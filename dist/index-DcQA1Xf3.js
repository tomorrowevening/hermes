var QPe=Object.defineProperty;var JPe=(s,e,t)=>e in s?QPe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Xe=(s,e,t)=>JPe(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var A0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function R8e(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var sV={exports:{}},aw={},oV={exports:{}},vi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s9e;function eRe(){if(s9e)return vi;s9e=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function S(Pe){return Pe===null||typeof Pe!="object"?null:(Pe=x&&Pe[x]||Pe["@@iterator"],typeof Pe=="function"?Pe:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,L={};function B(Pe,vt,Bt){this.props=Pe,this.context=vt,this.refs=L,this.updater=Bt||M}B.prototype.isReactComponent={},B.prototype.setState=function(Pe,vt){if(typeof Pe!="object"&&typeof Pe!="function"&&Pe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Pe,vt,"setState")},B.prototype.forceUpdate=function(Pe){this.updater.enqueueForceUpdate(this,Pe,"forceUpdate")};function A(){}A.prototype=B.prototype;function V(Pe,vt,Bt){this.props=Pe,this.context=vt,this.refs=L,this.updater=Bt||M}var X=V.prototype=new A;X.constructor=V,I(X,B.prototype),X.isPureReactComponent=!0;var P=Array.isArray,te=Object.prototype.hasOwnProperty,oe={current:null},ie={key:!0,ref:!0,__self:!0,__source:!0};function K(Pe,vt,Bt){var ct,Pt={},on=null,Gt=null;if(vt!=null)for(ct in vt.ref!==void 0&&(Gt=vt.ref),vt.key!==void 0&&(on=""+vt.key),vt)te.call(vt,ct)&&!ie.hasOwnProperty(ct)&&(Pt[ct]=vt[ct]);var hn=arguments.length-2;if(hn===1)Pt.children=Bt;else if(1<hn){for(var Xn=Array(hn),Fn=0;Fn<hn;Fn++)Xn[Fn]=arguments[Fn+2];Pt.children=Xn}if(Pe&&Pe.defaultProps)for(ct in hn=Pe.defaultProps,hn)Pt[ct]===void 0&&(Pt[ct]=hn[ct]);return{$$typeof:s,type:Pe,key:on,ref:Gt,props:Pt,_owner:oe.current}}function re(Pe,vt){return{$$typeof:s,type:Pe.type,key:vt,ref:Pe.ref,props:Pe.props,_owner:Pe._owner}}function se(Pe){return typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===s}function q(Pe){var vt={"=":"=0",":":"=2"};return"$"+Pe.replace(/[=:]/g,function(Bt){return vt[Bt]})}var De=/\/+/g;function Be(Pe,vt){return typeof Pe=="object"&&Pe!==null&&Pe.key!=null?q(""+Pe.key):vt.toString(36)}function tt(Pe,vt,Bt,ct,Pt){var on=typeof Pe;(on==="undefined"||on==="boolean")&&(Pe=null);var Gt=!1;if(Pe===null)Gt=!0;else switch(on){case"string":case"number":Gt=!0;break;case"object":switch(Pe.$$typeof){case s:case e:Gt=!0}}if(Gt)return Gt=Pe,Pt=Pt(Gt),Pe=ct===""?"."+Be(Gt,0):ct,P(Pt)?(Bt="",Pe!=null&&(Bt=Pe.replace(De,"$&/")+"/"),tt(Pt,vt,Bt,"",function(Fn){return Fn})):Pt!=null&&(se(Pt)&&(Pt=re(Pt,Bt+(!Pt.key||Gt&&Gt.key===Pt.key?"":(""+Pt.key).replace(De,"$&/")+"/")+Pe)),vt.push(Pt)),1;if(Gt=0,ct=ct===""?".":ct+":",P(Pe))for(var hn=0;hn<Pe.length;hn++){on=Pe[hn];var Xn=ct+Be(on,hn);Gt+=tt(on,vt,Bt,Xn,Pt)}else if(Xn=S(Pe),typeof Xn=="function")for(Pe=Xn.call(Pe),hn=0;!(on=Pe.next()).done;)on=on.value,Xn=ct+Be(on,hn++),Gt+=tt(on,vt,Bt,Xn,Pt);else if(on==="object")throw vt=String(Pe),Error("Objects are not valid as a React child (found: "+(vt==="[object Object]"?"object with keys {"+Object.keys(Pe).join(", ")+"}":vt)+"). If you meant to render a collection of children, use an array instead.");return Gt}function st(Pe,vt,Bt){if(Pe==null)return Pe;var ct=[],Pt=0;return tt(Pe,ct,"","",function(on){return vt.call(Bt,on,Pt++)}),ct}function de(Pe){if(Pe._status===-1){var vt=Pe._result;vt=vt(),vt.then(function(Bt){(Pe._status===0||Pe._status===-1)&&(Pe._status=1,Pe._result=Bt)},function(Bt){(Pe._status===0||Pe._status===-1)&&(Pe._status=2,Pe._result=Bt)}),Pe._status===-1&&(Pe._status=0,Pe._result=vt)}if(Pe._status===1)return Pe._result.default;throw Pe._result}var ft={current:null},Se={transition:null},rt={ReactCurrentDispatcher:ft,ReactCurrentBatchConfig:Se,ReactCurrentOwner:oe};function ut(){throw Error("act(...) is not supported in production builds of React.")}return vi.Children={map:st,forEach:function(Pe,vt,Bt){st(Pe,function(){vt.apply(this,arguments)},Bt)},count:function(Pe){var vt=0;return st(Pe,function(){vt++}),vt},toArray:function(Pe){return st(Pe,function(vt){return vt})||[]},only:function(Pe){if(!se(Pe))throw Error("React.Children.only expected to receive a single React element child.");return Pe}},vi.Component=B,vi.Fragment=t,vi.Profiler=r,vi.PureComponent=V,vi.StrictMode=n,vi.Suspense=u,vi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rt,vi.act=ut,vi.cloneElement=function(Pe,vt,Bt){if(Pe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Pe+".");var ct=I({},Pe.props),Pt=Pe.key,on=Pe.ref,Gt=Pe._owner;if(vt!=null){if(vt.ref!==void 0&&(on=vt.ref,Gt=oe.current),vt.key!==void 0&&(Pt=""+vt.key),Pe.type&&Pe.type.defaultProps)var hn=Pe.type.defaultProps;for(Xn in vt)te.call(vt,Xn)&&!ie.hasOwnProperty(Xn)&&(ct[Xn]=vt[Xn]===void 0&&hn!==void 0?hn[Xn]:vt[Xn])}var Xn=arguments.length-2;if(Xn===1)ct.children=Bt;else if(1<Xn){hn=Array(Xn);for(var Fn=0;Fn<Xn;Fn++)hn[Fn]=arguments[Fn+2];ct.children=hn}return{$$typeof:s,type:Pe.type,key:Pt,ref:on,props:ct,_owner:Gt}},vi.createContext=function(Pe){return Pe={$$typeof:a,_currentValue:Pe,_currentValue2:Pe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Pe.Provider={$$typeof:i,_context:Pe},Pe.Consumer=Pe},vi.createElement=K,vi.createFactory=function(Pe){var vt=K.bind(null,Pe);return vt.type=Pe,vt},vi.createRef=function(){return{current:null}},vi.forwardRef=function(Pe){return{$$typeof:c,render:Pe}},vi.isValidElement=se,vi.lazy=function(Pe){return{$$typeof:y,_payload:{_status:-1,_result:Pe},_init:de}},vi.memo=function(Pe,vt){return{$$typeof:p,type:Pe,compare:vt===void 0?null:vt}},vi.startTransition=function(Pe){var vt=Se.transition;Se.transition={};try{Pe()}finally{Se.transition=vt}},vi.unstable_act=ut,vi.useCallback=function(Pe,vt){return ft.current.useCallback(Pe,vt)},vi.useContext=function(Pe){return ft.current.useContext(Pe)},vi.useDebugValue=function(){},vi.useDeferredValue=function(Pe){return ft.current.useDeferredValue(Pe)},vi.useEffect=function(Pe,vt){return ft.current.useEffect(Pe,vt)},vi.useId=function(){return ft.current.useId()},vi.useImperativeHandle=function(Pe,vt,Bt){return ft.current.useImperativeHandle(Pe,vt,Bt)},vi.useInsertionEffect=function(Pe,vt){return ft.current.useInsertionEffect(Pe,vt)},vi.useLayoutEffect=function(Pe,vt){return ft.current.useLayoutEffect(Pe,vt)},vi.useMemo=function(Pe,vt){return ft.current.useMemo(Pe,vt)},vi.useReducer=function(Pe,vt,Bt){return ft.current.useReducer(Pe,vt,Bt)},vi.useRef=function(Pe){return ft.current.useRef(Pe)},vi.useState=function(Pe){return ft.current.useState(Pe)},vi.useSyncExternalStore=function(Pe,vt,Bt){return ft.current.useSyncExternalStore(Pe,vt,Bt)},vi.useTransition=function(){return ft.current.useTransition()},vi.version="18.3.1",vi}var o9e;function pW(){return o9e||(o9e=1,oV.exports=eRe()),oV.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a9e;function tRe(){if(a9e)return aw;a9e=1;var s=pW(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(c,u,p){var y,x={},S=null,M=null;p!==void 0&&(S=""+p),u.key!==void 0&&(S=""+u.key),u.ref!==void 0&&(M=u.ref);for(y in u)n.call(u,y)&&!i.hasOwnProperty(y)&&(x[y]=u[y]);if(c&&c.defaultProps)for(y in u=c.defaultProps,u)x[y]===void 0&&(x[y]=u[y]);return{$$typeof:e,type:c,key:S,ref:M,props:x,_owner:r.current}}return aw.Fragment=t,aw.jsx=a,aw.jsxs=a,aw}var l9e;function nRe(){return l9e||(l9e=1,sV.exports=tRe()),sV.exports}var Ke=nRe(),Tn=pW(),mR={},aV={exports:{}},$c={},lV={exports:{}},cV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c9e;function rRe(){return c9e||(c9e=1,function(s){function e(Se,rt){var ut=Se.length;Se.push(rt);e:for(;0<ut;){var Pe=ut-1>>>1,vt=Se[Pe];if(0<r(vt,rt))Se[Pe]=rt,Se[ut]=vt,ut=Pe;else break e}}function t(Se){return Se.length===0?null:Se[0]}function n(Se){if(Se.length===0)return null;var rt=Se[0],ut=Se.pop();if(ut!==rt){Se[0]=ut;e:for(var Pe=0,vt=Se.length,Bt=vt>>>1;Pe<Bt;){var ct=2*(Pe+1)-1,Pt=Se[ct],on=ct+1,Gt=Se[on];if(0>r(Pt,ut))on<vt&&0>r(Gt,Pt)?(Se[Pe]=Gt,Se[on]=ut,Pe=on):(Se[Pe]=Pt,Se[ct]=ut,Pe=ct);else if(on<vt&&0>r(Gt,ut))Se[Pe]=Gt,Se[on]=ut,Pe=on;else break e}}return rt}function r(Se,rt){var ut=Se.sortIndex-rt.sortIndex;return ut!==0?ut:Se.id-rt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;s.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();s.unstable_now=function(){return a.now()-c}}var u=[],p=[],y=1,x=null,S=3,M=!1,I=!1,L=!1,B=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function X(Se){for(var rt=t(p);rt!==null;){if(rt.callback===null)n(p);else if(rt.startTime<=Se)n(p),rt.sortIndex=rt.expirationTime,e(u,rt);else break;rt=t(p)}}function P(Se){if(L=!1,X(Se),!I)if(t(u)!==null)I=!0,de(te);else{var rt=t(p);rt!==null&&ft(P,rt.startTime-Se)}}function te(Se,rt){I=!1,L&&(L=!1,A(K),K=-1),M=!0;var ut=S;try{for(X(rt),x=t(u);x!==null&&(!(x.expirationTime>rt)||Se&&!q());){var Pe=x.callback;if(typeof Pe=="function"){x.callback=null,S=x.priorityLevel;var vt=Pe(x.expirationTime<=rt);rt=s.unstable_now(),typeof vt=="function"?x.callback=vt:x===t(u)&&n(u),X(rt)}else n(u);x=t(u)}if(x!==null)var Bt=!0;else{var ct=t(p);ct!==null&&ft(P,ct.startTime-rt),Bt=!1}return Bt}finally{x=null,S=ut,M=!1}}var oe=!1,ie=null,K=-1,re=5,se=-1;function q(){return!(s.unstable_now()-se<re)}function De(){if(ie!==null){var Se=s.unstable_now();se=Se;var rt=!0;try{rt=ie(!0,Se)}finally{rt?Be():(oe=!1,ie=null)}}else oe=!1}var Be;if(typeof V=="function")Be=function(){V(De)};else if(typeof MessageChannel<"u"){var tt=new MessageChannel,st=tt.port2;tt.port1.onmessage=De,Be=function(){st.postMessage(null)}}else Be=function(){B(De,0)};function de(Se){ie=Se,oe||(oe=!0,Be())}function ft(Se,rt){K=B(function(){Se(s.unstable_now())},rt)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Se){Se.callback=null},s.unstable_continueExecution=function(){I||M||(I=!0,de(te))},s.unstable_forceFrameRate=function(Se){0>Se||125<Se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<Se?Math.floor(1e3/Se):5},s.unstable_getCurrentPriorityLevel=function(){return S},s.unstable_getFirstCallbackNode=function(){return t(u)},s.unstable_next=function(Se){switch(S){case 1:case 2:case 3:var rt=3;break;default:rt=S}var ut=S;S=rt;try{return Se()}finally{S=ut}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Se,rt){switch(Se){case 1:case 2:case 3:case 4:case 5:break;default:Se=3}var ut=S;S=Se;try{return rt()}finally{S=ut}},s.unstable_scheduleCallback=function(Se,rt,ut){var Pe=s.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?Pe+ut:Pe):ut=Pe,Se){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=ut+vt,Se={id:y++,callback:rt,priorityLevel:Se,startTime:ut,expirationTime:vt,sortIndex:-1},ut>Pe?(Se.sortIndex=ut,e(p,Se),t(u)===null&&Se===t(p)&&(L?(A(K),K=-1):L=!0,ft(P,ut-Pe))):(Se.sortIndex=vt,e(u,Se),I||M||(I=!0,de(te))),Se},s.unstable_shouldYield=q,s.unstable_wrapCallback=function(Se){var rt=S;return function(){var ut=S;S=rt;try{return Se.apply(this,arguments)}finally{S=ut}}}}(cV)),cV}var u9e;function iRe(){return u9e||(u9e=1,lV.exports=rRe()),lV.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h9e;function sRe(){if(h9e)return $c;h9e=1;var s=pW(),e=iRe();function t(d){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+d,E=1;E<arguments.length;E++)g+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function i(d,g){a(d,g),a(d+"Capture",g)}function a(d,g){for(r[d]=g,d=0;d<g.length;d++)n.add(g[d])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},x={};function S(d){return u.call(x,d)?!0:u.call(y,d)?!1:p.test(d)?x[d]=!0:(y[d]=!0,!1)}function M(d,g,E,D){if(E!==null&&E.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return D?!1:E!==null?!E.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function I(d,g,E,D){if(g===null||typeof g>"u"||M(d,g,E,D))return!0;if(D)return!1;if(E!==null)switch(E.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function L(d,g,E,D,H,Q,he){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=D,this.attributeNamespace=H,this.mustUseProperty=E,this.propertyName=d,this.type=g,this.sanitizeURL=Q,this.removeEmptyString=he}var B={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){B[d]=new L(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var g=d[0];B[g]=new L(g,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){B[d]=new L(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){B[d]=new L(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){B[d]=new L(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){B[d]=new L(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){B[d]=new L(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){B[d]=new L(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){B[d]=new L(d,5,!1,d.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function V(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var g=d.replace(A,V);B[g]=new L(g,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var g=d.replace(A,V);B[g]=new L(g,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var g=d.replace(A,V);B[g]=new L(g,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){B[d]=new L(d,1,!1,d.toLowerCase(),null,!1,!1)}),B.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){B[d]=new L(d,1,!1,d.toLowerCase(),null,!0,!0)});function X(d,g,E,D){var H=B.hasOwnProperty(g)?B[g]:null;(H!==null?H.type!==0:D||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(I(g,E,H,D)&&(E=null),D||H===null?S(g)&&(E===null?d.removeAttribute(g):d.setAttribute(g,""+E)):H.mustUseProperty?d[H.propertyName]=E===null?H.type===3?!1:"":E:(g=H.attributeName,D=H.attributeNamespace,E===null?d.removeAttribute(g):(H=H.type,E=H===3||H===4&&E===!0?"":""+E,D?d.setAttributeNS(D,g,E):d.setAttribute(g,E))))}var P=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),oe=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),K=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),se=Symbol.for("react.provider"),q=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),Be=Symbol.for("react.suspense"),tt=Symbol.for("react.suspense_list"),st=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),ft=Symbol.for("react.offscreen"),Se=Symbol.iterator;function rt(d){return d===null||typeof d!="object"?null:(d=Se&&d[Se]||d["@@iterator"],typeof d=="function"?d:null)}var ut=Object.assign,Pe;function vt(d){if(Pe===void 0)try{throw Error()}catch(E){var g=E.stack.trim().match(/\n( *(at )?)/);Pe=g&&g[1]||""}return`
`+Pe+d}var Bt=!1;function ct(d,g){if(!d||Bt)return"";Bt=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Ct){var D=Ct}Reflect.construct(d,[],g)}else{try{g.call()}catch(Ct){D=Ct}d.call(g.prototype)}else{try{throw Error()}catch(Ct){D=Ct}d()}}catch(Ct){if(Ct&&D&&typeof Ct.stack=="string"){for(var H=Ct.stack.split(`
`),Q=D.stack.split(`
`),he=H.length-1,ke=Q.length-1;1<=he&&0<=ke&&H[he]!==Q[ke];)ke--;for(;1<=he&&0<=ke;he--,ke--)if(H[he]!==Q[ke]){if(he!==1||ke!==1)do if(he--,ke--,0>ke||H[he]!==Q[ke]){var ze=`
`+H[he].replace(" at new "," at ");return d.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",d.displayName)),ze}while(1<=he&&0<=ke);break}}}finally{Bt=!1,Error.prepareStackTrace=E}return(d=d?d.displayName||d.name:"")?vt(d):""}function Pt(d){switch(d.tag){case 5:return vt(d.type);case 16:return vt("Lazy");case 13:return vt("Suspense");case 19:return vt("SuspenseList");case 0:case 2:case 15:return d=ct(d.type,!1),d;case 11:return d=ct(d.type.render,!1),d;case 1:return d=ct(d.type,!0),d;default:return""}}function on(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case ie:return"Fragment";case oe:return"Portal";case re:return"Profiler";case K:return"StrictMode";case Be:return"Suspense";case tt:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case q:return(d.displayName||"Context")+".Consumer";case se:return(d._context.displayName||"Context")+".Provider";case De:var g=d.render;return d=d.displayName,d||(d=g.displayName||g.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case st:return g=d.displayName||null,g!==null?g:on(d.type)||"Memo";case de:g=d._payload,d=d._init;try{return on(d(g))}catch{}}return null}function Gt(d){var g=d.type;switch(d.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=g.render,d=d.displayName||d.name||"",g.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return on(g);case 8:return g===K?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function hn(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Xn(d){var g=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Fn(d){var g=Xn(d)?"checked":"value",E=Object.getOwnPropertyDescriptor(d.constructor.prototype,g),D=""+d[g];if(!d.hasOwnProperty(g)&&typeof E<"u"&&typeof E.get=="function"&&typeof E.set=="function"){var H=E.get,Q=E.set;return Object.defineProperty(d,g,{configurable:!0,get:function(){return H.call(this)},set:function(he){D=""+he,Q.call(this,he)}}),Object.defineProperty(d,g,{enumerable:E.enumerable}),{getValue:function(){return D},setValue:function(he){D=""+he},stopTracking:function(){d._valueTracker=null,delete d[g]}}}}function Kr(d){d._valueTracker||(d._valueTracker=Fn(d))}function Mi(d){if(!d)return!1;var g=d._valueTracker;if(!g)return!0;var E=g.getValue(),D="";return d&&(D=Xn(d)?d.checked?"true":"false":d.value),d=D,d!==E?(g.setValue(d),!0):!1}function Br(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Ue(d,g){var E=g.checked;return ut({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:E??d._wrapperState.initialChecked})}function Ii(d,g){var E=g.defaultValue==null?"":g.defaultValue,D=g.checked!=null?g.checked:g.defaultChecked;E=hn(g.value!=null?g.value:E),d._wrapperState={initialChecked:D,initialValue:E,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function ei(d,g){g=g.checked,g!=null&&X(d,"checked",g,!1)}function Ar(d,g){ei(d,g);var E=hn(g.value),D=g.type;if(E!=null)D==="number"?(E===0&&d.value===""||d.value!=E)&&(d.value=""+E):d.value!==""+E&&(d.value=""+E);else if(D==="submit"||D==="reset"){d.removeAttribute("value");return}g.hasOwnProperty("value")?Yr(d,g.type,E):g.hasOwnProperty("defaultValue")&&Yr(d,g.type,hn(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(d.defaultChecked=!!g.defaultChecked)}function On(d,g,E){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var D=g.type;if(!(D!=="submit"&&D!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+d._wrapperState.initialValue,E||g===d.value||(d.value=g),d.defaultValue=g}E=d.name,E!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,E!==""&&(d.name=E)}function Yr(d,g,E){(g!=="number"||Br(d.ownerDocument)!==d)&&(E==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+E&&(d.defaultValue=""+E))}var Yn=Array.isArray;function vr(d,g,E,D){if(d=d.options,g){g={};for(var H=0;H<E.length;H++)g["$"+E[H]]=!0;for(E=0;E<d.length;E++)H=g.hasOwnProperty("$"+d[E].value),d[E].selected!==H&&(d[E].selected=H),H&&D&&(d[E].defaultSelected=!0)}else{for(E=""+hn(E),g=null,H=0;H<d.length;H++){if(d[H].value===E){d[H].selected=!0,D&&(d[H].defaultSelected=!0);return}g!==null||d[H].disabled||(g=d[H])}g!==null&&(g.selected=!0)}}function Ci(d,g){if(g.dangerouslySetInnerHTML!=null)throw Error(t(91));return ut({},g,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Ie(d,g){var E=g.value;if(E==null){if(E=g.children,g=g.defaultValue,E!=null){if(g!=null)throw Error(t(92));if(Yn(E)){if(1<E.length)throw Error(t(93));E=E[0]}g=E}g==null&&(g=""),E=g}d._wrapperState={initialValue:hn(E)}}function pe(d,g){var E=hn(g.value),D=hn(g.defaultValue);E!=null&&(E=""+E,E!==d.value&&(d.value=E),g.defaultValue==null&&d.defaultValue!==E&&(d.defaultValue=E)),D!=null&&(d.defaultValue=""+D)}function wt(d){var g=d.textContent;g===d._wrapperState.initialValue&&g!==""&&g!==null&&(d.value=g)}function Vt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qt(d,g){return d==null||d==="http://www.w3.org/1999/xhtml"?Vt(g):d==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var Ot,Kn=function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,E,D,H){MSApp.execUnsafeLocalFunction(function(){return d(g,E,D,H)})}:d}(function(d,g){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=g;else{for(Ot=Ot||document.createElement("div"),Ot.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=Ot.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;g.firstChild;)d.appendChild(g.firstChild)}});function vn(d,g){if(g){var E=d.firstChild;if(E&&E===d.lastChild&&E.nodeType===3){E.nodeValue=g;return}}d.textContent=g}var Ln={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qn=["Webkit","ms","Moz","O"];Object.keys(Ln).forEach(function(d){Qn.forEach(function(g){g=g+d.charAt(0).toUpperCase()+d.substring(1),Ln[g]=Ln[d]})});function jt(d,g,E){return g==null||typeof g=="boolean"||g===""?"":E||typeof g!="number"||g===0||Ln.hasOwnProperty(d)&&Ln[d]?(""+g).trim():g+"px"}function Rn(d,g){d=d.style;for(var E in g)if(g.hasOwnProperty(E)){var D=E.indexOf("--")===0,H=jt(E,g[E],D);E==="float"&&(E="cssFloat"),D?d.setProperty(E,H):d[E]=H}}var rr=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jn(d,g){if(g){if(rr[d]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(t(137,d));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(t(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(t(61))}if(g.style!=null&&typeof g.style!="object")throw Error(t(62))}}function _n(d,g){if(d.indexOf("-")===-1)return typeof g.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tr=null;function je(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var yn=null,Yt=null,wn=null;function tn(d){if(d=vh(d)){if(typeof yn!="function")throw Error(t(280));var g=d.stateNode;g&&(g=vc(g),yn(d.stateNode,d.type,g))}}function Wt(d){Yt?wn?wn.push(d):wn=[d]:Yt=d}function kn(){if(Yt){var d=Yt,g=wn;if(wn=Yt=null,tn(d),g)for(d=0;d<g.length;d++)tn(g[d])}}function yr(d,g){return d(g)}function ki(){}var hr=!1;function Qi(d,g,E){if(hr)return d(g,E);hr=!0;try{return yr(d,g,E)}finally{hr=!1,(Yt!==null||wn!==null)&&(ki(),kn())}}function Eo(d,g){var E=d.stateNode;if(E===null)return null;var D=vc(E);if(D===null)return null;E=D[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(d=d.type,D=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!D;break e;default:d=!1}if(d)return null;if(E&&typeof E!="function")throw Error(t(231,g,typeof E));return E}var ru=!1;if(c)try{var I0={};Object.defineProperty(I0,"passive",{get:function(){ru=!0}}),window.addEventListener("test",I0,I0),window.removeEventListener("test",I0,I0)}catch{ru=!1}function i0(d,g,E,D,H,Q,he,ke,ze){var Ct=Array.prototype.slice.call(arguments,3);try{g.apply(E,Ct)}catch(Qt){this.onError(Qt)}}var k0=!1,iu=null,su=!1,ea=null,ih={onError:function(d){k0=!0,iu=d}};function sh(d,g,E,D,H,Q,he,ke,ze){k0=!1,iu=null,i0.apply(ih,arguments)}function zf(d,g,E,D,H,Q,he,ke,ze){if(sh.apply(this,arguments),k0){if(k0){var Ct=iu;k0=!1,iu=null}else throw Error(t(198));su||(su=!0,ea=Ct)}}function ao(d){var g=d,E=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,(g.flags&4098)!==0&&(E=g.return),d=g.return;while(d)}return g.tag===3?E:null}function hd(d){if(d.tag===13){var g=d.memoizedState;if(g===null&&(d=d.alternate,d!==null&&(g=d.memoizedState)),g!==null)return g.dehydrated}return null}function fc(d){if(ao(d)!==d)throw Error(t(188))}function oh(d){var g=d.alternate;if(!g){if(g=ao(d),g===null)throw Error(t(188));return g!==d?null:d}for(var E=d,D=g;;){var H=E.return;if(H===null)break;var Q=H.alternate;if(Q===null){if(D=H.return,D!==null){E=D;continue}break}if(H.child===Q.child){for(Q=H.child;Q;){if(Q===E)return fc(H),d;if(Q===D)return fc(H),g;Q=Q.sibling}throw Error(t(188))}if(E.return!==D.return)E=H,D=Q;else{for(var he=!1,ke=H.child;ke;){if(ke===E){he=!0,E=H,D=Q;break}if(ke===D){he=!0,D=H,E=Q;break}ke=ke.sibling}if(!he){for(ke=Q.child;ke;){if(ke===E){he=!0,E=Q,D=H;break}if(ke===D){he=!0,D=Q,E=H;break}ke=ke.sibling}if(!he)throw Error(t(189))}}if(E.alternate!==D)throw Error(t(190))}if(E.tag!==3)throw Error(t(188));return E.stateNode.current===E?d:g}function To(d){return d=oh(d),d!==null?va(d):null}function va(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var g=va(d);if(g!==null)return g;d=d.sibling}return null}var Vf=e.unstable_scheduleCallback,ye=e.unstable_cancelCallback,at=e.unstable_shouldYield,Tt=e.unstable_requestPaint,gt=e.unstable_now,lt=e.unstable_getCurrentPriorityLevel,Kt=e.unstable_ImmediatePriority,bn=e.unstable_UserBlockingPriority,Cn=e.unstable_NormalPriority,Nn=e.unstable_LowPriority,fr=e.unstable_IdlePriority,ar=null,Bn=null;function Pr(d){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(ar,d,void 0,(d.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:Dr,Oi=Math.log,is=Math.LN2;function Dr(d){return d>>>=0,d===0?32:31-(Oi(d)/is|0)|0}var jn=64,vs=4194304;function Ur(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function lo(d,g){var E=d.pendingLanes;if(E===0)return 0;var D=0,H=d.suspendedLanes,Q=d.pingedLanes,he=E&268435455;if(he!==0){var ke=he&~H;ke!==0?D=Ur(ke):(Q&=he,Q!==0&&(D=Ur(Q)))}else he=E&~H,he!==0?D=Ur(he):Q!==0&&(D=Ur(Q));if(D===0)return 0;if(g!==0&&g!==D&&(g&H)===0&&(H=D&-D,Q=g&-g,H>=Q||H===16&&(Q&4194240)!==0))return g;if((D&4)!==0&&(D|=E&16),g=d.entangledLanes,g!==0)for(d=d.entanglements,g&=D;0<g;)E=31-_r(g),H=1<<E,D|=d[E],g&=~H;return D}function wl(d,g){switch(d){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mo(d,g){for(var E=d.suspendedLanes,D=d.pingedLanes,H=d.expirationTimes,Q=d.pendingLanes;0<Q;){var he=31-_r(Q),ke=1<<he,ze=H[he];ze===-1?((ke&E)===0||(ke&D)!==0)&&(H[he]=wl(ke,g)):ze<=g&&(d.expiredLanes|=ke),Q&=~ke}}function s0(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Li(){var d=jn;return jn<<=1,(jn&4194240)===0&&(jn=64),d}function ys(d){for(var g=[],E=0;31>E;E++)g.push(d);return g}function xs(d,g,E){d.pendingLanes|=g,g!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,g=31-_r(g),d[g]=E}function co(d,g){var E=d.pendingLanes&~g;d.pendingLanes=g,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=g,d.mutableReadLanes&=g,d.entangledLanes&=g,g=d.entanglements;var D=d.eventTimes;for(d=d.expirationTimes;0<E;){var H=31-_r(E),Q=1<<H;g[H]=0,D[H]=-1,d[H]=-1,E&=~Q}}function ks(d,g){var E=d.entangledLanes|=g;for(d=d.entanglements;E;){var D=31-_r(E),H=1<<D;H&g|d[D]&g&&(d[D]|=g),E&=~H}}var ti=0;function Co(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var dd,P1,ou,R1,El,Gf=!1,jf=[],Tl=null,ya=null,N0=null,au=new Map,ah=new Map,Ml=[],Jg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function I1(d,g){switch(d){case"focusin":case"focusout":Tl=null;break;case"dragenter":case"dragleave":ya=null;break;case"mouseover":case"mouseout":N0=null;break;case"pointerover":case"pointerout":au.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":ah.delete(g.pointerId)}}function fd(d,g,E,D,H,Q){return d===null||d.nativeEvent!==Q?(d={blockedOn:g,domEventName:E,eventSystemFlags:D,nativeEvent:Q,targetContainers:[H]},g!==null&&(g=vh(g),g!==null&&P1(g)),d):(d.eventSystemFlags|=D,g=d.targetContainers,H!==null&&g.indexOf(H)===-1&&g.push(H),d)}function n4(d,g,E,D,H){switch(g){case"focusin":return Tl=fd(Tl,d,g,E,D,H),!0;case"dragenter":return ya=fd(ya,d,g,E,D,H),!0;case"mouseover":return N0=fd(N0,d,g,E,D,H),!0;case"pointerover":var Q=H.pointerId;return au.set(Q,fd(au.get(Q)||null,d,g,E,D,H)),!0;case"gotpointercapture":return Q=H.pointerId,ah.set(Q,fd(ah.get(Q)||null,d,g,E,D,H)),!0}return!1}function pc(d){var g=U0(d.target);if(g!==null){var E=ao(g);if(E!==null){if(g=E.tag,g===13){if(g=hd(E),g!==null){d.blockedOn=g,El(d.priority,function(){ou(E)});return}}else if(g===3&&E.stateNode.current.memoizedState.isDehydrated){d.blockedOn=E.tag===3?E.stateNode.containerInfo:null;return}}}d.blockedOn=null}function lu(d){if(d.blockedOn!==null)return!1;for(var g=d.targetContainers;0<g.length;){var E=qf(d.domEventName,d.eventSystemFlags,g[0],d.nativeEvent);if(E===null){E=d.nativeEvent;var D=new E.constructor(E.type,E);tr=D,E.target.dispatchEvent(D),tr=null}else return g=vh(E),g!==null&&P1(g),d.blockedOn=E,!1;g.shift()}return!0}function e2(d,g,E){lu(d)&&E.delete(g)}function D0(){Gf=!1,Tl!==null&&lu(Tl)&&(Tl=null),ya!==null&&lu(ya)&&(ya=null),N0!==null&&lu(N0)&&(N0=null),au.forEach(e2),ah.forEach(e2)}function o0(d,g){d.blockedOn===g&&(d.blockedOn=null,Gf||(Gf=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,D0)))}function lh(d){function g(H){return o0(H,d)}if(0<jf.length){o0(jf[0],d);for(var E=1;E<jf.length;E++){var D=jf[E];D.blockedOn===d&&(D.blockedOn=null)}}for(Tl!==null&&o0(Tl,d),ya!==null&&o0(ya,d),N0!==null&&o0(N0,d),au.forEach(g),ah.forEach(g),E=0;E<Ml.length;E++)D=Ml[E],D.blockedOn===d&&(D.blockedOn=null);for(;0<Ml.length&&(E=Ml[0],E.blockedOn===null);)pc(E),E.blockedOn===null&&Ml.shift()}var Cl=P.ReactCurrentBatchConfig,Hf=!0;function k1(d,g,E,D){var H=ti,Q=Cl.transition;Cl.transition=null;try{ti=1,Wf(d,g,E,D)}finally{ti=H,Cl.transition=Q}}function t2(d,g,E,D){var H=ti,Q=Cl.transition;Cl.transition=null;try{ti=4,Wf(d,g,E,D)}finally{ti=H,Cl.transition=Q}}function Wf(d,g,E,D){if(Hf){var H=qf(d,g,E,D);if(H===null)m2(d,g,D,$f,E),I1(d,D);else if(n4(H,d,g,E,D))D.stopPropagation();else if(I1(d,D),g&4&&-1<Jg.indexOf(d)){for(;H!==null;){var Q=vh(H);if(Q!==null&&dd(Q),Q=qf(d,g,E,D),Q===null&&m2(d,g,D,$f,E),Q===H)break;H=Q}H!==null&&D.stopPropagation()}else m2(d,g,D,null,E)}}var $f=null;function qf(d,g,E,D){if($f=null,d=je(D),d=U0(d),d!==null)if(g=ao(d),g===null)d=null;else if(E=g.tag,E===13){if(d=hd(g),d!==null)return d;d=null}else if(E===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;d=null}else g!==d&&(d=null);return $f=d,null}function N1(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lt()){case Kt:return 1;case bn:return 4;case Cn:case Nn:return 16;case fr:return 536870912;default:return 16}default:return 16}}var Al=null,Xf=null,ch=null;function D1(){if(ch)return ch;var d,g=Xf,E=g.length,D,H="value"in Al?Al.value:Al.textContent,Q=H.length;for(d=0;d<E&&g[d]===H[d];d++);var he=E-d;for(D=1;D<=he&&g[E-D]===H[Q-D];D++);return ch=H.slice(d,1<D?1-D:void 0)}function Yf(d){var g=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&g===13&&(d=13)):d=g,d===10&&(d=13),32<=d||d===13?d:0}function Pl(){return!0}function Kf(){return!1}function uo(d){function g(E,D,H,Q,he){this._reactName=E,this._targetInst=H,this.type=D,this.nativeEvent=Q,this.target=he,this.currentTarget=null;for(var ke in d)d.hasOwnProperty(ke)&&(E=d[ke],this[ke]=E?E(Q):Q[ke]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?Pl:Kf,this.isPropagationStopped=Kf,this}return ut(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var E=this.nativeEvent;E&&(E.preventDefault?E.preventDefault():typeof E.returnValue!="unknown"&&(E.returnValue=!1),this.isDefaultPrevented=Pl)},stopPropagation:function(){var E=this.nativeEvent;E&&(E.stopPropagation?E.stopPropagation():typeof E.cancelBubble!="unknown"&&(E.cancelBubble=!0),this.isPropagationStopped=Pl)},persist:function(){},isPersistent:Pl}),g}var cu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ia=uo(cu),O0=ut({},cu,{view:0,detail:0}),pd=uo(O0),md,Rl,uu,Il=ut({},O0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tp,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==uu&&(uu&&d.type==="mousemove"?(md=d.screenX-uu.screenX,Rl=d.screenY-uu.screenY):Rl=md=0,uu=d),md)},movementY:function(d){return"movementY"in d?d.movementY:Rl}}),Vs=uo(Il),mc=ut({},Il,{dataTransfer:0}),Zf=uo(mc),n2=ut({},O0,{relatedTarget:0}),L0=uo(n2),gd=ut({},cu,{animationName:0,elapsedTime:0,pseudoElement:0}),r2=uo(gd),i2=ut({},cu,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),O1=uo(i2),r4=ut({},cu,{data:0}),Qf=uo(r4),i4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ep(d){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(d):(d=Jf[d])?!!g[d]:!1}function tp(){return ep}var vd=ut({},O0,{key:function(d){if(d.key){var g=i4[d.key]||d.key;if(g!=="Unidentified")return g}return d.type==="keypress"?(d=Yf(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?L1[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tp,charCode:function(d){return d.type==="keypress"?Yf(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Yf(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Ao=uo(vd),s4=ut({},Il,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yd=uo(s4),s2=ut({},O0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tp}),o2=uo(s2),Bo=ut({},cu,{propertyName:0,elapsedTime:0,pseudoElement:0}),a2=uo(Bo),o4=ut({},Il,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),l2=uo(o4),c2=[9,13,27,32],F1=c&&"CompositionEvent"in window,_s=null;c&&"documentMode"in document&&(_s=document.documentMode);var uh=c&&"TextEvent"in window&&!_s,F0=c&&(!F1||_s&&8<_s&&11>=_s),kl=" ",B1=!1;function mi(d,g){switch(d){case"keyup":return c2.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hu(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var hh=!1;function dh(d,g){switch(d){case"compositionend":return hu(g);case"keypress":return g.which!==32?null:(B1=!0,kl);case"textInput":return d=g.data,d===kl&&B1?null:d;default:return null}}function xd(d,g){if(hh)return d==="compositionend"||!F1&&mi(d,g)?(d=D1(),ch=Xf=Al=null,hh=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return F0&&g.locale!=="ko"?null:g.data;default:return null}}var u2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function U1(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g==="input"?!!u2[d.type]:g==="textarea"}function fh(d,g,E,D){Wt(D),g=$1(g,"onChange"),0<g.length&&(E=new Ia("onChange","change",null,E,D),d.push({event:E,listeners:g}))}var B0=null,du=null;function a4(d){W1(d,0)}function Nl(d){var g=pu(d);if(Mi(g))return d}function np(d,g){if(d==="change")return g}var h2=!1;if(c){var le;if(c){var we="oninput"in document;if(!we){var We=document.createElement("div");We.setAttribute("oninput","return;"),we=typeof We.oninput=="function"}le=we}else le=!1;h2=le&&(!document.documentMode||9<document.documentMode)}function kt(){B0&&(B0.detachEvent("onpropertychange",pr),du=B0=null)}function pr(d){if(d.propertyName==="value"&&Nl(du)){var g=[];fh(g,du,d,je(d)),Qi(a4,g)}}function bi(d,g,E){d==="focusin"?(kt(),B0=g,du=E,B0.attachEvent("onpropertychange",pr)):d==="focusout"&&kt()}function Uo(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Nl(du)}function a0(d,g){if(d==="click")return Nl(g)}function _d(d,g){if(d==="input"||d==="change")return Nl(g)}function gc(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var zo=typeof Object.is=="function"?Object.is:gc;function Dl(d,g){if(zo(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var E=Object.keys(d),D=Object.keys(g);if(E.length!==D.length)return!1;for(D=0;D<E.length;D++){var H=E[D];if(!u.call(g,H)||!zo(d[H],g[H]))return!1}return!0}function rp(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function kv(d,g){var E=rp(d);d=0;for(var D;E;){if(E.nodeType===3){if(D=d+E.textContent.length,d<=g&&D>=g)return{node:E,offset:g-d};d=D}e:{for(;E;){if(E.nextSibling){E=E.nextSibling;break e}E=E.parentNode}E=void 0}E=rp(E)}}function d2(d,g){return d&&g?d===g?!0:d&&d.nodeType===3?!1:g&&g.nodeType===3?d2(d,g.parentNode):"contains"in d?d.contains(g):d.compareDocumentPosition?!!(d.compareDocumentPosition(g)&16):!1:!1}function Nv(){for(var d=window,g=Br();g instanceof d.HTMLIFrameElement;){try{var E=typeof g.contentWindow.location.href=="string"}catch{E=!1}if(E)d=g.contentWindow;else break;g=Br(d.document)}return g}function l4(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g&&(g==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||g==="textarea"||d.contentEditable==="true")}function Dv(d){var g=Nv(),E=d.focusedElem,D=d.selectionRange;if(g!==E&&E&&E.ownerDocument&&d2(E.ownerDocument.documentElement,E)){if(D!==null&&l4(E)){if(g=D.start,d=D.end,d===void 0&&(d=g),"selectionStart"in E)E.selectionStart=g,E.selectionEnd=Math.min(d,E.value.length);else if(d=(g=E.ownerDocument||document)&&g.defaultView||window,d.getSelection){d=d.getSelection();var H=E.textContent.length,Q=Math.min(D.start,H);D=D.end===void 0?Q:Math.min(D.end,H),!d.extend&&Q>D&&(H=D,D=Q,Q=H),H=kv(E,Q);var he=kv(E,D);H&&he&&(d.rangeCount!==1||d.anchorNode!==H.node||d.anchorOffset!==H.offset||d.focusNode!==he.node||d.focusOffset!==he.offset)&&(g=g.createRange(),g.setStart(H.node,H.offset),d.removeAllRanges(),Q>D?(d.addRange(g),d.extend(he.node,he.offset)):(g.setEnd(he.node,he.offset),d.addRange(g)))}}for(g=[],d=E;d=d.parentNode;)d.nodeType===1&&g.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<g.length;E++)d=g[E],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var f2=c&&"documentMode"in document&&11>=document.documentMode,Ol=null,c4=null,ip=null,z1=!1;function Ov(d,g,E){var D=E.window===E?E.document:E.nodeType===9?E:E.ownerDocument;z1||Ol==null||Ol!==Br(D)||(D=Ol,"selectionStart"in D&&l4(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),ip&&Dl(ip,D)||(ip=D,D=$1(c4,"onSelect"),0<D.length&&(g=new Ia("onSelect","select",null,g,E),d.push({event:g,listeners:D}),g.target=Ol)))}function sp(d,g){var E={};return E[d.toLowerCase()]=g.toLowerCase(),E["Webkit"+d]="webkit"+g,E["Moz"+d]="moz"+g,E}var ph={animationend:sp("Animation","AnimationEnd"),animationiteration:sp("Animation","AnimationIteration"),animationstart:sp("Animation","AnimationStart"),transitionend:sp("Transition","TransitionEnd")},u4={},op={};c&&(op=document.createElement("div").style,"AnimationEvent"in window||(delete ph.animationend.animation,delete ph.animationiteration.animation,delete ph.animationstart.animation),"TransitionEvent"in window||delete ph.transitionend.transition);function V1(d){if(u4[d])return u4[d];if(!ph[d])return d;var g=ph[d],E;for(E in g)if(g.hasOwnProperty(E)&&E in op)return u4[d]=g[E];return d}var h4=V1("animationend"),d4=V1("animationiteration"),G1=V1("animationstart"),j1=V1("transitionend"),f4=new Map,p4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mh(d,g){f4.set(d,g),i(g,[d])}for(var H1=0;H1<p4.length;H1++){var ap=p4[H1],Lv=ap.toLowerCase(),m4=ap[0].toUpperCase()+ap.slice(1);mh(Lv,"on"+m4)}mh(h4,"onAnimationEnd"),mh(d4,"onAnimationIteration"),mh(G1,"onAnimationStart"),mh("dblclick","onDoubleClick"),mh("focusin","onFocus"),mh("focusout","onBlur"),mh(j1,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g4=new Set("cancel close invalid load scroll toggle".split(" ").concat(bd));function lp(d,g,E){var D=d.type||"unknown-event";d.currentTarget=E,zf(D,g,void 0,d),d.currentTarget=null}function W1(d,g){g=(g&4)!==0;for(var E=0;E<d.length;E++){var D=d[E],H=D.event;D=D.listeners;e:{var Q=void 0;if(g)for(var he=D.length-1;0<=he;he--){var ke=D[he],ze=ke.instance,Ct=ke.currentTarget;if(ke=ke.listener,ze!==Q&&H.isPropagationStopped())break e;lp(H,ke,Ct),Q=ze}else for(he=0;he<D.length;he++){if(ke=D[he],ze=ke.instance,Ct=ke.currentTarget,ke=ke.listener,ze!==Q&&H.isPropagationStopped())break e;lp(H,ke,Ct),Q=ze}}}if(su)throw d=ea,su=!1,ea=null,d}function us(d,g){var E=g[Ed];E===void 0&&(E=g[Ed]=new Set);var D=d+"__bubble";E.has(D)||(v4(g,d,2,!1),E.add(D))}function p2(d,g,E){var D=0;g&&(D|=4),v4(E,d,D,g)}var gh="_reactListening"+Math.random().toString(36).slice(2);function cp(d){if(!d[gh]){d[gh]=!0,n.forEach(function(E){E!=="selectionchange"&&(g4.has(E)||p2(E,!1,d),p2(E,!0,d))});var g=d.nodeType===9?d:d.ownerDocument;g===null||g[gh]||(g[gh]=!0,p2("selectionchange",!1,g))}}function v4(d,g,E,D){switch(N1(g)){case 1:var H=k1;break;case 4:H=t2;break;default:H=Wf}E=H.bind(null,g,E,d),H=void 0,!ru||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(H=!0),D?H!==void 0?d.addEventListener(g,E,{capture:!0,passive:H}):d.addEventListener(g,E,!0):H!==void 0?d.addEventListener(g,E,{passive:H}):d.addEventListener(g,E,!1)}function m2(d,g,E,D,H){var Q=D;if((g&1)===0&&(g&2)===0&&D!==null)e:for(;;){if(D===null)return;var he=D.tag;if(he===3||he===4){var ke=D.stateNode.containerInfo;if(ke===H||ke.nodeType===8&&ke.parentNode===H)break;if(he===4)for(he=D.return;he!==null;){var ze=he.tag;if((ze===3||ze===4)&&(ze=he.stateNode.containerInfo,ze===H||ze.nodeType===8&&ze.parentNode===H))return;he=he.return}for(;ke!==null;){if(he=U0(ke),he===null)return;if(ze=he.tag,ze===5||ze===6){D=Q=he;continue e}ke=ke.parentNode}}D=D.return}Qi(function(){var Ct=Q,Qt=je(E),cn=[];e:{var Zt=f4.get(d);if(Zt!==void 0){var Dn=Ia,zn=d;switch(d){case"keypress":if(Yf(E)===0)break e;case"keydown":case"keyup":Dn=Ao;break;case"focusin":zn="focus",Dn=L0;break;case"focusout":zn="blur",Dn=L0;break;case"beforeblur":case"afterblur":Dn=L0;break;case"click":if(E.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Dn=Vs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Dn=Zf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Dn=o2;break;case h4:case d4:case G1:Dn=r2;break;case j1:Dn=a2;break;case"scroll":Dn=pd;break;case"wheel":Dn=l2;break;case"copy":case"cut":case"paste":Dn=O1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Dn=yd}var Hn=(g&4)!==0,Ns=!Hn&&d==="scroll",yt=Hn?Zt!==null?Zt+"Capture":null:Zt;Hn=[];for(var Qe=Ct,St;Qe!==null;){St=Qe;var fn=St.stateNode;if(St.tag===5&&fn!==null&&(St=fn,yt!==null&&(fn=Eo(Qe,yt),fn!=null&&Hn.push(up(Qe,fn,St)))),Ns)break;Qe=Qe.return}0<Hn.length&&(Zt=new Dn(Zt,zn,null,E,Qt),cn.push({event:Zt,listeners:Hn}))}}if((g&7)===0){e:{if(Zt=d==="mouseover"||d==="pointerover",Dn=d==="mouseout"||d==="pointerout",Zt&&E!==tr&&(zn=E.relatedTarget||E.fromElement)&&(U0(zn)||zn[ka]))break e;if((Dn||Zt)&&(Zt=Qt.window===Qt?Qt:(Zt=Qt.ownerDocument)?Zt.defaultView||Zt.parentWindow:window,Dn?(zn=E.relatedTarget||E.toElement,Dn=Ct,zn=zn?U0(zn):null,zn!==null&&(Ns=ao(zn),zn!==Ns||zn.tag!==5&&zn.tag!==6)&&(zn=null)):(Dn=null,zn=Ct),Dn!==zn)){if(Hn=Vs,fn="onMouseLeave",yt="onMouseEnter",Qe="mouse",(d==="pointerout"||d==="pointerover")&&(Hn=yd,fn="onPointerLeave",yt="onPointerEnter",Qe="pointer"),Ns=Dn==null?Zt:pu(Dn),St=zn==null?Zt:pu(zn),Zt=new Hn(fn,Qe+"leave",Dn,E,Qt),Zt.target=Ns,Zt.relatedTarget=St,fn=null,U0(Qt)===Ct&&(Hn=new Hn(yt,Qe+"enter",zn,E,Qt),Hn.target=St,Hn.relatedTarget=Ns,fn=Hn),Ns=fn,Dn&&zn)t:{for(Hn=Dn,yt=zn,Qe=0,St=Hn;St;St=Sd(St))Qe++;for(St=0,fn=yt;fn;fn=Sd(fn))St++;for(;0<Qe-St;)Hn=Sd(Hn),Qe--;for(;0<St-Qe;)yt=Sd(yt),St--;for(;Qe--;){if(Hn===yt||yt!==null&&Hn===yt.alternate)break t;Hn=Sd(Hn),yt=Sd(yt)}Hn=null}else Hn=null;Dn!==null&&y4(cn,Zt,Dn,Hn,!1),zn!==null&&Ns!==null&&y4(cn,Ns,zn,Hn,!0)}}e:{if(Zt=Ct?pu(Ct):window,Dn=Zt.nodeName&&Zt.nodeName.toLowerCase(),Dn==="select"||Dn==="input"&&Zt.type==="file")var er=np;else if(U1(Zt))if(h2)er=_d;else{er=Uo;var dr=bi}else(Dn=Zt.nodeName)&&Dn.toLowerCase()==="input"&&(Zt.type==="checkbox"||Zt.type==="radio")&&(er=a0);if(er&&(er=er(d,Ct))){fh(cn,er,E,Qt);break e}dr&&dr(d,Zt,Ct),d==="focusout"&&(dr=Zt._wrapperState)&&dr.controlled&&Zt.type==="number"&&Yr(Zt,"number",Zt.value)}switch(dr=Ct?pu(Ct):window,d){case"focusin":(U1(dr)||dr.contentEditable==="true")&&(Ol=dr,c4=Ct,ip=null);break;case"focusout":ip=c4=Ol=null;break;case"mousedown":z1=!0;break;case"contextmenu":case"mouseup":case"dragend":z1=!1,Ov(cn,E,Qt);break;case"selectionchange":if(f2)break;case"keydown":case"keyup":Ov(cn,E,Qt)}var mr;if(F1)e:{switch(d){case"compositionstart":var br="onCompositionStart";break e;case"compositionend":br="onCompositionEnd";break e;case"compositionupdate":br="onCompositionUpdate";break e}br=void 0}else hh?mi(d,E)&&(br="onCompositionEnd"):d==="keydown"&&E.keyCode===229&&(br="onCompositionStart");br&&(F0&&E.locale!=="ko"&&(hh||br!=="onCompositionStart"?br==="onCompositionEnd"&&hh&&(mr=D1()):(Al=Qt,Xf="value"in Al?Al.value:Al.textContent,hh=!0)),dr=$1(Ct,br),0<dr.length&&(br=new Qf(br,d,null,E,Qt),cn.push({event:br,listeners:dr}),mr?br.data=mr:(mr=hu(E),mr!==null&&(br.data=mr)))),(mr=uh?dh(d,E):xd(d,E))&&(Ct=$1(Ct,"onBeforeInput"),0<Ct.length&&(Qt=new Qf("onBeforeInput","beforeinput",null,E,Qt),cn.push({event:Qt,listeners:Ct}),Qt.data=mr))}W1(cn,g)})}function up(d,g,E){return{instance:d,listener:g,currentTarget:E}}function $1(d,g){for(var E=g+"Capture",D=[];d!==null;){var H=d,Q=H.stateNode;H.tag===5&&Q!==null&&(H=Q,Q=Eo(d,E),Q!=null&&D.unshift(up(d,Q,H)),Q=Eo(d,g),Q!=null&&D.push(up(d,Q,H))),d=d.return}return D}function Sd(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function y4(d,g,E,D,H){for(var Q=g._reactName,he=[];E!==null&&E!==D;){var ke=E,ze=ke.alternate,Ct=ke.stateNode;if(ze!==null&&ze===D)break;ke.tag===5&&Ct!==null&&(ke=Ct,H?(ze=Eo(E,Q),ze!=null&&he.unshift(up(E,ze,ke))):H||(ze=Eo(E,Q),ze!=null&&he.push(up(E,ze,ke)))),E=E.return}he.length!==0&&d.push({event:g,listeners:he})}var Fv=/\r\n?/g,Bv=/\u0000|\uFFFD/g;function x4(d){return(typeof d=="string"?d:""+d).replace(Fv,`
`).replace(Bv,"")}function q1(d,g,E){if(g=x4(g),x4(d)!==g&&E)throw Error(t(425))}function X1(){}var g2=null,v2=null;function y2(d,g){return d==="textarea"||d==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var x2=typeof setTimeout=="function"?setTimeout:void 0,Uv=typeof clearTimeout=="function"?clearTimeout:void 0,_4=typeof Promise=="function"?Promise:void 0,zv=typeof queueMicrotask=="function"?queueMicrotask:typeof _4<"u"?function(d){return _4.resolve(null).then(d).catch(Vv)}:x2;function Vv(d){setTimeout(function(){throw d})}function _2(d,g){var E=g,D=0;do{var H=E.nextSibling;if(d.removeChild(E),H&&H.nodeType===8)if(E=H.data,E==="/$"){if(D===0){d.removeChild(H),lh(g);return}D--}else E!=="$"&&E!=="$?"&&E!=="$!"||D++;E=H}while(E);lh(g)}function fu(d){for(;d!=null;d=d.nextSibling){var g=d.nodeType;if(g===1||g===3)break;if(g===8){if(g=d.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return d}function Ji(d){d=d.previousSibling;for(var g=0;d;){if(d.nodeType===8){var E=d.data;if(E==="$"||E==="$!"||E==="$?"){if(g===0)return d;g--}else E==="/$"&&g++}d=d.previousSibling}return null}var wd=Math.random().toString(36).slice(2),gi="__reactFiber$"+wd,Y1="__reactProps$"+wd,ka="__reactContainer$"+wd,Ed="__reactEvents$"+wd,K1="__reactListeners$"+wd,Td="__reactHandles$"+wd;function U0(d){var g=d[gi];if(g)return g;for(var E=d.parentNode;E;){if(g=E[ka]||E[gi]){if(E=g.alternate,g.child!==null||E!==null&&E.child!==null)for(d=Ji(d);d!==null;){if(E=d[gi])return E;d=Ji(d)}return g}d=E,E=d.parentNode}return null}function vh(d){return d=d[gi]||d[ka],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function pu(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(t(33))}function vc(d){return d[Y1]||null}var yc=[],mu=-1;function gu(d){return{current:d}}function Hi(d){0>mu||(d.current=yc[mu],yc[mu]=null,mu--)}function es(d,g){mu++,yc[mu]=d.current,d.current=g}var yh={},Vo=gu(yh),ta=gu(!1),vu=yh;function xh(d,g){var E=d.type.contextTypes;if(!E)return yh;var D=d.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===g)return D.__reactInternalMemoizedMaskedChildContext;var H={},Q;for(Q in E)H[Q]=g[Q];return D&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=g,d.__reactInternalMemoizedMaskedChildContext=H),H}function Na(d){return d=d.childContextTypes,d!=null}function hp(){Hi(ta),Hi(Vo)}function b4(d,g,E){if(Vo.current!==yh)throw Error(t(168));es(Vo,g),es(ta,E)}function S4(d,g,E){var D=d.stateNode;if(g=g.childContextTypes,typeof D.getChildContext!="function")return E;D=D.getChildContext();for(var H in D)if(!(H in g))throw Error(t(108,Gt(d)||"Unknown",H));return ut({},E,D)}function Z1(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||yh,vu=Vo.current,es(Vo,d),es(ta,ta.current),!0}function Gv(d,g,E){var D=d.stateNode;if(!D)throw Error(t(169));E?(d=S4(d,g,vu),D.__reactInternalMemoizedMergedChildContext=d,Hi(ta),Hi(Vo),es(Vo,d)):Hi(ta),es(ta,E)}var yu=null,xu=!1,b2=!1;function w4(d){yu===null?yu=[d]:yu.push(d)}function l_(d){xu=!0,w4(d)}function _h(){if(!b2&&yu!==null){b2=!0;var d=0,g=ti;try{var E=yu;for(ti=1;d<E.length;d++){var D=E[d];do D=D(!0);while(D!==null)}yu=null,xu=!1}catch(H){throw yu!==null&&(yu=yu.slice(d+1)),Vf(Kt,_h),H}finally{ti=g,b2=!1}}return null}var Ll=[],xc=0,S2=null,Md=0,z0=[],l0=0,bh=null,V0=1,_c="";function Cd(d,g){Ll[xc++]=Md,Ll[xc++]=S2,S2=d,Md=g}function jv(d,g,E){z0[l0++]=V0,z0[l0++]=_c,z0[l0++]=bh,bh=d;var D=V0;d=_c;var H=32-_r(D)-1;D&=~(1<<H),E+=1;var Q=32-_r(g)+H;if(30<Q){var he=H-H%5;Q=(D&(1<<he)-1).toString(32),D>>=he,H-=he,V0=1<<32-_r(g)+H|E<<H|D,_c=Q+d}else V0=1<<Q|E<<H|D,_c=d}function Ad(d){d.return!==null&&(Cd(d,1),jv(d,1,0))}function Q1(d){for(;d===S2;)S2=Ll[--xc],Ll[xc]=null,Md=Ll[--xc],Ll[xc]=null;for(;d===bh;)bh=z0[--l0],z0[l0]=null,_c=z0[--l0],z0[l0]=null,V0=z0[--l0],z0[l0]=null}var c0=null,Da=null,hs=!1,Oa=null;function J1(d,g){var E=W0(5,null,null,0);E.elementType="DELETED",E.stateNode=g,E.return=d,g=d.deletions,g===null?(d.deletions=[E],d.flags|=16):g.push(E)}function E4(d,g){switch(d.tag){case 5:var E=d.type;return g=g.nodeType!==1||E.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(d.stateNode=g,c0=d,Da=fu(g.firstChild),!0):!1;case 6:return g=d.pendingProps===""||g.nodeType!==3?null:g,g!==null?(d.stateNode=g,c0=d,Da=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(E=bh!==null?{id:V0,overflow:_c}:null,d.memoizedState={dehydrated:g,treeContext:E,retryLane:1073741824},E=W0(18,null,null,0),E.stateNode=g,E.return=d,d.child=E,c0=d,Da=null,!0):!1;default:return!1}}function Sh(d){return(d.mode&1)!==0&&(d.flags&128)===0}function dp(d){if(hs){var g=Da;if(g){var E=g;if(!E4(d,g)){if(Sh(d))throw Error(t(418));g=fu(E.nextSibling);var D=c0;g&&E4(d,g)?J1(D,E):(d.flags=d.flags&-4097|2,hs=!1,c0=d)}}else{if(Sh(d))throw Error(t(418));d.flags=d.flags&-4097|2,hs=!1,c0=d}}}function Hv(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;c0=d}function em(d){if(d!==c0)return!1;if(!hs)return Hv(d),hs=!0,!1;var g;if((g=d.tag!==3)&&!(g=d.tag!==5)&&(g=d.type,g=g!=="head"&&g!=="body"&&!y2(d.type,d.memoizedProps)),g&&(g=Da)){if(Sh(d))throw Wv(),Error(t(418));for(;g;)J1(d,g),g=fu(g.nextSibling)}if(Hv(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(t(317));e:{for(d=d.nextSibling,g=0;d;){if(d.nodeType===8){var E=d.data;if(E==="/$"){if(g===0){Da=fu(d.nextSibling);break e}g--}else E!=="$"&&E!=="$!"&&E!=="$?"||g++}d=d.nextSibling}Da=null}}else Da=c0?fu(d.stateNode.nextSibling):null;return!0}function Wv(){for(var d=Da;d;)d=fu(d.nextSibling)}function fp(){Da=c0=null,hs=!1}function w2(d){Oa===null?Oa=[d]:Oa.push(d)}var c_=P.ReactCurrentBatchConfig;function tm(d,g,E){if(d=E.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(t(309));var D=E.stateNode}if(!D)throw Error(t(147,d));var H=D,Q=""+d;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===Q?g.ref:(g=function(he){var ke=H.refs;he===null?delete ke[Q]:ke[Q]=he},g._stringRef=Q,g)}if(typeof d!="string")throw Error(t(284));if(!E._owner)throw Error(t(290,d))}return d}function nm(d,g){throw d=Object.prototype.toString.call(g),Error(t(31,d==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":d))}function rm(d){var g=d._init;return g(d._payload)}function T4(d){function g(yt,Qe){if(d){var St=yt.deletions;St===null?(yt.deletions=[Qe],yt.flags|=16):St.push(Qe)}}function E(yt,Qe){if(!d)return null;for(;Qe!==null;)g(yt,Qe),Qe=Qe.sibling;return null}function D(yt,Qe){for(yt=new Map;Qe!==null;)Qe.key!==null?yt.set(Qe.key,Qe):yt.set(Qe.index,Qe),Qe=Qe.sibling;return yt}function H(yt,Qe){return yt=Pc(yt,Qe),yt.index=0,yt.sibling=null,yt}function Q(yt,Qe,St){return yt.index=St,d?(St=yt.alternate,St!==null?(St=St.index,St<Qe?(yt.flags|=2,Qe):St):(yt.flags|=2,Qe)):(yt.flags|=1048576,Qe)}function he(yt){return d&&yt.alternate===null&&(yt.flags|=2),yt}function ke(yt,Qe,St,fn){return Qe===null||Qe.tag!==6?(Qe=y5(St,yt.mode,fn),Qe.return=yt,Qe):(Qe=H(Qe,St),Qe.return=yt,Qe)}function ze(yt,Qe,St,fn){var er=St.type;return er===ie?Qt(yt,Qe,St.props.children,fn,St.key):Qe!==null&&(Qe.elementType===er||typeof er=="object"&&er!==null&&er.$$typeof===de&&rm(er)===Qe.type)?(fn=H(Qe,St.props),fn.ref=tm(yt,Qe,St),fn.return=yt,fn):(fn=u9(St.type,St.key,St.props,null,yt.mode,fn),fn.ref=tm(yt,Qe,St),fn.return=yt,fn)}function Ct(yt,Qe,St,fn){return Qe===null||Qe.tag!==4||Qe.stateNode.containerInfo!==St.containerInfo||Qe.stateNode.implementation!==St.implementation?(Qe=x5(St,yt.mode,fn),Qe.return=yt,Qe):(Qe=H(Qe,St.children||[]),Qe.return=yt,Qe)}function Qt(yt,Qe,St,fn,er){return Qe===null||Qe.tag!==7?(Qe=Fd(St,yt.mode,fn,er),Qe.return=yt,Qe):(Qe=H(Qe,St),Qe.return=yt,Qe)}function cn(yt,Qe,St){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return Qe=y5(""+Qe,yt.mode,St),Qe.return=yt,Qe;if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case te:return St=u9(Qe.type,Qe.key,Qe.props,null,yt.mode,St),St.ref=tm(yt,null,Qe),St.return=yt,St;case oe:return Qe=x5(Qe,yt.mode,St),Qe.return=yt,Qe;case de:var fn=Qe._init;return cn(yt,fn(Qe._payload),St)}if(Yn(Qe)||rt(Qe))return Qe=Fd(Qe,yt.mode,St,null),Qe.return=yt,Qe;nm(yt,Qe)}return null}function Zt(yt,Qe,St,fn){var er=Qe!==null?Qe.key:null;if(typeof St=="string"&&St!==""||typeof St=="number")return er!==null?null:ke(yt,Qe,""+St,fn);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case te:return St.key===er?ze(yt,Qe,St,fn):null;case oe:return St.key===er?Ct(yt,Qe,St,fn):null;case de:return er=St._init,Zt(yt,Qe,er(St._payload),fn)}if(Yn(St)||rt(St))return er!==null?null:Qt(yt,Qe,St,fn,null);nm(yt,St)}return null}function Dn(yt,Qe,St,fn,er){if(typeof fn=="string"&&fn!==""||typeof fn=="number")return yt=yt.get(St)||null,ke(Qe,yt,""+fn,er);if(typeof fn=="object"&&fn!==null){switch(fn.$$typeof){case te:return yt=yt.get(fn.key===null?St:fn.key)||null,ze(Qe,yt,fn,er);case oe:return yt=yt.get(fn.key===null?St:fn.key)||null,Ct(Qe,yt,fn,er);case de:var dr=fn._init;return Dn(yt,Qe,St,dr(fn._payload),er)}if(Yn(fn)||rt(fn))return yt=yt.get(St)||null,Qt(Qe,yt,fn,er,null);nm(Qe,fn)}return null}function zn(yt,Qe,St,fn){for(var er=null,dr=null,mr=Qe,br=Qe=0,fo=null;mr!==null&&br<St.length;br++){mr.index>br?(fo=mr,mr=null):fo=mr.sibling;var wi=Zt(yt,mr,St[br],fn);if(wi===null){mr===null&&(mr=fo);break}d&&mr&&wi.alternate===null&&g(yt,mr),Qe=Q(wi,Qe,br),dr===null?er=wi:dr.sibling=wi,dr=wi,mr=fo}if(br===St.length)return E(yt,mr),hs&&Cd(yt,br),er;if(mr===null){for(;br<St.length;br++)mr=cn(yt,St[br],fn),mr!==null&&(Qe=Q(mr,Qe,br),dr===null?er=mr:dr.sibling=mr,dr=mr);return hs&&Cd(yt,br),er}for(mr=D(yt,mr);br<St.length;br++)fo=Dn(mr,yt,br,St[br],fn),fo!==null&&(d&&fo.alternate!==null&&mr.delete(fo.key===null?br:fo.key),Qe=Q(fo,Qe,br),dr===null?er=fo:dr.sibling=fo,dr=fo);return d&&mr.forEach(function(Rc){return g(yt,Rc)}),hs&&Cd(yt,br),er}function Hn(yt,Qe,St,fn){var er=rt(St);if(typeof er!="function")throw Error(t(150));if(St=er.call(St),St==null)throw Error(t(151));for(var dr=er=null,mr=Qe,br=Qe=0,fo=null,wi=St.next();mr!==null&&!wi.done;br++,wi=St.next()){mr.index>br?(fo=mr,mr=null):fo=mr.sibling;var Rc=Zt(yt,mr,wi.value,fn);if(Rc===null){mr===null&&(mr=fo);break}d&&mr&&Rc.alternate===null&&g(yt,mr),Qe=Q(Rc,Qe,br),dr===null?er=Rc:dr.sibling=Rc,dr=Rc,mr=fo}if(wi.done)return E(yt,mr),hs&&Cd(yt,br),er;if(mr===null){for(;!wi.done;br++,wi=St.next())wi=cn(yt,wi.value,fn),wi!==null&&(Qe=Q(wi,Qe,br),dr===null?er=wi:dr.sibling=wi,dr=wi);return hs&&Cd(yt,br),er}for(mr=D(yt,mr);!wi.done;br++,wi=St.next())wi=Dn(mr,yt,br,wi.value,fn),wi!==null&&(d&&wi.alternate!==null&&mr.delete(wi.key===null?br:wi.key),Qe=Q(wi,Qe,br),dr===null?er=wi:dr.sibling=wi,dr=wi);return d&&mr.forEach(function(yy){return g(yt,yy)}),hs&&Cd(yt,br),er}function Ns(yt,Qe,St,fn){if(typeof St=="object"&&St!==null&&St.type===ie&&St.key===null&&(St=St.props.children),typeof St=="object"&&St!==null){switch(St.$$typeof){case te:e:{for(var er=St.key,dr=Qe;dr!==null;){if(dr.key===er){if(er=St.type,er===ie){if(dr.tag===7){E(yt,dr.sibling),Qe=H(dr,St.props.children),Qe.return=yt,yt=Qe;break e}}else if(dr.elementType===er||typeof er=="object"&&er!==null&&er.$$typeof===de&&rm(er)===dr.type){E(yt,dr.sibling),Qe=H(dr,St.props),Qe.ref=tm(yt,dr,St),Qe.return=yt,yt=Qe;break e}E(yt,dr);break}else g(yt,dr);dr=dr.sibling}St.type===ie?(Qe=Fd(St.props.children,yt.mode,fn,St.key),Qe.return=yt,yt=Qe):(fn=u9(St.type,St.key,St.props,null,yt.mode,fn),fn.ref=tm(yt,Qe,St),fn.return=yt,yt=fn)}return he(yt);case oe:e:{for(dr=St.key;Qe!==null;){if(Qe.key===dr)if(Qe.tag===4&&Qe.stateNode.containerInfo===St.containerInfo&&Qe.stateNode.implementation===St.implementation){E(yt,Qe.sibling),Qe=H(Qe,St.children||[]),Qe.return=yt,yt=Qe;break e}else{E(yt,Qe);break}else g(yt,Qe);Qe=Qe.sibling}Qe=x5(St,yt.mode,fn),Qe.return=yt,yt=Qe}return he(yt);case de:return dr=St._init,Ns(yt,Qe,dr(St._payload),fn)}if(Yn(St))return zn(yt,Qe,St,fn);if(rt(St))return Hn(yt,Qe,St,fn);nm(yt,St)}return typeof St=="string"&&St!==""||typeof St=="number"?(St=""+St,Qe!==null&&Qe.tag===6?(E(yt,Qe.sibling),Qe=H(Qe,St),Qe.return=yt,yt=Qe):(E(yt,Qe),Qe=y5(St,yt.mode,fn),Qe.return=yt,yt=Qe),he(yt)):E(yt,Qe)}return Ns}var Pd=T4(!0),M4=T4(!1),E2=gu(null),im=null,Rd=null,T2=null;function C4(){T2=Rd=im=null}function A4(d){var g=E2.current;Hi(E2),d._currentValue=g}function pp(d,g,E){for(;d!==null;){var D=d.alternate;if((d.childLanes&g)!==g?(d.childLanes|=g,D!==null&&(D.childLanes|=g)):D!==null&&(D.childLanes&g)!==g&&(D.childLanes|=g),d===E)break;d=d.return}}function _u(d,g){im=d,T2=Rd=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&g)!==0&&(La=!0),d.firstContext=null)}function G0(d){var g=d._currentValue;if(T2!==d)if(d={context:d,memoizedValue:g,next:null},Rd===null){if(im===null)throw Error(t(308));Rd=d,im.dependencies={lanes:0,firstContext:d}}else Rd=Rd.next=d;return g}var u0=null;function mp(d){u0===null?u0=[d]:u0.push(d)}function P4(d,g,E,D){var H=g.interleaved;return H===null?(E.next=E,mp(g)):(E.next=H.next,H.next=E),g.interleaved=E,bu(d,D)}function bu(d,g){d.lanes|=g;var E=d.alternate;for(E!==null&&(E.lanes|=g),E=d,d=d.return;d!==null;)d.childLanes|=g,E=d.alternate,E!==null&&(E.childLanes|=g),E=d,d=d.return;return E.tag===3?E.stateNode:null}var bc=!1;function M2(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $v(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function h0(d,g){return{eventTime:d,lane:g,tag:0,payload:null,callback:null,next:null}}function Fl(d,g,E){var D=d.updateQueue;if(D===null)return null;if(D=D.shared,(Si&2)!==0){var H=D.pending;return H===null?g.next=g:(g.next=H.next,H.next=g),D.pending=g,bu(d,E)}return H=D.interleaved,H===null?(g.next=g,mp(D)):(g.next=H.next,H.next=g),D.interleaved=g,bu(d,E)}function C2(d,g,E){if(g=g.updateQueue,g!==null&&(g=g.shared,(E&4194240)!==0)){var D=g.lanes;D&=d.pendingLanes,E|=D,g.lanes=E,ks(d,E)}}function R4(d,g){var E=d.updateQueue,D=d.alternate;if(D!==null&&(D=D.updateQueue,E===D)){var H=null,Q=null;if(E=E.firstBaseUpdate,E!==null){do{var he={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};Q===null?H=Q=he:Q=Q.next=he,E=E.next}while(E!==null);Q===null?H=Q=g:Q=Q.next=g}else H=Q=g;E={baseState:D.baseState,firstBaseUpdate:H,lastBaseUpdate:Q,shared:D.shared,effects:D.effects},d.updateQueue=E;return}d=E.lastBaseUpdate,d===null?E.firstBaseUpdate=g:d.next=g,E.lastBaseUpdate=g}function sm(d,g,E,D){var H=d.updateQueue;bc=!1;var Q=H.firstBaseUpdate,he=H.lastBaseUpdate,ke=H.shared.pending;if(ke!==null){H.shared.pending=null;var ze=ke,Ct=ze.next;ze.next=null,he===null?Q=Ct:he.next=Ct,he=ze;var Qt=d.alternate;Qt!==null&&(Qt=Qt.updateQueue,ke=Qt.lastBaseUpdate,ke!==he&&(ke===null?Qt.firstBaseUpdate=Ct:ke.next=Ct,Qt.lastBaseUpdate=ze))}if(Q!==null){var cn=H.baseState;he=0,Qt=Ct=ze=null,ke=Q;do{var Zt=ke.lane,Dn=ke.eventTime;if((D&Zt)===Zt){Qt!==null&&(Qt=Qt.next={eventTime:Dn,lane:0,tag:ke.tag,payload:ke.payload,callback:ke.callback,next:null});e:{var zn=d,Hn=ke;switch(Zt=g,Dn=E,Hn.tag){case 1:if(zn=Hn.payload,typeof zn=="function"){cn=zn.call(Dn,cn,Zt);break e}cn=zn;break e;case 3:zn.flags=zn.flags&-65537|128;case 0:if(zn=Hn.payload,Zt=typeof zn=="function"?zn.call(Dn,cn,Zt):zn,Zt==null)break e;cn=ut({},cn,Zt);break e;case 2:bc=!0}}ke.callback!==null&&ke.lane!==0&&(d.flags|=64,Zt=H.effects,Zt===null?H.effects=[ke]:Zt.push(ke))}else Dn={eventTime:Dn,lane:Zt,tag:ke.tag,payload:ke.payload,callback:ke.callback,next:null},Qt===null?(Ct=Qt=Dn,ze=cn):Qt=Qt.next=Dn,he|=Zt;if(ke=ke.next,ke===null){if(ke=H.shared.pending,ke===null)break;Zt=ke,ke=Zt.next,Zt.next=null,H.lastBaseUpdate=Zt,H.shared.pending=null}}while(!0);if(Qt===null&&(ze=cn),H.baseState=ze,H.firstBaseUpdate=Ct,H.lastBaseUpdate=Qt,g=H.shared.interleaved,g!==null){H=g;do he|=H.lane,H=H.next;while(H!==g)}else Q===null&&(H.shared.lanes=0);Ah|=he,d.lanes=he,d.memoizedState=cn}}function I4(d,g,E){if(d=g.effects,g.effects=null,d!==null)for(g=0;g<d.length;g++){var D=d[g],H=D.callback;if(H!==null){if(D.callback=null,D=E,typeof H!="function")throw Error(t(191,H));H.call(D)}}}var om={},Sc=gu(om),gp=gu(om),am=gu(om);function wh(d){if(d===om)throw Error(t(174));return d}function A2(d,g){switch(es(am,g),es(gp,d),es(Sc,om),d=g.nodeType,d){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:qt(null,"");break;default:d=d===8?g.parentNode:g,g=d.namespaceURI||null,d=d.tagName,g=qt(g,d)}Hi(Sc),es(Sc,g)}function vp(){Hi(Sc),Hi(gp),Hi(am)}function qv(d){wh(am.current);var g=wh(Sc.current),E=qt(g,d.type);g!==E&&(es(gp,d),es(Sc,E))}function P2(d){gp.current===d&&(Hi(Sc),Hi(gp))}var Cs=gu(0);function Su(d){for(var g=d;g!==null;){if(g.tag===13){var E=g.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||E.data==="$?"||E.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Id=[];function yp(){for(var d=0;d<Id.length;d++)Id[d]._workInProgressVersionPrimary=null;Id.length=0}var lm=P.ReactCurrentDispatcher,Eh=P.ReactCurrentBatchConfig,wu=0,Wi=null,bs=null,Po=null,R2=!1,xp=!1,cm=0,Xv=0;function Gs(){throw Error(t(321))}function _p(d,g){if(g===null)return!1;for(var E=0;E<g.length&&E<d.length;E++)if(!zo(d[E],g[E]))return!1;return!0}function I2(d,g,E,D,H,Q){if(wu=Q,Wi=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,lm.current=d===null||d.memoizedState===null?Ep:u_,d=E(D,H),xp){Q=0;do{if(xp=!1,cm=0,25<=Q)throw Error(t(301));Q+=1,Po=bs=null,g.updateQueue=null,lm.current=V2,d=E(D,H)}while(xp)}if(lm.current=Ec,g=bs!==null&&bs.next!==null,wu=0,Po=bs=Wi=null,R2=!1,g)throw Error(t(300));return d}function um(){var d=cm!==0;return cm=0,d}function wc(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Po===null?Wi.memoizedState=Po=d:Po=Po.next=d,Po}function j0(){if(bs===null){var d=Wi.alternate;d=d!==null?d.memoizedState:null}else d=bs.next;var g=Po===null?Wi.memoizedState:Po.next;if(g!==null)Po=g,bs=d;else{if(d===null)throw Error(t(310));bs=d,d={memoizedState:bs.memoizedState,baseState:bs.baseState,baseQueue:bs.baseQueue,queue:bs.queue,next:null},Po===null?Wi.memoizedState=Po=d:Po=Po.next=d}return Po}function bp(d,g){return typeof g=="function"?g(d):g}function k4(d){var g=j0(),E=g.queue;if(E===null)throw Error(t(311));E.lastRenderedReducer=d;var D=bs,H=D.baseQueue,Q=E.pending;if(Q!==null){if(H!==null){var he=H.next;H.next=Q.next,Q.next=he}D.baseQueue=H=Q,E.pending=null}if(H!==null){Q=H.next,D=D.baseState;var ke=he=null,ze=null,Ct=Q;do{var Qt=Ct.lane;if((wu&Qt)===Qt)ze!==null&&(ze=ze.next={lane:0,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null}),D=Ct.hasEagerState?Ct.eagerState:d(D,Ct.action);else{var cn={lane:Qt,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null};ze===null?(ke=ze=cn,he=D):ze=ze.next=cn,Wi.lanes|=Qt,Ah|=Qt}Ct=Ct.next}while(Ct!==null&&Ct!==Q);ze===null?he=D:ze.next=ke,zo(D,g.memoizedState)||(La=!0),g.memoizedState=D,g.baseState=he,g.baseQueue=ze,E.lastRenderedState=D}if(d=E.interleaved,d!==null){H=d;do Q=H.lane,Wi.lanes|=Q,Ah|=Q,H=H.next;while(H!==d)}else H===null&&(E.lanes=0);return[g.memoizedState,E.dispatch]}function N4(d){var g=j0(),E=g.queue;if(E===null)throw Error(t(311));E.lastRenderedReducer=d;var D=E.dispatch,H=E.pending,Q=g.memoizedState;if(H!==null){E.pending=null;var he=H=H.next;do Q=d(Q,he.action),he=he.next;while(he!==H);zo(Q,g.memoizedState)||(La=!0),g.memoizedState=Q,g.baseQueue===null&&(g.baseState=Q),E.lastRenderedState=Q}return[Q,D]}function k2(){}function Yv(d,g){var E=Wi,D=j0(),H=g(),Q=!zo(D.memoizedState,H);if(Q&&(D.memoizedState=H,La=!0),D=D.queue,O2(Zv.bind(null,E,D,d),[d]),D.getSnapshot!==g||Q||Po!==null&&Po.memoizedState.tag&1){if(E.flags|=2048,kd(9,N2.bind(null,E,D,H,g),void 0,null),ho===null)throw Error(t(349));(wu&30)!==0||Kv(E,g,H)}return H}function Kv(d,g,E){d.flags|=16384,d={getSnapshot:g,value:E},g=Wi.updateQueue,g===null?(g={lastEffect:null,stores:null},Wi.updateQueue=g,g.stores=[d]):(E=g.stores,E===null?g.stores=[d]:E.push(d))}function N2(d,g,E,D){g.value=E,g.getSnapshot=D,Eu(g)&&Sp(d)}function Zv(d,g,E){return E(function(){Eu(g)&&Sp(d)})}function Eu(d){var g=d.getSnapshot;d=d.value;try{var E=g();return!zo(d,E)}catch{return!0}}function Sp(d){var g=bu(d,1);g!==null&&p0(g,d,1,-1)}function D2(d){var g=wc();return typeof d=="function"&&(d=d()),g.memoizedState=g.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bp,lastRenderedState:d},g.queue=d,d=d.dispatch=fm.bind(null,Wi,d),[g.memoizedState,d]}function kd(d,g,E,D){return d={tag:d,create:g,destroy:E,deps:D,next:null},g=Wi.updateQueue,g===null?(g={lastEffect:null,stores:null},Wi.updateQueue=g,g.lastEffect=d.next=d):(E=g.lastEffect,E===null?g.lastEffect=d.next=d:(D=E.next,E.next=d,d.next=D,g.lastEffect=d)),d}function D4(){return j0().memoizedState}function Nd(d,g,E,D){var H=wc();Wi.flags|=d,H.memoizedState=kd(1|g,E,void 0,D===void 0?null:D)}function hm(d,g,E,D){var H=j0();D=D===void 0?null:D;var Q=void 0;if(bs!==null){var he=bs.memoizedState;if(Q=he.destroy,D!==null&&_p(D,he.deps)){H.memoizedState=kd(g,E,Q,D);return}}Wi.flags|=d,H.memoizedState=kd(1|g,E,Q,D)}function Qv(d,g){return Nd(8390656,8,d,g)}function O2(d,g){return hm(2048,8,d,g)}function L2(d,g){return hm(4,2,d,g)}function Jv(d,g){return hm(4,4,d,g)}function dm(d,g){if(typeof g=="function")return d=d(),g(d),function(){g(null)};if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function O4(d,g,E){return E=E!=null?E.concat([d]):null,hm(4,4,dm.bind(null,g,d),E)}function F2(){}function L4(d,g){var E=j0();g=g===void 0?null:g;var D=E.memoizedState;return D!==null&&g!==null&&_p(g,D[1])?D[0]:(E.memoizedState=[d,g],d)}function B2(d,g){var E=j0();g=g===void 0?null:g;var D=E.memoizedState;return D!==null&&g!==null&&_p(g,D[1])?D[0]:(d=d(),E.memoizedState=[d,g],d)}function ey(d,g,E){return(wu&21)===0?(d.baseState&&(d.baseState=!1,La=!0),d.memoizedState=E):(zo(E,g)||(E=Li(),Wi.lanes|=E,Ah|=E,d.baseState=!0),g)}function wp(d,g){var E=ti;ti=E!==0&&4>E?E:4,d(!0);var D=Eh.transition;Eh.transition={};try{d(!1),g()}finally{ti=E,Eh.transition=D}}function F4(){return j0().memoizedState}function B4(d,g,E){var D=Ac(d);if(E={lane:D,action:E,hasEagerState:!1,eagerState:null,next:null},U2(d))U4(g,E);else if(E=P4(d,g,E,D),E!==null){var H=js();p0(E,d,D,H),z2(E,g,D)}}function fm(d,g,E){var D=Ac(d),H={lane:D,action:E,hasEagerState:!1,eagerState:null,next:null};if(U2(d))U4(g,H);else{var Q=d.alternate;if(d.lanes===0&&(Q===null||Q.lanes===0)&&(Q=g.lastRenderedReducer,Q!==null))try{var he=g.lastRenderedState,ke=Q(he,E);if(H.hasEagerState=!0,H.eagerState=ke,zo(ke,he)){var ze=g.interleaved;ze===null?(H.next=H,mp(g)):(H.next=ze.next,ze.next=H),g.interleaved=H;return}}catch{}finally{}E=P4(d,g,H,D),E!==null&&(H=js(),p0(E,d,D,H),z2(E,g,D))}}function U2(d){var g=d.alternate;return d===Wi||g!==null&&g===Wi}function U4(d,g){xp=R2=!0;var E=d.pending;E===null?g.next=g:(g.next=E.next,E.next=g),d.pending=g}function z2(d,g,E){if((E&4194240)!==0){var D=g.lanes;D&=d.pendingLanes,E|=D,g.lanes=E,ks(d,E)}}var Ec={readContext:G0,useCallback:Gs,useContext:Gs,useEffect:Gs,useImperativeHandle:Gs,useInsertionEffect:Gs,useLayoutEffect:Gs,useMemo:Gs,useReducer:Gs,useRef:Gs,useState:Gs,useDebugValue:Gs,useDeferredValue:Gs,useTransition:Gs,useMutableSource:Gs,useSyncExternalStore:Gs,useId:Gs,unstable_isNewReconciler:!1},Ep={readContext:G0,useCallback:function(d,g){return wc().memoizedState=[d,g===void 0?null:g],d},useContext:G0,useEffect:Qv,useImperativeHandle:function(d,g,E){return E=E!=null?E.concat([d]):null,Nd(4194308,4,dm.bind(null,g,d),E)},useLayoutEffect:function(d,g){return Nd(4194308,4,d,g)},useInsertionEffect:function(d,g){return Nd(4,2,d,g)},useMemo:function(d,g){var E=wc();return g=g===void 0?null:g,d=d(),E.memoizedState=[d,g],d},useReducer:function(d,g,E){var D=wc();return g=E!==void 0?E(g):g,D.memoizedState=D.baseState=g,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:g},D.queue=d,d=d.dispatch=B4.bind(null,Wi,d),[D.memoizedState,d]},useRef:function(d){var g=wc();return d={current:d},g.memoizedState=d},useState:D2,useDebugValue:F2,useDeferredValue:function(d){return wc().memoizedState=d},useTransition:function(){var d=D2(!1),g=d[0];return d=wp.bind(null,d[1]),wc().memoizedState=d,[g,d]},useMutableSource:function(){},useSyncExternalStore:function(d,g,E){var D=Wi,H=wc();if(hs){if(E===void 0)throw Error(t(407));E=E()}else{if(E=g(),ho===null)throw Error(t(349));(wu&30)!==0||Kv(D,g,E)}H.memoizedState=E;var Q={value:E,getSnapshot:g};return H.queue=Q,Qv(Zv.bind(null,D,Q,d),[d]),D.flags|=2048,kd(9,N2.bind(null,D,Q,E,g),void 0,null),E},useId:function(){var d=wc(),g=ho.identifierPrefix;if(hs){var E=_c,D=V0;E=(D&~(1<<32-_r(D)-1)).toString(32)+E,g=":"+g+"R"+E,E=cm++,0<E&&(g+="H"+E.toString(32)),g+=":"}else E=Xv++,g=":"+g+"r"+E.toString(32)+":";return d.memoizedState=g},unstable_isNewReconciler:!1},u_={readContext:G0,useCallback:L4,useContext:G0,useEffect:O2,useImperativeHandle:O4,useInsertionEffect:L2,useLayoutEffect:Jv,useMemo:B2,useReducer:k4,useRef:D4,useState:function(){return k4(bp)},useDebugValue:F2,useDeferredValue:function(d){var g=j0();return ey(g,bs.memoizedState,d)},useTransition:function(){var d=k4(bp)[0],g=j0().memoizedState;return[d,g]},useMutableSource:k2,useSyncExternalStore:Yv,useId:F4,unstable_isNewReconciler:!1},V2={readContext:G0,useCallback:L4,useContext:G0,useEffect:O2,useImperativeHandle:O4,useInsertionEffect:L2,useLayoutEffect:Jv,useMemo:B2,useReducer:N4,useRef:D4,useState:function(){return N4(bp)},useDebugValue:F2,useDeferredValue:function(d){var g=j0();return bs===null?g.memoizedState=d:ey(g,bs.memoizedState,d)},useTransition:function(){var d=N4(bp)[0],g=j0().memoizedState;return[d,g]},useMutableSource:k2,useSyncExternalStore:Yv,useId:F4,unstable_isNewReconciler:!1};function d0(d,g){if(d&&d.defaultProps){g=ut({},g),d=d.defaultProps;for(var E in d)g[E]===void 0&&(g[E]=d[E]);return g}return g}function z4(d,g,E,D){g=d.memoizedState,E=E(D,g),E=E==null?g:ut({},g,E),d.memoizedState=E,d.lanes===0&&(d.updateQueue.baseState=E)}var Tc={isMounted:function(d){return(d=d._reactInternals)?ao(d)===d:!1},enqueueSetState:function(d,g,E){d=d._reactInternals;var D=js(),H=Ac(d),Q=h0(D,H);Q.payload=g,E!=null&&(Q.callback=E),g=Fl(d,Q,H),g!==null&&(p0(g,d,H,D),C2(g,d,H))},enqueueReplaceState:function(d,g,E){d=d._reactInternals;var D=js(),H=Ac(d),Q=h0(D,H);Q.tag=1,Q.payload=g,E!=null&&(Q.callback=E),g=Fl(d,Q,H),g!==null&&(p0(g,d,H,D),C2(g,d,H))},enqueueForceUpdate:function(d,g){d=d._reactInternals;var E=js(),D=Ac(d),H=h0(E,D);H.tag=2,g!=null&&(H.callback=g),g=Fl(d,H,D),g!==null&&(p0(g,d,D,E),C2(g,d,D))}};function H0(d,g,E,D,H,Q,he){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(D,Q,he):g.prototype&&g.prototype.isPureReactComponent?!Dl(E,D)||!Dl(H,Q):!0}function Tp(d,g,E){var D=!1,H=yh,Q=g.contextType;return typeof Q=="object"&&Q!==null?Q=G0(Q):(H=Na(g)?vu:Vo.current,D=g.contextTypes,Q=(D=D!=null)?xh(d,H):yh),g=new g(E,Q),d.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Tc,d.stateNode=g,g._reactInternals=d,D&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=H,d.__reactInternalMemoizedMaskedChildContext=Q),g}function pm(d,g,E,D){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(E,D),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(E,D),g.state!==d&&Tc.enqueueReplaceState(g,g.state,null)}function mm(d,g,E,D){var H=d.stateNode;H.props=E,H.state=d.memoizedState,H.refs={},M2(d);var Q=g.contextType;typeof Q=="object"&&Q!==null?H.context=G0(Q):(Q=Na(g)?vu:Vo.current,H.context=xh(d,Q)),H.state=d.memoizedState,Q=g.getDerivedStateFromProps,typeof Q=="function"&&(z4(d,g,Q,E),H.state=d.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(g=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),g!==H.state&&Tc.enqueueReplaceState(H,H.state,null),sm(d,E,H,D),H.state=d.memoizedState),typeof H.componentDidMount=="function"&&(d.flags|=4194308)}function Mp(d,g){try{var E="",D=g;do E+=Pt(D),D=D.return;while(D);var H=E}catch(Q){H=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:d,source:g,stack:H,digest:null}}function gm(d,g,E){return{value:d,source:null,stack:E??null,digest:g??null}}function G2(d,g){try{console.error(g.value)}catch(E){setTimeout(function(){throw E})}}var j2=typeof WeakMap=="function"?WeakMap:Map;function V4(d,g,E){E=h0(-1,E),E.tag=3,E.payload={element:null};var D=g.value;return E.callback=function(){t9||(t9=!0,n9=D),G2(d,g)},E}function vm(d,g,E){E=h0(-1,E),E.tag=3;var D=d.type.getDerivedStateFromError;if(typeof D=="function"){var H=g.value;E.payload=function(){return D(H)},E.callback=function(){G2(d,g)}}var Q=d.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(E.callback=function(){G2(d,g),typeof D!="function"&&(Vl===null?Vl=new Set([this]):Vl.add(this));var he=g.stack;this.componentDidCatch(g.value,{componentStack:he!==null?he:""})}),E}function ty(d,g,E){var D=d.pingCache;if(D===null){D=d.pingCache=new j2;var H=new Set;D.set(g,H)}else H=D.get(g),H===void 0&&(H=new Set,D.set(g,H));H.has(E)||(H.add(E),d=m_.bind(null,d,g,E),g.then(d,d))}function G4(d){do{var g;if((g=d.tag===13)&&(g=d.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return d;d=d.return}while(d!==null);return null}function ym(d,g,E,D,H){return(d.mode&1)===0?(d===g?d.flags|=65536:(d.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(g=h0(-1,1),g.tag=2,Fl(E,g,1))),E.lanes|=1),d):(d.flags|=65536,d.lanes=H,d)}var j4=P.ReactCurrentOwner,La=!1;function Go(d,g,E,D){g.child=d===null?M4(g,null,E,D):Pd(g,d.child,E,D)}function H2(d,g,E,D,H){E=E.render;var Q=g.ref;return _u(g,H),D=I2(d,g,E,D,Q,H),E=um(),d!==null&&!La?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~H,Tu(d,g,H)):(hs&&E&&Ad(g),g.flags|=1,Go(d,g,D,H),g.child)}function H4(d,g,E,D,H){if(d===null){var Q=E.type;return typeof Q=="function"&&!Im(Q)&&Q.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(g.tag=15,g.type=Q,W2(d,g,Q,D,H)):(d=u9(E.type,null,D,g,g.mode,H),d.ref=g.ref,d.return=g,g.child=d)}if(Q=d.child,(d.lanes&H)===0){var he=Q.memoizedProps;if(E=E.compare,E=E!==null?E:Dl,E(he,D)&&d.ref===g.ref)return Tu(d,g,H)}return g.flags|=1,d=Pc(Q,D),d.ref=g.ref,d.return=g,g.child=d}function W2(d,g,E,D,H){if(d!==null){var Q=d.memoizedProps;if(Dl(Q,D)&&d.ref===g.ref)if(La=!1,g.pendingProps=D=Q,(d.lanes&H)!==0)(d.flags&131072)!==0&&(La=!0);else return g.lanes=d.lanes,Tu(d,g,H)}return Cp(d,g,E,D,H)}function W4(d,g,E){var D=g.pendingProps,H=D.children,Q=d!==null?d.memoizedState:null;if(D.mode==="hidden")if((g.mode&1)===0)g.memoizedState={baseLanes:0,cachePool:null,transitions:null},es(Mh,Ba),Ba|=E;else{if((E&1073741824)===0)return d=Q!==null?Q.baseLanes|E:E,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:d,cachePool:null,transitions:null},g.updateQueue=null,es(Mh,Ba),Ba|=d,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=Q!==null?Q.baseLanes:E,es(Mh,Ba),Ba|=D}else Q!==null?(D=Q.baseLanes|E,g.memoizedState=null):D=E,es(Mh,Ba),Ba|=D;return Go(d,g,H,E),g.child}function $4(d,g){var E=g.ref;(d===null&&E!==null||d!==null&&d.ref!==E)&&(g.flags|=512,g.flags|=2097152)}function Cp(d,g,E,D,H){var Q=Na(E)?vu:Vo.current;return Q=xh(g,Q),_u(g,H),E=I2(d,g,E,D,Q,H),D=um(),d!==null&&!La?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~H,Tu(d,g,H)):(hs&&D&&Ad(g),g.flags|=1,Go(d,g,E,H),g.child)}function q4(d,g,E,D,H){if(Na(E)){var Q=!0;Z1(g)}else Q=!1;if(_u(g,H),g.stateNode===null)xm(d,g),Tp(g,E,D),mm(g,E,D,H),D=!0;else if(d===null){var he=g.stateNode,ke=g.memoizedProps;he.props=ke;var ze=he.context,Ct=E.contextType;typeof Ct=="object"&&Ct!==null?Ct=G0(Ct):(Ct=Na(E)?vu:Vo.current,Ct=xh(g,Ct));var Qt=E.getDerivedStateFromProps,cn=typeof Qt=="function"||typeof he.getSnapshotBeforeUpdate=="function";cn||typeof he.UNSAFE_componentWillReceiveProps!="function"&&typeof he.componentWillReceiveProps!="function"||(ke!==D||ze!==Ct)&&pm(g,he,D,Ct),bc=!1;var Zt=g.memoizedState;he.state=Zt,sm(g,D,he,H),ze=g.memoizedState,ke!==D||Zt!==ze||ta.current||bc?(typeof Qt=="function"&&(z4(g,E,Qt,D),ze=g.memoizedState),(ke=bc||H0(g,E,ke,D,Zt,ze,Ct))?(cn||typeof he.UNSAFE_componentWillMount!="function"&&typeof he.componentWillMount!="function"||(typeof he.componentWillMount=="function"&&he.componentWillMount(),typeof he.UNSAFE_componentWillMount=="function"&&he.UNSAFE_componentWillMount()),typeof he.componentDidMount=="function"&&(g.flags|=4194308)):(typeof he.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=D,g.memoizedState=ze),he.props=D,he.state=ze,he.context=Ct,D=ke):(typeof he.componentDidMount=="function"&&(g.flags|=4194308),D=!1)}else{he=g.stateNode,$v(d,g),ke=g.memoizedProps,Ct=g.type===g.elementType?ke:d0(g.type,ke),he.props=Ct,cn=g.pendingProps,Zt=he.context,ze=E.contextType,typeof ze=="object"&&ze!==null?ze=G0(ze):(ze=Na(E)?vu:Vo.current,ze=xh(g,ze));var Dn=E.getDerivedStateFromProps;(Qt=typeof Dn=="function"||typeof he.getSnapshotBeforeUpdate=="function")||typeof he.UNSAFE_componentWillReceiveProps!="function"&&typeof he.componentWillReceiveProps!="function"||(ke!==cn||Zt!==ze)&&pm(g,he,D,ze),bc=!1,Zt=g.memoizedState,he.state=Zt,sm(g,D,he,H);var zn=g.memoizedState;ke!==cn||Zt!==zn||ta.current||bc?(typeof Dn=="function"&&(z4(g,E,Dn,D),zn=g.memoizedState),(Ct=bc||H0(g,E,Ct,D,Zt,zn,ze)||!1)?(Qt||typeof he.UNSAFE_componentWillUpdate!="function"&&typeof he.componentWillUpdate!="function"||(typeof he.componentWillUpdate=="function"&&he.componentWillUpdate(D,zn,ze),typeof he.UNSAFE_componentWillUpdate=="function"&&he.UNSAFE_componentWillUpdate(D,zn,ze)),typeof he.componentDidUpdate=="function"&&(g.flags|=4),typeof he.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof he.componentDidUpdate!="function"||ke===d.memoizedProps&&Zt===d.memoizedState||(g.flags|=4),typeof he.getSnapshotBeforeUpdate!="function"||ke===d.memoizedProps&&Zt===d.memoizedState||(g.flags|=1024),g.memoizedProps=D,g.memoizedState=zn),he.props=D,he.state=zn,he.context=ze,D=Ct):(typeof he.componentDidUpdate!="function"||ke===d.memoizedProps&&Zt===d.memoizedState||(g.flags|=4),typeof he.getSnapshotBeforeUpdate!="function"||ke===d.memoizedProps&&Zt===d.memoizedState||(g.flags|=1024),D=!1)}return X4(d,g,E,D,Q,H)}function X4(d,g,E,D,H,Q){$4(d,g);var he=(g.flags&128)!==0;if(!D&&!he)return H&&Gv(g,E,!1),Tu(d,g,Q);D=g.stateNode,j4.current=g;var ke=he&&typeof E.getDerivedStateFromError!="function"?null:D.render();return g.flags|=1,d!==null&&he?(g.child=Pd(g,d.child,null,Q),g.child=Pd(g,null,ke,Q)):Go(d,g,ke,Q),g.memoizedState=D.state,H&&Gv(g,E,!0),g.child}function Y4(d){var g=d.stateNode;g.pendingContext?b4(d,g.pendingContext,g.pendingContext!==g.context):g.context&&b4(d,g.context,!1),A2(d,g.containerInfo)}function K4(d,g,E,D,H){return fp(),w2(H),g.flags|=256,Go(d,g,E,D),g.child}var $2={dehydrated:null,treeContext:null,retryLane:0};function Z4(d){return{baseLanes:d,cachePool:null,transitions:null}}function ny(d,g,E){var D=g.pendingProps,H=Cs.current,Q=!1,he=(g.flags&128)!==0,ke;if((ke=he)||(ke=d!==null&&d.memoizedState===null?!1:(H&2)!==0),ke?(Q=!0,g.flags&=-129):(d===null||d.memoizedState!==null)&&(H|=1),es(Cs,H&1),d===null)return dp(g),d=g.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((g.mode&1)===0?g.lanes=1:d.data==="$!"?g.lanes=8:g.lanes=1073741824,null):(he=D.children,d=D.fallback,Q?(D=g.mode,Q=g.child,he={mode:"hidden",children:he},(D&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=he):Q=km(he,D,0,null),d=Fd(d,D,E,null),Q.return=g,d.return=g,Q.sibling=d,g.child=Q,g.child.memoizedState=Z4(E),g.memoizedState=$2,d):q2(g,he));if(H=d.memoizedState,H!==null&&(ke=H.dehydrated,ke!==null))return h_(d,g,he,D,ke,H,E);if(Q){Q=D.fallback,he=g.mode,H=d.child,ke=H.sibling;var ze={mode:"hidden",children:D.children};return(he&1)===0&&g.child!==H?(D=g.child,D.childLanes=0,D.pendingProps=ze,g.deletions=null):(D=Pc(H,ze),D.subtreeFlags=H.subtreeFlags&14680064),ke!==null?Q=Pc(ke,Q):(Q=Fd(Q,he,E,null),Q.flags|=2),Q.return=g,D.return=g,D.sibling=Q,g.child=D,D=Q,Q=g.child,he=d.child.memoizedState,he=he===null?Z4(E):{baseLanes:he.baseLanes|E,cachePool:null,transitions:he.transitions},Q.memoizedState=he,Q.childLanes=d.childLanes&~E,g.memoizedState=$2,D}return Q=d.child,d=Q.sibling,D=Pc(Q,{mode:"visible",children:D.children}),(g.mode&1)===0&&(D.lanes=E),D.return=g,D.sibling=null,d!==null&&(E=g.deletions,E===null?(g.deletions=[d],g.flags|=16):E.push(d)),g.child=D,g.memoizedState=null,D}function q2(d,g){return g=km({mode:"visible",children:g},d.mode,0,null),g.return=d,d.child=g}function X2(d,g,E,D){return D!==null&&w2(D),Pd(g,d.child,null,E),d=q2(g,g.pendingProps.children),d.flags|=2,g.memoizedState=null,d}function h_(d,g,E,D,H,Q,he){if(E)return g.flags&256?(g.flags&=-257,D=gm(Error(t(422))),X2(d,g,he,D)):g.memoizedState!==null?(g.child=d.child,g.flags|=128,null):(Q=D.fallback,H=g.mode,D=km({mode:"visible",children:D.children},H,0,null),Q=Fd(Q,H,he,null),Q.flags|=2,D.return=g,Q.return=g,D.sibling=Q,g.child=D,(g.mode&1)!==0&&Pd(g,d.child,null,he),g.child.memoizedState=Z4(he),g.memoizedState=$2,Q);if((g.mode&1)===0)return X2(d,g,he,null);if(H.data==="$!"){if(D=H.nextSibling&&H.nextSibling.dataset,D)var ke=D.dgst;return D=ke,Q=Error(t(419)),D=gm(Q,D,void 0),X2(d,g,he,D)}if(ke=(he&d.childLanes)!==0,La||ke){if(D=ho,D!==null){switch(he&-he){case 4:H=2;break;case 16:H=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:H=32;break;case 536870912:H=268435456;break;default:H=0}H=(H&(D.suspendedLanes|he))!==0?0:H,H!==0&&H!==Q.retryLane&&(Q.retryLane=H,bu(d,H),p0(D,d,H,-1))}return f5(),D=gm(Error(t(421))),X2(d,g,he,D)}return H.data==="$?"?(g.flags|=128,g.child=d.child,g=dy.bind(null,d),H._reactRetry=g,null):(d=Q.treeContext,Da=fu(H.nextSibling),c0=g,hs=!0,Oa=null,d!==null&&(z0[l0++]=V0,z0[l0++]=_c,z0[l0++]=bh,V0=d.id,_c=d.overflow,bh=g),g=q2(g,D.children),g.flags|=4096,g)}function Bi(d,g,E){d.lanes|=g;var D=d.alternate;D!==null&&(D.lanes|=g),pp(d.return,g,E)}function Dd(d,g,E,D,H){var Q=d.memoizedState;Q===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:D,tail:E,tailMode:H}:(Q.isBackwards=g,Q.rendering=null,Q.renderingStartTime=0,Q.last=D,Q.tail=E,Q.tailMode=H)}function ry(d,g,E){var D=g.pendingProps,H=D.revealOrder,Q=D.tail;if(Go(d,g,D.children,E),D=Cs.current,(D&2)!==0)D=D&1|2,g.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Bi(d,E,g);else if(d.tag===19)Bi(d,E,g);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}D&=1}if(es(Cs,D),(g.mode&1)===0)g.memoizedState=null;else switch(H){case"forwards":for(E=g.child,H=null;E!==null;)d=E.alternate,d!==null&&Su(d)===null&&(H=E),E=E.sibling;E=H,E===null?(H=g.child,g.child=null):(H=E.sibling,E.sibling=null),Dd(g,!1,H,E,Q);break;case"backwards":for(E=null,H=g.child,g.child=null;H!==null;){if(d=H.alternate,d!==null&&Su(d)===null){g.child=H;break}d=H.sibling,H.sibling=E,E=H,H=d}Dd(g,!0,E,null,Q);break;case"together":Dd(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function xm(d,g){(g.mode&1)===0&&d!==null&&(d.alternate=null,g.alternate=null,g.flags|=2)}function Tu(d,g,E){if(d!==null&&(g.dependencies=d.dependencies),Ah|=g.lanes,(E&g.childLanes)===0)return null;if(d!==null&&g.child!==d.child)throw Error(t(153));if(g.child!==null){for(d=g.child,E=Pc(d,d.pendingProps),g.child=E,E.return=g;d.sibling!==null;)d=d.sibling,E=E.sibling=Pc(d,d.pendingProps),E.return=g;E.sibling=null}return g.child}function d_(d,g,E){switch(g.tag){case 3:Y4(g),fp();break;case 5:qv(g);break;case 1:Na(g.type)&&Z1(g);break;case 4:A2(g,g.stateNode.containerInfo);break;case 10:var D=g.type._context,H=g.memoizedProps.value;es(E2,D._currentValue),D._currentValue=H;break;case 13:if(D=g.memoizedState,D!==null)return D.dehydrated!==null?(es(Cs,Cs.current&1),g.flags|=128,null):(E&g.child.childLanes)!==0?ny(d,g,E):(es(Cs,Cs.current&1),d=Tu(d,g,E),d!==null?d.sibling:null);es(Cs,Cs.current&1);break;case 19:if(D=(E&g.childLanes)!==0,(d.flags&128)!==0){if(D)return ry(d,g,E);g.flags|=128}if(H=g.memoizedState,H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),es(Cs,Cs.current),D)break;return null;case 22:case 23:return g.lanes=0,W4(d,g,E)}return Tu(d,g,E)}var Q4,J4,iy,e5;Q4=function(d,g){for(var E=g.child;E!==null;){if(E.tag===5||E.tag===6)d.appendChild(E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===g)break;for(;E.sibling===null;){if(E.return===null||E.return===g)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},J4=function(){},iy=function(d,g,E,D){var H=d.memoizedProps;if(H!==D){d=g.stateNode,wh(Sc.current);var Q=null;switch(E){case"input":H=Ue(d,H),D=Ue(d,D),Q=[];break;case"select":H=ut({},H,{value:void 0}),D=ut({},D,{value:void 0}),Q=[];break;case"textarea":H=Ci(d,H),D=Ci(d,D),Q=[];break;default:typeof H.onClick!="function"&&typeof D.onClick=="function"&&(d.onclick=X1)}Jn(E,D);var he;E=null;for(Ct in H)if(!D.hasOwnProperty(Ct)&&H.hasOwnProperty(Ct)&&H[Ct]!=null)if(Ct==="style"){var ke=H[Ct];for(he in ke)ke.hasOwnProperty(he)&&(E||(E={}),E[he]="")}else Ct!=="dangerouslySetInnerHTML"&&Ct!=="children"&&Ct!=="suppressContentEditableWarning"&&Ct!=="suppressHydrationWarning"&&Ct!=="autoFocus"&&(r.hasOwnProperty(Ct)?Q||(Q=[]):(Q=Q||[]).push(Ct,null));for(Ct in D){var ze=D[Ct];if(ke=H!=null?H[Ct]:void 0,D.hasOwnProperty(Ct)&&ze!==ke&&(ze!=null||ke!=null))if(Ct==="style")if(ke){for(he in ke)!ke.hasOwnProperty(he)||ze&&ze.hasOwnProperty(he)||(E||(E={}),E[he]="");for(he in ze)ze.hasOwnProperty(he)&&ke[he]!==ze[he]&&(E||(E={}),E[he]=ze[he])}else E||(Q||(Q=[]),Q.push(Ct,E)),E=ze;else Ct==="dangerouslySetInnerHTML"?(ze=ze?ze.__html:void 0,ke=ke?ke.__html:void 0,ze!=null&&ke!==ze&&(Q=Q||[]).push(Ct,ze)):Ct==="children"?typeof ze!="string"&&typeof ze!="number"||(Q=Q||[]).push(Ct,""+ze):Ct!=="suppressContentEditableWarning"&&Ct!=="suppressHydrationWarning"&&(r.hasOwnProperty(Ct)?(ze!=null&&Ct==="onScroll"&&us("scroll",d),Q||ke===ze||(Q=[])):(Q=Q||[]).push(Ct,ze))}E&&(Q=Q||[]).push("style",E);var Ct=Q;(g.updateQueue=Ct)&&(g.flags|=4)}},e5=function(d,g,E,D){E!==D&&(g.flags|=4)};function _m(d,g){if(!hs)switch(d.tailMode){case"hidden":g=d.tail;for(var E=null;g!==null;)g.alternate!==null&&(E=g),g=g.sibling;E===null?d.tail=null:E.sibling=null;break;case"collapsed":E=d.tail;for(var D=null;E!==null;)E.alternate!==null&&(D=E),E=E.sibling;D===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:D.sibling=null}}function na(d){var g=d.alternate!==null&&d.alternate.child===d.child,E=0,D=0;if(g)for(var H=d.child;H!==null;)E|=H.lanes|H.childLanes,D|=H.subtreeFlags&14680064,D|=H.flags&14680064,H.return=d,H=H.sibling;else for(H=d.child;H!==null;)E|=H.lanes|H.childLanes,D|=H.subtreeFlags,D|=H.flags,H.return=d,H=H.sibling;return d.subtreeFlags|=D,d.childLanes=E,g}function sy(d,g,E){var D=g.pendingProps;switch(Q1(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return na(g),null;case 1:return Na(g.type)&&hp(),na(g),null;case 3:return D=g.stateNode,vp(),Hi(ta),Hi(Vo),yp(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(d===null||d.child===null)&&(em(g)?g.flags|=4:d===null||d.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,Oa!==null&&(Cm(Oa),Oa=null))),J4(d,g),na(g),null;case 5:P2(g);var H=wh(am.current);if(E=g.type,d!==null&&g.stateNode!=null)iy(d,g,E,D,H),d.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!D){if(g.stateNode===null)throw Error(t(166));return na(g),null}if(d=wh(Sc.current),em(g)){D=g.stateNode,E=g.type;var Q=g.memoizedProps;switch(D[gi]=g,D[Y1]=Q,d=(g.mode&1)!==0,E){case"dialog":us("cancel",D),us("close",D);break;case"iframe":case"object":case"embed":us("load",D);break;case"video":case"audio":for(H=0;H<bd.length;H++)us(bd[H],D);break;case"source":us("error",D);break;case"img":case"image":case"link":us("error",D),us("load",D);break;case"details":us("toggle",D);break;case"input":Ii(D,Q),us("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!Q.multiple},us("invalid",D);break;case"textarea":Ie(D,Q),us("invalid",D)}Jn(E,Q),H=null;for(var he in Q)if(Q.hasOwnProperty(he)){var ke=Q[he];he==="children"?typeof ke=="string"?D.textContent!==ke&&(Q.suppressHydrationWarning!==!0&&q1(D.textContent,ke,d),H=["children",ke]):typeof ke=="number"&&D.textContent!==""+ke&&(Q.suppressHydrationWarning!==!0&&q1(D.textContent,ke,d),H=["children",""+ke]):r.hasOwnProperty(he)&&ke!=null&&he==="onScroll"&&us("scroll",D)}switch(E){case"input":Kr(D),On(D,Q,!0);break;case"textarea":Kr(D),wt(D);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(D.onclick=X1)}D=H,g.updateQueue=D,D!==null&&(g.flags|=4)}else{he=H.nodeType===9?H:H.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Vt(E)),d==="http://www.w3.org/1999/xhtml"?E==="script"?(d=he.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof D.is=="string"?d=he.createElement(E,{is:D.is}):(d=he.createElement(E),E==="select"&&(he=d,D.multiple?he.multiple=!0:D.size&&(he.size=D.size))):d=he.createElementNS(d,E),d[gi]=g,d[Y1]=D,Q4(d,g,!1,!1),g.stateNode=d;e:{switch(he=_n(E,D),E){case"dialog":us("cancel",d),us("close",d),H=D;break;case"iframe":case"object":case"embed":us("load",d),H=D;break;case"video":case"audio":for(H=0;H<bd.length;H++)us(bd[H],d);H=D;break;case"source":us("error",d),H=D;break;case"img":case"image":case"link":us("error",d),us("load",d),H=D;break;case"details":us("toggle",d),H=D;break;case"input":Ii(d,D),H=Ue(d,D),us("invalid",d);break;case"option":H=D;break;case"select":d._wrapperState={wasMultiple:!!D.multiple},H=ut({},D,{value:void 0}),us("invalid",d);break;case"textarea":Ie(d,D),H=Ci(d,D),us("invalid",d);break;default:H=D}Jn(E,H),ke=H;for(Q in ke)if(ke.hasOwnProperty(Q)){var ze=ke[Q];Q==="style"?Rn(d,ze):Q==="dangerouslySetInnerHTML"?(ze=ze?ze.__html:void 0,ze!=null&&Kn(d,ze)):Q==="children"?typeof ze=="string"?(E!=="textarea"||ze!=="")&&vn(d,ze):typeof ze=="number"&&vn(d,""+ze):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(r.hasOwnProperty(Q)?ze!=null&&Q==="onScroll"&&us("scroll",d):ze!=null&&X(d,Q,ze,he))}switch(E){case"input":Kr(d),On(d,D,!1);break;case"textarea":Kr(d),wt(d);break;case"option":D.value!=null&&d.setAttribute("value",""+hn(D.value));break;case"select":d.multiple=!!D.multiple,Q=D.value,Q!=null?vr(d,!!D.multiple,Q,!1):D.defaultValue!=null&&vr(d,!!D.multiple,D.defaultValue,!0);break;default:typeof H.onClick=="function"&&(d.onclick=X1)}switch(E){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return na(g),null;case 6:if(d&&g.stateNode!=null)e5(d,g,d.memoizedProps,D);else{if(typeof D!="string"&&g.stateNode===null)throw Error(t(166));if(E=wh(am.current),wh(Sc.current),em(g)){if(D=g.stateNode,E=g.memoizedProps,D[gi]=g,(Q=D.nodeValue!==E)&&(d=c0,d!==null))switch(d.tag){case 3:q1(D.nodeValue,E,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&q1(D.nodeValue,E,(d.mode&1)!==0)}Q&&(g.flags|=4)}else D=(E.nodeType===9?E:E.ownerDocument).createTextNode(D),D[gi]=g,g.stateNode=D}return na(g),null;case 13:if(Hi(Cs),D=g.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(hs&&Da!==null&&(g.mode&1)!==0&&(g.flags&128)===0)Wv(),fp(),g.flags|=98560,Q=!1;else if(Q=em(g),D!==null&&D.dehydrated!==null){if(d===null){if(!Q)throw Error(t(318));if(Q=g.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(t(317));Q[gi]=g}else fp(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;na(g),Q=!1}else Oa!==null&&(Cm(Oa),Oa=null),Q=!0;if(!Q)return g.flags&65536?g:null}return(g.flags&128)!==0?(g.lanes=E,g):(D=D!==null,D!==(d!==null&&d.memoizedState!==null)&&D&&(g.child.flags|=8192,(g.mode&1)!==0&&(d===null||(Cs.current&1)!==0?Tr===0&&(Tr=3):f5())),g.updateQueue!==null&&(g.flags|=4),na(g),null);case 4:return vp(),J4(d,g),d===null&&cp(g.stateNode.containerInfo),na(g),null;case 10:return A4(g.type._context),na(g),null;case 17:return Na(g.type)&&hp(),na(g),null;case 19:if(Hi(Cs),Q=g.memoizedState,Q===null)return na(g),null;if(D=(g.flags&128)!==0,he=Q.rendering,he===null)if(D)_m(Q,!1);else{if(Tr!==0||d!==null&&(d.flags&128)!==0)for(d=g.child;d!==null;){if(he=Su(d),he!==null){for(g.flags|=128,_m(Q,!1),D=he.updateQueue,D!==null&&(g.updateQueue=D,g.flags|=4),g.subtreeFlags=0,D=E,E=g.child;E!==null;)Q=E,d=D,Q.flags&=14680066,he=Q.alternate,he===null?(Q.childLanes=0,Q.lanes=d,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=he.childLanes,Q.lanes=he.lanes,Q.child=he.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=he.memoizedProps,Q.memoizedState=he.memoizedState,Q.updateQueue=he.updateQueue,Q.type=he.type,d=he.dependencies,Q.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),E=E.sibling;return es(Cs,Cs.current&1|2),g.child}d=d.sibling}Q.tail!==null&&gt()>Mu&&(g.flags|=128,D=!0,_m(Q,!1),g.lanes=4194304)}else{if(!D)if(d=Su(he),d!==null){if(g.flags|=128,D=!0,E=d.updateQueue,E!==null&&(g.updateQueue=E,g.flags|=4),_m(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!he.alternate&&!hs)return na(g),null}else 2*gt()-Q.renderingStartTime>Mu&&E!==1073741824&&(g.flags|=128,D=!0,_m(Q,!1),g.lanes=4194304);Q.isBackwards?(he.sibling=g.child,g.child=he):(E=Q.last,E!==null?E.sibling=he:g.child=he,Q.last=he)}return Q.tail!==null?(g=Q.tail,Q.rendering=g,Q.tail=g.sibling,Q.renderingStartTime=gt(),g.sibling=null,E=Cs.current,es(Cs,D?E&1|2:E&1),g):(na(g),null);case 22:case 23:return a9(),D=g.memoizedState!==null,d!==null&&d.memoizedState!==null!==D&&(g.flags|=8192),D&&(g.mode&1)!==0?(Ba&1073741824)!==0&&(na(g),g.subtreeFlags&6&&(g.flags|=8192)):na(g),null;case 24:return null;case 25:return null}throw Error(t(156,g.tag))}function f_(d,g){switch(Q1(g),g.tag){case 1:return Na(g.type)&&hp(),d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 3:return vp(),Hi(ta),Hi(Vo),yp(),d=g.flags,(d&65536)!==0&&(d&128)===0?(g.flags=d&-65537|128,g):null;case 5:return P2(g),null;case 13:if(Hi(Cs),d=g.memoizedState,d!==null&&d.dehydrated!==null){if(g.alternate===null)throw Error(t(340));fp()}return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 19:return Hi(Cs),null;case 4:return vp(),null;case 10:return A4(g.type._context),null;case 22:case 23:return a9(),null;case 24:return null;default:return null}}var Y2=!1,Ro=!1,oy=typeof WeakSet=="function"?WeakSet:Set,Un=null;function Bl(d,g){var E=d.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(D){Ss(d,g,D)}else E.current=null}function Th(d,g,E){try{E()}catch(D){Ss(d,g,D)}}var K2=!1;function ay(d,g){if(g2=Hf,d=Nv(),l4(d)){if("selectionStart"in d)var E={start:d.selectionStart,end:d.selectionEnd};else e:{E=(E=d.ownerDocument)&&E.defaultView||window;var D=E.getSelection&&E.getSelection();if(D&&D.rangeCount!==0){E=D.anchorNode;var H=D.anchorOffset,Q=D.focusNode;D=D.focusOffset;try{E.nodeType,Q.nodeType}catch{E=null;break e}var he=0,ke=-1,ze=-1,Ct=0,Qt=0,cn=d,Zt=null;t:for(;;){for(var Dn;cn!==E||H!==0&&cn.nodeType!==3||(ke=he+H),cn!==Q||D!==0&&cn.nodeType!==3||(ze=he+D),cn.nodeType===3&&(he+=cn.nodeValue.length),(Dn=cn.firstChild)!==null;)Zt=cn,cn=Dn;for(;;){if(cn===d)break t;if(Zt===E&&++Ct===H&&(ke=he),Zt===Q&&++Qt===D&&(ze=he),(Dn=cn.nextSibling)!==null)break;cn=Zt,Zt=cn.parentNode}cn=Dn}E=ke===-1||ze===-1?null:{start:ke,end:ze}}else E=null}E=E||{start:0,end:0}}else E=null;for(v2={focusedElem:d,selectionRange:E},Hf=!1,Un=g;Un!==null;)if(g=Un,d=g.child,(g.subtreeFlags&1028)!==0&&d!==null)d.return=g,Un=d;else for(;Un!==null;){g=Un;try{var zn=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if(zn!==null){var Hn=zn.memoizedProps,Ns=zn.memoizedState,yt=g.stateNode,Qe=yt.getSnapshotBeforeUpdate(g.elementType===g.type?Hn:d0(g.type,Hn),Ns);yt.__reactInternalSnapshotBeforeUpdate=Qe}break;case 3:var St=g.stateNode.containerInfo;St.nodeType===1?St.textContent="":St.nodeType===9&&St.documentElement&&St.removeChild(St.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(fn){Ss(g,g.return,fn)}if(d=g.sibling,d!==null){d.return=g.return,Un=d;break}Un=g.return}return zn=K2,K2=!1,zn}function Ap(d,g,E){var D=g.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var H=D=D.next;do{if((H.tag&d)===d){var Q=H.destroy;H.destroy=void 0,Q!==void 0&&Th(g,E,Q)}H=H.next}while(H!==D)}}function Z2(d,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var E=g=g.next;do{if((E.tag&d)===d){var D=E.create;E.destroy=D()}E=E.next}while(E!==g)}}function t5(d){var g=d.ref;if(g!==null){var E=d.stateNode;switch(d.tag){case 5:d=E;break;default:d=E}typeof g=="function"?g(d):g.current=d}}function n5(d){var g=d.alternate;g!==null&&(d.alternate=null,n5(g)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(g=d.stateNode,g!==null&&(delete g[gi],delete g[Y1],delete g[Ed],delete g[K1],delete g[Td])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function ly(d){return d.tag===5||d.tag===3||d.tag===4}function r5(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||ly(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function bm(d,g,E){var D=d.tag;if(D===5||D===6)d=d.stateNode,g?E.nodeType===8?E.parentNode.insertBefore(d,g):E.insertBefore(d,g):(E.nodeType===8?(g=E.parentNode,g.insertBefore(d,E)):(g=E,g.appendChild(d)),E=E._reactRootContainer,E!=null||g.onclick!==null||(g.onclick=X1));else if(D!==4&&(d=d.child,d!==null))for(bm(d,g,E),d=d.sibling;d!==null;)bm(d,g,E),d=d.sibling}function Sm(d,g,E){var D=d.tag;if(D===5||D===6)d=d.stateNode,g?E.insertBefore(d,g):E.appendChild(d);else if(D!==4&&(d=d.child,d!==null))for(Sm(d,g,E),d=d.sibling;d!==null;)Sm(d,g,E),d=d.sibling}var Io=null,f0=!1;function Ul(d,g,E){for(E=E.child;E!==null;)i5(d,g,E),E=E.sibling}function i5(d,g,E){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(ar,E)}catch{}switch(E.tag){case 5:Ro||Bl(E,g);case 6:var D=Io,H=f0;Io=null,Ul(d,g,E),Io=D,f0=H,Io!==null&&(f0?(d=Io,E=E.stateNode,d.nodeType===8?d.parentNode.removeChild(E):d.removeChild(E)):Io.removeChild(E.stateNode));break;case 18:Io!==null&&(f0?(d=Io,E=E.stateNode,d.nodeType===8?_2(d.parentNode,E):d.nodeType===1&&_2(d,E),lh(d)):_2(Io,E.stateNode));break;case 4:D=Io,H=f0,Io=E.stateNode.containerInfo,f0=!0,Ul(d,g,E),Io=D,f0=H;break;case 0:case 11:case 14:case 15:if(!Ro&&(D=E.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){H=D=D.next;do{var Q=H,he=Q.destroy;Q=Q.tag,he!==void 0&&((Q&2)!==0||(Q&4)!==0)&&Th(E,g,he),H=H.next}while(H!==D)}Ul(d,g,E);break;case 1:if(!Ro&&(Bl(E,g),D=E.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=E.memoizedProps,D.state=E.memoizedState,D.componentWillUnmount()}catch(ke){Ss(E,g,ke)}Ul(d,g,E);break;case 21:Ul(d,g,E);break;case 22:E.mode&1?(Ro=(D=Ro)||E.memoizedState!==null,Ul(d,g,E),Ro=D):Ul(d,g,E);break;default:Ul(d,g,E)}}function cy(d){var g=d.updateQueue;if(g!==null){d.updateQueue=null;var E=d.stateNode;E===null&&(E=d.stateNode=new oy),g.forEach(function(D){var H=fy.bind(null,d,D);E.has(D)||(E.add(D),D.then(H,H))})}}function zl(d,g){var E=g.deletions;if(E!==null)for(var D=0;D<E.length;D++){var H=E[D];try{var Q=d,he=g,ke=he;e:for(;ke!==null;){switch(ke.tag){case 5:Io=ke.stateNode,f0=!1;break e;case 3:Io=ke.stateNode.containerInfo,f0=!0;break e;case 4:Io=ke.stateNode.containerInfo,f0=!0;break e}ke=ke.return}if(Io===null)throw Error(t(160));i5(Q,he,H),Io=null,f0=!1;var ze=H.alternate;ze!==null&&(ze.return=null),H.return=null}catch(Ct){Ss(H,g,Ct)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)Q2(g,d),g=g.sibling}function Q2(d,g){var E=d.alternate,D=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(zl(g,d),Mc(d),D&4){try{Ap(3,d,d.return),Z2(3,d)}catch(Hn){Ss(d,d.return,Hn)}try{Ap(5,d,d.return)}catch(Hn){Ss(d,d.return,Hn)}}break;case 1:zl(g,d),Mc(d),D&512&&E!==null&&Bl(E,E.return);break;case 5:if(zl(g,d),Mc(d),D&512&&E!==null&&Bl(E,E.return),d.flags&32){var H=d.stateNode;try{vn(H,"")}catch(Hn){Ss(d,d.return,Hn)}}if(D&4&&(H=d.stateNode,H!=null)){var Q=d.memoizedProps,he=E!==null?E.memoizedProps:Q,ke=d.type,ze=d.updateQueue;if(d.updateQueue=null,ze!==null)try{ke==="input"&&Q.type==="radio"&&Q.name!=null&&ei(H,Q),_n(ke,he);var Ct=_n(ke,Q);for(he=0;he<ze.length;he+=2){var Qt=ze[he],cn=ze[he+1];Qt==="style"?Rn(H,cn):Qt==="dangerouslySetInnerHTML"?Kn(H,cn):Qt==="children"?vn(H,cn):X(H,Qt,cn,Ct)}switch(ke){case"input":Ar(H,Q);break;case"textarea":pe(H,Q);break;case"select":var Zt=H._wrapperState.wasMultiple;H._wrapperState.wasMultiple=!!Q.multiple;var Dn=Q.value;Dn!=null?vr(H,!!Q.multiple,Dn,!1):Zt!==!!Q.multiple&&(Q.defaultValue!=null?vr(H,!!Q.multiple,Q.defaultValue,!0):vr(H,!!Q.multiple,Q.multiple?[]:"",!1))}H[Y1]=Q}catch(Hn){Ss(d,d.return,Hn)}}break;case 6:if(zl(g,d),Mc(d),D&4){if(d.stateNode===null)throw Error(t(162));H=d.stateNode,Q=d.memoizedProps;try{H.nodeValue=Q}catch(Hn){Ss(d,d.return,Hn)}}break;case 3:if(zl(g,d),Mc(d),D&4&&E!==null&&E.memoizedState.isDehydrated)try{lh(g.containerInfo)}catch(Hn){Ss(d,d.return,Hn)}break;case 4:zl(g,d),Mc(d);break;case 13:zl(g,d),Mc(d),H=d.child,H.flags&8192&&(Q=H.memoizedState!==null,H.stateNode.isHidden=Q,!Q||H.alternate!==null&&H.alternate.memoizedState!==null||(u5=gt())),D&4&&cy(d);break;case 22:if(Qt=E!==null&&E.memoizedState!==null,d.mode&1?(Ro=(Ct=Ro)||Qt,zl(g,d),Ro=Ct):zl(g,d),Mc(d),D&8192){if(Ct=d.memoizedState!==null,(d.stateNode.isHidden=Ct)&&!Qt&&(d.mode&1)!==0)for(Un=d,Qt=d.child;Qt!==null;){for(cn=Un=Qt;Un!==null;){switch(Zt=Un,Dn=Zt.child,Zt.tag){case 0:case 11:case 14:case 15:Ap(4,Zt,Zt.return);break;case 1:Bl(Zt,Zt.return);var zn=Zt.stateNode;if(typeof zn.componentWillUnmount=="function"){D=Zt,E=Zt.return;try{g=D,zn.props=g.memoizedProps,zn.state=g.memoizedState,zn.componentWillUnmount()}catch(Hn){Ss(D,E,Hn)}}break;case 5:Bl(Zt,Zt.return);break;case 22:if(Zt.memoizedState!==null){o5(cn);continue}}Dn!==null?(Dn.return=Zt,Un=Dn):o5(cn)}Qt=Qt.sibling}e:for(Qt=null,cn=d;;){if(cn.tag===5){if(Qt===null){Qt=cn;try{H=cn.stateNode,Ct?(Q=H.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(ke=cn.stateNode,ze=cn.memoizedProps.style,he=ze!=null&&ze.hasOwnProperty("display")?ze.display:null,ke.style.display=jt("display",he))}catch(Hn){Ss(d,d.return,Hn)}}}else if(cn.tag===6){if(Qt===null)try{cn.stateNode.nodeValue=Ct?"":cn.memoizedProps}catch(Hn){Ss(d,d.return,Hn)}}else if((cn.tag!==22&&cn.tag!==23||cn.memoizedState===null||cn===d)&&cn.child!==null){cn.child.return=cn,cn=cn.child;continue}if(cn===d)break e;for(;cn.sibling===null;){if(cn.return===null||cn.return===d)break e;Qt===cn&&(Qt=null),cn=cn.return}Qt===cn&&(Qt=null),cn.sibling.return=cn.return,cn=cn.sibling}}break;case 19:zl(g,d),Mc(d),D&4&&cy(d);break;case 21:break;default:zl(g,d),Mc(d)}}function Mc(d){var g=d.flags;if(g&2){try{e:{for(var E=d.return;E!==null;){if(ly(E)){var D=E;break e}E=E.return}throw Error(t(160))}switch(D.tag){case 5:var H=D.stateNode;D.flags&32&&(vn(H,""),D.flags&=-33);var Q=r5(d);Sm(d,Q,H);break;case 3:case 4:var he=D.stateNode.containerInfo,ke=r5(d);bm(d,ke,he);break;default:throw Error(t(161))}}catch(ze){Ss(d,d.return,ze)}d.flags&=-3}g&4096&&(d.flags&=-4097)}function p_(d,g,E){Un=d,J2(d)}function J2(d,g,E){for(var D=(d.mode&1)!==0;Un!==null;){var H=Un,Q=H.child;if(H.tag===22&&D){var he=H.memoizedState!==null||Y2;if(!he){var ke=H.alternate,ze=ke!==null&&ke.memoizedState!==null||Ro;ke=Y2;var Ct=Ro;if(Y2=he,(Ro=ze)&&!Ct)for(Un=H;Un!==null;)he=Un,ze=he.child,he.tag===22&&he.memoizedState!==null?a5(H):ze!==null?(ze.return=he,Un=ze):a5(H);for(;Q!==null;)Un=Q,J2(Q),Q=Q.sibling;Un=H,Y2=ke,Ro=Ct}s5(d)}else(H.subtreeFlags&8772)!==0&&Q!==null?(Q.return=H,Un=Q):s5(d)}}function s5(d){for(;Un!==null;){var g=Un;if((g.flags&8772)!==0){var E=g.alternate;try{if((g.flags&8772)!==0)switch(g.tag){case 0:case 11:case 15:Ro||Z2(5,g);break;case 1:var D=g.stateNode;if(g.flags&4&&!Ro)if(E===null)D.componentDidMount();else{var H=g.elementType===g.type?E.memoizedProps:d0(g.type,E.memoizedProps);D.componentDidUpdate(H,E.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var Q=g.updateQueue;Q!==null&&I4(g,Q,D);break;case 3:var he=g.updateQueue;if(he!==null){if(E=null,g.child!==null)switch(g.child.tag){case 5:E=g.child.stateNode;break;case 1:E=g.child.stateNode}I4(g,he,E)}break;case 5:var ke=g.stateNode;if(E===null&&g.flags&4){E=ke;var ze=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":ze.autoFocus&&E.focus();break;case"img":ze.src&&(E.src=ze.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var Ct=g.alternate;if(Ct!==null){var Qt=Ct.memoizedState;if(Qt!==null){var cn=Qt.dehydrated;cn!==null&&lh(cn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ro||g.flags&512&&t5(g)}catch(Zt){Ss(g,g.return,Zt)}}if(g===d){Un=null;break}if(E=g.sibling,E!==null){E.return=g.return,Un=E;break}Un=g.return}}function o5(d){for(;Un!==null;){var g=Un;if(g===d){Un=null;break}var E=g.sibling;if(E!==null){E.return=g.return,Un=E;break}Un=g.return}}function a5(d){for(;Un!==null;){var g=Un;try{switch(g.tag){case 0:case 11:case 15:var E=g.return;try{Z2(4,g)}catch(ze){Ss(g,E,ze)}break;case 1:var D=g.stateNode;if(typeof D.componentDidMount=="function"){var H=g.return;try{D.componentDidMount()}catch(ze){Ss(g,H,ze)}}var Q=g.return;try{t5(g)}catch(ze){Ss(g,Q,ze)}break;case 5:var he=g.return;try{t5(g)}catch(ze){Ss(g,he,ze)}}}catch(ze){Ss(g,g.return,ze)}if(g===d){Un=null;break}var ke=g.sibling;if(ke!==null){ke.return=g.return,Un=ke;break}Un=g.return}}var l5=Math.ceil,wm=P.ReactCurrentDispatcher,Pp=P.ReactCurrentOwner,Fa=P.ReactCurrentBatchConfig,Si=0,ho=null,Js=null,ko=0,Ba=0,Mh=gu(0),Tr=0,Ch=null,Ah=0,e9=0,c5=0,Od=null,xa=null,u5=0,Mu=1/0,Cc=null,t9=!1,n9=null,Vl=null,Em=!1,Gl=null,r9=0,Rp=0,Ip=null,i9=-1,Tm=0;function js(){return(Si&6)!==0?gt():i9!==-1?i9:i9=gt()}function Ac(d){return(d.mode&1)===0?1:(Si&2)!==0&&ko!==0?ko&-ko:c_.transition!==null?(Tm===0&&(Tm=Li()),Tm):(d=ti,d!==0||(d=window.event,d=d===void 0?16:N1(d.type)),d)}function p0(d,g,E,D){if(50<Rp)throw Rp=0,Ip=null,Error(t(185));xs(d,E,D),((Si&2)===0||d!==ho)&&(d===ho&&((Si&2)===0&&(e9|=E),Tr===4&&Cu(d,ko)),_a(d,D),E===1&&Si===0&&(g.mode&1)===0&&(Mu=gt()+500,xu&&_h()))}function _a(d,g){var E=d.callbackNode;Mo(d,g);var D=lo(d,d===ho?ko:0);if(D===0)E!==null&&ye(E),d.callbackNode=null,d.callbackPriority=0;else if(g=D&-D,d.callbackPriority!==g){if(E!=null&&ye(E),g===1)d.tag===0?l_(d5.bind(null,d)):w4(d5.bind(null,d)),zv(function(){(Si&6)===0&&_h()}),E=null;else{switch(Co(D)){case 1:E=Kt;break;case 4:E=bn;break;case 16:E=Cn;break;case 536870912:E=fr;break;default:E=Cn}E=v5(E,s9.bind(null,d))}d.callbackPriority=g,d.callbackNode=E}}function s9(d,g){if(i9=-1,Tm=0,(Si&6)!==0)throw Error(t(327));var E=d.callbackNode;if(kp()&&d.callbackNode!==E)return null;var D=lo(d,d===ho?ko:0);if(D===0)return null;if((D&30)!==0||(D&d.expiredLanes)!==0||g)g=Pm(d,D);else{g=D;var H=Si;Si|=2;var Q=Am();(ho!==d||ko!==g)&&(Cc=null,Mu=gt()+500,Ua(d,g));do try{p5();break}catch(ke){Ld(d,ke)}while(!0);C4(),wm.current=Q,Si=H,Js!==null?g=0:(ho=null,ko=0,g=Tr)}if(g!==0){if(g===2&&(H=s0(d),H!==0&&(D=H,g=Mm(d,H))),g===1)throw E=Ch,Ua(d,0),Cu(d,D),_a(d,gt()),E;if(g===6)Cu(d,D);else{if(H=d.current.alternate,(D&30)===0&&!h5(H)&&(g=Pm(d,D),g===2&&(Q=s0(d),Q!==0&&(D=Q,g=Mm(d,Q))),g===1))throw E=Ch,Ua(d,0),Cu(d,D),_a(d,gt()),E;switch(d.finishedWork=H,d.finishedLanes=D,g){case 0:case 1:throw Error(t(345));case 2:jl(d,xa,Cc);break;case 3:if(Cu(d,D),(D&130023424)===D&&(g=u5+500-gt(),10<g)){if(lo(d,0)!==0)break;if(H=d.suspendedLanes,(H&D)!==D){js(),d.pingedLanes|=d.suspendedLanes&H;break}d.timeoutHandle=x2(jl.bind(null,d,xa,Cc),g);break}jl(d,xa,Cc);break;case 4:if(Cu(d,D),(D&4194240)===D)break;for(g=d.eventTimes,H=-1;0<D;){var he=31-_r(D);Q=1<<he,he=g[he],he>H&&(H=he),D&=~Q}if(D=H,D=gt()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*l5(D/1960))-D,10<D){d.timeoutHandle=x2(jl.bind(null,d,xa,Cc),D);break}jl(d,xa,Cc);break;case 5:jl(d,xa,Cc);break;default:throw Error(t(329))}}}return _a(d,gt()),d.callbackNode===E?s9.bind(null,d):null}function Mm(d,g){var E=Od;return d.current.memoizedState.isDehydrated&&(Ua(d,g).flags|=256),d=Pm(d,g),d!==2&&(g=xa,xa=E,g!==null&&Cm(g)),d}function Cm(d){xa===null?xa=d:xa.push.apply(xa,d)}function h5(d){for(var g=d;;){if(g.flags&16384){var E=g.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var D=0;D<E.length;D++){var H=E[D],Q=H.getSnapshot;H=H.value;try{if(!zo(Q(),H))return!1}catch{return!1}}}if(E=g.child,g.subtreeFlags&16384&&E!==null)E.return=g,g=E;else{if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Cu(d,g){for(g&=~c5,g&=~e9,d.suspendedLanes|=g,d.pingedLanes&=~g,d=d.expirationTimes;0<g;){var E=31-_r(g),D=1<<E;d[E]=-1,g&=~D}}function d5(d){if((Si&6)!==0)throw Error(t(327));kp();var g=lo(d,0);if((g&1)===0)return _a(d,gt()),null;var E=Pm(d,g);if(d.tag!==0&&E===2){var D=s0(d);D!==0&&(g=D,E=Mm(d,D))}if(E===1)throw E=Ch,Ua(d,0),Cu(d,g),_a(d,gt()),E;if(E===6)throw Error(t(345));return d.finishedWork=d.current.alternate,d.finishedLanes=g,jl(d,xa,Cc),_a(d,gt()),null}function o9(d,g){var E=Si;Si|=1;try{return d(g)}finally{Si=E,Si===0&&(Mu=gt()+500,xu&&_h())}}function Ph(d){Gl!==null&&Gl.tag===0&&(Si&6)===0&&kp();var g=Si;Si|=1;var E=Fa.transition,D=ti;try{if(Fa.transition=null,ti=1,d)return d()}finally{ti=D,Fa.transition=E,Si=g,(Si&6)===0&&_h()}}function a9(){Ba=Mh.current,Hi(Mh)}function Ua(d,g){d.finishedWork=null,d.finishedLanes=0;var E=d.timeoutHandle;if(E!==-1&&(d.timeoutHandle=-1,Uv(E)),Js!==null)for(E=Js.return;E!==null;){var D=E;switch(Q1(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&hp();break;case 3:vp(),Hi(ta),Hi(Vo),yp();break;case 5:P2(D);break;case 4:vp();break;case 13:Hi(Cs);break;case 19:Hi(Cs);break;case 10:A4(D.type._context);break;case 22:case 23:a9()}E=E.return}if(ho=d,Js=d=Pc(d.current,null),ko=Ba=g,Tr=0,Ch=null,c5=e9=Ah=0,xa=Od=null,u0!==null){for(g=0;g<u0.length;g++)if(E=u0[g],D=E.interleaved,D!==null){E.interleaved=null;var H=D.next,Q=E.pending;if(Q!==null){var he=Q.next;Q.next=H,D.next=he}E.pending=D}u0=null}return d}function Ld(d,g){do{var E=Js;try{if(C4(),lm.current=Ec,R2){for(var D=Wi.memoizedState;D!==null;){var H=D.queue;H!==null&&(H.pending=null),D=D.next}R2=!1}if(wu=0,Po=bs=Wi=null,xp=!1,cm=0,Pp.current=null,E===null||E.return===null){Tr=1,Ch=g,Js=null;break}e:{var Q=d,he=E.return,ke=E,ze=g;if(g=ko,ke.flags|=32768,ze!==null&&typeof ze=="object"&&typeof ze.then=="function"){var Ct=ze,Qt=ke,cn=Qt.tag;if((Qt.mode&1)===0&&(cn===0||cn===11||cn===15)){var Zt=Qt.alternate;Zt?(Qt.updateQueue=Zt.updateQueue,Qt.memoizedState=Zt.memoizedState,Qt.lanes=Zt.lanes):(Qt.updateQueue=null,Qt.memoizedState=null)}var Dn=G4(he);if(Dn!==null){Dn.flags&=-257,ym(Dn,he,ke,Q,g),Dn.mode&1&&ty(Q,Ct,g),g=Dn,ze=Ct;var zn=g.updateQueue;if(zn===null){var Hn=new Set;Hn.add(ze),g.updateQueue=Hn}else zn.add(ze);break e}else{if((g&1)===0){ty(Q,Ct,g),f5();break e}ze=Error(t(426))}}else if(hs&&ke.mode&1){var Ns=G4(he);if(Ns!==null){(Ns.flags&65536)===0&&(Ns.flags|=256),ym(Ns,he,ke,Q,g),w2(Mp(ze,ke));break e}}Q=ze=Mp(ze,ke),Tr!==4&&(Tr=2),Od===null?Od=[Q]:Od.push(Q),Q=he;do{switch(Q.tag){case 3:Q.flags|=65536,g&=-g,Q.lanes|=g;var yt=V4(Q,ze,g);R4(Q,yt);break e;case 1:ke=ze;var Qe=Q.type,St=Q.stateNode;if((Q.flags&128)===0&&(typeof Qe.getDerivedStateFromError=="function"||St!==null&&typeof St.componentDidCatch=="function"&&(Vl===null||!Vl.has(St)))){Q.flags|=65536,g&=-g,Q.lanes|=g;var fn=vm(Q,ke,g);R4(Q,fn);break e}}Q=Q.return}while(Q!==null)}m5(E)}catch(er){g=er,Js===E&&E!==null&&(Js=E=E.return);continue}break}while(!0)}function Am(){var d=wm.current;return wm.current=Ec,d===null?Ec:d}function f5(){(Tr===0||Tr===3||Tr===2)&&(Tr=4),ho===null||(Ah&268435455)===0&&(e9&268435455)===0||Cu(ho,ko)}function Pm(d,g){var E=Si;Si|=2;var D=Am();(ho!==d||ko!==g)&&(Cc=null,Ua(d,g));do try{uy();break}catch(H){Ld(d,H)}while(!0);if(C4(),Si=E,wm.current=D,Js!==null)throw Error(t(261));return ho=null,ko=0,Tr}function uy(){for(;Js!==null;)l9(Js)}function p5(){for(;Js!==null&&!at();)l9(Js)}function l9(d){var g=Np(d.alternate,d,Ba);d.memoizedProps=d.pendingProps,g===null?m5(d):Js=g,Pp.current=null}function m5(d){var g=d;do{var E=g.alternate;if(d=g.return,(g.flags&32768)===0){if(E=sy(E,g,Ba),E!==null){Js=E;return}}else{if(E=f_(E,g),E!==null){E.flags&=32767,Js=E;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Tr=6,Js=null;return}}if(g=g.sibling,g!==null){Js=g;return}Js=g=d}while(g!==null);Tr===0&&(Tr=5)}function jl(d,g,E){var D=ti,H=Fa.transition;try{Fa.transition=null,ti=1,hy(d,g,E,D)}finally{Fa.transition=H,ti=D}return null}function hy(d,g,E,D){do kp();while(Gl!==null);if((Si&6)!==0)throw Error(t(327));E=d.finishedWork;var H=d.finishedLanes;if(E===null)return null;if(d.finishedWork=null,d.finishedLanes=0,E===d.current)throw Error(t(177));d.callbackNode=null,d.callbackPriority=0;var Q=E.lanes|E.childLanes;if(co(d,Q),d===ho&&(Js=ho=null,ko=0),(E.subtreeFlags&2064)===0&&(E.flags&2064)===0||Em||(Em=!0,v5(Cn,function(){return kp(),null})),Q=(E.flags&15990)!==0,(E.subtreeFlags&15990)!==0||Q){Q=Fa.transition,Fa.transition=null;var he=ti;ti=1;var ke=Si;Si|=4,Pp.current=null,ay(d,E),Q2(E,d),Dv(v2),Hf=!!g2,v2=g2=null,d.current=E,p_(E),Tt(),Si=ke,ti=he,Fa.transition=Q}else d.current=E;if(Em&&(Em=!1,Gl=d,r9=H),Q=d.pendingLanes,Q===0&&(Vl=null),Pr(E.stateNode),_a(d,gt()),g!==null)for(D=d.onRecoverableError,E=0;E<g.length;E++)H=g[E],D(H.value,{componentStack:H.stack,digest:H.digest});if(t9)throw t9=!1,d=n9,n9=null,d;return(r9&1)!==0&&d.tag!==0&&kp(),Q=d.pendingLanes,(Q&1)!==0?d===Ip?Rp++:(Rp=0,Ip=d):Rp=0,_h(),null}function kp(){if(Gl!==null){var d=Co(r9),g=Fa.transition,E=ti;try{if(Fa.transition=null,ti=16>d?16:d,Gl===null)var D=!1;else{if(d=Gl,Gl=null,r9=0,(Si&6)!==0)throw Error(t(331));var H=Si;for(Si|=4,Un=d.current;Un!==null;){var Q=Un,he=Q.child;if((Un.flags&16)!==0){var ke=Q.deletions;if(ke!==null){for(var ze=0;ze<ke.length;ze++){var Ct=ke[ze];for(Un=Ct;Un!==null;){var Qt=Un;switch(Qt.tag){case 0:case 11:case 15:Ap(8,Qt,Q)}var cn=Qt.child;if(cn!==null)cn.return=Qt,Un=cn;else for(;Un!==null;){Qt=Un;var Zt=Qt.sibling,Dn=Qt.return;if(n5(Qt),Qt===Ct){Un=null;break}if(Zt!==null){Zt.return=Dn,Un=Zt;break}Un=Dn}}}var zn=Q.alternate;if(zn!==null){var Hn=zn.child;if(Hn!==null){zn.child=null;do{var Ns=Hn.sibling;Hn.sibling=null,Hn=Ns}while(Hn!==null)}}Un=Q}}if((Q.subtreeFlags&2064)!==0&&he!==null)he.return=Q,Un=he;else e:for(;Un!==null;){if(Q=Un,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:Ap(9,Q,Q.return)}var yt=Q.sibling;if(yt!==null){yt.return=Q.return,Un=yt;break e}Un=Q.return}}var Qe=d.current;for(Un=Qe;Un!==null;){he=Un;var St=he.child;if((he.subtreeFlags&2064)!==0&&St!==null)St.return=he,Un=St;else e:for(he=Qe;Un!==null;){if(ke=Un,(ke.flags&2048)!==0)try{switch(ke.tag){case 0:case 11:case 15:Z2(9,ke)}}catch(er){Ss(ke,ke.return,er)}if(ke===he){Un=null;break e}var fn=ke.sibling;if(fn!==null){fn.return=ke.return,Un=fn;break e}Un=ke.return}}if(Si=H,_h(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(ar,d)}catch{}D=!0}return D}finally{ti=E,Fa.transition=g}}return!1}function Rm(d,g,E){g=Mp(E,g),g=V4(d,g,1),d=Fl(d,g,1),g=js(),d!==null&&(xs(d,1,g),_a(d,g))}function Ss(d,g,E){if(d.tag===3)Rm(d,d,E);else for(;g!==null;){if(g.tag===3){Rm(g,d,E);break}else if(g.tag===1){var D=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Vl===null||!Vl.has(D))){d=Mp(E,d),d=vm(g,d,1),g=Fl(g,d,1),d=js(),g!==null&&(xs(g,1,d),_a(g,d));break}}g=g.return}}function m_(d,g,E){var D=d.pingCache;D!==null&&D.delete(g),g=js(),d.pingedLanes|=d.suspendedLanes&E,ho===d&&(ko&E)===E&&(Tr===4||Tr===3&&(ko&130023424)===ko&&500>gt()-u5?Ua(d,0):c5|=E),_a(d,g)}function g5(d,g){g===0&&((d.mode&1)===0?g=1:(g=vs,vs<<=1,(vs&130023424)===0&&(vs=4194304)));var E=js();d=bu(d,g),d!==null&&(xs(d,g,E),_a(d,E))}function dy(d){var g=d.memoizedState,E=0;g!==null&&(E=g.retryLane),g5(d,E)}function fy(d,g){var E=0;switch(d.tag){case 13:var D=d.stateNode,H=d.memoizedState;H!==null&&(E=H.retryLane);break;case 19:D=d.stateNode;break;default:throw Error(t(314))}D!==null&&D.delete(g),g5(d,E)}var Np;Np=function(d,g,E){if(d!==null)if(d.memoizedProps!==g.pendingProps||ta.current)La=!0;else{if((d.lanes&E)===0&&(g.flags&128)===0)return La=!1,d_(d,g,E);La=(d.flags&131072)!==0}else La=!1,hs&&(g.flags&1048576)!==0&&jv(g,Md,g.index);switch(g.lanes=0,g.tag){case 2:var D=g.type;xm(d,g),d=g.pendingProps;var H=xh(g,Vo.current);_u(g,E),H=I2(null,g,D,d,H,E);var Q=um();return g.flags|=1,typeof H=="object"&&H!==null&&typeof H.render=="function"&&H.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Na(D)?(Q=!0,Z1(g)):Q=!1,g.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,M2(g),H.updater=Tc,g.stateNode=H,H._reactInternals=g,mm(g,D,d,E),g=X4(null,g,D,!0,Q,E)):(g.tag=0,hs&&Q&&Ad(g),Go(null,g,H,E),g=g.child),g;case 16:D=g.elementType;e:{switch(xm(d,g),d=g.pendingProps,H=D._init,D=H(D._payload),g.type=D,H=g.tag=c9(D),d=d0(D,d),H){case 0:g=Cp(null,g,D,d,E);break e;case 1:g=q4(null,g,D,d,E);break e;case 11:g=H2(null,g,D,d,E);break e;case 14:g=H4(null,g,D,d0(D.type,d),E);break e}throw Error(t(306,D,""))}return g;case 0:return D=g.type,H=g.pendingProps,H=g.elementType===D?H:d0(D,H),Cp(d,g,D,H,E);case 1:return D=g.type,H=g.pendingProps,H=g.elementType===D?H:d0(D,H),q4(d,g,D,H,E);case 3:e:{if(Y4(g),d===null)throw Error(t(387));D=g.pendingProps,Q=g.memoizedState,H=Q.element,$v(d,g),sm(g,D,null,E);var he=g.memoizedState;if(D=he.element,Q.isDehydrated)if(Q={element:D,isDehydrated:!1,cache:he.cache,pendingSuspenseBoundaries:he.pendingSuspenseBoundaries,transitions:he.transitions},g.updateQueue.baseState=Q,g.memoizedState=Q,g.flags&256){H=Mp(Error(t(423)),g),g=K4(d,g,D,E,H);break e}else if(D!==H){H=Mp(Error(t(424)),g),g=K4(d,g,D,E,H);break e}else for(Da=fu(g.stateNode.containerInfo.firstChild),c0=g,hs=!0,Oa=null,E=M4(g,null,D,E),g.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if(fp(),D===H){g=Tu(d,g,E);break e}Go(d,g,D,E)}g=g.child}return g;case 5:return qv(g),d===null&&dp(g),D=g.type,H=g.pendingProps,Q=d!==null?d.memoizedProps:null,he=H.children,y2(D,H)?he=null:Q!==null&&y2(D,Q)&&(g.flags|=32),$4(d,g),Go(d,g,he,E),g.child;case 6:return d===null&&dp(g),null;case 13:return ny(d,g,E);case 4:return A2(g,g.stateNode.containerInfo),D=g.pendingProps,d===null?g.child=Pd(g,null,D,E):Go(d,g,D,E),g.child;case 11:return D=g.type,H=g.pendingProps,H=g.elementType===D?H:d0(D,H),H2(d,g,D,H,E);case 7:return Go(d,g,g.pendingProps,E),g.child;case 8:return Go(d,g,g.pendingProps.children,E),g.child;case 12:return Go(d,g,g.pendingProps.children,E),g.child;case 10:e:{if(D=g.type._context,H=g.pendingProps,Q=g.memoizedProps,he=H.value,es(E2,D._currentValue),D._currentValue=he,Q!==null)if(zo(Q.value,he)){if(Q.children===H.children&&!ta.current){g=Tu(d,g,E);break e}}else for(Q=g.child,Q!==null&&(Q.return=g);Q!==null;){var ke=Q.dependencies;if(ke!==null){he=Q.child;for(var ze=ke.firstContext;ze!==null;){if(ze.context===D){if(Q.tag===1){ze=h0(-1,E&-E),ze.tag=2;var Ct=Q.updateQueue;if(Ct!==null){Ct=Ct.shared;var Qt=Ct.pending;Qt===null?ze.next=ze:(ze.next=Qt.next,Qt.next=ze),Ct.pending=ze}}Q.lanes|=E,ze=Q.alternate,ze!==null&&(ze.lanes|=E),pp(Q.return,E,g),ke.lanes|=E;break}ze=ze.next}}else if(Q.tag===10)he=Q.type===g.type?null:Q.child;else if(Q.tag===18){if(he=Q.return,he===null)throw Error(t(341));he.lanes|=E,ke=he.alternate,ke!==null&&(ke.lanes|=E),pp(he,E,g),he=Q.sibling}else he=Q.child;if(he!==null)he.return=Q;else for(he=Q;he!==null;){if(he===g){he=null;break}if(Q=he.sibling,Q!==null){Q.return=he.return,he=Q;break}he=he.return}Q=he}Go(d,g,H.children,E),g=g.child}return g;case 9:return H=g.type,D=g.pendingProps.children,_u(g,E),H=G0(H),D=D(H),g.flags|=1,Go(d,g,D,E),g.child;case 14:return D=g.type,H=d0(D,g.pendingProps),H=d0(D.type,H),H4(d,g,D,H,E);case 15:return W2(d,g,g.type,g.pendingProps,E);case 17:return D=g.type,H=g.pendingProps,H=g.elementType===D?H:d0(D,H),xm(d,g),g.tag=1,Na(D)?(d=!0,Z1(g)):d=!1,_u(g,E),Tp(g,D,H),mm(g,D,H,E),X4(null,g,D,!0,d,E);case 19:return ry(d,g,E);case 22:return W4(d,g,E)}throw Error(t(156,g.tag))};function v5(d,g){return Vf(d,g)}function py(d,g,E,D){this.tag=d,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function W0(d,g,E,D){return new py(d,g,E,D)}function Im(d){return d=d.prototype,!(!d||!d.isReactComponent)}function c9(d){if(typeof d=="function")return Im(d)?1:0;if(d!=null){if(d=d.$$typeof,d===De)return 11;if(d===st)return 14}return 2}function Pc(d,g){var E=d.alternate;return E===null?(E=W0(d.tag,g,d.key,d.mode),E.elementType=d.elementType,E.type=d.type,E.stateNode=d.stateNode,E.alternate=d,d.alternate=E):(E.pendingProps=g,E.type=d.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=d.flags&14680064,E.childLanes=d.childLanes,E.lanes=d.lanes,E.child=d.child,E.memoizedProps=d.memoizedProps,E.memoizedState=d.memoizedState,E.updateQueue=d.updateQueue,g=d.dependencies,E.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},E.sibling=d.sibling,E.index=d.index,E.ref=d.ref,E}function u9(d,g,E,D,H,Q){var he=2;if(D=d,typeof d=="function")Im(d)&&(he=1);else if(typeof d=="string")he=5;else e:switch(d){case ie:return Fd(E.children,H,Q,g);case K:he=8,H|=8;break;case re:return d=W0(12,E,g,H|2),d.elementType=re,d.lanes=Q,d;case Be:return d=W0(13,E,g,H),d.elementType=Be,d.lanes=Q,d;case tt:return d=W0(19,E,g,H),d.elementType=tt,d.lanes=Q,d;case ft:return km(E,H,Q,g);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case se:he=10;break e;case q:he=9;break e;case De:he=11;break e;case st:he=14;break e;case de:he=16,D=null;break e}throw Error(t(130,d==null?d:typeof d,""))}return g=W0(he,E,g,H),g.elementType=d,g.type=D,g.lanes=Q,g}function Fd(d,g,E,D){return d=W0(7,d,D,g),d.lanes=E,d}function km(d,g,E,D){return d=W0(22,d,D,g),d.elementType=ft,d.lanes=E,d.stateNode={isHidden:!1},d}function y5(d,g,E){return d=W0(6,d,null,g),d.lanes=E,d}function x5(d,g,E){return g=W0(4,d.children!==null?d.children:[],d.key,g),g.lanes=E,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}function _5(d,g,E,D,H){this.tag=g,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ys(0),this.expirationTimes=ys(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ys(0),this.identifierPrefix=D,this.onRecoverableError=H,this.mutableSourceEagerHydrationData=null}function h9(d,g,E,D,H,Q,he,ke,ze){return d=new _5(d,g,E,ke,ze),g===1?(g=1,Q===!0&&(g|=8)):g=0,Q=W0(3,null,null,g),d.current=Q,Q.stateNode=d,Q.memoizedState={element:D,isDehydrated:E,cache:null,transitions:null,pendingSuspenseBoundaries:null},M2(Q),d}function my(d,g,E){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:oe,key:D==null?null:""+D,children:d,containerInfo:g,implementation:E}}function b5(d){if(!d)return yh;d=d._reactInternals;e:{if(ao(d)!==d||d.tag!==1)throw Error(t(170));var g=d;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Na(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(t(171))}if(d.tag===1){var E=d.type;if(Na(E))return S4(d,E,g)}return g}function d9(d,g,E,D,H,Q,he,ke,ze){return d=h9(E,D,!0,d,H,Q,he,ke,ze),d.context=b5(null),E=d.current,D=js(),H=Ac(E),Q=h0(D,H),Q.callback=g??null,Fl(E,Q,H),d.current.lanes=H,xs(d,H,D),_a(d,D),d}function Nm(d,g,E,D){var H=g.current,Q=js(),he=Ac(H);return E=b5(E),g.context===null?g.context=E:g.pendingContext=E,g=h0(Q,he),g.payload={element:d},D=D===void 0?null:D,D!==null&&(g.callback=D),d=Fl(H,g,he),d!==null&&(p0(d,H,he,Q),C2(d,H,he)),he}function Dm(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function S5(d,g){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var E=d.retryLane;d.retryLane=E!==0&&E<g?E:g}}function f9(d,g){S5(d,g),(d=d.alternate)&&S5(d,g)}function gy(){return null}var w5=typeof reportError=="function"?reportError:function(d){console.error(d)};function p9(d){this._internalRoot=d}Om.prototype.render=p9.prototype.render=function(d){var g=this._internalRoot;if(g===null)throw Error(t(409));Nm(d,g,null,null)},Om.prototype.unmount=p9.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var g=d.containerInfo;Ph(function(){Nm(null,d,null,null)}),g[ka]=null}};function Om(d){this._internalRoot=d}Om.prototype.unstable_scheduleHydration=function(d){if(d){var g=R1();d={blockedOn:null,target:d,priority:g};for(var E=0;E<Ml.length&&g!==0&&g<Ml[E].priority;E++);Ml.splice(E,0,d),E===0&&pc(d)}};function m9(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Lm(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function E5(){}function vy(d,g,E,D,H){if(H){if(typeof D=="function"){var Q=D;D=function(){var Ct=Dm(he);Q.call(Ct)}}var he=d9(g,D,d,0,null,!1,!1,"",E5);return d._reactRootContainer=he,d[ka]=he.current,cp(d.nodeType===8?d.parentNode:d),Ph(),he}for(;H=d.lastChild;)d.removeChild(H);if(typeof D=="function"){var ke=D;D=function(){var Ct=Dm(ze);ke.call(Ct)}}var ze=h9(d,0,!1,null,null,!1,!1,"",E5);return d._reactRootContainer=ze,d[ka]=ze.current,cp(d.nodeType===8?d.parentNode:d),Ph(function(){Nm(g,ze,E,D)}),ze}function Fm(d,g,E,D,H){var Q=E._reactRootContainer;if(Q){var he=Q;if(typeof H=="function"){var ke=H;H=function(){var ze=Dm(he);ke.call(ze)}}Nm(g,he,d,H)}else he=vy(E,g,d,H,D);return Dm(he)}dd=function(d){switch(d.tag){case 3:var g=d.stateNode;if(g.current.memoizedState.isDehydrated){var E=Ur(g.pendingLanes);E!==0&&(ks(g,E|1),_a(g,gt()),(Si&6)===0&&(Mu=gt()+500,_h()))}break;case 13:Ph(function(){var D=bu(d,1);if(D!==null){var H=js();p0(D,d,1,H)}}),f9(d,1)}},P1=function(d){if(d.tag===13){var g=bu(d,134217728);if(g!==null){var E=js();p0(g,d,134217728,E)}f9(d,134217728)}},ou=function(d){if(d.tag===13){var g=Ac(d),E=bu(d,g);if(E!==null){var D=js();p0(E,d,g,D)}f9(d,g)}},R1=function(){return ti},El=function(d,g){var E=ti;try{return ti=d,g()}finally{ti=E}},yn=function(d,g,E){switch(g){case"input":if(Ar(d,E),g=E.name,E.type==="radio"&&g!=null){for(E=d;E.parentNode;)E=E.parentNode;for(E=E.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<E.length;g++){var D=E[g];if(D!==d&&D.form===d.form){var H=vc(D);if(!H)throw Error(t(90));Mi(D),Ar(D,H)}}}break;case"textarea":pe(d,E);break;case"select":g=E.value,g!=null&&vr(d,!!E.multiple,g,!1)}},yr=o9,ki=Ph;var T5={usingClientEntryPoint:!1,Events:[vh,pu,vc,Wt,kn,o9]},Dp={findFiberByHostInstance:U0,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},g_={bundleType:Dp.bundleType,version:Dp.version,rendererPackageName:Dp.rendererPackageName,rendererConfig:Dp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=To(d),d===null?null:d.stateNode},findFiberByHostInstance:Dp.findFiberByHostInstance||gy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var g9=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!g9.isDisabled&&g9.supportsFiber)try{ar=g9.inject(g_),Bn=g9}catch{}}return $c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T5,$c.createPortal=function(d,g){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m9(g))throw Error(t(200));return my(d,g,null,E)},$c.createRoot=function(d,g){if(!m9(d))throw Error(t(299));var E=!1,D="",H=w5;return g!=null&&(g.unstable_strictMode===!0&&(E=!0),g.identifierPrefix!==void 0&&(D=g.identifierPrefix),g.onRecoverableError!==void 0&&(H=g.onRecoverableError)),g=h9(d,1,!1,null,null,E,!1,D,H),d[ka]=g.current,cp(d.nodeType===8?d.parentNode:d),new p9(g)},$c.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var g=d._reactInternals;if(g===void 0)throw typeof d.render=="function"?Error(t(188)):(d=Object.keys(d).join(","),Error(t(268,d)));return d=To(g),d=d===null?null:d.stateNode,d},$c.flushSync=function(d){return Ph(d)},$c.hydrate=function(d,g,E){if(!Lm(g))throw Error(t(200));return Fm(null,d,g,!0,E)},$c.hydrateRoot=function(d,g,E){if(!m9(d))throw Error(t(405));var D=E!=null&&E.hydratedSources||null,H=!1,Q="",he=w5;if(E!=null&&(E.unstable_strictMode===!0&&(H=!0),E.identifierPrefix!==void 0&&(Q=E.identifierPrefix),E.onRecoverableError!==void 0&&(he=E.onRecoverableError)),g=d9(g,null,d,1,E??null,H,!1,Q,he),d[ka]=g.current,cp(d),D)for(d=0;d<D.length;d++)E=D[d],H=E._getVersion,H=H(E._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[E,H]:g.mutableSourceEagerHydrationData.push(E,H);return new Om(g)},$c.render=function(d,g,E){if(!Lm(g))throw Error(t(200));return Fm(null,d,g,!1,E)},$c.unmountComponentAtNode=function(d){if(!Lm(d))throw Error(t(40));return d._reactRootContainer?(Ph(function(){Fm(null,null,d,!1,function(){d._reactRootContainer=null,d[ka]=null})}),!0):!1},$c.unstable_batchedUpdates=o9,$c.unstable_renderSubtreeIntoContainer=function(d,g,E,D){if(!Lm(E))throw Error(t(200));if(d==null||d._reactInternals===void 0)throw Error(t(38));return Fm(d,g,E,!1,D)},$c.version="18.3.1-next-f1338f8080-20240426",$c}var d9e;function oRe(){if(d9e)return aV.exports;d9e=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),aV.exports=sRe(),aV.exports}var f9e;function aRe(){if(f9e)return mR;f9e=1;var s=oRe();return mR.createRoot=s.createRoot,mR.hydrateRoot=s.hydrateRoot,mR}var lRe=aRe();const cRe=R8e(lRe);var jw={exports:{}},uV={},p9e;function rn(){return p9e||(p9e=1,function(s){var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,c=(le,we,We)=>we in le?e(le,we,{enumerable:!0,configurable:!0,writable:!0,value:We}):le[we]=We,u=(le,we)=>{for(var We in we||(we={}))i.call(we,We)&&c(le,We,we[We]);if(r)for(var We of r(we))a.call(we,We)&&c(le,We,we[We]);return le},p=(le,we)=>t(le,n(we)),y=le=>e(le,"__esModule",{value:!0}),x=(le,we)=>{y(le);for(var We in we)e(le,We,{get:we[We],enumerable:!0})};x(s,{Atom:()=>xd,PointerProxy:()=>h2,Ticker:()=>Nl,getPointerParts:()=>O0,isPointer:()=>Rl,isPrism:()=>mc,iterateAndCountTicks:()=>du,iterateOver:()=>np,pointer:()=>md,pointerToPrism:()=>fh,prism:()=>kl,val:()=>B0});var S=Array.isArray,M=S,I=typeof A0=="object"&&A0&&A0.Object===Object&&A0,L=I,B=typeof self=="object"&&self&&self.Object===Object&&self,A=L||B||Function("return this")(),V=A,X=V.Symbol,P=X,te=Object.prototype,oe=te.hasOwnProperty,ie=te.toString,K=P?P.toStringTag:void 0;function re(le){var we=oe.call(le,K),We=le[K];try{le[K]=void 0;var kt=!0}catch{}var pr=ie.call(le);return kt&&(we?le[K]=We:delete le[K]),pr}var se=re,q=Object.prototype,De=q.toString;function Be(le){return De.call(le)}var tt=Be,st="[object Null]",de="[object Undefined]",ft=P?P.toStringTag:void 0;function Se(le){return le==null?le===void 0?de:st:ft&&ft in Object(le)?se(le):tt(le)}var rt=Se;function ut(le){return le!=null&&typeof le=="object"}var Pe=ut,vt="[object Symbol]";function Bt(le){return typeof le=="symbol"||Pe(le)&&rt(le)==vt}var ct=Bt,Pt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,on=/^\w*$/;function Gt(le,we){if(M(le))return!1;var We=typeof le;return We=="number"||We=="symbol"||We=="boolean"||le==null||ct(le)?!0:on.test(le)||!Pt.test(le)||we!=null&&le in Object(we)}var hn=Gt;function Xn(le){var we=typeof le;return le!=null&&(we=="object"||we=="function")}var Fn=Xn,Kr="[object AsyncFunction]",Mi="[object Function]",Br="[object GeneratorFunction]",Ue="[object Proxy]";function Ii(le){if(!Fn(le))return!1;var we=rt(le);return we==Mi||we==Br||we==Kr||we==Ue}var ei=Ii,Ar=V["__core-js_shared__"],On=Ar,Yr=function(){var le=/[^.]+$/.exec(On&&On.keys&&On.keys.IE_PROTO||"");return le?"Symbol(src)_1."+le:""}();function Yn(le){return!!Yr&&Yr in le}var vr=Yn,Ci=Function.prototype,Ie=Ci.toString;function pe(le){if(le!=null){try{return Ie.call(le)}catch{}try{return le+""}catch{}}return""}var wt=pe,Vt=/[\\^$.*+?()[\]{}|]/g,qt=/^\[object .+?Constructor\]$/,Ot=Function.prototype,Kn=Object.prototype,vn=Ot.toString,Ln=Kn.hasOwnProperty,Qn=RegExp("^"+vn.call(Ln).replace(Vt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jt(le){if(!Fn(le)||vr(le))return!1;var we=ei(le)?Qn:qt;return we.test(wt(le))}var Rn=jt;function rr(le,we){return le==null?void 0:le[we]}var Jn=rr;function _n(le,we){var We=Jn(le,we);return Rn(We)?We:void 0}var tr=_n,je=tr(Object,"create"),yn=je;function Yt(){this.__data__=yn?yn(null):{},this.size=0}var wn=Yt;function tn(le){var we=this.has(le)&&delete this.__data__[le];return this.size-=we?1:0,we}var Wt=tn,kn="__lodash_hash_undefined__",yr=Object.prototype,ki=yr.hasOwnProperty;function hr(le){var we=this.__data__;if(yn){var We=we[le];return We===kn?void 0:We}return ki.call(we,le)?we[le]:void 0}var Qi=hr,Eo=Object.prototype,ru=Eo.hasOwnProperty;function I0(le){var we=this.__data__;return yn?we[le]!==void 0:ru.call(we,le)}var i0=I0,k0="__lodash_hash_undefined__";function iu(le,we){var We=this.__data__;return this.size+=this.has(le)?0:1,We[le]=yn&&we===void 0?k0:we,this}var su=iu;function ea(le){var we=-1,We=le==null?0:le.length;for(this.clear();++we<We;){var kt=le[we];this.set(kt[0],kt[1])}}ea.prototype.clear=wn,ea.prototype.delete=Wt,ea.prototype.get=Qi,ea.prototype.has=i0,ea.prototype.set=su;var ih=ea;function sh(){this.__data__=[],this.size=0}var zf=sh;function ao(le,we){return le===we||le!==le&&we!==we}var hd=ao;function fc(le,we){for(var We=le.length;We--;)if(hd(le[We][0],we))return We;return-1}var oh=fc,To=Array.prototype,va=To.splice;function Vf(le){var we=this.__data__,We=oh(we,le);if(We<0)return!1;var kt=we.length-1;return We==kt?we.pop():va.call(we,We,1),--this.size,!0}var ye=Vf;function at(le){var we=this.__data__,We=oh(we,le);return We<0?void 0:we[We][1]}var Tt=at;function gt(le){return oh(this.__data__,le)>-1}var lt=gt;function Kt(le,we){var We=this.__data__,kt=oh(We,le);return kt<0?(++this.size,We.push([le,we])):We[kt][1]=we,this}var bn=Kt;function Cn(le){var we=-1,We=le==null?0:le.length;for(this.clear();++we<We;){var kt=le[we];this.set(kt[0],kt[1])}}Cn.prototype.clear=zf,Cn.prototype.delete=ye,Cn.prototype.get=Tt,Cn.prototype.has=lt,Cn.prototype.set=bn;var Nn=Cn,fr=tr(V,"Map"),ar=fr;function Bn(){this.size=0,this.__data__={hash:new ih,map:new(ar||Nn),string:new ih}}var Pr=Bn;function _r(le){var we=typeof le;return we=="string"||we=="number"||we=="symbol"||we=="boolean"?le!=="__proto__":le===null}var Oi=_r;function is(le,we){var We=le.__data__;return Oi(we)?We[typeof we=="string"?"string":"hash"]:We.map}var Dr=is;function jn(le){var we=Dr(this,le).delete(le);return this.size-=we?1:0,we}var vs=jn;function Ur(le){return Dr(this,le).get(le)}var lo=Ur;function wl(le){return Dr(this,le).has(le)}var Mo=wl;function s0(le,we){var We=Dr(this,le),kt=We.size;return We.set(le,we),this.size+=We.size==kt?0:1,this}var Li=s0;function ys(le){var we=-1,We=le==null?0:le.length;for(this.clear();++we<We;){var kt=le[we];this.set(kt[0],kt[1])}}ys.prototype.clear=Pr,ys.prototype.delete=vs,ys.prototype.get=lo,ys.prototype.has=Mo,ys.prototype.set=Li;var xs=ys,co="Expected a function";function ks(le,we){if(typeof le!="function"||we!=null&&typeof we!="function")throw new TypeError(co);var We=function(){var kt=arguments,pr=we?we.apply(this,kt):kt[0],bi=We.cache;if(bi.has(pr))return bi.get(pr);var Uo=le.apply(this,kt);return We.cache=bi.set(pr,Uo)||bi,Uo};return We.cache=new(ks.Cache||xs),We}ks.Cache=xs;var ti=ks,Co=500;function dd(le){var we=ti(le,function(kt){return We.size===Co&&We.clear(),kt}),We=we.cache;return we}var P1=dd,ou=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,R1=/\\(\\)?/g,El=P1(function(le){var we=[];return le.charCodeAt(0)===46&&we.push(""),le.replace(ou,function(We,kt,pr,bi){we.push(pr?bi.replace(R1,"$1"):kt||We)}),we}),Gf=El;function jf(le,we){for(var We=-1,kt=le==null?0:le.length,pr=Array(kt);++We<kt;)pr[We]=we(le[We],We,le);return pr}var Tl=jf,ya=P?P.prototype:void 0,N0=ya?ya.toString:void 0;function au(le){if(typeof le=="string")return le;if(M(le))return Tl(le,au)+"";if(ct(le))return N0?N0.call(le):"";var we=le+"";return we=="0"&&1/le==-1/0?"-0":we}var ah=au;function Ml(le){return le==null?"":ah(le)}var Jg=Ml;function I1(le,we){return M(le)?le:hn(le,we)?[le]:Gf(Jg(le))}var fd=I1;function n4(le){if(typeof le=="string"||ct(le))return le;var we=le+"";return we=="0"&&1/le==-1/0?"-0":we}var pc=n4;function lu(le,we){we=fd(we,le);for(var We=0,kt=we.length;le!=null&&We<kt;)le=le[pc(we[We++])];return We&&We==kt?le:void 0}var e2=lu;function D0(le,we,We){var kt=le==null?void 0:e2(le,we);return kt===void 0?We:kt}var o0=D0;function lh(le,we){return function(We){return le(we(We))}}var Cl=lh,Hf=Cl(Object.getPrototypeOf,Object),k1=Hf,t2="[object Object]",Wf=Function.prototype,$f=Object.prototype,qf=Wf.toString,N1=$f.hasOwnProperty,Al=qf.call(Object);function Xf(le){if(!Pe(le)||rt(le)!=t2)return!1;var we=k1(le);if(we===null)return!0;var We=N1.call(we,"constructor")&&we.constructor;return typeof We=="function"&&We instanceof We&&qf.call(We)==Al}var ch=Xf;function D1(le){var we=le==null?0:le.length;return we?le[we-1]:void 0}var Yf=D1,Pl=new WeakMap,Kf=new WeakMap,uo=Symbol("pointerMeta"),cu={get(le,we){if(we===uo)return Pl.get(le);let We=Kf.get(le);We||(We=new Map,Kf.set(le,We));const kt=We.get(we);if(kt!==void 0)return kt;const pr=Pl.get(le),bi=pd({root:pr.root,path:[...pr.path,we]});return We.set(we,bi),bi}},Ia=le=>le[uo],O0=le=>{const{root:we,path:We}=Ia(le);return{root:we,path:We}};function pd(le){var we;const We={root:le.root,path:(we=le.path)!=null?we:[]},kt={};return Pl.set(kt,We),new Proxy(kt,cu)}var md=pd,Rl=le=>le&&!!Ia(le);function uu(le,we,We){return we.length===0?We(le):Il(le,we,We)}var Il=(le,we,We)=>{if(we.length===0)return We(le);if(Array.isArray(le)){let[kt,...pr]=we;kt=parseInt(String(kt),10),isNaN(kt)&&(kt=0);const bi=le[kt],Uo=Il(bi,pr,We);if(bi===Uo)return le;const a0=[...le];return a0.splice(kt,1,Uo),a0}else if(typeof le=="object"&&le!==null){const[kt,...pr]=we,bi=le[kt],Uo=Il(bi,pr,We);return bi===Uo?le:p(u({},le),{[kt]:Uo})}else{const[kt,...pr]=we;return{[kt]:Il(void 0,pr,We)}}},Vs=class{constructor(){this._head=void 0}peek(){return this._head&&this._head.data}pop(){const le=this._head;if(le)return this._head=le.next,le.data}push(le){const we={next:this._head,data:le};this._head=we}};function mc(le){return!!(le&&le.isPrism&&le.isPrism===!0)}function Zf(){const le=()=>{},we=new Vs,We=le;return{type:"Dataverse_discoveryMechanism",startIgnoringDependencies:()=>{we.push(We)},stopIgnoringDependencies:()=>{we.peek()!==We||we.pop()},reportResolutionStart:gc=>{const zo=we.peek();zo&&zo(gc),we.push(We)},reportResolutionEnd:gc=>{we.pop()},pushCollector:gc=>{we.push(gc)},popCollector:gc=>{if(we.peek()!==gc)throw new Error("Popped collector is not on top of the stack");we.pop()}}}function n2(){const le="__dataverse_discoveryMechanism_sharedStack",we=typeof window<"u"?window:typeof A0<"u"?A0:{};if(we){const We=we[le];if(We&&typeof We=="object"&&We.type==="Dataverse_discoveryMechanism")return We;{const kt=Zf();return we[le]=kt,kt}}else return Zf()}var{startIgnoringDependencies:L0,stopIgnoringDependencies:gd,reportResolutionEnd:r2,reportResolutionStart:i2,pushCollector:O1,popCollector:r4}=n2(),Qf=()=>{},i4=class{constructor(le,we){this._fn=le,this._prismInstance=we,this._didMarkDependentsAsStale=!1,this._isFresh=!1,this._cacheOfDendencyValues=new Map,this._dependents=new Set,this._dependencies=new Set,this._possiblyStaleDeps=new Set,this._scope=new ep(this),this._lastValue=void 0,this._forciblySetToStale=!1,this._reactToDependencyGoingStale=We=>{this._possiblyStaleDeps.add(We),this._markAsStale()};for(const We of this._dependencies)We._addDependent(this._reactToDependencyGoingStale);L0(),this.getValue(),gd()}get hasDependents(){return this._dependents.size>0}removeDependent(le){this._dependents.delete(le)}addDependent(le){this._dependents.add(le)}destroy(){for(const le of this._dependencies)le._removeDependent(this._reactToDependencyGoingStale);tp(this._scope)}getValue(){if(!this._isFresh){const le=this._recalculate();this._lastValue=le,this._isFresh=!0,this._didMarkDependentsAsStale=!1,this._forciblySetToStale=!1}return this._lastValue}_recalculate(){let le;if(!this._forciblySetToStale&&this._possiblyStaleDeps.size>0){let kt=!1;L0();for(const pr of this._possiblyStaleDeps)if(this._cacheOfDendencyValues.get(pr)!==pr.getValue()){kt=!0;break}if(gd(),this._possiblyStaleDeps.clear(),!kt)return this._lastValue}const we=new Set;this._cacheOfDendencyValues.clear();const We=kt=>{we.add(kt),this._addDependency(kt)};O1(We),Ao.push(this._scope);try{le=this._fn()}catch(kt){console.error(kt)}finally{Ao.pop()!==this._scope&&console.warn("The Prism hook stack has slipped. This is a bug.")}r4(We);for(const kt of this._dependencies)we.has(kt)||this._removeDependency(kt);this._dependencies=we,L0();for(const kt of we)this._cacheOfDendencyValues.set(kt,kt.getValue());return gd(),le}forceStale(){this._forciblySetToStale=!0,this._markAsStale()}_markAsStale(){if(!this._didMarkDependentsAsStale){this._didMarkDependentsAsStale=!0,this._isFresh=!1;for(const le of this._dependents)le(this._prismInstance)}}_addDependency(le){this._dependencies.has(le)||(this._dependencies.add(le),le._addDependent(this._reactToDependencyGoingStale))}_removeDependency(le){this._dependencies.has(le)&&(this._dependencies.delete(le),le._removeDependent(this._reactToDependencyGoingStale))}},L1={},Jf=class{constructor(le){this._fn=le,this.isPrism=!0,this._state={hot:!1,handle:void 0}}get isHot(){return this._state.hot}onChange(le,we,We=!1){const kt=()=>{le.onThisOrNextTick(bi)};let pr=L1;const bi=()=>{const a0=this.getValue();a0!==pr&&(pr=a0,we(a0))};return this._addDependent(kt),We&&(pr=this.getValue(),we(pr)),()=>{this._removeDependent(kt),le.offThisOrNextTick(bi),le.offNextTick(bi)}}onStale(le){const we=()=>{this._removeDependent(We)},We=()=>le();return this._addDependent(We),we}keepHot(){return this.onStale(()=>{})}_addDependent(le){this._state.hot||this._goHot(),this._state.handle.addDependent(le)}_goHot(){const le=new i4(this._fn,this);this._state={hot:!0,handle:le}}_removeDependent(le){const we=this._state;if(!we.hot)return;const We=we.handle;We.removeDependent(le),We.hasDependents||(this._state={hot:!1,handle:void 0},We.destroy())}getValue(){i2(this);const le=this._state;let we;return le.hot?we=le.handle.getValue():we=F0(this._fn),r2(this),we}},ep=class{constructor(le){this._hotHandle=le,this._refs=new Map,this.isPrismScope=!0,this.subs={},this.effects=new Map,this.memos=new Map}ref(le,we){let We=this._refs.get(le);if(We!==void 0)return We;{const kt={current:we};return this._refs.set(le,kt),kt}}effect(le,we,We){let kt=this.effects.get(le);kt===void 0&&(kt={cleanup:Qf,deps:void 0},this.effects.set(le,kt)),s2(kt.deps,We)&&(kt.cleanup(),L0(),kt.cleanup=vd(we,Qf).value,gd(),kt.deps=We)}memo(le,we,We){let kt=this.memos.get(le);return kt===void 0&&(kt={cachedValue:null,deps:void 0},this.memos.set(le,kt)),s2(kt.deps,We)&&(L0(),kt.cachedValue=vd(we,void 0).value,gd(),kt.deps=We),kt.cachedValue}state(le,we){const{value:We,setValue:kt}=this.memo("state/"+le,()=>{const pr={current:we};return{value:pr,setValue:Uo=>{pr.current=Uo,this._hotHandle.forceStale()}}},[]);return[We.current,kt]}sub(le){return this.subs[le]||(this.subs[le]=new ep(this._hotHandle)),this.subs[le]}cleanupEffects(){for(const le of this.effects.values())vd(le.cleanup,void 0);this.effects.clear()}source(le,we){return this.effect("$$source/blah",()=>le(()=>{this._hotHandle.forceStale()}),[le]),we()}};function tp(le){for(const we of Object.values(le.subs))tp(we);le.cleanupEffects()}function vd(le,we){try{return{value:le(),ok:!0}}catch(We){return setTimeout(function(){throw We}),{value:we,ok:!1}}}var Ao=new Vs;function s4(le,we){const We=Ao.peek();if(!We)throw new Error("prism.ref() is called outside of a prism() call.");return We.ref(le,we)}function yd(le,we,We){const kt=Ao.peek();if(!kt)throw new Error("prism.effect() is called outside of a prism() call.");return kt.effect(le,we,We)}function s2(le,we){if(le===void 0||we===void 0)return!0;const We=le.length;if(We!==we.length)return!0;for(let kt=0;kt<We;kt++)if(le[kt]!==we[kt])return!0;return!1}function o2(le,we,We){const kt=Ao.peek();if(!kt)throw new Error("prism.memo() is called outside of a prism() call.");return kt.memo(le,we,We)}function Bo(le,we){const We=Ao.peek();if(!We)throw new Error("prism.state() is called outside of a prism() call.");return We.state(le,we)}function a2(){if(!Ao.peek())throw new Error("The parent function is called outside of a prism() call.")}function o4(le,we){const We=Ao.peek();if(!We)throw new Error("prism.scope() is called outside of a prism() call.");const kt=We.sub(le);Ao.push(kt);const pr=vd(we,void 0).value;return Ao.pop(),pr}function l2(le,we,We){return o2(le,()=>_s(we),We).getValue()}function c2(){return!!Ao.peek()}function F1(le,we){const We=Ao.peek();if(!We)throw new Error("prism.source() is called outside of a prism() call.");return We.source(le,we)}var _s=le=>new Jf(le),uh=class{effect(le,we,We){console.warn("prism.effect() does not run in cold prisms")}memo(le,we,We){return we()}state(le,we){return[we,()=>{}]}ref(le,we){return{current:we}}sub(le){return new uh}source(le,we){return we()}};function F0(le){const we=new uh;Ao.push(we);let We;try{We=le()}catch(kt){console.error(kt)}finally{Ao.pop()!==we&&console.warn("The Prism hook stack has slipped. This is a bug.")}return We}_s.ref=s4,_s.effect=yd,_s.memo=o2,_s.ensurePrism=a2,_s.state=Bo,_s.scope=o4,_s.sub=l2,_s.inPrism=c2,_s.source=F1;var kl=_s,B1;(function(le){le[le.Dict=0]="Dict",le[le.Array=1]="Array",le[le.Other=2]="Other"})(B1||(B1={}));var mi=le=>Array.isArray(le)?1:ch(le)?0:2,hu=(le,we,We=mi(le))=>We===0&&typeof we=="string"||We===1&&hh(we)?le[we]:void 0,hh=le=>{const we=typeof le=="number"?le:parseInt(le,10);return!isNaN(we)&&we>=0&&we<1/0&&(we|0)===we},dh=class{constructor(le,we){this._parent=le,this._path=we,this.children=new Map,this.identityChangeListeners=new Set}addIdentityChangeListener(le){this.identityChangeListeners.add(le)}removeIdentityChangeListener(le){this.identityChangeListeners.delete(le),this._checkForGC()}removeChild(le){this.children.delete(le),this._checkForGC()}getChild(le){return this.children.get(le)}getOrCreateChild(le){let we=this.children.get(le);return we||(we=we=new dh(this,this._path.concat([le])),this.children.set(le,we)),we}_checkForGC(){this.identityChangeListeners.size>0||this.children.size>0||this._parent&&this._parent.removeChild(Yf(this._path))}},xd=class{constructor(le){this.$$isPointerToPrismProvider=!0,this.pointer=md({root:this,path:[]}),this.prism=this.pointerToPrism(this.pointer),this._onPointerValueChange=(we,We)=>{const{path:kt}=O0(we),pr=this._getOrCreateScopeForPath(kt);return pr.identityChangeListeners.add(We),()=>{pr.identityChangeListeners.delete(We)}},this._currentState=le,this._rootScope=new dh(void 0,[])}set(le){const we=this._currentState;this._currentState=le,this._checkUpdates(this._rootScope,we,le)}get(){return this._currentState}getByPointer(le){const we=Rl(le)?le:le(this.pointer),We=O0(we).path;return this._getIn(We)}_getIn(le){return le.length===0?this.get():o0(this.get(),le)}reduce(le){this.set(le(this.get()))}reduceByPointer(le,we){const We=Rl(le)?le:le(this.pointer),kt=O0(We).path,pr=uu(this.get(),kt,we);this.set(pr)}setByPointer(le,we){this.reduceByPointer(le,()=>we)}_checkUpdates(le,we,We){if(we===We)return;for(const bi of le.identityChangeListeners)bi(We);if(le.children.size===0)return;const kt=mi(we),pr=mi(We);if(!(kt===2&&kt===pr))for(const[bi,Uo]of le.children){const a0=hu(we,bi,kt),_d=hu(We,bi,pr);this._checkUpdates(Uo,a0,_d)}}_getOrCreateScopeForPath(le){let we=this._rootScope;for(const We of le)we=we.getOrCreateChild(We);return we}pointerToPrism(le){const{path:we}=O0(le),We=pr=>this._onPointerValueChange(le,pr),kt=()=>this._getIn(we);return kl(()=>kl.source(We,kt))}},u2=new WeakMap;function U1(le){return typeof le=="object"&&le!==null&&le.$$isPointerToPrismProvider===!0}var fh=le=>{const we=Ia(le);let We=u2.get(we);if(!We){const kt=we.root;if(!U1(kt))throw new Error("Cannot run pointerToPrism() on a pointer whose root is not an PointerToPrismProvider");We=kt.pointerToPrism(le),u2.set(we,We)}return We},B0=le=>Rl(le)?fh(le).getValue():mc(le)?le.getValue():le;function*du(le){let we;if(Rl(le))we=fh(le);else if(mc(le))we=le;else throw new Error("Only pointers and prisms are supported");let We=0;const kt=we.onStale(()=>{We++});try{for(;;){const pr=We;We=0,yield{value:we.getValue(),ticks:pr}}}finally{kt()}}var a4=60*3,Nl=class{constructor(le){this._conf=le,this._ticking=!1,this._dormant=!0,this._numberOfDormantTicks=0,this.__ticks=0,this._scheduledForThisOrNextTick=new Set,this._scheduledForNextTick=new Set,this._timeAtCurrentTick=0}get dormant(){return this._dormant}onThisOrNextTick(le){this._scheduledForThisOrNextTick.add(le),this._dormant&&this._goActive()}onNextTick(le){this._scheduledForNextTick.add(le),this._dormant&&this._goActive()}offThisOrNextTick(le){this._scheduledForThisOrNextTick.delete(le)}offNextTick(le){this._scheduledForNextTick.delete(le)}get time(){return this._ticking?this._timeAtCurrentTick:performance.now()}_goActive(){var le,we;this._dormant&&(this._dormant=!1,(we=(le=this._conf)==null?void 0:le.onActive)==null||we.call(le))}_goDormant(){var le,we;this._dormant||(this._dormant=!0,this._numberOfDormantTicks=0,(we=(le=this._conf)==null?void 0:le.onDormant)==null||we.call(le))}tick(le=performance.now()){if(this.__ticks++,!this._dormant&&this._scheduledForNextTick.size===0&&this._scheduledForThisOrNextTick.size===0&&(this._numberOfDormantTicks++,this._numberOfDormantTicks>=a4)){this._goDormant();return}this._ticking=!0,this._timeAtCurrentTick=le;for(const we of this._scheduledForNextTick)this._scheduledForThisOrNextTick.add(we);this._scheduledForNextTick.clear(),this._tick(0),this._ticking=!1}_tick(le){const we=this.time;if(le>10&&console.warn("_tick() recursing for 10 times"),le>100)throw new Error("Maximum recursion limit for _tick()");const We=this._scheduledForThisOrNextTick;this._scheduledForThisOrNextTick=new Set;for(const kt of We)kt(we);if(this._scheduledForThisOrNextTick.size>0)return this._tick(le+1)}};function*np(le){let we;if(Rl(le))we=fh(le);else if(mc(le))we=le;else throw new Error("Only pointers and prisms are supported");const We=new Nl,kt=we.onChange(We,pr=>{});try{for(;;)We.tick(),yield we.getValue()}finally{kt()}}var h2=class{constructor(le){this.$$isPointerToPrismProvider=!0,this._currentPointerBox=new xd(le),this.pointer=md({root:this,path:[]})}setPointer(le){this._currentPointerBox.set(le)}pointerToPrism(le){const{path:we}=Ia(le);return kl(()=>{const We=this._currentPointerBox.prism.getValue(),kt=we.reduce((pr,bi)=>pr[bi],We);return B0(kt)})}}}(uV)),uV}var Hw={exports:{}};Hw.exports;var m9e;function I8e(){return m9e||(m9e=1,function(s,e){var t=Object.create,n=Object.defineProperty,r=Object.defineProperties,i=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,S=(b,k,z)=>k in b?n(b,k,{enumerable:!0,configurable:!0,writable:!0,value:z}):b[k]=z,M=(b,k)=>{for(var z in k||(k={}))y.call(k,z)&&S(b,z,k[z]);if(u)for(var z of u(k))x.call(k,z)&&S(b,z,k[z]);return b},I=(b,k)=>r(b,a(k)),L=(b,k)=>function(){return k||(0,b[c(b)[0]])((k={exports:{}}).exports,k),k.exports},B=(b,k)=>{for(var z in k)n(b,z,{get:k[z],enumerable:!0})},A=(b,k,z,ee)=>{if(k&&typeof k=="object"||typeof k=="function")for(let ue of c(k))!y.call(b,ue)&&ue!==z&&n(b,ue,{get:()=>k[ue],enumerable:!(ee=i(k,ue))||ee.enumerable});return b},V=(b,k,z)=>(z=b!=null?t(p(b)):{},A(!b||!b.__esModule?n(z,"default",{value:b,enumerable:!0}):z,b)),X=b=>A(n({},"__esModule",{value:!0}),b),P=(b,k,z)=>(S(b,typeof k!="symbol"?k+"":k,z),z),te=L({"../node_modules/timing-function/lib/UnitBezier.js"(b,k){k.exports=function(){function z(ee,ue,ge,Le){this.set(ee,ue,ge,Le)}return z.prototype.set=function(ee,ue,ge,Le){this._cx=3*ee,this._bx=3*(ge-ee)-this._cx,this._ax=1-this._cx-this._bx,this._cy=3*ue,this._by=3*(Le-ue)-this._cy,this._ay=1-this._cy-this._by},z.epsilon=1e-6,z.prototype._sampleCurveX=function(ee){return((this._ax*ee+this._bx)*ee+this._cx)*ee},z.prototype._sampleCurveY=function(ee){return((this._ay*ee+this._by)*ee+this._cy)*ee},z.prototype._sampleCurveDerivativeX=function(ee){return(3*this._ax*ee+2*this._bx)*ee+this._cx},z.prototype._solveCurveX=function(ee,ue){var ge,Le,Je,mt,It,Jt;for(Je=void 0,mt=void 0,It=void 0,Jt=void 0,ge=void 0,Le=void 0,It=ee,Le=0;Le<8;){if(Jt=this._sampleCurveX(It)-ee,Math.abs(Jt)<ue)return It;if(ge=this._sampleCurveDerivativeX(It),Math.abs(ge)<ue)break;It=It-Jt/ge,Le++}if(Je=0,mt=1,It=ee,It<Je)return Je;if(It>mt)return mt;for(;Je<mt;){if(Jt=this._sampleCurveX(It),Math.abs(Jt-ee)<ue)return It;ee>Jt?Je=It:mt=It,It=(mt-Je)*.5+Je}return It},z.prototype.solve=function(ee,ue){return this._sampleCurveY(this._solveCurveX(ee,ue))},z.prototype.solveSimple=function(ee){return this._sampleCurveY(this._solveCurveX(ee,1e-6))},z}()}}),oe=L({"../node_modules/levenshtein-edit-distance/index.js"(b,k){var z,ee;z=[],ee=[];function ue(ge,Le,Je){var mt,It,Jt,an,En,Wn,Gn,Or;if(ge===Le)return 0;if(mt=ge.length,It=Le.length,mt===0)return It;if(It===0)return mt;for(Je&&(ge=ge.toLowerCase(),Le=Le.toLowerCase()),Gn=0;Gn<mt;)ee[Gn]=ge.charCodeAt(Gn),z[Gn]=++Gn;for(Or=0;Or<It;)for(Jt=Le.charCodeAt(Or),an=En=Or++,Gn=-1;++Gn<mt;)Wn=Jt===ee[Gn]?En:En+1,En=z[Gn],z[Gn]=an=En>an?Wn>an?an+1:Wn:Wn>En?En+1:Wn;return an}k.exports=ue}}),ie=L({"../node_modules/propose/propose.js"(b,k){var z=oe();function ee(){var ue,ge,Le,Je,mt,It=0,Jt=arguments[0],an=arguments[1],En=an.length,Wn=arguments[2];Wn&&(Je=Wn.threshold,mt=Wn.ignoreCase),Je===void 0&&(Je=0);for(var Gn=0;Gn<En;++Gn)mt?ge=z(Jt,an[Gn],!0):ge=z(Jt,an[Gn]),ge>Jt.length?ue=1-ge/an[Gn].length:ue=1-ge/Jt.length,ue>It&&(It=ue,Le=an[Gn]);return It>=Je?Le:null}k.exports=ee}}),K=L({"../node_modules/fast-deep-equal/index.js"(b,k){k.exports=function z(ee,ue){if(ee===ue)return!0;if(ee&&ue&&typeof ee=="object"&&typeof ue=="object"){if(ee.constructor!==ue.constructor)return!1;var ge,Le,Je;if(Array.isArray(ee)){if(ge=ee.length,ge!=ue.length)return!1;for(Le=ge;Le--!==0;)if(!z(ee[Le],ue[Le]))return!1;return!0}if(ee.constructor===RegExp)return ee.source===ue.source&&ee.flags===ue.flags;if(ee.valueOf!==Object.prototype.valueOf)return ee.valueOf()===ue.valueOf();if(ee.toString!==Object.prototype.toString)return ee.toString()===ue.toString();if(Je=Object.keys(ee),ge=Je.length,ge!==Object.keys(ue).length)return!1;for(Le=ge;Le--!==0;)if(!Object.prototype.hasOwnProperty.call(ue,Je[Le]))return!1;for(Le=ge;Le--!==0;){var mt=Je[Le];if(!z(ee[mt],ue[mt]))return!1}return!0}return ee!==ee&&ue!==ue}}}),re={};B(re,{createRafDriver:()=>Ay,getProject:()=>nM,notify:()=>Lp,onChange:()=>nb,types:()=>L_,val:()=>rb}),s.exports=X(re);var se={};B(se,{createRafDriver:()=>Ay,getProject:()=>nM,notify:()=>Lp,onChange:()=>nb,types:()=>L_,val:()=>rb});var q=rn(),De=class{constructor(){P(this,"atom",new q.Atom({projects:{}}))}add(b,k){this.atom.setByPointer(z=>z.projects[b],k)}get(b){return this.atom.get().projects[b]}has(b){return!!this.get(b)}},Be=new De,tt=Be,st=new WeakMap;function de(b){return st.get(b)}function ft(b,k){st.set(b,k)}var Se=[],rt=Array.isArray,ut=rt,Pe=typeof A0=="object"&&A0&&A0.Object===Object&&A0,vt=Pe,Bt=typeof self=="object"&&self&&self.Object===Object&&self,ct=vt||Bt||Function("return this")(),Pt=ct,on=Pt.Symbol,Gt=on,hn=Object.prototype,Xn=hn.hasOwnProperty,Fn=hn.toString,Kr=Gt?Gt.toStringTag:void 0;function Mi(b){var k=Xn.call(b,Kr),z=b[Kr];try{b[Kr]=void 0;var ee=!0}catch{}var ue=Fn.call(b);return ee&&(k?b[Kr]=z:delete b[Kr]),ue}var Br=Mi,Ue=Object.prototype,Ii=Ue.toString;function ei(b){return Ii.call(b)}var Ar=ei,On="[object Null]",Yr="[object Undefined]",Yn=Gt?Gt.toStringTag:void 0;function vr(b){return b==null?b===void 0?Yr:On:Yn&&Yn in Object(b)?Br(b):Ar(b)}var Ci=vr;function Ie(b){return b!=null&&typeof b=="object"}var pe=Ie,wt="[object Symbol]";function Vt(b){return typeof b=="symbol"||pe(b)&&Ci(b)==wt}var qt=Vt,Ot=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Kn=/^\w*$/;function vn(b,k){if(ut(b))return!1;var z=typeof b;return z=="number"||z=="symbol"||z=="boolean"||b==null||qt(b)?!0:Kn.test(b)||!Ot.test(b)||k!=null&&b in Object(k)}var Ln=vn;function Qn(b){var k=typeof b;return b!=null&&(k=="object"||k=="function")}var jt=Qn,Rn="[object AsyncFunction]",rr="[object Function]",Jn="[object GeneratorFunction]",_n="[object Proxy]";function tr(b){if(!jt(b))return!1;var k=Ci(b);return k==rr||k==Jn||k==Rn||k==_n}var je=tr,yn=Pt["__core-js_shared__"],Yt=yn,wn=function(){var b=/[^.]+$/.exec(Yt&&Yt.keys&&Yt.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}();function tn(b){return!!wn&&wn in b}var Wt=tn,kn=Function.prototype,yr=kn.toString;function ki(b){if(b!=null){try{return yr.call(b)}catch{}try{return b+""}catch{}}return""}var hr=ki,Qi=/[\\^$.*+?()[\]{}|]/g,Eo=/^\[object .+?Constructor\]$/,ru=Function.prototype,I0=Object.prototype,i0=ru.toString,k0=I0.hasOwnProperty,iu=RegExp("^"+i0.call(k0).replace(Qi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function su(b){if(!jt(b)||Wt(b))return!1;var k=je(b)?iu:Eo;return k.test(hr(b))}var ea=su;function ih(b,k){return b==null?void 0:b[k]}var sh=ih;function zf(b,k){var z=sh(b,k);return ea(z)?z:void 0}var ao=zf,hd=ao(Object,"create"),fc=hd;function oh(){this.__data__=fc?fc(null):{},this.size=0}var To=oh;function va(b){var k=this.has(b)&&delete this.__data__[b];return this.size-=k?1:0,k}var Vf=va,ye="__lodash_hash_undefined__",at=Object.prototype,Tt=at.hasOwnProperty;function gt(b){var k=this.__data__;if(fc){var z=k[b];return z===ye?void 0:z}return Tt.call(k,b)?k[b]:void 0}var lt=gt,Kt=Object.prototype,bn=Kt.hasOwnProperty;function Cn(b){var k=this.__data__;return fc?k[b]!==void 0:bn.call(k,b)}var Nn=Cn,fr="__lodash_hash_undefined__";function ar(b,k){var z=this.__data__;return this.size+=this.has(b)?0:1,z[b]=fc&&k===void 0?fr:k,this}var Bn=ar;function Pr(b){var k=-1,z=b==null?0:b.length;for(this.clear();++k<z;){var ee=b[k];this.set(ee[0],ee[1])}}Pr.prototype.clear=To,Pr.prototype.delete=Vf,Pr.prototype.get=lt,Pr.prototype.has=Nn,Pr.prototype.set=Bn;var _r=Pr;function Oi(){this.__data__=[],this.size=0}var is=Oi;function Dr(b,k){return b===k||b!==b&&k!==k}var jn=Dr;function vs(b,k){for(var z=b.length;z--;)if(jn(b[z][0],k))return z;return-1}var Ur=vs,lo=Array.prototype,wl=lo.splice;function Mo(b){var k=this.__data__,z=Ur(k,b);if(z<0)return!1;var ee=k.length-1;return z==ee?k.pop():wl.call(k,z,1),--this.size,!0}var s0=Mo;function Li(b){var k=this.__data__,z=Ur(k,b);return z<0?void 0:k[z][1]}var ys=Li;function xs(b){return Ur(this.__data__,b)>-1}var co=xs;function ks(b,k){var z=this.__data__,ee=Ur(z,b);return ee<0?(++this.size,z.push([b,k])):z[ee][1]=k,this}var ti=ks;function Co(b){var k=-1,z=b==null?0:b.length;for(this.clear();++k<z;){var ee=b[k];this.set(ee[0],ee[1])}}Co.prototype.clear=is,Co.prototype.delete=s0,Co.prototype.get=ys,Co.prototype.has=co,Co.prototype.set=ti;var dd=Co,P1=ao(Pt,"Map"),ou=P1;function R1(){this.size=0,this.__data__={hash:new _r,map:new(ou||dd),string:new _r}}var El=R1;function Gf(b){var k=typeof b;return k=="string"||k=="number"||k=="symbol"||k=="boolean"?b!=="__proto__":b===null}var jf=Gf;function Tl(b,k){var z=b.__data__;return jf(k)?z[typeof k=="string"?"string":"hash"]:z.map}var ya=Tl;function N0(b){var k=ya(this,b).delete(b);return this.size-=k?1:0,k}var au=N0;function ah(b){return ya(this,b).get(b)}var Ml=ah;function Jg(b){return ya(this,b).has(b)}var I1=Jg;function fd(b,k){var z=ya(this,b),ee=z.size;return z.set(b,k),this.size+=z.size==ee?0:1,this}var n4=fd;function pc(b){var k=-1,z=b==null?0:b.length;for(this.clear();++k<z;){var ee=b[k];this.set(ee[0],ee[1])}}pc.prototype.clear=El,pc.prototype.delete=au,pc.prototype.get=Ml,pc.prototype.has=I1,pc.prototype.set=n4;var lu=pc,e2="Expected a function";function D0(b,k){if(typeof b!="function"||k!=null&&typeof k!="function")throw new TypeError(e2);var z=function(){var ee=arguments,ue=k?k.apply(this,ee):ee[0],ge=z.cache;if(ge.has(ue))return ge.get(ue);var Le=b.apply(this,ee);return z.cache=ge.set(ue,Le)||ge,Le};return z.cache=new(D0.Cache||lu),z}D0.Cache=lu;var o0=D0,lh=500;function Cl(b){var k=o0(b,function(ee){return z.size===lh&&z.clear(),ee}),z=k.cache;return k}var Hf=Cl,k1=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t2=/\\(\\)?/g,Wf=Hf(function(b){var k=[];return b.charCodeAt(0)===46&&k.push(""),b.replace(k1,function(z,ee,ue,ge){k.push(ue?ge.replace(t2,"$1"):ee||z)}),k}),$f=Wf;function qf(b,k){for(var z=-1,ee=b==null?0:b.length,ue=Array(ee);++z<ee;)ue[z]=k(b[z],z,b);return ue}var N1=qf,Al=Gt?Gt.prototype:void 0,Xf=Al?Al.toString:void 0;function ch(b){if(typeof b=="string")return b;if(ut(b))return N1(b,ch)+"";if(qt(b))return Xf?Xf.call(b):"";var k=b+"";return k=="0"&&1/b==-1/0?"-0":k}var D1=ch;function Yf(b){return b==null?"":D1(b)}var Pl=Yf;function Kf(b,k){return ut(b)?b:Ln(b,k)?[b]:$f(Pl(b))}var uo=Kf;function cu(b){if(typeof b=="string"||qt(b))return b;var k=b+"";return k=="0"&&1/b==-1/0?"-0":k}var Ia=cu;function O0(b,k){k=uo(k,b);for(var z=0,ee=k.length;b!=null&&z<ee;)b=b[Ia(k[z++])];return z&&z==ee?b:void 0}var pd=O0;function md(b,k,z){var ee=b==null?void 0:pd(b,k);return ee===void 0?z:ee}var Rl=md;function uu(b,k){return k.length===0?b:Rl(b,k)}var Il=class{constructor(){P(this,"_values",{})}get(b,k){if(this.has(b))return this._values[b];{const z=k();return this._values[b]=z,z}}has(b){return this._values.hasOwnProperty(b)}},Vs=rn(),mc=function(){try{var b=ao(Object,"defineProperty");return b({},"",{}),b}catch{}}(),Zf=mc;function n2(b,k,z){k=="__proto__"&&Zf?Zf(b,k,{configurable:!0,enumerable:!0,value:z,writable:!0}):b[k]=z}var L0=n2,gd=Object.prototype,r2=gd.hasOwnProperty;function i2(b,k,z){var ee=b[k];(!(r2.call(b,k)&&jn(ee,z))||z===void 0&&!(k in b))&&L0(b,k,z)}var O1=i2,r4=9007199254740991,Qf=/^(?:0|[1-9]\d*)$/;function i4(b,k){var z=typeof b;return k=k??r4,!!k&&(z=="number"||z!="symbol"&&Qf.test(b))&&b>-1&&b%1==0&&b<k}var L1=i4;function Jf(b,k,z,ee){if(!jt(b))return b;k=uo(k,b);for(var ue=-1,ge=k.length,Le=ge-1,Je=b;Je!=null&&++ue<ge;){var mt=Ia(k[ue]),It=z;if(mt==="__proto__"||mt==="constructor"||mt==="prototype")return b;if(ue!=Le){var Jt=Je[mt];It=ee?ee(Jt,mt,Je):void 0,It===void 0&&(It=jt(Jt)?Jt:L1(k[ue+1])?[]:{})}O1(Je,mt,It),Je=Je[mt]}return b}var ep=Jf;function tp(b,k,z){return b==null?b:ep(b,k,z)}var vd=tp,Ao=new WeakMap;function s4(b){return yd(b)}function yd(b){if(Ao.has(b))return Ao.get(b);const k=b.type==="compound"?o2(b):b.type==="enum"?s2(b):b.default;return Ao.set(b,k),k}function s2(b){const k={$case:b.defaultCase};for(const[z,ee]of Object.entries(b.cases))k[z]=yd(ee);return k}function o2(b){const k={};for(const[z,ee]of Object.entries(b.props))k[z]=yd(ee);return k}var Bo=rn(),a2=V(te());function o4(b,k,z){return(0,Bo.prism)(()=>{const ee=(0,Bo.val)(k);return Bo.prism.memo("driver",()=>ee?ee.type==="BasicKeyframedTrack"?l2(b,ee,z):(b.logger.error("Track type not yet supported."),(0,Bo.prism)(()=>{})):(0,Bo.prism)(()=>{}),[ee]).getValue()})}function l2(b,k,z){return(0,Bo.prism)(()=>{let ee=Bo.prism.ref("state",{started:!1}),ue=ee.current;const ge=z.getValue();return(!ue.started||ge<ue.validFrom||ue.validTo<=ge)&&(ee.current=ue=F1(b,z,k)),ue.der.getValue()})}var c2=(0,Bo.prism)(()=>{});function F1(b,k,z){const ee=k.getValue();if(z.keyframes.length===0)return{started:!0,validFrom:-1/0,validTo:1/0,der:c2};let ue=0;for(;;){const ge=z.keyframes[ue];if(!ge)return _s.error;const Le=ue===z.keyframes.length-1;if(ee<ge.position)return ue===0?_s.beforeFirstKeyframe(ge):_s.error;if(ge.position===ee)return Le?_s.lastKeyframe(ge):_s.between(ge,z.keyframes[ue+1],k);if(ue===z.keyframes.length-1)return _s.lastKeyframe(ge);{const Je=ue+1;if(z.keyframes[Je].position<=ee){ue=Je;continue}else return _s.between(ge,z.keyframes[ue+1],k)}}}var _s={beforeFirstKeyframe(b){return{started:!0,validFrom:-1/0,validTo:b.position,der:(0,Bo.prism)(()=>({left:b.value,progression:0}))}},lastKeyframe(b){return{started:!0,validFrom:b.position,validTo:1/0,der:(0,Bo.prism)(()=>({left:b.value,progression:0}))}},between(b,k,z){if(!b.connectedRight)return{started:!0,validFrom:b.position,validTo:k.position,der:(0,Bo.prism)(()=>({left:b.value,progression:0}))};const ee=ge=>(ge-b.position)/(k.position-b.position);if(!b.type||b.type==="bezier"){const ge=new a2.default(b.handles[2],b.handles[3],k.handles[0],k.handles[1]),Le=(0,Bo.prism)(()=>{const Je=ee(z.getValue()),mt=ge.solveSimple(Je);return{left:b.value,right:k.value,progression:mt}});return{started:!0,validFrom:b.position,validTo:k.position,der:Le}}const ue=(0,Bo.prism)(()=>{const ge=ee(z.getValue()),Le=Math.floor(ge);return{left:b.value,right:k.value,progression:Le}});return{started:!0,validFrom:b.position,validTo:k.position,der:ue}},error:{started:!0,validFrom:-1/0,validTo:1/0,der:c2}};function uh(b,k,z){const ue=z.get(b);if(ue&&ue.override===k)return ue.merged;const ge=M({},b);for(const Le of Object.keys(k)){const Je=k[Le],mt=b[Le];ge[Le]=typeof Je=="object"&&typeof mt=="object"?uh(mt,Je,z):Je===void 0?mt:Je}return z.set(b,{override:k,merged:ge}),ge}function F0(b,k){let z=b;for(const ee of k)z=z[ee];return z}var kl=rn(),B1=(b,k)=>{const z=kl.prism.memo(b,()=>new kl.Atom(k),[]);return z.set(k),z},mi=rn(),hu=rn(),hh=/\s/;function dh(b){for(var k=b.length;k--&&hh.test(b.charAt(k)););return k}var xd=dh,u2=/^\s+/;function U1(b){return b&&b.slice(0,xd(b)+1).replace(u2,"")}var fh=U1,B0=NaN,du=/^[-+]0x[0-9a-f]+$/i,a4=/^0b[01]+$/i,Nl=/^0o[0-7]+$/i,np=parseInt;function h2(b){if(typeof b=="number")return b;if(qt(b))return B0;if(jt(b)){var k=typeof b.valueOf=="function"?b.valueOf():b;b=jt(k)?k+"":k}if(typeof b!="string")return b===0?b:+b;b=fh(b);var z=a4.test(b);return z||Nl.test(b)?np(b.slice(2),z?2:8):du.test(b)?B0:+b}var le=h2,we=1/0,We=17976931348623157e292;function kt(b){if(!b)return b===0?b:0;if(b=le(b),b===we||b===-we){var k=b<0?-1:1;return k*We}return b===b?b:0}var pr=kt;function bi(b){var k=pr(b),z=k%1;return k===k?z?k-z:k:0}var Uo=bi;function a0(b){return b}var _d=a0,gc=ao(Pt,"WeakMap"),zo=gc,Dl=Object.create,rp=function(){function b(){}return function(k){if(!jt(k))return{};if(Dl)return Dl(k);b.prototype=k;var z=new b;return b.prototype=void 0,z}}(),kv=rp;function d2(b,k){var z=-1,ee=b.length;for(k||(k=Array(ee));++z<ee;)k[z]=b[z];return k}var Nv=d2;function l4(b,k){for(var z=-1,ee=b==null?0:b.length;++z<ee&&k(b[z],z,b)!==!1;);return b}var Dv=l4;function f2(b,k,z,ee){var ue=!z;z||(z={});for(var ge=-1,Le=k.length;++ge<Le;){var Je=k[ge],mt=ee?ee(z[Je],b[Je],Je,z,b):void 0;mt===void 0&&(mt=b[Je]),ue?L0(z,Je,mt):O1(z,Je,mt)}return z}var Ol=f2,c4=9007199254740991;function ip(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=c4}var z1=ip;function Ov(b){return b!=null&&z1(b.length)&&!je(b)}var sp=Ov,ph=Object.prototype;function u4(b){var k=b&&b.constructor,z=typeof k=="function"&&k.prototype||ph;return b===z}var op=u4;function V1(b,k){for(var z=-1,ee=Array(b);++z<b;)ee[z]=k(z);return ee}var h4=V1,d4="[object Arguments]";function G1(b){return pe(b)&&Ci(b)==d4}var j1=G1,f4=Object.prototype,p4=f4.hasOwnProperty,mh=f4.propertyIsEnumerable,H1=j1(function(){return arguments}())?j1:function(b){return pe(b)&&p4.call(b,"callee")&&!mh.call(b,"callee")},ap=H1;function Lv(){return!1}var m4=Lv,bd=e&&!e.nodeType&&e,g4=bd&&!0&&s&&!s.nodeType&&s,lp=g4&&g4.exports===bd,W1=lp?Pt.Buffer:void 0,us=W1?W1.isBuffer:void 0,p2=us||m4,gh=p2,cp="[object Arguments]",v4="[object Array]",m2="[object Boolean]",up="[object Date]",$1="[object Error]",Sd="[object Function]",y4="[object Map]",Fv="[object Number]",Bv="[object Object]",x4="[object RegExp]",q1="[object Set]",X1="[object String]",g2="[object WeakMap]",v2="[object ArrayBuffer]",y2="[object DataView]",x2="[object Float32Array]",Uv="[object Float64Array]",_4="[object Int8Array]",zv="[object Int16Array]",Vv="[object Int32Array]",_2="[object Uint8Array]",fu="[object Uint8ClampedArray]",Ji="[object Uint16Array]",wd="[object Uint32Array]",gi={};gi[x2]=gi[Uv]=gi[_4]=gi[zv]=gi[Vv]=gi[_2]=gi[fu]=gi[Ji]=gi[wd]=!0,gi[cp]=gi[v4]=gi[v2]=gi[m2]=gi[y2]=gi[up]=gi[$1]=gi[Sd]=gi[y4]=gi[Fv]=gi[Bv]=gi[x4]=gi[q1]=gi[X1]=gi[g2]=!1;function Y1(b){return pe(b)&&z1(b.length)&&!!gi[Ci(b)]}var ka=Y1;function Ed(b){return function(k){return b(k)}}var K1=Ed,Td=e&&!e.nodeType&&e,U0=Td&&!0&&s&&!s.nodeType&&s,vh=U0&&U0.exports===Td,pu=vh&&vt.process,vc=function(){try{var b=U0&&U0.require&&U0.require("util").types;return b||pu&&pu.binding&&pu.binding("util")}catch{}}(),yc=vc,mu=yc&&yc.isTypedArray,gu=mu?K1(mu):ka,Hi=gu,es=Object.prototype,yh=es.hasOwnProperty;function Vo(b,k){var z=ut(b),ee=!z&&ap(b),ue=!z&&!ee&&gh(b),ge=!z&&!ee&&!ue&&Hi(b),Le=z||ee||ue||ge,Je=Le?h4(b.length,String):[],mt=Je.length;for(var It in b)(k||yh.call(b,It))&&!(Le&&(It=="length"||ue&&(It=="offset"||It=="parent")||ge&&(It=="buffer"||It=="byteLength"||It=="byteOffset")||L1(It,mt)))&&Je.push(It);return Je}var ta=Vo;function vu(b,k){return function(z){return b(k(z))}}var xh=vu,Na=xh(Object.keys,Object),hp=Na,b4=Object.prototype,S4=b4.hasOwnProperty;function Z1(b){if(!op(b))return hp(b);var k=[];for(var z in Object(b))S4.call(b,z)&&z!="constructor"&&k.push(z);return k}var Gv=Z1;function yu(b){return sp(b)?ta(b):Gv(b)}var xu=yu;function b2(b){var k=[];if(b!=null)for(var z in Object(b))k.push(z);return k}var w4=b2,l_=Object.prototype,_h=l_.hasOwnProperty;function Ll(b){if(!jt(b))return w4(b);var k=op(b),z=[];for(var ee in b)ee=="constructor"&&(k||!_h.call(b,ee))||z.push(ee);return z}var xc=Ll;function S2(b){return sp(b)?ta(b,!0):xc(b)}var Md=S2;function z0(b,k){for(var z=-1,ee=k.length,ue=b.length;++z<ee;)b[ue+z]=k[z];return b}var l0=z0,bh=xh(Object.getPrototypeOf,Object),V0=bh,_c="[object Object]",Cd=Function.prototype,jv=Object.prototype,Ad=Cd.toString,Q1=jv.hasOwnProperty,c0=Ad.call(Object);function Da(b){if(!pe(b)||Ci(b)!=_c)return!1;var k=V0(b);if(k===null)return!0;var z=Q1.call(k,"constructor")&&k.constructor;return typeof z=="function"&&z instanceof z&&Ad.call(z)==c0}var hs=Da;function Oa(b,k,z){var ee=-1,ue=b.length;k<0&&(k=-k>ue?0:ue+k),z=z>ue?ue:z,z<0&&(z+=ue),ue=k>z?0:z-k>>>0,k>>>=0;for(var ge=Array(ue);++ee<ue;)ge[ee]=b[ee+k];return ge}var J1=Oa;function E4(b,k,z){var ee=b.length;return z=z===void 0?ee:z,!k&&z>=ee?b:J1(b,k,z)}var Sh=E4,dp="\\ud800-\\udfff",Hv="\\u0300-\\u036f",em="\\ufe20-\\ufe2f",Wv="\\u20d0-\\u20ff",fp=Hv+em+Wv,w2="\\ufe0e\\ufe0f",c_="\\u200d",tm=RegExp("["+c_+dp+fp+w2+"]");function nm(b){return tm.test(b)}var rm=nm;function T4(b){return b.split("")}var Pd=T4,M4="\\ud800-\\udfff",E2="\\u0300-\\u036f",im="\\ufe20-\\ufe2f",Rd="\\u20d0-\\u20ff",T2=E2+im+Rd,C4="\\ufe0e\\ufe0f",A4="["+M4+"]",pp="["+T2+"]",_u="\\ud83c[\\udffb-\\udfff]",G0="(?:"+pp+"|"+_u+")",u0="[^"+M4+"]",mp="(?:\\ud83c[\\udde6-\\uddff]){2}",P4="[\\ud800-\\udbff][\\udc00-\\udfff]",bu="\\u200d",bc=G0+"?",M2="["+C4+"]?",$v="(?:"+bu+"(?:"+[u0,mp,P4].join("|")+")"+M2+bc+")*",h0=M2+bc+$v,Fl="(?:"+[u0+pp+"?",pp,mp,P4,A4].join("|")+")",C2=RegExp(_u+"(?="+_u+")|"+Fl+h0,"g");function R4(b){return b.match(C2)||[]}var sm=R4;function I4(b){return rm(b)?sm(b):Pd(b)}var om=I4;function Sc(b,k,z){return b===b&&(z!==void 0&&(b=b<=z?b:z),k!==void 0&&(b=b>=k?b:k)),b}var gp=Sc;function am(b,k,z){return z===void 0&&(z=k,k=void 0),z!==void 0&&(z=le(z),z=z===z?z:0),k!==void 0&&(k=le(k),k=k===k?k:0),gp(le(b),k,z)}var wh=am;function A2(){this.__data__=new dd,this.size=0}var vp=A2;function qv(b){var k=this.__data__,z=k.delete(b);return this.size=k.size,z}var P2=qv;function Cs(b){return this.__data__.get(b)}var Su=Cs;function Id(b){return this.__data__.has(b)}var yp=Id,lm=200;function Eh(b,k){var z=this.__data__;if(z instanceof dd){var ee=z.__data__;if(!ou||ee.length<lm-1)return ee.push([b,k]),this.size=++z.size,this;z=this.__data__=new lu(ee)}return z.set(b,k),this.size=z.size,this}var wu=Eh;function Wi(b){var k=this.__data__=new dd(b);this.size=k.size}Wi.prototype.clear=vp,Wi.prototype.delete=P2,Wi.prototype.get=Su,Wi.prototype.has=yp,Wi.prototype.set=wu;var bs=Wi;function Po(b,k){return b&&Ol(k,xu(k),b)}var R2=Po;function xp(b,k){return b&&Ol(k,Md(k),b)}var cm=xp,Xv=e&&!e.nodeType&&e,Gs=Xv&&!0&&s&&!s.nodeType&&s,_p=Gs&&Gs.exports===Xv,I2=_p?Pt.Buffer:void 0,um=I2?I2.allocUnsafe:void 0;function wc(b,k){if(k)return b.slice();var z=b.length,ee=um?um(z):new b.constructor(z);return b.copy(ee),ee}var j0=wc;function bp(b,k){for(var z=-1,ee=b==null?0:b.length,ue=0,ge=[];++z<ee;){var Le=b[z];k(Le,z,b)&&(ge[ue++]=Le)}return ge}var k4=bp;function N4(){return[]}var k2=N4,Yv=Object.prototype,Kv=Yv.propertyIsEnumerable,N2=Object.getOwnPropertySymbols,Zv=N2?function(b){return b==null?[]:(b=Object(b),k4(N2(b),function(k){return Kv.call(b,k)}))}:k2,Eu=Zv;function Sp(b,k){return Ol(b,Eu(b),k)}var D2=Sp,kd=Object.getOwnPropertySymbols,D4=kd?function(b){for(var k=[];b;)l0(k,Eu(b)),b=V0(b);return k}:k2,Nd=D4;function hm(b,k){return Ol(b,Nd(b),k)}var Qv=hm;function O2(b,k,z){var ee=k(b);return ut(b)?ee:l0(ee,z(b))}var L2=O2;function Jv(b){return L2(b,xu,Eu)}var dm=Jv;function O4(b){return L2(b,Md,Nd)}var F2=O4,L4=ao(Pt,"DataView"),B2=L4,ey=ao(Pt,"Promise"),wp=ey,F4=ao(Pt,"Set"),B4=F4,fm="[object Map]",U2="[object Object]",U4="[object Promise]",z2="[object Set]",Ec="[object WeakMap]",Ep="[object DataView]",u_=hr(B2),V2=hr(ou),d0=hr(wp),z4=hr(B4),Tc=hr(zo),H0=Ci;(B2&&H0(new B2(new ArrayBuffer(1)))!=Ep||ou&&H0(new ou)!=fm||wp&&H0(wp.resolve())!=U4||B4&&H0(new B4)!=z2||zo&&H0(new zo)!=Ec)&&(H0=function(b){var k=Ci(b),z=k==U2?b.constructor:void 0,ee=z?hr(z):"";if(ee)switch(ee){case u_:return Ep;case V2:return fm;case d0:return U4;case z4:return z2;case Tc:return Ec}return k});var Tp=H0,pm=Object.prototype,mm=pm.hasOwnProperty;function Mp(b){var k=b.length,z=new b.constructor(k);return k&&typeof b[0]=="string"&&mm.call(b,"index")&&(z.index=b.index,z.input=b.input),z}var gm=Mp,G2=Pt.Uint8Array,j2=G2;function V4(b){var k=new b.constructor(b.byteLength);return new j2(k).set(new j2(b)),k}var vm=V4;function ty(b,k){var z=k?vm(b.buffer):b.buffer;return new b.constructor(z,b.byteOffset,b.byteLength)}var G4=ty,ym=/\w*$/;function j4(b){var k=new b.constructor(b.source,ym.exec(b));return k.lastIndex=b.lastIndex,k}var La=j4,Go=Gt?Gt.prototype:void 0,H2=Go?Go.valueOf:void 0;function H4(b){return H2?Object(H2.call(b)):{}}var W2=H4;function W4(b,k){var z=k?vm(b.buffer):b.buffer;return new b.constructor(z,b.byteOffset,b.length)}var $4=W4,Cp="[object Boolean]",q4="[object Date]",X4="[object Map]",Y4="[object Number]",K4="[object RegExp]",$2="[object Set]",Z4="[object String]",ny="[object Symbol]",q2="[object ArrayBuffer]",X2="[object DataView]",h_="[object Float32Array]",Bi="[object Float64Array]",Dd="[object Int8Array]",ry="[object Int16Array]",xm="[object Int32Array]",Tu="[object Uint8Array]",d_="[object Uint8ClampedArray]",Q4="[object Uint16Array]",J4="[object Uint32Array]";function iy(b,k,z){var ee=b.constructor;switch(k){case q2:return vm(b);case Cp:case q4:return new ee(+b);case X2:return G4(b,z);case h_:case Bi:case Dd:case ry:case xm:case Tu:case d_:case Q4:case J4:return $4(b,z);case X4:return new ee;case Y4:case Z4:return new ee(b);case K4:return La(b);case $2:return new ee;case ny:return W2(b)}}var e5=iy;function _m(b){return typeof b.constructor=="function"&&!op(b)?kv(V0(b)):{}}var na=_m,sy="[object Map]";function f_(b){return pe(b)&&Tp(b)==sy}var Y2=f_,Ro=yc&&yc.isMap,oy=Ro?K1(Ro):Y2,Un=oy,Bl="[object Set]";function Th(b){return pe(b)&&Tp(b)==Bl}var K2=Th,ay=yc&&yc.isSet,Ap=ay?K1(ay):K2,Z2=Ap,t5=1,n5=2,ly=4,r5="[object Arguments]",bm="[object Array]",Sm="[object Boolean]",Io="[object Date]",f0="[object Error]",Ul="[object Function]",i5="[object GeneratorFunction]",cy="[object Map]",zl="[object Number]",Q2="[object Object]",Mc="[object RegExp]",p_="[object Set]",J2="[object String]",s5="[object Symbol]",o5="[object WeakMap]",a5="[object ArrayBuffer]",l5="[object DataView]",wm="[object Float32Array]",Pp="[object Float64Array]",Fa="[object Int8Array]",Si="[object Int16Array]",ho="[object Int32Array]",Js="[object Uint8Array]",ko="[object Uint8ClampedArray]",Ba="[object Uint16Array]",Mh="[object Uint32Array]",Tr={};Tr[r5]=Tr[bm]=Tr[a5]=Tr[l5]=Tr[Sm]=Tr[Io]=Tr[wm]=Tr[Pp]=Tr[Fa]=Tr[Si]=Tr[ho]=Tr[cy]=Tr[zl]=Tr[Q2]=Tr[Mc]=Tr[p_]=Tr[J2]=Tr[s5]=Tr[Js]=Tr[ko]=Tr[Ba]=Tr[Mh]=!0,Tr[f0]=Tr[Ul]=Tr[o5]=!1;function Ch(b,k,z,ee,ue,ge){var Le,Je=k&t5,mt=k&n5,It=k&ly;if(z&&(Le=ue?z(b,ee,ue,ge):z(b)),Le!==void 0)return Le;if(!jt(b))return b;var Jt=ut(b);if(Jt){if(Le=gm(b),!Je)return Nv(b,Le)}else{var an=Tp(b),En=an==Ul||an==i5;if(gh(b))return j0(b,Je);if(an==Q2||an==r5||En&&!ue){if(Le=mt||En?{}:na(b),!Je)return mt?Qv(b,cm(Le,b)):D2(b,R2(Le,b))}else{if(!Tr[an])return ue?b:{};Le=e5(b,an,Je)}}ge||(ge=new bs);var Wn=ge.get(b);if(Wn)return Wn;ge.set(b,Le),Z2(b)?b.forEach(function(Wr){Le.add(Ch(Wr,k,z,Wr,b,ge))}):Un(b)&&b.forEach(function(Wr,Mr){Le.set(Mr,Ch(Wr,k,z,Mr,b,ge))});var Gn=It?mt?F2:dm:mt?Md:xu,Or=Jt?void 0:Gn(b);return Dv(Or||b,function(Wr,Mr){Or&&(Mr=Wr,Wr=b[Mr]),O1(Le,Mr,Ch(Wr,k,z,Mr,b,ge))}),Le}var Ah=Ch,e9=1,c5=4;function Od(b){return Ah(b,e9|c5)}var xa=Od,u5="__lodash_hash_undefined__";function Mu(b){return this.__data__.set(b,u5),this}var Cc=Mu;function t9(b){return this.__data__.has(b)}var n9=t9;function Vl(b){var k=-1,z=b==null?0:b.length;for(this.__data__=new lu;++k<z;)this.add(b[k])}Vl.prototype.add=Vl.prototype.push=Cc,Vl.prototype.has=n9;var Em=Vl;function Gl(b,k){for(var z=-1,ee=b==null?0:b.length;++z<ee;)if(k(b[z],z,b))return!0;return!1}var r9=Gl;function Rp(b,k){return b.has(k)}var Ip=Rp,i9=1,Tm=2;function js(b,k,z,ee,ue,ge){var Le=z&i9,Je=b.length,mt=k.length;if(Je!=mt&&!(Le&&mt>Je))return!1;var It=ge.get(b),Jt=ge.get(k);if(It&&Jt)return It==k&&Jt==b;var an=-1,En=!0,Wn=z&Tm?new Em:void 0;for(ge.set(b,k),ge.set(k,b);++an<Je;){var Gn=b[an],Or=k[an];if(ee)var Wr=Le?ee(Or,Gn,an,k,b,ge):ee(Gn,Or,an,b,k,ge);if(Wr!==void 0){if(Wr)continue;En=!1;break}if(Wn){if(!r9(k,function(Mr,Ai){if(!Ip(Wn,Ai)&&(Gn===Mr||ue(Gn,Mr,z,ee,ge)))return Wn.push(Ai)})){En=!1;break}}else if(!(Gn===Or||ue(Gn,Or,z,ee,ge))){En=!1;break}}return ge.delete(b),ge.delete(k),En}var Ac=js;function p0(b){var k=-1,z=Array(b.size);return b.forEach(function(ee,ue){z[++k]=[ue,ee]}),z}var _a=p0;function s9(b){var k=-1,z=Array(b.size);return b.forEach(function(ee){z[++k]=ee}),z}var Mm=s9,Cm=1,h5=2,Cu="[object Boolean]",d5="[object Date]",o9="[object Error]",Ph="[object Map]",a9="[object Number]",Ua="[object RegExp]",Ld="[object Set]",Am="[object String]",f5="[object Symbol]",Pm="[object ArrayBuffer]",uy="[object DataView]",p5=Gt?Gt.prototype:void 0,l9=p5?p5.valueOf:void 0;function m5(b,k,z,ee,ue,ge,Le){switch(z){case uy:if(b.byteLength!=k.byteLength||b.byteOffset!=k.byteOffset)return!1;b=b.buffer,k=k.buffer;case Pm:return!(b.byteLength!=k.byteLength||!ge(new j2(b),new j2(k)));case Cu:case d5:case a9:return jn(+b,+k);case o9:return b.name==k.name&&b.message==k.message;case Ua:case Am:return b==k+"";case Ph:var Je=_a;case Ld:var mt=ee&Cm;if(Je||(Je=Mm),b.size!=k.size&&!mt)return!1;var It=Le.get(b);if(It)return It==k;ee|=h5,Le.set(b,k);var Jt=Ac(Je(b),Je(k),ee,ue,ge,Le);return Le.delete(b),Jt;case f5:if(l9)return l9.call(b)==l9.call(k)}return!1}var jl=m5,hy=1,kp=Object.prototype,Rm=kp.hasOwnProperty;function Ss(b,k,z,ee,ue,ge){var Le=z&hy,Je=dm(b),mt=Je.length,It=dm(k),Jt=It.length;if(mt!=Jt&&!Le)return!1;for(var an=mt;an--;){var En=Je[an];if(!(Le?En in k:Rm.call(k,En)))return!1}var Wn=ge.get(b),Gn=ge.get(k);if(Wn&&Gn)return Wn==k&&Gn==b;var Or=!0;ge.set(b,k),ge.set(k,b);for(var Wr=Le;++an<mt;){En=Je[an];var Mr=b[En],Ai=k[En];if(ee)var jo=Le?ee(Ai,Mr,En,k,b,ge):ee(Mr,Ai,En,b,k,ge);if(!(jo===void 0?Mr===Ai||ue(Mr,Ai,z,ee,ge):jo)){Or=!1;break}Wr||(Wr=En=="constructor")}if(Or&&!Wr){var to=b.constructor,po=k.constructor;to!=po&&"constructor"in b&&"constructor"in k&&!(typeof to=="function"&&to instanceof to&&typeof po=="function"&&po instanceof po)&&(Or=!1)}return ge.delete(b),ge.delete(k),Or}var m_=Ss,g5=1,dy="[object Arguments]",fy="[object Array]",Np="[object Object]",v5=Object.prototype,py=v5.hasOwnProperty;function W0(b,k,z,ee,ue,ge){var Le=ut(b),Je=ut(k),mt=Le?fy:Tp(b),It=Je?fy:Tp(k);mt=mt==dy?Np:mt,It=It==dy?Np:It;var Jt=mt==Np,an=It==Np,En=mt==It;if(En&&gh(b)){if(!gh(k))return!1;Le=!0,Jt=!1}if(En&&!Jt)return ge||(ge=new bs),Le||Hi(b)?Ac(b,k,z,ee,ue,ge):jl(b,k,mt,z,ee,ue,ge);if(!(z&g5)){var Wn=Jt&&py.call(b,"__wrapped__"),Gn=an&&py.call(k,"__wrapped__");if(Wn||Gn){var Or=Wn?b.value():b,Wr=Gn?k.value():k;return ge||(ge=new bs),ue(Or,Wr,z,ee,ge)}}return En?(ge||(ge=new bs),m_(b,k,z,ee,ue,ge)):!1}var Im=W0;function c9(b,k,z,ee,ue){return b===k?!0:b==null||k==null||!pe(b)&&!pe(k)?b!==b&&k!==k:Im(b,k,z,ee,c9,ue)}var Pc=c9,u9=1,Fd=2;function km(b,k,z,ee){var ue=z.length,ge=ue,Le=!ee;if(b==null)return!ge;for(b=Object(b);ue--;){var Je=z[ue];if(Le&&Je[2]?Je[1]!==b[Je[0]]:!(Je[0]in b))return!1}for(;++ue<ge;){Je=z[ue];var mt=Je[0],It=b[mt],Jt=Je[1];if(Le&&Je[2]){if(It===void 0&&!(mt in b))return!1}else{var an=new bs;if(ee)var En=ee(It,Jt,mt,b,k,an);if(!(En===void 0?Pc(Jt,It,u9|Fd,ee,an):En))return!1}}return!0}var y5=km;function x5(b){return b===b&&!jt(b)}var _5=x5;function h9(b){for(var k=xu(b),z=k.length;z--;){var ee=k[z],ue=b[ee];k[z]=[ee,ue,_5(ue)]}return k}var my=h9;function b5(b,k){return function(z){return z==null?!1:z[b]===k&&(k!==void 0||b in Object(z))}}var d9=b5;function Nm(b){var k=my(b);return k.length==1&&k[0][2]?d9(k[0][0],k[0][1]):function(z){return z===b||y5(z,b,k)}}var Dm=Nm;function S5(b,k){return b!=null&&k in Object(b)}var f9=S5;function gy(b,k,z){k=uo(k,b);for(var ee=-1,ue=k.length,ge=!1;++ee<ue;){var Le=Ia(k[ee]);if(!(ge=b!=null&&z(b,Le)))break;b=b[Le]}return ge||++ee!=ue?ge:(ue=b==null?0:b.length,!!ue&&z1(ue)&&L1(Le,ue)&&(ut(b)||ap(b)))}var w5=gy;function p9(b,k){return b!=null&&w5(b,k,f9)}var Om=p9,m9=1,Lm=2;function E5(b,k){return Ln(b)&&_5(k)?d9(Ia(b),k):function(z){var ee=Rl(z,b);return ee===void 0&&ee===k?Om(z,b):Pc(k,ee,m9|Lm)}}var vy=E5;function Fm(b){return function(k){return k==null?void 0:k[b]}}var T5=Fm;function Dp(b){return function(k){return pd(k,b)}}var g_=Dp;function g9(b){return Ln(b)?T5(Ia(b)):g_(b)}var d=g9;function g(b){return typeof b=="function"?b:b==null?_d:typeof b=="object"?ut(b)?vy(b[0],b[1]):Dm(b):d(b)}var E=g;function D(b){return function(k,z,ee){for(var ue=-1,ge=Object(k),Le=ee(k),Je=Le.length;Je--;){var mt=Le[b?Je:++ue];if(z(ge[mt],mt,ge)===!1)break}return k}}var H=D,Q=H(),he=Q;function ke(b,k){return b&&he(b,k,xu)}var ze=ke,Ct=function(){return Pt.Date.now()},Qt=Ct,cn="Expected a function",Zt=Math.max,Dn=Math.min;function zn(b,k,z){var ee,ue,ge,Le,Je,mt,It=0,Jt=!1,an=!1,En=!0;if(typeof b!="function")throw new TypeError(cn);k=le(k)||0,jt(z)&&(Jt=!!z.leading,an="maxWait"in z,ge=an?Zt(le(z.maxWait)||0,k):ge,En="trailing"in z?!!z.trailing:En);function Wn(Ui){var No=ee,za=ue;return ee=ue=void 0,It=Ui,Le=b.apply(za,No),Le}function Gn(Ui){return It=Ui,Je=setTimeout(Mr,k),Jt?Wn(Ui):Le}function Or(Ui){var No=Ui-mt,za=Ui-It,X0=k-No;return an?Dn(X0,ge-za):X0}function Wr(Ui){var No=Ui-mt,za=Ui-It;return mt===void 0||No>=k||No<0||an&&za>=ge}function Mr(){var Ui=Qt();if(Wr(Ui))return Ai(Ui);Je=setTimeout(Mr,Or(Ui))}function Ai(Ui){return Je=void 0,En&&ee?Wn(Ui):(ee=ue=void 0,Le)}function jo(){Je!==void 0&&clearTimeout(Je),It=0,ee=mt=ue=Je=void 0}function to(){return Je===void 0?Le:Ai(Qt())}function po(){var Ui=Qt(),No=Wr(Ui);if(ee=arguments,ue=this,mt=Ui,No){if(Je===void 0)return Gn(mt);if(an)return clearTimeout(Je),Je=setTimeout(Mr,k),Wn(mt)}return Je===void 0&&(Je=setTimeout(Mr,k)),Le}return po.cancel=jo,po.flush=to,po}var Hn=zn;function Ns(b){var k=b==null?0:b.length;return k?b[k-1]:void 0}var yt=Ns;function Qe(b,k){return k.length<2?b:pd(b,J1(k,0,-1))}var St=Qe;function fn(b){return typeof b=="number"&&b==Uo(b)}var er=fn;function dr(b,k){var z={};return k=E(k),ze(b,function(ee,ue,ge){L0(z,ue,k(ee,ue,ge))}),z}var mr=dr;function br(b,k){return k=uo(k,b),b=St(b,k),b==null||delete b[Ia(yt(k))]}var fo=br,wi=9007199254740991,Rc=Math.floor;function yy(b,k){var z="";if(!b||k<1||k>wi)return z;do k%2&&(z+=b),k=Rc(k/2),k&&(b+=b);while(k);return z}var v_=yy,WE=T5("length"),y_=WE,x_="\\ud800-\\udfff",$E="\\u0300-\\u036f",qE="\\ufe20-\\ufe2f",XE="\\u20d0-\\u20ff",YE=$E+qE+XE,KE="\\ufe0e\\ufe0f",ZE="["+x_+"]",xy="["+YE+"]",_y="\\ud83c[\\udffb-\\udfff]",QE="(?:"+xy+"|"+_y+")",__="[^"+x_+"]",b_="(?:\\ud83c[\\udde6-\\uddff]){2}",S_="[\\ud800-\\udbff][\\udc00-\\udfff]",JE="\\u200d",w_=QE+"?",E_="["+KE+"]?",ds="(?:"+JE+"(?:"+[__,b_,S_].join("|")+")"+E_+w_+")*",eT=E_+w_+ds,mN="(?:"+[__+xy+"?",xy,b_,S_,ZE].join("|")+")",tT=RegExp(_y+"(?="+_y+")|"+mN+eT,"g");function nT(b){for(var k=tT.lastIndex=0;tT.test(b);)++k;return k}var rT=nT;function iT(b){return rm(b)?rT(b):y_(b)}var sT=iT,gN=Math.ceil;function oT(b,k){k=k===void 0?" ":D1(k);var z=k.length;if(z<2)return z?v_(k,b):k;var ee=v_(k,gN(b/sT(k)));return rm(k)?Sh(om(ee),0,b).join(""):ee.slice(0,b)}var aT=oT;function vN(b,k,z){b=Pl(b),k=Uo(k);var ee=k?sT(b):0;return k&&ee<k?aT(k-ee,z)+b:b}var M5=vN;function lT(b,k){return b==null?!0:fo(b,k)}var cT=lT,by=5*1e3,T_=class{constructor(b){P(this,"_cache",new Il),P(this,"_keepHotUntapDebounce"),ft(this,b)}get type(){return"Theatre_SheetObject_PublicAPI"}get props(){return de(this).propsP}get sheet(){return de(this).sheet.publicApi}get project(){return de(this).sheet.project.publicApi}get address(){return M({},de(this).address)}_valuesPrism(){return this._cache.get("_valuesPrism",()=>{const b=de(this);return(0,hu.prism)(()=>(0,hu.val)(b.getValues().getValue()))})}onValuesChange(b,k){return nb(this._valuesPrism(),b,k)}get value(){const b=this._valuesPrism();{if(!b.isHot){this._keepHotUntapDebounce!=null&&this._keepHotUntapDebounce.flush();const k=b.keepHot();this._keepHotUntapDebounce=Hn(()=>{k(),this._keepHotUntapDebounce=void 0},by)}this._keepHotUntapDebounce&&this._keepHotUntapDebounce()}return b.getValue()}set initialValue(b){de(this).setInitialValue(b)}};function uT(b){const k=new WeakMap;return z=>(k.has(z)||k.set(z,b(z)),k.get(z))}function Sy(b){return b.type==="compound"||b.type==="enum"}function wy(b,k){if(!b)return;const[z,...ee]=k;if(z===void 0)return b;if(!Sy(b))return;const ue=b.type==="enum"?b.cases[z]:b.props[z];return wy(ue,ee)}function yN(b){return!Sy(b)}var xN=class{constructor(b,k,z){this.sheet=b,this.template=k,this.nativeObject=z,P(this,"$$isPointerToPrismProvider",!0),P(this,"address"),P(this,"publicApi"),P(this,"_initialValue",new mi.Atom({})),P(this,"_cache",new Il),P(this,"_logger"),P(this,"_internalUtilCtx"),this._logger=b._logger.named("SheetObject",k.address.objectKey),this._logger._trace("creating object"),this._internalUtilCtx={logger:this._logger.utilFor.internal()},this.address=I(M({},k.address),{sheetInstanceId:b.address.sheetInstanceId}),this.publicApi=new T_(this)}get type(){return"Theatre_SheetObject"}getValues(){return this._cache.get("getValues()",()=>(0,mi.prism)(()=>{const b=(0,mi.val)(this.template.getDefaultValues()),k=(0,mi.val)(this._initialValue.pointer),z=mi.prism.memo("withInitialCache",()=>new WeakMap,[]),ee=uh(b,k,z),ue=(0,mi.val)(this.template.getStaticValues()),ge=mi.prism.memo("withStatics",()=>new WeakMap,[]);let Je=uh(ee,ue,ge),mt;{const Jt=mi.prism.memo("seq",()=>this.getSequencedValues(),[]),an=mi.prism.memo("withSeqsCache",()=>new WeakMap,[]);mt=(0,mi.val)((0,mi.val)(Jt)),Je=uh(Je,mt,an)}return B1("finalAtom",Je).pointer}))}getValueByPointer(b){const k=(0,mi.val)(this.getValues()),{path:z}=(0,mi.getPointerParts)(b);return(0,mi.val)(F0(k,z))}pointerToPrism(b){const{path:k}=(0,mi.getPointerParts)(b);return(0,mi.prism)(()=>{const z=(0,mi.val)(this.getValues());return(0,mi.val)(F0(z,k))})}getSequencedValues(){return(0,mi.prism)(()=>{const b=mi.prism.memo("tracksToProcess",()=>this.template.getArrayOfValidSequenceTracks(),[]),k=(0,mi.val)(b),z=new mi.Atom({}),ee=(0,mi.val)(this.template.configPointer);return mi.prism.effect("processTracks",()=>{const ue=[];for(const{trackId:ge,pathToProp:Le}of k){const Je=this._trackIdToPrism(ge),mt=wy(ee,Le),It=mt.deserializeAndSanitize,Jt=mt.interpolate,an=()=>{const Wn=Je.getValue();if(!Wn)return z.setByPointer(Ai=>F0(Ai,Le),void 0);const Gn=It(Wn.left),Or=Gn===void 0?mt.default:Gn;if(Wn.right===void 0)return z.setByPointer(Ai=>F0(Ai,Le),Or);const Wr=It(Wn.right),Mr=Wr===void 0?mt.default:Wr;return z.setByPointer(Ai=>F0(Ai,Le),Jt(Or,Mr,Wn.progression))},En=Je.onStale(an);an(),ue.push(En)}return()=>{for(const ge of ue)ge()}},[ee,...k]),z.pointer})}_trackIdToPrism(b){const k=this.template.project.pointers.historic.sheetsById[this.address.sheetId].sequence.tracksByObject[this.address.objectKey].trackData[b],z=this.sheet.getSequence().positionPrism;return o4(this._internalUtilCtx,k,z)}get propsP(){return this._cache.get("propsP",()=>(0,mi.pointer)({root:this,path:[]}))}validateValue(b,k){}setInitialValue(b){this.validateValue(this.propsP,b),this._initialValue.set(b)}};function ss(b){return function(z,ee){return b(z,ee())}}var $0={_hmm:Hl(524),_todo:Hl(522),_error:Hl(521),errorDev:Hl(529),errorPublic:Hl(545),_kapow:Hl(268),_warn:Hl(265),warnDev:Hl(273),warnPublic:Hl(289),_debug:Hl(137),debugDev:Hl(145),_trace:Hl(73),traceDev:Hl(81)};function Hl(b){return Object.freeze({audience:Op(b,8)?"internal":Op(b,16)?"dev":"public",category:Op(b,4)?"troubleshooting":Op(b,2)?"todo":"general",level:Op(b,512)?512:Op(b,256)?256:Op(b,128)?128:64})}function Op(b,k){return(b&k)===k}function fs(b,k){return((k&32)===32?!0:(k&16)===16?b.dev:(k&8)===8?b.internal:!1)&&b.min<=k}var Au={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(b,k,z){return this.create({names:[...b.names,{name:k,key:z}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(b){if(b.length<5)return b;const k=b.replace(this.collapseOnRE,"");return this.cssMemo.has(k)||this.cssMemo.set(k,this.css(b)),k},css(b){var k,z,ee,ue;const ge=this.cssMemo.get(b);if(ge)return ge;let Le="color:".concat((z=(k=this.color)==null?void 0:k.call(this,b))!=null?z:"hsl(".concat((b.charCodeAt(0)+b.charCodeAt(b.length-1))%360,", 100%, 60%)"));return(ee=this.bold)!=null&&ee.test(b)&&(Le+=";font-weight:600"),(ue=this.italic)!=null&&ue.test(b)&&(Le+=";font-style:italic"),this.cssMemo.set(b,Le),Le}}};function M_(b=console,k={}){const z=I(M({},Au),{includes:M({},Au.includes)}),ee={styled:bN.bind(z,b),noStyle:Ey.bind(z,b)},ue=hT.bind(z);function ge(){return z.loggingConsoleStyle&&z.loggerConsoleStyle?ee.styled:ee.noStyle}return z.create=ge(),{configureLogger(Le){var Je;Le==="console"?(z.loggerConsoleStyle=Au.loggerConsoleStyle,z.create=ge()):Le.type==="console"?(z.loggerConsoleStyle=(Je=Le.style)!=null?Je:Au.loggerConsoleStyle,z.create=ge()):Le.type==="keyed"?(z.creatExt=mt=>Le.keyed(mt.names),z.create=ue):Le.type==="named"&&(z.creatExt=_N.bind(null,Le.named),z.create=ue)},configureLogging(Le){var Je,mt,It,Jt,an;z.includes.dev=(Je=Le.dev)!=null?Je:Au.includes.dev,z.includes.internal=(mt=Le.internal)!=null?mt:Au.includes.internal,z.includes.min=(It=Le.min)!=null?It:Au.includes.min,z.include=(Jt=Le.include)!=null?Jt:Au.include,z.loggingConsoleStyle=(an=Le.consoleStyle)!=null?an:Au.loggingConsoleStyle,z.create=ge()},getLogger(){return z.create({names:[]})}}}function _N(b,k){const z=[];for(let{name:ee,key:ue}of k.names)z.push(ue==null?ee:"".concat(ee," (").concat(ue,")"));return b(z)}function hT(b){const k=M(M({},this.includes),this.include(b)),z=this.filtered,ee=this.named.bind(this,b),ue=this.creatExt(b),ge=fs(k,524),Le=fs(k,522),Je=fs(k,521),mt=fs(k,529),It=fs(k,545),Jt=fs(k,265),an=fs(k,268),En=fs(k,273),Wn=fs(k,289),Gn=fs(k,137),Or=fs(k,145),Wr=fs(k,73),Mr=fs(k,81),Ai=ge?ue.error.bind(ue,$0._hmm):z.bind(b,524),jo=Le?ue.error.bind(ue,$0._todo):z.bind(b,522),to=Je?ue.error.bind(ue,$0._error):z.bind(b,521),po=mt?ue.error.bind(ue,$0.errorDev):z.bind(b,529),Ui=It?ue.error.bind(ue,$0.errorPublic):z.bind(b,545),No=an?ue.warn.bind(ue,$0._kapow):z.bind(b,268),za=Jt?ue.warn.bind(ue,$0._warn):z.bind(b,265),X0=En?ue.warn.bind(ue,$0.warnDev):z.bind(b,273),Pu=Wn?ue.warn.bind(ue,$0.warnPublic):z.bind(b,273),Ru=Gn?ue.debug.bind(ue,$0._debug):z.bind(b,137),Nh=Or?ue.debug.bind(ue,$0.debugDev):z.bind(b,145),Ic=Wr?ue.trace.bind(ue,$0._trace):z.bind(b,73),ra=Mr?ue.trace.bind(ue,$0.traceDev):z.bind(b,81),os={_hmm:Ai,_todo:jo,_error:to,errorDev:po,errorPublic:Ui,_kapow:No,_warn:za,warnDev:X0,warnPublic:Pu,_debug:Ru,debugDev:Nh,_trace:Ic,traceDev:ra,lazy:{_hmm:ge?ss(Ai):Ai,_todo:Le?ss(jo):jo,_error:Je?ss(to):to,errorDev:mt?ss(po):po,errorPublic:It?ss(Ui):Ui,_kapow:an?ss(No):No,_warn:Jt?ss(za):za,warnDev:En?ss(X0):X0,warnPublic:Wn?ss(Pu):Pu,_debug:Gn?ss(Ru):Ru,debugDev:Or?ss(Nh):Nh,_trace:Wr?ss(Ic):Ic,traceDev:Mr?ss(ra):ra},named:ee,utilFor:{internal(){return{debug:os._debug,error:os._error,warn:os._warn,trace:os._trace,named(Do,ts){return os.named(Do,ts).utilFor.internal()}}},dev(){return{debug:os.debugDev,error:os.errorDev,warn:os.warnDev,trace:os.traceDev,named(Do,ts){return os.named(Do,ts).utilFor.dev()}}},public(){return{error:os.errorPublic,warn:os.warnPublic,debug(Do,ts){os._warn('(public "debug" filtered out) '.concat(Do),ts)},trace(Do,ts){os._warn('(public "trace" filtered out) '.concat(Do),ts)},named(Do,ts){return os.named(Do,ts).utilFor.public()}}}}};return os}function bN(b,k){const z=M(M({},this.includes),this.include(k)),ee=[];let ue="";for(let mt=0;mt<k.names.length;mt++){const{name:It,key:Jt}=k.names[mt];if(ue+=" %c".concat(It),ee.push(this.style.css(It)),Jt!=null){const an="%c#".concat(Jt);ue+=an,ee.push(this.style.css(an))}}const ge=this.filtered,Le=this.named.bind(this,k),Je=[ue,...ee];return Ty(ge,k,z,b,Je,SN(Je),Le)}function SN(b){const k=b.slice(0);for(let z=1;z<k.length;z++)k[z]+=";background-color:#e0005a;padding:2px;color:white";return k}function Ey(b,k){const z=M(M({},this.includes),this.include(k));let ee="";for(let Je=0;Je<k.names.length;Je++){const{name:mt,key:It}=k.names[Je];ee+=" ".concat(mt),It!=null&&(ee+="#".concat(It))}const ue=this.filtered,ge=this.named.bind(this,k),Le=[ee];return Ty(ue,k,z,b,Le,Le,ge)}function Ty(b,k,z,ee,ue,ge,Le){const Je=fs(z,524),mt=fs(z,522),It=fs(z,521),Jt=fs(z,529),an=fs(z,545),En=fs(z,265),Wn=fs(z,268),Gn=fs(z,273),Or=fs(z,289),Wr=fs(z,137),Mr=fs(z,145),Ai=fs(z,73),jo=fs(z,81),to=Je?ee.error.bind(ee,...ue):b.bind(k,524),po=mt?ee.error.bind(ee,...ue):b.bind(k,522),Ui=It?ee.error.bind(ee,...ue):b.bind(k,521),No=Jt?ee.error.bind(ee,...ue):b.bind(k,529),za=an?ee.error.bind(ee,...ue):b.bind(k,545),X0=Wn?ee.warn.bind(ee,...ge):b.bind(k,268),Pu=En?ee.warn.bind(ee,...ue):b.bind(k,265),Ru=Gn?ee.warn.bind(ee,...ue):b.bind(k,273),Nh=Or?ee.warn.bind(ee,...ue):b.bind(k,273),Ic=Wr?ee.info.bind(ee,...ue):b.bind(k,137),ra=Mr?ee.info.bind(ee,...ue):b.bind(k,145),os=Ai?ee.debug.bind(ee,...ue):b.bind(k,73),Do=jo?ee.debug.bind(ee,...ue):b.bind(k,81),ts={_hmm:to,_todo:po,_error:Ui,errorDev:No,errorPublic:za,_kapow:X0,_warn:Pu,warnDev:Ru,warnPublic:Nh,_debug:Ic,debugDev:ra,_trace:os,traceDev:Do,lazy:{_hmm:Je?ss(to):to,_todo:mt?ss(po):po,_error:It?ss(Ui):Ui,errorDev:Jt?ss(No):No,errorPublic:an?ss(za):za,_kapow:Wn?ss(X0):X0,_warn:En?ss(Pu):Pu,warnDev:Gn?ss(Ru):Ru,warnPublic:Or?ss(Nh):Nh,_debug:Wr?ss(Ic):Ic,debugDev:Mr?ss(ra):ra,_trace:Ai?ss(os):os,traceDev:jo?ss(Do):Do},named:Le,utilFor:{internal(){return{debug:ts._debug,error:ts._error,warn:ts._warn,trace:ts._trace,named(Ds,zd){return ts.named(Ds,zd).utilFor.internal()}}},dev(){return{debug:ts.debugDev,error:ts.errorDev,warn:ts.warnDev,trace:ts.traceDev,named(Ds,zd){return ts.named(Ds,zd).utilFor.dev()}}},public(){return{error:ts.errorPublic,warn:ts.warnPublic,debug(Ds,zd){ts._warn('(public "debug" filtered out) '.concat(Ds),zd)},trace(Ds,zd){ts._warn('(public "trace" filtered out) '.concat(Ds),zd)},named(Ds,zd){return ts.named(Ds,zd).utilFor.public()}}}}};return ts}var dT=M_(console,{});dT.configureLogging({dev:!0,min:64});var C5=dT.getLogger().named("Theatre.js (default logger)").utilFor.dev(),C_=new WeakMap;function fT(b){const k=C_.get(b);if(k)return k;const z=new Map;return C_.set(b,z),A_([],b,z),z}function A_(b,k,z){for(const[ee,ue]of Object.entries(k.props))if(!Sy(ue)){const ge=[...b,ee];z.set(JSON.stringify(ge),z.size),P_(ge,ue,z)}for(const[ee,ue]of Object.entries(k.props))if(Sy(ue)){const ge=[...b,ee];z.set(JSON.stringify(ge),z.size),P_(ge,ue,z)}}function P_(b,k,z){if(k.type==="compound")A_(b,k,z);else{if(k.type==="enum")throw new Error("Enums aren't supported yet");z.set(JSON.stringify(b),z.size)}}function R_(b){return typeof b=="object"&&b!==null&&Object.keys(b).length===0}var pT=class{constructor(b,k,z,ee,ue){this.sheetTemplate=b,P(this,"address"),P(this,"type","Theatre_SheetObjectTemplate"),P(this,"_config"),P(this,"_temp_actions_atom"),P(this,"_cache",new Il),P(this,"project"),P(this,"pointerToSheetState"),P(this,"pointerToStaticOverrides"),this.address=I(M({},b.address),{objectKey:k}),this._config=new Vs.Atom(ee),this._temp_actions_atom=new Vs.Atom(ue),this.project=b.project,this.pointerToSheetState=this.sheetTemplate.project.pointers.historic.sheetsById[this.address.sheetId],this.pointerToStaticOverrides=this.pointerToSheetState.staticOverrides.byObject[this.address.objectKey]}get staticConfig(){return this._config.get()}get configPointer(){return this._config.pointer}get _temp_actions(){return this._temp_actions_atom.get()}get _temp_actionsPointer(){return this._temp_actions_atom.pointer}createInstance(b,k,z){return this._config.set(z),new xN(b,this,k)}reconfigure(b){this._config.set(b)}_temp_setActions(b){this._temp_actions_atom.set(b)}getDefaultValues(){return this._cache.get("getDefaultValues()",()=>(0,Vs.prism)(()=>{const b=(0,Vs.val)(this.configPointer);return s4(b)}))}getStaticValues(){return this._cache.get("getStaticValues",()=>(0,Vs.prism)(()=>{var b;const k=(b=(0,Vs.val)(this.pointerToStaticOverrides))!=null?b:{};return(0,Vs.val)(this.configPointer).deserializeAndSanitize(k)||{}}))}getArrayOfValidSequenceTracks(){return this._cache.get("getArrayOfValidSequenceTracks",()=>(0,Vs.prism)(()=>{const b=this.project.pointers.historic.sheetsById[this.address.sheetId],k=(0,Vs.val)(b.sequence.tracksByObject[this.address.objectKey].trackIdByPropPath);if(!k)return Se;const z=[];if(!k)return Se;const ee=(0,Vs.val)(this.configPointer),ue=Object.entries(k);for(const[Le,Je]of ue){const mt=mT(Le);if(!mt)continue;const It=wy(ee,mt);It&&yN(It)&&z.push({pathToProp:mt,trackId:Je})}const ge=fT(ee);return z.sort((Le,Je)=>{const mt=Le.pathToProp,It=Je.pathToProp,Jt=ge.get(JSON.stringify(mt)),an=ge.get(JSON.stringify(It));return Jt>an?1:-1}),z.length===0?Se:z}))}getMapOfValidSequenceTracks_forStudio(){return this._cache.get("getMapOfValidSequenceTracks_forStudio",()=>(0,Vs.prism)(()=>{const b=(0,Vs.val)(this.getArrayOfValidSequenceTracks());let k={};for(const{pathToProp:z,trackId:ee}of b)vd(k,z,ee);return k}))}getStaticButNotSequencedOverrides(){return this._cache.get("getStaticButNotSequencedOverrides",()=>(0,Vs.prism)(()=>{const b=(0,Vs.val)(this.getStaticValues()),k=(0,Vs.val)(this.getArrayOfValidSequenceTracks()),z=xa(b);for(const{pathToProp:ee}of k){cT(z,ee);let ue=ee.slice(0,-1);for(;ue.length>0;){const ge=uu(z,ue);if(!R_(ge))break;cT(z,ue),ue=ue.slice(0,-1)}}if(!R_(z))return z}))}getDefaultsAtPointer(b){const{path:k}=(0,Vs.getPointerParts)(b),z=this.getDefaultValues().getValue();return uu(z,k)}};function mT(b){try{return JSON.parse(b)}catch{C5.warn("property ".concat(JSON.stringify(b)," cannot be parsed. Skipping."));return}}var I_=rn(),gT=uT(b=>JSON.stringify(b));V(ie());var vT=class extends Error{},v9=class extends vT{},k_=rn(),N_=rn(),My=rn(),eo=rn();function Bd(){let b,k;const z=new Promise((ue,ge)=>{b=Le=>{ue(Le),ee.status="resolved"},k=Le=>{ge(Le),ee.status="rejected"}}),ee={resolve:b,reject:k,promise:z,status:"pending"};return ee}var wN=()=>{},A5=wN,yT=rn(),xT=class{constructor(){P(this,"_stopPlayCallback",A5),P(this,"_state",new yT.Atom({position:0,playing:!1})),P(this,"statePointer"),this.statePointer=this._state.pointer}destroy(){}pause(){this._stopPlayCallback(),this.playing=!1,this._stopPlayCallback=A5}gotoPosition(b){this._updatePositionInState(b)}_updatePositionInState(b){this._state.setByPointer(k=>k.position,b)}getCurrentPosition(){return this._state.get().position}get playing(){return this._state.get().playing}set playing(b){this._state.setByPointer(k=>k.playing,b)}play(b,k,z,ee,ue){this.playing&&this.pause(),this.playing=!0;const ge=k[1]-k[0];{const En=this.getCurrentPosition();En<k[0]||En>k[1]?ee==="normal"||ee==="alternate"?this._updatePositionInState(k[0]):(ee==="reverse"||ee==="alternateReverse")&&this._updatePositionInState(k[1]):ee==="normal"||ee==="alternate"?En===k[1]&&this._updatePositionInState(k[0]):En===k[0]&&this._updatePositionInState(k[1])}const Le=Bd(),Je=ue.time,mt=ge*b;let It=this.getCurrentPosition()-k[0];(ee==="reverse"||ee==="alternateReverse")&&(It=k[1]-this.getCurrentPosition());const Jt=En=>{const Gn=Math.max(En-Je,0)/1e3,Or=Math.min(Gn*z+It,mt);if(Or!==mt){const Wr=Math.floor(Or/ge);let Mr=Or/ge%1*ge;if(ee!=="normal")if(ee==="reverse")Mr=ge-Mr;else{const Ai=Wr%2===0;ee==="alternate"?Ai||(Mr=ge-Mr):Ai&&(Mr=ge-Mr)}this._updatePositionInState(Mr+k[0]),an()}else{if(ee==="normal")this._updatePositionInState(k[1]);else if(ee==="reverse")this._updatePositionInState(k[0]);else{const Wr=(b-1)%2===0;ee==="alternate"?Wr?this._updatePositionInState(k[1]):this._updatePositionInState(k[0]):Wr?this._updatePositionInState(k[0]):this._updatePositionInState(k[1])}this.playing=!1,Le.resolve(!0)}};this._stopPlayCallback=()=>{ue.offThisOrNextTick(Jt),ue.offNextTick(Jt),this.playing&&Le.resolve(!1)};const an=()=>ue.onNextTick(Jt);return ue.onThisOrNextTick(Jt),Le.promise}playDynamicRange(b,k){this.playing&&this.pause(),this.playing=!0;const z=Bd(),ee=b.keepHot();z.promise.then(ee,ee);let ue=k.time;const ge=Je=>{const mt=Math.max(Je-ue,0);ue=Je;const It=mt/1e3,Jt=this.getCurrentPosition(),an=b.getValue();if(Jt<an[0]||Jt>an[1])this.gotoPosition(an[0]);else{let En=Jt+It;En>an[1]&&(En=an[0]+(En-an[1])),this.gotoPosition(En)}Le()};this._stopPlayCallback=()=>{k.offThisOrNextTick(ge),k.offNextTick(ge),z.resolve(!1)};const Le=()=>k.onNextTick(ge);return k.onThisOrNextTick(ge),z.promise}},_T=rn(),EN="__TheatreJS_StudioBundle",D_="__TheatreJS_CoreBundle",bT="__TheatreJS_Notifications",y9=b=>(...k)=>{var z;switch(b){case"success":{C5.debug(k.slice(0,2).join(`
`));break}case"info":{C5.debug(k.slice(0,2).join(`
`));break}case"warning":{C5.warn(k.slice(0,2).join(`
`));break}}return typeof window<"u"?(z=window[bT])==null?void 0:z.notify[b](...k):void 0},Lp={warning:y9("warning"),success:y9("success"),info:y9("info"),error:y9("error")};typeof window<"u"&&(window.addEventListener("error",b=>{Lp.error("An error occurred","<pre>".concat(b.message,`</pre>

See **console** for details.`))}),window.addEventListener("unhandledrejection",b=>{Lp.error("An error occurred","<pre>".concat(b.reason,`</pre>

See **console** for details.`))}));var P5=class{constructor(b,k,z){this._decodedBuffer=b,this._audioContext=k,this._nodeDestination=z,P(this,"_mainGain"),P(this,"_state",new _T.Atom({position:0,playing:!1})),P(this,"statePointer"),P(this,"_stopPlayCallback",A5),this.statePointer=this._state.pointer,this._mainGain=this._audioContext.createGain(),this._mainGain.connect(this._nodeDestination)}playDynamicRange(b,k){const z=Bd();this._playing&&this.pause(),this._playing=!0;let ee;const ue=()=>{ee==null||ee(),ee=this._loopInRange(b.getValue(),k).stop},ge=b.onStale(ue);return ue(),this._stopPlayCallback=()=>{ee==null||ee(),ge(),z.resolve(!1)},z.promise}_loopInRange(b,k){let ee=this.getCurrentPosition();const ue=b[1]-b[0];ee<b[0]||ee>b[1]?this._updatePositionInState(b[0]):ee===b[1]&&this._updatePositionInState(b[0]),ee=this.getCurrentPosition();const ge=this._audioContext.createBufferSource();ge.buffer=this._decodedBuffer,ge.connect(this._mainGain),ge.playbackRate.value=1,ge.loop=!0,ge.loopStart=b[0],ge.loopEnd=b[1];const Le=k.time;let Je=ee-b[0];ge.start(0,ee);const mt=an=>{let Or=(Math.max(an-Le,0)/1e3*1+Je)/ue%1*ue;this._updatePositionInState(Or+b[0]),It()},It=()=>k.onNextTick(mt);return k.onThisOrNextTick(mt),{stop:()=>{ge.stop(),ge.disconnect(),k.offThisOrNextTick(mt),k.offNextTick(mt)}}}get _playing(){return this._state.get().playing}set _playing(b){this._state.setByPointer(k=>k.playing,b)}destroy(){}pause(){this._stopPlayCallback(),this._playing=!1,this._stopPlayCallback=A5}gotoPosition(b){this._updatePositionInState(b)}_updatePositionInState(b){this._state.reduce(k=>I(M({},k),{position:b}))}getCurrentPosition(){return this._state.get().position}play(b,k,z,ee,ue){this._playing&&this.pause(),this._playing=!0;let ge=this.getCurrentPosition();const Le=k[1]-k[0];if(ee!=="normal")throw new v9('Audio-controlled sequences can only be played in the "normal" direction. '+"'".concat(ee,"' given."));ge<k[0]||ge>k[1]?this._updatePositionInState(k[0]):ge===k[1]&&this._updatePositionInState(k[0]),ge=this.getCurrentPosition();const Je=Bd(),mt=this._audioContext.createBufferSource();mt.buffer=this._decodedBuffer,mt.connect(this._mainGain),mt.playbackRate.value=z,b>1e3&&(Lp.warning("Can't play sequences with audio more than 1000 times","The sequence will still play, but only 1000 times. The `iterationCount: ".concat(b,"` provided to `sequence.play()`\nis too high for a sequence with audio.\n\nTo fix this, either set `iterationCount` to a lower value, or remove the audio from the sequence."),[{url:"https://www.theatrejs.com/docs/latest/manual/audio",title:"Using Audio"},{url:"https://www.theatrejs.com/docs/latest/api/core#sequence.attachaudio",title:"Audio API"}]),b=1e3),b>1&&(mt.loop=!0,mt.loopStart=k[0],mt.loopEnd=k[1]);const It=ue.time;let Jt=ge-k[0];const an=Le*b;mt.start(0,ge,an-Jt);const En=Or=>{const Mr=Math.max(Or-It,0)/1e3,Ai=Math.min(Mr*z+Jt,an);if(Ai!==an){let jo=Ai/Le%1*Le;this._updatePositionInState(jo+k[0]),Gn()}else this._updatePositionInState(k[1]),this._playing=!1,Wn(),Je.resolve(!0)},Wn=()=>{mt.stop(),mt.disconnect()};this._stopPlayCallback=()=>{Wn(),ue.offThisOrNextTick(En),ue.offNextTick(En),this._playing&&Je.resolve(!1)};const Gn=()=>ue.onNextTick(En);return ue.onThisOrNextTick(En),Je.promise}},ST=rn(),Cy=0;function Ay(b){var k;const z=Le=>{ee.tick(Le)},ee=new ST.Ticker({onActive(){var Le;(Le=b==null?void 0:b.start)==null||Le.call(b)},onDormant(){var Le;(Le=b==null?void 0:b.stop)==null||Le.call(b)}}),ue={tick:z,id:Cy++,name:(k=b==null?void 0:b.name)!=null?k:"CustomRafDriver-".concat(Cy),type:"Theatre_RafDriver_PublicAPI"},ge={type:"Theatre_RafDriver_PrivateAPI",publicApi:ue,ticker:ee,start:b==null?void 0:b.start,stop:b==null?void 0:b.stop};return ft(ue,ge),ue}function TN(){let b=null;const ee=Ay({name:"DefaultCoreRafDriver",start:()=>{if(typeof window<"u"){const ue=ge=>{ee.tick(ge),b=window.requestAnimationFrame(ue)};b=window.requestAnimationFrame(ue)}else ee.tick(0),setTimeout(()=>ee.tick(1),0)},stop:()=>{typeof window<"u"&&b!==null&&window.cancelAnimationFrame(b)}});return ee}var R5;function Py(){return R5||MN(TN()),R5}function Ry(){return Py().ticker}function MN(b){if(R5)throw new Error("`setCoreRafDriver()` is already called.");R5=de(b)}var wT=class{get type(){return"Theatre_Sequence_PublicAPI"}constructor(b){ft(this,b)}play(b){const k=de(this);if(k._project.isReady()){const z=b!=null&&b.rafDriver?de(b.rafDriver).ticker:Ry();return k.play(b??{},z)}else{const z=Bd();return z.resolve(!0),z.promise}}pause(){de(this).pause()}get position(){return de(this).position}set position(b){de(this).position=b}__experimental_getKeyframes(b){return de(this).getKeyframesOfSimpleProp(b)}async attachAudio(b){const{audioContext:k,destinationNode:z,decodedBuffer:ee,gainNode:ue}=await ET(b),ge=new P5(ee,k,ue);return de(this).replacePlaybackController(ge),{audioContext:k,destinationNode:z,decodedBuffer:ee,gainNode:ue}}get pointer(){return de(this).pointer}getMarkerPosition(b){return de(this).getMarkerPosition(b)}goToAndPlay(b,k){const z=de(this);if(z._project.isReady()){const ee=k!=null&&k.rafDriver?de(k.rafDriver).ticker:Ry();return z.goToAndPlay(b,k??{},ee)}else{const ee=Bd();return ee.resolve(!0),ee.promise}}goToAndStop(b){return de(this).goToAndStop(b)}listen(b,k){return de(this).listen(b,k)}unlisten(b,k){return de(this).unlisten(b,k)}addSubSequence(b,k,z){return de(this).addSubSequence(b,k,z)}removeSubSequence(b){return de(this).removeSubSequence(b)}updateSubSequence(b,k){return de(this).updateSubSequence(b,k)}};async function ET(b){function k(){if(b.audioContext)return Promise.resolve(b.audioContext);const It=new AudioContext;return It.state==="running"||typeof window>"u"?Promise.resolve(It):new Promise(Jt=>{const an=()=>{It.resume().catch(Gn=>{console.error(Gn)})},En=["mousedown","keydown","touchstart"],Wn={capture:!0,passive:!1};En.forEach(Gn=>{window.addEventListener(Gn,an,Wn)}),It.addEventListener("statechange",()=>{It.state==="running"&&(En.forEach(Gn=>{window.removeEventListener(Gn,an,Wn)}),Jt(It))})})}async function z(){if(b.source instanceof AudioBuffer)return b.source;const It=Bd();if(typeof b.source!="string")throw new Error("Error validating arguments to sequence.attachAudio(). args.source must either be a string or an instance of AudioBuffer.");let Jt;try{Jt=await fetch(b.source)}catch(Gn){throw console.error(Gn),new Error("Could not fetch '".concat(b.source,"'. Network error logged above."))}let an;try{an=await Jt.arrayBuffer()}catch(Gn){throw console.error(Gn),new Error("Could not read '".concat(b.source,"' as an arrayBuffer."))}(await ee).decodeAudioData(an,It.resolve,It.reject);let Wn;try{Wn=await It.promise}catch(Gn){throw console.error(Gn),new Error("Could not decode ".concat(b.source," as an audio file."))}return Wn}const ee=k(),ue=z(),[ge,Le]=await Promise.all([ee,ue]),Je=b.destinationNode||ge.destination,mt=ge.createGain();return mt.connect(Je),{audioContext:ge,decodedBuffer:Le,gainNode:mt,destinationNode:Je}}var TT=CN("Theatre_SheetObject");function CN(b){return k=>typeof k=="object"&&!!k&&k.type===b}var AN=class{constructor(b,k,z,ee,ue){this._project=b,this._sheet=k,this._lengthD=z,this._subUnitsPerUnitD=ee,P(this,"address"),P(this,"publicApi"),P(this,"_playbackControllerBox"),P(this,"_prismOfStatePointer"),P(this,"_positionD"),P(this,"_positionFormatterD"),P(this,"_playableRangeD"),P(this,"_eventListeners",new Map),P(this,"_lastProcessedPosition",-1),P(this,"_processedEvents",new Set),P(this,"pointer",(0,My.pointer)({root:this,path:[]})),P(this,"$$isPointerToPrismProvider",!0),P(this,"_logger"),P(this,"closestGridPosition",ge=>{const Je=1/this.subUnitsPerUnit;return parseFloat((Math.round(ge/Je)*Je).toFixed(3))}),this._logger=b._logger.named("Sheet",k.address.sheetId).named("Instance",k.address.sheetInstanceId),this.address=I(M({},this._sheet.address),{sequenceName:"default"}),this.publicApi=new wT(this),this._playbackControllerBox=new N_.Atom(ue??new xT),this._prismOfStatePointer=(0,eo.prism)(()=>this._playbackControllerBox.prism.getValue().statePointer),this._positionD=(0,eo.prism)(()=>{const ge=this._prismOfStatePointer.getValue();return(0,eo.val)(ge.position)}),this._positionFormatterD=(0,eo.prism)(()=>{const ge=(0,eo.val)(this._subUnitsPerUnitD);return new O_(ge)}),this._positionD.onStale(()=>{const ge=this._positionD.getValue();this._processEventsForPositionChange(this._lastProcessedPosition,ge),this._processSubSequencesForPositionChange(this._lastProcessedPosition,ge),this._lastProcessedPosition=ge})}get type(){return"Theatre_Sequence"}listen(b,k){this._eventListeners.has(b)||this._eventListeners.set(b,new Set),this._eventListeners.get(b).add(k)}unlisten(b,k){const z=this._eventListeners.get(b);z&&(z.delete(k),z.size===0&&this._eventListeners.delete(b))}_processEventsForPositionChange(b,k){const z=this._getEvents();if(!z||z.length===0)return;const ee=this.length;if(b>k&&b>ee*.8&&k<ee*.2){this._processedEvents.clear();return}const ge=Math.min(b,k),Le=Math.max(b,k);Math.abs(k-b)>.1&&this._processedEvents.clear();for(const Je of z)if(Je.position>ge&&Je.position<=Le){const mt="".concat(Je.id,"-").concat(Je.position);if(this._processedEvents.has(mt))continue;if(Je.name==="goTo"||this._processedEvents.add(mt),this._triggerEvent(Je),Je.name==="stop"){requestAnimationFrame(()=>{this.pause(),this._playbackControllerBox.get().gotoPosition(Je.position)});return}else if(Je.name==="goTo"&&Je.value!==void 0){requestAnimationFrame(()=>{if(this._processedEvents.clear(),typeof Je.value=="string"){const Jt=this.getMarkerPosition(Je.value);Jt!==void 0&&this._gotoPositionWithoutPausing(Jt)}else typeof Je.value=="number"&&this._gotoPositionWithoutPausing(Je.value)});return}}}_triggerEvent(b){const k=this._eventListeners.get(b.name);k&&k.forEach(z=>{try{z(b)}catch(ee){console.error("Error in sequence event listener:",ee)}})}_processSubSequencesForPositionChange(b,k){var z,ee;const ue=this._getSubSequences();if(!(!ue||ue.length===0))for(const ge of ue){const Le=ge.position,Je=(z=ge.duration)!=null?z:this._getSubSequenceDuration(ge.sheetId),mt=(ee=ge.timeScale)!=null?ee:1,It=Le+Je/mt;if(k>=Le&&k<=It){const an=(k-Le)*mt;try{const Wn=this._project.getOrCreateSheet(ge.sheetId,"default").getSequence();Wn&&"_gotoPositionWithoutPausing"in Wn&&Wn._gotoPositionWithoutPausing(an)}catch{this._logger._error("Sub-sequence references non-existent sheet: ".concat(ge.sheetId))}}}}_getSubSequenceDuration(b){var k;try{const ee=this._project.getOrCreateSheet(b,"default").getSequence();return(k=ee==null?void 0:ee.length)!=null?k:0}catch{return 0}}_getEvents(){const b=this._project.pointers.historic.sheetsById[this._sheet.address.sheetId],k=(0,eo.val)(b.sequence);return(k==null?void 0:k.events)||[]}_getSubSequences(){const b=this._project.pointers.historic.sheetsById[this._sheet.address.sheetId],k=(0,eo.val)(b.sequence);return(k==null?void 0:k.subSequences)||[]}pointerToPrism(b){const{path:k}=(0,k_.getPointerParts)(b);if(k.length===0)return(0,eo.prism)(()=>({length:(0,eo.val)(this.pointer.length),playing:(0,eo.val)(this.pointer.playing),position:(0,eo.val)(this.pointer.position),subUnitsPerUnit:(0,eo.val)(this.pointer.subUnitsPerUnit)}));if(k.length>1)return(0,eo.prism)(()=>{});const[z]=k;return z==="length"?this._lengthD:z==="subUnitsPerUnit"?this._subUnitsPerUnitD:z==="position"?this._positionD:z==="playing"?(0,eo.prism)(()=>(0,eo.val)(this._prismOfStatePointer.getValue().playing)):(0,eo.prism)(()=>{})}getKeyframesOfSimpleProp(b){const{path:k,root:z}=(0,k_.getPointerParts)(b);if(!TT(z))throw new v9("Argument prop must be a pointer to a SheetObject property");const ee=(0,eo.val)(this._project.pointers.historic.sheetsById[this._sheet.address.sheetId].sequence.tracksByObject[z.address.objectKey]);if(!ee)return[];const{trackData:ue,trackIdByPropPath:ge}=ee,Le=gT(k),Je=ge[Le];if(!Je)return[];const mt=ue[Je];return mt?mt.keyframes:[]}get positionFormatter(){return this._positionFormatterD.getValue()}get prismOfStatePointer(){return this._prismOfStatePointer}get length(){return this._lengthD.getValue()}get positionPrism(){return this._positionD}get position(){return this._playbackControllerBox.get().getCurrentPosition()}get subUnitsPerUnit(){return this._subUnitsPerUnitD.getValue()}get positionSnappedToGrid(){return this.closestGridPosition(this.position)}set position(b){let k=b;this.pause(),k>this.length&&(k=this.length);const z=this.length;this._playbackControllerBox.get().gotoPosition(k>z?z:k)}_gotoPositionWithoutPausing(b){let k=b;k>this.length&&(k=this.length);const z=this.length;this._playbackControllerBox.get().gotoPosition(k>z?z:k)}getDurationCold(){return this._lengthD.getValue()}get playing(){return(0,eo.val)(this._playbackControllerBox.get().statePointer.playing)}_makeRangeFromSequenceTemplate(){return(0,eo.prism)(()=>[0,(0,eo.val)(this._lengthD)])}playDynamicRange(b,k){return this._playbackControllerBox.get().playDynamicRange(b,k)}async play(b,k){const z=this.length,ee=b&&b.range?b.range:[0,z],ue=b&&typeof b.iterationCount=="number"?b.iterationCount:1,ge=b&&typeof b.rate<"u"?b.rate:1,Le=b&&b.direction?b.direction:"normal";return await this._play(ue,[ee[0],ee[1]],ge,Le,k)}_play(b,k,z,ee,ue){return this._playbackControllerBox.get().play(b,k,z,ee,ue)}pause(){this._playbackControllerBox.get().pause()}replacePlaybackController(b){this.pause();const k=this._playbackControllerBox.get();this._playbackControllerBox.set(b);const z=k.getCurrentPosition();k.destroy(),b.gotoPosition(z)}getMarkerPosition(b){const k=this._project.pointers.historic.sheetsById[this._sheet.address.sheetId],z=(0,eo.val)(k.sequence.markers);if(!z)return;let ee=z.find(ue=>ue.label===b);return ee||(ee=z.find(ue=>{var ge;return((ge=ue.label)==null?void 0:ge.toLowerCase())===b.toLowerCase()})),ee||(ee=z.find(ue=>{var ge;return(ge=ue.label)==null?void 0:ge.includes(b)})),ee==null?void 0:ee.position}async goToAndPlay(b,k,z){const ee=this.getMarkerPosition(b);if(ee===void 0)throw new Error('Marker "'.concat(b,'" not found in sequence "').concat(this._sheet.address.sheetId,'"'));return this.position=ee,this.play(k,z)}goToAndStop(b){const k=this.getMarkerPosition(b);if(k===void 0)throw new Error('Marker "'.concat(b,'" not found in sequence "').concat(this._sheet.address.sheetId,'"'));this.position=k}addSubSequence(b,k,z){throw new Error("addSubSequence() can only be called when Theatre.js Studio is loaded.")}removeSubSequence(b){throw new Error("removeSubSequence() can only be called when Theatre.js Studio is loaded.")}updateSubSequence(b,k){throw new Error("updateSubSequence() can only be called when Theatre.js Studio is loaded.")}},O_=class{constructor(b){this._fps=b}formatSubUnitForGrid(b){const k=b%1,z=1/this._fps;return Math.round(k/z)+"f"}formatFullUnitForGrid(b){let k=b,z="";if(k>=Um){const ue=Math.floor(k/Um);z+=ue+"h",k=k%Um}if(k>=Bm){const ue=Math.floor(k/Bm);z+=ue+"m",k=k%Bm}if(k>=Fp){const ue=Math.floor(k/Fp);z+=ue+"s",k=k%Fp}const ee=1/this._fps;if(k>=ee){const ue=Math.floor(k/ee);z+=ue+"f",k=k%ee}return z.length===0?"0s":z}formatForPlayhead(b){let k=b,z="";if(k>=Um){const ue=Math.floor(k/Um);z+=M5(ue.toString(),2,"0")+"h",k=k%Um}if(k>=Bm){const ue=Math.floor(k/Bm);z+=M5(ue.toString(),2,"0")+"m",k=k%Bm}else z.length>0&&(z+="00m");if(k>=Fp){const ue=Math.floor(k/Fp);z+=M5(ue.toString(),2,"0")+"s",k=k%Fp}else z+="00s";const ee=1/this._fps;if(k>=ee){const ue=Math.round(k/ee);z+=M5(ue.toString(),2,"0")+"f",k=k%ee}else k/ee>.98?(z+=M5("1",2,"0")+"f",k=k%ee):z+="00f";return z.length===0?"00s00f":z}formatBasic(b){return b.toFixed(2)+"s"}},Fp=1,Bm=Fp*60,Um=Bm*60,L_={};B(L_,{boolean:()=>LT,compound:()=>z_,file:()=>DN,image:()=>IT,number:()=>NT,rgba:()=>FN,string:()=>BT,stringLiteral:()=>k5});function MT(b,k){return b.length<=k?b:b.substr(0,k-3)+"..."}var F_=b=>typeof b=="string"?'string("'.concat(MT(b,10),'")'):typeof b=="number"?"number(".concat(MT(String(b),10),")"):b===null?"null":b===void 0?"undefined":typeof b=="boolean"?String(b):Array.isArray(b)?"array":typeof b=="object"?"object":"unknown",B_=F_;function PN(b,{removeAlphaIfOpaque:k=!1}={}){const z=(b.a*255|256).toString(16).slice(1),ee=(b.r*255|256).toString(16).slice(1)+(b.g*255|256).toString(16).slice(1)+(b.b*255|256).toString(16).slice(1)+(k&&z==="ff"?"":z);return"#".concat(ee)}function Iy(b){return I(M({},b),{toString(){return PN(this,{removeAlphaIfOpaque:!0})}})}function RN(b){return Object.fromEntries(Object.entries(b).map(([k,z])=>[k,wh(z,0,1)]))}function IN(b){function k(z){return z>=.0031308?1.055*z**(1/2.4)-.055:12.92*z}return RN({r:k(b.r),g:k(b.g),b:k(b.b),a:b.a})}function U_(b){function k(z){return z>=.04045?((z+.055)/(1+.055))**2.4:z/12.92}return{r:k(b.r),g:k(b.g),b:k(b.b),a:b.a}}function CT(b){let k=.4122214708*b.r+.5363325363*b.g+.0514459929*b.b,z=.2119034982*b.r+.6806995451*b.g+.1073969566*b.b,ee=.0883024619*b.r+.2817188376*b.g+.6299787005*b.b,ue=Math.cbrt(k),ge=Math.cbrt(z),Le=Math.cbrt(ee);return{L:.2104542553*ue+.793617785*ge-.0040720468*Le,a:1.9779984951*ue-2.428592205*ge+.4505937099*Le,b:.0259040371*ue+.7827717662*ge-.808675766*Le,alpha:b.a}}function kN(b){let k=b.L+.3963377774*b.a+.2158037573*b.b,z=b.L-.1055613458*b.a-.0638541728*b.b,ee=b.L-.0894841775*b.a-1.291485548*b.b,ue=k*k*k,ge=z*z*z,Le=ee*ee*ee;return{r:4.0767416621*ue-3.3077115913*ge+.2309699292*Le,g:-1.2684380046*ue+2.6097574011*ge-.3413193965*Le,b:-.0041960863*ue-.7034186147*ge+1.707614701*Le,a:b.alpha}}var Rh=Symbol("TheatrePropType_Basic");function AT(b){return typeof b=="object"&&!!b&&b[Rh]==="TheatrePropType"}function NN(b){if(typeof b=="number")return NT(b);if(typeof b=="boolean")return LT(b);if(typeof b=="string")return BT(b);if(typeof b=="object"&&b){if(AT(b))return b;if(hs(b))return z_(b);throw new v9("This value is not a valid prop type: ".concat(B_(b)))}else throw new v9("This value is not a valid prop type: ".concat(B_(b)))}function PT(b){const k={};for(const z of Object.keys(b)){const ee=b[z];AT(ee)?k[z]=ee:k[z]=NN(ee)}return k}var z_=(b,k={})=>{const z=PT(b),ee=new WeakMap;return{type:"compound",props:z,valueType:null,[Rh]:"TheatrePropType",label:k.label,default:mr(z,ge=>ge.default),deserializeAndSanitize:ge=>{if(typeof ge!="object"||!ge)return;if(ee.has(ge))return ee.get(ge);const Le={};let Je=!1;for(const[mt,It]of Object.entries(z))if(Object.prototype.hasOwnProperty.call(ge,mt)){const Jt=It.deserializeAndSanitize(ge[mt]);Jt!=null&&(Je=!0,Le[mt]=Jt)}if(ee.set(ge,Le),Je)return Le}}},DN=(b,k={})=>{const z=(ee,ue,ge)=>{var Le;return{type:"file",id:((Le=k.interpolate)!=null?Le:I5)(ee.id,ue.id,ge)}};return{type:"file",default:{type:"file",id:b},valueType:null,[Rh]:"TheatrePropType",label:k.label,interpolate:z,deserializeAndSanitize:RT}},RT=b=>{if(!b)return;let k=!0;if(typeof b.id!="string"&&![null,void 0].includes(b.id)&&(k=!1),b.type!=="file"&&(k=!1),!!k)return b},IT=(b,k={})=>{const z=(ee,ue,ge)=>{var Le;return{type:"image",id:((Le=k.interpolate)!=null?Le:I5)(ee.id,ue.id,ge)}};return{type:"image",default:{type:"image",id:b},valueType:null,[Rh]:"TheatrePropType",label:k.label,interpolate:z,deserializeAndSanitize:kT}},kT=b=>{if(!b)return;let k=!0;if(typeof b.id!="string"&&![null,void 0].includes(b.id)&&(k=!1),b.type!=="image"&&(k=!1),!!k)return b},NT=(b,k={})=>{var z;return I(M({type:"number",valueType:0,default:b,[Rh]:"TheatrePropType"},k||{}),{label:k.label,nudgeFn:(z=k.nudgeFn)!=null?z:UN,nudgeMultiplier:typeof k.nudgeMultiplier=="number"?k.nudgeMultiplier:void 0,interpolate:LN,deserializeAndSanitize:ON(k.range)})},ON=b=>b?k=>{if(typeof k=="number"&&isFinite(k))return wh(k,b[0],b[1])}:DT,DT=b=>typeof b=="number"&&isFinite(b)?b:void 0,LN=(b,k,z)=>b+z*(k-b),FN=(b={r:0,g:0,b:0,a:1},k={})=>{const z={};for(const ee of["r","g","b","a"])z[ee]=Math.min(Math.max(b[ee],0),1);return{type:"rgba",valueType:null,default:Iy(z),[Rh]:"TheatrePropType",label:k.label,interpolate:BN,deserializeAndSanitize:OT}},OT=b=>{if(!b)return;let k=!0;for(const ee of["r","g","b","a"])(!Object.prototype.hasOwnProperty.call(b,ee)||typeof b[ee]!="number")&&(k=!1);if(!k)return;const z={};for(const ee of["r","g","b","a"])z[ee]=Math.min(Math.max(b[ee],0),1);return Iy(z)},BN=(b,k,z)=>{const ee=CT(U_(b)),ue=CT(U_(k)),ge={L:(1-z)*ee.L+z*ue.L,a:(1-z)*ee.a+z*ue.a,b:(1-z)*ee.b+z*ue.b,alpha:(1-z)*ee.alpha+z*ue.alpha},Le=IN(kN(ge));return Iy(Le)},LT=(b,k={})=>{var z;return{type:"boolean",default:b,valueType:null,[Rh]:"TheatrePropType",label:k.label,interpolate:(z=k.interpolate)!=null?z:I5,deserializeAndSanitize:FT}},FT=b=>typeof b=="boolean"?b:void 0;function I5(b){return b}var BT=(b,k={})=>{var z;return{type:"string",default:b,valueType:null,[Rh]:"TheatrePropType",label:k.label,interpolate:(z=k.interpolate)!=null?z:I5,deserializeAndSanitize:x9}};function x9(b){return typeof b=="string"?b:void 0}function k5(b,k,z={}){var ee,ue;return{type:"stringLiteral",default:b,valuesAndLabels:M({},k),[Rh]:"TheatrePropType",valueType:null,as:(ee=z.as)!=null?ee:"menu",label:z.label,interpolate:(ue=z.interpolate)!=null?ue:I5,deserializeAndSanitize(ge){if(typeof ge=="string"&&Object.prototype.hasOwnProperty.call(k,ge))return ge}}}var UN=({config:b,deltaX:k,deltaFraction:z,magnitude:ee})=>{var ue;const{range:ge}=b;return!b.nudgeMultiplier&&ge&&!ge.includes(1/0)&&!ge.includes(-1/0)?z*(ge[1]-ge[0])*ee:k*ee*((ue=b.nudgeMultiplier)!=null?ue:1)},UT=b=>b.replace(/^[\s\/]*/,"").replace(/[\s\/]*$/,"").replace(/\s*\/\s*/g," / ");function ky(b,k){return UT(b)}V(K());var zN=class{get type(){return"Theatre_Sheet_PublicAPI"}constructor(b){ft(this,b)}object(b,k,z){const ee=de(this),ue=ky(b),ge=ee.getObject(ue),Le=null,Je=z==null?void 0:z.__actions__THIS_API_IS_UNSTABLE_AND_WILL_CHANGE_IN_THE_NEXT_VERSION;if(ge)return Je&&ge.template._temp_setActions(Je),ge.publicApi;{const mt=z_(k);return ee.createObject(ue,Le,mt,Je).publicApi}}__experimental_getExistingObject(b){const k=de(this),z=ky(b),ee=k.getObject(z);return ee==null?void 0:ee.publicApi}get sequence(){return de(this).getSequence().publicApi}get project(){return de(this).project.publicApi}get address(){return M({},de(this).address)}detachObject(b){const k=de(this),z=ky(b);if(!k.getObject(z)){Lp.warning(`Couldn't delete object "`.concat(z,'"'),'There is no object with key "'.concat(z,`".

To fix this, make sure you are calling \`sheet.deleteObject("`).concat(z,'")` with the correct key.')),console.warn('Object key "'.concat(z,'" does not exist.'));return}k.deleteObject(z)}},_9=rn(),VN=class{constructor(b,k){this.template=b,this.instanceId=k,P(this,"_objects",new _9.Atom({})),P(this,"_sequence"),P(this,"address"),P(this,"publicApi"),P(this,"project"),P(this,"objectsP",this._objects.pointer),P(this,"type","Theatre_Sheet"),P(this,"_logger"),this._logger=b.project._logger.named("Sheet",k),this._logger._trace("creating sheet"),this.project=b.project,this.address=I(M({},b.address),{sheetInstanceId:this.instanceId}),this.publicApi=new zN(this)}createObject(b,k,z,ee={}){const ge=this.template.getObjectTemplate(b,k,z,ee).createInstance(this,k,z);return this._objects.setByPointer(Le=>Le[b],ge),ge}getObject(b){return this._objects.get()[b]}deleteObject(b){this._objects.reduce(k=>{const z=M({},k);return delete z[b],z})}getSequence(){if(!this._sequence){const b=(0,_9.prism)(()=>{const z=(0,_9.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.length);return zT(z)}),k=(0,_9.prism)(()=>{const z=(0,_9.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.subUnitsPerUnit);return VT(z)});this._sequence=new AN(this.template.project,this,b,k)}return this._sequence}},zT=b=>typeof b=="number"&&isFinite(b)&&b>0?b:10,VT=b=>typeof b=="number"&&er(b)&&b>=1&&b<=1e3?b:30,GN=class{constructor(b,k){this.project=b,P(this,"type","Theatre_SheetTemplate"),P(this,"address"),P(this,"_instances",new I_.Atom({})),P(this,"instancesP",this._instances.pointer),P(this,"_objectTemplates",new I_.Atom({})),P(this,"objectTemplatesP",this._objectTemplates.pointer),this.address=I(M({},b.address),{sheetId:k})}getInstance(b){let k=this._instances.get()[b];return k||(k=new VN(this,b),this._instances.setByPointer(z=>z[b],k)),k}getObjectTemplate(b,k,z,ee){let ue=this._objectTemplates.get()[b];return ue||(ue=new pT(this,b,k,z,ee),this._objectTemplates.setByPointer(ge=>ge[b],ue)),ue}},V_=rn(),Ny=rn(),GT=b=>new Promise(k=>setTimeout(k,b)),jN=GT;function Wl(b){for(var k=arguments.length,z=Array(k>1?k-1:0),ee=1;ee<k;ee++)z[ee-1]=arguments[ee];throw Error("[Immer] minified error nr: "+b+(z.length?" "+z.map(function(ue){return"'"+ue+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function zm(b){return!!b&&!!b[q0]}function Bp(b){return!!b&&(function(k){if(!k||typeof k!="object")return!1;var z=Object.getPrototypeOf(k);if(z===null)return!0;var ee=Object.hasOwnProperty.call(z,"constructor")&&z.constructor;return ee===Object||typeof ee=="function"&&Function.toString.call(ee)===K_}(b)||Array.isArray(b)||!!b[JT]||!!b.constructor[JT]||j_(b)||Oy(b))}function G_(b){return zm(b)||Wl(23,b),b[q0].t}function b9(b,k,z){z===void 0&&(z=!1),S9(b)===0?(z?Object.keys:Z_)(b).forEach(function(ee){z&&typeof ee=="symbol"||k(ee,b[ee],b)}):b.forEach(function(ee,ue){return k(ue,ee,b)})}function S9(b){var k=b[q0];return k?k.i>3?k.i-4:k.i:Array.isArray(b)?1:j_(b)?2:Oy(b)?3:0}function Dy(b,k){return S9(b)===2?b.has(k):Object.prototype.hasOwnProperty.call(b,k)}function HN(b,k){return S9(b)===2?b.get(k):b[k]}function jT(b,k,z){var ee=S9(b);ee===2?b.set(k,z):ee===3?(b.delete(k),b.add(z)):b[k]=z}function HT(b,k){return b===k?b!==0||1/b==1/k:b!=b&&k!=k}function j_(b){return $N&&b instanceof Map}function Oy(b){return QT&&b instanceof Set}function Ih(b){return b.o||b.t}function H_(b){if(Array.isArray(b))return Array.prototype.slice.call(b);var k=qN(b);delete k[q0];for(var z=Z_(k),ee=0;ee<z.length;ee++){var ue=z[ee],ge=k[ue];ge.writable===!1&&(ge.writable=!0,ge.configurable=!0),(ge.get||ge.set)&&(k[ue]={configurable:!0,writable:!0,enumerable:ge.enumerable,value:b[ue]})}return Object.create(Object.getPrototypeOf(b),k)}function W_(b,k){return k===void 0&&(k=!1),Ly(b)||zm(b)||!Bp(b)||(S9(b)>1&&(b.set=b.add=b.clear=b.delete=WT),Object.freeze(b),k&&b9(b,function(z,ee){return W_(ee,!0)},!0)),b}function WT(){Wl(2)}function Ly(b){return b==null||typeof b!="object"||Object.isFrozen(b)}function kh(b){var k=Q_[b];return k||Wl(18,b),k}function Fy(){return E9}function By(b,k){k&&(kh("Patches"),b.u=[],b.s=[],b.v=k)}function Uy(b){zy(b),b.p.forEach(WN),b.p=null}function zy(b){b===E9&&(E9=b.l)}function $T(b){return E9={p:[],l:E9,h:b,m:!0,_:0}}function WN(b){var k=b[q0];k.i===0||k.i===1?k.j():k.O=!0}function Vm(b,k){k._=k.p.length;var z=k.p[0],ee=b!==void 0&&b!==z;return k.h.g||kh("ES5").S(k,b,ee),ee?(z[q0].P&&(Uy(k),Wl(4)),Bp(b)&&(b=w9(k,b),k.l||N5(k,b)),k.u&&kh("Patches").M(z[q0],b,k.u,k.s)):b=w9(k,z,[]),Uy(k),k.u&&k.v(k.u,k.s),b!==Y_?b:void 0}function w9(b,k,z){if(Ly(k))return k;var ee=k[q0];if(!ee)return b9(k,function(ge,Le){return qT(b,ee,k,ge,Le,z)},!0),k;if(ee.A!==b)return k;if(!ee.P)return N5(b,ee.t,!0),ee.t;if(!ee.I){ee.I=!0,ee.A._--;var ue=ee.i===4||ee.i===5?ee.o=H_(ee.k):ee.o;b9(ee.i===3?new Set(ue):ue,function(ge,Le){return qT(b,ee,ue,ge,Le,z)}),N5(b,ue,!1),z&&b.u&&kh("Patches").R(ee,z,b.u,b.s)}return ee.o}function qT(b,k,z,ee,ue,ge){if(zm(ue)){var Le=w9(b,ue,ge&&k&&k.i!==3&&!Dy(k.D,ee)?ge.concat(ee):void 0);if(jT(z,ee,Le),!zm(Le))return;b.m=!1}if(Bp(ue)&&!Ly(ue)){if(!b.h.F&&b._<1)return;w9(b,ue),k&&k.A.l||N5(b,ue)}}function N5(b,k,z){z===void 0&&(z=!1),b.h.F&&b.m&&W_(k,z)}function D5(b,k){var z=b[q0];return(z?Ih(z):b)[k]}function XT(b,k){if(k in b)for(var z=Object.getPrototypeOf(b);z;){var ee=Object.getOwnPropertyDescriptor(z,k);if(ee)return ee;z=Object.getPrototypeOf(z)}}function $_(b){b.P||(b.P=!0,b.l&&$_(b.l))}function Vy(b){b.o||(b.o=H_(b.t))}function Gy(b,k,z){var ee=j_(k)?kh("MapSet").N(k,z):Oy(k)?kh("MapSet").T(k,z):b.g?function(ue,ge){var Le=Array.isArray(ue),Je={i:Le?1:0,A:ge?ge.A:Fy(),P:!1,I:!1,D:{},l:ge,t:ue,k:null,o:null,j:null,C:!1},mt=Je,It=O5;Le&&(mt=[Je],It=L5);var Jt=Proxy.revocable(mt,It),an=Jt.revoke,En=Jt.proxy;return Je.k=En,Je.j=an,En}(k,z):kh("ES5").J(k,z);return(z?z.A:Fy()).p.push(ee),ee}function YT(b){return zm(b)||Wl(22,b),function k(z){if(!Bp(z))return z;var ee,ue=z[q0],ge=S9(z);if(ue){if(!ue.P&&(ue.i<4||!kh("ES5").K(ue)))return ue.t;ue.I=!0,ee=KT(z,ge),ue.I=!1}else ee=KT(z,ge);return b9(ee,function(Le,Je){ue&&HN(ue.t,Le)===Je||jT(ee,Le,k(Je))}),ge===3?new Set(ee):ee}(b)}function KT(b,k){switch(k){case 2:return new Map(b);case 3:return Array.from(b)}return H_(b)}var ZT,E9,q_=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",$N=typeof Map<"u",QT=typeof Set<"u",X_=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",Y_=q_?Symbol.for("immer-nothing"):((ZT={})["immer-nothing"]=!0,ZT),JT=q_?Symbol.for("immer-draftable"):"__$immer_draftable",q0=q_?Symbol.for("immer-state"):"__$immer_state",K_=""+Object.prototype.constructor,Z_=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:Object.getOwnPropertyNames,qN=Object.getOwnPropertyDescriptors||function(b){var k={};return Z_(b).forEach(function(z){k[z]=Object.getOwnPropertyDescriptor(b,z)}),k},Q_={},O5={get:function(b,k){if(k===q0)return b;var z=Ih(b);if(!Dy(z,k))return function(ue,ge,Le){var Je,mt=XT(ge,Le);return mt?"value"in mt?mt.value:(Je=mt.get)===null||Je===void 0?void 0:Je.call(ue.k):void 0}(b,z,k);var ee=z[k];return b.I||!Bp(ee)?ee:ee===D5(b.t,k)?(Vy(b),b.o[k]=Gy(b.A.h,ee,b)):ee},has:function(b,k){return k in Ih(b)},ownKeys:function(b){return Reflect.ownKeys(Ih(b))},set:function(b,k,z){var ee=XT(Ih(b),k);if(ee!=null&&ee.set)return ee.set.call(b.k,z),!0;if(!b.P){var ue=D5(Ih(b),k),ge=ue==null?void 0:ue[q0];if(ge&&ge.t===z)return b.o[k]=z,b.D[k]=!1,!0;if(HT(z,ue)&&(z!==void 0||Dy(b.t,k)))return!0;Vy(b),$_(b)}return b.o[k]===z&&typeof z!="number"&&(z!==void 0||k in b.o)||(b.o[k]=z,b.D[k]=!0,!0)},deleteProperty:function(b,k){return D5(b.t,k)!==void 0||k in b.t?(b.D[k]=!1,Vy(b),$_(b)):delete b.D[k],b.o&&delete b.o[k],!0},getOwnPropertyDescriptor:function(b,k){var z=Ih(b),ee=Reflect.getOwnPropertyDescriptor(z,k);return ee&&{writable:!0,configurable:b.i!==1||k!=="length",enumerable:ee.enumerable,value:z[k]}},defineProperty:function(){Wl(11)},getPrototypeOf:function(b){return Object.getPrototypeOf(b.t)},setPrototypeOf:function(){Wl(12)}},L5={};b9(O5,function(b,k){L5[b]=function(){return arguments[0]=arguments[0][0],k.apply(this,arguments)}}),L5.deleteProperty=function(b,k){return O5.deleteProperty.call(this,b[0],k)},L5.set=function(b,k,z){return O5.set.call(this,b[0],k,z,b[0])};var Up=function(){function b(z){var ee=this;this.g=X_,this.F=!0,this.produce=function(ue,ge,Le){if(typeof ue=="function"&&typeof ge!="function"){var Je=ge;ge=ue;var mt=ee;return function(Wn){var Gn=this;Wn===void 0&&(Wn=Je);for(var Or=arguments.length,Wr=Array(Or>1?Or-1:0),Mr=1;Mr<Or;Mr++)Wr[Mr-1]=arguments[Mr];return mt.produce(Wn,function(Ai){var jo;return(jo=ge).call.apply(jo,[Gn,Ai].concat(Wr))})}}var It;if(typeof ge!="function"&&Wl(6),Le!==void 0&&typeof Le!="function"&&Wl(7),Bp(ue)){var Jt=$T(ee),an=Gy(ee,ue,void 0),En=!0;try{It=ge(an),En=!1}finally{En?Uy(Jt):zy(Jt)}return typeof Promise<"u"&&It instanceof Promise?It.then(function(Wn){return By(Jt,Le),Vm(Wn,Jt)},function(Wn){throw Uy(Jt),Wn}):(By(Jt,Le),Vm(It,Jt))}if(!ue||typeof ue!="object")return(It=ge(ue))===Y_?void 0:(It===void 0&&(It=ue),ee.F&&W_(It,!0),It);Wl(21,ue)},this.produceWithPatches=function(ue,ge){return typeof ue=="function"?function(mt){for(var It=arguments.length,Jt=Array(It>1?It-1:0),an=1;an<It;an++)Jt[an-1]=arguments[an];return ee.produceWithPatches(mt,function(En){return ue.apply(void 0,[En].concat(Jt))})}:[ee.produce(ue,ge,function(mt,It){Le=mt,Je=It}),Le,Je];var Le,Je},typeof(z==null?void 0:z.useProxies)=="boolean"&&this.setUseProxies(z.useProxies),typeof(z==null?void 0:z.autoFreeze)=="boolean"&&this.setAutoFreeze(z.autoFreeze)}var k=b.prototype;return k.createDraft=function(z){Bp(z)||Wl(8),zm(z)&&(z=YT(z));var ee=$T(this),ue=Gy(this,z,void 0);return ue[q0].C=!0,zy(ee),ue},k.finishDraft=function(z,ee){var ue=z&&z[q0],ge=ue.A;return By(ge,ee),Vm(void 0,ge)},k.setAutoFreeze=function(z){this.F=z},k.setUseProxies=function(z){z&&!X_&&Wl(20),this.g=z},k.applyPatches=function(z,ee){var ue;for(ue=ee.length-1;ue>=0;ue--){var ge=ee[ue];if(ge.path.length===0&&ge.op==="replace"){z=ge.value;break}}var Le=kh("Patches").$;return zm(z)?Le(z,ee):this.produce(z,function(Je){return Le(Je,ee.slice(ue+1))})},b}(),$l=new Up;$l.produce,$l.produceWithPatches.bind($l),$l.setAutoFreeze.bind($l),$l.setUseProxies.bind($l),$l.applyPatches.bind($l),$l.createDraft.bind($l),$l.finishDraft.bind($l);var XN={currentProjectStateDefinitionVersion:"0.4.0"},Ud=XN;async function eM(b,k,z){if(await jN(0),b.transaction(({drafts:ee})=>{var ue;const ge=k.address.projectId;ee.ephemeral.coreByProject[ge]={lastExportedObject:null,loadingState:{type:"loading"}},ee.ahistoric.coreByProject[ge]={ahistoricStuff:""};function Le(){ee.ephemeral.coreByProject[ge].loadingState={type:"loaded"},ee.historic.coreByProject[ge]={sheetsById:{},definitionVersion:Ud.currentProjectStateDefinitionVersion,revisionHistory:[]}}function Je(an){ee.ephemeral.coreByProject[ge].loadingState={type:"loaded"},ee.historic.coreByProject[ge]=an}function mt(){ee.ephemeral.coreByProject[ge].loadingState={type:"loaded"}}function It(an){ee.ephemeral.coreByProject[ge].loadingState={type:"browserStateIsNotBasedOnDiskState",onDiskState:an}}const Jt=(ue=G_(ee.historic))==null?void 0:ue.coreByProject[k.address.projectId];Jt?z&&Jt.revisionHistory.indexOf(z.revisionHistory[0])==-1?It(z):mt():z?Je(z):Le()}),z!=null&&z.sheetsById){const ee=k.address.projectId;b.transaction(({stateEditors:ue})=>{var ge,Le,Je,mt,It,Jt,an,En,Wn,Gn,Or,Wr,Mr,Ai,jo,to,po,Ui,No,za,X0,Pu,Ru,Nh;for(const[Ic,ra]of Object.entries(z.sheetsById)){if((ge=ra==null?void 0:ra.sequence)!=null&&ge.markers){const os=ra.sequence.markers;(an=(Jt=(It=(mt=(Je=(Le=ue==null?void 0:ue.studio)==null?void 0:Le.historic)==null?void 0:Je.projects)==null?void 0:mt.stateByProjectId)==null?void 0:It.stateBySheetId)==null?void 0:Jt.sequenceEditor)!=null&&an.replaceMarkers&&ue.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:{projectId:ee,sheetId:Ic},markers:os,snappingFunction:Do=>Do})}if((En=ra==null?void 0:ra.sequence)!=null&&En.events){const os=ra.sequence.events;(Ai=(Mr=(Wr=(Or=(Gn=(Wn=ue==null?void 0:ue.studio)==null?void 0:Wn.historic)==null?void 0:Gn.projects)==null?void 0:Or.stateByProjectId)==null?void 0:Wr.stateBySheetId)==null?void 0:Mr.sequenceEditor)!=null&&Ai.replaceEvents&&ue.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:{projectId:ee,sheetId:Ic},events:os,snappingFunction:Do=>Do})}if((jo=ra==null?void 0:ra.sequence)!=null&&jo.subSequences){const os=ra.sequence.subSequences;if((X0=(za=(No=(Ui=(po=(to=ue==null?void 0:ue.studio)==null?void 0:to.historic)==null?void 0:po.projects)==null?void 0:Ui.stateByProjectId)==null?void 0:No.stateBySheetId)==null?void 0:za.sequenceEditor)!=null&&X0.replaceSubSequences){const Do=(Nh=(Ru=(Pu=ue.studio.historic.projects.stateByProjectId[ee])==null?void 0:Pu.stateBySheetId[Ic])==null?void 0:Ru.sequenceEditor)==null?void 0:Nh.subSequenceSet,ts=Do?os.filter(Ds=>!Do.byId[Ds.id]):os;ts.length>0&&ue.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceSubSequences({sheetAddress:{projectId:ee,sheetId:Ic},subSequences:ts,snappingFunction:Ds=>Ds})}}}})}}function tM(){}function J_(b){var k,z;const ee=(k=b==null?void 0:b.logging)!=null&&k.internal?(z=b.logging.min)!=null?z:256:1/0,ue=ee<=128,ge=ee<=512,Le=M_(void 0,{_debug:ue?console.debug.bind(console,"_coreLogger(TheatreInternalLogger) debug"):tM,_error:ge?console.error.bind(console,"_coreLogger(TheatreInternalLogger) error"):tM});if(b){const{logger:Je,logging:mt}=b;Je&&Le.configureLogger(Je),mt?Le.configureLogging(mt):Le.configureLogging({dev:!1})}return Le.getLogger().named("Theatre")}var YN=class{constructor(b,k={},z){this.config=k,this.publicApi=z,P(this,"pointers"),P(this,"_pointerProxies"),P(this,"address"),P(this,"_studioReadyDeferred"),P(this,"_assetStorageReadyDeferred"),P(this,"_readyPromise"),P(this,"_sheetTemplates",new Ny.Atom({})),P(this,"sheetTemplatesP",this._sheetTemplates.pointer),P(this,"_studio"),P(this,"assetStorage"),P(this,"type","Theatre_Project"),P(this,"_logger");var ee;this._logger=J_({logging:{dev:!0}}).named("Project",b),this._logger.traceDev("creating project"),this.address={projectId:b};const ue=new Ny.Atom({ahistoric:{ahistoricStuff:""},historic:(ee=k.state)!=null?ee:{sheetsById:{},definitionVersion:Ud.currentProjectStateDefinitionVersion,revisionHistory:[]},ephemeral:{loadingState:{type:"loaded"},lastExportedObject:null}});this._assetStorageReadyDeferred=Bd(),this.assetStorage={getAssetUrl:ge=>{var Le;return"".concat((Le=k.assets)==null?void 0:Le.baseUrl,"/").concat(ge)},createAsset:()=>{throw new Error("Please wait for Project.ready to use assets.")}},this._pointerProxies={historic:new V_.PointerProxy(ue.pointer.historic),ahistoric:new V_.PointerProxy(ue.pointer.ahistoric),ephemeral:new V_.PointerProxy(ue.pointer.ephemeral)},this.pointers={historic:this._pointerProxies.historic.pointer,ahistoric:this._pointerProxies.ahistoric.pointer,ephemeral:this._pointerProxies.ephemeral.pointer},tt.add(b,this),this._studioReadyDeferred=Bd(),this._readyPromise=Promise.all([this._studioReadyDeferred.promise,this._assetStorageReadyDeferred.promise]).then(()=>{}),k.state?setTimeout(()=>{this._studio||(this._studioReadyDeferred.resolve(void 0),this._assetStorageReadyDeferred.resolve(void 0),this._logger._trace("ready deferred resolved with no state"))},0):typeof window>"u"?console.error('Argument config.state in Theatre.getProject("'.concat(b,'", config) is empty. ')+"You can safely ignore this message if you're developing a Next.js/Remix project in development mode. But if you are shipping to your end-users, then you need to set config.state, otherwise your project's state will be empty and nothing will animate. Learn more at https://www.theatrejs.com/docs/latest/manual/projects#state"):setTimeout(()=>{if(!this._studio)throw new Error('Argument config.state in Theatre.getProject("'.concat(b,'", config) is empty. This is fine ')+"while you are using @tomorrowevening/theatre-core along with @tomorrowevening/theatre-studio. But since @tomorrowevening/theatre-studio "+'is not loaded, the state of project "'.concat(b,`" will be empty.

`)+`To fix this, you need to add @tomorrowevening/theatre-studio into the bundle and export the project's state. Learn how to do that at https://www.theatrejs.com/docs/latest/manual/projects#state
`)},1e3)}attachToStudio(b){if(this._studio){if(this._studio!==b)throw new Error("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));console.warn("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));return}this._studio=b,b.initialized.then(async()=>{var k;await eM(b,this,this.config.state),this._pointerProxies.historic.setPointer(b.atomP.historic.coreByProject[this.address.projectId]),this._pointerProxies.ahistoric.setPointer(b.atomP.ahistoric.coreByProject[this.address.projectId]),this._pointerProxies.ephemeral.setPointer(b.atomP.ephemeral.coreByProject[this.address.projectId]),await b.createAssetStorage(this,(k=this.config.assets)==null?void 0:k.baseUrl).then(z=>{this.assetStorage=z,this._assetStorageReadyDeferred.resolve(void 0)}),this._studioReadyDeferred.resolve(void 0)}).catch(k=>{throw console.error(k),k})}get isAttachedToStudio(){return!!this._studio}get ready(){return this._readyPromise}isReady(){return this._studioReadyDeferred.status==="resolved"&&this._assetStorageReadyDeferred.status==="resolved"}getOrCreateSheet(b,k="default"){let z=this._sheetTemplates.get()[b];return z||(z=new GN(this,b),this._sheetTemplates.reduce(ee=>I(M({},ee),{[b]:z}))),z.getInstance(k)}},KN=class{get type(){return"Theatre_Project_PublicAPI"}constructor(b,k={}){ft(this,new YN(b,k,this))}get ready(){return de(this).ready}get isReady(){return de(this).isReady()}get address(){return M({},de(this).address)}getAssetUrl(b){if(!this.isReady){console.error("Calling `project.getAssetUrl()` before `project.ready` is resolved, will always return `undefined`. Either use `project.ready.then(() => project.getAssetUrl())` or `await project.ready` before calling `project.getAssetUrl()`.");return}return b.id?de(this).assetStorage.getAssetUrl(b.id):void 0}sheet(b,k="default"){const z=ky(b);return de(this).getOrCreateSheet(z,k).publicApi}};V(K());var eb=rn(),tb=rn();function nM(b,k={}){const z=tt.get(b);if(z)return z.publicApi;const ue=J_().named("Project",b);return k.state?(ZN(b,k.state),ue._debug("deep validated config.state on disk")):ue._debug("no config.state"),new KN(b,k)}var rM=(b,k)=>{if(Array.isArray(k)||k==null||k.definitionVersion!==Ud.currentProjectStateDefinitionVersion)throw new v9("Error validating conf.state in Theatre.getProject(".concat(JSON.stringify(b),", conf). The state seems to be formatted in a way that is unreadable to Theatre.js. Read more at https://www.theatrejs.com/docs/latest/manual/projects#state"))},ZN=(b,k)=>{rM(b,k)};function nb(b,k,z){const ee=z?de(z).ticker:Ry();if((0,eb.isPointer)(b))return(0,tb.pointerToPrism)(b).onChange(ee,k,!0);if((0,tb.isPrism)(b))return b.onChange(ee,k,!0);throw new Error("Called onChange(p) where p is neither a pointer nor a prism.")}function rb(b){if((0,eb.isPointer)(b))return(0,tb.pointerToPrism)(b).getValue();throw new Error("Called val(p) where p is not a pointer.")}var QN=class{constructor(){P(this,"_studio")}get type(){return"Theatre_CoreBundle"}get version(){return"1.0.19"}getBitsForStudio(b,k){if(this._studio)throw new Error("@tomorrowevening/theatre-core is already attached to @tomorrowevening/theatre-studio");this._studio=b;const z={projectsP:tt.atom.pointer.projects,privateAPI:de,coreExports:se,getCoreRafDriver:Py};k(z)}};JN();function JN(){if(typeof window>"u")return;const b=window[D_];if(typeof b<"u")throw typeof b=="object"&&b&&typeof b.version=="string"?new Error(`It seems that the module '@tomorrowevening/theatre-core' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@tomorrowevening/theatre-core' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(D_," seems to be already set by a module other than @tomorrowevening/theatre-core."));const k=new QN;window[D_]=k;const z=window[EN];z&&z!==null&&z.type==="Theatre_StudioBundle"&&z.registerCoreBundle(k)}/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)
		*/}(Hw,Hw.exports)),Hw.exports}jw.exports;var g9e;function uRe(){return g9e||(g9e=1,function(s,e){var t={},n=Object.create,r=Object.freeze,i=Object.defineProperty,a=Object.defineProperties,c=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertyNames,y=Object.getOwnPropertySymbols,x=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,I=(o,l)=>{if(l=Symbol[o])return l;throw Error("Symbol."+o+" is not defined")},L=Math.pow,B=(o,l,h)=>l in o?i(o,l,{enumerable:!0,configurable:!0,writable:!0,value:h}):o[l]=h,A=(o,l)=>{for(var h in l||(l={}))S.call(l,h)&&B(o,h,l[h]);if(y)for(var h of y(l))M.call(l,h)&&B(o,h,l[h]);return o},V=(o,l)=>a(o,u(l)),X=(o,l)=>{var h={};for(var m in o)S.call(o,m)&&l.indexOf(m)<0&&(h[m]=o[m]);if(o!=null&&y)for(var m of y(o))l.indexOf(m)<0&&M.call(o,m)&&(h[m]=o[m]);return h},P=(o,l)=>()=>(o&&(l=o(o=0)),l),te=(o,l)=>()=>(l||o((l={exports:{}}).exports,l),l.exports),oe=(o,l)=>{for(var h in l)i(o,h,{get:l[h],enumerable:!0})},ie=(o,l,h,m)=>{if(l&&typeof l=="object"||typeof l=="function")for(let _ of p(l))!S.call(o,_)&&_!==h&&i(o,_,{get:()=>l[_],enumerable:!(m=c(l,_))||m.enumerable});return o},K=(o,l,h)=>(h=o!=null?n(x(o)):{},ie(l||!o||!o.__esModule?i(h,"default",{value:o,enumerable:!0}):h,o)),re=o=>ie(i({},"__esModule",{value:!0}),o),se=(o,l,h)=>(B(o,typeof l!="symbol"?l+"":l,h),h),q=(o,l)=>r(i(o,"raw",{value:r(o.slice())})),De=(o,l,h)=>new Promise((m,_)=>{var w=N=>{try{R(h.next(N))}catch(F){_(F)}},C=N=>{try{R(h.throw(N))}catch(F){_(F)}},R=N=>N.done?m(N.value):Promise.resolve(N.value).then(w,C);R((h=h.apply(o,l)).next())}),Be=function(o,l){this[0]=o,this[1]=l},tt=o=>{var l=o[I("asyncIterator")],h=!1,m,_={};return l==null?(l=o[I("iterator")](),m=w=>_[w]=C=>l[w](C)):(l=l.call(o),m=w=>_[w]=C=>{if(h){if(h=!1,w==="throw")throw C;return C}return h=!0,{done:!1,value:new Be(new Promise(R=>{var N=l[w](C);if(!(N instanceof Object))throw TypeError("Object expected");R(N)}),1)}}),_[I("iterator")]=()=>_,m("next"),"throw"in l?m("throw"):_.throw=w=>{throw w},"return"in l&&m("return"),_};function st(o){ft=o}function de(){return ft}var ft,Se=P(()=>{});function rt(o){return l=>typeof l=="object"&&!!l&&l.type===o}var ut,Pe,vt,Bt,ct,Pt,on,Gt,hn=P(()=>{ut=rt("Theatre_Project"),Pe=rt("Theatre_Sheet"),vt=rt("Theatre_SheetTemplate"),Bt=rt("Theatre_SheetObject"),ct=rt("Theatre_Sequence"),Pt=rt("Theatre_SheetObjectTemplate"),on=rt("Theatre_Sheet_PublicAPI"),Gt=rt("Theatre_SheetObject_PublicAPI")}),Xn,Fn,Kr=P(()=>{Xn=typeof A0=="object"&&A0&&A0.Object===Object&&A0,Fn=Xn}),Mi,Br,Ue,Ii=P(()=>{Kr(),Mi=typeof self=="object"&&self&&self.Object===Object&&self,Br=Fn||Mi||Function("return this")(),Ue=Br}),ei,Ar,On=P(()=>{Ii(),ei=Ue.Symbol,Ar=ei});function Yr(o){var l=vr.call(o,Ie),h=o[Ie];try{o[Ie]=void 0;var m=!0}catch{}var _=Ci.call(o);return m&&(l?o[Ie]=h:delete o[Ie]),_}var Yn,vr,Ci,Ie,pe,wt=P(()=>{On(),Yn=Object.prototype,vr=Yn.hasOwnProperty,Ci=Yn.toString,Ie=Ar?Ar.toStringTag:void 0,pe=Yr});function Vt(o){return Ot.call(o)}var qt,Ot,Kn,vn=P(()=>{qt=Object.prototype,Ot=qt.toString,Kn=Vt});function Ln(o){return o==null?o===void 0?jt:Qn:Rn&&Rn in Object(o)?pe(o):Kn(o)}var Qn,jt,Rn,rr,Jn=P(()=>{On(),wt(),vn(),Qn="[object Null]",jt="[object Undefined]",Rn=Ar?Ar.toStringTag:void 0,rr=Ln});function _n(o){return o!=null&&typeof o=="object"}var tr,je=P(()=>{tr=_n});function yn(o){return typeof o=="symbol"||tr(o)&&rr(o)==Yt}var Yt,wn,tn=P(()=>{Jn(),je(),Yt="[object Symbol]",wn=yn});function Wt(o,l){for(var h=-1,m=o==null?0:o.length,_=Array(m);++h<m;)_[h]=l(o[h],h,o);return _}var kn,yr=P(()=>{kn=Wt}),ki,hr,Qi=P(()=>{ki=Array.isArray,hr=ki});function Eo(o){if(typeof o=="string")return o;if(hr(o))return kn(o,Eo)+"";if(wn(o))return i0?i0.call(o):"";var l=o+"";return l=="0"&&1/o==-ru?"-0":l}var ru,I0,i0,k0,iu=P(()=>{On(),yr(),Qi(),tn(),ru=1/0,I0=Ar?Ar.prototype:void 0,i0=I0?I0.toString:void 0,k0=Eo});function su(o){for(var l=o.length;l--&&ea.test(o.charAt(l)););return l}var ea,ih,sh=P(()=>{ea=/\s/,ih=su});function zf(o){return o&&o.slice(0,ih(o)+1).replace(ao,"")}var ao,hd,fc=P(()=>{sh(),ao=/^\s+/,hd=zf});function oh(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}var To,va=P(()=>{To=oh});function Vf(o){if(typeof o=="number")return o;if(wn(o))return ye;if(To(o)){var l=typeof o.valueOf=="function"?o.valueOf():o;o=To(l)?l+"":l}if(typeof o!="string")return o===0?o:+o;o=hd(o);var h=Tt.test(o);return h||gt.test(o)?lt(o.slice(2),h?2:8):at.test(o)?ye:+o}var ye,at,Tt,gt,lt,Kt,bn=P(()=>{fc(),va(),tn(),ye=NaN,at=/^[-+]0x[0-9a-f]+$/i,Tt=/^0b[01]+$/i,gt=/^0o[0-7]+$/i,lt=parseInt,Kt=Vf});function Cn(o){if(!o)return o===0?o:0;if(o=Kt(o),o===Nn||o===-Nn){var l=o<0?-1:1;return l*fr}return o===o?o:0}var Nn,fr,ar,Bn=P(()=>{bn(),Nn=1/0,fr=17976931348623157e292,ar=Cn});function Pr(o){var l=ar(o),h=l%1;return l===l?h?l-h:l:0}var _r,Oi=P(()=>{Bn(),_r=Pr});function is(o){return o}var Dr,jn=P(()=>{Dr=is});function vs(o){if(!To(o))return!1;var l=rr(o);return l==lo||l==wl||l==Ur||l==Mo}var Ur,lo,wl,Mo,s0,Li=P(()=>{Jn(),va(),Ur="[object AsyncFunction]",lo="[object Function]",wl="[object GeneratorFunction]",Mo="[object Proxy]",s0=vs}),ys,xs,co=P(()=>{Ii(),ys=Ue["__core-js_shared__"],xs=ys});function ks(o){return!!ti&&ti in o}var ti,Co,dd=P(()=>{co(),ti=function(){var o=/[^.]+$/.exec(xs&&xs.keys&&xs.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Co=ks});function P1(o){if(o!=null){try{return R1.call(o)}catch{}try{return o+""}catch{}}return""}var ou,R1,El,Gf=P(()=>{ou=Function.prototype,R1=ou.toString,El=P1});function jf(o){if(!To(o)||Co(o))return!1;var l=s0(o)?Jg:ya;return l.test(El(o))}var Tl,ya,N0,au,ah,Ml,Jg,I1,fd=P(()=>{Li(),dd(),va(),Gf(),Tl=/[\\^$.*+?()[\]{}|]/g,ya=/^\[object .+?Constructor\]$/,N0=Function.prototype,au=Object.prototype,ah=N0.toString,Ml=au.hasOwnProperty,Jg=RegExp("^"+ah.call(Ml).replace(Tl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I1=jf});function n4(o,l){return o==null?void 0:o[l]}var pc,lu=P(()=>{pc=n4});function e2(o,l){var h=pc(o,l);return I1(h)?h:void 0}var D0,o0=P(()=>{fd(),lu(),D0=e2}),lh,Cl,Hf=P(()=>{o0(),Ii(),lh=D0(Ue,"WeakMap"),Cl=lh}),k1,t2,Wf,$f=P(()=>{va(),k1=Object.create,t2=function(){function o(){}return function(l){if(!To(l))return{};if(k1)return k1(l);o.prototype=l;var h=new o;return o.prototype=void 0,h}}(),Wf=t2});function qf(o,l,h){switch(h.length){case 0:return o.call(l);case 1:return o.call(l,h[0]);case 2:return o.call(l,h[0],h[1]);case 3:return o.call(l,h[0],h[1],h[2])}return o.apply(l,h)}var N1,Al=P(()=>{N1=qf});function Xf(){}var ch,D1=P(()=>{ch=Xf});function Yf(o,l){var h=-1,m=o.length;for(l||(l=Array(m));++h<m;)l[h]=o[h];return l}var Pl,Kf=P(()=>{Pl=Yf});function uo(o){var l=0,h=0;return function(){var m=O0(),_=Ia-(m-h);if(h=m,_>0){if(++l>=cu)return arguments[0]}else l=0;return o.apply(void 0,arguments)}}var cu,Ia,O0,pd,md=P(()=>{cu=800,Ia=16,O0=Date.now,pd=uo});function Rl(o){return function(){return o}}var uu,Il=P(()=>{uu=Rl}),Vs,mc,Zf=P(()=>{o0(),Vs=function(){try{var o=D0(Object,"defineProperty");return o({},"",{}),o}catch{}}(),mc=Vs}),n2,L0,gd=P(()=>{Il(),Zf(),jn(),n2=mc?function(o,l){return mc(o,"toString",{configurable:!0,enumerable:!1,value:uu(l),writable:!0})}:Dr,L0=n2}),r2,i2,O1=P(()=>{gd(),md(),r2=pd(L0),i2=r2});function r4(o,l){for(var h=-1,m=o==null?0:o.length;++h<m&&l(o[h],h,o)!==!1;);return o}var Qf,i4=P(()=>{Qf=r4});function L1(o,l,h,m){for(var _=o.length,w=h+(m?1:-1);m?w--:++w<_;)if(l(o[w],w,o))return w;return-1}var Jf,ep=P(()=>{Jf=L1});function tp(o){return o!==o}var vd,Ao=P(()=>{vd=tp});function s4(o,l,h){for(var m=h-1,_=o.length;++m<_;)if(o[m]===l)return m;return-1}var yd,s2=P(()=>{yd=s4});function o2(o,l,h){return l===l?yd(o,l,h):Jf(o,vd,h)}var Bo,a2=P(()=>{ep(),Ao(),s2(),Bo=o2});function o4(o,l){var h=o==null?0:o.length;return!!h&&Bo(o,l,0)>-1}var l2,c2=P(()=>{a2(),l2=o4});function F1(o,l){var h=typeof o;return l=l??_s,!!l&&(h=="number"||h!="symbol"&&uh.test(o))&&o>-1&&o%1==0&&o<l}var _s,uh,F0,kl=P(()=>{_s=9007199254740991,uh=/^(?:0|[1-9]\d*)$/,F0=F1});function B1(o,l,h){l=="__proto__"&&mc?mc(o,l,{configurable:!0,enumerable:!0,value:h,writable:!0}):o[l]=h}var mi,hu=P(()=>{Zf(),mi=B1});function hh(o,l){return o===l||o!==o&&l!==l}var dh,xd=P(()=>{dh=hh});function u2(o,l,h){var m=o[l];(!(fh.call(o,l)&&dh(m,h))||h===void 0&&!(l in o))&&mi(o,l,h)}var U1,fh,B0,du=P(()=>{hu(),xd(),U1=Object.prototype,fh=U1.hasOwnProperty,B0=u2});function a4(o,l,h,m){var _=!h;h||(h={});for(var w=-1,C=l.length;++w<C;){var R=l[w],N=m?m(h[R],o[R],R,h,o):void 0;N===void 0&&(N=o[R]),_?mi(h,R,N):B0(h,R,N)}return h}var Nl,np=P(()=>{du(),hu(),Nl=a4});function h2(o,l,h){return l=le(l===void 0?o.length-1:l,0),function(){for(var m=arguments,_=-1,w=le(m.length-l,0),C=Array(w);++_<w;)C[_]=m[l+_];_=-1;for(var R=Array(l+1);++_<l;)R[_]=m[_];return R[l]=h(C),N1(o,this,R)}}var le,we,We=P(()=>{Al(),le=Math.max,we=h2});function kt(o,l){return i2(we(o,l,Dr),o+"")}var pr,bi=P(()=>{jn(),We(),O1(),pr=kt});function Uo(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=a0}var a0,_d,gc=P(()=>{a0=9007199254740991,_d=Uo});function zo(o){return o!=null&&_d(o.length)&&!s0(o)}var Dl,rp=P(()=>{Li(),gc(),Dl=zo});function kv(o,l,h){if(!To(h))return!1;var m=typeof l;return(m=="number"?Dl(h)&&F0(l,h.length):m=="string"&&l in h)?dh(h[l],o):!1}var d2,Nv=P(()=>{xd(),rp(),kl(),va(),d2=kv});function l4(o){var l=o&&o.constructor,h=typeof l=="function"&&l.prototype||Dv;return o===h}var Dv,f2,Ol=P(()=>{Dv=Object.prototype,f2=l4});function c4(o,l){for(var h=-1,m=Array(o);++h<o;)m[h]=l(h);return m}var ip,z1=P(()=>{ip=c4});function Ov(o){return tr(o)&&rr(o)==sp}var sp,ph,u4=P(()=>{Jn(),je(),sp="[object Arguments]",ph=Ov}),op,V1,h4,d4,G1,j1=P(()=>{u4(),je(),op=Object.prototype,V1=op.hasOwnProperty,h4=op.propertyIsEnumerable,d4=ph(function(){return arguments}())?ph:function(o){return tr(o)&&V1.call(o,"callee")&&!h4.call(o,"callee")},G1=d4});function f4(){return!1}var p4,mh=P(()=>{p4=f4}),H1,ap,Lv,m4,bd,g4,lp,W1=P(()=>{Ii(),mh(),H1=e&&!e.nodeType&&e,ap=H1&&!0&&s&&!s.nodeType&&s,Lv=ap&&ap.exports===H1,m4=Lv?Ue.Buffer:void 0,bd=m4?m4.isBuffer:void 0,g4=bd||p4,lp=g4});function us(o){return tr(o)&&_d(o.length)&&!!Ji[rr(o)]}var p2,gh,cp,v4,m2,up,$1,Sd,y4,Fv,Bv,x4,q1,X1,g2,v2,y2,x2,Uv,_4,zv,Vv,_2,fu,Ji,wd,gi=P(()=>{Jn(),gc(),je(),p2="[object Arguments]",gh="[object Array]",cp="[object Boolean]",v4="[object Date]",m2="[object Error]",up="[object Function]",$1="[object Map]",Sd="[object Number]",y4="[object Object]",Fv="[object RegExp]",Bv="[object Set]",x4="[object String]",q1="[object WeakMap]",X1="[object ArrayBuffer]",g2="[object DataView]",v2="[object Float32Array]",y2="[object Float64Array]",x2="[object Int8Array]",Uv="[object Int16Array]",_4="[object Int32Array]",zv="[object Uint8Array]",Vv="[object Uint8ClampedArray]",_2="[object Uint16Array]",fu="[object Uint32Array]",Ji={},Ji[v2]=Ji[y2]=Ji[x2]=Ji[Uv]=Ji[_4]=Ji[zv]=Ji[Vv]=Ji[_2]=Ji[fu]=!0,Ji[p2]=Ji[gh]=Ji[X1]=Ji[cp]=Ji[g2]=Ji[v4]=Ji[m2]=Ji[up]=Ji[$1]=Ji[Sd]=Ji[y4]=Ji[Fv]=Ji[Bv]=Ji[x4]=Ji[q1]=!1,wd=us});function Y1(o){return function(l){return o(l)}}var ka,Ed=P(()=>{ka=Y1}),K1,Td,U0,vh,pu,vc,yc=P(()=>{Kr(),K1=e&&!e.nodeType&&e,Td=K1&&!0&&s&&!s.nodeType&&s,U0=Td&&Td.exports===K1,vh=U0&&Fn.process,pu=function(){try{var o=Td&&Td.require&&Td.require("util").types;return o||vh&&vh.binding&&vh.binding("util")}catch{}}(),vc=pu}),mu,gu,Hi,es=P(()=>{gi(),Ed(),yc(),mu=vc&&vc.isTypedArray,gu=mu?ka(mu):wd,Hi=gu});function yh(o,l){var h=hr(o),m=!h&&G1(o),_=!h&&!m&&lp(o),w=!h&&!m&&!_&&Hi(o),C=h||m||_||w,R=C?ip(o.length,String):[],N=R.length;for(var F in o)(l||ta.call(o,F))&&!(C&&(F=="length"||_&&(F=="offset"||F=="parent")||w&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||F0(F,N)))&&R.push(F);return R}var Vo,ta,vu,xh=P(()=>{z1(),j1(),Qi(),W1(),kl(),es(),Vo=Object.prototype,ta=Vo.hasOwnProperty,vu=yh});function Na(o,l){return function(h){return o(l(h))}}var hp,b4=P(()=>{hp=Na}),S4,Z1,Gv=P(()=>{b4(),S4=hp(Object.keys,Object),Z1=S4});function yu(o){if(!f2(o))return Z1(o);var l=[];for(var h in Object(o))b2.call(o,h)&&h!="constructor"&&l.push(h);return l}var xu,b2,w4,l_=P(()=>{Ol(),Gv(),xu=Object.prototype,b2=xu.hasOwnProperty,w4=yu});function _h(o){return Dl(o)?vu(o):w4(o)}var Ll,xc=P(()=>{xh(),l_(),rp(),Ll=_h});function S2(o){var l=[];if(o!=null)for(var h in Object(o))l.push(h);return l}var Md,z0=P(()=>{Md=S2});function l0(o){if(!To(o))return Md(o);var l=f2(o),h=[];for(var m in o)m=="constructor"&&(l||!V0.call(o,m))||h.push(m);return h}var bh,V0,_c,Cd=P(()=>{va(),Ol(),z0(),bh=Object.prototype,V0=bh.hasOwnProperty,_c=l0});function jv(o){return Dl(o)?vu(o,!0):_c(o)}var Ad,Q1=P(()=>{xh(),Cd(),rp(),Ad=jv});function c0(o,l){if(hr(o))return!1;var h=typeof o;return h=="number"||h=="symbol"||h=="boolean"||o==null||wn(o)?!0:hs.test(o)||!Da.test(o)||l!=null&&o in Object(l)}var Da,hs,Oa,J1=P(()=>{Qi(),tn(),Da=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hs=/^\w*$/,Oa=c0}),E4,Sh,dp=P(()=>{o0(),E4=D0(Object,"create"),Sh=E4});function Hv(){this.__data__=Sh?Sh(null):{},this.size=0}var em,Wv=P(()=>{dp(),em=Hv});function fp(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}var w2,c_=P(()=>{w2=fp});function tm(o){var l=this.__data__;if(Sh){var h=l[o];return h===nm?void 0:h}return T4.call(l,o)?l[o]:void 0}var nm,rm,T4,Pd,M4=P(()=>{dp(),nm="__lodash_hash_undefined__",rm=Object.prototype,T4=rm.hasOwnProperty,Pd=tm});function E2(o){var l=this.__data__;return Sh?l[o]!==void 0:Rd.call(l,o)}var im,Rd,T2,C4=P(()=>{dp(),im=Object.prototype,Rd=im.hasOwnProperty,T2=E2});function A4(o,l){var h=this.__data__;return this.size+=this.has(o)?0:1,h[o]=Sh&&l===void 0?pp:l,this}var pp,_u,G0=P(()=>{dp(),pp="__lodash_hash_undefined__",_u=A4});function u0(o){var l=-1,h=o==null?0:o.length;for(this.clear();++l<h;){var m=o[l];this.set(m[0],m[1])}}var mp,P4=P(()=>{Wv(),c_(),M4(),C4(),G0(),u0.prototype.clear=em,u0.prototype.delete=w2,u0.prototype.get=Pd,u0.prototype.has=T2,u0.prototype.set=_u,mp=u0});function bu(){this.__data__=[],this.size=0}var bc,M2=P(()=>{bc=bu});function $v(o,l){for(var h=o.length;h--;)if(dh(o[h][0],l))return h;return-1}var h0,Fl=P(()=>{xd(),h0=$v});function C2(o){var l=this.__data__,h=h0(l,o);if(h<0)return!1;var m=l.length-1;return h==m?l.pop():sm.call(l,h,1),--this.size,!0}var R4,sm,I4,om=P(()=>{Fl(),R4=Array.prototype,sm=R4.splice,I4=C2});function Sc(o){var l=this.__data__,h=h0(l,o);return h<0?void 0:l[h][1]}var gp,am=P(()=>{Fl(),gp=Sc});function wh(o){return h0(this.__data__,o)>-1}var A2,vp=P(()=>{Fl(),A2=wh});function qv(o,l){var h=this.__data__,m=h0(h,o);return m<0?(++this.size,h.push([o,l])):h[m][1]=l,this}var P2,Cs=P(()=>{Fl(),P2=qv});function Su(o){var l=-1,h=o==null?0:o.length;for(this.clear();++l<h;){var m=o[l];this.set(m[0],m[1])}}var Id,yp=P(()=>{M2(),om(),am(),vp(),Cs(),Su.prototype.clear=bc,Su.prototype.delete=I4,Su.prototype.get=gp,Su.prototype.has=A2,Su.prototype.set=P2,Id=Su}),lm,Eh,wu=P(()=>{o0(),Ii(),lm=D0(Ue,"Map"),Eh=lm});function Wi(){this.size=0,this.__data__={hash:new mp,map:new(Eh||Id),string:new mp}}var bs,Po=P(()=>{P4(),yp(),wu(),bs=Wi});function R2(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}var xp,cm=P(()=>{xp=R2});function Xv(o,l){var h=o.__data__;return xp(l)?h[typeof l=="string"?"string":"hash"]:h.map}var Gs,_p=P(()=>{cm(),Gs=Xv});function I2(o){var l=Gs(this,o).delete(o);return this.size-=l?1:0,l}var um,wc=P(()=>{_p(),um=I2});function j0(o){return Gs(this,o).get(o)}var bp,k4=P(()=>{_p(),bp=j0});function N4(o){return Gs(this,o).has(o)}var k2,Yv=P(()=>{_p(),k2=N4});function Kv(o,l){var h=Gs(this,o),m=h.size;return h.set(o,l),this.size+=h.size==m?0:1,this}var N2,Zv=P(()=>{_p(),N2=Kv});function Eu(o){var l=-1,h=o==null?0:o.length;for(this.clear();++l<h;){var m=o[l];this.set(m[0],m[1])}}var Sp,D2=P(()=>{Po(),wc(),k4(),Yv(),Zv(),Eu.prototype.clear=bs,Eu.prototype.delete=um,Eu.prototype.get=bp,Eu.prototype.has=k2,Eu.prototype.set=N2,Sp=Eu});function kd(o,l){if(typeof o!="function"||l!=null&&typeof l!="function")throw new TypeError(D4);var h=function(){var m=arguments,_=l?l.apply(this,m):m[0],w=h.cache;if(w.has(_))return w.get(_);var C=o.apply(this,m);return h.cache=w.set(_,C)||w,C};return h.cache=new(kd.Cache||Sp),h}var D4,Nd,hm=P(()=>{D2(),D4="Expected a function",kd.Cache=Sp,Nd=kd});function Qv(o){var l=Nd(o,function(m){return h.size===O2&&h.clear(),m}),h=l.cache;return l}var O2,L2,Jv=P(()=>{hm(),O2=500,L2=Qv}),dm,O4,F2,L4,B2=P(()=>{Jv(),dm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,O4=/\\(\\)?/g,F2=L2(function(o){var l=[];return o.charCodeAt(0)===46&&l.push(""),o.replace(dm,function(h,m,_,w){l.push(_?w.replace(O4,"$1"):m||h)}),l}),L4=F2});function ey(o){return o==null?"":k0(o)}var wp,F4=P(()=>{iu(),wp=ey});function B4(o,l){return hr(o)?o:Oa(o,l)?[o]:L4(wp(o))}var fm,U2=P(()=>{Qi(),J1(),B2(),F4(),fm=B4});function U4(o){if(typeof o=="string"||wn(o))return o;var l=o+"";return l=="0"&&1/o==-z2?"-0":l}var z2,Ec,Ep=P(()=>{tn(),z2=1/0,Ec=U4});function u_(o,l){l=fm(l,o);for(var h=0,m=l.length;o!=null&&h<m;)o=o[Ec(l[h++])];return h&&h==m?o:void 0}var V2,d0=P(()=>{U2(),Ep(),V2=u_});function z4(o,l,h){var m=o==null?void 0:V2(o,l);return m===void 0?h:m}var Tc,H0=P(()=>{d0(),Tc=z4});function Tp(o,l){for(var h=-1,m=l.length,_=o.length;++h<m;)o[_+h]=l[h];return o}var pm,mm=P(()=>{pm=Tp});function Mp(o){return hr(o)||G1(o)||!!(gm&&o&&o[gm])}var gm,G2,j2=P(()=>{On(),j1(),Qi(),gm=Ar?Ar.isConcatSpreadable:void 0,G2=Mp});function V4(o,l,h,m,_){var w=-1,C=o.length;for(h||(h=G2),_||(_=[]);++w<C;){var R=o[w];l>0&&h(R)?l>1?V4(R,l-1,h,m,_):pm(_,R):m||(_[_.length]=R)}return _}var vm,ty=P(()=>{mm(),j2(),vm=V4}),G4,ym,j4=P(()=>{b4(),G4=hp(Object.getPrototypeOf,Object),ym=G4});function La(o){if(!tr(o)||rr(o)!=Go)return!1;var l=ym(o);if(l===null)return!0;var h=W4.call(l,"constructor")&&l.constructor;return typeof h=="function"&&h instanceof h&&W2.call(h)==$4}var Go,H2,H4,W2,W4,$4,Cp,q4=P(()=>{Jn(),j4(),je(),Go="[object Object]",H2=Function.prototype,H4=Object.prototype,W2=H2.toString,W4=H4.hasOwnProperty,$4=W2.call(Object),Cp=La});function X4(o){var l=Math[o];return function(h,m){if(h=Kt(h),m=m==null?0:K4(_r(m),292),m&&Y4(h)){var _=(wp(h)+"e").split("e"),w=l(_[0]+"e"+(+_[1]+m));return _=(wp(w)+"e").split("e"),+(_[0]+"e"+(+_[1]-m))}return l(h)}}var Y4,K4,$2,Z4=P(()=>{Ii(),Oi(),bn(),F4(),Y4=Ue.isFinite,K4=Math.min,$2=X4});function ny(o,l,h){return o===o&&(h!==void 0&&(o=o<=h?o:h),l!==void 0&&(o=o>=l?o:l)),o}var q2,X2=P(()=>{q2=ny});function h_(o,l,h){return h===void 0&&(h=l,l=void 0),h!==void 0&&(h=Kt(h),h=h===h?h:0),l!==void 0&&(l=Kt(l),l=l===l?l:0),q2(Kt(o),l,h)}var Bi,Dd=P(()=>{X2(),bn(),Bi=h_});function ry(){this.__data__=new Id,this.size=0}var xm,Tu=P(()=>{yp(),xm=ry});function d_(o){var l=this.__data__,h=l.delete(o);return this.size=l.size,h}var Q4,J4=P(()=>{Q4=d_});function iy(o){return this.__data__.get(o)}var e5,_m=P(()=>{e5=iy});function na(o){return this.__data__.has(o)}var sy,f_=P(()=>{sy=na});function Y2(o,l){var h=this.__data__;if(h instanceof Id){var m=h.__data__;if(!Eh||m.length<Ro-1)return m.push([o,l]),this.size=++h.size,this;h=this.__data__=new Sp(m)}return h.set(o,l),this.size=h.size,this}var Ro,oy,Un=P(()=>{yp(),wu(),D2(),Ro=200,oy=Y2});function Bl(o){var l=this.__data__=new Id(o);this.size=l.size}var Th,K2=P(()=>{yp(),Tu(),J4(),_m(),f_(),Un(),Bl.prototype.clear=xm,Bl.prototype.delete=Q4,Bl.prototype.get=e5,Bl.prototype.has=sy,Bl.prototype.set=oy,Th=Bl});function ay(o,l){return o&&Nl(l,Ll(l),o)}var Ap,Z2=P(()=>{np(),xc(),Ap=ay});function t5(o,l){return o&&Nl(l,Ad(l),o)}var n5,ly=P(()=>{np(),Q1(),n5=t5});function r5(o,l){if(l)return o.slice();var h=o.length,m=Ul?Ul(h):new o.constructor(h);return o.copy(m),m}var bm,Sm,Io,f0,Ul,i5,cy=P(()=>{Ii(),bm=e&&!e.nodeType&&e,Sm=bm&&!0&&s&&!s.nodeType&&s,Io=Sm&&Sm.exports===bm,f0=Io?Ue.Buffer:void 0,Ul=f0?f0.allocUnsafe:void 0,i5=r5});function zl(o,l){for(var h=-1,m=o==null?0:o.length,_=0,w=[];++h<m;){var C=o[h];l(C,h,o)&&(w[_++]=C)}return w}var Q2,Mc=P(()=>{Q2=zl});function p_(){return[]}var J2,s5=P(()=>{J2=p_}),o5,a5,l5,wm,Pp,Fa=P(()=>{Mc(),s5(),o5=Object.prototype,a5=o5.propertyIsEnumerable,l5=Object.getOwnPropertySymbols,wm=l5?function(o){return o==null?[]:(o=Object(o),Q2(l5(o),function(l){return a5.call(o,l)}))}:J2,Pp=wm});function Si(o,l){return Nl(o,Pp(o),l)}var ho,Js=P(()=>{np(),Fa(),ho=Si}),ko,Ba,Mh,Tr=P(()=>{mm(),j4(),Fa(),s5(),ko=Object.getOwnPropertySymbols,Ba=ko?function(o){for(var l=[];o;)pm(l,Pp(o)),o=ym(o);return l}:J2,Mh=Ba});function Ch(o,l){return Nl(o,Mh(o),l)}var Ah,e9=P(()=>{np(),Tr(),Ah=Ch});function c5(o,l,h){var m=l(o);return hr(o)?m:pm(m,h(o))}var Od,xa=P(()=>{mm(),Qi(),Od=c5});function u5(o){return Od(o,Ll,Pp)}var Mu,Cc=P(()=>{xa(),Fa(),xc(),Mu=u5});function t9(o){return Od(o,Ad,Mh)}var n9,Vl=P(()=>{xa(),Tr(),Q1(),n9=t9}),Em,Gl,r9=P(()=>{o0(),Ii(),Em=D0(Ue,"DataView"),Gl=Em}),Rp,Ip,i9=P(()=>{o0(),Ii(),Rp=D0(Ue,"Promise"),Ip=Rp}),Tm,js,Ac=P(()=>{o0(),Ii(),Tm=D0(Ue,"Set"),js=Tm}),p0,_a,s9,Mm,Cm,h5,Cu,d5,o9,Ph,a9,Ua,Ld,Am=P(()=>{r9(),wu(),i9(),Ac(),Hf(),Jn(),Gf(),p0="[object Map]",_a="[object Object]",s9="[object Promise]",Mm="[object Set]",Cm="[object WeakMap]",h5="[object DataView]",Cu=El(Gl),d5=El(Eh),o9=El(Ip),Ph=El(js),a9=El(Cl),Ua=rr,(Gl&&Ua(new Gl(new ArrayBuffer(1)))!=h5||Eh&&Ua(new Eh)!=p0||Ip&&Ua(Ip.resolve())!=s9||js&&Ua(new js)!=Mm||Cl&&Ua(new Cl)!=Cm)&&(Ua=function(o){var l=rr(o),h=l==_a?o.constructor:void 0,m=h?El(h):"";if(m)switch(m){case Cu:return h5;case d5:return p0;case o9:return s9;case Ph:return Mm;case a9:return Cm}return l}),Ld=Ua});function f5(o){var l=o.length,h=new o.constructor(l);return l&&typeof o[0]=="string"&&uy.call(o,"index")&&(h.index=o.index,h.input=o.input),h}var Pm,uy,p5,l9=P(()=>{Pm=Object.prototype,uy=Pm.hasOwnProperty,p5=f5}),m5,jl,hy=P(()=>{Ii(),m5=Ue.Uint8Array,jl=m5});function kp(o){var l=new o.constructor(o.byteLength);return new jl(l).set(new jl(o)),l}var Rm,Ss=P(()=>{hy(),Rm=kp});function m_(o,l){var h=l?Rm(o.buffer):o.buffer;return new o.constructor(h,o.byteOffset,o.byteLength)}var g5,dy=P(()=>{Ss(),g5=m_});function fy(o){var l=new o.constructor(o.source,Np.exec(o));return l.lastIndex=o.lastIndex,l}var Np,v5,py=P(()=>{Np=/\w*$/,v5=fy});function W0(o){return c9?Object(c9.call(o)):{}}var Im,c9,Pc,u9=P(()=>{On(),Im=Ar?Ar.prototype:void 0,c9=Im?Im.valueOf:void 0,Pc=W0});function Fd(o,l){var h=l?Rm(o.buffer):o.buffer;return new o.constructor(h,o.byteOffset,o.length)}var km,y5=P(()=>{Ss(),km=Fd});function x5(o,l,h){var m=o.constructor;switch(l){case f9:return Rm(o);case _5:case h9:return new m(+o);case gy:return g5(o,h);case w5:case p9:case Om:case m9:case Lm:case E5:case vy:case Fm:case T5:return km(o,h);case my:return new m;case b5:case Dm:return new m(o);case d9:return v5(o);case Nm:return new m;case S5:return Pc(o)}}var _5,h9,my,b5,d9,Nm,Dm,S5,f9,gy,w5,p9,Om,m9,Lm,E5,vy,Fm,T5,Dp,g_=P(()=>{Ss(),dy(),py(),u9(),y5(),_5="[object Boolean]",h9="[object Date]",my="[object Map]",b5="[object Number]",d9="[object RegExp]",Nm="[object Set]",Dm="[object String]",S5="[object Symbol]",f9="[object ArrayBuffer]",gy="[object DataView]",w5="[object Float32Array]",p9="[object Float64Array]",Om="[object Int8Array]",m9="[object Int16Array]",Lm="[object Int32Array]",E5="[object Uint8Array]",vy="[object Uint8ClampedArray]",Fm="[object Uint16Array]",T5="[object Uint32Array]",Dp=x5});function g9(o){return typeof o.constructor=="function"&&!f2(o)?Wf(ym(o)):{}}var d,g=P(()=>{$f(),j4(),Ol(),d=g9});function E(o){return tr(o)&&Ld(o)==D}var D,H,Q=P(()=>{Am(),je(),D="[object Map]",H=E}),he,ke,ze,Ct=P(()=>{Q(),Ed(),yc(),he=vc&&vc.isMap,ke=he?ka(he):H,ze=ke});function Qt(o){return tr(o)&&Ld(o)==cn}var cn,Zt,Dn=P(()=>{Am(),je(),cn="[object Set]",Zt=Qt}),zn,Hn,Ns,yt=P(()=>{Dn(),Ed(),yc(),zn=vc&&vc.isSet,Hn=zn?ka(zn):Zt,Ns=Hn});function Qe(o,l,h,m,_,w){var C,R=l&St,N=l&fn,F=l&er;if(h&&(C=_?h(o,m,_,w):h(o)),C!==void 0)return C;if(!To(o))return o;var U=hr(o);if(U){if(C=p5(o),!R)return Pl(o,C)}else{var $=Ld(o),j=$==Rc||$==yy;if(lp(o))return i5(o,R);if($==y_||$==dr||j&&!_){if(C=N||j?{}:d(o),!R)return N?Ah(o,n5(C,o)):ho(o,Ap(C,o))}else{if(!ds[$])return _?o:{};C=Dp(o,$,R)}}w||(w=new Th);var G=w.get(o);if(G)return G;w.set(o,C),Ns(o)?o.forEach(function(ne){C.add(Qe(ne,l,h,ne,o,w))}):ze(o)&&o.forEach(function(ne,ae){C.set(ae,Qe(ne,l,h,ae,o,w))});var Y=F?N?n9:Mu:N?Ad:Ll,Z=U?void 0:Y(o);return Qf(Z||o,function(ne,ae){Z&&(ae=ne,ne=o[ae]),B0(C,ae,Qe(ne,l,h,ae,o,w))}),C}var St,fn,er,dr,mr,br,fo,wi,Rc,yy,v_,WE,y_,x_,$E,qE,XE,YE,KE,ZE,xy,_y,QE,__,b_,S_,JE,w_,E_,ds,eT,mN=P(()=>{K2(),i4(),du(),Z2(),ly(),cy(),Kf(),Js(),e9(),Cc(),Vl(),Am(),l9(),g_(),g(),Qi(),W1(),Ct(),va(),yt(),xc(),Q1(),St=1,fn=2,er=4,dr="[object Arguments]",mr="[object Array]",br="[object Boolean]",fo="[object Date]",wi="[object Error]",Rc="[object Function]",yy="[object GeneratorFunction]",v_="[object Map]",WE="[object Number]",y_="[object Object]",x_="[object RegExp]",$E="[object Set]",qE="[object String]",XE="[object Symbol]",YE="[object WeakMap]",KE="[object ArrayBuffer]",ZE="[object DataView]",xy="[object Float32Array]",_y="[object Float64Array]",QE="[object Int8Array]",__="[object Int16Array]",b_="[object Int32Array]",S_="[object Uint8Array]",JE="[object Uint8ClampedArray]",w_="[object Uint16Array]",E_="[object Uint32Array]",ds={},ds[dr]=ds[mr]=ds[KE]=ds[ZE]=ds[br]=ds[fo]=ds[xy]=ds[_y]=ds[QE]=ds[__]=ds[b_]=ds[v_]=ds[WE]=ds[y_]=ds[x_]=ds[$E]=ds[qE]=ds[XE]=ds[S_]=ds[JE]=ds[w_]=ds[E_]=!0,ds[wi]=ds[Rc]=ds[YE]=!1,eT=Qe});function tT(o){return eT(o,nT|rT)}var nT,rT,iT,sT=P(()=>{mN(),nT=1,rT=4,iT=tT});function gN(o){return this.__data__.set(o,oT),this}var oT,aT,vN=P(()=>{oT="__lodash_hash_undefined__",aT=gN});function M5(o){return this.__data__.has(o)}var lT,cT=P(()=>{lT=M5});function by(o){var l=-1,h=o==null?0:o.length;for(this.__data__=new Sp;++l<h;)this.add(o[l])}var T_,uT=P(()=>{D2(),vN(),cT(),by.prototype.add=by.prototype.push=aT,by.prototype.has=lT,T_=by});function Sy(o,l){for(var h=-1,m=o==null?0:o.length;++h<m;)if(l(o[h],h,o))return!0;return!1}var wy,yN=P(()=>{wy=Sy});function xN(o,l){return o.has(l)}var ss,$0=P(()=>{ss=xN});function Hl(o,l,h,m,_,w){var C=h&Op,R=o.length,N=l.length;if(R!=N&&!(C&&N>R))return!1;var F=w.get(o),U=w.get(l);if(F&&U)return F==l&&U==o;var $=-1,j=!0,G=h&fs?new T_:void 0;for(w.set(o,l),w.set(l,o);++$<R;){var Y=o[$],Z=l[$];if(m)var ne=C?m(Z,Y,$,l,o,w):m(Y,Z,$,o,l,w);if(ne!==void 0){if(ne)continue;j=!1;break}if(G){if(!wy(l,function(ae,ce){if(!ss(G,ce)&&(Y===ae||_(Y,ae,h,m,w)))return G.push(ce)})){j=!1;break}}else if(!(Y===Z||_(Y,Z,h,m,w))){j=!1;break}}return w.delete(o),w.delete(l),j}var Op,fs,Au,M_=P(()=>{uT(),yN(),$0(),Op=1,fs=2,Au=Hl});function _N(o){var l=-1,h=Array(o.size);return o.forEach(function(m,_){h[++l]=[_,m]}),h}var hT,bN=P(()=>{hT=_N});function SN(o){var l=-1,h=Array(o.size);return o.forEach(function(m){h[++l]=m}),h}var Ey,Ty=P(()=>{Ey=SN});function dT(o,l,h,m,_,w,C){switch(h){case k_:if(o.byteLength!=l.byteLength||o.byteOffset!=l.byteOffset)return!1;o=o.buffer,l=l.buffer;case v9:return!(o.byteLength!=l.byteLength||!w(new jl(o),new jl(l)));case fT:case A_:case pT:return dh(+o,+l);case P_:return o.name==l.name&&o.message==l.message;case mT:case gT:return o==l+"";case R_:var R=hT;case I_:var N=m&C5;if(R||(R=Ey),o.size!=l.size&&!N)return!1;var F=C.get(o);if(F)return F==l;m|=C_,C.set(o,l);var U=Au(R(o),R(l),m,_,w,C);return C.delete(o),U;case vT:if(My)return My.call(o)==My.call(l)}return!1}var C5,C_,fT,A_,P_,R_,pT,mT,I_,gT,vT,v9,k_,N_,My,eo,Bd=P(()=>{On(),hy(),xd(),M_(),bN(),Ty(),C5=1,C_=2,fT="[object Boolean]",A_="[object Date]",P_="[object Error]",R_="[object Map]",pT="[object Number]",mT="[object RegExp]",I_="[object Set]",gT="[object String]",vT="[object Symbol]",v9="[object ArrayBuffer]",k_="[object DataView]",N_=Ar?Ar.prototype:void 0,My=N_?N_.valueOf:void 0,eo=dT});function wN(o,l,h,m,_,w){var C=h&A5,R=Mu(o),N=R.length,F=Mu(l),U=F.length;if(N!=U&&!C)return!1;for(var $=N;$--;){var j=R[$];if(!(C?j in l:xT.call(l,j)))return!1}var G=w.get(o),Y=w.get(l);if(G&&Y)return G==l&&Y==o;var Z=!0;w.set(o,l),w.set(l,o);for(var ne=C;++$<N;){j=R[$];var ae=o[j],ce=l[j];if(m)var ve=C?m(ce,ae,j,l,o,w):m(ae,ce,j,o,l,w);if(!(ve===void 0?ae===ce||_(ae,ce,h,m,w):ve)){Z=!1;break}ne||(ne=j=="constructor")}if(Z&&!ne){var Me=o.constructor,Te=l.constructor;Me!=Te&&"constructor"in o&&"constructor"in l&&!(typeof Me=="function"&&Me instanceof Me&&typeof Te=="function"&&Te instanceof Te)&&(Z=!1)}return w.delete(o),w.delete(l),Z}var A5,yT,xT,_T,EN=P(()=>{Cc(),A5=1,yT=Object.prototype,xT=yT.hasOwnProperty,_T=wN});function D_(o,l,h,m,_,w){var C=hr(o),R=hr(l),N=C?Lp:Ld(o),F=R?Lp:Ld(l);N=N==y9?P5:N,F=F==y9?P5:F;var U=N==P5,$=F==P5,j=N==F;if(j&&lp(o)){if(!lp(l))return!1;C=!0,U=!1}if(j&&!U)return w||(w=new Th),C||Hi(o)?Au(o,l,h,m,_,w):eo(o,l,N,h,m,_,w);if(!(h&bT)){var G=U&&Cy.call(o,"__wrapped__"),Y=$&&Cy.call(l,"__wrapped__");if(G||Y){var Z=G?o.value():o,ne=Y?l.value():l;return w||(w=new Th),_(Z,ne,h,m,w)}}return j?(w||(w=new Th),_T(o,l,h,m,_,w)):!1}var bT,y9,Lp,P5,ST,Cy,Ay,TN=P(()=>{K2(),M_(),Bd(),EN(),Am(),Qi(),W1(),es(),bT=1,y9="[object Arguments]",Lp="[object Array]",P5="[object Object]",ST=Object.prototype,Cy=ST.hasOwnProperty,Ay=D_});function R5(o,l,h,m,_){return o===l?!0:o==null||l==null||!tr(o)&&!tr(l)?o!==o&&l!==l:Ay(o,l,h,m,R5,_)}var Py,Ry=P(()=>{TN(),je(),Py=R5});function MN(o,l,h,m){var _=h.length,w=_,C=!m;if(o==null)return!w;for(o=Object(o);_--;){var R=h[_];if(C&&R[2]?R[1]!==o[R[0]]:!(R[0]in o))return!1}for(;++_<w;){R=h[_];var N=R[0],F=o[N],U=R[1];if(C&&R[2]){if(F===void 0&&!(N in o))return!1}else{var $=new Th;if(m)var j=m(F,U,N,o,l,$);if(!(j===void 0?Py(U,F,wT|ET,m,$):j))return!1}}return!0}var wT,ET,TT,CN=P(()=>{K2(),Ry(),wT=1,ET=2,TT=MN});function AN(o){return o===o&&!To(o)}var O_,Fp=P(()=>{va(),O_=AN});function Bm(o){for(var l=Ll(o),h=l.length;h--;){var m=l[h],_=o[m];l[h]=[m,_,O_(_)]}return l}var Um,L_=P(()=>{Fp(),xc(),Um=Bm});function MT(o,l){return function(h){return h==null?!1:h[o]===l&&(l!==void 0||o in Object(h))}}var F_,B_=P(()=>{F_=MT});function PN(o){var l=Um(o);return l.length==1&&l[0][2]?F_(l[0][0],l[0][1]):function(h){return h===o||TT(h,o,l)}}var Iy,RN=P(()=>{CN(),L_(),B_(),Iy=PN});function IN(o,l){return o!=null&&l in Object(o)}var U_,CT=P(()=>{U_=IN});function kN(o,l,h){l=fm(l,o);for(var m=-1,_=l.length,w=!1;++m<_;){var C=Ec(l[m]);if(!(w=o!=null&&h(o,C)))break;o=o[C]}return w||++m!=_?w:(_=o==null?0:o.length,!!_&&_d(_)&&F0(C,_)&&(hr(o)||G1(o)))}var Rh,AT=P(()=>{U2(),j1(),Qi(),kl(),gc(),Ep(),Rh=kN});function NN(o,l){return o!=null&&Rh(o,l,U_)}var PT,z_=P(()=>{CT(),AT(),PT=NN});function DN(o,l){return Oa(o)&&O_(l)?F_(Ec(o),l):function(h){var m=Tc(h,o);return m===void 0&&m===l?PT(h,o):Py(l,m,RT|IT)}}var RT,IT,kT,NT=P(()=>{Ry(),H0(),z_(),J1(),Fp(),B_(),Ep(),RT=1,IT=2,kT=DN});function ON(o){return function(l){return l==null?void 0:l[o]}}var DT,LN=P(()=>{DT=ON});function FN(o){return function(l){return V2(l,o)}}var OT,BN=P(()=>{d0(),OT=FN});function LT(o){return Oa(o)?DT(Ec(o)):OT(o)}var FT,I5=P(()=>{LN(),BN(),J1(),Ep(),FT=LT});function BT(o){return typeof o=="function"?o:o==null?Dr:typeof o=="object"?hr(o)?kT(o[0],o[1]):Iy(o):FT(o)}var x9,k5=P(()=>{RN(),NT(),jn(),Qi(),I5(),x9=BT});function UN(o,l,h,m){for(var _=-1,w=o==null?0:o.length;++_<w;){var C=o[_];l(m,C,h(C),o)}return m}var UT,ky=P(()=>{UT=UN});function zN(o){return function(l,h,m){for(var _=-1,w=Object(l),C=m(l),R=C.length;R--;){var N=C[o?R:++_];if(h(w[N],N,w)===!1)break}return l}}var _9,VN=P(()=>{_9=zN}),zT,VT,GN=P(()=>{VN(),zT=_9(),VT=zT});function V_(o,l){return o&&VT(o,l,Ll)}var Ny,GT=P(()=>{GN(),xc(),Ny=V_});function jN(o,l){return function(h,m){if(h==null)return h;if(!Dl(h))return o(h,m);for(var _=h.length,w=l?_:-1,C=Object(h);(l?w--:++w<_)&&m(C[w],w,C)!==!1;);return h}}var Wl,zm=P(()=>{rp(),Wl=jN}),Bp,G_,b9=P(()=>{GT(),zm(),Bp=Wl(Ny),G_=Bp});function S9(o,l,h,m){return G_(o,function(_,w,C){l(m,_,h(_),C)}),m}var Dy,HN=P(()=>{b9(),Dy=S9});function jT(o,l){return function(h,m){var _=hr(h)?UT:Dy,w=l?l():{};return _(h,o,x9(m,2),w)}}var HT,j_=P(()=>{ky(),HN(),k5(),Qi(),HT=jT}),Oy,Ih,H_=P(()=>{Ii(),Oy=function(){return Ue.Date.now()},Ih=Oy});function W_(o,l,h){var m,_,w,C,R,N,F=0,U=!1,$=!1,j=!0;if(typeof o!="function")throw new TypeError(WT);l=Kt(l)||0,To(h)&&(U=!!h.leading,$="maxWait"in h,w=$?Ly(Kt(h.maxWait)||0,l):w,j="trailing"in h?!!h.trailing:j);function G(_e){var it=m,Re=_;return m=_=void 0,F=_e,C=o.apply(Re,it),C}function Y(_e){return F=_e,R=setTimeout(ae,l),U?G(_e):C}function Z(_e){var it=_e-N,Re=_e-F,xe=l-it;return $?kh(xe,w-Re):xe}function ne(_e){var it=_e-N,Re=_e-F;return N===void 0||it>=l||it<0||$&&Re>=w}function ae(){var _e=Ih();if(ne(_e))return ce(_e);R=setTimeout(ae,Z(_e))}function ce(_e){return R=void 0,j&&m?G(_e):(m=_=void 0,C)}function ve(){R!==void 0&&clearTimeout(R),F=0,m=N=_=R=void 0}function Me(){return R===void 0?C:ce(Ih())}function Te(){var _e=Ih(),it=ne(_e);if(m=arguments,_=this,N=_e,it){if(R===void 0)return Y(N);if($)return clearTimeout(R),R=setTimeout(ae,l),G(N)}return R===void 0&&(R=setTimeout(ae,l)),C}return Te.cancel=ve,Te.flush=Me,Te}var WT,Ly,kh,Fy,By=P(()=>{va(),H_(),bn(),WT="Expected a function",Ly=Math.max,kh=Math.min,Fy=W_});function Uy(o,l,h){for(var m=-1,_=o==null?0:o.length;++m<_;)if(h(l,o[m]))return!0;return!1}var zy,$T=P(()=>{zy=Uy});function WN(o){var l=o==null?0:o.length;return l?o[l-1]:void 0}var Vm,w9=P(()=>{Vm=WN});function qT(o,l,h){var m=o==null?0:o.length;if(!m)return-1;var _=h==null?0:_r(h);return _<0&&(_=N5(m+_,0)),Jf(o,x9(l,3),_)}var N5,D5,XT=P(()=>{ep(),k5(),Oi(),N5=Math.max,D5=qT});function $_(o,l,h){var m=o==null?0:o.length;if(!m)return-1;var _=m-1;return h!==void 0&&(_=_r(h),_=h<0?Vy(m+_,0):Gy(_,m-1)),Jf(o,x9(l,3),_,!0)}var Vy,Gy,YT,KT=P(()=>{ep(),k5(),Oi(),Vy=Math.max,Gy=Math.min,YT=$_});function ZT(o,l){var h=-1,m=Dl(o)?Array(o.length):[];return G_(o,function(_,w,C){m[++h]=l(_,w,C)}),m}var E9,q_=P(()=>{b9(),rp(),E9=ZT});function $N(o,l,h){return o>=X_(l,h)&&o<QT(l,h)}var QT,X_,Y_,JT=P(()=>{QT=Math.max,X_=Math.min,Y_=$N});function q0(o,l,h){return l=ar(l),h===void 0?(h=l,l=0):h=ar(h),o=Kt(o),Y_(o,l,h)}var K_,Z_=P(()=>{JT(),Bn(),bn(),K_=q0});function qN(o){return typeof o=="number"&&o==_r(o)}var Q_,O5=P(()=>{Oi(),Q_=qN}),L5,Up,$l=P(()=>{hu(),j_(),L5=HT(function(o,l,h){mi(o,h,l)}),Up=L5});function XN(o,l){var h={};return l=x9(l,3),Ny(o,function(m,_,w){mi(h,_,l(m,_,w))}),h}var Ud,eM=P(()=>{hu(),GT(),k5(),Ud=XN});function tM(o,l,h,m){if(!To(o))return o;l=fm(l,o);for(var _=-1,w=l.length,C=w-1,R=o;R!=null&&++_<w;){var N=Ec(l[_]),F=h;if(N==="__proto__"||N==="constructor"||N==="prototype")return o;if(_!=C){var U=R[N];F=m?m(U,N,R):void 0,F===void 0&&(F=To(U)?U:F0(l[_+1])?[]:{})}B0(R,N,F),R=R[N]}return o}var J_,YN=P(()=>{du(),U2(),kl(),va(),Ep(),J_=tM});function KN(o,l){var h=o.length;for(o.sort(l);h--;)o[h]=o[h].value;return o}var eb,tb=P(()=>{eb=KN});function nM(o,l){if(o!==l){var h=o!==void 0,m=o===null,_=o===o,w=wn(o),C=l!==void 0,R=l===null,N=l===l,F=wn(l);if(!R&&!F&&!w&&o>l||w&&C&&N&&!R&&!F||m&&C&&N||!h&&N||!_)return 1;if(!m&&!w&&!F&&o<l||F&&h&&_&&!m&&!w||R&&h&&_||!C&&_||!N)return-1}return 0}var rM,ZN=P(()=>{tn(),rM=nM});function nb(o,l,h){for(var m=-1,_=o.criteria,w=l.criteria,C=_.length,R=h.length;++m<C;){var N=rM(_[m],w[m]);if(N){if(m>=R)return N;var F=h[m];return N*(F=="desc"?-1:1)}}return o.index-l.index}var rb,QN=P(()=>{ZN(),rb=nb});function JN(o,l,h){l.length?l=kn(l,function(w){return hr(w)?function(C){return V2(C,w.length===1?w[0]:w)}:w}):l=[Dr];var m=-1;l=kn(l,ka(x9));var _=E9(o,function(w,C,R){var N=kn(l,function(F){return F(w)});return{criteria:N,index:++m,value:w}});return eb(_,function(w,C){return rb(w,C,h)})}var b,k=P(()=>{yr(),d0(),k5(),q_(),tb(),Ed(),QN(),jn(),Qi(),b=JN});function z(o,l,h,m){for(var _=h-1,w=o.length;++_<w;)if(m(o[_],l))return _;return-1}var ee,ue=P(()=>{ee=z});function ge(o,l,h,m){var _=m?ee:Bo,w=-1,C=l.length,R=o;for(o===l&&(l=Pl(l)),h&&(R=kn(o,ka(h)));++w<C;)for(var N=0,F=l[w],U=h?h(F):F;(N=_(R,U,N,m))>-1;)R!==o&&Je.call(R,N,1),Je.call(o,N,1);return o}var Le,Je,mt,It=P(()=>{yr(),a2(),ue(),Ed(),Kf(),Le=Array.prototype,Je=Le.splice,mt=ge});function Jt(o,l){return o&&o.length&&l&&l.length?mt(o,l):o}var an,En=P(()=>{It(),an=Jt}),Wn,Gn,Or=P(()=>{bi(),En(),Wn=pr(an),Gn=Wn}),Wr,Mr,Ai=P(()=>{Z4(),Wr=$2("round"),Mr=Wr});function jo(o,l,h){return o==null?o:J_(o,l,h)}var to,po=P(()=>{YN(),to=jo}),Ui,No,za=P(()=>{ty(),k(),bi(),Nv(),Ui=pr(function(o,l){if(o==null)return[];var h=l.length;return h>1&&d2(o,l[0],l[1])?l=[]:h>2&&d2(l[0],l[1],l[2])&&(l=[l[0]]),b(o,vm(l,1),[])}),No=Ui}),X0,Pu,Ru,Nh=P(()=>{Ac(),D1(),Ty(),X0=1/0,Pu=js&&1/Ey(new js([,-0]))[1]==X0?function(o){return new js(o)}:ch,Ru=Pu});function Ic(o,l,h){var m=-1,_=l2,w=o.length,C=!0,R=[],N=R;if(h)C=!1,_=zy;else if(w>=ra){var F=l?null:Ru(o);if(F)return Ey(F);C=!1,_=ss,N=new T_}else N=l?[]:R;e:for(;++m<w;){var U=o[m],$=l?l(U):U;if(U=h||U!==0?U:0,C&&$===$){for(var j=N.length;j--;)if(N[j]===$)continue e;l&&N.push($),R.push(U)}else _(N,$,h)||(N!==R&&N.push($),R.push(U))}return R}var ra,os,Do=P(()=>{uT(),c2(),$T(),$0(),Nh(),Ty(),ra=200,os=Ic});function ts(o){return o&&o.length?os(o):[]}var Ds,zd=P(()=>{Do(),Ds=ts}),m0=P(()=>{Dd(),By(),XT(),Z_(),O5(),q4(),w9(),eM(),hm(),Ai(),zd()}),H7e=te((o,l)=>{var h;l.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:A0):m=>(h||(h=Promise.resolve())).then(m).catch(_=>setTimeout(()=>{throw _},0))}),W7e=te(o=>{var l=Symbol.for("react.element"),h=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),R=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),U=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),j=Symbol.iterator;function G(Ce){return Ce===null||typeof Ce!="object"?null:(Ce=j&&Ce[j]||Ce["@@iterator"],typeof Ce=="function"?Ce:null)}var Y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Z=Object.assign,ne={};function ae(Ce,Ze,Ft){this.props=Ce,this.context=Ze,this.refs=ne,this.updater=Ft||Y}ae.prototype.isReactComponent={},ae.prototype.setState=function(Ce,Ze){if(typeof Ce!="object"&&typeof Ce!="function"&&Ce!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ce,Ze,"setState")},ae.prototype.forceUpdate=function(Ce){this.updater.enqueueForceUpdate(this,Ce,"forceUpdate")};function ce(){}ce.prototype=ae.prototype;function ve(Ce,Ze,Ft){this.props=Ce,this.context=Ze,this.refs=ne,this.updater=Ft||Y}var Me=ve.prototype=new ce;Me.constructor=ve,Z(Me,ae.prototype),Me.isPureReactComponent=!0;var Te=Array.isArray,_e=Object.prototype.hasOwnProperty,it={current:null},Re={key:!0,ref:!0,__self:!0,__source:!0};function xe(Ce,Ze,Ft){var $t,_t={},be=null,dt=null;if(Ze!=null)for($t in Ze.ref!==void 0&&(dt=Ze.ref),Ze.key!==void 0&&(be=""+Ze.key),Ze)_e.call(Ze,$t)&&!Re.hasOwnProperty($t)&&(_t[$t]=Ze[$t]);var bt=arguments.length-2;if(bt===1)_t.children=Ft;else if(1<bt){for(var pn=Array(bt),qn=0;qn<bt;qn++)pn[qn]=arguments[qn+2];_t.children=pn}if(Ce&&Ce.defaultProps)for($t in bt=Ce.defaultProps,bt)_t[$t]===void 0&&(_t[$t]=bt[$t]);return{$$typeof:l,type:Ce,key:be,ref:dt,props:_t,_owner:it.current}}function Oe(Ce,Ze){return{$$typeof:l,type:Ce.type,key:Ze,ref:Ce.ref,props:Ce.props,_owner:Ce._owner}}function He(Ce){return typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===l}function Fe(Ce){var Ze={"=":"=0",":":"=2"};return"$"+Ce.replace(/[=:]/g,function(Ft){return Ze[Ft]})}var Nt=/\/+/g;function Ve(Ce,Ze){return typeof Ce=="object"&&Ce!==null&&Ce.key!=null?Fe(""+Ce.key):Ze.toString(36)}function Ht(Ce,Ze,Ft,$t,_t){var be=typeof Ce;(be==="undefined"||be==="boolean")&&(Ce=null);var dt=!1;if(Ce===null)dt=!0;else switch(be){case"string":case"number":dt=!0;break;case"object":switch(Ce.$$typeof){case l:case h:dt=!0}}if(dt)return dt=Ce,_t=_t(dt),Ce=$t===""?"."+Ve(dt,0):$t,Te(_t)?(Ft="",Ce!=null&&(Ft=Ce.replace(Nt,"$&/")+"/"),Ht(_t,Ze,Ft,"",function(qn){return qn})):_t!=null&&(He(_t)&&(_t=Oe(_t,Ft+(!_t.key||dt&&dt.key===_t.key?"":(""+_t.key).replace(Nt,"$&/")+"/")+Ce)),Ze.push(_t)),1;if(dt=0,$t=$t===""?".":$t+":",Te(Ce))for(var bt=0;bt<Ce.length;bt++){be=Ce[bt];var pn=$t+Ve(be,bt);dt+=Ht(be,Ze,Ft,pn,_t)}else if(pn=G(Ce),typeof pn=="function")for(Ce=pn.call(Ce),bt=0;!(be=Ce.next()).done;)be=be.value,pn=$t+Ve(be,bt++),dt+=Ht(be,Ze,Ft,pn,_t);else if(be==="object")throw Ze=String(Ce),Error("Objects are not valid as a React child (found: "+(Ze==="[object Object]"?"object with keys {"+Object.keys(Ce).join(", ")+"}":Ze)+"). If you meant to render a collection of children, use an array instead.");return dt}function ot(Ce,Ze,Ft){if(Ce==null)return Ce;var $t=[],_t=0;return Ht(Ce,$t,"","",function(be){return Ze.call(Ft,be,_t++)}),$t}function Ye(Ce){if(Ce._status===-1){var Ze=Ce._result;Ze=Ze(),Ze.then(function(Ft){(Ce._status===0||Ce._status===-1)&&(Ce._status=1,Ce._result=Ft)},function(Ft){(Ce._status===0||Ce._status===-1)&&(Ce._status=2,Ce._result=Ft)}),Ce._status===-1&&(Ce._status=0,Ce._result=Ze)}if(Ce._status===1)return Ce._result.default;throw Ce._result}var Ee={current:null},et={transition:null},At={ReactCurrentDispatcher:Ee,ReactCurrentBatchConfig:et,ReactCurrentOwner:it};o.Children={map:ot,forEach:function(Ce,Ze,Ft){ot(Ce,function(){Ze.apply(this,arguments)},Ft)},count:function(Ce){var Ze=0;return ot(Ce,function(){Ze++}),Ze},toArray:function(Ce){return ot(Ce,function(Ze){return Ze})||[]},only:function(Ce){if(!He(Ce))throw Error("React.Children.only expected to receive a single React element child.");return Ce}},o.Component=ae,o.Fragment=m,o.Profiler=w,o.PureComponent=ve,o.StrictMode=_,o.Suspense=F,o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=At,o.cloneElement=function(Ce,Ze,Ft){if(Ce==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Ce+".");var $t=Z({},Ce.props),_t=Ce.key,be=Ce.ref,dt=Ce._owner;if(Ze!=null){if(Ze.ref!==void 0&&(be=Ze.ref,dt=it.current),Ze.key!==void 0&&(_t=""+Ze.key),Ce.type&&Ce.type.defaultProps)var bt=Ce.type.defaultProps;for(pn in Ze)_e.call(Ze,pn)&&!Re.hasOwnProperty(pn)&&($t[pn]=Ze[pn]===void 0&&bt!==void 0?bt[pn]:Ze[pn])}var pn=arguments.length-2;if(pn===1)$t.children=Ft;else if(1<pn){bt=Array(pn);for(var qn=0;qn<pn;qn++)bt[qn]=arguments[qn+2];$t.children=bt}return{$$typeof:l,type:Ce.type,key:_t,ref:be,props:$t,_owner:dt}},o.createContext=function(Ce){return Ce={$$typeof:R,_currentValue:Ce,_currentValue2:Ce,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Ce.Provider={$$typeof:C,_context:Ce},Ce.Consumer=Ce},o.createElement=xe,o.createFactory=function(Ce){var Ze=xe.bind(null,Ce);return Ze.type=Ce,Ze},o.createRef=function(){return{current:null}},o.forwardRef=function(Ce){return{$$typeof:N,render:Ce}},o.isValidElement=He,o.lazy=function(Ce){return{$$typeof:$,_payload:{_status:-1,_result:Ce},_init:Ye}},o.memo=function(Ce,Ze){return{$$typeof:U,type:Ce,compare:Ze===void 0?null:Ze}},o.startTransition=function(Ce){var Ze=et.transition;et.transition={};try{Ce()}finally{et.transition=Ze}},o.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},o.useCallback=function(Ce,Ze){return Ee.current.useCallback(Ce,Ze)},o.useContext=function(Ce){return Ee.current.useContext(Ce)},o.useDebugValue=function(){},o.useDeferredValue=function(Ce){return Ee.current.useDeferredValue(Ce)},o.useEffect=function(Ce,Ze){return Ee.current.useEffect(Ce,Ze)},o.useId=function(){return Ee.current.useId()},o.useImperativeHandle=function(Ce,Ze,Ft){return Ee.current.useImperativeHandle(Ce,Ze,Ft)},o.useInsertionEffect=function(Ce,Ze){return Ee.current.useInsertionEffect(Ce,Ze)},o.useLayoutEffect=function(Ce,Ze){return Ee.current.useLayoutEffect(Ce,Ze)},o.useMemo=function(Ce,Ze){return Ee.current.useMemo(Ce,Ze)},o.useReducer=function(Ce,Ze,Ft){return Ee.current.useReducer(Ce,Ze,Ft)},o.useRef=function(Ce){return Ee.current.useRef(Ce)},o.useState=function(Ce){return Ee.current.useState(Ce)},o.useSyncExternalStore=function(Ce,Ze,Ft){return Ee.current.useSyncExternalStore(Ce,Ze,Ft)},o.useTransition=function(){return Ee.current.useTransition()},o.version="18.2.0"}),$e=te((o,l)=>{l.exports=W7e()}),$7e=te(o=>{function l(Ee,et){var At=Ee.length;Ee.push(et);e:for(;0<At;){var Ce=At-1>>>1,Ze=Ee[Ce];if(0<_(Ze,et))Ee[Ce]=et,Ee[At]=Ze,At=Ce;else break e}}function h(Ee){return Ee.length===0?null:Ee[0]}function m(Ee){if(Ee.length===0)return null;var et=Ee[0],At=Ee.pop();if(At!==et){Ee[0]=At;e:for(var Ce=0,Ze=Ee.length,Ft=Ze>>>1;Ce<Ft;){var $t=2*(Ce+1)-1,_t=Ee[$t],be=$t+1,dt=Ee[be];if(0>_(_t,At))be<Ze&&0>_(dt,_t)?(Ee[Ce]=dt,Ee[be]=At,Ce=be):(Ee[Ce]=_t,Ee[$t]=At,Ce=$t);else if(be<Ze&&0>_(dt,At))Ee[Ce]=dt,Ee[be]=At,Ce=be;else break e}}return et}function _(Ee,et){var At=Ee.sortIndex-et.sortIndex;return At!==0?At:Ee.id-et.id}typeof performance=="object"&&typeof performance.now=="function"?(w=performance,o.unstable_now=function(){return w.now()}):(C=Date,R=C.now(),o.unstable_now=function(){return C.now()-R});var w,C,R,N=[],F=[],U=1,$=null,j=3,G=!1,Y=!1,Z=!1,ne=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,ce=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ve(Ee){for(var et=h(F);et!==null;){if(et.callback===null)m(F);else if(et.startTime<=Ee)m(F),et.sortIndex=et.expirationTime,l(N,et);else break;et=h(F)}}function Me(Ee){if(Z=!1,ve(Ee),!Y)if(h(N)!==null)Y=!0,ot(Te);else{var et=h(F);et!==null&&Ye(Me,et.startTime-Ee)}}function Te(Ee,et){Y=!1,Z&&(Z=!1,ae(Re),Re=-1),G=!0;var At=j;try{for(ve(et),$=h(N);$!==null&&(!($.expirationTime>et)||Ee&&!He());){var Ce=$.callback;if(typeof Ce=="function"){$.callback=null,j=$.priorityLevel;var Ze=Ce($.expirationTime<=et);et=o.unstable_now(),typeof Ze=="function"?$.callback=Ze:$===h(N)&&m(N),ve(et)}else m(N);$=h(N)}if($!==null)var Ft=!0;else{var $t=h(F);$t!==null&&Ye(Me,$t.startTime-et),Ft=!1}return Ft}finally{$=null,j=At,G=!1}}var _e=!1,it=null,Re=-1,xe=5,Oe=-1;function He(){return!(o.unstable_now()-Oe<xe)}function Fe(){if(it!==null){var Ee=o.unstable_now();Oe=Ee;var et=!0;try{et=it(!0,Ee)}finally{et?Nt():(_e=!1,it=null)}}else _e=!1}var Nt;typeof ce=="function"?Nt=function(){ce(Fe)}:typeof MessageChannel<"u"?(Ve=new MessageChannel,Ht=Ve.port2,Ve.port1.onmessage=Fe,Nt=function(){Ht.postMessage(null)}):Nt=function(){ne(Fe,0)};var Ve,Ht;function ot(Ee){it=Ee,_e||(_e=!0,Nt())}function Ye(Ee,et){Re=ne(function(){Ee(o.unstable_now())},et)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Ee){Ee.callback=null},o.unstable_continueExecution=function(){Y||G||(Y=!0,ot(Te))},o.unstable_forceFrameRate=function(Ee){0>Ee||125<Ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xe=0<Ee?Math.floor(1e3/Ee):5},o.unstable_getCurrentPriorityLevel=function(){return j},o.unstable_getFirstCallbackNode=function(){return h(N)},o.unstable_next=function(Ee){switch(j){case 1:case 2:case 3:var et=3;break;default:et=j}var At=j;j=et;try{return Ee()}finally{j=At}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Ee,et){switch(Ee){case 1:case 2:case 3:case 4:case 5:break;default:Ee=3}var At=j;j=Ee;try{return et()}finally{j=At}},o.unstable_scheduleCallback=function(Ee,et,At){var Ce=o.unstable_now();switch(typeof At=="object"&&At!==null?(At=At.delay,At=typeof At=="number"&&0<At?Ce+At:Ce):At=Ce,Ee){case 1:var Ze=-1;break;case 2:Ze=250;break;case 5:Ze=1073741823;break;case 4:Ze=1e4;break;default:Ze=5e3}return Ze=At+Ze,Ee={id:U++,callback:et,priorityLevel:Ee,startTime:At,expirationTime:Ze,sortIndex:-1},At>Ce?(Ee.sortIndex=At,l(F,Ee),h(N)===null&&Ee===h(F)&&(Z?(ae(Re),Re=-1):Z=!0,Ye(Me,At-Ce))):(Ee.sortIndex=Ze,l(N,Ee),Y||G||(Y=!0,ot(Te))),Ee},o.unstable_shouldYield=He,o.unstable_wrapCallback=function(Ee){var et=j;return function(){var At=j;j=et;try{return Ee.apply(this,arguments)}finally{j=At}}}}),q7e=te((o,l)=>{l.exports=$7e()}),X7e=te(o=>{var l=$e(),h=q7e();function m(f){for(var v="https://reactjs.org/docs/error-decoder.html?invariant="+f,T=1;T<arguments.length;T++)v+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+f+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _=new Set,w={};function C(f,v){R(f,v),R(f+"Capture",v)}function R(f,v){for(w[f]=v,f=0;f<v.length;f++)_.add(v[f])}var N=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),F=Object.prototype.hasOwnProperty,U=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$={},j={};function G(f){return F.call(j,f)?!0:F.call($,f)?!1:U.test(f)?j[f]=!0:($[f]=!0,!1)}function Y(f,v,T,O){if(T!==null&&T.type===0)return!1;switch(typeof v){case"function":case"symbol":return!0;case"boolean":return O?!1:T!==null?!T.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function Z(f,v,T,O){if(v===null||typeof v>"u"||Y(f,v,T,O))return!0;if(O)return!1;if(T!==null)switch(T.type){case 3:return!v;case 4:return v===!1;case 5:return isNaN(v);case 6:return isNaN(v)||1>v}return!1}function ne(f,v,T,O,W,J,fe){this.acceptsBooleans=v===2||v===3||v===4,this.attributeName=O,this.attributeNamespace=W,this.mustUseProperty=T,this.propertyName=f,this.type=v,this.sanitizeURL=J,this.removeEmptyString=fe}var ae={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){ae[f]=new ne(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var v=f[0];ae[v]=new ne(v,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){ae[f]=new ne(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){ae[f]=new ne(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){ae[f]=new ne(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){ae[f]=new ne(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){ae[f]=new ne(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){ae[f]=new ne(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){ae[f]=new ne(f,5,!1,f.toLowerCase(),null,!1,!1)});var ce=/[\-:]([a-z])/g;function ve(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var v=f.replace(ce,ve);ae[v]=new ne(v,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var v=f.replace(ce,ve);ae[v]=new ne(v,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var v=f.replace(ce,ve);ae[v]=new ne(v,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){ae[f]=new ne(f,1,!1,f.toLowerCase(),null,!1,!1)}),ae.xlinkHref=new ne("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){ae[f]=new ne(f,1,!1,f.toLowerCase(),null,!0,!0)});function Me(f,v,T,O){var W=ae.hasOwnProperty(v)?ae[v]:null;(W!==null?W.type!==0:O||!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(Z(v,T,W,O)&&(T=null),O||W===null?G(v)&&(T===null?f.removeAttribute(v):f.setAttribute(v,""+T)):W.mustUseProperty?f[W.propertyName]=T===null?W.type===3?!1:"":T:(v=W.attributeName,O=W.attributeNamespace,T===null?f.removeAttribute(v):(W=W.type,T=W===3||W===4&&T===!0?"":""+T,O?f.setAttributeNS(O,v,T):f.setAttribute(v,T))))}var Te=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_e=Symbol.for("react.element"),it=Symbol.for("react.portal"),Re=Symbol.for("react.fragment"),xe=Symbol.for("react.strict_mode"),Oe=Symbol.for("react.profiler"),He=Symbol.for("react.provider"),Fe=Symbol.for("react.context"),Nt=Symbol.for("react.forward_ref"),Ve=Symbol.for("react.suspense"),Ht=Symbol.for("react.suspense_list"),ot=Symbol.for("react.memo"),Ye=Symbol.for("react.lazy"),Ee=Symbol.for("react.offscreen"),et=Symbol.iterator;function At(f){return f===null||typeof f!="object"?null:(f=et&&f[et]||f["@@iterator"],typeof f=="function"?f:null)}var Ce=Object.assign,Ze;function Ft(f){if(Ze===void 0)try{throw Error()}catch(T){var v=T.stack.trim().match(/\n( *(at )?)/);Ze=v&&v[1]||""}return`
`+Ze+f}var $t=!1;function _t(f,v){if(!f||$t)return"";$t=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(v)if(v=function(){throw Error()},Object.defineProperty(v.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(v,[])}catch(Rt){var O=Rt}Reflect.construct(f,[],v)}else{try{v.call()}catch(Rt){O=Rt}f.call(v.prototype)}else{try{throw Error()}catch(Rt){O=Rt}f()}}catch(Rt){if(Rt&&O&&typeof Rt.stack=="string"){for(var W=Rt.stack.split(`
`),J=O.stack.split(`
`),fe=W.length-1,Ne=J.length-1;1<=fe&&0<=Ne&&W[fe]!==J[Ne];)Ne--;for(;1<=fe&&0<=Ne;fe--,Ne--)if(W[fe]!==J[Ne]){if(fe!==1||Ne!==1)do if(fe--,Ne--,0>Ne||W[fe]!==J[Ne]){var qe=`
`+W[fe].replace(" at new "," at ");return f.displayName&&qe.includes("<anonymous>")&&(qe=qe.replace("<anonymous>",f.displayName)),qe}while(1<=fe&&0<=Ne);break}}}finally{$t=!1,Error.prepareStackTrace=T}return(f=f?f.displayName||f.name:"")?Ft(f):""}function be(f){switch(f.tag){case 5:return Ft(f.type);case 16:return Ft("Lazy");case 13:return Ft("Suspense");case 19:return Ft("SuspenseList");case 0:case 2:case 15:return f=_t(f.type,!1),f;case 11:return f=_t(f.type.render,!1),f;case 1:return f=_t(f.type,!0),f;default:return""}}function dt(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case Re:return"Fragment";case it:return"Portal";case Oe:return"Profiler";case xe:return"StrictMode";case Ve:return"Suspense";case Ht:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case Fe:return(f.displayName||"Context")+".Consumer";case He:return(f._context.displayName||"Context")+".Provider";case Nt:var v=f.render;return f=f.displayName,f||(f=v.displayName||v.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case ot:return v=f.displayName||null,v!==null?v:dt(f.type)||"Memo";case Ye:v=f._payload,f=f._init;try{return dt(f(v))}catch{}}return null}function bt(f){var v=f.type;switch(f.tag){case 24:return"Cache";case 9:return(v.displayName||"Context")+".Consumer";case 10:return(v._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=v.render,f=f.displayName||f.name||"",v.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return v;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dt(v);case 8:return v===xe?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v}return null}function pn(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function qn(f){var v=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function sr(f){var v=qn(f)?"checked":"value",T=Object.getOwnPropertyDescriptor(f.constructor.prototype,v),O=""+f[v];if(!f.hasOwnProperty(v)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var W=T.get,J=T.set;return Object.defineProperty(f,v,{configurable:!0,get:function(){return W.call(this)},set:function(fe){O=""+fe,J.call(this,fe)}}),Object.defineProperty(f,v,{enumerable:T.enumerable}),{getValue:function(){return O},setValue:function(fe){O=""+fe},stopTracking:function(){f._valueTracker=null,delete f[v]}}}}function gr(f){f._valueTracker||(f._valueTracker=sr(f))}function oi(f){if(!f)return!1;var v=f._valueTracker;if(!v)return!0;var T=v.getValue(),O="";return f&&(O=qn(f)?f.checked?"true":"false":f.value),f=O,f!==T?(v.setValue(f),!0):!1}function ps(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function zr(f,v){var T=v.checked;return Ce({},v,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??f._wrapperState.initialChecked})}function qs(f,v){var T=v.defaultValue==null?"":v.defaultValue,O=v.checked!=null?v.checked:v.defaultChecked;T=pn(v.value!=null?v.value:T),f._wrapperState={initialChecked:O,initialValue:T,controlled:v.type==="checkbox"||v.type==="radio"?v.checked!=null:v.value!=null}}function ri(f,v){v=v.checked,v!=null&&Me(f,"checked",v,!1)}function di(f,v){ri(f,v);var T=pn(v.value),O=v.type;if(T!=null)O==="number"?(T===0&&f.value===""||f.value!=T)&&(f.value=""+T):f.value!==""+T&&(f.value=""+T);else if(O==="submit"||O==="reset"){f.removeAttribute("value");return}v.hasOwnProperty("value")?vo(f,v.type,T):v.hasOwnProperty("defaultValue")&&vo(f,v.type,pn(v.defaultValue)),v.checked==null&&v.defaultChecked!=null&&(f.defaultChecked=!!v.defaultChecked)}function Wa(f,v,T){if(v.hasOwnProperty("value")||v.hasOwnProperty("defaultValue")){var O=v.type;if(!(O!=="submit"&&O!=="reset"||v.value!==void 0&&v.value!==null))return;v=""+f._wrapperState.initialValue,T||v===f.value||(f.value=v),f.defaultValue=v}T=f.name,T!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,T!==""&&(f.name=T)}function vo(f,v,T){(v!=="number"||ps(f.ownerDocument)!==f)&&(T==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+T&&(f.defaultValue=""+T))}var zh=Array.isArray;function zc(f,v,T,O){if(f=f.options,v){v={};for(var W=0;W<T.length;W++)v["$"+T[W]]=!0;for(T=0;T<f.length;T++)W=v.hasOwnProperty("$"+f[T].value),f[T].selected!==W&&(f[T].selected=W),W&&O&&(f[T].defaultSelected=!0)}else{for(T=""+pn(T),v=null,W=0;W<f.length;W++){if(f[W].value===T){f[W].selected=!0,O&&(f[W].defaultSelected=!0);return}v!==null||f[W].disabled||(v=f[W])}v!==null&&(v.selected=!0)}}function $a(f,v){if(v.dangerouslySetInnerHTML!=null)throw Error(m(91));return Ce({},v,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function Cr(f,v){var T=v.value;if(T==null){if(T=v.children,v=v.defaultValue,T!=null){if(v!=null)throw Error(m(92));if(zh(T)){if(1<T.length)throw Error(m(93));T=T[0]}v=T}v==null&&(v=""),T=v}f._wrapperState={initialValue:pn(T)}}function Zr(f,v){var T=pn(v.value),O=pn(v.defaultValue);T!=null&&(T=""+T,T!==f.value&&(f.value=T),v.defaultValue==null&&f.defaultValue!==T&&(f.defaultValue=T)),O!=null&&(f.defaultValue=""+O)}function cg(f){var v=f.textContent;v===f._wrapperState.initialValue&&v!==""&&v!==null&&(f.value=v)}function $6(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vh(f,v){return f==null||f==="http://www.w3.org/1999/xhtml"?$6(v):f==="http://www.w3.org/2000/svg"&&v==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var sP,gme=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(v,T,O,W){MSApp.execUnsafeLocalFunction(function(){return f(v,T,O,W)})}:f}(function(f,v){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=v;else{for(sP=sP||document.createElement("div"),sP.innerHTML="<svg>"+v.valueOf().toString()+"</svg>",v=sP.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;v.firstChild;)f.appendChild(v.firstChild)}});function wS(f,v){if(v){var T=f.firstChild;if(T&&T===f.lastChild&&T.nodeType===3){T.nodeValue=v;return}}f.textContent=v}var ES={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iAe=["Webkit","ms","Moz","O"];Object.keys(ES).forEach(function(f){iAe.forEach(function(v){v=v+f.charAt(0).toUpperCase()+f.substring(1),ES[v]=ES[f]})});function vme(f,v,T){return v==null||typeof v=="boolean"||v===""?"":T||typeof v!="number"||v===0||ES.hasOwnProperty(f)&&ES[f]?(""+v).trim():v+"px"}function yme(f,v){f=f.style;for(var T in v)if(v.hasOwnProperty(T)){var O=T.indexOf("--")===0,W=vme(T,v[T],O);T==="float"&&(T="cssFloat"),O?f.setProperty(T,W):f[T]=W}}var sAe=Ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _U(f,v){if(v){if(sAe[f]&&(v.children!=null||v.dangerouslySetInnerHTML!=null))throw Error(m(137,f));if(v.dangerouslySetInnerHTML!=null){if(v.children!=null)throw Error(m(60));if(typeof v.dangerouslySetInnerHTML!="object"||!("__html"in v.dangerouslySetInnerHTML))throw Error(m(61))}if(v.style!=null&&typeof v.style!="object")throw Error(m(62))}}function bU(f,v){if(f.indexOf("-")===-1)return typeof v.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var SU=null;function wU(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var EU=null,q6=null,X6=null;function xme(f){if(f=WS(f)){if(typeof EU!="function")throw Error(m(280));var v=f.stateNode;v&&(v=IP(v),EU(f.stateNode,f.type,v))}}function _me(f){q6?X6?X6.push(f):X6=[f]:q6=f}function bme(){if(q6){var f=q6,v=X6;if(X6=q6=null,xme(f),v)for(f=0;f<v.length;f++)xme(v[f])}}function Sme(f,v){return f(v)}function wme(){}var TU=!1;function Eme(f,v,T){if(TU)return f(v,T);TU=!0;try{return Sme(f,v,T)}finally{TU=!1,(q6!==null||X6!==null)&&(wme(),bme())}}function TS(f,v){var T=f.stateNode;if(T===null)return null;var O=IP(T);if(O===null)return null;T=O[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(f=f.type,O=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!O;break e;default:f=!1}if(f)return null;if(T&&typeof T!="function")throw Error(m(231,v,typeof T));return T}var MU=!1;if(N)try{Y6={},Object.defineProperty(Y6,"passive",{get:function(){MU=!0}}),window.addEventListener("test",Y6,Y6),window.removeEventListener("test",Y6,Y6)}catch{MU=!1}var Y6;function oAe(f,v,T,O,W,J,fe,Ne,qe){var Rt=Array.prototype.slice.call(arguments,3);try{v.apply(T,Rt)}catch(un){this.onError(un)}}var MS=!1,oP=null,aP=!1,CU=null,aAe={onError:function(f){MS=!0,oP=f}};function lAe(f,v,T,O,W,J,fe,Ne,qe){MS=!1,oP=null,oAe.apply(aAe,arguments)}function cAe(f,v,T,O,W,J,fe,Ne,qe){if(lAe.apply(this,arguments),MS){if(MS){var Rt=oP;MS=!1,oP=null}else throw Error(m(198));aP||(aP=!0,CU=Rt)}}function T8(f){var v=f,T=f;if(f.alternate)for(;v.return;)v=v.return;else{f=v;do v=f,v.flags&4098&&(T=v.return),f=v.return;while(f)}return v.tag===3?T:null}function Tme(f){if(f.tag===13){var v=f.memoizedState;if(v===null&&(f=f.alternate,f!==null&&(v=f.memoizedState)),v!==null)return v.dehydrated}return null}function Mme(f){if(T8(f)!==f)throw Error(m(188))}function uAe(f){var v=f.alternate;if(!v){if(v=T8(f),v===null)throw Error(m(188));return v!==f?null:f}for(var T=f,O=v;;){var W=T.return;if(W===null)break;var J=W.alternate;if(J===null){if(O=W.return,O!==null){T=O;continue}break}if(W.child===J.child){for(J=W.child;J;){if(J===T)return Mme(W),f;if(J===O)return Mme(W),v;J=J.sibling}throw Error(m(188))}if(T.return!==O.return)T=W,O=J;else{for(var fe=!1,Ne=W.child;Ne;){if(Ne===T){fe=!0,T=W,O=J;break}if(Ne===O){fe=!0,O=W,T=J;break}Ne=Ne.sibling}if(!fe){for(Ne=J.child;Ne;){if(Ne===T){fe=!0,T=J,O=W;break}if(Ne===O){fe=!0,O=J,T=W;break}Ne=Ne.sibling}if(!fe)throw Error(m(189))}}if(T.alternate!==O)throw Error(m(190))}if(T.tag!==3)throw Error(m(188));return T.stateNode.current===T?f:v}function Cme(f){return f=uAe(f),f!==null?Ame(f):null}function Ame(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var v=Ame(f);if(v!==null)return v;f=f.sibling}return null}var Pme=h.unstable_scheduleCallback,Rme=h.unstable_cancelCallback,hAe=h.unstable_shouldYield,dAe=h.unstable_requestPaint,$o=h.unstable_now,fAe=h.unstable_getCurrentPriorityLevel,AU=h.unstable_ImmediatePriority,Ime=h.unstable_UserBlockingPriority,lP=h.unstable_NormalPriority,pAe=h.unstable_LowPriority,kme=h.unstable_IdlePriority,cP=null,r1=null;function mAe(f){if(r1&&typeof r1.onCommitFiberRoot=="function")try{r1.onCommitFiberRoot(cP,f,void 0,(f.current.flags&128)===128)}catch{}}var hf=Math.clz32?Math.clz32:yAe,gAe=Math.log,vAe=Math.LN2;function yAe(f){return f>>>=0,f===0?32:31-(gAe(f)/vAe|0)|0}var uP=64,hP=4194304;function CS(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function dP(f,v){var T=f.pendingLanes;if(T===0)return 0;var O=0,W=f.suspendedLanes,J=f.pingedLanes,fe=T&268435455;if(fe!==0){var Ne=fe&~W;Ne!==0?O=CS(Ne):(J&=fe,J!==0&&(O=CS(J)))}else fe=T&~W,fe!==0?O=CS(fe):J!==0&&(O=CS(J));if(O===0)return 0;if(v!==0&&v!==O&&!(v&W)&&(W=O&-O,J=v&-v,W>=J||W===16&&(J&4194240)!==0))return v;if(O&4&&(O|=T&16),v=f.entangledLanes,v!==0)for(f=f.entanglements,v&=O;0<v;)T=31-hf(v),W=1<<T,O|=f[T],v&=~W;return O}function xAe(f,v){switch(f){case 1:case 2:case 4:return v+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _Ae(f,v){for(var T=f.suspendedLanes,O=f.pingedLanes,W=f.expirationTimes,J=f.pendingLanes;0<J;){var fe=31-hf(J),Ne=1<<fe,qe=W[fe];qe===-1?(!(Ne&T)||Ne&O)&&(W[fe]=xAe(Ne,v)):qe<=v&&(f.expiredLanes|=Ne),J&=~Ne}}function PU(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Nme(){var f=uP;return uP<<=1,!(uP&4194240)&&(uP=64),f}function RU(f){for(var v=[],T=0;31>T;T++)v.push(f);return v}function AS(f,v,T){f.pendingLanes|=v,v!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,v=31-hf(v),f[v]=T}function bAe(f,v){var T=f.pendingLanes&~v;f.pendingLanes=v,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=v,f.mutableReadLanes&=v,f.entangledLanes&=v,v=f.entanglements;var O=f.eventTimes;for(f=f.expirationTimes;0<T;){var W=31-hf(T),J=1<<W;v[W]=0,O[W]=-1,f[W]=-1,T&=~J}}function IU(f,v){var T=f.entangledLanes|=v;for(f=f.entanglements;T;){var O=31-hf(T),W=1<<O;W&v|f[O]&v&&(f[O]|=v),T&=~W}}var ms=0;function Dme(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var Ome,kU,Lme,Fme,Bme,NU=!1,fP=[],X9=null,Y9=null,K9=null,PS=new Map,RS=new Map,Z9=[],SAe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ume(f,v){switch(f){case"focusin":case"focusout":X9=null;break;case"dragenter":case"dragleave":Y9=null;break;case"mouseover":case"mouseout":K9=null;break;case"pointerover":case"pointerout":PS.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":RS.delete(v.pointerId)}}function IS(f,v,T,O,W,J){return f===null||f.nativeEvent!==J?(f={blockedOn:v,domEventName:T,eventSystemFlags:O,nativeEvent:J,targetContainers:[W]},v!==null&&(v=WS(v),v!==null&&kU(v)),f):(f.eventSystemFlags|=O,v=f.targetContainers,W!==null&&v.indexOf(W)===-1&&v.push(W),f)}function wAe(f,v,T,O,W){switch(v){case"focusin":return X9=IS(X9,f,v,T,O,W),!0;case"dragenter":return Y9=IS(Y9,f,v,T,O,W),!0;case"mouseover":return K9=IS(K9,f,v,T,O,W),!0;case"pointerover":var J=W.pointerId;return PS.set(J,IS(PS.get(J)||null,f,v,T,O,W)),!0;case"gotpointercapture":return J=W.pointerId,RS.set(J,IS(RS.get(J)||null,f,v,T,O,W)),!0}return!1}function zme(f){var v=M8(f.target);if(v!==null){var T=T8(v);if(T!==null){if(v=T.tag,v===13){if(v=Tme(T),v!==null){f.blockedOn=v,Bme(f.priority,function(){Lme(T)});return}}else if(v===3&&T.stateNode.current.memoizedState.isDehydrated){f.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}f.blockedOn=null}function pP(f){if(f.blockedOn!==null)return!1;for(var v=f.targetContainers;0<v.length;){var T=OU(f.domEventName,f.eventSystemFlags,v[0],f.nativeEvent);if(T===null){T=f.nativeEvent;var O=new T.constructor(T.type,T);SU=O,T.target.dispatchEvent(O),SU=null}else return v=WS(T),v!==null&&kU(v),f.blockedOn=T,!1;v.shift()}return!0}function Vme(f,v,T){pP(f)&&T.delete(v)}function EAe(){NU=!1,X9!==null&&pP(X9)&&(X9=null),Y9!==null&&pP(Y9)&&(Y9=null),K9!==null&&pP(K9)&&(K9=null),PS.forEach(Vme),RS.forEach(Vme)}function kS(f,v){f.blockedOn===v&&(f.blockedOn=null,NU||(NU=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,EAe)))}function NS(f){function v(W){return kS(W,f)}if(0<fP.length){kS(fP[0],f);for(var T=1;T<fP.length;T++){var O=fP[T];O.blockedOn===f&&(O.blockedOn=null)}}for(X9!==null&&kS(X9,f),Y9!==null&&kS(Y9,f),K9!==null&&kS(K9,f),PS.forEach(v),RS.forEach(v),T=0;T<Z9.length;T++)O=Z9[T],O.blockedOn===f&&(O.blockedOn=null);for(;0<Z9.length&&(T=Z9[0],T.blockedOn===null);)zme(T),T.blockedOn===null&&Z9.shift()}var K6=Te.ReactCurrentBatchConfig,mP=!0;function TAe(f,v,T,O){var W=ms,J=K6.transition;K6.transition=null;try{ms=1,DU(f,v,T,O)}finally{ms=W,K6.transition=J}}function MAe(f,v,T,O){var W=ms,J=K6.transition;K6.transition=null;try{ms=4,DU(f,v,T,O)}finally{ms=W,K6.transition=J}}function DU(f,v,T,O){if(mP){var W=OU(f,v,T,O);if(W===null)KU(f,v,O,gP,T),Ume(f,O);else if(wAe(W,f,v,T,O))O.stopPropagation();else if(Ume(f,O),v&4&&-1<SAe.indexOf(f)){for(;W!==null;){var J=WS(W);if(J!==null&&Ome(J),J=OU(f,v,T,O),J===null&&KU(f,v,O,gP,T),J===W)break;W=J}W!==null&&O.stopPropagation()}else KU(f,v,O,null,T)}}var gP=null;function OU(f,v,T,O){if(gP=null,f=wU(O),f=M8(f),f!==null)if(v=T8(f),v===null)f=null;else if(T=v.tag,T===13){if(f=Tme(v),f!==null)return f;f=null}else if(T===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;f=null}else v!==f&&(f=null);return gP=f,null}function Gme(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fAe()){case AU:return 1;case Ime:return 4;case lP:case pAe:return 16;case kme:return 536870912;default:return 16}default:return 16}}var Q9=null,LU=null,vP=null;function jme(){if(vP)return vP;var f,v=LU,T=v.length,O,W="value"in Q9?Q9.value:Q9.textContent,J=W.length;for(f=0;f<T&&v[f]===W[f];f++);var fe=T-f;for(O=1;O<=fe&&v[T-O]===W[J-O];O++);return vP=W.slice(f,1<O?1-O:void 0)}function yP(f){var v=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&v===13&&(f=13)):f=v,f===10&&(f=13),32<=f||f===13?f:0}function xP(){return!0}function Hme(){return!1}function Fu(f){function v(T,O,W,J,fe){this._reactName=T,this._targetInst=W,this.type=O,this.nativeEvent=J,this.target=fe,this.currentTarget=null;for(var Ne in f)f.hasOwnProperty(Ne)&&(T=f[Ne],this[Ne]=T?T(J):J[Ne]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?xP:Hme,this.isPropagationStopped=Hme,this}return Ce(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=xP)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=xP)},persist:function(){},isPersistent:xP}),v}var Z6={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},FU=Fu(Z6),DS=Ce({},Z6,{view:0,detail:0}),CAe=Fu(DS),BU,UU,OS,_P=Ce({},DS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:VU,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==OS&&(OS&&f.type==="mousemove"?(BU=f.screenX-OS.screenX,UU=f.screenY-OS.screenY):UU=BU=0,OS=f),BU)},movementY:function(f){return"movementY"in f?f.movementY:UU}}),Wme=Fu(_P),AAe=Ce({},_P,{dataTransfer:0}),PAe=Fu(AAe),RAe=Ce({},DS,{relatedTarget:0}),zU=Fu(RAe),IAe=Ce({},Z6,{animationName:0,elapsedTime:0,pseudoElement:0}),kAe=Fu(IAe),NAe=Ce({},Z6,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),DAe=Fu(NAe),OAe=Ce({},Z6,{data:0}),$me=Fu(OAe),LAe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FAe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BAe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UAe(f){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(f):(f=BAe[f])?!!v[f]:!1}function VU(){return UAe}var zAe=Ce({},DS,{key:function(f){if(f.key){var v=LAe[f.key]||f.key;if(v!=="Unidentified")return v}return f.type==="keypress"?(f=yP(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?FAe[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:VU,charCode:function(f){return f.type==="keypress"?yP(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?yP(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),VAe=Fu(zAe),GAe=Ce({},_P,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qme=Fu(GAe),jAe=Ce({},DS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:VU}),HAe=Fu(jAe),WAe=Ce({},Z6,{propertyName:0,elapsedTime:0,pseudoElement:0}),$Ae=Fu(WAe),qAe=Ce({},_P,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),XAe=Fu(qAe),YAe=[9,13,27,32],GU=N&&"CompositionEvent"in window,LS=null;N&&"documentMode"in document&&(LS=document.documentMode);var KAe=N&&"TextEvent"in window&&!LS,Xme=N&&(!GU||LS&&8<LS&&11>=LS),Yme=" ",Kme=!1;function Zme(f,v){switch(f){case"keyup":return YAe.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qme(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Q6=!1;function ZAe(f,v){switch(f){case"compositionend":return Qme(v);case"keypress":return v.which!==32?null:(Kme=!0,Yme);case"textInput":return f=v.data,f===Yme&&Kme?null:f;default:return null}}function QAe(f,v){if(Q6)return f==="compositionend"||!GU&&Zme(f,v)?(f=jme(),vP=LU=Q9=null,Q6=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return Xme&&v.locale!=="ko"?null:v.data;default:return null}}var JAe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jme(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v==="input"?!!JAe[f.type]:v==="textarea"}function ege(f,v,T,O){_me(O),v=AP(v,"onChange"),0<v.length&&(T=new FU("onChange","change",null,T,O),f.push({event:T,listeners:v}))}var FS=null,BS=null;function ePe(f){xge(f,0)}function bP(f){var v=r7(f);if(oi(v))return f}function tPe(f,v){if(f==="change")return v}var tge=!1;N&&(N?(SP="oninput"in document,SP||(HU=document.createElement("div"),HU.setAttribute("oninput","return;"),SP=typeof HU.oninput=="function"),jU=SP):jU=!1,tge=jU&&(!document.documentMode||9<document.documentMode));var jU,SP,HU;function nge(){FS&&(FS.detachEvent("onpropertychange",rge),BS=FS=null)}function rge(f){if(f.propertyName==="value"&&bP(BS)){var v=[];ege(v,BS,f,wU(f)),Eme(ePe,v)}}function nPe(f,v,T){f==="focusin"?(nge(),FS=v,BS=T,FS.attachEvent("onpropertychange",rge)):f==="focusout"&&nge()}function rPe(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return bP(BS)}function iPe(f,v){if(f==="click")return bP(v)}function sPe(f,v){if(f==="input"||f==="change")return bP(v)}function oPe(f,v){return f===v&&(f!==0||1/f===1/v)||f!==f&&v!==v}var df=typeof Object.is=="function"?Object.is:oPe;function US(f,v){if(df(f,v))return!0;if(typeof f!="object"||f===null||typeof v!="object"||v===null)return!1;var T=Object.keys(f),O=Object.keys(v);if(T.length!==O.length)return!1;for(O=0;O<T.length;O++){var W=T[O];if(!F.call(v,W)||!df(f[W],v[W]))return!1}return!0}function ige(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function sge(f,v){var T=ige(f);f=0;for(var O;T;){if(T.nodeType===3){if(O=f+T.textContent.length,f<=v&&O>=v)return{node:T,offset:v-f};f=O}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=ige(T)}}function oge(f,v){return f&&v?f===v?!0:f&&f.nodeType===3?!1:v&&v.nodeType===3?oge(f,v.parentNode):"contains"in f?f.contains(v):f.compareDocumentPosition?!!(f.compareDocumentPosition(v)&16):!1:!1}function age(){for(var f=window,v=ps();v instanceof f.HTMLIFrameElement;){try{var T=typeof v.contentWindow.location.href=="string"}catch{T=!1}if(T)f=v.contentWindow;else break;v=ps(f.document)}return v}function WU(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v&&(v==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||v==="textarea"||f.contentEditable==="true")}function aPe(f){var v=age(),T=f.focusedElem,O=f.selectionRange;if(v!==T&&T&&T.ownerDocument&&oge(T.ownerDocument.documentElement,T)){if(O!==null&&WU(T)){if(v=O.start,f=O.end,f===void 0&&(f=v),"selectionStart"in T)T.selectionStart=v,T.selectionEnd=Math.min(f,T.value.length);else if(f=(v=T.ownerDocument||document)&&v.defaultView||window,f.getSelection){f=f.getSelection();var W=T.textContent.length,J=Math.min(O.start,W);O=O.end===void 0?J:Math.min(O.end,W),!f.extend&&J>O&&(W=O,O=J,J=W),W=sge(T,J);var fe=sge(T,O);W&&fe&&(f.rangeCount!==1||f.anchorNode!==W.node||f.anchorOffset!==W.offset||f.focusNode!==fe.node||f.focusOffset!==fe.offset)&&(v=v.createRange(),v.setStart(W.node,W.offset),f.removeAllRanges(),J>O?(f.addRange(v),f.extend(fe.node,fe.offset)):(v.setEnd(fe.node,fe.offset),f.addRange(v)))}}for(v=[],f=T;f=f.parentNode;)f.nodeType===1&&v.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<v.length;T++)f=v[T],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var lPe=N&&"documentMode"in document&&11>=document.documentMode,J6=null,$U=null,zS=null,qU=!1;function lge(f,v,T){var O=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;qU||J6==null||J6!==ps(O)||(O=J6,"selectionStart"in O&&WU(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),zS&&US(zS,O)||(zS=O,O=AP($U,"onSelect"),0<O.length&&(v=new FU("onSelect","select",null,v,T),f.push({event:v,listeners:O}),v.target=J6)))}function wP(f,v){var T={};return T[f.toLowerCase()]=v.toLowerCase(),T["Webkit"+f]="webkit"+v,T["Moz"+f]="moz"+v,T}var e7={animationend:wP("Animation","AnimationEnd"),animationiteration:wP("Animation","AnimationIteration"),animationstart:wP("Animation","AnimationStart"),transitionend:wP("Transition","TransitionEnd")},XU={},cge={};N&&(cge=document.createElement("div").style,"AnimationEvent"in window||(delete e7.animationend.animation,delete e7.animationiteration.animation,delete e7.animationstart.animation),"TransitionEvent"in window||delete e7.transitionend.transition);function EP(f){if(XU[f])return XU[f];if(!e7[f])return f;var v=e7[f],T;for(T in v)if(v.hasOwnProperty(T)&&T in cge)return XU[f]=v[T];return f}var uge=EP("animationend"),hge=EP("animationiteration"),dge=EP("animationstart"),fge=EP("transitionend"),pge=new Map,mge="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function J9(f,v){pge.set(f,v),C(v,[f])}for(MP=0;MP<mge.length;MP++)TP=mge[MP],gge=TP.toLowerCase(),vge=TP[0].toUpperCase()+TP.slice(1),J9(gge,"on"+vge);var TP,gge,vge,MP;J9(uge,"onAnimationEnd"),J9(hge,"onAnimationIteration"),J9(dge,"onAnimationStart"),J9("dblclick","onDoubleClick"),J9("focusin","onFocus"),J9("focusout","onBlur"),J9(fge,"onTransitionEnd"),R("onMouseEnter",["mouseout","mouseover"]),R("onMouseLeave",["mouseout","mouseover"]),R("onPointerEnter",["pointerout","pointerover"]),R("onPointerLeave",["pointerout","pointerover"]),C("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),C("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),C("onBeforeInput",["compositionend","keypress","textInput","paste"]),C("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),C("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),C("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var VS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cPe=new Set("cancel close invalid load scroll toggle".split(" ").concat(VS));function yge(f,v,T){var O=f.type||"unknown-event";f.currentTarget=T,cAe(O,v,void 0,f),f.currentTarget=null}function xge(f,v){v=(v&4)!==0;for(var T=0;T<f.length;T++){var O=f[T],W=O.event;O=O.listeners;e:{var J=void 0;if(v)for(var fe=O.length-1;0<=fe;fe--){var Ne=O[fe],qe=Ne.instance,Rt=Ne.currentTarget;if(Ne=Ne.listener,qe!==J&&W.isPropagationStopped())break e;yge(W,Ne,Rt),J=qe}else for(fe=0;fe<O.length;fe++){if(Ne=O[fe],qe=Ne.instance,Rt=Ne.currentTarget,Ne=Ne.listener,qe!==J&&W.isPropagationStopped())break e;yge(W,Ne,Rt),J=qe}}}if(aP)throw f=CU,aP=!1,CU=null,f}function Xs(f,v){var T=v[nz];T===void 0&&(T=v[nz]=new Set);var O=f+"__bubble";T.has(O)||(_ge(v,f,2,!1),T.add(O))}function YU(f,v,T){var O=0;v&&(O|=4),_ge(T,f,O,v)}var CP="_reactListening"+Math.random().toString(36).slice(2);function GS(f){if(!f[CP]){f[CP]=!0,_.forEach(function(T){T!=="selectionchange"&&(cPe.has(T)||YU(T,!1,f),YU(T,!0,f))});var v=f.nodeType===9?f:f.ownerDocument;v===null||v[CP]||(v[CP]=!0,YU("selectionchange",!1,v))}}function _ge(f,v,T,O){switch(Gme(v)){case 1:var W=TAe;break;case 4:W=MAe;break;default:W=DU}T=W.bind(null,v,T,f),W=void 0,!MU||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(W=!0),O?W!==void 0?f.addEventListener(v,T,{capture:!0,passive:W}):f.addEventListener(v,T,!0):W!==void 0?f.addEventListener(v,T,{passive:W}):f.addEventListener(v,T,!1)}function KU(f,v,T,O,W){var J=O;if(!(v&1)&&!(v&2)&&O!==null)e:for(;;){if(O===null)return;var fe=O.tag;if(fe===3||fe===4){var Ne=O.stateNode.containerInfo;if(Ne===W||Ne.nodeType===8&&Ne.parentNode===W)break;if(fe===4)for(fe=O.return;fe!==null;){var qe=fe.tag;if((qe===3||qe===4)&&(qe=fe.stateNode.containerInfo,qe===W||qe.nodeType===8&&qe.parentNode===W))return;fe=fe.return}for(;Ne!==null;){if(fe=M8(Ne),fe===null)return;if(qe=fe.tag,qe===5||qe===6){O=J=fe;continue e}Ne=Ne.parentNode}}O=O.return}Eme(function(){var Rt=J,un=wU(T),dn=[];e:{var ln=pge.get(f);if(ln!==void 0){var Vn=FU,nr=f;switch(f){case"keypress":if(yP(T)===0)break e;case"keydown":case"keyup":Vn=VAe;break;case"focusin":nr="focus",Vn=zU;break;case"focusout":nr="blur",Vn=zU;break;case"beforeblur":case"afterblur":Vn=zU;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Vn=Wme;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Vn=PAe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Vn=HAe;break;case uge:case hge:case dge:Vn=kAe;break;case fge:Vn=$Ae;break;case"scroll":Vn=CAe;break;case"wheel":Vn=XAe;break;case"copy":case"cut":case"paste":Vn=DAe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Vn=qme}var ir=(v&4)!==0,qo=!ir&&f==="scroll",xt=ir?ln!==null?ln+"Capture":null:ln;ir=[];for(var nt=Rt,Et;nt!==null;){Et=nt;var gn=Et.stateNode;if(Et.tag===5&&gn!==null&&(Et=gn,xt!==null&&(gn=TS(nt,xt),gn!=null&&ir.push(jS(nt,gn,Et)))),qo)break;nt=nt.return}0<ir.length&&(ln=new Vn(ln,nr,null,T,un),dn.push({event:ln,listeners:ir}))}}if(!(v&7)){e:{if(ln=f==="mouseover"||f==="pointerover",Vn=f==="mouseout"||f==="pointerout",ln&&T!==SU&&(nr=T.relatedTarget||T.fromElement)&&(M8(nr)||nr[ug]))break e;if((Vn||ln)&&(ln=un.window===un?un:(ln=un.ownerDocument)?ln.defaultView||ln.parentWindow:window,Vn?(nr=T.relatedTarget||T.toElement,Vn=Rt,nr=nr?M8(nr):null,nr!==null&&(qo=T8(nr),nr!==qo||nr.tag!==5&&nr.tag!==6)&&(nr=null)):(Vn=null,nr=Rt),Vn!==nr)){if(ir=Wme,gn="onMouseLeave",xt="onMouseEnter",nt="mouse",(f==="pointerout"||f==="pointerover")&&(ir=qme,gn="onPointerLeave",xt="onPointerEnter",nt="pointer"),qo=Vn==null?ln:r7(Vn),Et=nr==null?ln:r7(nr),ln=new ir(gn,nt+"leave",Vn,T,un),ln.target=qo,ln.relatedTarget=Et,gn=null,M8(un)===Rt&&(ir=new ir(xt,nt+"enter",nr,T,un),ir.target=Et,ir.relatedTarget=qo,gn=ir),qo=gn,Vn&&nr)t:{for(ir=Vn,xt=nr,nt=0,Et=ir;Et;Et=t7(Et))nt++;for(Et=0,gn=xt;gn;gn=t7(gn))Et++;for(;0<nt-Et;)ir=t7(ir),nt--;for(;0<Et-nt;)xt=t7(xt),Et--;for(;nt--;){if(ir===xt||xt!==null&&ir===xt.alternate)break t;ir=t7(ir),xt=t7(xt)}ir=null}else ir=null;Vn!==null&&bge(dn,ln,Vn,ir,!1),nr!==null&&qo!==null&&bge(dn,qo,nr,ir,!0)}}e:{if(ln=Rt?r7(Rt):window,Vn=ln.nodeName&&ln.nodeName.toLowerCase(),Vn==="select"||Vn==="input"&&ln.type==="file")var cr=tPe;else if(Jme(ln))if(tge)cr=sPe;else{cr=rPe;var Sr=nPe}else(Vn=ln.nodeName)&&Vn.toLowerCase()==="input"&&(ln.type==="checkbox"||ln.type==="radio")&&(cr=iPe);if(cr&&(cr=cr(f,Rt))){ege(dn,cr,T,un);break e}Sr&&Sr(f,ln,Rt),f==="focusout"&&(Sr=ln._wrapperState)&&Sr.controlled&&ln.type==="number"&&vo(ln,"number",ln.value)}switch(Sr=Rt?r7(Rt):window,f){case"focusin":(Jme(Sr)||Sr.contentEditable==="true")&&(J6=Sr,$U=Rt,zS=null);break;case"focusout":zS=$U=J6=null;break;case"mousedown":qU=!0;break;case"contextmenu":case"mouseup":case"dragend":qU=!1,lge(dn,T,un);break;case"selectionchange":if(lPe)break;case"keydown":case"keyup":lge(dn,T,un)}var wr;if(GU)e:{switch(f){case"compositionstart":var Lr="onCompositionStart";break e;case"compositionend":Lr="onCompositionEnd";break e;case"compositionupdate":Lr="onCompositionUpdate";break e}Lr=void 0}else Q6?Zme(f,T)&&(Lr="onCompositionEnd"):f==="keydown"&&T.keyCode===229&&(Lr="onCompositionStart");Lr&&(Xme&&T.locale!=="ko"&&(Q6||Lr!=="onCompositionStart"?Lr==="onCompositionEnd"&&Q6&&(wr=jme()):(Q9=un,LU="value"in Q9?Q9.value:Q9.textContent,Q6=!0)),Sr=AP(Rt,Lr),0<Sr.length&&(Lr=new $me(Lr,f,null,T,un),dn.push({event:Lr,listeners:Sr}),wr?Lr.data=wr:(wr=Qme(T),wr!==null&&(Lr.data=wr)))),(wr=KAe?ZAe(f,T):QAe(f,T))&&(Rt=AP(Rt,"onBeforeInput"),0<Rt.length&&(un=new $me("onBeforeInput","beforeinput",null,T,un),dn.push({event:un,listeners:Rt}),un.data=wr))}xge(dn,v)})}function jS(f,v,T){return{instance:f,listener:v,currentTarget:T}}function AP(f,v){for(var T=v+"Capture",O=[];f!==null;){var W=f,J=W.stateNode;W.tag===5&&J!==null&&(W=J,J=TS(f,T),J!=null&&O.unshift(jS(f,J,W)),J=TS(f,v),J!=null&&O.push(jS(f,J,W))),f=f.return}return O}function t7(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function bge(f,v,T,O,W){for(var J=v._reactName,fe=[];T!==null&&T!==O;){var Ne=T,qe=Ne.alternate,Rt=Ne.stateNode;if(qe!==null&&qe===O)break;Ne.tag===5&&Rt!==null&&(Ne=Rt,W?(qe=TS(T,J),qe!=null&&fe.unshift(jS(T,qe,Ne))):W||(qe=TS(T,J),qe!=null&&fe.push(jS(T,qe,Ne)))),T=T.return}fe.length!==0&&f.push({event:v,listeners:fe})}var uPe=/\r\n?/g,hPe=/\u0000|\uFFFD/g;function Sge(f){return(typeof f=="string"?f:""+f).replace(uPe,`
`).replace(hPe,"")}function PP(f,v,T){if(v=Sge(v),Sge(f)!==v&&T)throw Error(m(425))}function RP(){}var ZU=null,QU=null;function JU(f,v){return f==="textarea"||f==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var ez=typeof setTimeout=="function"?setTimeout:void 0,dPe=typeof clearTimeout=="function"?clearTimeout:void 0,wge=typeof Promise=="function"?Promise:void 0,fPe=typeof queueMicrotask=="function"?queueMicrotask:typeof wge<"u"?function(f){return wge.resolve(null).then(f).catch(pPe)}:ez;function pPe(f){setTimeout(function(){throw f})}function tz(f,v){var T=v,O=0;do{var W=T.nextSibling;if(f.removeChild(T),W&&W.nodeType===8)if(T=W.data,T==="/$"){if(O===0){f.removeChild(W),NS(v);return}O--}else T!=="$"&&T!=="$?"&&T!=="$!"||O++;T=W}while(T);NS(v)}function e3(f){for(;f!=null;f=f.nextSibling){var v=f.nodeType;if(v===1||v===3)break;if(v===8){if(v=f.data,v==="$"||v==="$!"||v==="$?")break;if(v==="/$")return null}}return f}function Ege(f){f=f.previousSibling;for(var v=0;f;){if(f.nodeType===8){var T=f.data;if(T==="$"||T==="$!"||T==="$?"){if(v===0)return f;v--}else T==="/$"&&v++}f=f.previousSibling}return null}var n7=Math.random().toString(36).slice(2),i1="__reactFiber$"+n7,HS="__reactProps$"+n7,ug="__reactContainer$"+n7,nz="__reactEvents$"+n7,mPe="__reactListeners$"+n7,gPe="__reactHandles$"+n7;function M8(f){var v=f[i1];if(v)return v;for(var T=f.parentNode;T;){if(v=T[ug]||T[i1]){if(T=v.alternate,v.child!==null||T!==null&&T.child!==null)for(f=Ege(f);f!==null;){if(T=f[i1])return T;f=Ege(f)}return v}f=T,T=f.parentNode}return null}function WS(f){return f=f[i1]||f[ug],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function r7(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(m(33))}function IP(f){return f[HS]||null}var rz=[],i7=-1;function t3(f){return{current:f}}function Ys(f){0>i7||(f.current=rz[i7],rz[i7]=null,i7--)}function Fs(f,v){i7++,rz[i7]=f.current,f.current=v}var n3={},sl=t3(n3),Vc=t3(!1),C8=n3;function s7(f,v){var T=f.type.contextTypes;if(!T)return n3;var O=f.stateNode;if(O&&O.__reactInternalMemoizedUnmaskedChildContext===v)return O.__reactInternalMemoizedMaskedChildContext;var W={},J;for(J in T)W[J]=v[J];return O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=v,f.__reactInternalMemoizedMaskedChildContext=W),W}function Gc(f){return f=f.childContextTypes,f!=null}function kP(){Ys(Vc),Ys(sl)}function Tge(f,v,T){if(sl.current!==n3)throw Error(m(168));Fs(sl,v),Fs(Vc,T)}function Mge(f,v,T){var O=f.stateNode;if(v=v.childContextTypes,typeof O.getChildContext!="function")return T;O=O.getChildContext();for(var W in O)if(!(W in v))throw Error(m(108,bt(f)||"Unknown",W));return Ce({},T,O)}function NP(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||n3,C8=sl.current,Fs(sl,f),Fs(Vc,Vc.current),!0}function Cge(f,v,T){var O=f.stateNode;if(!O)throw Error(m(169));T?(f=Mge(f,v,C8),O.__reactInternalMemoizedMergedChildContext=f,Ys(Vc),Ys(sl),Fs(sl,f)):Ys(Vc),Fs(Vc,T)}var hg=null,DP=!1,iz=!1;function Age(f){hg===null?hg=[f]:hg.push(f)}function vPe(f){DP=!0,Age(f)}function r3(){if(!iz&&hg!==null){iz=!0;var f=0,v=ms;try{var T=hg;for(ms=1;f<T.length;f++){var O=T[f];do O=O(!0);while(O!==null)}hg=null,DP=!1}catch(W){throw hg!==null&&(hg=hg.slice(f+1)),Pme(AU,r3),W}finally{ms=v,iz=!1}}return null}var o7=[],a7=0,OP=null,LP=0,Gh=[],jh=0,A8=null,dg=1,fg="";function P8(f,v){o7[a7++]=LP,o7[a7++]=OP,OP=f,LP=v}function Pge(f,v,T){Gh[jh++]=dg,Gh[jh++]=fg,Gh[jh++]=A8,A8=f;var O=dg;f=fg;var W=32-hf(O)-1;O&=~(1<<W),T+=1;var J=32-hf(v)+W;if(30<J){var fe=W-W%5;J=(O&(1<<fe)-1).toString(32),O>>=fe,W-=fe,dg=1<<32-hf(v)+W|T<<W|O,fg=J+f}else dg=1<<J|T<<W|O,fg=f}function sz(f){f.return!==null&&(P8(f,1),Pge(f,1,0))}function oz(f){for(;f===OP;)OP=o7[--a7],o7[a7]=null,LP=o7[--a7],o7[a7]=null;for(;f===A8;)A8=Gh[--jh],Gh[jh]=null,fg=Gh[--jh],Gh[jh]=null,dg=Gh[--jh],Gh[jh]=null}var Bu=null,Uu=null,io=!1,ff=null;function Rge(f,v){var T=qh(5,null,null,0);T.elementType="DELETED",T.stateNode=v,T.return=f,v=f.deletions,v===null?(f.deletions=[T],f.flags|=16):v.push(T)}function Ige(f,v){switch(f.tag){case 5:var T=f.type;return v=v.nodeType!==1||T.toLowerCase()!==v.nodeName.toLowerCase()?null:v,v!==null?(f.stateNode=v,Bu=f,Uu=e3(v.firstChild),!0):!1;case 6:return v=f.pendingProps===""||v.nodeType!==3?null:v,v!==null?(f.stateNode=v,Bu=f,Uu=null,!0):!1;case 13:return v=v.nodeType!==8?null:v,v!==null?(T=A8!==null?{id:dg,overflow:fg}:null,f.memoizedState={dehydrated:v,treeContext:T,retryLane:1073741824},T=qh(18,null,null,0),T.stateNode=v,T.return=f,f.child=T,Bu=f,Uu=null,!0):!1;default:return!1}}function az(f){return(f.mode&1)!==0&&(f.flags&128)===0}function lz(f){if(io){var v=Uu;if(v){var T=v;if(!Ige(f,v)){if(az(f))throw Error(m(418));v=e3(T.nextSibling);var O=Bu;v&&Ige(f,v)?Rge(O,T):(f.flags=f.flags&-4097|2,io=!1,Bu=f)}}else{if(az(f))throw Error(m(418));f.flags=f.flags&-4097|2,io=!1,Bu=f}}}function kge(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Bu=f}function FP(f){if(f!==Bu)return!1;if(!io)return kge(f),io=!0,!1;var v;if((v=f.tag!==3)&&!(v=f.tag!==5)&&(v=f.type,v=v!=="head"&&v!=="body"&&!JU(f.type,f.memoizedProps)),v&&(v=Uu)){if(az(f))throw Nge(),Error(m(418));for(;v;)Rge(f,v),v=e3(v.nextSibling)}if(kge(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(m(317));e:{for(f=f.nextSibling,v=0;f;){if(f.nodeType===8){var T=f.data;if(T==="/$"){if(v===0){Uu=e3(f.nextSibling);break e}v--}else T!=="$"&&T!=="$!"&&T!=="$?"||v++}f=f.nextSibling}Uu=null}}else Uu=Bu?e3(f.stateNode.nextSibling):null;return!0}function Nge(){for(var f=Uu;f;)f=e3(f.nextSibling)}function l7(){Uu=Bu=null,io=!1}function cz(f){ff===null?ff=[f]:ff.push(f)}var yPe=Te.ReactCurrentBatchConfig;function pf(f,v){if(f&&f.defaultProps){v=Ce({},v),f=f.defaultProps;for(var T in f)v[T]===void 0&&(v[T]=f[T]);return v}return v}var BP=t3(null),UP=null,c7=null,uz=null;function hz(){uz=c7=UP=null}function dz(f){var v=BP.current;Ys(BP),f._currentValue=v}function fz(f,v,T){for(;f!==null;){var O=f.alternate;if((f.childLanes&v)!==v?(f.childLanes|=v,O!==null&&(O.childLanes|=v)):O!==null&&(O.childLanes&v)!==v&&(O.childLanes|=v),f===T)break;f=f.return}}function u7(f,v){UP=f,uz=c7=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&v&&(jc=!0),f.firstContext=null)}function Hh(f){var v=f._currentValue;if(uz!==f)if(f={context:f,memoizedValue:v,next:null},c7===null){if(UP===null)throw Error(m(308));c7=f,UP.dependencies={lanes:0,firstContext:f}}else c7=c7.next=f;return v}var R8=null;function pz(f){R8===null?R8=[f]:R8.push(f)}function Dge(f,v,T,O){var W=v.interleaved;return W===null?(T.next=T,pz(v)):(T.next=W.next,W.next=T),v.interleaved=T,pg(f,O)}function pg(f,v){f.lanes|=v;var T=f.alternate;for(T!==null&&(T.lanes|=v),T=f,f=f.return;f!==null;)f.childLanes|=v,T=f.alternate,T!==null&&(T.childLanes|=v),T=f,f=f.return;return T.tag===3?T.stateNode:null}var i3=!1;function mz(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oge(f,v){f=f.updateQueue,v.updateQueue===f&&(v.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function mg(f,v){return{eventTime:f,lane:v,tag:0,payload:null,callback:null,next:null}}function s3(f,v,T){var O=f.updateQueue;if(O===null)return null;if(O=O.shared,Vi&2){var W=O.pending;return W===null?v.next=v:(v.next=W.next,W.next=v),O.pending=v,pg(f,T)}return W=O.interleaved,W===null?(v.next=v,pz(O)):(v.next=W.next,W.next=v),O.interleaved=v,pg(f,T)}function zP(f,v,T){if(v=v.updateQueue,v!==null&&(v=v.shared,(T&4194240)!==0)){var O=v.lanes;O&=f.pendingLanes,T|=O,v.lanes=T,IU(f,T)}}function Lge(f,v){var T=f.updateQueue,O=f.alternate;if(O!==null&&(O=O.updateQueue,T===O)){var W=null,J=null;if(T=T.firstBaseUpdate,T!==null){do{var fe={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};J===null?W=J=fe:J=J.next=fe,T=T.next}while(T!==null);J===null?W=J=v:J=J.next=v}else W=J=v;T={baseState:O.baseState,firstBaseUpdate:W,lastBaseUpdate:J,shared:O.shared,effects:O.effects},f.updateQueue=T;return}f=T.lastBaseUpdate,f===null?T.firstBaseUpdate=v:f.next=v,T.lastBaseUpdate=v}function VP(f,v,T,O){var W=f.updateQueue;i3=!1;var J=W.firstBaseUpdate,fe=W.lastBaseUpdate,Ne=W.shared.pending;if(Ne!==null){W.shared.pending=null;var qe=Ne,Rt=qe.next;qe.next=null,fe===null?J=Rt:fe.next=Rt,fe=qe;var un=f.alternate;un!==null&&(un=un.updateQueue,Ne=un.lastBaseUpdate,Ne!==fe&&(Ne===null?un.firstBaseUpdate=Rt:Ne.next=Rt,un.lastBaseUpdate=qe))}if(J!==null){var dn=W.baseState;fe=0,un=Rt=qe=null,Ne=J;do{var ln=Ne.lane,Vn=Ne.eventTime;if((O&ln)===ln){un!==null&&(un=un.next={eventTime:Vn,lane:0,tag:Ne.tag,payload:Ne.payload,callback:Ne.callback,next:null});e:{var nr=f,ir=Ne;switch(ln=v,Vn=T,ir.tag){case 1:if(nr=ir.payload,typeof nr=="function"){dn=nr.call(Vn,dn,ln);break e}dn=nr;break e;case 3:nr.flags=nr.flags&-65537|128;case 0:if(nr=ir.payload,ln=typeof nr=="function"?nr.call(Vn,dn,ln):nr,ln==null)break e;dn=Ce({},dn,ln);break e;case 2:i3=!0}}Ne.callback!==null&&Ne.lane!==0&&(f.flags|=64,ln=W.effects,ln===null?W.effects=[Ne]:ln.push(Ne))}else Vn={eventTime:Vn,lane:ln,tag:Ne.tag,payload:Ne.payload,callback:Ne.callback,next:null},un===null?(Rt=un=Vn,qe=dn):un=un.next=Vn,fe|=ln;if(Ne=Ne.next,Ne===null){if(Ne=W.shared.pending,Ne===null)break;ln=Ne,Ne=ln.next,ln.next=null,W.lastBaseUpdate=ln,W.shared.pending=null}}while(!0);if(un===null&&(qe=dn),W.baseState=qe,W.firstBaseUpdate=Rt,W.lastBaseUpdate=un,v=W.shared.interleaved,v!==null){W=v;do fe|=W.lane,W=W.next;while(W!==v)}else J===null&&(W.shared.lanes=0);N8|=fe,f.lanes=fe,f.memoizedState=dn}}function Fge(f,v,T){if(f=v.effects,v.effects=null,f!==null)for(v=0;v<f.length;v++){var O=f[v],W=O.callback;if(W!==null){if(O.callback=null,O=T,typeof W!="function")throw Error(m(191,W));W.call(O)}}}var Bge=new l.Component().refs;function gz(f,v,T,O){v=f.memoizedState,T=T(O,v),T=T==null?v:Ce({},v,T),f.memoizedState=T,f.lanes===0&&(f.updateQueue.baseState=T)}var GP={isMounted:function(f){return(f=f._reactInternals)?T8(f)===f:!1},enqueueSetState:function(f,v,T){f=f._reactInternals;var O=Jl(),W=c3(f),J=mg(O,W);J.payload=v,T!=null&&(J.callback=T),v=s3(f,J,W),v!==null&&(vf(v,f,W,O),zP(v,f,W))},enqueueReplaceState:function(f,v,T){f=f._reactInternals;var O=Jl(),W=c3(f),J=mg(O,W);J.tag=1,J.payload=v,T!=null&&(J.callback=T),v=s3(f,J,W),v!==null&&(vf(v,f,W,O),zP(v,f,W))},enqueueForceUpdate:function(f,v){f=f._reactInternals;var T=Jl(),O=c3(f),W=mg(T,O);W.tag=2,v!=null&&(W.callback=v),v=s3(f,W,O),v!==null&&(vf(v,f,O,T),zP(v,f,O))}};function Uge(f,v,T,O,W,J,fe){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(O,J,fe):v.prototype&&v.prototype.isPureReactComponent?!US(T,O)||!US(W,J):!0}function zge(f,v,T){var O=!1,W=n3,J=v.contextType;return typeof J=="object"&&J!==null?J=Hh(J):(W=Gc(v)?C8:sl.current,O=v.contextTypes,J=(O=O!=null)?s7(f,W):n3),v=new v(T,J),f.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=GP,f.stateNode=v,v._reactInternals=f,O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=W,f.__reactInternalMemoizedMaskedChildContext=J),v}function Vge(f,v,T,O){f=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(T,O),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(T,O),v.state!==f&&GP.enqueueReplaceState(v,v.state,null)}function vz(f,v,T,O){var W=f.stateNode;W.props=T,W.state=f.memoizedState,W.refs=Bge,mz(f);var J=v.contextType;typeof J=="object"&&J!==null?W.context=Hh(J):(J=Gc(v)?C8:sl.current,W.context=s7(f,J)),W.state=f.memoizedState,J=v.getDerivedStateFromProps,typeof J=="function"&&(gz(f,v,J,T),W.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof W.getSnapshotBeforeUpdate=="function"||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(v=W.state,typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount(),v!==W.state&&GP.enqueueReplaceState(W,W.state,null),VP(f,T,W,O),W.state=f.memoizedState),typeof W.componentDidMount=="function"&&(f.flags|=4194308)}function $S(f,v,T){if(f=T.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(m(309));var O=T.stateNode}if(!O)throw Error(m(147,f));var W=O,J=""+f;return v!==null&&v.ref!==null&&typeof v.ref=="function"&&v.ref._stringRef===J?v.ref:(v=function(fe){var Ne=W.refs;Ne===Bge&&(Ne=W.refs={}),fe===null?delete Ne[J]:Ne[J]=fe},v._stringRef=J,v)}if(typeof f!="string")throw Error(m(284));if(!T._owner)throw Error(m(290,f))}return f}function jP(f,v){throw f=Object.prototype.toString.call(v),Error(m(31,f==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":f))}function Gge(f){var v=f._init;return v(f._payload)}function jge(f){function v(xt,nt){if(f){var Et=xt.deletions;Et===null?(xt.deletions=[nt],xt.flags|=16):Et.push(nt)}}function T(xt,nt){if(!f)return null;for(;nt!==null;)v(xt,nt),nt=nt.sibling;return null}function O(xt,nt){for(xt=new Map;nt!==null;)nt.key!==null?xt.set(nt.key,nt):xt.set(nt.index,nt),nt=nt.sibling;return xt}function W(xt,nt){return xt=h3(xt,nt),xt.index=0,xt.sibling=null,xt}function J(xt,nt,Et){return xt.index=Et,f?(Et=xt.alternate,Et!==null?(Et=Et.index,Et<nt?(xt.flags|=2,nt):Et):(xt.flags|=2,nt)):(xt.flags|=1048576,nt)}function fe(xt){return f&&xt.alternate===null&&(xt.flags|=2),xt}function Ne(xt,nt,Et,gn){return nt===null||nt.tag!==6?(nt=Jz(Et,xt.mode,gn),nt.return=xt,nt):(nt=W(nt,Et),nt.return=xt,nt)}function qe(xt,nt,Et,gn){var cr=Et.type;return cr===Re?un(xt,nt,Et.props.children,gn,Et.key):nt!==null&&(nt.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Ye&&Gge(cr)===nt.type)?(gn=W(nt,Et.props),gn.ref=$S(xt,nt,Et),gn.return=xt,gn):(gn=lR(Et.type,Et.key,Et.props,null,xt.mode,gn),gn.ref=$S(xt,nt,Et),gn.return=xt,gn)}function Rt(xt,nt,Et,gn){return nt===null||nt.tag!==4||nt.stateNode.containerInfo!==Et.containerInfo||nt.stateNode.implementation!==Et.implementation?(nt=eV(Et,xt.mode,gn),nt.return=xt,nt):(nt=W(nt,Et.children||[]),nt.return=xt,nt)}function un(xt,nt,Et,gn,cr){return nt===null||nt.tag!==7?(nt=F8(Et,xt.mode,gn,cr),nt.return=xt,nt):(nt=W(nt,Et),nt.return=xt,nt)}function dn(xt,nt,Et){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return nt=Jz(""+nt,xt.mode,Et),nt.return=xt,nt;if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case _e:return Et=lR(nt.type,nt.key,nt.props,null,xt.mode,Et),Et.ref=$S(xt,null,nt),Et.return=xt,Et;case it:return nt=eV(nt,xt.mode,Et),nt.return=xt,nt;case Ye:var gn=nt._init;return dn(xt,gn(nt._payload),Et)}if(zh(nt)||At(nt))return nt=F8(nt,xt.mode,Et,null),nt.return=xt,nt;jP(xt,nt)}return null}function ln(xt,nt,Et,gn){var cr=nt!==null?nt.key:null;if(typeof Et=="string"&&Et!==""||typeof Et=="number")return cr!==null?null:Ne(xt,nt,""+Et,gn);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case _e:return Et.key===cr?qe(xt,nt,Et,gn):null;case it:return Et.key===cr?Rt(xt,nt,Et,gn):null;case Ye:return cr=Et._init,ln(xt,nt,cr(Et._payload),gn)}if(zh(Et)||At(Et))return cr!==null?null:un(xt,nt,Et,gn,null);jP(xt,Et)}return null}function Vn(xt,nt,Et,gn,cr){if(typeof gn=="string"&&gn!==""||typeof gn=="number")return xt=xt.get(Et)||null,Ne(nt,xt,""+gn,cr);if(typeof gn=="object"&&gn!==null){switch(gn.$$typeof){case _e:return xt=xt.get(gn.key===null?Et:gn.key)||null,qe(nt,xt,gn,cr);case it:return xt=xt.get(gn.key===null?Et:gn.key)||null,Rt(nt,xt,gn,cr);case Ye:var Sr=gn._init;return Vn(xt,nt,Et,Sr(gn._payload),cr)}if(zh(gn)||At(gn))return xt=xt.get(Et)||null,un(nt,xt,gn,cr,null);jP(nt,gn)}return null}function nr(xt,nt,Et,gn){for(var cr=null,Sr=null,wr=nt,Lr=nt=0,Ya=null;wr!==null&&Lr<Et.length;Lr++){wr.index>Lr?(Ya=wr,wr=null):Ya=wr.sibling;var qi=ln(xt,wr,Et[Lr],gn);if(qi===null){wr===null&&(wr=Ya);break}f&&wr&&qi.alternate===null&&v(xt,wr),nt=J(qi,nt,Lr),Sr===null?cr=qi:Sr.sibling=qi,Sr=qi,wr=Ya}if(Lr===Et.length)return T(xt,wr),io&&P8(xt,Lr),cr;if(wr===null){for(;Lr<Et.length;Lr++)wr=dn(xt,Et[Lr],gn),wr!==null&&(nt=J(wr,nt,Lr),Sr===null?cr=wr:Sr.sibling=wr,Sr=wr);return io&&P8(xt,Lr),cr}for(wr=O(xt,wr);Lr<Et.length;Lr++)Ya=Vn(wr,xt,Lr,Et[Lr],gn),Ya!==null&&(f&&Ya.alternate!==null&&wr.delete(Ya.key===null?Lr:Ya.key),nt=J(Ya,nt,Lr),Sr===null?cr=Ya:Sr.sibling=Ya,Sr=Ya);return f&&wr.forEach(function(d3){return v(xt,d3)}),io&&P8(xt,Lr),cr}function ir(xt,nt,Et,gn){var cr=At(Et);if(typeof cr!="function")throw Error(m(150));if(Et=cr.call(Et),Et==null)throw Error(m(151));for(var Sr=cr=null,wr=nt,Lr=nt=0,Ya=null,qi=Et.next();wr!==null&&!qi.done;Lr++,qi=Et.next()){wr.index>Lr?(Ya=wr,wr=null):Ya=wr.sibling;var d3=ln(xt,wr,qi.value,gn);if(d3===null){wr===null&&(wr=Ya);break}f&&wr&&d3.alternate===null&&v(xt,wr),nt=J(d3,nt,Lr),Sr===null?cr=d3:Sr.sibling=d3,Sr=d3,wr=Ya}if(qi.done)return T(xt,wr),io&&P8(xt,Lr),cr;if(wr===null){for(;!qi.done;Lr++,qi=Et.next())qi=dn(xt,qi.value,gn),qi!==null&&(nt=J(qi,nt,Lr),Sr===null?cr=qi:Sr.sibling=qi,Sr=qi);return io&&P8(xt,Lr),cr}for(wr=O(xt,wr);!qi.done;Lr++,qi=Et.next())qi=Vn(wr,xt,Lr,qi.value,gn),qi!==null&&(f&&qi.alternate!==null&&wr.delete(qi.key===null?Lr:qi.key),nt=J(qi,nt,Lr),Sr===null?cr=qi:Sr.sibling=qi,Sr=qi);return f&&wr.forEach(function(ZPe){return v(xt,ZPe)}),io&&P8(xt,Lr),cr}function qo(xt,nt,Et,gn){if(typeof Et=="object"&&Et!==null&&Et.type===Re&&Et.key===null&&(Et=Et.props.children),typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case _e:e:{for(var cr=Et.key,Sr=nt;Sr!==null;){if(Sr.key===cr){if(cr=Et.type,cr===Re){if(Sr.tag===7){T(xt,Sr.sibling),nt=W(Sr,Et.props.children),nt.return=xt,xt=nt;break e}}else if(Sr.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Ye&&Gge(cr)===Sr.type){T(xt,Sr.sibling),nt=W(Sr,Et.props),nt.ref=$S(xt,Sr,Et),nt.return=xt,xt=nt;break e}T(xt,Sr);break}else v(xt,Sr);Sr=Sr.sibling}Et.type===Re?(nt=F8(Et.props.children,xt.mode,gn,Et.key),nt.return=xt,xt=nt):(gn=lR(Et.type,Et.key,Et.props,null,xt.mode,gn),gn.ref=$S(xt,nt,Et),gn.return=xt,xt=gn)}return fe(xt);case it:e:{for(Sr=Et.key;nt!==null;){if(nt.key===Sr)if(nt.tag===4&&nt.stateNode.containerInfo===Et.containerInfo&&nt.stateNode.implementation===Et.implementation){T(xt,nt.sibling),nt=W(nt,Et.children||[]),nt.return=xt,xt=nt;break e}else{T(xt,nt);break}else v(xt,nt);nt=nt.sibling}nt=eV(Et,xt.mode,gn),nt.return=xt,xt=nt}return fe(xt);case Ye:return Sr=Et._init,qo(xt,nt,Sr(Et._payload),gn)}if(zh(Et))return nr(xt,nt,Et,gn);if(At(Et))return ir(xt,nt,Et,gn);jP(xt,Et)}return typeof Et=="string"&&Et!==""||typeof Et=="number"?(Et=""+Et,nt!==null&&nt.tag===6?(T(xt,nt.sibling),nt=W(nt,Et),nt.return=xt,xt=nt):(T(xt,nt),nt=Jz(Et,xt.mode,gn),nt.return=xt,xt=nt),fe(xt)):T(xt,nt)}return qo}var h7=jge(!0),Hge=jge(!1),qS={},s1=t3(qS),XS=t3(qS),YS=t3(qS);function I8(f){if(f===qS)throw Error(m(174));return f}function yz(f,v){switch(Fs(YS,v),Fs(XS,f),Fs(s1,qS),f=v.nodeType,f){case 9:case 11:v=(v=v.documentElement)?v.namespaceURI:Vh(null,"");break;default:f=f===8?v.parentNode:v,v=f.namespaceURI||null,f=f.tagName,v=Vh(v,f)}Ys(s1),Fs(s1,v)}function d7(){Ys(s1),Ys(XS),Ys(YS)}function Wge(f){I8(YS.current);var v=I8(s1.current),T=Vh(v,f.type);v!==T&&(Fs(XS,f),Fs(s1,T))}function xz(f){XS.current===f&&(Ys(s1),Ys(XS))}var yo=t3(0);function HP(f){for(var v=f;v!==null;){if(v.tag===13){var T=v.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if(v.flags&128)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}var _z=[];function bz(){for(var f=0;f<_z.length;f++)_z[f]._workInProgressVersionPrimary=null;_z.length=0}var WP=Te.ReactCurrentDispatcher,Sz=Te.ReactCurrentBatchConfig,k8=0,xo=null,Sa=null,qa=null,$P=!1,KS=!1,ZS=0,xPe=0;function ol(){throw Error(m(321))}function wz(f,v){if(v===null)return!1;for(var T=0;T<v.length&&T<f.length;T++)if(!df(f[T],v[T]))return!1;return!0}function Ez(f,v,T,O,W,J){if(k8=J,xo=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,WP.current=f===null||f.memoizedState===null?wPe:EPe,f=T(O,W),KS){J=0;do{if(KS=!1,ZS=0,25<=J)throw Error(m(301));J+=1,qa=Sa=null,v.updateQueue=null,WP.current=TPe,f=T(O,W)}while(KS)}if(WP.current=YP,v=Sa!==null&&Sa.next!==null,k8=0,qa=Sa=xo=null,$P=!1,v)throw Error(m(300));return f}function Tz(){var f=ZS!==0;return ZS=0,f}function o1(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qa===null?xo.memoizedState=qa=f:qa=qa.next=f,qa}function Wh(){if(Sa===null){var f=xo.alternate;f=f!==null?f.memoizedState:null}else f=Sa.next;var v=qa===null?xo.memoizedState:qa.next;if(v!==null)qa=v,Sa=f;else{if(f===null)throw Error(m(310));Sa=f,f={memoizedState:Sa.memoizedState,baseState:Sa.baseState,baseQueue:Sa.baseQueue,queue:Sa.queue,next:null},qa===null?xo.memoizedState=qa=f:qa=qa.next=f}return qa}function QS(f,v){return typeof v=="function"?v(f):v}function Mz(f){var v=Wh(),T=v.queue;if(T===null)throw Error(m(311));T.lastRenderedReducer=f;var O=Sa,W=O.baseQueue,J=T.pending;if(J!==null){if(W!==null){var fe=W.next;W.next=J.next,J.next=fe}O.baseQueue=W=J,T.pending=null}if(W!==null){J=W.next,O=O.baseState;var Ne=fe=null,qe=null,Rt=J;do{var un=Rt.lane;if((k8&un)===un)qe!==null&&(qe=qe.next={lane:0,action:Rt.action,hasEagerState:Rt.hasEagerState,eagerState:Rt.eagerState,next:null}),O=Rt.hasEagerState?Rt.eagerState:f(O,Rt.action);else{var dn={lane:un,action:Rt.action,hasEagerState:Rt.hasEagerState,eagerState:Rt.eagerState,next:null};qe===null?(Ne=qe=dn,fe=O):qe=qe.next=dn,xo.lanes|=un,N8|=un}Rt=Rt.next}while(Rt!==null&&Rt!==J);qe===null?fe=O:qe.next=Ne,df(O,v.memoizedState)||(jc=!0),v.memoizedState=O,v.baseState=fe,v.baseQueue=qe,T.lastRenderedState=O}if(f=T.interleaved,f!==null){W=f;do J=W.lane,xo.lanes|=J,N8|=J,W=W.next;while(W!==f)}else W===null&&(T.lanes=0);return[v.memoizedState,T.dispatch]}function Cz(f){var v=Wh(),T=v.queue;if(T===null)throw Error(m(311));T.lastRenderedReducer=f;var O=T.dispatch,W=T.pending,J=v.memoizedState;if(W!==null){T.pending=null;var fe=W=W.next;do J=f(J,fe.action),fe=fe.next;while(fe!==W);df(J,v.memoizedState)||(jc=!0),v.memoizedState=J,v.baseQueue===null&&(v.baseState=J),T.lastRenderedState=J}return[J,O]}function $ge(){}function qge(f,v){var T=xo,O=Wh(),W=v(),J=!df(O.memoizedState,W);if(J&&(O.memoizedState=W,jc=!0),O=O.queue,Az(Kge.bind(null,T,O,f),[f]),O.getSnapshot!==v||J||qa!==null&&qa.memoizedState.tag&1){if(T.flags|=2048,JS(9,Yge.bind(null,T,O,W,v),void 0,null),Xa===null)throw Error(m(349));k8&30||Xge(T,v,W)}return W}function Xge(f,v,T){f.flags|=16384,f={getSnapshot:v,value:T},v=xo.updateQueue,v===null?(v={lastEffect:null,stores:null},xo.updateQueue=v,v.stores=[f]):(T=v.stores,T===null?v.stores=[f]:T.push(f))}function Yge(f,v,T,O){v.value=T,v.getSnapshot=O,Zge(v)&&Qge(f)}function Kge(f,v,T){return T(function(){Zge(v)&&Qge(f)})}function Zge(f){var v=f.getSnapshot;f=f.value;try{var T=v();return!df(f,T)}catch{return!0}}function Qge(f){var v=pg(f,1);v!==null&&vf(v,f,1,-1)}function Jge(f){var v=o1();return typeof f=="function"&&(f=f()),v.memoizedState=v.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:QS,lastRenderedState:f},v.queue=f,f=f.dispatch=SPe.bind(null,xo,f),[v.memoizedState,f]}function JS(f,v,T,O){return f={tag:f,create:v,destroy:T,deps:O,next:null},v=xo.updateQueue,v===null?(v={lastEffect:null,stores:null},xo.updateQueue=v,v.lastEffect=f.next=f):(T=v.lastEffect,T===null?v.lastEffect=f.next=f:(O=T.next,T.next=f,f.next=O,v.lastEffect=f)),f}function e2e(){return Wh().memoizedState}function qP(f,v,T,O){var W=o1();xo.flags|=f,W.memoizedState=JS(1|v,T,void 0,O===void 0?null:O)}function XP(f,v,T,O){var W=Wh();O=O===void 0?null:O;var J=void 0;if(Sa!==null){var fe=Sa.memoizedState;if(J=fe.destroy,O!==null&&wz(O,fe.deps)){W.memoizedState=JS(v,T,J,O);return}}xo.flags|=f,W.memoizedState=JS(1|v,T,J,O)}function t2e(f,v){return qP(8390656,8,f,v)}function Az(f,v){return XP(2048,8,f,v)}function n2e(f,v){return XP(4,2,f,v)}function r2e(f,v){return XP(4,4,f,v)}function i2e(f,v){if(typeof v=="function")return f=f(),v(f),function(){v(null)};if(v!=null)return f=f(),v.current=f,function(){v.current=null}}function s2e(f,v,T){return T=T!=null?T.concat([f]):null,XP(4,4,i2e.bind(null,v,f),T)}function Pz(){}function o2e(f,v){var T=Wh();v=v===void 0?null:v;var O=T.memoizedState;return O!==null&&v!==null&&wz(v,O[1])?O[0]:(T.memoizedState=[f,v],f)}function a2e(f,v){var T=Wh();v=v===void 0?null:v;var O=T.memoizedState;return O!==null&&v!==null&&wz(v,O[1])?O[0]:(f=f(),T.memoizedState=[f,v],f)}function l2e(f,v,T){return k8&21?(df(T,v)||(T=Nme(),xo.lanes|=T,N8|=T,f.baseState=!0),v):(f.baseState&&(f.baseState=!1,jc=!0),f.memoizedState=T)}function _Pe(f,v){var T=ms;ms=T!==0&&4>T?T:4,f(!0);var O=Sz.transition;Sz.transition={};try{f(!1),v()}finally{ms=T,Sz.transition=O}}function c2e(){return Wh().memoizedState}function bPe(f,v,T){var O=c3(f);if(T={lane:O,action:T,hasEagerState:!1,eagerState:null,next:null},u2e(f))h2e(v,T);else if(T=Dge(f,v,T,O),T!==null){var W=Jl();vf(T,f,O,W),d2e(T,v,O)}}function SPe(f,v,T){var O=c3(f),W={lane:O,action:T,hasEagerState:!1,eagerState:null,next:null};if(u2e(f))h2e(v,W);else{var J=f.alternate;if(f.lanes===0&&(J===null||J.lanes===0)&&(J=v.lastRenderedReducer,J!==null))try{var fe=v.lastRenderedState,Ne=J(fe,T);if(W.hasEagerState=!0,W.eagerState=Ne,df(Ne,fe)){var qe=v.interleaved;qe===null?(W.next=W,pz(v)):(W.next=qe.next,qe.next=W),v.interleaved=W;return}}catch{}finally{}T=Dge(f,v,W,O),T!==null&&(W=Jl(),vf(T,f,O,W),d2e(T,v,O))}}function u2e(f){var v=f.alternate;return f===xo||v!==null&&v===xo}function h2e(f,v){KS=$P=!0;var T=f.pending;T===null?v.next=v:(v.next=T.next,T.next=v),f.pending=v}function d2e(f,v,T){if(T&4194240){var O=v.lanes;O&=f.pendingLanes,T|=O,v.lanes=T,IU(f,T)}}var YP={readContext:Hh,useCallback:ol,useContext:ol,useEffect:ol,useImperativeHandle:ol,useInsertionEffect:ol,useLayoutEffect:ol,useMemo:ol,useReducer:ol,useRef:ol,useState:ol,useDebugValue:ol,useDeferredValue:ol,useTransition:ol,useMutableSource:ol,useSyncExternalStore:ol,useId:ol,unstable_isNewReconciler:!1},wPe={readContext:Hh,useCallback:function(f,v){return o1().memoizedState=[f,v===void 0?null:v],f},useContext:Hh,useEffect:t2e,useImperativeHandle:function(f,v,T){return T=T!=null?T.concat([f]):null,qP(4194308,4,i2e.bind(null,v,f),T)},useLayoutEffect:function(f,v){return qP(4194308,4,f,v)},useInsertionEffect:function(f,v){return qP(4,2,f,v)},useMemo:function(f,v){var T=o1();return v=v===void 0?null:v,f=f(),T.memoizedState=[f,v],f},useReducer:function(f,v,T){var O=o1();return v=T!==void 0?T(v):v,O.memoizedState=O.baseState=v,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:v},O.queue=f,f=f.dispatch=bPe.bind(null,xo,f),[O.memoizedState,f]},useRef:function(f){var v=o1();return f={current:f},v.memoizedState=f},useState:Jge,useDebugValue:Pz,useDeferredValue:function(f){return o1().memoizedState=f},useTransition:function(){var f=Jge(!1),v=f[0];return f=_Pe.bind(null,f[1]),o1().memoizedState=f,[v,f]},useMutableSource:function(){},useSyncExternalStore:function(f,v,T){var O=xo,W=o1();if(io){if(T===void 0)throw Error(m(407));T=T()}else{if(T=v(),Xa===null)throw Error(m(349));k8&30||Xge(O,v,T)}W.memoizedState=T;var J={value:T,getSnapshot:v};return W.queue=J,t2e(Kge.bind(null,O,J,f),[f]),O.flags|=2048,JS(9,Yge.bind(null,O,J,T,v),void 0,null),T},useId:function(){var f=o1(),v=Xa.identifierPrefix;if(io){var T=fg,O=dg;T=(O&~(1<<32-hf(O)-1)).toString(32)+T,v=":"+v+"R"+T,T=ZS++,0<T&&(v+="H"+T.toString(32)),v+=":"}else T=xPe++,v=":"+v+"r"+T.toString(32)+":";return f.memoizedState=v},unstable_isNewReconciler:!1},EPe={readContext:Hh,useCallback:o2e,useContext:Hh,useEffect:Az,useImperativeHandle:s2e,useInsertionEffect:n2e,useLayoutEffect:r2e,useMemo:a2e,useReducer:Mz,useRef:e2e,useState:function(){return Mz(QS)},useDebugValue:Pz,useDeferredValue:function(f){var v=Wh();return l2e(v,Sa.memoizedState,f)},useTransition:function(){var f=Mz(QS)[0],v=Wh().memoizedState;return[f,v]},useMutableSource:$ge,useSyncExternalStore:qge,useId:c2e,unstable_isNewReconciler:!1},TPe={readContext:Hh,useCallback:o2e,useContext:Hh,useEffect:Az,useImperativeHandle:s2e,useInsertionEffect:n2e,useLayoutEffect:r2e,useMemo:a2e,useReducer:Cz,useRef:e2e,useState:function(){return Cz(QS)},useDebugValue:Pz,useDeferredValue:function(f){var v=Wh();return Sa===null?v.memoizedState=f:l2e(v,Sa.memoizedState,f)},useTransition:function(){var f=Cz(QS)[0],v=Wh().memoizedState;return[f,v]},useMutableSource:$ge,useSyncExternalStore:qge,useId:c2e,unstable_isNewReconciler:!1};function f7(f,v){try{var T="",O=v;do T+=be(O),O=O.return;while(O);var W=T}catch(J){W=`
Error generating stack: `+J.message+`
`+J.stack}return{value:f,source:v,stack:W,digest:null}}function Rz(f,v,T){return{value:f,source:null,stack:T??null,digest:v??null}}function Iz(f,v){try{console.error(v.value)}catch(T){setTimeout(function(){throw T})}}var MPe=typeof WeakMap=="function"?WeakMap:Map;function f2e(f,v,T){T=mg(-1,T),T.tag=3,T.payload={element:null};var O=v.value;return T.callback=function(){nR||(nR=!0,Wz=O),Iz(f,v)},T}function p2e(f,v,T){T=mg(-1,T),T.tag=3;var O=f.type.getDerivedStateFromError;if(typeof O=="function"){var W=v.value;T.payload=function(){return O(W)},T.callback=function(){Iz(f,v)}}var J=f.stateNode;return J!==null&&typeof J.componentDidCatch=="function"&&(T.callback=function(){Iz(f,v),typeof O!="function"&&(a3===null?a3=new Set([this]):a3.add(this));var fe=v.stack;this.componentDidCatch(v.value,{componentStack:fe!==null?fe:""})}),T}function m2e(f,v,T){var O=f.pingCache;if(O===null){O=f.pingCache=new MPe;var W=new Set;O.set(v,W)}else W=O.get(v),W===void 0&&(W=new Set,O.set(v,W));W.has(T)||(W.add(T),f=zPe.bind(null,f,v,T),v.then(f,f))}function g2e(f){do{var v;if((v=f.tag===13)&&(v=f.memoizedState,v=v!==null?v.dehydrated!==null:!0),v)return f;f=f.return}while(f!==null);return null}function v2e(f,v,T,O,W){return f.mode&1?(f.flags|=65536,f.lanes=W,f):(f===v?f.flags|=65536:(f.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(v=mg(-1,1),v.tag=2,s3(T,v,1))),T.lanes|=1),f)}var CPe=Te.ReactCurrentOwner,jc=!1;function Ql(f,v,T,O){v.child=f===null?Hge(v,null,T,O):h7(v,f.child,T,O)}function y2e(f,v,T,O,W){T=T.render;var J=v.ref;return u7(v,W),O=Ez(f,v,T,O,J,W),T=Tz(),f!==null&&!jc?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~W,gg(f,v,W)):(io&&T&&sz(v),v.flags|=1,Ql(f,v,O,W),v.child)}function x2e(f,v,T,O,W){if(f===null){var J=T.type;return typeof J=="function"&&!Qz(J)&&J.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(v.tag=15,v.type=J,_2e(f,v,J,O,W)):(f=lR(T.type,null,O,v,v.mode,W),f.ref=v.ref,f.return=v,v.child=f)}if(J=f.child,!(f.lanes&W)){var fe=J.memoizedProps;if(T=T.compare,T=T!==null?T:US,T(fe,O)&&f.ref===v.ref)return gg(f,v,W)}return v.flags|=1,f=h3(J,O),f.ref=v.ref,f.return=v,v.child=f}function _2e(f,v,T,O,W){if(f!==null){var J=f.memoizedProps;if(US(J,O)&&f.ref===v.ref)if(jc=!1,v.pendingProps=O=J,(f.lanes&W)!==0)f.flags&131072&&(jc=!0);else return v.lanes=f.lanes,gg(f,v,W)}return kz(f,v,T,O,W)}function b2e(f,v,T){var O=v.pendingProps,W=O.children,J=f!==null?f.memoizedState:null;if(O.mode==="hidden")if(!(v.mode&1))v.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fs(m7,zu),zu|=T;else{if(!(T&1073741824))return f=J!==null?J.baseLanes|T:T,v.lanes=v.childLanes=1073741824,v.memoizedState={baseLanes:f,cachePool:null,transitions:null},v.updateQueue=null,Fs(m7,zu),zu|=f,null;v.memoizedState={baseLanes:0,cachePool:null,transitions:null},O=J!==null?J.baseLanes:T,Fs(m7,zu),zu|=O}else J!==null?(O=J.baseLanes|T,v.memoizedState=null):O=T,Fs(m7,zu),zu|=O;return Ql(f,v,W,T),v.child}function S2e(f,v){var T=v.ref;(f===null&&T!==null||f!==null&&f.ref!==T)&&(v.flags|=512,v.flags|=2097152)}function kz(f,v,T,O,W){var J=Gc(T)?C8:sl.current;return J=s7(v,J),u7(v,W),T=Ez(f,v,T,O,J,W),O=Tz(),f!==null&&!jc?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~W,gg(f,v,W)):(io&&O&&sz(v),v.flags|=1,Ql(f,v,T,W),v.child)}function w2e(f,v,T,O,W){if(Gc(T)){var J=!0;NP(v)}else J=!1;if(u7(v,W),v.stateNode===null)ZP(f,v),zge(v,T,O),vz(v,T,O,W),O=!0;else if(f===null){var fe=v.stateNode,Ne=v.memoizedProps;fe.props=Ne;var qe=fe.context,Rt=T.contextType;typeof Rt=="object"&&Rt!==null?Rt=Hh(Rt):(Rt=Gc(T)?C8:sl.current,Rt=s7(v,Rt));var un=T.getDerivedStateFromProps,dn=typeof un=="function"||typeof fe.getSnapshotBeforeUpdate=="function";dn||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Ne!==O||qe!==Rt)&&Vge(v,fe,O,Rt),i3=!1;var ln=v.memoizedState;fe.state=ln,VP(v,O,fe,W),qe=v.memoizedState,Ne!==O||ln!==qe||Vc.current||i3?(typeof un=="function"&&(gz(v,T,un,O),qe=v.memoizedState),(Ne=i3||Uge(v,T,Ne,O,ln,qe,Rt))?(dn||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount()),typeof fe.componentDidMount=="function"&&(v.flags|=4194308)):(typeof fe.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=O,v.memoizedState=qe),fe.props=O,fe.state=qe,fe.context=Rt,O=Ne):(typeof fe.componentDidMount=="function"&&(v.flags|=4194308),O=!1)}else{fe=v.stateNode,Oge(f,v),Ne=v.memoizedProps,Rt=v.type===v.elementType?Ne:pf(v.type,Ne),fe.props=Rt,dn=v.pendingProps,ln=fe.context,qe=T.contextType,typeof qe=="object"&&qe!==null?qe=Hh(qe):(qe=Gc(T)?C8:sl.current,qe=s7(v,qe));var Vn=T.getDerivedStateFromProps;(un=typeof Vn=="function"||typeof fe.getSnapshotBeforeUpdate=="function")||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Ne!==dn||ln!==qe)&&Vge(v,fe,O,qe),i3=!1,ln=v.memoizedState,fe.state=ln,VP(v,O,fe,W);var nr=v.memoizedState;Ne!==dn||ln!==nr||Vc.current||i3?(typeof Vn=="function"&&(gz(v,T,Vn,O),nr=v.memoizedState),(Rt=i3||Uge(v,T,Rt,O,ln,nr,qe)||!1)?(un||typeof fe.UNSAFE_componentWillUpdate!="function"&&typeof fe.componentWillUpdate!="function"||(typeof fe.componentWillUpdate=="function"&&fe.componentWillUpdate(O,nr,qe),typeof fe.UNSAFE_componentWillUpdate=="function"&&fe.UNSAFE_componentWillUpdate(O,nr,qe)),typeof fe.componentDidUpdate=="function"&&(v.flags|=4),typeof fe.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof fe.componentDidUpdate!="function"||Ne===f.memoizedProps&&ln===f.memoizedState||(v.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||Ne===f.memoizedProps&&ln===f.memoizedState||(v.flags|=1024),v.memoizedProps=O,v.memoizedState=nr),fe.props=O,fe.state=nr,fe.context=qe,O=Rt):(typeof fe.componentDidUpdate!="function"||Ne===f.memoizedProps&&ln===f.memoizedState||(v.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||Ne===f.memoizedProps&&ln===f.memoizedState||(v.flags|=1024),O=!1)}return Nz(f,v,T,O,J,W)}function Nz(f,v,T,O,W,J){S2e(f,v);var fe=(v.flags&128)!==0;if(!O&&!fe)return W&&Cge(v,T,!1),gg(f,v,J);O=v.stateNode,CPe.current=v;var Ne=fe&&typeof T.getDerivedStateFromError!="function"?null:O.render();return v.flags|=1,f!==null&&fe?(v.child=h7(v,f.child,null,J),v.child=h7(v,null,Ne,J)):Ql(f,v,Ne,J),v.memoizedState=O.state,W&&Cge(v,T,!0),v.child}function E2e(f){var v=f.stateNode;v.pendingContext?Tge(f,v.pendingContext,v.pendingContext!==v.context):v.context&&Tge(f,v.context,!1),yz(f,v.containerInfo)}function T2e(f,v,T,O,W){return l7(),cz(W),v.flags|=256,Ql(f,v,T,O),v.child}var Dz={dehydrated:null,treeContext:null,retryLane:0};function Oz(f){return{baseLanes:f,cachePool:null,transitions:null}}function M2e(f,v,T){var O=v.pendingProps,W=yo.current,J=!1,fe=(v.flags&128)!==0,Ne;if((Ne=fe)||(Ne=f!==null&&f.memoizedState===null?!1:(W&2)!==0),Ne?(J=!0,v.flags&=-129):(f===null||f.memoizedState!==null)&&(W|=1),Fs(yo,W&1),f===null)return lz(v),f=v.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(v.mode&1?f.data==="$!"?v.lanes=8:v.lanes=1073741824:v.lanes=1,null):(fe=O.children,f=O.fallback,J?(O=v.mode,J=v.child,fe={mode:"hidden",children:fe},!(O&1)&&J!==null?(J.childLanes=0,J.pendingProps=fe):J=cR(fe,O,0,null),f=F8(f,O,T,null),J.return=v,f.return=v,J.sibling=f,v.child=J,v.child.memoizedState=Oz(T),v.memoizedState=Dz,f):Lz(v,fe));if(W=f.memoizedState,W!==null&&(Ne=W.dehydrated,Ne!==null))return APe(f,v,fe,O,Ne,W,T);if(J){J=O.fallback,fe=v.mode,W=f.child,Ne=W.sibling;var qe={mode:"hidden",children:O.children};return!(fe&1)&&v.child!==W?(O=v.child,O.childLanes=0,O.pendingProps=qe,v.deletions=null):(O=h3(W,qe),O.subtreeFlags=W.subtreeFlags&14680064),Ne!==null?J=h3(Ne,J):(J=F8(J,fe,T,null),J.flags|=2),J.return=v,O.return=v,O.sibling=J,v.child=O,O=J,J=v.child,fe=f.child.memoizedState,fe=fe===null?Oz(T):{baseLanes:fe.baseLanes|T,cachePool:null,transitions:fe.transitions},J.memoizedState=fe,J.childLanes=f.childLanes&~T,v.memoizedState=Dz,O}return J=f.child,f=J.sibling,O=h3(J,{mode:"visible",children:O.children}),!(v.mode&1)&&(O.lanes=T),O.return=v,O.sibling=null,f!==null&&(T=v.deletions,T===null?(v.deletions=[f],v.flags|=16):T.push(f)),v.child=O,v.memoizedState=null,O}function Lz(f,v){return v=cR({mode:"visible",children:v},f.mode,0,null),v.return=f,f.child=v}function KP(f,v,T,O){return O!==null&&cz(O),h7(v,f.child,null,T),f=Lz(v,v.pendingProps.children),f.flags|=2,v.memoizedState=null,f}function APe(f,v,T,O,W,J,fe){if(T)return v.flags&256?(v.flags&=-257,O=Rz(Error(m(422))),KP(f,v,fe,O)):v.memoizedState!==null?(v.child=f.child,v.flags|=128,null):(J=O.fallback,W=v.mode,O=cR({mode:"visible",children:O.children},W,0,null),J=F8(J,W,fe,null),J.flags|=2,O.return=v,J.return=v,O.sibling=J,v.child=O,v.mode&1&&h7(v,f.child,null,fe),v.child.memoizedState=Oz(fe),v.memoizedState=Dz,J);if(!(v.mode&1))return KP(f,v,fe,null);if(W.data==="$!"){if(O=W.nextSibling&&W.nextSibling.dataset,O)var Ne=O.dgst;return O=Ne,J=Error(m(419)),O=Rz(J,O,void 0),KP(f,v,fe,O)}if(Ne=(fe&f.childLanes)!==0,jc||Ne){if(O=Xa,O!==null){switch(fe&-fe){case 4:W=2;break;case 16:W=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:W=32;break;case 536870912:W=268435456;break;default:W=0}W=W&(O.suspendedLanes|fe)?0:W,W!==0&&W!==J.retryLane&&(J.retryLane=W,pg(f,W),vf(O,f,W,-1))}return Zz(),O=Rz(Error(m(421))),KP(f,v,fe,O)}return W.data==="$?"?(v.flags|=128,v.child=f.child,v=VPe.bind(null,f),W._reactRetry=v,null):(f=J.treeContext,Uu=e3(W.nextSibling),Bu=v,io=!0,ff=null,f!==null&&(Gh[jh++]=dg,Gh[jh++]=fg,Gh[jh++]=A8,dg=f.id,fg=f.overflow,A8=v),v=Lz(v,O.children),v.flags|=4096,v)}function C2e(f,v,T){f.lanes|=v;var O=f.alternate;O!==null&&(O.lanes|=v),fz(f.return,v,T)}function Fz(f,v,T,O,W){var J=f.memoizedState;J===null?f.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:O,tail:T,tailMode:W}:(J.isBackwards=v,J.rendering=null,J.renderingStartTime=0,J.last=O,J.tail=T,J.tailMode=W)}function A2e(f,v,T){var O=v.pendingProps,W=O.revealOrder,J=O.tail;if(Ql(f,v,O.children,T),O=yo.current,O&2)O=O&1|2,v.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=v.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&C2e(f,T,v);else if(f.tag===19)C2e(f,T,v);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===v)break e;for(;f.sibling===null;){if(f.return===null||f.return===v)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}O&=1}if(Fs(yo,O),!(v.mode&1))v.memoizedState=null;else switch(W){case"forwards":for(T=v.child,W=null;T!==null;)f=T.alternate,f!==null&&HP(f)===null&&(W=T),T=T.sibling;T=W,T===null?(W=v.child,v.child=null):(W=T.sibling,T.sibling=null),Fz(v,!1,W,T,J);break;case"backwards":for(T=null,W=v.child,v.child=null;W!==null;){if(f=W.alternate,f!==null&&HP(f)===null){v.child=W;break}f=W.sibling,W.sibling=T,T=W,W=f}Fz(v,!0,T,null,J);break;case"together":Fz(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function ZP(f,v){!(v.mode&1)&&f!==null&&(f.alternate=null,v.alternate=null,v.flags|=2)}function gg(f,v,T){if(f!==null&&(v.dependencies=f.dependencies),N8|=v.lanes,!(T&v.childLanes))return null;if(f!==null&&v.child!==f.child)throw Error(m(153));if(v.child!==null){for(f=v.child,T=h3(f,f.pendingProps),v.child=T,T.return=v;f.sibling!==null;)f=f.sibling,T=T.sibling=h3(f,f.pendingProps),T.return=v;T.sibling=null}return v.child}function PPe(f,v,T){switch(v.tag){case 3:E2e(v),l7();break;case 5:Wge(v);break;case 1:Gc(v.type)&&NP(v);break;case 4:yz(v,v.stateNode.containerInfo);break;case 10:var O=v.type._context,W=v.memoizedProps.value;Fs(BP,O._currentValue),O._currentValue=W;break;case 13:if(O=v.memoizedState,O!==null)return O.dehydrated!==null?(Fs(yo,yo.current&1),v.flags|=128,null):T&v.child.childLanes?M2e(f,v,T):(Fs(yo,yo.current&1),f=gg(f,v,T),f!==null?f.sibling:null);Fs(yo,yo.current&1);break;case 19:if(O=(T&v.childLanes)!==0,f.flags&128){if(O)return A2e(f,v,T);v.flags|=128}if(W=v.memoizedState,W!==null&&(W.rendering=null,W.tail=null,W.lastEffect=null),Fs(yo,yo.current),O)break;return null;case 22:case 23:return v.lanes=0,b2e(f,v,T)}return gg(f,v,T)}var P2e,Bz,R2e,I2e;P2e=function(f,v){for(var T=v.child;T!==null;){if(T.tag===5||T.tag===6)f.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===v)break;for(;T.sibling===null;){if(T.return===null||T.return===v)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},Bz=function(){},R2e=function(f,v,T,O){var W=f.memoizedProps;if(W!==O){f=v.stateNode,I8(s1.current);var J=null;switch(T){case"input":W=zr(f,W),O=zr(f,O),J=[];break;case"select":W=Ce({},W,{value:void 0}),O=Ce({},O,{value:void 0}),J=[];break;case"textarea":W=$a(f,W),O=$a(f,O),J=[];break;default:typeof W.onClick!="function"&&typeof O.onClick=="function"&&(f.onclick=RP)}_U(T,O);var fe;T=null;for(Rt in W)if(!O.hasOwnProperty(Rt)&&W.hasOwnProperty(Rt)&&W[Rt]!=null)if(Rt==="style"){var Ne=W[Rt];for(fe in Ne)Ne.hasOwnProperty(fe)&&(T||(T={}),T[fe]="")}else Rt!=="dangerouslySetInnerHTML"&&Rt!=="children"&&Rt!=="suppressContentEditableWarning"&&Rt!=="suppressHydrationWarning"&&Rt!=="autoFocus"&&(w.hasOwnProperty(Rt)?J||(J=[]):(J=J||[]).push(Rt,null));for(Rt in O){var qe=O[Rt];if(Ne=W!=null?W[Rt]:void 0,O.hasOwnProperty(Rt)&&qe!==Ne&&(qe!=null||Ne!=null))if(Rt==="style")if(Ne){for(fe in Ne)!Ne.hasOwnProperty(fe)||qe&&qe.hasOwnProperty(fe)||(T||(T={}),T[fe]="");for(fe in qe)qe.hasOwnProperty(fe)&&Ne[fe]!==qe[fe]&&(T||(T={}),T[fe]=qe[fe])}else T||(J||(J=[]),J.push(Rt,T)),T=qe;else Rt==="dangerouslySetInnerHTML"?(qe=qe?qe.__html:void 0,Ne=Ne?Ne.__html:void 0,qe!=null&&Ne!==qe&&(J=J||[]).push(Rt,qe)):Rt==="children"?typeof qe!="string"&&typeof qe!="number"||(J=J||[]).push(Rt,""+qe):Rt!=="suppressContentEditableWarning"&&Rt!=="suppressHydrationWarning"&&(w.hasOwnProperty(Rt)?(qe!=null&&Rt==="onScroll"&&Xs("scroll",f),J||Ne===qe||(J=[])):(J=J||[]).push(Rt,qe))}T&&(J=J||[]).push("style",T);var Rt=J;(v.updateQueue=Rt)&&(v.flags|=4)}},I2e=function(f,v,T,O){T!==O&&(v.flags|=4)};function ew(f,v){if(!io)switch(f.tailMode){case"hidden":v=f.tail;for(var T=null;v!==null;)v.alternate!==null&&(T=v),v=v.sibling;T===null?f.tail=null:T.sibling=null;break;case"collapsed":T=f.tail;for(var O=null;T!==null;)T.alternate!==null&&(O=T),T=T.sibling;O===null?v||f.tail===null?f.tail=null:f.tail.sibling=null:O.sibling=null}}function al(f){var v=f.alternate!==null&&f.alternate.child===f.child,T=0,O=0;if(v)for(var W=f.child;W!==null;)T|=W.lanes|W.childLanes,O|=W.subtreeFlags&14680064,O|=W.flags&14680064,W.return=f,W=W.sibling;else for(W=f.child;W!==null;)T|=W.lanes|W.childLanes,O|=W.subtreeFlags,O|=W.flags,W.return=f,W=W.sibling;return f.subtreeFlags|=O,f.childLanes=T,v}function RPe(f,v,T){var O=v.pendingProps;switch(oz(v),v.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return al(v),null;case 1:return Gc(v.type)&&kP(),al(v),null;case 3:return O=v.stateNode,d7(),Ys(Vc),Ys(sl),bz(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(f===null||f.child===null)&&(FP(v)?v.flags|=4:f===null||f.memoizedState.isDehydrated&&!(v.flags&256)||(v.flags|=1024,ff!==null&&(Xz(ff),ff=null))),Bz(f,v),al(v),null;case 5:xz(v);var W=I8(YS.current);if(T=v.type,f!==null&&v.stateNode!=null)R2e(f,v,T,O,W),f.ref!==v.ref&&(v.flags|=512,v.flags|=2097152);else{if(!O){if(v.stateNode===null)throw Error(m(166));return al(v),null}if(f=I8(s1.current),FP(v)){O=v.stateNode,T=v.type;var J=v.memoizedProps;switch(O[i1]=v,O[HS]=J,f=(v.mode&1)!==0,T){case"dialog":Xs("cancel",O),Xs("close",O);break;case"iframe":case"object":case"embed":Xs("load",O);break;case"video":case"audio":for(W=0;W<VS.length;W++)Xs(VS[W],O);break;case"source":Xs("error",O);break;case"img":case"image":case"link":Xs("error",O),Xs("load",O);break;case"details":Xs("toggle",O);break;case"input":qs(O,J),Xs("invalid",O);break;case"select":O._wrapperState={wasMultiple:!!J.multiple},Xs("invalid",O);break;case"textarea":Cr(O,J),Xs("invalid",O)}_U(T,J),W=null;for(var fe in J)if(J.hasOwnProperty(fe)){var Ne=J[fe];fe==="children"?typeof Ne=="string"?O.textContent!==Ne&&(J.suppressHydrationWarning!==!0&&PP(O.textContent,Ne,f),W=["children",Ne]):typeof Ne=="number"&&O.textContent!==""+Ne&&(J.suppressHydrationWarning!==!0&&PP(O.textContent,Ne,f),W=["children",""+Ne]):w.hasOwnProperty(fe)&&Ne!=null&&fe==="onScroll"&&Xs("scroll",O)}switch(T){case"input":gr(O),Wa(O,J,!0);break;case"textarea":gr(O),cg(O);break;case"select":case"option":break;default:typeof J.onClick=="function"&&(O.onclick=RP)}O=W,v.updateQueue=O,O!==null&&(v.flags|=4)}else{fe=W.nodeType===9?W:W.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=$6(T)),f==="http://www.w3.org/1999/xhtml"?T==="script"?(f=fe.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof O.is=="string"?f=fe.createElement(T,{is:O.is}):(f=fe.createElement(T),T==="select"&&(fe=f,O.multiple?fe.multiple=!0:O.size&&(fe.size=O.size))):f=fe.createElementNS(f,T),f[i1]=v,f[HS]=O,P2e(f,v,!1,!1),v.stateNode=f;e:{switch(fe=bU(T,O),T){case"dialog":Xs("cancel",f),Xs("close",f),W=O;break;case"iframe":case"object":case"embed":Xs("load",f),W=O;break;case"video":case"audio":for(W=0;W<VS.length;W++)Xs(VS[W],f);W=O;break;case"source":Xs("error",f),W=O;break;case"img":case"image":case"link":Xs("error",f),Xs("load",f),W=O;break;case"details":Xs("toggle",f),W=O;break;case"input":qs(f,O),W=zr(f,O),Xs("invalid",f);break;case"option":W=O;break;case"select":f._wrapperState={wasMultiple:!!O.multiple},W=Ce({},O,{value:void 0}),Xs("invalid",f);break;case"textarea":Cr(f,O),W=$a(f,O),Xs("invalid",f);break;default:W=O}_U(T,W),Ne=W;for(J in Ne)if(Ne.hasOwnProperty(J)){var qe=Ne[J];J==="style"?yme(f,qe):J==="dangerouslySetInnerHTML"?(qe=qe?qe.__html:void 0,qe!=null&&gme(f,qe)):J==="children"?typeof qe=="string"?(T!=="textarea"||qe!=="")&&wS(f,qe):typeof qe=="number"&&wS(f,""+qe):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(w.hasOwnProperty(J)?qe!=null&&J==="onScroll"&&Xs("scroll",f):qe!=null&&Me(f,J,qe,fe))}switch(T){case"input":gr(f),Wa(f,O,!1);break;case"textarea":gr(f),cg(f);break;case"option":O.value!=null&&f.setAttribute("value",""+pn(O.value));break;case"select":f.multiple=!!O.multiple,J=O.value,J!=null?zc(f,!!O.multiple,J,!1):O.defaultValue!=null&&zc(f,!!O.multiple,O.defaultValue,!0);break;default:typeof W.onClick=="function"&&(f.onclick=RP)}switch(T){case"button":case"input":case"select":case"textarea":O=!!O.autoFocus;break e;case"img":O=!0;break e;default:O=!1}}O&&(v.flags|=4)}v.ref!==null&&(v.flags|=512,v.flags|=2097152)}return al(v),null;case 6:if(f&&v.stateNode!=null)I2e(f,v,f.memoizedProps,O);else{if(typeof O!="string"&&v.stateNode===null)throw Error(m(166));if(T=I8(YS.current),I8(s1.current),FP(v)){if(O=v.stateNode,T=v.memoizedProps,O[i1]=v,(J=O.nodeValue!==T)&&(f=Bu,f!==null))switch(f.tag){case 3:PP(O.nodeValue,T,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&PP(O.nodeValue,T,(f.mode&1)!==0)}J&&(v.flags|=4)}else O=(T.nodeType===9?T:T.ownerDocument).createTextNode(O),O[i1]=v,v.stateNode=O}return al(v),null;case 13:if(Ys(yo),O=v.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(io&&Uu!==null&&v.mode&1&&!(v.flags&128))Nge(),l7(),v.flags|=98560,J=!1;else if(J=FP(v),O!==null&&O.dehydrated!==null){if(f===null){if(!J)throw Error(m(318));if(J=v.memoizedState,J=J!==null?J.dehydrated:null,!J)throw Error(m(317));J[i1]=v}else l7(),!(v.flags&128)&&(v.memoizedState=null),v.flags|=4;al(v),J=!1}else ff!==null&&(Xz(ff),ff=null),J=!0;if(!J)return v.flags&65536?v:null}return v.flags&128?(v.lanes=T,v):(O=O!==null,O!==(f!==null&&f.memoizedState!==null)&&O&&(v.child.flags|=8192,v.mode&1&&(f===null||yo.current&1?wa===0&&(wa=3):Zz())),v.updateQueue!==null&&(v.flags|=4),al(v),null);case 4:return d7(),Bz(f,v),f===null&&GS(v.stateNode.containerInfo),al(v),null;case 10:return dz(v.type._context),al(v),null;case 17:return Gc(v.type)&&kP(),al(v),null;case 19:if(Ys(yo),J=v.memoizedState,J===null)return al(v),null;if(O=(v.flags&128)!==0,fe=J.rendering,fe===null)if(O)ew(J,!1);else{if(wa!==0||f!==null&&f.flags&128)for(f=v.child;f!==null;){if(fe=HP(f),fe!==null){for(v.flags|=128,ew(J,!1),O=fe.updateQueue,O!==null&&(v.updateQueue=O,v.flags|=4),v.subtreeFlags=0,O=T,T=v.child;T!==null;)J=T,f=O,J.flags&=14680066,fe=J.alternate,fe===null?(J.childLanes=0,J.lanes=f,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=fe.childLanes,J.lanes=fe.lanes,J.child=fe.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=fe.memoizedProps,J.memoizedState=fe.memoizedState,J.updateQueue=fe.updateQueue,J.type=fe.type,f=fe.dependencies,J.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),T=T.sibling;return Fs(yo,yo.current&1|2),v.child}f=f.sibling}J.tail!==null&&$o()>g7&&(v.flags|=128,O=!0,ew(J,!1),v.lanes=4194304)}else{if(!O)if(f=HP(fe),f!==null){if(v.flags|=128,O=!0,T=f.updateQueue,T!==null&&(v.updateQueue=T,v.flags|=4),ew(J,!0),J.tail===null&&J.tailMode==="hidden"&&!fe.alternate&&!io)return al(v),null}else 2*$o()-J.renderingStartTime>g7&&T!==1073741824&&(v.flags|=128,O=!0,ew(J,!1),v.lanes=4194304);J.isBackwards?(fe.sibling=v.child,v.child=fe):(T=J.last,T!==null?T.sibling=fe:v.child=fe,J.last=fe)}return J.tail!==null?(v=J.tail,J.rendering=v,J.tail=v.sibling,J.renderingStartTime=$o(),v.sibling=null,T=yo.current,Fs(yo,O?T&1|2:T&1),v):(al(v),null);case 22:case 23:return Kz(),O=v.memoizedState!==null,f!==null&&f.memoizedState!==null!==O&&(v.flags|=8192),O&&v.mode&1?zu&1073741824&&(al(v),v.subtreeFlags&6&&(v.flags|=8192)):al(v),null;case 24:return null;case 25:return null}throw Error(m(156,v.tag))}function IPe(f,v){switch(oz(v),v.tag){case 1:return Gc(v.type)&&kP(),f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 3:return d7(),Ys(Vc),Ys(sl),bz(),f=v.flags,f&65536&&!(f&128)?(v.flags=f&-65537|128,v):null;case 5:return xz(v),null;case 13:if(Ys(yo),f=v.memoizedState,f!==null&&f.dehydrated!==null){if(v.alternate===null)throw Error(m(340));l7()}return f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 19:return Ys(yo),null;case 4:return d7(),null;case 10:return dz(v.type._context),null;case 22:case 23:return Kz(),null;case 24:return null;default:return null}}var QP=!1,ll=!1,kPe=typeof WeakSet=="function"?WeakSet:Set,Zn=null;function p7(f,v){var T=f.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(O){Lo(f,v,O)}else T.current=null}function k2e(f,v,T){try{T()}catch(O){Lo(f,v,O)}}var N2e=!1;function NPe(f,v){if(ZU=mP,f=age(),WU(f)){if("selectionStart"in f)var T={start:f.selectionStart,end:f.selectionEnd};else e:{T=(T=f.ownerDocument)&&T.defaultView||window;var O=T.getSelection&&T.getSelection();if(O&&O.rangeCount!==0){T=O.anchorNode;var W=O.anchorOffset,J=O.focusNode;O=O.focusOffset;try{T.nodeType,J.nodeType}catch{T=null;break e}var fe=0,Ne=-1,qe=-1,Rt=0,un=0,dn=f,ln=null;t:for(;;){for(var Vn;dn!==T||W!==0&&dn.nodeType!==3||(Ne=fe+W),dn!==J||O!==0&&dn.nodeType!==3||(qe=fe+O),dn.nodeType===3&&(fe+=dn.nodeValue.length),(Vn=dn.firstChild)!==null;)ln=dn,dn=Vn;for(;;){if(dn===f)break t;if(ln===T&&++Rt===W&&(Ne=fe),ln===J&&++un===O&&(qe=fe),(Vn=dn.nextSibling)!==null)break;dn=ln,ln=dn.parentNode}dn=Vn}T=Ne===-1||qe===-1?null:{start:Ne,end:qe}}else T=null}T=T||{start:0,end:0}}else T=null;for(QU={focusedElem:f,selectionRange:T},mP=!1,Zn=v;Zn!==null;)if(v=Zn,f=v.child,(v.subtreeFlags&1028)!==0&&f!==null)f.return=v,Zn=f;else for(;Zn!==null;){v=Zn;try{var nr=v.alternate;if(v.flags&1024)switch(v.tag){case 0:case 11:case 15:break;case 1:if(nr!==null){var ir=nr.memoizedProps,qo=nr.memoizedState,xt=v.stateNode,nt=xt.getSnapshotBeforeUpdate(v.elementType===v.type?ir:pf(v.type,ir),qo);xt.__reactInternalSnapshotBeforeUpdate=nt}break;case 3:var Et=v.stateNode.containerInfo;Et.nodeType===1?Et.textContent="":Et.nodeType===9&&Et.documentElement&&Et.removeChild(Et.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(m(163))}}catch(gn){Lo(v,v.return,gn)}if(f=v.sibling,f!==null){f.return=v.return,Zn=f;break}Zn=v.return}return nr=N2e,N2e=!1,nr}function tw(f,v,T){var O=v.updateQueue;if(O=O!==null?O.lastEffect:null,O!==null){var W=O=O.next;do{if((W.tag&f)===f){var J=W.destroy;W.destroy=void 0,J!==void 0&&k2e(v,T,J)}W=W.next}while(W!==O)}}function JP(f,v){if(v=v.updateQueue,v=v!==null?v.lastEffect:null,v!==null){var T=v=v.next;do{if((T.tag&f)===f){var O=T.create;T.destroy=O()}T=T.next}while(T!==v)}}function Uz(f){var v=f.ref;if(v!==null){var T=f.stateNode;switch(f.tag){case 5:f=T;break;default:f=T}typeof v=="function"?v(f):v.current=f}}function D2e(f){var v=f.alternate;v!==null&&(f.alternate=null,D2e(v)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(v=f.stateNode,v!==null&&(delete v[i1],delete v[HS],delete v[nz],delete v[mPe],delete v[gPe])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function O2e(f){return f.tag===5||f.tag===3||f.tag===4}function L2e(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||O2e(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function zz(f,v,T){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?T.nodeType===8?T.parentNode.insertBefore(f,v):T.insertBefore(f,v):(T.nodeType===8?(v=T.parentNode,v.insertBefore(f,T)):(v=T,v.appendChild(f)),T=T._reactRootContainer,T!=null||v.onclick!==null||(v.onclick=RP));else if(O!==4&&(f=f.child,f!==null))for(zz(f,v,T),f=f.sibling;f!==null;)zz(f,v,T),f=f.sibling}function Vz(f,v,T){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?T.insertBefore(f,v):T.appendChild(f);else if(O!==4&&(f=f.child,f!==null))for(Vz(f,v,T),f=f.sibling;f!==null;)Vz(f,v,T),f=f.sibling}var E0=null,mf=!1;function o3(f,v,T){for(T=T.child;T!==null;)F2e(f,v,T),T=T.sibling}function F2e(f,v,T){if(r1&&typeof r1.onCommitFiberUnmount=="function")try{r1.onCommitFiberUnmount(cP,T)}catch{}switch(T.tag){case 5:ll||p7(T,v);case 6:var O=E0,W=mf;E0=null,o3(f,v,T),E0=O,mf=W,E0!==null&&(mf?(f=E0,T=T.stateNode,f.nodeType===8?f.parentNode.removeChild(T):f.removeChild(T)):E0.removeChild(T.stateNode));break;case 18:E0!==null&&(mf?(f=E0,T=T.stateNode,f.nodeType===8?tz(f.parentNode,T):f.nodeType===1&&tz(f,T),NS(f)):tz(E0,T.stateNode));break;case 4:O=E0,W=mf,E0=T.stateNode.containerInfo,mf=!0,o3(f,v,T),E0=O,mf=W;break;case 0:case 11:case 14:case 15:if(!ll&&(O=T.updateQueue,O!==null&&(O=O.lastEffect,O!==null))){W=O=O.next;do{var J=W,fe=J.destroy;J=J.tag,fe!==void 0&&(J&2||J&4)&&k2e(T,v,fe),W=W.next}while(W!==O)}o3(f,v,T);break;case 1:if(!ll&&(p7(T,v),O=T.stateNode,typeof O.componentWillUnmount=="function"))try{O.props=T.memoizedProps,O.state=T.memoizedState,O.componentWillUnmount()}catch(Ne){Lo(T,v,Ne)}o3(f,v,T);break;case 21:o3(f,v,T);break;case 22:T.mode&1?(ll=(O=ll)||T.memoizedState!==null,o3(f,v,T),ll=O):o3(f,v,T);break;default:o3(f,v,T)}}function B2e(f){var v=f.updateQueue;if(v!==null){f.updateQueue=null;var T=f.stateNode;T===null&&(T=f.stateNode=new kPe),v.forEach(function(O){var W=GPe.bind(null,f,O);T.has(O)||(T.add(O),O.then(W,W))})}}function gf(f,v){var T=v.deletions;if(T!==null)for(var O=0;O<T.length;O++){var W=T[O];try{var J=f,fe=v,Ne=fe;e:for(;Ne!==null;){switch(Ne.tag){case 5:E0=Ne.stateNode,mf=!1;break e;case 3:E0=Ne.stateNode.containerInfo,mf=!0;break e;case 4:E0=Ne.stateNode.containerInfo,mf=!0;break e}Ne=Ne.return}if(E0===null)throw Error(m(160));F2e(J,fe,W),E0=null,mf=!1;var qe=W.alternate;qe!==null&&(qe.return=null),W.return=null}catch(Rt){Lo(W,v,Rt)}}if(v.subtreeFlags&12854)for(v=v.child;v!==null;)U2e(v,f),v=v.sibling}function U2e(f,v){var T=f.alternate,O=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(gf(v,f),a1(f),O&4){try{tw(3,f,f.return),JP(3,f)}catch(ir){Lo(f,f.return,ir)}try{tw(5,f,f.return)}catch(ir){Lo(f,f.return,ir)}}break;case 1:gf(v,f),a1(f),O&512&&T!==null&&p7(T,T.return);break;case 5:if(gf(v,f),a1(f),O&512&&T!==null&&p7(T,T.return),f.flags&32){var W=f.stateNode;try{wS(W,"")}catch(ir){Lo(f,f.return,ir)}}if(O&4&&(W=f.stateNode,W!=null)){var J=f.memoizedProps,fe=T!==null?T.memoizedProps:J,Ne=f.type,qe=f.updateQueue;if(f.updateQueue=null,qe!==null)try{Ne==="input"&&J.type==="radio"&&J.name!=null&&ri(W,J),bU(Ne,fe);var Rt=bU(Ne,J);for(fe=0;fe<qe.length;fe+=2){var un=qe[fe],dn=qe[fe+1];un==="style"?yme(W,dn):un==="dangerouslySetInnerHTML"?gme(W,dn):un==="children"?wS(W,dn):Me(W,un,dn,Rt)}switch(Ne){case"input":di(W,J);break;case"textarea":Zr(W,J);break;case"select":var ln=W._wrapperState.wasMultiple;W._wrapperState.wasMultiple=!!J.multiple;var Vn=J.value;Vn!=null?zc(W,!!J.multiple,Vn,!1):ln!==!!J.multiple&&(J.defaultValue!=null?zc(W,!!J.multiple,J.defaultValue,!0):zc(W,!!J.multiple,J.multiple?[]:"",!1))}W[HS]=J}catch(ir){Lo(f,f.return,ir)}}break;case 6:if(gf(v,f),a1(f),O&4){if(f.stateNode===null)throw Error(m(162));W=f.stateNode,J=f.memoizedProps;try{W.nodeValue=J}catch(ir){Lo(f,f.return,ir)}}break;case 3:if(gf(v,f),a1(f),O&4&&T!==null&&T.memoizedState.isDehydrated)try{NS(v.containerInfo)}catch(ir){Lo(f,f.return,ir)}break;case 4:gf(v,f),a1(f);break;case 13:gf(v,f),a1(f),W=f.child,W.flags&8192&&(J=W.memoizedState!==null,W.stateNode.isHidden=J,!J||W.alternate!==null&&W.alternate.memoizedState!==null||(Hz=$o())),O&4&&B2e(f);break;case 22:if(un=T!==null&&T.memoizedState!==null,f.mode&1?(ll=(Rt=ll)||un,gf(v,f),ll=Rt):gf(v,f),a1(f),O&8192){if(Rt=f.memoizedState!==null,(f.stateNode.isHidden=Rt)&&!un&&f.mode&1)for(Zn=f,un=f.child;un!==null;){for(dn=Zn=un;Zn!==null;){switch(ln=Zn,Vn=ln.child,ln.tag){case 0:case 11:case 14:case 15:tw(4,ln,ln.return);break;case 1:p7(ln,ln.return);var nr=ln.stateNode;if(typeof nr.componentWillUnmount=="function"){O=ln,T=ln.return;try{v=O,nr.props=v.memoizedProps,nr.state=v.memoizedState,nr.componentWillUnmount()}catch(ir){Lo(O,T,ir)}}break;case 5:p7(ln,ln.return);break;case 22:if(ln.memoizedState!==null){G2e(dn);continue}}Vn!==null?(Vn.return=ln,Zn=Vn):G2e(dn)}un=un.sibling}e:for(un=null,dn=f;;){if(dn.tag===5){if(un===null){un=dn;try{W=dn.stateNode,Rt?(J=W.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none"):(Ne=dn.stateNode,qe=dn.memoizedProps.style,fe=qe!=null&&qe.hasOwnProperty("display")?qe.display:null,Ne.style.display=vme("display",fe))}catch(ir){Lo(f,f.return,ir)}}}else if(dn.tag===6){if(un===null)try{dn.stateNode.nodeValue=Rt?"":dn.memoizedProps}catch(ir){Lo(f,f.return,ir)}}else if((dn.tag!==22&&dn.tag!==23||dn.memoizedState===null||dn===f)&&dn.child!==null){dn.child.return=dn,dn=dn.child;continue}if(dn===f)break e;for(;dn.sibling===null;){if(dn.return===null||dn.return===f)break e;un===dn&&(un=null),dn=dn.return}un===dn&&(un=null),dn.sibling.return=dn.return,dn=dn.sibling}}break;case 19:gf(v,f),a1(f),O&4&&B2e(f);break;case 21:break;default:gf(v,f),a1(f)}}function a1(f){var v=f.flags;if(v&2){try{e:{for(var T=f.return;T!==null;){if(O2e(T)){var O=T;break e}T=T.return}throw Error(m(160))}switch(O.tag){case 5:var W=O.stateNode;O.flags&32&&(wS(W,""),O.flags&=-33);var J=L2e(f);Vz(f,J,W);break;case 3:case 4:var fe=O.stateNode.containerInfo,Ne=L2e(f);zz(f,Ne,fe);break;default:throw Error(m(161))}}catch(qe){Lo(f,f.return,qe)}f.flags&=-3}v&4096&&(f.flags&=-4097)}function DPe(f,v,T){Zn=f,z2e(f)}function z2e(f,v,T){for(var O=(f.mode&1)!==0;Zn!==null;){var W=Zn,J=W.child;if(W.tag===22&&O){var fe=W.memoizedState!==null||QP;if(!fe){var Ne=W.alternate,qe=Ne!==null&&Ne.memoizedState!==null||ll;Ne=QP;var Rt=ll;if(QP=fe,(ll=qe)&&!Rt)for(Zn=W;Zn!==null;)fe=Zn,qe=fe.child,fe.tag===22&&fe.memoizedState!==null?j2e(W):qe!==null?(qe.return=fe,Zn=qe):j2e(W);for(;J!==null;)Zn=J,z2e(J),J=J.sibling;Zn=W,QP=Ne,ll=Rt}V2e(f)}else W.subtreeFlags&8772&&J!==null?(J.return=W,Zn=J):V2e(f)}}function V2e(f){for(;Zn!==null;){var v=Zn;if(v.flags&8772){var T=v.alternate;try{if(v.flags&8772)switch(v.tag){case 0:case 11:case 15:ll||JP(5,v);break;case 1:var O=v.stateNode;if(v.flags&4&&!ll)if(T===null)O.componentDidMount();else{var W=v.elementType===v.type?T.memoizedProps:pf(v.type,T.memoizedProps);O.componentDidUpdate(W,T.memoizedState,O.__reactInternalSnapshotBeforeUpdate)}var J=v.updateQueue;J!==null&&Fge(v,J,O);break;case 3:var fe=v.updateQueue;if(fe!==null){if(T=null,v.child!==null)switch(v.child.tag){case 5:T=v.child.stateNode;break;case 1:T=v.child.stateNode}Fge(v,fe,T)}break;case 5:var Ne=v.stateNode;if(T===null&&v.flags&4){T=Ne;var qe=v.memoizedProps;switch(v.type){case"button":case"input":case"select":case"textarea":qe.autoFocus&&T.focus();break;case"img":qe.src&&(T.src=qe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(v.memoizedState===null){var Rt=v.alternate;if(Rt!==null){var un=Rt.memoizedState;if(un!==null){var dn=un.dehydrated;dn!==null&&NS(dn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(m(163))}ll||v.flags&512&&Uz(v)}catch(ln){Lo(v,v.return,ln)}}if(v===f){Zn=null;break}if(T=v.sibling,T!==null){T.return=v.return,Zn=T;break}Zn=v.return}}function G2e(f){for(;Zn!==null;){var v=Zn;if(v===f){Zn=null;break}var T=v.sibling;if(T!==null){T.return=v.return,Zn=T;break}Zn=v.return}}function j2e(f){for(;Zn!==null;){var v=Zn;try{switch(v.tag){case 0:case 11:case 15:var T=v.return;try{JP(4,v)}catch(qe){Lo(v,T,qe)}break;case 1:var O=v.stateNode;if(typeof O.componentDidMount=="function"){var W=v.return;try{O.componentDidMount()}catch(qe){Lo(v,W,qe)}}var J=v.return;try{Uz(v)}catch(qe){Lo(v,J,qe)}break;case 5:var fe=v.return;try{Uz(v)}catch(qe){Lo(v,fe,qe)}}}catch(qe){Lo(v,v.return,qe)}if(v===f){Zn=null;break}var Ne=v.sibling;if(Ne!==null){Ne.return=v.return,Zn=Ne;break}Zn=v.return}}var OPe=Math.ceil,eR=Te.ReactCurrentDispatcher,Gz=Te.ReactCurrentOwner,$h=Te.ReactCurrentBatchConfig,Vi=0,Xa=null,oa=null,T0=0,zu=0,m7=t3(0),wa=0,nw=null,N8=0,tR=0,jz=0,rw=null,Hc=null,Hz=0,g7=1/0,vg=null,nR=!1,Wz=null,a3=null,rR=!1,l3=null,iR=0,iw=0,$z=null,sR=-1,oR=0;function Jl(){return Vi&6?$o():sR!==-1?sR:sR=$o()}function c3(f){return f.mode&1?Vi&2&&T0!==0?T0&-T0:yPe.transition!==null?(oR===0&&(oR=Nme()),oR):(f=ms,f!==0||(f=window.event,f=f===void 0?16:Gme(f.type)),f):1}function vf(f,v,T,O){if(50<iw)throw iw=0,$z=null,Error(m(185));AS(f,T,O),(!(Vi&2)||f!==Xa)&&(f===Xa&&(!(Vi&2)&&(tR|=T),wa===4&&u3(f,T0)),Wc(f,O),T===1&&Vi===0&&!(v.mode&1)&&(g7=$o()+500,DP&&r3()))}function Wc(f,v){var T=f.callbackNode;_Ae(f,v);var O=dP(f,f===Xa?T0:0);if(O===0)T!==null&&Rme(T),f.callbackNode=null,f.callbackPriority=0;else if(v=O&-O,f.callbackPriority!==v){if(T!=null&&Rme(T),v===1)f.tag===0?vPe(W2e.bind(null,f)):Age(W2e.bind(null,f)),fPe(function(){!(Vi&6)&&r3()}),T=null;else{switch(Dme(O)){case 1:T=AU;break;case 4:T=Ime;break;case 16:T=lP;break;case 536870912:T=kme;break;default:T=lP}T=J2e(T,H2e.bind(null,f))}f.callbackPriority=v,f.callbackNode=T}}function H2e(f,v){if(sR=-1,oR=0,Vi&6)throw Error(m(327));var T=f.callbackNode;if(v7()&&f.callbackNode!==T)return null;var O=dP(f,f===Xa?T0:0);if(O===0)return null;if(O&30||O&f.expiredLanes||v)v=aR(f,O);else{v=O;var W=Vi;Vi|=2;var J=q2e();(Xa!==f||T0!==v)&&(vg=null,g7=$o()+500,O8(f,v));do try{BPe();break}catch(Ne){$2e(f,Ne)}while(!0);hz(),eR.current=J,Vi=W,oa!==null?v=0:(Xa=null,T0=0,v=wa)}if(v!==0){if(v===2&&(W=PU(f),W!==0&&(O=W,v=qz(f,W))),v===1)throw T=nw,O8(f,0),u3(f,O),Wc(f,$o()),T;if(v===6)u3(f,O);else{if(W=f.current.alternate,!(O&30)&&!LPe(W)&&(v=aR(f,O),v===2&&(J=PU(f),J!==0&&(O=J,v=qz(f,J))),v===1))throw T=nw,O8(f,0),u3(f,O),Wc(f,$o()),T;switch(f.finishedWork=W,f.finishedLanes=O,v){case 0:case 1:throw Error(m(345));case 2:L8(f,Hc,vg);break;case 3:if(u3(f,O),(O&130023424)===O&&(v=Hz+500-$o(),10<v)){if(dP(f,0)!==0)break;if(W=f.suspendedLanes,(W&O)!==O){Jl(),f.pingedLanes|=f.suspendedLanes&W;break}f.timeoutHandle=ez(L8.bind(null,f,Hc,vg),v);break}L8(f,Hc,vg);break;case 4:if(u3(f,O),(O&4194240)===O)break;for(v=f.eventTimes,W=-1;0<O;){var fe=31-hf(O);J=1<<fe,fe=v[fe],fe>W&&(W=fe),O&=~J}if(O=W,O=$o()-O,O=(120>O?120:480>O?480:1080>O?1080:1920>O?1920:3e3>O?3e3:4320>O?4320:1960*OPe(O/1960))-O,10<O){f.timeoutHandle=ez(L8.bind(null,f,Hc,vg),O);break}L8(f,Hc,vg);break;case 5:L8(f,Hc,vg);break;default:throw Error(m(329))}}}return Wc(f,$o()),f.callbackNode===T?H2e.bind(null,f):null}function qz(f,v){var T=rw;return f.current.memoizedState.isDehydrated&&(O8(f,v).flags|=256),f=aR(f,v),f!==2&&(v=Hc,Hc=T,v!==null&&Xz(v)),f}function Xz(f){Hc===null?Hc=f:Hc.push.apply(Hc,f)}function LPe(f){for(var v=f;;){if(v.flags&16384){var T=v.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var O=0;O<T.length;O++){var W=T[O],J=W.getSnapshot;W=W.value;try{if(!df(J(),W))return!1}catch{return!1}}}if(T=v.child,v.subtreeFlags&16384&&T!==null)T.return=v,v=T;else{if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function u3(f,v){for(v&=~jz,v&=~tR,f.suspendedLanes|=v,f.pingedLanes&=~v,f=f.expirationTimes;0<v;){var T=31-hf(v),O=1<<T;f[T]=-1,v&=~O}}function W2e(f){if(Vi&6)throw Error(m(327));v7();var v=dP(f,0);if(!(v&1))return Wc(f,$o()),null;var T=aR(f,v);if(f.tag!==0&&T===2){var O=PU(f);O!==0&&(v=O,T=qz(f,O))}if(T===1)throw T=nw,O8(f,0),u3(f,v),Wc(f,$o()),T;if(T===6)throw Error(m(345));return f.finishedWork=f.current.alternate,f.finishedLanes=v,L8(f,Hc,vg),Wc(f,$o()),null}function Yz(f,v){var T=Vi;Vi|=1;try{return f(v)}finally{Vi=T,Vi===0&&(g7=$o()+500,DP&&r3())}}function D8(f){l3!==null&&l3.tag===0&&!(Vi&6)&&v7();var v=Vi;Vi|=1;var T=$h.transition,O=ms;try{if($h.transition=null,ms=1,f)return f()}finally{ms=O,$h.transition=T,Vi=v,!(Vi&6)&&r3()}}function Kz(){zu=m7.current,Ys(m7)}function O8(f,v){f.finishedWork=null,f.finishedLanes=0;var T=f.timeoutHandle;if(T!==-1&&(f.timeoutHandle=-1,dPe(T)),oa!==null)for(T=oa.return;T!==null;){var O=T;switch(oz(O),O.tag){case 1:O=O.type.childContextTypes,O!=null&&kP();break;case 3:d7(),Ys(Vc),Ys(sl),bz();break;case 5:xz(O);break;case 4:d7();break;case 13:Ys(yo);break;case 19:Ys(yo);break;case 10:dz(O.type._context);break;case 22:case 23:Kz()}T=T.return}if(Xa=f,oa=f=h3(f.current,null),T0=zu=v,wa=0,nw=null,jz=tR=N8=0,Hc=rw=null,R8!==null){for(v=0;v<R8.length;v++)if(T=R8[v],O=T.interleaved,O!==null){T.interleaved=null;var W=O.next,J=T.pending;if(J!==null){var fe=J.next;J.next=W,O.next=fe}T.pending=O}R8=null}return f}function $2e(f,v){do{var T=oa;try{if(hz(),WP.current=YP,$P){for(var O=xo.memoizedState;O!==null;){var W=O.queue;W!==null&&(W.pending=null),O=O.next}$P=!1}if(k8=0,qa=Sa=xo=null,KS=!1,ZS=0,Gz.current=null,T===null||T.return===null){wa=1,nw=v,oa=null;break}e:{var J=f,fe=T.return,Ne=T,qe=v;if(v=T0,Ne.flags|=32768,qe!==null&&typeof qe=="object"&&typeof qe.then=="function"){var Rt=qe,un=Ne,dn=un.tag;if(!(un.mode&1)&&(dn===0||dn===11||dn===15)){var ln=un.alternate;ln?(un.updateQueue=ln.updateQueue,un.memoizedState=ln.memoizedState,un.lanes=ln.lanes):(un.updateQueue=null,un.memoizedState=null)}var Vn=g2e(fe);if(Vn!==null){Vn.flags&=-257,v2e(Vn,fe,Ne,J,v),Vn.mode&1&&m2e(J,Rt,v),v=Vn,qe=Rt;var nr=v.updateQueue;if(nr===null){var ir=new Set;ir.add(qe),v.updateQueue=ir}else nr.add(qe);break e}else{if(!(v&1)){m2e(J,Rt,v),Zz();break e}qe=Error(m(426))}}else if(io&&Ne.mode&1){var qo=g2e(fe);if(qo!==null){!(qo.flags&65536)&&(qo.flags|=256),v2e(qo,fe,Ne,J,v),cz(f7(qe,Ne));break e}}J=qe=f7(qe,Ne),wa!==4&&(wa=2),rw===null?rw=[J]:rw.push(J),J=fe;do{switch(J.tag){case 3:J.flags|=65536,v&=-v,J.lanes|=v;var xt=f2e(J,qe,v);Lge(J,xt);break e;case 1:Ne=qe;var nt=J.type,Et=J.stateNode;if(!(J.flags&128)&&(typeof nt.getDerivedStateFromError=="function"||Et!==null&&typeof Et.componentDidCatch=="function"&&(a3===null||!a3.has(Et)))){J.flags|=65536,v&=-v,J.lanes|=v;var gn=p2e(J,Ne,v);Lge(J,gn);break e}}J=J.return}while(J!==null)}Y2e(T)}catch(cr){v=cr,oa===T&&T!==null&&(oa=T=T.return);continue}break}while(!0)}function q2e(){var f=eR.current;return eR.current=YP,f===null?YP:f}function Zz(){(wa===0||wa===3||wa===2)&&(wa=4),Xa===null||!(N8&268435455)&&!(tR&268435455)||u3(Xa,T0)}function aR(f,v){var T=Vi;Vi|=2;var O=q2e();(Xa!==f||T0!==v)&&(vg=null,O8(f,v));do try{FPe();break}catch(W){$2e(f,W)}while(!0);if(hz(),Vi=T,eR.current=O,oa!==null)throw Error(m(261));return Xa=null,T0=0,wa}function FPe(){for(;oa!==null;)X2e(oa)}function BPe(){for(;oa!==null&&!hAe();)X2e(oa)}function X2e(f){var v=Q2e(f.alternate,f,zu);f.memoizedProps=f.pendingProps,v===null?Y2e(f):oa=v,Gz.current=null}function Y2e(f){var v=f;do{var T=v.alternate;if(f=v.return,v.flags&32768){if(T=IPe(T,v),T!==null){T.flags&=32767,oa=T;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{wa=6,oa=null;return}}else if(T=RPe(T,v,zu),T!==null){oa=T;return}if(v=v.sibling,v!==null){oa=v;return}oa=v=f}while(v!==null);wa===0&&(wa=5)}function L8(f,v,T){var O=ms,W=$h.transition;try{$h.transition=null,ms=1,UPe(f,v,T,O)}finally{$h.transition=W,ms=O}return null}function UPe(f,v,T,O){do v7();while(l3!==null);if(Vi&6)throw Error(m(327));T=f.finishedWork;var W=f.finishedLanes;if(T===null)return null;if(f.finishedWork=null,f.finishedLanes=0,T===f.current)throw Error(m(177));f.callbackNode=null,f.callbackPriority=0;var J=T.lanes|T.childLanes;if(bAe(f,J),f===Xa&&(oa=Xa=null,T0=0),!(T.subtreeFlags&2064)&&!(T.flags&2064)||rR||(rR=!0,J2e(lP,function(){return v7(),null})),J=(T.flags&15990)!==0,T.subtreeFlags&15990||J){J=$h.transition,$h.transition=null;var fe=ms;ms=1;var Ne=Vi;Vi|=4,Gz.current=null,NPe(f,T),U2e(T,f),aPe(QU),mP=!!ZU,QU=ZU=null,f.current=T,DPe(T),dAe(),Vi=Ne,ms=fe,$h.transition=J}else f.current=T;if(rR&&(rR=!1,l3=f,iR=W),J=f.pendingLanes,J===0&&(a3=null),mAe(T.stateNode),Wc(f,$o()),v!==null)for(O=f.onRecoverableError,T=0;T<v.length;T++)W=v[T],O(W.value,{componentStack:W.stack,digest:W.digest});if(nR)throw nR=!1,f=Wz,Wz=null,f;return iR&1&&f.tag!==0&&v7(),J=f.pendingLanes,J&1?f===$z?iw++:(iw=0,$z=f):iw=0,r3(),null}function v7(){if(l3!==null){var f=Dme(iR),v=$h.transition,T=ms;try{if($h.transition=null,ms=16>f?16:f,l3===null)var O=!1;else{if(f=l3,l3=null,iR=0,Vi&6)throw Error(m(331));var W=Vi;for(Vi|=4,Zn=f.current;Zn!==null;){var J=Zn,fe=J.child;if(Zn.flags&16){var Ne=J.deletions;if(Ne!==null){for(var qe=0;qe<Ne.length;qe++){var Rt=Ne[qe];for(Zn=Rt;Zn!==null;){var un=Zn;switch(un.tag){case 0:case 11:case 15:tw(8,un,J)}var dn=un.child;if(dn!==null)dn.return=un,Zn=dn;else for(;Zn!==null;){un=Zn;var ln=un.sibling,Vn=un.return;if(D2e(un),un===Rt){Zn=null;break}if(ln!==null){ln.return=Vn,Zn=ln;break}Zn=Vn}}}var nr=J.alternate;if(nr!==null){var ir=nr.child;if(ir!==null){nr.child=null;do{var qo=ir.sibling;ir.sibling=null,ir=qo}while(ir!==null)}}Zn=J}}if(J.subtreeFlags&2064&&fe!==null)fe.return=J,Zn=fe;else e:for(;Zn!==null;){if(J=Zn,J.flags&2048)switch(J.tag){case 0:case 11:case 15:tw(9,J,J.return)}var xt=J.sibling;if(xt!==null){xt.return=J.return,Zn=xt;break e}Zn=J.return}}var nt=f.current;for(Zn=nt;Zn!==null;){fe=Zn;var Et=fe.child;if(fe.subtreeFlags&2064&&Et!==null)Et.return=fe,Zn=Et;else e:for(fe=nt;Zn!==null;){if(Ne=Zn,Ne.flags&2048)try{switch(Ne.tag){case 0:case 11:case 15:JP(9,Ne)}}catch(cr){Lo(Ne,Ne.return,cr)}if(Ne===fe){Zn=null;break e}var gn=Ne.sibling;if(gn!==null){gn.return=Ne.return,Zn=gn;break e}Zn=Ne.return}}if(Vi=W,r3(),r1&&typeof r1.onPostCommitFiberRoot=="function")try{r1.onPostCommitFiberRoot(cP,f)}catch{}O=!0}return O}finally{ms=T,$h.transition=v}}return!1}function K2e(f,v,T){v=f7(T,v),v=f2e(f,v,1),f=s3(f,v,1),v=Jl(),f!==null&&(AS(f,1,v),Wc(f,v))}function Lo(f,v,T){if(f.tag===3)K2e(f,f,T);else for(;v!==null;){if(v.tag===3){K2e(v,f,T);break}else if(v.tag===1){var O=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(a3===null||!a3.has(O))){f=f7(T,f),f=p2e(v,f,1),v=s3(v,f,1),f=Jl(),v!==null&&(AS(v,1,f),Wc(v,f));break}}v=v.return}}function zPe(f,v,T){var O=f.pingCache;O!==null&&O.delete(v),v=Jl(),f.pingedLanes|=f.suspendedLanes&T,Xa===f&&(T0&T)===T&&(wa===4||wa===3&&(T0&130023424)===T0&&500>$o()-Hz?O8(f,0):jz|=T),Wc(f,v)}function Z2e(f,v){v===0&&(f.mode&1?(v=hP,hP<<=1,!(hP&130023424)&&(hP=4194304)):v=1);var T=Jl();f=pg(f,v),f!==null&&(AS(f,v,T),Wc(f,T))}function VPe(f){var v=f.memoizedState,T=0;v!==null&&(T=v.retryLane),Z2e(f,T)}function GPe(f,v){var T=0;switch(f.tag){case 13:var O=f.stateNode,W=f.memoizedState;W!==null&&(T=W.retryLane);break;case 19:O=f.stateNode;break;default:throw Error(m(314))}O!==null&&O.delete(v),Z2e(f,T)}var Q2e;Q2e=function(f,v,T){if(f!==null)if(f.memoizedProps!==v.pendingProps||Vc.current)jc=!0;else{if(!(f.lanes&T)&&!(v.flags&128))return jc=!1,PPe(f,v,T);jc=!!(f.flags&131072)}else jc=!1,io&&v.flags&1048576&&Pge(v,LP,v.index);switch(v.lanes=0,v.tag){case 2:var O=v.type;ZP(f,v),f=v.pendingProps;var W=s7(v,sl.current);u7(v,T),W=Ez(null,v,O,f,W,T);var J=Tz();return v.flags|=1,typeof W=="object"&&W!==null&&typeof W.render=="function"&&W.$$typeof===void 0?(v.tag=1,v.memoizedState=null,v.updateQueue=null,Gc(O)?(J=!0,NP(v)):J=!1,v.memoizedState=W.state!==null&&W.state!==void 0?W.state:null,mz(v),W.updater=GP,v.stateNode=W,W._reactInternals=v,vz(v,O,f,T),v=Nz(null,v,O,!0,J,T)):(v.tag=0,io&&J&&sz(v),Ql(null,v,W,T),v=v.child),v;case 16:O=v.elementType;e:{switch(ZP(f,v),f=v.pendingProps,W=O._init,O=W(O._payload),v.type=O,W=v.tag=HPe(O),f=pf(O,f),W){case 0:v=kz(null,v,O,f,T);break e;case 1:v=w2e(null,v,O,f,T);break e;case 11:v=y2e(null,v,O,f,T);break e;case 14:v=x2e(null,v,O,pf(O.type,f),T);break e}throw Error(m(306,O,""))}return v;case 0:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:pf(O,W),kz(f,v,O,W,T);case 1:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:pf(O,W),w2e(f,v,O,W,T);case 3:e:{if(E2e(v),f===null)throw Error(m(387));O=v.pendingProps,J=v.memoizedState,W=J.element,Oge(f,v),VP(v,O,null,T);var fe=v.memoizedState;if(O=fe.element,J.isDehydrated)if(J={element:O,isDehydrated:!1,cache:fe.cache,pendingSuspenseBoundaries:fe.pendingSuspenseBoundaries,transitions:fe.transitions},v.updateQueue.baseState=J,v.memoizedState=J,v.flags&256){W=f7(Error(m(423)),v),v=T2e(f,v,O,T,W);break e}else if(O!==W){W=f7(Error(m(424)),v),v=T2e(f,v,O,T,W);break e}else for(Uu=e3(v.stateNode.containerInfo.firstChild),Bu=v,io=!0,ff=null,T=Hge(v,null,O,T),v.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(l7(),O===W){v=gg(f,v,T);break e}Ql(f,v,O,T)}v=v.child}return v;case 5:return Wge(v),f===null&&lz(v),O=v.type,W=v.pendingProps,J=f!==null?f.memoizedProps:null,fe=W.children,JU(O,W)?fe=null:J!==null&&JU(O,J)&&(v.flags|=32),S2e(f,v),Ql(f,v,fe,T),v.child;case 6:return f===null&&lz(v),null;case 13:return M2e(f,v,T);case 4:return yz(v,v.stateNode.containerInfo),O=v.pendingProps,f===null?v.child=h7(v,null,O,T):Ql(f,v,O,T),v.child;case 11:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:pf(O,W),y2e(f,v,O,W,T);case 7:return Ql(f,v,v.pendingProps,T),v.child;case 8:return Ql(f,v,v.pendingProps.children,T),v.child;case 12:return Ql(f,v,v.pendingProps.children,T),v.child;case 10:e:{if(O=v.type._context,W=v.pendingProps,J=v.memoizedProps,fe=W.value,Fs(BP,O._currentValue),O._currentValue=fe,J!==null)if(df(J.value,fe)){if(J.children===W.children&&!Vc.current){v=gg(f,v,T);break e}}else for(J=v.child,J!==null&&(J.return=v);J!==null;){var Ne=J.dependencies;if(Ne!==null){fe=J.child;for(var qe=Ne.firstContext;qe!==null;){if(qe.context===O){if(J.tag===1){qe=mg(-1,T&-T),qe.tag=2;var Rt=J.updateQueue;if(Rt!==null){Rt=Rt.shared;var un=Rt.pending;un===null?qe.next=qe:(qe.next=un.next,un.next=qe),Rt.pending=qe}}J.lanes|=T,qe=J.alternate,qe!==null&&(qe.lanes|=T),fz(J.return,T,v),Ne.lanes|=T;break}qe=qe.next}}else if(J.tag===10)fe=J.type===v.type?null:J.child;else if(J.tag===18){if(fe=J.return,fe===null)throw Error(m(341));fe.lanes|=T,Ne=fe.alternate,Ne!==null&&(Ne.lanes|=T),fz(fe,T,v),fe=J.sibling}else fe=J.child;if(fe!==null)fe.return=J;else for(fe=J;fe!==null;){if(fe===v){fe=null;break}if(J=fe.sibling,J!==null){J.return=fe.return,fe=J;break}fe=fe.return}J=fe}Ql(f,v,W.children,T),v=v.child}return v;case 9:return W=v.type,O=v.pendingProps.children,u7(v,T),W=Hh(W),O=O(W),v.flags|=1,Ql(f,v,O,T),v.child;case 14:return O=v.type,W=pf(O,v.pendingProps),W=pf(O.type,W),x2e(f,v,O,W,T);case 15:return _2e(f,v,v.type,v.pendingProps,T);case 17:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:pf(O,W),ZP(f,v),v.tag=1,Gc(O)?(f=!0,NP(v)):f=!1,u7(v,T),zge(v,O,W),vz(v,O,W,T),Nz(null,v,O,!0,f,T);case 19:return A2e(f,v,T);case 22:return b2e(f,v,T)}throw Error(m(156,v.tag))};function J2e(f,v){return Pme(f,v)}function jPe(f,v,T,O){this.tag=f,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qh(f,v,T,O){return new jPe(f,v,T,O)}function Qz(f){return f=f.prototype,!(!f||!f.isReactComponent)}function HPe(f){if(typeof f=="function")return Qz(f)?1:0;if(f!=null){if(f=f.$$typeof,f===Nt)return 11;if(f===ot)return 14}return 2}function h3(f,v){var T=f.alternate;return T===null?(T=qh(f.tag,v,f.key,f.mode),T.elementType=f.elementType,T.type=f.type,T.stateNode=f.stateNode,T.alternate=f,f.alternate=T):(T.pendingProps=v,T.type=f.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=f.flags&14680064,T.childLanes=f.childLanes,T.lanes=f.lanes,T.child=f.child,T.memoizedProps=f.memoizedProps,T.memoizedState=f.memoizedState,T.updateQueue=f.updateQueue,v=f.dependencies,T.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},T.sibling=f.sibling,T.index=f.index,T.ref=f.ref,T}function lR(f,v,T,O,W,J){var fe=2;if(O=f,typeof f=="function")Qz(f)&&(fe=1);else if(typeof f=="string")fe=5;else e:switch(f){case Re:return F8(T.children,W,J,v);case xe:fe=8,W|=8;break;case Oe:return f=qh(12,T,v,W|2),f.elementType=Oe,f.lanes=J,f;case Ve:return f=qh(13,T,v,W),f.elementType=Ve,f.lanes=J,f;case Ht:return f=qh(19,T,v,W),f.elementType=Ht,f.lanes=J,f;case Ee:return cR(T,W,J,v);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case He:fe=10;break e;case Fe:fe=9;break e;case Nt:fe=11;break e;case ot:fe=14;break e;case Ye:fe=16,O=null;break e}throw Error(m(130,f==null?f:typeof f,""))}return v=qh(fe,T,v,W),v.elementType=f,v.type=O,v.lanes=J,v}function F8(f,v,T,O){return f=qh(7,f,O,v),f.lanes=T,f}function cR(f,v,T,O){return f=qh(22,f,O,v),f.elementType=Ee,f.lanes=T,f.stateNode={isHidden:!1},f}function Jz(f,v,T){return f=qh(6,f,null,v),f.lanes=T,f}function eV(f,v,T){return v=qh(4,f.children!==null?f.children:[],f.key,v),v.lanes=T,v.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},v}function WPe(f,v,T,O,W){this.tag=v,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=RU(0),this.expirationTimes=RU(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=RU(0),this.identifierPrefix=O,this.onRecoverableError=W,this.mutableSourceEagerHydrationData=null}function tV(f,v,T,O,W,J,fe,Ne,qe){return f=new WPe(f,v,T,Ne,qe),v===1?(v=1,J===!0&&(v|=8)):v=0,J=qh(3,null,null,v),f.current=J,J.stateNode=f,J.memoizedState={element:O,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},mz(J),f}function $Pe(f,v,T){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:it,key:O==null?null:""+O,children:f,containerInfo:v,implementation:T}}function e9e(f){if(!f)return n3;f=f._reactInternals;e:{if(T8(f)!==f||f.tag!==1)throw Error(m(170));var v=f;do{switch(v.tag){case 3:v=v.stateNode.context;break e;case 1:if(Gc(v.type)){v=v.stateNode.__reactInternalMemoizedMergedChildContext;break e}}v=v.return}while(v!==null);throw Error(m(171))}if(f.tag===1){var T=f.type;if(Gc(T))return Mge(f,T,v)}return v}function t9e(f,v,T,O,W,J,fe,Ne,qe){return f=tV(T,O,!0,f,W,J,fe,Ne,qe),f.context=e9e(null),T=f.current,O=Jl(),W=c3(T),J=mg(O,W),J.callback=v??null,s3(T,J,W),f.current.lanes=W,AS(f,W,O),Wc(f,O),f}function uR(f,v,T,O){var W=v.current,J=Jl(),fe=c3(W);return T=e9e(T),v.context===null?v.context=T:v.pendingContext=T,v=mg(J,fe),v.payload={element:f},O=O===void 0?null:O,O!==null&&(v.callback=O),f=s3(W,v,fe),f!==null&&(vf(f,W,fe,J),zP(f,W,fe)),fe}function hR(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function n9e(f,v){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var T=f.retryLane;f.retryLane=T!==0&&T<v?T:v}}function nV(f,v){n9e(f,v),(f=f.alternate)&&n9e(f,v)}function qPe(){return null}var r9e=typeof reportError=="function"?reportError:function(f){console.error(f)};function rV(f){this._internalRoot=f}dR.prototype.render=rV.prototype.render=function(f){var v=this._internalRoot;if(v===null)throw Error(m(409));uR(f,v,null,null)},dR.prototype.unmount=rV.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var v=f.containerInfo;D8(function(){uR(null,f,null,null)}),v[ug]=null}};function dR(f){this._internalRoot=f}dR.prototype.unstable_scheduleHydration=function(f){if(f){var v=Fme();f={blockedOn:null,target:f,priority:v};for(var T=0;T<Z9.length&&v!==0&&v<Z9[T].priority;T++);Z9.splice(T,0,f),T===0&&zme(f)}};function iV(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function fR(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function i9e(){}function XPe(f,v,T,O,W){if(W){if(typeof O=="function"){var J=O;O=function(){var Rt=hR(fe);J.call(Rt)}}var fe=t9e(v,O,f,0,null,!1,!1,"",i9e);return f._reactRootContainer=fe,f[ug]=fe.current,GS(f.nodeType===8?f.parentNode:f),D8(),fe}for(;W=f.lastChild;)f.removeChild(W);if(typeof O=="function"){var Ne=O;O=function(){var Rt=hR(qe);Ne.call(Rt)}}var qe=tV(f,0,!1,null,null,!1,!1,"",i9e);return f._reactRootContainer=qe,f[ug]=qe.current,GS(f.nodeType===8?f.parentNode:f),D8(function(){uR(v,qe,T,O)}),qe}function pR(f,v,T,O,W){var J=T._reactRootContainer;if(J){var fe=J;if(typeof W=="function"){var Ne=W;W=function(){var qe=hR(fe);Ne.call(qe)}}uR(v,fe,f,W)}else fe=XPe(T,v,f,W,O);return hR(fe)}Ome=function(f){switch(f.tag){case 3:var v=f.stateNode;if(v.current.memoizedState.isDehydrated){var T=CS(v.pendingLanes);T!==0&&(IU(v,T|1),Wc(v,$o()),!(Vi&6)&&(g7=$o()+500,r3()))}break;case 13:D8(function(){var O=pg(f,1);if(O!==null){var W=Jl();vf(O,f,1,W)}}),nV(f,1)}},kU=function(f){if(f.tag===13){var v=pg(f,134217728);if(v!==null){var T=Jl();vf(v,f,134217728,T)}nV(f,134217728)}},Lme=function(f){if(f.tag===13){var v=c3(f),T=pg(f,v);if(T!==null){var O=Jl();vf(T,f,v,O)}nV(f,v)}},Fme=function(){return ms},Bme=function(f,v){var T=ms;try{return ms=f,v()}finally{ms=T}},EU=function(f,v,T){switch(v){case"input":if(di(f,T),v=T.name,T.type==="radio"&&v!=null){for(T=f;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+v)+'][type="radio"]'),v=0;v<T.length;v++){var O=T[v];if(O!==f&&O.form===f.form){var W=IP(O);if(!W)throw Error(m(90));oi(O),di(O,W)}}}break;case"textarea":Zr(f,T);break;case"select":v=T.value,v!=null&&zc(f,!!T.multiple,v,!1)}},Sme=Yz,wme=D8;var YPe={usingClientEntryPoint:!1,Events:[WS,r7,IP,_me,bme,Yz]},sw={findFiberByHostInstance:M8,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},KPe={bundleType:sw.bundleType,version:sw.version,rendererPackageName:sw.rendererPackageName,rendererConfig:sw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Te.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=Cme(f),f===null?null:f.stateNode},findFiberByHostInstance:sw.findFiberByHostInstance||qPe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(ow=__REACT_DEVTOOLS_GLOBAL_HOOK__,!ow.isDisabled&&ow.supportsFiber))try{cP=ow.inject(KPe),r1=ow}catch{}var ow;o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YPe,o.createPortal=function(f,v){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!iV(v))throw Error(m(200));return $Pe(f,v,null,T)},o.createRoot=function(f,v){if(!iV(f))throw Error(m(299));var T=!1,O="",W=r9e;return v!=null&&(v.unstable_strictMode===!0&&(T=!0),v.identifierPrefix!==void 0&&(O=v.identifierPrefix),v.onRecoverableError!==void 0&&(W=v.onRecoverableError)),v=tV(f,1,!1,null,null,T,!1,O,W),f[ug]=v.current,GS(f.nodeType===8?f.parentNode:f),new rV(v)},o.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var v=f._reactInternals;if(v===void 0)throw typeof f.render=="function"?Error(m(188)):(f=Object.keys(f).join(","),Error(m(268,f)));return f=Cme(v),f=f===null?null:f.stateNode,f},o.flushSync=function(f){return D8(f)},o.hydrate=function(f,v,T){if(!fR(v))throw Error(m(200));return pR(null,f,v,!0,T)},o.hydrateRoot=function(f,v,T){if(!iV(f))throw Error(m(405));var O=T!=null&&T.hydratedSources||null,W=!1,J="",fe=r9e;if(T!=null&&(T.unstable_strictMode===!0&&(W=!0),T.identifierPrefix!==void 0&&(J=T.identifierPrefix),T.onRecoverableError!==void 0&&(fe=T.onRecoverableError)),v=t9e(v,null,f,1,T??null,W,!1,J,fe),f[ug]=v.current,GS(f),O)for(f=0;f<O.length;f++)T=O[f],W=T._getVersion,W=W(T._source),v.mutableSourceEagerHydrationData==null?v.mutableSourceEagerHydrationData=[T,W]:v.mutableSourceEagerHydrationData.push(T,W);return new dR(v)},o.render=function(f,v,T){if(!fR(v))throw Error(m(200));return pR(null,f,v,!1,T)},o.unmountComponentAtNode=function(f){if(!fR(f))throw Error(m(40));return f._reactRootContainer?(D8(function(){pR(null,null,f,!1,function(){f._reactRootContainer=null,f[ug]=null})}),!0):!1},o.unstable_batchedUpdates=Yz,o.unstable_renderSubtreeIntoContainer=function(f,v,T,O){if(!fR(T))throw Error(m(200));if(f==null||f._reactInternals===void 0)throw Error(m(38));return pR(f,v,T,!1,O)},o.version="18.2.0-next-9e3b772b8-20220608"}),Gm=te((o,l)=>{function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(m){console.error(m)}}h(),l.exports=X7e()});function Y7e(o){let[,l]=(0,T9.useState)(0);return(0,T9.useCallback)(()=>{l(h=>h+1)},[])}function jr(o,l,h){let m=(0,T9.useCallback)(o,l),_=(0,T9.useRef)(null);_.current?_.current.set(m):_.current=new iM.Atom(m);let w=(0,T9.useRef)(null);return w.current||(w.current=(0,iM.prism)(()=>_.current.prism.getValue()())),lq(w.current,h)}function K7e(){sM||(sM=!0,(0,cq.default)(()=>{(0,uq.unstable_batchedUpdates)(function(){for(var o,l;Vd.length>0;){let h=Vd.shift();jy.delete(h);let m;F5&&((o=h.debug)==null||o.history.push("queue reached"));try{m=h.der.getValue()}catch(_){F5&&((l=h.debug)==null||l.history.push("queue: der.getValue() errored")),console.error("A `der.getValue()` in `usePrismInstance(der)` threw an error. This may be a zombie child issue, so we're gonna try to get its value again in a normal react render phase.If you see the same error again, then you either have an error in your prism code, or the deps array in `usePrism(fn, deps)` is missing a dependency and causing the prism to read stale values."),console.error(_),h.runUpdate();continue}m!==h.lastValue&&(h.lastValue=m,h.runUpdate())}sM=!1},1)}))}function lq(o,l){var h;let m=Y7e(),_=(0,T9.useRef)(void 0);_.current||(eD++,_.current={order:eD,runUpdate:()=>{_.current.unmounted||m()},der:o,lastValue:void 0,unmounted:!1,queueUpdate:()=>{var C;F5&&((C=_.current.debug)==null||C.history.push("queueUpdate()")),hq(_.current)},untap:o.onStale(()=>{F5&&_.current.debug.history.push("onStale(cb)"),_.current.queueUpdate()})},F5&&(_.current.debug={label:l,traceOfFirstTimeRender:new Error,history:[]})),(0,T9.useLayoutEffect)(()=>function(){_.current.unmounted=!0,_.current.untap(),tD(_.current)},[]),tD(_.current);let w=_.current.der.getValue();return _.current.lastValue=w,F5&&((h=_.current.debug)==null||h.history.push("rendered")),w}var iM,cq,T9,uq,F5,Rr,eD,Vd,jy,sM,hq,dq,tD,ur=P(()=>{iM=rn(),m0(),cq=K(H7e()),T9=K($e()),uq=K(Gm()),F5=!1,Rr=(o,l)=>jr(()=>(0,iM.val)(o),[o],l),eD=0,Vd=[],jy=new Set,sM=!1,hq=o=>{dq(o),K7e()},dq=o=>{if(!jy.has(o))if(jy.add(o),Vd.length===0)Vd.push(o);else{let l=D5(Vd,h=>h.order>=o.order);l===-1?Vd.push(o):Vd[l].order>o.order&&Vd.splice(l,0,o)}},tD=o=>{if(!jy.has(o))return;jy.delete(o);let l=D5(Vd,h=>h===o);Vd.splice(l,1)}}),Z7e=te(o=>{var l=60103,h=60106,m=60107,_=60108,w=60114,C=60109,R=60110,N=60112,F=60113,U=60120,$=60115,j=60116,G=60121,Y=60122,Z=60117,ne=60129,ae=60131;typeof Symbol=="function"&&Symbol.for&&(ce=Symbol.for,l=ce("react.element"),h=ce("react.portal"),m=ce("react.fragment"),_=ce("react.strict_mode"),w=ce("react.profiler"),C=ce("react.provider"),R=ce("react.context"),N=ce("react.forward_ref"),F=ce("react.suspense"),U=ce("react.suspense_list"),$=ce("react.memo"),j=ce("react.lazy"),G=ce("react.block"),Y=ce("react.server.block"),Z=ce("react.fundamental"),ne=ce("react.debug_trace_mode"),ae=ce("react.legacy_hidden"));var ce;function ve(Ve){if(typeof Ve=="object"&&Ve!==null){var Ht=Ve.$$typeof;switch(Ht){case l:switch(Ve=Ve.type,Ve){case m:case w:case _:case F:case U:return Ve;default:switch(Ve=Ve&&Ve.$$typeof,Ve){case R:case N:case j:case $:case C:return Ve;default:return Ht}}case h:return Ht}}}var Me=C,Te=l,_e=N,it=m,Re=j,xe=$,Oe=h,He=w,Fe=_,Nt=F;o.ContextConsumer=R,o.ContextProvider=Me,o.Element=Te,o.ForwardRef=_e,o.Fragment=it,o.Lazy=Re,o.Memo=xe,o.Portal=Oe,o.Profiler=He,o.StrictMode=Fe,o.Suspense=Nt,o.isAsyncMode=function(){return!1},o.isConcurrentMode=function(){return!1},o.isContextConsumer=function(Ve){return ve(Ve)===R},o.isContextProvider=function(Ve){return ve(Ve)===C},o.isElement=function(Ve){return typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===l},o.isForwardRef=function(Ve){return ve(Ve)===N},o.isFragment=function(Ve){return ve(Ve)===m},o.isLazy=function(Ve){return ve(Ve)===j},o.isMemo=function(Ve){return ve(Ve)===$},o.isPortal=function(Ve){return ve(Ve)===h},o.isProfiler=function(Ve){return ve(Ve)===w},o.isStrictMode=function(Ve){return ve(Ve)===_},o.isSuspense=function(Ve){return ve(Ve)===F},o.isValidElementType=function(Ve){return typeof Ve=="string"||typeof Ve=="function"||Ve===m||Ve===w||Ve===ne||Ve===_||Ve===F||Ve===U||Ve===ae||typeof Ve=="object"&&Ve!==null&&(Ve.$$typeof===j||Ve.$$typeof===$||Ve.$$typeof===C||Ve.$$typeof===R||Ve.$$typeof===N||Ve.$$typeof===Z||Ve.$$typeof===G||Ve[0]===Y)},o.typeOf=ve}),Q7e=te((o,l)=>{l.exports=Z7e()}),fq=te((o,l)=>{l.exports=function(h,m,_,w){var C=_?_.call(w,h,m):void 0;if(C!==void 0)return!!C;if(h===m)return!0;if(typeof h!="object"||!h||typeof m!="object"||!m)return!1;var R=Object.keys(h),N=Object.keys(m);if(R.length!==N.length)return!1;for(var F=Object.prototype.hasOwnProperty.bind(m),U=0;U<R.length;U++){var $=R[U];if(!F($))return!1;var j=h[$],G=m[$];if(C=_?_.call(w,j,G,$):void 0,C===!1||C===void 0&&j!==G)return!1}return!0}});function J7e(o){function l(Ze,Ft,$t,_t,be){for(var dt=0,bt=0,pn=0,qn=0,sr,gr,oi=0,ps=0,zr,qs=zr=sr=0,ri=0,di=0,Wa=0,vo=0,zh=$t.length,zc=zh-1,$a,Cr="",Zr="",cg="",$6="",Vh;ri<zh;){if(gr=$t.charCodeAt(ri),ri===zc&&bt+qn+pn+dt!==0&&(bt!==0&&(gr=bt===47?10:47),qn=pn=dt=0,zh++,zc++),bt+qn+pn+dt===0){if(ri===zc&&(0<di&&(Cr=Cr.replace(j,"")),0<Cr.trim().length)){switch(gr){case 32:case 9:case 59:case 13:case 10:break;default:Cr+=$t.charAt(ri)}gr=59}switch(gr){case 123:for(Cr=Cr.trim(),sr=Cr.charCodeAt(0),zr=1,vo=++ri;ri<zh;){switch(gr=$t.charCodeAt(ri)){case 123:zr++;break;case 125:zr--;break;case 47:switch(gr=$t.charCodeAt(ri+1)){case 42:case 47:e:{for(qs=ri+1;qs<zc;++qs)switch($t.charCodeAt(qs)){case 47:if(gr===42&&$t.charCodeAt(qs-1)===42&&ri+2!==qs){ri=qs+1;break e}break;case 10:if(gr===47){ri=qs+1;break e}}ri=qs}}break;case 91:gr++;case 40:gr++;case 34:case 39:for(;ri++<zc&&$t.charCodeAt(ri)!==gr;);}if(zr===0)break;ri++}switch(zr=$t.substring(vo,ri),sr===0&&(sr=(Cr=Cr.replace($,"").trim()).charCodeAt(0)),sr){case 64:switch(0<di&&(Cr=Cr.replace(j,"")),gr=Cr.charCodeAt(1),gr){case 100:case 109:case 115:case 45:di=Ft;break;default:di=ot}if(zr=l(Ft,di,zr,gr,be+1),vo=zr.length,0<Ee&&(di=h(ot,Cr,Wa),Vh=R(3,zr,di,Ft,Nt,Fe,vo,gr,be,_t),Cr=di.join(""),Vh!==void 0&&(vo=(zr=Vh.trim()).length)===0&&(gr=0,zr="")),0<vo)switch(gr){case 115:Cr=Cr.replace(_e,C);case 100:case 109:case 45:zr=Cr+"{"+zr+"}";break;case 107:Cr=Cr.replace(ce,"$1 $2"),zr=Cr+"{"+zr+"}",zr=Ht===1||Ht===2&&w("@"+zr,3)?"@-webkit-"+zr+"@"+zr:"@"+zr;break;default:zr=Cr+zr,_t===112&&(zr=(Zr+=zr,""))}else zr="";break;default:zr=l(Ft,h(Ft,Cr,Wa),zr,_t,be+1)}cg+=zr,zr=Wa=di=qs=sr=0,Cr="",gr=$t.charCodeAt(++ri);break;case 125:case 59:if(Cr=(0<di?Cr.replace(j,""):Cr).trim(),1<(vo=Cr.length))switch(qs===0&&(sr=Cr.charCodeAt(0),sr===45||96<sr&&123>sr)&&(vo=(Cr=Cr.replace(" ",":")).length),0<Ee&&(Vh=R(1,Cr,Ft,Ze,Nt,Fe,Zr.length,_t,be,_t))!==void 0&&(vo=(Cr=Vh.trim()).length)===0&&(Cr="\0\0"),sr=Cr.charCodeAt(0),gr=Cr.charCodeAt(1),sr){case 0:break;case 64:if(gr===105||gr===99){$6+=Cr+$t.charAt(ri);break}default:Cr.charCodeAt(vo-1)!==58&&(Zr+=_(Cr,sr,gr,Cr.charCodeAt(2)))}Wa=di=qs=sr=0,Cr="",gr=$t.charCodeAt(++ri)}}switch(gr){case 13:case 10:bt===47?bt=0:1+sr===0&&_t!==107&&0<Cr.length&&(di=1,Cr+="\0"),0<Ee*At&&R(0,Cr,Ft,Ze,Nt,Fe,Zr.length,_t,be,_t),Fe=1,Nt++;break;case 59:case 125:if(bt+qn+pn+dt===0){Fe++;break}default:switch(Fe++,$a=$t.charAt(ri),gr){case 9:case 32:if(qn+dt+bt===0)switch(oi){case 44:case 58:case 9:case 32:$a="";break;default:gr!==32&&($a=" ")}break;case 0:$a="\\0";break;case 12:$a="\\f";break;case 11:$a="\\v";break;case 38:qn+bt+dt===0&&(di=Wa=1,$a="\f"+$a);break;case 108:if(qn+bt+dt+Ve===0&&0<qs)switch(ri-qs){case 2:oi===112&&$t.charCodeAt(ri-3)===58&&(Ve=oi);case 8:ps===111&&(Ve=ps)}break;case 58:qn+bt+dt===0&&(qs=ri);break;case 44:bt+pn+qn+dt===0&&(di=1,$a+="\r");break;case 34:case 39:bt===0&&(qn=qn===gr?0:qn===0?gr:qn);break;case 91:qn+bt+pn===0&&dt++;break;case 93:qn+bt+pn===0&&dt--;break;case 41:qn+bt+dt===0&&pn--;break;case 40:if(qn+bt+dt===0){if(sr===0)switch(2*oi+3*ps){case 533:break;default:sr=1}pn++}break;case 64:bt+pn+qn+dt+qs+zr===0&&(zr=1);break;case 42:case 47:if(!(0<qn+dt+pn))switch(bt){case 0:switch(2*gr+3*$t.charCodeAt(ri+1)){case 235:bt=47;break;case 220:vo=ri,bt=42}break;case 42:gr===47&&oi===42&&vo+2!==ri&&($t.charCodeAt(vo+2)===33&&(Zr+=$t.substring(vo,ri+1)),$a="",bt=0)}}bt===0&&(Cr+=$a)}ps=oi,oi=gr,ri++}if(vo=Zr.length,0<vo){if(di=Ft,0<Ee&&(Vh=R(2,Zr,di,Ze,Nt,Fe,vo,_t,be,_t),Vh!==void 0&&(Zr=Vh).length===0))return $6+Zr+cg;if(Zr=di.join(",")+"{"+Zr+"}",Ht*Ve!==0){switch(Ht!==2||w(Zr,2)||(Ve=0),Ve){case 111:Zr=Zr.replace(Me,":-moz-$1")+Zr;break;case 112:Zr=Zr.replace(ve,"::-webkit-input-$1")+Zr.replace(ve,"::-moz-$1")+Zr.replace(ve,":-ms-input-$1")+Zr}Ve=0}}return $6+Zr+cg}function h(Ze,Ft,$t){var _t=Ft.trim().split(ne);Ft=_t;var be=_t.length,dt=Ze.length;switch(dt){case 0:case 1:var bt=0;for(Ze=dt===0?"":Ze[0]+" ";bt<be;++bt)Ft[bt]=m(Ze,Ft[bt],$t).trim();break;default:var pn=bt=0;for(Ft=[];bt<be;++bt)for(var qn=0;qn<dt;++qn)Ft[pn++]=m(Ze[qn]+" ",_t[bt],$t).trim()}return Ft}function m(Ze,Ft,$t){var _t=Ft.charCodeAt(0);switch(33>_t&&(_t=(Ft=Ft.trim()).charCodeAt(0)),_t){case 38:return Ft.replace(ae,"$1"+Ze.trim());case 58:return Ze.trim()+Ft.replace(ae,"$1"+Ze.trim());default:if(0<1*$t&&0<Ft.indexOf("\f"))return Ft.replace(ae,(Ze.charCodeAt(0)===58?"":"$1")+Ze.trim())}return Ze+Ft}function _(Ze,Ft,$t,_t){var be=Ze+";",dt=2*Ft+3*$t+4*_t;if(dt===944){Ze=be.indexOf(":",9)+1;var bt=be.substring(Ze,be.length-1).trim();return bt=be.substring(0,Ze).trim()+bt+";",Ht===1||Ht===2&&w(bt,1)?"-webkit-"+bt+bt:bt}if(Ht===0||Ht===2&&!w(be,1))return be;switch(dt){case 1015:return be.charCodeAt(10)===97?"-webkit-"+be+be:be;case 951:return be.charCodeAt(3)===116?"-webkit-"+be+be:be;case 963:return be.charCodeAt(5)===110?"-webkit-"+be+be:be;case 1009:if(be.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+be+be;case 978:return"-webkit-"+be+"-moz-"+be+be;case 1019:case 983:return"-webkit-"+be+"-moz-"+be+"-ms-"+be+be;case 883:if(be.charCodeAt(8)===45)return"-webkit-"+be+be;if(0<be.indexOf("image-set(",11))return be.replace(He,"$1-webkit-$2")+be;break;case 932:if(be.charCodeAt(4)===45)switch(be.charCodeAt(5)){case 103:return"-webkit-box-"+be.replace("-grow","")+"-webkit-"+be+"-ms-"+be.replace("grow","positive")+be;case 115:return"-webkit-"+be+"-ms-"+be.replace("shrink","negative")+be;case 98:return"-webkit-"+be+"-ms-"+be.replace("basis","preferred-size")+be}return"-webkit-"+be+"-ms-"+be+be;case 964:return"-webkit-"+be+"-ms-flex-"+be+be;case 1023:if(be.charCodeAt(8)!==99)break;return bt=be.substring(be.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+bt+"-webkit-"+be+"-ms-flex-pack"+bt+be;case 1005:return Y.test(be)?be.replace(G,":-webkit-")+be.replace(G,":-moz-")+be:be;case 1e3:switch(bt=be.substring(13).trim(),Ft=bt.indexOf("-")+1,bt.charCodeAt(0)+bt.charCodeAt(Ft)){case 226:bt=be.replace(Te,"tb");break;case 232:bt=be.replace(Te,"tb-rl");break;case 220:bt=be.replace(Te,"lr");break;default:return be}return"-webkit-"+be+"-ms-"+bt+be;case 1017:if(be.indexOf("sticky",9)===-1)break;case 975:switch(Ft=(be=Ze).length-10,bt=(be.charCodeAt(Ft)===33?be.substring(0,Ft):be).substring(Ze.indexOf(":",7)+1).trim(),dt=bt.charCodeAt(0)+(bt.charCodeAt(7)|0)){case 203:if(111>bt.charCodeAt(8))break;case 115:be=be.replace(bt,"-webkit-"+bt)+";"+be;break;case 207:case 102:be=be.replace(bt,"-webkit-"+(102<dt?"inline-":"")+"box")+";"+be.replace(bt,"-webkit-"+bt)+";"+be.replace(bt,"-ms-"+bt+"box")+";"+be}return be+";";case 938:if(be.charCodeAt(5)===45)switch(be.charCodeAt(6)){case 105:return bt=be.replace("-items",""),"-webkit-"+be+"-webkit-box-"+bt+"-ms-flex-"+bt+be;case 115:return"-webkit-"+be+"-ms-flex-item-"+be.replace(Re,"")+be;default:return"-webkit-"+be+"-ms-flex-line-pack"+be.replace("align-content","").replace(Re,"")+be}break;case 973:case 989:if(be.charCodeAt(3)!==45||be.charCodeAt(4)===122)break;case 931:case 953:if(Oe.test(Ze)===!0)return(bt=Ze.substring(Ze.indexOf(":")+1)).charCodeAt(0)===115?_(Ze.replace("stretch","fill-available"),Ft,$t,_t).replace(":fill-available",":stretch"):be.replace(bt,"-webkit-"+bt)+be.replace(bt,"-moz-"+bt.replace("fill-",""))+be;break;case 962:if(be="-webkit-"+be+(be.charCodeAt(5)===102?"-ms-"+be:"")+be,$t+_t===211&&be.charCodeAt(13)===105&&0<be.indexOf("transform",10))return be.substring(0,be.indexOf(";",27)+1).replace(Z,"$1-webkit-$2")+be}return be}function w(Ze,Ft){var $t=Ze.indexOf(Ft===1?":":"{"),_t=Ze.substring(0,Ft!==3?$t:10);return $t=Ze.substring($t+1,Ze.length-1),et(Ft!==2?_t:_t.replace(xe,"$1"),$t,Ft)}function C(Ze,Ft){var $t=_(Ft,Ft.charCodeAt(0),Ft.charCodeAt(1),Ft.charCodeAt(2));return $t!==Ft+";"?$t.replace(it," or ($1)").substring(4):"("+Ft+")"}function R(Ze,Ft,$t,_t,be,dt,bt,pn,qn,sr){for(var gr=0,oi=Ft,ps;gr<Ee;++gr)switch(ps=Ye[gr].call(U,Ze,oi,$t,_t,be,dt,bt,pn,qn,sr)){case void 0:case!1:case!0:case null:break;default:oi=ps}if(oi!==Ft)return oi}function N(Ze){switch(Ze){case void 0:case null:Ee=Ye.length=0;break;default:if(typeof Ze=="function")Ye[Ee++]=Ze;else if(typeof Ze=="object")for(var Ft=0,$t=Ze.length;Ft<$t;++Ft)N(Ze[Ft]);else At=!!Ze|0}return N}function F(Ze){return Ze=Ze.prefix,Ze!==void 0&&(et=null,Ze?typeof Ze!="function"?Ht=1:(Ht=2,et=Ze):Ht=0),F}function U(Ze,Ft){var $t=Ze;if(33>$t.charCodeAt(0)&&($t=$t.trim()),Ce=$t,$t=[Ce],0<Ee){var _t=R(-1,Ft,$t,$t,Nt,Fe,0,0,0,0);_t!==void 0&&typeof _t=="string"&&(Ft=_t)}var be=l(ot,$t,Ft,0,0);return 0<Ee&&(_t=R(-2,be,$t,$t,Nt,Fe,be.length,0,0,0),_t!==void 0&&(be=_t)),Ce="",Ve=0,Fe=Nt=1,be}var $=/^\0+/g,j=/[\0\r\f]/g,G=/: */g,Y=/zoo|gra/,Z=/([,: ])(transform)/g,ne=/,\r+?/g,ae=/([\t\r\n ])*\f?&/g,ce=/@(k\w+)\s*(\S*)\s*/,ve=/::(place)/g,Me=/:(read-only)/g,Te=/[svh]\w+-[tblr]{2}/,_e=/\(\s*(.*)\s*\)/g,it=/([\s\S]*?);/g,Re=/-self|flex-/g,xe=/[^]*?(:[rp][el]a[\w-]+)[^]*/,Oe=/stretch|:\s*\w+\-(?:conte|avail)/,He=/([^-])(image-set\()/,Fe=1,Nt=1,Ve=0,Ht=1,ot=[],Ye=[],Ee=0,et=null,At=0,Ce="";return U.use=N,U.set=F,o!==void 0&&F(o),U}var pq,exe=P(()=>{pq=J7e}),mq,gq,txe=P(()=>{mq={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},gq=mq});function nxe(o){var l=Object.create(null);return function(h){return l[h]===void 0&&(l[h]=o(h)),l[h]}}var vq,rxe=P(()=>{vq=nxe}),yq,xq,nD,ixe=P(()=>{rxe(),yq=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,xq=vq(function(o){return yq.test(o)||o.charCodeAt(0)===111&&o.charCodeAt(1)===110&&o.charCodeAt(2)<91}),nD=xq}),sxe=te(o=>{var l=typeof Symbol=="function"&&Symbol.for,h=l?Symbol.for("react.element"):60103,m=l?Symbol.for("react.portal"):60106,_=l?Symbol.for("react.fragment"):60107,w=l?Symbol.for("react.strict_mode"):60108,C=l?Symbol.for("react.profiler"):60114,R=l?Symbol.for("react.provider"):60109,N=l?Symbol.for("react.context"):60110,F=l?Symbol.for("react.async_mode"):60111,U=l?Symbol.for("react.concurrent_mode"):60111,$=l?Symbol.for("react.forward_ref"):60112,j=l?Symbol.for("react.suspense"):60113,G=l?Symbol.for("react.suspense_list"):60120,Y=l?Symbol.for("react.memo"):60115,Z=l?Symbol.for("react.lazy"):60116,ne=l?Symbol.for("react.block"):60121,ae=l?Symbol.for("react.fundamental"):60117,ce=l?Symbol.for("react.responder"):60118,ve=l?Symbol.for("react.scope"):60119;function Me(_e){if(typeof _e=="object"&&_e!==null){var it=_e.$$typeof;switch(it){case h:switch(_e=_e.type,_e){case F:case U:case _:case C:case w:case j:return _e;default:switch(_e=_e&&_e.$$typeof,_e){case N:case $:case Z:case Y:case R:return _e;default:return it}}case m:return it}}}function Te(_e){return Me(_e)===U}o.AsyncMode=F,o.ConcurrentMode=U,o.ContextConsumer=N,o.ContextProvider=R,o.Element=h,o.ForwardRef=$,o.Fragment=_,o.Lazy=Z,o.Memo=Y,o.Portal=m,o.Profiler=C,o.StrictMode=w,o.Suspense=j,o.isAsyncMode=function(_e){return Te(_e)||Me(_e)===F},o.isConcurrentMode=Te,o.isContextConsumer=function(_e){return Me(_e)===N},o.isContextProvider=function(_e){return Me(_e)===R},o.isElement=function(_e){return typeof _e=="object"&&_e!==null&&_e.$$typeof===h},o.isForwardRef=function(_e){return Me(_e)===$},o.isFragment=function(_e){return Me(_e)===_},o.isLazy=function(_e){return Me(_e)===Z},o.isMemo=function(_e){return Me(_e)===Y},o.isPortal=function(_e){return Me(_e)===m},o.isProfiler=function(_e){return Me(_e)===C},o.isStrictMode=function(_e){return Me(_e)===w},o.isSuspense=function(_e){return Me(_e)===j},o.isValidElementType=function(_e){return typeof _e=="string"||typeof _e=="function"||_e===_||_e===U||_e===C||_e===w||_e===j||_e===G||typeof _e=="object"&&_e!==null&&(_e.$$typeof===Z||_e.$$typeof===Y||_e.$$typeof===R||_e.$$typeof===N||_e.$$typeof===$||_e.$$typeof===ae||_e.$$typeof===ce||_e.$$typeof===ve||_e.$$typeof===ne)},o.typeOf=Me}),oxe=te((o,l)=>{l.exports=sxe()}),axe=te((o,l)=>{var h=oxe(),m={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},_={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},w={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},C={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},R={};R[h.ForwardRef]=w,R[h.Memo]=C;function N(ne){return h.isMemo(ne)?C:R[ne.$$typeof]||m}var F=Object.defineProperty,U=Object.getOwnPropertyNames,$=Object.getOwnPropertySymbols,j=Object.getOwnPropertyDescriptor,G=Object.getPrototypeOf,Y=Object.prototype;function Z(ne,ae,ce){if(typeof ae!="string"){if(Y){var ve=G(ae);ve&&ve!==Y&&Z(ne,ve,ce)}var Me=U(ae);$&&(Me=Me.concat($(ae)));for(var Te=N(ne),_e=N(ae),it=0;it<Me.length;++it){var Re=Me[it];if(!_[Re]&&!(ce&&ce[Re])&&!(_e&&_e[Re])&&!(Te&&Te[Re])){var xe=j(ae,Re);try{F(ne,Re,xe)}catch{}}}}return ne}l.exports=Z});function Gd(){return(Gd=Object.assign||function(o){for(var l=1;l<arguments.length;l++){var h=arguments[l];for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&(o[m]=h[m])}return o}).apply(this,arguments)}function ib(o){return typeof o=="function"}function _q(o){return o.displayName||o.name||"Component"}function rD(o){return o&&typeof o.styledComponentId=="string"}function jm(o){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];throw new Error("An error occurred. See https://git.io/JUIaE#"+o+" for more information."+(h.length>0?" Args: "+h.join(", "):""))}function iD(o){var l,h="";for(l=Math.abs(o);l>52;l=l/52|0)h=hD(l%52)+h;return(hD(l%52)+h).replace(Hq,"$1-$2")}function bq(o){for(var l=0;l<o.length;l+=1){var h=o[l];if(ib(h)&&!rD(h))return!1}return!0}function Sq(o){var l,h,m,_,w=o===void 0?Hm:o,C=w.options,R=C===void 0?Hm:C,N=w.plugins,F=N===void 0?sb:N,U=new pq(R),$=[],j=function(Z){function ne(ae){if(ae)try{Z(ae+"}")}catch{}}return function(ae,ce,ve,Me,Te,_e,it,Re,xe,Oe){switch(ae){case 1:if(xe===0&&ce.charCodeAt(0)===64)return Z(ce+";"),"";break;case 2:if(Re===0)return ce+"/*|*/";break;case 3:switch(Re){case 102:case 112:return Z(ve[0]+ce),"";default:return ce+(Oe===0?"/*|*/":"")}case-2:ce.split("/*|*/}").forEach(ne)}}}(function(Z){$.push(Z)}),G=function(Z,ne,ae){return ne===0&&Xq.indexOf(ae[h.length])!==-1||ae.match(_)?Z:"."+l};function Y(Z,ne,ae,ce){ce===void 0&&(ce="&");var ve=Z.replace(qq,""),Me=ne&&ae?ae+" "+ne+" { "+ve+" }":ve;return l=ce,h=ne,m=new RegExp("\\"+h+"\\b","g"),_=new RegExp("(\\"+h+"\\b){2,}"),U(ae||!ne?"":ne,Me)}return U.use([].concat(F,[function(Z,ne,ae){Z===2&&ae.length&&ae[0].lastIndexOf(h)>0&&(ae[0]=ae[0].replace(m,G))},j,function(Z){if(Z===-2){var ne=$;return $=[],ne}}])),Y.hash=F.length?F.reduce(function(Z,ne){return ne.name||jm(15),U5(Z,ne.name)},5381).toString():"",Y}function sD(){return(0,Ho.useContext)(uM)||Yq}function wq(){return(0,Ho.useContext)(hM)||dM}function Eq(o){var l=(0,Ho.useState)(o.stylisPlugins),h=l[0],m=l[1],_=sD(),w=(0,Ho.useMemo)(function(){var R=_;return o.sheet?R=o.sheet:o.target&&(R=R.reconstructWithOptions({target:o.target},!1)),o.disableCSSOMInjection&&(R=R.reconstructWithOptions({useCSSOMInjection:!1})),R},[o.disableCSSOMInjection,o.sheet,o.target]),C=(0,Ho.useMemo)(function(){return Sq({options:{prefix:!o.disableVendorPrefixes},plugins:h})},[o.disableVendorPrefixes,h]);return(0,Ho.useEffect)(function(){(0,Pq.default)(h,o.stylisPlugins)||m(o.stylisPlugins)},[o.stylisPlugins]),Ho.default.createElement(uM.Provider,{value:w},Ho.default.createElement(hM.Provider,{value:C},o.children))}function Tq(o){return Zq.test(o)?o.replace(Qq,eX).replace(Jq,"-ms-"):o}function B5(o,l,h,m){if(Array.isArray(o)){for(var _,w=[],C=0,R=o.length;C<R;C+=1)(_=B5(o[C],l,h,m))!==""&&(Array.isArray(_)?w.push.apply(w,_):w.push(_));return w}if(fD(o))return"";if(rD(o))return"."+o.styledComponentId;if(ib(o)){if(typeof(F=o)!="function"||F.prototype&&F.prototype.isReactComponent||!l)return o;var N=o(l);return B5(N,l,h,m)}var F;return o instanceof Kq?h?(o.inject(h,m),o.getName(m)):o:aM(o)?function U($,j){var G,Y,Z=[];for(var ne in $)$.hasOwnProperty(ne)&&!fD($[ne])&&(Array.isArray($[ne])&&$[ne].isCss||ib($[ne])?Z.push(Tq(ne)+":",$[ne],";"):aM($[ne])?Z.push.apply(Z,U($[ne],ne)):Z.push(Tq(ne)+": "+(G=ne,(Y=$[ne])==null||typeof Y=="boolean"||Y===""?"":typeof Y!="number"||Y===0||G in gq||G.startsWith("--")?String(Y).trim():Y+"px")+";"));return j?[j+" {"].concat(Z,["}"]):Z}(o):o.toString()}function Iu(o){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];return ib(o)||aM(o)?pD(B5(lD(sb,[o].concat(h)))):h.length===0&&o.length===1&&typeof o[0]=="string"?o:pD(B5(lD(o,h)))}function oD(o){return o.replace(tX,"-").replace(nX,"")}function oM(o){return typeof o=="string"&&!0}function lxe(o,l,h){var m=o[h];fM(l)&&fM(m)?Mq(m,l):o[h]=l}function Mq(o){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];for(var _=0,w=h;_<w.length;_++){var C=w[_];if(fM(C))for(var R in C)rX(R)&&lxe(o,C[R],R)}return o}function Cq(o,l,h){var m=rD(o),_=!oM(o),w=l.attrs,C=w===void 0?sb:w,R=l.componentId,N=R===void 0?function(ce,ve){var Me=typeof ce!="string"?"sc":oD(ce);mM[Me]=(mM[Me]||0)+1;var Te=Me+"-"+gD("5.3.11"+Me+mM[Me]);return ve?ve+"-"+Te:Te}(l.displayName,l.parentComponentId):R,F=l.displayName,U=F===void 0?function(ce){return oM(ce)?"styled."+ce:"Styled("+_q(ce)+")"}(o):F,$=l.displayName&&l.componentId?oD(l.displayName)+"-"+l.componentId:l.componentId||N,j=m&&o.attrs?Array.prototype.concat(o.attrs,C).filter(Boolean):C,G=l.shouldForwardProp;m&&o.shouldForwardProp&&(G=l.shouldForwardProp?function(ce,ve,Me){return o.shouldForwardProp(ce,ve,Me)&&l.shouldForwardProp(ce,ve,Me)}:o.shouldForwardProp);var Y,Z=new $q(h,$,m?o.componentStyle:void 0),ne=Z.isStatic&&C.length===0,ae=function(ce,ve){return function(Me,Te,_e,it){var Re=Me.attrs,xe=Me.componentStyle,Oe=Me.defaultProps,He=Me.foldedComponentIds,Fe=Me.shouldForwardProp,Nt=Me.styledComponentId,Ve=Me.target,Ht=function(_t,be,dt){_t===void 0&&(_t=Hm);var bt=Gd({},be,{theme:_t}),pn={};return dt.forEach(function(qn){var sr,gr,oi,ps=qn;for(sr in ib(ps)&&(ps=ps(bt)),ps)bt[sr]=pn[sr]=sr==="className"?(gr=pn[sr],oi=ps[sr],gr&&oi?gr+" "+oi:gr||oi):ps[sr]}),[bt,pn]}(mD(Te,(0,Ho.useContext)(pM),Oe)||Hm,Te,Re),ot=Ht[0],Ye=Ht[1],Ee=function(_t,be,dt,bt){var pn=sD(),qn=wq(),sr=be?_t.generateAndInjectStyles(Hm,pn,qn):_t.generateAndInjectStyles(dt,pn,qn);return sr}(xe,it,ot),et=_e,At=Ye.$as||Te.$as||Ye.as||Te.as||Ve,Ce=oM(At),Ze=Ye!==Te?Gd({},Te,{},Ye):Te,Ft={};for(var $t in Ze)$t[0]!=="$"&&$t!=="as"&&($t==="forwardedAs"?Ft.as=Ze[$t]:(Fe?Fe($t,nD,At):!Ce||nD($t))&&(Ft[$t]=Ze[$t]));return Te.style&&Ye.style!==Te.style&&(Ft.style=Gd({},Te.style,{},Ye.style)),Ft.className=Array.prototype.concat(He,Nt,Ee!==Nt?Ee:null,Te.className,Ye.className).filter(Boolean).join(" "),Ft.ref=et,(0,Ho.createElement)(At,Ft)}(Y,ce,ve,ne)};return ae.displayName=U,(Y=Ho.default.forwardRef(ae)).attrs=j,Y.componentStyle=Z,Y.displayName=U,Y.shouldForwardProp=G,Y.foldedComponentIds=m?Array.prototype.concat(o.foldedComponentIds,o.styledComponentId):sb,Y.styledComponentId=$,Y.target=m?o.target:o,Y.withComponent=function(ce){var ve=l.componentId,Me=function(_e,it){if(_e==null)return{};var Re,xe,Oe={},He=Object.keys(_e);for(xe=0;xe<He.length;xe++)Re=He[xe],it.indexOf(Re)>=0||(Oe[Re]=_e[Re]);return Oe}(l,["componentId"]),Te=ve&&ve+"-"+(oM(ce)?ce:oD(_q(ce)));return Cq(ce,Gd({},Me,{attrs:j,componentId:Te}),h)},Object.defineProperty(Y,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(ce){this._foldedDefaultProps=m?Mq({},o.defaultProps,ce):ce}}),Object.defineProperty(Y,"toString",{value:function(){return"."+Y.styledComponentId}}),_&&(0,Rq.default)(Y,o,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),Y}function Aq(o){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];var _=Iu.apply(void 0,[o].concat(h)),w="sc-global-"+gD(JSON.stringify(_)),C=new iX(_,w);function R(F){var U=sD(),$=wq(),j=(0,Ho.useContext)(pM),G=(0,Ho.useRef)(U.allocateGSInstance(w)).current;return U.server&&N(G,F,U,j,$),(0,Ho.useLayoutEffect)(function(){if(!U.server)return N(G,F,U,j,$),function(){return C.removeStyles(G,U)}},[G,F,U,j,$]),null}function N(F,U,$,j,G){if(C.isStatic)C.renderStyles(F,kq,$,G);else{var Y=Gd({},U,{theme:mD(U,j,R.defaultProps)});C.renderStyles(F,Y,$,G)}}return Ho.default.memo(R)}var aD,Ho,Pq,Rq,lD,aM,sb,Hm,Wm,lM,Iq,kq,Nq,ob,ab,Hy,lb,Dq,Oq,Lq,Fq,Bq,Uq,cM,cD,zq,Vq,Gq,uD,jq,Wy,Hq,hD,U5,dD,Wq,$q,qq,Xq,uM,hM,Yq,dM,Kq,Zq,Qq,Jq,eX,fD,pD,mD,tX,nX,gD,fM,rX,pM,mM,gM,iX,me,Xt=P(()=>{aD=K(Q7e()),Ho=K($e()),Pq=K(fq()),exe(),txe(),ixe(),Rq=K(axe()),lD=function(o,l){for(var h=[o[0]],m=0,_=l.length;m<_;m+=1)h.push(l[m],o[m+1]);return h},aM=function(o){return o!==null&&typeof o=="object"&&(o.toString?o.toString():Object.prototype.toString.call(o))==="[object Object]"&&!(0,aD.typeOf)(o)},sb=Object.freeze([]),Hm=Object.freeze({}),Wm=typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_ATTR||t.SC_ATTR)||"data-styled",lM=typeof window<"u"&&"HTMLElement"in window,Iq=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&t.REACT_APP_SC_DISABLE_SPEEDY!==""?t.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&t.REACT_APP_SC_DISABLE_SPEEDY:t.SC_DISABLE_SPEEDY!==void 0&&t.SC_DISABLE_SPEEDY!==""&&t.SC_DISABLE_SPEEDY!=="false"&&t.SC_DISABLE_SPEEDY)),kq={},Nq=function(){function o(h){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=h}var l=o.prototype;return l.indexOfGroup=function(h){for(var m=0,_=0;_<h;_++)m+=this.groupSizes[_];return m},l.insertRules=function(h,m){if(h>=this.groupSizes.length){for(var _=this.groupSizes,w=_.length,C=w;h>=C;)(C<<=1)<0&&jm(16,""+h);this.groupSizes=new Uint32Array(C),this.groupSizes.set(_),this.length=C;for(var R=w;R<C;R++)this.groupSizes[R]=0}for(var N=this.indexOfGroup(h+1),F=0,U=m.length;F<U;F++)this.tag.insertRule(N,m[F])&&(this.groupSizes[h]++,N++)},l.clearGroup=function(h){if(h<this.length){var m=this.groupSizes[h],_=this.indexOfGroup(h),w=_+m;this.groupSizes[h]=0;for(var C=_;C<w;C++)this.tag.deleteRule(_)}},l.getGroup=function(h){var m="";if(h>=this.length||this.groupSizes[h]===0)return m;for(var _=this.groupSizes[h],w=this.indexOfGroup(h),C=w+_,R=w;R<C;R++)m+=this.tag.getRule(R)+`/*!sc*/
`;return m},o}(),ob=new Map,ab=new Map,Hy=1,lb=function(o){if(ob.has(o))return ob.get(o);for(;ab.has(Hy);)Hy++;var l=Hy++;return ob.set(o,l),ab.set(l,o),l},Dq=function(o){return ab.get(o)},Oq=function(o,l){l>=Hy&&(Hy=l+1),ob.set(o,l),ab.set(l,o)},Lq="style["+Wm+'][data-styled-version="5.3.11"]',Fq=new RegExp("^"+Wm+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),Bq=function(o,l,h){for(var m,_=h.split(","),w=0,C=_.length;w<C;w++)(m=_[w])&&o.registerName(l,m)},Uq=function(o,l){for(var h=(l.textContent||"").split(`/*!sc*/
`),m=[],_=0,w=h.length;_<w;_++){var C=h[_].trim();if(C){var R=C.match(Fq);if(R){var N=0|parseInt(R[1],10),F=R[2];N!==0&&(Oq(F,N),Bq(o,F,R[3]),o.getTag().insertRules(N,m)),m.length=0}else m.push(C)}}},cM=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},cD=function(o){var l=document.head,h=o||l,m=document.createElement("style"),_=function(R){for(var N=R.childNodes,F=N.length;F>=0;F--){var U=N[F];if(U&&U.nodeType===1&&U.hasAttribute(Wm))return U}}(h),w=_!==void 0?_.nextSibling:null;m.setAttribute(Wm,"active"),m.setAttribute("data-styled-version","5.3.11");var C=cM();return C&&m.setAttribute("nonce",C),h.insertBefore(m,w),m},zq=function(){function o(h){var m=this.element=cD(h);m.appendChild(document.createTextNode("")),this.sheet=function(_){if(_.sheet)return _.sheet;for(var w=document.styleSheets,C=0,R=w.length;C<R;C++){var N=w[C];if(N.ownerNode===_)return N}jm(17)}(m),this.length=0}var l=o.prototype;return l.insertRule=function(h,m){try{return this.sheet.insertRule(m,h),this.length++,!0}catch{return!1}},l.deleteRule=function(h){this.sheet.deleteRule(h),this.length--},l.getRule=function(h){var m=this.sheet.cssRules[h];return m!==void 0&&typeof m.cssText=="string"?m.cssText:""},o}(),Vq=function(){function o(h){var m=this.element=cD(h);this.nodes=m.childNodes,this.length=0}var l=o.prototype;return l.insertRule=function(h,m){if(h<=this.length&&h>=0){var _=document.createTextNode(m),w=this.nodes[h];return this.element.insertBefore(_,w||null),this.length++,!0}return!1},l.deleteRule=function(h){this.element.removeChild(this.nodes[h]),this.length--},l.getRule=function(h){return h<this.length?this.nodes[h].textContent:""},o}(),Gq=function(){function o(h){this.rules=[],this.length=0}var l=o.prototype;return l.insertRule=function(h,m){return h<=this.length&&(this.rules.splice(h,0,m),this.length++,!0)},l.deleteRule=function(h){this.rules.splice(h,1),this.length--},l.getRule=function(h){return h<this.length?this.rules[h]:""},o}(),uD=lM,jq={isServer:!lM,useCSSOMInjection:!Iq},Wy=function(){function o(h,m,_){h===void 0&&(h=Hm),m===void 0&&(m={}),this.options=Gd({},jq,{},h),this.gs=m,this.names=new Map(_),this.server=!!h.isServer,!this.server&&lM&&uD&&(uD=!1,function(w){for(var C=document.querySelectorAll(Lq),R=0,N=C.length;R<N;R++){var F=C[R];F&&F.getAttribute(Wm)!=="active"&&(Uq(w,F),F.parentNode&&F.parentNode.removeChild(F))}}(this))}o.registerId=function(h){return lb(h)};var l=o.prototype;return l.reconstructWithOptions=function(h,m){return m===void 0&&(m=!0),new o(Gd({},this.options,{},h),this.gs,m&&this.names||void 0)},l.allocateGSInstance=function(h){return this.gs[h]=(this.gs[h]||0)+1},l.getTag=function(){return this.tag||(this.tag=(_=(m=this.options).isServer,w=m.useCSSOMInjection,C=m.target,h=_?new Gq(C):w?new zq(C):new Vq(C),new Nq(h)));var h,m,_,w,C},l.hasNameForId=function(h,m){return this.names.has(h)&&this.names.get(h).has(m)},l.registerName=function(h,m){if(lb(h),this.names.has(h))this.names.get(h).add(m);else{var _=new Set;_.add(m),this.names.set(h,_)}},l.insertRules=function(h,m,_){this.registerName(h,m),this.getTag().insertRules(lb(h),_)},l.clearNames=function(h){this.names.has(h)&&this.names.get(h).clear()},l.clearRules=function(h){this.getTag().clearGroup(lb(h)),this.clearNames(h)},l.clearTag=function(){this.tag=void 0},l.toString=function(){return function(h){for(var m=h.getTag(),_=m.length,w="",C=0;C<_;C++){var R=Dq(C);if(R!==void 0){var N=h.names.get(R),F=m.getGroup(C);if(N&&F&&N.size){var U=Wm+".g"+C+'[id="'+R+'"]',$="";N!==void 0&&N.forEach(function(j){j.length>0&&($+=j+",")}),w+=""+F+U+'{content:"'+$+`"}/*!sc*/
`}}}return w}(this)},o}(),Hq=/(a)(d)/gi,hD=function(o){return String.fromCharCode(o+(o>25?39:97))},U5=function(o,l){for(var h=l.length;h;)o=33*o^l.charCodeAt(--h);return o},dD=function(o){return U5(5381,o)},Wq=dD("5.3.11"),$q=function(){function o(l,h,m){this.rules=l,this.staticRulesId="",this.isStatic=(m===void 0||m.isStatic)&&bq(l),this.componentId=h,this.baseHash=U5(Wq,h),this.baseStyle=m,Wy.registerId(h)}return o.prototype.generateAndInjectStyles=function(l,h,m){var _=this.componentId,w=[];if(this.baseStyle&&w.push(this.baseStyle.generateAndInjectStyles(l,h,m)),this.isStatic&&!m.hash)if(this.staticRulesId&&h.hasNameForId(_,this.staticRulesId))w.push(this.staticRulesId);else{var C=B5(this.rules,l,h,m).join(""),R=iD(U5(this.baseHash,C)>>>0);if(!h.hasNameForId(_,R)){var N=m(C,"."+R,void 0,_);h.insertRules(_,R,N)}w.push(R),this.staticRulesId=R}else{for(var F=this.rules.length,U=U5(this.baseHash,m.hash),$="",j=0;j<F;j++){var G=this.rules[j];if(typeof G=="string")$+=G;else if(G){var Y=B5(G,l,h,m),Z=Array.isArray(Y)?Y.join(""):Y;U=U5(U,Z+j),$+=Z}}if($){var ne=iD(U>>>0);if(!h.hasNameForId(_,ne)){var ae=m($,"."+ne,void 0,_);h.insertRules(_,ne,ae)}w.push(ne)}}return w.join(" ")},o}(),qq=/^\s*\/\/.*$/gm,Xq=[":","[",".","#"],uM=Ho.default.createContext(),uM.Consumer,hM=Ho.default.createContext(),Yq=(hM.Consumer,new Wy),dM=Sq(),Kq=function(){function o(l,h){var m=this;this.inject=function(_,w){w===void 0&&(w=dM);var C=m.name+w.hash;_.hasNameForId(m.id,C)||_.insertRules(m.id,C,w(m.rules,C,"@keyframes"))},this.toString=function(){return jm(12,String(m.name))},this.name=l,this.id="sc-keyframes-"+l,this.rules=h}return o.prototype.getName=function(l){return l===void 0&&(l=dM),this.name+l.hash},o}(),Zq=/([A-Z])/,Qq=/([A-Z])/g,Jq=/^ms-/,eX=function(o){return"-"+o.toLowerCase()},fD=function(o){return o==null||o===!1||o===""},pD=function(o){return Array.isArray(o)&&(o.isCss=!0),o},mD=function(o,l,h){return h===void 0&&(h=Hm),o.theme!==h.theme&&o.theme||l||h.theme},tX=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,nX=/(^-|-$)/g,gD=function(o){return iD(dD(o)>>>0)},fM=function(o){return typeof o=="function"||typeof o=="object"&&o!==null&&!Array.isArray(o)},rX=function(o){return o!=="__proto__"&&o!=="constructor"&&o!=="prototype"},pM=Ho.default.createContext(),pM.Consumer,mM={},gM=function(o){return function l(h,m,_){if(_===void 0&&(_=Hm),!(0,aD.isValidElementType)(m))return jm(1,String(m));var w=function(){return h(m,_,Iu.apply(void 0,arguments))};return w.withConfig=function(C){return l(h,m,Gd({},_,{},C))},w.attrs=function(C){return l(h,m,Gd({},_,{attrs:Array.prototype.concat(_.attrs,C).filter(Boolean)}))},w}(Cq,o)},["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(o){gM[o]=gM(o)}),iX=function(){function o(h,m){this.rules=h,this.componentId=m,this.isStatic=bq(h),Wy.registerId(this.componentId+1)}var l=o.prototype;return l.createStyles=function(h,m,_,w){var C=w(B5(this.rules,m,_,w).join(""),""),R=this.componentId+h;_.insertRules(R,R,C)},l.removeStyles=function(h,m){m.clearRules(this.componentId+h)},l.renderStyles=function(h,m,_,w){h>2&&Wy.registerId(this.componentId+h),this.removeStyles(h,_),this.createStyles(h,m,_,w)},o}(),function(){function o(){var h=this;this._emitSheetCSS=function(){var m=h.instance.toString();if(!m)return"";var _=cM();return"<style "+[_&&'nonce="'+_+'"',Wm+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+m+"</style>"},this.getStyleTags=function(){return h.sealed?jm(2):h._emitSheetCSS()},this.getStyleElement=function(){var m;if(h.sealed)return jm(2);var _=((m={})[Wm]="",m["data-styled-version"]="5.3.11",m.dangerouslySetInnerHTML={__html:h.instance.toString()},m),w=cM();return w&&(_.nonce=w),[Ho.default.createElement("style",Gd({},_,{key:"sc-0-0"}))]},this.seal=function(){h.sealed=!0},this.instance=new Wy({isServer:!0}),this.sealed=!1}var l=o.prototype;return l.collectStyles=function(h){return this.sealed?jm(2):Ho.default.createElement(Eq,{sheet:this.instance},h)},l.interleaveWithNodeStream=function(h){return jm(3)},o}(),me=gM});function z5(){return z5=Object.assign||function(o){for(var l=1;l<arguments.length;l++){var h=arguments[l];for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&(o[m]=h[m])}return o},z5.apply(this,arguments)}var cxe=P(()=>{});function uxe(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}var hxe=P(()=>{});function cb(o,l){return cb=Object.setPrototypeOf||function(h,m){return h.__proto__=m,h},cb(o,l)}var vD=P(()=>{});function dxe(o,l){o.prototype=Object.create(l.prototype),o.prototype.constructor=o,cb(o,l)}var fxe=P(()=>{vD()});function yD(o){return yD=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},yD(o)}var pxe=P(()=>{});function mxe(o){return Function.toString.call(o).indexOf("[native code]")!==-1}var gxe=P(()=>{});function vxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var yxe=P(()=>{});function vM(o,l,h){return vxe()?vM=Reflect.construct:vM=function(m,_,w){var C=[null];C.push.apply(C,_);var R=Function.bind.apply(m,C),N=new R;return w&&cb(N,w.prototype),N},vM.apply(null,arguments)}var xxe=P(()=>{vD(),yxe()});function xD(o){var l=typeof Map=="function"?new Map:void 0;return xD=function(h){if(h===null||!mxe(h))return h;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l<"u"){if(l.has(h))return l.get(h);l.set(h,m)}function m(){return vM(h,arguments,yD(this).constructor)}return m.prototype=Object.create(h.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),cb(m,h)},xD(o)}var _xe=P(()=>{pxe(),vD(),gxe(),xxe()}),bxe=P(()=>{});function Sxe(o){return o.charAt(0).toUpperCase()+o.slice(1)}function wxe(o,l){if(!o)return l.toLowerCase();var h=o.split("-");if(h.length>1)return h.splice(1,0,l),h.reduce(function(_,w){return""+_+Sxe(w)});var m=o.replace(/([a-z])([A-Z])/g,"$1"+l+"$2");return o===m?""+o+l:m}function Exe(o,l){for(var h={},m=0;m<l.length;m+=1)(l[m]||l[m]===0)&&(h[wxe(o,hX[m])]=l[m]);return h}function sX(o){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];var _=h[0],w=h[1],C=w===void 0?_:w,R=h[2],N=R===void 0?_:R,F=h[3],U=F===void 0?C:F,$=[_,C,N,U];return Exe(o,$)}function _D(o){return Math.round(o*255)}function Txe(o,l,h){return _D(o)+","+_D(l)+","+_D(h)}function yM(o,l,h,m){if(m===void 0&&(m=Txe),l===0)return m(h,h,h);var _=(o%360+360)%360/60,w=(1-Math.abs(2*h-1))*l,C=w*(1-Math.abs(_%2-1)),R=0,N=0,F=0;_>=0&&_<1?(R=w,N=C):_>=1&&_<2?(R=C,N=w):_>=2&&_<3?(N=w,F=C):_>=3&&_<4?(N=C,F=w):_>=4&&_<5?(R=C,F=w):_>=5&&_<6&&(R=w,F=C);var U=h-w/2,$=R+U,j=N+U,G=F+U;return m($,j,G)}function Mxe(o){if(typeof o!="string")return o;var l=o.toLowerCase();return TD[l]?"#"+TD[l]:o}function oX(o){if(typeof o!="string")throw new jd(3);var l=Mxe(o);if(l.match(dX))return{red:parseInt(""+l[1]+l[2],16),green:parseInt(""+l[3]+l[4],16),blue:parseInt(""+l[5]+l[6],16)};if(l.match(fX)){var h=parseFloat((parseInt(""+l[7]+l[8],16)/255).toFixed(2));return{red:parseInt(""+l[1]+l[2],16),green:parseInt(""+l[3]+l[4],16),blue:parseInt(""+l[5]+l[6],16),alpha:h}}if(l.match(pX))return{red:parseInt(""+l[1]+l[1],16),green:parseInt(""+l[2]+l[2],16),blue:parseInt(""+l[3]+l[3],16)};if(l.match(mX)){var m=parseFloat((parseInt(""+l[4]+l[4],16)/255).toFixed(2));return{red:parseInt(""+l[1]+l[1],16),green:parseInt(""+l[2]+l[2],16),blue:parseInt(""+l[3]+l[3],16),alpha:m}}var _=bM.exec(l);if(_)return{red:parseInt(""+_[1],10),green:parseInt(""+_[2],10),blue:parseInt(""+_[3],10)};var w=gX.exec(l.substring(0,50));if(w)return{red:parseInt(""+w[1],10),green:parseInt(""+w[2],10),blue:parseInt(""+w[3],10),alpha:parseFloat(""+w[4])};var C=vX.exec(l);if(C){var R=parseInt(""+C[1],10),N=parseInt(""+C[2],10)/100,F=parseInt(""+C[3],10)/100,U="rgb("+yM(R,N,F)+")",$=bM.exec(U);if(!$)throw new jd(4,l,U);return{red:parseInt(""+$[1],10),green:parseInt(""+$[2],10),blue:parseInt(""+$[3],10)}}var j=yX.exec(l.substring(0,50));if(j){var G=parseInt(""+j[1],10),Y=parseInt(""+j[2],10)/100,Z=parseInt(""+j[3],10)/100,ne="rgb("+yM(G,Y,Z)+")",ae=bM.exec(ne);if(!ae)throw new jd(4,l,ne);return{red:parseInt(""+ae[1],10),green:parseInt(""+ae[2],10),blue:parseInt(""+ae[3],10),alpha:parseFloat(""+j[4])}}throw new jd(5)}function Cxe(o){var l=o.red/255,h=o.green/255,m=o.blue/255,_=Math.max(l,h,m),w=Math.min(l,h,m),C=(_+w)/2;if(_===w)return o.alpha!==void 0?{hue:0,saturation:0,lightness:C,alpha:o.alpha}:{hue:0,saturation:0,lightness:C};var R,N=_-w,F=C>.5?N/(2-_-w):N/(_+w);switch(_){case l:R=(h-m)/N+(h<m?6:0);break;case h:R=(m-l)/N+2;break;default:R=(l-h)/N+4;break}return R*=60,o.alpha!==void 0?{hue:R,saturation:F,lightness:C,alpha:o.alpha}:{hue:R,saturation:F,lightness:C}}function bD(o){return Cxe(oX(o))}function V5(o){var l=o.toString(16);return l.length===1?"0"+l:l}function SD(o){return V5(Math.round(o*255))}function Axe(o,l,h){return SM("#"+SD(o)+SD(l)+SD(h))}function aX(o,l,h){return yM(o,l,h,Axe)}function Pxe(o,l,h){if(typeof o=="object"&&l===void 0&&h===void 0)return aX(o.hue,o.saturation,o.lightness);throw new jd(1)}function Rxe(o,l,h,m){if(typeof o=="object"&&l===void 0&&h===void 0&&m===void 0)return o.alpha>=1?aX(o.hue,o.saturation,o.lightness):"rgba("+yM(o.hue,o.saturation,o.lightness)+","+o.alpha+")";throw new jd(2)}function lX(o,l,h){if(typeof o=="number"&&typeof l=="number"&&typeof h=="number")return SM("#"+V5(o)+V5(l)+V5(h));if(typeof o=="object"&&l===void 0&&h===void 0)return SM("#"+V5(o.red)+V5(o.green)+V5(o.blue));throw new jd(6)}function cX(o,l,h,m){if(typeof o=="object"&&l===void 0&&h===void 0&&m===void 0)return o.alpha>=1?lX(o.red,o.green,o.blue):"rgba("+o.red+","+o.green+","+o.blue+","+o.alpha+")";throw new jd(7)}function wD(o){if(typeof o!="object")throw new jd(8);if(_X(o))return cX(o);if(xX(o))return lX(o);if(SX(o))return Rxe(o);if(bX(o))return Pxe(o);throw new jd(8)}function uX(o,l,h){return function(){var m=h.concat(Array.prototype.slice.call(arguments));return m.length>=l?o.apply(this,m):uX(o,l,m)}}function xM(o){return uX(o,o.length,[])}function _M(o,l,h){return Math.max(o,Math.min(l,h))}function Ixe(o,l){if(l==="transparent")return l;var h=bD(l);return wD(z5({},h,{lightness:_M(0,1,h.lightness-parseFloat(o))}))}function kxe(o,l){if(l==="transparent")return l;var h=bD(l);return wD(z5({},h,{lightness:_M(0,1,h.lightness+parseFloat(o))}))}function Nxe(o,l){if(l==="transparent")return l;var h=bD(l);return wD(z5({},h,{saturation:_M(0,1,h.saturation+parseFloat(o))}))}function Dxe(o,l){if(l==="transparent")return l;var h=oX(l),m=typeof h.alpha=="number"?h.alpha:1,_=z5({},h,{alpha:_M(0,1,+(m*100-parseFloat(o)*100).toFixed(2)/100)});return cX(_)}function ED(o){for(var l=arguments.length,h=new Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];return wX.indexOf(o)>=0&&o?z5({},sX.apply(void 0,[""].concat(h)),{position:o}):sX.apply(void 0,["",o].concat(h))}var jd,hX,TD,dX,fX,pX,mX,bM,gX,vX,yX,SM,xX,_X,bX,SX,MD,$y,wM,zp,wX,Hd=P(()=>{cxe(),hxe(),fxe(),_xe(),bxe(),jd=function(o){dxe(l,o);function l(h){var m;return m=o.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+h+" for more information.")||this,uxe(m)}return l}(xD(Error)),hX=["Top","Right","Bottom","Left"],TD={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},dX=/^#[a-fA-F0-9]{6}$/,fX=/^#[a-fA-F0-9]{8}$/,pX=/^#[a-fA-F0-9]{3}$/,mX=/^#[a-fA-F0-9]{4}$/,bM=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,gX=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,vX=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,yX=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,SM=function(o){return o.length===7&&o[1]===o[2]&&o[3]===o[4]&&o[5]===o[6]?"#"+o[1]+o[3]+o[5]:o},xX=function(o){return typeof o.red=="number"&&typeof o.green=="number"&&typeof o.blue=="number"&&(typeof o.alpha!="number"||typeof o.alpha>"u")},_X=function(o){return typeof o.red=="number"&&typeof o.green=="number"&&typeof o.blue=="number"&&typeof o.alpha=="number"},bX=function(o){return typeof o.hue=="number"&&typeof o.saturation=="number"&&typeof o.lightness=="number"&&(typeof o.alpha!="number"||typeof o.alpha>"u")},SX=function(o){return typeof o.hue=="number"&&typeof o.saturation=="number"&&typeof o.lightness=="number"&&typeof o.alpha=="number"},MD=xM(Ixe),$y=xM(kxe),wM=xM(Nxe),zp=xM(Dxe),wX=["absolute","fixed","relative","static","sticky"]});function Oxe(o,l,h){return l in o?Object.defineProperty(o,l,{value:h,enumerable:!0,configurable:!0,writable:!0}):o[l]=h,o}function EX(o,l){var h=Object.keys(o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),h.push.apply(h,m)}return h}function G5(o){for(var l=1;l<arguments.length;l++){var h=arguments[l]!=null?arguments[l]:{};l%2?EX(Object(h),!0).forEach(function(m){Oxe(o,m,h[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(h)):EX(Object(h)).forEach(function(m){Object.defineProperty(o,m,Object.getOwnPropertyDescriptor(h,m))})}return o}function qy(o,l){if(o==null)return{};var h={},m=Object.keys(o),_,w;for(w=0;w<m.length;w++)_=m[w],!(l.indexOf(_)>=0)&&(h[_]=o[_]);return h}var ub=P(()=>{}),TX,CD,MX=P(()=>{TX=K($e()),CD=(0,TX.createContext)({})});function Lxe(o,l,h){return l in o?Object.defineProperty(o,l,{value:h,enumerable:!0,configurable:!0,writable:!0}):o[l]=h,o}function CX(o,l){var h=Object.keys(o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),h.push.apply(h,m)}return h}function Xy(o){for(var l=1;l<arguments.length;l++){var h=arguments[l]!=null?arguments[l]:{};l%2?CX(Object(h),!0).forEach(function(m){Lxe(o,m,h[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(h)):CX(Object(h)).forEach(function(m){Object.defineProperty(o,m,Object.getOwnPropertyDescriptor(h,m))})}return o}function AD(o,l){if(o==null)return{};var h={},m=Object.keys(o),_,w;for(w=0;w<m.length;w++)_=m[w],!(l.indexOf(_)>=0)&&(h[_]=o[_]);return h}function Fxe(o,l){if(o){if(typeof o=="string")return AX(o,l);var h=Object.prototype.toString.call(o).slice(8,-1);if(h==="Object"&&o.constructor&&(h=o.constructor.name),h==="Map"||h==="Set")return Array.from(o);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return AX(o,l)}}function AX(o,l){(l==null||l>o.length)&&(l=o.length);for(var h=0,m=new Array(l);h<l;h++)m[h]=o[h];return m}function PX(o,l){var h;if(typeof Symbol>"u"||o[Symbol.iterator]==null){if(Array.isArray(o)||(h=Fxe(o))||l){h&&(o=h);var m=0;return function(){return m>=o.length?{done:!0}:{done:!1,value:o[m++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return h=o[Symbol.iterator](),h.next.bind(h)}var EM=P(()=>{});function Bxe(o){return typeof o=="function"}var PD,RX,Uxe=P(()=>{PD=K($e()),MX(),EM(),RX=function(o,l,h){h===void 0&&(h=l.children);var m=(0,PD.useContext)(CD);if(m.useCreateElement)return m.useCreateElement(o,l,h);if(typeof o=="string"&&Bxe(h)){l.children;var _=AD(l,["children"]);return h(_)}return(0,PD.createElement)(o,l,h)}});function zxe(o,l,h){return l in o?Object.defineProperty(o,l,{value:h,enumerable:!0,configurable:!0,writable:!0}):o[l]=h,o}function IX(o,l){var h=Object.keys(o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),h.push.apply(h,m)}return h}function Yy(o){for(var l=1;l<arguments.length;l++){var h=arguments[l]!=null?arguments[l]:{};l%2?IX(Object(h),!0).forEach(function(m){zxe(o,m,h[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(h)):IX(Object(h)).forEach(function(m){Object.defineProperty(o,m,Object.getOwnPropertyDescriptor(h,m))})}return o}function Vxe(o,l){if(o==null)return{};var h={},m=Object.keys(o),_,w;for(w=0;w<m.length;w++)_=m[w],!(l.indexOf(_)>=0)&&(h[_]=o[_]);return h}var kX=P(()=>{});function Gxe(o){return typeof o=="object"&&o!=null}var jxe=P(()=>{});function RD(o){var l;if(!Gxe(o))return!1;var h=Object.getPrototypeOf(o);return h==null?!0:((l=h.constructor)===null||l===void 0?void 0:l.toString())===Object.toString()}var NX=P(()=>{jxe()});function DX(o,l){for(var h=Object.keys(o),m={},_={},w=0,C=h;w<C.length;w++){var R=C[w];l.indexOf(R)>=0?m[R]=o[R]:_[R]=o[R]}return[m,_]}function OX(o,l){if(l===void 0&&(l=[]),!RD(o.state))return DX(o,l);var h=DX(o,[].concat(l,["state"])),m=h[0],_=h[1],w=m.state,C=Vxe(m,["state"]);return[Yy(Yy({},w),C),_]}var Hxe=P(()=>{kX(),NX()});function TM(o,l){if(o===l)return!0;if(!o||!l||typeof o!="object"||typeof l!="object")return!1;var h=Object.keys(o),m=Object.keys(l),_=h.length;if(m.length!==_)return!1;for(var w=0,C=h;w<C.length;w++){var R=C[w];if(o[R]!==l[R])return!1}return!0}var ID=P(()=>{});function LX(o){return o.name==="normalizePropsAreEqualInner"?o:function(l,h){return!RD(l.state)||!RD(h.state)?o(l,h):o(Yy(Yy({},l.state),l),Yy(Yy({},h.state),h))}}var Wxe=P(()=>{kX(),NX()});function $xe(o){return(0,kD.forwardRef)(o)}function qxe(o,l){return(0,kD.memo)(o,l)}function hb(o){var l=o.as,h=o.useHook,m=o.memo,_=o.propsAreEqual,w=_===void 0?h==null?void 0:h.unstable_propsAreEqual:_,C=o.keys,R=C===void 0?(h==null?void 0:h.__keys)||[]:C,N=o.useCreateElement,F=N===void 0?RX:N,U=function($,j){var G=$.as,Y=G===void 0?l:G,Z=AD($,["as"]);if(h){var ne,ae=OX(Z,R),ce=ae[0],ve=ae[1],Me=h(ce,Xy({ref:j},ve)),Te=Me.wrapElement,_e=AD(Me,["wrapElement"]),it=((ne=Y.render)===null||ne===void 0?void 0:ne.__keys)||Y.__keys,Re=it&&OX(Z,it)[0],xe=Re?Xy(Xy({},_e),Re):_e,Oe=F(Y,xe);return Te?Te(Oe):Oe}return F(Y,Xy({ref:j},Z))};return U=$xe(U),m&&(U=qxe(U,w&&LX(w))),U.__keys=R,U.unstable_propsAreEqual=LX(w||TM),U}var kD,db=P(()=>{kD=K($e()),EM(),Uxe(),Hxe(),ID(),Wxe()});function FX(o,l){(0,ND.useDebugValue)(o);var h=(0,ND.useContext)(CD);return h[o]!=null?h[o]:l}var ND,BX=P(()=>{ND=K($e()),MX()});function Xxe(o,l,h){l===void 0&&(l={}),h===void 0&&(h={});var m="use"+o+"Props";(0,UX.useDebugValue)(m);var _=FX(m);return _?_(l,h):h}var UX,Yxe=P(()=>{UX=K($e()),BX()});function Kxe(o,l,h){l===void 0&&(l={}),h===void 0&&(h={});var m="use"+o+"Options";(0,zX.useDebugValue)(m);var _=FX(m);return _?Xy(Xy({},l),_(l,h)):l}var zX,Zxe=P(()=>{zX=K($e()),BX(),EM()});function Qxe(o){return Array.isArray(o)?o:typeof o<"u"?[o]:[]}var Jxe=P(()=>{});function fb(o){var l,h,m=Qxe(o.compose),_=function(R,N){if(o.useOptions&&(R=o.useOptions(R,N)),o.name&&(R=Kxe(o.name,R,N)),o.compose)for(var F=PX(m),U;!(U=F()).done;){var $=U.value;R=$.__useOptions(R,N)}return R},w=function(R,N,F){if(R===void 0&&(R={}),N===void 0&&(N={}),F===void 0&&(F=!1),F||(R=_(R,N)),o.useProps&&(N=o.useProps(R,N)),o.name&&(N=Xxe(o.name,R,N)),o.compose)if(o.useComposeOptions&&(R=o.useComposeOptions(R,N)),o.useComposeProps)N=o.useComposeProps(R,N);else for(var U=PX(m),$;!($=U()).done;){var j=$.value;N=j(R,N,!0)}var G={},Y=N||{};for(var Z in Y)Y[Z]!==void 0&&(G[Z]=Y[Z]);return G};w.__useOptions=_;var C=m.reduce(function(R,N){return R.push.apply(R,N.__keys||[]),R},[]);return w.__keys=[].concat(C,((l=o.useState)===null||l===void 0?void 0:l.__keys)||[],o.keys||[]),w.unstable_propsAreEqual=o.propsAreEqual||((h=m[0])===null||h===void 0?void 0:h.unstable_propsAreEqual)||TM,w}var pb=P(()=>{K($e()),Yxe(),EM(),Zxe(),ID(),Jxe()});function VX(o,l){l===void 0&&(l=null),o&&(typeof o=="function"?o(l):o.current=l)}function GX(o,l){return(0,jX.useMemo)(function(){return o==null&&l==null?null:function(h){VX(o,h),VX(l,h)}},[o,l])}var jX,HX=P(()=>{jX=K($e())});function DD(o){if(o.tagName==="BUTTON")return!0;if(o.tagName==="INPUT"){var l=o;return WX.indexOf(l.type)!==-1}return!1}var WX,OD=P(()=>{WX=["button","color","file","image","reset","submit"]}),LD=P(()=>{}),e_e=P(()=>{LD(),K($e())}),MM=P(()=>{LD(),K($e()),e_e()});function t_e(o){return o?o.ownerDocument||o:document}var $X=P(()=>{});function n_e(o){return qX}var qX,r_e=P(()=>{$X();try{qX=window}catch{}});function i_e(){var o=n_e();return!!(typeof o<"u"&&o.document&&o.document.createElement)}var CM,FD=P(()=>{r_e(),CM=i_e()}),BD,UD,zD=P(()=>{BD=K($e()),FD(),UD=CM?BD.useLayoutEffect:BD.useEffect});function Ky(o){var l=(0,XX.useRef)(o);return UD(function(){l.current=o}),l}var XX,YX=P(()=>{XX=K($e()),zD()});function s_e(o){return o.target===o.currentTarget}var o_e=P(()=>{});function a_e(o){var l=t_e(o),h=l.activeElement;return h!=null&&h.nodeName?h:null}var l_e=P(()=>{$X()});function KX(o,l){return o===l||o.contains(l)}var ZX=P(()=>{});function c_e(o){var l=a_e(o);if(!l)return!1;if(KX(o,l))return!0;var h=l.getAttribute("aria-activedescendant");return h?h===o.id?!0:!!o.querySelector("#"+h):!1}var u_e=P(()=>{l_e(),ZX()});function h_e(o){return!KX(o.currentTarget,o.target)}var d_e=P(()=>{ZX()});function AM(o){return CM?window.navigator.userAgent.indexOf(o)!==-1:!1}var f_e=P(()=>{FD()});function p_e(o,l){return"matches"in o?o.matches(l):"msMatchesSelector"in o?o.msMatchesSelector(l):o.webkitMatchesSelector(l)}var m_e=P(()=>{});function g_e(o){var l=o;return l.offsetWidth>0||l.offsetHeight>0||o.getClientRects().length>0}function v_e(o){return p_e(o,QX)&&g_e(o)}var QX,y_e=P(()=>{m_e(),QX="input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), a[href], button:not([disabled]), [tabindex], iframe, object, embed, area[href], audio[controls], video[controls], [contenteditable]:not([contenteditable='false'])"}),JX,PM,eY=P(()=>{ub(),db(),pb(),ID(),JX=["unstable_system"],PM=fb({name:"Role",keys:JX,propsAreEqual:function(o,l){var h=o.unstable_system,m=qy(o,["unstable_system"]),_=l.unstable_system,w=qy(l,["unstable_system"]);return h!==_&&!TM(h,_)?!1:TM(m,w)}}),hb({as:"div",useHook:PM})});function tY(o){!c_e(o)&&v_e(o)&&o.focus()}function x_e(o){return o.tagName==="BUTTON"||o.tagName==="INPUT"||o.tagName==="SELECT"||o.tagName==="TEXTAREA"||o.tagName==="A"}function __e(o){return o.tagName==="BUTTON"||o.tagName==="INPUT"||o.tagName==="SELECT"||o.tagName==="TEXTAREA"}function b_e(o,l,h,m){return o?l&&!h?-1:void 0:l?m:m||0}function VD(o,l){return(0,Zy.useCallback)(function(h){var m;(m=o.current)===null||m===void 0||m.call(o,h),!h.defaultPrevented&&l&&(h.stopPropagation(),h.preventDefault())},[o,l])}var Zy,nY,rY,GD,S_e=P(()=>{ub(),db(),pb(),Zy=K($e()),HX(),OD(),MM(),YX(),zD(),u_e(),d_e(),f_e(),y_e(),eY(),nY=["disabled","focusable"],rY=AM("Mac")&&!AM("Chrome")&&(AM("Safari")||AM("Firefox")),GD=fb({name:"Tabbable",compose:PM,keys:nY,useOptions:function(o,l){var h=l.disabled;return G5({disabled:h},o)},useProps:function(o,l){var h=l.ref,m=l.tabIndex,_=l.onClickCapture,w=l.onMouseDownCapture,C=l.onMouseDown,R=l.onKeyPressCapture,N=l.style,F=qy(l,["ref","tabIndex","onClickCapture","onMouseDownCapture","onMouseDown","onKeyPressCapture","style"]),U=(0,Zy.useRef)(null),$=Ky(_),j=Ky(w),G=Ky(C),Y=Ky(R),Z=!!o.disabled&&!o.focusable,ne=(0,Zy.useState)(!0),ae=ne[0],ce=ne[1],ve=(0,Zy.useState)(!0),Me=ve[0],Te=ve[1],_e=o.disabled?G5({pointerEvents:"none"},N):N;UD(function(){var He=U.current;He&&(x_e(He)||ce(!1),__e(He)||Te(!1))},[]);var it=VD($,o.disabled),Re=VD(j,o.disabled),xe=VD(Y,o.disabled),Oe=(0,Zy.useCallback)(function(He){var Fe;(Fe=G.current)===null||Fe===void 0||Fe.call(G,He);var Nt=He.currentTarget;if(!He.defaultPrevented&&rY&&!h_e(He)&&DD(Nt)){var Ve=requestAnimationFrame(function(){Nt.removeEventListener("mouseup",Ht,!0),tY(Nt)}),Ht=function(){cancelAnimationFrame(Ve),tY(Nt)};Nt.addEventListener("mouseup",Ht,{once:!0,capture:!0})}},[]);return G5({ref:GX(U,h),style:_e,tabIndex:b_e(Z,ae,Me,m),disabled:Z&&Me?!0:void 0,"aria-disabled":o.disabled?!0:void 0,onClickCapture:it,onMouseDownCapture:Re,onMouseDown:Oe,onKeyPressCapture:xe},F)}}),hb({as:"div",useHook:GD})});function w_e(o){var l=o.currentTarget;return o.isTrusted?DD(l)||l.tagName==="INPUT"||l.tagName==="TEXTAREA"||l.tagName==="A"||l.tagName==="SELECT":!1}var RM,iY,jD,E_e=P(()=>{ub(),db(),pb(),RM=K($e()),OD(),MM(),YX(),o_e(),S_e(),iY=["unstable_clickOnEnter","unstable_clickOnSpace"],jD=fb({name:"Clickable",compose:GD,keys:iY,useOptions:function(o){var l=o.unstable_clickOnEnter,h=l===void 0?!0:l,m=o.unstable_clickOnSpace,_=m===void 0?!0:m,w=qy(o,["unstable_clickOnEnter","unstable_clickOnSpace"]);return G5({unstable_clickOnEnter:h,unstable_clickOnSpace:_},w)},useProps:function(o,l){var h=l.onKeyDown,m=l.onKeyUp,_=qy(l,["onKeyDown","onKeyUp"]),w=(0,RM.useState)(!1),C=w[0],R=w[1],N=Ky(h),F=Ky(m),U=(0,RM.useCallback)(function(j){var G;if((G=N.current)===null||G===void 0||G.call(N,j),!j.defaultPrevented&&!o.disabled&&!j.metaKey&&s_e(j)){var Y=o.unstable_clickOnEnter&&j.key==="Enter",Z=o.unstable_clickOnSpace&&j.key===" ";if(Y||Z){if(w_e(j))return;j.preventDefault(),Y?j.currentTarget.click():Z&&R(!0)}}},[o.disabled,o.unstable_clickOnEnter,o.unstable_clickOnSpace]),$=(0,RM.useCallback)(function(j){var G;if((G=F.current)===null||G===void 0||G.call(F,j),!j.defaultPrevented&&!o.disabled&&!j.metaKey){var Y=o.unstable_clickOnSpace&&j.key===" ";C&&Y&&(R(!1),j.currentTarget.click())}},[o.disabled,o.unstable_clickOnSpace,C]);return G5({"data-active":C||void 0,onKeyDown:U,onKeyUp:$},_)}}),hb({as:"button",memo:!0,useHook:jD})}),mb,sY,oY,aY,T_e=P(()=>{ub(),db(),pb(),mb=K($e()),HX(),OD(),MM(),E_e(),sY=[],oY=fb({name:"Button",compose:jD,keys:sY,useProps:function(o,l){var h=l.ref,m=qy(l,["ref"]),_=(0,mb.useRef)(null),w=(0,mb.useState)(void 0),C=w[0],R=w[1],N=(0,mb.useState)("button"),F=N[0],U=N[1];return(0,mb.useEffect)(function(){var $=_.current;$&&(DD($)||($.tagName!=="A"&&R("button"),U(void 0)))},[]),G5({ref:GX(_,h),role:C,type:F},m)}}),aY=hb({as:"button",memo:!0,useHook:oY})}),lY,cY,uY,M_e=P(()=>{ub(),db(),pb(),eY(),lY=[],cY=fb({name:"Group",compose:PM,keys:lY,useProps:function(o,l){return G5({role:"group"},l)}}),uY=hb({as:"div",useHook:cY})});function C_e(){return CM?document.body:null}var hY,Qy,A_e=P(()=>{hY=K($e()),zD(),FD(),K(Gm()),Qy=(0,hY.createContext)(C_e())}),HD,P_e=P(()=>{typeof window<"u"&&(HD={get passive(){}},window.addEventListener("testPassive",null,HD),window.removeEventListener("testPassive",null,HD))}),j5=P(()=>{K($e()),MM(),T_e(),M_e(),K(Gm()),A_e(),P_e(),LD()});function ui(o){let l=(0,WD.useMemo)(()=>{let _=o;return{get current(){return _},set current(w){_=w,m(w)}}},[]),[h,m]=(0,WD.useState)(()=>o);return[l,h]}var WD,zi=P(()=>{WD=K($e())});function R_e(o){return l=>Y0.default.createElement(vY,null,Y0.default.createElement(o,A({},l)))}var Y0,dY,fY,Ni,Jy,pY,mY,gY,$D,qD,vY,$i=P(()=>{Hd(),Xt(),Xt(),Y0=K($e()),dY=K(Gm()),j5(),zi(),Ni=Iu(fY||(fY=q([`
  #pointer-root & {
    pointer-events: none;
  }
  #pointer-root.normal & {
    pointer-events: auto;
  }
`]))),Jy={panel:{bg:"#282b2f",head:{title:{color:"#bbb"},punctuation:{color:"#808080"}},body:{compoudThing:{label:{get color(){return $y(.6,Jy.panel.bg)}}}}}},mY=typeof window<"u"?Aq(pY||(pY=q([`
  :host {
    all: initial;
    color: white;
    font: 11px -apple-system, BlinkMacSystemFont, Segoe WPC, Segoe Editor,
      HelveticaNeue-Light, Ubuntu, Droid Sans, sans-serif;
  }

  * {
    padding: 0;
    margin: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    list-style: none;
  }
`]))):{},$D=me.div(gY||(gY=q([`
  z-index: 51;
  position: fixed;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  pointer-events: none;
`]))),qD=o=>Y0.default.createElement(Eq,{disableVendorPrefixes:!0,target:o.target},Y0.default.createElement(Y0.default.Fragment,null,Y0.default.createElement(mY,null),o.children)),vY=o=>{let[l,h]=(0,Y0.useState)(null),[m,_]=(0,Y0.useState)(null);(0,Y0.useLayoutEffect)(()=>{if(!l)return;let{parentNode:R}=l;if(!R)return;let N=R.shadowRoot?parent.shadowRoot:R.attachShadow({mode:"open"});_(N)},[l]);let[w,C]=ui(void 0);return m?dY.default.createPortal(Y0.default.createElement(qD,{target:m},Y0.default.createElement(Y0.default.Fragment,null,Y0.default.createElement($D,{ref:w}),Y0.default.createElement(Qy.Provider,{value:C},o.children))),m):Y0.default.createElement("template",{ref:h,"shadow-root":"open"},o.children)}}),H5,yY,xY,XD,_Y,IM,bY,SY,wY,EY,kM,Vp,M9=P(()=>{$i(),Xt(),H5={get outlinePanel(){return 1},get propsPanel(){return H5.outlinePanel},get sequenceEditorPanel(){return this.outlinePanel-1},get toolbar(){return this.outlinePanel+1},get pluginPanes(){return this.sequenceEditorPanel-1}},yY=Jy.panel.bg,XD=me.span(xY||(xY=q([`
  white-space: nowrap;
`]))),IM=me.span(_Y||(_Y=q([`
  white-space: nowrap;
  color: `,`;
`])),Jy.panel.head.punctuation.color),SY=me.div(bY||(bY=q([`
  background: `,`;
  flex-grow: 1;
  overflow-y: scroll;
  padding: 0;
`])),yY),wY=18,kM=me.div(EY||(EY=q([`
  height: `,`px;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  padding: 0 10px;
  position: relative;
  color: #adadadb3;
  border-bottom: 1px solid rgb(0 0 0 / 13%);
  background-color: #25272b;
  font-size: 10px;
  font-weight: 500;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
`])),wY),Vp=100}),TY,Wd,e6=P(()=>{TY=()=>{},Wd=TY});function I_e(o){return YD.createElement("svg",A({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),YD.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.775 2.781a.5.5 0 01.5.5v1.7H4.67c.108-.957.92-1.7 1.905-1.7h6.608a1.917 1.917 0 110 3.834H6.574c-.78 0-1.452-.466-1.751-1.135H2.275v5.03h2.39a2.032 2.032 0 012.023-1.854h6.38a2.031 2.031 0 110 4.063h-6.38c-.83 0-1.543-.497-1.858-1.21H1.775a.5.5 0 01-.5-.5V3.281a.5.5 0 01.5-.5zm4.799 1.5h6.608a.917.917 0 110 1.834H6.574a.917.917 0 110-1.834zm.114 5.875h6.38a1.031 1.031 0 110 2.063h-6.38a1.032 1.032 0 110-2.063z",fill:"currentColor"}))}var YD,MY,k_e=P(()=>{YD=K($e()),MY=I_e});function N_e(o){return KD.createElement("svg",A({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),KD.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 10.5L4 6.654 5.2 5.5 8 8.385 10.8 5.5 12 6.654 8 10.5z",fill:"currentColor"}))}var KD,CY,D_e=P(()=>{KD=K($e()),CY=N_e});function O_e(o){return ZD.createElement("svg",A({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),ZD.createElement("path",{d:"M8.339 4.5l-2.055.644 4.451 1.393v2.748l-2.966.928-2.504-.783V6.738l2.42.758 2.055-.644-4.458-1.395L4 5.858v4.463L7.768 11.5 12 10.175V5.646L8.339 4.5z",fill:"currentColor"}))}var ZD,QD,L_e=P(()=>{ZD=K($e()),QD=O_e});function F_e(o){return JD.createElement("svg",A({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),JD.createElement("path",{d:"M6.8 11.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6zm6-7.2h-2.4v-.6A1.8 1.8 0 008.6 2H7.4a1.8 1.8 0 00-1.8 1.8v.6H3.2a.6.6 0 100 1.2h.6v6.6A1.8 1.8 0 005.6 14h4.8a1.8 1.8 0 001.8-1.8V5.6h.6a.6.6 0 100-1.2zm-6-.6a.6.6 0 01.6-.6h1.2a.6.6 0 01.6.6v.6H6.8v-.6zm4.2 8.4a.6.6 0 01-.6.6H5.6a.6.6 0 01-.6-.6V5.6h6v6.6zm-1.8-.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6z",fill:"currentColor"}))}var JD,eO,B_e=P(()=>{JD=K($e()),eO=F_e}),NM=P(()=>{k_e(),D_e(),L_e(),B_e()}),Gp,AY,DM,PY,RY,IY,kY,NY,DY,OY,LY,FY,BY,UY,zY,VY,GY,jY,tO,HY=P(()=>{Gp=K($e()),Xt(),e6(),$i(),NM(),DM=me.li(AY||(AY=q([`
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  justify-content: flex-start;
  flex-direction: column;
  align-items: flex-start;
`]))),RY=me.div(PY||(PY=q([""]))),kY=me(RY)(IY||(IY=q([`
  position: relative;
  margin-top: 2px;
  margin-bottom: 2px;
  margin-left: calc(4px + var(--depth) * 16px);
  padding-left: 4px;
  padding-right: 8px;
  gap: 4px;
  height: 21px;
  line-height: 0;
  box-sizing: border-box;
  display: flex;
  flex-wrap: nowrap;
  align-items: center;
  pointer-events: none;
  white-space: nowrap;

  border-radius: 2px;
  box-shadow: 0 3px 4px -1px rgba(0, 0, 0, 0.48);

  color: rgba(255, 255, 255, 0.9);
  background: rgba(40, 43, 47, 0.65);
  backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);

  &.descendant-is-selected {
    background: rgba(29, 53, 59, 0.7);
  }

  `,`;
  &:not(.not-selectable):not(.selected):hover {
    background: rgba(59, 63, 69, 0.9);

    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &:not(.not-selectable):not(.selected):active {
    background: rgba(82, 88, 96, 0.9);
    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &.selected {
    background: rgba(30, 88, 102, 0.7);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Ni),DY=Iu(NY||(NY=q([`
  font-weight: 500;
  font-size: 11px;
  & {
  }
`]))),LY=me.span(OY||(OY=q([`
  `,`;

  `,`;
  position: relative;
  // Compensate for border bottom
  top: 0.5px;
  display: flex;
  height: 20px;
  align-items: center;
  box-sizing: border-box;
`])),DY,Ni),BY=me.div(FY||(FY=q([`
  font-weight: 500;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  opacity: 0.99;
`]))),zY=me.span(UY||(UY=q([`
  font-size: 9px;
  position: relative;
  display: block;
  transition: transform 0.1s ease-out;

  &:hover {
    transform: rotate(-20deg);
  }

  `,`.collapsed & {
    transform: rotate(-90deg);

    &:hover {
      transform: rotate(-70deg);
    }
  }
`])),DM),GY=me.ul(VY||(VY=q([`
  margin: 0;
  padding: 0;
  list-style: none;

  `,`.collapsed & {
    display: none;
  }
`])),DM),jY=({label:o,children:l,depth:h,select:m,selectionStatus:_,labelDecoration:w,collapsed:C=!1,setIsCollapsed:R,draggable:N,onDragStart:F,onDragEnd:U})=>{let $=l!==void 0;return Gp.default.createElement(DM,{style:{"--depth":h},className:C?"collapsed":""},Gp.default.createElement(kY,{className:_,onClick:m??Wd,"data-header":!0,draggable:N,onDragStart:F,onDragEnd:U},Gp.default.createElement(BY,null,$?Gp.default.createElement(zY,{onClick:j=>{j.stopPropagation(),j.preventDefault(),R==null||R(!C)}},Gp.default.createElement(CY,null)):Gp.default.createElement(QD,null)),Gp.default.createElement(LY,null,Gp.default.createElement("span",null,o)),w),$&&Gp.default.createElement(GY,null,l))},tO=jY});function U_e(o){return Object.keys(o)}function z_e(o){return Object.keys((0,jp.val)(o.sheetTemplatesP))}function V_e(){let o=Ds(Dh().filter(l=>Pe(l)||Bt(l)).map(l=>Bt(l)?l.sheet:l))[0];if(o)return o.getSequence()}var jp,Dh,WY,t6=P(()=>{jp=rn(),hn(),m0(),Se(),Dh=()=>{var o;let l=(0,jp.val)(de().projectsP),h=((o=(0,jp.val)(de().atomP.historic.panels.outlinePanel.selection))!=null?o:[]).map(m=>{let _=l[m.projectId];if(!_)return;if(m.type==="Project")return _;if(!(0,jp.val)(_.sheetTemplatesP[m.sheetId]))return;let w=WY(_,m.sheetId);if(!w)return;if(m.type==="Sheet")return w;let C=(0,jp.val)(w.objectsP[m.objectKey]);if(C)return C});return Ds(h.filter(m=>typeof m<"u"))},WY=(o,l)=>{let h=de().atomP.historic.projects.stateByProjectId[o.address.projectId],m=(0,jp.val)(h.stateBySheetId[l].selectedInstanceId),_=(0,jp.val)(o.sheetTemplatesP[l]);if(_){if(m)return(0,jp.val)(_.instancesP[m]);{let w=(0,jp.val)(_.instancesP);return w[U_e(w)[0]]}}}}),gb,$Y,G_e=P(()=>{Se(),t6(),ur(),gb=K($e()),HY(),$Y=({sheet:o,depth:l})=>{let h=(0,gb.useCallback)(()=>{de().transaction(({stateEditors:w})=>{w.studio.historic.panels.outline.selection.set([o])})},[o]),m=(0,gb.useCallback)(w=>{let C={type:"theatre-sheet",projectId:o.address.projectId,sheetId:o.address.sheetId,sheetInstanceId:o.address.sheetInstanceId};w.dataTransfer.setData("application/json",JSON.stringify(C)),w.dataTransfer.effectAllowed="copy",document.body.classList.add("dragging-sheet")},[o]),_=(0,gb.useCallback)(()=>{document.body.classList.remove("dragging-sheet")},[]);return jr(()=>{let w=Dh();return gb.default.createElement(tO,{depth:l,select:h,selectionStatus:w.some(C=>C===o)?"selected":w.some(C=>C.type==="Theatre_SheetObject"&&C.sheet===o)?"descendant-is-selected":"not-selected",label:"".concat(o.address.sheetId,": ").concat(o.address.sheetInstanceId),draggable:!0,onDragStart:m,onDragEnd:_})},[l,m,_])}}),nO,n6,qY,XY,YY,KY,j_e=P(()=>{ur(),nO=rn(),n6=K($e()),Xt(),G_e(),me.div(qY||(qY=q([`
  display: flex;
`]))),me.li(XY||(XY=q([`
  color: `,`;
`])),o=>o.isSelected?"white":"hsl(1, 1%, 80%)"),me.div(YY||(YY=q([""]))),KY=({sheetId:o,depth:l,project:h})=>jr(()=>{let m=(0,nO.val)(h.sheetTemplatesP[o]);if(!m)return n6.default.createElement(n6.default.Fragment,null);let _=(0,nO.val)(m.instancesP);return n6.default.createElement(n6.default.Fragment,null,Object.entries(_).map(([w,C])=>n6.default.createElement($Y,{key:C.address.sheetInstanceId,sheet:C,depth:l})))},[l,o,h])}),OM,ZY,QY,H_e=P(()=>{t6(),ur(),OM=K($e()),j_e(),ZY=({project:o,depth:l})=>jr(()=>{if(!o)return null;let h=z_e(o);return OM.default.createElement(OM.default.Fragment,null,h.map(m=>OM.default.createElement(KY,{depth:l,sheetId:m,key:"sheet-".concat(m),project:o})))},[o,l]),QY=ZY});function W_e(o){var l;let h=o.type==="namespace"?"namespace:".concat(o.sheet.address.sheetId,":").concat(o.path.join("/")):o.type==="Theatre_Project"?"project":o.type==="Theatre_Sheet"?"sheetInstance:".concat(o.address.sheetId,":").concat(o.address.sheetInstanceId):"unknown",m=o.type==="namespace"?o.sheet.address.projectId:o.address.projectId,_=(l=Rr(de().atomP.ahistoric.projects.stateByProjectId[m].collapsedItemsInOutline[h]))!=null?l:!1,w=(0,JY.useCallback)(C=>{de().transaction(({stateEditors:R})=>{R.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline.set({projectId:m,isCollapsed:C,itemKey:h})})},[h]);return{collapsed:_,setCollapsed:w}}var JY,$_e=P(()=>{JY=K($e()),Se(),ur()}),vb,eK,tK,nK,rK,iK,q_e=P(()=>{vb=K($e()),HY(),H_e(),Se(),ur(),t6(),eK=rn(),Xt(),$_e(),nK=me.div(tK||(tK=q([`
  color: #ff6363;
  margin-left: 11px;
  background: #4c282d;
  padding: 2px 8px;
  border-radius: 2px;
  font-size: 10px;
  box-shadow: 0 2px 8px -4px black;
`]))),rK=({depth:o,project:l})=>{let h=jr(()=>Dh(),[]),m=jr(()=>{let R=l.address.projectId,N=(0,eK.val)(de().atomP.ephemeral.coreByProject[R].loadingState);return(N==null?void 0:N.type)==="browserStateIsNotBasedOnDiskState"},[l]),_=(0,vb.useCallback)(()=>{de().transaction(({stateEditors:R})=>{R.studio.historic.panels.outline.selection.set([l])})},[l]),{collapsed:w,setCollapsed:C}=W_e(l);return vb.default.createElement(tO,{depth:o,label:l.address.projectId,setIsCollapsed:C,collapsed:w,labelDecoration:m?vb.default.createElement(nK,null,"Has Conflicts"):null,children:vb.default.createElement(QY,{project:l,depth:o+1}),selectionStatus:h.includes(l)?"selected":h.some(R=>R.address.projectId===l.address.projectId)?"descendant-is-selected":"not-selected",select:_})},iK=rK}),sK,rO,oK,aK,lK,cK,X_e=P(()=>{sK=rn(),ur(),Se(),rO=K($e()),Xt(),q_e(),aK=me.ul(oK||(oK=q([`
  list-style: none;
  margin: 0;
  padding: 0;
  padding-right: 4px;
`]))),lK=o=>jr(()=>{let l=(0,sK.val)(de().projectsP);return rO.default.createElement(aK,null,Object.keys(l).map(h=>{let m=l[h];return rO.default.createElement(iK,{depth:0,project:m,key:"projectListItem-".concat(h)})}))},[]),cK=lK});function Y_e(o){let[l,h]=(0,iO.useState)(!1);return(0,iO.useEffect)(()=>{let m=w=>{let C=l?200:50,R=56,N=w.x<C;N&&(N=w.y>R),h(!!N)};document.addEventListener("mousemove",m);let _=()=>{h(!1)};return document.addEventListener("mouseleave",_),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseleave",_)}},[l]),l}var iO,K_e=P(()=>{iO=K($e())}),yb,r6,sO,uK,hK,dK,fK,LM,xb,pK,Z_e=P(()=>{yb=K($e()),Xt(),M9(),X_e(),ur(),Se(),K_e(),r6=rn(),$i(),sO="44px",hK=me.div(uK||(uK=q([`
  `,`;
  background-color: transparent;
  position: absolute;
  left: 8px;
  z-index: `,`;

  top: calc(`,` + 8px);
  height: fit-content;
  max-height: calc(100% - `,`);
  overflow-y: scroll;
  overflow-x: hidden;
  padding: 0;
  user-select: none;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;

  display: `,`;

  &:hover {
    display: block;
  }

  // Create a small buffer on the bottom to aid selecting the bottom item in a long, scrolling list
  &::after {
    content: '';
    display: block;
    height: 20px;
  }
`])),Ni,H5.outlinePanel,sO,sO,({pin:o})=>o?"block":"none"),dK=()=>{var o;let l=(o=Rr(de().atomP.ahistoric.pinOutline))!=null?o:!0,h=Rr(pK),m=Y_e();return(0,yb.useLayoutEffect)(()=>{LM.set(m)},[m]),(0,yb.useEffect)(()=>()=>{xb.set(!1),LM.set(!1)},[]),yb.default.createElement(hK,{pin:l||h,onMouseEnter:()=>{xb.set(!0)},onMouseLeave:()=>{xb.set(!1)}},yb.default.createElement(cK,null))},fK=dK,LM=new r6.Atom(!1),xb=new r6.Atom(!1),pK=(0,r6.prism)(()=>{let o=(0,r6.val)(xb.prism),l=(0,r6.val)(LM.prism);return o||l})});function Q_e(){let[o,l]=(0,oO.useState)(!1),h=(0,oO.useMemo)(()=>{let m=new Set;return()=>{let _=()=>{m.delete(_),l(m.size>0)};return m.add(_),l(!0),_}},[]);return[o,h]}var oO,J_e=P(()=>{oO=K($e())}),mK,gK,vK,ebe=P(()=>{mK=K($e()),gK=function(o){(0,mK.useEffect)(o,[])},vK=gK}),yK,xK,_K,tbe=P(()=>{yK=K($e()),ebe(),xK=function(o){var l=(0,yK.useRef)(o);l.current=o,vK(function(){return function(){return l.current()}})},_K=xK}),FM,bK,SK,nbe=P(()=>{FM=K($e()),tbe(),bK=function(o){var l=(0,FM.useRef)(0),h=(0,FM.useState)(o),m=h[0],_=h[1],w=(0,FM.useCallback)(function(C){cancelAnimationFrame(l.current),l.current=requestAnimationFrame(function(){_(C)})},[]);return _K(function(){cancelAnimationFrame(l.current)}),[m,w]},SK=bK});function rbe(o){for(var l=[],h=1;h<arguments.length;h++)l[h-1]=arguments[h];o&&o.addEventListener&&o.addEventListener.apply(o,l)}function ibe(o){for(var l=[],h=1;h<arguments.length;h++)l[h-1]=arguments[h];o&&o.removeEventListener&&o.removeEventListener.apply(o,l)}var BM,sbe=P(()=>{BM=typeof window<"u"}),wK,EK,UM,aO=P(()=>{wK=K($e()),nbe(),sbe(),EK=function(o,l){o===void 0&&(o=1/0),l===void 0&&(l=1/0);var h=SK({width:BM?window.innerWidth:o,height:BM?window.innerHeight:l}),m=h[0],_=h[1];return(0,wK.useEffect)(function(){if(BM){var w=function(){_({width:window.innerWidth,height:window.innerHeight})};return rbe(window,"resize",w),function(){ibe(window,"resize",w)}}},[]),m},UM=EK}),lO,zM,VM,cO,i6,TK,uO,s6=P(()=>{lO=rn(),ur(),Se(),J_e(),zM=K($e()),aO(),VM=(o,l)=>{let h=o.left/l.width,m=(o.left+o.width)/l.width,_=o.top/l.height,w=(o.height+o.top)/l.height;return{edges:{left:h<=.5?{from:"screenLeft",distance:h}:{from:"screenRight",distance:1-h},right:m<=.5?{from:"screenLeft",distance:m}:{from:"screenRight",distance:1-m},top:_<=.5?{from:"screenTop",distance:_}:{from:"screenBottom",distance:1-_},bottom:w<=.5?{from:"screenTop",distance:w}:{from:"screenBottom",distance:1-w}}}},cO=zM.default.createContext(null),i6=()=>(0,zM.useContext)(cO),TK=({panelId:o,children:l,defaultPosition:h,minDims:m})=>{let _=UM(800,200),[w,C]=Q_e(),{stuff:R}=jr(()=>{var N;let{edges:F}=(N=(0,lO.val)(de().atomP.historic.panelPositions[o]))!=null?N:h,U=Math.floor(_.width*(F.left.from==="screenLeft"?F.left.distance:1-F.left.distance)),$=Math.floor(_.width*(F.right.from==="screenLeft"?F.right.distance:1-F.right.distance)),j=Math.floor(_.height*(F.top.from==="screenTop"?F.top.distance:1-F.top.distance)),G=Math.floor(_.height*(F.bottom.from==="screenTop"?F.bottom.distance:1-F.bottom.distance)),Y=Math.max($-U,m.width),Z=Math.max(G-j,m.height);return{stuff:{dims:lO.prism.memo("dims",()=>({width:Y,left:U,top:j,height:Z}),[Y,U,j,Z]),panelId:o,minDims:m,boundsHighlighted:w,addBoundsHighlightLock:C}}},[o,_,w,C]);return zM.default.createElement(cO.Provider,{value:R},l)},uO=TK}),$m,MK,$d,CK,AK,PK,RK,hO,IK,kc,kK,K0=P(()=>{$m=K($e()),Xt(),MK="pointer-root",$d="--lockedCursor",AK=me.div(CK||(CK=q([`
  pointer-events: auto;
  &.normal {
    pointer-events: none;
  }
`]))),RK=me.div(PK||(PK=q([`
  position: absolute;
  inset: 0;
  pointer-events: none;

  #pointer-root:not(.normal) > & {
    pointer-events: auto;
  }
`]))),hO=(0,$m.createContext)({}),IK=o=>{var l,h,m,_;let[w,C]=(0,$m.useState)([]),R=(0,$m.useMemo)(()=>({getLock:(F,U)=>{let $={className:F,cursor:U};return C(j=>[...j,$]),()=>{C(j=>j.filter(G=>G!==$))}}}),[]),N=(h=(l=w[0])==null?void 0:l.cursor)!=null?h:"";return $m.default.createElement(hO.Provider,{value:R},$m.default.createElement(AK,{id:MK,className:((_=(m=w[0])==null?void 0:m.className)!=null?_:"normal")+" "+o.className},$m.default.createElement(RK,{style:{cursor:N,[$d]:N}},o.children)))},kc=(o,l,h)=>{let m=(0,$m.useContext)(hO);(0,$m.useLayoutEffect)(()=>{if(o)return m.getLock(l,h)},[o,l,h])},kK=IK});function NK(o){return _b.default.createElement(dO.Provider,{value:o.logger},o.children)}function o6(o,l){let h=(0,_b.useContext)(dO);return(0,_b.useMemo)(()=>o?h.named(o,l):h,[h,o,l])}var _b,dO,W5=P(()=>{_b=K($e()),dO=_b.default.createContext(null)});function obe(){let o=o6("PointerCapturing"),l=qd.default.useRef(null),h=()=>l.current!=null;return m=>{let _,w=C=>(_=C,l.current=C,C);return{capturing:{capturePointer(C){if(o._debug("Capturing pointer",{forDebugName:m,reason:C}),l.current!=null)throw new Error('"'.concat(m,'" attempted capturing pointer for "').concat(C,'" while already captured by "').concat(l.current.debugOwnerName,'" for "').concat(l.current.debugReason,'"'));let R=w({debugOwnerName:m,debugReason:C});return{isCapturing(){return R===l.current},release(){return R===l.current?(o._debug("Releasing pointer",{forDebugName:m,reason:C}),w(null),!0):!1}}},isPointerBeingCaptured:h},forceRelease(){_&&l.current===_&&(o._debug("Force releasing pointer",{localCapture:_}),w(null))}}}}function abe(o){let l=obe();return qd.default.createElement(fO.Provider,{value:l},qd.default.createElement(OK,{children:o.children}))}function DK(o){let l=(0,qd.useContext)(fO),h=(0,qd.useMemo)(()=>l(o),[o,l]);return(0,qd.useEffect)(()=>()=>{h.forceRelease()},[h]),h.capturing}var qd,fO,OK,pO=P(()=>{qd=K($e()),W5(),fO=qd.default.createContext(null),OK=qd.default.memo(({children:o})=>qd.default.createElement(qd.default.Fragment,null,o))}),mO,lbe=P(()=>{mO=typeof window<"u"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)});function Hs(o,l){let h=(0,a6.useRef)(l);h.current=l;let m=l.shouldPointerLock&&!mO,_=(0,a6.useRef)({domDragStarted:!1}),{capturePointer:w}=DK("useDrag for ".concat(l.debugName)),C=(0,a6.useRef)({onDrag:Wd,onDragEnd:Wd,onClick:Wd}),R=(0,a6.useRef)(),[N,F]=ui(!1);return(0,a6.useLayoutEffect)(()=>{if(!o)return;let U=()=>{let ce=_.current.domDragStarted&&_.current.detection.detected;N.current!==ce&&(N.current=ce)},$=ce=>{if(!_.current.domDragStarted)return;let ve=_.current;if(!cbe(ce,ve)&&(ve.detection.detected||(ve.detection.totalDistanceMoved+=Math.abs(ce.movementY)+Math.abs(ce.movementX),ve.detection.totalDistanceMoved>LK&&(m&&o.requestPointerLock(),ve.detection={detected:!0,dragMovement:{x:0,y:0},dragEventCount:0},U())),ve.detection.detected)){ve.detection.dragEventCount+=1;let{dragMovement:Me}=ve.detection;if(m)Me.x+=ce.movementX,Me.y+=ce.movementY;else{let{startPos:Te}=ve;Me.x=ce.screenX-Te.x,Me.y=ce.screenY-Te.y}C.current.onDrag(Me.x,Me.y,ce,ce.movementX,ce.movementY)}},j=ce=>{if(Y(),!_.current.domDragStarted)return;let ve=_.current.detection.detected;_.current={domDragStarted:!1},l.shouldPointerLock&&!mO&&document.exitPointerLock(),C.current.onDragEnd(ve),window.focus(),ve||C.current.onClick(ce),U()},G=()=>{document.addEventListener("mousemove",$),document.addEventListener("mouseup",j)},Y=()=>{var ce;(ce=R.current)==null||ce.release(),document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",j)},Z=ce=>{h.current.disabled||_.current.domDragStarted&&_.current.detection.detected&&(h.current.dontBlockMouseDown||(ce.stopPropagation(),ce.preventDefault()),_.current.detection={detected:!1,totalDistanceMoved:0},U())},ne=ce=>{var ve,Me,Te,_e;(ve=R.current)==null||ve.release();let it=h.current;if(it.disabled===!0||!((Me=it.buttons)!=null?Me:[0]).includes(ce.button))return;let Re=it.onDragStart(ce);Re!==!1&&(C.current.onDrag=Re.onDrag,C.current.onDragEnd=(Te=Re.onDragEnd)!=null?Te:Wd,C.current.onClick=(_e=Re.onClick)!=null?_e:Wd,R.current=w("Drag start"),it.dontBlockMouseDown||(ce.stopPropagation(),ce.preventDefault()),_.current={domDragStarted:!0,startPos:{x:ce.screenX,y:ce.screenY},detection:{detected:!1,totalDistanceMoved:0}},U(),G())},ae=ce=>{ne(ce)};return o.addEventListener("mousedown",ae),o.addEventListener("click",Z),()=>{var ce,ve;Y(),o.removeEventListener("mousedown",ae),o.removeEventListener("click",Z),_.current.domDragStarted&&((ve=(ce=C.current).onDragEnd)==null||ve.call(ce,_.current.detection.detected)),_.current={domDragStarted:!1},U()}},[o]),kc(F&&!!l.lockCSSCursorTo,"dragging",l.lockCSSCursorTo),[F]}function cbe(o,l){return(!l.detection.detected||l.detection.detected&&l.detection.dragEventCount<3)&&(Math.abs(o.movementX)>gO||Math.abs(o.movementY)>gO)}var a6,LK,gO,Oo=P(()=>{a6=K($e()),K0(),pO(),e6(),lbe(),zi(),LK=3,gO=100}),bb,FK,BK,UK,vO,zK=P(()=>{zi(),Se(),Oo(),bb=K($e()),Xt(),s6(),K0(),m0(),M9(),BK=me.div(FK||(FK=q([`
  cursor: move;
`]))),UK=o=>{let l=i6(),h=(0,bb.useRef)(l);h.current=l;let[m,_]=ui(null),w=(0,bb.useMemo)(()=>({debugName:"PanelDragZone",lockCursorTo:"move",onDragStart(){let F=h.current,U,$=l.addBoundsHighlightLock(),j=F.panelId;if(j.startsWith("pane-")){let G=j.slice(5);de().paneManager.bringPaneToFront(G)}return{onDrag(G,Y){let Z=V(A({},F.dims),{top:Bi(F.dims.top+Y,0,window.innerHeight-Vp),left:Bi(F.dims.left+G,-F.dims.width+Vp,window.innerWidth-Vp)}),ne=VM(Z,{width:window.innerWidth,height:window.innerHeight});U==null||U.discard(),U=de().tempTransaction(({stateEditors:ae})=>{ae.studio.historic.panelPositions.setPanelPosition({position:ne,panelId:F.panelId})})},onDragEnd(G){$(),G?U==null||U.commit():U==null||U.discard()}}}}),[]),[C]=Hs(_,w);kc(C,"dragging","move");let[R,N]=(0,bb.useMemo)(()=>{let F;return[function(){if(F){let U=F;F=void 0,U()}F=l.addBoundsHighlightLock()},function(){if(F){let U=F;F=void 0,U()}}]},[]);return bb.default.createElement(BK,V(A({},o),{ref:m,onMouseEnter:R,onMouseLeave:N}))},vO=UK}),Sb,yO,VK,xO,GK,_O,jK,bO,HK,WK,$K,qK,XK,SO,YK,KK,ZK,QK,JK,wb,eZ,tZ,nZ,rZ,iZ,sZ,oZ,aZ,lZ,wO,cZ,qm,ube=P(()=>{zi(),Se(),Oo(),Hd(),Sb=K($e()),Xt(),s6(),$i(),m0(),M9(),yO=rn(),xO=me.div(VK||(VK=q([`
  position: absolute;
  `,`;
  &:after {
    position: absolute;
    inset: -5px;
    display: block;
    content: ' ';
  }

  opacity: 0;
  background-color: #478698;

  &.isHighlighted {
    opacity: 0.7;
  }

  &.isDragging {
    opacity: 1;
    /* background-color: `,`; */
  }

  &:hover {
    opacity: 1;
  }
`])),Ni,$y(.2,"#478698")),_O=me(xO)(GK||(GK=q([`
  /**
  The horizintal/vertical resize handles have z-index:-1 and are offset 1px outside of the panel
  to make sure they don't occlude any element that pops out of the panel (like the Playhead in SequenceEditorPanel).

  This means that panels will always need an extra 1px margin for their resize handles to be visible, but that's not a problem
  that we have to deal with right now (if it is at all a problem).
  
   */
  z-index: -1;
`]))),bO=me(_O)(jK||(jK=q([`
  left: 0px;
  right: 0px;
  height: 1px;
`]))),WK=me(bO)(HK||(HK=q([`
  top: -1px;
`]))),qK=me(bO)($K||($K=q([`
  bottom: -1px;
`]))),SO=me(_O)(XK||(XK=q([`
  z-index: -1;
  top: -1px;
  bottom: -1px;
  width: 1px;
`]))),KK=me(SO)(YK||(YK=q([`
  left: -1px;
`]))),QK=me(SO)(ZK||(ZK=q([`
  right: -1px;
`]))),wb=me(xO)(JK||(JK=q([`
  // The angles have z-index: 10 to make sure they _do_ occlude other elements in the panel.
  z-index: 10;
  width: 8px;
  height: 8px;
`]))),tZ=me(wb)(eZ||(eZ=q([`
  top: 0;
  left: 0;
`]))),rZ=me(wb)(nZ||(nZ=q([`
  top: 0;
  right: 0;
`]))),sZ=me(wb)(iZ||(iZ=q([`
  bottom: 0;
  left: 0;
`]))),aZ=me(wb)(oZ||(oZ=q([`
  bottom: 0;
  right: 0;
`]))),lZ={Top:WK,TopLeft:tZ,TopRight:rZ,Bottom:qK,BottomLeft:sZ,BottomRight:aZ,Left:KK,Right:QK},wO={Top:"ns-resize",Bottom:"ns-resize",Left:"ew-resize",Right:"ew-resize",TopLeft:"nw-resize",TopRight:"ne-resize",BottomLeft:"sw-resize",BottomRight:"se-resize"},cZ=({which:o})=>{let l=i6(),h=(0,Sb.useRef)(l);h.current=l;let m=(0,Sb.useRef)(0),[_,w]=ui(null),C=(0,Sb.useMemo)(()=>({debugName:"PanelResizeHandle",lockCursorTo:wO[o],onDragStart(){var U;let $,j=h.current,G=l.addBoundsHighlightLock();return m.current=(U=(0,yO.val)(de().atomP.historic.panels.sequenceEditor.dopesheetLeftWidth))!=null?U:225,{onDrag(Y,Z){var ne;let ae=(ne=(0,yO.val)(de().atomP.historic.panels.sequenceEditor.rightPanelOpen))!=null?ne:!0,ce=A({},j.dims);if(o.startsWith("Bottom"))ce.height=Math.max(ce.height+Z,j.minDims.height);else if(o.startsWith("Top")){let Me=ce.top+ce.height,Te=Bi(ce.top+Z,0,Math.min(Me-j.minDims.height,window.innerHeight-Vp)),_e=Me-Te;ce.height=_e,ce.top=Te}if(o.endsWith("Left")){let Me=ce.left+ce.width,Te=Math.min(ce.left+Y,Math.min(Me-j.minDims.width,window.innerWidth-Vp)),_e=Me-Te;ce.width=_e,ce.left=Te}else o.endsWith("Right")&&(ce.width=Math.max(ce.width+Y,Math.max(j.minDims.width,Vp-j.dims.left)));let ve=VM(ce,{width:window.innerWidth,height:window.innerHeight});$==null||$.discard(),$=de().tempTransaction(({stateEditors:Me})=>{if(!ae&&(o==="BottomRight"||o==="TopRight")&&j.panelId==="sequenceEditor"){let Te=Math.max(225,m.current+Y);Me.studio.historic.panels.sequenceEditor.setDopesheetLeftWidth(Te)}Me.studio.historic.panelPositions.setPanelPosition({position:ve,panelId:j.panelId})})},onDragEnd(Y){G(),Y?$==null||$.commit():$==null||$.discard()}}}}),[o]),[R]=Hs(w,C),N=lZ[o],F=o.length<=6;return Sb.default.createElement(N,{ref:_,className:[R?"isDragging":"",l.boundsHighlighted&&F?"isHighlighted":""].join(" "),style:{cursor:wO[o]}})},qm=cZ}),Xd,uZ,hZ,hbe=P(()=>{Xd=K($e()),ube(),uZ=o=>Xd.default.createElement(Xd.default.Fragment,null,Xd.default.createElement(qm,{which:"Bottom"}),Xd.default.createElement(qm,{which:"Top"}),Xd.default.createElement(qm,{which:"Left"}),Xd.default.createElement(qm,{which:"Right"}),Xd.default.createElement(qm,{which:"TopLeft"}),Xd.default.createElement(qm,{which:"TopRight"}),Xd.default.createElement(qm,{which:"BottomLeft"}),Xd.default.createElement(qm,{which:"BottomRight"})),hZ=uZ}),GM,dZ,fZ,pZ,EO,mZ=P(()=>{$i(),GM=K($e()),Xt(),s6(),hbe(),fZ=me.div(dZ||(dZ=q([`
  position: absolute;
  user-select: none;
  box-sizing: border-box;
  `,`;
  /* box-shadow: 1px 2px 10px -5px black; */

  z-index: 1000;
`])),Ni),pZ=GM.default.forwardRef((o,l)=>{let h=i6(),m=o,{style:_,children:w}=m,C=X(m,["style","children"]);return GM.default.createElement(fZ,V(A({ref:l},C),{style:A({width:h.dims.width+"px",height:h.dims.height+"px",top:h.dims.top+"px",left:h.dims.left+"px"},_??{})}),GM.default.createElement(hZ,null),w)}),EO=pZ}),dbe=te((o,l)=>{(function(h,m){typeof o=="object"&&typeof l<"u"?m(o,$e()):(h=typeof globalThis<"u"?globalThis:h||self,m(h.ReactErrorBoundary={},h.React))})(o,function(h,m){function _(G){if(G&&G.__esModule)return G;var Y=Object.create(null);return G&&Object.keys(G).forEach(function(Z){if(Z!=="default"){var ne=Object.getOwnPropertyDescriptor(G,Z);Object.defineProperty(Y,Z,ne.get?ne:{enumerable:!0,get:function(){return G[Z]}})}}),Y.default=G,Object.freeze(Y)}var w=_(m);function C(G,Y){return C=Object.setPrototypeOf||function(Z,ne){return Z.__proto__=ne,Z},C(G,Y)}function R(G,Y){G.prototype=Object.create(Y.prototype),G.prototype.constructor=G,C(G,Y)}var N=function(G,Y){return G===void 0&&(G=[]),Y===void 0&&(Y=[]),G.length!==Y.length||G.some(function(Z,ne){return!Object.is(Z,Y[ne])})},F={error:null},U=function(G){R(Y,G);function Y(){for(var ne,ae=arguments.length,ce=new Array(ae),ve=0;ve<ae;ve++)ce[ve]=arguments[ve];return ne=G.call.apply(G,[this].concat(ce))||this,ne.state=F,ne.updatedWithError=!1,ne.resetErrorBoundary=function(){for(var Me,Te=arguments.length,_e=new Array(Te),it=0;it<Te;it++)_e[it]=arguments[it];ne.props.onReset==null||(Me=ne.props).onReset.apply(Me,_e),ne.reset()},ne}Y.getDerivedStateFromError=function(ne){return{error:ne}};var Z=Y.prototype;return Z.reset=function(){this.updatedWithError=!1,this.setState(F)},Z.componentDidCatch=function(ne,ae){var ce,ve;(ce=(ve=this.props).onError)==null||ce.call(ve,ne,ae)},Z.componentDidMount=function(){var ne=this.state.error;ne!==null&&(this.updatedWithError=!0)},Z.componentDidUpdate=function(ne){var ae=this.state.error,ce=this.props.resetKeys;if(ae!==null&&!this.updatedWithError){this.updatedWithError=!0;return}if(ae!==null&&N(ne.resetKeys,ce)){var ve,Me;(ve=(Me=this.props).onResetKeysChange)==null||ve.call(Me,ne.resetKeys,ce),this.reset()}},Z.render=function(){var ne=this.state.error,ae=this.props,ce=ae.fallbackRender,ve=ae.FallbackComponent,Me=ae.fallback;if(ne!==null){var Te={error:ne,resetErrorBoundary:this.resetErrorBoundary};if(w.isValidElement(Me))return Me;if(typeof ce=="function")return ce(Te);if(ve)return w.createElement(ve,Te);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},Y}(w.Component);function $(G,Y){var Z=function(ae){return w.createElement(U,Y,w.createElement(G,ae))},ne=G.displayName||G.name||"Unknown";return Z.displayName="withErrorBoundary("+ne+")",Z}function j(G){var Y=w.useState(null),Z=Y[0],ne=Y[1];if(G!=null)throw G;if(Z!=null)throw Z;return ne}h.ErrorBoundary=U,h.useErrorHandler=j,h.withErrorBoundary=$,Object.defineProperty(h,"__esModule",{value:!0})})}),fbe=P(()=>{}),TO,MO,CO,gZ=P(()=>{TO=K($e()),MO={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},CO=TO.default.createContext&&TO.default.createContext(MO)});function vZ(o){return o&&o.map(function(l,h){return c6.default.createElement(l.tag,Xm({key:h},l.attr),vZ(l.child))})}function l6(o){return function(l){return c6.default.createElement(pbe,Xm({attr:Xm({},o.attr)},l),vZ(o.child))}}function pbe(o){var l=function(h){var m=o.attr,_=o.size,w=o.title,C=yZ(o,["attr","size","title"]),R=_||h.size||"1em",N;return h.className&&(N=h.className),o.className&&(N=(N?N+" ":"")+o.className),c6.default.createElement("svg",Xm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},h.attr,m,C,{className:N,style:Xm(Xm({color:o.color||h.color},h.style),o.style),height:R,width:R,xmlns:"http://www.w3.org/2000/svg"}),w&&c6.default.createElement("title",null,w),o.children)};return CO!==void 0?c6.default.createElement(CO.Consumer,null,function(h){return l(h)}):l(MO)}var c6,Xm,yZ,mbe=P(()=>{c6=K($e()),gZ(),Xm=function(){return Xm=Object.assign||function(o){for(var l,h=1,m=arguments.length;h<m;h++){l=arguments[h];for(var _ in l)Object.prototype.hasOwnProperty.call(l,_)&&(o[_]=l[_])}return o},Xm.apply(this,arguments)},yZ=function(o,l){var h={};for(var m in o)Object.prototype.hasOwnProperty.call(o,m)&&l.indexOf(m)<0&&(h[m]=o[m]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,m=Object.getOwnPropertySymbols(o);_<m.length;_++)l.indexOf(m[_])<0&&Object.prototype.propertyIsEnumerable.call(o,m[_])&&(h[m[_]]=o[m[_]]);return h}}),Wo=P(()=>{fbe(),mbe(),gZ()}),gbe=P(()=>{Wo()}),vbe=P(()=>{Wo()});function ybe(o){return l6({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}}]})(o)}var xbe=P(()=>{Wo()}),_be=P(()=>{Wo()}),bbe=P(()=>{Wo()});function Sbe(o){return l6({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5 5-5z"}}]})(o)}function wbe(o){return l6({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3l5 5z"}}]})(o)}var Ebe=P(()=>{Wo()}),Tbe=P(()=>{Wo()}),Mbe=P(()=>{Wo()}),Cbe=P(()=>{Wo()}),Abe=P(()=>{Wo()}),Pbe=P(()=>{Wo()}),Rbe=P(()=>{Wo()}),Ibe=P(()=>{Wo()}),kbe=P(()=>{Wo()}),Nbe=P(()=>{Wo()});function Dbe(o){return l6({attr:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"}}]})(o)}var Obe=P(()=>{Wo()}),Lbe=P(()=>{Wo()}),Fbe=P(()=>{Wo()}),Bbe=P(()=>{Wo()});function Ube(o){return l6({attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M6 9.65685L7.41421 11.0711L11.6569 6.82843L15.8995 11.0711L17.3137 9.65685L11.6569 4L6 9.65685Z",fill:"currentColor"}},{tag:"path",attr:{d:"M6 14.4433L7.41421 13.0291L11.6569 17.2717L15.8995 13.0291L17.3137 14.4433L11.6569 20.1001L6 14.4433Z",fill:"currentColor"}}]})(o)}var zbe=P(()=>{Wo()});function Vbe(o){return l6({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M14 10.44l-.413.56H2.393L2 10.46 7.627 5h.827L14 10.44z"}}]})(o)}var Gbe=P(()=>{Wo()}),Eb=P(()=>{gbe(),vbe(),xbe(),_be(),bbe(),Ebe(),Tbe(),Mbe(),Cbe(),Abe(),Pbe(),Rbe(),Ibe(),kbe(),Nbe(),Obe(),Lbe(),Fbe(),Bbe(),zbe(),Gbe()}),Va,xZ,_Z,bZ,SZ,wZ,EZ,TZ,MZ,CZ,AZ,PZ,RZ,IZ,kZ,NZ,DZ,OZ,LZ,FZ,jbe=P(()=>{Va=K($e()),Xt(),M9(),s6(),zK(),mZ(),xZ=K(dbe()),Eb(),Se(),M9(),ur(),_Z={edges:{left:{from:"screenLeft",distance:.3},right:{from:"screenRight",distance:.3},top:{from:"screenTop",distance:.3},bottom:{from:"screenBottom",distance:.3}}},bZ={width:300,height:300},SZ=({paneInstance:o})=>Va.default.createElement(uO,{panelId:"pane-".concat(o.instanceId),defaultPosition:_Z,minDims:bZ},Va.default.createElement(LZ,{paneInstance:o})),EZ=me(EO)(wZ||(wZ=q([`
  display: flex;
  flex-direction: column;

  box-shadow: 0px 5px 12px -4px rgb(0 0 0 / 22%);
  z-index: `,`;
`])),o=>o.$zIndex),MZ=me.div(TZ||(TZ=q([`
  width: 100%;
`]))),AZ=me.div(CZ||(CZ=q([`
  display: flex;
  align-items: center;
  opacity: 1;
  position: absolute;
  right: 4px;
  top: 0;
  bottom: 0;
`]))),RZ=me.button(PZ||(PZ=q([`
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 2px;
  font-size: 11px;
  height: 10px;
  width: 18px;
  color: #adadadb3;
  background: transparent;
  border: none;
  cursor: pointer;
  &:hover {
    color: white;
  }
`]))),kZ=me(SY)(IZ||(IZ=q([`
  position: relative;
  overflow: hidden;

  &:after {
    z-index: 10;
    position: absolute;
    inset: 0;
    display: block;
    content: ' ';
    pointer-events: none;

    #pointer-root:not(.normal) & {
      pointer-events: auto;
    }
  }
`]))),DZ=me.div(NZ||(NZ=q([`
  padding: 12px;

  & > pre {
    border: 1px solid #ff62624f;
    background-color: rgb(255 0 0 / 5%);
    margin: 8px 0;
    padding: 8px;
    font-family: monospace;
    overflow: scroll;
    color: #ff9896;
  }
`]))),OZ=o=>Va.default.createElement(DZ,null,"An Error occurred rendering this pane. Open the console for more info.",Va.default.createElement("pre",null,JSON.stringify({message:o.error.message,stack:o.error.stack},null,2))),LZ=({paneInstance:o})=>{var l;let[h,m]=(0,Va.useState)(null),_=o.definition.mount;(0,Va.useLayoutEffect)(()=>{if(!h)return;let F=_({paneId:o.instanceId,node:h});if(typeof F=="function")return F},[h,_,o.instanceId]);let w=(0,Va.useCallback)(()=>{de().paneManager.destroyPane(o.instanceId)},[o]),C=(0,Va.useCallback)(()=>{de().paneManager.bringPaneToFront(o.instanceId)},[o]),R=((l=Rr(de().atomP.historic.paneFocusOrder))!=null?l:[]).indexOf(o.instanceId),N=R>=0?H5.pluginPanes+R:H5.pluginPanes;return Va.default.createElement(EZ,{"data-testid":"theatre-pane-wrapper-".concat(o.instanceId),$zIndex:N,onMouseDown:C},Va.default.createElement(vO,null,Va.default.createElement(kM,null,Va.default.createElement(AZ,null,Va.default.createElement(RZ,{onClick:w,title:"Close Pane"},Va.default.createElement(ybe,null))),Va.default.createElement(MZ,null,o.instanceId))),Va.default.createElement(xZ.ErrorBoundary,{FallbackComponent:OZ},Va.default.createElement(kZ,{"data-testid":"theatre-pane-content-".concat(o.instanceId),ref:m})))},FZ=SZ});function u6(o){return JSON.stringify(AO(o))}function AO(o){return Cp(o)?Object.keys(o).sort().reduce((l,h)=>(l[h]=AO(o[h]),l),{}):Array.isArray(o)?o.map(AO):o}var Hbe=P(()=>{m0()}),BZ,h6,UZ=P(()=>{BZ="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",h6=(o=21)=>{let l="",h=o;for(;h--;)l+=BZ[Math.random()*64|0];return l}});function zZ(){return h6(10)}function Wbe(){return h6(10)}function VZ(){return h6(10)}function GZ(){return h6(10)}var Ga,Yd=P(()=>{Hbe(),UZ(),Ga={forSheet(){return"sheet"},forSheetObject(o){return u6({o:o.address.objectKey})},forSubSequence(o){return u6({ss:o})},forSheetObjectProp(o,l){return u6({o:o.address.objectKey,p:l})},forTrackKeyframe(o,l,h){return u6({o:o.address.objectKey,t:l,k:h})},forSheetObjectAggregateKeyframe(o,l){return Ga.forCompoundPropAggregateKeyframe(o,[],l)},forSheetAggregateKeyframe(o,l){return u6({o:o.address.sheetId,pos:l})},forCompoundPropAggregateKeyframe(o,l,h){return u6({o:o.address.objectKey,p:l,pos:h})}}}),PO,RO,jZ=P(()=>{PO=rn(),RO=(o,l)=>{let h=PO.prism.memo(o,()=>new PO.Atom(l),[]);return h.set(l),h}}),HZ,Kd,Ym=P(()=>{Xt(),Kd=Iu(HZ||(HZ=q([`
  font-weight: 300;
  font-size: 11px;
  color: `,`;
  text-shadow: 0.5px 0.5px 2px rgba(0, 0, 0, 0.3);
`])),o=>o.isHighlighted==="self"?"#CCC":"#919191")});function d6(o,l){let h=o;for(let m of l)h=h[m];return h}var Tb=P(()=>{});function $be(){let o=0,l=new qZ.Atom({hasLock:!1});return{replaceLock(h,m){let _=o++,w=l.get();return w.hasLock&&w.cleanup(),l.set({hasLock:!0,lockId:_,cleanup:m,deepPath:qbe(WZ(h))}),function(){let C=l.get();C.hasLock&&C.lockId===_&&(C.cleanup(),l.set({hasLock:!1}))}},getIsPropHighlightedD(h){let m=d6(l.pointer.deepPath,WZ(h));return(0,XZ.prism)(()=>{let _=(0,$Z.val)(m);return _===!0?"self":_?"descendent":null})}}}function WZ(o){return[o.projectId,o.sheetId,o.objectKey,...o.pathToProp]}function qbe(o){let l={};return to(l,o,!0),l}var $Z,qZ,XZ,YZ,Xbe=P(()=>{$Z=rn(),qZ=rn(),XZ=rn(),Tb(),po(),YZ=$be()});function IO(o,l){(0,KZ.useLayoutEffect)(()=>{if(!o||l.type!=="propWithChildren"&&l.type!=="primitiveProp"&&l.type!=="sheetObject")return;let h=null,m=V(A({},l.sheetObject.address),{pathToProp:l.type==="sheetObject"?[]:l.pathToProp});function _(){h=YZ.replaceLock(m,()=>{})}function w(){h==null||h()}return o.addEventListener("mouseenter",_),o.addEventListener("mouseleave",w),()=>{h==null||h(),o.removeEventListener("mouseenter",_),o.removeEventListener("mouseleave",w)}},[o])}var KZ,kO=P(()=>{KZ=K($e()),Xbe()});function NO(o){let[l,h]=(0,DO.useState)(null);return(0,DO.useLayoutEffect)(()=>(o&&h(o.getBoundingClientRect()),()=>{h(null)}),[o]),l}var DO,ZZ=P(()=>{DO=K($e())}),Mb,jM,QZ,JZ,eQ,tQ,nQ,rQ,iQ=P(()=>{e6(),Mb=K($e()),Xt(),jM=26,JZ=me.li(QZ||(QZ=q([`
  height: `,`px;
  padding: 0 12px;
  margin: 0;
  display: flex;
  align-items: center;
  font-size: 11px;
  font-weight: 400;
  position: relative;
  color: `,`;
  cursor: `,`;

  &:after {
    position: absolute;
    inset: 2px 1px;
    display: block;
    content: ' ';
    pointer-events: none;
    z-index: -1;
    border-radius: 3px;
  }

  &:hover:after {
    background-color: `,`;
  }
`])),jM,o=>o.enabled?"white":"#8f8f8f",o=>o.enabled?"normal":"not-allowed",o=>o.enabled?"rgba(63, 174, 191, 0.75)":"initial"),tQ=me.span(eQ||(eQ=q([""]))),nQ=o=>Mb.default.createElement(JZ,{onClick:o.enabled?o.onClick:Wd,enabled:o.enabled,title:o.enabled?void 0:"Disabled"},Mb.default.createElement(tQ,null,Mb.default.createElement(Mb.default.Fragment,null,o.label))),rQ=nQ});function Ybe(o){let l=(0,OO.useRef)(o);l.current=o,(0,OO.useEffect)(()=>{let h=m=>l.current(m);return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[])}var OO,Kbe=P(()=>{OO=K($e())}),Cb,sQ,oQ,aQ,lQ,cQ,uQ,hQ,LO,dQ=P(()=>{Cb=K($e()),iQ(),Xt(),Hd(),$i(),sQ=190,oQ=!0,lQ=me.ul(aQ||(aQ=q([`
  position: absolute;
  min-width: `,`px;
  z-index: 10000;
  background: `,`;
  backdrop-filter: blur(2px);
  color: white;
  list-style-type: none;
  padding: 2px 0;
  margin: 0;
  border-radius: 1px;
  cursor: default;
  `,`;
  border-radius: 3px;
`])),sQ,zp(.2,"#111"),Ni),uQ=me.div(cQ||(cQ=q([`
  padding: 4px 10px;
  border-bottom: 1px solid #6262626d;
  color: #adadadb3;
  font-size: 11px;
  font-weight: 500;
`]))),hQ=Cb.default.forwardRef((o,l)=>Cb.default.createElement(lQ,{ref:l},oQ&&o.displayName?Cb.default.createElement(uQ,null,o.displayName):null,o.items.map((h,m)=>Cb.default.createElement(rQ,{key:"item-".concat(m),label:h.label,enabled:h.enabled!==!1,onClick:_=>{h.callback&&h.callback(_),o.onRequestClose()}})))),LO=hQ}),fQ,pQ,HM,mQ,Ab,gQ,vQ,Zbe=P(()=>{ZZ(),fQ=K($e()),pQ=K($e()),HM=K($e()),mQ=K(Gm()),aO(),iQ(),j5(),Kbe(),dQ(),Ab=20,gQ=o=>{let[l,h]=(0,HM.useState)(null),m=NO(l),_=UM();(0,HM.useLayoutEffect)(()=>{if(!m||!l)return;let R={left:m.width/2,top:jM/2+(o.displayName?jM:0)},N={left:o.clickPoint.clientX-R.left,top:o.clickPoint.clientY-R.top};N.left<0?N.left=0:N.left+m.width>_.width&&(N.left=_.width-m.width),N.top<0?N.top=0:N.top+m.height>_.height&&(N.top=_.height-m.height),l.style.left=N.left+"px",l.style.top=N.top+"px";let F=U=>{(U.clientX<N.left-Ab||U.clientX>N.left+m.width+Ab||U.clientY<N.top-Ab||U.clientY>N.top+m.height+Ab)&&o.onRequestClose()};return window.addEventListener("mousemove",F),()=>{window.removeEventListener("mousemove",F)}},[m,l,o.clickPoint,_,o.onRequestClose]);let w=(0,pQ.useContext)(Qy);Ybe(R=>{R.key==="Escape"&&o.onRequestClose()});let C=(0,fQ.useMemo)(()=>{let R=Array.isArray(o.items)?o.items:o.items();return R.length>0?R:[{label:o.displayName?"No actions for ".concat(o.displayName):"No actions found",enabled:!1}]},[o.items]);return(0,mQ.createPortal)(HM.default.createElement(LO,{items:C,onRequestClose:o.onRequestClose,displayName:o.displayName,ref:h}),w)},vQ=gQ}),WM,yQ,xQ,Qbe=P(()=>{WM=K($e()),yQ=(o,l)=>{let[h,m]=(0,WM.useState)({isOpen:!1}),_=(0,WM.useCallback)(()=>m({isOpen:!1}),[]);return(0,WM.useEffect)(()=>{if(!o||l.disabled===!0){m({isOpen:!1});return}let w=C=>{m({isOpen:!0,event:C}),C.preventDefault(),C.stopPropagation()};return o.addEventListener("contextmenu",w),()=>{o.removeEventListener("contextmenu",w)}},[o,l.disabled]),[h,_]},xQ=yQ}),_Q,bQ,SQ,Jbe=P(()=>{Xt(),bQ=me.input.attrs({type:"checkbox"})(_Q||(_Q=q([`
  outline: none;
`]))),SQ=bQ});function eSe({propConfig:o,editingTools:l,value:h,autoFocus:m}){let _=(0,FO.useCallback)(w=>{l.permanentlySetValue(!!w.target.checked)},[o,l]);return FO.default.createElement(EQ,{checked:h,onChange:_,autoFocus:m})}var FO,wQ,EQ,TQ,tSe=P(()=>{FO=K($e()),Xt(),Jbe(),EQ=me(SQ)(wQ||(wQ=q([`
  margin-left: 6px;

  :focus {
    outline: 1px solid #555;
  }
`]))),TQ=eSe});function $M(o){return l=>{o.forEach(h=>{typeof h=="function"?h(l):h!=null&&(h.current=l)})}}var qM=P(()=>{});function BO(o,l,h){(0,MQ.useEffect)(()=>{if(!o||h===!1)return;let m=Array.isArray(o)?o.filter(w=>w):[o],_=w=>{m.every(C=>!w.composedPath().includes(C))&&l(w)};return window.addEventListener("mousedown",_,{capture:!0,passive:!1}),()=>{window.removeEventListener("mousedown",_,{capture:!0,passive:!1})}},[o,h])}var MQ,UO=P(()=>{MQ=K($e())});function nSe(o){return isNaN(o)?"NaN":Q_(o)?o.toFixed(0):Mr(o,3).toString()}var CQ,AQ,Km,PQ,XM,RQ,IQ,kQ,NQ,DQ,OQ,LQ,FQ,f6,Pb=P(()=>{m0(),CQ=K($e()),AQ=K($e()),Km=K($e()),Xt(),qM(),zi(),UO(),Oo(),XM=me.div(PQ||(PQ=q([`
  height: 100%;
  width: 100%;
  position: relative;
  z-index: 0;
  box-sizing: border-box;
  display: flex;
  align-items: center;

  &:after {
    position: absolute;
    inset: 1px 0 2px;
    display: block;
    content: ' ';
    background-color: transparent;
    border: 1px solid transparent;
    z-index: -2;
    box-sizing: border-box;
    border-radius: 1px;
  }

  &:hover,
  &.dragging,
  &.editingViaKeyboard {
    &:after {
      background-color: #10101042;
      border-color: #00000059;
    }
  }
`]))),IQ=me.input(RQ||(RQ=q([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: ew-resize;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;

  &:focus {
    cursor: text;
  }
`]))),NQ=me.div(kQ||(kQ=q([`
  position: absolute;
  inset: 3px 2px 4px;
  transform: scale(var(--percentage), 1);
  transform-origin: top left;
  background-color: #2d5561;
  z-index: -1;
  border-radius: 2px;
  pointer-events: none;

  `,".dragging &, ",`.noFocus:hover & {
    background-color: #338198;
  }
`])),XM,XM),OQ=me.div(DQ||(DQ=q([`
  display: contents;
`]))),LQ=o=>!0,FQ=o=>{var l;let[h]=ui({mode:"noFocus"}),m=(l=o.isValid)!=null?l:LQ,_=(0,Km.useRef)(o);_.current=o;let w=(0,Km.useRef)(null);BO(w.current,()=>{w.current.blur()},h.current.mode==="editingViaKeyboard");let C=(0,Km.useRef)(null),R=(0,Km.useMemo)(()=>{let ne=Re=>{let xe=Re.target,{value:Oe}=xe,He=h.current;h.current=V(A({},He),{currentEditedValueInString:Oe});let Fe=parseFloat(Oe);!isFinite(Fe)||!m(Fe)||_.current.temporarilySetValue(Fe)},ae=()=>{h.current.mode==="editingViaKeyboard"&&(ce(),h.current={mode:"noFocus"}),o.onBlur&&o.onBlur()},ce=()=>{let Re=h.current,xe=parseFloat(Re.currentEditedValueInString);!isFinite(xe)||!m(xe)||Re.valueBeforeEditing===xe?_.current.discardTemporaryValue():_.current.permanentlySetValue(xe)},ve=Re=>{Re.key==="Escape"?(_.current.discardTemporaryValue(),h.current={mode:"noFocus"},w.current.blur()):(Re.key==="Enter"||Re.key==="Tab")&&(ce(),w.current.blur())},Me=Re=>{h.current.mode==="noFocus"&&(w.current.focus(),Re.preventDefault()),Re.stopPropagation()},Te=()=>{h.current.mode==="noFocus"?_e():h.current.mode},_e=()=>{let Re=_.current.value;h.current={mode:"editingViaKeyboard",currentEditedValueInString:String(Re),valueBeforeEditing:Re},setTimeout(()=>{w.current.focus(),w.current.setSelectionRange(0,100)})},it;return{inputChange:ne,onBlur:ae,transitionToDraggingMode:()=>{var Re;let xe=_.current.value;it=(Re=w.current)==null?void 0:Re.getBoundingClientRect().width,h.current={mode:"dragging"};let Oe=xe,He=xe;return C.current=document.body.style.cursor,{onDrag(Fe,Nt,Ve,Ht){let ot=Ve.altKey?Ht/10:Ht,Ye=He+o.nudge({deltaX:ot,deltaFraction:ot/it,magnitude:1});He=o.range?Bi(Ye,o.range[0],o.range[1]):Ye,_.current.temporarilySetValue(He)},onDragEnd(Fe){Fe?(Oe===He?_.current.discardTemporaryValue():_.current.permanentlySetValue(He),h.current={mode:"noFocus"}):(_.current.discardTemporaryValue(),h.current={mode:"noFocus"})},onClick(){w.current.focus(),w.current.setSelectionRange(0,100)}}},onInputKeyDown:ve,onClick:Me,onFocus:Te}},[]);(0,CQ.useEffect)(()=>()=>{R.onBlur()},[]);let N=h.current.mode!=="editingViaKeyboard"?nSe(o.value):h.current.currentEditedValueInString;typeof N=="number"&&isNaN(N)&&(N="NaN");let F=[w];o.inputRef&&F.push(o.inputRef);let U=Km.default.createElement(IQ,{key:"input",type:"text",onChange:R.inputChange,value:N,onBlur:R.onBlur,onKeyDown:R.onInputKeyDown,onClick:R.onClick,onFocus:R.onFocus,ref:$M(F),onMouseDown:ne=>{ne.stopPropagation()},onDoubleClick:ne=>{ne.preventDefault(),ne.stopPropagation()},autoFocus:o.autoFocus}),{range:$}=o,j=parseFloat(N),G=$?Km.default.createElement(NQ,{style:{"--percentage":Bi((j-$[0])/($[1]-$[0]),0,1)}}):null,[Y,Z]=(0,AQ.useState)(null);return Hs(Y,{debugName:"form/BasicNumberInput",onDragStart:R.transitionToDraggingMode,lockCSSCursorTo:"ew-resize",shouldPointerLock:!0,disabled:h.current.mode==="editingViaKeyboard"}),Km.default.createElement(XM,{className:o.className+" "+h.current.mode},Km.default.createElement(OQ,{ref:Z},U),G)},f6=FQ});function rSe({propConfig:o,editingTools:l,value:h,autoFocus:m}){let _=(0,zO.useCallback)(w=>o.nudgeFn(V(A({},w),{config:o})),[o]);return zO.default.createElement(f6,{value:h,temporarilySetValue:l.temporarilySetValue,discardTemporaryValue:l.discardTemporaryValue,permanentlySetValue:l.permanentlySetValue,range:o.range,nudge:_,autoFocus:m})}var zO,BQ,iSe=P(()=>{Pb(),zO=K($e()),BQ=rSe});function sSe({value:o,onChange:l,options:h,autoFocus:m}){let _=(0,Rb.useCallback)(w=>{l(String(w.target.value))},[l]);return Rb.default.createElement(VO,{role:"radiogroup"},Object.keys(h).map((w,C)=>Rb.default.createElement(VQ,{key:"label-"+C,"data-checked":o===w},h[w],Rb.default.createElement(jQ,{type:"radio",checked:o===w,value:w,onChange:_,name:"switchbox",autoFocus:m}))))}var Rb,UQ,VO,zQ,VQ,GQ,jQ,HQ,oSe=P(()=>{Hd(),Rb=K($e()),Xt(),VO=me.form(UQ||(UQ=q([`
  display: flex;
  flex-direction: row;
  align-items: stretch;
  vertical-align: middle;
  justify-content: stretch;
  height: 24px;
  width: 100%;
`]))),VQ=me.label(zQ||(zQ=q([`
  padding: 0 0.5em;
  background: transparent;
  /* background: #373748; */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-grow: 1;
  color: #a7a7a7;
  border: 1px solid transparent;
  box-sizing: border-box;
  border-right-width: 0px;

  & + &:last-child {
    border-right-width: 1px;
  }

  `,`:hover > & {
    border-color: #1c2123;
    /* background-color: #373748; */
    /* color: `,`; */
  }

  &&:hover {
    background-color: #464654;
  }

  &&[data-checked='true'] {
    color: white;
    background: #3f3f4c;
  }
`])),VO,MD(.1,"white")),jQ=me.input(GQ||(GQ=q([`
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 0;
  height: 0;
`]))),HQ=sSe});function aSe({value:o,onChange:l,options:h,className:m,autoFocus:_}){let w=(0,$5.useCallback)(C=>{l(String(C.target.value))},[l]);return $5.default.createElement($Q,null,$5.default.createElement(KQ,{className:m,value:o,onChange:w,autoFocus:_},Object.keys(h).map((C,R)=>$5.default.createElement("option",{key:"option-"+R,value:C},h[C]))),$5.default.createElement(XQ,null,$5.default.createElement(Ube,null)))}var $5,WQ,$Q,qQ,XQ,YQ,KQ,ZQ,lSe=P(()=>{$5=K($e()),Xt(),Eb(),$Q=me.div(WQ||(WQ=q([`
  width: 100%;
  position: relative;
`]))),XQ=me.div(qQ||(qQ=q([`
  position: absolute;
  right: 0px;
  top: 0;
  bottom: 0;
  width: 1.5em;
  font-size: 14px;
  display: flex;
  align-items: center;
  color: #6b7280;
  pointer-events: none;
`]))),KQ=me.select(YQ||(YQ=q([`
  appearance: none;
  background-color: transparent;
  box-sizing: border-box;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.85);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  text-align: left;
  width: 100%;
  border-radius: 2px;
  /*
  looks like putting percentages in the height of a select box doesn't work in Firefox. Not sure why.
  So we're hard-coding the height to 26px, unlike all other inputs that use a relative height.
  */
  height: 26px /* calc(100% - 4px); */;

  @supports (-moz-appearance: none) {
    /* Ugly hack to remove the extra left padding that shows up only in Firefox */
    text-indent: -2px;
  }

  &:hover,
  &:focus {
    background-color: #10101042;
    border-color: #00000059;
  }
`]))),ZQ=aSe});function cSe({propConfig:o,editingTools:l,value:h,autoFocus:m}){let _=(0,YM.useCallback)(w=>{l.permanentlySetValue(w)},[o,l]);return o.as==="menu"?YM.default.createElement(ZQ,{value:h,onChange:_,options:o.valuesAndLabels,autoFocus:m}):YM.default.createElement(HQ,{value:h,onChange:_,options:o.valuesAndLabels,autoFocus:m})}var YM,QQ,uSe=P(()=>{YM=K($e()),oSe(),lSe(),QQ=cSe}),JQ,Ib,eJ,tJ,nJ,rJ,C9,p6=P(()=>{Xt(),JQ=K($e()),Ib=K($e()),qM(),zi(),UO(),tJ=me.input.attrs({type:"text"})(eJ||(eJ=q([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;
  border: 1px solid transparent;
  box-sizing: border-box;

  &:hover {
    background-color: #10101042;
    border-color: #00000059;
  }

  &:hover,
  &:focus {
    cursor: text;
    background-color: #10101042;
    border-color: #00000059;
  }

  &.invalid {
    border-color: red;
  }
`]))),nJ=o=>!0,rJ=o=>{var l,h;let[m]=ui({mode:"noFocus"}),_=(l=o.isValid)!=null?l:nJ,w=(0,Ib.useRef)(o);w.current=o;let C=(0,Ib.useRef)(null);BO(C.current,()=>{C.current.blur()},m.current.mode==="editingViaKeyboard");let R=(0,Ib.useMemo)(()=>{let U=ae=>{let ce=ae.target,{value:ve}=ce,Me=m.current;m.current=V(A({},Me),{currentEditedValueInString:ve}),_(ve)&&w.current.temporarilySetValue(ve)},$=()=>{var ae,ce;m.current.mode==="editingViaKeyboard"&&(j(),m.current={mode:"noFocus"}),(ce=(ae=w.current).onBlur)==null||ce.call(ae)},j=()=>{let ae=m.current,ce=ae.currentEditedValueInString;_(ce)?ae.valueBeforeEditing===ce?w.current.discardTemporaryValue():w.current.permanentlySetValue(ce):w.current.discardTemporaryValue()},G=ae=>{ae.key==="Escape"?(w.current.discardTemporaryValue(),m.current={mode:"noFocus"},C.current.blur()):(ae.key==="Enter"||ae.key==="Tab")&&(j(),C.current.blur())},Y=ae=>{m.current.mode==="noFocus"&&(C.current.focus(),ae.preventDefault()),ae.stopPropagation()},Z=()=>{m.current.mode==="noFocus"?ne():m.current.mode},ne=()=>{let ae=w.current.value;m.current={mode:"editingViaKeyboard",currentEditedValueInString:String(ae),valueBeforeEditing:ae},setTimeout(()=>{C.current.focus()})};return{inputChange:U,onBlur:$,onInputKeyDown:G,onClick:Y,onFocus:Z}},[]);(0,JQ.useEffect)(()=>()=>{R.onBlur()},[]);let N=m.current.mode!=="editingViaKeyboard"?o.value:m.current.currentEditedValueInString,F=[C];return o.inputRef&&F.push(o.inputRef),Ib.default.createElement(tJ,{key:"input",type:"text",className:"".concat((h=o.className)!=null?h:""," ").concat(_(N)?"":"invalid"),onChange:R.inputChange,value:N,onBlur:R.onBlur,onKeyDown:R.onInputKeyDown,onClick:R.onClick,onFocus:R.onFocus,ref:$M(F),onMouseDown:U=>{U.stopPropagation()},onDoubleClick:U=>{U.preventDefault(),U.stopPropagation()},autoFocus:o.autoFocus})},C9=rJ});function hSe({editingTools:o,value:l,autoFocus:h}){return iJ.default.createElement(C9,{value:l,temporarilySetValue:o.temporarilySetValue,discardTemporaryValue:o.discardTemporaryValue,permanentlySetValue:o.permanentlySetValue,autoFocus:h})}var iJ,sJ,dSe=P(()=>{iJ=K($e()),p6(),sJ=hSe});function fSe(o){o=o.trim().toLowerCase();let l=o.match(HO);if(!l)return{r:0,g:0,b:0,a:1};let h=pSe(l[1]);return{r:parseInt(h.substr(0,2),16)/255,g:parseInt(h.substr(2,2),16)/255,b:parseInt(h.substr(4,2),16)/255,a:parseInt(h.substr(6,2),16)/255}}function GO(o,{removeAlphaIfOpaque:l=!1}={}){let h=(o.a*255|256).toString(16).slice(1),m=(o.r*255|256).toString(16).slice(1)+(o.g*255|256).toString(16).slice(1)+(o.b*255|256).toString(16).slice(1)+(l&&h==="ff"?"":h);return"#".concat(m)}function jO(o){return V(A({},o),{toString(){return GO(this,{removeAlphaIfOpaque:!0})}})}function pSe(o){switch(o.length){case 3:return"".concat(o.repeat(2),"ff");case 4:let l=o.substr(0,3),h=o[3];return"".concat(l.repeat(2)).concat(h.repeat(2));case 6:return"".concat(o,"ff")}return o}var HO,oJ=P(()=>{HO=/^#*([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i});function KM(o){let l=(0,WO.useRef)(o),h=(0,WO.useRef)(m=>{l.current&&l.current(m)});return l.current=o,h.current}var WO,aJ=P(()=>{WO=K($e())}),q5,ZM=P(()=>{q5=(o,l=0,h=1)=>o>h?h:o<l?l:o}),kb,$O,lJ,qO,XO=P(()=>{kb=K($e()),$O=(0,kb.createContext)(void 0),lJ=({children:o})=>{let[l,h]=(0,kb.useState)(!1);return kb.default.createElement($O.Provider,{value:{editing:l,setEditing:h}},o)},qO=()=>(0,kb.useContext)($O)}),A9,m6,cJ,QM,YO,KO,uJ,hJ,dJ,fJ,Nb,JM=P(()=>{A9=K($e()),aJ(),ZM(),Xt(),XO(),m6=o=>"touches"in o,cJ=(o,l)=>{for(let h=0;h<o.length;h++)if(o[h].identifier===l)return o[h];return o[0]},QM=o=>o&&o.ownerDocument.defaultView||self,YO=(o,l,h)=>{let m=o.getBoundingClientRect(),_=m6(l)?cJ(l.touches,h):l;return{left:q5((_.pageX-(m.left+QM(o).pageXOffset))/m.width),top:q5((_.pageY-(m.top+QM(o).pageYOffset))/m.height)}},KO=o=>{!m6(o)&&o.preventDefault()},uJ=(o,l)=>l&&!m6(o),dJ=me.div(hJ||(hJ=q([`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  outline: none;
  /* Don't trigger the default scrolling behavior when the event is originating from this element */
  touch-action: none;
`]))),fJ=o=>{var l=o,{onMove:h,onKey:m}=l,_=X(l,["onMove","onKey"]);let w=(0,A9.useRef)(null),C=KM(h),R=KM(m),N=(0,A9.useRef)(null),F=(0,A9.useRef)(!1),{setEditing:U}=qO(),[$,j,G]=(0,A9.useMemo)(()=>{let Y=({nativeEvent:ve})=>{let Me=w.current;if(Me&&(KO(ve),!(uJ(ve,F.current)||!Me))){if(m6(ve)){F.current=!0;let Te=ve.changedTouches||[];Te.length&&(N.current=Te[0].identifier)}Me.focus(),U(!0),C(YO(Me,ve,N.current)),ce(!0)}},Z=ve=>{KO(ve),(m6(ve)?ve.touches.length>0:ve.buttons>0)&&w.current?C(YO(w.current,ve,N.current)):(U(!1),ce(!1))},ne=ve=>{U(!1),ce(!1)},ae=ve=>{let Me=ve.which||ve.keyCode;Me<37||Me>40||(ve.preventDefault(),R({left:Me===39?.05:Me===37?-.05:0,top:Me===40?.05:Me===38?-.05:0}))};function ce(ve){let Me=F.current,Te=w.current,_e=QM(Te),it=ve?_e.addEventListener:_e.removeEventListener;it(Me?"touchmove":"mousemove",Z),it(Me?"touchend":"mouseup",ne)}return[Y,ae,ce]},[R,C]);return(0,A9.useEffect)(()=>G,[G]),A9.default.createElement(dJ,V(A({},_),{onTouchStart:$,onMouseDown:$,ref:w,onKeyDown:j,tabIndex:0,role:"slider"}))},Nb=A9.default.memo(fJ)}),ZO,pJ,mJ,gJ,vJ,yJ,xJ,eC,QO=P(()=>{ZO=K($e()),Xt(),JM(),mJ=me(Nb)(pJ||(pJ=q([""]))),vJ=me.div(gJ||(gJ=q([`
  position: absolute;
  z-index: 1;
  box-sizing: border-box;
  width: 16px;
  height: 16px;
  transform: translate(-50%, -50%);
  background-color: #fff;
  border: 1px solid #ffffff00;
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);

  `,`:focus & {
    transform: translate(-50%, -50%) scale(1.1);
  }
`])),mJ),xJ=me.div(yJ||(yJ=q([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;
`]))),eC=({className:o,color:l,left:h,top:m=.5})=>{let _={top:"".concat(m*100,"%"),left:"".concat(h*100,"%")};return ZO.default.createElement(vJ,{style:_,className:o},ZO.default.createElement(xJ,{style:{backgroundColor:l}}))}}),Z0,tC=P(()=>{Z0=(o,l=0,h=Math.pow(10,l))=>Math.round(h*o)/h}),JO,nC,rC,_J,bJ,iC=P(()=>{tC(),JO=({h:o,s:l,v:h,a:m})=>{let _=(200-l)*h/100;return{h:Z0(o),s:Z0(_>0&&_<200?l*h/100/(_<=100?_:200-_)*100:0),l:Z0(_/2),a:Z0(m,2)}},nC=o=>{let{h:l,s:h,l:m}=JO(o);return"hsl(".concat(l,", ").concat(h,"%, ").concat(m,"%)")},rC=o=>{let{h:l,s:h,l:m,a:_}=JO(o);return"hsla(".concat(l,", ").concat(h,"%, ").concat(m,"%, ").concat(_,")")},_J=({h:o,s:l,v:h,a:m})=>{o=o/360*6,l=l/100,h=h/100;let _=Math.floor(o),w=h*(1-l),C=h*(1-(o-_)*l),R=h*(1-(1-o+_)*l),N=_%6;return{r:Z0([h,C,w,w,R,h][N]*255),g:Z0([R,h,h,C,w,w][N]*255),b:Z0([w,w,R,h,h,C][N]*255),a:Z0(m,2)}},bJ=({r:o,g:l,b:h,a:m})=>{let _=Math.max(o,l,h),w=_-Math.min(o,l,h),C=w?_===o?(l-h)/w:_===l?2+(h-o)/w:4+(o-l)/w:0;return{h:Z0(60*(C<0?C+6:C)),s:Z0(_?w/_*100:0),v:Z0(_/255*100),a:m}}}),Db,SJ,wJ,EJ,TJ,MJ,CJ,mSe=P(()=>{Db=K($e()),JM(),QO(),iC(),ZM(),tC(),Xt(),wJ=me.div(SJ||(SJ=q([`
  position: relative;
  height: 16px;
  border-radius: 2px;

  background: linear-gradient(
    to right,
    #f00 0%,
    #ff0 17%,
    #0f0 33%,
    #0ff 50%,
    #00f 67%,
    #f0f 83%,
    #f00 100%
  );
`]))),TJ=me(eC)(EJ||(EJ=q([`
  z-index: 2;
`]))),MJ=({className:o,hue:l,onChange:h})=>Db.default.createElement(wJ,{className:o},Db.default.createElement(Nb,{onMove:m=>{h({h:360*m.left})},onKey:m=>{h({h:q5(l+m.left*360,0,360)})},"aria-label":"Hue","aria-valuetext":Z0(l)},Db.default.createElement(TJ,{left:l/360,color:nC({h:l,s:100,v:100,a:1})}))),CJ=Db.default.memo(MJ)}),Ob,AJ,PJ,RJ,IJ,kJ,NJ,gSe=P(()=>{Ob=K($e()),JM(),QO(),iC(),ZM(),tC(),Xt(),PJ=me.div(AJ||(AJ=q([`
  position: relative;
  flex-grow: 1;
  border-color: transparent; /* Fixes https://github.com/omgovich/react-colorful/issues/139 */
  border-bottom: 12px solid #000;
  border-radius: 2px;
  background-image: linear-gradient(to top, #000, rgba(0, 0, 0, 0)),
    linear-gradient(to right, #fff, rgba(255, 255, 255, 0));

  // Improve elements rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),IJ=me(eC)(RJ||(RJ=q([`
  z-index: 3;
`]))),kJ=({hsva:o,onChange:l})=>{let h=w=>{l({s:w.left*100,v:100-w.top*100})},m=w=>{l({s:q5(o.s+w.left*100,0,100),v:q5(o.v-w.top*100,0,100)})},_={backgroundColor:nC({h:o.h,s:100,v:100,a:1})};return Ob.default.createElement(PJ,{style:_},Ob.default.createElement(Nb,{onMove:h,onKey:m,"aria-label":"Color","aria-valuetext":"Saturation ".concat(Z0(o.s),"%, Brightness ").concat(Z0(o.v),"%")},Ob.default.createElement(IJ,{top:1-o.v/100,left:o.s/100,color:nC(o)})))},NJ=Ob.default.memo(kJ)}),Lb,DJ,OJ,LJ,FJ,BJ,UJ,zJ,vSe=P(()=>{Lb=K($e()),JM(),QO(),iC(),ZM(),tC(),Xt(),OJ=me.div(DJ||(DJ=q([`
  position: relative;
  height: 16px;
  border-radius: 2px;
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),FJ=me.div.attrs(({colorFrom:o,colorTo:l})=>({style:{backgroundImage:"linear-gradient(90deg, ".concat(o,", ").concat(l,")")}}))(LJ||(LJ=q([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;

  // Improve rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),UJ=me(eC)(BJ||(BJ=q([`
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),zJ=({className:o,hsva:l,onChange:h})=>{let m=R=>{h({a:R.left})},_=R=>{h({a:q5(l.a+R.left)})},w=rC(Object.assign({},l,{a:0})),C=rC(Object.assign({},l,{a:1}));return Lb.default.createElement(OJ,{className:o},Lb.default.createElement(FJ,{colorFrom:w,colorTo:C}),Lb.default.createElement(Nb,{onMove:m,onKey:_,"aria-label":"Alpha","aria-valuetext":"".concat(Z0(l.a*100),"%")},Lb.default.createElement(UJ,{left:l.a,color:rC(l)})))}}),sC,VJ=P(()=>{sC=(o,l)=>{if(o===l)return!0;for(let h in o)if(o[h]!==l[h])return!1;return!0}});function ySe(o,l,h,m){let{editing:_}=qO(),[w,C]=(0,Zm.useState)(l),R=KM(h),N=KM(m),F=_?w:l,[U,$]=(0,Zm.useState)(()=>o.toHsva(F)),j=(0,Zm.useRef)({color:F,hsva:U}),G=(0,Zm.useRef)({color:F,hsva:U});(0,Zm.useEffect)(()=>{_&&C(j.current.color)},[_]),(0,Zm.useEffect)(()=>{let Z=o.fromHsva(U);_?!sC(U,j.current.hsva)&&!o.equal(Z,j.current.color)&&(j.current={hsva:U,color:Z},C(Z),R(Z)):!sC(U,G.current.hsva)&&!o.equal(Z,G.current.color)&&(G.current={hsva:U,color:Z},j.current={hsva:U,color:Z},N(Z))},[_,U,o,R,N]),(0,Zm.useEffect)(()=>{if(!_&&!o.equal(F,G.current.color)){let Z=o.toHsva(F);G.current={hsva:Z,color:F},$(Z)}},[_,F,o]);let Y=(0,Zm.useCallback)(Z=>{$(ne=>Object.assign({},ne,Z))},[]);return[U,Y]}var Zm,xSe=P(()=>{Zm=K($e()),VJ(),aJ(),XO()}),g6,GJ,jJ,HJ,_Se=P(()=>{g6=K($e()),mSe(),gSe(),vSe(),xSe(),Xt(),jJ=me.div(GJ||(GJ=q([`
  position: relative;
  display: flex;
  gap: 4px;
  flex-direction: column;
  width: 200px;
  height: 200px;
  user-select: none;
  cursor: default;
`]))),HJ=o=>{var l=o,{className:h,colorModel:m,color:_=m.defaultColor,temporarilySetValue:w,permanentlySetValue:C,discardTemporaryValue:R}=l,N=X(l,["className","colorModel","color","temporarilySetValue","permanentlySetValue","discardTemporaryValue"]);let[F,U]=ySe(m,_,w,C);return(0,g6.useEffect)(()=>()=>{R()},[]),g6.default.createElement(jJ,A({},N),g6.default.createElement(NJ,{hsva:F,onChange:U}),g6.default.createElement(CJ,{hue:F.h,onChange:U}),g6.default.createElement(zJ,{hsva:F,onChange:U}))}}),eL,WJ,$J,qJ,XJ,bSe=P(()=>{eL=K($e()),_Se(),VJ(),iC(),XO(),WJ=o=>({r:o.r/255,g:o.g/255,b:o.b/255,a:o.a}),$J=o=>({r:o.r*255,g:o.g*255,b:o.b*255,a:o.a}),qJ={defaultColor:{r:0,g:0,b:0,a:1},toHsva:o=>bJ($J(o)),fromHsva:o=>WJ(_J(o)),equal:sC},XJ=o=>eL.default.createElement(lJ,null,eL.default.createElement(HJ,V(A({},o),{permanentlySetValue:l=>{o.permanentlySetValue(l)},colorModel:qJ})))}),SSe=P(()=>{bSe()}),YJ,KJ,tL,ZJ=P(()=>{YJ=K($e()),KJ=(0,YJ.createContext)({}),tL=KJ});function wSe(o,l,h){let m=_=>{let w=o.getBoundingClientRect();(_.clientX<w.left-l||_.clientX>w.left+w.width+l||_.clientY<w.top-l||_.clientY>w.top+w.height+l)&&h(_)};return window.addEventListener("mousemove",m),()=>{window.removeEventListener("mousemove",m)}}var ESe=P(()=>{}),QJ,oC,nL,JJ,rL,eee=P(()=>{QJ=K($e()),oC=K($e()),aO(),ZZ(),ZJ(),zi(),UO(),ESe(),e6(),m0(),nL=8,JJ=o=>{var l,h;let m=o.children(),[_,w]=ui(null),C=m.props.style?A({},m.props.style):{};C.position="absolute";let R=NO(w),N=NO(o.target),F=UM(),[U,$]=(0,oC.useState)({});return(0,oC.useLayoutEffect)(()=>{var j,G,Y;if(!R||!w||!N)return;let Z=(j=o.verticalGap)!=null?j:8,ne={},ae=(G=o.verticalPlacement)!=null?G:"bottom",ce=0,ve=0;ae==="bottom"?N.bottom+R.height+Z<F.height?(ae="bottom",ce=N.bottom+Z,ne.top="0px"):N.top>R.height+Z?(ae="top",ce=N.top-(R.height+Z),ne.bottom="0px",ne.transform="rotateZ(180deg)"):ae="overlay":ae==="top"&&(N.top>R.height+Z?(ae="top",ce=N.top-(R.height+Z),ne.bottom="0px",ne.transform="rotateZ(180deg)"):N.bottom+R.height+Z<F.height?(ae="bottom",ce=N.bottom+Z,ne.top="0px"):ae="overlay");let Me=0;if(ae!=="overlay"){let Oe=N.left+N.width/2;Oe<R.width/2?(ve=Z,Me=Math.max(Oe-Z,nL)):Oe+R.width/2>F.width?(ve=F.width-(Z+R.width),Me=Math.min(Oe-ve,R.width-nL)):(ve=Oe-R.width/2,Me=R.width/2),ne.left=Me+"px"}let{minX:Te=-1/0,maxX:_e=1/0,minY:it=-1/0,maxY:Re=1/0}=(Y=o.constraints)!=null?Y:{},xe={left:Bi(ve,Te,_e-R.width),top:Bi(ce,it,Re+R.height)};if(w.style.left=xe.left+"px",w.style.top=xe.top+"px",$(ne),o.onPointerOutside)return wSe(w,o.onPointerOutside.threshold,o.onPointerOutside.callback)},[R,w,o.target,N,F,o.onPointerOutside]),BO([w,(l=o.target)!=null?l:null],(h=o.onClickOutside)!=null?h:Wd),QJ.default.createElement(tL.Provider,{value:U},(0,oC.cloneElement)(m,{ref:_,style:C}))},rL=JJ});function Nc(o,l){let{isPointerBeingCaptured:h}=DK("usePopover"),[m,_]=ui({isOpen:!1}),w=(0,Q0.useRef)(o),C=(0,Q0.useCallback)(j=>{m.current={isOpen:!1}},[]),R=(0,Q0.useCallback)((j,G)=>{var Y;let Z=typeof w.current=="function"?w.current():w.current;function ne(){F.childHasFocusRef.current||Z.closeOnClickOutside!==!1&&C("clicked outside popover")}m.current={isOpen:!0,clickPoint:{clientX:j.clientX,clientY:j.clientY},target:G,opts:Z,onClickOutside:ne,onPointerOutside:Z.closeWhenPointerIsDistant===!1?void 0:{threshold:(Y=Z.pointerDistanceThreshold)!=null?Y:100,callback:()=>{F.childHasFocusRef.current||h()||C("pointer outside")}}}},[]),N=(0,Q0.useCallback)((...j)=>{m.current.isOpen?C("toggled"):R(...j)},[]),F=TSe({state:_}),[,U]=(0,Q0.useContext)(yL);(0,Q0.useEffect)(()=>{let j;return _.isOpen&&(j=U()),()=>j==null?void 0:j()},[_.isOpen]);let $=(0,Q0.useContext)(Qy);return{node:_.isOpen?(0,tee.createPortal)(Q0.default.createElement(iL.Provider,{value:F.childPopoverLock},Q0.default.createElement(rL,{children:l,target:_.target,onClickOutside:_.onClickOutside,onPointerOutside:_.onPointerOutside,constraints:_.opts.constraints,verticalGap:_.opts.verticalGap})),$):Q0.default.createElement(Q0.default.Fragment,null),open:R,close:C,toggle:N,isOpen:_.isOpen}}function TSe(o){let l=(0,Q0.useContext)(iL);(0,Q0.useEffect)(()=>{if(o.state.isOpen){let m=l.takeFocus();return()=>{m.releaseFocus()}}},[o.state.isOpen]);let h=(0,Q0.useRef)(!1);return{childHasFocusRef:h,childPopoverLock:{takeFocus(){return h.current=!0,{releaseFocus(){h.current=!1}}}}}}var Q0,tee,iL,Zd=P(()=>{pO(),zi(),Q0=K($e()),tee=K(Gm()),j5(),eee(),Bte(),iL=Q0.default.createContext({takeFocus(){return{releaseFocus(){}}}})}),Qm,nee,ree,iee,see,oee,aee,lee,cee,uee,hee,dee,fee,MSe=P(()=>{Qm=K($e()),Xt(),ZJ(),ree=me.div(nee||(nee=q([`
  position: absolute;
  width: 0;
  height: 0;
  color: var(--popover-arrow-color);
  pointer-events: none;
`]))),see=me.div(iee||(iee=q([`
  width: 12px;
  height: 8px;
  position: absolute;
  left: -7px;
  top: -8px;
  text-align: center;
  line-height: 0;
`]))),aee=me.path(oee||(oee=q([`
  fill: var(--popover-bg);
`]))),cee=me.path(lee||(lee=q([`
  fill: var(--popover-inner-stroke);
`]))),hee=me.path(uee||(uee=q([`
  fill: var(--popover-outer-stroke);
`]))),dee=(0,Qm.forwardRef)(({className:o},l)=>{let h=(0,Qm.useContext)(tL);return Qm.default.createElement(ree,{className:o,ref:l,style:A({},h)},Qm.default.createElement(see,null,Qm.default.createElement("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Qm.default.createElement(hee,{d:"M6 0L0 6H12L6 0Z"}),Qm.default.createElement(cee,{d:"M6 1.5L0 7.5H12L6 1.5Z"}),Qm.default.createElement(aee,{d:"M6 3L0 9H12L6 3Z"}))))}),fee=dee}),aC,sL,pee,mee,gee,Dc,Qd=P(()=>{$i(),Hd(),aC=K($e()),Xt(),MSe(),sL=zp(.05,"#2a2a31"),mee=me.div(pee||(pee=q([`
  position: absolute;
  --popover-bg: `,`;
  --popover-inner-stroke: #505159;
  --popover-outer-stroke: #111;

  background: var(--popover-bg);

  color: white;
  padding: 0;
  margin: 0;
  cursor: default;
  `,`;
  border-radius: 3px;
  z-index: 10000;
  border: 1px solid var(--popover-inner-stroke);
  box-shadow: 0 0 0 1px var(--popover-outer-stroke), 0 6px 8px -4px black;
  backdrop-filter: blur(8px);

  & a {
    color: inherit;
  }
`])),sL,Ni),gee=aC.default.forwardRef(({children:o,className:l,showPopoverEdgeTriangle:h=!0},m)=>aC.default.createElement(mee,{className:l,ref:m},h?aC.default.createElement(fee,null):void 0,o)),Dc=gee});function CSe({editingTools:o,value:l,autoFocus:h}){let m=(0,Hp.useRef)(null),_=(0,Hp.useCallback)(C=>{let R=jO(fSe(C));o.permanentlySetValue(R)},[o]),w=Nc({debugName:"RgbaPropEditor"},()=>Hp.default.createElement(Eee,null,Hp.default.createElement(XJ,{color:{r:l.r,g:l.g,b:l.b,a:l.a},temporarilySetValue:C=>{let R=jO(C);o.temporarilySetValue(R)},permanentlySetValue:C=>{let R=jO(C);o.permanentlySetValue(R)},discardTemporaryValue:o.discardTemporaryValue})));return Hp.default.createElement(Hp.default.Fragment,null,Hp.default.createElement(yee,null,Hp.default.createElement(_ee,{rgbaColor:l,ref:m,onClick:C=>{w.toggle(C,m.current)}}),Hp.default.createElement(See,{value:GO(l,{removeAlphaIfOpaque:!0}),temporarilySetValue:oL,discardTemporaryValue:oL,permanentlySetValue:_,isValid:C=>!!C.match(HO),autoFocus:h})),w.node)}var Hp,vee,yee,xee,_ee,bee,See,oL,wee,Eee,Tee,ASe=P(()=>{oJ(),oJ(),Hp=K($e()),SSe(),Xt(),Zd(),p6(),Qd(),yee=me.div(vee||(vee=q([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),_ee=me.div.attrs(o=>({style:{background:GO(o.rgbaColor)}}))(xee||(xee=q([`
  height: 18px;
  aspect-ratio: 1;
  border-radius: 99999px;
`]))),See=me(C9)(bee||(bee=q([`
  flex: 1;
`]))),oL=()=>{},Eee=me.div(wee||(wee=q([`
  position: absolute;
  background-color: `,`;
  color: white;
  margin: 0;
  cursor: default;
  border-radius: 3px;
  z-index: 10000;
  backdrop-filter: blur(8px);

  padding: 4px;
  pointer-events: all;

  border: none;
  box-shadow: none;
`])),sL),Tee=CSe});function PSe({propConfig:o,editingTools:l,value:h,autoFocus:m}){let[_,w]=Jd.default.useState();(0,Jd.useEffect)(()=>{w(h?l.getAssetUrl(h):void 0)},[h]);let C=(0,Jd.useCallback)(N=>De(this,null,function*(){let F=N.target.files[0];l.permanentlySetValue({type:"image",id:void 0});let U=yield l.createAsset(F);U?l.permanentlySetValue({type:"image",id:U}):l.permanentlySetValue(h),N.target.value=null}),[l,h]),R=!(h!=null&&h.id);return Jd.default.createElement(aL,{empty:R},Jd.default.createElement(kee,{empty:R,title:R?"Upload image":'"'.concat(h.id,'" (Click to upload new image)')},Jd.default.createElement(Dee,{type:"file",onChange:C,accept:"image/*,.hdr",autoFocus:m}),_?Jd.default.createElement(Lee,{src:_}):Jd.default.createElement(Aee,null)),!R&&Jd.default.createElement(Bee,{title:"Delete image",onClick:()=>{l.permanentlySetValue({type:"image",id:void 0})}},Jd.default.createElement(eO,null)))}var Jd,Mee,aL,Cee,Aee,Pee,Ree,Iee,kee,Nee,Dee,Oee,Lee,Fee,Bee,Uee,RSe=P(()=>{NM(),Jd=K($e()),Xt(),aL=me.div(Mee||(Mee=q([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),Aee=me.div(Cee||(Cee=q([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),kee=me.label(Iee||(Iee=q([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),o=>o.empty?Iu(Pee||(Pee=q([""]))):Iu(Ree||(Ree=q([""])))),Dee=me.input.attrs({type:"file"})(Nee||(Nee=q([`
  display: none;
`]))),Lee=me.img(Oee||(Oee=q([`
  position: absolute;
  inset: 0;
  height: 100%;
  aspect-ratio: 1;

  object-fit: cover;
`]))),Bee=me.button(Fee||(Fee=q([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),aL),Uee=PSe});function ISe({propConfig:o,editingTools:l,value:h,autoFocus:m}){let[_,w]=ef.default.useState();(0,ef.useEffect)(()=>{w(h?l.getAssetUrl(h):void 0)},[h]);let C=(0,ef.useCallback)(N=>De(this,null,function*(){let F=N.target.files[0];l.permanentlySetValue({type:"file",id:void 0});let U=yield l.createAsset(F);U?l.permanentlySetValue({type:"file",id:U}):l.permanentlySetValue(h),N.target.value=null}),[l,h]),R=!(h!=null&&h.id);return ef.default.createElement(lL,{empty:R},ef.default.createElement($ee,{empty:R,title:R?"Upload file":'"'.concat(h.id,'" (Click to upload new file)')},ef.default.createElement(Xee,{type:"file",onChange:C,autoFocus:m}),_?ef.default.createElement(QD,null):ef.default.createElement(Gee,null)),!R&&ef.default.createElement(Kee,{title:"Delete file",onClick:()=>{l.permanentlySetValue({type:"file",id:void 0})}},ef.default.createElement(eO,null)))}var ef,zee,lL,Vee,Gee,jee,Hee,Wee,$ee,qee,Xee,Yee,Kee,Zee,kSe=P(()=>{NM(),ef=K($e()),Xt(),lL=me.div(zee||(zee=q([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),Gee=me.div(Vee||(Vee=q([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),$ee=me.label(Wee||(Wee=q([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),o=>o.empty?Iu(jee||(jee=q([""]))):Iu(Hee||(Hee=q([""])))),Xee=me.input.attrs({type:"file"})(qee||(qee=q([`
  display: none;
`]))),Kee=me.button(Yee||(Yee=q([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),lL),Zee=ISe}),cL,Qee=P(()=>{tSe(),iSe(),uSe(),dSe(),ASe(),RSe(),kSe(),cL={number:BQ,string:sJ,boolean:TQ,stringLiteral:QQ,rgba:Tee,image:Uee,file:Zee}});function lC(o){let l=new WeakMap;return h=>(l.has(h)||l.set(h,o(h)),l.get(h))}var uL=P(()=>{});function Wp(o){return o.type==="compound"||o.type==="enum"}function v6(o,l){if(!o)return;let[h,...m]=l;if(h===void 0)return o;if(!Wp(o))return;let _=o.type==="enum"?o.cases[h]:o.props[h];return v6(_,m)}function cC(o,l){let h=l.deserializeAndSanitize(o);return h===void 0?l.default:h}function NSe(o){return!Wp(o)}function*y6(o,l){if(o.type==="compound")for(let h in o.props)yield*tt(y6(o.props[h],[...l,h]));else{if(o.type==="enum")throw new Error("Not implemented yet");return yield{path:l,conf:o}}}var hL,P9=P(()=>{uL(),hL=lC(o=>{if(o.type==="enum")throw new Error("Not implemented yet for enums");for(let l in o.props){let h=o.props[l];if(Wp(h)){if(hL(h))return!0}else return!0}return!1})});function R9(o,l){return l.length===0?o:Tc(o,l)}var uC=P(()=>{H0()});function Jee(o,l){return o==null?null:o instanceof Element&&o.matches(l)?o:Jee(o.parentElement,l)}var DSe=P(()=>{});function OSe(o){let l=new dC.Atom(void 0),h=new dC.Atom({}),m=new dC.Atom({}),_=0;return{addRelatedFlags(w,C){let R=String(++_),N=C.map(F=>{let U={flag:F.flag},$=[F.affects,w,R];return m.setByPointer(j=>d6(j,$),U),$});return()=>{for(let F of N)m.setByPointer(U=>d6(U,F),void 0)}},usePresenceFlag(w){},setUserHover(w){let C=l.get();C!==w&&(C&&h.setByPointer(R=>R[C],!1),l.set(w),w&&h.setByPointer(R=>R[w],!0))}}}function x6(o){let l=hC.default.useContext(fL),h=l.usePresenceFlag(o);return{attrs:{[fC]:o},flag:h,useRelations(m,_){(0,dL.useEffect)(()=>o&&l.addRelatedFlags(o,m()),[o,..._])}}}function LSe(o){let l=hC.default.useContext(fL),h=o6("PresenceListeners");(0,dL.useEffect)(()=>{let m;if(!o)return;let _=w=>{if(w.target instanceof Node){let C=Jee(w.target,"[".concat(fC,"]"));if(C){let R=C.getAttribute(fC);m!==R&&(m=R,l.setUserHover(R||void 0),h._debug("Updated current hover",{itemKey:R}));return}m!=null&&(m=null,l.setUserHover(void 0),h._debug("Cleared current hover"))}};return o.addEventListener("mouseover",_),()=>{o.removeEventListener("mouseover",_),m!=null&&(m=null,h._debug("Cleared current hover as part of cleanup"))}},[o,l])}var hC,dL,ete,dC,tte,fL,fC,Fb=P(()=>{hC=K($e()),dL=K($e()),W5(),ete=rn(),dC=rn(),ur(),DSe(),Tb(),tte=(0,ete.prism)(()=>{}),tte.keepHot(),fL=hC.default.createContext(OSe()),fC="data-pi-key"}),g0,nte,Bb,rte,pL,I9,ite,mL,ste,ote,ate,pC,lte,cte,ute,hte,dte,fte,Ub,pte,gL,mC=P(()=>{$i(),Hd(),g0=K($e()),Xt(),Fb(),Bb=me.div(nte||(nte=q([`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 16px;
  margin: 0 0px 0 2px;
  position: relative;
  z-index: 0;
  opacity: 0.7;

  &:after {
    position: absolute;
    left: -14px;
    right: -14px;
    top: -2px;
    bottom: -2px;
    content: ' ';
    display: none;
    z-index: -1;
    background: `,`;
  }

  &:hover {
    opacity: 1;
    &:after {
      display: block;
    }
  }
`])),zp(.2,"black")),pL=me.div(rte||(rte=q([`
  background: none;
  position: relative;
  border: 0;
  transition: transform 0.1s ease-out;
  z-index: 0;
  outline: none;
  cursor: pointer;

  &:after {
    display: none;
    `,`:hover & {
      display: block;
    }
    position: absolute;
    left: -4px;
    right: -4px;
    top: -4px;
    bottom: -4px;
    content: ' ';
    z-index: -1;
  }
`])),Bb),I9={offColor:"#555",onColor:"#e0c917"},mL=me(pL)(ite||(ite=q([`
  &:hover {
    color: #e0c917;
  }

  color: `,`;
`])),o=>o.presence===2?"white":o.isOn?I9.onColor:I9.offColor),ote=Iu(ste||(ste=q([`
  pointer-events: none !important;
`]))),pC=me(pL)(ate||(ate=q([`
  color: `,`;

  `,`;
`])),o=>o.flag===2?"white":o.available?I9.onColor:I9.offColor,o=>o.available?Ni:ote),cte=me(pC)(lte||(lte=q([`
  transform: translateX(2px);
  `,`:hover & {
    transform: translateX(-7px);
  }
`])),Bb),hte=me(pC)(ute||(ute=q([`
  transform: translateX(-2px);
  `,`:hover & {
    transform: translateX(7px);
  }
`])),Bb),(o=>{let l=me.g(dte||(dte=q([`
    stroke-width: 1;
    `,`:hover & path {
      stroke-width: 3;
    }
  `])),pC);o.Prev=()=>g0.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g0.default.createElement(l,{transform:"translate(6 3)"},g0.default.createElement("path",{d:"M4 1L1 4L4 7",stroke:"currentColor"}))),o.Next=()=>g0.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g0.default.createElement(l,{transform:"translate(1 3)"},g0.default.createElement("path",{d:"M1 1L4 4L1 7",stroke:"currentColor"})));let h=me.g(fte||(fte=q([`
    stroke-width: 0;
    `,`:hover & path {
      stroke: currentColor;
      stroke-width: 2;
    }
  `])),mL);o.Cur=()=>g0.default.createElement("svg",{width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g0.default.createElement(h,{transform:"translate(1 4)"},g0.default.createElement("path",{d:"M3 0L6 3L3 6L0 3L3 0Z",fill:"currentColor"})))})(Ub||(Ub={})),pte=o=>{var l,h,m,_,w;let C=x6((l=o.prev)==null?void 0:l.itemKey),R=x6(((h=o.cur)==null?void 0:h.type)==="on"?o.cur.itemKey:void 0),N=x6((m=o.next)==null?void 0:m.itemKey);return g0.default.createElement(Bb,null,g0.default.createElement(cte,A({available:!!o.prev,onClick:(_=o.prev)==null?void 0:_.jump,flag:C.flag},C.attrs),g0.default.createElement(Ub.Prev,null)),g0.default.createElement(mL,A({isOn:o.cur.type==="on",onClick:o.cur.toggle,presence:R.flag},R.attrs),g0.default.createElement(Ub.Cur,null)),g0.default.createElement(hte,A({available:!!o.next,onClick:(w=o.next)==null?void 0:w.jump,flag:N.flag},N.attrs),g0.default.createElement(Ub.Next,null)))},gL=pte}),gC,zb,mte,gte,vte,yte,xte,_te,bte,Vb,Ste=P(()=>{Hd(),gC=K($e()),Xt(),Se(),mC(),P9(),zb={defaultState:{color:zp(.95,"#C4C4C4"),hoverColor:zp(.15,I9.onColor)},withStaticOverride:{color:zp(.85,"#C4C4C4"),hoverColor:zp(.15,I9.onColor)}},gte=me.div(mte||(mte=q([`
  width: 16px;
  margin: 0 0px 0 2px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  color: `,`;

  &:hover {
    color: `,`;
  }
`])),o=>o.hasStaticOverride?zb.withStaticOverride.color:zb.defaultState.color,o=>o.hasStaticOverride?zb.withStaticOverride.hoverColor:zb.defaultState.hoverColor),yte=me.div(vte||(vte=q([`
  width: 5px;
  height: 5px;
  border-radius: 1px;
  transform: rotate(45deg);
  /* border: 1px solid currentColor; */
  background-color: currentColor;
`]))),_te=me.div(xte||(xte=q([`
  width: 5px;
  height: 5px;
  background-color: currentColor;
  border-radius: 1px;
  transform: rotate(45deg);
`]))),bte=o=>{let{hasStaticOverride:l,obj:h,propConfig:m,pathToProp:_}=o;return gC.default.createElement(gte,{hasStaticOverride:l,onClick:()=>{de().transaction(({stateEditors:w})=>{for(let{path:C,conf:R}of y6(m,_)){if(Wp(R))continue;let N=V(A({},h.address),{pathToProp:C});w.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(N,m)}})},title:"Sequence this prop"},l?gC.default.createElement(_te,{title:"The default value is overridden"}):gC.default.createElement(yte,{title:"This is the default value for this prop"}))},Vb=bte});function wte(o,l,h){if(!l||l.data.keyframes.length===0)return Ete;let m=vL.get(l.data);if(m&&m[0]===h)return m[1];function _(C){if(!l)return;let R=l.data.keyframes[C];return R&&{kf:R,track:l,itemKey:Ga.forTrackKeyframe(o,l.id,R.id)}}let w=(()=>{let C=l.data.keyframes.findIndex(N=>N.position>=h);if(C===-1)return{prev:_(l.data.keyframes.length-1)};let R=_(C);return R.kf.position===h?{prev:_(C-1),cur:R,next:_(C+1)}:{next:R,prev:_(C-1)}})();return vL.set(l.data,[h,w]),w}var vL,Ete,Tte=P(()=>{Yd(),vL=new WeakMap,Ete={}}),Mte,FSe=P(()=>{Mte={}});function Cte(o,l,h){let m=(0,Oh.getPointerParts)(o).path;return jr(()=>{if(!hL(h))return{type:"AllStatic",beingScrubbed:!1,contextMenuItems:[],controlIndicators:X5.default.createElement(Vb,{hasStaticOverride:!1,obj:l,pathToProp:m,propConfig:h})};let _=!!(0,Oh.val)(Tc(de().atomP.ephemeral.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].stateByObjectKey[l.address.objectKey].valuesBeingScrubbed,(0,Oh.getPointerParts)(o).path)),w=[],C={beingScrubbed:_,contextMenuItems:w,controlIndicators:X5.default.createElement(X5.default.Fragment,null)},R=(0,Oh.val)(l.template.getMapOfValidSequenceTracks_forStudio()),N=R9(R,m),F=N!==void 0&&Object.keys(N).length!==0,U=[],$=(0,Oh.val)(l.template.getStaticButNotSequencedOverrides()),j=R9($??Mte,m)!==void 0;if(F)for(let G of y6(h,[])){if(Wp(G.conf))continue;let Y=R9(N,G.path);typeof Y!="string"?j=!0:U.push(Y)}if((j||F)&&w.push({label:"Reset all to default",callback:()=>{de().transaction(({unset:G})=>{G(o)})}}),F&&w.push({label:"Make all static",callback:()=>{de().transaction(({stateEditors:G})=>{for(let{path:Y,conf:Z}of y6(h,[])){if(Wp(Z))continue;let ne=V(A({},l.address),{pathToProp:[...m,...Y]}),ae=d6(o,Y);G.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic(V(A({},ne),{value:l.getValueByPointer(ae)}))}})}}),(!F||F&&j)&&w.push({label:"Sequence all",callback:()=>{de().transaction(({stateEditors:G})=>{for(let{path:Y,conf:Z}of y6(h,m)){if(Wp(Z))continue;let ne=V(A({},l.address),{pathToProp:Y});G.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(ne,h)}})}}),F){let G=Oh.prism.memo("controlIndicators",()=>X5.default.createElement(BSe,{pointerToProp:o,obj:l,possibleSequenceTrackIds:N,listOfDescendantTrackIds:U}),[N,U]);return V(A({},C),{type:"HasSequences",controlIndicators:G})}else return V(A({},C),{type:"AllStatic",controlIndicators:X5.default.createElement(Vb,{hasStaticOverride:j,obj:l,pathToProp:m,propConfig:h})})},[])}function BSe({pointerToProp:o,obj:l,possibleSequenceTrackIds:h,listOfDescendantTrackIds:m}){return jr(()=>{let _=(0,Oh.getPointerParts)(o).path,w=(0,Oh.val)(l.sheet.getSequence().positionPrism),C=m.map(G=>({trackId:G,track:(0,Oh.val)(l.template.project.pointers.historic.sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[G])})).filter(({track:G})=>!!G).map(G=>V(A({},G),{nearbies:wte(l,{id:G.trackId,data:G.track,sheetObject:l},w)})),R=C.find(({nearbies:G})=>!!G.cur),N=C.every(({nearbies:G})=>!!G.cur),F=C.reduce((G,Y)=>Y.nearbies.prev&&(G===void 0||Y.nearbies.prev.kf.position>G.kf.position)?Y.nearbies.prev:G,void 0),U=C.reduce((G,Y)=>Y.nearbies.next&&(G===void 0||Y.nearbies.next.kf.position<G.kf.position)?Y.nearbies.next:G,void 0),$=()=>{N?de().transaction(G=>{G.unset(o)}):R?de().transaction(G=>{G.set(o,(0,Oh.val)(o))}):de().transaction(G=>{G.set(o,(0,Oh.val)(o))})},j={cur:R?{type:"on",itemKey:Ga.forCompoundPropAggregateKeyframe(l,_,w),toggle:$}:{toggle:$,type:"off"},prev:F!==void 0?{position:F.kf.position,itemKey:Ga.forCompoundPropAggregateKeyframe(l,_,F.kf.position),jump:()=>{l.sheet.getSequence().position=F.kf.position}}:void 0,next:U!==void 0?{position:U.kf.position,itemKey:Ga.forCompoundPropAggregateKeyframe(l,_,U.kf.position),jump:()=>{l.sheet.getSequence().position=U.kf.position}}:void 0};return X5.default.createElement(gL,A({},j))},[o,l,h,m])}var Oh,X5,Ate=P(()=>{Se(),uC(),ur(),Oh=rn(),H0(),X5=K($e()),Ste(),P9(),Yd(),Tb(),mC(),Tte(),FSe()});function USe(o,l,h){return(0,tf.prism)(()=>{var m;let _=(0,tf.getPointerParts)(o).path,w=l.getValueByPointer(o),C=tf.prism.memo("editPropValue",()=>{let Y=null;return{temporarilySetValue(Z){Y||(Y=de().scrub()),Y.capture(ne=>{ne.set(o,Z)})},discardTemporaryValue(){Y&&(Y.discard(),Y=null)},permanentlySetValue(Z){Y?(Y.capture(ne=>{ne.set(o,Z)}),Y.commit(),Y=null):de().transaction(ne=>{ne.set(o,Z)})}}},[]),R={createAsset:Y=>l.sheet.project.assetStorage.createAsset(Y),getAssetUrl:Y=>Y.id?l.sheet.project.assetStorage.getAssetUrl(Y.id):void 0},N=(0,tf.val)(Tc(de().atomP.ephemeral.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].stateByObjectKey[l.address.objectKey].valuesBeingScrubbed,(0,tf.getPointerParts)(o).path))===!0,F=[],U=V(A(A({},C),R),{value:w,beingScrubbed:N,contextMenuItems:F,controlIndicators:_6.default.createElement(_6.default.Fragment,null)}),$=NSe(h);if($){let Y=(0,tf.val)(l.template.getMapOfValidSequenceTracks_forStudio()),Z=R9(Y,_);if(typeof Z=="string"){F.push({label:"Make static",callback:()=>{de().transaction(({stateEditors:_e})=>{let it=V(A({},l.address),{pathToProp:_});_e.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic(V(A({},it),{value:l.getValueByPointer(o)}))})}});let ne=Z,ae=tf.prism.sub("lcr",()=>{let _e=(0,tf.val)(l.template.project.pointers.historic.sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[ne]),it=(0,tf.val)(l.sheet.getSequence().positionPrism);return wte(l,_e&&{data:_e,id:ne,sheetObject:l},it)},[ne]),ce;U.beingScrubbed?ce="Sequenced_OnKeyframe_BeingScrubbed":ae.cur?ce="Sequenced_OnKeyframe":((m=ae.prev)==null?void 0:m.kf.connectedRight)===!0?ce="Sequenced_BeingInterpolated":ce="Sequened_NotBeingInterpolated";let ve=()=>{ae.cur?de().transaction(_e=>{_e.unset(o)}):de().transaction(_e=>{_e.set(o,U.value)})},Me={cur:ae.cur?{type:"on",itemKey:ae.cur.itemKey,toggle:ve}:{type:"off",toggle:ve},prev:ae.prev!==void 0?{itemKey:ae.prev.itemKey,position:ae.prev.kf.position,jump:()=>{l.sheet.getSequence().position=ae.prev.kf.position}}:void 0,next:ae.next!==void 0?{itemKey:ae.next.itemKey,position:ae.next.kf.position,jump:()=>{l.sheet.getSequence().position=ae.next.kf.position}}:void 0},Te=_6.default.createElement(gL,A({},Me));return V(A({},U),{type:"Sequenced",shade:ce,nearbyKeyframes:ae,controlIndicators:Te})}}let j=(0,tf.val)(l.template.getStaticValues()),G=R9(j,_);return typeof G<"u"&&F.push({label:"Reset to default",callback:()=>{de().transaction(({unset:Y})=>{Y(o)})}}),$&&F.push({label:"Sequence",callback:()=>{de().transaction(({stateEditors:Y})=>{let Z=V(A({},l.address),{pathToProp:_});Y.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(Z,h)})}}),typeof G<"u"?V(A({},U),{type:"Static",shade:U.beingScrubbed?"Static_BeingScrubbed":"Static",controlIndicators:_6.default.createElement(Vb,{hasStaticOverride:!0,obj:l,pathToProp:_,propConfig:h})}):V(A({},U),{type:"Default",shade:"Default",controlIndicators:_6.default.createElement(Vb,{hasStaticOverride:!0,obj:l,pathToProp:_,propConfig:h})})})}function zSe(o,l,h){if(vC.has(o))return vC.get(o);{let m=USe(o,l,h);return vC.set(o,m),m}}function VSe(o,l,h){let m=zSe(o,l,h);return lq(m)}var _6,tf,vC,GSe=P(()=>{H0(),_6=K($e()),tf=rn(),Se(),uC(),ur(),P9(),Ste(),Tte(),mC(),vC=new WeakMap});function jSe(o){return yC.has(o)||yC.set(o,(Pte++).toString()),yC.get(o)}var yC,Pte,HSe=P(()=>{yC=new WeakMap,Pte=0}),Rte,b6,Ite,kte,Nte,Dte,Ote,yL,Lte,Fte,Bte=P(()=>{ur(),Rte=K($e()),Xt(),hn(),M9(),$i(),b6=rn(),Ite="32px",me.div(kte||(kte=q([`
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  position: fixed;
  right: 8px;
  top: 50px;
  // Temporary, see comment about CSS grid in SingleRowPropEditor.
  width: 280px;
  height: fit-content;
  z-index: `,`;

  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border-radius: 2px;

  display: `,`;

  &:hover {
    display: block;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Ni,H5.propsPanel,({pin:o})=>o?"block":"none"),me.div(Nte||(Nte=q([`
  margin: 0 10px;
  color: #919191;
  font-weight: 500;
  font-size: 10px;
  user-select: none;
  `,`;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`])),Ni),me.div(Dte||(Dte=q([`
  height: `,`;
  display: flex;
  align-items: center;
`])),Ite),me.div(Ote||(Ote=q([`
  `,`;
  max-height: calc(100vh - 100px);
  overflow-y: scroll;
  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
  padding: 0;
  user-select: none;

  /* Set the font-size for input values in the detail panel */
  font-size: 12px;
`])),Ni),yL=(0,Rte.createContext)([!1,()=>()=>{}]),Lte=new b6.Atom(!1),Fte=new b6.Atom(!1),(0,b6.prism)(()=>{let o=(0,b6.val)(Fte.prism),l=(0,b6.val)(Lte.prism);return o||l})});function J0(o,l){let[h,m]=xQ(o,l),[,_]=(0,S6.useContext)(yL);return(0,S6.useEffect)(()=>{var w;let C;return h.isOpen&&((w=l.onOpen)==null||w.call(l),C=_()),()=>C==null?void 0:C()},[h.isOpen,l.onOpen]),[h.isOpen?S6.default.createElement(vQ,{items:l.menuItems,displayName:l.displayName,clickPoint:h.event,onRequestClose:m}):Ute,m,h.isOpen]}var S6,Ute,el=P(()=>{S6=K($e()),Zbe(),Qbe(),Bte(),Ute=S6.default.createElement(S6.default.Fragment,null)}),Jm,zte,xL,Vte,xC,Gte,_L,jte,Hte,Wte,$te,qte,Xte,Yte,Kte,Zte,bL,_C=P(()=>{$i(),Jm=K($e()),Eb(),Xt(),Ym(),kO(),el(),xL=me.li(zte||(zte=q([`
  --depth: `,`;
  margin: 0;
  padding: 0;
  list-style: none;
`])),o=>o.depth-1),xC=me.div(Vte||(Vte=q([`
  border-bottom: 1px solid #7695b705;
`]))),_L=me(xC)(Gte||(Gte=q([`
  padding-left: calc(var(--depth) * 10px);

  display: flex;
  align-items: stretch;
  color: `,`;

  box-sizing: border-box;

  `,`;
`])),Jy.panel.body.compoudThing.label.color,o=>o.isSelected&&"background: blue"),Hte=me.span(jte||(jte=q([`
  `,`;
  overflow-x: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding-right: 4px;
  line-height: 26px;
  flex-wrap: nowrap;
  width: 100%;

  `,`:hover & {
    color: #ccc;
  }
`])),Kd,_L),$te=me.span(Wte||(Wte=q([`
  color: #6a9955;
  font-size: 12px;
  margin-right: auto;
  margin-left: 8px;
  opacity: 0.8;
  font-weight: normal;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`]))),Xte=me.span(qte||(qte=q([`
  width: 12px;
  padding: 8px;
  font-size: 9px;
  display: flex;
  align-items: center;

  transition: transform 0.05s ease-out, color 0.1s ease-out;
  transform: rotateZ(`,`deg);
  color: #66686a;

  &:hover {
    transform: rotateZ(`,`deg);
    color: #c0c4c9;
  }
`])),o=>o.isCollapsed?0:90,o=>o.isCollapsed?15:75),Kte=me.ul(Yte||(Yte=q([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),Zte=({leaf:o,label:l,children:h,isSelectable:m,isSelected:_,toggleSelect:w,toggleCollapsed:C,isCollapsed:R,valueDisplay:N,contextMenuItems:F})=>{let U=Array.isArray(h)&&h.length>0,$=(0,Jm.useRef)(null);IO($.current,o);let[j]=J0($.current,{menuItems:F??[]});return o.shouldRender?Jm.default.createElement(xL,{depth:o.depth},j,Jm.default.createElement(_L,{ref:$,style:{height:o.nodeHeight+"px"},isSelectable:m===!0,isSelected:_===!0,onClick:w,isEven:o.n%2===0},Jm.default.createElement(Xte,{isCollapsed:R,onClick:C},Jm.default.createElement(Dbe,null)),Jm.default.createElement(Hte,{onClick:C},l),N&&Jm.default.createElement($te,null,N)),U&&Jm.default.createElement(Kte,null,h)):null},bL=Zte});function WSe(o,l){if(o.length!==l.length)return!1;for(let h=0;h<o.length;h++)if(o[h]!==l[h])return!1;return!0}function SL(o){var l;let h=[];for(;;){let m=h.length,_=(l=o[0])==null?void 0:l[m];if(_===void 0)return h;for(let w of o)if(_!==w[m])return h;h.push(_)}}var nf,wL,k9=P(()=>{uL(),nf=lC(o=>JSON.stringify(o)),wL=o=>JSON.parse(o)});function $Se(o,l){let h=(0,EL.useRef)({combo:o,listener:l});h.current={combo:o,listener:l},(0,EL.useEffect)(()=>{function m(C){C.key===h.current.combo&&h.current.listener({down:!0,event:C})}function _(C){C.key===h.current.combo&&h.current.listener({down:!1,event:C})}function w(C){h.current.listener({down:!1,event:void 0})}return document.addEventListener("keydown",m),document.addEventListener("keyup",_),window.addEventListener("blur",w),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",_),window.removeEventListener("blur",w)}},[])}var EL,qSe=P(()=>{EL=K($e())});function Qte(o){let[l,h]=(0,Jte.useState)(!1);return $Se(o,({down:m})=>{h(m)}),l}var Jte,ene=P(()=>{Jte=K($e()),qSe()});function XSe(o){let l=(0,TL.useMemo)(()=>new tne.Atom(o),[]);return(0,TL.useLayoutEffect)(()=>{l.set(o)},[o]),l}var tne,TL,YSe=P(()=>{tne=rn(),TL=K($e())});function nne(o,l,h){let m=(0,ML.pointer)({root:{},path:[]}),_=l(m);to(o,(0,ML.getPointerParts)(_).path,h)}var ML,KSe=P(()=>{ML=rn(),po()}),bC,rne,tl,rf=P(()=>{bC="data-pos",rne={checkIfMouseEventSnapToPos(o,l){let h=o.composedPath().find(m=>m instanceof Element&&m!==(l==null?void 0:l.ignore)&&m.hasAttribute(bC));if(h){let m=parseFloat(h.getAttribute(bC));if(isFinite(m))return m}return null},includePositionSnapAttrs(o){return{[bC]:o}}},tl=rne});function SC(o){let l=o.type==="sheet"?QSe(o):CL(o);return{byPosition:ZSe(l),tracks:l}}function ZSe(o){let l=new Map;for(let h of o)for(let m of h.data.keyframes){let _=l.get(m.position);_||(_=[],l.set(m.position,_)),_.push({kf:m,track:h,itemKey:Ga.forTrackKeyframe(h.sheetObject,h.id,m.id)})}return l}function QSe(o){return o.children.filter(l=>l.type==="sheetObject").flatMap(CL)}function CL(o){return o.children.flatMap(l=>l.type==="propWithChildren"?CL(l):JSe(l))}function JSe(o){let l=o.sheetObject,h=l.address.projectId,m=de().atomP.historic.coreByProject[h].sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey],_=(0,AL.val)(m.trackIdByPropPath[nf(o.pathToProp)]);if(!_)return[];let w=(0,AL.val)(m.trackData[_]);return w?[{id:_,data:w,sheetObject:l}]:[]}var AL,wC=P(()=>{Se(),AL=rn(),Yd(),k9()});function ewe(o,l){let[h,m]=ui(null),_=o6("useCaptureSelection");return Hs(l,(0,w6.useMemo)(()=>({debugName:"DopeSheetSelectionView/useCaptureSelection",dontBlockMouseDown:!0,lockCSSCursorTo:"cell",onDragStart(w){if(!w.shiftKey||w.target instanceof HTMLInputElement)return!1;let C=l.getBoundingClientRect(),R=w.clientX-C.left-(0,Lh.val)(o.scaledSpace.leftPadding),N=(0,Lh.val)(o.scaledSpace.toUnitSpace)(R);return h.current={h:[N,N],v:[w.clientY-C.top,w.clientY-C.top]},(0,Lh.val)(o.selectionAtom).set({current:void 0}),{onDrag(F,U,$){let j=l.getBoundingClientRect(),G=$.clientX-j.left-(0,Lh.val)(o.scaledSpace.leftPadding),Y=(0,Lh.val)(o.scaledSpace.toUnitSpace)(G);h.current={h:[h.current.h[0],Y],v:[h.current.v[0],$.clientY-j.top]};let Z=PL.boundsToSelection(_,(0,Lh.val)(o),h.current);(0,Lh.val)(o.selectionAtom).set({current:Z})},onDragEnd(F){h.current=null}}}}),[o,l,h])),m}var Lh,w6,Y5,ine,sne,one,PL,ane,lne,RL,cne,une,twe=P(()=>{Se(),Oo(),ene(),YSe(),KSe(),zi(),ur(),Lh=rn(),w6=K($e()),Xt(),rf(),wC(),W5(),Y5=5,sne=me.div(ine||(ine=q([`
  cursor: `,`;
`])),o=>o.isShiftDown?"cell":"default"),one=({layoutP:o,children:l,height:h})=>{let[m,_]=ui(null),w=Qte("Shift"),C=ewe(o,_),R=(0,w6.useRef)(C);return R.current=C,w6.default.createElement(sne,{style:{height:h+"px"},ref:m,isShiftDown:w,className:"selectionview"},C&&w6.default.createElement(cne,{state:C,layoutP:o}),l)},(o=>{let l=(C,R,N,F,U)=>{let $=SC(N);if(N.top+N.nodeHeight/2+Y5>F.v[0]&&N.top+N.nodeHeight/2-Y5<F.v[1])for(let[j,G]of $.byPosition){let Y=R.scaledSpace.toUnitSpace(Y5);if(!(j+Y<=F.h[0]||j-Y>=F.h[1]))for(let Z of G)nne(U,ne=>ne[Z.track.sheetObject.address.objectKey].byTrackId[Z.track.id].byKeyframeId[Z.kf.id],!0)}m(C,R,N,F,U)},h={sheet(C,R,N,F,U){l(C,R,N,F,U)},propWithChildren(C,R,N,F,U){l(C,R,N,F,U)},sheetObject(C,R,N,F,U){l(C,R,N,F,U)},primitiveProp(C,R,N,F,U){let{sheetObject:$,trackId:j}=N;if(!j)return;let G=(0,Lh.val)(de().atomP.historic.coreByProject[$.address.projectId].sheetsById[$.address.sheetId].sequence.tracksByObject[$.address.objectKey].trackData[j]);if(!(F.v[0]>N.top+N.nodeHeight/2+Y5||N.top+N.nodeHeight/2-Y5>F.v[1]))for(let Y of G.keyframes){let Z=R.scaledSpace.toUnitSpace(Y5);if(!(Y.position+Z<=F.h[0])){if(Y.position-Z>=F.h[1])break;nne(U,ne=>ne[$.address.objectKey].byTrackId[j].byKeyframeId[Y.id],!0)}}}},m=(C,R,N,F,U)=>{if("children"in N)for(let $ of N.children)_(C,R,$,F,U)};function _(C,R,N,F,U){if(!N.shouldRender){m(C,R,N,F,U);return}if(F.v[0]>N.top+N.heightIncludingChildren||N.top>F.v[1])return;let $=h[N.type];$?$(C,R,N,F,U):m(C,R,N,F,U)}function w(C,R,N){let F={};N=RL(N);let U=R.tree;_(C.utilFor.internal(),R,U,N,F);let $=R.tree.sheet;return{type:"DopeSheetSelection",byObjectKey:F,getDragHandlers(j){return{debugName:"DopeSheetSelectionView/boundsToSelection",onDragStart(){let G,Y=R.scaledSpace.toUnitSpace;return{onDrag(Z,ne,ae){G&&(G.discard(),G=void 0);let ce=tl.checkIfMouseEventSnapToPos(ae,{ignore:j.domNode}),ve=ce!=null?ce-j.positionAtStartOfDrag:Y(Z);G=de().tempTransaction(({stateEditors:Me})=>{let Te=Me.coreByProject.historic.sheetsById.sequence.transformKeyframes;for(let _e of Object.keys(F)){let{byTrackId:it}=F[_e];for(let Re of Object.keys(it)){let{byKeyframeId:xe}=it[Re];Te({trackId:Re,keyframeIds:Object.keys(xe),translate:ve,scale:1,origin:0,snappingFunction:$.getSequence().closestGridPosition,objectKey:_e,projectId:j.projectId,sheetId:j.sheetId})}}})},onDragEnd(Z){Z?G==null||G.commit():G==null||G.discard()}}}}},delete(){de().transaction(({stateEditors:j})=>{let G=j.coreByProject.historic.sheetsById.sequence.deleteKeyframes;for(let Y of Object.keys(F)){let{byTrackId:Z}=F[Y];for(let ne of Object.keys(Z)){let{byKeyframeId:ae}=Z[ne];G(V(A({},$.address),{objectKey:Y,trackId:ne,keyframeIds:Object.keys(ae)}))}}})}}}o.boundsToSelection=w})(PL||(PL={})),lne=me.div(ane||(ane=q([`
  position: absolute;
  background: rgba(255, 255, 255, 0.1);
  border: 1px dashed rgba(255, 255, 255, 0.4);
  box-sizing: border-box;
`]))),RL=o=>({h:[...o.h].sort((l,h)=>l-h),v:[...o.v].sort((l,h)=>l-h)}),cne=({state:o,layoutP:l})=>{let h=XSe(o);return jr(()=>{let m=(0,Lh.val)(h.pointer),_=RL(m),w=(0,Lh.val)(l.scaledSpace.fromUnitSpace),C=(0,Lh.val)(l.scaledSpace.leftPadding),R=_.h.map(w).map(j=>j+C),N=_.v[0],F=_.v[1]-_.v[0],U=R[0],$=R[1]-R[0];return w6.default.createElement(lne,{style:{top:N+"px",height:F+"px",left:U+"px",width:$+"px"}})},[l,h])},une=one}),ku,hne,dne,fne,IL,kL,NL,pne,mne,gne,EC=P(()=>{e6(),ku=K($e()),Xt(),e1(),hne=rn(),fne=me.div(dne||(dne=q([`
  position: absolute;
  top: 30px;
  right: 0;
  left: 0;
  bottom: 0;
  overflow-x: hidden;
  overflow-y: scroll;
  z-index: `,`;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
`])),()=>lf.scrollableArea),IL=(0,ku.createContext)(Wd),kL=(0,ku.createContext)(null),NL=()=>(0,ku.useContext)(kL),pne=()=>(0,ku.useContext)(IL),mne=o=>{let l=(0,ku.useRef)(null),h=(0,ku.useCallback)(w=>{l.current.scrollBy(0,w.deltaY)},[]),m=(0,ku.useMemo)(()=>new hne.Atom({scrollTop:0,clientHeight:0}),[]),_=(0,ku.useCallback)(()=>{l.current&&m.set({scrollTop:l.current.scrollTop,clientHeight:l.current.clientHeight})},[m]);return(0,ku.useLayoutEffect)(()=>{l.current&&m.set({scrollTop:l.current.scrollTop,clientHeight:l.current.clientHeight});let w=l.current;if(!w)return;let C=new ResizeObserver(()=>{m.set({scrollTop:w.scrollTop,clientHeight:w.clientHeight})});return C.observe(w),()=>C.disconnect()},[m]),ku.default.createElement(kL.Provider,{value:m.pointer},ku.default.createElement(IL.Provider,{value:h},ku.default.createElement(fne,{ref:l,onScroll:_,id:"VerticalScrollContainer"},o.children)))},gne=mne}),DL,vne=P(()=>{DL='data:image/svg+xml,<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">%0D%0A  <path d="M1 7V1H7" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A  <path d="M7 33H1L1 27" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A  <path d="M33 27V33H27" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A  <path d="M27 1L33 1V7" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A</svg>'}),sf,TC=P(()=>{sf=(o,l=o)=>`
  left: `.concat(o*-.5,`px;
  top: `).concat(l*-.5,`px;
  width: `).concat(o,`px;
  height: `).concat(l,`px;
`)}),MC,yne,xne,nwe=P(()=>{MC=rn(),yne=(0,MC.prism)(()=>{let[o,l]=MC.prism.state("pos",null);return MC.prism.effect("setupListeners",()=>{let h=m=>{l(m)};return document.addEventListener("mousemove",h),()=>{document.removeEventListener("mousemove",h)}},[]),o}),xne=yne}),eg,ql,Gb,_ne,bne,Sne,OL,$p,qp,CC,wne,Ene,ba=P(()=>{eg=rn(),nwe(),m0(),ql=K($e()),Gb=(0,ql.createContext)(null),_ne=0,bne=({children:o,layoutP:l})=>{let h=(0,ql.useMemo)(()=>new eg.Atom([]),[]),m=(0,ql.useMemo)(()=>(0,eg.prism)(()=>{let C=eg.prism.memo("p",()=>wne(l),[l]).getValue(),R=(0,eg.val)(h.pointer);return R.length>0?Vm(R).position:C}),[l]),_=(0,ql.useCallback)(()=>{let C=_ne++;return h.reduce(R=>[...R,{id:C,position:[-1,0]}]),{set:R=>{h.reduce(N=>{let F=N.findIndex($=>$.id===C);if(F===-1)return console.warn("Lock is already freed. This is a bug."),N;let U=[...N];return U.splice(F,1,{id:C,position:[R,R===-1?0:1]}),U})},unlock:()=>{h.reduce(R=>R.filter(N=>N.id!==C))}}},[]),w={currentD:m,getLock:_};return ql.default.createElement(Gb.Provider,{value:w},o)},Sne=()=>(0,ql.useContext)(Gb).currentD,OL=()=>{let{getLock:o}=(0,ql.useContext)(Gb),l=(0,ql.useRef)();return(0,ql.useLayoutEffect)(()=>()=>{var h;(h=l.current)==null||h.unlock()},[]),(0,ql.useMemo)(()=>{let h;return(m,_)=>{var w,C;(h==null?void 0:h.shouldLock)!==m&&(m?l.current=o():(w=l.current)==null||w.unlock()),(h==null?void 0:h.pos)!==_&&m&&((C=l.current)==null||C.set(_)),h={shouldLock:m,pos:_}}},[o])},$p=(o,l)=>{let{getLock:h}=(0,ql.useContext)(Gb),m=(0,ql.useRef)();(0,ql.useLayoutEffect)(()=>{if(o)return m.current=h(),()=>{m.current.unlock()}},[o,h]),(0,ql.useLayoutEffect)(()=>{o&&m.current.set(l)},[l,o])},qp=o=>({[CC]:o==="hide"?o:o.toFixed(3)}),CC="data-theatre-lock-framestamp-to",wne=o=>(0,eg.prism)(()=>{let l=(0,eg.val)(o.rightDims),h=(0,eg.val)(o.clippedSpace.toUnitSpace),m=(0,eg.val)(xne);if(!m)return[-1,0];for(let U of m.composedPath()){if(!(U instanceof HTMLElement||U instanceof SVGElement))break;if(U.hasAttribute(CC)){let $=U.getAttribute(CC);if(typeof $!="string")continue;if($==="hide")return[-1,0];let j=parseFloat($);if(isFinite(j)&&j>=0)return[j,2]}}let{clientX:_,clientY:w}=m,{screenX:C,screenY:R,width:N,height:F}=l;if(K_(_,C,C+N)&&K_(w,R+16,R+F)){let U=_-C;return[h(U),3]}else return[-1,0]}),Ene=bne}),Tne,jb,LL,Mne,Cne,Xl,FL=P(()=>{$i(),K0(),Xt(),vne(),TC(),rf(),ba(),Tne=12,jb=34,LL="beingDragged",Xl={BEING_DRAGGED_CLASS:LL,CSS:Iu(Mne||(Mne=q([`
    position: absolute;
    `,`;
    `,`;

    &.`,` {
      pointer-events: none !important;
    }
  `])),sf(Tne),Ni,LL),CSS_WHEN_SOMETHING_DRAGGING:Iu(Cne||(Cne=q([`
    pointer-events: auto;
    cursor: var(`,`);

    //  thing
    // This box extends the hitzone so the user does not
    // accidentally leave the hitzone
    &:hover:after {
      position: absolute;
      top: calc(50% - `,`px);
      left: calc(50% - `,`px);
      width: `,`px;
      height: `,`px;
      display: block;
      content: ' ';
      background: url(`,`) no-repeat 100% 100%;
      // This icon might also fit: GiConvergenceTarget
    }
  `])),$d,jb/2,jb/2,jb,jb,DL),reactProps(o){return V(A(A({},qp(o.position)),tl.includePositionSnapAttrs(o.position)),{className:o.isDragging?Xl.BEING_DRAGGED_CLASS:""})}}});function AC(){Hb.set({mode:"snapToAll"})}function E6(){Hb.set({mode:"snapToNone"})}function rwe(o){Hb.set({mode:"snapToSome",positions:o})}function iwe(o,l){return Object.fromEntries(Object.entries(o).map(([h,m])=>[h,Object.fromEntries(Object.entries(m.trackData).map(([_,w])=>[_,w.keyframes.filter(C=>l(C,{trackId:_,trackData:w,objectKey:h})).map(C=>C.position)]))]))}var Ane,Pne,BL,Rne,Ine,kne,Nne,Dne,UL,Hb,One,T6=P(()=>{Ane=rn(),Pne=rn(),BL=K($e()),Xt(),FL(),Ine=me.div(Rne||(Rne=q([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  #pointer-root.draggingPositionInSequenceEditor & {
    `,`
  }
`])),Xl.CSS,Xl.CSS_WHEN_SOMETHING_DRAGGING),Nne=me.div(kne||(kne=q([`
  position: absolute;
`]))),Dne=o=>BL.default.createElement(Nne,{style:{top:"".concat(o.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,Pne.val)(o.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(o.position,"px))")}},BL.default.createElement(Ine,A({},Xl.reactProps({isDragging:!1,position:o.position})))),UL=Dne,Hb=new Ane.Atom({mode:"snapToNone"}),One=Hb.prism});function swe(o,l){let h=(0,K5.useMemo)(()=>({debugName:"HorizontallyScrollableArea",onDragStart(_){if(_.target instanceof HTMLInputElement||_.shiftKey||_.altKey||_.ctrlKey||_.metaKey||_.composedPath().some($=>$ instanceof HTMLElement&&$.draggable===!0))return!1;let w=_.clientX-l.getBoundingClientRect().left,C=Bi((0,mo.val)(o.clippedSpace.toUnitSpace)(w),0,1/0),R=(0,mo.val)(o.seeker.setIsSeeking),N=(0,mo.val)(o.sheet).getSequence();N.position=C;let F=C,U=(0,mo.val)(o.scaledSpace.toUnitSpace);return R(!0),AC(),{onDrag($,j,G){let Y=U($),Z=Bi(F+Y,0,N.length),ne=tl.checkIfMouseEventSnapToPos(G,{});ne!=null&&(Z=ne),N.position=Z},onDragEnd(){R(!1),E6()}}}}),[o,l]),[m]=Hs(l,h);kc(m,"draggingPositionInSequenceEditor","ew-resize")}function owe(o,l){let h=pne();(0,K5.useLayoutEffect)(()=>{if(!l)return;let m=w=>{if(w.ctrlKey){w.preventDefault(),w.stopPropagation();let C=w.clientX-l.getBoundingClientRect().left,R=(0,mo.val)(o.clippedSpace.toUnitSpace)(C),N=(0,mo.val)(o.clippedSpace.range),F=1+zL(w.deltaY,[-50,50])*.03,U=Ud(N,G=>(G-R)*F+R),$=(0,mo.val)(o.sheet).getSequence().length,j=$+$*.25;(0,mo.val)(o.clippedSpace.setRange)(awe(U,[0,j]));return}else if(w.shiftKey){w.preventDefault(),w.stopPropagation();let C=(0,mo.val)(o.sheet).getSequence().length,R=(0,mo.val)(o.clippedSpace.range),N=(R.end-R.start)/C,F=zL(w.deltaY||w.deltaX,[-50,50])*.05*N,U=Ud(R,$=>$+F);(0,mo.val)(o.clippedSpace.setRange)(U);return}else{h(w),w.preventDefault(),w.stopPropagation();let C=(0,mo.val)(o.scaledSpace.toUnitSpace)(w.deltaX*1),R=(0,mo.val)(o.clippedSpace.range),N=Ud(R,F=>F+C);(0,mo.val)(o.clippedSpace.setRange)(N);return}},_={capture:!0,passive:!1};return l.addEventListener("wheel",m,_),()=>{l.removeEventListener("wheel",m,_)}},[l,o]),Hs(l,(0,K5.useMemo)(()=>({onDragStart(m){let _=(0,mo.val)(o.clippedSpace.range),w=(0,mo.val)(o.clippedSpace.setRange),C=(0,mo.val)(o.scaledSpace.toUnitSpace);return m.preventDefault(),m.stopPropagation(),{onDrag(R,N,F,U,$){h({deltaY:-$});let j=-C(R),G=Ud(_,Y=>Y+j);w(G)}}},debugName:"HorizontallyScrollableArea Middle Button Drag",buttons:[1],lockCSSCursorTo:"grabbing"}),[o]))}function zL(o,[l,h]){return Math.max(Math.min(o,h),l)}function awe(o,l){return Ud(o,h=>zL(h,l))}function lwe(o,l){(0,K5.useLayoutEffect)(()=>{if(!l)return;let h=(0,mo.prism)(()=>{let C=(0,mo.val)(o.clippedSpace.range);return(0,mo.val)(o.scaledSpace.fromUnitSpace)(C.start)}),m=()=>{let C=h.getValue();l.scrollLeft=C},_=h.onStale(m);m();let w=setTimeout(m,100);return()=>{clearTimeout(w),_()}},[o,l])}var mo,K5,Lne,Fne,Bne,PC,VL=P(()=>{Oo(),zi(),ur(),mo=rn(),m0(),K5=K($e()),Xt(),EC(),$i(),K0(),rf(),T6(),Fne=me.div(Lne||(Lne=q([`
  position: absolute;
  right: 0;
  overflow-x: scroll;
  overflow-y: hidden;
  `,`;

  // hide the scrollbar on Gecko
  scrollbar-width: none;

  // hide the scrollbar on Webkit/Blink
  &::-webkit-scrollbar {
    display: none;
  }
`])),Ni),Bne=K5.default.memo(({layoutP:o,children:l,height:h})=>{let{width:m,unitSpaceToScaledSpaceMultiplier:_}=jr(()=>({width:(0,mo.val)(o.rightDims.width),unitSpaceToScaledSpaceMultiplier:(0,mo.val)(o.scaledSpace.fromUnitSpace)(1)}),[o]),[w,C]=ui(null);return owe(o,C),swe(o,C),lwe(o,C),K5.default.createElement(Fne,{ref:w,style:{width:m+"px",height:h+"px","--unitSpaceToScaledSpaceMultiplier":_}},l)}),PC=Bne}),RC,Une,zne,Vne,Gne,jne,Hne,Wne,Z5,IC=P(()=>{RC=K($e()),Xt(),zne=me.li(Une||(Une=q([`
  margin: 0;
  padding: 0;
  list-style: none;
  box-sizing: border-box;
  position: relative;
`]))),Gne=me.div(Vne||(Vne=q([`
  box-sizing: border-box;
  width: 100%;
  position: relative;

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -40px;
    top: 0;
    bottom: 0;
    right: 0;
    box-sizing: border-box;
    border-bottom: 1px solid #252b3869;
    background: `,`;
  }
`])),o=>o.isEven?"transparent":"#6b8fb505"),Hne=me.ul(jne||(jne=q([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),Wne=({leaf:o,children:l,node:h,isCollapsed:m})=>{let _=Array.isArray(l)&&l.length>0;return o.shouldRender?RC.default.createElement(zne,null,RC.default.createElement(Gne,{style:{height:o.nodeHeight+"px"},isEven:o.n%2===0},h),_&&RC.default.createElement(Hne,null,l)):null},Z5=Wne}),cwe=te((o,l)=>{(function(){var h=this,m={};typeof o<"u"?l.exports=m:h.fuzzy=m,m.simpleFilter=function(_,w){return w.filter(function(C){return m.test(_,C)})},m.test=function(_,w){return m.match(_,w)!==null},m.match=function(_,w,C){C=C||{};var R=0,N=[],F=w.length,U=0,$=0,j=C.pre||"",G=C.post||"",Y=C.caseSensitive&&w||w.toLowerCase(),Z;_=C.caseSensitive&&_||_.toLowerCase();for(var ne=0;ne<F;ne++)Z=w[ne],Y[ne]===_[R]?(Z=j+Z+G,R+=1,$+=1+$):$=0,U+=$,N[N.length]=Z;return R===_.length?(U=Y===_?1/0:U,{rendered:N.join(""),score:U}):null},m.filter=function(_,w,C){return!w||w.length===0?[]:typeof _!="string"?w:(C=C||{},w.reduce(function(R,N,F,U){var $=N;C.extract&&($=C.extract(N));var j=m.match(_,$,C);return j!=null&&(R[R.length]={string:j.rendered,score:j.score,index:F,original:N}),R},[]).sort(function(R,N){var F=N.score-R.score;return F||R.index-N.index}))}})()});function uwe(o,l){let[h,m]=(0,kC.useState)(!1),_=(0,kC.useRef)(l);return h||(_.current=l),(0,kC.useMemo)(()=>o(m),_.current)}var kC,hwe=P(()=>{kC=K($e())}),GL,N9,NC=P(()=>{GL="rgba(26, 28, 30, 0.97);",N9="#272B2F"});function $ne(o,l,h,m){let _=uwe(w=>({debugName:"CurveSegmentEditor/useKeyframeDrag",lockCSSCursorTo:"move",onDragStart(){return w(!0),{onDrag(C,R){o&&h.onCurveChange(m(C,R))},onDragEnd(C){w(!1),h.onCancelCurveChange()}}}}),[o,h.onCurveChange,h.onCancelCurveChange]);Hs(l,_)}var Di,DC,Wb,M6,qne,$b,Xne,OC,Yne,Kne,Zne,C6,Qne,Q5,Jne,ere,jL,tre,LC,nre,HL,rre,ire,dwe=P(()=>{Di=K($e()),Oo(),zi(),Dd(),Xt(),$i(),hwe(),NC(),DC=.12,Wb=1+DC*2,M6=.01,qne=8,$b=(1-M6)/(qne-1),Xne="#3EAAA4",OC="#3EAAA4",Yne="#3EAAA4",Kne="#3EAAA4",Zne="#3EAAA4",C6="#3EAAA4",Qne="#3EAAA4",Q5="#B3B3B3",Jne="#3eaaa4",ere="#67dfd8",jL=["goldenrod","cornflowerblue","dodgerblue","lawngreen"],LC=me.circle(tre||(tre=q([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.04px;
  pointer-events: none;
  transition: r 0.15s;
  fill: `,`;
`])),Jne),HL=me.circle(nre||(nre=q([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.09px;
  cursor: move;
  `,`;
  &:hover {
    opacity: 0.4;
  }
  &:hover + `,` {
    fill: `,`;
  }
`])),Ni,LC,ere),rre=o=>{let{curveConnection:{left:l,right:h},backgroundConnections:m}=o,_=Math.min(0,1-h.handles[1],1-l.handles[3]),w=Math.max(1,1-h.handles[1],1-l.handles[3]),C=Math.max(1,w-_),R=ae=>(ae-_)/C,[N,F]=ui(null),U=Wb/((F==null?void 0:F.clientWidth)||1),$=Wb/((F==null?void 0:F.clientHeight)||1),[j,G]=ui(null);$ne(F,G,o,(ae,ce)=>{let ve=Bi(l.handles[2]+ae*U,0,1),Me=l.handles[3]-ce*$;return[ve,Me,h.handles[0],h.handles[1]]});let[Y,Z]=ui(null);$ne(F,Z,o,(ae,ce)=>{let ve=Bi(h.handles[0]+ae*U,0,1),Me=h.handles[1]-ce*$;return[l.handles[2],l.handles[3],ve,Me]});let ne=ae=>"M0 ".concat(R(1)," C").concat(ae.left.handles[2]," ").concat(R(1-ae.left.handles[3])," ").concat(ae.right.handles[0]," ").concat(R(1-ae.right.handles[1])," 1 ").concat(R(0));return Di.default.createElement("svg",{height:"100%",width:"100%",ref:N,viewBox:"".concat(-DC," ").concat(-DC," ").concat(Wb," ").concat(Wb),xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",fill:"none"},Di.default.createElement("linearGradient",{id:"myGradient",gradientTransform:"rotate(90)"},Di.default.createElement("stop",{offset:R(-1),stopColor:Qne}),Di.default.createElement("stop",{offset:R(0),stopColor:C6}),Di.default.createElement("stop",{offset:R(.3),stopColor:Zne}),Di.default.createElement("stop",{offset:R(.5),stopColor:Kne}),Di.default.createElement("stop",{offset:R(.7),stopColor:Yne}),Di.default.createElement("stop",{offset:R(1),stopColor:OC}),Di.default.createElement("stop",{offset:R(2),stopColor:Xne})),Di.default.createElement("pattern",{id:"dot-background-pattern-1",width:$b,height:$b/C,y:-_/C},Di.default.createElement("rect",{width:M6,height:M6,fill:Q5,opacity:.3})),Di.default.createElement("rect",{x:0,y:0,width:"1",height:1,fill:"url(#dot-background-pattern-1)"}),Di.default.createElement("pattern",{id:"dot-background-pattern-2",width:$b,height:$b},Di.default.createElement("rect",{width:M6,height:M6,fill:Q5})),Di.default.createElement("rect",{x:0,y:R(0),width:"1",height:R(1)-R(0),fill:"url(#dot-background-pattern-2)"}),!l.type||l.type==="bezier"?Di.default.createElement(Di.default.Fragment,null,Di.default.createElement("line",{x1:0,y1:R(1),x2:l.handles[2],y2:R(1-l.handles[3]),stroke:Q5,strokeWidth:"0.01"}),Di.default.createElement("line",{x1:1,y1:R(0),x2:h.handles[0],y2:R(1-h.handles[1]),stroke:Q5,strokeWidth:"0.01"}),Di.default.createElement("path",{d:ne(o.curveConnection),stroke:"none",fill:"url('#myGradient')",opacity:"0.1"}),m.map((ae,ce)=>Di.default.createElement("path",{key:ae.objectKey+"/"+ae.left.id,d:ne(ae),stroke:jL[ce%jL.length],opacity:.6,strokeWidth:"0.01"})),Di.default.createElement("path",{d:ne(o.curveConnection),stroke:"url('#myGradient')",strokeWidth:"0.02"}),Di.default.createElement("circle",{cx:0,cy:R(1),r:"0.025",stroke:OC,strokeWidth:"0.02",fill:N9}),Di.default.createElement("circle",{cx:1,cy:R(0),r:"0.025",stroke:C6,strokeWidth:"0.02",fill:N9}),Di.default.createElement(HL,{ref:j,cx:l.handles[2],cy:R(1-l.handles[3]),fill:OC,opacity:.2}),Di.default.createElement(LC,{cx:l.handles[2],cy:R(1-l.handles[3])}),Di.default.createElement(HL,{ref:Y,cx:h.handles[0],cy:R(1-h.handles[1]),fill:C6,opacity:.2}),Di.default.createElement(LC,{cx:h.handles[0],cy:R(1-h.handles[1])})):Di.default.createElement(Di.default.Fragment,null,Di.default.createElement("line",{x1:0,y1:R(1),x2:1,y2:R(1),stroke:Q5,strokeWidth:"0.01"}),Di.default.createElement("line",{x1:1,y1:R(1),x2:1,y2:0,stroke:Q5,strokeWidth:"0.01"}),Di.default.createElement("circle",{cx:0,cy:1,r:"0.025",stroke:C6,strokeWidth:"0.02",fill:N9}),Di.default.createElement("circle",{cx:1,cy:0,r:"0.025",stroke:C6,strokeWidth:"0.02",fill:N9})))},ire=rre}),sre,tg,WL,ore,are,lre,cre,ure=P(()=>{sre=rn(),zi(),tg=K($e()),WL=(0,tg.createContext)(null),ore=0,are=()=>{let o=(0,tg.useMemo)(()=>ore++,[]),{cur:l,set:h}=(0,tg.useContext)(WL),[m,_]=ui(!1),w=(0,tg.useCallback)((C,R)=>{h(C?o:-1,R)},[]);return(0,tg.useEffect)(()=>l.onStale(()=>{let C=l.getValue()===o;m.current!==C&&(m.current=C)}),[l,o]),[_,w]},lre=({children:o})=>{let l=(0,tg.useMemo)(()=>new sre.Atom(-1),[]),h=l.prism,m=(0,tg.useMemo)(()=>{let _;return(w,C)=>{let R=_!==void 0;_!==void 0&&(clearTimeout(_),_=void 0),C===0||R?l.set(w):_=setTimeout(()=>{l.set(w),_=void 0},C)}},[]);return tg.default.createElement(WL.Provider,{value:{cur:h,set:m}},o)},cre=lre});function FC(o,l){let h=o.enabled!==!1,[m,_]=are(),[w,C]=ui(null);(0,dre.useEffect)(()=>{if(!h)return;let N=w.current;if(!N)return;let F=()=>{var $;return _(!0,($=o.enterDelay)!=null?$:400)},U=()=>{var $;return _(!1,($=o.exitDelay)!=null?$:200)};return N.addEventListener("mouseenter",F),N.addEventListener("mouseleave",U),()=>{N.removeEventListener("mouseenter",F),N.removeEventListener("mouseleave",U)}},[w,h,o.enterDelay,o.exitDelay]);let R=(0,hre.useContext)(Qy);return[h&&m&&C?(0,fre.createPortal)(BC.default.createElement(rL,{children:l,target:C,onClickOutside:Wd,verticalPlacement:o.verticalPlacement,verticalGap:o.verticalGap}),R):BC.default.createElement(BC.default.Fragment,null),w,m]}var hre,dre,BC,fre,UC=P(()=>{zi(),hre=K($e()),dre=K($e()),BC=K($e()),eee(),fre=K(Gm()),ure(),j5(),e6()});function zC(o){return o.map(l=>l.toFixed(3)).join(", ")}function VC(o){if(!o||(o==null?void 0:o.length)>pre)return null;let l=o.split(",");if(l.length!==4)return null;let h=l.map(m=>Number(m.trim()));return!h.every(m=>isFinite(m))||h[0]<0||h[0]>1||h[2]<0||h[2]>1?null:h}function fwe(o,l,h={threshold:.02}){if(!o||!l)return!1;let m=0;for(let _=0;_<4;_++)m+=Math.abs(o[_]-l[_]);return m<h.threshold}var pre,GC,mre=P(()=>{pre=128,GC=[{label:"Quad Out",value:"0.250, 0.460, 0.450, 0.940"},{label:"Quad In Out",value:"0.455, 0.030, 0.515, 0.955"},{label:"Quad In",value:"0.550, 0.085, 0.680, 0.530"},{label:"Cubic Out",value:"0.215, 0.610, 0.355, 1.000"},{label:"Cubic In Out",value:"0.645, 0.045, 0.355, 1.000"},{label:"Cubic In",value:"0.550, 0.055, 0.675, 0.190"},{label:"Quart Out",value:"0.165, 0.840, 0.440, 1.000"},{label:"Quart In Out",value:"0.770, 0.000, 0.175, 1.000"},{label:"Quart In",value:"0.895, 0.030, 0.685, 0.220"},{label:"Quint Out",value:"0.230, 1.000, 0.320, 1.000"},{label:"Quint In Out",value:"0.860, 0.000, 0.070, 1.000"},{label:"Quint In",value:"0.755, 0.050, 0.855, 0.060"},{label:"Sine Out",value:"0.390, 0.575, 0.565, 1.000"},{label:"Sine In Out",value:"0.445, 0.050, 0.550, 0.950"},{label:"Sine In",value:"0.470, 0.000, 0.745, 0.715"},{label:"Expo Out",value:"0.190, 1.000, 0.220, 1.000"},{label:"Expo In Out",value:"1.000, 0.000, 0.000, 1.000"},{label:"Expo In",value:"0.780, 0.000, 0.810, 0.00"},{label:"Circ Out",value:"0.075, 0.820, 0.165, 1.000"},{label:"Circ In Out",value:"0.785, 0.135, 0.150, 0.860"},{label:"Circ In",value:"0.600, 0.040, 0.980, 0.335"},{label:"Back Out",value:"0.175, 0.885, 0.320, 1.275"},{label:"Back In Out",value:"0.680, -0.550, 0.265, 1.550"},{label:"Back In",value:"0.600, -0.280, 0.735, 0.045"},{label:"linear",value:"0.5, 0.5, 0.5, 0.5"},{label:"In Out",value:"0.42,0,0.58,1"},{label:"Hold",value:"0, 0, Infinity, Infinity"}]}),nl,jC,J5,$L,gre,vre,qb,qL,XL,yre,xre,pwe=P(()=>{nl=K($e()),jC=.75,J5=.1,$L=1+jC*2,gre="#F5F5F5",vre="#888888",qb="#4f4f4f",qL="rgba(255, 255, 255, 0.1)",XL=o=>1-o,yre=o=>{let{easing:l,isSelected:h}=o,m=h?gre:vre,_="".concat(-jC," ").concat(-jC," ").concat($L," ").concat($L);if(l){let w=[l[0],XL(l[1])],C=[l[2],XL(l[3])];return nl.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},nl.default.createElement("line",{x1:"0",y1:"1",x2:w[0],y2:w[1],stroke:qb,strokeWidth:"0.1"}),nl.default.createElement("line",{x1:"1",y1:"0",x2:C[0],y2:C[1],stroke:qb,strokeWidth:"0.1"}),nl.default.createElement("circle",{cx:w[0],cy:w[1],r:.1,fill:qL}),nl.default.createElement("circle",{cx:C[0],cy:C[1],r:.1,fill:qL}),nl.default.createElement("circle",{cx:w[0],cy:w[1],r:J5,fill:qb}),nl.default.createElement("circle",{cx:C[0],cy:C[1],r:J5,fill:qb}),nl.default.createElement("path",{d:"M0 1 C".concat(w[0]," ").concat(w[1]," ").concat(C[0],` 
        `).concat(C[1]," 1 0"),stroke:m,strokeWidth:"0.08"}),nl.default.createElement("circle",{cx:0,cy:1,r:J5,fill:m}),nl.default.createElement("circle",{cx:1,cy:0,r:J5,fill:m}))}return nl.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},nl.default.createElement("line",{x1:"0",y1:"1",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),nl.default.createElement("line",{x1:"1",y1:"0",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),nl.default.createElement("circle",{cx:0,cy:1,r:J5,fill:m}),nl.default.createElement("circle",{cx:1,cy:0,r:J5,fill:m}))},xre=yre}),Xb,_re,bre,Sre,wre,Ere,Tre,Mre,mwe=P(()=>{UC(),Xb=K($e()),Xt(),mre(),pwe(),qM(),NC(),Qd(),Sre=me.div(bre||(bre=q([`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  aspect-ratio: 1;

  transition: background-color 0.15s;
  background-color: `,`;
  border-radius: 2px;
  cursor: pointer;
  outline: none;

  `,`

  &:hover {
    background-color: #31353a;
  }

  &:focus {
    background-color: #383d42;
  }
`])),N9,({isSelected:o})=>o&&Iu(_re||(_re=q([`
      background-color: #383d42;
    `])))),Ere=me(Dc)(wre||(wre=q([`
  padding: 0.5em;
  color: white;
  max-width: 240px;
  pointer-events: none !important;
  --popover-bg: black;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: transparent;
  box-shadow: none;
`]))),Tre=Xb.default.forwardRef((o,l)=>{let[h,m]=FC({enabled:!0,verticalPlacement:o.tooltipPlacement,verticalGap:0},()=>Xb.default.createElement(Ere,{showPopoverEdgeTriangle:!1},o.easing.label));return Xb.default.createElement(Sre,A({ref:$M([m,l])},o),h,Xb.default.createElement(xre,{easing:VC(o.easing.value),isSelected:o.isSelected}))}),Mre=Tre});function gwe(o){var l;let[h,m]=(0,Cre.useState)(null),_=C=>{if(h===null){o.items.length>0&&m(0);return}let R=h+C*o.uiColumns,N=R<0,F=R>o.items.length-1;if(N||F){if(o.canVerticleExit&&o.canVerticleExit(N?"top":"bottom")){m(null);return}return}m(R)},w=C=>{h===null?m(_we(C,o.items.length)):h+C<0?m(null):m(Math.min(h+C,o.items.length-1))};return{focusFirstItem(){m(0)},onParentEltKeyDown:C=>{if(C.key==="ArrowRight")w(1);else if(C.key==="ArrowLeft")w(-1);else if(C.key==="ArrowUp")_(-1);else if(C.key==="ArrowDown")_(1);else return 0;return 1},gridItems:o.items.map((C,R)=>o.renderItem({isSelected:R===h,item:C,select(N){m(R),o.onSelectItem(C)===1&&(N==null||N.preventDefault(),N==null||N.stopPropagation())}})),currentSelection:(l=o.items[h??-1])!=null?l:null}}var Cre,vwe=P(()=>{Cre=K($e()),$re()});function Are(o,l,h){var m;(m=o.current)==null||m.discard(),o.current=null;let _=VC(h);_===null?o.current=xwe(l):o.current=ywe(l,_)}function Pre(o){var l;(l=o.current)==null||l.discard(),o.current=null}function ywe(o,l){return de().tempTransaction(({stateEditors:h})=>{let{setHandlesForKeyframe:m,setKeyframeType:_}=h.coreByProject.historic.sheetsById.sequence;for(let{projectId:w,sheetId:C,objectKey:R,trackId:N,left:F,right:U}of o)m({projectId:w,sheetId:C,objectKey:R,trackId:N,keyframeId:F.id,start:[l[0],l[1]]}),m({projectId:w,sheetId:C,objectKey:R,trackId:N,keyframeId:U.id,end:[l[2],l[3]]}),_({projectId:w,sheetId:C,objectKey:R,trackId:N,keyframeId:F.id,keyframeType:"bezier"})})}function xwe(o){return de().tempTransaction(({stateEditors:l})=>{let{setKeyframeType:h}=l.coreByProject.historic.sheetsById.sequence;for(let{projectId:m,sheetId:_,objectKey:w,trackId:C,left:R}of o)h({projectId:m,sheetId:_,objectKey:w,trackId:C,keyframeId:R.id,keyframeType:"hold"})})}function _we(o,l){return(o%l+l)%l}function bwe(o,l){return()=>setTimeout(o,l)}function Swe({left:o,right:l}){return({left:h,right:m})=>o.handles[2]!==h.handles[2]||o.handles[3]!==h.handles[3]||l.handles[0]!==m.handles[0]||l.handles[1]!==m.handles[1]}var HC,Ws,Rre,YL,KL,Ire,kre,Nre,Dre,Ore,Lre,Fre,Bre,Ure,zre,Vre,Gre,jre,wwe,Hre,Wre,$re=P(()=>{HC=rn(),Ws=K($e()),Xt(),Rre=K(cwe()),Se(),dwe(),mwe(),mre(),NC(),zi(),vwe(),YL=3,KL=53,Ire=25,Nre=me.div(kre||(kre=q([`
  background: `,`;
  display: grid;
  grid-template-areas:
    'search  tween'
    'presets tween';
  grid-template-rows: 32px 1fr;
  grid-template-columns: `,`px 120px;
  gap: 1px;
  height: 120px;
`])),GL,YL*KL),Ore=me.div(Dre||(Dre=q([`
  overflow: auto;
  grid-area: presets;

  display: grid;
  grid-template-columns: repeat(`,`, 1fr);
  grid-auto-rows: min-content;
  gap: 1px;

  overflow-y: scroll;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
  &::-webkit-scrollbar {
    /* WebKit */
    width: 0;
    height: 0;
  }
`])),YL),Fre=me.input.attrs({type:"text"})(Lre||(Lre=q([`
  background-color: `,`;
  border: none;
  border-radius: 2px;
  color: rgba(255, 255, 255, 0.8);
  padding: 6px;
  font-size: 12px;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: 100%;
  box-sizing: border-box;

  grid-area: search;

  &:hover {
    background-color: #212121;
  }

  &:focus {
    background-color: rgba(16, 16, 16, 0.26);
    outline: 1px solid rgba(0, 0, 0, 0.35);
  }
`])),N9),Ure=me.div(Bre||(Bre=q([`
  grid-area: tween;
  background: `,`;
`])),N9),Vre=me.div(zre||(zre=q([`
  grid-column: 1 / 4;
  padding: 6px;
  color: #888888;
`]))),Gre=o=>{let l=(0,Ws.useMemo)(()=>[o.curveConnection,...o.additionalConnections],[o.curveConnection,...o.additionalConnections]),h=(0,Ws.useRef)(null);(0,Ws.useEffect)(()=>{let Fe=Wre(l);return()=>{var Nt;Fe(),(Nt=h.current)==null||Nt.commit()}},[h]);let m=[o.curveConnection.left.handles[2],o.curveConnection.left.handles[3],o.curveConnection.right.handles[0],o.curveConnection.right.handles[1]],_=(0,Ws.useRef)(null);(0,Ws.useLayoutEffect)(()=>{var Fe,Nt;(Fe=_.current)==null||Fe.select(),(Nt=_.current)==null||Nt.focus()},[_.current]);let[w,C]=(0,Ws.useState)(zC(m)),R=Fe=>{Fe!==void 0&&(U(1),C(Fe.target.value),VC(Fe.target.value)&&j(Fe.target.value))},N=Fe=>{var Nt,Ve;U(1),(Fe.key==="ArrowDown"||Fe.key==="ArrowUp")&&Fe.preventDefault(),Fe.key==="ArrowDown"?(He.focusFirstItem(),(Ve=(Nt=_e.current[ae[0].label])==null?void 0:Nt.current)==null||Ve.focus()):Fe.key==="Escape"?(Pre(h),o.onRequestClose("key Escape")):Fe.key==="Enter"&&o.onRequestClose("key Enter")},[F,U]=(0,Ws.useState)(0);(0,Ws.useEffect)(()=>{F===2?C(zC(m)):F===3&&w!==""&&C("")},l);let[$,j]=(0,Ws.useState)(zC(m)),[G,Y]=(0,Ws.useState)(null);(0,Ws.useEffect)(()=>{var Fe;F!==0&&F!==3&&Are(h,l,(Fe=G??$)!=null?Fe:"")},[G,$,F]),l.some(Swe(o.curveConnection))&&F===0&&U(3);let Z=Fe=>{var Nt,Ve;U(2);let Ht=zC(Fe);C(Ht),j(Ht),(Nt=_.current)==null||Nt.select(),(Ve=_.current)==null||Ve.focus()},ne=()=>{},ae=(0,Ws.useMemo)(()=>/^[A-Za-z]/.test(w)?Rre.default.filter(w,GC,{extract:Fe=>Fe.label}).map(Fe=>Fe.original):GC,[w]);(0,Ws.useEffect)(()=>{F===1&&ae[0]&&j(ae[0].value)},[ae]);let ce=Fe=>{Fe.key==="Escape"?(Pre(h),o.onRequestClose("key Escape"),Fe.stopPropagation()):Fe.key==="Enter"&&(o.onRequestClose("key Enter"),Fe.stopPropagation())},ve=Fe=>{F===0&&U(2),Y(Fe.value)},Me=()=>Y(null),Te=Fe=>(Are(h,l,Fe.value),o.onRequestClose("selected easing option"),1),_e=(0,Ws.useRef)(GC.reduce((Fe,Nt)=>(Fe[Nt.label]={current:null},Fe),{})),[it,Re]=ui(null),[xe,Oe]=(0,Ws.useState)(0);(0,Ws.useEffect)(()=>{let Fe=()=>{var Nt;Oe((Nt=Re==null?void 0:Re.scrollTop)!=null?Nt:0)};return Re==null||Re.addEventListener("scroll",Fe),()=>Re==null?void 0:Re.removeEventListener("scroll",Fe)},[Re]);let He=gwe({items:ae,uiColumns:3,onSelectItem:Te,canVerticleExit(Fe){var Nt,Ve;return Fe==="top"?((Nt=_.current)==null||Nt.select(),(Ve=_.current)==null||Ve.focus(),1):0},renderItem:({item:Fe,select:Nt})=>{var Ve,Ht;return Ws.default.createElement(Mre,{key:Fe.label,easing:Fe,tabIndex:0,onKeyDown:ce,ref:_e.current[Fe.label],onMouseOver:()=>ve(Fe),onMouseOut:Me,onClick:Nt,tooltipPlacement:((Ht=(Ve=_e.current[Fe.label].current)==null?void 0:Ve.offsetTop)!=null?Ht:0)-(xe??0)<KL+Ire?"bottom":"top",isSelected:fwe(m,VC(Fe.value))})}});return(0,Ws.useLayoutEffect)(()=>{var Fe,Nt;if(He.currentSelection!==null&&document.activeElement!==_.current){let Ve=(Nt=(Fe=_e.current)==null?void 0:Fe[He.currentSelection.label])==null?void 0:Nt.current;Ve==null||Ve.focus(),j(He.currentSelection.value),/^[A-Za-z]/.test(w)||C(He.currentSelection.value)}},[He.currentSelection]),Ws.default.createElement(Nre,null,Ws.default.createElement(Fre,{value:w,placeholder:F===3?"Multiple easings selected":"Search presets...",onPaste:bwe(R),onChange:R,ref:_,onKeyDown:N}),Ws.default.createElement(Ore,{ref:it,onKeyDown:Fe=>He.onParentEltKeyDown(Fe)},He.gridItems,He.gridItems.length===0?Ws.default.createElement(Vre,null,"No results found"):void 0),Ws.default.createElement(Ure,{onClick:()=>{var Fe;return(Fe=_.current)==null?void 0:Fe.focus()}},Ws.default.createElement(ire,{curveConnection:o.curveConnection,backgroundConnections:o.additionalConnections,onCurveChange:Z,onCancelCurveChange:ne})))},jre=Gre,{isCurveEditorOpenD:wwe,isConnectionEditingInCurvePopover:Hre,getLock:Wre}=(()=>{let o=new HC.Atom([]);return{getLock(l){return o.set(l),function(){o.set([])}},isCurveEditorOpenD:(0,HC.prism)(()=>o.prism.getValue().length>0),isConnectionEditingInCurvePopover(l){return HC.prism.ensurePrism(),o.prism.getValue().some(({left:h,right:m})=>l.left.id===h.id&&l.right.id===m.id)}}})()});function Ewe(o,l){for(let{keyframeId:h}of Awe(l))if(o.left.id===h)return!0;return!1}function Twe(o,l,h){return(0,WC.prism)(()=>{if(h===void 0)return[];let m=[];for(let{objectKey:_,trackId:w}of Yre(h)){let C=(0,WC.val)(de().atomP.historic.coreByProject[o].sheetsById[l].sequence.tracksByObject[_].trackData[w]);C&&(m=m.concat(Cwe(C.keyframes).filter(R=>Ewe(R,h)).map(({left:R,right:N})=>({left:R,right:N,trackId:w,objectKey:_,sheetId:l,projectId:o}))))}return m})}function qre(o,l,h){var m;if(h===void 0)return[];let _=[];for(let{objectKey:C,trackId:R,keyframeIds:N}of Yre(h))_=_.concat((m=Xre({projectId:o,sheetId:l,objectKey:C,trackId:R,keyframeIds:N}))!=null?m:[]);let w=SL(_.map(C=>C.pathToProp));return _.map(({keyframe:C,pathToProp:R})=>({keyframe:C,pathToProp:R.slice(w.length)}))}function Xre({projectId:o,sheetId:l,objectKey:h,trackId:m,keyframeIds:_}){let w=(0,WC.val)(de().atomP.historic.coreByProject[o].sheetsById[l].sequence.tracksByObject[h]),C=w==null?void 0:w.trackData[m];if(!C)return null;let R=Mwe((w==null?void 0:w.trackIdByPropPath)||{})[m];if(!R)return null;let N=[h,...wL(R)];return _.map(F=>({keyframe:C.keyframes.find(U=>U.id===F),pathToProp:N})).filter(({keyframe:F})=>F!==void 0)}function Mwe(o){let l={};for(let[h,m]of Object.entries(o))l[m]=h;return l}function Cwe(o){return o.map((l,h)=>({left:l,right:o[h+1]})).slice(0,-1)}function Awe(o){var l,h,m;let _=[];for(let[w,C]of Object.entries((l=o==null?void 0:o.byObjectKey)!=null?l:{}))for(let[R,N]of Object.entries((h=C==null?void 0:C.byTrackId)!=null?h:{}))for(let F of Object.keys((m=N==null?void 0:N.byKeyframeId)!=null?m:{}))_.push({objectKey:w,trackId:R,keyframeId:F});return _}function Yre(o){var l,h,m;let _=[];for(let[w,C]of Object.entries((l=o==null?void 0:o.byObjectKey)!=null?l:{}))for(let[R,N]of Object.entries((h=C==null?void 0:C.byTrackId)!=null?h:{}))_.push({objectKey:w,trackId:R,keyframeIds:Object.keys((m=N==null?void 0:N.byKeyframeId)!=null?m:{})});return _}var WC,$C=P(()=>{WC=rn(),Se(),k9()});function Pwe(o,l){return(0,Kre.useMemo)(()=>Rwe(o,l),[])}function Rwe(o,l){let h=null,m=C=>de().tempTransaction(R=>o(R,C));function _(){h==null||h.discard(),h=null}let w={createAsset:l.sheet.project.assetStorage.createAsset,getAssetUrl:C=>C.id?l.sheet.project.assetStorage.getAssetUrl(C.id):void 0};return A({temporarilySetValue(C){_(),h=m(C)},discardTemporaryValue:_,permanentlySetValue(C){_(),m(C).commit()}},w)}var Kre,Iwe=P(()=>{Se(),Kre=K($e())});function ZL(o){var l;if(o.type==="sheetObject")return v0.default.createElement(v0.default.Fragment,null,v0.default.createElement(qC,{style:{paddingLeft:"".concat(o.indent*XC,"px")}},o.sheetObject.address.objectKey),o.children.map((h,m)=>v0.default.createElement(ZL,V(A({key:m},h),{autoFocusInput:o.autoFocusInput&&m===0,indent:o.indent+1}))));if(o.type==="propWithChildren"){let h=(l=o.propConfig.label)!=null?l:Vm(o.pathToProp);return v0.default.createElement(v0.default.Fragment,null,v0.default.createElement(qC,{style:{paddingLeft:"".concat(o.indent*XC,"px")}},h),o.children.map((m,_)=>v0.default.createElement(ZL,V(A({key:_},m),{autoFocusInput:o.autoFocusInput&&_===0,indent:o.indent+1}))))}else return v0.default.createElement(kwe,V(A({},o),{autoFocusInput:o.autoFocusInput,indent:o.indent}))}function kwe(o){var l;let h=(l=o.propConfig.label)!=null?l:Vm(o.pathToProp),m=Nwe(o);if(o.propConfig.type==="enum")return v0.default.createElement(v0.default.Fragment,null);{let _=cL[o.propConfig.type];return v0.default.createElement(Qre,null,v0.default.createElement(qC,null,v0.default.createElement("span",{style:{paddingLeft:"".concat(o.indent*XC,"px")}},h)),v0.default.createElement(tie,null,v0.default.createElement(_,{editingTools:m,propConfig:o.propConfig,value:cC(o.keyframe.value,o.propConfig),autoFocus:o.autoFocusInput})))}}function Nwe(o){let l=o.sheetObject;return Pwe(({stateEditors:h},m)=>{let _=V(A({},o.keyframe),{value:m});h.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},l.address),{trackId:o.trackId,keyframes:[_],snappingFunction:l.sheet.getSequence().closestGridPosition}))},l)}var v0,Zre,Qre,Jre,qC,XC,eie,tie,Dwe=P(()=>{v0=K($e()),Xt(),Qee(),w9(),Iwe(),P9(),Qre=me.div(Zre||(Zre=q([`
  display: flex;
  align-items: stretch;
  min-width: 200px;

  select {
    min-width: 100px;
  }
`]))),qC=me.div(Jre||(Jre=q([`
  font-style: normal;
  font-weight: 400;
  font-size: 11px;
  line-height: 13px;
  letter-spacing: 0.01em;
  padding: 6px 6px 6px 0;

  width: 40%;

  color: #919191;

  overflow: hidden;
`]))),XC=10,tie=me.div(eie||(eie=q([`
  display: flex;
  align-items: center;
  width: 60%;
`])))});function QL(o){return Nc({debugName:"useKeyframeInlineEditorPopover"},()=>YC.default.createElement(Dc,{showPopoverEdgeTriangle:!0},YC.default.createElement("div",{style:{margin:"1px 2px 1px 10px"}},Array.isArray(o)?o.map((l,h)=>YC.default.createElement(ZL,V(A({key:h},l),{autoFocusInput:h===0,indent:0}))):void 0)))}var YC,JL=P(()=>{YC=K($e()),Zd(),Qd(),Dwe()});function Owe(o,l,h){return J0(o,{displayName:"Keyframe",menuItems:()=>{let m=qre(h.leaf.sheetObject.address.projectId,h.leaf.sheetObject.address.sheetId,h.selection);return[{label:m.length>0?"Copy (selection)":"Copy",callback:()=>{m.length>0?de().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes(m)}):de().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:h.keyframe,pathToProp:h.leaf.pathToProp}])})}},{label:h.selection!==void 0?"Delete (selection)":"Delete",callback:()=>{h.selection?h.selection.delete():de().transaction(({stateEditors:_})=>{_.coreByProject.historic.sheetsById.sequence.deleteKeyframes(V(A({},h.leaf.sheetObject.address),{keyframeIds:[h.keyframe.id],trackId:h.leaf.trackId}))})}}]},onOpen(){l._debug("Show keyframe",h)}})}function Lwe(o,l,h){let m=(0,D9.useRef)(l);m.current=l;let{onClickFromDrag:_}=h,w=(0,D9.useMemo)(()=>({debugName:"KeyframeDot/useDragKeyframe",onDragStart(R){let N=m.current,F=(0,KC.val)(de().atomP.historic.coreByProject[N.leaf.sheetObject.address.projectId].sheetsById[N.leaf.sheetObject.address.sheetId].sequence.tracksByObject),U=iwe(F,function(Y,{trackId:Z,objectKey:ne}){var ae,ce;return Y.id!==N.keyframe.id&&!(N.selection&&(ce=(ae=N.selection.byObjectKey[ne])==null?void 0:ae.byTrackId[Z])!=null&&ce.byKeyframeId[Y.id])});if(rwe(U),N.selection){let{selection:Y,leaf:Z}=N,{sheetObject:ne}=Z,ae=Y.getDragHandlers(V(A({},ne.address),{domNode:o,positionAtStartOfDrag:N.track.data.keyframes[N.index].position})).onDragStart(R);return ae&&V(A({},ae),{onClick:_,onDragEnd:(...ce)=>{var ve;(ve=ae.onDragEnd)==null||ve.call(ae,...ce),E6()}})}let $=N,j=(0,KC.val)($.layoutP.scaledSpace.toUnitSpace),G;return{onDrag(Y,Z,ne){var ae;let ce=$.track.data.keyframes[$.index],ve=Math.max((ae=tl.checkIfMouseEventSnapToPos(ne,{ignore:o}))!=null?ae:ce.position+j(Y),0);G==null||G.discard(),G=void 0,G=de().tempTransaction(({stateEditors:Me})=>{Me.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},$.leaf.sheetObject.address),{trackId:$.leaf.trackId,keyframes:[V(A({},ce),{position:ve})],snappingFunction:(0,KC.val)($.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(Y){Y?G==null||G.commit():G==null||G.discard(),E6()},onClick(Y){_(Y)}}}}),[_]),[C]=Hs(o,w);return $p(C,l.keyframe.position),kc(C,"draggingPositionInSequenceEditor","ew-resize"),[C]}var D9,KC,Yb,eF,Kb,tF,nie,ZC,rie,iie,sie,oie,aie,lie,cie=P(()=>{D9=K($e()),Xt(),Se(),el(),Oo(),zi(),KC=rn(),ba(),K0(),rf(),TC(),W5(),$C(),$i(),T6(),JL(),Fb(),Yb=6,eF=Yb+2,Kb={normalColor:"#40AAA4",selectedColor:"#F2C95C",inlineEditorOpenColor:"#FCF3DC",selectedAndInlineEditorOpenColor:"#CBEBEA"},tF=({isSelected:o,isInlineEditorPopoverOpen:l})=>o&&l?Kb.inlineEditorOpenColor:o?Kb.selectedColor:l?Kb.selectedAndInlineEditorOpenColor:Kb.normalColor,ZC=me.div(nie||(nie=q([`
  position: absolute;
  `,`

  background: `,`;
  transform: rotateZ(45deg);

  `,`;

  z-index: 1;
  pointer-events: none;
`])),sf(Yb),o=>tF(o),o=>o.flag===2?"outline: 2px solid white;":""),iie=me.div(rie||(rie=q([`
  position: absolute;
  `,`

  background: `,`;

  `,`;

  z-index: 1;
  pointer-events: none;
`])),sf(Yb*1.5),o=>tF(o),o=>o.flag===2?"outline: 2px solid white;":""),oie=me.div(sie||(sie=q([`
  z-index: 1;
  cursor: ew-resize;

  position: absolute;
  `,`;
  `,`;

  & + `,` {
    `,`
  }

  &:hover + `,` {
    `,`
  }
`])),sf(12),Ni,ZC,o=>o.isInlineEditorPopoverOpen?sf(eF):"",ZC,sf(eF)),aie=o=>{let l=o6("SingleKeyframeDot",o.keyframe.id),h=x6(o.itemKey),[m,_]=ui(null),[w]=Owe(_,l,o),{node:C,toggle:R,isOpen:N}=QL([{type:"primitiveProp",keyframe:o.keyframe,pathToProp:o.leaf.pathToProp,propConfig:o.leaf.propConf,sheetObject:o.leaf.sheetObject,trackId:o.leaf.trackId}]);Lwe(_,o,{onClickFromDrag(U){R(U,m.current)}});let F=!o.keyframe.type||o.keyframe.type==="bezier";return D9.default.createElement(D9.default.Fragment,null,D9.default.createElement(oie,A({ref:m,isInlineEditorPopoverOpen:N},h.attrs)),F?D9.default.createElement(ZC,{isSelected:!!o.selection,isInlineEditorPopoverOpen:N,flag:h.flag}):D9.default.createElement(iie,{isSelected:!!o.selection,isInlineEditorPopoverOpen:N,flag:h.flag}),C,w)},lie=aie}),nF,rF,iF,e8,uie,hie,die,Fwe=P(()=>{Hd(),nF=K($e()),Xt(),cie(),rF=Yb/2+1,iF=1e3,e8={normalColor:"#365b59",selectedColor:"#8A7842",barColor:o=>{let l=o.isSelected?e8.selectedColor:e8.normalColor;return o.isPopoverOpen?wM(.2,$y(.2,l)):l},hoverColor:o=>{let l=o.isSelected?e8.selectedColor:e8.normalColor;return o.isPopoverOpen?wM(.2,$y(.2,l)):wM(.1,$y(.1,l))}},hie=me.div(uie||(uie=q([`
  position: absolute;
  background: `,`;
  height: `,`px;
  width: `,`px;

  left: 0;
  top: -`,`px;
  transform-origin: top left;
  z-index: 0;
  cursor: ew-resize;

  &:after {
    display: block;
    position: absolute;
    content: ' ';
    top: -4px;
    bottom: -4px;
    left: 0;
    right: 0;
  }

  &:hover {
    background: `,`;
  }
`])),e8.barColor,rF,iF,rF/2,e8.hoverColor),die=nF.default.forwardRef((o,l)=>{let h={isPopoverOpen:o.isPopoverOpen,isSelected:o.isSelected};return nF.default.createElement(hie,V(A({},h),{ref:l,style:{transform:"scaleX(calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(o.connectorLengthInUnitSpace/iF,"))")},onClick:m=>{var _;(_=o.openPopover)==null||_.call(o,m)}}),o.children)})});function Bwe(o,l){let h=(0,sF.useRef)(l);h.current=l;let m=(0,sF.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(_){let w=h.current,C;if(w.selection){let{selection:U,leaf:$}=w,{sheetObject:j}=$;return U.getDragHandlers(V(A({},j.address),{domNode:o,positionAtStartOfDrag:w.track.data.keyframes[w.index].position})).onDragStart(_)}let R=w,N=(0,QC.val)(R.layoutP.sheet).getSequence(),F=(0,QC.val)(R.layoutP.scaledSpace.toUnitSpace);return{onDrag(U,$,j){let G=F(U);C&&(C.discard(),C=void 0),C=de().tempTransaction(({stateEditors:Y})=>{Y.coreByProject.historic.sheetsById.sequence.transformKeyframes(V(A({},R.leaf.sheetObject.address),{trackId:R.leaf.trackId,keyframeIds:[R.keyframe.id,R.track.data.keyframes[R.index+1].id],translate:G,scale:1,origin:0,snappingFunction:N.closestGridPosition}))})},onDragEnd(U){U?C&&C.commit():C&&C.discard()}}}}),[]);Hs(o,m)}function Uwe(o,l,h,m){return J0(l,{displayName:"Tween",menuItems:()=>{let _=qre(o.leaf.sheetObject.address.projectId,o.leaf.sheetObject.address.sheetId,o.selection);return[{label:_.length>0?"Copy (selection)":"Copy",callback:()=>{_.length>0?de().transaction(w=>{w.stateEditors.studio.ahistoric.setClipboardKeyframes(_)}):de().transaction(w=>{w.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:h,pathToProp:o.leaf.pathToProp},{keyframe:m,pathToProp:o.leaf.pathToProp}])})}},{label:o.selection?"Delete (selection)":"Delete",callback:()=>{o.selection?o.selection.delete():de().transaction(({stateEditors:w})=>{w.coreByProject.historic.sheetsById.sequence.deleteKeyframes(V(A({},o.leaf.sheetObject.address),{keyframeIds:[h.id,m.id],trackId:o.leaf.trackId}))})}}]}})}var QC,O9,sF,oF,fie,pie,mie,gie,vie,zwe=P(()=>{Se(),el(),Oo(),zi(),QC=rn(),O9=K($e()),sF=K($e()),Zd(),Qd(),$re(),Fwe(),NC(),ur(),$C(),$C(),Xt(),oF=5,pie=me(Dc)(fie||(fie=q([`
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: `,`;
`])),GL),mie=o=>{let{index:l,track:h}=o,m=h.data.keyframes[l],_=h.data.keyframes[l+1],[w,C]=ui(null),{node:R,toggle:N,close:F}=Nc(()=>{let G=(0,QC.val)(o.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:G.screenX+oF,maxX:G.screenX+G.width-oF}}},()=>O9.default.createElement(vie,V(A({},o),{closePopover:F}))),[U]=Uwe(o,C,m,_);Bwe(C,o);let $=_.position-m.position,j={isPopoverOpen:jr(()=>Hre(V(A({},o.leaf.sheetObject.address),{trackId:o.leaf.trackId,left:m,right:_})),[o.leaf.sheetObject.address,o.leaf.trackId,m,_]),isSelected:o.selection!==void 0};return O9.default.createElement(O9.default.Fragment,null,O9.default.createElement(die,V(A({ref:w,connectorLengthInUnitSpace:$},j),{openPopover:G=>{C&&N(G,C)}}),R),U)},gie=mie,vie=O9.default.forwardRef((o,l)=>{let{index:h,track:{data:m},selection:_}=o,w=m.keyframes[h],C=m.keyframes[h+1],R=o.leaf.trackId,N=o.leaf.sheetObject.address;if(!R)return null;let F=jr(()=>Twe(N.projectId,N.sheetId,_).getValue(),[N,_]),U=A({left:w,right:C,trackId:R},N);return O9.default.createElement(pie,{showPopoverEdgeTriangle:!1,ref:l},O9.default.createElement(jre,{curveConnection:U,additionalConnections:F,onRequestClose:o.closePopover}))})}),yie,t8,xie,_ie,bie,Sie,wie,Vwe=P(()=>{yie=rn(),t8=K($e()),Xt(),zwe(),cie(),_ie=me.div(xie||(xie=q([`
  position: absolute;
`]))),bie=t8.default.createElement(t8.default.Fragment,null),Sie=t8.default.memo(o=>{let{index:l,track:{data:h}}=o,m=h.keyframes[l],_=h.keyframes[l+1],w=m.connectedRight&&!!_;return t8.default.createElement(_ie,{style:{top:"".concat(o.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,yie.val)(o.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(m.position,"px))")}},t8.default.createElement(lie,V(A({},o),{itemKey:o.itemKey})),w?t8.default.createElement(gie,A({},o)):bie)}),wie=Sie});function Gwe(o,l){return J0(o,{displayName:"Keyframe Track",menuItems:()=>{var h;let m=(h=(0,A6.val)(de().atomP.ahistoric.clipboard.keyframesWithRelativePaths))!=null?h:[];return[jwe(l,m)]}})}function jwe(o,l){return{label:"Paste Keyframes",enabled:l.length>0,callback:()=>{var h;let m=(0,A6.val)(o.layoutP.sheet).getSequence(),_=(h=l[0])==null?void 0:h.pathToProp,w=l.filter(({keyframe:C,pathToProp:R})=>WSe(_,R)).map(({keyframe:C,pathToProp:R})=>C);de().transaction(({stateEditors:C})=>{var R;m.position=m.closestGridPosition(m.position);let N=(R=Hwe(w))==null?void 0:R.position;for(let F of w)o.leaf.trackId&&C.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(V(A({},o.leaf.sheetObject.address),{trackId:o.leaf.trackId,position:m.position+F.position-N,handles:F.handles,value:F.value,snappingFunction:m.closestGridPosition,type:F.type}))})}}}function Hwe(o){let l=null;for(let h of o)(l===null||h.position<l.position)&&(l=h);return l}var A6,ng,Eie,Tie,aF,Mie,Wwe=P(()=>{ur(),A6=rn(),ng=K($e()),Xt(),Vwe(),el(),zi(),Se(),k9(),T6(),Yd(),Tie=me.div(Eie||(Eie=q([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),aF=ng.default.memo(o=>{var l;let{layoutP:h,trackData:m,leaf:_}=o,[w,C]=ui(null),{selectedKeyframeIds:R,selection:N}=jr(()=>{if(!_.trackId)return{selectedKeyframeIds:void 0,selection:void 0};let ve=(0,A6.val)(h.selectionAtom),Me=(0,A6.val)(ve.pointer.current);if(!Me)return{selectedKeyframeIds:void 0,selection:void 0};let Te=(0,A6.val)(ve.pointer.current.byObjectKey[_.sheetObject.address.objectKey].byTrackId[_.trackId].byKeyframeId);return Te?{selectedKeyframeIds:Te,selection:Me}:{selectedKeyframeIds:void 0,selection:void 0}},[h,_.trackId]),[F,U,$]=Gwe(C,o),j=Rr(One),G=j.mode==="snapToSome"&&_.trackId?(l=j.positions[_.sheetObject.address.objectKey])==null?void 0:l[_.trackId]:[],Y=j.mode==="snapToAll";if(!_.trackId)return null;let Z=(0,ng.useMemo)(()=>({data:m,id:_.trackId,sheetObject:o.leaf.sheetObject}),[m,_.trackId]),ne=m.keyframes.map((ve,Me)=>ng.default.createElement(wie,{key:"keyframe-"+ve.id,itemKey:Ga.forTrackKeyframe(_.sheetObject,_.trackId,ve.id),keyframe:ve,index:Me,track:Z,layoutP:h,leaf:_,selection:(R==null?void 0:R[ve.id])===!0?N:void 0})),ae=G.map(ve=>ng.default.createElement(UL,{key:"snap-target-"+ve,layoutP:h,leaf:_,position:ve})),ce=Y?m.keyframes.map(ve=>ng.default.createElement(UL,{key:"additionalSnapTarget-".concat(ve.id),layoutP:h,leaf:_,position:ve.position})):null;return ng.default.createElement(Tie,{ref:w,style:{background:$?"#444850 ":"unset"}},ne,ae,ng.default.createElement(ng.default.Fragment,null,ce),F)}),aF.displayName="BasicKeyframedTrack",Mie=aF}),Cie,n8,Aie,Pie,$we=P(()=>{Se(),ur(),Cie=rn(),n8=K($e()),IC(),Wwe(),W5(),Aie=({leaf:o,layoutP:l})=>{let h=o6("PrimitivePropRow",o.pathToProp.join());return jr(()=>{let{sheetObject:m}=o,{trackId:_}=o;if(!_)return n8.default.createElement(Z5,{leaf:o,isCollapsed:!1,node:n8.default.createElement("div",null)});let w=(0,Cie.val)(de().atomP.historic.coreByProject[m.address.projectId].sheetsById[m.address.sheetId].sequence.tracksByObject[m.address.objectKey].trackData[_]);return(w==null?void 0:w.type)!=="BasicKeyframedTrack"?(h.errorDev("trackData type ".concat(w==null?void 0:w.type," is not yet supported on the sequence editor")),n8.default.createElement(Z5,{leaf:o,isCollapsed:!1,node:n8.default.createElement("div",null)})):n8.default.createElement(Z5,{leaf:o,isCollapsed:!1,node:n8.default.createElement(Mie,{layoutP:l,trackData:w,leaf:o})})},[o,l])},Pie=Aie});function Rie(){let o=Math.random()*360,l=.7+Math.random()*.3,h=.55+Math.random()*.2,m=l*Math.min(h,1-h),_=w=>{let C=(w+o/30)%12,R=h-m*Math.max(Math.min(C-3,9-C,1),-1);return Math.round(255*R).toString(16).padStart(2,"0")};return"#".concat(_(0)).concat(_(8)).concat(_(4))}var Iie=P(()=>{});function kie(o,l,h){let m=(0,Zb.val)(l.sheet).getSequence();o.type==="sheet"?qwe(o,h,m):Xwe(o,h,m)}function qwe(o,l,h){var m,_;let{projectId:w,sheetId:C}=o.sheet.address,R=l.every(({pathToProp:U})=>U.length===0),N=[],F=new Map;for(let U of o.children)U.type==="sheetObject"&&F.set(U.sheetObject.address.objectKey,U.sheetObject);if(R)for(let U of o.children.filter($=>$.type==="sheetObject").map($=>$.sheetObject)){let $=(0,Zb.pointerToPrism)(de().atomP.historic.coreByProject[w].sheetsById[C].sequence.tracksByObject[U.address.objectKey]).getValue(),j=Object.keys((m=$==null?void 0:$.trackData)!=null?m:{});for(let G of j)for(let{keyframe:Y}of l)N.push({keyframe:Y,trackId:G,address:V(A({},U.address),{pathToProp:[]}),sheetObject:U})}else{let U=(0,Zb.pointerToPrism)(de().atomP.historic.coreByProject[w].sheetsById[C].sequence.tracksByObject).getValue();for(let{keyframe:$,pathToProp:j}of l){if(j.length===0)continue;let G=j[0],Y=j.slice(1),Z=F.get(G);if(!Z)continue;let ne=U==null?void 0:U[G],ae=nf(Y),ce=(_=ne==null?void 0:ne.trackIdByPropPath)==null?void 0:_[ae];N.push({keyframe:$,trackId:ce,address:V(A({},Z.address),{pathToProp:Y}),sheetObject:Z})}}Nie(N,h)}function Xwe(o,l,h){var m,_;let{projectId:w,sheetId:C,objectKey:R}=o.sheetObject.address,N=o.sheetObject,F=(0,Zb.pointerToPrism)(de().atomP.historic.coreByProject[w].sheetsById[C].sequence.tracksByObject[R]).getValue(),U=l.every(({pathToProp:j})=>j.length===0),$=[];if(U)if(o.type==="sheetObject"){let j=Object.keys((m=F==null?void 0:F.trackData)!=null?m:{});for(let G of j)for(let{keyframe:Y}of l)$.push({keyframe:Y,trackId:G,address:V(A({},N.address),{pathToProp:[]}),sheetObject:N})}else{let j=o.pathToProp,G=v6(N.template.staticConfig,j);if(G)for(let{path:Y,conf:Z}of y6(G,j)){if(Wp(Z))continue;let ne=Y,ae=nf(ne),ce=(_=F==null?void 0:F.trackIdByPropPath)==null?void 0:_[ae];for(let{keyframe:ve}of l)$.push({keyframe:ve,trackId:ce,address:V(A({},N.address),{pathToProp:ne}),sheetObject:N})}}else{let j=(F==null?void 0:F.trackIdByPropPath)||{},G=o.type==="propWithChildren"?o.pathToProp:[];for(let{keyframe:Y,pathToProp:Z}of l){let ne=[...G,...Z],ae=nf(ne),ce=j[ae];$.push({keyframe:Y,trackId:ce,address:V(A({},N.address),{pathToProp:ne}),sheetObject:N})}}Nie($,h)}function Nie(o,l){var h;if(o.length===0)return;l.position=l.closestGridPosition(l.position);let m=(h=Ywe(o.map(({keyframe:_})=>_)))==null?void 0:h.position;de().transaction(({stateEditors:_,drafts:w})=>{var C,R,N;for(let F of o){let{keyframe:U,address:$,sheetObject:j}=F,G=F.trackId;if(!G){let Y=v6(j.template.staticConfig,$.pathToProp);if(Y&&!Wp(Y)){_.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced($,Y);let Z=(N=(R=(C=w.historic.coreByProject[$.projectId])==null?void 0:C.sheetsById[$.sheetId])==null?void 0:R.sequence)==null?void 0:N.tracksByObject[$.objectKey];if(Z){let ne=nf($.pathToProp);G=Z.trackIdByPropPath[ne]}}}G&&_.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(V(A({},$),{trackId:G,position:l.position+U.position-m,handles:U.handles,value:U.value,snappingFunction:l.closestGridPosition,type:U.type}))}})}function Ywe(o){let l=null;for(let h of o)(l===null||h.position<l.position)&&(l=h);return l}function Die(o,l){let h=Array.from(l.byPosition.keys());if(h.length===0)return;let m={first:Math.min(...h),last:Math.max(...h)},_=l.tracks.flatMap(N=>{var F;return(F=Xre(V(A({},N.sheetObject.address),{trackId:N.id,keyframeIds:N.data.keyframes.filter(U=>U.position>=m.first&&U.position<=m.last).map(U=>U.id)})))!=null?F:[]}),w=o.type==="sheet"?[]:o.type==="sheetObject"?[o.sheetObject.address.objectKey]:o.type==="propWithChildren"?[o.sheetObject.address.objectKey,...o.pathToProp]:[],C=SL([w,..._.map(N=>N.pathToProp)]),R=_.map(({keyframe:N,pathToProp:F})=>({keyframe:N,pathToProp:F.slice(C.length)}));de().transaction(N=>{N.stateEditors.studio.ahistoric.setClipboardKeyframes(R)})}var Zb,Oie=P(()=>{Zb=rn(),Se(),$C(),k9(),P9()});function Kwe(o){if(!o)return null;let l=o.closest("[data-handle]");return l&&l.getAttribute("data-handle")||null}function Lie(o){if(o.type==="sheet")return"theatre-agg-keyframe-color-sheet-".concat(o.sheet.address.sheetId);if(o.type==="sheetObject")return"theatre-agg-keyframe-color-object-".concat(o.sheetObject.address.objectKey);{let l=o.pathToProp.join(".");return"theatre-agg-keyframe-color-prop-".concat(o.sheetObject.address.objectKey,"-").concat(l)}}function Zwe(o){let l=Lie(o),h=localStorage.getItem(l);if(h)return h;let m=Rie();return localStorage.setItem(l,m),m}function Fie(o,l){let h=Lie(o);localStorage.setItem(h,l)}function Qwe(o){let{layoutP:l,aggregatedKeyframes:h,viewModel:m}=o,[_,w]=ui(null),C=y0.default.useRef(null),[R,N]=y0.default.useState(()=>Zwe(m)),[F,U]=y0.default.useState(!1),[$,j]=y0.default.useState({top:0,left:0}),G=(0,y0.useMemo)(()=>{let Te=Array.from(h.byPosition.keys());return Te.length===0?null:{first:Math.min(...Te),last:Math.max(...Te)}},[h]),[Y]=J0(w,{displayName:"Aggregate Keyframe",menuItems:()=>{var Te;let _e=(Te=(0,P6.pointerToPrism)(de().atomP.ahistoric.clipboard.keyframesWithRelativePaths).getValue())!=null?Te:[];return[{label:"Copy Keyframes",callback:()=>{Die(m,h)}},{label:"Paste Keyframes",enabled:_e.length>0,callback:()=>{kie(m,l,_e)}},{label:"Custom Color",callback:()=>{if(U(!0),w){let it=w.getBoundingClientRect();j({top:Math.max(10,it.top),left:Math.max(10,it.left)})}}},{label:"Delete",callback:()=>{de().transaction(({stateEditors:it})=>{for(let Re of h.tracks){let xe=Re.data.keyframes.filter(Oe=>Oe.position>=G.first&&Oe.position<=G.last).map(Oe=>Oe.id);xe.length>0&&it.coreByProject.historic.sheetsById.sequence.deleteKeyframes(V(A({},Re.sheetObject.address),{keyframeIds:xe,trackId:Re.id}))}})}}]}}),Z=OL(),ne=(0,y0.useMemo)(()=>({debugName:"AggregateKeyframeBar/useDrag",onDragStart:Te=>{if(!G)return!1;let _e=Te.target,it=Kwe(_e),Re=it!==null;Z(!0,G.first),m.type==="sheet"?m.sheet.address:m.sheetObject.address;let xe=(0,P6.val)(l.scaledSpace.toUnitSpace),Oe;return{onDrag(He,Fe,Nt){let Ve=xe(He),Ht=Math.max(0,G.first+Ve);if(Re){let ot=it==="left",Ye=G.first,Ee=G.last,et=ot?G.first:G.last,At=Math.max(0,et+Ve);if(ot&&At>=Ee||!ot&&At<=Ye)return;let Ce=Ee-Ye,Ze=Math.abs(At-(ot?Ee:Ye));if(Ce===0||Ze===0)return;Oe==null||Oe.discard(),Oe=de().tempTransaction(({stateEditors:Ft})=>{for(let $t of h.tracks){let _t=[];for(let be of $t.data.keyframes)if(be.position>=Math.min(Ye,Ee)&&be.position<=Math.max(Ye,Ee)){let dt=(be.position-Ye)/Ce,bt=ot?At+dt*Ze:Ye+dt*Ze;_t.push(V(A({},be),{position:bt}))}_t.length>0&&Ft.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},$t.sheetObject.address),{trackId:$t.id,keyframes:_t,snappingFunction:(0,P6.val)(l.sheet).getSequence().closestGridPosition}))}})}else Oe==null||Oe.discard(),Oe=de().tempTransaction(({stateEditors:ot})=>{for(let Ye of h.tracks){let Ee=[];for(let et of Ye.data.keyframes)et.position>=G.first&&et.position<=G.last&&Ee.push(V(A({},et),{position:Math.max(0,et.position+Ve)}));Ee.length>0&&ot.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},Ye.sheetObject.address),{trackId:Ye.id,keyframes:Ee,snappingFunction:(0,P6.val)(l.sheet).getSequence().closestGridPosition}))}});Z(!0,Ht)},onDragEnd(He){Z(!1,-1),He?Oe==null||Oe.commit():Oe==null||Oe.discard()}}}}),[G,h,l,m,Z]),[ae]=Hs(w,ne);if(kc(ae,"draggingPositionInSequenceEditor","ew-resize"),!G)return y0.default.createElement(lF,{ref:_});let ce=(0,P6.val)(l.scaledSpace.leftPadding),ve="calc(".concat(ce,"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(G.first,"px))"),Me="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(G.last-G.first,"px)");return y0.default.createElement(lF,{ref:_},y0.default.createElement(zie,{$color:R,style:{left:ve,width:Me}},y0.default.createElement(jie,{$position:"left","data-handle":"left"}),y0.default.createElement(Wie,{$position:"right",style:{left:"calc(100% - 7px)"},"data-handle":"right"})),F&&y0.default.createElement(qie,{style:{position:"fixed",top:"".concat($.top,"px"),left:"".concat($.left,"px")}},y0.default.createElement(Yie,{ref:C,type:"color",value:R,onChange:Te=>{let _e=Te.currentTarget.value;N(_e),Fie(m,_e)},autoFocus:!0}),y0.default.createElement(Zie,{type:"text",placeholder:"#000000",value:R,onChange:Te=>{let _e=Te.currentTarget.value;_e.startsWith("#")||(_e="#"+_e),/^#[0-9A-F]{6}$/i.test(_e)&&(N(_e),Fie(m,_e))}}),y0.default.createElement("button",{onClick:()=>U(!1),style:{padding:"4px 8px",fontSize:"12px",cursor:"pointer",border:"1px solid #666",borderRadius:"2px",background:"#222",color:"#FFF",height:"28px"}},"Done")),Y)}var P6,y0,Bie,lF,Uie,zie,Vie,cF,Gie,jie,Hie,Wie,$ie,qie,Xie,Yie,Kie,Zie,Qie,Jie,Jwe=P(()=>{P6=rn(),y0=K($e()),Xt(),zi(),Oo(),K0(),Se(),ba(),el(),$i(),Iie(),Oie(),lF=me.div(Bie||(Bie=q([`
  position: absolute;
  height: 100%;
  width: 100%;
`]))),zie=me.div(Uie||(Uie=q([`
  position: absolute;
  height: 20px;
  background: `,`;
  cursor: ew-resize;
  top: 50%;
  transform: translateY(-50%);
  border-radius: 2px;
  z-index: 2;
  `,`

  &:hover {
    opacity: 0.8;
  }
`])),o=>o.$color,Ni),cF=me.div(Vie||(Vie=q([`
  position: absolute;
  height: 20px;
  width: 7px;
  top: 50%;
  transform: translateY(-50%);
  display: block;
  z-index: 3;
  `,`

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    background: inherit;
    border-radius: `,`;
    width: 7px;
    height: 20px;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    width: 15px;
    height: 28px;
    top: 50%;
    transform: translateY(-50%);
    `,`
  }

  &:hover:before {
    opacity: 0.8;
  }
`])),Ni,o=>o.$position==="left"?"2px 0 0 2px":"0 2px 2px 0",o=>o.$position==="left"?"left: -8px; cursor: w-resize;":"right: -8px; cursor: e-resize;"),jie=me(cF)(Gie||(Gie=q([`
  left: calc(-1 * 7px);
`]))),Wie=me(cF)(Hie||(Hie=q([`
  right: 0px;
`]))),qie=me.div($ie||($ie=q([`
  position: absolute;
  background: #333;
  border-radius: 4px;
  padding: 4px;
  z-index: 1000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
`]))),Yie=me.input(Xie||(Xie=q([`
  background: #222;
  width: 50px;
  height: 30px;
  border: 1px solid #666;
  border-radius: 2px;
  cursor: pointer;

  &::-webkit-color-swatch-wrapper {
    padding: 2px;
  }

  &::-webkit-color-swatch {
    border: 1px solid #999;
    border-radius: 2px;
  }
`]))),Zie=me.input(Kie||(Kie=q([`
  background: #222;
  border: 1px solid #666;
  color: #fff;
  width: 70px;
  height: 28px;
  padding: 4px;
  border-radius: 2px;
  font-family: monospace;
  font-size: 12px;

  &:focus {
    outline: none;
    border-color: #40aaa4;
  }
`]))),Qie=y0.default.memo(Qwe),Jie=Qie});function eEe(o){let{layoutP:l,aggregatedKeyframes:h,viewModel:m}=o,[_,w]=ui(null);return JC.default.createElement(tse,{ref:_},JC.default.createElement(Jie,{viewModel:m,aggregatedKeyframes:h,layoutP:l}))}var JC,ese,tse,nse,uF,rse=P(()=>{JC=K($e()),Xt(),zi(),Jwe(),tse=me.div(ese||(ese=q([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),nse=JC.default.memo(eEe),uF=nse}),R6,eA,ise,sse=P(()=>{ur(),R6=K($e()),$we(),IC(),rse(),wC(),W5(),eA=(o,l,h=!0)=>o.type==="propWithChildren"?R6.default.createElement(ise,{layoutP:l,viewModel:o,key:"prop"+o.pathToProp[o.pathToProp.length-1],renderChildren:h}):R6.default.createElement(Pie,{layoutP:l,leaf:o,key:"prop"+o.pathToProp[o.pathToProp.length-1]}),ise=({viewModel:o,layoutP:l,renderChildren:h=!0})=>{let m=o6("RightPropWithChildrenRow",o.pathToProp.join());return jr(()=>{let _=SC(o);return R6.default.createElement(NK,{logger:m},R6.default.createElement(Z5,{leaf:o,node:R6.default.createElement(uF,{layoutP:l,aggregatedKeyframes:_,viewModel:o}),isCollapsed:o.isCollapsed},h&&o.children.map(w=>eA(w,l))))},[o,l])}}),hF,ose,ase,tEe=P(()=>{ur(),hF=K($e()),sse(),IC(),wC(),rse(),ose=({leaf:o,layoutP:l,renderChildren:h=!0})=>jr(()=>{let m=SC(o);return hF.default.createElement(Z5,{leaf:o,node:hF.default.createElement(uF,{layoutP:l,aggregatedKeyframes:m,viewModel:o}),isCollapsed:o.isCollapsed},h&&o.children.map(_=>eA(_,l)))},[o,l]),ase=ose});function lse(o){return"theatre-subsequence-color-".concat(o.sheet.address.projectId,"-").concat(o.sheet.address.sheetId,"-").concat(o.subSequence.id)}function nEe(o){let l=lse(o),h=localStorage.getItem(l);if(h)return h;let m=Rie();return localStorage.setItem(l,m),m}function cse(o,l){let h=lse(o);localStorage.setItem(h,l)}var Nu,hi,use,hse,dse,fse,pse,dF,mse,gse,vse,yse,xse,_se,bse,Sse,wse,Ese,Tse,Mse,Cse,rEe=P(()=>{Nu=rn(),hi=K($e()),Xt(),ba(),K0(),Se(),el(),Zd(),Qd(),Oo(),zi(),$i(),rf(),K0(),vne(),Iie(),hse=me.div(use||(use=q([`
  position: absolute;
  height: 100%;
  width: 100%;
  min-width: 20px;
`]))),fse=me.div.attrs(o=>({style:{background:o.$color}}))(dse||(dse=q([`
  position: absolute;
  height: 20px;
  line-height: 20px;
  cursor: ew-resize;
  top: 50%;
  transform: translateY(-50%);
  border-radius: 2px;
  text-align: center;
  width: 100%;
  z-index: 2;
  `,`

  &:hover {
    opacity: 0.8;
  }

  span {
    color: white;
    font-weight: bold;
    text-shadow: 0 1px rgba(0, 0, 0, 0.67);
  }
`])),Ni),dF=me.div(pse||(pse=q([`
  background: #555;
  position: absolute;
  height: 20px;
  width: 7px;
  top: 50%;
  transform: translateY(-50%);
  display: block;
  z-index: 3;
  `,`

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    background: inherit;
    border-radius: `,`;
    width: 7px;
    height: 20px;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    width: 15px;
    height: 28px;
    top: 50%;
    transform: translateY(-50%);
    `,`
  }

  &:hover:before {
    background: rgba(170, 64, 64, 0.6);
  }

  // Snap cursor when dragging playhead
  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);

    // Show snap cursor () on hover
    &:hover:after {
      background: url(`,`) no-repeat center center;
      background-size: 34px 34px;
    }
  }
`])),Ni,o=>o.$position==="left"?"2px 0 0 2px":"0 2px 2px 0",o=>o.$position==="left"?"left: -8px; cursor: w-resize;":"right: -8px; cursor: e-resize;",$d,DL),gse=me(dF).attrs(o=>({style:{background:o.$color}}))(mse||(mse=q([`
  border-right: 1px solid rgba(0, 0, 0, 0.25);
  left: -7px;
`]))),yse=me(dF).attrs(o=>({style:{background:o.$color}}))(vse||(vse=q([`
  border-left: 1px solid rgba(0, 0, 0, 0.25);
  right: -7px;
`]))),me.div(xse||(xse=q([`
  position: absolute;
  left: 8px;
  top: 50%;
  transform: translateY(-50%);
  color: rgba(255, 255, 255, 0.9);
  font-size: 11px;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  pointer-events: none;
  user-select: none;
`]))),bse=me.div(_se||(_se=q([`
  position: absolute;
  background: #333;
  border-radius: 4px;
  padding: 4px;
  z-index: 1000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
`]))),wse=me.input(Sse||(Sse=q([`
  background: #222;
  width: 50px;
  height: 30px;
  border: 1px solid #666;
  border-radius: 2px;
  cursor: pointer;

  &::-webkit-color-swatch-wrapper {
    padding: 2px;
  }

  &::-webkit-color-swatch {
    border: 1px solid #999;
    border-radius: 2px;
  }
`]))),Tse=me.input(Ese||(Ese=q([`
  background: #222;
  border: 1px solid #666;
  color: #fff;
  width: 70px;
  height: 28px;
  padding: 4px;
  border-radius: 2px;
  font-family: monospace;
  font-size: 12px;

  &:focus {
    outline: none;
    border-color: #40aaa4;
  }
`]))),Mse=({leaf:o,layoutP:l})=>{var h;let[m,_]=ui(null),[w,C]=ui(null),[R,N]=ui(null),[F,U]=ui(null),$=hi.default.useRef(null),[j,G]=(0,hi.useState)(()=>nEe(o)),[Y,Z]=(0,hi.useState)(!1),[ne,ae]=(0,hi.useState)({top:0,left:0}),ce=Nc({debugName:"SubSequenceBar/editLabel"},()=>{let et=o.subSequence.label,At=et;return hi.default.createElement(Dc,null,hi.default.createElement("div",{style:{padding:"8px"}},hi.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Label"),hi.default.createElement("input",{type:"text",defaultValue:et,onChange:Ce=>{At=Ce.target.value},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),hi.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},hi.default.createElement("button",{onClick:()=>{de().transaction(({stateEditors:Ce})=>{Ce.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Ce.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{label:At}})}),ce.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Done"))))}),ve=Nc({debugName:"SubSequenceBar/editDuration"},()=>{let et=o.subSequence.duration,At=et;return hi.default.createElement(Dc,null,hi.default.createElement("div",{style:{padding:"8px"}},hi.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Duration"),hi.default.createElement("input",{type:"number",defaultValue:et,step:.1,min:.1,onChange:Ce=>{At=parseFloat(Ce.target.value)},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),hi.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},hi.default.createElement("button",{onClick:()=>{At>0&&de().transaction(({stateEditors:Ce})=>{Ce.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Ce.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{duration:At}})}),ve.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Done"))))}),Me=Nc({debugName:"SubSequenceBar/editTimeScale"},()=>{let et=o.subSequence.timeScale,At=et;return hi.default.createElement(Dc,null,hi.default.createElement("div",{style:{padding:"8px"}},hi.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Time Scale"),hi.default.createElement("input",{type:"number",defaultValue:et,step:.1,min:.1,onChange:Ce=>{At=parseFloat(Ce.target.value)},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),hi.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},hi.default.createElement("button",{onClick:()=>{At>0&&de().transaction(({stateEditors:Ce})=>{Ce.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Ce.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{timeScale:At}})}),Me.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Done"))))}),Te=Nc({debugName:"SubSequenceBar/editStart"},()=>{let et=o.subSequence.position,At=et;return hi.default.createElement(Dc,null,hi.default.createElement("div",{style:{padding:"8px"}},hi.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Start Position"),hi.default.createElement("input",{type:"number",defaultValue:et,step:.1,min:0,onChange:Ce=>{At=parseFloat(Ce.target.value)},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),hi.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},hi.default.createElement("button",{onClick:()=>{At>=0&&de().transaction(({stateEditors:Ce})=>{Ce.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Ce.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{position:At}})}),Te.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Ok"))))}),[_e]=J0(_,{menuItems:()=>[{label:"Edit Label",callback:()=>{if(_){let et=_.getBoundingClientRect();ce.open({clientX:et.left,clientY:et.top},_)}}},{label:"Edit Start",callback:()=>{if(_){let et=_.getBoundingClientRect();Te.open({clientX:et.left,clientY:et.top},_)}}},{label:"Edit Duration",callback:()=>{if(_){let et=_.getBoundingClientRect();ve.open({clientX:et.left,clientY:et.top},_)}}},{label:"Edit Time Scale",callback:()=>{if(_){let et=_.getBoundingClientRect();Me.open({clientX:et.left,clientY:et.top},_)}}},{label:"Delete Sub-sequence",callback:()=>{de().transaction(({stateEditors:et})=>{et.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),et.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id})})}},{label:"Custom Color",callback:()=>{if(Z(!0),_){let et=_.getBoundingClientRect();ae({top:Math.max(10,et.top),left:Math.max(10,et.left)})}}}]}),it=OL(),Re=et=>{let At=et.composedPath();for(let Ce of At){if(Ce===N)return"left";if(Ce===U)return"right";if(Ce===C)return"bar";if(Ce===_)break}return null},xe=(0,hi.useMemo)(()=>{let et=null,At=null,Ce=0,Ze=0,Ft=1,$t=()=>{var _t;let be=o.subSequence.duration;if(!be||be===0)try{let dt=de(),bt=(0,Nu.val)(dt.projectsP)[o.sheet.address.projectId];be=(_t=(0,Nu.val)(bt.pointers.historic.sheetsById[o.subSequence.sheetId].sequence.length))!=null?_t:(0,Nu.val)(l.sheet).getSequence().length}catch{be=(0,Nu.val)(l.sheet).getSequence().length}return be??1};return{debugName:"SubSequenceBar/drag",lockCSSCursorTo:"ew-resize",onDragStart(_t){return At=Re(_t),At?(Ce=o.subSequence.position,Ze=$t(),Ft=o.subSequence.timeScale,it(!0,o.subSequence.position),{onDrag(be){et&&et.discard(),et=de().tempTransaction(({stateEditors:dt})=>{let bt=(0,Nu.val)(l.clippedSpace.range),pn=(0,Nu.val)(l.clippedSpace.width),qn=(bt.end-bt.start)/pn,sr=be*qn,gr=(0,Nu.val)(l.sheet).getSequence().closestGridPosition;if(At==="bar"){let oi=Ce+sr,ps=Math.max(0,gr(oi));dt.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),dt.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{position:ps}})}else if(At==="left"){let oi=Ce+Ze/Ft,ps=Ce+sr,zr=Math.max(0,gr(ps)),qs=oi-zr,ri=Math.max(.01,Ze/qs);dt.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),dt.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{position:zr,timeScale:ri}})}else if(At==="right"){let oi=Ce+Ze/Ft+sr,ps=Math.max(Ce+.01,gr(oi))-Ce,zr=Math.max(.01,Ze/ps);dt.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),dt.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{timeScale:zr}})}})},onDragEnd(be){it(!1,0),be&&et?et.commit():et&&et.discard(),et=null}}):!1}}},[o,l,it,N,U,C,_]),[Oe]=Hs(_,xe);kc(Oe,"draggingPositionInSequenceEditor","ew-resize");let He=(0,Nu.val)(l.scaledSpace.leftPadding),Fe=o.subSequence.position,Nt=o.subSequence.timeScale,Ve=o.subSequence.duration;if(!Ve||Ve===0)try{let et=de(),At=(0,Nu.val)(et.projectsP)[o.sheet.address.projectId];Ve=(h=(0,Nu.val)(At.pointers.historic.sheetsById[o.subSequence.sheetId].sequence.length))!=null?h:(0,Nu.val)(l.sheet).getSequence().length}catch{Ve=(0,Nu.val)(l.sheet).getSequence().length}Ve||(Ve=1);let Ht="calc(".concat(He,"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(Fe,"px))"),ot="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(Ve/Nt,"px)"),Ye=Fe,Ee=Fe+Ve/Nt;return hi.default.createElement(hse,{ref:m,style:{left:Ht,width:ot}},ce.node,Te.node,ve.node,Me.node,Y&&hi.default.createElement(bse,{style:{position:"fixed",top:"".concat(ne.top,"px"),left:"".concat(ne.left,"px")}},hi.default.createElement(wse,{ref:$,type:"color",value:j,onChange:et=>{let At=et.currentTarget.value;G(At),cse(o,At)},autoFocus:!0}),hi.default.createElement(Tse,{type:"text",placeholder:"#000000",value:j,onChange:et=>{let At=et.currentTarget.value;At.startsWith("#")||(At="#"+At),/^#[0-9A-F]{6}$/i.test(At)&&(G(At),cse(o,At))}}),hi.default.createElement("button",{onClick:()=>Z(!1),style:{padding:"4px 8px",fontSize:"12px",cursor:"pointer",border:"1px solid #666",borderRadius:"2px",background:"#222",color:"#FFF",height:"28px"}},"Done")),_e,hi.default.createElement(fse,{ref:w,$color:j},hi.default.createElement("span",null,o.subSequence.timeScale.toFixed(2),"x")),hi.default.createElement(gse,V(A({ref:R,$position:"left","data-handle":"left",title:isFinite(Ye)?"Sub-sequence start: ".concat(Ye.toFixed(2)):"Sub-sequence start"},isFinite(Ye)?tl.includePositionSnapAttrs(Ye):{}),{$color:j})),hi.default.createElement(yse,V(A({ref:F,$position:"right","data-handle":"right",title:isFinite(Ee)?"Sub-sequence end: ".concat(Ee.toFixed(2)):"Sub-sequence end"},isFinite(Ee)?tl.includePositionSnapAttrs(Ee):{}),{$color:j})))},Cse=Mse}),fF,Ase,Pse,Rse,Ise,iEe=P(()=>{fF=K($e()),Xt(),rEe(),Pse=me.div(Ase||(Ase=q([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),Rse=({layoutP:o,leaf:l})=>fF.default.createElement(Pse,null,fF.default.createElement(Cse,{layoutP:o,leaf:l})),Ise=Rse}),pF,kse,Nse,sEe=P(()=>{pF=K($e()),IC(),iEe(),kse=({leaf:o,layoutP:l})=>pF.default.createElement(Z5,{leaf:o,node:pF.default.createElement(Ise,{layoutP:l,leaf:o})},null),Nse=kse}),tA,mF,Dse,gF,vF=P(()=>{tA=K($e()),mF=(0,tA.createContext)({searchTerm:"",searchTrigger:0}),Dse=({searchTerm:o,searchTrigger:l,children:h})=>tA.default.createElement(mF.Provider,{value:{searchTerm:o,searchTrigger:l}},h),gF=()=>(0,tA.useContext)(mF)});function I6(o,l){de().transaction(({stateEditors:h})=>{h.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.sequenceEditorCollapsableItems.set(V(A({},l.sheetAddress),{studioSheetItemKey:l.sheetItemKey,isCollapsed:o}))})}var yF=P(()=>{Se()});function oEe(o,l){if(!l.trim())return;let h=l.toLowerCase().trim();o.children.filter(m=>m.type==="sheetObject").forEach(m=>{cEe(m,h)&&(I6(!1,{sheetAddress:m.sheetObject.address,sheetItemKey:m.sheetItemKey}),Fse(m.children,h,m.sheetObject.address))})}function aEe(o){o.children.filter(l=>l.type==="sheetObject").forEach(l=>{let h="".concat(l.sheetObject.address.projectId,":").concat(l.sheetObject.address.sheetId,":").concat(l.sheetItemKey);r8.set(h,l.isCollapsed),Ose(l.children,l.sheetObject.address)})}function Ose(o,l){o.forEach(h=>{if(h.type==="propWithChildren"){let m="".concat(l.projectId,":").concat(l.sheetId,":").concat(h.sheetItemKey);r8.set(m,h.isCollapsed),Ose(h.children,l)}})}function lEe(o){o.children.filter(l=>l.type==="sheetObject").forEach(l=>{let h="".concat(l.sheetObject.address.projectId,":").concat(l.sheetObject.address.sheetId,":").concat(l.sheetItemKey),m=r8.get(h);m!==void 0&&m!==l.isCollapsed&&I6(m,{sheetAddress:l.sheetObject.address,sheetItemKey:l.sheetItemKey}),Lse(l.children,l.sheetObject.address)}),r8.clear()}function Lse(o,l){o.forEach(h=>{if(h.type==="propWithChildren"){let m="".concat(l.projectId,":").concat(l.sheetId,":").concat(h.sheetItemKey),_=r8.get(m);_!==void 0&&_!==h.isCollapsed&&I6(_,{sheetAddress:l,sheetItemKey:h.sheetItemKey}),Lse(h.children,l)}})}function cEe(o,l){return o.sheetObject.address.objectKey.toLowerCase().includes(l)?!0:o.children.some(h=>xF(h,l))}function Fse(o,l,h){o.forEach(m=>{var _;if(m.type==="propWithChildren"){let w=(((_=m.pathToProp[m.pathToProp.length-1])==null?void 0:_.toString().toLowerCase())||"").includes(l),C=m.children.some(R=>xF(R,l));(w||C)&&(I6(!1,{sheetAddress:h,sheetItemKey:m.sheetItemKey}),Fse(m.children,l,h))}})}function xF(o,l){var h;return(((h=o.pathToProp[o.pathToProp.length-1])==null?void 0:h.toString().toLowerCase())||"").includes(l)?!0:o.type==="propWithChildren"?o.children.some(m=>xF(m,l)):!1}function Bse(o,l){if(!l.trim())return lEe(o),o;r8.size===0&&aEe(o),oEe(o,l);let h=l.toLowerCase().trim(),m=o.children.map(R=>R.type==="sheetObject"?uEe(R,h):null).filter(R=>R!==null),_=o.top,w=o.n,C=m.map(R=>{let N=hEe(R,_,w);return _=N.top+N.heightIncludingChildren,w=N.n+1,N});return V(A({},o),{children:C,heightIncludingChildren:_-o.top,isCollapsed:!1})}function uEe(o,l){if(o.sheetObject.address.objectKey.toLowerCase().includes(l))return V(A({},o),{children:o.children,isCollapsed:!1});{let h=o.children.map(m=>Use(m,l)).filter(m=>m!==null);if(h.length>0)return V(A({},o),{children:h,isCollapsed:!1})}return null}function Use(o,l){var h;let m=(((h=o.pathToProp[o.pathToProp.length-1])==null?void 0:h.toString().toLowerCase())||"").includes(l);if(o.type==="primitiveProp")return m?o:null;if(m)return V(A({},o),{children:o.children,isCollapsed:!1});{let _=o.children.map(w=>Use(w,l)).filter(w=>w!==null);if(_.length>0)return V(A({},o),{children:_,isCollapsed:!1})}return null}function hEe(o,l,h){let m=l,_=h,w=V(A({},o),{top:m,n:_});m+=o.nodeHeight,_+=1;let C=o.children.map(R=>{let N=zse(R,m,_);return m=N.top+N.nodeHeight,N.type==="propWithChildren"&&(m+=N.heightIncludingChildren-N.nodeHeight),_=N.n+1,N});return V(A({},w),{children:C,heightIncludingChildren:m-w.top})}function zse(o,l,h){let m=V(A({},o),{top:l,n:h});if(o.type==="propWithChildren"){let _=l+o.nodeHeight,w=h+1,C=o.children.map(R=>{let N=zse(R,_,w);return _=N.top+N.nodeHeight,N.type==="propWithChildren"&&(_+=N.heightIncludingChildren-N.nodeHeight),w=N.n+1,N});return V(A({},m),{children:C,heightIncludingChildren:_-m.top})}return m}var r8,Vse=P(()=>{yF(),r8=new Map});function _F(o,l=[]){o.shouldRender&&l.push(o);let h="isCollapsed"in o?o.isCollapsed:!1;if((o.type==="sheet"||!h)&&"children"in o)for(let m of o.children)_F(m,l);return l}var Gse=P(()=>{}),nA,L9,k6,jse,Hse,Wse,$se,qse,Xse,bF=P(()=>{ur(),nA=rn(),L9=K($e()),Xt(),twe(),VL(),tEe(),sEe(),vF(),Vse(),Yd(),Gse(),EC(),sse(),k6=1e6,Hse=me.div(jse||(jse=q([`
  position: relative;
`]))),$se=me.div(Wse||(Wse=q([`
  margin: 0;
  padding: 0;
  position: absolute;
  left: 0;
  width: `,`px;
  z-index: 10;
`])),k6),qse=({layoutP:o})=>{let{searchTerm:l,searchTrigger:h}=gF(),m=NL(),{scrollTop:_,clientHeight:w}=Rr(m);return jr(()=>{let C=(0,nA.val)(o.tree),R=l.trim()?Bse(C,l):C,N=(0,nA.val)(o.tree.top)+Math.max(R.heightIncludingChildren,(0,nA.val)(o.dopeSheetDims.height)),F=_F(R),U=[],$=500,j=_-$,G=_+w+$,Y=-1;for(let Z=0;Z<F.length;Z++){let ne=F[Z];if(ne.top+ne.nodeHeight>=j){Y=Z;break}}if(Y!==-1)for(let Z=Y;Z<F.length;Z++){let ne=F[Z];if(ne.top>G)break;U.push(ne)}return L9.default.createElement(Hse,null,L9.default.createElement(PC,{layoutP:o,height:N},L9.default.createElement(une,{layoutP:o,height:N},L9.default.createElement($se,{style:{top:"0px"}},U.map(Z=>{let ne=null;return Z.type==="subSequence"?ne=L9.default.createElement(Nse,{layoutP:o,key:Ga.forSubSequence(Z.subSequence.id),leaf:Z}):Z.type==="sheetObject"?ne=L9.default.createElement(ase,{layoutP:o,key:"sheetObject-"+Z.sheetObject.address.objectKey,leaf:Z,renderChildren:!1}):(Z.type==="propWithChildren"||Z.type==="primitiveProp")&&(ne=eA(Z,o,!1)),ne?L9.default.createElement("div",{key:Z.type+"-"+(Z.sheetItemKey||Z.top),style:{position:"absolute",top:Z.top+"px",width:"100%",height:Z.nodeHeight+"px"}},ne):null})))))},[o,l,h,_,w])},Xse=qse});function SF(o,l,h,m){let _="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(o,"px)"),w="calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(l,") * 1px)");h===0&&(h=1e-4);let C="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(h,")");m===0&&(m=.001);let R="calc(var(--graphEditorVerticalSpace) * ".concat(m*-1,")");return"translate(".concat(_,", ").concat(w,") scale(").concat(C,", ").concat(R,")")}function dEe(o,l){let{index:h,trackData:m}=l,_=m.keyframes[h],w=m.keyframes[h+1];return J0(o,{menuItems:()=>[{label:"Delete",callback:()=>{de().transaction(({stateEditors:C})=>{let{deleteKeyframes:R}=C.coreByProject.historic.sheetsById.sequence;R(V(A({},l.sheetObject.address),{trackId:l.trackId,keyframeIds:[_.id,w.id]}))})}}]})}var rA,Yse,Kse,Zse,Qse,Jse,wF=P(()=>{P9(),Se(),el(),zi(),rA=K($e()),Xt(),Kse=me.path(Yse||(Yse=q([`
  stroke-width: 2;
  stroke: var(--main-color);
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),Zse="M 0 0 L 1 0 L 1 1",Qse=o=>{let{index:l,trackData:h}=o,m=h.keyframes[l],_=h.keyframes[l+1],w=_.position-m.position,[C,R]=ui(null),[N]=dEe(R,o),F=o.isScalar?cC(m.value,o.propConfig):0,U=o.isScalar?cC(_.value,o.propConfig):1,$=o.extremumSpace.fromValueSpace(F),j=o.extremumSpace.fromValueSpace(U)-$,G=SF(m.position,$,w,j),Y=m.handles[2],Z=m.handles[3],ne=_.handles[0],ae=_.handles[1],ce="M 0 0 C ".concat(Y," ").concat(Z," ").concat(ne," ").concat(ae," 1 1");return rA.default.createElement(rA.default.Fragment,null,rA.default.createElement(Kse,{ref:C,d:!m.type||m.type==="bezier"?ce:Zse,style:{transform:G}}),N)},Jse=Qse});function fEe(o,l){let h=(0,i8.useRef)(l);h.current=l;let m=(0,i8.useMemo)(()=>({debugName:"CurveHandler/useOurDrags",lockCSSCursorTo:"move",onDragStart(){let _,w=h.current,C=(0,Qb.val)(w.layoutP.scaledSpace.toUnitSpace),R=(0,Qb.val)(w.layoutP.graphEditorVerticalSpace.toExtremumSpace),N=w.extremumSpace.lock();return{onDrag(F,U){_&&(_.discard(),_=void 0);let{index:$,trackData:j}=w,G=j.keyframes[$],Y=j.keyframes[$+1],Z=C(F)/(Y.position-G.position),ne=-U,ae=R(ne),ce=w.extremumSpace.deltaToValueSpace(ae),ve=l.isScalar?G.value:0,Me=l.isScalar?Y.value:1,Te=ce/(Me-ve);if(w.which==="left"){let _e=Bi(G.handles[2]+Z,0,1),it=G.handles[3]+Te;_=de().tempTransaction(({stateEditors:Re})=>{Re.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},w.sheetObject.address),{snappingFunction:(0,Qb.val)(w.layoutP.sheet).getSequence().closestGridPosition,trackId:w.trackId,keyframes:[V(A({},G),{handles:[G.handles[0],G.handles[1],_e,it]})]}))})}else{let _e=Bi(Y.handles[0]+Z,0,1),it=Y.handles[1]+Te;_=de().tempTransaction(({stateEditors:Re})=>{Re.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},w.sheetObject.address),{trackId:w.trackId,snappingFunction:(0,Qb.val)(w.layoutP.sheet).getSequence().closestGridPosition,keyframes:[V(A({},Y),{handles:[_e,it,Y.handles[2],Y.handles[3]]})]}))})}},onDragEnd(F){N(),F?_&&_.commit():_&&_.discard()}}}}),[]);Hs(o,m)}function pEe(o,l){return J0(o,{menuItems:()=>[{label:"Delete",callback:()=>{de().transaction(({stateEditors:h})=>{h.coreByProject.historic.sheetsById.sequence.deleteKeyframes(V(A({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}var Qb,i8,eoe,EF,toe,noe,roe,ioe,soe,TF,mEe=P(()=>{Se(),el(),Oo(),zi(),Qb=rn(),m0(),i8=K($e()),Xt(),wF(),$i(),EF=me.circle(eoe||(eoe=q([`
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;
  fill: var(--main-color);
  r: 2px;
  pointer-events: none;
`]))),noe=me.circle(toe||(toe=q([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  cursor: move;
  `,`;
  &:hover {
  }
  &:hover + `,` {
    r: 6px;
  }
`])),Ni,EF),ioe=me.path(roe||(roe=q([`
  stroke-width: 1;
  stroke: var(--main-color);
  /* stroke: gray; */
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),soe=o=>{let[l,h]=ui(null),{index:m,trackData:_}=o,w=_.keyframes[m],C=_.keyframes[m+1],[R]=pEe(h,o);fEe(h,o);let N=o.which==="left"?w.handles[2]:C.handles[0],F=w.position+(C.position-w.position)*N,U=o.which==="left"?w.handles[3]:C.handles[1],$=o.isScalar?w.value:0,j=o.isScalar?C.value:1,G=$+(j-$)*U,Y=o.extremumSpace.fromValueSpace(G),Z=Y-o.extremumSpace.fromValueSpace(o.which==="left"?$:j),ne=SF(o.which==="left"?w.position:C.position,o.extremumSpace.fromValueSpace(o.which==="left"?$:j),F-(o.which==="left"?w.position:C.position),Z);return i8.default.createElement("g",null,i8.default.createElement(noe,{ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(F," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(Y,") * 1px)")}}),i8.default.createElement(EF,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(F," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(Y,") * 1px)")}}),i8.default.createElement(ioe,{d:"M 0 0 L 1 1",style:{transform:ne}}),R)},TF=soe});function gEe(o){let[l,h]=(0,F9.useState)(!1);$p(l,o.props.keyframe.position);let m=(0,F9.useRef)(o.props);m.current=o.props;let _=(0,F9.useMemo)(()=>({debugName:"GraphEditorDotScalar/useDragKeyframe",lockCSSCursorTo:"move",onDragStart(w){h(!0);let C=!!w.altKey,R=m.current,N=(0,iA.val)(R.layoutP.scaledSpace.toUnitSpace),F=(0,iA.val)(R.layoutP.graphEditorVerticalSpace.toExtremumSpace),U=R.extremumSpace.lock(),$;return{onDrag(j,G){let Y=R.trackData.keyframes[R.index],Z=N(j),ne=-G,ae=F(ne),ce=R.extremumSpace.deltaToValueSpace(ae),ve=[],Me=V(A({},Y),{position:Y.position+Z,value:Y.value+ce,handles:[...Y.handles]});if(ve.push(Me),C){let Te=R.trackData.keyframes[R.index-1];if(Te&&Math.abs(Y.value-Te.value)>0){let it=V(A({},Te),{handles:[...Te.handles]});ve.push(it),it.handles[3]=yEe(Te.handles[3],Te.value,Te.value,Y.value,Me.value)}let _e=R.trackData.keyframes[R.index+1];if(_e&&Math.abs(Y.value-_e.value)>0){let it=V(A({},_e),{handles:[..._e.handles]});ve.push(it),it.handles[1]=xEe(it.handles[1],it.value,it.value,Y.value,Me.value)}}$==null||$.discard(),$=de().tempTransaction(({stateEditors:Te})=>{Te.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},R.sheetObject.address),{trackId:R.trackId,keyframes:ve,snappingFunction:(0,iA.val)(R.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(j){h(!1),U(),j?$==null||$.commit():($==null||$.discard(),o.onDetectedClick(w))}}}}),[]);return Hs(o.node,_),kc(l,"draggingPositionInSequenceEditor","move"),l}function vEe(o,l){return J0(o,{menuItems:()=>[{label:"Delete",callback:()=>{de().transaction(({stateEditors:h})=>{h.coreByProject.historic.sheetsById.sequence.deleteKeyframes(V(A({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}function yEe(o,l,h,m,_){return(m-l)*o/(_-h)}function xEe(o,l,h,m,_){return((l-m)*o+m-l+h-_)/(h-_)}var iA,F9,ooe,MF,aoe,loe,coe,uoe,_Ee=P(()=>{Se(),el(),Oo(),zi(),iA=rn(),F9=K($e()),Xt(),ba(),ba(),$i(),K0(),rf(),JL(),Fb(),MF=me.circle(ooe||(ooe=q([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),loe=me.circle(aoe||(aoe=q([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: move;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Ni,MF,$d),coe=o=>{let[l,h]=ui(null),{index:m,trackData:_}=o,w=_.keyframes[m],[C]=vEe(h,o),R=x6(o.itemKey),N=w.value,F=o.extremumSpace.fromValueSpace(N),U=QL([{type:"primitiveProp",keyframe:o.keyframe,pathToProp:o.pathToProp,propConfig:o.propConfig,sheetObject:o.sheetObject,trackId:o.trackId}]),$=gEe({node:h,props:o,onDetectedClick:j=>U.toggle(j,j.target instanceof Element?j.target:h)});return F9.default.createElement(F9.default.Fragment,null,F9.default.createElement(loe,V(A(A(A({ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(w.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(F,") * 1px)")}},qp(w.position)),tl.includePositionSnapAttrs(w.position)),R.attrs),{className:$?"beingDragged":""})),F9.default.createElement(MF,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(w.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(F,") * 1px)"),fill:R.flag===2?"white":void 0}}),U.node,C)},uoe=coe});function bEe(o){let[l,h]=(0,B9.useState)(!1);$p(l,o.props.keyframe.position);let m=(0,B9.useRef)(o.props);m.current=o.props;let _=(0,B9.useMemo)(()=>({debugName:"GraphEditorDotNonScalar/useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(w){h(!0);let C=m.current,R=(0,CF.val)(C.layoutP.scaledSpace.toUnitSpace),N=C.extremumSpace.lock(),F;return{onDrag(U,$){let j=C.trackData.keyframes[C.index],G=R(U),Y=[],Z=V(A({},j),{position:j.position+G,value:j.value,handles:[...j.handles]});Y.push(Z),F==null||F.discard(),F=de().tempTransaction(({stateEditors:ne})=>{ne.coreByProject.historic.sheetsById.sequence.replaceKeyframes(V(A({},C.sheetObject.address),{trackId:C.trackId,keyframes:Y,snappingFunction:(0,CF.val)(C.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(U){h(!1),N(),U?F==null||F.commit():(F==null||F.discard(),o.onDetectedClick(w))}}}}),[]);return Hs(o.node,_),kc(l,"draggingPositionInSequenceEditor","ew-resize"),l}function SEe(o,l){return J0(o,{menuItems:()=>[{label:"Delete",callback:()=>{de().transaction(({stateEditors:h})=>{h.coreByProject.historic.sheetsById.sequence.deleteKeyframes(V(A({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}var CF,B9,hoe,AF,doe,foe,poe,PF,wEe=P(()=>{Se(),el(),Oo(),zi(),CF=rn(),B9=K($e()),Xt(),ba(),ba(),$i(),K0(),rf(),JL(),Fb(),AF=me.circle(hoe||(hoe=q([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),foe=me.circle(doe||(doe=q([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: ew-resize;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Ni,AF,$d),poe=o=>{let[l,h]=ui(null),{index:m,trackData:_,itemKey:w}=o,C=_.keyframes[m],[R]=SEe(h,o),N=x6(w),F=o.which==="left"?0:1,U=QL([{type:"primitiveProp",keyframe:o.keyframe,pathToProp:o.pathToProp,propConfig:o.propConfig,sheetObject:o.sheetObject,trackId:o.trackId}]),$=bEe({node:h,props:o,onDetectedClick:G=>U.toggle(G,G.target instanceof Element?G.target:h)}),j=o.extremumSpace.fromValueSpace(F);return B9.default.createElement(B9.default.Fragment,null,B9.default.createElement(foe,V(A(A(A({ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(C.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(j,") * 1px)")}},N.attrs),qp(C.position)),tl.includePositionSnapAttrs(C.position)),{className:$?"beingDragged":""})),B9.default.createElement(AF,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(C.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(j,") * 1px)"),fill:N.flag===2?"white":void 0}}),U.node,R)},PF=poe}),sA,moe,goe,voe,yoe,EEe=P(()=>{sA=K($e()),Xt(),wF(),goe=me.path(moe||(moe=q([`
  stroke-width: 2;
  stroke: var(--main-color);
  stroke-dasharray: 3 2;
  fill: none;
  vector-effect: non-scaling-stroke;
  opacity: 0.3;
`]))),voe=o=>{let{index:l,trackData:h}=o,m="M 0 0 L 1 1",_=SF(h.keyframes[l].position,o.extremumSpace.fromValueSpace(0),0,o.extremumSpace.fromValueSpace(1)-o.extremumSpace.fromValueSpace(0));return sA.default.createElement(sA.default.Fragment,null,sA.default.createElement(goe,{d:m,style:{transform:_}}))},yoe=voe}),x0,xoe,_oe,boe,Soe,woe,TEe=P(()=>{x0=K($e()),Xt(),wF(),mEe(),_Ee(),wEe(),EEe(),_oe=me.g(xoe||(xoe=q([`
  /* position: absolute; */
`]))),boe=x0.default.createElement(x0.default.Fragment,null),Soe=o=>{let{index:l,trackData:h,isScalar:m}=o,_=h.keyframes[l],w=h.keyframes[l+1],C=_.connectedRight&&!!w&&w.value!==_.value;return x0.default.createElement(_oe,null,C?x0.default.createElement(x0.default.Fragment,null,x0.default.createElement(Jse,A({},o)),!_.type||_.type==="bezier"&&x0.default.createElement(x0.default.Fragment,null,x0.default.createElement(TF,V(A({},o),{which:"left"})),x0.default.createElement(TF,V(A({},o),{which:"right"})))):boe,m?x0.default.createElement(uoe,A({},o)):x0.default.createElement(x0.default.Fragment,null,x0.default.createElement(PF,V(A({},o),{which:"left"})),x0.default.createElement(PF,V(A({},o),{which:"right"})),x0.default.createElement(yoe,A({},o))))},woe=Soe});function MEe(o,l){let h=1/0,m=-1/0;function _(w){h=Math.min(w,h),m=Math.max(w,m)}return o.forEach((w,C)=>{let R=cC(w.value,l);if(_(R),!w.connectedRight)return;let N=o[C+1];if(!N)return;let F=(typeof N.value=="number"?N.value:1)-R;_(R+w.handles[3]*F),_(R+N.handles[1]*F)}),[h,m]}function CEe(o){let l=0,h=1;function m(_){l=Math.min(_,l),h=Math.max(_,h)}return o.forEach((_,w)=>{if(!_.connectedRight)return;let C=o[w+1];C&&(m(_.handles[3]),m(C.handles[1]))}),[l,h]}var Xp,Eoe,Toe,AEe=P(()=>{Yd(),Xp=K($e()),aA(),TEe(),P9(),ur(),Eoe=Xp.default.memo(({layoutP:o,trackData:l,sheetObject:h,trackId:m,color:_,pathToProp:w})=>{let C=v6(Rr(h.template.configPointer),w);if(Wp(C))return console.error("Composite prop types cannot be keyframed"),Xp.default.createElement(Xp.default.Fragment,null);let[R,N]=(0,Xp.useState)(!1),F=(0,Xp.useMemo)(()=>{let G=new Set;return function(){let Y=G.size===0;G.add(Z),Y&&N(!0);function Z(){let ne=G.size>0;G.delete(Z),ne&&G.size===0&&N(!1)}return Z}},[]),U=(0,Xp.useMemo)(()=>{let G=C.type==="number"?MEe(l.keyframes,C):CEe(l.keyframes),Y=ae=>(ae-G[0])/(G[1]-G[0]),Z=ae=>G[0]+ne(ae),ne=ae=>ae*(G[1]-G[0]);return{fromValueSpace:Y,toValueSpace:Z,deltaToValueSpace:ne,lock:F}},[l.keyframes]),$=(0,Xp.useRef)(void 0);R||($.current=U);let j=l.keyframes.map((G,Y)=>Xp.default.createElement(woe,{pathToProp:w,propConfig:C,itemKey:Ga.forTrackKeyframe(h,m,G.id),keyframe:G,index:Y,trackData:l,layoutP:o,sheetObject:h,trackId:m,isScalar:C.type==="number",key:G.id,extremumSpace:$.current,color:_}));return Xp.default.createElement("g",{style:{"--main-color":Jb[_].iconColor}},j)}),Toe=Eoe}),Moe,oA,Coe,Aoe,PEe=P(()=>{Se(),ur(),Moe=rn(),oA=K($e()),AEe(),Coe=o=>jr(()=>{let{sheetObject:l,trackId:h}=o,m=(0,Moe.val)(de().atomP.historic.coreByProject[l.address.projectId].sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[h]);return(m==null?void 0:m.type)!=="BasicKeyframedTrack"?(console.error("trackData type ".concat(m==null?void 0:m.type," is not yet supported on the graph editor")),oA.default.createElement(oA.default.Fragment,null)):oA.default.createElement(Toe,V(A({},o),{trackData:m}))},[o.trackId,o.layoutP]),Aoe=Coe});function Poe({clippedSpaceRange:o,clippedSpaceWidth:l,fps:h,gapWidth:m=120},_){let w=1/h,C=o.end-o.start,R=l/(h*C),N=Math.floor(m/R),F=(N<h?Roe(h).find(j=>j>=N):h*Math.floor(N/h))*w,U=Math.floor(o.start/F),$=Math.ceil(o.end/F);for(let j=U;j<=$;j++){let G=j*F,Y=G%1===0;_(G,Y)}}var Roe,Ioe=P(()=>{m0(),Roe=Nd(o=>{let l=[];for(let h=1;h<=o;h++)o%h===0&&l.push(h);return l})});function REe(o){let{clippedSpaceWidth:l,height:h,ctx:m,unitSpaceToClippedSpace:_,snapToGrid:w}=o;m.clearRect(0,0,l,h),Poe(o,(C,R)=>{let N=w(C),F=Math.floor(_(N));m.strokeStyle=R?"rgba(225, 225, 225, 0.04)":"rgba(255, 255, 255, 0.01)",m.beginPath(),m.moveTo(F,0),m.lineTo(F,h),m.stroke(),m.closePath()})}var s8,o8,koe,Noe,Doe,Ooe,Loe,Foe,Boe,Uoe,RF,zoe=P(()=>{s8=rn(),o8=K($e()),Xt(),Ioe(),Se(),Noe=me.div(koe||(koe=q([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),Ooe=me.canvas(Doe||(Doe=q([`
  position: relative;
  left: 0;
`]))),Loe=o=>{let l=o;return l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1},Foe=()=>window.devicePixelRatio||1,Boe=o=>Foe()/Loe(o),Uoe=({layoutP:o,width:l,height:h})=>{let m=(0,o8.useRef)(null),[_,w]=(0,o8.useState)(null),{ctx:C,ratio:R}=(0,o8.useMemo)(()=>{if(!_)return{};let N=_.getContext("2d"),F=Boe(N);return{ctx:N,ratio:F}},[_]);return(0,o8.useLayoutEffect)(()=>{if(!C)return;_.width=l*R,_.height=h*R;let N=(0,s8.prism)(()=>{let F=(0,s8.val)(o.sheet).getSequence();return{ctx:C,clippedSpaceRange:(0,s8.val)(o.clippedSpace.range),clippedSpaceWidth:(0,s8.val)(o.clippedSpace.width),unitSpaceToClippedSpace:(0,s8.val)(o.clippedSpace.fromUnitSpace),height:h,leftPadding:(0,s8.val)(o.scaledSpace.leftPadding),fps:F.subUnitsPerUnit,snapToGrid:U=>F.closestGridPosition(U)}}).onChange(de().ticker,F=>{C.save(),C.scale(R,R),REe(F),C.restore()},!0);return()=>{N()}},[C,l,h,o]),o8.default.createElement(Noe,{ref:m,style:{width:l+"px"}},o8.default.createElement(Ooe,{ref:w,style:{width:l+"px",height:h+"px"}}))},RF=Uoe}),Yp,a8,Jb,Voe,Goe,joe,Hoe,Woe,$oe,aA=P(()=>{Se(),k9(),uC(),ur(),Yp=rn(),a8=K($e()),Xt(),bF(),VL(),PEe(),zoe(),Hd(),Jb={1:{iconColor:"#b98b08"},2:{iconColor:"#70a904"},3:{iconColor:"#2e928a"},4:{iconColor:"#a943bb"},5:{iconColor:"#b90808"},6:{iconColor:"#b4bf0e"}},Goe=me.div(Voe||(Voe=q([`
  position: absolute;
  right: 0;
  bottom: 0;
  padding-bottom: 25px;
  background: `,`;
`])),zp(.03,"#1a1c1e")),Hoe=me.svg(joe||(joe=q([`
  position: absolute;
  top: 0;
  left: 0;
  margin: 0;
  pointer-events: none;
`]))),Woe=({layoutP:o})=>jr(()=>{let l=(0,Yp.val)(o.sheet),h=(0,Yp.val)(de().atomP.historic.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].sequenceEditor.selectedPropsByObject),m=(0,Yp.val)(o.graphEditorDims.height),_=(0,Yp.val)(o.scaledSpace.fromUnitSpace)(1),w=[];if(h)for(let[R,N]of Object.entries(h)){let F=l.getObject(R);if(!F)continue;let U=(0,Yp.val)(F.template.getMapOfValidSequenceTracks_forStudio());for(let[$,j]of Object.entries(N)){let G=wL($),Y=R9(U,G);Y&&w.push(a8.default.createElement(Aoe,{key:"graph-".concat(R,"-").concat($),sheetObject:F,pathToProp:G,layoutP:o,trackId:Y,color:j}))}}let C=(0,Yp.val)(o.rightDims.width);return a8.default.createElement(Goe,{style:{width:C+"px",height:m+"px","--unitSpaceToScaledSpaceMultiplier":_,"--graphEditorVerticalSpace":"".concat((0,Yp.val)(o.graphEditorVerticalSpace.space))}},a8.default.createElement(RF,{layoutP:o,width:C,height:m}),a8.default.createElement(PC,{layoutP:o,height:m},a8.default.createElement(Hoe,{width:k6,height:m,viewBox:"0 0 ".concat(k6," ").concat(m)},a8.default.createElement("g",{style:{transform:"translate(".concat((0,Yp.val)(o.scaledSpace.leftPadding),"px, ").concat((0,Yp.val)(o.graphEditorDims.padding.top),"px)")}},w))))},[o]),$oe=Woe}),qoe,Oc,Xoe,Yoe,Koe,Zoe,IF,Qoe,Joe,eae,tae,nae,rae,iae,sae,oae,IEe=P(()=>{Se(),k9(),Tb(),ur(),qoe=rn(),Oc=K($e()),Xt(),GSe(),mC(),aA(),_C(),Ym(),kO(),el(),Qee(),Xoe={label:{color:"#9a9a9a"}},Koe=me(xL)(Yoe||(Yoe=q([""]))),IF=me(xC)(Zoe||(Zoe=q([`
  display: flex;
  color: `,`;
  padding-left: calc(10px + var(--depth) * 10px);
  padding-right: 12px;
  align-items: center;
  justify-content: flex-end;
  box-sizing: border-box;
`])),Xoe.label.color),Joe=me.button(Qoe||(Qoe=q([`
  background: none;
  border: none;
  outline: none;
  display: flex;
  box-sizing: border-box;
  font-size: 14px;
  align-items: center;
  height: 100%;
  margin-left: 12px;
  color: `,`;

  &:not([disabled]):hover {
    color: white;
  }
`])),o=>o.isSelected?Jb[o.graphEditorColor].iconColor:I9.offColor),eae=()=>Oc.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"12",viewBox:"0 0 640 512"},Oc.default.createElement("g",{transform:"translate(0 100)"},Oc.default.createElement("path",{fill:"currentColor",d:"M368 32h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM208 88h-84.75C113.75 64.56 90.84 48 64 48 28.66 48 0 76.65 0 112s28.66 64 64 64c26.84 0 49.75-16.56 59.25-40h79.73c-55.37 32.52-95.86 87.32-109.54 152h49.4c11.3-41.61 36.77-77.21 71.04-101.56-3.7-8.08-5.88-16.99-5.88-26.44V88zm-48 232H64c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zM576 48c-26.84 0-49.75 16.56-59.25 40H432v72c0 9.45-2.19 18.36-5.88 26.44 34.27 24.35 59.74 59.95 71.04 101.56h49.4c-13.68-64.68-54.17-119.48-109.54-152h79.73c9.5 23.44 32.41 40 59.25 40 35.34 0 64-28.65 64-64s-28.66-64-64-64zm0 272h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32z"}))),nae=me.span(tae||(tae=q([`
  margin-right: 4px;
  `,`;

  `,`:hover & {
    color: #ccc;
  }
`])),Kd,IF),iae=me.div(rae||(rae=q([`
  margin-right: auto;
  margin-left: 8px;
  display: flex;
  align-items: center;
  min-width: 0;
  flex: 1;

  /* Override some default input styles to fit in the row */
  input {
    font-size: 11px;
    height: 24px;
    padding: 2px 4px;
  }
`]))),sae=({leaf:o})=>{var l;let h=d6(o.sheetObject.propsP,o.pathToProp),m=o.sheetObject,_=VSe(h,m,o.propConf),w=jr(()=>{let Y=o.sheetObject.address,Z=nf(o.pathToProp);return(0,qoe.val)(de().atomP.historic.projects.stateByProjectId[Y.projectId].stateBySheetId[Y.sheetId].sequenceEditor.selectedPropsByObject[Y.objectKey][Z])},[o]),C=(0,Oc.useRef)(!1),R=typeof w=="string";C.current=R;let N=(0,Oc.useCallback)(()=>{let Y=o.sheetObject.address;de().transaction(({stateEditors:Z})=>{C.current?Z.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removePropFromGraphEditor(V(A({},Y),{pathToProp:o.pathToProp})):o.trackId&&(Z.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.addPropToGraphEditor(V(A({},Y),{pathToProp:o.pathToProp})),Z.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!0}))})},[o]),F=(l=o.propConf.label)!=null?l:o.pathToProp[o.pathToProp.length-1],U=!!o.trackId,$=(0,Oc.useRef)(null);IO($.current,o);let[j]=J0($.current,{menuItems:_.contextMenuItems}),G=cL[o.propConf.type];return Oc.default.createElement(Koe,{depth:o.depth},j,Oc.default.createElement(IF,{ref:$,isEven:o.n%2===0,style:{height:o.nodeHeight+"px"},isSelected:R===!0},Oc.default.createElement(nae,null,F),Oc.default.createElement(iae,null,Oc.default.createElement(G,{editingTools:_,propConfig:o.propConf,value:_.value})),_.controlIndicators,Oc.default.createElement(Joe,{onClick:N,isSelected:R===!0,graphEditorColor:w??"1",style:{opacity:U?1:.25},disabled:!U},Oc.default.createElement(eae,null))))},oae=sae}),N6,lA,aae,lae=P(()=>{N6=K($e()),_C(),IEe(),yF(),Ate(),Tb(),lA=(o,l=!0)=>{let h="prop"+o.pathToProp[o.pathToProp.length-1];return o.shouldRender?o.type==="propWithChildren"?N6.default.createElement(aae,{leaf:o,key:h,renderChildren:l}):N6.default.createElement(oae,{leaf:o,key:h}):N6.default.createElement(N6.default.Fragment,{key:h})},aae=({leaf:o,renderChildren:l=!0})=>{var h;let m=d6(o.sheetObject.propsP,o.pathToProp),_=Cte(m,o.sheetObject,o.propConf);return N6.default.createElement(bL,{leaf:o,label:(h=o.propConf.label)!=null?h:o.pathToProp[o.pathToProp.length-1],isCollapsed:o.isCollapsed,contextMenuItems:_.contextMenuItems,toggleCollapsed:()=>I6(!o.isCollapsed,{sheetAddress:o.sheetObject.address,sheetItemKey:o.sheetItemKey})},l&&o.children.map(w=>lA(w)))}}),cae,uae,hae,dae,kEe=P(()=>{cae=K($e()),_C(),lae(),yF(),Se(),Ate(),ur(),uae=rn(),wC(),Oie(),hae=({leaf:o,renderChildren:l=!0,layoutP:h})=>{let m=o.sheetObject,_=Cte(m.propsP,m,m.template.staticConfig),w=jr(()=>{var C;let R=SC(o),N=R.byPosition.size>0,F=(C=(0,uae.pointerToPrism)(de().atomP.ahistoric.clipboard.keyframesWithRelativePaths).getValue())!=null?C:[];return[{label:"Copy Keyframes",enabled:N,callback:()=>Die(o,R)},{label:"Paste Keyframes",enabled:F.length>0,callback:()=>kie(o,h,F)}]},[o,h]);return cae.default.createElement(bL,{leaf:o,label:o.sheetObject.address.objectKey,isCollapsed:o.isCollapsed,contextMenuItems:[..._.contextMenuItems,...w],toggleSelect:()=>{de().transaction(({stateEditors:C})=>{C.studio.historic.panels.outline.selection.set([o.sheetObject])})},toggleCollapsed:()=>I6(!o.isCollapsed,{sheetAddress:o.sheetObject.address,sheetItemKey:o.sheetItemKey})},l&&o.children.map(C=>lA(C)))},dae=hae}),eS,kF,fae,pae,mae,NF,gae,vae,yae,xae,NEe=P(()=>{eS=K($e()),Xt(),_C(),Ym(),kO(),Se(),el(),kF=rn(),pae=me.li(fae||(fae=q([`
  --depth: `,`;
  margin: 0;
  padding: 0;
  list-style: none;
`])),o=>o.depth-1),NF=me(xC)(mae||(mae=q([`
  padding-left: calc(var(--depth) * 10px);
  display: flex;
  align-items: stretch;
  color: #999;
  box-sizing: border-box;

  &:hover {
    background: rgba(255, 255, 255, 0.05);
  }
`]))),vae=me.span(gae||(gae=q([`
  `,`;
  overflow-x: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding-right: 4px;
  padding-left: 20px;
  line-height: 26px;
  flex-wrap: nowrap;
  color: #ccc;

  `,`:hover & {
    color: #fff;
  }
`])),Kd,NF),yae=({leaf:o})=>{let l=(0,eS.useRef)(null);IO(l.current,o);let h=o.subSequence.label===void 0?"":o.subSequence.label,m="".concat(h," (").concat(o.subSequence.sheetId,")"),[_]=J0(l.current,{menuItems:()=>[{label:"Edit Label",callback:()=>{let w=prompt("Enter new label:",o.subSequence.label);w!==null&&w.trim()!==""&&de().transaction(({stateEditors:C})=>{C.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{label:w.trim()}})})}},{label:"Edit Duration",callback:()=>{var w,C;let R=(w=o.subSequence.duration)!=null?w:0;if(R===0){let F=de(),U=(0,kF.val)(F.projectsP)[o.sheet.address.projectId];R=(C=(0,kF.val)(U.pointers.historic.sheetsById[o.subSequence.sheetId].sequence.length))!=null?C:0}let N=prompt("Enter new duration (seconds):",String(R));if(N!==null){let F=parseFloat(N);!isNaN(F)&&F>0&&de().transaction(({stateEditors:U})=>{U.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{duration:F}})})}}},{label:"Edit Time Scale",callback:()=>{var w;let C=(w=o.subSequence.timeScale)!=null?w:1,R=prompt("Enter new time scale:",String(C));if(R!==null){let N=parseFloat(R);!isNaN(N)&&N>0&&de().transaction(({stateEditors:F})=>{F.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{timeScale:N}})})}}},{label:"Delete Sub-sequence",callback:()=>{confirm('Are you sure you want to delete sub-sequence "'.concat(o.subSequence.label,'"?'))&&de().transaction(({stateEditors:w})=>{w.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id})})}}]});return o.shouldRender?eS.default.createElement(pae,{depth:o.depth},_,eS.default.createElement(NF,{ref:l,style:{height:o.nodeHeight+"px"},isEven:o.n%2===0},eS.default.createElement(vae,null,m))):null},xae=yae}),tS,no,_ae,bae,Sae,wae,Eae,Tae,DEe=P(()=>{ur(),tS=rn(),no=K($e()),Xt(),kEe(),NEe(),HSe(),Yd(),vF(),Vse(),Zd(),Qd(),Gse(),EC(),lae(),bae=me.div(_ae||(_ae=q([`
  position: absolute;
  left: 0;
  overflow-x: visible;

  &.drop-target {
    background: rgba(64, 170, 164, 0.1);
    outline: 2px dashed rgba(64, 170, 164, 0.5);
    outline-offset: -2px;
  }
`]))),wae=me.div(Sae||(Sae=q([`
  margin: 0 0 50px 0;
  padding: 0;
  position: relative;
`]))),Eae=({layoutP:o})=>{let{searchTerm:l,searchTrigger:h}=gF(),[m,_]=(0,no.useState)(!1),[w,C]=(0,no.useState)(null),R=(0,no.useRef)(null),N=NL();(0,no.useLayoutEffect)(()=>{let Y=R.current;if(!Y)return;let Z=ne=>{ne.stopPropagation()};return Y.addEventListener("wheel",Z,{passive:!0}),()=>Y.removeEventListener("wheel",Z)},[]);let F=Nc({debugName:"Left/addSubSequence"},()=>{if(!w)return no.default.createElement(no.default.Fragment,null);let Y=w.sheetId;return no.default.createElement(Dc,null,no.default.createElement("div",{style:{padding:"8px",minWidth:"300px"}},no.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold",color:"#CCC"}},"Add Sub-sequence"),no.default.createElement("div",{style:{marginBottom:"4px",fontSize:"11px",color:"#999"}},"Label:"),no.default.createElement("input",{type:"text",defaultValue:w.sheetId,onChange:Z=>{Y=Z.target.value},style:{width:"100%",padding:"6px 8px",marginBottom:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"2px",color:"#FFF",fontSize:"11px"},autoFocus:!0,onKeyDown:Z=>{Z.key==="Enter"?((0,tS.val)(o.sheet).getSequence().addSubSequence(w.sheetId,0,{label:Y.trim()||w.sheetId}),F.close("user action"),C(null)):Z.key==="Escape"&&(F.close("user action"),C(null))}}),no.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"}},no.default.createElement("button",{onClick:()=>{F.close("user action"),C(null)},style:{padding:"6px 12px",background:"rgba(255, 255, 255, 0.1)",color:"#CCC",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"2px",cursor:"pointer",fontSize:"11px"}},"Cancel"),no.default.createElement("button",{onClick:()=>{(0,tS.val)(o.sheet).getSequence().addSubSequence(w.sheetId,0,{label:Y.trim()||w.sheetId}),F.close("user action"),C(null)},style:{padding:"6px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"11px"}},"Ok"))))}),U=(0,no.useCallback)(Y=>{Y.preventDefault(),Y.stopPropagation(),_(!0)},[]),$=(0,no.useCallback)(Y=>{Y.preventDefault(),Y.stopPropagation(),_(!1);try{let Z=Y.dataTransfer.getData("application/json");if(!Z)return;let ne=JSON.parse(Z);if(ne.type!=="theatre-sheet")return;C({sheetId:ne.sheetId,projectId:ne.projectId,sheetInstanceId:ne.sheetInstanceId}),R.current&&F.open({clientX:Y.clientX,clientY:Y.clientY},R.current)}catch(Z){console.error("Error handling drop:",Z)}},[F]),{scrollTop:j,clientHeight:G}=Rr(N);return jr(()=>{let Y=(0,tS.val)(o.tree),Z=(0,tS.val)(o.leftDims.width),ne=l.trim()?Bse(Y,l):Y,ae=_F(ne),ce=[],ve=500,Me=j-ve,Te=j+G+ve,_e=-1;for(let xe=0;xe<ae.length;xe++){let Oe=ae[xe];if(Oe.top+Oe.nodeHeight>=Me){_e=xe;break}}if(_e!==-1)for(let xe=_e;xe<ae.length;xe++){let Oe=ae[xe];if(Oe.top>Te)break;ce.push(Oe)}let it=ae[ae.length-1],Re=it?it.top+it.nodeHeight:0;return no.default.createElement(no.default.Fragment,null,F.node,no.default.createElement(bae,{id:"leftContainer",ref:R,style:{width:Z+"px",top:0,pointerEvents:w!==null?"none":"auto"},className:m?"drop-target":"",onDragOver:U,onDrop:$},no.default.createElement(wae,{style:{height:Re+"px"}},ce.map(xe=>{let Oe=null;return xe.type==="subSequence"?Oe=no.default.createElement(xae,{key:Ga.forSubSequence(xe.subSequence.id),leaf:xe}):xe.type==="sheetObject"?Oe=no.default.createElement(dae,{key:"sheetObject-"+jSe(xe.sheetObject),leaf:xe,renderChildren:!1,layoutP:o}):(xe.type==="propWithChildren"||xe.type==="primitiveProp")&&(Oe=lA(xe,!1)),Oe?no.default.createElement("div",{key:xe.type+"-"+(xe.sheetItemKey||xe.top),style:{position:"absolute",top:xe.top+"px",width:"100%"}},Oe):null}))))},[o,l,h,m,w,U,$,F.node,j,G])},Tae=Eae}),cA,uA,Mae,Cae,Aae,Pae,OEe=P(()=>{zi(),Se(),Oo(),cA=rn(),uA=K($e()),Xt(),ur(),Cae=me.div(Mae||(Mae=q([`
  position: absolute;
  top: 0;
  bottom: 0;
  width: 11px;
  margin-left: -5px;
  cursor: ew-resize;
  z-index: 1;
  pointer-events: auto;

  &:hover,
  &.isDragging {
    background: linear-gradient(
      to right,
      transparent 5px,
      #478698 5px,
      #478698 6px,
      transparent 6px
    );
  }
`]))),Aae=({layoutP:o})=>{let l=Rr(o.leftDims.width),[h,m]=ui(null),_=(0,uA.useRef)(0),w=(0,uA.useMemo)(()=>({debugName:"DopesheetSplitter",lockCursorTo:"ew-resize",onDragStart(){var R;let N;return _.current=(R=(0,cA.val)(de().atomP.historic.panels.sequenceEditor.dopesheetLeftWidth))!=null?R:(0,cA.val)(o.leftDims.width),{onDrag(F){let U=(0,cA.val)(o.dopeSheetDims.width)-100,$=Math.min(U,Math.max(225,_.current+F));N==null||N.discard(),N=de().tempTransaction(({stateEditors:j})=>{j.studio.historic.panels.sequenceEditor.setDopesheetLeftWidth($)})},onDragEnd(F){F?N==null||N.commit():N==null||N.discard()}}}}),[]),[C]=Hs(m,w);return uA.default.createElement(Cae,{ref:h,className:C?"isDragging":"",style:{left:"".concat(l,"px")}})},Pae=Aae}),DF,Rae,Iae,kae,Nae,LEe=P(()=>{$i(),e1(),ur(),Hd(),DF=K($e()),Xt(),zoe(),Iae=me.div(Rae||(Rae=q([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: hidden;
  background: `,`;
  pointer-events: none;
`])),()=>lf.rightBackground,zp(.01,MD(1*.03,Jy.panel.bg))),kae=({layoutP:o})=>{let l=Rr(o.rightDims.width),h=Rr(o.panelDims.height);return DF.default.createElement(Iae,{style:{width:l+"px"}},DF.default.createElement(RF,{width:l,height:h,layoutP:o}))},Nae=kae}),l8,Dae,Oae,Lae,Fae,FEe=P(()=>{ur(),l8=K($e()),Xt(),DEe(),OEe(),LEe(),bF(),EC(),Oae=me.div(Dae||(Dae=q([`
  position: absolute;
  left: 0;
  right: 0;
`]))),Lae=({layoutP:o})=>{let l=Rr(o.dopeSheetDims.height);return l8.default.createElement(Oae,{style:{height:l+"px"}},l8.default.createElement(Nae,{layoutP:o}),l8.default.createElement(gne,null,l8.default.createElement(Tae,{layoutP:o}),l8.default.createElement(Xse,{layoutP:o})),l8.default.createElement(Pae,{layoutP:o}))},Fae=Lae});function BEe(o,l,h){return OF.prism.memo(o,()=>(0,OF.prism)(l),h).getValue()}var OF,UEe=P(()=>{OF=rn()});function Os(o){return function(l,h){return o(l,h())}}function Du(o){return Object.freeze({audience:c8(o,8)?"internal":c8(o,16)?"dev":"public",category:c8(o,4)?"troubleshooting":c8(o,2)?"todo":"general",level:c8(o,512)?512:c8(o,256)?256:c8(o,128)?128:64})}function c8(o,l){return(o&l)===l}function Ls(o,l){return((l&32)===32?!0:(l&16)===16?o.dev:(l&8)===8?o.internal:!1)&&o.min<=l}function Bae(o=console,l={}){let h=V(A({},Kp),{includes:A({},Kp.includes)}),m={styled:GEe.bind(h,o),noStyle:HEe.bind(h,o)},_=VEe.bind(h);function w(){return h.loggingConsoleStyle&&h.loggerConsoleStyle?m.styled:m.noStyle}return h.create=w(),{configureLogger(C){var R;C==="console"?(h.loggerConsoleStyle=Kp.loggerConsoleStyle,h.create=w()):C.type==="console"?(h.loggerConsoleStyle=(R=C.style)!=null?R:Kp.loggerConsoleStyle,h.create=w()):C.type==="keyed"?(h.creatExt=N=>C.keyed(N.names),h.create=_):C.type==="named"&&(h.creatExt=zEe.bind(null,C.named),h.create=_)},configureLogging(C){var R,N,F,U,$;h.includes.dev=(R=C.dev)!=null?R:Kp.includes.dev,h.includes.internal=(N=C.internal)!=null?N:Kp.includes.internal,h.includes.min=(F=C.min)!=null?F:Kp.includes.min,h.include=(U=C.include)!=null?U:Kp.include,h.loggingConsoleStyle=($=C.consoleStyle)!=null?$:Kp.loggingConsoleStyle,h.create=w()},getLogger(){return h.create({names:[]})}}}function zEe(o,l){let h=[];for(let{name:m,key:_}of l.names)h.push(_==null?m:"".concat(m," (").concat(_,")"));return o(h)}function VEe(o){let l=A(A({},this.includes),this.include(o)),h=this.filtered,m=this.named.bind(this,o),_=this.creatExt(o),w=Ls(l,524),C=Ls(l,522),R=Ls(l,521),N=Ls(l,529),F=Ls(l,545),U=Ls(l,265),$=Ls(l,268),j=Ls(l,273),G=Ls(l,289),Y=Ls(l,137),Z=Ls(l,145),ne=Ls(l,73),ae=Ls(l,81),ce=w?_.error.bind(_,Lc._hmm):h.bind(o,524),ve=C?_.error.bind(_,Lc._todo):h.bind(o,522),Me=R?_.error.bind(_,Lc._error):h.bind(o,521),Te=N?_.error.bind(_,Lc.errorDev):h.bind(o,529),_e=F?_.error.bind(_,Lc.errorPublic):h.bind(o,545),it=$?_.warn.bind(_,Lc._kapow):h.bind(o,268),Re=U?_.warn.bind(_,Lc._warn):h.bind(o,265),xe=j?_.warn.bind(_,Lc.warnDev):h.bind(o,273),Oe=G?_.warn.bind(_,Lc.warnPublic):h.bind(o,273),He=Y?_.debug.bind(_,Lc._debug):h.bind(o,137),Fe=Z?_.debug.bind(_,Lc.debugDev):h.bind(o,145),Nt=ne?_.trace.bind(_,Lc._trace):h.bind(o,73),Ve=ae?_.trace.bind(_,Lc.traceDev):h.bind(o,81),Ht={_hmm:ce,_todo:ve,_error:Me,errorDev:Te,errorPublic:_e,_kapow:it,_warn:Re,warnDev:xe,warnPublic:Oe,_debug:He,debugDev:Fe,_trace:Nt,traceDev:Ve,lazy:{_hmm:w?Os(ce):ce,_todo:C?Os(ve):ve,_error:R?Os(Me):Me,errorDev:N?Os(Te):Te,errorPublic:F?Os(_e):_e,_kapow:$?Os(it):it,_warn:U?Os(Re):Re,warnDev:j?Os(xe):xe,warnPublic:G?Os(Oe):Oe,_debug:Y?Os(He):He,debugDev:Z?Os(Fe):Fe,_trace:ne?Os(Nt):Nt,traceDev:ae?Os(Ve):Ve},named:m,utilFor:{internal(){return{debug:Ht._debug,error:Ht._error,warn:Ht._warn,trace:Ht._trace,named(ot,Ye){return Ht.named(ot,Ye).utilFor.internal()}}},dev(){return{debug:Ht.debugDev,error:Ht.errorDev,warn:Ht.warnDev,trace:Ht.traceDev,named(ot,Ye){return Ht.named(ot,Ye).utilFor.dev()}}},public(){return{error:Ht.errorPublic,warn:Ht.warnPublic,debug(ot,Ye){Ht._warn('(public "debug" filtered out) '.concat(ot),Ye)},trace(ot,Ye){Ht._warn('(public "trace" filtered out) '.concat(ot),Ye)},named(ot,Ye){return Ht.named(ot,Ye).utilFor.public()}}}}};return Ht}function GEe(o,l){let h=A(A({},this.includes),this.include(l)),m=[],_="";for(let N=0;N<l.names.length;N++){let{name:F,key:U}=l.names[N];if(_+=" %c".concat(F),m.push(this.style.css(F)),U!=null){let $="%c#".concat(U);_+=$,m.push(this.style.css($))}}let w=this.filtered,C=this.named.bind(this,l),R=[_,...m];return Uae(w,l,h,o,R,jEe(R),C)}function jEe(o){let l=o.slice(0);for(let h=1;h<l.length;h++)l[h]+=";background-color:#e0005a;padding:2px;color:white";return l}function HEe(o,l){let h=A(A({},this.includes),this.include(l)),m="";for(let R=0;R<l.names.length;R++){let{name:N,key:F}=l.names[R];m+=" ".concat(N),F!=null&&(m+="#".concat(F))}let _=this.filtered,w=this.named.bind(this,l),C=[m];return Uae(_,l,h,o,C,C,w)}function Uae(o,l,h,m,_,w,C){let R=Ls(h,524),N=Ls(h,522),F=Ls(h,521),U=Ls(h,529),$=Ls(h,545),j=Ls(h,265),G=Ls(h,268),Y=Ls(h,273),Z=Ls(h,289),ne=Ls(h,137),ae=Ls(h,145),ce=Ls(h,73),ve=Ls(h,81),Me=R?m.error.bind(m,..._):o.bind(l,524),Te=N?m.error.bind(m,..._):o.bind(l,522),_e=F?m.error.bind(m,..._):o.bind(l,521),it=U?m.error.bind(m,..._):o.bind(l,529),Re=$?m.error.bind(m,..._):o.bind(l,545),xe=G?m.warn.bind(m,...w):o.bind(l,268),Oe=j?m.warn.bind(m,..._):o.bind(l,265),He=Y?m.warn.bind(m,..._):o.bind(l,273),Fe=Z?m.warn.bind(m,..._):o.bind(l,273),Nt=ne?m.info.bind(m,..._):o.bind(l,137),Ve=ae?m.info.bind(m,..._):o.bind(l,145),Ht=ce?m.debug.bind(m,..._):o.bind(l,73),ot=ve?m.debug.bind(m,..._):o.bind(l,81),Ye={_hmm:Me,_todo:Te,_error:_e,errorDev:it,errorPublic:Re,_kapow:xe,_warn:Oe,warnDev:He,warnPublic:Fe,_debug:Nt,debugDev:Ve,_trace:Ht,traceDev:ot,lazy:{_hmm:R?Os(Me):Me,_todo:N?Os(Te):Te,_error:F?Os(_e):_e,errorDev:U?Os(it):it,errorPublic:$?Os(Re):Re,_kapow:G?Os(xe):xe,_warn:j?Os(Oe):Oe,warnDev:Y?Os(He):He,warnPublic:Z?Os(Fe):Fe,_debug:ne?Os(Nt):Nt,debugDev:ae?Os(Ve):Ve,_trace:ce?Os(Ht):Ht,traceDev:ve?Os(ot):ot},named:C,utilFor:{internal(){return{debug:Ye._debug,error:Ye._error,warn:Ye._warn,trace:Ye._trace,named(Ee,et){return Ye.named(Ee,et).utilFor.internal()}}},dev(){return{debug:Ye.debugDev,error:Ye.errorDev,warn:Ye.warnDev,trace:Ye.traceDev,named(Ee,et){return Ye.named(Ee,et).utilFor.dev()}}},public(){return{error:Ye.errorPublic,warn:Ye.warnPublic,debug(Ee,et){Ye._warn('(public "debug" filtered out) '.concat(Ee),et)},trace(Ee,et){Ye._warn('(public "trace" filtered out) '.concat(Ee),et)},named(Ee,et){return Ye.named(Ee,et).utilFor.public()}}}}};return Ye}var Lc,Kp,zae=P(()=>{Lc={_hmm:Du(524),_todo:Du(522),_error:Du(521),errorDev:Du(529),errorPublic:Du(545),_kapow:Du(268),_warn:Du(265),warnDev:Du(273),warnPublic:Du(289),_debug:Du(137),debugDev:Du(145),_trace:Du(73),traceDev:Du(81)},Kp={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(o,l,h){return this.create({names:[...o.names,{name:l,key:h}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(o){if(o.length<5)return o;let l=o.replace(this.collapseOnRE,"");return this.cssMemo.has(l)||this.cssMemo.set(l,this.css(o)),l},css(o){var l,h,m,_;let w=this.cssMemo.get(o);if(w)return w;let C="color:".concat((h=(l=this.color)==null?void 0:l.call(this,o))!=null?h:"hsl(".concat((o.charCodeAt(0)+o.charCodeAt(o.length-1))%360,", 100%, 60%)"));return(m=this.bold)!=null&&m.test(o)&&(C+=";font-weight:600"),(_=this.italic)!=null&&_.test(o)&&(C+=";font-style:italic"),this.cssMemo.set(o,C),C}}}}),LF,hA,dA=P(()=>{zae(),zae(),LF=Bae(console,{}),LF.configureLogging({dev:!0,min:64}),hA=LF.getLogger().named("Theatre.js (default logger)").utilFor.dev()}),rg,U9,Vae,WEe=P(()=>{Yd(),rg=rn(),dA(),U9=28,Vae=(o,l)=>{rg.prism.ensurePrism();let h=!1,m=30,_=0,w=l.atomP.ahistoric.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId].sequence.collapsableItems,C={type:"sheet",isCollapsed:!1,sheet:o,children:[],sheetItemKey:Ga.forSheet(),shouldRender:h,top:60,depth:0,n:_,nodeHeight:0,heightIncludingChildren:-1};for(let Y of Object.values((0,rg.val)(o.objectsP)))Y&&F(Y,C.children,C.depth+1,!0);let R=(0,rg.val)(l.atomP.historic.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId]),N=(0,rg.val)(R.sequenceEditor);if(N){let Y=N.subSequenceSet;if(Y){let Z=Object.values(Y.byId||{}).filter(ne=>ne!==void 0).map(ne=>ne).sort((ne,ae)=>ne.position-ae.position);for(let ne of Z){let ae={type:"subSequence",subSequence:ne,sheet:o,sheetItemKey:Ga.forSubSequence(ne.id),shouldRender:!0,top:m,depth:C.depth+1,n:_,nodeHeight:U9,heightIncludingChildren:U9};C.children.push(ae),m+=U9,_+=1}}}C.heightIncludingChildren=m-C.top;function F(Y,Z,ne,ae){var ce;let ve=(0,rg.val)(Y.template.getMapOfValidSequenceTracks_forStudio()),Me=(0,rg.val)(Y.template.configPointer);if(Object.keys(Me.props).length===0)return;let Te=(ce=(0,rg.val)(w.byId[Ga.forSheetObject(Y)].isCollapsed))!=null?ce:!0,_e={type:"sheetObject",isCollapsed:Te,sheetItemKey:Ga.forSheetObject(Y),shouldRender:ae,top:m,children:[],depth:ne,n:_,sheetObject:Y,nodeHeight:U9,heightIncludingChildren:-1};Z.push(_e),_+=1,m+=_e.nodeHeight,U(Y,Me.props,ve,[],Me,_e.children,ne+1,!Te),_e.heightIncludingChildren=m-_e.top}function U(Y,Z,ne,ae,ce,ve,Me,Te){for(let[_e,it]of Object.entries(Z)){let Re=ne[_e];$(Y,Re,[...ae,_e],it,ve,Me,Te)}}function $(Y,Z,ne,ae,ce,ve,Me){ae.type==="compound"?j(Y,Z||{},ae,ne,ae,ce,ve,Me):ae.type==="enum"?hA.warn("Prop type enum is not yet supported in the sequence editor"):G(Y,Z,ne,ae,ce,ve,Me)}function j(Y,Z,ne,ae,ce,ve,Me,Te){var _e;let it=(_e=(0,rg.val)(w.byId[Ga.forSheetObjectProp(Y,ae)].isCollapsed))!=null?_e:!1,Re={type:"propWithChildren",isCollapsed:it,propConf:ne,pathToProp:ae,sheetItemKey:Ga.forSheetObjectProp(Y,ae),sheetObject:Y,shouldRender:Te,top:m,children:[],nodeHeight:Te?U9:0,heightIncludingChildren:-1,depth:Me,trackMapping:Z,n:_};ve.push(Re),Te&&(m+=Re.nodeHeight,_+=1),U(Y,ce.props,Z,ae,ce,Re.children,Me+1,Te&&!it),Re.heightIncludingChildren=m-Re.top}function G(Y,Z,ne,ae,ce,ve,Me){let Te={type:"primitiveProp",propConf:ae,depth:ve,sheetItemKey:Ga.forSheetObjectProp(Y,ne),sheetObject:Y,pathToProp:ne,shouldRender:Me,top:m,nodeHeight:Me?U9:0,heightIncludingChildren:Me?U9:0,trackId:Z,n:_};ce.push(Te),_+=1,m+=Te.nodeHeight}return C}});function $Ee(o,l){let h=de(),m=h.atomP.ahistoric.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId],_=h.atomP.historic.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId];return(0,ja.prism)(()=>{var w,C,R;let N=BEe("tree",()=>Vae(o,h),[]),F=(0,ja.val)(l),U=(0,ja.val)(h.atomP.historic.panels.sequenceEditor.graphEditor),$=h.atomP.historic.panels.sequenceEditor.rightPanelOpen,j=(w=(0,ja.val)($))!=null?w:!0,G=(0,ja.val)(_.sequenceEditor.selectedPropsByObject),Y=!!G&&Object.keys(G).length>0,Z=(C=(0,ja.val)(h.atomP.historic.panels.sequenceEditor.dopesheetLeftWidth))!=null?C:Math.floor(F.width*Gae),{leftDims:ne,rightDims:ae,graphEditorDims:ce,dopeSheetDims:ve,horizontalScrollbarDims:Me}=ja.prism.memo("leftDims",()=>{var ot,Ye;let Ee=(ot=(0,ja.val)($))!=null?ot:!0,et={width:Z,height:F.height,screenX:F.screenX,screenY:F.screenY},At={width:Ee?F.width-et.width:0,height:F.height,screenX:F.screenX+et.width,screenY:F.screenY},Ce=Y&&(U==null?void 0:U.isOpen)===!0,Ze=Math.floor((Ce?Bi((Ye=U==null?void 0:U.height)!=null?Ye:.5,.1,.7):0)*F.heightWithoutBorder),Ft=F.height,$t={width:F.width,height:Ft,screenX:F.screenX,screenY:F.screenY},_t={isAvailable:Y,isOpen:Ce,width:At.width,height:Ze,screenX:F.screenX,screenY:F.screenY+Ft,padding:{top:20,bottom:20}};return{leftDims:et,rightDims:At,graphEditorDims:_t,dopeSheetDims:$t,horizontalScrollbarDims:{bottom:0}}},[F,U,Y,$,Z]),Te=ja.prism.memo("graphEditorVerticalSpace",()=>{let ot=ce.height-ce.padding.top-ce.padding.bottom;return{space:ot,fromExtremumSpace(Ye){return Ye*ot},toExtremumSpace(Ye){return Ye/ot}}},[ce]),[_e,it]=ja.prism.state("isSeeking",!1),Re={isSeeking:_e,setIsSeeking:it},xe={},Oe=(R=(0,ja.val)(m.sequence.clippedSpaceRange))!=null?R:jae,He=ja.prism.memo("scaledSpace",()=>{let ot=Oe.end-Oe.start,Ye=ae.width,Ee=ot/Ye,et=Ye/ot;return{fromUnitSpace(At){return At*et},toUnitSpace(At){return At*Ee},leftPadding:10}},[Oe,ae.width]),Fe=ja.prism.memo("setClippedSpaceRange",()=>function(ot){h.transaction(({stateEditors:Ye})=>{let Ee=A({},ot);if(Ee.end<=Ee.start&&(Ee.end=Ee.start+1),Ee.start<0){let et=Ee.end-Ee.start;Ee.start=0,Ee.end=et}Ye.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.clippedSpaceRange.set(V(A({},o.address),{range:Ee}))})},[]),Nt=ja.prism.memo("clippedSpace",()=>({range:Oe,width:ae.width,fromUnitSpace(ot){return He.fromUnitSpace(ot-Oe.start)+He.leftPadding},toUnitSpace(ot){return He.toUnitSpace(ot-He.leftPadding)+Oe.start},setRange:Fe}),[Oe,ae.width,He,Fe]),Ve=ja.prism.memo("selection.current",()=>new ja.Atom({current:void 0}),[]),Ht=ja.prism.memo("setRightPanelOpen",()=>function(ot){h.transaction(({stateEditors:Ye})=>{Ye.studio.historic.panels.sequenceEditor.setRightPanelOpen(ot)})},[]);return RO("finalAtom",{sheet:o,tree:N,panelDims:F,leftDims:ne,rightDims:ae,dopeSheetDims:ve,horizontalScrollbarDims:Me,seeker:Re,unitSpace:xe,scaledSpace:He,clippedSpace:Nt,graphEditorDims:ce,graphEditorVerticalSpace:Te,selectionAtom:Ve,rightPanelOpen:j,setRightPanelOpen:Ht}).pointer})}var ja,Gae,jae,FF,qEe=P(()=>{Se(),UEe(),jZ(),ja=rn(),WEe(),m0(),Gae=.3,jae={start:0,end:10},FF=250});function XEe(o){let{fullSecondStampsContainer:l,sequencePositionFormatter:h,snapToGrid:m,unitSpaceToClippedSpace:_}=o,w="";Poe(o,(C,R)=>{let N=m(C),F=_(N);R?w+=Hae(h.formatFullUnitForGrid(N),F,"full-unit"):w+=Hae(h.formatSubUnitForGrid(N),F,"sub-unit")}),l.innerHTML=w}function Hae(o,l,h){return'<span class="'.concat(h,'" style="transform: translate3d(').concat(l.toFixed(1),'px, -50%, 0);">').concat(o,"</span>")}var u8,h8,Wae,$ae,d8,qae,Xae,Yae,Kae,Zae,Qae,Jae=P(()=>{u8=rn(),h8=K($e()),Xt(),Ioe(),Se(),$ae=me.div(Wae||(Wae=q([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),d8={fullUnitStampColor:"#999999",stampFontSize:"10px",subUnitStampColor:"#666666"},Xae=me.div(qae||(qae=q([`
  position: absolute;
  top: 0;
  height: 100%;
  left: 0;
  overflow: hidden;
  z-index: 2;
  will-change: transform;
  pointer-events: none;
`]))),Kae=me.div(Yae||(Yae=q([`
  position: absolute;
  top: 0;
  left: 0;

  & > span {
    position: absolute;
    display: block;
    top: 9px;
    left: -10px;
    color: `,`;
    text-align: center;
    font-size: `,`;
    width: 20px;

    &.full-unit {
      color: `,`;
    }

    &.sub-unit {
      color: `,`;
    }
  }

  pointer-events: none;
`])),d8.fullUnitStampColor,d8.stampFontSize,d8.fullUnitStampColor,d8.subUnitStampColor),Zae=({layoutP:o,width:l})=>{let h=(0,h8.useRef)(null),[m,_]=(0,h8.useState)(null);return(0,h8.useLayoutEffect)(()=>{if(m)return(0,u8.prism)(()=>{let w=(0,u8.val)(o.sheet).getSequence();return{fullSecondStampsContainer:m,clippedSpaceRange:(0,u8.val)(o.clippedSpace.range),clippedSpaceWidth:(0,u8.val)(o.clippedSpace.width),unitSpaceToClippedSpace:(0,u8.val)(o.clippedSpace.fromUnitSpace),leftPadding:(0,u8.val)(o.scaledSpace.leftPadding),fps:w.subUnitsPerUnit,sequencePositionFormatter:w.positionFormatter,snapToGrid:C=>w.closestGridPosition(C)}}).onChange(de().ticker,XEe,!0)},[m,l,o]),h8.default.createElement($ae,{ref:h,style:{width:l+"px"}},h8.default.createElement(Xae,{style:{width:l+"px"}},h8.default.createElement(Kae,{ref:_})))},Qae=Zae});function YEe(o){let[l,h]=(0,BF.useState)(!1);return(0,BF.useEffect)(()=>{if(h(!1),!o)return;let m=w=>{w.target===o?h(!0):h(!1)},_=()=>{h(!1)};return o.addEventListener("mouseenter",m),o.addEventListener("mousemove",m),o.addEventListener("mouseleave",_),()=>{h(!1),o.removeEventListener("mouseenter",m),o.removeEventListener("mousemove",m),o.removeEventListener("mouseleave",_)}},[o]),l}var BF,KEe=P(()=>{BF=K($e())});function ZEe(o,l){let h=0,[m,_]=o,[w,C]=l;return _-m>C-w?[w,C]:(m<w&&(h=0-m),_>C&&(h=C-_),[m+h,_+h])}var Zp,z9,ia,UF,e0e,fA,t0e,n0e,r0e=P(()=>{Zp=rn(),ur(),$i(),Se(),p8(),el(),Oo(),zi(),z9=K($e()),Xt(),ba(),ia={enabled:{backgroundColor:"#2C2F34",stroke:"#646568"},disabled:{backgroundColor:"#282a2cc5",stroke:"#595a5d"},hover:{backgroundColor:"#34373D",stroke:"#C8CAC0"},dragging:{backgroundColor:"#3F444A",stroke:"#C8CAC0"},thumbWidth:9,hitZoneWidth:26,rangeStripMinWidth:30},UF=1e3,fA=me.div(e0e||(e0e=q([`
  position: absolute;
  height: `,`px;
  background-color: `,`;
  cursor: grab;
  top: 0;
  left: 0;
  width: `,`px;
  transform-origin: left top;
  &:hover {
    background-color: `,`;
  }
  &.dragging {
    background-color: `,`;
    cursor: grabbing !important;
  }
  `,`;

  /* covers the one pixel space between the focus range strip and the top strip
  of the sequence editor panel, which would have caused that one pixel to act
  like a panel drag zone */
  &:after {
    display: block;
    content: ' ';
    position: absolute;
    bottom: -1px;
    height: 1px;
    left: 0;
    right: 0;
    background: transparent;
    pointer-events: normal;
    z-index: -1;
  }
`])),()=>Jp-1,o=>o.enabled?ia.enabled.backgroundColor:ia.disabled.backgroundColor,UF,ia.hover.backgroundColor,ia.dragging.backgroundColor,Ni),t0e=({layoutP:o})=>{let l=(0,z9.useMemo)(()=>(0,Zp.prism)(()=>{let{projectId:F,sheetId:U}=(0,Zp.val)(o.sheet).address;return(0,Zp.val)(de().atomP.ahistoric.projects.stateByProjectId[F].stateBySheetId[U].sequence.focusRange)}),[o]),[h,m]=ui(null),[_]=J0(m,{menuItems:()=>{let F=(0,Zp.val)(o.sheet),U=l.getValue();return[{label:"Delete focus range",callback:()=>{de().tempTransaction(({stateEditors:$})=>{$.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.unset(A({},F.address))}).commit()}},{label:U!=null&&U.enabled?"Disable focus range":"Enable focus range",callback:()=>{U!==void 0&&de().tempTransaction(({stateEditors:$})=>{$.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(V(A({},F.address),{range:U.range,enabled:!U.enabled}))}).commit()}}]}}),w=Rr(o.scaledSpace.toUnitSpace),C=Rr(o.sheet),R=(0,z9.useMemo)(()=>{let F,U;return{debugName:"FocusRangeStrip",onDragStart($){let j,G=l.getValue();if(!G)return!1;let Y=G.range.start,Z=G.range.end,ne=!1,ae=(0,Zp.val)(o.sheet).getSequence();return{onDrag(ce){if(G=l.getValue(),G){ne=!0;let ve=w(ce),Me=Y+ve,Te=Z+ve;Te<Me&&(Te=Me),[F,U]=ZEe([Me,Te],[0,ae.length]).map(_e=>ae.closestGridPosition(_e)),j&&j.discard(),j=de().tempTransaction(({stateEditors:_e})=>{var it;_e.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(V(A({},C.address),{range:{start:F,end:U},enabled:(it=G==null?void 0:G.enabled)!=null?it:!0}))})}},onDragEnd(){G&&(ne&&j!==void 0?j.commit():j&&j.discard())}}},lockCSSCursorTo:"grabbing"}},[C,w]),[N]=Hs(m,R);return $p(N,-1),jr(()=>{let F=l.getValue(),U=(F==null?void 0:F.range)||{start:0,end:0},$=(0,Zp.val)(o.clippedSpace.fromUnitSpace)(U.start),j=(0,Zp.val)(o.clippedSpace.fromUnitSpace)(U.end),G,Y;return $<0&&($=0),j>(0,Zp.val)(o.clippedSpace.width)&&(j=(0,Zp.val)(o.clippedSpace.width)),$>j?(Y=0,G=0):(Y=$,G=(j-$)/UF),F?z9.default.createElement(z9.default.Fragment,null,_,z9.default.createElement(fA,{id:"range-strip",enabled:F.enabled,className:"".concat(N?"dragging":""," ").concat(F.enabled?"enabled":""),ref:h,style:{transform:"translateX(".concat(Y,"px) scale(").concat(G,", 1)")}})):z9.default.createElement(z9.default.Fragment,null)},[o,h,l,_,N])},n0e=t0e}),V9,ig,i0e,s0e,o0e,a0e,l0e,c0e,u0e,zF,QEe=P(()=>{V9=rn(),ur(),Se(),p8(),K0(),Oo(),zi(),ig=K($e()),Xt(),ba(),r0e(),rf(),s0e=me.div(i0e||(i0e=q([`
  position: absolute;
  top: 0;
  // the right handle has to be pulled back by its width since its right side indicates its position, not its left side
  left: `,`px;
  transform-origin: left top;
  width: `,`px;
  height: `,`px;
  z-index: 3;

  --bg: `,`;

  stroke: `,`;
  user-select: none;

  cursor: `,`;

  // no pointer events unless pointer-root is in normal mode _and_ the
  // focus range is enabled
  #pointer-root & {
    pointer-events: none;
  }

  #pointer-root.normal & {
    pointer-events: auto;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.dragging {
    pointer-events: none !important;
  }

  // highlight the handle if it's hovered, or the whole strip is hovverd
  `,`:hover ~ &, &:hover {
    --bg: `,`;
    stroke: `,`;
  }

  // highlight the handle when it's being dragged or the whole strip is being dragged.
  // using dragging.dragging to give this selector priority, as it seems to be overridden
  // by the hover selector above
  &.dragging,
  `,`.dragging.dragging ~ & {
    --bg: `,`;
    stroke: `,`;
  }

  #pointer-root.draggingPositionInSequenceEditor &:hover {
    --bg: `,`;
    stroke: #40aaa4;
  }

  background-color: var(--bg);

  // a larger hit zone
  &:before {
    display: block;
    content: ' ';
    position: absolute;
    inset: -8px;
  }
`])),o=>o.type==="start"?0:-ia.thumbWidth,ia.thumbWidth,()=>Jp-1,({enabled:o})=>o?ia.enabled.backgroundColor:ia.disabled.backgroundColor,ia.enabled.stroke,o=>o.type==="start"?"w-resize":"e-resize",$d,()=>fA,ia.hover.backgroundColor,ia.hover.stroke,()=>fA,ia.dragging.backgroundColor,ia.dragging.stroke,ia.dragging.backgroundColor),a0e=me.div(o0e||(o0e=q([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    var(--bg) 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),o=>o.type==="start"?90:-90,o=>o.type==="start"?ia.thumbWidth:-ia.thumbWidth+1),c0e=me.div(l0e||(l0e=q([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    `,` 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),o=>o.type==="start"?-90:90,()=>nS.backgroundColor,o=>o.type==="start"?-12:ia.thumbWidth),u0e=({layoutP:o,thumbType:l})=>{var h;let[m,_]=ui(null),w=(0,ig.useMemo)(()=>(0,V9.prism)(()=>{let{projectId:F,sheetId:U}=(0,V9.val)(o.sheet).address;return(0,V9.val)(de().atomP.ahistoric.projects.stateByProjectId[F].stateBySheetId[U].sequence.focusRange)}),[o]),C=(0,ig.useMemo)(()=>({debugName:"FocusRangeThumb",onDragStart(){let F,U,$=(0,V9.val)(o.sheet),j={start:0,end:$.getSequence().length},G=w.getValue()||{range:j,enabled:!1},Y=G.enabled,Z=G.range[l],ne=(0,V9.val)(o.scaledSpace.toUnitSpace),ae=ne(ia.rangeStripMinWidth);return{onDrag(ce,ve,Me){var Te;let _e,it=tl.checkIfMouseEventSnapToPos(Me,{ignore:_});if(it==null){let xe=ne(ce);_e=Z+xe}else _e=it;U=((Te=w.getValue())==null?void 0:Te.range)||j,l==="start"?_e=Math.max(Math.min(_e,U.end-ae),0):_e=Math.min(Math.max(_e,U.start+ae),$.getSequence().length);let Re=$.getSequence().closestGridPosition(_e);F!==void 0&&F.discard(),F=de().tempTransaction(({stateEditors:xe})=>{xe.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(V(A({},$.address),{range:V(A({},U),{[l]:Re}),enabled:Y}))})},onDragEnd(ce){ce?F==null||F.commit():F==null||F.discard()}}}}),[o]),[R]=Hs(_,C);kc(R,"draggingPositionInSequenceEditor",l==="start"?"w-resize":"e-resize");let N=Rr(w);return $p(R,(h=N==null?void 0:N.range[l])!=null?h:0),jr(()=>{let F=w.getValue();if(!F)return null;let{enabled:U}=F,$=F.range[l],j=(0,V9.val)(o.clippedSpace.fromUnitSpace)($);return(j<0||(0,V9.val)(o.clippedSpace.width)<j)&&(j=-1e4),ig.default.createElement(s0e,V(A(A({ref:m},tl.includePositionSnapAttrs($)),qp($)),{className:"".concat(R&&"dragging"," ").concat(U&&"enabled"),enabled:U,type:l,style:{transform:"translate3d(".concat(j,"px, 0, 0)")}}),ig.default.createElement(a0e,{type:l,enabled:U}),ig.default.createElement(c0e,{type:l}),ig.default.createElement("svg",{viewBox:"0 0 9 18",xmlns:"http://www.w3.org/2000/svg"},ig.default.createElement("line",{x1:"4",y1:"6",x2:"4",y2:"12"}),ig.default.createElement("line",{x1:"6",y1:"6",x2:"6",y2:"12"})))},[o,m,w,R])},zF=u0e});function JEe(o,l){let[h,m]=(0,Qp.useState)("none");return kc(h!=="none","dragging",h==="creating"?"ew-resize":"move"),(0,Qp.useMemo)(()=>{let _=()=>({debugName:"FocusRangeZone/focusRangeCreationGestureHandlers",onDragStart(C){let R,N=(0,f8.val)(o.clippedSpace.toUnitSpace),F=(0,f8.val)(o.scaledSpace.toUnitSpace),U=(0,f8.val)(o.sheet),$=U.getSequence(),j=C.target.getBoundingClientRect(),G=N(C.clientX-j.left),Y=F(ia.rangeStripMinWidth);return{onDrag(Z){let ne=F(Z),ae=G,ce=G+ne;[ae,ce]=[Bi(ae,0,$.length),Bi(ce,0,$.length)].map(ve=>$.closestGridPosition(ve)),ce<ae?[ae,ce]=[Math.max(Math.min(ce,ae-Y),0),ae]:Z>0&&(ce=Math.min(Math.max(ce,ae+Y),$.length)),R&&R.discard(),R=de().tempTransaction(({stateEditors:ve})=>{ve.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(V(A({},U.address),{range:{start:ae,end:ce},enabled:!0}))})},onDragEnd(Z){Z&&R!==void 0?R.commit():R&&R.discard()}}},lockCSSCursorTo:"ew-resize"}),w=()=>({debugName:"FocusRangeZone/panelMoveGestureHandlers",onDragStart(){let C,R=l.current,N=l.current.addBoundsHighlightLock();return{onDrag(F,U){let $=V(A({},R.dims),{top:Bi(R.dims.top+U,0,window.innerHeight-Vp),left:Bi(R.dims.left+F,-R.dims.width+Vp,window.innerWidth-Vp)}),j=VM($,{width:window.innerWidth,height:window.innerHeight});C==null||C.discard(),C=de().tempTransaction(({stateEditors:G})=>{G.studio.historic.panelPositions.setPanelPosition({position:j,panelId:R.panelId})})},onDragEnd(F){N(),F?C==null||C.commit():C==null||C.discard()}}},lockCSSCursorTo:"move"});return{debugName:"FocusRangeZone",onDragStart(C){let[R,N]=C.shiftKey?["creating",_().onDragStart(C)]:["moving-panel",w().onDragStart(C)];return m(R),N===!1?!1:{onDrag(F,U,$,j,G){N.onDrag(F,U,$,j,G)},onDragEnd(F){var U;m("none"),(U=N.onDragEnd)==null||U.call(N,F)}}}}},[o,l])}var f8,Qp,h0e,d0e,f0e,p0e,eTe=P(()=>{f8=rn(),ur(),Se(),s6(),p8(),K0(),Oo(),KEe(),ene(),zi(),m0(),Qp=K($e()),Xt(),r0e(),QEe(),M9(),d0e=me.div(h0e||(h0e=q([`
  position: absolute;
  height: `,`px;
  left: 0;
  right: 0;
  box-sizing: border-box;
  /* Use the "grab" cursor if the shift key is up, which is the one used on the top strip of the sequence editor */
  cursor: `,`;
`])),()=>Jp,o=>o.isShiftDown?"ew-resize":"move"),f0e=({layoutP:o})=>{let[l,h]=ui(null),m=i6(),_=(0,Qp.useRef)(m);_.current=m;let w=(0,Qp.useMemo)(()=>(0,f8.prism)(()=>{let{projectId:N,sheetId:F}=(0,f8.val)(o.sheet).address;return(0,f8.val)(de().atomP.ahistoric.projects.stateByProjectId[N].stateBySheetId[F].sequence.focusRange)}),[o]);Hs(h,JEe(o,_));let C=Qte("Shift"),R=YEe(h);return(0,Qp.useEffect)(()=>{if(!C&&R)return _.current.addBoundsHighlightLock()},[!C&&R]),jr(()=>Qp.default.createElement(d0e,{ref:l,isShiftDown:C},Qp.default.createElement(n0e,{layoutP:o}),Qp.default.createElement(zF,{thumbType:"start",layoutP:o}),Qp.default.createElement(zF,{thumbType:"end",layoutP:o})),[o,w,C])},p0e=f0e}),D6,Jp,nS,m0e,g0e,v0e,y0e,p8=P(()=>{ur(),D6=K($e()),Xt(),Jae(),ba(),$i(),eTe(),Jp=30,nS={backgroundColor:"#1f2120eb",borderColor:"#1c1e21"},g0e=me.div(m0e||(m0e=q([`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: `,`px;
  box-sizing: border-box;
  background: `,`;
  border-bottom: 1px solid `,`;
  z-index: -10;
  `,`;
`])),Jp,nS.backgroundColor,nS.borderColor,Ni),v0e=({layoutP:o})=>{let l=Rr(o.rightDims.width);return D6.default.createElement(D6.default.Fragment,null,D6.default.createElement(g0e,A({},qp("hide")),D6.default.createElement(Qae,{layoutP:o,width:l,height:Jp}),D6.default.createElement(p0e,{layoutP:o})))},y0e=v0e}),m8,x0e,_0e,b0e,S0e,w0e,E0e,T0e,M0e,tTe=P(()=>{m8=K($e()),Xt(),ur(),Se(),Pb(),Ym(),x0e=o=>isFinite(o)&&o>0,b0e=me.div(_0e||(_0e=q([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),w0e=me.div(S0e||(S0e=q([`
  `,`;
  white-space: nowrap;
`])),Kd),E0e=({deltaX:o})=>o*.25,T0e=({layoutP:o})=>{let l=Rr(o.sheet),h=(0,m8.useMemo)(()=>{let _;return{temporarilySetValue(w){_&&(_.discard(),_=void 0),_=de().tempTransaction(({stateEditors:C})=>{C.coreByProject.historic.sheetsById.sequence.setLength(V(A({},l.address),{length:w}))})},discardTemporaryValue(){_&&(_.discard(),_=void 0)},permanentlySetValue(w){_&&(_.discard(),_=void 0),de().transaction(({stateEditors:C})=>{C.coreByProject.historic.sheetsById.sequence.setLength(V(A({},l.address),{length:w}))})}}},[o,l]),m=(0,m8.useRef)(null);return(0,m8.useLayoutEffect)(()=>{m.current.focus()},[]),jr(()=>{let _=l.getSequence().length;return m8.default.createElement(b0e,null,m8.default.createElement(w0e,null,"Sequence length"),m8.default.createElement(f6,V(A({value:_},h),{isValid:x0e,inputRef:m,nudge:E0e})))},[l,h,m])},M0e=T0e});function nTe(o,l){let h=(0,Fc.useRef)(l);h.current=l;let m=(0,Fc.useMemo)(()=>({debugName:"LengthIndicator/useDragBulge",lockCSSCursorTo:"ew-resize",onDragStart(w){let C,R=h.current,N=(0,g8.val)(h.current.layoutP.sheet),F=N.getSequence().length,U=(0,g8.val)(R.layoutP.scaledSpace.toUnitSpace);return{onDrag($,j,G){let Y=U($);C&&(C.discard(),C=void 0),C=de().tempTransaction(({stateEditors:Z})=>{Z.coreByProject.historic.sheetsById.sequence.setLength(V(A({},N.address),{length:F+Y}))})},onDragEnd($){$?C&&C.commit():C&&C.discard()}}}}),[]),[_]=Hs(o,m);return $p(_,-1),[_]}var g8,Fc,VF,rS,C0e,G9,A0e,P0e,R0e,I0e,k0e,N0e,D0e,O0e,L0e,F0e,B0e,rTe=P(()=>{ur(),g8=rn(),Fc=K($e()),Xt(),e1(),p8(),zi(),Oo(),Se(),Zd(),ba(),Eb(),tTe(),$i(),Qd(),VF=1e3,rS={stripNormal:"#0000006c",stripActive:"#000000"},G9=me.div(C0e||(C0e=q([`
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  z-index: `,`;
  pointer-events: none;

  &:after {
    display: block;
    content: ' ';
    position: absolute;
    /* top: `,`px; */
    top: 0;
    bottom: 0;
    left: -1px;
    width: 1px;
    background-color: `,`;
  }

  &:hover:after,
  &.dragging:after {
    background-color: `,`;
  }
`])),()=>lf.lengthIndicatorStrip,Jp,rS.stripNormal,rS.stripActive),P0e=me.div(A0e||(A0e=q([`
  position: absolute;
  top: `,`px;
  width: 100px;
  left: -50px;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 1;
`])),Jp-15),I0e=me.div(R0e||(R0e=q([`
  margin-top: 8px;
  font-size: 10px;
  white-space: nowrap;
  padding: 2px 8px;
  border-radius: 2px;
  `,`;
  cursor: ew-resize;
  color: #464646;
  background-color: #0000004d;
  display: none;

  `,":hover &, ",`.dragging & {
    display: block;
    color: white;
    background-color: `,`;
  }
`])),Ni,G9,G9,rS.stripActive),N0e=me.div(k0e||(k0e=q([`
  font-size: 10px;
  white-space: nowrap;
  padding: 1px 2px;
  border-radius: 2px;
  `,`;
  justify-content: center;
  align-items: center;
  cursor: ew-resize;
  color: #5d5d5d;
  background-color: #191919;

  `,":hover &, ",`.dragging & {
    color: white;
    background-color: `,`;

    & > svg:first-child {
      margin-right: -1px;
    }
  }

  & > svg:first-child {
    margin-right: -4px;
  }
`])),Ni,G9,G9,rS.stripActive),O0e=me.div(D0e||(D0e=q([`
  position: absolute;
  top: 0;
  left: 0;
  background-color: rgb(23 23 23 / 43%);
  width: `,`px;
  z-index: `,`;
  transform-origin: left top;

  `,".dragging ~ &, ",`:hover ~ & {
    background-color: rgb(23 23 23 / 60%);
  }
`])),VF,()=>lf.lengthIndicatorCover,G9,G9),L0e=-1e4,F0e=({layoutP:o})=>{let[l,h]=ui(null),[m]=nTe(h,{layoutP:o}),{node:_,toggle:w,close:C}=Nc({debugName:"LengthIndicator"},()=>Fc.default.createElement(Dc,null,Fc.default.createElement(M0e,{layoutP:o,onRequestClose:C})));return jr(()=>{let R=(0,g8.val)(o.sheet),N=(0,g8.val)(o.rightDims.height),F=R.getSequence(),U=F.length,$=U,j=(0,g8.val)(o.clippedSpace.fromUnitSpace)($),G=(0,g8.val)(o.clippedSpace.width),Y,Z;return j>G?(Z=0,Y=0):(j<0&&(j=0),Z=j,Y=(G-j)/VF),Fc.default.createElement(Fc.default.Fragment,null,_,Fc.default.createElement(G9,{style:{height:N+"px",transform:"translateX(".concat(Z===0?L0e:Z,"px)")},className:m?"dragging":""},Fc.default.createElement(P0e,null,Fc.default.createElement(N0e,A({ref:l,onClick:ne=>{w(ne,h)}},qp("hide")),Fc.default.createElement(Sbe,null),Fc.default.createElement(wbe,null)),Fc.default.createElement(I0e,null,"Sequence length:"," ",F.positionFormatter.formatBasic(U)))),Fc.default.createElement(O0e,{title:"Length",style:{height:N+"px",transform:"translateX(".concat(Z,"px) scale(").concat(Y,", 1)")}}))},[o,l,m,_])},B0e=F0e}),GF,sg,U0e,z0e,V0e,G0e,j0e,H0e,W0e,$0e,iTe=P(()=>{ur(),GF=rn(),sg=K($e()),Xt(),Jae(),e1(),p8(),ba(),z0e=me.div(U0e||(U0e=q([`
  position: absolute;
  top: 0;
  left: 0;
  margin-top: 0px;
`]))),G0e=me.div(V0e||(V0e=q([`
  position: absolute;
  top: 16px;
  font-size: `,`;
  color: `,`;
  text-align: center;
  transform: translateX(-50%);
  background: `,`;
  padding: 1px 8px;
  font-variant-numeric: tabular-nums;
  pointer-events: none;
  z-index: `,`;
`])),d8.stampFontSize,d8.fullUnitStampColor,nS.backgroundColor,()=>lf.currentFrameStamp),H0e=me.div(j0e||(j0e=q([`
  position: absolute;
  top: 5px;
  left: -0px;
  bottom: 0;
  width: 0.5px;
  background: rgba(100, 100, 100, 0.2);
  pointer-events: none;
`]))),W0e=sg.default.memo(({layoutP:o})=>{let[l,h]=Rr(Sne()),m=Rr(o.clippedSpace.fromUnitSpace),{sequence:_,formatter:w,clippedSpaceWidth:C}=jr(()=>{let U=(0,GF.val)(o.sheet).getSequence(),$=(0,GF.val)(o.clippedSpace.width);return{sequence:U,formatter:U.positionFormatter,clippedSpaceWidth:$}},[o]);if(l==-1)return sg.default.createElement(sg.default.Fragment,null);let R=h===3?_.closestGridPosition(l):l,N=m(R),F=N>=0&&N<=C;return sg.default.createElement(sg.default.Fragment,null,sg.default.createElement(z0e,null,sg.default.createElement(G0e,{style:{opacity:F?1:0,transform:"translate3d(calc(".concat(N,"px - 50%), 0, 0)")}},w.formatForPlayhead(R)),sg.default.createElement(H0e,{posType:h,style:{opacity:F?1:0,transform:"translate3d(".concat(N,"px, 0, 0)")}}))," ")}),$0e=W0e}),Fh,ro,q0e,X0e,Y0e,K0e,Z0e,pA,Q0e,jF,J0e,mA,ele,gA,tle,HF,nle,WF,rle,ile,sTe=P(()=>{ur(),Fh=rn(),eM(),Hd(),ro=K($e()),Xt(),e1(),ba(),$i(),Oo(),X0e=me.div(q0e||(q0e=q([`
  --threadHeight: 20px;
  --bg-inactive: #32353b;
  --bg-active: #5b5c5d;
  position: absolute;
  height: 0;
  width: 100%;
  left: 12px;
  /* bottom: 8px; */
  z-index: `,`;
  `,`
`])),()=>lf.horizontalScrollbar,Ni),K0e=me.div(Y0e||(Y0e=q([`
  position: relative;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--threadHeight);
`]))),pA=me.div(Z0e||(Z0e=q([`
  position: absolute;
  height: 20px;
  background: var(--bg-inactive);
  cursor: ew-resize;
  z-index: 2;

  &:hover,
  &:active {
    background: var(--bg-active);
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),ED("absolute","-4px")),jF=me.div(Q0e||(Q0e=q([`
  position: absolute;
  height: 20px;
  width: 7px;
  left: 0;
  z-index: 2;
  top: 0;
  bottom: 0;
  display: block;

  &:hover:before {
    background: var(--bg-active);
  }

  &:before {
    `,`;
    display: block;
    content: ' ';
    background: var(--bg-inactive);
    border-radius: 0 2px 2px 0;
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),ED("absolute","0"),ED("absolute","-4px")),mA=me(jF)(J0e||(J0e=q([`
  left: calc(-1 * 7px);
  cursor: w-resize;
  &:before {
    transform: scaleX(-1);
  }
`]))),gA=me(jF)(ele||(ele=q([`
  cursor: e-resize;
  left: 0px;
`]))),HF=me.div(tle||(tle=q([`
  display: `,`;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 4px;
  transform: translateX(-50%);
  background: #131d1f;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;

  `,`:hover &,
  `,`:hover &,
  `,":hover ~ ",` &,
  `,":hover ~ ",` & {
    display: block;
  }
`])),o=>o.active?"block":"none",mA,gA,pA,mA,pA,gA),WF=me.input(nle||(nle=q([`
  background: transparent;
  border: none;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;
  width: 40px;
  outline: none;

  &:focus {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
  }
`]))),rle=({layoutP:o})=>{let l=(0,ro.useCallback)(xe=>xe.toFixed(2),[]),h=(0,ro.useMemo)(()=>(0,Fh.prism)(()=>{let xe=(0,Fh.val)(o.rightDims.width)-25,Oe=(0,Fh.val)(o.clippedSpace.range),He=(0,Fh.val)(o.sheet).getSequence().length,Fe=Math.max(Oe.end,He),Nt=Oe.start/Fe*xe,Ve=Oe.end/Fe*xe;return{rightWidth:xe,clippedSpaceRange:Oe,sequenceLength:He,assumedLengthOfSequence:Fe,rangeStartX:Nt,rangeEndX:Ve,bottom:(0,Fh.val)(o.horizontalScrollbarDims.bottom)}}),[o]),{rangeStartX:m,rangeEndX:_,clippedSpaceRange:w,bottom:C}=Rr(h),[R,N]=(0,ro.useState)("nothing"),[F,U]=(0,ro.useState)(!1),[$,j]=(0,ro.useState)(!1),[G,Y]=(0,ro.useState)(""),[Z,ne]=(0,ro.useState)(""),ae=(0,ro.useMemo)(()=>{let xe=(Oe,He)=>{let Fe=Math.max(0,Math.min(Oe,He-.01)),Nt=Math.max(Oe+.01,He);(0,Fh.val)(o.clippedSpace.setRange)({start:Fe,end:Nt})};return{onStartInputClick:Oe=>{Oe.stopPropagation(),U(!0),Y(l(w.start))},onEndInputClick:Oe=>{Oe.stopPropagation(),j(!0),ne(l(w.end))},onStartInputChange:Oe=>{Y(Oe.target.value)},onEndInputChange:Oe=>{ne(Oe.target.value)},onStartInputKeyDown:Oe=>{if(Oe.key==="Enter"){let He=parseFloat(G);isNaN(He)||xe(He,w.end),U(!1)}else Oe.key==="Escape"&&U(!1)},onEndInputKeyDown:Oe=>{if(Oe.key==="Enter"){let He=parseFloat(Z);isNaN(He)||xe(w.start,He),j(!1)}else Oe.key==="Escape"&&j(!1)},onStartInputBlur:()=>{let Oe=parseFloat(G);isNaN(Oe)||xe(Oe,w.end),U(!1)},onEndInputBlur:()=>{let Oe=parseFloat(Z);isNaN(Oe)||xe(w.start,Oe),j(!1)}}},[o,h,w,G,Z,l]),ce=(0,ro.useMemo)(()=>{let xe=(0,Fh.val)(h),Oe=()=>{xe=(0,Fh.val)(h)},He=Fe=>Fe/xe.rightWidth*xe.assumedLengthOfSequence;return{onRangeDragStart(){return Oe(),{onDrag(Fe){N("both");let Nt=He(Fe),Ve=Ud(xe.clippedSpaceRange,Ht=>Ht+Nt);(0,Fh.val)(o.clippedSpace.setRange)(Ve)},onDragEnd(){N("nothing")}}},onRangeStartDragStart(){return Oe(),{onDrag(Fe){N("start");let Nt=He(Fe),Ve={start:xe.clippedSpaceRange.start+Nt,end:xe.clippedSpaceRange.end};Ve.start>Ve.end-1&&(Ve.start=Ve.end-1),Ve.start<=0&&(Ve.start=0),(0,Fh.val)(o.clippedSpace.setRange)(Ve)},onDragEnd(){N("nothing")}}},onRangeEndDragStart(){return Oe(),{onDrag(Fe){N("end");let Nt=He(Fe),Ve={start:xe.clippedSpaceRange.start,end:xe.clippedSpaceRange.end+Nt};Ve.end<Ve.start+1&&(Ve.end=Ve.start+1),Ve.end>=xe.assumedLengthOfSequence&&(Ve.end=xe.assumedLengthOfSequence),(0,Fh.val)(o.clippedSpace.setRange)(Ve)},onDragEnd(){N("nothing")}}}}},[o,h]),[ve,Me]=(0,ro.useState)(null);Hs(ve,{debugName:"HorizontalScrollbar/onRangeDrag",onDragStart:ce.onRangeDragStart,lockCSSCursorTo:"ew-resize"});let[Te,_e]=(0,ro.useState)(null);Hs(Te,{debugName:"HorizontalScrollbar/onRangeStartDrag",onDragStart:ce.onRangeStartDragStart,lockCSSCursorTo:"w-resize"});let[it,Re]=(0,ro.useState)(null);return Hs(it,{debugName:"HorizontalScrollbar/onRangeEndDrag",onDragStart:ce.onRangeEndDragStart,lockCSSCursorTo:"e-resize"}),ro.default.createElement(X0e,A({style:{bottom:C+23+"px"}},qp("hide")),ro.default.createElement(K0e,null,ro.default.createElement(pA,{ref:Me,style:{width:"".concat(_-m,"px"),transform:"translate3d(".concat(m,"px, 0, 0)")}}),ro.default.createElement(mA,{ref:_e,style:{transform:"translate3d(".concat(m,"px, 0, 0)")}},ro.default.createElement(HF,{active:R==="both"||R==="start"||F},F?ro.default.createElement(WF,{value:G,onChange:ae.onStartInputChange,onKeyDown:ae.onStartInputKeyDown,onBlur:ae.onStartInputBlur,autoFocus:!0}):ro.default.createElement("span",{onClick:ae.onStartInputClick},l(w.start)))),ro.default.createElement(gA,{ref:Re,style:{transform:"translate3d(".concat(_,"px, 0, 0)")}},ro.default.createElement(HF,{active:R==="both"||R==="end"||$},$?ro.default.createElement(WF,{value:Z,onChange:ae.onEndInputChange,onKeyDown:ae.onEndInputKeyDown,onBlur:ae.onEndInputBlur,autoFocus:!0}):ro.default.createElement("span",{onClick:ae.onEndInputClick},l(w.end))))))},ile=rle}),sle,ole,ale,lle,cle,oTe=P(()=>{sle=K($e()),Xt(),ale=me.div(ole||(ole=q([`
  position: absolute;
  inset: `,`px;
`])),o=>o.room*-1),lle=o=>sle.default.createElement(ale,{room:o.room}),cle=lle}),vA,yA,$F,ule,hle,dle,fle,ple,mle,gle,vle,aTe=P(()=>{Xt(),ur(),Pb(),Ym(),vA=K($e()),yA=K($e()),$F=rn(),Dd(),ule=o=>isFinite(o)&&o>=0,dle=me.div(hle||(hle=q([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),ple=me.div(fle||(fle=q([`
  `,`;
  white-space: nowrap;
`])),Kd),mle=({deltaX:o})=>o*.25,gle=({layoutP:o,onRequestClose:l})=>{let h=(0,$F.val)(o.sheet),m=h.getSequence(),_=(0,vA.useMemo)(()=>{let C,R=m.position;return{temporarilySetValue(N){C&&(C=void 0),C=Bi(N,0,m.length),m.position=C},discardTemporaryValue(){C&&(C=void 0,m.position=R,l("discardTemporaryValue"))},permanentlySetValue(N){C&&(C=void 0),m.position=Bi(N,0,m.length),l("permanentlySetValue")}}},[o,m]),w=(0,vA.useRef)(null);return(0,vA.useLayoutEffect)(()=>{w.current.focus()},[]),jr(()=>{let C=h.getSequence(),R=Number((0,$F.val)(C.pointer.position).toFixed(3));return yA.default.createElement(dle,null,yA.default.createElement(ple,null,"Sequence position"),yA.default.createElement(f6,V(A({value:R},_),{isValid:ule,inputRef:w,nudge:mle})))},[h,_,w])},vle=gle}),yle,lTe=P(()=>{yle=typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0}),xle,cTe=P(()=>{lTe(),xle=o=>yle?o.metaKey===!0:o.ctrlKey===!0});function uTe(){xA=!1}function hTe(){xA=!0}function dTe(){let o=de();(0,_le.useEffect)(()=>{let l=h=>{let m=h.composedPath()[0];if(!(m&&(m.tagName==="INPUT"||m.tagName==="TEXTAREA"))){if(h.key==="z"||h.key==="Z"||h.code==="KeyZ")if(xle(h))h.shiftKey===!0?o.redo():o.undo();else return;else if(h.code==="Space"&&!h.shiftKey&&!h.metaKey&&!h.altKey&&!h.ctrlKey){if(!xA)return;let _=V_e();if(_)if(_.playing)_.pause();else{let{projectId:w,sheetId:C}=_.address,R=(0,of.prism)(()=>{let U=(0,of.val)(de().atomP.ahistoric.projects.stateByProjectId[w].stateBySheetId[C].sequence.focusRange);return of.prism.memo("shouldFollowFocusRange",()=>{let $=_.position;if(U){let j=$>=U.range.start&&$<=U.range.end;return U.enabled?!!j:!0}else return!0},[])&&U&&U.enabled?{range:[U.range.start,U.range.end],isFollowingARange:!0}:{range:[0,(0,of.val)(_.pointer.length)],isFollowingARange:!1}}),N=_.playDynamicRange((0,of.prism)(()=>(0,of.val)(R).range),de().ticker),F=qF(_);N.finally(()=>{F.set(void 0)}),F.set(R)}else return}else if(h.altKey&&(h.key==="\\"||h.code==="Backslash"||h.code==="IntlBackslash"))o.transaction(({stateEditors:_,drafts:w})=>{_.studio.ahistoric.setVisibilityState(w.ahistoric.visibilityState==="everythingIsHidden"?"everythingIsVisible":"everythingIsHidden")});else return;h.preventDefault(),h.stopPropagation()}};return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}},[])}var _le,of,xA,qF,ble,XF=P(()=>{_le=K($e()),Se(),cTe(),t6(),of=rn(),uL(),xA=!0,qF=lC(o=>new of.Atom(void 0)),ble=lC(o=>(0,of.prism)(()=>{let l=qF(o).prism.getValue();if(l)return l.getValue().isFollowingARange;{let{projectId:h,sheetId:m}=o.address,_=(0,of.val)(de().atomP.ahistoric.projects.stateByProjectId[h].stateBySheetId[m].sequence.focusRange);if(!_||!_.enabled)return!1;let w=(0,of.val)(o.pointer.position);return w>=_.range.start&&w<=_.range.end}}))});function fTe(o,l){return J0(o,{menuItems(){return[{label:"Place marker",callback:()=>{de().transaction(({stateEditors:h})=>{let m=(0,Bh.val)(l.layoutP.sheet),_=m.getSequence();h.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:m.address,markers:[{id:VZ(),position:_.position}],snappingFunction:_.closestGridPosition})})}},{label:"Place event",callback:()=>{de().transaction(({stateEditors:h})=>{let m=(0,Bh.val)(l.layoutP.sheet),_=m.getSequence();h.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:m.address,events:[{id:GZ(),name:"event",position:_.position}]})})}},{label:"Attach audio",callback:()=>{let h=new CustomEvent("theatre:attachAudio",{detail:{sheet:(0,Bh.val)(l.layoutP.sheet)}});document.dispatchEvent(h)}}]}})}var Bh,Uh,Sle,v8,wle,Ele,Tle,YF,Mle,Cle,Ale,Ple,Rle,Ile,pTe=P(()=>{oTe(),Oo(),zi(),ur(),Bh=rn(),Dd(),Uh=K($e()),Xt(),e1(),ba(),$i(),Zd(),Qd(),aTe(),XF(),K0(),el(),Se(),Yd(),rf(),T6(),v8=me.div(Sle||(Sle=q([`
  --thumbColor: #00e0ff;
  position: absolute;
  top: 0;
  left: 0;
  width: 5px;
  height: 100%;
  z-index: `,`;
  pointer-events: none;

  display: `,`;
`])),()=>lf.playhead,o=>o.isVisible?"block":"none"),Ele=me.div(wle||(wle=q([`
  position: absolute;
  top: 30px;
  width: 0;
  height: calc(100% - 30px);
  border-left: 1px solid #27e0fd;
  z-index: 10;
  pointer-events: none;

  #pointer-root.draggingPositionInSequenceEditor &:not(.seeking) {
    /* pointer-events: auto; */
    /* cursor: var(`,`); */

    &:after {
      position: absolute;
      inset: -8px;
      display: block;
      content: ' ';
    }
  }
`])),$d),YF=me.div(Tle||(Tle=q([`
  background-color: var(--thumbColor);
  position: absolute;
  width: 5px;
  height: 34px;
  top: -4px;
  left: -2px;
  z-index: 11;
  cursor: ew-resize;
  --sunblock-color: #1f2b2b;

  `,`;

  `,`.seeking > & {
    pointer-events: none !important;
  }

  #pointer-root.draggingPositionInSequenceEditor
    `,`:not(.seeking)
    > & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  `,`.playheadattachedtofocusrange > & {
    top: -8px;
    --sunblock-color: #005662;
    &:before,
    &:after {
      border-bottom-width: 8px;
    }
  }

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-left: 2px solid transparent;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    right: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-right: 2px solid transparent;
  }
`])),Ni,v8,v8,$d,v8),Cle=me.div(Mle||(Mle=q([`
  position: absolute;
  left: 1px;
  right: 1px;
  top: 35px;
  border-top: 3px solid var(--thumbColor);
  border-right: 1px solid transparent;
  border-left: 1px solid transparent;
  pointer-events: none;

  /* `,`.playheadattachedtofocusrange & {
    top: 10px;
    &:before,
    &:after {
      height: 15px;
    }
  } */

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    left: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 0 100% 0 0;
    border-top: 1px solid var(--thumbColor);
    border-right: 1px solid var(--thumbColor);
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    right: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 100% 0 0 0;
    border-top: 1px solid var(--thumbColor);
    border-left: 1px solid var(--thumbColor);
  }
`])),v8),Ple=me.div(Ale||(Ale=q([`
  display: none;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 2px;
  transform: translateX(-50%);
  background: #1a1a1a;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;
  `,":hover &, ",`.seeking & {
    display: block;
  }
`])),YF,v8),Rle=({layoutP:o})=>{let[l,h]=ui(null),{node:m,toggle:_,close:w}=Nc({debugName:"Playhead"},()=>Uh.default.createElement(Dc,null,Uh.default.createElement(vle,{layoutP:o,onRequestClose:w}))),C=(0,Uh.useMemo)(()=>({debugName:"RightOverlay/Playhead",onDragStart(){let F=(0,Bh.val)(o.sheet).getSequence(),U=F.position,$=(0,Bh.val)(o.scaledSpace.toUnitSpace),j=(0,Bh.val)(o.seeker.setIsSeeking);return j(!0),AC(),{onDrag(G,Y,Z){var ne;let ae=$(G);F.position=(ne=tl.checkIfMouseEventSnapToPos(Z,{ignore:h}))!=null?ne:Bi(U+ae,0,F.length)},onDragEnd(G){j(!1),E6()},onClick(G){_(G,l.current)}}}}),[o,h]),[R]=Hs(h,C);kc(R,"draggingPositionInSequenceEditor","ew-resize"),$p(Rr(o.seeker.isSeeking)||R,-1);let[N]=fTe(h,{layoutP:o});return jr(()=>{let F=(0,Bh.val)(o.seeker.isSeeking),U=(0,Bh.val)(o.sheet).getSequence(),$=(0,Bh.val)(ble(U)),j=U.positionPrism.getValue(),G=(0,Bh.val)(o.clippedSpace.fromUnitSpace)(j),Y=G>=0&&G<=(0,Bh.val)(o.clippedSpace.width);return Uh.default.createElement(Uh.default.Fragment,null,N,m,Uh.default.createElement(v8,A({isVisible:Y,style:{transform:"translate3d(".concat(G,"px, 0, 0)")},className:"".concat(F&&"seeking"," ").concat($&&"playheadattachedtofocusrange")},qp("hide")),Uh.default.createElement(YF,A({ref:l},tl.includePositionSnapAttrs(j)),Uh.default.createElement(cle,{room:8}),Uh.default.createElement(Cle,null),Uh.default.createElement(Ple,null,U.positionFormatter.formatForPlayhead(U.closestGridPosition(j)))),Uh.default.createElement(Ele,V(A({},tl.includePositionSnapAttrs(j)),{className:F?"seeking":""}))))},[o,l,m])},Ile=Rle}),y8,iS,_A,kle,Nle,Dle,Ole,mTe=P(()=>{y8=rn(),ur(),Se(),p8(),iS=K($e()),Xt(),_A=1e3,Nle=me.div(kle||(kle=q([`
  position: absolute;
  top: `,`px;
  left: 0;
  opacity: 0.15;
  width: `,`px;
  transform-origin: top left;
  pointer-events: none;
  background-color: `,`;
`])),Jp,_A,o=>o.enabled?"#000000":"transparent"),Dle=({layoutP:o})=>{let l=(0,iS.useMemo)(()=>(0,y8.prism)(()=>{let{projectId:h,sheetId:m}=(0,y8.val)(o.sheet).address;return(0,y8.val)(de().atomP.ahistoric.projects.stateByProjectId[h].stateBySheetId[m].sequence.focusRange)}),[o]);return jr(()=>{let h=l.getValue();if(!h||!h.enabled)return null;let{range:m}=h,_=(0,y8.val)(o.rightDims.height)-Jp,w=(0,y8.val)(o.clippedSpace.fromUnitSpace),C=(0,y8.val)(o.clippedSpace.width),R=[];{let N=0,F=w(h.range.start),U,$;N>F?($=0,U=0):(F>C&&(F=C),$=N,U=(F-N)/_A),R.push({translateX:$,scaleX:U})}{let N=w(h.range.end),F=C,U,$;N>F?($=0,U=0):(N<0&&(N=0),$=N,U=(F-N)/_A),R.push({translateX:$,scaleX:U})}return iS.default.createElement(iS.default.Fragment,null,R.map(({translateX:N,scaleX:F},U)=>iS.default.createElement(Nle,{key:"curtain-".concat(U),enabled:!0,style:{height:"".concat(_,"px"),transform:"translateX(".concat(N,"px) scaleX(").concat(F,")")}})))},[o,l])},Ole=Dle}),O6,Lle,Fle,Ble,Ule,zle,gTe=P(()=>{O6=K($e()),Xt(),ur(),Se(),Ym(),p6(),Fle=me.div(Lle||(Lle=q([`
  display: flex;
  gap: 8px;
  /* padding: 4px 8px; */
  height: 28px;
  align-items: center;
`]))),me.div(Ble||(Ble=q([`
  `,`;
  white-space: nowrap;
`])),Kd),Ule=({layoutP:o,marker:l})=>{var h;let m=Rr(o.sheet),_=(0,O6.useMemo)(()=>{let C;return{temporarilySetValue(R){C&&(C.discard(),C=void 0),C=de().tempTransaction(({stateEditors:N})=>{N.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:l.id,label:R})})},discardTemporaryValue(){C&&(C.discard(),C=void 0)},permanentlySetValue(R){C&&(C.discard(),C=void 0),de().transaction(({stateEditors:N})=>{N.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:l.id,label:R})})}}},[o,m]),w=(0,O6.useRef)(null);return(0,O6.useLayoutEffect)(()=>{w.current.focus()},[]),O6.default.createElement(Fle,null,O6.default.createElement(C9,V(A({value:(h=l.label)!=null?h:""},_),{isValid:()=>!0,inputRef:w})))},zle=Ule});function vTe(o,l){return J0(o,{menuItems(){return[{label:"Remove marker",callback:()=>{de().transaction(({stateEditors:h})=>{h.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeMarker({sheetAddress:l.sheetAddress,markerId:l.markerId})})}}]}})}function yTe(o,l){let h=(0,Yl.useRef)(l);h.current=l;let m=(0,Yl.useMemo)(()=>({debugName:"MarkerDot/useDragMarker (".concat(l.marker.id,")"),onDragStart(w){let C=h.current.marker,R=(0,bA.val)(l.layoutP.scaledSpace.toUnitSpace),N;return AC(),{onDrag(F,U,$){var j;let G=C,Y=Math.max((j=tl.checkIfMouseEventSnapToPos($,{ignore:o}))!=null?j:G.position+R(F),0);N==null||N.discard(),N=de().tempTransaction(({stateEditors:Z})=>{Z.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:(0,bA.val)(l.layoutP.sheet.address),markers:[V(A({},G),{position:Y})],snappingFunction:(0,bA.val)(l.layoutP.sheet).getSequence().closestGridPosition})})},onDragEnd(F){F?N==null||N.commit():N==null||N.discard(),E6()}}}}),[]),[_]=Hs(o,m);return $p(_,l.marker.position),kc(_,"draggingPositionInSequenceEditor draggingMarker","ew-resize"),[_]}var bA,Yl,KF,ZF,Vle,Gle,jle,Hle,Wle,SA,$le,qle,Xle,Yle,Kle,Zle,xTe=P(()=>{bA=rn(),ur(),Se(),K0(),el(),zi(),Yl=K($e()),Xt(),ba(),Oo(),e1(),rf(),TC(),FL(),T6(),Zd(),Qd(),gTe(),KF=12,ZF=12,Vle=KF*2,Gle=ZF*2,Hle=me.div(jle||(jle=q([`
  position: absolute;
  // below the sequence ruler "top bar"
  top: 30px;
  z-index: `,`;
`])),()=>lf.marker),SA=me.div(Wle||(Wle=q([`
  position: absolute;
  `,`
  pointer-events: none;
`])),sf(KF,ZF)),$le=Yl.default.memo(()=>Yl.default.createElement(SA,{children:Yl.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Yl.default.createElement("path",{d:"M12 5H0V7H2.71973L5.96237 10.2426L9.20501 7H12V5Z",fill:"#40AAA4"}))})),Xle=me.div(qle||(qle=q([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  // :not dragging marker to ensure that markers don't snap to other markers
  // this works because only one marker track (so this technique is not used by keyframes...)
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) & {
    `,`
  }

  // "All instances of this component <Mark/> inside #pointer-root when it has the .draggingPositionInSequenceEditor class"
  // ref: https://styled-components.com/docs/basics#pseudoelements-pseudoselectors-and-nesting
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) &,
  #pointer-root.draggingPositionInSequenceEditor
    &.`,` {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &:hover
    + `,`,
    // notice , "or" in CSS
    &.`,`
    + `,` {
    `,`
  }
`])),Xl.CSS,Xl.CSS_WHEN_SOMETHING_DRAGGING,Xl.BEING_DRAGGED_CLASS,$d,SA,Xl.BEING_DRAGGED_CLASS,SA,sf(Vle,Gle)),Yle=({layoutP:o,markerId:l})=>{let h=Rr(o.sheet.address),m=Rr(de().atomP.historic.projects.stateByProjectId[h.projectId].stateBySheetId[h.sheetId].sequenceEditor.markerSet.byId[l]);if(!m)return null;let _=Rr(o.clippedSpace.width),w=Rr(o.clippedSpace.fromUnitSpace)(m.position),C=w<=0||w>_,R=C?-1e4:w,N=C?0:1;return Yl.default.createElement(Hle,{style:{transform:"translateX(".concat(R,"px) scale(").concat(N,")")}},Yl.default.createElement(Zle,{marker:m,layoutP:o}))},Kle=Yle,Zle=({layoutP:o,marker:l})=>{let h=Rr(o.sheet.address),[m,_]=ui(null),[w]=vTe(_,{sheetAddress:h,markerId:l.id}),[C]=yTe(_,{layoutP:o,marker:l}),{node:R,toggle:N,close:F}=Nc({debugName:"MarkerPopover"},()=>Yl.default.createElement(Dc,null,Yl.default.createElement(zle,{marker:l,layoutP:o,onRequestClose:F})));return Yl.default.createElement(Yl.default.Fragment,null,w,R,Yl.default.createElement(Xle,A({title:l.label?"Marker: ".concat(l.label):"Marker",ref:m,onClick:U=>{N(U,m.current)}},Xl.reactProps({isDragging:C,position:l.position}))),Yl.default.createElement($le,null))}}),wA,Qle,Jle,_Te=P(()=>{ur(),Se(),wA=K($e()),xTe(),Qle=({layoutP:o})=>{let l=Rr(o.sheet.address),h=de().atomP.historic.projects.stateByProjectId[l.projectId].stateBySheetId[l.sheetId].sequenceEditor.markerSet,m=Rr(h.allIds);return wA.default.createElement(wA.default.Fragment,null,m&&Object.keys(m).map(_=>wA.default.createElement(Kle,{key:_,layoutP:o,markerId:_})))},Jle=Qle}),_0,ece,tce,nce,EA,rce,TA,ice,sce,bTe=P(()=>{_0=K($e()),Xt(),ur(),Se(),Ym(),p6(),Pb(),tce=me.div(ece||(ece=q([`
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px;
  min-width: 200px;
`]))),EA=me.div(nce||(nce=q([`
  display: flex;
  gap: 8px;
  height: 28px;
  align-items: center;
`]))),TA=me.div(rce||(rce=q([`
  `,`;
  white-space: nowrap;
  min-width: 60px;
`])),Kd),ice=({layoutP:o,event:l})=>{var h;let m=Rr(o.sheet),_=(0,_0.useMemo)(()=>{let F;return{temporarilySetValue(U){F&&(F.discard(),F=void 0),F=de().tempTransaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:U,value:l.value})})},discardTemporaryValue(){F&&(F.discard(),F=void 0)},permanentlySetValue(U){F&&(F.discard(),F=void 0),de().transaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:U,value:l.value})})}}},[o,m,l]),w=(0,_0.useMemo)(()=>{let F;return{temporarilySetValue(U){F&&(F.discard(),F=void 0),F=de().tempTransaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:m.address,events:[V(A({},l),{position:U})]})})},discardTemporaryValue(){F&&(F.discard(),F=void 0)},permanentlySetValue(U){F&&(F.discard(),F=void 0),de().transaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:m.address,events:[V(A({},l),{position:U})]})})}}},[o,m,l]),C=(0,_0.useMemo)(()=>{let F;return{temporarilySetValue(U){F&&(F.discard(),F=void 0);let $=U;try{U.trim()!==""&&($=JSON.parse(U))}catch{}F=de().tempTransaction(({stateEditors:j})=>{j.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:l.name,value:$})})},discardTemporaryValue(){F&&(F.discard(),F=void 0)},permanentlySetValue(U){F&&(F.discard(),F=void 0);let $=U;try{U.trim()!==""&&($=JSON.parse(U))}catch{}de().transaction(({stateEditors:j})=>{j.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:l.name,value:$})})}}},[o,m,l]),R=(0,_0.useRef)(null);(0,_0.useLayoutEffect)(()=>{R.current.focus()},[]);let N=(0,_0.useMemo)(()=>l.value===void 0||l.value===null?"":typeof l.value=="string"?l.value:JSON.stringify(l.value),[l.value]);return _0.default.createElement(tce,null,_0.default.createElement(EA,null,_0.default.createElement(TA,null,"Name"),_0.default.createElement(C9,V(A({value:(h=l.name)!=null?h:""},_),{isValid:()=>!0,inputRef:R}))),_0.default.createElement(EA,null,_0.default.createElement(TA,null,"Time"),_0.default.createElement(f6,V(A({value:l.position},w),{isValid:()=>!0,nudge:({deltaX:F})=>F*.25}))),_0.default.createElement(EA,null,_0.default.createElement(TA,null,"Value"),_0.default.createElement(C9,V(A({value:N},C),{isValid:()=>!0}))))},sce=ice});function STe(o,l){return J0(o,{menuItems(){return[{label:"Remove event",callback:()=>{de().transaction(({stateEditors:h})=>{h.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeEvent({sheetAddress:l.sheetAddress,eventId:l.eventId})})}}]}})}function wTe(o,l){let h=(0,Kl.useRef)(l);h.current=l;let m=(0,Kl.useMemo)(()=>({debugName:"EventDot/useDragEvent (".concat(l.event.id,")"),onDragStart(w){let C=h.current.event,R=(0,QF.val)(l.layoutP.scaledSpace.toUnitSpace),N;return AC(),{onDrag(F,U,$){var j;let G=C,Y=Math.max((j=tl.checkIfMouseEventSnapToPos($,{ignore:o}))!=null?j:G.position+R(F),0);N==null||N.discard(),N=de().tempTransaction(({stateEditors:Z})=>{Z.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:(0,QF.val)(l.layoutP.sheet.address),events:[V(A({},G),{position:Y})]})})},onDragEnd(F){F?N==null||N.commit():N==null||N.discard(),E6()}}}}),[]),[_]=Hs(o,m);return $p(_,l.event.position),kc(_,"draggingPositionInSequenceEditor draggingEvent","ew-resize"),[_]}var QF,Kl,JF,eB,oce,ace,lce,cce,uce,MA,hce,dce,fce,pce,mce,gce,ETe=P(()=>{QF=rn(),ur(),Se(),K0(),el(),zi(),Kl=K($e()),Xt(),ba(),Oo(),e1(),rf(),TC(),FL(),T6(),Zd(),Qd(),bTe(),JF=12,eB=12,oce=JF*2,ace=eB*2,cce=me.div(lce||(lce=q([`
  position: absolute;
  // below the sequence ruler "top bar"
  top: 15px;
  z-index: `,`;
`])),()=>lf.marker),MA=me.div(uce||(uce=q([`
  position: absolute;
  `,`
  pointer-events: none;
`])),sf(JF,eB)),hce=Kl.default.memo(()=>Kl.default.createElement(MA,{children:Kl.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Kl.default.createElement("circle",{cx:"6",cy:"6",r:"5",fill:"#2b86ee",stroke:"#FFFFFF",strokeWidth:"1"}))})),fce=me.div(dce||(dce=q([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  // :not dragging event to ensure that events don't snap to other events
  // this works because only one event track (so this technique is not used by keyframes...)
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingEvent) & {
    `,`
  }

  // "All instances of this component <Event/> inside #pointer-root when it has the .draggingPositionInSequenceEditor class"
  // ref: https://styled-components.com/docs/basics#pseudoelements-pseudoselectors-and-nesting
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingEvent) &,
  #pointer-root.draggingPositionInSequenceEditor
    &.`,` {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &:hover
    + `,`,
    // notice , "or" in CSS
    &.`,`
    + `,` {
    `,`
  }
`])),Xl.CSS,Xl.CSS_WHEN_SOMETHING_DRAGGING,Xl.BEING_DRAGGED_CLASS,$d,MA,Xl.BEING_DRAGGED_CLASS,MA,sf(oce,ace)),pce=({layoutP:o,eventId:l})=>{let h=Rr(o.sheet.address),m=Rr(de().atomP.historic.projects.stateByProjectId[h.projectId].stateBySheetId[h.sheetId].sequenceEditor.eventSet.byId[l]);if(!m)return null;let _=Rr(o.clippedSpace.width),w=Rr(o.clippedSpace.fromUnitSpace)(m.position),C=w<=0||w>_,R=C?-1e4:w,N=C?0:1;return Kl.default.createElement(cce,{style:{transform:"translateX(".concat(R,"px) scale(").concat(N,")")}},Kl.default.createElement(gce,{event:m,layoutP:o}))},mce=pce,gce=({layoutP:o,event:l})=>{let h=Rr(o.sheet.address),[m,_]=ui(null),[w]=STe(_,{sheetAddress:h,eventId:l.id}),[C]=wTe(_,{layoutP:o,event:l}),{node:R,toggle:N,close:F}=Nc({debugName:"EventPopover"},()=>Kl.default.createElement(Dc,null,Kl.default.createElement(sce,{event:l,layoutP:o,onRequestClose:F})));return Kl.default.createElement(Kl.default.Fragment,null,w,R,Kl.default.createElement(fce,A({title:l.name?"Event: ".concat(l.name):"Event",ref:m,onClick:U=>{N(U,m.current)}},Xl.reactProps({isDragging:C,position:l.position}))),Kl.default.createElement(hce,null))}}),CA,vce,yce,TTe=P(()=>{ur(),Se(),CA=K($e()),ETe(),vce=({layoutP:o})=>{let l=Rr(o.sheet.address),h=de().atomP.historic.projects.stateByProjectId[l.projectId].stateBySheetId[l.sheetId].sequenceEditor.eventSet,m=Rr(h.allIds);return CA.default.createElement(CA.default.Fragment,null,m&&Object.keys(m).map(_=>CA.default.createElement(mce,{key:_,layoutP:o,eventId:_})))},yce=vce}),xce,af,_ce,bce,Sce,wce,Ece,Tce,MTe=P(()=>{e1(),ur(),xce=rn(),af=K($e()),Xt(),rTe(),iTe(),sTe(),pTe(),p8(),mTe(),_Te(),TTe(),bce=me.div(_ce||(_ce=q([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: visible;
  pointer-events: none;
`])),()=>lf.rightOverlay),wce=me.div(Sce||(Sce=q([`
  background: #222;
  position: absolute;
  top: 30px;
  width: 100%;
  height: 30px;
`]))),Ece=({layoutP:o})=>jr(()=>{let l=(0,xce.val)(o.rightDims.width);return af.default.createElement(bce,{style:{width:l+"px"}},af.default.createElement(Ile,{layoutP:o}),af.default.createElement(ile,{layoutP:o}),af.default.createElement($0e,{layoutP:o}),af.default.createElement(y0e,{layoutP:o}),af.default.createElement(wce,null,af.default.createElement(Jle,{layoutP:o}),af.default.createElement(yce,{layoutP:o})),af.default.createElement(B0e,{layoutP:o}),af.default.createElement(Ole,{layoutP:o}))},[o]),Tce=Ece}),Mce,AA,Cce,Ace,Pce,Rce,CTe=P(()=>{Mce=rn(),ur(),Se(),AA=K($e()),Xt(),Eb(),ba(),Ace=me.button(Cce||(Cce=q([`
  outline: none;
  background-color: #1c1d21;
  border: 1px solid #191919;
  border-radius: 2px;
  display: flex;
  bottom: 25px;
  right: 15px;
  z-index: 1;
  position: absolute;

  padding: 4px 8px;
  display: flex;
  color: #656d77;
  line-height: 20px;
  font-size: 10px;

  &:hover {
    color: white;
  }

  & > svg {
    transition: transform 0.3s;
    transform: rotateZ(0deg);
  }

  &:hover > svg {
    transform: rotateZ(-20deg);
  }

  &.open > svg {
    transform: rotateZ(-180deg);
  }

  &.open:hover > svg {
    transform: rotateZ(-160deg);
  }
`]))),Pce=({layoutP:o})=>{let l=Rr(o.graphEditorDims.isOpen),h=(0,AA.useCallback)(()=>{let m=(0,Mce.val)(o.graphEditorDims.isOpen);de().transaction(({stateEditors:_})=>{_.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!m})})},[o]);return AA.default.createElement(Ace,A({onClick:h,title:"Toggle graph editor",className:l?"open":""},qp("hide")),AA.default.createElement(Vbe,null))},Rce=Pce}),Bc,sS,Ice,kce,Nce,Dce,tB,Oce,ATe=P(()=>{Bc=K($e()),Xt(),ur(),sS=rn(),bF(),VL(),kce=me.div(Ice||(Ice=q([`
  position: absolute;
  right: 0;
  bottom: 0;
  padding-bottom: 10px;
  pointer-events: none;
  z-index: 1;
  display: `,`;
`])),o=>o.isVisible?"block":"none"),Dce=me.svg(Nce||(Nce=q([`
  position: absolute;
  top: 0;
  left: 0;
  margin: 0;
  pointer-events: none;
`]))),tB=(0,Bc.forwardRef)(({layoutP:o,sheetAddress:l,renderMode:h="both",color:m="#4a9eff",strokeWidth:_=2,circleRadius:w=3,height:C},R)=>{let N=ne=>ne?"svgViewer_".concat(ne.projectId,"_").concat(ne.sheetId):"svgViewer_default",F=ne=>{try{let ae=N(ne),ce=localStorage.getItem(ae);if(ce){let ve=JSON.parse(ce);if(Array.isArray(ve))return ve.length>0&&typeof ve[0]=="object"&&"time"in ve[0]?[{id:"legacy",data:ve,color:"#4a9eff",name:"Legacy Data"}]:ve.filter(Me=>Me&&typeof Me=="object"&&Array.isArray(Me.data)&&typeof Me.color=="string")}}catch(ae){console.warn(" SVGViewer: Failed to load data from localStorage:",ae)}return[]},U=(ne,ae)=>{try{let ce=N(ae);localStorage.setItem(ce,JSON.stringify(ne))}catch(ce){console.warn(" SVGViewer: Failed to save data to localStorage:",ce)}},[$,j]=(0,Bc.useState)(()=>F(l)),[G,Y]=(0,Bc.useState)(!0);(0,Bc.useEffect)(()=>{let ne=F(l);j(ne)},[l==null?void 0:l.projectId,l==null?void 0:l.sheetId]);let Z=ne=>{try{let ae=JSON.parse(ne);if(Array.isArray(ae))return ae.filter(ce=>typeof ce=="object"&&typeof ce.time=="number"&&typeof ce.value=="number")}catch{let ce=ne.trim().split(`
`),ve=[];for(let Me of ce){if(!Me.trim()||Me.toLowerCase().includes("time")||Me.toLowerCase().includes("value"))continue;let Te=Me.split(",").map(_e=>_e.trim());if(Te.length>=2){let _e=parseFloat(Te[0]),it=parseFloat(Te[1]);!isNaN(_e)&&!isNaN(it)&&ve.push({time:_e,value:it})}else{let _e=Me.split(/\s+/).filter(it=>it.length>0);if(_e.length>=2){let it=parseFloat(_e[0]),Re=parseFloat(_e[1]);!isNaN(it)&&!isNaN(Re)&&ve.push({time:it,value:Re})}}}return ve}return[]};return(0,Bc.useImperativeHandle)(R,()=>({clearData:()=>{let ne=[];j(ne),U(ne,l)},addData:(ne,ae)=>{console.log(" SVGViewer: Adding dataset with",ne.length,"points",ae?"and color ".concat(ae):"");let ce={id:"dataset-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),data:ne,color:ae||m,name:"Dataset ".concat($.length+1)},ve=[...$,ce];j(ve),U(ve,l)},loadData:(ne,ae)=>{console.log(" SVGViewer: loadData called, redirecting to addData");let ce={id:"dataset-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),data:ne,color:ae||m,name:"Dataset ".concat($.length+1)},ve=[...$,ce];j(ve),U(ve,l)},loadFromClipboard:()=>De(void 0,null,function*(){try{let ne=yield navigator.clipboard.readText(),ae=Z(ne);if(ae.length>0){console.log(" SVGViewer: Successfully parsed",ae.length,"data points from clipboard");let ce={id:"clipboard-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),data:ae,color:m,name:"Clipboard Data ".concat($.length+1)},ve=[...$,ce];j(ve),U(ve,l)}else console.warn(" SVGViewer: No valid data found in clipboard")}catch(ne){throw console.error(" SVGViewer: Failed to read from clipboard:",ne),ne}}),show:()=>{console.log(" SVGViewer: Showing component"),Y(!0)},hide:()=>{console.log(" SVGViewer: Hiding component"),Y(!1)}}),[l,$,m]),jr(()=>{let ne=(0,sS.val)(o.rightDims.width),ae=C||(0,sS.val)(o.dopeSheetDims.height)-30,ce=(0,sS.val)(o.scaledSpace.fromUnitSpace)(1),ve=(0,sS.val)(o.scaledSpace.leftPadding),Me=0,Te=1;return Bc.default.createElement(kce,{isVisible:G,style:{width:ne+"px",height:ae+"px","--unitSpaceToScaledSpaceMultiplier":ce}},Bc.default.createElement(PC,{layoutP:o,height:ae},Bc.default.createElement(Dce,{width:k6,height:ae,viewBox:"0 0 ".concat(k6," ").concat(ae)},Bc.default.createElement("g",{style:{transform:"translate(".concat(ve,"px, 0px)")}},$.map(_e=>{let it=_e.data.map((xe,Oe)=>{let He=xe.time*ce,Fe=(xe.value-Me)/Te,Nt=ae-Fe*(ae-40)-20;return{x:He,y:Nt,originalValue:xe.value,time:xe.time,index:Oe}}),Re=it.length>0?"M ".concat(it[0].x," ").concat(it[0].y," ")+it.slice(1).map(xe=>"L ".concat(xe.x," ").concat(xe.y)).join(" "):"";return Bc.default.createElement("g",{key:_e.id},(h==="lines"||h==="both")&&it.length>1&&Bc.default.createElement("path",{d:Re,fill:"none",stroke:_e.color,strokeWidth:_,opacity:.8}),(h==="circles"||h==="both")&&it.map(xe=>Bc.default.createElement("circle",{key:"".concat(_e.id,"-point-").concat(xe.index,"-").concat(xe.time,"-").concat(xe.originalValue),cx:xe.x,cy:xe.y,r:w,fill:_e.color,opacity:.9},Bc.default.createElement("title",null,"".concat(_e.name||"Dataset"," - Time: ").concat(xe.time.toFixed(2),", Value: ").concat(xe.originalValue.toFixed(3))))))})))))},[o,$,h,_,w,C,G])}),tB.displayName="SVGViewer",Oce=tB});function PTe(o){return De(this,arguments,function*(l,h={}){let{sampleRate:m=100,normalize:_=!0}=h;try{let w=new(window.AudioContext||window.webkitAudioContext),C=yield l.arrayBuffer(),R=yield w.decodeAudioData(C),N=R.getChannelData(0),F=R.duration,U=R.sampleRate,$=Math.floor(U/m),j=Math.floor(N.length/$),G=[],Y=0;for(let Z=0;Z<j;Z++){let ne=Z*$,ae=Math.min(ne+$,N.length),ce=0;for(let Te=ne;Te<ae;Te++)ce+=N[Te]*N[Te];let ve=Math.sqrt(ce/(ae-ne)),Me=Z*$/U;G.push({time:Me,amplitude:ve}),ve>Y&&(Y=ve)}if(_&&Y>0)for(let Z of G)Z.amplitude=Z.amplitude/Y;return yield w.close(),console.log(" Audio analysis complete: ".concat(G.length," data points over ").concat(F.toFixed(2),"s")),G}catch(w){throw console.error(" Audio analysis failed:",w),new Error("Failed to analyze audio file: ".concat(w instanceof Error?w.message:"Unknown error"))}})}function Lce(o){return["audio/mpeg","audio/wav","audio/ogg","audio/mp4","audio/aac"].includes(o.type)||o.name.toLowerCase().match(/\.(mp3|wav|ogg|m4a|aac)$/)!==null}function Fce(o){if(o===0)return"0 Bytes";let l=1024,h=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(o)/Math.log(l));return parseFloat((o/Math.pow(l,m)).toFixed(2))+" "+h[m]}var Bce=P(()=>{}),ni,Uce,zce,Vce,Gce,jce,Hce,Wce,nB,$ce,PA,qce,Xce,Yce,Kce,Zce,Qce,Jce,eue,tue,nue,rue,iue,sue,rB,oue,aue,lue,cue,uue,hue,due,iB,fue,pue,mue,gue,vue,yue,xue,_ue,bue,Sue,wue,Eue,Tue,Mue,Cue,RTe=P(()=>{ni=K($e()),Xt(),p6(),Ym(),Bce(),zce=me.div(Uce||(Uce=q([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`]))),Gce=me.div(Vce||(Vce=q([`
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 16px;
  min-width: 400px;
  max-width: 500px;
  background: #2a2a2a;
  border: 1px solid #3a3a3a;
  border-radius: 6px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
`]))),Hce=me.h3(jce||(jce=q([`
  margin: 0;
  font-size: 14px;
  font-weight: 500;
  color: #ccc;
`]))),nB=me.div(Wce||(Wce=q([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),PA=me.div($ce||($ce=q([`
  `,`;
  font-size: 12px;
  color: #999;
`])),Kd),Xce=me.div(qce||(qce=q([`
  font-size: 11px;
  color: #666;
  font-style: italic;
  margin-top: 4px;
`]))),Kce=me.div(Yce||(Yce=q([`
  display: flex;
  gap: 8px;
  align-items: center;
`]))),Qce=me.input(Zce||(Zce=q([`
  width: 40px;
  height: 28px;
  border: 1px solid #3a3a3a;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;

  &::-webkit-color-swatch-wrapper {
    padding: 2px;
  }

  &::-webkit-color-swatch {
    border: none;
    border-radius: 2px;
  }
`]))),eue=me(C9)(Jce||(Jce=q([`
  flex: 1;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
`]))),nue=me.textarea(tue||(tue=q([`
  width: 100%;
  min-height: 120px;
  padding: 8px;
  border: 1px solid #3a3a3a;
  border-radius: 4px;
  background: #2a2a2a;
  color: #ccc;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  font-size: 12px;
  resize: vertical;

  &::placeholder {
    color: #666;
  }

  &:focus {
    outline: none;
    border-color: #4a9eff;
  }
`]))),iue=me.div(rue||(rue=q([`
  display: flex;
  gap: 8px;
  justify-content: flex-end;
`]))),rB=me.button(sue||(sue=q([`
  padding: 8px 16px;
  border: 1px solid
    `,`;
  border-radius: 4px;
  background: `,`;
  color: `,`;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#4a9eff":"#3a3a3a",o=>o.variant==="primary"?"#4a9eff":"transparent",o=>o.variant==="primary"?"#fff":"#ccc",o=>o.variant==="primary"?"#3a8eef":"#3a3a3a"),aue=me.div(oue||(oue=q([`
  border-top: 1px solid #3a3a3a;
  padding-top: 16px;
  margin-top: 8px;
`]))),cue=me.div(lue||(lue=q([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),hue=me.div(uue||(uue=q([`
  border: 2px dashed `,`;
  border-radius: 4px;
  padding: 16px;
  text-align: center;
  background: `,`;
  cursor: pointer;
  transition: all 0.2s;

  `,`

  &:hover {
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  }
`])),o=>o.isDragOver?"#4a9eff":"#3a3a3a",o=>o.isDragOver?"rgba(74, 158, 255, 0.1)":"transparent",o=>o.hasFile&&`
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  `),iB=me.div(due||(due=q([`
  color: #999;
  font-size: 12px;
  margin-bottom: 4px;
`]))),pue=me.div(fue||(fue=q([`
  color: #ccc;
  font-size: 11px;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
`]))),gue=me.div(mue||(mue=q([`
  display: flex;
  gap: 16px;
  align-items: center;
  margin-top: 8px;
`]))),yue=me.div(vue||(vue=q([`
  display: flex;
  flex-direction: column;
  gap: 4px;
`]))),_ue=me.label(xue||(xue=q([`
  `,`;
  font-size: 11px;
  color: #999;
`])),Kd),Sue=me.input(bue||(bue=q([`
  width: 80px;
  padding: 4px 8px;
  border: 1px solid #3a3a3a;
  border-radius: 4px;
  background: #2a2a2a;
  color: #ccc;
  font-size: 12px;

  &:focus {
    outline: none;
    border-color: #4a9eff;
  }
`]))),Eue=me.div(wue||(wue=q([`
  font-size: 11px;
  margin-top: 8px;
  color: `,`;
`])),o=>{switch(o.status){case"analyzing":return"#4a9eff";case"complete":return"#4a9eff";case"error":return"#ff6b6b";default:return"#666"}}),Tue=`[
  {"time": 0, "value": 0},
  {"time": 1, "value": 0.5},
  {"time": 2, "value": 0.2},
  {"time": 3, "value": 1}
]

Or CSV format:
time,value
0,0
1,0.5
2,0.2
3,1

Or space-separated:
0 0
1 0.5
2 0.2
3 1`,Mue=({onLoad:o,onCancel:l})=>{let[h,m]=(0,ni.useState)("#4a9eff"),[_,w]=(0,ni.useState)("#4a9eff"),[C,R]=(0,ni.useState)(""),[N,F]=(0,ni.useState)(null),[U,$]=(0,ni.useState)(!1),[j,G]=(0,ni.useState)(100),[Y,Z]=(0,ni.useState)("idle"),[ne,ae]=(0,ni.useState)(""),ce=(0,ni.useRef)(null),ve=(0,ni.useRef)(null);(0,ni.useEffect)(()=>{ce.current&&ce.current.focus()},[]);let Me=Ee=>{try{let et=JSON.parse(Ee);if(Array.isArray(et))return et.filter(At=>typeof At=="object"&&typeof At.time=="number"&&typeof At.value=="number")}catch{let At=Ee.trim().split(`
`),Ce=[];for(let Ze of At){if(!Ze.trim()||Ze.toLowerCase().includes("time")||Ze.toLowerCase().includes("value"))continue;let Ft=Ze.split(",").map($t=>$t.trim());if(Ft.length>=2){let $t=parseFloat(Ft[0]),_t=parseFloat(Ft[1]);!isNaN($t)&&!isNaN(_t)&&Ce.push({time:$t,value:_t})}else{let $t=Ze.split(/\s+/).filter(_t=>_t.length>0);if($t.length>=2){let _t=parseFloat($t[0]),be=parseFloat($t[1]);!isNaN(_t)&&!isNaN(be)&&Ce.push({time:_t,value:be})}}}return Ce}return[]},Te=Me(C).length,_e=Te>0||N!==null,it=Ee=>De(void 0,null,function*(){Z("analyzing"),ae("");try{let et=(yield PTe(Ee,{sampleRate:j,normalize:!0})).map(At=>({time:At.time,value:At.amplitude}));R(JSON.stringify(et,null,2)),Z("complete")}catch(et){console.error("Audio analysis failed:",et),ae(et instanceof Error?et.message:"Analysis failed"),Z("error")}}),Re=Ee=>{if(!Lce(Ee)){ae("Please select a supported audio file (MP3, WAV, OGG, M4A, AAC)"),Z("error");return}F(Ee),Z("idle"),ae(""),it(Ee)},xe=Ee=>{Ee.preventDefault(),$(!0)},Oe=Ee=>{Ee.preventDefault(),$(!1)},He=Ee=>{Ee.preventDefault(),$(!1);let et=Array.from(Ee.dataTransfer.files);et.length>0&&Re(et[0])},Fe=Ee=>{let et=Ee.target.files;et&&et.length>0&&Re(et[0])},Nt=()=>{var Ee;(Ee=ve.current)==null||Ee.click()},Ve=()=>{let Ee=Me(C);Ee.length>0?o(Ee,h):console.warn("No valid data found in input")};(0,ni.useEffect)(()=>{let Ee=et=>{et.key==="Escape"?Ye():et.key==="Enter"&&(et.ctrlKey||et.metaKey)&&_e&&Ve()};return document.addEventListener("keydown",Ee),()=>document.removeEventListener("keydown",Ee)},[_e]);let Ht=Ee=>{m(Ee),w(Ee)},ot=Ee=>{w(Ee),/^#[0-9A-F]{6}$/i.test(Ee)&&m(Ee)},Ye=()=>{R(""),m("#4a9eff"),w("#4a9eff"),F(null),Z("idle"),ae(""),l()};return ni.default.createElement(zce,{onClick:Ye},ni.default.createElement(Gce,{onClick:Ee=>Ee.stopPropagation()},ni.default.createElement(Hce,null,"Load SVG Data"),ni.default.createElement(nB,null,ni.default.createElement(PA,null,"Color"),ni.default.createElement(Kce,null,ni.default.createElement(Qce,{type:"color",value:h,onChange:Ee=>Ht(Ee.target.value)}),ni.default.createElement(eue,{value:_,temporarilySetValue:ot,discardTemporaryValue:()=>w(h),permanentlySetValue:ot,isValid:Ee=>/^#[0-9A-F]{6}$/i.test(Ee)}))),ni.default.createElement(nB,null,ni.default.createElement(PA,null,"SVG Data"),ni.default.createElement(nue,{ref:ce,value:C,onChange:Ee=>R(Ee.target.value),placeholder:Tue}),C&&ni.default.createElement(Xce,null,Te>0?"".concat(Te," data points will be loaded"):"No valid data points found")),ni.default.createElement(aue,null,ni.default.createElement(PA,null,"Or Analyze Audio File"),ni.default.createElement(cue,null,ni.default.createElement(hue,{isDragOver:U,hasFile:N!==null,onClick:Nt,onDragOver:xe,onDragLeave:Oe,onDrop:He},ni.default.createElement(iB,null,N?"Click to select a different audio file":"Click to select or drag & drop an audio file"),ni.default.createElement(iB,{style:{fontSize:"11px",color:"#666"}},"Supported formats: MP3, WAV, OGG, M4A, AAC"),N&&ni.default.createElement(pue,null," ",N.name," (",Fce(N.size),")")),ni.default.createElement("input",{ref:ve,type:"file",accept:"audio/*,.mp3,.wav,.ogg,.m4a,.aac",onChange:Fe,style:{display:"none"}}),ni.default.createElement(gue,null,ni.default.createElement(yue,null,ni.default.createElement(_ue,null,"Sample Rate (Hz)"),ni.default.createElement(Sue,{type:"number",min:"10",max:"1000",value:j,onChange:Ee=>G(parseInt(Ee.target.value)||100)}))),Y!=="idle"&&ni.default.createElement(Eue,{status:Y},Y==="analyzing"&&" Analyzing audio...",Y==="complete"&&" Audio analysis complete! Data loaded above.",Y==="error"&&" ".concat(ne)))),ni.default.createElement(iue,null,ni.default.createElement(rB,{onClick:Ye},"Cancel"),ni.default.createElement(rB,{variant:"primary",onClick:Ve,disabled:!_e},"Create"))))},Cue=Mue}),Pi,Aue,Pue,Rue,Iue,kue,Nue,Due,sB,Oue,oB,Lue,RA,Fue,Bue,Uue,aB,zue,Vue,Gue,jue,Hue,lB,Wue,$ue,que,Xue,Yue,Kue,Zue,Que,Jue,ehe,the,cB,nhe,rhe,ITe=P(()=>{Pi=K($e()),Xt(),p6(),Ym(),Bce(),Pue=me.div(Aue||(Aue=q([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`]))),Iue=me.div(Rue||(Rue=q([`
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 16px;
  min-width: 400px;
  max-width: 500px;
  background: #2a2a2a;
  border: 1px solid #3a3a3a;
  border-radius: 6px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
`]))),Nue=me.h3(kue||(kue=q([`
  margin: 0;
  font-size: 14px;
  font-weight: 500;
  color: #ccc;
`]))),sB=me.div(Due||(Due=q([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),oB=me.div(Oue||(Oue=q([`
  `,`;
  font-size: 12px;
  color: #999;
`])),Kd),RA=me.div(Lue||(Lue=q([`
  font-size: 11px;
  color: #666;
  font-style: italic;
  margin-bottom: 8px;
`]))),Bue=me.div(Fue||(Fue=q([`
  display: flex;
  gap: 8px;
  justify-content: flex-end;
`]))),aB=me.button(Uue||(Uue=q([`
  padding: 8px 16px;
  border: 1px solid
    `,`;
  border-radius: 4px;
  background: `,`;
  color: `,`;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#4a9eff":"#3a3a3a",o=>o.variant==="primary"?"#4a9eff":"transparent",o=>o.variant==="primary"?"#fff":"#ccc",o=>o.variant==="primary"?"#3a8eef":"#3a3a3a"),Vue=me.div(zue||(zue=q([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),jue=me.div(Gue||(Gue=q([`
  border: 2px dashed `,`;
  border-radius: 4px;
  padding: 16px;
  text-align: center;
  background: `,`;
  cursor: pointer;
  transition: all 0.2s;

  `,`

  &:hover {
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  }
`])),o=>o.isDragOver?"#4a9eff":"#3a3a3a",o=>o.isDragOver?"rgba(74, 158, 255, 0.1)":"transparent",o=>o.hasFile&&`
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  `),lB=me.div(Hue||(Hue=q([`
  color: #999;
  font-size: 12px;
  margin-bottom: 4px;
`]))),$ue=me.div(Wue||(Wue=q([`
  color: #ccc;
  font-size: 11px;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
`]))),Xue=me(C9)(que||(que=q([`
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  font-size: 12px;

  &::placeholder {
    color: #666;
  }
`]))),Kue=me.div(Yue||(Yue=q([`
  color: #ff6b6b;
  font-size: 11px;
  margin-top: 4px;
`]))),Que=me.div(Zue||(Zue=q([`
  color: #4a9eff;
  font-size: 11px;
  margin-top: 4px;
`]))),ehe=me.div(Jue||(Jue=q([`
  display: flex;
  border-bottom: 1px solid #3a3a3a;
  margin-bottom: 16px;
`]))),cB=me.button(the||(the=q([`
  padding: 8px 16px;
  border: none;
  background: `,`;
  color: `,`;
  font-size: 12px;
  cursor: pointer;
  border-bottom: 2px solid
    `,`;
  transition: all 0.2s;

  &:hover {
    background: #3a3a3a;
    color: #ccc;
  }
`])),o=>o.active?"#3a3a3a":"transparent",o=>o.active?"#ccc":"#999",o=>o.active?"#4a9eff":"transparent"),nhe=({onAttach:o,onCancel:l})=>{let[h,m]=(0,Pi.useState)("file"),[_,w]=(0,Pi.useState)(null),[C,R]=(0,Pi.useState)(""),[N,F]=(0,Pi.useState)(!1),[U,$]=(0,Pi.useState)(!1),[j,G]=(0,Pi.useState)(""),[Y,Z]=(0,Pi.useState)(""),ne=(0,Pi.useRef)(null);(0,Pi.useEffect)(()=>{G(""),Z("")},[h]);let ae=He=>{if(!Lce(He)){G("Please select a supported audio file (MP3, WAV, OGG, M4A, AAC)");return}w(He),G(""),Z("")},ce=He=>{He.preventDefault(),F(!0)},ve=He=>{He.preventDefault(),F(!1)},Me=He=>{He.preventDefault(),F(!1);let Fe=Array.from(He.dataTransfer.files);Fe.length>0&&ae(Fe[0])},Te=He=>{let Fe=He.target.files;Fe&&Fe.length>0&&ae(Fe[0])},_e=()=>{var He;(He=ne.current)==null||He.click()},it=He=>{try{return new URL(He),!0}catch{return!1}},Re=()=>h==="file"?_!==null:C.trim()!==""&&it(C.trim()),xe=()=>De(void 0,null,function*(){if(Re()){$(!0),G(""),Z("");try{let He=h==="file"?_:C.trim();yield o(He),Z("Audio attached successfully!"),setTimeout(()=>{l()},1e3)}catch(He){console.error("Failed to attach audio:",He),G(He instanceof Error?He.message:"Failed to attach audio")}finally{$(!1)}}});(0,Pi.useEffect)(()=>{let He=Fe=>{Fe.key==="Escape"?Oe():Fe.key==="Enter"&&(Fe.ctrlKey||Fe.metaKey)&&Re()&&xe()};return document.addEventListener("keydown",He),()=>document.removeEventListener("keydown",He)},[h,_,C]);let Oe=()=>{w(null),R(""),G(""),Z(""),l()};return Pi.default.createElement(Pue,{onClick:Oe},Pi.default.createElement(Iue,{onClick:He=>He.stopPropagation()},Pi.default.createElement(Nue,null,"Attach Audio to Sequence"),Pi.default.createElement(RA,null,"Attach an audio file to sync with your sequence playback. The audio will play automatically when the sequence plays."),Pi.default.createElement(ehe,null,Pi.default.createElement(cB,{active:h==="file",onClick:()=>m("file")},"Upload File"),Pi.default.createElement(cB,{active:h==="url",onClick:()=>m("url")},"From URL")),h==="file"?Pi.default.createElement(sB,null,Pi.default.createElement(oB,null,"Audio File"),Pi.default.createElement(Vue,null,Pi.default.createElement(jue,{isDragOver:N,hasFile:_!==null,onClick:_e,onDragOver:ce,onDragLeave:ve,onDrop:Me},Pi.default.createElement(lB,null,_?"Click to select a different audio file":"Click to select or drag & drop an audio file"),Pi.default.createElement(lB,{style:{fontSize:"11px",color:"#666"}},"Supported formats: MP3, WAV, OGG, M4A, AAC"),_&&Pi.default.createElement($ue,null," ",_.name," (",Fce(_.size),")")),Pi.default.createElement("input",{ref:ne,type:"file",accept:"audio/*,.mp3,.wav,.ogg,.m4a,.aac",onChange:Te,style:{display:"none"}}))):Pi.default.createElement(sB,null,Pi.default.createElement(oB,null,"Audio URL"),Pi.default.createElement(Xue,{value:C,temporarilySetValue:R,discardTemporaryValue:()=>R(""),permanentlySetValue:R,isValid:He=>He.trim()===""||it(He.trim())}),C.trim()===""&&Pi.default.createElement(RA,{style:{marginTop:"4px",fontSize:"11px",color:"#666"}},"Example: https://example.com/audio.mp3"),Pi.default.createElement(RA,null,"Enter a URL to an audio file. Make sure the server supports CORS if loading from a different domain.")),j&&Pi.default.createElement(Kue,null," ",j),Y&&Pi.default.createElement(Que,null," ",Y),Pi.default.createElement(Bue,null,Pi.default.createElement(aB,{onClick:Oe,disabled:U},"Cancel"),Pi.default.createElement(aB,{variant:"primary",onClick:xe,disabled:!Re()||U},U?"Attaching...":"Attach Audio"))))},rhe=nhe});function kTe(){return $s.default.createElement("svg",{fill:"#FFFFFF",width:"800px",height:"800px",viewBox:"0 0 1920 1920",xmlns:"http://www.w3.org/2000/svg",style:{width:"15px",height:"15px"}},$s.default.createElement("path",{d:"M1637.718 0c93.4 0 169.406 76.007 169.406 169.407v1581.13c0 93.512-76.007 169.407-169.406 169.407H451.87V0h1185.848zM1158.7 581l-79.861 79.861 242.422 242.423H667v112.94h654.262l-242.422 242.423 79.861 79.862 378.755-378.755L1158.7 581zM225.938 1920h112.938V.056H225.938z"}))}var $s,ihe,she,ohe,ahe,lhe,che,uhe,hhe,dhe,fhe,phe,mhe,ghe,vhe,yhe,xhe,uB,_he,bhe,She,whe,NTe=P(()=>{$s=K($e()),Xt(),ihe=rn(),ur(),ohe=me.div(she||(she=q([`
  position: absolute;
  bottom: 10px;
  left: 10px;
  z-index: 100;
  display: flex;
  align-items: center;
  gap: 8px;
  width: `,`px; /* Subtract left/right margins */
  box-sizing: border-box;
`])),o=>o.width-20),lhe=me.input(ahe||(ahe=q([`
  background: `,`;
  color: #cccccc;
  border: 1px solid `,`;
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  font-family: inherit;
  flex: 1; /* Expand to fill available space */
  min-width: 80px; /* Minimum width to ensure usability */
  transition: all 0.15s ease-out;

  &:focus {
    outline: none;
    border-color: #0078d4;
    background: #1e1e1e;
  }

  &::placeholder {
    color: #6a6a6a;
  }
`])),o=>o.hasValue?"#1e1e1e":"#2d2d30",o=>o.hasValue?"#0078d4":"#3e3e42"),uhe=me.button(che||(che=q([`
  background: #2d2d30;
  color: white;
  border: 1px solid #3e3e42;
  padding: 8px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 4px;

  &:hover {
    background: #3e3e42;
  }

  &:active {
    background: #1e1e1e;
  }
`]))),dhe=me.button(hhe||(hhe=q([`
  background: `,`;
  color: white;
  border: 1px solid #3e3e42;
  padding: 8px 10px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 6px;

  &:hover {
    background: `,`;
  }

  &:active {
    background: #005a9e;
  }
`])),o=>o.isOpen?"#0078d4":"#2d2d30",o=>o.isOpen?"#106ebe":"#3e3e42"),phe=me.div(fhe||(fhe=q([`
  position: absolute;
  bottom: 100%;
  left: 0;
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  min-width: 200px;
  opacity: `,`;
  visibility: `,`;
  transform: `,`;
  transition: all 0.15s ease-out;
  z-index: 1000;
`])),o=>o.isOpen?1:0,o=>o.isOpen?"visible":"hidden",o=>o.isOpen?"translateY(0)":"translateY(10px)"),ghe=me.div(mhe||(mhe=q([`
  padding: 4px 0;

  &:not(:last-child) {
    border-bottom: 1px solid #3e3e42;
  }
`]))),yhe=me.div(vhe||(vhe=q([`
  position: relative;

  &:hover > div:last-child {
    opacity: `,`;
    visibility: `,`;
  }
`])),o=>o.hasSubmenu?1:0,o=>o.hasSubmenu?"visible":"hidden"),uB=me.button(xhe||(xhe=q([`
  width: 100%;
  background: transparent;
  color: #cccccc;
  border: none;
  padding: 8px 16px;
  text-align: left;
  cursor: pointer;
  font-size: 12px;
  font-family: inherit;
  display: flex;
  align-items: center;
  justify-content: space-between;

  &:hover {
    background: #3e3e42;
    color: white;
  }

  &:active {
    background: #0078d4;
  }
`]))),bhe=me.div(_he||(_he=q([`
  position: absolute;
  left: 100%;
  top: 0;
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  min-width: 150px;
  opacity: 0;
  visibility: hidden;
  transition: all 0.15s ease-out;
  z-index: 1001;
`]))),She=({layoutP:o,onSVGViewerClear:l,onSVGViewerLoad:h,onSVGViewerShow:m,onSVGViewerHide:_,onFileSave:w,onMarkersAdd:C,onMarkersClear:R,onMarkersLog:N,onEventsAdd:F,onEventsClear:U,onEventsLog:$,onSheetCreate:j,onSheetDuplicate:G,onSheetObjectCreate:Y,onSearchChange:Z,onSearchTrigger:ne})=>{let[ae,ce]=(0,$s.useState)(!1),[ve,Me]=(0,$s.useState)(""),[Te,_e]=(0,$s.useState)(0),it=(0,$s.useCallback)(()=>{ce(Ve=>!Ve)},[]),Re=(0,$s.useCallback)(()=>{ce(!1)},[]),xe=(0,$s.useCallback)(Ve=>{let Ht=Ve.target.value;Me(Ht),Z&&Z(Ht)},[Z]),Oe=(0,$s.useCallback)(Ve=>{if(Ve.key==="Enter"){let Ht=Te+1;_e(Ht),ne&&ne(Ht),Z&&Z(ve)}},[Z,ne,ve,Te]),He=(0,$s.useCallback)(Ve=>{Ve&&Ve(),Re()},[Re]),Fe=[{label:"File",submenu:[{label:"Save",action:w}]},{label:"Sheets",submenu:[{label:"Create Sheet",action:j},{label:"Duplicate Sheet",action:G},{label:"Create Sheet Object",action:Y}]},{label:"Markers",submenu:[{label:"Add",action:C},{label:"Log",action:N},{label:"Clear",action:R}]},{label:"Events",submenu:[{label:"Add",action:F},{label:"Log",action:$},{label:"Clear",action:U}]},{label:"Data Viewer",submenu:[{label:"Show",action:m},{label:"Hide",action:_},{label:"Load",action:h},{label:"Clear",action:l}]}],Nt=(Ve,Ht)=>$s.default.createElement(yhe,{key:Ht,hasSubmenu:!!Ve.submenu},$s.default.createElement(uB,{hasSubmenu:!!Ve.submenu,onClick:()=>!Ve.submenu&&He(Ve.action)},Ve.label,Ve.submenu&&$s.default.createElement("span",null,"")),Ve.submenu&&$s.default.createElement(bhe,null,Ve.submenu.map((ot,Ye)=>$s.default.createElement(uB,{key:Ye,onClick:()=>He(ot.action)},ot.label))));return jr(()=>{let Ve=(0,ihe.val)(o),Ht=Ve.rightPanelOpen,ot=Ve.leftDims.width;return $s.default.createElement(ohe,{width:ot},$s.default.createElement(dhe,{isOpen:ae,onClick:it},$s.default.createElement("span",null,"")),$s.default.createElement(phe,{isOpen:ae},$s.default.createElement(ghe,null,Fe.map(Nt))),$s.default.createElement(lhe,{type:"text",placeholder:"Search...",value:ve,onChange:xe,onKeyDown:Oe,hasValue:ve.length>0}),$s.default.createElement(uhe,{isActive:Ht,onClick:()=>{Ve.setRightPanelOpen(!Ht)},title:Ht?"Hide timeline editor":"Show timeline editor",style:{transform:"scale(".concat(Ht?-1:1,", 1)")}},$s.default.createElement(kTe,null)),ae&&$s.default.createElement("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:99},onClick:Re}))},[o,ae,Fe])},whe=She}),b0,Ehe,The,Mhe,Che,Ahe,Phe,Rhe,Ihe,khe,Nhe,Dhe,hB,Ohe,Lhe,DTe=P(()=>{b0=K($e()),Xt(),The=me.div(Ehe||(Ehe=q([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: `,`;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`])),o=>o.isOpen?"flex":"none"),Che=me.div(Mhe||(Mhe=q([`
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  padding: 24px;
  min-width: 400px;
  max-width: 500px;
`]))),Phe=me.h3(Ahe||(Ahe=q([`
  color: #ffffff;
  font-size: 16px;
  font-family: inherit;
  margin: 0 0 16px 0;
  font-weight: 500;
`]))),Ihe=me.input(Rhe||(Rhe=q([`
  width: 100%;
  background: #1e1e1e;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  padding: 8px 12px;
  color: #ffffff;
  font-size: 14px;
  font-family: inherit;
  margin-bottom: 20px;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #0078d4;
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.3);
  }

  &::placeholder {
    color: #888888;
  }
`]))),Nhe=me.div(khe||(khe=q([`
  display: flex;
  gap: 12px;
  justify-content: flex-end;
`]))),hB=me.button(Dhe||(Dhe=q([`
  background: `,`;
  color: `,`;
  border: 1px solid
    `,`;
  border-radius: 4px;
  padding: 8px 16px;
  font-size: 14px;
  font-family: inherit;
  cursor: pointer;
  min-width: 80px;

  &:hover {
    background: `,`;
  }

  &:active {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#0078d4":"transparent",o=>o.variant==="primary"?"#ffffff":"#cccccc",o=>o.variant==="primary"?"#0078d4":"#3e3e42",o=>o.variant==="primary"?"#106ebe":"#3e3e42",o=>o.variant==="primary"?"#005a9e":"#4a4a4a"),Ohe=(0,b0.forwardRef)(({onConfirm:o,onCancel:l},h)=>{let[m,_]=(0,b0.useState)(!1),[w,C]=(0,b0.useState)("create"),[R,N]=(0,b0.useState)(""),F=w==="create"?"Create New Sheet":"Duplicate Sheet",U="Enter sheet name";(0,b0.useImperativeHandle)(h,()=>({open:(Z,ne)=>{C(Z),_(!0),N(Z==="duplicate"&&ne?"".concat(ne," Copy"):"")},close:()=>{_(!1),N("")}}));let $=(0,b0.useCallback)(()=>{let Z=R.trim();Z&&(o(Z,w),_(!1),N(""))},[R,w,o]),j=(0,b0.useCallback)(()=>{l(),_(!1),N("")},[l]),G=(0,b0.useCallback)(Z=>{Z.key==="Enter"?$():Z.key==="Escape"&&j()},[$,j]),Y=(0,b0.useCallback)(Z=>{Z.target===Z.currentTarget&&j()},[j]);return b0.default.createElement(The,{isOpen:m,onClick:Y},b0.default.createElement(Che,null,b0.default.createElement(Phe,null,F),b0.default.createElement(Ihe,{type:"text",value:R,onChange:Z=>N(Z.target.value),onKeyDown:G,placeholder:U,autoFocus:!0}),b0.default.createElement(Nhe,null,b0.default.createElement(hB,{variant:"secondary",onClick:j},"Cancel"),b0.default.createElement(hB,{variant:"primary",onClick:$,disabled:!R.trim()},"Create"))))}),Lhe=Ohe}),lr,Fhe,Bhe,Uhe,zhe,Vhe,Ghe,jhe,L6,Hhe,og,Whe,j9,$he,qhe,Xhe,Yhe,Khe,Zhe,Qhe,Jhe,ede,tde,nde,rde,ide,sde,ode,ade,lde,cde,ude,hde,dde,fde,pde,dB,fB,mde,OTe=P(()=>{lr=K($e()),Xt(),Bhe=me.div(Fhe||(Fhe=q([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: `,`;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`])),o=>o.isOpen?"flex":"none"),zhe=me.div(Uhe||(Uhe=q([`
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  padding: 24px;
  min-width: 500px;
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
`]))),Ghe=me.h3(Vhe||(Vhe=q([`
  color: #ffffff;
  font-size: 16px;
  font-family: inherit;
  margin: 0 0 20px 0;
  font-weight: 500;
`]))),L6=me.div(jhe||(jhe=q([`
  margin-bottom: 16px;
`]))),og=me.label(Hhe||(Hhe=q([`
  display: block;
  color: #cccccc;
  font-size: 12px;
  font-family: inherit;
  margin-bottom: 6px;
  font-weight: 500;
`]))),j9=me.input(Whe||(Whe=q([`
  width: 100%;
  background: #1e1e1e;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  padding: 8px 12px;
  color: #ffffff;
  font-size: 14px;
  font-family: inherit;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #0078d4;
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.3);
  }

  &::placeholder {
    color: #888888;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`]))),qhe=me.select($he||($he=q([`
  width: 100%;
  background: #1e1e1e;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  padding: 8px 12px;
  color: #ffffff;
  font-size: 14px;
  font-family: inherit;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #0078d4;
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.3);
  }

  option {
    background: #1e1e1e;
    color: #ffffff;
  }
`]))),Yhe=me.div(Xhe||(Xhe=q([`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 12px;
`]))),Zhe=me.div(Khe||(Khe=q([`
  display: flex;
  gap: 12px;
  align-items: flex-end;
`]))),Jhe=me.div(Qhe||(Qhe=q([`
  width: 40px;
  height: 32px;
  border-radius: 4px;
  border: 1px solid #3e3e42;
  background: `,`;
  cursor: pointer;
  position: relative;

  &:hover {
    border-color: #0078d4;
  }
`])),o=>o.color),tde=me.input(ede||(ede=q([`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
`]))),rde=me(j9)(nde||(nde=q([`
  flex: 1;
  font-family: 'Courier New', monospace;
  text-transform: uppercase;
`]))),sde=me.div(ide||(ide=q([`
  display: flex;
  align-items: center;
  gap: 12px;
`]))),ade=me.div(ode||(ode=q([`
  width: 48px;
  height: 24px;
  border-radius: 12px;
  background: `,`;
  border: 1px solid `,`;
  position: relative;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background: `,`;
  }
`])),o=>o.isOn?"#0078d4":"#3e3e42",o=>o.isOn?"#0078d4":"#5a5a5a",o=>o.isOn?"#106ebe":"#4a4a4a"),cde=me.div(lde||(lde=q([`
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #ffffff;
  position: absolute;
  top: 2px;
  left: `,`;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
`])),o=>o.isOn?"26px":"2px"),hde=me.span(ude||(ude=q([`
  color: `,`;
  font-size: 14px;
  font-family: inherit;
  font-weight: `,`;
`])),o=>o.isOn?"#ffffff":"#cccccc",o=>o.isOn?"500":"normal"),fde=me.div(dde||(dde=q([`
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 24px;
`]))),dB=me.button(pde||(pde=q([`
  background: `,`;
  color: `,`;
  border: 1px solid
    `,`;
  border-radius: 4px;
  padding: 8px 16px;
  font-size: 14px;
  font-family: inherit;
  cursor: pointer;
  min-width: 80px;

  &:hover {
    background: `,`;
  }

  &:active {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#0078d4":"transparent",o=>o.variant==="primary"?"#ffffff":"#cccccc",o=>o.variant==="primary"?"#0078d4":"#3e3e42",o=>o.variant==="primary"?"#106ebe":"#3e3e42",o=>o.variant==="primary"?"#005a9e":"#4a4a4a"),fB=(0,lr.forwardRef)(({onConfirm:o,onCancel:l},h)=>{let[m,_]=(0,lr.useState)(!1),[w,C]=(0,lr.useState)(""),[R,N]=(0,lr.useState)(""),[F,U]=(0,lr.useState)("number"),[$,j]=(0,lr.useState)(""),[G,Y]=(0,lr.useState)(""),[Z,ne]=(0,lr.useState)(""),[ae,ce]=(0,lr.useState)(""),[ve,Me]=(0,lr.useState)("#FFFFFF"),[Te,_e]=(0,lr.useState)(!1),it=_t=>{let be=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(_t);return be?{r:parseInt(be[1],16)/255,g:parseInt(be[2],16)/255,b:parseInt(be[3],16)/255,a:1}:{r:1,g:1,b:1,a:1}},Re=_t=>{let be=dt=>{let bt=Math.round(dt*255).toString(16);return bt.length===1?"0"+bt:bt};return"#".concat(be(_t.r)).concat(be(_t.g)).concat(be(_t.b)).toUpperCase()},xe=_t=>{try{let be=JSON.parse(_t);if(be&&typeof be=="object"&&"r"in be&&"g"in be&&"b"in be)return{r:be.r,g:be.g,b:be.b,a:1}}catch{}return{r:1,g:1,b:1,a:1}};(0,lr.useImperativeHandle)(h,()=>({open:_t=>{_(!0),C(_t||""),N(""),U("number"),j(""),Y(""),ne(""),ce(""),Me("#FFFFFF"),_e(!1)},close:()=>{_(!1)}}));let Oe=_t=>{switch(_t){case"number":return"0";case"string":return"Hello World";case"boolean":return"false";case"rgba":return'{"r": 1, "g": 1, "b": 1, "a": 1}';case"compound":return'{"x": 0, "y": 0, "z": 0}';default:return""}},He=_t=>{switch(_t){case"number":return"e.g. 0, 3.14, -10";case"string":return'e.g. "Hello World"';case"boolean":return"Use toggle below";case"rgba":return"Use color picker or enter hex";case"compound":return'{"x": 0, "y": 0, "z": 0}';default:return""}},Fe=_t=>{U(_t);let be=Oe(_t);if(j(be),_t==="rgba"){let dt=xe(be);Me(Re(dt))}else _t==="boolean"&&(_e(!1),j("false"));_t!=="number"&&(Y(""),ne(""),ce(""))},Nt=()=>{let _t=!Te;_e(_t),j(_t.toString())},Ve=_t=>{Me(_t);let be=it(_t);j(JSON.stringify(be))},Ht=_t=>{/^#[0-9A-Fa-f]{6}$/.test(_t)?Ve(_t):Me(_t)},ot=(_t,be)=>{switch(be){case"number":let dt=parseFloat(_t);return isNaN(dt)?0:dt;case"string":return _t;case"boolean":return _t.toLowerCase()==="true";case"rgba":try{return JSON.parse(_t)}catch{return{r:1,g:1,b:1,a:1}}case"compound":try{return JSON.parse(_t)}catch{return{}}default:return _t}},Ye=(0,lr.useCallback)(()=>{let _t=w.trim(),be=R.trim();if(!_t||!be)return;let dt=ot($,F),bt={name:_t,key:be,type:F,value:dt};F==="number"&&(G!==""&&(bt.min=parseFloat(G)),Z!==""&&(bt.max=parseFloat(Z)),ae!==""&&(bt.step=parseFloat(ae))),o(bt),_(!1)},[w,R,F,$,G,Z,ae,o]),Ee=(0,lr.useCallback)(()=>{l(),_(!1)},[l]),et=(0,lr.useCallback)(_t=>{_t.key==="Enter"&&_t.ctrlKey?Ye():_t.key==="Escape"&&Ee()},[Ye,Ee]),At=(0,lr.useCallback)(_t=>{_t.target===_t.currentTarget&&Ee()},[Ee]),Ce=F==="number",Ze=F==="rgba",Ft=F==="boolean",$t=w.trim()!==""&&R.trim()!=="";return lr.default.createElement(Bhe,{isOpen:m,onClick:At},lr.default.createElement(zhe,null,lr.default.createElement(Ghe,null,"Create Sheet Object"),lr.default.createElement(L6,null,lr.default.createElement(og,null,"Object Name"),lr.default.createElement(j9,{type:"text",value:w,onChange:_t=>C(_t.target.value),onKeyDown:et,placeholder:"Enter object name (e.g. 'myBox', 'character')",autoFocus:!0})),lr.default.createElement(L6,null,lr.default.createElement(og,null,"Property Key"),lr.default.createElement(j9,{type:"text",value:R,onChange:_t=>N(_t.target.value),onKeyDown:et,placeholder:"Enter property key (e.g. 'position', 'color', 'scale')"})),lr.default.createElement(L6,null,lr.default.createElement(og,null,"Type"),lr.default.createElement(qhe,{value:F,onChange:_t=>Fe(_t.target.value)},lr.default.createElement("option",{value:"number"},"Number"),lr.default.createElement("option",{value:"string"},"String"),lr.default.createElement("option",{value:"boolean"},"Boolean"),lr.default.createElement("option",{value:"rgba"},"Color"),lr.default.createElement("option",{value:"compound"},"Object"))),lr.default.createElement(L6,null,lr.default.createElement(og,null,"Default Value"),Ze?lr.default.createElement(Zhe,null,lr.default.createElement(Jhe,{color:ve},lr.default.createElement(tde,{type:"color",value:ve,onChange:_t=>Ve(_t.target.value)})),lr.default.createElement(rde,{type:"text",value:ve,onChange:_t=>Ht(_t.target.value),onKeyDown:et,placeholder:"#FFFFFF"})):Ft?lr.default.createElement(sde,null,lr.default.createElement(ade,{isOn:Te,onClick:Nt},lr.default.createElement(cde,{isOn:Te})),lr.default.createElement(hde,{isOn:Te},Te?"True":"False")):lr.default.createElement(j9,{type:"text",value:$,onChange:_t=>j(_t.target.value),onKeyDown:et,placeholder:He(F)})),Ce&&lr.default.createElement(L6,null,lr.default.createElement(og,null,"Range (Optional)"),lr.default.createElement(Yhe,null,lr.default.createElement("div",null,lr.default.createElement(og,{style:{fontSize:"11px",marginBottom:"4px"}},"Min"),lr.default.createElement(j9,{type:"number",value:G,onChange:_t=>Y(_t.target.value),onKeyDown:et,placeholder:"Min"})),lr.default.createElement("div",null,lr.default.createElement(og,{style:{fontSize:"11px",marginBottom:"4px"}},"Max"),lr.default.createElement(j9,{type:"number",value:Z,onChange:_t=>ne(_t.target.value),onKeyDown:et,placeholder:"Max"})),lr.default.createElement("div",null,lr.default.createElement(og,{style:{fontSize:"11px",marginBottom:"4px"}},"Step"),lr.default.createElement(j9,{type:"number",value:ae,onChange:_t=>ce(_t.target.value),onKeyDown:et,placeholder:"Step"})))),lr.default.createElement(fde,null,lr.default.createElement(dB,{variant:"secondary",onClick:Ee},"Cancel"),lr.default.createElement(dB,{variant:"primary",onClick:Ye,disabled:!$t},"Create"))))}),fB.displayName="SheetObjectModal",mde=fB});function LTe(o,l){let h=new File([o],l),m=URL.createObjectURL(h),_=Object.assign(document.createElement("a"),{href:m,target:"_blank",rel:"noopener"});_.setAttribute("download",l),_.click(),setTimeout(()=>{URL.revokeObjectURL(m)},4e4)}var ws,In,F6,gde,vde,yde,xde,lf,_de,bde,Sde,wde,Ede,Tde,Mde,Cde,Ade,Pde,Rde,Ide,kde,oS,Nde,Dde,Ode,Lde,Fde,Bde,Ude,zde,Vde,Gde,e1=P(()=>{Se(),t6(),Yd(),ur(),jZ(),ws=rn(),In=K($e()),Xt(),F6=I8e(),FEe(),aA(),qEe(),MTe(),s6(),Pb(),Dd(),zK(),mZ(),ba(),hn(),m0(),CTe(),M9(),Fb(),ATe(),RTe(),ITe(),NTe(),DTe(),OTe(),vF(),vde=me(EO)(gde||(gde=q([`
  z-index: `,`;
  box-shadow: 2px 2px 0 rgb(0 0 0 / 11%);
  `,`
`])),H5.sequenceEditorPanel,o=>o.collapsedWidth?"width: ".concat(o.collapsedWidth,"px !important; max-width: ").concat(o.collapsedWidth,"px !important;"):""),xde=me.div(yde||(yde=q([`
  background-color: rgba(40, 43, 47, 0.99);
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  z-index: -1;
  pointer-events: none;
`]))),lf=(()=>{let o={svgViewer:0,rightBackground:0,scrollableArea:0,rightOverlay:0,lengthIndicatorCover:0,lengthIndicatorStrip:0,playhead:0,currentFrameStamp:0,marker:0,horizontalScrollbar:0},l=-1;for(let h of Object.keys(o))o[h]=l,l++;return o})(),bde=me(vO)(_de||(_de=q([`
  position: absolute;
  left: 0;
  top: 0;
  z-index: 2;

  `,` {
    height: 60px;
    display: flex;
    flex-direction: column;
    align-items: normal;
    padding: 0;
  }
`])),kM),Sde={edges:{left:{from:"screenLeft",distance:.1},right:{from:"screenRight",distance:.2},top:{from:"screenBottom",distance:.4},bottom:{from:"screenBottom",distance:.01}}},wde=()=>jr(()=>{var o;let l=de(),h={width:(o=(0,ws.val)(l.atomP.historic.panels.sequenceEditor.rightPanelOpen))==null||o?FF*2:FF,height:200};return In.default.createElement(uO,{panelId:"sequenceEditor",defaultPosition:Sde,minDims:h},In.default.createElement(Ede,null))},[]),Ede=()=>{let{dims:o}=i6(),[l,h]=(0,In.useState)(null),[m,_]=(0,In.useState)(""),[w,C]=(0,In.useState)(0),R=(0,In.useRef)(null),[N,F]=(0,In.useState)(!1),[U,$]=(0,In.useState)(!1),[j,G]=(0,In.useState)(null),Y=(0,In.useRef)(null),Z=(0,In.useRef)(null),ne=(0,In.useRef)(new Map),ae=(0,In.useRef)(null),ce=(0,In.useCallback)(()=>{var be;(be=R.current)==null||be.clearData()},[]),ve=(0,In.useCallback)(()=>{F(!0)},[]),Me=(0,In.useCallback)(()=>{var be;(be=R.current)==null||be.show()},[]),Te=(0,In.useCallback)(()=>{var be;(be=R.current)==null||be.hide()},[]),_e=(0,In.useCallback)((be,dt)=>{var bt;(bt=R.current)==null||bt.addData(be,dt),F(!1)},[]),it=(0,In.useCallback)(()=>{F(!1)},[]),Re=(0,In.useCallback)(be=>De(void 0,null,function*(){if(!j)throw new Error("No sheet selected");try{let dt=j.project.publicApi.sheet(j.address.sheetId).sequence,bt;be instanceof File?bt=URL.createObjectURL(be):bt=be,yield dt.attachAudio({source:bt}),console.log(" Audio attached successfully"),be instanceof File&&setTimeout(()=>{URL.revokeObjectURL(bt)},5e3)}catch(dt){throw console.error(" Failed to attach audio:",dt),dt}}),[j]),xe=(0,In.useCallback)(()=>{$(!1),G(null)},[]),Oe=(0,In.useCallback)(()=>{var be;(be=Y.current)==null||be.open("create")},[]),He=(0,In.useCallback)(()=>{var be,dt;let bt=ae.current,pn=((be=bt==null?void 0:bt.address)==null?void 0:be.sheetId)||"Sheet";(dt=Y.current)==null||dt.open("duplicate",pn)},[]),Fe=(0,In.useCallback)((be,dt)=>{var bt;try{let pn=ae.current;if((bt=pn==null?void 0:pn.project)!=null&&bt.publicApi){let qn=pn.project.publicApi.sheet(be);console.log(" Successfully ".concat(dt==="create"?"created":"duplicated"," sheet: ").concat(be))}else console.error(" No current sheet or project available")}catch(pn){console.error(" Failed to ".concat(dt," sheet:"),pn)}},[]),Nt=(0,In.useCallback)(()=>{console.log(" Sheet modal cancelled")},[]),Ve=(0,In.useCallback)(()=>{var be;(be=Z.current)==null||be.open()},[]),Ht=(0,In.useCallback)(be=>{_(be)},[]),ot=(0,In.useCallback)(be=>{C(be)},[]);In.default.useEffect(()=>{let be=dt=>{let{sheet:bt}=dt.detail;G(bt),$(!0)};return document.addEventListener("theatre:attachAudio",be),()=>{document.removeEventListener("theatre:attachAudio",be)}},[]);let Ye=(0,In.useCallback)(be=>{try{let dt=ae.current;if(dt){let bt;switch(be.type){case"number":if(be.min!==void 0||be.max!==void 0||be.step!==void 0){let oi={};be.min!==void 0&&be.max!==void 0&&(oi.range=[be.min,be.max]),be.step!==void 0&&(oi.nudgeMultiplier=be.step),bt=F6.types.number(be.value,oi)}else bt=F6.types.number(be.value);break;case"string":bt=F6.types.string(be.value);break;case"boolean":bt=F6.types.boolean(be.value);break;case"rgba":bt=F6.types.rgba(be.value);break;case"compound":bt=be.value;break;default:bt=be.value}let pn=dt.project.publicApi.sheet(dt.address.sheetId),qn="".concat(dt.address.sheetId,":").concat(be.name),sr=ne.current.get(qn)||{};sr[be.key]=bt,ne.current.set(qn,sr);let gr;try{let oi,ps={};try{oi=pn.object(be.name,{}),ps=oi.value||{}}catch{}let zr=A({},sr);gr=pn.object(be.name,zr,{reconfigure:!0});let qs=Object.keys(sr),ri=Object.keys(gr.value||{}),di=qs.filter(Wa=>!ri.includes(Wa));di.length!==0&&(console.log(" Still missing props:",di),console.log("This indicates a fundamental Theatre.js limitation with reconfigure"))}catch(oi){throw console.error(" Object creation failed:",oi),oi}}else console.error(" No current sheet available")}catch(dt){console.error(" Failed to create sheet object:",dt)}},[]),Ee=(0,In.useCallback)(()=>{console.log(" Sheet object modal cancelled")},[]),et=(0,In.useCallback)(()=>{console.log(" Start Menu: Saving project files");try{let be=(0,ws.val)(de().projectsP);Object.values(be).forEach(dt=>{if(dt){let bt=dt.address.projectId,pn=bt.replace(/[^\w\d'_\-]+/g," ").trim(),qn="".concat(pn,".json"),sr=JSON.stringify(de().createContentOfSaveFile(bt),null,2);LTe(sr,qn),console.log(" Saved project: ".concat(qn))}})}catch(be){console.error(" Failed to save project files:",be)}},[]),At=(0,In.useCallback)(()=>{try{let be=Ds(Dh().filter(dt=>Pe(dt)||Bt(dt)).map(dt=>Bt(dt)?dt.sheet:dt));if(be.length>0){let dt=be[0],bt=dt.getSequence();de().transaction(({stateEditors:pn})=>{pn.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:dt.address,markers:[{id:VZ(),position:bt.position,label:"Marker ".concat(Math.floor(bt.position*100)/100,"s")}],snappingFunction:bt.closestGridPosition})})}else console.warn(" No sheet selected for adding marker")}catch(be){console.error(" Failed to add marker:",be)}},[]),Ce=(0,In.useCallback)(()=>{try{let be=Ds(Dh().filter(dt=>Pe(dt)||Bt(dt)).map(dt=>Bt(dt)?dt.sheet:dt));if(be.length>0){let dt=be[0],bt=dt.getSequence();de().transaction(({stateEditors:pn})=>{pn.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:dt.address,events:[{id:GZ(),name:"event",position:bt.position}]})})}else console.warn(" No sheet selected for adding event")}catch(be){console.error(" Failed to add event:",be)}},[]),Ze=(0,In.useCallback)(()=>{try{let be=Ds(Dh().filter(dt=>Pe(dt)||Bt(dt)).map(dt=>Bt(dt)?dt.sheet:dt));if(be.length>0){let dt=be[0],bt=de().atomP.historic.projects.stateByProjectId[dt.address.projectId].stateBySheetId[dt.address.sheetId].sequenceEditor.markerSet,pn=(0,ws.val)(bt.allIds);pn&&Object.keys(pn).length>0?Object.keys(pn).forEach(qn=>{de().transaction(({stateEditors:sr})=>{sr.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeMarker({sheetAddress:dt.address,markerId:qn})})}):console.log(" No markers to clear")}else console.warn(" No sheet selected for clearing markers")}catch(be){console.error(" Failed to clear markers:",be)}},[]),Ft=(0,In.useCallback)(()=>{try{let be=Ds(Dh().filter(dt=>Pe(dt)||Bt(dt)).map(dt=>Bt(dt)?dt.sheet:dt));if(be.length>0){let dt=be[0],bt=(0,ws.val)(de().atomP.historic.projects.stateByProjectId[dt.address.projectId].stateBySheetId[dt.address.sheetId]),pn=(0,ws.val)(de().atomP.historic.coreByProject[dt.address.projectId].sheetsById[dt.address.sheetId].sequence.markers)||[];console.group(" Markers for sheet:",dt.address.sheetId),console.log("Total markers:",pn.length),pn.forEach((qn,sr)=>{console.log("".concat(sr+1,'. "').concat(qn.label||"Unnamed",'" at ').concat(qn.position,"s (ID: ").concat(qn.id,")"))}),console.groupEnd()}else console.warn(" No sheet selected for logging markers")}catch(be){console.error(" Failed to log markers:",be)}},[]),$t=(0,In.useCallback)(()=>{try{let be=Ds(Dh().filter(dt=>Pe(dt)||Bt(dt)).map(dt=>Bt(dt)?dt.sheet:dt));if(be.length>0){let dt=be[0],bt=de().atomP.historic.projects.stateByProjectId[dt.address.projectId].stateBySheetId[dt.address.sheetId].sequenceEditor.eventSet,pn=(0,ws.val)(bt==null?void 0:bt.allIds);pn&&Object.keys(pn).length>0?Object.keys(pn).forEach(qn=>{de().transaction(({stateEditors:sr})=>{sr.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeEvent({sheetAddress:dt.address,eventId:qn})})}):console.log(" No events to clear")}else console.warn(" No sheet selected for clearing events")}catch(be){console.error(" Failed to clear events:",be)}},[]),_t=(0,In.useCallback)(()=>{try{let be=Ds(Dh().filter(dt=>Pe(dt)||Bt(dt)).map(dt=>Bt(dt)?dt.sheet:dt));if(be.length>0){let dt=be[0],bt=(0,ws.val)(de().atomP.historic.coreByProject[dt.address.projectId].sheetsById[dt.address.sheetId].sequence.events)||[];console.group(" Events for sheet:",dt.address.sheetId),console.log("Total events:",bt.length),bt.forEach((pn,qn)=>{console.log("".concat(qn+1,'. "').concat(pn.name,'" at ').concat(pn.position,"s").concat(pn.value!==void 0?" (value: ".concat(JSON.stringify(pn.value),")"):""," (ID: ").concat(pn.id,")"))}),console.groupEnd()}else console.warn(" No sheet selected for logging events")}catch(be){console.error(" Failed to log events:",be)}},[]);return LSe(l),jr(()=>{var be;let dt=de(),bt=(be=(0,ws.val)(dt.atomP.historic.panels.sequenceEditor.rightPanelOpen))!=null?be:!0,pn=ws.prism.memo("panelSize",()=>{let Zr=o.width,cg=o.height;return{width:Zr,height:cg,widthWithoutBorder:Zr-2,heightWithoutBorder:cg-4,screenX:o.left,screenY:o.top}},[o,bt]),qn=Ds(Dh().filter(Zr=>Pe(Zr)||Bt(Zr)).map(Zr=>Bt(Zr)?Zr.sheet:Zr));if(Ds(qn.map(Zr=>Zr.template)).length!==1)return In.default.createElement(In.default.Fragment,null);let sr=qn[0];if(!sr)return In.default.createElement(In.default.Fragment,null);ae.current=sr;let gr=sr.getSequence().length,oi=(0,ws.val)(de().atomP.ahistoric.projects.stateByProjectId[sr.address.projectId].stateBySheetId[sr.address.sheetId].sequence.clippedSpaceRange)||{start:0,end:10},ps=oi.start===0&&oi.end===10,zr=gr*1.05;gr>0&&gr!==10&&oi.end!==zr&&ps&&setTimeout(()=>{de().transaction(({stateEditors:Zr})=>{Zr.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.clippedSpaceRange.set(V(A({},sr.address),{range:{start:0,end:zr}}))})},0);let qs=RO("panelSizeP",pn).pointer,ri=ws.prism.memo("key",()=>JSON.stringify(sr.address),[sr]),di=$Ee(sr,qs).getValue();(0,ws.val)(di.tree.children).length>0;let Wa=(0,ws.val)(sr.project.pointers.historic.sheetsById[sr.address.sheetId].sequence);Wa!=null&&Wa.length&&Wa.length>0||Wa!=null&&Wa.markers&&Wa.markers.length>0;let vo=ws.prism.memo("containerRef",Gde,[]),zh=(0,ws.val)(di.graphEditorDims.isAvailable),zc=(0,ws.val)(di.graphEditorDims.isOpen),$a=(0,ws.val)(di.rightPanelOpen),Cr=$a?void 0:(0,ws.val)(di.leftDims.width);return In.default.createElement(vde,{collapsedWidth:Cr,ref:Zr=>{vo(Zr),Zr!==l&&h(Zr)}},In.default.createElement(xde,{style:{width:"".concat((0,ws.val)(di.leftDims.width),"px")}}),In.default.createElement(whe,{layoutP:di,onSVGViewerClear:ce,onSVGViewerLoad:ve,onSVGViewerShow:Me,onSVGViewerHide:Te,onFileSave:et,onMarkersAdd:At,onMarkersClear:Ze,onMarkersLog:Ft,onEventsAdd:Ce,onEventsClear:$t,onEventsLog:_t,onSheetCreate:Oe,onSheetDuplicate:He,onSheetObjectCreate:Ve,onSearchChange:Ht,onSearchTrigger:ot}),In.default.createElement(Ene,{layoutP:di},In.default.createElement(Tde,{layoutP:di}),In.default.createElement(Oce,{ref:R,key:ri+"-svgViewer",layoutP:di,sheetAddress:sr.address,renderMode:"both",color:"#4575e3"}),In.default.createElement(Dse,{searchTerm:m,searchTrigger:w},In.default.createElement(Fae,{key:ri+"-dopeSheet-"+m+"-"+w,layoutP:di})),zc&&In.default.createElement($oe,{key:ri+"-graphEditor",layoutP:di}),zh&&In.default.createElement(Rce,{layoutP:di}),$a&&In.default.createElement(Tce,{layoutP:di})),In.default.createElement(Lhe,{ref:Y,onConfirm:Fe,onCancel:Nt}),In.default.createElement(mde,{ref:Z,onConfirm:Ye,onCancel:Ee}),N&&In.default.createElement(Cue,{onLoad:_e,onCancel:it}),U&&In.default.createElement(rhe,{onAttach:Re,onCancel:xe}))},[o,l,m,w,N,U])},Tde=({layoutP:o})=>jr(()=>{let l=(0,ws.val)(o.sheet);return l.getSequence(),In.default.createElement(bde,{style:{width:(0,ws.val)(o.leftDims.width)}},In.default.createElement(kM,{style:{borderRight:"1px solid #222"}},In.default.createElement(Pde,{style:{borderBottom:"1px solid #222"}},In.default.createElement(XD,{style:{color:"white",fontSize:"14px",fontWeight:"bold"}},l.address.sheetId)),In.default.createElement(Ide,null,In.default.createElement(Cde,null,In.default.createElement(Fde,{layoutP:o}),In.default.createElement(IM,null,"/"),In.default.createElement(Bde,{layoutP:o}),In.default.createElement(IM,null,"-"),In.default.createElement(zde,{layoutP:o}),In.default.createElement(IM,null,":"),In.default.createElement(Ude,{layoutP:o}),In.default.createElement(XD,{style:{fontSize:"9px",opacity:.7}},"fps")))))},[o]),Cde=me.div(Mde||(Mde=q([`
  display: flex;
  align-items: center;
  gap: 4px;
  height: 30px;
`]))),Pde=me.div(Ade||(Ade=q([`
  display: flex;
  align-items: center;
  height: 30px;
  padding: 0 8px;
`]))),Ide=me.div(Rde||(Rde=q([`
  display: flex;
  align-items: center;
  height: 30px;
  padding: 0 8px;
`]))),oS=me(f6)(kde||(kde=q([`
  flex: 1;
  min-width: 0;
  height: 20px;
  font-size: 12px;
  padding: 0;
  background: rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: #adadadb3;
  border-radius: 2px;

  &:hover {
    background: rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.15);
  }

  &:focus {
    background: rgba(0, 0, 0, 0.4);
    border-color: rgba(255, 255, 255, 0.2);
    color: white;
  }
`]))),Dde=me(oS)(Nde||(Nde=q([`
  width: 40px;
`]))),Lde=me(oS)(Ode||(Ode=q([`
  width: 40px;
`]))),Fde=({layoutP:o})=>jr(()=>{let l=(0,ws.val)(o.sheet).getSequence(),h=Number((0,ws.val)(l.pointer.position).toFixed(3)),m,_=l.position;return In.default.createElement(oS,V(A({value:h},{temporarilySetValue(w){m!==void 0&&(m=void 0),m=Bi(w,0,l.length),l.position=m},discardTemporaryValue(){m!==void 0&&(m=void 0,l.position=_)},permanentlySetValue(w){m!==void 0&&(m=void 0),l.position=Bi(w,0,l.length)}}),{isValid:w=>isFinite(w)&&w>=0,nudge:({deltaX:w})=>w*.01}))},[o]),Bde=({layoutP:o})=>jr(()=>{let l=(0,ws.val)(o.sheet),h=l.getSequence().length,m;return In.default.createElement(oS,V(A({value:h},{temporarilySetValue(_){m&&(m.discard(),m=void 0),m=de().tempTransaction(({stateEditors:w})=>{w.coreByProject.historic.sheetsById.sequence.setLength(V(A({},l.address),{length:_}))})},discardTemporaryValue(){m&&(m.discard(),m=void 0)},permanentlySetValue(_){m&&(m.discard(),m=void 0),de().transaction(({stateEditors:w})=>{w.coreByProject.historic.sheetsById.sequence.setLength(V(A({},l.address),{length:_}))})}}),{isValid:_=>isFinite(_)&&_>0,nudge:({deltaX:_})=>_*.1}))},[o]),Ude=({layoutP:o})=>jr(()=>{let l=(0,ws.val)(o.sheet),h=l.getSequence().subUnitsPerUnit,m;return In.default.createElement(Lde,V(A({value:h},{temporarilySetValue(_){m&&(m.discard(),m=void 0),m=de().tempTransaction(({stateEditors:w})=>{w.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit(V(A({},l.address),{subUnitsPerUnit:_}))})},discardTemporaryValue(){m&&(m.discard(),m=void 0)},permanentlySetValue(_){m&&(m.discard(),m=void 0),de().transaction(({stateEditors:w})=>{w.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit(V(A({},l.address),{subUnitsPerUnit:_}))})}}),{isValid:_=>isFinite(_)&&_>=1&&_<=L(2,12),nudge:({deltaX:_})=>_*1}))},[o]),zde=({layoutP:o})=>jr(()=>{let l=(0,ws.val)(o.sheet).getSequence(),h=l.subUnitsPerUnit,m=(0,ws.val)(l.pointer.position),_=Math.round(m*h),w,C=l.position;return In.default.createElement(Dde,V(A({value:_},{temporarilySetValue(R){w!==void 0&&(w=void 0),w=R;let N=Bi(R/h,0,l.length);l.position=N},discardTemporaryValue(){w!==void 0&&(w=void 0,l.position=C)},permanentlySetValue(R){w!==void 0&&(w=void 0);let N=Bi(R/h,0,l.length);l.position=N}}),{isValid:R=>isFinite(R)&&R>=0,nudge:({deltaX:R})=>R*1}))},[o]),Vde=wde,Gde=()=>{let o=null,l={passive:!1,capture:!1},h=m=>{Math.abs(m.deltaY)<Math.abs(m.deltaX)&&(m.preventDefault(),m.stopPropagation())};return m=>{o!==m&&o&&o.removeEventListener("wheel",h,l),o=m,m&&m.addEventListener("wheel",h,l)}}}),B6,jde,Hde,FTe=P(()=>{Z_e(),B6=K($e()),Se(),ur(),jbe(),e1(),jde=()=>{let o=Rr(de().paneManager.allPanesD),l=Object.entries(o).map(([h,m])=>B6.default.createElement(FZ,{key:"pane-".concat(h),paneInstance:m}));return B6.default.createElement(B6.default.Fragment,null,l,B6.default.createElement(fK,null),B6.default.createElement(Vde,null))},Hde=jde}),Wde,$de,IA,pB=P(()=>{Xt(),Qd(),$de=me(Dc)(Wde||(Wde=q([`
  padding: 1em;
  max-width: 240px;
  pointer-events: none !important;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: #45464d;
`]))),IA=$de}),qde,Xde,Yde,BTe=P(()=>{Xt(),pB(),Xde=me(IA)(qde||(qde=q([`
  --popover-outer-stroke: #e11c1c;
  --popover-inner-stroke: #2c1c1c;
  --popover-bg: #2c1c1c;
  pointer-events: none !important;
`]))),Yde=Xde}),UTe=te((o,l)=>{var h,m;h=[],m=[];function _(w,C,R){var N,F,U,$,j,G,Y,Z;if(w===C)return 0;if(N=w.length,F=C.length,N===0)return F;if(F===0)return N;for(R&&(w=w.toLowerCase(),C=C.toLowerCase()),Y=0;Y<N;)m[Y]=w.charCodeAt(Y),h[Y]=++Y;for(Z=0;Z<F;)for(U=C.charCodeAt(Z),$=j=Z++,Y=-1;++Y<N;)G=U===m[Y]?j:j+1,j=h[Y],h[Y]=$=j>$?G>$?$+1:G:G>j?j+1:G;return $}l.exports=_}),zTe=te((o,l)=>{var h=UTe();function m(){var _,w,C,R,N,F=0,U=arguments[0],$=arguments[1],j=$.length,G=arguments[2];G&&(R=G.threshold,N=G.ignoreCase),R===void 0&&(R=0);for(var Y=0;Y<j;++Y)N?w=h(U,$[Y],!0):w=h(U,$[Y]),w>U.length?_=1-w/$[Y].length:_=1-w/U.length,_>F&&(F=_,C=$[Y]);return F>=R?C:null}l.exports=m});function VTe(o,l,h="Did you mean ",m="?"){let _=(0,Kde.default)(o,l,{threshold:.7});return _?h+JSON.stringify(_)+m:""}var Kde,GTe=P(()=>{Kde=K(zTe())});function Zde(o,l){return o.length<=l?o:o.substr(0,l-3)+"..."}var jTe=P(()=>{}),Qde,mB,Jde=P(()=>{jTe(),Qde=o=>typeof o=="string"?'string("'.concat(Zde(o,10),'")'):typeof o=="number"?"number(".concat(Zde(String(o),10),")"):o===null?"null":o===void 0?"undefined":typeof o=="boolean"?String(o):Array.isArray(o)?"array":typeof o=="object"?"object":"unknown",mB=Qde}),efe,tfe,gB,nfe=P(()=>{Xt(),pB(),tfe=me(IA)(efe||(efe=q([`
  padding: 6px;
`]))),gB=tfe}),rfe,ife,vB,sfe=P(()=>{Xt(),j5(),ife=me(uY)(rfe||(rfe=q([`
  display: flex;
  height: fit-content;
  backdrop-filter: blur(14px);
  border-radius: 2px;
`]))),vB=ife}),U6,ofe,afe,lfe,aS,kA=P(()=>{Xt(),$i(),U6=K($e()),UC(),qM(),nfe(),sfe(),afe=me.button(ofe||(ofe=q([`
  `,`;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  width: 32px;
  height: 32px;
  outline: none;

  color: #a8a8a9;

  background: rgba(40, 43, 47, 0.8);
  backdrop-filter: blur(14px);
  border: none;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 2px;

  svg {
    display: block;
  }

  &:hover {
    background: rgba(59, 63, 69, 0.8);
  }

  &:active {
    background: rgba(82, 88, 96, 0.8);
  }

  &.selected {
    color: rgba(255, 255, 255, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.7);
  }

  // Don't blur if in a button group, because it already blurs. We need to blur
  // on the group-level, otherwise we get seams.
  `,` > & {
    backdrop-filter: none;
    filter: none;
    border-radius: 0;

    &:first-child {
      border-top-left-radius: 2px;
      border-bottom-left-radius: 2px;
    }

    &:last-child {
      border-bottom-right-radius: 2px;
      border-top-right-radius: 2px;
    }
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Ni,vB),lfe=U6.default.forwardRef((o,l)=>{var h=o,{title:m}=h,_=X(h,["title"]);let[w,C]=FC({enabled:typeof m=="string"},()=>U6.default.createElement(gB,null,m));return U6.default.createElement(U6.default.Fragment,null,w,U6.default.createElement(afe,A({ref:$M([C,l])},_))," ")}),aS=lfe}),cfe,ufe,hfe,dfe,ffe,HTe=P(()=>{cfe=K($e()),kA(),Xt(),$i(),hfe=me(aS)(ufe||(ufe=q([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Ni),dfe=({config:o,testId:l})=>{var h;return cfe.default.createElement(hfe,{onClick:o.onClick,"data-testid":l,title:o.title,dangerouslySetInnerHTML:{__html:(h=o.svgSource)!=null?h:""}})},ffe=dfe});function WTe({value:o,label:l,icon:h,onClick:m,isSelected:_}){return z6.default.createElement(z6.default.Fragment,null,z6.default.createElement(aS,{forwardedAs:aY,className:_?"selected":void 0,"aria-label":l,onClick:m,title:l},h))}var z6,pfe,mfe,$Te=P(()=>{z6=K($e()),j5(),kA(),sfe(),pfe=({value:o,onChange:l,options:h})=>z6.default.createElement(vB,null,h.map(({label:m,icon:_,value:w})=>z6.default.createElement(WTe,{key:w,value:w,isSelected:o===w,label:m,icon:_,onClick:()=>l(w)}))),mfe=pfe}),yB,gfe,vfe,yfe,xfe,qTe=P(()=>{yB=K($e()),Xt(),$i(),$Te(),vfe=me.div(gfe||(gfe=q([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Ni),yfe=({config:o})=>yB.default.createElement(mfe,{onChange:o.onChange,options:o.options.map(({label:l,value:h,svgSource:m})=>({label:l,value:h,icon:yB.default.createElement(vfe,{dangerouslySetInnerHTML:{__html:m}})})),value:o.value}),xfe=yfe}),lS,_fe,bfe,Sfe,wfe,XTe=P(()=>{lS=K($e()),Xt(),$i(),kA(),dQ(),Zd(),bfe=me.div(_fe||(_fe=q([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Ni),Sfe=({config:o})=>{let l=(0,lS.useRef)(null),h=Nc(()=>{let m=l.current.getBoundingClientRect();return{debugName:"ExtensionFlyoutMenu:"+o.label,constraints:{maxX:m.right,maxY:8,minX:m.left,minY:8},verticalGap:2}},()=>lS.default.createElement(LO,{items:o.items.map((m,_)=>({label:m.label,callback:()=>{var w;try{(w=m.onClick)==null||w.call(m)}catch(C){console.error(C)}}})),onRequestClose:()=>{h.close("clicked")}}));return lS.default.createElement(bfe,null,h.node,lS.default.createElement(aS,{ref:l,onClick:m=>{h.open(m,l.current)}},o.label))},wfe=Sfe});function YTe(o){return xB[o]}var cS,Efe,xB,Tfe,Mfe,KTe=P(()=>{GTe(),Jde(),cS=K($e()),HTe(),qTe(),XTe(),Efe=o=>cS.default.createElement(cS.default.Fragment,null,o.config.map((l,h)=>cS.default.createElement(Tfe,{config:l,key:h}))),xB={Icon:ffe,Switch:xfe,Flyout:wfe},Tfe=({config:o})=>{let l=YTe(o.type);if(!l)throw new Error("No tool with tool.type ".concat(mB(o.type)," exists. Did you mean ").concat(VTe(o.type,Object.keys(xB))));return cS.default.createElement(l,{config:o})},Mfe=Efe}),Cfe,t1,Afe,Pfe,Rfe,_B,Ife,kfe,bB,Nfe=P(()=>{Cfe=rn(),ur(),Se(),t1=K($e()),Xt(),KTe(),Pfe=me.div(Afe||(Afe=q([`
  height: 36px;
  /* pointer-events: none; */

  display: flex;
  gap: 0.5rem;
  justify-content: center;
`]))),_B=me.div(Rfe||(Rfe=q([`
  position: abolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),Ife=({extension:o,toolbarId:l})=>{var h;let m=(0,t1.useMemo)(()=>new Cfe.Atom([]),[]),_=(h=o.toolbars)==null?void 0:h[l];(0,t1.useLayoutEffect)(()=>{let C=_==null?void 0:_(m.set.bind(m),de().publicApi);if(typeof C=="function")return C},[o,l,_]);let w=Rr(m.prism);return t1.default.createElement(Mfe,{config:w})},kfe=({toolbarId:o,showLeftDivider:l})=>{var h;let m=[],_=Rr(de().atomP.ephemeral.extensions.byId),w=!1;for(let[,C]of Object.entries(_))!C||!((h=C.toolbars)!=null&&h[o])||(m.push(t1.default.createElement(t1.default.Fragment,{key:"extensionToolbar-"+C.id},w?t1.default.createElement(_B,null):void 0,t1.default.createElement(Ife,{extension:C,toolbarId:o}))),w=!0);return m.length===0?null:t1.default.createElement(Pfe,{"data-testid":"theatre-extensionToolbar-".concat(o)},l?t1.default.createElement(_B,null):void 0,m)},bB=kfe}),uS,Dfe,Ofe,Lfe,Ffe,ZTe=P(()=>{Xt(),uS=K($e()),kA(),Ofe=me(aS)(Dfe||(Dfe=q([`
  color: `,`;

  border-bottom: 1px solid
    `,`;
`])),({pinned:o})=>o?"rgba(255, 255, 255, 0.8)":"#A8A8A9",({pinned:o})=>o?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.08)"),Lfe=(0,uS.forwardRef)((o,l)=>{var h=o,{children:m,hint:_,pinned:w,icon:C,pinHintIcon:R,unpinHintIcon:N}=h,F=X(h,["children","hint","pinned","icon","pinHintIcon","unpinHintIcon"]);let[U,$]=(0,uS.useState)(!1),j=U||_;return uS.default.createElement(Ofe,V(A({},F),{pinned:w,ref:l,onMouseOver:()=>$(!0),onMouseOut:()=>$(!1)}),uS.default.createElement("div",{style:{pointerEvents:"none",width:"fit-content",height:"fit-content",inset:0}},j&&!w?R:j&&w?N:C),m)}),Ffe=Lfe});function QTe(o){return SB.createElement("svg",A({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),SB.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.732 4.048l-.792-.792L7.2 8l4.74 4.744.792-.792L8.781 8l3.951-3.952zm-3.932 0l-.792-.792L3.268 8l4.74 4.744.792-.792L4.848 8 8.8 4.048z",fill:"currentColor"}))}var SB,Bfe,JTe=P(()=>{SB=K($e()),Bfe=QTe});function eMe(o){return wB.createElement("svg",A({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),wB.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.694 3.765l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.951-3.951-3.951-3.952zm3.932 0l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.952-3.951-3.952-3.952z",fill:"currentColor"}))}var wB,Ufe,tMe=P(()=>{wB=K($e()),Ufe=eMe}),sa,zfe,Vfe,Gfe,EB,jfe,H9,Hfe,Wfe,$fe,qfe,Xfe,Yfe,Kfe,Zfe,Qfe,NA,Jfe,epe,TB,MB,tpe,npe,nMe=P(()=>{ur(),Se(),sa=K($e()),Xt(),Vfe=me.div(zfe||(zfe=q([`
  width: 138px;
  border-radius: 2px;
  background-color: rgba(42, 45, 50, 0.9);
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.25), 0px 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  pointer-events: auto;
  // makes the edges of the item highlights match the rounded corners
  overflow: hidden;

  @supports not (backdrop-filter: blur()) {
    background-color: rgba(42, 45, 50, 0.98);
  }

  color: rgba(255, 255, 255, 0.9);

  & a {
    // Fix colors of links to not be default
    color: inherit;
  }
`]))),EB=me.div(Gfe||(Gfe=q([`
  position: relative;
  padding: 0px 12px;
  font-weight: 400;
  font-size: 11px;
  height: 32px;
  text-decoration: none;
  user-select: none;
  display: flex;
  flex-direction: row;
  align-items: center;
  cursor: default;
`]))),H9=me(EB)(jfe||(jfe=q([`
  &:before {
    position: absolute;
    display: block;
    content: ' ';
    inset: 3px;
    border-radius: 3px;
    background: rgba(255, 255, 255, 0.1);
    opacity: 0;
  }

  &.secondary {
    color: rgba(255, 255, 255, 0.5);
  }

  &:hover {
    /* background-color: #398995; */
    color: white !important;
    &:before {
      opacity: 1;
    }
  }
`]))),Wfe=me(EB)(Hfe||(Hfe=q([`
  height: auto;
  min-height: 32px;
  padding-top: 12px;
  padding-bottom: 10px;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  gap: 8px;
  color: rgba(255, 255, 255, 0.5);
`]))),qfe=me.div($fe||($fe=q([`
  font-weight: 600;
`]))),Yfe=me.div(Xfe||(Xfe=q([`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`]))),Zfe=me.div(Kfe||(Kfe=q([`
  margin-left: 2px;
`]))),NA=me.div(Qfe||(Qfe=q([`
  height: 1px;
  margin: 0 2px;
  background: rgba(255, 255, 255, 0.02);
`]))),epe=me.div(Jfe||(Jfe=q([`
  position: absolute;
  width: 8px;
  height: 8px;
  background: #40aaa4;
  right: 14px;
  top: 12px;
  border-radius: 50%;
`]))),TB="1.0.19",MB=TB.match(/^[^\-]+/)[0],tpe=sa.default.forwardRef((o,l)=>{let h=Rr(de().atomP.ahistoric.updateChecker.result.hasUpdates);return sa.default.createElement(Vfe,{ref:l},sa.default.createElement(H9,{as:"a",href:"https://www.theatrejs.com/docs/latest",className:"",target:"_blank"},"Docs"),sa.default.createElement(H9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases",className:"",target:"_blank"},"Changelog"),sa.default.createElement(NA,null),sa.default.createElement(H9,{as:"a",href:"https://github.com/theatre-js/theatre",className:"",target:"_blank"},"Github"),sa.default.createElement(H9,{as:"a",href:"https://twitter.com/theatre_js",className:"",target:"_blank"},"Twitter"),sa.default.createElement(H9,{className:"",as:"a",href:"https://discord.gg/bm9f8F9Y9N",target:"_blank"},"Discord"),sa.default.createElement(NA,null),sa.default.createElement(Wfe,null,sa.default.createElement(qfe,null,"Version"),sa.default.createElement(Yfe,null,sa.default.createElement(Zfe,null,TB," ",h===!0?"(outdated)":h===!1?"(latest)":""))),h===!0&&sa.default.createElement(sa.default.Fragment,null,sa.default.createElement(NA,null),sa.default.createElement(H9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases".concat(encodeURIComponent(MB)),className:"",target:"_blank"},"Update",sa.default.createElement(epe,null)),sa.default.createElement(H9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases#".concat(encodeURIComponent(MB)),className:"",target:"_blank"},"What's new?")))}),npe=tpe}),CB,DA,rpe,AB,ipe,spe,hS,ope,PB,ape,OA,dS,fS,W9,lpe,cpe,upe,V6,Uc,hpe,dpe,fpe,RB,rMe=P(()=>{CB=K($e(),1),DA=K($e(),1),rpe=o=>typeof o=="function",AB=(o,l)=>rpe(o)?o(l):o,ipe=(()=>{let o=0;return()=>(++o).toString()})(),spe=20,hS=new Map,ope=1e3,PB=o=>{if(hS.has(o))return;let l=setTimeout(()=>{hS.delete(o),W9({type:4,toastId:o})},ope);hS.set(o,l)},ape=o=>{let l=hS.get(o);l&&clearTimeout(l)},OA=(o,l)=>{switch(l.type){case 0:return V(A({},o),{toasts:[l.toast,...o.toasts].slice(0,spe)});case 1:return l.toast.id&&ape(l.toast.id),V(A({},o),{toasts:o.toasts.map(w=>w.id===l.toast.id?A(A({},w),l.toast):w)});case 2:let{toast:h}=l;return o.toasts.find(w=>w.id===h.id)?OA(o,{type:1,toast:h}):OA(o,{type:0,toast:h});case 3:let{toastId:m}=l;return m?PB(m):o.toasts.forEach(w=>{PB(w.id)}),V(A({},o),{toasts:o.toasts.map(w=>w.id===m||m===void 0?V(A({},w),{visible:!1}):w)});case 4:return l.toastId===void 0?V(A({},o),{toasts:[]}):V(A({},o),{toasts:o.toasts.filter(w=>w.id!==l.toastId)});case 5:return V(A({},o),{pausedAt:l.time});case 6:let _=l.time-(o.pausedAt||0);return V(A({},o),{pausedAt:void 0,toasts:o.toasts.map(w=>V(A({},w),{pauseDuration:w.pauseDuration+_}))})}},dS=[],fS={toasts:[],pausedAt:void 0},W9=o=>{fS=OA(fS,o),dS.forEach(l=>{l(fS)})},lpe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},cpe=(o={})=>{let[l,h]=(0,CB.useState)(fS);(0,CB.useEffect)(()=>(dS.push(h),()=>{let _=dS.indexOf(h);_>-1&&dS.splice(_,1)}),[l]);let m=l.toasts.map(_=>{var w,C;return V(A(A(A({},o),o[_.type]),_),{duration:_.duration||((w=o[_.type])==null?void 0:w.duration)||(o==null?void 0:o.duration)||lpe[_.type],style:A(A(A({},o.style),(C=o[_.type])==null?void 0:C.style),_.style)})});return V(A({},l),{toasts:m})},upe=(o,l="blank",h)=>V(A({createdAt:Date.now(),visible:!0,type:l,ariaProps:{role:"status","aria-live":"polite"},message:o,pauseDuration:0},h),{id:(h==null?void 0:h.id)||ipe()}),V6=o=>(l,h)=>{let m=upe(l,o,h);return W9({type:2,toast:m}),m.id},Uc=(o,l)=>V6("blank")(o,l),Uc.error=V6("error"),Uc.success=V6("success"),Uc.loading=V6("loading"),Uc.custom=V6("custom"),Uc.dismiss=o=>{W9({type:3,toastId:o})},Uc.remove=o=>W9({type:4,toastId:o}),Uc.promise=(o,l,h)=>{let m=Uc.loading(l.loading,A(A({},h),h==null?void 0:h.loading));return o.then(_=>(Uc.success(AB(l.success,_),A(A({id:m},h),h==null?void 0:h.success)),_)).catch(_=>{Uc.error(AB(l.error,_),A(A({id:m},h),h==null?void 0:h.error))}),o},hpe=(o,l)=>{W9({type:1,toast:{id:o,height:l}})},dpe=()=>{W9({type:5,time:Date.now()})},fpe=o=>{let{toasts:l,pausedAt:h}=cpe(o);(0,DA.useEffect)(()=>{if(h)return;let w=Date.now(),C=l.map(R=>{if(R.duration===1/0)return;let N=(R.duration||0)+R.pauseDuration-(w-R.createdAt);if(N<0){R.visible&&Uc.dismiss(R.id);return}return setTimeout(()=>Uc.dismiss(R.id),N)});return()=>{C.forEach(R=>R&&clearTimeout(R))}},[l,h]);let m=(0,DA.useCallback)(()=>{h&&W9({type:6,time:Date.now()})},[h]),_=(0,DA.useCallback)((w,C)=>{let{reverseOrder:R=!1,gutter:N=8,defaultPosition:F}=C||{},U=l.filter(G=>(G.position||F)===(w.position||F)&&G.height),$=U.findIndex(G=>G.id===w.id),j=U.filter((G,Y)=>Y<$&&G.visible).length;return U.filter(G=>G.visible).slice(...R?[j+1]:[0,j]).reduce((G,Y)=>G+(Y.height||0)+N,0)},[l]);return{toasts:l,handlers:{updateHeight:hpe,startPause:dpe,endPause:m,calculateOffset:_}}},RB=Uc});function ppe(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function iMe(o){x8=o}function Ha(o,l){if(l){if(Spe.test(o))return o.replace(wpe,IB)}else if(Epe.test(o))return o.replace(Tpe,IB);return o}function mpe(o){return o.replace(Cpe,(l,h)=>(h=h.toLowerCase(),h==="colon"?":":h.charAt(0)==="#"?h.charAt(1)==="x"?String.fromCharCode(parseInt(h.substring(2),16)):String.fromCharCode(+h.substring(1)):""))}function As(o,l){o=typeof o=="string"?o:o.source,l=l||"";let h={replace:(m,_)=>(_=_.source||_,_=_.replace(Ape,"$1"),o=o.replace(m,_),h),getRegex:()=>new RegExp(o,l)};return h}function gpe(o,l,h){if(o){let m;try{m=decodeURIComponent(mpe(h)).replace(Ppe,"").toLowerCase()}catch{return null}if(m.indexOf("javascript:")===0||m.indexOf("vbscript:")===0||m.indexOf("data:")===0)return null}l&&!Rpe.test(h)&&(h=sMe(l,h));try{h=encodeURI(h).replace(/%25/g,"%")}catch{return null}return h}function sMe(o,l){pS[" "+o]||(Ipe.test(o)?pS[" "+o]=o+"/":pS[" "+o]=LA(o,"/",!0)),o=pS[" "+o];let h=o.indexOf(":")===-1;return l.substring(0,2)==="//"?h?l:o.replace(kpe,"$1")+l:l.charAt(0)==="/"?h?l:o.replace(Npe,"$1")+l:o+l}function cf(o){let l=1,h,m;for(;l<arguments.length;l++){h=arguments[l];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&(o[m]=h[m])}return o}function vpe(o,l){let h=o.replace(/\|/g,(w,C,R)=>{let N=!1,F=C;for(;--F>=0&&R[F]==="\\";)N=!N;return N?"|":" |"}),m=h.split(/ \|/),_=0;if(m[0].trim()||m.shift(),m.length>0&&!m[m.length-1].trim()&&m.pop(),m.length>l)m.splice(l);else for(;m.length<l;)m.push("");for(;_<m.length;_++)m[_]=m[_].trim().replace(/\\\|/g,"|");return m}function LA(o,l,h){let m=o.length;if(m===0)return"";let _=0;for(;_<m;){let w=o.charAt(m-_-1);if(w===l&&!h)_++;else if(w!==l&&h)_++;else break}return o.slice(0,m-_)}function oMe(o,l){if(o.indexOf(l[1])===-1)return-1;let h=o.length,m=0,_=0;for(;_<h;_++)if(o[_]==="\\")_++;else if(o[_]===l[0])m++;else if(o[_]===l[1]&&(m--,m<0))return _;return-1}function ype(o){o&&o.sanitize&&!o.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function xpe(o,l){if(l<1)return"";let h="";for(;l>1;)l&1&&(h+=o),l>>=1,o+=o;return h+o}function _pe(o,l,h,m){let _=l.href,w=l.title?Ha(l.title):null,C=o[1].replace(/\\([\[\]])/g,"$1");if(o[0].charAt(0)!=="!"){m.state.inLink=!0;let R={type:"link",raw:h,href:_,title:w,text:C,tokens:m.inlineTokens(C)};return m.state.inLink=!1,R}return{type:"image",raw:h,href:_,title:w,text:Ha(C)}}function aMe(o,l){let h=o.match(/^(\s+)(?:```)/);if(h===null)return l;let m=h[1];return l.split(`
`).map(_=>{let w=_.match(/^\s+/);if(w===null)return _;let[C]=w;return C.length>=m.length?_.slice(m.length):_}).join(`
`)}function lMe(o){return o.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function bpe(o){let l="",h,m,_=o.length;for(h=0;h<_;h++)m=o.charCodeAt(h),Math.random()>.5&&(m="x"+m.toString(16)),l+="&#"+m+";";return l}function Ir(o,l,h){if(typeof o>"u"||o===null)throw new Error("marked(): input parameter is undefined or null");if(typeof o!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(o)+", string expected");if(typeof l=="function"&&(h=l,l=null),l=cf({},Ir.defaults,l||{}),ype(l),h){let _=l.highlight,w;try{w=_8.lex(o,l)}catch(N){return h(N)}let C=function(N){let F;if(!N)try{l.walkTokens&&Ir.walkTokens(w,l.walkTokens),F=$9.parse(w,l)}catch(U){N=U}return l.highlight=_,N?h(N):h(null,F)};if(!_||_.length<3||(delete l.highlight,!w.length))return C();let R=0;Ir.walkTokens(w,function(N){N.type==="code"&&(R++,setTimeout(()=>{_(N.text,N.lang,function(F,U){if(F)return C(F);U!=null&&U!==N.text&&(N.text=U,N.escaped=!0),R--,R===0&&C()})},0))}),R===0&&C();return}function m(_){if(_.message+=`
Please report this to https://github.com/markedjs/marked.`,l.silent)return"<p>An error occurred:</p><pre>"+Ha(_.message+"",!0)+"</pre>";throw _}try{let _=_8.lex(o,l);if(l.walkTokens){if(l.async)return Promise.all(Ir.walkTokens(_,l.walkTokens)).then(()=>$9.parse(_,l)).catch(m);Ir.walkTokens(_,l.walkTokens)}return $9.parse(_,l)}catch(_){m(_)}}var x8,Spe,wpe,Epe,Tpe,Mpe,IB,Cpe,Ape,Ppe,Rpe,pS,Ipe,kpe,Npe,mS,FA,xr,$n,_8,BA,kB,NB,$9,cMe=P(()=>{x8=ppe(),Spe=/[&<>"']/,wpe=/[&<>"']/g,Epe=/[<>"']|&(?!#?\w+;)/,Tpe=/[<>"']|&(?!#?\w+;)/g,Mpe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},IB=o=>Mpe[o],Cpe=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,Ape=/(^|[^\[])\^/g,Ppe=/[^\w:]/g,Rpe=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,pS={},Ipe=/^[^:]+:\/*[^/]*$/,kpe=/^([^:]+:)[\s\S]*$/,Npe=/^([^:]+:\/*[^/]*)[\s\S]*$/,mS={exec:function(){}},FA=class{constructor(o){this.options=o||x8}space(o){let l=this.rules.block.newline.exec(o);if(l&&l[0].length>0)return{type:"space",raw:l[0]}}code(o){let l=this.rules.block.code.exec(o);if(l){let h=l[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:l[0],codeBlockStyle:"indented",text:this.options.pedantic?h:LA(h,`
`)}}}fences(o){let l=this.rules.block.fences.exec(o);if(l){let h=l[0],m=aMe(h,l[3]||"");return{type:"code",raw:h,lang:l[2]?l[2].trim():l[2],text:m}}}heading(o){let l=this.rules.block.heading.exec(o);if(l){let h=l[2].trim();if(/#$/.test(h)){let m=LA(h,"#");(this.options.pedantic||!m||/ $/.test(m))&&(h=m.trim())}return{type:"heading",raw:l[0],depth:l[1].length,text:h,tokens:this.lexer.inline(h)}}}hr(o){let l=this.rules.block.hr.exec(o);if(l)return{type:"hr",raw:l[0]}}blockquote(o){let l=this.rules.block.blockquote.exec(o);if(l){let h=l[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:l[0],tokens:this.lexer.blockTokens(h,[]),text:h}}}list(o){let l=this.rules.block.list.exec(o);if(l){let h,m,_,w,C,R,N,F,U,$,j,G,Y=l[1].trim(),Z=Y.length>1,ne={type:"list",raw:"",ordered:Z,start:Z?+Y.slice(0,-1):"",loose:!1,items:[]};Y=Z?"\\d{1,9}\\".concat(Y.slice(-1)):"\\".concat(Y),this.options.pedantic&&(Y=Z?Y:"[*+-]");let ae=new RegExp("^( {0,3}".concat(Y,")((?:[	 ][^\\n]*)?(?:\\n|$))"));for(;o&&(G=!1,!(!(l=ae.exec(o))||this.rules.block.hr.test(o)));){if(h=l[0],o=o.substring(h.length),F=l[2].split(`
`,1)[0],U=o.split(`
`,1)[0],this.options.pedantic?(w=2,j=F.trimLeft()):(w=l[2].search(/[^ ]/),w=w>4?1:w,j=F.slice(w),w+=l[1].length),R=!1,!F&&/^ *$/.test(U)&&(h+=U+`
`,o=o.substring(U.length+1),G=!0),!G){let ve=new RegExp("^ {0,".concat(Math.min(3,w-1),"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))")),Me=new RegExp("^ {0,".concat(Math.min(3,w-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),Te=new RegExp("^ {0,".concat(Math.min(3,w-1),"}(?:```|~~~)")),_e=new RegExp("^ {0,".concat(Math.min(3,w-1),"}#"));for(;o&&($=o.split(`
`,1)[0],F=$,this.options.pedantic&&(F=F.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(Te.test(F)||_e.test(F)||ve.test(F)||Me.test(o)));){if(F.search(/[^ ]/)>=w||!F.trim())j+=`
`+F.slice(w);else if(!R)j+=`
`+F;else break;!R&&!F.trim()&&(R=!0),h+=$+`
`,o=o.substring($.length+1)}}ne.loose||(N?ne.loose=!0:/\n *\n *$/.test(h)&&(N=!0)),this.options.gfm&&(m=/^\[[ xX]\] /.exec(j),m&&(_=m[0]!=="[ ] ",j=j.replace(/^\[[ xX]\] +/,""))),ne.items.push({type:"list_item",raw:h,task:!!m,checked:_,loose:!1,text:j}),ne.raw+=h}ne.items[ne.items.length-1].raw=h.trimRight(),ne.items[ne.items.length-1].text=j.trimRight(),ne.raw=ne.raw.trimRight();let ce=ne.items.length;for(C=0;C<ce;C++){this.lexer.state.top=!1,ne.items[C].tokens=this.lexer.blockTokens(ne.items[C].text,[]);let ve=ne.items[C].tokens.filter(Te=>Te.type==="space"),Me=ve.every(Te=>{let _e=Te.raw.split(""),it=0;for(let Re of _e)if(Re===`
`&&(it+=1),it>1)return!0;return!1});!ne.loose&&ve.length&&Me&&(ne.loose=!0,ne.items[C].loose=!0)}return ne}}html(o){let l=this.rules.block.html.exec(o);if(l){let h={type:"html",raw:l[0],pre:!this.options.sanitizer&&(l[1]==="pre"||l[1]==="script"||l[1]==="style"),text:l[0]};if(this.options.sanitize){let m=this.options.sanitizer?this.options.sanitizer(l[0]):Ha(l[0]);h.type="paragraph",h.text=m,h.tokens=this.lexer.inline(m)}return h}}def(o){let l=this.rules.block.def.exec(o);if(l)return l[3]&&(l[3]=l[3].substring(1,l[3].length-1)),{type:"def",tag:l[1].toLowerCase().replace(/\s+/g," "),raw:l[0],href:l[2],title:l[3]}}table(o){let l=this.rules.block.table.exec(o);if(l){let h={type:"table",header:vpe(l[1]).map(m=>({text:m})),align:l[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:l[3]&&l[3].trim()?l[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(h.header.length===h.align.length){h.raw=l[0];let m=h.align.length,_,w,C,R;for(_=0;_<m;_++)/^ *-+: *$/.test(h.align[_])?h.align[_]="right":/^ *:-+: *$/.test(h.align[_])?h.align[_]="center":/^ *:-+ *$/.test(h.align[_])?h.align[_]="left":h.align[_]=null;for(m=h.rows.length,_=0;_<m;_++)h.rows[_]=vpe(h.rows[_],h.header.length).map(N=>({text:N}));for(m=h.header.length,w=0;w<m;w++)h.header[w].tokens=this.lexer.inline(h.header[w].text);for(m=h.rows.length,w=0;w<m;w++)for(R=h.rows[w],C=0;C<R.length;C++)R[C].tokens=this.lexer.inline(R[C].text);return h}}}lheading(o){let l=this.rules.block.lheading.exec(o);if(l)return{type:"heading",raw:l[0],depth:l[2].charAt(0)==="="?1:2,text:l[1],tokens:this.lexer.inline(l[1])}}paragraph(o){let l=this.rules.block.paragraph.exec(o);if(l){let h=l[1].charAt(l[1].length-1)===`
`?l[1].slice(0,-1):l[1];return{type:"paragraph",raw:l[0],text:h,tokens:this.lexer.inline(h)}}}text(o){let l=this.rules.block.text.exec(o);if(l)return{type:"text",raw:l[0],text:l[0],tokens:this.lexer.inline(l[0])}}escape(o){let l=this.rules.inline.escape.exec(o);if(l)return{type:"escape",raw:l[0],text:Ha(l[1])}}tag(o){let l=this.rules.inline.tag.exec(o);if(l)return!this.lexer.state.inLink&&/^<a /i.test(l[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(l[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(l[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(l[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:l[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(l[0]):Ha(l[0]):l[0]}}link(o){let l=this.rules.inline.link.exec(o);if(l){let h=l[2].trim();if(!this.options.pedantic&&/^</.test(h)){if(!/>$/.test(h))return;let w=LA(h.slice(0,-1),"\\");if((h.length-w.length)%2===0)return}else{let w=oMe(l[2],"()");if(w>-1){let C=(l[0].indexOf("!")===0?5:4)+l[1].length+w;l[2]=l[2].substring(0,w),l[0]=l[0].substring(0,C).trim(),l[3]=""}}let m=l[2],_="";if(this.options.pedantic){let w=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(m);w&&(m=w[1],_=w[3])}else _=l[3]?l[3].slice(1,-1):"";return m=m.trim(),/^</.test(m)&&(this.options.pedantic&&!/>$/.test(h)?m=m.slice(1):m=m.slice(1,-1)),_pe(l,{href:m&&m.replace(this.rules.inline._escapes,"$1"),title:_&&_.replace(this.rules.inline._escapes,"$1")},l[0],this.lexer)}}reflink(o,l){let h;if((h=this.rules.inline.reflink.exec(o))||(h=this.rules.inline.nolink.exec(o))){let m=(h[2]||h[1]).replace(/\s+/g," ");if(m=l[m.toLowerCase()],!m||!m.href){let _=h[0].charAt(0);return{type:"text",raw:_,text:_}}return _pe(h,m,h[0],this.lexer)}}emStrong(o,l,h=""){let m=this.rules.inline.emStrong.lDelim.exec(o);if(!m||m[3]&&h.match(/[\p{L}\p{N}]/u))return;let _=m[1]||m[2]||"";if(!_||_&&(h===""||this.rules.inline.punctuation.exec(h))){let w=m[0].length-1,C,R,N=w,F=0,U=m[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(U.lastIndex=0,l=l.slice(-1*o.length+w);(m=U.exec(l))!=null;){if(C=m[1]||m[2]||m[3]||m[4]||m[5]||m[6],!C)continue;if(R=C.length,m[3]||m[4]){N+=R;continue}else if((m[5]||m[6])&&w%3&&!((w+R)%3)){F+=R;continue}if(N-=R,N>0)continue;if(R=Math.min(R,R+N+F),Math.min(w,R)%2){let j=o.slice(1,w+m.index+R);return{type:"em",raw:o.slice(0,w+m.index+R+1),text:j,tokens:this.lexer.inlineTokens(j)}}let $=o.slice(2,w+m.index+R-1);return{type:"strong",raw:o.slice(0,w+m.index+R+1),text:$,tokens:this.lexer.inlineTokens($)}}}}codespan(o){let l=this.rules.inline.code.exec(o);if(l){let h=l[2].replace(/\n/g," "),m=/[^ ]/.test(h),_=/^ /.test(h)&&/ $/.test(h);return m&&_&&(h=h.substring(1,h.length-1)),h=Ha(h,!0),{type:"codespan",raw:l[0],text:h}}}br(o){let l=this.rules.inline.br.exec(o);if(l)return{type:"br",raw:l[0]}}del(o){let l=this.rules.inline.del.exec(o);if(l)return{type:"del",raw:l[0],text:l[2],tokens:this.lexer.inlineTokens(l[2])}}autolink(o,l){let h=this.rules.inline.autolink.exec(o);if(h){let m,_;return h[2]==="@"?(m=Ha(this.options.mangle?l(h[1]):h[1]),_="mailto:"+m):(m=Ha(h[1]),_=m),{type:"link",raw:h[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}url(o,l){let h;if(h=this.rules.inline.url.exec(o)){let m,_;if(h[2]==="@")m=Ha(this.options.mangle?l(h[0]):h[0]),_="mailto:"+m;else{let w;do w=h[0],h[0]=this.rules.inline._backpedal.exec(h[0])[0];while(w!==h[0]);m=Ha(h[0]),h[1]==="www."?_="http://"+m:_=m}return{type:"link",raw:h[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}inlineText(o,l){let h=this.rules.inline.text.exec(o);if(h){let m;return this.lexer.state.inRawBlock?m=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(h[0]):Ha(h[0]):h[0]:m=Ha(this.options.smartypants?l(h[0]):h[0]),{type:"text",raw:h[0],text:m}}}},xr={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:mS,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/},xr._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,xr._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,xr.def=As(xr.def).replace("label",xr._label).replace("title",xr._title).getRegex(),xr.bullet=/(?:[*+-]|\d{1,9}[.)])/,xr.listItemStart=As(/^( *)(bull) */).replace("bull",xr.bullet).getRegex(),xr.list=As(xr.list).replace(/bull/g,xr.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+xr.def.source+")").getRegex(),xr._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",xr._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,xr.html=As(xr.html,"i").replace("comment",xr._comment).replace("tag",xr._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),xr.paragraph=As(xr._paragraph).replace("hr",xr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xr._tag).getRegex(),xr.blockquote=As(xr.blockquote).replace("paragraph",xr.paragraph).getRegex(),xr.normal=cf({},xr),xr.gfm=cf({},xr.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),xr.gfm.table=As(xr.gfm.table).replace("hr",xr.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xr._tag).getRegex(),xr.gfm.paragraph=As(xr._paragraph).replace("hr",xr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",xr.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xr._tag).getRegex(),xr.pedantic=cf({},xr.normal,{html:As(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",xr._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:mS,paragraph:As(xr.normal._paragraph).replace("hr",xr.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xr.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),$n={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:mS,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:mS,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/},$n._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",$n.punctuation=As($n.punctuation).replace(/punctuation/g,$n._punctuation).getRegex(),$n.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,$n.escapedEmSt=/\\\*|\\_/g,$n._comment=As(xr._comment).replace("(?:-->|$)","-->").getRegex(),$n.emStrong.lDelim=As($n.emStrong.lDelim).replace(/punct/g,$n._punctuation).getRegex(),$n.emStrong.rDelimAst=As($n.emStrong.rDelimAst,"g").replace(/punct/g,$n._punctuation).getRegex(),$n.emStrong.rDelimUnd=As($n.emStrong.rDelimUnd,"g").replace(/punct/g,$n._punctuation).getRegex(),$n._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,$n._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,$n._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,$n.autolink=As($n.autolink).replace("scheme",$n._scheme).replace("email",$n._email).getRegex(),$n._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,$n.tag=As($n.tag).replace("comment",$n._comment).replace("attribute",$n._attribute).getRegex(),$n._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,$n._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,$n._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,$n.link=As($n.link).replace("label",$n._label).replace("href",$n._href).replace("title",$n._title).getRegex(),$n.reflink=As($n.reflink).replace("label",$n._label).replace("ref",xr._label).getRegex(),$n.nolink=As($n.nolink).replace("ref",xr._label).getRegex(),$n.reflinkSearch=As($n.reflinkSearch,"g").replace("reflink",$n.reflink).replace("nolink",$n.nolink).getRegex(),$n.normal=cf({},$n),$n.pedantic=cf({},$n.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:As(/^!?\[(label)\]\((.*?)\)/).replace("label",$n._label).getRegex(),reflink:As(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",$n._label).getRegex()}),$n.gfm=cf({},$n.normal,{escape:As($n.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),$n.gfm.url=As($n.gfm.url,"i").replace("email",$n.gfm._extended_email).getRegex(),$n.breaks=cf({},$n.gfm,{br:As($n.br).replace("{2,}","*").getRegex(),text:As($n.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),_8=class Ij{constructor(l){this.tokens=[],this.tokens.links=Object.create(null),this.options=l||x8,this.options.tokenizer=this.options.tokenizer||new FA,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let h={block:xr.normal,inline:$n.normal};this.options.pedantic?(h.block=xr.pedantic,h.inline=$n.pedantic):this.options.gfm&&(h.block=xr.gfm,this.options.breaks?h.inline=$n.breaks:h.inline=$n.gfm),this.tokenizer.rules=h}static get rules(){return{block:xr,inline:$n}}static lex(l,h){return new Ij(h).lex(l)}static lexInline(l,h){return new Ij(h).inlineTokens(l)}lex(l){l=l.replace(/\r\n|\r/g,`
`),this.blockTokens(l,this.tokens);let h;for(;h=this.inlineQueue.shift();)this.inlineTokens(h.src,h.tokens);return this.tokens}blockTokens(l,h=[]){this.options.pedantic?l=l.replace(/\t/g,"    ").replace(/^ +$/gm,""):l=l.replace(/^( *)(\t+)/gm,(R,N,F)=>N+"    ".repeat(F.length));let m,_,w,C;for(;l;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(R=>(m=R.call({lexer:this},l,h))?(l=l.substring(m.raw.length),h.push(m),!0):!1))){if(m=this.tokenizer.space(l)){l=l.substring(m.raw.length),m.raw.length===1&&h.length>0?h[h.length-1].raw+=`
`:h.push(m);continue}if(m=this.tokenizer.code(l)){l=l.substring(m.raw.length),_=h[h.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue[this.inlineQueue.length-1].src=_.text):h.push(m);continue}if(m=this.tokenizer.fences(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.heading(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.hr(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.blockquote(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.list(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.html(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.def(l)){l=l.substring(m.raw.length),_=h[h.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.raw,this.inlineQueue[this.inlineQueue.length-1].src=_.text):this.tokens.links[m.tag]||(this.tokens.links[m.tag]={href:m.href,title:m.title});continue}if(m=this.tokenizer.table(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.lheading(l)){l=l.substring(m.raw.length),h.push(m);continue}if(w=l,this.options.extensions&&this.options.extensions.startBlock){let R=1/0,N=l.slice(1),F;this.options.extensions.startBlock.forEach(function(U){F=U.call({lexer:this},N),typeof F=="number"&&F>=0&&(R=Math.min(R,F))}),R<1/0&&R>=0&&(w=l.substring(0,R+1))}if(this.state.top&&(m=this.tokenizer.paragraph(w))){_=h[h.length-1],C&&_.type==="paragraph"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):h.push(m),C=w.length!==l.length,l=l.substring(m.raw.length);continue}if(m=this.tokenizer.text(l)){l=l.substring(m.raw.length),_=h[h.length-1],_&&_.type==="text"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):h.push(m);continue}if(l){let R="Infinite loop on byte: "+l.charCodeAt(0);if(this.options.silent){console.error(R);break}else throw new Error(R)}}return this.state.top=!0,h}inline(l,h=[]){return this.inlineQueue.push({src:l,tokens:h}),h}inlineTokens(l,h=[]){let m,_,w,C=l,R,N,F;if(this.tokens.links){let U=Object.keys(this.tokens.links);if(U.length>0)for(;(R=this.tokenizer.rules.inline.reflinkSearch.exec(C))!=null;)U.includes(R[0].slice(R[0].lastIndexOf("[")+1,-1))&&(C=C.slice(0,R.index)+"["+xpe("a",R[0].length-2)+"]"+C.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(R=this.tokenizer.rules.inline.blockSkip.exec(C))!=null;)C=C.slice(0,R.index)+"["+xpe("a",R[0].length-2)+"]"+C.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(R=this.tokenizer.rules.inline.escapedEmSt.exec(C))!=null;)C=C.slice(0,R.index)+"++"+C.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;l;)if(N||(F=""),N=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(U=>(m=U.call({lexer:this},l,h))?(l=l.substring(m.raw.length),h.push(m),!0):!1))){if(m=this.tokenizer.escape(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.tag(l)){l=l.substring(m.raw.length),_=h[h.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):h.push(m);continue}if(m=this.tokenizer.link(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.reflink(l,this.tokens.links)){l=l.substring(m.raw.length),_=h[h.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):h.push(m);continue}if(m=this.tokenizer.emStrong(l,C,F)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.codespan(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.br(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.del(l)){l=l.substring(m.raw.length),h.push(m);continue}if(m=this.tokenizer.autolink(l,bpe)){l=l.substring(m.raw.length),h.push(m);continue}if(!this.state.inLink&&(m=this.tokenizer.url(l,bpe))){l=l.substring(m.raw.length),h.push(m);continue}if(w=l,this.options.extensions&&this.options.extensions.startInline){let U=1/0,$=l.slice(1),j;this.options.extensions.startInline.forEach(function(G){j=G.call({lexer:this},$),typeof j=="number"&&j>=0&&(U=Math.min(U,j))}),U<1/0&&U>=0&&(w=l.substring(0,U+1))}if(m=this.tokenizer.inlineText(w,lMe)){l=l.substring(m.raw.length),m.raw.slice(-1)!=="_"&&(F=m.raw.slice(-1)),N=!0,_=h[h.length-1],_&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):h.push(m);continue}if(l){let U="Infinite loop on byte: "+l.charCodeAt(0);if(this.options.silent){console.error(U);break}else throw new Error(U)}}return h}},BA=class{constructor(o){this.options=o||x8}code(o,l,h){let m=(l||"").match(/\S*/)[0];if(this.options.highlight){let _=this.options.highlight(o,m);_!=null&&_!==o&&(h=!0,o=_)}return o=o.replace(/\n$/,"")+`
`,m?'<pre><code class="'+this.options.langPrefix+Ha(m,!0)+'">'+(h?o:Ha(o,!0))+`</code></pre>
`:"<pre><code>"+(h?o:Ha(o,!0))+`</code></pre>
`}blockquote(o){return`<blockquote>
`.concat(o,`</blockquote>
`)}html(o){return o}heading(o,l,h,m){if(this.options.headerIds){let _=this.options.headerPrefix+m.slug(h);return"<h".concat(l,' id="').concat(_,'">').concat(o,"</h").concat(l,`>
`)}return"<h".concat(l,">").concat(o,"</h").concat(l,`>
`)}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(o,l,h){let m=l?"ol":"ul",_=l&&h!==1?' start="'+h+'"':"";return"<"+m+_+`>
`+o+"</"+m+`>
`}listitem(o){return"<li>".concat(o,`</li>
`)}checkbox(o){return"<input "+(o?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(o){return"<p>".concat(o,`</p>
`)}table(o,l){return l&&(l="<tbody>".concat(l,"</tbody>")),`<table>
<thead>
`+o+`</thead>
`+l+`</table>
`}tablerow(o){return`<tr>
`.concat(o,`</tr>
`)}tablecell(o,l){let h=l.header?"th":"td";return(l.align?"<".concat(h,' align="').concat(l.align,'">'):"<".concat(h,">"))+o+"</".concat(h,`>
`)}strong(o){return"<strong>".concat(o,"</strong>")}em(o){return"<em>".concat(o,"</em>")}codespan(o){return"<code>".concat(o,"</code>")}br(){return this.options.xhtml?"<br/>":"<br>"}del(o){return"<del>".concat(o,"</del>")}link(o,l,h){if(o=gpe(this.options.sanitize,this.options.baseUrl,o),o===null)return h;let m='<a href="'+Ha(o)+'"';return l&&(m+=' title="'+l+'"'),m+=">"+h+"</a>",m}image(o,l,h){if(o=gpe(this.options.sanitize,this.options.baseUrl,o),o===null)return h;let m='<img src="'.concat(o,'" alt="').concat(h,'"');return l&&(m+=' title="'.concat(l,'"')),m+=this.options.xhtml?"/>":">",m}text(o){return o}},kB=class{strong(o){return o}em(o){return o}codespan(o){return o}del(o){return o}html(o){return o}text(o){return o}link(o,l,h){return""+h}image(o,l,h){return""+h}br(){return""}},NB=class{constructor(){this.seen={}}serialize(o){return o.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(o,l){let h=o,m=0;if(this.seen.hasOwnProperty(h)){m=this.seen[o];do m++,h=o+"-"+m;while(this.seen.hasOwnProperty(h))}return l||(this.seen[o]=m,this.seen[h]=0),h}slug(o,l={}){let h=this.serialize(o);return this.getNextSafeSlug(h,l.dryrun)}},$9=class kj{constructor(l){this.options=l||x8,this.options.renderer=this.options.renderer||new BA,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new kB,this.slugger=new NB}static parse(l,h){return new kj(h).parse(l)}static parseInline(l,h){return new kj(h).parseInline(l)}parse(l,h=!0){let m="",_,w,C,R,N,F,U,$,j,G,Y,Z,ne,ae,ce,ve,Me,Te,_e,it=l.length;for(_=0;_<it;_++){if(G=l[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[G.type]&&(_e=this.options.extensions.renderers[G.type].call({parser:this},G),_e!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(G.type))){m+=_e||"";continue}switch(G.type){case"space":continue;case"hr":{m+=this.renderer.hr();continue}case"heading":{m+=this.renderer.heading(this.parseInline(G.tokens),G.depth,mpe(this.parseInline(G.tokens,this.textRenderer)),this.slugger);continue}case"code":{m+=this.renderer.code(G.text,G.lang,G.escaped);continue}case"table":{for($="",U="",R=G.header.length,w=0;w<R;w++)U+=this.renderer.tablecell(this.parseInline(G.header[w].tokens),{header:!0,align:G.align[w]});for($+=this.renderer.tablerow(U),j="",R=G.rows.length,w=0;w<R;w++){for(F=G.rows[w],U="",N=F.length,C=0;C<N;C++)U+=this.renderer.tablecell(this.parseInline(F[C].tokens),{header:!1,align:G.align[C]});j+=this.renderer.tablerow(U)}m+=this.renderer.table($,j);continue}case"blockquote":{j=this.parse(G.tokens),m+=this.renderer.blockquote(j);continue}case"list":{for(Y=G.ordered,Z=G.start,ne=G.loose,R=G.items.length,j="",w=0;w<R;w++)ce=G.items[w],ve=ce.checked,Me=ce.task,ae="",ce.task&&(Te=this.renderer.checkbox(ve),ne?ce.tokens.length>0&&ce.tokens[0].type==="paragraph"?(ce.tokens[0].text=Te+" "+ce.tokens[0].text,ce.tokens[0].tokens&&ce.tokens[0].tokens.length>0&&ce.tokens[0].tokens[0].type==="text"&&(ce.tokens[0].tokens[0].text=Te+" "+ce.tokens[0].tokens[0].text)):ce.tokens.unshift({type:"text",text:Te}):ae+=Te),ae+=this.parse(ce.tokens,ne),j+=this.renderer.listitem(ae,Me,ve);m+=this.renderer.list(j,Y,Z);continue}case"html":{m+=this.renderer.html(G.text);continue}case"paragraph":{m+=this.renderer.paragraph(this.parseInline(G.tokens));continue}case"text":{for(j=G.tokens?this.parseInline(G.tokens):G.text;_+1<it&&l[_+1].type==="text";)G=l[++_],j+=`
`+(G.tokens?this.parseInline(G.tokens):G.text);m+=h?this.renderer.paragraph(j):j;continue}default:{let Re='Token with "'+G.type+'" type was not found.';if(this.options.silent){console.error(Re);return}else throw new Error(Re)}}}return m}parseInline(l,h){h=h||this.renderer;let m="",_,w,C,R=l.length;for(_=0;_<R;_++){if(w=l[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[w.type]&&(C=this.options.extensions.renderers[w.type].call({parser:this},w),C!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(w.type))){m+=C||"";continue}switch(w.type){case"escape":{m+=h.text(w.text);break}case"html":{m+=h.html(w.text);break}case"link":{m+=h.link(w.href,w.title,this.parseInline(w.tokens,h));break}case"image":{m+=h.image(w.href,w.title,w.text);break}case"strong":{m+=h.strong(this.parseInline(w.tokens,h));break}case"em":{m+=h.em(this.parseInline(w.tokens,h));break}case"codespan":{m+=h.codespan(w.text);break}case"br":{m+=h.br();break}case"del":{m+=h.del(this.parseInline(w.tokens,h));break}case"text":{m+=h.text(w.text);break}default:{let N='Token with "'+w.type+'" type was not found.';if(this.options.silent){console.error(N);return}else throw new Error(N)}}}return m}},Ir.options=Ir.setOptions=function(o){return cf(Ir.defaults,o),iMe(Ir.defaults),Ir},Ir.getDefaults=ppe,Ir.defaults=x8,Ir.use=function(...o){let l=cf({},...o),h=Ir.defaults.extensions||{renderers:{},childTokens:{}},m;o.forEach(_=>{if(_.extensions&&(m=!0,_.extensions.forEach(w=>{if(!w.name)throw new Error("extension name required");if(w.renderer){let C=h.renderers?h.renderers[w.name]:null;C?h.renderers[w.name]=function(...R){let N=w.renderer.apply(this,R);return N===!1&&(N=C.apply(this,R)),N}:h.renderers[w.name]=w.renderer}if(w.tokenizer){if(!w.level||w.level!=="block"&&w.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");h[w.level]?h[w.level].unshift(w.tokenizer):h[w.level]=[w.tokenizer],w.start&&(w.level==="block"?h.startBlock?h.startBlock.push(w.start):h.startBlock=[w.start]:w.level==="inline"&&(h.startInline?h.startInline.push(w.start):h.startInline=[w.start]))}w.childTokens&&(h.childTokens[w.name]=w.childTokens)})),_.renderer){let w=Ir.defaults.renderer||new BA;for(let C in _.renderer){let R=w[C];w[C]=(...N)=>{let F=_.renderer[C].apply(w,N);return F===!1&&(F=R.apply(w,N)),F}}l.renderer=w}if(_.tokenizer){let w=Ir.defaults.tokenizer||new FA;for(let C in _.tokenizer){let R=w[C];w[C]=(...N)=>{let F=_.tokenizer[C].apply(w,N);return F===!1&&(F=R.apply(w,N)),F}}l.tokenizer=w}if(_.walkTokens){let w=Ir.defaults.walkTokens;l.walkTokens=function(C){let R=[];return R.push(_.walkTokens.call(this,C)),w&&(R=R.concat(w.call(this,C))),R}}m&&(l.extensions=h),Ir.setOptions(l)})},Ir.walkTokens=function(o,l){let h=[];for(let m of o)switch(h=h.concat(l.call(Ir,m)),m.type){case"table":{for(let _ of m.header)h=h.concat(Ir.walkTokens(_.tokens,l));for(let _ of m.rows)for(let w of _)h=h.concat(Ir.walkTokens(w.tokens,l));break}case"list":{h=h.concat(Ir.walkTokens(m.items,l));break}default:Ir.defaults.extensions&&Ir.defaults.extensions.childTokens&&Ir.defaults.extensions.childTokens[m.type]?Ir.defaults.extensions.childTokens[m.type].forEach(function(_){h=h.concat(Ir.walkTokens(m[_],l))}):m.tokens&&(h=h.concat(Ir.walkTokens(m.tokens,l)))}return h},Ir.parseInline=function(o,l){if(typeof o>"u"||o===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof o!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(o)+", string expected");l=cf({},Ir.defaults,l||{}),ype(l);try{let h=_8.lexInline(o,l);return l.walkTokens&&Ir.walkTokens(h,l.walkTokens),$9.parseInline(h,l)}catch(h){if(h.message+=`
Please report this to https://github.com/markedjs/marked.`,l.silent)return"<p>An error occurred:</p><pre>"+Ha(h.message+"",!0)+"</pre>";throw h}},Ir.Parser=$9,Ir.parser=$9.parse,Ir.Renderer=BA,Ir.TextRenderer=kB,Ir.Lexer=_8,Ir.lexer=_8.lex,Ir.Tokenizer=FA,Ir.Slugger=NB,Ir.parse=Ir,Ir.options,Ir.setOptions,Ir.use,Ir.walkTokens,Ir.parseInline,$9.parse,_8.lex}),Zl,UA,zA,DB,Dpe,Ope,Lpe,OB,Fpe,Bpe,Upe,LB,zpe,Vpe,Gpe,jpe,Hpe,gS,VA,Wpe,$pe,qpe,Xpe,Ype,Kpe,Zpe,FB,BB=P(()=>{Zl=K($e()),rMe(),Xt(),$i(),ur(),cMe(),UC(),nfe(),UA=({title:o,message:l})=>"".concat(o," ").concat(l),zA=(()=>{let o=new Map;return{add:l=>{let h=UA(l);o.has(h)?o.set(h,o.get(h)+1):o.set(h,1)},delete:l=>{let h=UA(l);o.has(h)&&o.get(h)>1?o.set(h,o.get(h)-1):o.delete(h)},clear:()=>{o.clear()},check:l=>o.has(UA(l))}})(),DB=(()=>{let o=new Map;return{add:l=>{o.has(l)?o.set(l,o.get(l)+1):o.set(l,1)},delete:l=>{o.has(l)&&o.get(l)>1?o.set(l,o.get(l)-1):o.delete(l)},clear:()=>{o.clear()},check:l=>o.has(l),get types(){return Array.of(...o.keys())}}})(),Ope=me.div(Dpe||(Dpe=q([`
  width: 100%;
  border-radius: 4px;
  display: flex;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Ni),OB=me.div(Lpe||(Lpe=q([`
  font-size: 14px;
  font-weight: bold;
  color: #fff;
`]))),Bpe=me.div(Fpe||(Fpe=q([`
  flex: 1;
  flex-direction: column;
  width: 0;
  display: flex;
  padding: 16px 0;
  gap: 12px;
`]))),LB=me.div(Upe||(Upe=q([`
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;

  a {
    color: rgba(255, 255, 255, 0.9);
  }

  em {
    font-style: italic;
  }

  strong {
    font-weight: bold;
    color: #d5d5d5;
  }

  p {
    margin-bottom: 8px;
  }

  code {
    font-family: monospace;
    background: rgba(0, 0, 0, 0.3);
    padding: 1px 1px 2px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    white-space: pre-wrap;
  }

  pre > code {
    white-space: pre;
    display: block;
    overflow: auto;
    padding: 4px;
  }

  pre {
    white-space: pre-wrap;
    margin-bottom: 8px;
  }
`]))),Vpe=me.button(zpe||(zpe=q([`
  color: rgba(255, 255, 255, 0.9);
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  padding-left: 12px;
  padding-right: 12px;
  border-left: 1px solid rgba(255, 255, 255, 0.05);

  &:hover {
    background: rgba(255, 255, 255, 0.05);
  }
`]))),Gpe={info:"#3b82f6",success:"#10b981",warning:"#f59e0b",error:"#ef4444"},Hpe=me.div(jpe||(jpe=q([`
  display: flex;
  justify-content: center;
  margin-left: 12px;
  padding-top: 21px;

  ::before {
    content: '';
    width: 8px;
    height: 8px;
    border-radius: 999999px;
    background-color: `,`;
  }
`])),({type:o})=>Gpe[o]),gS=o=>(l,h,m=[],_=!1)=>{(_||!zA.check({title:l,message:h}))&&(zA.add({title:l,message:h}),DB.add(o),RB.custom(w=>Zl.default.createElement(Ope,null,Zl.default.createElement(Hpe,{type:o}),Zl.default.createElement(Bpe,null,Zl.default.createElement(OB,null,l),Zl.default.createElement(LB,{dangerouslySetInnerHTML:{__html:Ir.parse(h)}}),m.length>0&&Zl.default.createElement(LB,null,Zl.default.createElement("span",null,"Docs:"," ",m.map((C,R)=>Zl.default.createElement(Zl.Fragment,{key:R},R>0&&", ",Zl.default.createElement("a",{target:"_blank",href:C.url},C.title)))))),Zl.default.createElement(Vpe,{onClick:()=>{RB.remove(w.id),zA.delete({title:l,message:h}),DB.delete(o)}},"Close")),{duration:1/0}))},VA={warning:gS("warning"),success:gS("success"),info:gS("info"),error:gS("error")},me.div(Wpe||(Wpe=q([`
  display: flex;
  justify-content: `,`;
  gap: 12px;
`])),({align:o})=>o==="center"?"center":"flex-end"),me.button($pe||($pe=q([`
  position: relative;
  border-radius: 4px;
  display: flex;
  align-items: center;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border: none;
  padding: 12px;
  color: #fff;
  overflow: hidden;

  ::before {
    content: '';
    position: absolute;
    inset: 0;
  }

  :hover::before {
    background: `,`;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Ni,({danger:o})=>o?"rgba(255, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"),me.div(qpe||(qpe=q([`
  z-index: 10;
  display: flex;
  flex-direction: column;
  gap: 8px;
  position: fixed;
  right: 92px;
  top: 50px;
  width: 500px;
  height: 85vh;
  min-height: 400px;
`]))),me.div(Xpe||(Xpe=q([`
  overflow: hidden;
  pointer-events: auto;
  border-radius: 4px;

  & > div {
    display: flex;
    flex-direction: column-reverse;
    gap: 8px;
    overflow: scroll;
    height: 100%;
  }
`]))),Kpe=me.div(Ype||(Ype=q([`
  width: fit-content;
  padding: 8px;
  border-radius: 4px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;
`]))),Zpe=()=>{let{hasNotifications:o}=FB();return FC({enabled:!o},()=>Zl.default.createElement(gB,null,Zl.default.createElement(Kpe,null,Zl.default.createElement(OB,null,"No notifications"),"Notifications will appear here when you get them.")))},FB=()=>{let{toasts:o}=fpe();return{hasNotifications:o.length>0}}}),rl,Qpe,Jpe,e1e,t1e,n1e,r1e,i1e,s1e,o1e,UB,a1e,l1e,uMe=P(()=>{ur(),Se(),rl=K($e()),Xt(),UC(),BTe(),pB(),Qpe=rn(),Nfe(),ZTe(),NM(),JTe(),tMe(),Zd(),nMe(),BB(),e1e=me.div(Jpe||(Jpe=q([`
  height: 36px;
  pointer-events: none;

  display: flex;
  justify-content: space-between;
  padding: 12px;
`]))),n1e=me.div(t1e||(t1e=q([`
  color: white;
  width: 14px;
  height: 14px;
  background: #d00;
  border-radius: 4px;
  text-align: center;
  line-height: 14px;
  font-weight: 600;
  font-size: 8px;
  position: relative;
  left: -6px;
  top: -11px;
  margin-right: -14px;
  box-shadow: 0 4px 6px -4px #00000059;
`]))),i1e=me.div(r1e||(r1e=q([`
  display: flex;
  gap: 8px;
`]))),me.div(s1e||(s1e=q([`
  position: absolute;
  background: `,`;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  right: -2px;
  top: -2px;
`])),({type:o})=>o==="info"?"#40aaa4":"#f59e0b"),me.div(o1e||(o1e=q([`
  position: absolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),UB=!1,a1e=()=>{var o;let l=jr(()=>{let U=(0,Qpe.val)(de().atomP.ephemeral.coreByProject);return Object.entries(U).map(([$,j])=>({projectId:$,state:j})).filter(({state:$})=>$.loadingState.type==="browserStateIsNotBasedOnDiskState")},[]),[h,m]=FC({enabled:l.length>0,enterDelay:l.length>0?0:200},()=>l.length>0?rl.default.createElement(Yde,null,l.length===1?'There is a state conflict in project "'.concat(l[0].projectId,'". Select the project in the outline below in order to fix it.'):"There are ".concat(l.length," projects that have state conflicts. They are highlighted in the outline below. ")):rl.default.createElement(IA,null,rl.default.createElement(rl.default.Fragment,null,"Outline"))),_=(o=Rr(de().atomP.ahistoric.pinOutline))!=null?o:!0,w=Rr(de().atomP.ahistoric.updateChecker.result.hasUpdates)===!0;Nc(()=>{let U=C.current.getBoundingClientRect();return{debugName:"More Menu",constraints:{maxX:U.right,maxY:8,minX:U.left-140,minY:8},verticalGap:2}},()=>rl.default.createElement(npe,null));let C=(0,rl.useRef)(null);(0,rl.useMemo)(()=>(window.__IS_VISUAL_REGRESSION_TESTING&&(UB||(UB=!0,console.warn("Visual regression testing enabled, so we're showing the updates badge unconditionally"))),w||window.__IS_VISUAL_REGRESSION_TESTING?!0:w),[w]);let{hasNotifications:R}=FB(),[N,F]=Zpe();return rl.default.createElement(e1e,null,rl.default.createElement(i1e,null,h,rl.default.createElement(Ffe,{ref:m,"data-testid":"OutlinePanel-TriggerButton",onClick:()=>{de().transaction(({stateEditors:U,drafts:$})=>{var j;U.studio.ahistoric.setPinOutline(!((j=$.ahistoric.pinOutline)==null||j))})},icon:rl.default.createElement(MY,null),pinHintIcon:rl.default.createElement(Ufe,null),unpinHintIcon:rl.default.createElement(Bfe,null),pinned:_}),l.length>0?rl.default.createElement(n1e,null,l.length):null,rl.default.createElement(bB,{showLeftDivider:!0,toolbarId:"global"})))},l1e=a1e}),c1e,vS,u1e,yS,h1e,d1e,f1e,p1e,m1e=P(()=>{c1e=rn(),ur(),vS=K($e()),u1e=K(Gm()),yS=new c1e.Atom({set:{},byId:{}}),h1e=1,d1e=()=>{let o=h1e++;function l(m,_,w){yS.reduce(C=>({byId:V(A({},C.byId),{[o]:{comp:m,props:_,portalNode:w}}),set:V(A({},C.set),{[o]:!0})}))}function h(){yS.reduce(m=>{let _=A({},m.set),w=A({},m.byId);return delete _[o],{byId:w,set:_}})}return{mountOrRender:l,unmount:h}},f1e=()=>{let o=Object.keys(Rr(yS.pointer.set));return vS.default.createElement(vS.default.Fragment,null,o.map(l=>vS.default.createElement(p1e,{key:"id-"+l,id:l})))},p1e=({id:o})=>{let{comp:l,portalNode:h,props:m}=Rr(yS.pointer.byId[o]);return(0,u1e.createPortal)(vS.default.createElement(l,A({},m)),h)}});function hMe(o){let l=de(),[h,m]=ui(void 0),_=Bae();_.configureLogging({min:128,dev:VB,internal:VB});let w=_.getLogger().named("Theatre.js UIRoot");dTe();let C=Rr(l.atomP.ahistoric.visibilityState);return(0,il.useEffect)(()=>(C==="everythingIsHidden"&&console.warn("Theatre.js Studio is hidden. Use the keyboard shortcut 'alt + \\' to restore the studio, or call studio.ui.restore()."),()=>{}),[C]),jr(()=>{let R=(0,zB.val)(l.atomP.ahistoric.visibilityState);return(0,zB.val)(l.atomP.ephemeral.initialised)?il.default.createElement(NK,{logger:w},il.default.createElement(cre,null,il.default.createElement(abe,null,il.default.createElement(b1e,null),il.default.createElement(Qy.Provider,{value:m},il.default.createElement(qD,{target:window.__IS_VISUAL_REGRESSION_TESTING===!0?void 0:o.containerShadow},il.default.createElement(il.default.Fragment,null,il.default.createElement(v1e,null),il.default.createElement(x1e,{className:R==="everythingIsHidden"?"invisible":""},il.default.createElement($D,{ref:h}),il.default.createElement(l1e,null),il.default.createElement(Hde,null)))))))):null},[l,h,m])}var zB,il,g1e,v1e,y1e,x1e,_1e,VB,b1e,dMe=P(()=>{Se(),ur(),zB=rn(),il=K($e()),Xt(),FTe(),uMe(),zi(),j5(),XF(),K0(),ure(),pO(),m1e(),$i(),dA(),W5(),v1e=typeof window<"u"?Aq(g1e||(g1e=q([`
  :host {
    contain: strict;
  }
`]))):{},x1e=me(kK)(y1e||(y1e=q([`
  z-index: 50;
  position: fixed;
  inset: 0;

  &.invisible {
    pointer-events: none !important;
    opacity: 0;
    transform: translateX(1000000px);
  }
`]))),VB=/Playground.+Theatre\.js/.test((_1e=typeof document<"u"?document==null?void 0:document.title:null)!=null?_1e:""),b1e=()=>il.default.createElement(f1e,null)}),fMe=te(o=>{var l=Gm();o.createRoot=l.createRoot,o.hydrateRoot=l.hydrateRoot}),S1e={};oe(S1e,{default:()=>T1e});var w1e,E1e,T1e,pMe=P(()=>{dMe(),w1e=K($e()),E1e=K(fMe()),m1e(),$i(),Nfe(),T1e=class{constructor(){se(this,"containerEl",document.createElement("div")),se(this,"_renderTimeout"),se(this,"_documentBodyUIIsRenderedIn"),se(this,"containerShadow"),this.containerEl.id="theatrejs-studio-root",this.containerEl.style.cssText=`
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      z-index: 100;
    `;let o=()=>{if(window.__IS_VISUAL_REGRESSION_TESTING===!0){let l=document.createElement("div");return l.id="theatrejs-faux-shadow-root",document.body.appendChild(l),l}else return this.containerEl.attachShadow({mode:"open"})};this.containerShadow=o()}render(){let o=()=>{if(!document.body){this._renderTimeout=setTimeout(o,5);return}this._renderTimeout=void 0,this._documentBodyUIIsRenderedIn=document.body,this._documentBodyUIIsRenderedIn.appendChild(this.containerEl),E1e.default.createRoot(this.containerShadow).render(w1e.default.createElement(hMe,{containerShadow:this.containerShadow}))};this._renderTimeout=setTimeout(o,10)}renderToolset(o,l){let h=d1e();return h.mountOrRender(R_e(bB),{toolbarId:o},l),h.unmount}}}),mMe=te(o=>{o.compare=_,o.reduce=w;var l,h,m;o.REMOVE=l=-1,o.ADD=h=1,o.EQUAL=m=0;function _(U,$){var j=U.length,G=$.length,Y=C(U,$),Z=Y<j&&Y<G?R(U,$):0,ne=Z+Y-1;j-=ne,G-=ne;for(var ae=F(j,G),ce=j-1;ce>=0;--ce)for(var ve=G-1;ve>=0;--ve)ae[ve][ce]=N(ae,U,$,Y,ce,ve);return{prefix:Y,matrix:ae,suffix:Z}}function w(U,$,j){var G,Y,Z,ne,ae=j.matrix,ce=j.prefix;for(G=0;G<ce;++G)$=U($,m,G,G);for(Z=G,ce=ae.length,G=0,Y=0;G<ce;)switch(ne=ae[G][Y].type,$=U($,ne,G+Z,Y+Z),ne){case m:++G,++Y;break;case l:++Y;break;case h:++G;break}for(G+=Z,Y+=Z,ce=j.suffix,Z=0;Z<ce;++Z)$=U($,m,G+Z,Y+Z);return $}function C(U,$){for(var j=0,G=Math.min(U.length,$.length);j<G&&U[j]===$[j];)++j;return j}function R(U,$){for(var j=U.length-1,G=$.length-1,Y=Math.min(j,G),Z=0;Z<Y&&U[j-Z]===$[G-Z];)++Z;return Z}function N(U,$,j,G,Y,Z){return $[Y+G]===j[Z+G]?{value:U[Z+1][Y+1].value,type:m}:U[Z][Y+1].value<U[Z+1][Y].value?{value:U[Z][Y+1].value+1,type:l}:{value:U[Z+1][Y].value+1,type:h}}function F(U,$){var j=[],G,Y,Z;for(Z=j[$]=[],Y=0;Y<U;++Y)Z[Y]={value:U-Y,type:l};for(G=0;G<$;++G)j[G]=[],j[G][U]={value:$-G,type:h};return j[$][U]={value:0,type:m},j}}),M1e=te(o=>{o.cons=l,o.tail=h,o.map=m;function l(_,w){var C=w.length,R=new Array(C+1);R[0]=_;for(var N=0;N<C;++N)R[N+1]=w[N];return R}function h(_){for(var w=_.length-1,C=new Array(w),R=0;R<w;++R)C[R]=_[R+1];return C}function m(_,w){for(var C=new Array(w.length),R=0;R<w.length;++R)C[R]=_(w[R]);return C}}),gMe=te((o,l)=>{l.exports=C;var h=/\/|~1|~0/g,m="/",_="~",w="~1";function C(R,N){var F,U,$,j;for(F=R.charAt(0)===m?1:0,U="",h.lastIndex=F;$=h.exec(R);)if(j=$[0],U+=R.slice(F,h.lastIndex-j.length),F=h.lastIndex,j===m){if(N(U)===!1)return R;U=""}else U+=j===w?m:_;return U+=R.slice(F),N(U),R}}),GB=te(o=>{var l=gMe();o.find=U,o.join=j,o.absolute=$,o.parse=G,o.contains=Y,o.encodeSegment=ne,o.decodeSegment=Z,o.parseArrayIndex=ve,o.isValidArrayIndex=ce;var h="/",m=/\//g,_="~1",w=/~1/g,C="~",R=/~/g,N="~0",F=/~0/g;function U(Te,_e,it,Re){if(typeof _e=="string"){if(_e==="")return{target:Te,key:void 0};if(_e===h)return{target:Te,key:""};var xe=Te,Oe,He=Re!==void 0;return l(_e,function(Fe){if(Te==null)return xe=null,!1;Array.isArray(Te)?Oe=He?Me(it,ve(Fe),Te,Re):Fe==="-"?Fe:ve(Fe):Oe=Fe,xe=Te,Te=Te[Oe]}),xe===null?void 0:{target:xe,key:Oe}}}function $(Te){return Te[0]===h?Te:h+Te}function j(Te){return Te.join(h)}function G(Te){var _e=[];return l(Te,_e.push.bind(_e)),_e}function Y(Te,_e){return _e.indexOf(Te)===0&&_e[Te.length]===h}function Z(Te){return Te.replace(w,h).replace(F,C)}function ne(Te){return Te.replace(R,N).replace(m,_)}var ae=/^(0|[1-9]\d*)$/;function ce(Te){return ae.test(Te)}function ve(Te){if(ce(Te))return+Te;throw new SyntaxError("invalid array index "+Te)}function Me(Te,_e,it,Re){var xe=_e;if(xe<0)throw new Error("array index out of bounds "+xe);if(Re!==void 0&&typeof Te=="function"&&(xe=Te(_e,it,Re),xe<0))throw new Error("could not find patch context "+Re);return xe}}),C1e=te((o,l)=>{l.exports=h;function h(w){return w==null||typeof w!="object"?w:Array.isArray(w)?m(w):_(w)}function m(w){for(var C=w.length,R=new Array(C),N=0;N<C;++N)R[N]=h(w[N]);return R}function _(w){for(var C=Object.keys(w),R={},N,F=0,U=C.length;F<U;++F)N=C[F],R[N]=h(w[N]);return R}}),vMe=te((o,l)=>{l.exports=h;function h(w,C){return w===C?!0:Array.isArray(w)&&Array.isArray(C)?m(w,C):typeof w=="object"&&typeof C=="object"?_(w,C):!1}function m(w,C){if(w.length!==C.length)return!1;for(var R=0;R<w.length;++R)if(!h(w[R],C[R]))return!1;return!0}function _(w,C){if(w===null&&C!==null||w!==null&&C===null)return!1;var R=Object.keys(w),N=Object.keys(C);if(R.length!==N.length)return!1;for(var F=0,U;F<R.length;++F)if(U=R[F],!(U in C&&h(w[U],C[U])))return!1;return!0}}),yMe=te((o,l)=>{var h=GB();l.exports=function(U,$){var j=h.parse(U.path),G=h.parse($.path),Y=N(j,G),Z=w(j,G,Y.length),ne=F(U),ae=F($);return Y.length===0&&!Z?[ae,ne]:Z?_(ne,j,ae,G):m(ne,j,ae)};function m(U,$,j,G){if(U.path===j.path)throw new TypeError("cannot commute "+U.op+","+j.op+" with identical object paths");return[j,U]}function _(U,$,j,G){return $.length===G.length?C(U,$,j,G):($.length>G.length?($=R(j,G,U,$,-1),U.path=h.absolute(h.join($))):(G=R(U,$,j,G,1),j.path=h.absolute(h.join(G))),[j,U])}function w(U,$,j){return h.isValidArrayIndex(U[j])&&h.isValidArrayIndex($[j])}function C(U,$,j,G){var Y=$.length-1,Z=+$[Y],ne=+G[Y],ae;return Z<ne?U.op==="add"||U.op==="copy"?(ae=G.slice(),ae[Y]=Math.max(0,ne-1),j.path=h.absolute(h.join(ae))):U.op==="remove"&&(ae=G.slice(),ae[Y]=ne+1,j.path=h.absolute(h.join(ae))):j.op==="add"||j.op==="copy"?(ae=$.slice(),ae[Y]=Z+1,U.path=h.absolute(h.join(ae))):Z>ne&&j.op==="remove"&&(ae=$.slice(),ae[Y]=Math.max(0,Z-1),U.path=h.absolute(h.join(ae))),[j,U]}function R(U,$,j,G,Y){var Z=$.length-1,ne=+$[Z],ae=+G[Z],ce=G.slice();return ne>ae||(U.op==="add"||U.op==="copy"?ce[Z]=Math.max(0,ae-Y):U.op==="remove"&&(ce[Z]=Math.max(0,ae+Y))),ce}function N(U,$){var j=U.length,G=$.length;if(j===0||G===0||j<2&&G<2)return[];for(var Y=j===G?j-1:Math.min(j,G),Z=0;Z<Y&&U[Z]===$[Z];)++Z;return U.slice(0,Z)}function F(U){return U.op==="remove"?{op:U.op,path:U.path}:U.op==="copy"||U.op==="move"?{op:U.op,path:U.path,from:U.from}:{op:U.op,path:U.path,value:U.value}}}),A1e=te((o,l)=>{l.exports=h;function h(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}h.prototype=Object.create(Error.prototype),h.prototype.constructor=h}),jB=te((o,l)=>{l.exports=h;function h(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}h.prototype=Object.create(Error.prototype),h.prototype.constructor=h}),P1e=te((o,l)=>{l.exports=h;function h(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}h.prototype=Object.create(Error.prototype),h.prototype.constructor=h}),R1e=te(o=>{var l=GB(),h=C1e(),m=vMe(),_=yMe(),w=M1e(),C=A1e(),R=jB(),N=P1e(),F=l.find,U=l.parseArrayIndex;o.test={apply:$,inverse:j,commute:G},o.add={apply:Y,inverse:ne,commute:ae},o.remove={apply:Te,inverse:it,commute:Re},o.replace={apply:ce,inverse:ve,commute:Me},o.move={apply:xe,inverse:Oe,commute:He},o.copy={apply:Fe,inverse:Nt,commute:ae};function $(Ye,Ee,et){var At=F(Ye,Ee.path,et.findContext,Ee.context),Ce=At.target,Ze,Ft;if(Array.isArray(Ce)?(Ze=U(At.key),Ft=Ce[Ze]):Ft=At.key===void 0?At.target:At.target[At.key],!m(Ft,Ee.value))throw new C("test failed "+JSON.stringify(Ee));return Ye}function j(Ye,Ee){return Ye.push(Ee),1}function G(Ye,Ee){if(Ye.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute test,remove -> remove,test for same path");return Ee.op==="test"||Ee.op==="replace"?[Ee,Ye]:_(Ye,Ee)}function Y(Ye,Ee,et){var At=F(Ye,Ee.path,et.findContext,Ee.context);if(Ve(At))throw new R("path does not exist "+Ee.path);if(Ee.value===void 0)throw new R("missing value");var Ce=h(Ee.value);return At.key===void 0?Ce:(Z(At,Ce),Ye)}function Z(Ye,Ee){var et=Ye.target;if(Array.isArray(et))if(Ye.key==="-")et.push(Ee);else{if(Ye.key>et.length)throw new R("target of add outside of array bounds");et.splice(Ye.key,0,Ee)}else if(ot(et))et[Ye.key]=Ee;else throw new R("target of add must be an object or array "+Ye.key)}function ne(Ye,Ee){var et=Ee.context;return et!==void 0&&(et={before:et.before,after:w.cons(Ee.value,et.after)}),Ye.push({op:"test",path:Ee.path,value:Ee.value,context:et}),Ye.push({op:"remove",path:Ee.path,context:et}),1}function ae(Ye,Ee){if(Ye.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute add,remove -> remove,add for same path");return _(Ye,Ee)}function ce(Ye,Ee,et){var At=F(Ye,Ee.path,et.findContext,Ee.context);if(Ve(At)||Ht(At))throw new R("path does not exist "+Ee.path);if(Ee.value===void 0)throw new R("missing value");var Ce=h(Ee.value);if(At.key===void 0)return Ce;var Ze=At.target;return Array.isArray(Ze)?Ze[U(At.key)]=Ce:Ze[At.key]=Ce,Ye}function ve(Ye,Ee,et,At){var Ce=At[et-1];if(Ce===void 0||Ce.op!=="test"||Ce.path!==Ee.path)throw new N("cannot invert replace w/o test");var Ze=Ce.context;return Ze!==void 0&&(Ze={before:Ze.before,after:w.cons(Ce.value,w.tail(Ze.after))}),Ye.push({op:"test",path:Ce.path,value:Ee.value}),Ye.push({op:"replace",path:Ce.path,value:Ce.value}),2}function Me(Ye,Ee){if(Ye.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute replace,remove -> remove,replace for same path");return Ee.op==="test"||Ee.op==="replace"?[Ee,Ye]:_(Ye,Ee)}function Te(Ye,Ee,et){var At=F(Ye,Ee.path,et.findContext,Ee.context);if(Ve(At)||At.target[At.key]===void 0)throw new R("path does not exist "+Ee.path);return _e(At),Ye}function _e(Ye){var Ee=Ye.target,et;if(Array.isArray(Ee))return et=Ee.splice(U(Ye.key),1),et[0];if(ot(Ee))return et=Ee[Ye.key],delete Ee[Ye.key],et;throw new R("target of remove must be an object or array")}function it(Ye,Ee,et,At){var Ce=At[et-1];if(Ce===void 0||Ce.op!=="test"||Ce.path!==Ee.path)throw new N("cannot invert remove w/o test");var Ze=Ce.context;return Ze!==void 0&&(Ze={before:Ze.before,after:w.tail(Ze.after)}),Ye.push({op:"add",path:Ce.path,value:Ce.value,context:Ze}),2}function Re(Ye,Ee){return Ye.path===Ee.path&&Ee.op==="remove"?[Ee,Ye]:_(Ye,Ee)}function xe(Ye,Ee,et){if(l.contains(Ee.path,Ee.from))throw new R("move.from cannot be ancestor of move.path");var At=F(Ye,Ee.path,et.findContext,Ee.context),Ce=F(Ye,Ee.from,et.findContext,Ee.fromContext);return Z(At,_e(Ce)),Ye}function Oe(Ye,Ee){return Ye.push({op:"move",path:Ee.from,context:Ee.fromContext,from:Ee.path,fromContext:Ee.context}),1}function He(Ye,Ee){if(Ye.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute move,remove -> move,replace for same path");return _(Ye,Ee)}function Fe(Ye,Ee,et){var At=F(Ye,Ee.path,et.findContext,Ee.context),Ce=F(Ye,Ee.from,et.findContext,Ee.fromContext);if(Ve(Ce)||Ht(Ce))throw new R("copy.from must exist");var Ze=Ce.target,Ft;return Array.isArray(Ze)?Ft=Ze[U(Ce.key)]:Ft=Ze[Ce.key],Z(At,h(Ft)),Ye}function Nt(Ye,Ee){throw new N("cannot invert "+Ee.op)}function Ve(Ye){return Ye===void 0||Ye.target==null&&Ye.key!==void 0}function Ht(Ye){return Ye.key!==void 0&&Ye.target[Ye.key]===void 0}function ot(Ye){return Ye!==null&&typeof Ye=="object"}}),xMe=te(o=>{var l=R1e(),h=C1e(),m=jB();o.apply=w,o.applyInPlace=C,o.clone=h,o.isValidObject=N,o.defaultHash=R;var _={};function w(U,$,j){return C(U,h($),j)}function C(U,$,j){if(j||(j=_),!Array.isArray(U))return $;for(var G,Y,Z=0;Z<U.length;++Z){if(Y=U[Z],G=l[Y.op],G===void 0)throw new m("invalid op "+JSON.stringify(Y));$=G.apply($,Y,j)}return $}function R(U){return N(U)||F(U)?JSON.stringify(U):U}function N(U){return U!==null&&Object.prototype.toString.call(U)==="[object Object]"}function F(U){return Object.prototype.toString.call(U)==="[object Array]"}}),_Me=te((o,l)=>{var h=R1e();l.exports=function(_){var w=[],C,R;for(C=_.length-1;C>=0;C-=R)R=m(w,_[C],C,_);return w};function m(_,w,C,R){var N=h[w.op];return N!==void 0&&typeof N.inverse=="function"?N.inverse(_,w,C,R):1}}),bMe=te(o=>{var l=mMe(),h=M1e(),m=xMe(),_=_Me(),w=GB(),C=w.encodeSegment;o.diff=F,o.patch=m.apply,o.patchInPlace=m.applyInPlace,o.inverse=_,o.clone=m.clone,o.InvalidPatchOperationError=jB(),o.TestFailedError=A1e(),o.PatchNotInvertibleError=P1e();var R=m.isValidObject,N=m.defaultHash;function F(ve,Me,Te){return $(ve,Me,"",U(Te,[])).patch}function U(ve,Me){return typeof ve=="object"?{patch:Me,hash:ne(ce,ve.hash,N),makeContext:ne(ce,ve.makeContext,ae),invertible:ve.invertible!==!1}:{patch:Me,hash:ne(ce,ve,N),makeContext:ae,invertible:!0}}function $(ve,Me,Te,_e){return Array.isArray(ve)&&Array.isArray(Me)?G(ve,Me,Te,_e):R(ve)&&R(Me)?j(ve,Me,Te,_e):Z(ve,Me,Te,_e)}function j(ve,Me,Te,_e){var it=Object.keys(Me),Re=_e.patch,xe,Oe;for(xe=it.length-1;xe>=0;--xe){Oe=it[xe];var He=Te+"/"+C(Oe);ve[Oe]!==void 0?$(ve[Oe],Me[Oe],He,_e):Re.push({op:"add",path:He,value:Me[Oe]})}for(it=Object.keys(ve),xe=it.length-1;xe>=0;--xe)if(Oe=it[xe],Me[Oe]===void 0){var Fe=Te+"/"+C(Oe);_e.invertible&&Re.push({op:"test",path:Fe,value:ve[Oe]}),Re.push({op:"remove",path:Fe})}return _e}function G(ve,Me,Te,_e){var it=h.map(_e.hash,ve),Re=h.map(_e.hash,Me),xe=l.compare(it,Re);return Y(ve,Me,Te,_e,xe)}function Y(ve,Me,Te,_e,it){var Re=0;return l.reduce(function(xe,Oe,He,Fe){var Nt,Ve,Ht=xe.patch,ot=Te+"/"+(Fe+Re);return Oe===l.REMOVE?(Nt=Ht[Ht.length-1],Ve=xe.makeContext(Fe,ve),xe.invertible&&Ht.push({op:"test",path:ot,value:ve[Fe],context:Ve}),Nt!==void 0&&Nt.op==="add"&&Nt.path===ot?(Nt.op="replace",Nt.context=Ve):Ht.push({op:"remove",path:ot,context:Ve}),Re-=1):Oe===l.ADD?(Ht.push({op:"add",path:ot,value:Me[He],context:xe.makeContext(Fe,ve)}),Re+=1):$(ve[Fe],Me[He],ot,xe),xe},_e,it)}function Z(ve,Me,Te,_e){return ve!==Me&&(_e.invertible&&_e.patch.push({op:"test",path:Te,value:ve}),_e.patch.push({op:"replace",path:Te,value:Me})),_e}function ne(ve,Me,Te){return ve(Me)?Me:Te}function ae(){}function ce(ve){return typeof ve=="function"}}),b8=te((o,l)=>{function h(m,_){for(var w=0,C=_.length-1;w<C;w++){if(!m[_[w]])return null;m=m[_[w]]}return m}l.exports=h}),q9=te((o,l)=>{function h(_){return _==="~0"?"~":"/"}function m(_){var w=_.split("/");if(_.indexOf("~")===-1)return w;for(var C=0,R=w.length;C<R;C++)w[C].indexOf("~")!==-1&&(w[C]=w[C].replace(/~[01]/g,h));return w}l.exports=m}),SMe=te((o,l)=>{var h=b8(),m=q9();function _(w,C){var R=m(C),N=R[R.length-1],F=h(w,R);return F?F[N]:void 0}l.exports=_}),GA=te((o,l)=>{function h(m,_){if(m===_)return!0;if(!(m&&_)||typeof m!="object"||typeof _!="object"||m.length!==_.length)return!1;if(Array.isArray(m)){if(!Array.isArray(_))return!1;for(var w=0,C=m.length;w<C;w++)if(!h(m[w],_[w]))return!1;return!0}var R=Object.keys(m);if(R.length!==Object.keys(_).length)return!1;for(var N=0,F=R.length;N<F;N++){var U=R[N];if(!h(m[U],_[U]))return!1}return!0}l.exports=h}),jA=te((o,l)=>{function h(m,_){if(_==="-")return m.length;for(var w=0,C=_.length;w<C;w++){var R=_.charCodeAt(w);if(57<R||R<48)return 1/0}return+_}l.exports=h}),HA=te((o,l)=>{var h=GA(),m=b8(),_=jA(),w=q9();function C(R,N,F,U){if(typeof F>"u")return"[op:add] require value, but got undefined";var $=w(N),j=$[$.length-1],G=m(R,$);if(G===null)return"[op:add] path not found: "+N;if(Array.isArray(G)){var Y=_(G,j);if(G.length<Y)return"[op:add] invalid array index: "+N;U(R,$).splice(Y,0,F)}else h(G[j],F)||(U(R,$)[j]=F)}l.exports=C}),I1e=te((o,l)=>{var h=b8(),m=jA(),_=q9();function w(C,R,N){var F=_(R),U=F[F.length-1],$=h(C,F);if($===null)return"[op:remove] path not found: "+R;if(Array.isArray($)){var j=m($,U);if($.length<=j)return"[op:remove] invalid array index: "+R;N(C,F).splice(j,1)}else delete N(C,F)[U]}l.exports=w}),k1e=te((o,l)=>{var h=GA(),m=b8(),_=jA(),w=q9();function C(R,N,F,U){if(typeof F>"u")return"[op:replace] require value, but got undefined";var $=w(N),j=$[$.length-1],G=m(R,$);if(G===null)return"[op:replace] path not found: "+N;if(Array.isArray(G)){var Y=_(G,j);if(G.length<=Y)return"[op:replace] invalid array index: "+N;h(G[Y],F)||U(R,$).splice(Y,1,F)}else h(G[j],F)||(U(R,$)[j]=F)}l.exports=C}),N1e=te((o,l)=>{var h=HA(),m=b8(),_=jA(),w=q9();function C(R,N,F,U){if(F!==N){var $=w(N),j=$[$.length-1],G=m(R,$);if(G===null)return"[op:move] path not found: "+N;var Y=void 0;if(Array.isArray(G)){var Z=_(G,j);if(G.length<=Z)return"[op:move] invalid array index: "+F;Y=G[Z],U(R,$).splice(Z,1)}else Y=G[j],delete U(R,$)[j];return h(R,F,Y,U)}}l.exports=C}),D1e=te((o,l)=>{var h=b8(),m=q9(),_=HA();function w(C,R,N,F){var U=m(R),$=U[U.length-1],j=h(C,U);return j===null?"[op:copy] path not found: "+R:_(C,N,j[$],F)}l.exports=w}),O1e=te((o,l)=>{var h=GA(),m=b8(),_=q9();function w(C,R,N){var F=_(R),U=F[F.length-1],$=m(C,F);if($===null)return"[op:test] path not found: "+R;if(!h($[U],N)){var j=JSON.stringify($[U]),G=JSON.stringify(N);return"[op:test] not matched: "+j+" "+G}}l.exports=w}),HB=te((o,l)=>{function h(m){if(!m||typeof m!="object")return m;if(Array.isArray(m)){for(var _=m.length,w=new Array(_),C=0;C<_;C++)w[C]=m[C];return w}for(var R=Object.keys(m),N={},F=0,U=R.length;F<U;F++){var $=R[F];N[$]=m[$]}return N}l.exports=h}),wMe=te((o,l)=>{var h=SMe(),m=HA(),_=I1e(),w=k1e(),C=N1e(),R=D1e(),N=O1e(),F=GA(),U=HB(),$=q9();function j(G,Y){return{get:function(Z){return h(G,Z)},add:function(Z,ne){return m(G,Z,ne,Y)},remove:function(Z){return _(G,Z,Y)},replace:function(Z,ne){return w(G,Z,ne,Y)},move:function(Z,ne){return C(G,Z,ne,Y)},copy:function(Z,ne){return R(G,Z,ne,Y)},test:function(Z,ne){return N(G,Z,ne)},deepEqual:F,shallowCopy:U,toKeys:$}}l.exports=j}),EMe=te((o,l)=>{function h(m,_,w,C){return C.error=w,C.partial?_[""]:m}l.exports=h}),TMe=te((o,l)=>{function h(m){return!!m}l.exports=h}),MMe=te((o,l)=>{function h(m){if(m)throw new TypeError(m)}l.exports=h}),CMe=te((o,l)=>{var h=HB();function m(_,w){for(var C=0,R=w.length-1;C<R;C++)_=_[w[C]]=h(_[w[C]]);return _}l.exports=m}),AMe=te((o,l)=>{var h=HB();function m(w,C,R){var N=w[C];return R.has(N)||(N=h(N),R.add(N)),N}function _(w,C,R){for(var N=0,F=C.length-1;N<F;N++)w=w[C[N]]=m(w,C[N],R);return w}l.exports=_}),PMe=te((o,l)=>{var h=wMe(),m=EMe(),_=TMe(),w=MMe(),C=CMe(),R=AMe(),N=HA(),F=I1e(),U=k1e(),$=N1e(),j=D1e(),G=O1e(),Y=Set||function(){var ne=[];return ne.has=function(ae){return this.indexOf(ae)!==-1},ne.add=function(ae){this.push(ae)},ne};function Z(ne,ae,ce){if(ae.length===0)return ne;ce=ce||{};for(var ve=ce.strict?w:_,Me=ae.length===1?C:function(Oe){return function(He,Fe){return R(He,Fe,Oe)}}(new Y),Te={"":ne},_e,it=0,Re=ae.length;it<Re;it++){var xe=ae[it];switch(xe.op){case"add":if(ve(N(Te,""+xe.path,xe.value,Me)))return m(ne,Te,xe,ce);break;case"remove":if(ve(F(Te,""+xe.path,Me)))return m(ne,Te,xe,ce);break;case"replace":if(ve(U(Te,""+xe.path,xe.value,Me)))return m(ne,Te,xe,ce);break;case"move":if(ve($(Te,""+xe.from,""+xe.path,Me)))return m(ne,Te,xe,ce);break;case"copy":if(ve(j(Te,""+xe.from,""+xe.path,Me)))return m(ne,Te,xe,ce);break;case"test":if(ve(G(Te,""+xe.path,xe.value)))return m(ne,Te,xe,ce);break;default:if(ce.custom&&ce.custom[xe.op]){if(_e=_e||h(Te,Me),ve(ce.custom[xe.op](_e,xe,it,ae)))return m(ne,Te,xe,ce)}else return ve("[op:"+xe.op+"] unknown"),m(ne,Te,xe,ce);break}}return Te[""]}l.exports=Z}),RMe=te((o,l)=>{l.exports=PMe()}),IMe=te((o,l)=>{(function(h,m){typeof o=="object"&&typeof l=="object"?l.exports=m():typeof o=="object"?o.blobCompare=m():h.blobCompare=m()})(window,function(){return function(h){var m={};function _(w){if(m[w])return m[w].exports;var C=m[w]={i:w,l:!1,exports:{}};return h[w].call(C.exports,C,C.exports,_),C.l=!0,C.exports}return _.m=h,_.c=m,_.d=function(w,C,R){_.o(w,C)||Object.defineProperty(w,C,{enumerable:!0,get:R})},_.r=function(w){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(w,"__esModule",{value:!0})},_.t=function(w,C){if(1&C&&(w=_(w)),8&C||4&C&&typeof w=="object"&&w&&w.__esModule)return w;var R=Object.create(null);if(_.r(R),Object.defineProperty(R,"default",{enumerable:!0,value:w}),2&C&&typeof w!="string")for(var N in w)_.d(R,N,(function(F){return w[F]}).bind(null,N));return R},_.n=function(w){var C=w&&w.__esModule?function(){return w.default}:function(){return w};return _.d(C,"a",C),C},_.o=function(w,C){return Object.prototype.hasOwnProperty.call(w,C)},_.p="",_(_.s=4)}([function(h,m,_){var w=function(U,$){if(Array.isArray(U))return U;if(Symbol.iterator in Object(U))return function(j,G){var Y=[],Z=!0,ne=!1,ae=void 0;try{for(var ce,ve=j[Symbol.iterator]();!(Z=(ce=ve.next()).done)&&(Y.push(ce.value),!G||Y.length!==G);Z=!0);}catch(Me){ne=!0,ae=Me}finally{try{!Z&&ve.return&&ve.return()}finally{if(ne)throw ae}}return Y}(U,$);throw new TypeError("Invalid attempt to destructure non-iterable instance")},C=function(){function U($,j){for(var G=0;G<j.length;G++){var Y=j[G];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty($,Y.key,Y)}}return function($,j,G){return j&&U($.prototype,j),G&&U($,G),$}}();function R(U){if(Array.isArray(U)){for(var $=0,j=Array(U.length);$<U.length;$++)j[$]=U[$];return j}return Array.from(U)}var N=_(2),F=function(U){function $(j){(function(Y,Z){if(!(Y instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,$);var G=function(Y,Z){if(!Y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!Z||typeof Z!="object"&&typeof Z!="function"?Y:Z}(this,($.__proto__||Object.getPrototypeOf($)).call(this));return G._messageId=1,G._messages=new Map,G._worker=j,G._worker.onmessage=G._onMessage.bind(G),G._id=Math.ceil(1e7*Math.random()),G}return function(j,G){if(typeof G!="function"&&G!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof G);j.prototype=Object.create(G&&G.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),G&&(Object.setPrototypeOf?Object.setPrototypeOf(j,G):j.__proto__=G)}($,U),C($,[{key:"terminate",value:function(){this._worker.terminate()}},{key:"isFree",value:function(){return this._messages.size===0}},{key:"jobsLength",value:function(){return this._messages.size}},{key:"exec",value:function(j){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Y=this,Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],ne=arguments[3];return new Promise(function(ae,ce){var ve=Y._messageId++;Y._messages.set(ve,[ae,ce,ne]),Y._worker.postMessage([ve,G,j],Z||[])})}},{key:"postMessage",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,G=this,Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Z=arguments[2];return new Promise(function(ne,ae){var ce=G._messageId++;G._messages.set(ce,[ne,ae,Z]),G._worker.postMessage([ce,j],Y||[])})}},{key:"emit",value:function(j){for(var G=arguments.length,Y=Array(G>1?G-1:0),Z=1;Z<G;Z++)Y[Z-1]=arguments[Z];this._worker.postMessage({eventName:j,args:Y})}},{key:"_onMessage",value:function(j){var G;if(!Array.isArray(j.data)&&j.data.eventName)return(G=function ce(ve,Me,Te){ve===null&&(ve=Function.prototype);var _e=Object.getOwnPropertyDescriptor(ve,Me);if(_e===void 0){var it=Object.getPrototypeOf(ve);return it===null?void 0:ce(it,Me,Te)}if("value"in _e)return _e.value;var Re=_e.get;return Re!==void 0?Re.call(Te):void 0}($.prototype.__proto__||Object.getPrototypeOf($.prototype),"emit",this)).call.apply(G,[this,j.data.eventName].concat(R(j.data.args)));var Y,Z=(Y=j.data,Array.isArray(Y)?Y:Array.from(Y)),ne=Z[0],ae=Z.slice(1);if(ne===1)this._onEvent.apply(this,R(ae));else{if(ne!==0)throw new Error("Wrong message type '"+ne+"'");this._onResult.apply(this,R(ae))}}},{key:"_onResult",value:function(j,G,Y){var Z=this._messages.get(j),ne=w(Z,2),ae=ne[0],ce=ne[1];return this._messages.delete(j),G===1?ae(Y):ce(Y)}},{key:"_onEvent",value:function(j,G,Y){var Z=this._messages.get(j),ne=w(Z,3)[2];ne&&ne(G,Y)}}]),$}(N);h.exports=F},function(h,m,_){h.exports=function(){return _(3)(`!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=r(1),c=0,l=1,s=0,y=1,p="main",b=function(e){return"object"===(void 0===e?"undefined":i(e))&&"function"==typeof e.then&&"function"==typeof e.catch};var v=function e(t,r){u(this,e),this.payload=t,this.transferable=r};e.exports=function(e){var t,r,i,h=(i=e,(r=p)in(t={})?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t),d=self.postMessage.bind(self),m=new(function(e){function t(){return u(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return d({eventName:e,args:r}),this}},{key:"emitLocally",value:function(e){for(var r,n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];(r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"emit",this)).call.apply(r,[this,e].concat(i))}},{key:"operation",value:function(e,t){return h[e]=t,this}}]),t}(f)),g=function(e,t,r){var n=function(t){t&&t instanceof v?w(e,y,t.payload,t.transferable):w(e,y,t)},o=function(t){w(e,s,{message:t.message,stack:t.stack})};try{var i=_(e,t,r);b(i)?i.then(n).catch(o):n(i)}catch(e){o(e)}},_=function(e,t,r){var n=h[r||p];if(!n)throw new Error("Not found handler for this request");return n(t,O.bind(null,e))},w=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];d([c,e,t,r],n)},O=function(e,t,r){if(!t)throw new Error("eventName is required");if("string"!=typeof t)throw new Error("eventName should be string");d([l,e,t,r])};return self.addEventListener("message",(function(e){var t=e.data;Array.isArray(t)?g.apply(void 0,a(t)):t&&t.eventName&&m.emitLocally.apply(m,[t.eventName].concat(a(t.args)))})),m},e.exports.TransferableResponse=v},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return n(e,[{key:"emit",value:function(e){if(!this.__listeners[e])return this;for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=!0,i=!1,a=void 0;try{for(var u,f=this.__listeners[e][Symbol.iterator]();!(o=(u=f.next()).done);o=!0){var c=u.value;c.apply(void 0,r)}}catch(e){i=!0,a=e}finally{try{!o&&f.return&&f.return()}finally{if(i)throw a}}return this}},{key:"once",value:function(e,t){var r=this,n=function n(){r.off(e,n),t.apply(void 0,arguments)};return this.on(e,n)}},{key:"on",value:function(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}},{key:"off",value:function(e,t){return this.__listeners[e]=t?this.__listeners[e].filter((function(e){return e!==t})):[],this}}]),e}();e.exports=o},function(e,t,r){"use strict";r.r(t);var n=r(0);r.n(n)()().operation("binary",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsBinaryString(a)})}(e,t)).operation("buffer",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsArrayBuffer(a)})}(e,t)).operation("compare",({buf1:e,buf2:t})=>(function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e),n=new DataView(t);for(var o=e.byteLength;o--;)if(r.getUint8(o)!==n.getUint8(o))return!1;return!0})(e,t))}]);`,null)}},function(h,m,_){var w=function(){function R(N,F){for(var U=0;U<F.length;U++){var $=F[U];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(N,$.key,$)}}return function(N,F,U){return F&&R(N.prototype,F),U&&R(N,U),N}}(),C=function(){function R(){(function(N,F){if(!(N instanceof F))throw new TypeError("Cannot call a class as a function")})(this,R),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return w(R,[{key:"emit",value:function(N){if(!this.__listeners[N])return this;for(var F=arguments.length,U=Array(F>1?F-1:0),$=1;$<F;$++)U[$-1]=arguments[$];var j=!0,G=!1,Y=void 0;try{for(var Z,ne=this.__listeners[N][Symbol.iterator]();!(j=(Z=ne.next()).done);j=!0){var ae=Z.value;ae.apply(void 0,U)}}catch(ce){G=!0,Y=ce}finally{try{!j&&ne.return&&ne.return()}finally{if(G)throw Y}}return this}},{key:"once",value:function(N,F){var U=this,$=function j(){U.off(N,j),F.apply(void 0,arguments)};return this.on(N,$)}},{key:"on",value:function(N,F){return this.__listeners[N]||(this.__listeners[N]=[]),this.__listeners[N].push(F),this}},{key:"off",value:function(N,F){return this.__listeners[N]=F?this.__listeners[N].filter(function(U){return U!==F}):[],this}}]),R}();h.exports=C},function(h,m,_){var w=window.URL||window.webkitURL;h.exports=function(C,R){try{try{var N;try{(N=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(C),N=N.getBlob()}catch{N=new Blob([C])}return new Worker(w.createObjectURL(N))}catch{return new Worker("data:application/javascript,"+encodeURIComponent(C))}}catch{if(!R)throw Error("Inline worker is not supported");return new Worker(R)}}},function(h,m,_){_.r(m);var w=_(0),C=_.n(w),R=_(1),N=_.n(R);_.d(m,"workersEnabled",function(){return F}),_.d(m,"default",function(){return U});let F=!!window.Worker;class U{static toBinaryStringWithWorker(j,G){return De(this,null,function*(){let Y=new C.a(new N.a),Z=yield Y.exec("binary",{blob:j,chunk:G});return Y.terminate(),Z})}static toBinaryStringWithoutWorker(j,G){return function(Y,Z){return new Promise((ne,ae)=>{let ce=new FileReader,ve=Z?Math.min(Z,Y.size):Y.size,Me=Y.slice(0,ve);ce.onload=()=>ne(ce.result),ce.onerror=ae,ce.readAsBinaryString(Me)})}(j,G)}static toBinaryString(j,G,Y=!0){return Y&&F?this.toBinaryStringWithWorker(j,G):this.toBinaryStringWithoutWorker(j,G)}static toArrayBufferWithWorker(j,G){return De(this,null,function*(){let Y=new C.a(new N.a),Z=yield Y.exec("buffer",{blob:j,chunk:G});return Y.terminate(),Z})}static toArrayBufferWithoutWorker(j,G){return function(Y,Z){return new Promise((ne,ae)=>{let ce=new FileReader,ve=Z?Math.min(Z,Y.size):Y.size,Me=Y.slice(0,ve);ce.onload=()=>ne(ce.result),ce.onerror=ae,ce.readAsArrayBuffer(Me)})}(j,G)}static toArrayBuffer(j,G,Y=!0){return Y&&F?this.toArrayBufferWithWorker(j,G):this.toArrayBufferWithoutWorker(j,G)}static compareBuffersWithWorker(j,G){return De(this,null,function*(){if(j===G)return!0;let Y=new C.a(new N.a),Z=yield Y.exec("compare",{buf1:j,buf2:G},[j,G]);return Y.terminate(),Z})}static compareBuffersWithoutWorker(j,G){return function(Y,Z){if(Y===Z)return!0;if(Y.byteLength!==Z.byteLength)return!1;let ne=new DataView(Y),ae=new DataView(Z);for(var ce=Y.byteLength;ce--;)if(ne.getUint8(ce)!==ae.getUint8(ce))return!1;return!0}(j,G)}static compareBuffers(j,G,Y=!0){return Y&&F?this.compareBuffersWithWorker(j,G):this.compareBuffersWithoutWorker(j,G)}static sizeEqual(j,G){return j.size===G.size}static typeEqual(j,G){return j.type===G.type}static magicNumbersEqual(j,G,Y=!0){return De(this,null,function*(){if(j===G)return!0;let Z=[24,16,14,12,8,6,4],[ne,ae]=yield Promise.all([this.toBinaryString(j,24,Y),this.toBinaryString(G,24,Y)]);for(let ce of Z)if(ne.substring(0,ce)===ae.substring(0,ce))return!0;return!1})}static bytesEqualWithBinaryString(j,G,Y,Z=!0){return De(this,null,function*(){if(j===G)return!0;let[ne,ae]=yield Promise.all([this.toBinaryString(j,Y,Z),this.toBinaryString(G,Y,Z)]);return ne===ae})}static bytesEqualWithArrayBuffer(j,G,Y,Z=!0){return De(this,null,function*(){if(j===G)return!0;let[ne,ae]=yield Promise.all([this.toArrayBuffer(j,Y,Z),this.toArrayBuffer(G,Y,Z)]);return this.compareBuffers(ne,ae,Z)})}static isEqual(j,G){return De(this,arguments,function*(Y,Z,{methods:ne=["size","type","magic","byte"],byte:ae="buffer",partial:ce=!1,chunks:ve=null,worker:Me=!0}={}){let Te=null;for(let _e of ne){if(Te===!1||ce&&Te===!0)break;switch(_e){case"byte":case"bytes":case"content":ve=ve instanceof Array?ve:[Y.size],Te=!0;for(let it of ve){let Re=!1;Re=ae==="buffer"?yield this.bytesEqualWithArrayBuffer(Y,Z,it,Me):yield this.bytesEqualWithBinaryString(Y,Z,it,Me),Re||(Te=!1)}break;case"magic":case"headers":case"numbers":case"mime":Te=yield this.magicNumbersEqual(Y,Z,Me);break;case"size":case"sizes":Te=this.sizeEqual(Y,Z);break;case"type":case"types":Te=this.typeEqual(Y,Z);break;default:throw new Error("Blob-compare : Unknown comparison method")}}return Te})}}}])})}),L1e={};oe(L1e,{ToolbarDropdownSelect:()=>eAe,default:()=>nAe}),s.exports=re(L1e),Se();function WA(o,l,h=[]){if(typeof o=="object"&&o){if(kMe(o)||NMe(o)){l(o,h);return}for(let[m,_]of Object.entries(o))WA(_,l,[...h,m])}else{if(o==null)return;l(o,h)}}var kMe=o=>typeof o=="object"&&o!==null&&Object.hasOwnProperty.call(o,"type")&&o.type==="image"&&Object.hasOwnProperty.call(o,"id")&&typeof o.id=="string"&&o.id!=="",NMe=o=>typeof o=="object"&&o!==null&&Object.hasOwnProperty.call(o,"r")&&Object.hasOwnProperty.call(o,"g")&&Object.hasOwnProperty.call(o,"b")&&Object.hasOwnProperty.call(o,"a")&&typeof o.r=="number"&&typeof o.g=="number"&&typeof o.b=="number"&&typeof o.a=="number",F1e=rn();hn();var DMe=0,OMe=class{constructor(o){this._studio=o,se(this,"_id"),se(this,"_state",{type:"Ready"}),this._id=String(DMe++)}get status(){return this._state.type}reset(){let{_state:o}=this;if(o.type!=="Ready")if(o.type==="Captured")this._state={type:"Ready"},o.transaction.discard(),o.flagsTransaction.discard();else throw o.type==="Committed"?new Error("This scrub is already committed and can't be reset."):new Error("This scrub is already discarded and can't be reset.")}commit(){let{_state:o}=this;if(o.type==="Captured")o.transaction.commit(),o.flagsTransaction.discard(),this._state={type:"Committed"};else if(o.type==="Ready"){console.warn("Scrub is empty. Nothing to commit.");return}else throw o.type==="Committed"?new Error("This scrub is already committed."):new Error("This scrub is already discarded and can't be comitted.")}capture(o){if(this._state.type==="Captured"&&this.reset(),this._state.type==="Ready"){let l=!0;try{this._state=A({type:"Captured"},this._capture(o)),l=!1}finally{l&&(console.error("This scrub's callback threw an error. We're undo-ing all of the changes made by this scrub, and marking it as discarded."),this._state={type:"Discarded"})}}else throw this._state.type==="Committed"?new Error("This scrub is already committed and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.commit()"):new Error("This scrub is already discarded and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.discard()")}_capture(o){let l=[],h=this._studio.tempTransaction(_=>{let w=!0,C={set:(R,N)=>{if(!w)throw new Error("You seem to have called the scrub api after scrub.capture()");let{root:F,path:U}=(0,F1e.getPointerParts)(R);if(!Bt(F))throw new Error("We can only scrub props of Sheet Objects for now");_.set(R,N),l.push(R)}};try{o(C)}finally{w=!1}}),m=this._studio.tempTransaction(({stateEditors:_})=>{l.forEach(w=>{let{root:C,path:R}=(0,F1e.getPointerParts)(w);if(!Bt(C))return;let N=C.template.getDefaultsAtPointer(w);WA(N,(F,U)=>{_.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey.propsBeingScrubbed.flag(V(A({},C.address),{pathToProp:U}))},R)})});return{transaction:h,flagsTransaction:m}}discard(){let{_state:o}=this;if(o.type==="Captured"||o.type==="Ready")o.type==="Captured"&&(o.transaction.discard(),o.flagsTransaction.discard()),this._state={type:"Discarded"};else throw o.type==="Committed"?new Error("This scrub is already committed and can't be discarded."):new Error("This scrub is already discarded")}},LMe=rn(),B1e=typeof window<"u"?Promise.resolve().then(()=>(pMe(),S1e)).then(o=>o.default):null,FMe=class{constructor(o){this.studio=o,se(this,"_rendered",!1),se(this,"_nonSSRBits",B1e?B1e.then(l=>new l):Promise.reject()),se(this,"ready",this._nonSSRBits.then(()=>{},()=>{}))}render(){this._rendered||(this._rendered=!0,this._nonSSRBits.then(o=>{o.render()}).catch(o=>{throw console.error(o),o}))}hide(){this.studio.transaction(({drafts:o})=>{o.ahistoric.visibilityState="everythingIsHidden"})}restore(){this.render(),this.studio.transaction(({drafts:o})=>{o.ahistoric.visibilityState="everythingIsVisible"})}get isHidden(){return(0,LMe.val)(this.studio.atomP.ahistoric.visibilityState)==="everythingIsHidden"}renderToolset(o,l){let h=!1,m=null;return this._nonSSRBits.then(_=>{h||(m=_.renderToolset(o,l))}).catch(_=>{console.error(_)}),()=>{if(m){m();return}h||(h=!0)}}},$A=rn();function BMe(o){return o}var UMe=(o,l=BMe)=>{let h=m=>({type:o,payload:l(m)});return h.type=o,h.is=m=>m&&m.type&&m.type===o,h},n1=UMe,U1e=K(bMe()),z1e=K(RMe());w9();var qA,zMe=new Uint8Array(16);function VMe(){if(!qA&&(qA=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!qA))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qA(zMe)}var GMe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function jMe(o){return typeof o=="string"&&GMe.test(o)}var HMe=jMe,S0=[];for(XA=0;XA<256;++XA)S0.push((XA+256).toString(16).substr(1));var XA;function WMe(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=(S0[o[l+0]]+S0[o[l+1]]+S0[o[l+2]]+S0[o[l+3]]+"-"+S0[o[l+4]]+S0[o[l+5]]+"-"+S0[o[l+6]]+S0[o[l+7]]+"-"+S0[o[l+8]]+S0[o[l+9]]+"-"+S0[o[l+10]]+S0[o[l+11]]+S0[o[l+12]]+S0[o[l+13]]+S0[o[l+14]]+S0[o[l+15]]).toLowerCase();if(!HMe(h))throw TypeError("Stringified UUID is invalid");return h}var $Me=WMe;function qMe(o,l,h){o=o||{};var m=o.random||(o.rng||VMe)();if(m[6]=m[6]&15|64,m[8]=m[8]&63|128,l){h=h||0;for(var _=0;_<16;++_)l[h+_]=m[_];return l}return $Me(m)}var XMe=qMe,xS={replaceHistory:n1("@history/replaceHistory"),startHistoryFromScratch:n1("@history/startHistoryFromScratch"),undo:n1("@history/undo"),redo:n1("@history/redo")},YMe={type:"@history/unknownAction",payload:""},KMe={maxNumberOfCommits:100},ZMe=(o,l=KMe)=>{let h=WB(o(void 0,YMe));return function(m,_){return xS.startHistoryFromScratch.is(_)?WB(o(void 0,_.payload)):xS.replaceHistory.is(_)?_.payload:xS.undo.is(_)?m?eCe(m):h:xS.redo.is(_)?m?tCe(m):h:m?QMe(m,o(m.innerState,_),l):WB(o(void 0,_))}};function WB(o){return{currentCommitHash:void 0,commitsByHash:{},listOfCommitHashes:[],innerState:o}}function QMe(o,l,h){if(l===o.innerState)return o;let m=JMe(o.innerState,l);if(m.forwardDiff.length===0)return o;let _=Vm(o.listOfCommitHashes),w={currentCommitHash:m.hash,commitsByHash:A({},o.commitsByHash),listOfCommitHashes:[...o.listOfCommitHashes],innerState:l};if(o.currentCommitHash!==_){let C=o.listOfCommitHashes.findIndex(R=>R===o.currentCommitHash);o.listOfCommitHashes.slice(C+1).forEach(R=>{delete w.commitsByHash[R]}),w.listOfCommitHashes.splice(C+1,w.listOfCommitHashes.length)}if(w.listOfCommitHashes.push(m.hash),w.commitsByHash[m.hash]=m,w.listOfCommitHashes.length>h.maxNumberOfCommits){let C=w.listOfCommitHashes.length-h.maxNumberOfCommits;w.listOfCommitHashes.slice(0,C).forEach(R=>{delete w.commitsByHash[R]}),w.listOfCommitHashes.splice(0,C)}return w}function JMe(o,l){let h=U1e.default.diff(o,l,{invertible:!1}),m=U1e.default.diff(l,o,{invertible:!1}),_=Date.now(),w=XMe();return{forwardDiff:h,backwardDiff:m,timestamp:_,hash:w}}function eCe(o){if(o.currentCommitHash===void 0)return o;let l=o.listOfCommitHashes.findIndex(C=>C===o.currentCommitHash);if(l===-1)throw new Error("This should never happen");let h=o.commitsByHash[o.currentCommitHash],m=(0,z1e.default)(o.innerState,h.backwardDiff),_=l-1,w=_===-1?void 0:o.listOfCommitHashes[_];return V(A({},o),{currentCommitHash:w,innerState:m})}function tCe(o){if(o.listOfCommitHashes.length===0)return o;let l=o.listOfCommitHashes.findIndex(C=>C===o.currentCommitHash);if(l===o.listOfCommitHashes.length-1)return o;let h=l+1,m=o.listOfCommitHashes[h],_=o.commitsByHash[m],w=(0,z1e.default)(o.innerState,_.forwardDiff);return V(A({},o),{currentCommitHash:m,innerState:w})}dA();var YA={ahistoric:{visibilityState:"everythingIsVisible",theTrigger:{position:{closestCorner:"bottomLeft",distanceFromHorizontalEdge:.02,distanceFromVerticalEdge:.02}},coreByProject:{},projects:{stateByProjectId:{}}},historic:{projects:{stateByProjectId:{}},autoKey:!0,coreByProject:{},panels:{sequenceEditor:{rightPanelOpen:!0}},panelInstanceDesceriptors:{}},ephemeral:{initialised:!1,coreByProject:{},projects:{stateByProjectId:{}},extensions:{byId:{},paneClasses:{}},showOutline:!1}},V1e=n1("@storeBundle/replacePersistentState",o=>o),G1e=n1("@storeBundle/reduceParts",o=>o),G6={historic:xS,replacePersistentState:V1e,reduceParts:G1e},j1e=n1("@storeBundle/setInnerHistoricState",o=>o),nCe=(o=YA.historic,l)=>j1e.is(l)?l.payload:o,$B=ZMe(nCe),H1e=(o,l)=>{if(V1e.is(l)){let{historic:h,ahistoric:m}=l.payload,_=(o==null?void 0:o.ephemeral)||YA.ephemeral;return{$persistent:{historic:h,ahistoric:m},ephemeral:_}}else if(o){let{historic:h,ahistoric:m}=o.$persistent,{ephemeral:_}=o;if(G1e.is(l)){let w={historic:o.$persistent.historic.innerState,ahistoric:o.$persistent.ahistoric,ephemeral:o.ephemeral},C=l.payload(w);if(C===w)return o;h.innerState!==C.historic&&(h=$B(h,j1e(C.historic))),m=C.ahistoric,_=C.ephemeral}else{let w=$B(h,l);if(w===h)return o;h=w}return{$persistent:h===o.$persistent.historic&&m===o.$persistent.ahistoric?o.$persistent:{historic:h,ahistoric:m},ephemeral:_}}else{let h=$B(void 0,{}),m=YA.ahistoric,_=YA.ephemeral;return{$persistent:{historic:h,ahistoric:m},ephemeral:_}}},W1e=n1("@history/pushTempAction",o=>o),$1e=n1("@history/discardTempAction",o=>o),q1e=n1("@history/commitTempAction",o=>o),rCe=0,iCe=()=>{let o=rCe++;return{push:l=>W1e({id:o,originalAction:l}),discard:()=>$1e(o),commit:()=>q1e(o)}},sCe=(o,l)=>{if(o){let{tempActions:h,permanent:m}=o.$temps,_;if(W1e.is(l))h=[...h,l];else if(q1e.is(l)){let C=h.find(R=>R.payload.id===l.payload);C?(_=C.payload.originalAction,h=h.filter(R=>R.payload.id!==l.payload)):hA.error("Comitting temp action group ".concat(l.payload," isn't possible as this group doesn't exist"))}else $1e.is(l)?h=h.filter(C=>C.payload.id!==l.payload):_=l;_&&(m=H1e(o.$temps.permanent,_));let w={historic:m.$persistent.historic.innerState,ahistoric:m.$persistent.ahistoric,ephemeral:m.ephemeral};for(let C of h)w=C.payload.originalAction.payload(w);return A({$temps:{tempActions:h,permanent:m},$persistent:m.$persistent},w)}else{let h=H1e(void 0,l);return{$temps:{permanent:h,tempActions:[]},$persistent:h.$persistent,historic:h.$persistent.historic.innerState,ahistoric:h.$persistent.ahistoric,ephemeral:h.ephemeral}}};k9(),k9(),Yd();function X1e(o,l){if(typeof o!="object"||o===null)return;if(l.length===0){for(let C of Object.keys(o))delete o[C];return}let h=l.slice(0,l.length-1),m=o,_=new WeakMap;for(let C of h){let R=m,N=R[C];if(typeof N!="object"||N===null)return;_.set(N,R),m=N}let w=l.slice().reverse();for(let C of w){if(delete m[C],Object.keys(m).length>0)return;m=_.get(m)}}function oCe(o,{scale:l,origin:h,translate:m}){let _=h+(o-h)*l;return m+_}function uf(o){for(var l=arguments.length,h=Array(l>1?l-1:0),m=1;m<l;m++)h[m-1]=arguments[m];throw Error("[Immer] minified error nr: "+o+(h.length?" "+h.map(function(_){return"'"+_+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function j6(o){return!!o&&!!o[Ou]}function S8(o){return!!o&&(function(l){if(!l||typeof l!="object")return!1;var h=Object.getPrototypeOf(l);if(h===null)return!0;var m=Object.hasOwnProperty.call(h,"constructor")&&h.constructor;return m===Object||typeof m=="function"&&Function.toString.call(m)===fCe}(o)||Array.isArray(o)||!!o[ime]||!!o.constructor[ime]||XB(o)||YB(o))}function _S(o,l,h){h===void 0&&(h=!1),H6(o)===0?(h?Object.keys:aU)(o).forEach(function(m){h&&typeof m=="symbol"||l(m,o[m],o)}):o.forEach(function(m,_){return l(_,m,o)})}function H6(o){var l=o[Ou];return l?l.i>3?l.i-4:l.i:Array.isArray(o)?1:XB(o)?2:YB(o)?3:0}function qB(o,l){return H6(o)===2?o.has(l):Object.prototype.hasOwnProperty.call(o,l)}function aCe(o,l){return H6(o)===2?o.get(l):o[l]}function Y1e(o,l,h){var m=H6(o);m===2?o.set(l,h):m===3?(o.delete(l),o.add(h)):o[l]=h}function lCe(o,l){return o===l?o!==0||1/o==1/l:o!=o&&l!=l}function XB(o){return hCe&&o instanceof Map}function YB(o){return dCe&&o instanceof Set}function w8(o){return o.o||o.t}function KB(o){if(Array.isArray(o))return Array.prototype.slice.call(o);var l=pCe(o);delete l[Ou];for(var h=aU(l),m=0;m<h.length;m++){var _=h[m],w=l[_];w.writable===!1&&(w.writable=!0,w.configurable=!0),(w.get||w.set)&&(l[_]={configurable:!0,writable:!0,enumerable:w.enumerable,value:o[_]})}return Object.create(Object.getPrototypeOf(o),l)}function ZB(o,l){return l===void 0&&(l=!1),QB(o)||j6(o)||!S8(o)||(H6(o)>1&&(o.set=o.add=o.clear=o.delete=cCe),Object.freeze(o),l&&_S(o,function(h,m){return ZB(m,!0)},!0)),o}function cCe(){uf(2)}function QB(o){return o==null||typeof o!="object"||Object.isFrozen(o)}function ag(o){var l=mCe[o];return l||uf(18,o),l}function K1e(){return bS}function JB(o,l){l&&(ag("Patches"),o.u=[],o.s=[],o.v=l)}function KA(o){eU(o),o.p.forEach(uCe),o.p=null}function eU(o){o===bS&&(bS=o.l)}function Z1e(o){return bS={p:[],l:bS,h:o,m:!0,_:0}}function uCe(o){var l=o[Ou];l.i===0||l.i===1?l.j():l.O=!0}function tU(o,l){l._=l.p.length;var h=l.p[0],m=o!==void 0&&o!==h;return l.h.g||ag("ES5").S(l,o,m),m?(h[Ou].P&&(KA(l),uf(4)),S8(o)&&(o=ZA(l,o),l.l||QA(l,o)),l.u&&ag("Patches").M(h[Ou],o,l.u,l.s)):o=ZA(l,h,[]),KA(l),l.u&&l.v(l.u,l.s),o!==rme?o:void 0}function ZA(o,l,h){if(QB(l))return l;var m=l[Ou];if(!m)return _S(l,function(w,C){return Q1e(o,m,l,w,C,h)},!0),l;if(m.A!==o)return l;if(!m.P)return QA(o,m.t,!0),m.t;if(!m.I){m.I=!0,m.A._--;var _=m.i===4||m.i===5?m.o=KB(m.k):m.o;_S(m.i===3?new Set(_):_,function(w,C){return Q1e(o,m,_,w,C,h)}),QA(o,_,!1),h&&o.u&&ag("Patches").R(m,h,o.u,o.s)}return m.o}function Q1e(o,l,h,m,_,w){if(j6(_)){var C=ZA(o,_,w&&l&&l.i!==3&&!qB(l.D,m)?w.concat(m):void 0);if(Y1e(h,m,C),!j6(C))return;o.m=!1}if(S8(_)&&!QB(_)){if(!o.h.F&&o._<1)return;ZA(o,_),l&&l.A.l||QA(o,_)}}function QA(o,l,h){h===void 0&&(h=!1),o.h.F&&o.m&&ZB(l,h)}function nU(o,l){var h=o[Ou];return(h?w8(h):o)[l]}function J1e(o,l){if(l in o)for(var h=Object.getPrototypeOf(o);h;){var m=Object.getOwnPropertyDescriptor(h,l);if(m)return m;h=Object.getPrototypeOf(h)}}function rU(o){o.P||(o.P=!0,o.l&&rU(o.l))}function iU(o){o.o||(o.o=KB(o.t))}function sU(o,l,h){var m=XB(l)?ag("MapSet").N(l,h):YB(l)?ag("MapSet").T(l,h):o.g?function(_,w){var C=Array.isArray(_),R={i:C?1:0,A:w?w.A:K1e(),P:!1,I:!1,D:{},l:w,t:_,k:null,o:null,j:null,C:!1},N=R,F=eP;C&&(N=[R],F=tP);var U=Proxy.revocable(N,F),$=U.revoke,j=U.proxy;return R.k=j,R.j=$,j}(l,h):ag("ES5").J(l,h);return(h?h.A:K1e()).p.push(m),m}function JA(o){return j6(o)||uf(22,o),function l(h){if(!S8(h))return h;var m,_=h[Ou],w=H6(h);if(_){if(!_.P&&(_.i<4||!ag("ES5").K(_)))return _.t;_.I=!0,m=eme(h,w),_.I=!1}else m=eme(h,w);return _S(m,function(C,R){_&&aCe(_.t,C)===R||Y1e(m,C,l(R))}),w===3?new Set(m):m}(o)}function eme(o,l){switch(l){case 2:return new Map(o);case 3:return Array.from(o)}return KB(o)}var tme,bS,oU=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",hCe=typeof Map<"u",dCe=typeof Set<"u",nme=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",rme=oU?Symbol.for("immer-nothing"):((tme={})["immer-nothing"]=!0,tme),ime=oU?Symbol.for("immer-draftable"):"__$immer_draftable",Ou=oU?Symbol.for("immer-state"):"__$immer_state",fCe=""+Object.prototype.constructor,aU=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:Object.getOwnPropertyNames,pCe=Object.getOwnPropertyDescriptors||function(o){var l={};return aU(o).forEach(function(h){l[h]=Object.getOwnPropertyDescriptor(o,h)}),l},mCe={},eP={get:function(o,l){if(l===Ou)return o;var h=w8(o);if(!qB(h,l))return function(_,w,C){var R,N=J1e(w,C);return N?"value"in N?N.value:(R=N.get)===null||R===void 0?void 0:R.call(_.k):void 0}(o,h,l);var m=h[l];return o.I||!S8(m)?m:m===nU(o.t,l)?(iU(o),o.o[l]=sU(o.A.h,m,o)):m},has:function(o,l){return l in w8(o)},ownKeys:function(o){return Reflect.ownKeys(w8(o))},set:function(o,l,h){var m=J1e(w8(o),l);if(m!=null&&m.set)return m.set.call(o.k,h),!0;if(!o.P){var _=nU(w8(o),l),w=_==null?void 0:_[Ou];if(w&&w.t===h)return o.o[l]=h,o.D[l]=!1,!0;if(lCe(h,_)&&(h!==void 0||qB(o.t,l)))return!0;iU(o),rU(o)}return o.o[l]===h&&typeof h!="number"&&(h!==void 0||l in o.o)||(o.o[l]=h,o.D[l]=!0,!0)},deleteProperty:function(o,l){return nU(o.t,l)!==void 0||l in o.t?(o.D[l]=!1,iU(o),rU(o)):delete o.D[l],o.o&&delete o.o[l],!0},getOwnPropertyDescriptor:function(o,l){var h=w8(o),m=Reflect.getOwnPropertyDescriptor(h,l);return m&&{writable:!0,configurable:o.i!==1||l!=="length",enumerable:m.enumerable,value:h[l]}},defineProperty:function(){uf(11)},getPrototypeOf:function(o){return Object.getPrototypeOf(o.t)},setPrototypeOf:function(){uf(12)}},tP={};_S(eP,function(o,l){tP[o]=function(){return arguments[0]=arguments[0][0],l.apply(this,arguments)}}),tP.deleteProperty=function(o,l){return eP.deleteProperty.call(this,o[0],l)},tP.set=function(o,l,h){return eP.set.call(this,o[0],l,h,o[0])};var gCe=function(){function o(h){var m=this;this.g=nme,this.F=!0,this.produce=function(_,w,C){if(typeof _=="function"&&typeof w!="function"){var R=w;w=_;var N=m;return function(G){var Y=this;G===void 0&&(G=R);for(var Z=arguments.length,ne=Array(Z>1?Z-1:0),ae=1;ae<Z;ae++)ne[ae-1]=arguments[ae];return N.produce(G,function(ce){var ve;return(ve=w).call.apply(ve,[Y,ce].concat(ne))})}}var F;if(typeof w!="function"&&uf(6),C!==void 0&&typeof C!="function"&&uf(7),S8(_)){var U=Z1e(m),$=sU(m,_,void 0),j=!0;try{F=w($),j=!1}finally{j?KA(U):eU(U)}return typeof Promise<"u"&&F instanceof Promise?F.then(function(G){return JB(U,C),tU(G,U)},function(G){throw KA(U),G}):(JB(U,C),tU(F,U))}if(!_||typeof _!="object")return(F=w(_))===rme?void 0:(F===void 0&&(F=_),m.F&&ZB(F,!0),F);uf(21,_)},this.produceWithPatches=function(_,w){return typeof _=="function"?function(N){for(var F=arguments.length,U=Array(F>1?F-1:0),$=1;$<F;$++)U[$-1]=arguments[$];return m.produceWithPatches(N,function(j){return _.apply(void 0,[j].concat(U))})}:[m.produce(_,w,function(N,F){C=N,R=F}),C,R];var C,R},typeof(h==null?void 0:h.useProxies)=="boolean"&&this.setUseProxies(h.useProxies),typeof(h==null?void 0:h.autoFreeze)=="boolean"&&this.setAutoFreeze(h.autoFreeze)}var l=o.prototype;return l.createDraft=function(h){S8(h)||uf(8),j6(h)&&(h=JA(h));var m=Z1e(this),_=sU(this,h,void 0);return _[Ou].C=!0,eU(m),_},l.finishDraft=function(h,m){var _=h&&h[Ou],w=_.A;return JB(w,m),tU(void 0,w)},l.setAutoFreeze=function(h){this.F=h},l.setUseProxies=function(h){h&&!nme&&uf(20),this.g=h},l.applyPatches=function(h,m){var _;for(_=m.length-1;_>=0;_--){var w=m[_];if(w.path.length===0&&w.op==="replace"){h=w.value;break}}var C=ag("Patches").$;return j6(h)?C(h,m):this.produce(h,function(R){return C(R,m.slice(_+1))})},o}(),Lu=new gCe;Lu.produce,Lu.produceWithPatches.bind(Lu),Lu.setAutoFreeze.bind(Lu),Lu.setUseProxies.bind(Lu),Lu.applyPatches.bind(Lu);var lU=Lu.createDraft.bind(Lu),cU=Lu.finishDraft.bind(Lu);KT(),$l(),Or(),po(),za(),aA(),m0(),hn();var go={create(o){let l={byId:{},allIds:{}};if(o)for(let[h,m]of o)l.byId[h]=m,l.allIds[h]=!0;return l},shallowCopy(o){return{byId:A({},o==null?void 0:o.byId),allIds:A({},o==null?void 0:o.allIds)}},add(o,l,h){return{byId:V(A({},o==null?void 0:o.byId),{[l]:h}),allIds:V(A({},o==null?void 0:o.allIds),{[l]:!0})}},merge(o){let l=go.create();for(let h=0;h<o.length;h++)l.byId=A(A({},l.byId),o[h].byId),l.allIds=A(A({},l.allIds),o[h].allIds);return l},remove(o,l){let h=go.shallowCopy(o);return delete h.allIds[l],delete h.byId[l],h},filter(o,l){let h=go.shallowCopy(o);for(let[m,_]of Object.entries(h.byId))l(_)||(delete h.allIds[m],delete h.byId[m]);return h}},sme=o=>(uU=o,hU),uU,w0=()=>{if(uU===void 0)throw new Error("Calling stateEditors outside of a transaction is not allowed.");return uU},hU;(o=>{(l=>{(h=>{(m=>{function _(w){let C=w0().historic;C.panelPositions!=null||(C.panelPositions={}),C.panelPositions[w.panelId]=w.position}m.setPanelPosition=_})(h.panelPositions||(h.panelPositions={})),(m=>{function _(){var w;return(w=w0().historic).panels!=null||(w.panels={}),w0().historic.panels}m._ensure=_,(w=>{function C(){let R=o.studio.historic.panels._ensure();return R.outlinePanel!=null||(R.outlinePanel={}),R.outlinePanel}w._ensure=C,(R=>{function N(U){let $=[];for(let j of Ds(U))ut(j)?$.push(A({type:"Project"},j.address)):Pe(j)?($.push(A({type:"Sheet"},j.template.address)),o.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(j.address)):vt(j)?$.push(A({type:"Sheet"},j.address)):Bt(j)?($.push(A({type:"SheetObject"},j.template.address)),o.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(j.sheet.address)):Pt(j)&&$.push(A({type:"SheetObject"},j.address));w._ensure().selection=$}R.set=N;function F(){w._ensure().selection=[]}R.unset=F})(w.selection||(w.selection={}))})(m.outline||(m.outline={})),(w=>{function C(){let U=o.studio.historic.panels._ensure();return U.sequenceEditor!=null||(U.sequenceEditor={}),U.sequenceEditor}w._ensure=C,(U=>{function $(){let G=w._ensure();return G.graphEditor!=null||(G.graphEditor={height:.5,isOpen:!1}),G.graphEditor}function j(G){$().isOpen=G.isOpen}U.setIsOpen=j})(w.graphEditor||(w.graphEditor={}));function R(U){let $=w._ensure();$.rightPanelOpen=U}w.setRightPanelOpen=R;function N(U){let $=w._ensure();$.dopesheetLeftWidth=U}w.setDopesheetLeftWidth=N;function F(){let U=w._ensure();return U.rightPanelOpen===void 0&&(U.rightPanelOpen=!0),U.rightPanelOpen}w._ensureRightPanelOpen=F})(m.sequenceEditor||(m.sequenceEditor={}))})(h.panels||(h.panels={})),(m=>{(_=>{function w(C){let R=w0().historic;return R.projects.stateByProjectId[C.projectId]||(R.projects.stateByProjectId[C.projectId]={stateBySheetId:{}}),R.projects.stateByProjectId[C.projectId]}_._ensure=w,(C=>{function R(F){let U=o.studio.historic.projects.stateByProjectId._ensure(F);return U.stateBySheetId[F.sheetId]||(U.stateBySheetId[F.sheetId]={selectedInstanceId:void 0,sequenceEditor:{selectedPropsByObject:{}}}),U.stateBySheetId[F.sheetId]}C._ensure=R;function N(F){o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(F).selectedInstanceId=F.sheetInstanceId}C.setSelectedInstanceId=N,(F=>{function U(Re){let{selectedPropsByObject:xe}=C._ensure(Re).sequenceEditor;xe[Re.objectKey]||(xe[Re.objectKey]={});let Oe=xe[Re.objectKey],He=nf(Re.pathToProp),Fe=new Set(Object.keys(Jb));for(let[Ve,Ht]of Object.entries(JA(xe)))for(let[ot,Ye]of Object.entries(Ht))Fe.delete(Ye);let Nt=Fe.size>0?Fe.values().next().value:Object.keys(Jb)[0];Oe[He]=Nt}F.addPropToGraphEditor=U;function $(Re){let{selectedPropsByObject:xe}=C._ensure(Re).sequenceEditor;if(!xe[Re.objectKey])return;let Oe=xe[Re.objectKey],He=nf(Re.pathToProp);Oe[He]&&X1e(xe,[Re.objectKey,He])}F.removePropFromGraphEditor=$;function j(Re){let xe=o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(Re).sequenceEditor;return xe.markerSet||(xe.markerSet=go.create()),xe.markerSet}function G(Re){let xe=j(Re.sheetAddress),Oe=Re.markers.filter(ot=>!!isFinite(ot.position)).map(ot=>V(A({},ot),{position:Re.snappingFunction(ot.position)})),He=Up(Oe,"id"),Fe=go.filter(xe,ot=>ot&&!He[ot.id]),Nt=Up(Object.values(Fe.byId),"position");Oe.forEach(({position:ot})=>{let Ye=Nt[ot];Ye&&(Fe=go.remove(Fe,Ye.id))}),Object.assign(xe,go.merge([Fe,go.create(Oe.map(ot=>[ot.id,ot]))]));let Ve=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);Ve.sequence||(Ve.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let Ht=[...Object.values(Fe.byId).filter(ot=>ot!==void 0),...Oe].sort((ot,Ye)=>ot.position-Ye.position);Ve.sequence.markers=Ht.map(ot=>({id:ot.id,label:ot.label,position:ot.position}))}F.replaceMarkers=G;function Y(Re){var xe;let Oe=j(Re.sheetAddress);Object.assign(Oe,go.remove(Oe,Re.markerId));let He=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);(xe=He.sequence)!=null&&xe.markers&&(He.sequence.markers=He.sequence.markers.filter(Fe=>Fe.id!==Re.markerId))}F.removeMarker=Y;function Z(Re){var xe;let Oe=j(Re.sheetAddress).byId[Re.markerId];if(Oe!==void 0){Oe.label=Re.label;let He=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);if((xe=He.sequence)!=null&&xe.markers){let Fe=He.sequence.markers.find(Nt=>Nt.id===Re.markerId);Fe&&(Fe.label=Re.label)}}}F.updateMarker=Z;function ne(Re){let xe=o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(Re).sequenceEditor;return xe.eventSet||(xe.eventSet=go.create()),xe.eventSet}function ae(Re){let xe=ne(Re.sheetAddress),Oe=Re.events.filter(ot=>isFinite(ot.position)?!ot.name||typeof ot.name!="string"?(console.warn("Event filtered out: invalid name",ot),!1):!0:(console.warn("Event filtered out: invalid position",ot),!1)).map(ot=>V(A({},ot),{position:Re.snappingFunction?Re.snappingFunction(ot.position):ot.position})),He=Up(Oe,"id"),Fe=go.filter(xe,ot=>ot&&!He[ot.id]),Nt=Up(Object.values(Fe.byId),"position");Oe.forEach(({position:ot})=>{let Ye=Nt[ot];Ye&&(Fe=go.remove(Fe,Ye.id))}),Object.assign(xe,go.merge([Fe,go.create(Oe.map(ot=>[ot.id,ot]))]));let Ve=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);Ve.sequence||(Ve.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let Ht=[...Object.values(Fe.byId).filter(ot=>ot!==void 0),...Oe].sort((ot,Ye)=>ot.position-Ye.position);Ve.sequence.events=Ht.map(ot=>({id:ot.id,name:ot.name,position:ot.position,value:ot.value}))}F.replaceEvents=ae;function ce(Re){var xe;let Oe=ne(Re.sheetAddress);Object.assign(Oe,go.remove(Oe,Re.eventId));let He=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);(xe=He.sequence)!=null&&xe.events&&(He.sequence.events=He.sequence.events.filter(Fe=>Fe.id!==Re.eventId))}F.removeEvent=ce;function ve(Re){var xe;let Oe=ne(Re.sheetAddress).byId[Re.eventId];if(Oe!==void 0){Oe.name=Re.name,Oe.value=Re.value;let He=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);if((xe=He.sequence)!=null&&xe.events){let Fe=He.sequence.events.find(Nt=>Nt.id===Re.eventId);Fe&&(Fe.name=Re.name,Fe.value=Re.value)}}}F.updateEvent=ve;function Me(Re){let xe=o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(Re).sequenceEditor;return xe.subSequenceSet||(xe.subSequenceSet=go.create()),xe.subSequenceSet}function Te(Re){let xe=Me(Re.sheetAddress),Oe=Re.subSequences.filter(ot=>isFinite(ot.position)?!ot.sheetId||typeof ot.sheetId!="string"?(console.warn("SubSequence filtered out: invalid sheetId",ot),!1):ot.duration!==void 0&&!isFinite(ot.duration)?(console.warn("SubSequence filtered out: invalid duration",ot),!1):ot.timeScale!==void 0&&(!isFinite(ot.timeScale)||ot.timeScale<=0)?(console.warn("SubSequence filtered out: invalid timeScale",ot),!1):!0:(console.warn("SubSequence filtered out: invalid position",ot),!1)).map(ot=>{var Ye;return V(A({},ot),{position:Re.snappingFunction(ot.position),timeScale:(Ye=ot.timeScale)!=null?Ye:1})}),He=Up(Oe,"id"),Fe=go.filter(xe,ot=>ot&&!He[ot.id]),Nt=Object.values(Fe.byId).filter(ot=>ot!==void 0);Oe.forEach(ot=>{var Ye;let Ee=ot.position,et=ot.position+((Ye=ot.duration)!=null?Ye:0);Nt.forEach(At=>{var Ce;let Ze=At.position,Ft=At.position+((Ce=At.duration)!=null?Ce:0);Ee<Ft&&et>Ze&&(Fe=go.remove(Fe,At.id))})}),Object.assign(xe,go.merge([Fe,go.create(Oe.map(ot=>[ot.id,ot]))]));let Ve=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);Ve.sequence||(Ve.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let Ht=[...Object.values(Fe.byId).filter(ot=>ot!==void 0),...Oe].sort((ot,Ye)=>ot.position-Ye.position);Ve.sequence.subSequences=Ht.map(ot=>({id:ot.id,sheetId:ot.sheetId,position:ot.position,duration:ot.duration,timeScale:ot.timeScale,label:ot.label}))}F.replaceSubSequences=Te;function _e(Re){var xe;let Oe=Me(Re.sheetAddress);Object.assign(Oe,go.remove(Oe,Re.subSequenceId));let He=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);(xe=He.sequence)!=null&&xe.subSequences&&(He.sequence.subSequences=He.sequence.subSequences.filter(Fe=>Fe.id!==Re.subSequenceId))}F.removeSubSequence=_e;function it(Re){var xe;let Oe=Me(Re.sheetAddress).byId[Re.subSequenceId];if(Oe!==void 0){Re.updates.position!==void 0&&(Oe.position=Re.updates.position),Re.updates.duration!==void 0&&(Oe.duration=Re.updates.duration),Re.updates.timeScale!==void 0&&(Oe.timeScale=Re.updates.timeScale),Re.updates.label!==void 0&&(Oe.label=Re.updates.label);let He=o.coreByProject.historic.sheetsById._ensure(Re.sheetAddress);if((xe=He.sequence)!=null&&xe.subSequences){let Fe=He.sequence.subSequences.find(Nt=>Nt.id===Re.subSequenceId);Fe&&(Re.updates.position!==void 0&&(Fe.position=Re.updates.position),Re.updates.duration!==void 0&&(Fe.duration=Re.updates.duration),Re.updates.timeScale!==void 0&&(Fe.timeScale=Re.updates.timeScale),Re.updates.label!==void 0&&(Fe.label=Re.updates.label))}}}F.updateSubSequence=it})(C.sequenceEditor||(C.sequenceEditor={}))})(_.stateBySheetId||(_.stateBySheetId={}))})(m.stateByProjectId||(m.stateByProjectId={}))})(h.projects||(h.projects={}))})(l.historic||(l.historic={})),(h=>{function m(_){w0().ephemeral.showOutline=_}h.setShowOutline=m,(_=>{(w=>{function C(R){let N=w0().ephemeral;return N.projects.stateByProjectId[R.projectId]||(N.projects.stateByProjectId[R.projectId]={stateBySheetId:{}}),N.projects.stateByProjectId[R.projectId]}w._ensure=C,(R=>{function N(F){let U=o.studio.ephemeral.projects.stateByProjectId._ensure(F);return U.stateBySheetId[F.sheetId]||(U.stateBySheetId[F.sheetId]={stateByObjectKey:{}}),U.stateBySheetId[F.sheetId]}R._ensure=N,(F=>{function U($){var j;let G=o.studio.ephemeral.projects.stateByProjectId.stateBySheetId._ensure($).stateByObjectKey;return G[j=$.objectKey]!=null||(G[j]={}),G[$.objectKey]}F._ensure=U,($=>{function j(Y){let Z=o.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey._ensure(Y);return Z.valuesBeingScrubbed!=null||(Z.valuesBeingScrubbed={}),Z.valuesBeingScrubbed}$._ensure=j;function G(Y){to(j(Y),Y.pathToProp,!0)}$.flag=G})(F.propsBeingScrubbed||(F.propsBeingScrubbed={}))})(R.stateByObjectKey||(R.stateByObjectKey={}))})(w.stateBySheetId||(w.stateBySheetId={}))})(_.stateByProjectId||(_.stateByProjectId={}))})(h.projects||(h.projects={}))})(l.ephemeral||(l.ephemeral={})),(h=>{function m(N){w0().ahistoric.pinOutline=N}h.setPinOutline=m;function _(N){w0().ahistoric.pinDetails=N}h.setPinDetails=_;function w(N){w0().ahistoric.pinNotifications=N}h.setPinNotifications=w;function C(N){w0().ahistoric.visibilityState=N}h.setVisibilityState=C;function R(N){let F=SL(N.map(j=>j.pathToProp)),U=N.map(({keyframe:j,pathToProp:G})=>({keyframe:j,pathToProp:G.slice(F.length)})),$=w0();$.ahistoric.clipboard?$.ahistoric.clipboard.keyframesWithRelativePaths=U:$.ahistoric.clipboard={keyframesWithRelativePaths:U}}h.setClipboardKeyframes=R,(N=>{(F=>{function U($){let j=w0().ahistoric;return j.projects.stateByProjectId[$.projectId]||(j.projects.stateByProjectId[$.projectId]={stateBySheetId:{}}),j.projects.stateByProjectId[$.projectId]}F._ensure=U,($=>{function j(Y){let Z=o.studio.ahistoric.projects.stateByProjectId._ensure(Y);return Z.collapsedItemsInOutline||(Z.collapsedItemsInOutline={}),Z.collapsedItemsInOutline}$._ensure=j;function G(Y){let Z=o.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline._ensure(Y);Y.isCollapsed?Z[Y.itemKey]=!0:delete Z[Y.itemKey]}$.set=G})(F.collapsedItemsInOutline||(F.collapsedItemsInOutline={})),($=>{function j(G){let Y=o.studio.ahistoric.projects.stateByProjectId._ensure(G);return Y.stateBySheetId[G.sheetId]||(Y.stateBySheetId[G.sheetId]={}),Y.stateBySheetId[G.sheetId]}$._ensure=j,(G=>{function Y(Z){let ne=o.studio.ahistoric.projects.stateByProjectId.stateBySheetId._ensure(Z);return ne.sequence||(ne.sequence={}),ne.sequence}G._ensure=Y,(Z=>{function ne(ce){o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ce).focusRange={range:ce.range,enabled:ce.enabled}}Z.set=ne;function ae(ce){o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ce).focusRange=void 0}Z.unset=ae})(G.focusRange||(G.focusRange={})),(Z=>{function ne(ae){o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ae).clippedSpaceRange=A({},ae.range)}Z.set=ne})(G.clippedSpaceRange||(G.clippedSpaceRange={})),(Z=>{function ne(ce){let ve=o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ce),Me=ve.collapsableItems;return Me||(Me=ve.collapsableItems=go.create()),Me}function ae(ce){let ve=ne(ce);Object.assign(ve,go.add(ve,ce.studioSheetItemKey,{isCollapsed:ce.isCollapsed}))}Z.set=ae})(G.sequenceEditorCollapsableItems||(G.sequenceEditorCollapsableItems={}))})($.sequence||($.sequence={}))})(F.stateBySheetId||(F.stateBySheetId={}))})(N.stateByProjectId||(N.stateByProjectId={}))})(h.projects||(h.projects={}))})(l.ahistoric||(l.ahistoric={}))})(o.studio||(o.studio={})),(l=>{(h=>{(m=>{function _(w){let C=w0().historic.coreByProject[w.projectId].revisionHistory,R=50;C.unshift(w.revision),C.length>R&&(C.length=R)}m.add=_})(h.revisionHistory||(h.revisionHistory={})),(m=>{function _(R){let N=w0().historic.coreByProject[R.projectId].sheetsById;return N[R.sheetId]||(N[R.sheetId]={staticOverrides:{byObject:{}}}),N[R.sheetId]}m._ensure=_;function w(R){let N=w0().historic.coreByProject[R.projectId].sheetsById[R.sheetId];if(!N)return;delete N.staticOverrides.byObject[R.objectKey];let F=N.sequence;F&&delete F.tracksByObject[R.objectKey]}m.forgetObject=w;function C(R){w0().historic.coreByProject[R.projectId].sheetsById[R.sheetId]&&delete w0().historic.coreByProject[R.projectId].sheetsById[R.sheetId]}m.forgetSheet=C,(R=>{function N(xe){let Oe=o.coreByProject.historic.sheetsById._ensure(xe);return Oe.sequence!=null||(Oe.sequence={subUnitsPerUnit:30,length:10,type:"PositionalSequence",tracksByObject:{}}),Oe.sequence}R._ensure=N;function F(xe){N(xe).length=Bi(parseFloat(xe.length.toFixed(2)),.01,1/0)}R.setLength=F;function U(xe){N(xe).subUnitsPerUnit=Bi(xe.subUnitsPerUnit,1,L(2,12))}R.setSubUnitsPerUnit=U;function $(xe){var Oe;let He=o.coreByProject.historic.sheetsById.sequence._ensure(xe).tracksByObject;return He[Oe=xe.objectKey]!=null||(He[Oe]={trackData:{},trackIdByPropPath:{}}),He[xe.objectKey]}function j(xe,Oe){let He=$(xe),Fe=nf(xe.pathToProp);if(typeof He.trackIdByPropPath[Fe]=="string")return;let Nt=Wbe(),Ve={type:"BasicKeyframedTrack",__debugName:"".concat(xe.objectKey,":").concat(Fe),keyframes:[]};He.trackData[Nt]=Ve,He.trackIdByPropPath[Fe]=Nt}R.setPrimitivePropAsSequenced=j;function G(xe){let Oe=$(xe),He=nf(xe.pathToProp),Fe=Oe.trackIdByPropPath[He];typeof Fe=="string"&&(delete Oe.trackIdByPropPath[He],delete Oe.trackData[Fe],o.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(xe))}R.setPrimitivePropAsStatic=G;function Y(xe){let Oe=$(xe);for(let He of Object.keys(Oe.trackIdByPropPath)){let Fe=JSON.parse(He);if(xe.pathToProp.every((Nt,Ve)=>Fe[Ve]===Nt)){let Nt=Oe.trackIdByPropPath[He];if(typeof Nt!="string")continue;delete Oe.trackIdByPropPath[He],delete Oe.trackData[Nt]}}o.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfCompoundProp(xe)}R.setCompoundPropAsStatic=Y;function Z(xe){return $(xe).trackData[xe.trackId]}function ne(xe){let Oe=Z(xe);if(Oe)return Oe.keyframes.find(He=>He.id===xe.keyframeId)}function ae(xe){let Oe=xe.snappingFunction(xe.position),He=Z(xe);if(!He)return;let{keyframes:Fe}=He,Nt=Fe.findIndex(ot=>ot.position===Oe);if(Nt!==-1){let ot=Fe[Nt];ot.value=xe.value;return}let Ve=YT(Fe,ot=>ot.position<Oe);if(Ve===-1){Fe.unshift({id:zZ(),position:Oe,connectedRight:!0,handles:xe.handles||[.5,1,.5,0],type:xe.type||"bezier",value:xe.value});return}let Ht=Fe[Ve];Fe.splice(Ve+1,0,{id:zZ(),position:Oe,connectedRight:Ht.connectedRight,handles:xe.handles||[.5,1,.5,0],type:xe.type||"bezier",value:xe.value})}R.setKeyframeAtPosition=ae;function ce(xe){let Oe=Z(xe);if(!Oe)return;let{keyframes:He}=Oe,Fe=He.findIndex(Nt=>Nt.position===xe.position);Fe!==-1&&He.splice(Fe,1)}R.unsetKeyframeAtPosition=ce;function ve(xe){let Oe=Z(xe);if(!Oe)return;let He=JA(Oe.keyframes).filter(Fe=>xe.keyframeIds.includes(Fe.id)).map(Fe=>{let Nt=Fe.position,Ve=xe.snappingFunction(oCe(Nt,xe));return V(A({},Fe),{position:Ve})});Re(V(A({},xe),{keyframes:He}))}R.transformKeyframes=ve;function Me(xe){let Oe=Z(xe);Oe&&(Oe.keyframes=Oe.keyframes.map((He,Fe)=>{let Nt=Oe.keyframes[Fe-1],Ve=xe.keyframeIds.includes(He.id),Ht=xe.keyframeIds.includes(Nt==null?void 0:Nt.id);return Ve&&!Ht?V(A({},He),{handles:[He.handles[0],He.handles[1],xe.handles[0],xe.handles[1]]}):Ve&&Ht?V(A({},He),{handles:[xe.handles[2],xe.handles[3],xe.handles[0],xe.handles[1]]}):Ht?V(A({},He),{handles:[xe.handles[2],xe.handles[3],He.handles[2],He.handles[3]]}):He}))}R.setTweenBetweenKeyframes=Me;function Te(xe){var Oe,He,Fe,Nt,Ve,Ht,ot,Ye;let Ee=ne(xe);Ee&&(Ee.handles=[(He=(Oe=xe.end)==null?void 0:Oe[0])!=null?He:Ee.handles[0],(Nt=(Fe=xe.end)==null?void 0:Fe[1])!=null?Nt:Ee.handles[1],(Ht=(Ve=xe.start)==null?void 0:Ve[0])!=null?Ht:Ee.handles[2],(Ye=(ot=xe.start)==null?void 0:ot[1])!=null?Ye:Ee.handles[3]])}R.setHandlesForKeyframe=Te;function _e(xe){let Oe=Z(xe);Oe&&(Oe.keyframes=Oe.keyframes.filter(He=>xe.keyframeIds.indexOf(He.id)===-1))}R.deleteKeyframes=_e;function it(xe){let Oe=ne(xe);Oe&&(Oe.type=xe.keyframeType)}R.setKeyframeType=it;function Re(xe){let Oe=Z(xe);if(!Oe)return;let He=JA(Oe.keyframes),Fe=xe.keyframes.filter(Ye=>!(typeof Ye.value=="number"&&!isFinite(Ye.value)||!Ye.handles.every(Ee=>isFinite(Ee)))).map(Ye=>V(A({},Ye),{position:xe.snappingFunction(Ye.position)})),Nt=Up(Fe,"id"),Ve=He.filter(Ye=>!Nt[Ye.id]),Ht=Up(Ve,"position");Fe.forEach(({position:Ye})=>{let Ee=Ht[Ye];Ee&&Gn(Ve,Ee)});let ot=No([...Ve,...Fe],"position");Oe.keyframes=ot}R.replaceKeyframes=Re})(m.sequence||(m.sequence={})),(R=>{(N=>{function F(G){var Y;let Z=o.coreByProject.historic.sheetsById._ensure(G).staticOverrides.byObject;return Z[Y=G.objectKey]!=null||(Z[Y]={}),Z[G.objectKey]}function U(G){let Y=F(G);to(Y,G.pathToProp,G.value)}N.setValueOfCompoundProp=U;function $(G){let Y=F(G);to(Y,G.pathToProp,G.value)}N.setValueOfPrimitiveProp=$;function j(G){let Y=o.coreByProject.historic.sheetsById._ensure(G).staticOverrides.byObject[G.objectKey];Y&&X1e(Y,G.pathToProp)}N.unsetValueOfPrimitiveProp=j})(R.byObject||(R.byObject={}))})(m.staticOverrides||(m.staticOverrides={}))})(h.sheetsById||(h.sheetsById={}))})(l.historic||(l.historic={}))})(o.coreByProject||(o.coreByProject={}))})(hU||(hU={}));function dU(){let o,l,h=new Promise((_,w)=>{o=C=>{_(C),m.status="resolved"},l=C=>{w(C),m.status="rejected"}}),m={resolve:o,reject:l,promise:h,status:"pending"};return m}var vCe=rn();function yCe(o){let l=o.getState(),h=new vCe.Atom(l);return o.subscribe(()=>{let m=o.getState();h.set(m),l=m}),h}q4();function xCe(o){var l,h=o.Symbol;return typeof h=="function"?h.observable?l=h.observable:(l=h("observable"),h.observable=l):l="@@observable",l}var SS;typeof self<"u"?SS=self:typeof window<"u"?SS=window:typeof A0<"u"?SS=A0:SS=s;var _Ce=xCe(SS),ome=_Ce,ame={INIT:"@@redux/INIT"};function lme(o,l,h){var m;if(typeof l=="function"&&typeof h>"u"&&(h=l,l=void 0),typeof h<"u"){if(typeof h!="function")throw new Error("Expected the enhancer to be a function.");return h(lme)(o,l)}if(typeof o!="function")throw new Error("Expected the reducer to be a function.");var _=o,w=l,C=[],R=C,N=!1;function F(){R===C&&(R=C.slice())}function U(){return w}function $(Z){if(typeof Z!="function")throw new Error("Expected listener to be a function.");var ne=!0;return F(),R.push(Z),function(){if(ne){ne=!1,F();var ae=R.indexOf(Z);R.splice(ae,1)}}}function j(Z){if(!Cp(Z))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(typeof Z.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(N)throw new Error("Reducers may not dispatch actions.");try{N=!0,w=_(w,Z)}finally{N=!1}for(var ne=C=R,ae=0;ae<ne.length;ae++){var ce=ne[ae];ce()}return Z}function G(Z){if(typeof Z!="function")throw new Error("Expected the nextReducer to be a function.");_=Z,j({type:ame.INIT})}function Y(){var Z,ne=$;return Z={subscribe:function(ae){if(typeof ae!="object")throw new TypeError("Expected the observer to be an object.");function ce(){ae.next&&ae.next(U())}ce();var ve=ne(ce);return{unsubscribe:ve}}},Z[ome]=function(){return this},Z}return j({type:ame.INIT}),m={dispatch:j,subscribe:$,getState:U,replaceReducer:G},m[ome]=Y,m}function bCe(){for(var o=arguments.length,l=Array(o),h=0;h<o;h++)l[h]=arguments[h];return l.length===0?function(m){return m}:l.length===1?l[0]:l.reduce(function(m,_){return function(){return m(_.apply(void 0,arguments))}})}function SCe(o){let l=bCe();return lme(o.rootReducer,void 0,l)}dA(),By();var fU=new WeakMap,wCe=(o,l,h)=>{let m=N=>{o.dispatch(G6.replacePersistentState(N))},_=cme(h),w=()=>o.getState().$persistent;R();let C=()=>{let N=w(),F=fU.get(o);N!==F&&(fU.set(o,N),localStorage.setItem(_,JSON.stringify(N)))};o.subscribe(Fy(C,1e3)),window&&window.addEventListener("beforeunload",C);function R(){let N=localStorage.getItem(_);if(N){let F,U=!0;try{F=JSON.parse(N),U=!1}catch{hA.warn("Could not parse Theatre's persisted state. This must be a bug. Please report it.")}finally{U||m(F),l()}}else l()}},ECe=(o,l)=>{let h=cme(l),m=o.getState().$persistent;localStorage.removeItem(h),fU.set(o,m)};function cme(o){return o+".persistent"}var TCe=(o=21)=>{let l="",h=crypto.getRandomValues(new Uint8Array(o));for(;o--;){let m=h[o]&63;m<36?l+=m.toString(36):m<62?l+=(m-26).toString(36).toUpperCase():m<63?l+="_":l+="-"}return l};function MCe(){return TCe(16)}sT(),hn(),H0(),O5(),uC();var nP=rn();P9(),m0(),Jde();function pU(o){if(typeof o=="boolean"||typeof o=="string"||typeof o=="number")return o;if(Cp(o)){let l={},h=!1;for(let[m,_]of Object.entries(o))pU(_)!==void 0&&(l[m]=_,h=!0);if(h)return l}else return}function ume(o,l,h){for(let[m,_]of Object.entries(o.props))if(_.type==="compound")ume(_,[...l,m],h);else{if(_.type==="enum")throw new Error("Not yet implemented");h(_,[...l,m])}}function CCe(o,l,h){return{set:(m,_)=>{o();let w=pU(_);if(typeof w>"u")return;let{root:C,path:R}=(0,nP.getPointerParts)(m);if(Bt(C)){let N=C.template.getMapOfValidSequenceTracks_forStudio().getValue(),F=v6(C.template.staticConfig,R);if(!F)throw new Error("Object ".concat(C.address.objectKey," does not have a prop at ").concat(JSON.stringify(R)));let U=($,j,G)=>{if($==null)return;if(pU(j.deserializeAndSanitize($))===void 0)throw new Error("Invalid value ".concat(mB($)," for object.props").concat(G.map(ne=>"[".concat(JSON.stringify(ne),"]")).join("")," is invalid"));let Y=V(A({},C.address),{pathToProp:G}),Z=Tc(N,G);if(typeof Z=="string"){let ne=C.sheet.getSequence();ne.position=ne.closestGridPosition(ne.position),l.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(V(A({},Y),{trackId:Z,position:ne.position,value:$,snappingFunction:ne.closestGridPosition,type:"bezier"}))}else l.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(V(A({},Y),{value:$}))};if(F.type==="compound"){let $=(0,nP.getPointerParts)(m).path,j=$.length;ume(F,$,(G,Y)=>{let Z=Y.slice(j),ne=R9(w,Z);if(typeof ne<"u")U(ne,G,Y);else throw new Error("Property object.props".concat(Y.map(ae=>"[".concat(JSON.stringify(ae),"]")).join("")," is required but not provided"))})}else{if(F.type==="enum")throw new Error("Enums aren't implemented yet");U(w,F,R)}}else if(ct(C)){let[N]=R;if(N==="subUnitsPerUnit"){if(typeof w!="number"||!Q_(w)||w<1)throw new Error("Value ".concat(w," is not an integer, which is required for setting sequence prop ").concat(N));l.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit(V(A({},C.address),{subUnitsPerUnit:w}))}else if(N==="length"){if(typeof w!="number"||w<=.001)throw new Error("Value ".concat(w," is not a positive number, which is required for setting sequence prop ").concat(N));l.coreByProject.historic.sheetsById.sequence.setLength(V(A({},C.address),{length:w}))}else throw new Error("Setting sequence prop ".concat(N," is not supported"))}else throw new Error("Only setting props of SheetObject-s and sequences is supported in a transaction so far")},unset:m=>{o();let{root:_,path:w}=(0,nP.getPointerParts)(m);if(Bt(_)){let C=_.template.getMapOfValidSequenceTracks_forStudio().getValue(),R=R9(_.template.getDefaultValues().getValue(),w),N=v6(_.template.staticConfig,w),F=(U,$)=>{let j=V(A({},_.address),{pathToProp:$}),G=Tc(C,$);typeof G=="string"?l.coreByProject.historic.sheetsById.sequence.unsetKeyframeAtPosition(V(A({},j),{trackId:G,position:_.sheet.getSequence().positionSnappedToGrid})):N!==void 0&&l.coreByProject.historic.sheetsById.staticOverrides.byObject.unsetValueOfPrimitiveProp(j)};N.type==="compound"?WA(R,(U,$)=>{F(U,$)},(0,nP.getPointerParts)(m).path):F(R,w)}else throw new Error("Only setting props of SheetObject-s is supported in a transaction so far")},get drafts(){return o(),h},get stateEditors(){return l}}}var ACe=class{constructor(){se(this,"_reduxStore"),se(this,"_atom"),se(this,"atomP"),this._reduxStore=SCe({rootReducer:sCe}),this._atom=yCe(this._reduxStore),this.atomP=this._atom.pointer}initialize(o){let l=dU();return o.usePersistentStorage===!0?wCe(this._reduxStore,()=>{this.tempTransaction(({drafts:h})=>{h.ephemeral.initialised=!0}).commit(),l.resolve()},o.persistenceKey):(this.tempTransaction(({drafts:h})=>{h.ephemeral.initialised=!0}).commit(),l.resolve()),l.promise}getState(){return this._reduxStore.getState()}__experimental_clearPersistentStorage(o){return ECe(this._reduxStore,o),this.getState()}__dev_startHistoryFromScratch(o){this._reduxStore.dispatch(G6.historic.startHistoryFromScratch(G6.reduceParts(l=>V(A({},l),{historic:o}))))}tempTransaction(o){let l=iCe(),h,m=l.push(G6.reduceParts(_=>{let w={historic:lU(_.historic),ahistoric:lU(_.ahistoric),ephemeral:lU(_.ephemeral)},C=!0,R=()=>{if(!C)throw new Error("You seem to have called the transaction api after studio.transaction() has finished running")},N=sme(w),F=CCe(R,N,w);try{return o(F),C=!1,{historic:cU(w.historic),ahistoric:cU(w.ahistoric),ephemeral:cU(w.ephemeral)}}catch(U){return h=U,_}finally{sme(void 0)}}));if(this._reduxStore.dispatch(m),h)throw this._reduxStore.dispatch(l.discard()),h;return{commit:()=>{this._reduxStore.dispatch(l.commit())},discard:()=>{this._reduxStore.dispatch(l.discard())}}}undo(){this._reduxStore.dispatch(G6.historic.undo())}redo(){this._reduxStore.dispatch(G6.historic.redo())}createContentOfSaveFile(o){var l,h,m,_;if(!this._reduxStore.getState().$persistent.historic.innerState.coreByProject[o])throw new Error("Project ".concat(o," has not been initialized."));let w=MCe();this.tempTransaction(({stateEditors:F})=>{F.coreByProject.historic.revisionHistory.add({projectId:o,revision:w})}).commit();let C=this._reduxStore.getState().$persistent.historic.innerState.coreByProject[o],R=(l=this._reduxStore.getState().$persistent.historic.innerState.projects)==null?void 0:l.stateByProjectId[o],N=iT(C);if(R!=null&&R.stateBySheetId)for(let[F,U]of Object.entries(R.stateBySheetId)){if((h=U==null?void 0:U.sequenceEditor)!=null&&h.markerSet){let $=U.sequenceEditor.markerSet;if($.allIds&&Object.keys($.allIds).length>0){N.sheetsById[F]||(N.sheetsById[F]={staticOverrides:{byObject:{}}});let j=N.sheetsById[F];j&&!j.sequence&&(j.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let G=Object.entries($.byId).map(([Y,Z])=>Z).filter(Y=>Y!==void 0).sort((Y,Z)=>Y.position-Z.position);j!=null&&j.sequence&&(j.sequence.markers=G)}}if((m=U==null?void 0:U.sequenceEditor)!=null&&m.eventSet){let $=U.sequenceEditor.eventSet;if($.allIds&&Object.keys($.allIds).length>0){N.sheetsById[F]||(N.sheetsById[F]={staticOverrides:{byObject:{}}});let j=N.sheetsById[F];j&&!j.sequence&&(j.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let G=Object.entries($.byId).map(([Y,Z])=>Z).filter(Y=>Y!==void 0).sort((Y,Z)=>Y.position-Z.position);j!=null&&j.sequence&&(j.sequence.events=G)}}if((_=U==null?void 0:U.sequenceEditor)!=null&&_.subSequenceSet){let $=U.sequenceEditor.subSequenceSet;if($.allIds&&Object.keys($.allIds).length>0){N.sheetsById[F]||(N.sheetsById[F]={staticOverrides:{byObject:{}}});let j=N.sheetsById[F];j&&!j.sequence&&(j.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let G=Object.entries($.byId).map(([Y,Z])=>Z).filter(Y=>Y!==void 0).sort((Y,Z)=>Y.position-Z.position);j!=null&&j.sequence&&(j.sequence.subSequences=G)}}}return N}},PCe=rn(),mU=class{constructor(){se(this,"_values",{})}get(o,l){if(this.has(o))return this._values[o];{let h=l();return this._values[o]=h,h}}has(o){return this._values.hasOwnProperty(o)}};hn(),t6(),Se(),m0(),XF();var RCe=class{constructor(o){se(this,"ui",{hide(){de().ui.hide()},get isHidden(){return de().ui.isHidden},restore(){de().ui.restore()},renderToolset(l,h){return de().ui.renderToolset(l,h)}}),se(this,"_cache",new mU),se(this,"__experimental",{__experimental_disblePlayPauseKeyboardShortcut(){uTe()},__experimental_enablePlayPauseKeyboardShortcut(){hTe()},__experimental_clearPersistentStorage(l){return de().clearPersistentStorage(l)},__experimental_createContentOfSaveFileTyped(l){return de().createContentOfSaveFile(l)}})}initialize(o){return de().initialize(o)}extend(o,l){de().extend(o,l)}transaction(o){return de().transaction(({set:l,unset:h,stateEditors:m})=>o({set:l,unset:h,__experimental_forgetObject:_=>{if(!Gt(_))throw new Error("object in transactionApi.__experimental_forgetObject(object) must be the return type of sheet.object(...)");m.coreByProject.historic.sheetsById.forgetObject(_.address)},__experimental_forgetSheet:_=>{if(!on(_))throw new Error("sheet in transactionApi.__experimental_forgetSheet(sheet) must be the return type of project.sheet()");m.coreByProject.historic.sheetsById.forgetSheet(_.address)}}))}_getSelectionPrism(){return this._cache.get("_getSelectionPrism()",()=>(0,PCe.prism)(()=>Dh().filter(o=>o.type==="Theatre_SheetObject"||o.type==="Theatre_Sheet").map(o=>o.publicApi)))}_getSelection(){return this._getSelectionPrism().getValue()}setSelection(o){let l=[...o].filter(h=>Gt(h)||on(h)).map(h=>de().corePrivateAPI(h));de().transaction(({stateEditors:h})=>{h.studio.historic.panels.outline.selection.set(l)})}onSelectionChange(o){let l=de();return this._getSelectionPrism().onChange(l.ticker,o,!0)}get selection(){return this._getSelection()}scrub(){return de().scrub()}getStudioProject(){let o=de().core;if(!o)throw new Error("You're calling studio.getStudioProject() before `@tomorrowevening/theatre-core` is loaded. To fix this:\n1. Check if `@tomorrowevening/theatre-core` is import/required in your bundle.\n2. Check the stack trace of this error and make sure the funciton that calls getStudioProject() is run after `@tomorrowevening/theatre-core` is loaded.");return de().getStudioProject(o)}debouncedScrub(o=1e3){let l,h=Fy(()=>{let m=l;m&&(l=void 0,m.commit())},o);return{capture:m=>{l||(l=this.scrub());let _=!0;try{l.capture(m),_=!1}finally{if(_){let w=l;l=void 0,w.discard()}else h()}}}}createPane(o){return de().paneManager.createPane(o)}destroyPane(o){return de().paneManager.destroyPane(o)}createContentOfSaveFile(o){return de().createContentOfSaveFile(o)}};UZ();var E8=rn(),ICe=class{constructor(o){this._studio=o,se(this,"_cache",new mU),this._instantiatePanesAsTheyComeIn()}_instantiatePanesAsTheyComeIn(){let o=this._getAllPanes();o.onStale(()=>{o.getValue()})}_getAllPanes(){return this._cache.get("_getAllPanels()",()=>(0,E8.prism)(()=>{if(!(0,E8.val)(this._studio.coreP))return{};let o=(0,E8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),l=(0,E8.val)(this._studio.atomP.ephemeral.extensions.paneClasses),h={};for(let m of Object.values(o)){if(!m)continue;let _=l[m.paneClass];if(!_)continue;let{instanceId:w}=m,{extensionId:C,classDefinition:R}=_,N=E8.prism.memo("instance-".concat(m.instanceId),()=>({extensionId:C,instanceId:w,definition:R}),[R]);h[w]=N}return h}))}get allPanesD(){return this._getAllPanes()}createPane(o){if(!this._studio.core)throw new Error("Can't create a pane because @tomorrowevening/theatre-core is not yet loaded");let l=(0,E8.val)(this._studio.atomP.ephemeral.extensions.paneClasses[o].extensionId),h=(0,E8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),m;for(let _=1;_<1e3&&(m="".concat(o," #").concat(_),!!h[m]);_++);if(!l)throw new Error('Pane class "'.concat(o,'" is not registered.'));return this._studio.transaction(({drafts:_})=>{_.historic.panelInstanceDesceriptors[m]={instanceId:m,paneClass:o},_.historic.paneFocusOrder||(_.historic.paneFocusOrder=[]);let w=_.historic.paneFocusOrder,C=w.indexOf(m);C!==-1&&w.splice(C,1),w.push(m)}),this._getAllPanes().getValue()[m]}destroyPane(o){if(!this._studio.core)throw new Error("Can't do this yet because @tomorrowevening/theatre-core is not yet loaded");this._studio.transaction(({drafts:l})=>{if(delete l.historic.panelInstanceDesceriptors[o],l.historic.paneFocusOrder){let h=l.historic.paneFocusOrder.indexOf(o);h!==-1&&l.historic.paneFocusOrder.splice(h,1)}})}bringPaneToFront(o){this._studio.transaction(({drafts:l})=>{l.historic.paneFocusOrder||(l.historic.paneFocusOrder=[]);let h=l.historic.paneFocusOrder,m=h.indexOf(o);m!==-1&&h.splice(m,1),h.push(o)})}},rP=rn();Se();var hme=30*60*1e3,kCe=1e3*60*60;function NCe(){return De(this,null,function*(){let o=de().atomP.ahistoric.visibilityState;if((0,rP.val)(o)==="everythingIsVisible")return;let l=dU(),h=(0,rP.pointerToPrism)(o).onStale(()=>{(0,rP.val)(o)==="everythingIsVisible"&&(h(),l.resolve(void 0))});return l.promise})}function DCe(){return De(this,null,function*(){if(!"1.0.19".match(/COMPAT/))for(yield iP(500),yield NCe();;){let o=(0,rP.val)(de().atomP.ahistoric.updateChecker);if(o&&o.result!=="error"){let l=o.lastChecked,h=Date.now(),m=Math.abs(h-l);m<hme&&(yield iP(hme-m))}try{let l=yield fetch(new Request("https://updates.theatrejs.com/updates/1.0.19"));if(l.ok){let h=yield l.json();if(!OCe(h))throw new Error("Bad response");de().transaction(({drafts:m})=>{m.ahistoric.updateChecker={lastChecked:Date.now(),result:A({},h)}}),yield iP(1e3)}else throw new Error("HTTP Error ".concat(l.statusText))}catch{yield iP(kCe)}}})}var iP=o=>new Promise(l=>setTimeout(l,o));function OCe(o){if(typeof o!="object")return!1;let l=o;return typeof l.hasUpdates!="boolean"?!1:l.hasUpdates===!0&&typeof l.newVersion=="string"&&typeof l.releasePage=="string"||l.hasUpdates===!1}var LCe=K(fq());function lg(o){return new Promise((l,h)=>{o.oncomplete=o.onsuccess=()=>l(o.result),o.onabort=o.onerror=()=>h(o.error)})}function dme(o,l){let h=indexedDB.open(o);h.onupgradeneeded=()=>h.result.createObjectStore(l);let m=lg(h);return(_,w)=>m.then(C=>w(C.transaction(l,_).objectStore(l)))}var gU;function W6(){return gU||(gU=dme("keyval-store","keyval")),gU}function FCe(o,l=W6()){return l("readonly",h=>lg(h.get(o)))}function BCe(o,l,h=W6()){return h("readwrite",m=>(m.put(l,o),lg(m.transaction)))}function UCe(o,l=W6()){return l("readwrite",h=>(h.delete(o),lg(h.transaction)))}function vU(o,l){return o.openCursor().onsuccess=function(){this.result&&(l(this.result),this.result.continue())},lg(o.transaction)}function zCe(o=W6()){return o("readonly",l=>{if(l.getAllKeys)return lg(l.getAllKeys());let h=[];return vU(l,m=>h.push(m.key)).then(()=>h)})}function VCe(o=W6()){return o("readonly",l=>{if(l.getAll)return lg(l.getAll());let h=[];return vU(l,m=>h.push(m.value)).then(()=>h)})}function GCe(o=W6()){return o("readonly",l=>{if(l.getAll&&l.getAllKeys)return Promise.all([lg(l.getAllKeys()),lg(l.getAll())]).then(([m,_])=>m.map((w,C)=>[w,_[C]]));let h=[];return o("readonly",m=>vU(m,_=>h.push([_.key,_.value])).then(()=>h))})}var jCe=o=>{let l=dme("theatrejs-".concat(o),"default-store");return{set:(h,m)=>BCe(h,m,l),get:h=>FCe(h,l),del:h=>UCe(h,l),keys:()=>zCe(l),entries:()=>GCe(l),values:()=>VCe(l)}},HCe=rn();function fme(o,l){var h;let m=Object.values((h=(0,HCe.val)(o.pointers.historic.sheetsById))!=null?h:{}),_=m.flatMap(C=>{var R;return Object.values((R=C==null?void 0:C.staticOverrides.byObject)!=null?R:{})}).flatMap(C=>Object.values(C??{})),w=[...m.flatMap(C=>{var R,N;return Object.values((N=(R=C==null?void 0:C.sequence)==null?void 0:R.tracksByObject)!=null?N:{})}).flatMap(C=>{var R;return Object.values((R=C==null?void 0:C.trackData)!=null?R:{})}).flatMap(C=>C==null?void 0:C.keyframes).map(C=>C==null?void 0:C.value)];return _.forEach(C=>{WA(C,R=>{w.push(R)},[])}),w.filter(C=>(C==null?void 0:C.type)&&typeof(C==null?void 0:C.type)=="string").map(C=>C.id).filter((C,R,N)=>C!==null&&C!==""&&N.indexOf(C)===R)}BB();var pme="theatre-0.4",WCe=`You seem to have imported '@tomorrowevening/theatre-studio' but haven't initialized it. You can initialize the studio by:
\`\`\`
import studio from '@tomorrowevening/theatre-studio'
studio.initialize()
\`\`\`

* If you didn't mean to import '@tomorrowevening/theatre-studio', this means that your bundler is not tree-shaking it. This is most likely a bundler misconfiguration.

* If you meant to import '@tomorrowevening/theatre-studio' without showing its UI, you can do that by running:

\`\`\`
import studio from '@tomorrowevening/theatre-studio'
studio.initialize()
studio.ui.hide()
\`\`\`
`,$Ce="You seem to have imported '@tomorrowevening/theatre-studio' but called `studio.initialize()` after some delay.\nTheatre.js projects remain in pending mode (won't play their sequences) until the studio is initialized, so you should place the `studio.initialize()` line right after the import line:\n\n```\nimport studio from '@tomorrowevening/theatre-studio'\n// ... and other imports\n\nstudio.initialize()\n```\n",qCe=class{constructor(){se(this,"ui"),se(this,"publicApi"),se(this,"address"),se(this,"_projectsProxy",new $A.PointerProxy(new $A.Atom({}).pointer)),se(this,"projectsP",this._projectsProxy.pointer),se(this,"_store",new ACe),se(this,"_corePrivateApi"),se(this,"_cache",new mU),se(this,"paneManager"),se(this,"_coreAtom",new $A.Atom({})),se(this,"_initializedDeferred",dU()),se(this,"_initializeFnCalled",!1),se(this,"_didWarnAboutNotInitializing",!1),se(this,"_coreBits"),se(this,"_rafDriver"),this.address={studioId:h6(10)},this.publicApi=new RCe(this),this.ui=new FMe(this),this._attachToIncomingProjects(),this.paneManager=new ICe(this),typeof window<"u"&&setTimeout(()=>{this._initializeFnCalled||(console.error(WCe),this._didWarnAboutNotInitializing=!0)},100)}get ticker(){if(!this._rafDriver)throw new Error("`studio.ticker` was read before studio.initialize() was called.");return this._rafDriver.ticker}get atomP(){return this._store.atomP}initialize(o){return De(this,null,function*(){if(!this._coreBits)throw new Error("You seem to have imported `@tomorrowevening/theatre-studio` without importing `@tomorrowevening/theatre-core`. Make sure to include an import of `@tomorrowevening/theatre-core` before calling `studio.initializer()`.");if(this._initializeFnCalled)return this._initializedDeferred.promise;this._initializeFnCalled=!0,this._didWarnAboutNotInitializing&&console.warn($Ce);let l={persistenceKey:pme,usePersistentStorage:!0};if(typeof(o==null?void 0:o.persistenceKey)=="string"&&(l.persistenceKey=o.persistenceKey),((o==null?void 0:o.usePersistentStorage)===!1||typeof window>"u")&&(l.usePersistentStorage=!1),o!=null&&o.__experimental_rafDriver){if(o.__experimental_rafDriver.type!=="Theatre_RafDriver_PublicAPI")throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` must be either be undefined, or the return type of core.createRafDriver()");let h=this._coreBits.privateAPI(o.__experimental_rafDriver);if(!h)throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` seems to come from a different version of `@tomorrowevening/theatre-core` than the version that is attached to `@tomorrowevening/theatre-studio`");this._rafDriver=h}else this._rafDriver=this._coreBits.getCoreRafDriver();try{yield this._store.initialize(l)}catch(h){this._initializedDeferred.reject(h);return}typeof window<"u"&&(yield this.ui.ready),this._initializedDeferred.resolve(),this.ui.render(),DCe().catch(h=>{console.error(h)})})}get initialized(){return this._initializedDeferred.promise}_attachToIncomingProjects(){let o=(0,$A.pointerToPrism)(this.projectsP),l=h=>{for(let m of Object.values(h))m.isAttachedToStudio||m.attachToStudio(this)};o.onStale(()=>{l(o.getValue())}),l(o.getValue())}setCoreBits(o){this._coreBits=o,this._corePrivateApi=o.privateAPI,this._coreAtom.setByPointer(l=>l.core,o.coreExports),this._setProjectsP(o.projectsP)}_setProjectsP(o){this._projectsProxy.setPointer(o)}scrub(){return new OMe(this)}tempTransaction(o){return this._store.tempTransaction(o)}transaction(o){return this.tempTransaction(o).commit()}__dev_startHistoryFromScratch(o){return this._store.__dev_startHistoryFromScratch(o)}get corePrivateAPI(){return this._corePrivateApi}get core(){return this._coreAtom.get().core}get coreP(){return this._coreAtom.pointer.core}extend(o,l){if(!o||typeof o!="object")throw new Error("Extensions must be JS objects");if(typeof o.id!="string")throw new Error("extension.id must be a string");let h=(l==null?void 0:l.__experimental_reconfigure)===!0,m=o.id,_=this._store.getState().ephemeral.extensions.byId[m];if(_&&!h){if(o===_||(0,LCe.default)(o,_))return;throw new Error('Extension id "'.concat(o.id,'" is already defined. If you mean to re-configure the extension, do it like this: studio.extend(extension, {__experimental_reconfigure: true})})'))}this.transaction(({drafts:w})=>{var C,R;w.ephemeral.extensions.byId[o.id]=o;let N=w.ephemeral.extensions.paneClasses;h&&_&&((C=_.panes)==null||C.forEach(F=>{delete N[F.class]})),(R=o.panes)==null||R.forEach(F=>{if(typeof F.class!="string")throw new Error("pane.class must be a string");if(F.class.length<3)throw new Error("pane.class should be a string with 3 or more characters");let U=N[F.class];if(U)if(h&&U.extensionId===o.id)console.warn('Pane class "'.concat(F.class,'" already exists. This is a bug in Theatre.js. Please report it at https://github.com/theatre-js/theatre/issues/new'));else throw new Error('Pane class "'.concat(F.class,'" already exists and is supplied by extension ').concat(U));N[F.class]={extensionId:o.id,classDefinition:F}})})}getStudioProject(o){return this._cache.get("getStudioProject",()=>o.getProject("Studio"))}getExtensionSheet(o,l){return this._cache.get("extensionSheet-"+o,()=>this.getStudioProject(l).sheet("Extension "+o))}undo(){this._store.undo()}redo(){this._store.redo()}createContentOfSaveFile(o){return this._store.createContentOfSaveFile(o)}createAssetStorage(o,l){return De(this,null,function*(){if(typeof window>"u")return{getAssetUrl:()=>"",createAsset:()=>Promise.resolve(null)};if(!("indexedDB"in window))return console.log("This browser doesn't support IndexedDB."),{getAssetUrl:F=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")},createAsset:F=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")}};let h=jCe("".concat(o.address.projectId,"-assets")),m=fme(o),_=yield h.keys();yield Promise.all(_.map(F=>De(this,null,function*(){m.includes(F)||(yield h.del(F))}))),yield Promise.all(_.map(F=>De(this,null,function*(){var U,$;let j="".concat(l,"/").concat(F);try{(yield fetch(j,{method:"HEAD"})).ok&&(yield h.del(F))}catch{VA.error("Failed to access assets","Failed to access assets at ".concat(($=(U=o.config.assets)==null?void 0:U.baseUrl)!=null?$:"/",". This is likely due to a CORS issue."))}})));let w=new Map(yield h.entries()),C=new Map,R=F=>{if(C.has(F))return C.get(F);{let U=URL.createObjectURL(F);return C.set(F,U),U}},N=F=>{let U=w.get(F);if(!U)throw new Error("Asset with id ".concat(F," not found"));return R(U)};return{getAssetUrl:F=>w.has(F)?N(F):"".concat(l,"/").concat(F),createAsset:F=>De(this,null,function*(){var U,$,j;let G=fme(o),Y=!1;if(G.includes(F.name)){let Z;try{Z=(U=w.get(F.name))!=null?U:yield fetch("".concat(l,"/").concat(F.name)).then(ne=>ne.ok?ne.blob():void 0)}catch{return VA.error("Failed to access assets","Failed to access assets at ".concat((j=($=o.config.assets)==null?void 0:$.baseUrl)!=null?j:"/",". This is likely due to a CORS issue.")),Promise.resolve(null)}if(Z){if(Y=yield(yield Promise.resolve().then(()=>K(IMe()))).default.isEqual(F,Z),Y)return F.name;{let ne=ae=>{let ce=prompt(ae,F.name);return ce===null?!1:ce===""?ne("Asset name cannot be empty. Please choose a different file name for this asset."):G.includes(ce)?(console.log(G),ne("An asset with this name already exists. Please choose a different file name for this asset.")):(F=new File([F],ce,{type:F.type}),!0)};if(!ne("An asset with this name already exists. Please choose a different file name for this asset."))return null}}}return w.set(F.name,F),yield h.set(F.name,F),F.name})}})}clearPersistentStorage(o=pme){this._store.__experimental_clearPersistentStorage(o)}},yU="__TheatreJS_StudioBundle",XCe="__TheatreJS_CoreBundle",YCe="__TheatreJS_Notifications",KCe=class{constructor(o){this._studio=o,se(this,"_coreBundle")}get type(){return"Theatre_StudioBundle"}registerCoreBundle(o){if(this._coreBundle)throw new Error("StudioBundle.coreBundle is already registered. This is a bug.");this._coreBundle=o;let l;o.getBitsForStudio(this._studio,h=>{l=h}),this._studio.setCoreBits(l)}},ZCe=K($e());Xt();var mme,QCe=me.div(mme||(mme=q([""]))),JCe=o=>ZCe.default.createElement(QCe,null),eAe=JCe;BB();var xU=new qCe;st(xU);var tAe=xU.publicApi,nAe=tAe;rAe();function rAe(){if(typeof window>"u")return;let o=window[yU];if(typeof o<"u")throw typeof o=="object"&&o&&typeof o.version=="string"?new Error(`It seems that the module '@tomorrowevening/theatre-studio' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@tomorrowevening/theatre-studio' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(yU," seems to be already set by a module other than @tomorrowevening/theatre-core."));let l=new KCe(xU);window[yU]=l;let h=window[XCe];h&&h!==null&&h.type==="Theatre_CoreBundle"&&l.registerCoreBundle(h)}typeof window<"u"&&(window[YCe]={notify:VA});/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)

		queue-microtask/index.js:
		  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

		react/cjs/react.production.min.js:
		  (**
		   * @license React
		   * react.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		scheduler/cjs/scheduler.production.min.js:
		  (**
		   * @license React
		   * scheduler.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-dom/cjs/react-dom.production.min.js:
		  (**
		   * @license React
		   * react-dom.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v17.0.2
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v16.13.1
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		jiff/lib/lcs.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/array.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointerParse.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointer.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/clone.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPatch.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/jiff.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)
		*/}(jw,jw.exports)),jw.exports}var hRe=uRe();const k8e=R8e(hRe);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const LE="177",xx={ROTATE:0,DOLLY:1,PAN:2},sx={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},dRe=0,v9e=1,fRe=2,N8e=1,pRe=2,Rg=3,E1=0,Qo=1,gl=2,cc=0,xv=1,Nj=2,Dj=3,Oj=4,D8e=5,L3=100,O8e=101,L8e=102,F8e=103,B8e=104,mW=200,gW=201,vW=202,yW=203,mE=204,gE=205,xW=206,_W=207,bW=208,SW=209,U8e=210,wW=211,EW=212,TW=213,MW=214,Lj=0,Fj=1,Bj=2,Ix=3,Uj=4,zj=5,Vj=6,Gj=7,Gk=0,mRe=1,gRe=2,b1=0,z8e=1,V8e=2,G8e=3,j8e=4,H8e=5,W8e=6,$8e=7,y9e="attached",vRe="detached",ox=300,kx=301,Nx=302,ak=303,jj=304,jk=306,Wg=1e3,C0=1001,Hj=1002,R0=1003,yRe=1004,gR=1005,e0=1006,hV=1007,mv=1008,t0=1009,q8e=1010,X8e=1011,vE=1012,CW=1013,H3=1014,ed=1015,W3=1016,AW=1017,PW=1018,Dx=1020,Y8e=35902,K8e=1021,Z8e=1022,yl=1023,yE=1026,Ox=1027,Q8e=1028,RW=1029,J8e=1030,IW=1031,kW=1033,VI=33776,GI=33777,jI=33778,HI=33779,Wj=35840,$j=35841,qj=35842,Xj=35843,Yj=36196,Kj=37492,Zj=37496,Qj=37808,Jj=37809,eH=37810,tH=37811,nH=37812,rH=37813,iH=37814,sH=37815,oH=37816,aH=37817,lH=37818,cH=37819,uH=37820,hH=37821,WI=36492,dH=36494,fH=36495,eve=36283,pH=36284,mH=36285,gH=36286,xRe=2200,_Re=2201,bRe=2202,lk=2300,vH=2301,dV=2302,ax=2400,lx=2401,ck=2402,NW=2500,SRe=2501,FE=3200,wRe=3201,Qx=0,ERe=1,kf="",qr="srgb",Ju="srgb-linear",uk="linear",Es="srgb",y7=7680,x9e=519,TRe=512,MRe=513,CRe=514,tve=515,ARe=516,PRe=517,RRe=518,IRe=519,_9e=35044,yH="300 es",x1=2e3,hk=2001;let nh=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,a=r.length;i<a;i++)r[i].call(this,e);e.target=null}}};const cl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let b9e=1234567;const rE=Math.PI/180,Lx=180/Math.PI;function Z3(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(cl[s&255]+cl[s>>8&255]+cl[s>>16&255]+cl[s>>24&255]+"-"+cl[e&255]+cl[e>>8&255]+"-"+cl[e>>16&15|64]+cl[e>>24&255]+"-"+cl[t&63|128]+cl[t>>8&255]+"-"+cl[t>>16&255]+cl[t>>24&255]+cl[n&255]+cl[n>>8&255]+cl[n>>16&255]+cl[n>>24&255]).toLowerCase()}function Jr(s,e,t){return Math.max(e,Math.min(t,s))}function DW(s,e){return(s%e+e)%e}function kRe(s,e,t,n,r){return n+(s-e)*(r-n)/(t-e)}function NRe(s,e,t){return s!==e?(t-s)/(e-s):0}function iE(s,e,t){return(1-t)*s+t*e}function DRe(s,e,t,n){return iE(s,e,1-Math.exp(-t*n))}function ORe(s,e=1){return e-Math.abs(DW(s,e*2)-e)}function LRe(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function FRe(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function BRe(s,e){return s+Math.floor(Math.random()*(e-s+1))}function URe(s,e){return s+Math.random()*(e-s)}function zRe(s){return s*(.5-Math.random())}function VRe(s){s!==void 0&&(b9e=s);let e=b9e+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function GRe(s){return s*rE}function jRe(s){return s*Lx}function HRe(s){return(s&s-1)===0&&s!==0}function WRe(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function $Re(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function qRe(s,e,t,n,r){const i=Math.cos,a=Math.sin,c=i(t/2),u=a(t/2),p=i((e+n)/2),y=a((e+n)/2),x=i((e-n)/2),S=a((e-n)/2),M=i((n-e)/2),I=a((n-e)/2);switch(r){case"XYX":s.set(c*y,u*x,u*S,c*p);break;case"YZY":s.set(u*S,c*y,u*x,c*p);break;case"ZXZ":s.set(u*x,u*S,c*y,c*p);break;case"XZX":s.set(c*y,u*I,u*M,c*p);break;case"YXY":s.set(u*M,c*y,u*I,c*p);break;case"ZYZ":s.set(u*I,u*M,c*y,c*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function tx(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function tc(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const pl={DEG2RAD:rE,RAD2DEG:Lx,generateUUID:Z3,clamp:Jr,euclideanModulo:DW,mapLinear:kRe,inverseLerp:NRe,lerp:iE,damp:DRe,pingpong:ORe,smoothstep:LRe,smootherstep:FRe,randInt:BRe,randFloat:URe,randFloatSpread:zRe,seededRandom:VRe,degToRad:GRe,radToDeg:jRe,isPowerOfTwo:HRe,ceilPowerOfTwo:WRe,floorPowerOfTwo:$Re,setQuaternionFromProperEuler:qRe,normalize:tc,denormalize:tx};let An=class nve{constructor(e=0,t=0){nve.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Jr(this.x,e.x,t.x),this.y=Jr(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Jr(this.x,e,t),this.y=Jr(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Jr(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Jr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},ls=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,c){let u=n[r+0],p=n[r+1],y=n[r+2],x=n[r+3];const S=i[a+0],M=i[a+1],I=i[a+2],L=i[a+3];if(c===0){e[t+0]=u,e[t+1]=p,e[t+2]=y,e[t+3]=x;return}if(c===1){e[t+0]=S,e[t+1]=M,e[t+2]=I,e[t+3]=L;return}if(x!==L||u!==S||p!==M||y!==I){let B=1-c;const A=u*S+p*M+y*I+x*L,V=A>=0?1:-1,X=1-A*A;if(X>Number.EPSILON){const te=Math.sqrt(X),oe=Math.atan2(te,A*V);B=Math.sin(B*oe)/te,c=Math.sin(c*oe)/te}const P=c*V;if(u=u*B+S*P,p=p*B+M*P,y=y*B+I*P,x=x*B+L*P,B===1-c){const te=1/Math.sqrt(u*u+p*p+y*y+x*x);u*=te,p*=te,y*=te,x*=te}}e[t]=u,e[t+1]=p,e[t+2]=y,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,i,a){const c=n[r],u=n[r+1],p=n[r+2],y=n[r+3],x=i[a],S=i[a+1],M=i[a+2],I=i[a+3];return e[t]=c*I+y*x+u*M-p*S,e[t+1]=u*I+y*S+p*x-c*M,e[t+2]=p*I+y*M+c*S-u*x,e[t+3]=y*I-c*x-u*S-p*M,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,a=e._order,c=Math.cos,u=Math.sin,p=c(n/2),y=c(r/2),x=c(i/2),S=u(n/2),M=u(r/2),I=u(i/2);switch(a){case"XYZ":this._x=S*y*x+p*M*I,this._y=p*M*x-S*y*I,this._z=p*y*I+S*M*x,this._w=p*y*x-S*M*I;break;case"YXZ":this._x=S*y*x+p*M*I,this._y=p*M*x-S*y*I,this._z=p*y*I-S*M*x,this._w=p*y*x+S*M*I;break;case"ZXY":this._x=S*y*x-p*M*I,this._y=p*M*x+S*y*I,this._z=p*y*I+S*M*x,this._w=p*y*x-S*M*I;break;case"ZYX":this._x=S*y*x-p*M*I,this._y=p*M*x+S*y*I,this._z=p*y*I-S*M*x,this._w=p*y*x+S*M*I;break;case"YZX":this._x=S*y*x+p*M*I,this._y=p*M*x+S*y*I,this._z=p*y*I-S*M*x,this._w=p*y*x-S*M*I;break;case"XZY":this._x=S*y*x-p*M*I,this._y=p*M*x-S*y*I,this._z=p*y*I+S*M*x,this._w=p*y*x+S*M*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],c=t[5],u=t[9],p=t[2],y=t[6],x=t[10],S=n+c+x;if(S>0){const M=.5/Math.sqrt(S+1);this._w=.25/M,this._x=(y-u)*M,this._y=(i-p)*M,this._z=(a-r)*M}else if(n>c&&n>x){const M=2*Math.sqrt(1+n-c-x);this._w=(y-u)/M,this._x=.25*M,this._y=(r+a)/M,this._z=(i+p)/M}else if(c>x){const M=2*Math.sqrt(1+c-n-x);this._w=(i-p)/M,this._x=(r+a)/M,this._y=.25*M,this._z=(u+y)/M}else{const M=2*Math.sqrt(1+x-n-c);this._w=(a-r)/M,this._x=(i+p)/M,this._y=(u+y)/M,this._z=.25*M}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Jr(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,c=t._x,u=t._y,p=t._z,y=t._w;return this._x=n*y+a*c+r*p-i*u,this._y=r*y+a*u+i*c-n*p,this._z=i*y+a*p+n*u-r*c,this._w=a*y-n*c-r*u-i*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let c=a*e._w+n*e._x+r*e._y+i*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const u=1-c*c;if(u<=Number.EPSILON){const M=1-t;return this._w=M*a+t*this._w,this._x=M*n+t*this._x,this._y=M*r+t*this._y,this._z=M*i+t*this._z,this.normalize(),this}const p=Math.sqrt(u),y=Math.atan2(p,c),x=Math.sin((1-t)*y)/p,S=Math.sin(t*y)/p;return this._w=a*x+this._w*S,this._x=n*x+this._x*S,this._y=r*x+this._y*S,this._z=i*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Ae=class rve{constructor(e=0,t=0,n=0){rve.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(S9e.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(S9e.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,c=e.z,u=e.w,p=2*(a*r-c*n),y=2*(c*t-i*r),x=2*(i*n-a*t);return this.x=t+u*p+a*x-c*y,this.y=n+u*y+c*p-i*x,this.z=r+u*x+i*y-a*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Jr(this.x,e.x,t.x),this.y=Jr(this.y,e.y,t.y),this.z=Jr(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Jr(this.x,e,t),this.y=Jr(this.y,e,t),this.z=Jr(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Jr(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,c=t.y,u=t.z;return this.x=r*u-i*c,this.y=i*a-n*u,this.z=n*c-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return fV.copy(this).projectOnVector(e),this.sub(fV)}reflect(e){return this.sub(fV.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Jr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const fV=new Ae,S9e=new ls;let si=class ive{constructor(e,t,n,r,i,a,c,u,p){ive.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,u,p)}set(e,t,n,r,i,a,c,u,p){const y=this.elements;return y[0]=e,y[1]=r,y[2]=c,y[3]=t,y[4]=i,y[5]=u,y[6]=n,y[7]=a,y[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[3],u=n[6],p=n[1],y=n[4],x=n[7],S=n[2],M=n[5],I=n[8],L=r[0],B=r[3],A=r[6],V=r[1],X=r[4],P=r[7],te=r[2],oe=r[5],ie=r[8];return i[0]=a*L+c*V+u*te,i[3]=a*B+c*X+u*oe,i[6]=a*A+c*P+u*ie,i[1]=p*L+y*V+x*te,i[4]=p*B+y*X+x*oe,i[7]=p*A+y*P+x*ie,i[2]=S*L+M*V+I*te,i[5]=S*B+M*X+I*oe,i[8]=S*A+M*P+I*ie,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],u=e[6],p=e[7],y=e[8];return t*a*y-t*c*p-n*i*y+n*c*u+r*i*p-r*a*u}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],u=e[6],p=e[7],y=e[8],x=y*a-c*p,S=c*u-y*i,M=p*i-a*u,I=t*x+n*S+r*M;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/I;return e[0]=x*L,e[1]=(r*p-y*n)*L,e[2]=(c*n-r*a)*L,e[3]=S*L,e[4]=(y*t-r*u)*L,e[5]=(r*i-c*t)*L,e[6]=M*L,e[7]=(n*u-p*t)*L,e[8]=(a*t-n*i)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,c){const u=Math.cos(i),p=Math.sin(i);return this.set(n*u,n*p,-n*(u*a+p*c)+a+e,-r*p,r*u,-r*(-p*a+u*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(pV.makeScale(e,t)),this}rotate(e){return this.premultiply(pV.makeRotation(-e)),this}translate(e,t){return this.premultiply(pV.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const pV=new si;function sve(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function xE(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function XRe(){const s=xE("canvas");return s.style.display="block",s}const w9e={};function _x(s){s in w9e||(w9e[s]=!0,console.warn(s))}function YRe(s,e,t){return new Promise(function(n,r){function i(){switch(s.clientWaitSync(e,s.SYNC_FLUSH_COMMANDS_BIT,0)){case s.WAIT_FAILED:r();break;case s.TIMEOUT_EXPIRED:setTimeout(i,t);break;default:n()}}setTimeout(i,t)})}function KRe(s){const e=s.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function ZRe(s){const e=s.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const E9e=new si().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),T9e=new si().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function QRe(){const s={enabled:!0,workingColorSpace:Ju,spaces:{},convert:function(r,i,a){return this.enabled===!1||i===a||!i||!a||(this.spaces[i].transfer===Es&&(r.r=Lg(r.r),r.g=Lg(r.g),r.b=Lg(r.b)),this.spaces[i].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[i].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Es&&(r.r=bx(r.r),r.g=bx(r.g),r.b=bx(r.b))),r},workingToColorSpace:function(r,i){return this.convert(r,this.workingColorSpace,i)},colorSpaceToWorking:function(r,i){return this.convert(r,i,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===kf?uk:this.spaces[r].transfer},getLuminanceCoefficients:function(r,i=this.workingColorSpace){return r.fromArray(this.spaces[i].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,i,a){return r.copy(this.spaces[i].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,i){return _x("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(r,i)},toWorkingColorSpace:function(r,i){return _x("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(r,i)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[Ju]:{primaries:e,whitePoint:n,transfer:uk,toXYZ:E9e,fromXYZ:T9e,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:qr},outputColorSpaceConfig:{drawingBufferColorSpace:qr}},[qr]:{primaries:e,whitePoint:n,transfer:Es,toXYZ:E9e,fromXYZ:T9e,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:qr}}}),s}const Gr=QRe();function Lg(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function bx(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let x7,JRe=class{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{x7===void 0&&(x7=xE("canvas")),x7.width=e.width,x7.height=e.height;const r=x7.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=x7}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=xE("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let a=0;a<i.length;a++)i[a]=Lg(i[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Lg(t[n]/255)*255):t[n]=Lg(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},eIe=0,OW=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:eIe++}),this.uuid=Z3(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let a=0,c=r.length;a<c;a++)r[a].isDataTexture?i.push(mV(r[a].image)):i.push(mV(r[a]))}else i=mV(r);n.url=i}return t||(e.images[this.uuid]=n),n}};function mV(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?JRe.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let tIe=0;const gV=new Ae;let n0=class $I extends nh{constructor(e=$I.DEFAULT_IMAGE,t=$I.DEFAULT_MAPPING,n=C0,r=C0,i=e0,a=mv,c=yl,u=t0,p=$I.DEFAULT_ANISOTROPY,y=kf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:tIe++}),this.uuid=Z3(),this.name="",this.source=new OW(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=u,this.offset=new An(0,0),this.repeat=new An(1,1),this.center=new An(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new si,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(gV).x}get height(){return this.source.getSize(gV).y}get depth(){return this.source.getSize(gV).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ox)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Wg:e.x=e.x-Math.floor(e.x);break;case C0:e.x=e.x<0?0:1;break;case Hj:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Wg:e.y=e.y-Math.floor(e.y);break;case C0:e.y=e.y<0?0:1;break;case Hj:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};n0.DEFAULT_IMAGE=null;n0.DEFAULT_MAPPING=ox;n0.DEFAULT_ANISOTROPY=1;let xi=class ove{constructor(e=0,t=0,n=0,r=1){ove.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const u=e.elements,p=u[0],y=u[4],x=u[8],S=u[1],M=u[5],I=u[9],L=u[2],B=u[6],A=u[10];if(Math.abs(y-S)<.01&&Math.abs(x-L)<.01&&Math.abs(I-B)<.01){if(Math.abs(y+S)<.1&&Math.abs(x+L)<.1&&Math.abs(I+B)<.1&&Math.abs(p+M+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const X=(p+1)/2,P=(M+1)/2,te=(A+1)/2,oe=(y+S)/4,ie=(x+L)/4,K=(I+B)/4;return X>P&&X>te?X<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(X),r=oe/n,i=ie/n):P>te?P<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(P),n=oe/r,i=K/r):te<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(te),n=ie/i,r=K/i),this.set(n,r,i,t),this}let V=Math.sqrt((B-I)*(B-I)+(x-L)*(x-L)+(S-y)*(S-y));return Math.abs(V)<.001&&(V=1),this.x=(B-I)/V,this.y=(x-L)/V,this.z=(S-y)/V,this.w=Math.acos((p+M+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Jr(this.x,e.x,t.x),this.y=Jr(this.y,e.y,t.y),this.z=Jr(this.z,e.z,t.z),this.w=Jr(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Jr(this.x,e,t),this.y=Jr(this.y,e,t),this.z=Jr(this.z,e,t),this.w=Jr(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Jr(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},ave=class extends nh{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:e0,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new xi(0,0,e,t),this.scissorTest=!1,this.viewport=new xi(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new n0(r);this.textures=[];const a=n.count;for(let c=0;c<a;c++)this.textures[c]=i.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:e0,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new OW(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},bl=class extends ave{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},lve=class extends n0{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=R0,this.minFilter=R0,this.wrapR=C0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};class nIe extends n0{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=R0,this.minFilter=R0,this.wrapR=C0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let Cv=class{constructor(e=new Ae(1/0,1/0,1/0),t=new Ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(yf.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(yf.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=yf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const i=n.getAttribute("position");if(t===!0&&i!==void 0&&e.isInstancedMesh!==!0)for(let a=0,c=i.count;a<c;a++)e.isMesh===!0?e.getVertexPosition(a,yf):yf.fromBufferAttribute(i,a),yf.applyMatrix4(e.matrixWorld),this.expandByPoint(yf);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),vR.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),vR.copy(n.boundingBox)),vR.applyMatrix4(e.matrixWorld),this.union(vR)}const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,yf),yf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lw),yR.subVectors(this.max,lw),_7.subVectors(e.a,lw),b7.subVectors(e.b,lw),S7.subVectors(e.c,lw),f3.subVectors(b7,_7),p3.subVectors(S7,b7),B8.subVectors(_7,S7);let t=[0,-f3.z,f3.y,0,-p3.z,p3.y,0,-B8.z,B8.y,f3.z,0,-f3.x,p3.z,0,-p3.x,B8.z,0,-B8.x,-f3.y,f3.x,0,-p3.y,p3.x,0,-B8.y,B8.x,0];return!vV(t,_7,b7,S7,yR)||(t=[1,0,0,0,1,0,0,0,1],!vV(t,_7,b7,S7,yR))?!1:(xR.crossVectors(f3,p3),t=[xR.x,xR.y,xR.z],vV(t,_7,b7,S7,yR))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,yf).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(yf).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(yg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),yg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),yg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),yg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),yg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),yg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),yg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),yg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(yg),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}};const yg=[new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae],yf=new Ae,vR=new Cv,_7=new Ae,b7=new Ae,S7=new Ae,f3=new Ae,p3=new Ae,B8=new Ae,lw=new Ae,yR=new Ae,xR=new Ae,U8=new Ae;function vV(s,e,t,n,r){for(let i=0,a=s.length-3;i<=a;i+=3){U8.fromArray(s,i);const c=r.x*Math.abs(U8.x)+r.y*Math.abs(U8.y)+r.z*Math.abs(U8.z),u=e.dot(U8),p=t.dot(U8),y=n.dot(U8);if(Math.max(-Math.max(u,p,y),Math.min(u,p,y))>c)return!1}return!0}const rIe=new Cv,cw=new Ae,yV=new Ae;let Q3=class{constructor(e=new Ae,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):rIe.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;cw.subVectors(e,this.center);const t=cw.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(cw,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(yV.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(cw.copy(e.center).add(yV)),this.expandByPoint(cw.copy(e.center).sub(yV))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}};const xg=new Ae,xV=new Ae,_R=new Ae,m3=new Ae,_V=new Ae,bR=new Ae,bV=new Ae;let Jx=class{constructor(e=new Ae,t=new Ae(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,xg)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=xg.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(xg.copy(this.origin).addScaledVector(this.direction,t),xg.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){xV.copy(e).add(t).multiplyScalar(.5),_R.copy(t).sub(e).normalize(),m3.copy(this.origin).sub(xV);const i=e.distanceTo(t)*.5,a=-this.direction.dot(_R),c=m3.dot(this.direction),u=-m3.dot(_R),p=m3.lengthSq(),y=Math.abs(1-a*a);let x,S,M,I;if(y>0)if(x=a*u-c,S=a*c-u,I=i*y,x>=0)if(S>=-I)if(S<=I){const L=1/y;x*=L,S*=L,M=x*(x+a*S+2*c)+S*(a*x+S+2*u)+p}else S=i,x=Math.max(0,-(a*S+c)),M=-x*x+S*(S+2*u)+p;else S=-i,x=Math.max(0,-(a*S+c)),M=-x*x+S*(S+2*u)+p;else S<=-I?(x=Math.max(0,-(-a*i+c)),S=x>0?-i:Math.min(Math.max(-i,-u),i),M=-x*x+S*(S+2*u)+p):S<=I?(x=0,S=Math.min(Math.max(-i,-u),i),M=S*(S+2*u)+p):(x=Math.max(0,-(a*i+c)),S=x>0?i:Math.min(Math.max(-i,-u),i),M=-x*x+S*(S+2*u)+p);else S=a>0?-i:i,x=Math.max(0,-(a*S+c)),M=-x*x+S*(S+2*u)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(xV).addScaledVector(_R,S),M}intersectSphere(e,t){xg.subVectors(e.center,this.origin);const n=xg.dot(this.direction),r=xg.dot(xg)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),c=n-a,u=n+a;return u<0?null:c<0?this.at(u,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,c,u;const p=1/this.direction.x,y=1/this.direction.y,x=1/this.direction.z,S=this.origin;return p>=0?(n=(e.min.x-S.x)*p,r=(e.max.x-S.x)*p):(n=(e.max.x-S.x)*p,r=(e.min.x-S.x)*p),y>=0?(i=(e.min.y-S.y)*y,a=(e.max.y-S.y)*y):(i=(e.max.y-S.y)*y,a=(e.min.y-S.y)*y),n>a||i>r||((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),x>=0?(c=(e.min.z-S.z)*x,u=(e.max.z-S.z)*x):(c=(e.max.z-S.z)*x,u=(e.min.z-S.z)*x),n>u||c>r)||((c>n||n!==n)&&(n=c),(u<r||r!==r)&&(r=u),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,xg)!==null}intersectTriangle(e,t,n,r,i){_V.subVectors(t,e),bR.subVectors(n,e),bV.crossVectors(_V,bR);let a=this.direction.dot(bV),c;if(a>0){if(r)return null;c=1}else if(a<0)c=-1,a=-a;else return null;m3.subVectors(this.origin,e);const u=c*this.direction.dot(bR.crossVectors(m3,bR));if(u<0)return null;const p=c*this.direction.dot(_V.cross(m3));if(p<0||u+p>a)return null;const y=-c*m3.dot(bV);return y<0?null:this.at(y/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},or=class xH{constructor(e,t,n,r,i,a,c,u,p,y,x,S,M,I,L,B){xH.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,u,p,y,x,S,M,I,L,B)}set(e,t,n,r,i,a,c,u,p,y,x,S,M,I,L,B){const A=this.elements;return A[0]=e,A[4]=t,A[8]=n,A[12]=r,A[1]=i,A[5]=a,A[9]=c,A[13]=u,A[2]=p,A[6]=y,A[10]=x,A[14]=S,A[3]=M,A[7]=I,A[11]=L,A[15]=B,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new xH().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/w7.setFromMatrixColumn(e,0).length(),i=1/w7.setFromMatrixColumn(e,1).length(),a=1/w7.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),c=Math.sin(n),u=Math.cos(r),p=Math.sin(r),y=Math.cos(i),x=Math.sin(i);if(e.order==="XYZ"){const S=a*y,M=a*x,I=c*y,L=c*x;t[0]=u*y,t[4]=-u*x,t[8]=p,t[1]=M+I*p,t[5]=S-L*p,t[9]=-c*u,t[2]=L-S*p,t[6]=I+M*p,t[10]=a*u}else if(e.order==="YXZ"){const S=u*y,M=u*x,I=p*y,L=p*x;t[0]=S+L*c,t[4]=I*c-M,t[8]=a*p,t[1]=a*x,t[5]=a*y,t[9]=-c,t[2]=M*c-I,t[6]=L+S*c,t[10]=a*u}else if(e.order==="ZXY"){const S=u*y,M=u*x,I=p*y,L=p*x;t[0]=S-L*c,t[4]=-a*x,t[8]=I+M*c,t[1]=M+I*c,t[5]=a*y,t[9]=L-S*c,t[2]=-a*p,t[6]=c,t[10]=a*u}else if(e.order==="ZYX"){const S=a*y,M=a*x,I=c*y,L=c*x;t[0]=u*y,t[4]=I*p-M,t[8]=S*p+L,t[1]=u*x,t[5]=L*p+S,t[9]=M*p-I,t[2]=-p,t[6]=c*u,t[10]=a*u}else if(e.order==="YZX"){const S=a*u,M=a*p,I=c*u,L=c*p;t[0]=u*y,t[4]=L-S*x,t[8]=I*x+M,t[1]=x,t[5]=a*y,t[9]=-c*y,t[2]=-p*y,t[6]=M*x+I,t[10]=S-L*x}else if(e.order==="XZY"){const S=a*u,M=a*p,I=c*u,L=c*p;t[0]=u*y,t[4]=-x,t[8]=p*y,t[1]=S*x+L,t[5]=a*y,t[9]=M*x-I,t[2]=I*x-M,t[6]=c*y,t[10]=L*x+S}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(iIe,e,sIe)}lookAt(e,t,n){const r=this.elements;return Vu.subVectors(e,t),Vu.lengthSq()===0&&(Vu.z=1),Vu.normalize(),g3.crossVectors(n,Vu),g3.lengthSq()===0&&(Math.abs(n.z)===1?Vu.x+=1e-4:Vu.z+=1e-4,Vu.normalize(),g3.crossVectors(n,Vu)),g3.normalize(),SR.crossVectors(Vu,g3),r[0]=g3.x,r[4]=SR.x,r[8]=Vu.x,r[1]=g3.y,r[5]=SR.y,r[9]=Vu.y,r[2]=g3.z,r[6]=SR.z,r[10]=Vu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[4],u=n[8],p=n[12],y=n[1],x=n[5],S=n[9],M=n[13],I=n[2],L=n[6],B=n[10],A=n[14],V=n[3],X=n[7],P=n[11],te=n[15],oe=r[0],ie=r[4],K=r[8],re=r[12],se=r[1],q=r[5],De=r[9],Be=r[13],tt=r[2],st=r[6],de=r[10],ft=r[14],Se=r[3],rt=r[7],ut=r[11],Pe=r[15];return i[0]=a*oe+c*se+u*tt+p*Se,i[4]=a*ie+c*q+u*st+p*rt,i[8]=a*K+c*De+u*de+p*ut,i[12]=a*re+c*Be+u*ft+p*Pe,i[1]=y*oe+x*se+S*tt+M*Se,i[5]=y*ie+x*q+S*st+M*rt,i[9]=y*K+x*De+S*de+M*ut,i[13]=y*re+x*Be+S*ft+M*Pe,i[2]=I*oe+L*se+B*tt+A*Se,i[6]=I*ie+L*q+B*st+A*rt,i[10]=I*K+L*De+B*de+A*ut,i[14]=I*re+L*Be+B*ft+A*Pe,i[3]=V*oe+X*se+P*tt+te*Se,i[7]=V*ie+X*q+P*st+te*rt,i[11]=V*K+X*De+P*de+te*ut,i[15]=V*re+X*Be+P*ft+te*Pe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],c=e[5],u=e[9],p=e[13],y=e[2],x=e[6],S=e[10],M=e[14],I=e[3],L=e[7],B=e[11],A=e[15];return I*(+i*u*x-r*p*x-i*c*S+n*p*S+r*c*M-n*u*M)+L*(+t*u*M-t*p*S+i*a*S-r*a*M+r*p*y-i*u*y)+B*(+t*p*x-t*c*M-i*a*x+n*a*M+i*c*y-n*p*y)+A*(-r*c*y-t*u*x+t*c*S+r*a*x-n*a*S+n*u*y)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],u=e[6],p=e[7],y=e[8],x=e[9],S=e[10],M=e[11],I=e[12],L=e[13],B=e[14],A=e[15],V=x*B*p-L*S*p+L*u*M-c*B*M-x*u*A+c*S*A,X=I*S*p-y*B*p-I*u*M+a*B*M+y*u*A-a*S*A,P=y*L*p-I*x*p+I*c*M-a*L*M-y*c*A+a*x*A,te=I*x*u-y*L*u-I*c*S+a*L*S+y*c*B-a*x*B,oe=t*V+n*X+r*P+i*te;if(oe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ie=1/oe;return e[0]=V*ie,e[1]=(L*S*i-x*B*i-L*r*M+n*B*M+x*r*A-n*S*A)*ie,e[2]=(c*B*i-L*u*i+L*r*p-n*B*p-c*r*A+n*u*A)*ie,e[3]=(x*u*i-c*S*i-x*r*p+n*S*p+c*r*M-n*u*M)*ie,e[4]=X*ie,e[5]=(y*B*i-I*S*i+I*r*M-t*B*M-y*r*A+t*S*A)*ie,e[6]=(I*u*i-a*B*i-I*r*p+t*B*p+a*r*A-t*u*A)*ie,e[7]=(a*S*i-y*u*i+y*r*p-t*S*p-a*r*M+t*u*M)*ie,e[8]=P*ie,e[9]=(I*x*i-y*L*i-I*n*M+t*L*M+y*n*A-t*x*A)*ie,e[10]=(a*L*i-I*c*i+I*n*p-t*L*p-a*n*A+t*c*A)*ie,e[11]=(y*c*i-a*x*i-y*n*p+t*x*p+a*n*M-t*c*M)*ie,e[12]=te*ie,e[13]=(y*L*r-I*x*r+I*n*S-t*L*S-y*n*B+t*x*B)*ie,e[14]=(I*c*r-a*L*r-I*n*u+t*L*u+a*n*B-t*c*B)*ie,e[15]=(a*x*r-y*c*r+y*n*u-t*x*u-a*n*S+t*c*S)*ie,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,c=e.y,u=e.z,p=i*a,y=i*c;return this.set(p*a+n,p*c-r*u,p*u+r*c,0,p*c+r*u,y*c+n,y*u-r*a,0,p*u-r*c,y*u+r*a,i*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,c=t._z,u=t._w,p=i+i,y=a+a,x=c+c,S=i*p,M=i*y,I=i*x,L=a*y,B=a*x,A=c*x,V=u*p,X=u*y,P=u*x,te=n.x,oe=n.y,ie=n.z;return r[0]=(1-(L+A))*te,r[1]=(M+P)*te,r[2]=(I-X)*te,r[3]=0,r[4]=(M-P)*oe,r[5]=(1-(S+A))*oe,r[6]=(B+V)*oe,r[7]=0,r[8]=(I+X)*ie,r[9]=(B-V)*ie,r[10]=(1-(S+L))*ie,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=w7.set(r[0],r[1],r[2]).length();const a=w7.set(r[4],r[5],r[6]).length(),c=w7.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],xf.copy(this);const p=1/i,y=1/a,x=1/c;return xf.elements[0]*=p,xf.elements[1]*=p,xf.elements[2]*=p,xf.elements[4]*=y,xf.elements[5]*=y,xf.elements[6]*=y,xf.elements[8]*=x,xf.elements[9]*=x,xf.elements[10]*=x,t.setFromRotationMatrix(xf),n.x=i,n.y=a,n.z=c,this}makePerspective(e,t,n,r,i,a,c=x1){const u=this.elements,p=2*i/(t-e),y=2*i/(n-r),x=(t+e)/(t-e),S=(n+r)/(n-r);let M,I;if(c===x1)M=-(a+i)/(a-i),I=-2*a*i/(a-i);else if(c===hk)M=-a/(a-i),I=-a*i/(a-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return u[0]=p,u[4]=0,u[8]=x,u[12]=0,u[1]=0,u[5]=y,u[9]=S,u[13]=0,u[2]=0,u[6]=0,u[10]=M,u[14]=I,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,n,r,i,a,c=x1){const u=this.elements,p=1/(t-e),y=1/(n-r),x=1/(a-i),S=(t+e)*p,M=(n+r)*y;let I,L;if(c===x1)I=(a+i)*x,L=-2*x;else if(c===hk)I=i*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return u[0]=2*p,u[4]=0,u[8]=0,u[12]=-S,u[1]=0,u[5]=2*y,u[9]=0,u[13]=-M,u[2]=0,u[6]=0,u[10]=L,u[14]=-I,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}};const w7=new Ae,xf=new or,iIe=new Ae(0,0,0),sIe=new Ae(1,1,1),g3=new Ae,SR=new Ae,Vu=new Ae,M9e=new or,C9e=new ls;let ua=class cve{constructor(e=0,t=0,n=0,r=cve.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],c=r[8],u=r[1],p=r[5],y=r[9],x=r[2],S=r[6],M=r[10];switch(t){case"XYZ":this._y=Math.asin(Jr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-y,M),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(S,p),this._z=0);break;case"YXZ":this._x=Math.asin(-Jr(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(c,M),this._z=Math.atan2(u,p)):(this._y=Math.atan2(-x,i),this._z=0);break;case"ZXY":this._x=Math.asin(Jr(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,M),this._z=Math.atan2(-a,p)):(this._y=0,this._z=Math.atan2(u,i));break;case"ZYX":this._y=Math.asin(-Jr(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,M),this._z=Math.atan2(u,i)):(this._x=0,this._z=Math.atan2(-a,p));break;case"YZX":this._z=Math.asin(Jr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-y,p),this._y=Math.atan2(-x,i)):(this._x=0,this._y=Math.atan2(c,M));break;case"XZY":this._z=Math.asin(-Jr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(S,p),this._y=Math.atan2(c,i)):(this._x=Math.atan2(-y,M),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return M9e.makeRotationFromQuaternion(e),this.setFromRotationMatrix(M9e,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return C9e.setFromEuler(this),this.setFromQuaternion(C9e,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};ua.DEFAULT_ORDER="XYZ";let LW=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},oIe=0;const A9e=new Ae,E7=new ls,_g=new or,wR=new Ae,uw=new Ae,aIe=new Ae,lIe=new ls,P9e=new Ae(1,0,0),R9e=new Ae(0,1,0),I9e=new Ae(0,0,1),k9e={type:"added"},cIe={type:"removed"},T7={type:"childadded",child:null},SV={type:"childremoved",child:null};let Ti=class qI extends nh{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:oIe++}),this.uuid=Z3(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=qI.DEFAULT_UP.clone();const e=new Ae,t=new ua,n=new ls,r=new Ae(1,1,1);function i(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(i),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new or},normalMatrix:{value:new si}}),this.matrix=new or,this.matrixWorld=new or,this.matrixAutoUpdate=qI.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=qI.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new LW,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return E7.setFromAxisAngle(e,t),this.quaternion.multiply(E7),this}rotateOnWorldAxis(e,t){return E7.setFromAxisAngle(e,t),this.quaternion.premultiply(E7),this}rotateX(e){return this.rotateOnAxis(P9e,e)}rotateY(e){return this.rotateOnAxis(R9e,e)}rotateZ(e){return this.rotateOnAxis(I9e,e)}translateOnAxis(e,t){return A9e.copy(e).applyQuaternion(this.quaternion),this.position.add(A9e.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(P9e,e)}translateY(e){return this.translateOnAxis(R9e,e)}translateZ(e){return this.translateOnAxis(I9e,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_g.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?wR.copy(e):wR.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),uw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_g.lookAt(uw,wR,this.up):_g.lookAt(wR,uw,this.up),this.quaternion.setFromRotationMatrix(_g),r&&(_g.extractRotation(r.matrixWorld),E7.setFromRotationMatrix(_g),this.quaternion.premultiply(E7.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(k9e),T7.child=e,this.dispatchEvent(T7),T7.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(cIe),SV.child=e,this.dispatchEvent(SV),SV.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),_g.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),_g.multiply(e.parent.matrixWorld)),e.applyMatrix4(_g),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(k9e),T7.child=e,this.dispatchEvent(T7),T7.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(uw,e,aIe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(uw,lIe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(c=>({...c})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function i(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const u=c.shapes;if(Array.isArray(u))for(let p=0,y=u.length;p<y;p++){const x=u[p];i(e.shapes,x)}else i(e.shapes,u)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let u=0,p=this.material.length;u<p;u++)c.push(i(e.materials,this.material[u]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){const u=this.animations[c];r.animations.push(i(e.animations,u))}}if(t){const c=a(e.geometries),u=a(e.materials),p=a(e.textures),y=a(e.images),x=a(e.shapes),S=a(e.skeletons),M=a(e.animations),I=a(e.nodes);c.length>0&&(n.geometries=c),u.length>0&&(n.materials=u),p.length>0&&(n.textures=p),y.length>0&&(n.images=y),x.length>0&&(n.shapes=x),S.length>0&&(n.skeletons=S),M.length>0&&(n.animations=M),I.length>0&&(n.nodes=I)}return n.object=r,n;function a(c){const u=[];for(const p in c){const y=c[p];delete y.metadata,u.push(y)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}};Ti.DEFAULT_UP=new Ae(0,1,0);Ti.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ti.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _f=new Ae,bg=new Ae,wV=new Ae,Sg=new Ae,M7=new Ae,C7=new Ae,N9e=new Ae,EV=new Ae,TV=new Ae,MV=new Ae,CV=new xi,AV=new xi,PV=new xi;let hw=class nx{constructor(e=new Ae,t=new Ae,n=new Ae){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),_f.subVectors(e,t),r.cross(_f);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){_f.subVectors(r,t),bg.subVectors(n,t),wV.subVectors(e,t);const a=_f.dot(_f),c=_f.dot(bg),u=_f.dot(wV),p=bg.dot(bg),y=bg.dot(wV),x=a*p-c*c;if(x===0)return i.set(0,0,0),null;const S=1/x,M=(p*u-c*y)*S,I=(a*y-c*u)*S;return i.set(1-M-I,I,M)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Sg)===null?!1:Sg.x>=0&&Sg.y>=0&&Sg.x+Sg.y<=1}static getInterpolation(e,t,n,r,i,a,c,u){return this.getBarycoord(e,t,n,r,Sg)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(i,Sg.x),u.addScaledVector(a,Sg.y),u.addScaledVector(c,Sg.z),u)}static getInterpolatedAttribute(e,t,n,r,i,a){return CV.setScalar(0),AV.setScalar(0),PV.setScalar(0),CV.fromBufferAttribute(e,t),AV.fromBufferAttribute(e,n),PV.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(CV,i.x),a.addScaledVector(AV,i.y),a.addScaledVector(PV,i.z),a}static isFrontFacing(e,t,n,r){return _f.subVectors(n,t),bg.subVectors(e,t),_f.cross(bg).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _f.subVectors(this.c,this.b),bg.subVectors(this.a,this.b),_f.cross(bg).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return nx.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return nx.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return nx.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return nx.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return nx.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,c;M7.subVectors(r,n),C7.subVectors(i,n),EV.subVectors(e,n);const u=M7.dot(EV),p=C7.dot(EV);if(u<=0&&p<=0)return t.copy(n);TV.subVectors(e,r);const y=M7.dot(TV),x=C7.dot(TV);if(y>=0&&x<=y)return t.copy(r);const S=u*x-y*p;if(S<=0&&u>=0&&y<=0)return a=u/(u-y),t.copy(n).addScaledVector(M7,a);MV.subVectors(e,i);const M=M7.dot(MV),I=C7.dot(MV);if(I>=0&&M<=I)return t.copy(i);const L=M*p-u*I;if(L<=0&&p>=0&&I<=0)return c=p/(p-I),t.copy(n).addScaledVector(C7,c);const B=y*I-M*x;if(B<=0&&x-y>=0&&M-I>=0)return N9e.subVectors(i,r),c=(x-y)/(x-y+(M-I)),t.copy(r).addScaledVector(N9e,c);const A=1/(B+L+S);return a=L*A,c=S*A,t.copy(n).addScaledVector(M7,a).addScaledVector(C7,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const uve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},v3={h:0,s:0,l:0},ER={h:0,s:0,l:0};function RV(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}let Pn=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=qr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Gr.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Gr.workingColorSpace){return this.r=e,this.g=t,this.b=n,Gr.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Gr.workingColorSpace){if(e=DW(e,1),t=Jr(t,0,1),n=Jr(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=RV(a,i,e+1/3),this.g=RV(a,i,e),this.b=RV(a,i,e-1/3)}return Gr.colorSpaceToWorking(this,r),this}setStyle(e,t=qr){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],c=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],a=i.length;if(a===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=qr){const n=uve[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Lg(e.r),this.g=Lg(e.g),this.b=Lg(e.b),this}copyLinearToSRGB(e){return this.r=bx(e.r),this.g=bx(e.g),this.b=bx(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=qr){return Gr.workingToColorSpace(ul.copy(this),e),Math.round(Jr(ul.r*255,0,255))*65536+Math.round(Jr(ul.g*255,0,255))*256+Math.round(Jr(ul.b*255,0,255))}getHexString(e=qr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Gr.workingColorSpace){Gr.workingToColorSpace(ul.copy(this),t);const n=ul.r,r=ul.g,i=ul.b,a=Math.max(n,r,i),c=Math.min(n,r,i);let u,p;const y=(c+a)/2;if(c===a)u=0,p=0;else{const x=a-c;switch(p=y<=.5?x/(a+c):x/(2-a-c),a){case n:u=(r-i)/x+(r<i?6:0);break;case r:u=(i-n)/x+2;break;case i:u=(n-r)/x+4;break}u/=6}return e.h=u,e.s=p,e.l=y,e}getRGB(e,t=Gr.workingColorSpace){return Gr.workingToColorSpace(ul.copy(this),t),e.r=ul.r,e.g=ul.g,e.b=ul.b,e}getStyle(e=qr){Gr.workingToColorSpace(ul.copy(this),e);const t=ul.r,n=ul.g,r=ul.b;return e!==qr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(v3),this.setHSL(v3.h+e,v3.s+t,v3.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(v3),e.getHSL(ER);const n=iE(v3.h,ER.h,t),r=iE(v3.s,ER.s,t),i=iE(v3.l,ER.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ul=new Pn;Pn.NAMES=uve;let uIe=0,rh=class extends nh{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:uIe++}),this.uuid=Z3(),this.name="",this.type="Material",this.blending=xv,this.side=E1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=mE,this.blendDst=gE,this.blendEquation=L3,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Pn(0,0,0),this.blendAlpha=0,this.depthFunc=Ix,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=x9e,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=y7,this.stencilZFail=y7,this.stencilZPass=y7,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==xv&&(n.blending=this.blending),this.side!==E1&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==mE&&(n.blendSrc=this.blendSrc),this.blendDst!==gE&&(n.blendDst=this.blendDst),this.blendEquation!==L3&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Ix&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==x9e&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==y7&&(n.stencilFail=this.stencilFail),this.stencilZFail!==y7&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==y7&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(i){const a=[];for(const c in i){const u=i[c];delete u.metadata,a.push(u)}return a}if(t){const i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},eh=class extends rh{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.combine=Gk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const kg=hIe();function hIe(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),r=new Uint32Array(512);for(let u=0;u<256;++u){const p=u-127;p<-27?(n[u]=0,n[u|256]=32768,r[u]=24,r[u|256]=24):p<-14?(n[u]=1024>>-p-14,n[u|256]=1024>>-p-14|32768,r[u]=-p-1,r[u|256]=-p-1):p<=15?(n[u]=p+15<<10,n[u|256]=p+15<<10|32768,r[u]=13,r[u|256]=13):p<128?(n[u]=31744,n[u|256]=64512,r[u]=24,r[u|256]=24):(n[u]=31744,n[u|256]=64512,r[u]=13,r[u|256]=13)}const i=new Uint32Array(2048),a=new Uint32Array(64),c=new Uint32Array(64);for(let u=1;u<1024;++u){let p=u<<13,y=0;for(;(p&8388608)===0;)p<<=1,y-=8388608;p&=-8388609,y+=947912704,i[u]=p|y}for(let u=1024;u<2048;++u)i[u]=939524096+(u-1024<<13);for(let u=1;u<31;++u)a[u]=u<<23;a[31]=1199570944,a[32]=2147483648;for(let u=33;u<63;++u)a[u]=2147483648+(u-32<<23);a[63]=3347054592;for(let u=1;u<64;++u)u!==32&&(c[u]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:i,exponentTable:a,offsetTable:c}}function dIe(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=Jr(s,-65504,65504),kg.floatView[0]=s;const e=kg.uint32View[0],t=e>>23&511;return kg.baseTable[t]+((e&8388607)>>kg.shiftTable[t])}function fIe(s){const e=s>>10;return kg.uint32View[0]=kg.mantissaTable[kg.offsetTable[e]+(s&1023)]+kg.exponentTable[e],kg.floatView[0]}class D9e{static toHalfFloat(e){return dIe(e)}static fromHalfFloat(e){return fIe(e)}}const aa=new Ae,TR=new An;let pIe=0,Qu=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:pIe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=_9e,this.updateRanges=[],this.gpuType=ed,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)TR.fromBufferAttribute(this,t),TR.applyMatrix3(e),this.setXY(t,TR.x,TR.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)aa.fromBufferAttribute(this,t),aa.applyMatrix3(e),this.setXYZ(t,aa.x,aa.y,aa.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)aa.fromBufferAttribute(this,t),aa.applyMatrix4(e),this.setXYZ(t,aa.x,aa.y,aa.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)aa.fromBufferAttribute(this,t),aa.applyNormalMatrix(e),this.setXYZ(t,aa.x,aa.y,aa.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)aa.fromBufferAttribute(this,t),aa.transformDirection(e),this.setXYZ(t,aa.x,aa.y,aa.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=tx(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=tc(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=tx(t,this.array)),t}setX(e,t){return this.normalized&&(t=tc(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=tx(t,this.array)),t}setY(e,t){return this.normalized&&(t=tc(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=tx(t,this.array)),t}setZ(e,t){return this.normalized&&(t=tc(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=tx(t,this.array)),t}setW(e,t){return this.normalized&&(t=tc(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=tc(t,this.array),n=tc(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=tc(t,this.array),n=tc(n,this.array),r=tc(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=tc(t,this.array),n=tc(n,this.array),r=tc(r,this.array),i=tc(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==_9e&&(e.usage=this.usage),e}},FW=class extends Qu{constructor(e,t,n){super(new Uint16Array(e),t,n)}},hve=class extends Qu{constructor(e,t,n){super(new Uint32Array(e),t,n)}},Er=class extends Qu{constructor(e,t,n){super(new Float32Array(e),t,n)}},mIe=0;const Xh=new or,IV=new Ti,A7=new Ae,Gu=new Cv,dw=new Cv,Ka=new Ae;let rs=class dve extends nh{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:mIe++}),this.uuid=Z3(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(sve(e)?hve:FW)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new si().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Xh.makeRotationFromQuaternion(e),this.applyMatrix4(Xh),this}rotateX(e){return Xh.makeRotationX(e),this.applyMatrix4(Xh),this}rotateY(e){return Xh.makeRotationY(e),this.applyMatrix4(Xh),this}rotateZ(e){return Xh.makeRotationZ(e),this.applyMatrix4(Xh),this}translate(e,t,n){return Xh.makeTranslation(e,t,n),this.applyMatrix4(Xh),this}scale(e,t,n){return Xh.makeScale(e,t,n),this.applyMatrix4(Xh),this}lookAt(e){return IV.lookAt(e),IV.updateMatrix(),this.applyMatrix4(IV.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(A7).negate(),this.translate(A7.x,A7.y,A7.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Er(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const i=e[r];t.setXYZ(r,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cv);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ae(-1/0,-1/0,-1/0),new Ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const i=t[n];Gu.setFromBufferAttribute(i),this.morphTargetsRelative?(Ka.addVectors(this.boundingBox.min,Gu.min),this.boundingBox.expandByPoint(Ka),Ka.addVectors(this.boundingBox.max,Gu.max),this.boundingBox.expandByPoint(Ka)):(this.boundingBox.expandByPoint(Gu.min),this.boundingBox.expandByPoint(Gu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Q3);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ae,1/0);return}if(e){const n=this.boundingSphere.center;if(Gu.setFromBufferAttribute(e),t)for(let i=0,a=t.length;i<a;i++){const c=t[i];dw.setFromBufferAttribute(c),this.morphTargetsRelative?(Ka.addVectors(Gu.min,dw.min),Gu.expandByPoint(Ka),Ka.addVectors(Gu.max,dw.max),Gu.expandByPoint(Ka)):(Gu.expandByPoint(dw.min),Gu.expandByPoint(dw.max))}Gu.getCenter(n);let r=0;for(let i=0,a=e.count;i<a;i++)Ka.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Ka));if(t)for(let i=0,a=t.length;i<a;i++){const c=t[i],u=this.morphTargetsRelative;for(let p=0,y=c.count;p<y;p++)Ka.fromBufferAttribute(c,p),u&&(A7.fromBufferAttribute(e,p),Ka.add(A7)),r=Math.max(r,n.distanceToSquared(Ka))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Qu(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),c=[],u=[];for(let K=0;K<n.count;K++)c[K]=new Ae,u[K]=new Ae;const p=new Ae,y=new Ae,x=new Ae,S=new An,M=new An,I=new An,L=new Ae,B=new Ae;function A(K,re,se){p.fromBufferAttribute(n,K),y.fromBufferAttribute(n,re),x.fromBufferAttribute(n,se),S.fromBufferAttribute(i,K),M.fromBufferAttribute(i,re),I.fromBufferAttribute(i,se),y.sub(p),x.sub(p),M.sub(S),I.sub(S);const q=1/(M.x*I.y-I.x*M.y);isFinite(q)&&(L.copy(y).multiplyScalar(I.y).addScaledVector(x,-M.y).multiplyScalar(q),B.copy(x).multiplyScalar(M.x).addScaledVector(y,-I.x).multiplyScalar(q),c[K].add(L),c[re].add(L),c[se].add(L),u[K].add(B),u[re].add(B),u[se].add(B))}let V=this.groups;V.length===0&&(V=[{start:0,count:e.count}]);for(let K=0,re=V.length;K<re;++K){const se=V[K],q=se.start,De=se.count;for(let Be=q,tt=q+De;Be<tt;Be+=3)A(e.getX(Be+0),e.getX(Be+1),e.getX(Be+2))}const X=new Ae,P=new Ae,te=new Ae,oe=new Ae;function ie(K){te.fromBufferAttribute(r,K),oe.copy(te);const re=c[K];X.copy(re),X.sub(te.multiplyScalar(te.dot(re))).normalize(),P.crossVectors(oe,re);const q=P.dot(u[K])<0?-1:1;a.setXYZW(K,X.x,X.y,X.z,q)}for(let K=0,re=V.length;K<re;++K){const se=V[K],q=se.start,De=se.count;for(let Be=q,tt=q+De;Be<tt;Be+=3)ie(e.getX(Be+0)),ie(e.getX(Be+1)),ie(e.getX(Be+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Qu(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let S=0,M=n.count;S<M;S++)n.setXYZ(S,0,0,0);const r=new Ae,i=new Ae,a=new Ae,c=new Ae,u=new Ae,p=new Ae,y=new Ae,x=new Ae;if(e)for(let S=0,M=e.count;S<M;S+=3){const I=e.getX(S+0),L=e.getX(S+1),B=e.getX(S+2);r.fromBufferAttribute(t,I),i.fromBufferAttribute(t,L),a.fromBufferAttribute(t,B),y.subVectors(a,i),x.subVectors(r,i),y.cross(x),c.fromBufferAttribute(n,I),u.fromBufferAttribute(n,L),p.fromBufferAttribute(n,B),c.add(y),u.add(y),p.add(y),n.setXYZ(I,c.x,c.y,c.z),n.setXYZ(L,u.x,u.y,u.z),n.setXYZ(B,p.x,p.y,p.z)}else for(let S=0,M=t.count;S<M;S+=3)r.fromBufferAttribute(t,S+0),i.fromBufferAttribute(t,S+1),a.fromBufferAttribute(t,S+2),y.subVectors(a,i),x.subVectors(r,i),y.cross(x),n.setXYZ(S+0,y.x,y.y,y.z),n.setXYZ(S+1,y.x,y.y,y.z),n.setXYZ(S+2,y.x,y.y,y.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ka.fromBufferAttribute(e,t),Ka.normalize(),e.setXYZ(t,Ka.x,Ka.y,Ka.z)}toNonIndexed(){function e(c,u){const p=c.array,y=c.itemSize,x=c.normalized,S=new p.constructor(u.length*y);let M=0,I=0;for(let L=0,B=u.length;L<B;L++){c.isInterleavedBufferAttribute?M=u[L]*c.data.stride+c.offset:M=u[L]*y;for(let A=0;A<y;A++)S[I++]=p[M++]}return new Qu(S,y,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new dve,n=this.index.array,r=this.attributes;for(const c in r){const u=r[c],p=e(u,n);t.setAttribute(c,p)}const i=this.morphAttributes;for(const c in i){const u=[],p=i[c];for(let y=0,x=p.length;y<x;y++){const S=p[y],M=e(S,n);u.push(M)}t.morphAttributes[c]=u}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,u=a.length;c<u;c++){const p=a[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const p in u)u[p]!==void 0&&(e[p]=u[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n){const p=n[u];e.data.attributes[u]=p.toJSON(e.data)}const r={};let i=!1;for(const u in this.morphAttributes){const p=this.morphAttributes[u],y=[];for(let x=0,S=p.length;x<S;x++){const M=p[x];y.push(M.toJSON(e.data))}y.length>0&&(r[u]=y,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const y=r[p];this.setAttribute(p,y.clone(t))}const i=e.morphAttributes;for(const p in i){const y=[],x=i[p];for(let S=0,M=x.length;S<M;S++)y.push(x[S].clone(t));this.morphAttributes[p]=y}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let p=0,y=a.length;p<y;p++){const x=a[p];this.addGroup(x.start,x.count,x.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const O9e=new or,z8=new Jx,MR=new Q3,L9e=new Ae,CR=new Ae,AR=new Ae,PR=new Ae,kV=new Ae,RR=new Ae,F9e=new Ae,IR=new Ae;let mn=class extends Ti{constructor(e=new rs,t=new eh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const c=this.morphTargetInfluences;if(i&&c){RR.set(0,0,0);for(let u=0,p=i.length;u<p;u++){const y=c[u],x=i[u];y!==0&&(kV.fromBufferAttribute(x,e),a?RR.addScaledVector(kV,y):RR.addScaledVector(kV.sub(t),y))}t.add(RR)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),MR.copy(n.boundingSphere),MR.applyMatrix4(i),z8.copy(e.ray).recast(e.near),!(MR.containsPoint(z8.origin)===!1&&(z8.intersectSphere(MR,L9e)===null||z8.origin.distanceToSquared(L9e)>(e.far-e.near)**2))&&(O9e.copy(i).invert(),z8.copy(e.ray).applyMatrix4(O9e),!(n.boundingBox!==null&&z8.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,z8)))}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,c=i.index,u=i.attributes.position,p=i.attributes.uv,y=i.attributes.uv1,x=i.attributes.normal,S=i.groups,M=i.drawRange;if(c!==null)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const B=S[I],A=a[B.materialIndex],V=Math.max(B.start,M.start),X=Math.min(c.count,Math.min(B.start+B.count,M.start+M.count));for(let P=V,te=X;P<te;P+=3){const oe=c.getX(P),ie=c.getX(P+1),K=c.getX(P+2);r=kR(this,A,e,n,p,y,x,oe,ie,K),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=B.materialIndex,t.push(r))}}else{const I=Math.max(0,M.start),L=Math.min(c.count,M.start+M.count);for(let B=I,A=L;B<A;B+=3){const V=c.getX(B),X=c.getX(B+1),P=c.getX(B+2);r=kR(this,a,e,n,p,y,x,V,X,P),r&&(r.faceIndex=Math.floor(B/3),t.push(r))}}else if(u!==void 0)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const B=S[I],A=a[B.materialIndex],V=Math.max(B.start,M.start),X=Math.min(u.count,Math.min(B.start+B.count,M.start+M.count));for(let P=V,te=X;P<te;P+=3){const oe=P,ie=P+1,K=P+2;r=kR(this,A,e,n,p,y,x,oe,ie,K),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=B.materialIndex,t.push(r))}}else{const I=Math.max(0,M.start),L=Math.min(u.count,M.start+M.count);for(let B=I,A=L;B<A;B+=3){const V=B,X=B+1,P=B+2;r=kR(this,a,e,n,p,y,x,V,X,P),r&&(r.faceIndex=Math.floor(B/3),t.push(r))}}}};function gIe(s,e,t,n,r,i,a,c){let u;if(e.side===Qo?u=n.intersectTriangle(a,i,r,!0,c):u=n.intersectTriangle(r,i,a,e.side===E1,c),u===null)return null;IR.copy(c),IR.applyMatrix4(s.matrixWorld);const p=t.ray.origin.distanceTo(IR);return p<t.near||p>t.far?null:{distance:p,point:IR.clone(),object:s}}function kR(s,e,t,n,r,i,a,c,u,p){s.getVertexPosition(c,CR),s.getVertexPosition(u,AR),s.getVertexPosition(p,PR);const y=gIe(s,e,t,n,CR,AR,PR,F9e);if(y){const x=new Ae;hw.getBarycoord(F9e,CR,AR,PR,x),r&&(y.uv=hw.getInterpolatedAttribute(r,c,u,p,x,new An)),i&&(y.uv1=hw.getInterpolatedAttribute(i,c,u,p,x,new An)),a&&(y.normal=hw.getInterpolatedAttribute(a,c,u,p,x,new Ae),y.normal.dot(n.direction)>0&&y.normal.multiplyScalar(-1));const S={a:c,b:u,c:p,normal:new Ae,materialIndex:0};hw.getNormal(CR,AR,PR,S.normal),y.face=S,y.barycoord=x}return y}let Ta=class fve extends rs{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const c=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const u=[],p=[],y=[],x=[];let S=0,M=0;I("z","y","x",-1,-1,n,t,e,a,i,0),I("z","y","x",1,-1,n,t,-e,a,i,1),I("x","z","y",1,1,e,n,t,r,a,2),I("x","z","y",1,-1,e,n,-t,r,a,3),I("x","y","z",1,-1,e,t,n,r,i,4),I("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(u),this.setAttribute("position",new Er(p,3)),this.setAttribute("normal",new Er(y,3)),this.setAttribute("uv",new Er(x,2));function I(L,B,A,V,X,P,te,oe,ie,K,re){const se=P/ie,q=te/K,De=P/2,Be=te/2,tt=oe/2,st=ie+1,de=K+1;let ft=0,Se=0;const rt=new Ae;for(let ut=0;ut<de;ut++){const Pe=ut*q-Be;for(let vt=0;vt<st;vt++){const Bt=vt*se-De;rt[L]=Bt*V,rt[B]=Pe*X,rt[A]=tt,p.push(rt.x,rt.y,rt.z),rt[L]=0,rt[B]=0,rt[A]=oe>0?1:-1,y.push(rt.x,rt.y,rt.z),x.push(vt/ie),x.push(1-ut/K),ft+=1}}for(let ut=0;ut<K;ut++)for(let Pe=0;Pe<ie;Pe++){const vt=S+Pe+st*ut,Bt=S+Pe+st*(ut+1),ct=S+(Pe+1)+st*(ut+1),Pt=S+(Pe+1)+st*ut;u.push(vt,Bt,Pt),u.push(Bt,ct,Pt),Se+=6}c.addGroup(M,Se,re),M+=Se,S+=ft}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fve(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Fx(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const r=s[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function nc(s){const e={};for(let t=0;t<s.length;t++){const n=Fx(s[t]);for(const r in n)e[r]=n[r]}return e}function vIe(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function pve(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Gr.workingColorSpace}const yIe={clone:Fx,merge:nc};var xIe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,_Ie=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;let r0=class extends rh{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=xIe,this.fragmentShader=_Ie,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fx(e.uniforms),this.uniformsGroups=vIe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},Hk=class extends Ti{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new or,this.projectionMatrix=new or,this.projectionMatrixInverse=new or,this.coordinateSystem=x1}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const y3=new Ae,B9e=new An,U9e=new An;let Ja=class extends Hk{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Lx*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(rE*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Lx*2*Math.atan(Math.tan(rE*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){y3.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(y3.x,y3.y).multiplyScalar(-e/y3.z),y3.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(y3.x,y3.y).multiplyScalar(-e/y3.z)}getViewSize(e,t){return this.getViewBounds(e,B9e,U9e),t.subVectors(U9e,B9e)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(rE*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const u=a.fullWidth,p=a.fullHeight;i+=a.offsetX*r/u,t-=a.offsetY*n/p,r*=a.width/u,n*=a.height/p}const c=this.filmOffset;c!==0&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const P7=-90,R7=1;let bIe=class extends Ti{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ja(P7,R7,e,t);r.layers=this.layers,this.add(r);const i=new Ja(P7,R7,e,t);i.layers=this.layers,this.add(i);const a=new Ja(P7,R7,e,t);a.layers=this.layers,this.add(a);const c=new Ja(P7,R7,e,t);c.layers=this.layers,this.add(c);const u=new Ja(P7,R7,e,t);u.layers=this.layers,this.add(u);const p=new Ja(P7,R7,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,c,u]=t;for(const p of t)this.remove(p);if(e===x1)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===hk)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,c,u,p,y]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),M=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const L=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,c),e.setRenderTarget(n,3,r),e.render(t,u),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=L,e.setRenderTarget(n,5,r),e.render(t,y),e.setRenderTarget(x,S,M),e.xr.enabled=I,n.texture.needsPMREMUpdate=!0}},BW=class extends n0{constructor(e=[],t=kx,n,r,i,a,c,u,p,y){super(e,t,n,r,i,a,c,u,p,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},SIe=class extends bl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new BW(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Ta(5,5,5),i=new r0({name:"CubemapFromEquirect",uniforms:Fx(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Qo,blending:cc});i.uniforms.tEquirect.value=t;const a=new mn(r,i),c=t.minFilter;return t.minFilter===mv&&(t.minFilter=e0),new bIe(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}},gv=class extends Ti{constructor(){super(),this.isGroup=!0,this.type="Group"}};const wIe={type:"move"};let NV=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new gv,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new gv,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new gv,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const c=this._targetRay,u=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){a=!0;for(const L of e.hand.values()){const B=t.getJointPose(L,n),A=this._getHandJoint(p,L);B!==null&&(A.matrix.fromArray(B.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=B.radius),A.visible=B!==null}const y=p.joints["index-finger-tip"],x=p.joints["thumb-tip"],S=y.position.distanceTo(x.position),M=.02,I=.005;p.inputState.pinching&&S>M+I?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&S<=M-I&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1));c!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&i!==null&&(r=i),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(wIe)))}return c!==null&&(c.visible=r!==null),u!==null&&(u.visible=i!==null),p!==null&&(p.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new gv;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},_E=class extends Ti{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ua,this.environmentIntensity=1,this.environmentRotation=new ua,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};const z9e=new Ae,V9e=new xi,G9e=new xi,EIe=new Ae,j9e=new or,NR=new Ae,DV=new Q3,H9e=new or,OV=new Jx;class UW extends mn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=y9e,this.bindMatrix=new or,this.bindMatrixInverse=new or,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Cv),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,NR),this.boundingBox.expandByPoint(NR)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Q3),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,NR),this.boundingSphere.expandByPoint(NR)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),DV.copy(this.boundingSphere),DV.applyMatrix4(r),e.ray.intersectsSphere(DV)!==!1&&(H9e.copy(r).invert(),OV.copy(e.ray).applyMatrix4(H9e),!(this.boundingBox!==null&&OV.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,OV)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new xi,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===y9e?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===vRe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;V9e.fromBufferAttribute(r.attributes.skinIndex,e),G9e.fromBufferAttribute(r.attributes.skinWeight,e),z9e.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const a=G9e.getComponent(i);if(a!==0){const c=V9e.getComponent(i);j9e.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(EIe.copy(z9e).applyMatrix4(j9e),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class _H extends Ti{constructor(){super(),this.isBone=!0,this.type="Bone"}}let Ww=class extends n0{constructor(e=null,t=1,n=1,r,i,a,c,u,p=R0,y=R0,x,S){super(null,a,c,u,p,y,r,i,x,S),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const W9e=new or,TIe=new or;class zW{constructor(e=[],t=[]){this.uuid=Z3(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new or)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new or;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,a=e.length;i<a;i++){const c=e[i]?e[i].matrixWorld:TIe;W9e.multiplyMatrices(c,t[i]),W9e.toArray(n,i*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new zW(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Ww(t,e,e,yl,ed);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const i=e.bones[n];let a=t[i];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new _H),this.bones.push(a),this.boneInverses.push(new or().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const a=t[r];e.bones.push(a.uuid);const c=n[r];e.boneInverses.push(c.toArray())}return e}}const LV=new Ae,MIe=new Ae,CIe=new si;let k3=class{constructor(e=new Ae(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=LV.subVectors(n,t).cross(MIe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(LV),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||CIe.getNormalMatrix(e),r=this.coplanarPoint(LV).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const V8=new Q3,DR=new Ae;let VW=class{constructor(e=new k3,t=new k3,n=new k3,r=new k3,i=new k3,a=new k3){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(i),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=x1){const n=this.planes,r=e.elements,i=r[0],a=r[1],c=r[2],u=r[3],p=r[4],y=r[5],x=r[6],S=r[7],M=r[8],I=r[9],L=r[10],B=r[11],A=r[12],V=r[13],X=r[14],P=r[15];if(n[0].setComponents(u-i,S-p,B-M,P-A).normalize(),n[1].setComponents(u+i,S+p,B+M,P+A).normalize(),n[2].setComponents(u+a,S+y,B+I,P+V).normalize(),n[3].setComponents(u-a,S-y,B-I,P-V).normalize(),n[4].setComponents(u-c,S-x,B-L,P-X).normalize(),t===x1)n[5].setComponents(u+c,S+x,B+L,P+X).normalize();else if(t===hk)n[5].setComponents(c,x,L,X).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),V8.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),V8.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(V8)}intersectsSprite(e){return V8.center.set(0,0,0),V8.radius=.7071067811865476,V8.applyMatrix4(e.matrixWorld),this.intersectsSphere(V8)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(DR.x=r.normal.x>0?e.max.x:e.min.x,DR.y=r.normal.y>0?e.max.y:e.min.y,DR.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(DR)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},Ff=class extends rh{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const dk=new Ae,fk=new Ae,$9e=new or,fw=new Jx,OR=new Q3,FV=new Ae,q9e=new Ae;class Kc extends Ti{constructor(e=new rs,t=new Ff){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,i=t.count;r<i;r++)dk.fromBufferAttribute(t,r-1),fk.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=dk.distanceTo(fk);e.setAttribute("lineDistance",new Er(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),OR.copy(n.boundingSphere),OR.applyMatrix4(r),OR.radius+=i,e.ray.intersectsSphere(OR)===!1)return;$9e.copy(r).invert(),fw.copy(e.ray).applyMatrix4($9e);const c=i/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,p=this.isLineSegments?2:1,y=n.index,S=n.attributes.position;if(y!==null){const M=Math.max(0,a.start),I=Math.min(y.count,a.start+a.count);for(let L=M,B=I-1;L<B;L+=p){const A=y.getX(L),V=y.getX(L+1),X=LR(this,e,fw,u,A,V,L);X&&t.push(X)}if(this.isLineLoop){const L=y.getX(I-1),B=y.getX(M),A=LR(this,e,fw,u,L,B,I-1);A&&t.push(A)}}else{const M=Math.max(0,a.start),I=Math.min(S.count,a.start+a.count);for(let L=M,B=I-1;L<B;L+=p){const A=LR(this,e,fw,u,L,L+1,L);A&&t.push(A)}if(this.isLineLoop){const L=LR(this,e,fw,u,I-1,M,I-1);L&&t.push(L)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}}function LR(s,e,t,n,r,i,a){const c=s.geometry.attributes.position;if(dk.fromBufferAttribute(c,r),fk.fromBufferAttribute(c,i),t.distanceSqToSegment(dk,fk,FV,q9e)>n)return;FV.applyMatrix4(s.matrixWorld);const p=e.ray.origin.distanceTo(FV);if(!(p<e.near||p>e.far))return{distance:p,point:q9e.clone().applyMatrix4(s.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:s}}const X9e=new Ae,Y9e=new Ae;class BE extends Kc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,i=t.count;r<i;r+=2)X9e.fromBufferAttribute(t,r),Y9e.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+X9e.distanceTo(Y9e);e.setAttribute("lineDistance",new Er(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}let mve=class extends rh{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Pn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};const K9e=new or,bH=new Jx,FR=new Q3,BR=new Ae;class AIe extends Ti{constructor(e=new rs,t=new mve){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),FR.copy(n.boundingSphere),FR.applyMatrix4(r),FR.radius+=i,e.ray.intersectsSphere(FR)===!1)return;K9e.copy(r).invert(),bH.copy(e.ray).applyMatrix4(K9e);const c=i/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,p=n.index,x=n.attributes.position;if(p!==null){const S=Math.max(0,a.start),M=Math.min(p.count,a.start+a.count);for(let I=S,L=M;I<L;I++){const B=p.getX(I);BR.fromBufferAttribute(x,B),Z9e(BR,B,u,r,e,t,this)}}else{const S=Math.max(0,a.start),M=Math.min(x.count,a.start+a.count);for(let I=S,L=M;I<L;I++)BR.fromBufferAttribute(x,I),Z9e(BR,I,u,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}}function Z9e(s,e,t,n,r,i,a){const c=bH.distanceSqToPoint(s);if(c<t){const u=new Ae;bH.closestPointToPoint(s,u),u.applyMatrix4(n);const p=r.ray.origin.distanceTo(u);if(p<r.near||p>r.far)return;i.push({distance:p,distanceToRay:Math.sqrt(c),point:u,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}let GW=class extends n0{constructor(e,t,n=H3,r,i,a,c=R0,u=R0,p,y=yE,x=1){if(y!==yE&&y!==Ox)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const S={width:e,height:t,depth:x};super(S,r,i,a,c,u,y,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new OW(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};class Wk extends rs{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],a=[],c=[],u=[],p=new Ae,y=new An;a.push(0,0,0),c.push(0,0,1),u.push(.5,.5);for(let x=0,S=3;x<=t;x++,S+=3){const M=n+x/t*r;p.x=e*Math.cos(M),p.y=e*Math.sin(M),a.push(p.x,p.y,p.z),c.push(0,0,1),y.x=(a[S]/e+1)/2,y.y=(a[S+1]/e+1)/2,u.push(y.x,y.y)}for(let x=1;x<=t;x++)i.push(x,x+1,0);this.setIndex(i),this.setAttribute("position",new Er(a,3)),this.setAttribute("normal",new Er(c,3)),this.setAttribute("uv",new Er(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wk(e.radius,e.segments,e.thetaStart,e.thetaLength)}}let qc=class gve extends rs{constructor(e=1,t=1,n=1,r=32,i=1,a=!1,c=0,u=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:c,thetaLength:u};const p=this;r=Math.floor(r),i=Math.floor(i);const y=[],x=[],S=[],M=[];let I=0;const L=[],B=n/2;let A=0;V(),a===!1&&(e>0&&X(!0),t>0&&X(!1)),this.setIndex(y),this.setAttribute("position",new Er(x,3)),this.setAttribute("normal",new Er(S,3)),this.setAttribute("uv",new Er(M,2));function V(){const P=new Ae,te=new Ae;let oe=0;const ie=(t-e)/n;for(let K=0;K<=i;K++){const re=[],se=K/i,q=se*(t-e)+e;for(let De=0;De<=r;De++){const Be=De/r,tt=Be*u+c,st=Math.sin(tt),de=Math.cos(tt);te.x=q*st,te.y=-se*n+B,te.z=q*de,x.push(te.x,te.y,te.z),P.set(st,ie,de).normalize(),S.push(P.x,P.y,P.z),M.push(Be,1-se),re.push(I++)}L.push(re)}for(let K=0;K<r;K++)for(let re=0;re<i;re++){const se=L[re][K],q=L[re+1][K],De=L[re+1][K+1],Be=L[re][K+1];(e>0||re!==0)&&(y.push(se,q,Be),oe+=3),(t>0||re!==i-1)&&(y.push(q,De,Be),oe+=3)}p.addGroup(A,oe,0),A+=oe}function X(P){const te=I,oe=new An,ie=new Ae;let K=0;const re=P===!0?e:t,se=P===!0?1:-1;for(let De=1;De<=r;De++)x.push(0,B*se,0),S.push(0,se,0),M.push(.5,.5),I++;const q=I;for(let De=0;De<=r;De++){const tt=De/r*u+c,st=Math.cos(tt),de=Math.sin(tt);ie.x=re*de,ie.y=B*se,ie.z=re*st,x.push(ie.x,ie.y,ie.z),S.push(0,se,0),oe.x=st*.5+.5,oe.y=de*.5*se+.5,M.push(oe.x,oe.y),I++}for(let De=0;De<r;De++){const Be=te+De,tt=q+De;P===!0?y.push(tt,tt+1,Be):y.push(tt+1,tt,Be),K+=3}p.addGroup(A,K,P===!0?1:2),A+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gve(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};class jW extends rs{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],a=[];c(r),p(n),y(),this.setAttribute("position",new Er(i,3)),this.setAttribute("normal",new Er(i.slice(),3)),this.setAttribute("uv",new Er(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function c(V){const X=new Ae,P=new Ae,te=new Ae;for(let oe=0;oe<t.length;oe+=3)M(t[oe+0],X),M(t[oe+1],P),M(t[oe+2],te),u(X,P,te,V)}function u(V,X,P,te){const oe=te+1,ie=[];for(let K=0;K<=oe;K++){ie[K]=[];const re=V.clone().lerp(P,K/oe),se=X.clone().lerp(P,K/oe),q=oe-K;for(let De=0;De<=q;De++)De===0&&K===oe?ie[K][De]=re:ie[K][De]=re.clone().lerp(se,De/q)}for(let K=0;K<oe;K++)for(let re=0;re<2*(oe-K)-1;re++){const se=Math.floor(re/2);re%2===0?(S(ie[K][se+1]),S(ie[K+1][se]),S(ie[K][se])):(S(ie[K][se+1]),S(ie[K+1][se+1]),S(ie[K+1][se]))}}function p(V){const X=new Ae;for(let P=0;P<i.length;P+=3)X.x=i[P+0],X.y=i[P+1],X.z=i[P+2],X.normalize().multiplyScalar(V),i[P+0]=X.x,i[P+1]=X.y,i[P+2]=X.z}function y(){const V=new Ae;for(let X=0;X<i.length;X+=3){V.x=i[X+0],V.y=i[X+1],V.z=i[X+2];const P=B(V)/2/Math.PI+.5,te=A(V)/Math.PI+.5;a.push(P,1-te)}I(),x()}function x(){for(let V=0;V<a.length;V+=6){const X=a[V+0],P=a[V+2],te=a[V+4],oe=Math.max(X,P,te),ie=Math.min(X,P,te);oe>.9&&ie<.1&&(X<.2&&(a[V+0]+=1),P<.2&&(a[V+2]+=1),te<.2&&(a[V+4]+=1))}}function S(V){i.push(V.x,V.y,V.z)}function M(V,X){const P=V*3;X.x=e[P+0],X.y=e[P+1],X.z=e[P+2]}function I(){const V=new Ae,X=new Ae,P=new Ae,te=new Ae,oe=new An,ie=new An,K=new An;for(let re=0,se=0;re<i.length;re+=9,se+=6){V.set(i[re+0],i[re+1],i[re+2]),X.set(i[re+3],i[re+4],i[re+5]),P.set(i[re+6],i[re+7],i[re+8]),oe.set(a[se+0],a[se+1]),ie.set(a[se+2],a[se+3]),K.set(a[se+4],a[se+5]),te.copy(V).add(X).add(P).divideScalar(3);const q=B(te);L(oe,se+0,V,q),L(ie,se+2,X,q),L(K,se+4,P,q)}}function L(V,X,P,te){te<0&&V.x===1&&(a[X]=V.x-1),P.x===0&&P.z===0&&(a[X]=te/2/Math.PI+.5)}function B(V){return Math.atan2(V.z,-V.x)}function A(V){return Math.atan2(-V.y,Math.sqrt(V.x*V.x+V.z*V.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jW(e.vertices,e.indices,e.radius,e.details)}}class vve{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const i=n.length;let a;t?a=t:a=e*n[i-1];let c=0,u=i-1,p;for(;c<=u;)if(r=Math.floor(c+(u-c)/2),p=n[r]-a,p<0)c=r+1;else if(p>0)u=r-1;else{u=r;break}if(r=u,n[r]===a)return r/(i-1);const y=n[r],S=n[r+1]-y,M=(a-y)/S;return(r+M)/(i-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),c=this.getPoint(i),u=t||(a.isVector2?new An:new Ae);return u.copy(c).sub(a).normalize(),u}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new Ae,r=[],i=[],a=[],c=new Ae,u=new or;for(let M=0;M<=e;M++){const I=M/e;r[M]=this.getTangentAt(I,new Ae)}i[0]=new Ae,a[0]=new Ae;let p=Number.MAX_VALUE;const y=Math.abs(r[0].x),x=Math.abs(r[0].y),S=Math.abs(r[0].z);y<=p&&(p=y,n.set(1,0,0)),x<=p&&(p=x,n.set(0,1,0)),S<=p&&n.set(0,0,1),c.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],c),a[0].crossVectors(r[0],i[0]);for(let M=1;M<=e;M++){if(i[M]=i[M-1].clone(),a[M]=a[M-1].clone(),c.crossVectors(r[M-1],r[M]),c.length()>Number.EPSILON){c.normalize();const I=Math.acos(Jr(r[M-1].dot(r[M]),-1,1));i[M].applyMatrix4(u.makeRotationAxis(c,I))}a[M].crossVectors(r[M],i[M])}if(t===!0){let M=Math.acos(Jr(i[0].dot(i[e]),-1,1));M/=e,r[0].dot(c.crossVectors(i[0],i[e]))>0&&(M=-M);for(let I=1;I<=e;I++)i[I].applyMatrix4(u.makeRotationAxis(r[I],M*I)),a[I].crossVectors(r[I],i[I])}return{tangents:r,normals:i,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function HW(){let s=0,e=0,t=0,n=0;function r(i,a,c,u){s=i,e=c,t=-3*i+3*a-2*c-u,n=2*i-2*a+c+u}return{initCatmullRom:function(i,a,c,u,p){r(a,c,p*(c-i),p*(u-a))},initNonuniformCatmullRom:function(i,a,c,u,p,y,x){let S=(a-i)/p-(c-i)/(p+y)+(c-a)/y,M=(c-a)/y-(u-a)/(y+x)+(u-c)/x;S*=y,M*=y,r(a,c,S,M)},calc:function(i){const a=i*i,c=a*i;return s+e*i+t*a+n*c}}}const UR=new Ae,BV=new HW,UV=new HW,zV=new HW;class Q9e extends vve{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Ae){const n=t,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e;let c=Math.floor(a),u=a-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/i)+1)*i:u===0&&c===i-1&&(c=i-2,u=1);let p,y;this.closed||c>0?p=r[(c-1)%i]:(UR.subVectors(r[0],r[1]).add(r[0]),p=UR);const x=r[c%i],S=r[(c+1)%i];if(this.closed||c+2<i?y=r[(c+2)%i]:(UR.subVectors(r[i-1],r[i-2]).add(r[i-1]),y=UR),this.curveType==="centripetal"||this.curveType==="chordal"){const M=this.curveType==="chordal"?.5:.25;let I=Math.pow(p.distanceToSquared(x),M),L=Math.pow(x.distanceToSquared(S),M),B=Math.pow(S.distanceToSquared(y),M);L<1e-4&&(L=1),I<1e-4&&(I=L),B<1e-4&&(B=L),BV.initNonuniformCatmullRom(p.x,x.x,S.x,y.x,I,L,B),UV.initNonuniformCatmullRom(p.y,x.y,S.y,y.y,I,L,B),zV.initNonuniformCatmullRom(p.z,x.z,S.z,y.z,I,L,B)}else this.curveType==="catmullrom"&&(BV.initCatmullRom(p.x,x.x,S.x,y.x,this.tension),UV.initCatmullRom(p.y,x.y,S.y,y.y,this.tension),zV.initCatmullRom(p.z,x.z,S.z,y.z,this.tension));return n.set(BV.calc(u),UV.calc(u),zV.calc(u)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Ae().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function PIe(s,e,t=2){const n=e&&e.length,r=n?e[0]*t:s.length;let i=yve(s,0,r,t,!0);const a=[];if(!i||i.next===i.prev)return a;let c,u,p;if(n&&(i=DIe(s,e,i,t)),s.length>80*t){c=1/0,u=1/0;let y=-1/0,x=-1/0;for(let S=t;S<r;S+=t){const M=s[S],I=s[S+1];M<c&&(c=M),I<u&&(u=I),M>y&&(y=M),I>x&&(x=I)}p=Math.max(y-c,x-u),p=p!==0?32767/p:0}return bE(i,a,t,c,u,p,0),a}function yve(s,e,t,n,r){let i;if(r===WIe(s,e,t,n)>0)for(let a=e;a<t;a+=n)i=J9e(a/n|0,s[a],s[a+1],i);else for(let a=t-n;a>=e;a-=n)i=J9e(a/n|0,s[a],s[a+1],i);return i&&Bx(i,i.next)&&(wE(i),i=i.next),i}function wv(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(Bx(t,t.next)||wo(t.prev,t,t.next)===0)){if(wE(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function bE(s,e,t,n,r,i,a){if(!s)return;!a&&i&&UIe(s,n,r,i);let c=s;for(;s.prev!==s.next;){const u=s.prev,p=s.next;if(i?IIe(s,n,r,i):RIe(s)){e.push(u.i,s.i,p.i),wE(s),s=p.next,c=p.next;continue}if(s=p,s===c){a?a===1?(s=kIe(wv(s),e),bE(s,e,t,n,r,i,2)):a===2&&NIe(s,e,t,n,r,i):bE(wv(s),e,t,n,r,i,1);break}}}function RIe(s){const e=s.prev,t=s,n=s.next;if(wo(e,t,n)>=0)return!1;const r=e.x,i=t.x,a=n.x,c=e.y,u=t.y,p=n.y,y=Math.min(r,i,a),x=Math.min(c,u,p),S=Math.max(r,i,a),M=Math.max(c,u,p);let I=n.next;for(;I!==e;){if(I.x>=y&&I.x<=S&&I.y>=x&&I.y<=M&&$w(r,c,i,u,a,p,I.x,I.y)&&wo(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function IIe(s,e,t,n){const r=s.prev,i=s,a=s.next;if(wo(r,i,a)>=0)return!1;const c=r.x,u=i.x,p=a.x,y=r.y,x=i.y,S=a.y,M=Math.min(c,u,p),I=Math.min(y,x,S),L=Math.max(c,u,p),B=Math.max(y,x,S),A=SH(M,I,e,t,n),V=SH(L,B,e,t,n);let X=s.prevZ,P=s.nextZ;for(;X&&X.z>=A&&P&&P.z<=V;){if(X.x>=M&&X.x<=L&&X.y>=I&&X.y<=B&&X!==r&&X!==a&&$w(c,y,u,x,p,S,X.x,X.y)&&wo(X.prev,X,X.next)>=0||(X=X.prevZ,P.x>=M&&P.x<=L&&P.y>=I&&P.y<=B&&P!==r&&P!==a&&$w(c,y,u,x,p,S,P.x,P.y)&&wo(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;X&&X.z>=A;){if(X.x>=M&&X.x<=L&&X.y>=I&&X.y<=B&&X!==r&&X!==a&&$w(c,y,u,x,p,S,X.x,X.y)&&wo(X.prev,X,X.next)>=0)return!1;X=X.prevZ}for(;P&&P.z<=V;){if(P.x>=M&&P.x<=L&&P.y>=I&&P.y<=B&&P!==r&&P!==a&&$w(c,y,u,x,p,S,P.x,P.y)&&wo(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function kIe(s,e){let t=s;do{const n=t.prev,r=t.next.next;!Bx(n,r)&&_ve(n,t,t.next,r)&&SE(n,r)&&SE(r,n)&&(e.push(n.i,t.i,r.i),wE(t),wE(t.next),t=s=r),t=t.next}while(t!==s);return wv(t)}function NIe(s,e,t,n,r,i){let a=s;do{let c=a.next.next;for(;c!==a.prev;){if(a.i!==c.i&&GIe(a,c)){let u=bve(a,c);a=wv(a,a.next),u=wv(u,u.next),bE(a,e,t,n,r,i,0),bE(u,e,t,n,r,i,0);return}c=c.next}a=a.next}while(a!==s)}function DIe(s,e,t,n){const r=[];for(let i=0,a=e.length;i<a;i++){const c=e[i]*n,u=i<a-1?e[i+1]*n:s.length,p=yve(s,c,u,n,!1);p===p.next&&(p.steiner=!0),r.push(VIe(p))}r.sort(OIe);for(let i=0;i<r.length;i++)t=LIe(r[i],t);return t}function OIe(s,e){let t=s.x-e.x;if(t===0&&(t=s.y-e.y,t===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function LIe(s,e){const t=FIe(s,e);if(!t)return e;const n=bve(t,s);return wv(n,n.next),wv(t,t.next)}function FIe(s,e){let t=e;const n=s.x,r=s.y;let i=-1/0,a;if(Bx(s,t))return t;do{if(Bx(s,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const x=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>i&&(i=x,a=t.x<t.next.x?t:t.next,x===n))return a}t=t.next}while(t!==e);if(!a)return null;const c=a,u=a.x,p=a.y;let y=1/0;t=a;do{if(n>=t.x&&t.x>=u&&n!==t.x&&xve(r<p?n:i,r,u,p,r<p?i:n,r,t.x,t.y)){const x=Math.abs(r-t.y)/(n-t.x);SE(t,s)&&(x<y||x===y&&(t.x>a.x||t.x===a.x&&BIe(a,t)))&&(a=t,y=x)}t=t.next}while(t!==c);return a}function BIe(s,e){return wo(s.prev,s,e.prev)<0&&wo(e.next,s,s.next)<0}function UIe(s,e,t,n){let r=s;do r.z===0&&(r.z=SH(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,zIe(r)}function zIe(s){let e,t=1;do{let n=s,r;s=null;let i=null;for(e=0;n;){e++;let a=n,c=0;for(let p=0;p<t&&(c++,a=a.nextZ,!!a);p++);let u=t;for(;c>0||u>0&&a;)c!==0&&(u===0||!a||n.z<=a.z)?(r=n,n=n.nextZ,c--):(r=a,a=a.nextZ,u--),i?i.nextZ=r:s=r,r.prevZ=i,i=r;n=a}i.nextZ=null,t*=2}while(e>1);return s}function SH(s,e,t,n,r){return s=(s-t)*r|0,e=(e-n)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function VIe(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function xve(s,e,t,n,r,i,a,c){return(r-a)*(e-c)>=(s-a)*(i-c)&&(s-a)*(n-c)>=(t-a)*(e-c)&&(t-a)*(i-c)>=(r-a)*(n-c)}function $w(s,e,t,n,r,i,a,c){return!(s===a&&e===c)&&xve(s,e,t,n,r,i,a,c)}function GIe(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!jIe(s,e)&&(SE(s,e)&&SE(e,s)&&HIe(s,e)&&(wo(s.prev,s,e.prev)||wo(s,e.prev,e))||Bx(s,e)&&wo(s.prev,s,s.next)>0&&wo(e.prev,e,e.next)>0)}function wo(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function Bx(s,e){return s.x===e.x&&s.y===e.y}function _ve(s,e,t,n){const r=VR(wo(s,e,t)),i=VR(wo(s,e,n)),a=VR(wo(t,n,s)),c=VR(wo(t,n,e));return!!(r!==i&&a!==c||r===0&&zR(s,t,e)||i===0&&zR(s,n,e)||a===0&&zR(t,s,n)||c===0&&zR(t,e,n))}function zR(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function VR(s){return s>0?1:s<0?-1:0}function jIe(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&_ve(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function SE(s,e){return wo(s.prev,s,s.next)<0?wo(s,e,s.next)>=0&&wo(s,s.prev,e)>=0:wo(s,e,s.prev)<0||wo(s,s.next,e)<0}function HIe(s,e){let t=s,n=!1;const r=(s.x+e.x)/2,i=(s.y+e.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&r<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function bve(s,e){const t=wH(s.i,s.x,s.y),n=wH(e.i,e.x,e.y),r=s.next,i=e.prev;return s.next=e,e.prev=s,t.next=r,r.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function J9e(s,e,t,n){const r=wH(s,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function wE(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function wH(s,e,t){return{i:s,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function WIe(s,e,t,n){let r=0;for(let i=e,a=t-n;i<t;i+=n)r+=(s[a]-s[i])*(s[i+1]+s[a+1]),a=i;return r}class $Ie{static triangulate(e,t,n=2){return PIe(e,t,n)}}class WW{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return n*.5}static isClockWise(e){return WW.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];e3e(e),t3e(n,e);let a=e.length;t.forEach(e3e);for(let u=0;u<t.length;u++)r.push(a),a+=t[u].length,t3e(n,t[u]);const c=$Ie.triangulate(n,r);for(let u=0;u<c.length;u+=3)i.push(c.slice(u,u+3));return i}}function e3e(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function t3e(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class vv extends jW{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vv(e.radius,e.detail)}}let Ev=class Sve extends rs{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,c=Math.floor(n),u=Math.floor(r),p=c+1,y=u+1,x=e/c,S=t/u,M=[],I=[],L=[],B=[];for(let A=0;A<y;A++){const V=A*S-a;for(let X=0;X<p;X++){const P=X*x-i;I.push(P,-V,0),L.push(0,0,1),B.push(X/c),B.push(1-A/u)}}for(let A=0;A<u;A++)for(let V=0;V<c;V++){const X=V+p*A,P=V+p*(A+1),te=V+1+p*(A+1),oe=V+1+p*A;M.push(X,P,oe),M.push(P,te,oe)}this.setIndex(M),this.setAttribute("position",new Er(I,3)),this.setAttribute("normal",new Er(L,3)),this.setAttribute("uv",new Er(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sve(e.width,e.height,e.widthSegments,e.heightSegments)}},Tv=class wve extends rs{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(a+c,Math.PI);let p=0;const y=[],x=new Ae,S=new Ae,M=[],I=[],L=[],B=[];for(let A=0;A<=n;A++){const V=[],X=A/n;let P=0;A===0&&a===0?P=.5/t:A===n&&u===Math.PI&&(P=-.5/t);for(let te=0;te<=t;te++){const oe=te/t;x.x=-e*Math.cos(r+oe*i)*Math.sin(a+X*c),x.y=e*Math.cos(a+X*c),x.z=e*Math.sin(r+oe*i)*Math.sin(a+X*c),I.push(x.x,x.y,x.z),S.copy(x).normalize(),L.push(S.x,S.y,S.z),B.push(oe+P,1-X),V.push(p++)}y.push(V)}for(let A=0;A<n;A++)for(let V=0;V<t;V++){const X=y[A][V+1],P=y[A][V],te=y[A+1][V],oe=y[A+1][V+1];(A!==0||a>0)&&M.push(X,P,oe),(A!==n-1||u<Math.PI)&&M.push(P,te,oe)}this.setIndex(M),this.setAttribute("position",new Er(I,3)),this.setAttribute("normal",new Er(L,3)),this.setAttribute("uv",new Er(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wve(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};class cv extends rs{constructor(e=1,t=.4,n=12,r=48,i=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const a=[],c=[],u=[],p=[],y=new Ae,x=new Ae,S=new Ae;for(let M=0;M<=n;M++)for(let I=0;I<=r;I++){const L=I/r*i,B=M/n*Math.PI*2;x.x=(e+t*Math.cos(B))*Math.cos(L),x.y=(e+t*Math.cos(B))*Math.sin(L),x.z=t*Math.sin(B),c.push(x.x,x.y,x.z),y.x=e*Math.cos(L),y.y=e*Math.sin(L),S.subVectors(x,y).normalize(),u.push(S.x,S.y,S.z),p.push(I/r),p.push(M/n)}for(let M=1;M<=n;M++)for(let I=1;I<=r;I++){const L=(r+1)*M+I-1,B=(r+1)*(M-1)+I-1,A=(r+1)*(M-1)+I,V=(r+1)*M+I;a.push(L,B,V),a.push(B,A,V)}this.setIndex(a),this.setAttribute("position",new Er(c,3)),this.setAttribute("normal",new Er(u,3)),this.setAttribute("uv",new Er(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cv(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class $W extends rs{constructor(e=1,t=.4,n=64,r=8,i=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},n=Math.floor(n),r=Math.floor(r);const c=[],u=[],p=[],y=[],x=new Ae,S=new Ae,M=new Ae,I=new Ae,L=new Ae,B=new Ae,A=new Ae;for(let X=0;X<=n;++X){const P=X/n*i*Math.PI*2;V(P,i,a,e,M),V(P+.01,i,a,e,I),B.subVectors(I,M),A.addVectors(I,M),L.crossVectors(B,A),A.crossVectors(L,B),L.normalize(),A.normalize();for(let te=0;te<=r;++te){const oe=te/r*Math.PI*2,ie=-t*Math.cos(oe),K=t*Math.sin(oe);x.x=M.x+(ie*A.x+K*L.x),x.y=M.y+(ie*A.y+K*L.y),x.z=M.z+(ie*A.z+K*L.z),u.push(x.x,x.y,x.z),S.subVectors(x,M).normalize(),p.push(S.x,S.y,S.z),y.push(X/n),y.push(te/r)}}for(let X=1;X<=n;X++)for(let P=1;P<=r;P++){const te=(r+1)*(X-1)+(P-1),oe=(r+1)*X+(P-1),ie=(r+1)*X+P,K=(r+1)*(X-1)+P;c.push(te,oe,K),c.push(oe,ie,K)}this.setIndex(c),this.setAttribute("position",new Er(u,3)),this.setAttribute("normal",new Er(p,3)),this.setAttribute("uv",new Er(y,2));function V(X,P,te,oe,ie){const K=Math.cos(X),re=Math.sin(X),se=te/P*X,q=Math.cos(se);ie.x=oe*(2+q)*.5*K,ie.y=oe*(2+q)*re*.5,ie.z=oe*Math.sin(se)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $W(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}let qIe=class extends rh{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Pn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qx,this.normalScale=new An(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},pk=class extends qIe{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new An(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Jr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Pn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Pn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Pn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},cx=class extends rh{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Pn(16777215),this.specular=new Pn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qx,this.normalScale=new An(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.combine=Gk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Eve=class extends rh{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qx,this.normalScale=new An(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},XIe=class extends rh{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qx,this.normalScale=new An(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ua,this.combine=Gk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};class Tve extends rh{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=FE,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class YIe extends rh{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}let Mve=class extends rh{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qx,this.normalScale=new An(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}};function GR(s,e){return!s||s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function KIe(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function ZIe(s){function e(r,i){return s[r]-s[i]}const t=s.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function n3e(s,e,t){const n=s.length,r=new s.constructor(n);for(let i=0,a=0;a!==n;++i){const c=t[i]*e;for(let u=0;u!==e;++u)r[a++]=s[c+u]}return r}function Cve(s,e,t,n){let r=1,i=s[0];for(;i!==void 0&&i[n]===void 0;)i=s[r++];if(i===void 0)return;let a=i[n];if(a!==void 0)if(Array.isArray(a))do a=i[n],a!==void 0&&(e.push(i.time),t.push(...a)),i=s[r++];while(i!==void 0);else if(a.toArray!==void 0)do a=i[n],a!==void 0&&(e.push(i.time),a.toArray(t,t.length)),i=s[r++];while(i!==void 0);else do a=i[n],a!==void 0&&(e.push(i.time),t.push(a)),i=s[r++];while(i!==void 0)}class $k{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let c=n+2;;){if(r===void 0){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(!(e>=i)){const c=t[1];e<c&&(n=2,i=c);for(let u=n-2;;){if(i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0;break n}break e}for(;n<a;){const c=n+a>>>1;e<t[c]?a=c:n=c+1}if(r=t[n],i=t[n-1],i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class QIe extends $k{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ax,endingEnd:ax}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,c=r[i],u=r[a];if(c===void 0)switch(this.getSettings_().endingStart){case lx:i=e,c=2*t-n;break;case ck:i=r.length-2,c=t+r[i]-r[i+1];break;default:i=e,c=n}if(u===void 0)switch(this.getSettings_().endingEnd){case lx:a=e,u=2*n-t;break;case ck:a=1,u=n+r[1]-r[0];break;default:a=e-1,u=t}const p=(n-t)*.5,y=this.valueSize;this._weightPrev=p/(t-c),this._weightNext=p/(u-n),this._offsetPrev=i*y,this._offsetNext=a*y}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,c=this.valueSize,u=e*c,p=u-c,y=this._offsetPrev,x=this._offsetNext,S=this._weightPrev,M=this._weightNext,I=(n-t)/(r-t),L=I*I,B=L*I,A=-S*B+2*S*L-S*I,V=(1+S)*B+(-1.5-2*S)*L+(-.5+S)*I+1,X=(-1-M)*B+(1.5+M)*L+.5*I,P=M*B-M*L;for(let te=0;te!==c;++te)i[te]=A*a[y+te]+V*a[p+te]+X*a[u+te]+P*a[x+te];return i}}class Ave extends $k{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,c=this.valueSize,u=e*c,p=u-c,y=(n-t)/(r-t),x=1-y;for(let S=0;S!==c;++S)i[S]=a[p+S]*x+a[u+S]*y;return i}}class JIe extends $k{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Bf{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=GR(t,this.TimeBufferType),this.values=GR(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:GR(e.times,Array),values:GR(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new JIe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ave(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new QIe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case lk:t=this.InterpolantFactoryMethodDiscrete;break;case vH:t=this.InterpolantFactoryMethodLinear;break;case dV:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return lk;case this.InterpolantFactoryMethodLinear:return vH;case this.InterpolantFactoryMethodSmooth:return dV}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;a!==-1&&n[a]>t;)--a;if(++a,i!==0||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const c=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*c,a*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let c=0;c!==i;c++){const u=n[c];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,u),e=!1;break}if(a!==null&&a>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,u,a),e=!1;break}a=u}if(r!==void 0&&KIe(r))for(let c=0,u=r.length;c!==u;++c){const p=r[c];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===dV,i=e.length-1;let a=1;for(let c=1;c<i;++c){let u=!1;const p=e[c],y=e[c+1];if(p!==y&&(c!==1||p!==e[0]))if(r)u=!0;else{const x=c*n,S=x-n,M=x+n;for(let I=0;I!==n;++I){const L=t[x+I];if(L!==t[S+I]||L!==t[M+I]){u=!0;break}}}if(u){if(c!==a){e[a]=e[c];const x=c*n,S=a*n;for(let M=0;M!==n;++M)t[S+M]=t[x+M]}++a}}if(i>0){e[a]=e[i];for(let c=i*n,u=a*n,p=0;p!==n;++p)t[u+p]=t[c+p];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Bf.prototype.ValueTypeName="";Bf.prototype.TimeBufferType=Float32Array;Bf.prototype.ValueBufferType=Float32Array;Bf.prototype.DefaultInterpolation=vH;class e_ extends Bf{constructor(e,t,n){super(e,t,n)}}e_.prototype.ValueTypeName="bool";e_.prototype.ValueBufferType=Array;e_.prototype.DefaultInterpolation=lk;e_.prototype.InterpolantFactoryMethodLinear=void 0;e_.prototype.InterpolantFactoryMethodSmooth=void 0;class Pve extends Bf{constructor(e,t,n,r){super(e,t,n,r)}}Pve.prototype.ValueTypeName="color";class EE extends Bf{constructor(e,t,n,r){super(e,t,n,r)}}EE.prototype.ValueTypeName="number";class eke extends $k{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,c=this.valueSize,u=(n-t)/(r-t);let p=e*c;for(let y=p+c;p!==y;p+=4)ls.slerpFlat(i,0,a,p-c,a,p,u);return i}}class Ux extends Bf{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new eke(this.times,this.values,this.getValueSize(),e)}}Ux.prototype.ValueTypeName="quaternion";Ux.prototype.InterpolantFactoryMethodSmooth=void 0;class t_ extends Bf{constructor(e,t,n){super(e,t,n)}}t_.prototype.ValueTypeName="string";t_.prototype.ValueBufferType=Array;t_.prototype.DefaultInterpolation=lk;t_.prototype.InterpolantFactoryMethodLinear=void 0;t_.prototype.InterpolantFactoryMethodSmooth=void 0;class TE extends Bf{constructor(e,t,n,r){super(e,t,n,r)}}TE.prototype.ValueTypeName="vector";class EH{constructor(e="",t=-1,n=[],r=NW){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Z3(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,c=n.length;a!==c;++a)t.push(nke(n[a]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,a=n.length;i!==a;++i)t.push(Bf.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let c=0;c<i;c++){let u=[],p=[];u.push((c+i-1)%i,c,(c+1)%i),p.push(0,1,0);const y=ZIe(u);u=n3e(u,1,y),p=n3e(p,1,y),!r&&u[0]===0&&(u.push(i),p.push(p[0])),a.push(new EE(".morphTargetInfluences["+t[c].name+"]",u,p).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let c=0,u=e.length;c<u;c++){const p=e[c],y=p.name.match(i);if(y&&y.length>1){const x=y[1];let S=r[x];S||(r[x]=S=[]),S.push(p)}}const a=[];for(const c in r)a.push(this.CreateFromMorphTargetSequence(c,r[c],t,n));return a}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(x,S,M,I,L){if(M.length!==0){const B=[],A=[];Cve(M,B,A,I),B.length!==0&&L.push(new x(S,B,A))}},r=[],i=e.name||"default",a=e.fps||30,c=e.blendMode;let u=e.length||-1;const p=e.hierarchy||[];for(let x=0;x<p.length;x++){const S=p[x].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const M={};let I;for(I=0;I<S.length;I++)if(S[I].morphTargets)for(let L=0;L<S[I].morphTargets.length;L++)M[S[I].morphTargets[L]]=-1;for(const L in M){const B=[],A=[];for(let V=0;V!==S[I].morphTargets.length;++V){const X=S[I];B.push(X.time),A.push(X.morphTarget===L?1:0)}r.push(new EE(".morphTargetInfluence["+L+"]",B,A))}u=M.length*a}else{const M=".bones["+t[x].name+"]";n(TE,M+".position",S,"pos",r),n(Ux,M+".quaternion",S,"rot",r),n(TE,M+".scale",S,"scl",r)}}return r.length===0?null:new this(i,u,r,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const i=this.tracks[n];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function tke(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return EE;case"vector":case"vector2":case"vector3":case"vector4":return TE;case"color":return Pve;case"quaternion":return Ux;case"bool":case"boolean":return e_;case"string":return t_}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function nke(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=tke(s.type);if(s.times===void 0){const t=[],n=[];Cve(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const mk={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class rke{constructor(e,t,n){const r=this;let i=!1,a=0,c=0,u;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(y){c++,i===!1&&r.onStart!==void 0&&r.onStart(y,a,c),i=!0},this.itemEnd=function(y){a++,r.onProgress!==void 0&&r.onProgress(y,a,c),a===c&&(i=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(y){r.onError!==void 0&&r.onError(y)},this.resolveURL=function(y){return u?u(y):y},this.setURLModifier=function(y){return u=y,this},this.addHandler=function(y,x){return p.push(y,x),this},this.removeHandler=function(y){const x=p.indexOf(y);return x!==-1&&p.splice(x,2),this},this.getHandler=function(y){for(let x=0,S=p.length;x<S;x+=2){const M=p[x],I=p[x+1];if(M.global&&(M.lastIndex=0),M.test(y))return I}return null}}}const ike=new rke;class $3{constructor(e){this.manager=e!==void 0?e:ike,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}$3.DEFAULT_MATERIAL_NAME="__DEFAULT";const wg={};class ske extends Error{constructor(e,t){super(e),this.response=t}}class oke extends $3{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=mk.get(e);if(i!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(wg[e]!==void 0){wg[e].push({onLoad:t,onProgress:n,onError:r});return}wg[e]=[],wg[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,u=this.responseType;fetch(a).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const y=wg[e],x=p.body.getReader(),S=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),M=S?parseInt(S):0,I=M!==0;let L=0;const B=new ReadableStream({start(A){V();function V(){x.read().then(({done:X,value:P})=>{if(X)A.close();else{L+=P.byteLength;const te=new ProgressEvent("progress",{lengthComputable:I,loaded:L,total:M});for(let oe=0,ie=y.length;oe<ie;oe++){const K=y[oe];K.onProgress&&K.onProgress(te)}A.enqueue(P),V()}},X=>{A.error(X)})}}});return new Response(B)}else throw new ske(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(u){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(y=>new DOMParser().parseFromString(y,c));case"json":return p.json();default:if(c==="")return p.text();{const x=/charset="?([^;"\s]*)"?/i.exec(c),S=x&&x[1]?x[1].toLowerCase():void 0,M=new TextDecoder(S);return p.arrayBuffer().then(I=>M.decode(I))}}}).then(p=>{mk.add(e,p);const y=wg[e];delete wg[e];for(let x=0,S=y.length;x<S;x++){const M=y[x];M.onLoad&&M.onLoad(p)}}).catch(p=>{const y=wg[e];if(y===void 0)throw this.manager.itemError(e),p;delete wg[e];for(let x=0,S=y.length;x<S;x++){const M=y[x];M.onError&&M.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Rve extends $3{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=mk.get(e);if(a!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;const c=xE("img");function u(){y(),mk.add(e,this),t&&t(this),i.manager.itemEnd(e)}function p(x){y(),r&&r(x),i.manager.itemError(e),i.manager.itemEnd(e)}function y(){c.removeEventListener("load",u,!1),c.removeEventListener("error",p,!1)}return c.addEventListener("load",u,!1),c.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),i.manager.itemStart(e),c.src=e,c}}class ake extends $3{constructor(e){super(e)}load(e,t,n,r){const i=new BW;i.colorSpace=qr;const a=new Rve(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let c=0;function u(p){a.load(e[p],function(y){i.images[p]=y,c++,c===6&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(let p=0;p<e.length;++p)u(p);return i}}class Ive extends $3{constructor(e){super(e)}load(e,t,n,r){const i=new n0,a=new Rve(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(c){i.image=c,i.needsUpdate=!0,t!==void 0&&t(i)},n,r),i}}let n_=class extends Ti{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Pn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}},lke=class extends n_{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ti.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}};const VV=new or,r3e=new Ae,i3e=new Ae;let qW=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new An(512,512),this.mapType=t0,this.map=null,this.mapPass=null,this.matrix=new or,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new VW,this._frameExtents=new An(1,1),this._viewportCount=1,this._viewports=[new xi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;r3e.setFromMatrixPosition(e.matrixWorld),t.position.copy(r3e),i3e.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(i3e),t.updateMatrixWorld(),VV.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(VV),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(VV)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},cke=class extends qW{constructor(){super(new Ja(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Lx*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},XW=class extends n_{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ti.DEFAULT_UP),this.updateMatrix(),this.target=new Ti,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new cke}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};const s3e=new or,pw=new Ae,GV=new Ae;let uke=class extends qW{constructor(){super(new Ja(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new An(4,2),this._viewportCount=6,this._viewports=[new xi(2,1,1,1),new xi(0,1,1,1),new xi(3,1,1,1),new xi(1,1,1,1),new xi(3,0,1,1),new xi(1,0,1,1)],this._cubeDirections=[new Ae(1,0,0),new Ae(-1,0,0),new Ae(0,0,1),new Ae(0,0,-1),new Ae(0,1,0),new Ae(0,-1,0)],this._cubeUps=[new Ae(0,1,0),new Ae(0,1,0),new Ae(0,1,0),new Ae(0,1,0),new Ae(0,0,1),new Ae(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),pw.setFromMatrixPosition(e.matrixWorld),n.position.copy(pw),GV.copy(n.position),GV.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(GV),n.updateMatrixWorld(),r.makeTranslation(-pw.x,-pw.y,-pw.z),s3e.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s3e)}},o3e=class extends n_{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new uke}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},zx=class extends Hk{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,c=r+t,u=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=p*this.view.offsetX,a=i+p*this.view.width,c-=y*this.view.offsetY,u=c-y*this.view.height}this.projectionMatrix.makeOrthographic(i,a,c,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},hke=class extends qW{constructor(){super(new zx(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},YW=class extends n_{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ti.DEFAULT_UP),this.updateMatrix(),this.target=new Ti,this.shadow=new hke}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},dke=class extends n_{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}},fke=class extends n_{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}};class pke{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}let mke=class extends Ja{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}};class kve{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=a3e(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=a3e();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function a3e(){return performance.now()}class gke{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,i,a;switch(t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let c=0;c!==r;++c)n[i+c]=n[c];a=t}else{a+=t;const c=t/a;this._mixBufferRegion(n,i,0,c,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const u=t*this._origIndex;this._mixBufferRegion(n,r,u,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let u=t,p=t+t;u!==p;++u)if(n[u]!==n[u+t]){c.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let a=0;a!==i;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){ls.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const a=this._workIndex*i;ls.multiplyQuaternionsFlat(e,a,e,t,e,n),ls.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){const a=1-r;for(let c=0;c!==i;++c){const u=t+c;e[u]=e[u]*a+e[n+c]*r}}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){const c=t+a;e[c]=e[c]+e[n+a]*r}}}const KW="\\[\\]\\.:\\/",vke=new RegExp("["+KW+"]","g"),ZW="[^"+KW+"]",yke="[^"+KW.replace("\\.","")+"]",xke=/((?:WC+[\/:])*)/.source.replace("WC",ZW),_ke=/(WCOD+)?/.source.replace("WCOD",yke),bke=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ZW),Ske=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ZW),wke=new RegExp("^"+xke+_ke+bke+Ske+"$"),Eke=["material","materials","bones","map"];class Tke{constructor(e,t,n){const r=n||Gi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Gi{constructor(e,t,n){this.path=t,this.parsedPath=n||Gi.parseTrackName(t),this.node=Gi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Gi.Composite(e,t,n):new Gi(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(vke,"")}static parseTrackName(e){const t=wke.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const i=n.nodeName.substring(r+1);Eke.indexOf(i)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(i){for(let a=0;a<i.length;a++){const c=i[a];if(c.name===t||c.uuid===t)return c;const u=n(c.children);if(u)return u}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=Gi.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let y=0;y<e.length;y++)if(e[y].name===p){p=y;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const a=e[r];if(a===void 0){const p=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(i!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[i]!==void 0&&(i=e.morphTargetDictionary[i])}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else a.fromArray!==void 0&&a.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Gi.Composite=Tke;Gi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Gi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Gi.prototype.GetterByBindingType=[Gi.prototype._getValue_direct,Gi.prototype._getValue_array,Gi.prototype._getValue_arrayElement,Gi.prototype._getValue_toArray];Gi.prototype.SetterByBindingTypeAndVersioning=[[Gi.prototype._setValue_direct,Gi.prototype._setValue_direct_setNeedsUpdate,Gi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Gi.prototype._setValue_array,Gi.prototype._setValue_array_setNeedsUpdate,Gi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Gi.prototype._setValue_arrayElement,Gi.prototype._setValue_arrayElement_setNeedsUpdate,Gi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Gi.prototype._setValue_fromArray,Gi.prototype._setValue_fromArray_setNeedsUpdate,Gi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Mke{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,a=i.length,c=new Array(a),u={endingStart:ax,endingEnd:ax};for(let p=0;p!==a;++p){const y=i[p].createInterpolant(null);c[p]=y,y.settings=u}this._interpolantSettings=u,this._interpolants=c,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=_Re,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,i=e._clip.duration,a=i/r,c=r/i;e.warp(1,a,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);const u=c.parameterPositions,p=c.sampleValues;return u[0]=i,u[1]=i+n,p[0]=e/a,p[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const i=this._startTime;if(i!==null){const u=(e-i)*n;u<0||n===0?t=0:(this._startTime=null,t=n*u)}t*=this._updateTimeScale(e);const a=this._updateTime(t),c=this._updateWeight(e);if(c>0){const u=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case SRe:for(let y=0,x=u.length;y!==x;++y)u[y].evaluate(a),p[y].accumulateAdditive(c);break;case NW:default:for(let y=0,x=u.length;y!==x;++y)u[y].evaluate(a),p[y].accumulate(r,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=n===bRe;if(e===0)return i===-1?r:a&&(i&1)===1?t-r:r;if(n===xRe){i===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(i===-1&&(e>=0?(i=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){const c=Math.floor(r/t);r-=t*c,i+=Math.abs(c);const u=this.repetitions-i;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const p=e<0;this._setEndings(p,!p,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=r;if(a&&(i&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=lx,r.endingEnd=lx):(e?r.endingStart=this.zeroSlopeAtStart?lx:ax:r.endingStart=ck,t?r.endingEnd=this.zeroSlopeAtEnd?lx:ax:r.endingEnd=ck)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const c=a.parameterPositions,u=a.sampleValues;return c[0]=i,u[0]=t,c[1]=i+e,u[1]=n,this}}const Cke=new Float32Array(1);class Ake extends nh{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,c=e._interpolants,u=n.uuid,p=this._bindingsByRootAndName;let y=p[u];y===void 0&&(y={},p[u]=y);for(let x=0;x!==i;++x){const S=r[x],M=S.name;let I=y[M];if(I!==void 0)++I.referenceCount,a[x]=I;else{if(I=a[x],I!==void 0){I._cacheIndex===null&&(++I.referenceCount,this._addInactiveBinding(I,u,M));continue}const L=t&&t._propertyBindings[x].binding.parsedPath;I=new gke(Gi.create(n,M,L),S.ValueTypeName,S.getValueSize()),++I.referenceCount,this._addInactiveBinding(I,u,M),a[x]=I}c[x].resultBuffer=I.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,i=this._actionsByClip[r];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];i.useCount++===0&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.useCount===0&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const c=a.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,c=a[i],u=c.knownActions,p=u[u.length-1],y=e._byClipCacheIndex;p._byClipCacheIndex=y,u[y]=p,u.pop(),e._byClipCacheIndex=null;const x=c.actionByRoot,S=(e._localRoot||this._root).uuid;delete x[S],u.length===0&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.referenceCount===0&&this._removeInactiveBinding(i)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];a===void 0&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,c=a[r],u=t[t.length-1],p=e._cacheIndex;u._cacheIndex=p,t[p]=u,t.pop(),delete c[i],Object.keys(c).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new Ave(new Float32Array(2),new Float32Array(2),1,Cke),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let a=typeof e=="string"?EH.findByName(r,e):e;const c=a!==null?a.uuid:e,u=this._actionsByClip[c];let p=null;if(n===void 0&&(a!==null?n=a.blendMode:n=NW),u!==void 0){const x=u.actionByRoot[i];if(x!==void 0&&x.blendMode===n)return x;p=u.knownActions[0],a===null&&(a=p._clip)}if(a===null)return null;const y=new Mke(this,a,t,n);return this._bindAction(y,p),this._addInactiveAction(y,c,i),y}existingAction(e,t){const n=t||this._root,r=n.uuid,i=typeof e=="string"?EH.findByName(n,e):e,a=i?i.uuid:e,c=this._actionsByClip[a];return c!==void 0&&c.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(r,e,i,a);const c=this._bindings,u=this._nActiveBindings;for(let p=0;p!==u;++p)c[p].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(i!==void 0){const a=i.knownActions;for(let c=0,u=a.length;c!==u;++c){const p=a[c];this._deactivateAction(p);const y=p._cacheIndex,x=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,x._cacheIndex=y,t[y]=x,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const c=n[a].actionByRoot,u=c[t];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const r=this._bindingsByRootAndName,i=r[t];if(i!==void 0)for(const a in i){const c=i[a];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}let gs=class Nve{constructor(e){this.value=e}clone(){return new Nve(this.value.clone===void 0?this.value:this.value.clone())}};const l3e=new or;class ME{constructor(e,t,n=0,r=1/0){this.ray=new Jx(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new LW,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return l3e.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(l3e),this}intersectObject(e,t=!0,n=[]){return TH(e,this,n,t),n.sort(c3e),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)TH(e[r],this,n,t);return n.sort(c3e),n}}function c3e(s,e){return s.distance-e.distance}function TH(s,e,t,n){let r=!0;if(s.layers.test(e.layers)&&s.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const i=s.children;for(let a=0,c=i.length;a<c;a++)TH(i[a],e,t,!0)}}class MH{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Jr(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Jr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const u3e=new Ae;class Pke extends Ti{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new rs,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,c=1,u=32;a<u;a++,c++){const p=a/u*Math.PI*2,y=c/u*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(y),Math.sin(y),1)}n.setAttribute("position",new Er(r,3));const i=new Ff({fog:!1,toneMapped:!1});this.cone=new BE(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),u3e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(u3e),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const x3=new Ae,jR=new or,jV=new or;class Rke extends BE{constructor(e){const t=Dve(e),n=new rs,r=[],i=[],a=new Pn(0,0,1),c=new Pn(0,1,0);for(let p=0;p<t.length;p++){const y=t[p];y.parent&&y.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(c.r,c.g,c.b))}n.setAttribute("position",new Er(r,3)),n.setAttribute("color",new Er(i,3));const u=new Ff({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,u),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");jV.copy(this.root.matrixWorld).invert();for(let i=0,a=0;i<t.length;i++){const c=t[i];c.parent&&c.parent.isBone&&(jR.multiplyMatrices(jV,c.matrixWorld),x3.setFromMatrixPosition(jR),r.setXYZ(a,x3.x,x3.y,x3.z),jR.multiplyMatrices(jV,c.parent.matrixWorld),x3.setFromMatrixPosition(jR),r.setXYZ(a+1,x3.x,x3.y,x3.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Dve(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push(...Dve(s.children[t]));return e}class Ike extends mn{constructor(e,t,n){const r=new Tv(t,4,2),i=new eh({wireframe:!0,fog:!1,toneMapped:!1});super(r,i),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const kke=new Ae,h3e=new Pn,d3e=new Pn;class Nke extends Ti{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new vv(t);r.rotateY(Math.PI*.5),this.material=new eh({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),a=new Float32Array(i.count*3);r.setAttribute("color",new Qu(a,3)),this.add(new mn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");h3e.copy(this.light.color),d3e.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const i=n<r/2?h3e:d3e;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(kke.setFromMatrixPosition(this.light.matrixWorld).negate())}}const f3e=new Ae,HR=new Ae,p3e=new Ae;class Dke extends Ti{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new rs;r.setAttribute("position",new Er([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new Ff({fog:!1,toneMapped:!1});this.lightPlane=new Kc(r,i),this.add(this.lightPlane),r=new rs,r.setAttribute("position",new Er([0,0,0,0,0,1],3)),this.targetLine=new Kc(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),f3e.setFromMatrixPosition(this.light.matrixWorld),HR.setFromMatrixPosition(this.light.target.matrixWorld),p3e.subVectors(HR,f3e),this.lightPlane.lookAt(HR),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(HR),this.targetLine.scale.z=p3e.length()}}const WR=new Ae,Fo=new Hk;class Oke extends BE{constructor(e){const t=new rs,n=new Ff({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(I,L){u(I),u(L)}function u(I){r.push(0,0,0),i.push(0,0,0),a[I]===void 0&&(a[I]=[]),a[I].push(r.length/3-1)}t.setAttribute("position",new Er(r,3)),t.setAttribute("color",new Er(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const p=new Pn(16755200),y=new Pn(16711680),x=new Pn(43775),S=new Pn(16777215),M=new Pn(3355443);this.setColors(p,y,x,S,M)}setColors(e,t,n,r,i){const c=this.geometry.getAttribute("color");c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,r.r,r.g,r.b),c.setXYZ(39,r.r,r.g,r.b),c.setXYZ(40,i.r,i.g,i.b),c.setXYZ(41,i.r,i.g,i.b),c.setXYZ(42,i.r,i.g,i.b),c.setXYZ(43,i.r,i.g,i.b),c.setXYZ(44,i.r,i.g,i.b),c.setXYZ(45,i.r,i.g,i.b),c.setXYZ(46,i.r,i.g,i.b),c.setXYZ(47,i.r,i.g,i.b),c.setXYZ(48,i.r,i.g,i.b),c.setXYZ(49,i.r,i.g,i.b),c.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;Fo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const i=this.camera.coordinateSystem===x1?-1:0;Xo("c",t,e,Fo,0,0,i),Xo("t",t,e,Fo,0,0,1),Xo("n1",t,e,Fo,-1,-1,i),Xo("n2",t,e,Fo,n,-1,i),Xo("n3",t,e,Fo,-1,r,i),Xo("n4",t,e,Fo,n,r,i),Xo("f1",t,e,Fo,-1,-1,1),Xo("f2",t,e,Fo,n,-1,1),Xo("f3",t,e,Fo,-1,r,1),Xo("f4",t,e,Fo,n,r,1),Xo("u1",t,e,Fo,n*.7,r*1.1,i),Xo("u2",t,e,Fo,-1*.7,r*1.1,i),Xo("u3",t,e,Fo,0,r*2,i),Xo("cf1",t,e,Fo,-1,0,1),Xo("cf2",t,e,Fo,n,0,1),Xo("cf3",t,e,Fo,0,-1,1),Xo("cf4",t,e,Fo,0,r,1),Xo("cn1",t,e,Fo,-1,0,i),Xo("cn2",t,e,Fo,n,0,i),Xo("cn3",t,e,Fo,0,-1,i),Xo("cn4",t,e,Fo,0,r,i),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Xo(s,e,t,n,r,i,a){WR.set(r,i,a).unproject(n);const c=e[s];if(c!==void 0){const u=t.getAttribute("position");for(let p=0,y=c.length;p<y;p++)u.setXYZ(c[p],WR.x,WR.y,WR.z)}}class Lke extends BE{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new rs;r.setAttribute("position",new Er(t,3)),r.setAttribute("color",new Er(n,3));const i=new Ff({vertexColors:!0,toneMapped:!1});super(r,i),this.type="AxesHelper"}setColors(e,t,n){const r=new Pn,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Ove extends nh{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function m3e(s,e,t,n){const r=Fke(n);switch(t){case K8e:return s*e;case Q8e:return s*e/r.components*r.byteLength;case RW:return s*e/r.components*r.byteLength;case J8e:return s*e*2/r.components*r.byteLength;case IW:return s*e*2/r.components*r.byteLength;case Z8e:return s*e*3/r.components*r.byteLength;case yl:return s*e*4/r.components*r.byteLength;case kW:return s*e*4/r.components*r.byteLength;case VI:case GI:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case jI:case HI:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case $j:case Xj:return Math.max(s,16)*Math.max(e,8)/4;case Wj:case qj:return Math.max(s,8)*Math.max(e,8)/2;case Yj:case Kj:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case Zj:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case Qj:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case Jj:return Math.floor((s+4)/5)*Math.floor((e+3)/4)*16;case eH:return Math.floor((s+4)/5)*Math.floor((e+4)/5)*16;case tH:return Math.floor((s+5)/6)*Math.floor((e+4)/5)*16;case nH:return Math.floor((s+5)/6)*Math.floor((e+5)/6)*16;case rH:return Math.floor((s+7)/8)*Math.floor((e+4)/5)*16;case iH:return Math.floor((s+7)/8)*Math.floor((e+5)/6)*16;case sH:return Math.floor((s+7)/8)*Math.floor((e+7)/8)*16;case oH:return Math.floor((s+9)/10)*Math.floor((e+4)/5)*16;case aH:return Math.floor((s+9)/10)*Math.floor((e+5)/6)*16;case lH:return Math.floor((s+9)/10)*Math.floor((e+7)/8)*16;case cH:return Math.floor((s+9)/10)*Math.floor((e+9)/10)*16;case uH:return Math.floor((s+11)/12)*Math.floor((e+9)/10)*16;case hH:return Math.floor((s+11)/12)*Math.floor((e+11)/12)*16;case WI:case dH:case fH:return Math.ceil(s/4)*Math.ceil(e/4)*16;case eve:case pH:return Math.ceil(s/4)*Math.ceil(e/4)*8;case mH:case gH:return Math.ceil(s/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Fke(s){switch(s){case t0:case q8e:return{byteLength:1,components:1};case vE:case X8e:case W3:return{byteLength:2,components:1};case AW:case PW:return{byteLength:2,components:4};case H3:case CW:case ed:return{byteLength:4,components:1};case Y8e:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${s}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:LE}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=LE);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function Lve(){let s=null,e=!1,t=null,n=null;function r(i,a){t(i,a),n=s.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(r),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(i){t=i},setContext:function(i){s=i}}}function Bke(s){const e=new WeakMap;function t(c,u){const p=c.array,y=c.usage,x=p.byteLength,S=s.createBuffer();s.bindBuffer(u,S),s.bufferData(u,p,y),c.onUploadCallback();let M;if(p instanceof Float32Array)M=s.FLOAT;else if(p instanceof Uint16Array)c.isFloat16BufferAttribute?M=s.HALF_FLOAT:M=s.UNSIGNED_SHORT;else if(p instanceof Int16Array)M=s.SHORT;else if(p instanceof Uint32Array)M=s.UNSIGNED_INT;else if(p instanceof Int32Array)M=s.INT;else if(p instanceof Int8Array)M=s.BYTE;else if(p instanceof Uint8Array)M=s.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)M=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:S,type:M,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version,size:x}}function n(c,u,p){const y=u.array,x=u.updateRanges;if(s.bindBuffer(p,c),x.length===0)s.bufferSubData(p,0,y);else{x.sort((M,I)=>M.start-I.start);let S=0;for(let M=1;M<x.length;M++){const I=x[S],L=x[M];L.start<=I.start+I.count+1?I.count=Math.max(I.count,L.start+L.count-I.start):(++S,x[S]=L)}x.length=S+1;for(let M=0,I=x.length;M<I;M++){const L=x[M];s.bufferSubData(p,L.start*y.BYTES_PER_ELEMENT,y,L.start,L.count)}u.clearUpdateRanges()}u.onUploadCallback()}function r(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function i(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=e.get(c);u&&(s.deleteBuffer(u.buffer),e.delete(c))}function a(c,u){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const y=e.get(c);(!y||y.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const p=e.get(c);if(p===void 0)e.set(c,t(c,u));else if(p.version<c.version){if(p.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,c,u),p.version=c.version}}return{get:r,remove:i,update:a}}var Uke=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,zke=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Vke=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Gke=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,jke=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Hke=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Wke=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,$ke=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,qke=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Xke=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Yke=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Kke=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Zke=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Qke=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Jke=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,eNe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,tNe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,nNe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,rNe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,iNe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,sNe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,oNe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,aNe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,lNe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cNe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,uNe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,hNe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,dNe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,fNe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,pNe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,mNe="gl_FragColor = linearToOutputTexel( gl_FragColor );",gNe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,vNe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,yNe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,xNe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,_Ne=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,bNe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,SNe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,wNe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ENe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,TNe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,MNe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,CNe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ANe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,PNe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,RNe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,INe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,kNe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,NNe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,DNe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ONe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,LNe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,FNe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,BNe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,UNe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,zNe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,VNe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,GNe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,jNe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,HNe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,WNe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,$Ne=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,qNe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,XNe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,YNe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,KNe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ZNe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,QNe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,JNe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,eDe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,tDe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,nDe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,rDe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,iDe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,sDe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,oDe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,aDe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,lDe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,cDe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,uDe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,hDe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,dDe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,fDe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,pDe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,mDe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,gDe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,vDe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,yDe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,xDe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,_De=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,bDe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,SDe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,wDe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,EDe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,TDe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,MDe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,CDe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,ADe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,PDe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,RDe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,IDe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,kDe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,NDe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,DDe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,ODe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,LDe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,FDe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const BDe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,UDe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zDe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,VDe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,GDe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,jDe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,HDe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,WDe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,$De=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,qDe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,XDe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,YDe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,KDe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ZDe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,QDe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,JDe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eOe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,tOe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nOe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,rOe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iOe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,sOe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,oOe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,aOe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lOe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,cOe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uOe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hOe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dOe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fOe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,pOe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mOe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,gOe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,vOe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ai={alphahash_fragment:Uke,alphahash_pars_fragment:zke,alphamap_fragment:Vke,alphamap_pars_fragment:Gke,alphatest_fragment:jke,alphatest_pars_fragment:Hke,aomap_fragment:Wke,aomap_pars_fragment:$ke,batching_pars_vertex:qke,batching_vertex:Xke,begin_vertex:Yke,beginnormal_vertex:Kke,bsdfs:Zke,iridescence_fragment:Qke,bumpmap_pars_fragment:Jke,clipping_planes_fragment:eNe,clipping_planes_pars_fragment:tNe,clipping_planes_pars_vertex:nNe,clipping_planes_vertex:rNe,color_fragment:iNe,color_pars_fragment:sNe,color_pars_vertex:oNe,color_vertex:aNe,common:lNe,cube_uv_reflection_fragment:cNe,defaultnormal_vertex:uNe,displacementmap_pars_vertex:hNe,displacementmap_vertex:dNe,emissivemap_fragment:fNe,emissivemap_pars_fragment:pNe,colorspace_fragment:mNe,colorspace_pars_fragment:gNe,envmap_fragment:vNe,envmap_common_pars_fragment:yNe,envmap_pars_fragment:xNe,envmap_pars_vertex:_Ne,envmap_physical_pars_fragment:INe,envmap_vertex:bNe,fog_vertex:SNe,fog_pars_vertex:wNe,fog_fragment:ENe,fog_pars_fragment:TNe,gradientmap_pars_fragment:MNe,lightmap_pars_fragment:CNe,lights_lambert_fragment:ANe,lights_lambert_pars_fragment:PNe,lights_pars_begin:RNe,lights_toon_fragment:kNe,lights_toon_pars_fragment:NNe,lights_phong_fragment:DNe,lights_phong_pars_fragment:ONe,lights_physical_fragment:LNe,lights_physical_pars_fragment:FNe,lights_fragment_begin:BNe,lights_fragment_maps:UNe,lights_fragment_end:zNe,logdepthbuf_fragment:VNe,logdepthbuf_pars_fragment:GNe,logdepthbuf_pars_vertex:jNe,logdepthbuf_vertex:HNe,map_fragment:WNe,map_pars_fragment:$Ne,map_particle_fragment:qNe,map_particle_pars_fragment:XNe,metalnessmap_fragment:YNe,metalnessmap_pars_fragment:KNe,morphinstance_vertex:ZNe,morphcolor_vertex:QNe,morphnormal_vertex:JNe,morphtarget_pars_vertex:eDe,morphtarget_vertex:tDe,normal_fragment_begin:nDe,normal_fragment_maps:rDe,normal_pars_fragment:iDe,normal_pars_vertex:sDe,normal_vertex:oDe,normalmap_pars_fragment:aDe,clearcoat_normal_fragment_begin:lDe,clearcoat_normal_fragment_maps:cDe,clearcoat_pars_fragment:uDe,iridescence_pars_fragment:hDe,opaque_fragment:dDe,packing:fDe,premultiplied_alpha_fragment:pDe,project_vertex:mDe,dithering_fragment:gDe,dithering_pars_fragment:vDe,roughnessmap_fragment:yDe,roughnessmap_pars_fragment:xDe,shadowmap_pars_fragment:_De,shadowmap_pars_vertex:bDe,shadowmap_vertex:SDe,shadowmask_pars_fragment:wDe,skinbase_vertex:EDe,skinning_pars_vertex:TDe,skinning_vertex:MDe,skinnormal_vertex:CDe,specularmap_fragment:ADe,specularmap_pars_fragment:PDe,tonemapping_fragment:RDe,tonemapping_pars_fragment:IDe,transmission_fragment:kDe,transmission_pars_fragment:NDe,uv_pars_fragment:DDe,uv_pars_vertex:ODe,uv_vertex:LDe,worldpos_vertex:FDe,background_vert:BDe,background_frag:UDe,backgroundCube_vert:zDe,backgroundCube_frag:VDe,cube_vert:GDe,cube_frag:jDe,depth_vert:HDe,depth_frag:WDe,distanceRGBA_vert:$De,distanceRGBA_frag:qDe,equirect_vert:XDe,equirect_frag:YDe,linedashed_vert:KDe,linedashed_frag:ZDe,meshbasic_vert:QDe,meshbasic_frag:JDe,meshlambert_vert:eOe,meshlambert_frag:tOe,meshmatcap_vert:nOe,meshmatcap_frag:rOe,meshnormal_vert:iOe,meshnormal_frag:sOe,meshphong_vert:oOe,meshphong_frag:aOe,meshphysical_vert:lOe,meshphysical_frag:cOe,meshtoon_vert:uOe,meshtoon_frag:hOe,points_vert:dOe,points_frag:fOe,shadow_vert:pOe,shadow_frag:mOe,sprite_vert:gOe,sprite_frag:vOe},Mn={common:{diffuse:{value:new Pn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new si},alphaMap:{value:null},alphaMapTransform:{value:new si},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new si}},envmap:{envMap:{value:null},envMapRotation:{value:new si},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new si}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new si}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new si},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new si},normalScale:{value:new An(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new si},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new si}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new si}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new si}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new si},alphaTest:{value:0},uvTransform:{value:new si}},sprite:{diffuse:{value:new Pn(16777215)},opacity:{value:1},center:{value:new An(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new si},alphaMap:{value:null},alphaMapTransform:{value:new si},alphaTest:{value:0}}},v1={basic:{uniforms:nc([Mn.common,Mn.specularmap,Mn.envmap,Mn.aomap,Mn.lightmap,Mn.fog]),vertexShader:ai.meshbasic_vert,fragmentShader:ai.meshbasic_frag},lambert:{uniforms:nc([Mn.common,Mn.specularmap,Mn.envmap,Mn.aomap,Mn.lightmap,Mn.emissivemap,Mn.bumpmap,Mn.normalmap,Mn.displacementmap,Mn.fog,Mn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:ai.meshlambert_vert,fragmentShader:ai.meshlambert_frag},phong:{uniforms:nc([Mn.common,Mn.specularmap,Mn.envmap,Mn.aomap,Mn.lightmap,Mn.emissivemap,Mn.bumpmap,Mn.normalmap,Mn.displacementmap,Mn.fog,Mn.lights,{emissive:{value:new Pn(0)},specular:{value:new Pn(1118481)},shininess:{value:30}}]),vertexShader:ai.meshphong_vert,fragmentShader:ai.meshphong_frag},standard:{uniforms:nc([Mn.common,Mn.envmap,Mn.aomap,Mn.lightmap,Mn.emissivemap,Mn.bumpmap,Mn.normalmap,Mn.displacementmap,Mn.roughnessmap,Mn.metalnessmap,Mn.fog,Mn.lights,{emissive:{value:new Pn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ai.meshphysical_vert,fragmentShader:ai.meshphysical_frag},toon:{uniforms:nc([Mn.common,Mn.aomap,Mn.lightmap,Mn.emissivemap,Mn.bumpmap,Mn.normalmap,Mn.displacementmap,Mn.gradientmap,Mn.fog,Mn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:ai.meshtoon_vert,fragmentShader:ai.meshtoon_frag},matcap:{uniforms:nc([Mn.common,Mn.bumpmap,Mn.normalmap,Mn.displacementmap,Mn.fog,{matcap:{value:null}}]),vertexShader:ai.meshmatcap_vert,fragmentShader:ai.meshmatcap_frag},points:{uniforms:nc([Mn.points,Mn.fog]),vertexShader:ai.points_vert,fragmentShader:ai.points_frag},dashed:{uniforms:nc([Mn.common,Mn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ai.linedashed_vert,fragmentShader:ai.linedashed_frag},depth:{uniforms:nc([Mn.common,Mn.displacementmap]),vertexShader:ai.depth_vert,fragmentShader:ai.depth_frag},normal:{uniforms:nc([Mn.common,Mn.bumpmap,Mn.normalmap,Mn.displacementmap,{opacity:{value:1}}]),vertexShader:ai.meshnormal_vert,fragmentShader:ai.meshnormal_frag},sprite:{uniforms:nc([Mn.sprite,Mn.fog]),vertexShader:ai.sprite_vert,fragmentShader:ai.sprite_frag},background:{uniforms:{uvTransform:{value:new si},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ai.background_vert,fragmentShader:ai.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new si}},vertexShader:ai.backgroundCube_vert,fragmentShader:ai.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ai.cube_vert,fragmentShader:ai.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ai.equirect_vert,fragmentShader:ai.equirect_frag},distanceRGBA:{uniforms:nc([Mn.common,Mn.displacementmap,{referencePosition:{value:new Ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ai.distanceRGBA_vert,fragmentShader:ai.distanceRGBA_frag},shadow:{uniforms:nc([Mn.lights,Mn.fog,{color:{value:new Pn(0)},opacity:{value:1}}]),vertexShader:ai.shadow_vert,fragmentShader:ai.shadow_frag}};v1.physical={uniforms:nc([v1.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new si},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new si},clearcoatNormalScale:{value:new An(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new si},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new si},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new si},sheen:{value:0},sheenColor:{value:new Pn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new si},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new si},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new si},transmissionSamplerSize:{value:new An},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new si},attenuationDistance:{value:0},attenuationColor:{value:new Pn(0)},specularColor:{value:new Pn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new si},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new si},anisotropyVector:{value:new An},anisotropyMap:{value:null},anisotropyMapTransform:{value:new si}}]),vertexShader:ai.meshphysical_vert,fragmentShader:ai.meshphysical_frag};const $R={r:0,b:0,g:0},G8=new ua,yOe=new or;function xOe(s,e,t,n,r,i,a){const c=new Pn(0);let u=i===!0?0:1,p,y,x=null,S=0,M=null;function I(X){let P=X.isScene===!0?X.background:null;return P&&P.isTexture&&(P=(X.backgroundBlurriness>0?t:e).get(P)),P}function L(X){let P=!1;const te=I(X);te===null?A(c,u):te&&te.isColor&&(A(te,1),P=!0);const oe=s.xr.getEnvironmentBlendMode();oe==="additive"?n.buffers.color.setClear(0,0,0,1,a):oe==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(s.autoClear||P)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil))}function B(X,P){const te=I(P);te&&(te.isCubeTexture||te.mapping===jk)?(y===void 0&&(y=new mn(new Ta(1,1,1),new r0({name:"BackgroundCubeMaterial",uniforms:Fx(v1.backgroundCube.uniforms),vertexShader:v1.backgroundCube.vertexShader,fragmentShader:v1.backgroundCube.fragmentShader,side:Qo,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),y.geometry.deleteAttribute("normal"),y.geometry.deleteAttribute("uv"),y.onBeforeRender=function(oe,ie,K){this.matrixWorld.copyPosition(K.matrixWorld)},Object.defineProperty(y.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(y)),G8.copy(P.backgroundRotation),G8.x*=-1,G8.y*=-1,G8.z*=-1,te.isCubeTexture&&te.isRenderTargetTexture===!1&&(G8.y*=-1,G8.z*=-1),y.material.uniforms.envMap.value=te,y.material.uniforms.flipEnvMap.value=te.isCubeTexture&&te.isRenderTargetTexture===!1?-1:1,y.material.uniforms.backgroundBlurriness.value=P.backgroundBlurriness,y.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,y.material.uniforms.backgroundRotation.value.setFromMatrix4(yOe.makeRotationFromEuler(G8)),y.material.toneMapped=Gr.getTransfer(te.colorSpace)!==Es,(x!==te||S!==te.version||M!==s.toneMapping)&&(y.material.needsUpdate=!0,x=te,S=te.version,M=s.toneMapping),y.layers.enableAll(),X.unshift(y,y.geometry,y.material,0,0,null)):te&&te.isTexture&&(p===void 0&&(p=new mn(new Ev(2,2),new r0({name:"BackgroundMaterial",uniforms:Fx(v1.background.uniforms),vertexShader:v1.background.vertexShader,fragmentShader:v1.background.fragmentShader,side:E1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=te,p.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,p.material.toneMapped=Gr.getTransfer(te.colorSpace)!==Es,te.matrixAutoUpdate===!0&&te.updateMatrix(),p.material.uniforms.uvTransform.value.copy(te.matrix),(x!==te||S!==te.version||M!==s.toneMapping)&&(p.material.needsUpdate=!0,x=te,S=te.version,M=s.toneMapping),p.layers.enableAll(),X.unshift(p,p.geometry,p.material,0,0,null))}function A(X,P){X.getRGB($R,pve(s)),n.buffers.color.setClear($R.r,$R.g,$R.b,P,a)}function V(){y!==void 0&&(y.geometry.dispose(),y.material.dispose(),y=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return c},setClearColor:function(X,P=1){c.set(X),u=P,A(c,u)},getClearAlpha:function(){return u},setClearAlpha:function(X){u=X,A(c,u)},render:L,addToRenderList:B,dispose:V}}function _Oe(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},r=S(null);let i=r,a=!1;function c(se,q,De,Be,tt){let st=!1;const de=x(Be,De,q);i!==de&&(i=de,p(i.object)),st=M(se,Be,De,tt),st&&I(se,Be,De,tt),tt!==null&&e.update(tt,s.ELEMENT_ARRAY_BUFFER),(st||a)&&(a=!1,P(se,q,De,Be),tt!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(tt).buffer))}function u(){return s.createVertexArray()}function p(se){return s.bindVertexArray(se)}function y(se){return s.deleteVertexArray(se)}function x(se,q,De){const Be=De.wireframe===!0;let tt=n[se.id];tt===void 0&&(tt={},n[se.id]=tt);let st=tt[q.id];st===void 0&&(st={},tt[q.id]=st);let de=st[Be];return de===void 0&&(de=S(u()),st[Be]=de),de}function S(se){const q=[],De=[],Be=[];for(let tt=0;tt<t;tt++)q[tt]=0,De[tt]=0,Be[tt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:De,attributeDivisors:Be,object:se,attributes:{},index:null}}function M(se,q,De,Be){const tt=i.attributes,st=q.attributes;let de=0;const ft=De.getAttributes();for(const Se in ft)if(ft[Se].location>=0){const ut=tt[Se];let Pe=st[Se];if(Pe===void 0&&(Se==="instanceMatrix"&&se.instanceMatrix&&(Pe=se.instanceMatrix),Se==="instanceColor"&&se.instanceColor&&(Pe=se.instanceColor)),ut===void 0||ut.attribute!==Pe||Pe&&ut.data!==Pe.data)return!0;de++}return i.attributesNum!==de||i.index!==Be}function I(se,q,De,Be){const tt={},st=q.attributes;let de=0;const ft=De.getAttributes();for(const Se in ft)if(ft[Se].location>=0){let ut=st[Se];ut===void 0&&(Se==="instanceMatrix"&&se.instanceMatrix&&(ut=se.instanceMatrix),Se==="instanceColor"&&se.instanceColor&&(ut=se.instanceColor));const Pe={};Pe.attribute=ut,ut&&ut.data&&(Pe.data=ut.data),tt[Se]=Pe,de++}i.attributes=tt,i.attributesNum=de,i.index=Be}function L(){const se=i.newAttributes;for(let q=0,De=se.length;q<De;q++)se[q]=0}function B(se){A(se,0)}function A(se,q){const De=i.newAttributes,Be=i.enabledAttributes,tt=i.attributeDivisors;De[se]=1,Be[se]===0&&(s.enableVertexAttribArray(se),Be[se]=1),tt[se]!==q&&(s.vertexAttribDivisor(se,q),tt[se]=q)}function V(){const se=i.newAttributes,q=i.enabledAttributes;for(let De=0,Be=q.length;De<Be;De++)q[De]!==se[De]&&(s.disableVertexAttribArray(De),q[De]=0)}function X(se,q,De,Be,tt,st,de){de===!0?s.vertexAttribIPointer(se,q,De,tt,st):s.vertexAttribPointer(se,q,De,Be,tt,st)}function P(se,q,De,Be){L();const tt=Be.attributes,st=De.getAttributes(),de=q.defaultAttributeValues;for(const ft in st){const Se=st[ft];if(Se.location>=0){let rt=tt[ft];if(rt===void 0&&(ft==="instanceMatrix"&&se.instanceMatrix&&(rt=se.instanceMatrix),ft==="instanceColor"&&se.instanceColor&&(rt=se.instanceColor)),rt!==void 0){const ut=rt.normalized,Pe=rt.itemSize,vt=e.get(rt);if(vt===void 0)continue;const Bt=vt.buffer,ct=vt.type,Pt=vt.bytesPerElement,on=ct===s.INT||ct===s.UNSIGNED_INT||rt.gpuType===CW;if(rt.isInterleavedBufferAttribute){const Gt=rt.data,hn=Gt.stride,Xn=rt.offset;if(Gt.isInstancedInterleavedBuffer){for(let Fn=0;Fn<Se.locationSize;Fn++)A(Se.location+Fn,Gt.meshPerAttribute);se.isInstancedMesh!==!0&&Be._maxInstanceCount===void 0&&(Be._maxInstanceCount=Gt.meshPerAttribute*Gt.count)}else for(let Fn=0;Fn<Se.locationSize;Fn++)B(Se.location+Fn);s.bindBuffer(s.ARRAY_BUFFER,Bt);for(let Fn=0;Fn<Se.locationSize;Fn++)X(Se.location+Fn,Pe/Se.locationSize,ct,ut,hn*Pt,(Xn+Pe/Se.locationSize*Fn)*Pt,on)}else{if(rt.isInstancedBufferAttribute){for(let Gt=0;Gt<Se.locationSize;Gt++)A(Se.location+Gt,rt.meshPerAttribute);se.isInstancedMesh!==!0&&Be._maxInstanceCount===void 0&&(Be._maxInstanceCount=rt.meshPerAttribute*rt.count)}else for(let Gt=0;Gt<Se.locationSize;Gt++)B(Se.location+Gt);s.bindBuffer(s.ARRAY_BUFFER,Bt);for(let Gt=0;Gt<Se.locationSize;Gt++)X(Se.location+Gt,Pe/Se.locationSize,ct,ut,Pe*Pt,Pe/Se.locationSize*Gt*Pt,on)}}else if(de!==void 0){const ut=de[ft];if(ut!==void 0)switch(ut.length){case 2:s.vertexAttrib2fv(Se.location,ut);break;case 3:s.vertexAttrib3fv(Se.location,ut);break;case 4:s.vertexAttrib4fv(Se.location,ut);break;default:s.vertexAttrib1fv(Se.location,ut)}}}}V()}function te(){K();for(const se in n){const q=n[se];for(const De in q){const Be=q[De];for(const tt in Be)y(Be[tt].object),delete Be[tt];delete q[De]}delete n[se]}}function oe(se){if(n[se.id]===void 0)return;const q=n[se.id];for(const De in q){const Be=q[De];for(const tt in Be)y(Be[tt].object),delete Be[tt];delete q[De]}delete n[se.id]}function ie(se){for(const q in n){const De=n[q];if(De[se.id]===void 0)continue;const Be=De[se.id];for(const tt in Be)y(Be[tt].object),delete Be[tt];delete De[se.id]}}function K(){re(),a=!0,i!==r&&(i=r,p(i.object))}function re(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:c,reset:K,resetDefaultState:re,dispose:te,releaseStatesOfGeometry:oe,releaseStatesOfProgram:ie,initAttributes:L,enableAttribute:B,disableUnusedAttributes:V}}function bOe(s,e,t){let n;function r(p){n=p}function i(p,y){s.drawArrays(n,p,y),t.update(y,n,1)}function a(p,y,x){x!==0&&(s.drawArraysInstanced(n,p,y,x),t.update(y,n,x))}function c(p,y,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,y,0,x);let M=0;for(let I=0;I<x;I++)M+=y[I];t.update(M,n,1)}function u(p,y,x,S){if(x===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let I=0;I<p.length;I++)a(p[I],y[I],S[I]);else{M.multiDrawArraysInstancedWEBGL(n,p,0,y,0,S,0,x);let I=0;for(let L=0;L<x;L++)I+=y[L]*S[L];t.update(I,n,1)}}this.setMode=r,this.render=i,this.renderInstances=a,this.renderMultiDraw=c,this.renderMultiDrawInstances=u}function SOe(s,e,t,n){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const ie=e.get("EXT_texture_filter_anisotropic");r=s.getParameter(ie.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(ie){return!(ie!==yl&&n.convert(ie)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(ie){const K=ie===W3&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(ie!==t0&&n.convert(ie)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&ie!==ed&&!K)}function u(ie){if(ie==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";ie="mediump"}return ie==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const y=u(p);y!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",y,"instead."),p=y);const x=t.logarithmicDepthBuffer===!0,S=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),M=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),I=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),L=s.getParameter(s.MAX_TEXTURE_SIZE),B=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),A=s.getParameter(s.MAX_VERTEX_ATTRIBS),V=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),X=s.getParameter(s.MAX_VARYING_VECTORS),P=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),te=I>0,oe=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:i,getMaxPrecision:u,textureFormatReadable:a,textureTypeReadable:c,precision:p,logarithmicDepthBuffer:x,reverseDepthBuffer:S,maxTextures:M,maxVertexTextures:I,maxTextureSize:L,maxCubemapSize:B,maxAttributes:A,maxVertexUniforms:V,maxVaryings:X,maxFragmentUniforms:P,vertexTextures:te,maxSamples:oe}}function wOe(s){const e=this;let t=null,n=0,r=!1,i=!1;const a=new k3,c=new si,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(x,S){const M=x.length!==0||S||n!==0||r;return r=S,n=x.length,M},this.beginShadows=function(){i=!0,y(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(x,S){t=y(x,S,0)},this.setState=function(x,S,M){const I=x.clippingPlanes,L=x.clipIntersection,B=x.clipShadows,A=s.get(x);if(!r||I===null||I.length===0||i&&!B)i?y(null):p();else{const V=i?0:n,X=V*4;let P=A.clippingState||null;u.value=P,P=y(I,S,X,M);for(let te=0;te!==X;++te)P[te]=t[te];A.clippingState=P,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=V}};function p(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function y(x,S,M,I){const L=x!==null?x.length:0;let B=null;if(L!==0){if(B=u.value,I!==!0||B===null){const A=M+L*4,V=S.matrixWorldInverse;c.getNormalMatrix(V),(B===null||B.length<A)&&(B=new Float32Array(A));for(let X=0,P=M;X!==L;++X,P+=4)a.copy(x[X]).applyMatrix4(V,c),a.normal.toArray(B,P),B[P+3]=a.constant}u.value=B,u.needsUpdate=!0}return e.numPlanes=L,e.numIntersection=0,B}}function EOe(s){let e=new WeakMap;function t(a,c){return c===ak?a.mapping=kx:c===jj&&(a.mapping=Nx),a}function n(a){if(a&&a.isTexture){const c=a.mapping;if(c===ak||c===jj)if(e.has(a)){const u=e.get(a).texture;return t(u,a.mapping)}else{const u=a.image;if(u&&u.height>0){const p=new SIe(u.height);return p.fromEquirectangularTexture(s,a),e.set(a,p),a.addEventListener("dispose",r),t(p.texture,a.mapping)}else return null}}return a}function r(a){const c=a.target;c.removeEventListener("dispose",r);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function i(){e=new WeakMap}return{get:n,dispose:i}}const ux=4,g3e=[.125,.215,.35,.446,.526,.582],uv=20,HV=new zx,v3e=new Pn;let WV=null,$V=0,qV=0,XV=!1;const nv=(1+Math.sqrt(5))/2,I7=1/nv,y3e=[new Ae(-nv,I7,0),new Ae(nv,I7,0),new Ae(-I7,0,nv),new Ae(I7,0,nv),new Ae(0,nv,-I7),new Ae(0,nv,I7),new Ae(-1,1,-1),new Ae(1,1,-1),new Ae(-1,1,1),new Ae(1,1,1)],TOe=new Ae;let x3e=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100,i={}){const{size:a=256,position:c=TOe}=i;WV=this._renderer.getRenderTarget(),$V=this._renderer.getActiveCubeFace(),qV=this._renderer.getActiveMipmapLevel(),XV=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const u=this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,n,r,u,c),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=S3e(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=b3e(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(WV,$V,qV),this._renderer.xr.enabled=XV,e.scissorTest=!1,qR(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===kx||e.mapping===Nx?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),WV=this._renderer.getRenderTarget(),$V=this._renderer.getActiveCubeFace(),qV=this._renderer.getActiveMipmapLevel(),XV=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:e0,minFilter:e0,generateMipmaps:!1,type:W3,format:yl,colorSpace:Ju,depthBuffer:!1},r=_3e(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_3e(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=MOe(i)),this._blurMaterial=COe(i,e,t)}return r}_compileMaterial(e){const t=new mn(this._lodPlanes[0],e);this._renderer.compile(t,HV)}_sceneToCubeUV(e,t,n,r,i){const u=new Ja(90,1,t,n),p=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],x=this._renderer,S=x.autoClear,M=x.toneMapping;x.getClearColor(v3e),x.toneMapping=b1,x.autoClear=!1;const I=new eh({name:"PMREM.Background",side:Qo,depthWrite:!1,depthTest:!1}),L=new mn(new Ta,I);let B=!1;const A=e.background;A?A.isColor&&(I.color.copy(A),e.background=null,B=!0):(I.color.copy(v3e),B=!0);for(let V=0;V<6;V++){const X=V%3;X===0?(u.up.set(0,p[V],0),u.position.set(i.x,i.y,i.z),u.lookAt(i.x+y[V],i.y,i.z)):X===1?(u.up.set(0,0,p[V]),u.position.set(i.x,i.y,i.z),u.lookAt(i.x,i.y+y[V],i.z)):(u.up.set(0,p[V],0),u.position.set(i.x,i.y,i.z),u.lookAt(i.x,i.y,i.z+y[V]));const P=this._cubeSize;qR(r,X*P,V>2?P:0,P,P),x.setRenderTarget(r),B&&x.render(L,u),x.render(e,u)}L.geometry.dispose(),L.material.dispose(),x.toneMapping=M,x.autoClear=S,e.background=A}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===kx||e.mapping===Nx;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=S3e()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=b3e());const i=r?this._cubemapMaterial:this._equirectMaterial,a=new mn(this._lodPlanes[0],i),c=i.uniforms;c.envMap.value=e;const u=this._cubeSize;qR(t,0,0,3*u,2*u),n.setRenderTarget(t),n.render(a,HV)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),c=y3e[(r-i-1)%y3e.length];this._blur(e,i-1,i,a,c)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,c){const u=this._renderer,p=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const y=3,x=new mn(this._lodPlanes[r],p),S=p.uniforms,M=this._sizeLods[n]-1,I=isFinite(i)?Math.PI/(2*M):2*Math.PI/(2*uv-1),L=i/I,B=isFinite(i)?1+Math.floor(y*L):uv;B>uv&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${B} samples when the maximum is set to ${uv}`);const A=[];let V=0;for(let ie=0;ie<uv;++ie){const K=ie/L,re=Math.exp(-K*K/2);A.push(re),ie===0?V+=re:ie<B&&(V+=2*re)}for(let ie=0;ie<A.length;ie++)A[ie]=A[ie]/V;S.envMap.value=e.texture,S.samples.value=B,S.weights.value=A,S.latitudinal.value=a==="latitudinal",c&&(S.poleAxis.value=c);const{_lodMax:X}=this;S.dTheta.value=I,S.mipInt.value=X-n;const P=this._sizeLods[r],te=3*P*(r>X-ux?r-X+ux:0),oe=4*(this._cubeSize-P);qR(t,te,oe,3*P,2*P),u.setRenderTarget(t),u.render(x,HV)}};function MOe(s){const e=[],t=[],n=[];let r=s;const i=s-ux+1+g3e.length;for(let a=0;a<i;a++){const c=Math.pow(2,r);t.push(c);let u=1/c;a>s-ux?u=g3e[a-s+ux-1]:a===0&&(u=0),n.push(u);const p=1/(c-2),y=-p,x=1+p,S=[y,y,x,y,x,x,y,y,x,x,y,x],M=6,I=6,L=3,B=2,A=1,V=new Float32Array(L*I*M),X=new Float32Array(B*I*M),P=new Float32Array(A*I*M);for(let oe=0;oe<M;oe++){const ie=oe%3*2/3-1,K=oe>2?0:-1,re=[ie,K,0,ie+2/3,K,0,ie+2/3,K+1,0,ie,K,0,ie+2/3,K+1,0,ie,K+1,0];V.set(re,L*I*oe),X.set(S,B*I*oe);const se=[oe,oe,oe,oe,oe,oe];P.set(se,A*I*oe)}const te=new rs;te.setAttribute("position",new Qu(V,L)),te.setAttribute("uv",new Qu(X,B)),te.setAttribute("faceIndex",new Qu(P,A)),e.push(te),r>ux&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function _3e(s,e,t){const n=new bl(s,e,t);return n.texture.mapping=jk,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function qR(s,e,t,n,r){s.viewport.set(e,t,n,r),s.scissor.set(e,t,n,r)}function COe(s,e,t){const n=new Float32Array(uv),r=new Ae(0,1,0);return new r0({name:"SphericalGaussianBlur",defines:{n:uv,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:QW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:cc,depthTest:!1,depthWrite:!1})}function b3e(){return new r0({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:QW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:cc,depthTest:!1,depthWrite:!1})}function S3e(){return new r0({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:QW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:cc,depthTest:!1,depthWrite:!1})}function QW(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function AOe(s){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const u=c.mapping,p=u===ak||u===jj,y=u===kx||u===Nx;if(p||y){let x=e.get(c);const S=x!==void 0?x.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==S)return t===null&&(t=new x3e(s)),x=p?t.fromEquirectangular(c,x):t.fromCubemap(c,x),x.texture.pmremVersion=c.pmremVersion,e.set(c,x),x.texture;if(x!==void 0)return x.texture;{const M=c.image;return p&&M&&M.height>0||y&&M&&r(M)?(t===null&&(t=new x3e(s)),x=p?t.fromEquirectangular(c):t.fromCubemap(c),x.texture.pmremVersion=c.pmremVersion,e.set(c,x),c.addEventListener("dispose",i),x.texture):null}}}return c}function r(c){let u=0;const p=6;for(let y=0;y<p;y++)c[y]!==void 0&&u++;return u===p}function i(c){const u=c.target;u.removeEventListener("dispose",i);const p=e.get(u);p!==void 0&&(e.delete(u),p.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function POe(s){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=s.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&_x("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function ROe(s,e,t,n){const r={},i=new WeakMap;function a(x){const S=x.target;S.index!==null&&e.remove(S.index);for(const I in S.attributes)e.remove(S.attributes[I]);S.removeEventListener("dispose",a),delete r[S.id];const M=i.get(S);M&&(e.remove(M),i.delete(S)),n.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,t.memory.geometries--}function c(x,S){return r[S.id]===!0||(S.addEventListener("dispose",a),r[S.id]=!0,t.memory.geometries++),S}function u(x){const S=x.attributes;for(const M in S)e.update(S[M],s.ARRAY_BUFFER)}function p(x){const S=[],M=x.index,I=x.attributes.position;let L=0;if(M!==null){const V=M.array;L=M.version;for(let X=0,P=V.length;X<P;X+=3){const te=V[X+0],oe=V[X+1],ie=V[X+2];S.push(te,oe,oe,ie,ie,te)}}else if(I!==void 0){const V=I.array;L=I.version;for(let X=0,P=V.length/3-1;X<P;X+=3){const te=X+0,oe=X+1,ie=X+2;S.push(te,oe,oe,ie,ie,te)}}else return;const B=new(sve(S)?hve:FW)(S,1);B.version=L;const A=i.get(x);A&&e.remove(A),i.set(x,B)}function y(x){const S=i.get(x);if(S){const M=x.index;M!==null&&S.version<M.version&&p(x)}else p(x);return i.get(x)}return{get:c,update:u,getWireframeAttribute:y}}function IOe(s,e,t){let n;function r(S){n=S}let i,a;function c(S){i=S.type,a=S.bytesPerElement}function u(S,M){s.drawElements(n,M,i,S*a),t.update(M,n,1)}function p(S,M,I){I!==0&&(s.drawElementsInstanced(n,M,i,S*a,I),t.update(M,n,I))}function y(S,M,I){if(I===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,M,0,i,S,0,I);let B=0;for(let A=0;A<I;A++)B+=M[A];t.update(B,n,1)}function x(S,M,I,L){if(I===0)return;const B=e.get("WEBGL_multi_draw");if(B===null)for(let A=0;A<S.length;A++)p(S[A]/a,M[A],L[A]);else{B.multiDrawElementsInstancedWEBGL(n,M,0,i,S,0,L,0,I);let A=0;for(let V=0;V<I;V++)A+=M[V]*L[V];t.update(A,n,1)}}this.setMode=r,this.setIndex=c,this.render=u,this.renderInstances=p,this.renderMultiDraw=y,this.renderMultiDrawInstances=x}function kOe(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(i,a,c){switch(t.calls++,a){case s.TRIANGLES:t.triangles+=c*(i/3);break;case s.LINES:t.lines+=c*(i/2);break;case s.LINE_STRIP:t.lines+=c*(i-1);break;case s.LINE_LOOP:t.lines+=c*i;break;case s.POINTS:t.points+=c*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function NOe(s,e,t){const n=new WeakMap,r=new xi;function i(a,c,u){const p=a.morphTargetInfluences,y=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,x=y!==void 0?y.length:0;let S=n.get(c);if(S===void 0||S.count!==x){let se=function(){K.dispose(),n.delete(c),c.removeEventListener("dispose",se)};var M=se;S!==void 0&&S.texture.dispose();const I=c.morphAttributes.position!==void 0,L=c.morphAttributes.normal!==void 0,B=c.morphAttributes.color!==void 0,A=c.morphAttributes.position||[],V=c.morphAttributes.normal||[],X=c.morphAttributes.color||[];let P=0;I===!0&&(P=1),L===!0&&(P=2),B===!0&&(P=3);let te=c.attributes.position.count*P,oe=1;te>e.maxTextureSize&&(oe=Math.ceil(te/e.maxTextureSize),te=e.maxTextureSize);const ie=new Float32Array(te*oe*4*x),K=new lve(ie,te,oe,x);K.type=ed,K.needsUpdate=!0;const re=P*4;for(let q=0;q<x;q++){const De=A[q],Be=V[q],tt=X[q],st=te*oe*4*q;for(let de=0;de<De.count;de++){const ft=de*re;I===!0&&(r.fromBufferAttribute(De,de),ie[st+ft+0]=r.x,ie[st+ft+1]=r.y,ie[st+ft+2]=r.z,ie[st+ft+3]=0),L===!0&&(r.fromBufferAttribute(Be,de),ie[st+ft+4]=r.x,ie[st+ft+5]=r.y,ie[st+ft+6]=r.z,ie[st+ft+7]=0),B===!0&&(r.fromBufferAttribute(tt,de),ie[st+ft+8]=r.x,ie[st+ft+9]=r.y,ie[st+ft+10]=r.z,ie[st+ft+11]=tt.itemSize===4?r.w:1)}}S={count:x,texture:K,size:new An(te,oe)},n.set(c,S),c.addEventListener("dispose",se)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)u.getUniforms().setValue(s,"morphTexture",a.morphTexture,t);else{let I=0;for(let B=0;B<p.length;B++)I+=p[B];const L=c.morphTargetsRelative?1:1-I;u.getUniforms().setValue(s,"morphTargetBaseInfluence",L),u.getUniforms().setValue(s,"morphTargetInfluences",p)}u.getUniforms().setValue(s,"morphTargetsTexture",S.texture,t),u.getUniforms().setValue(s,"morphTargetsTextureSize",S.size)}return{update:i}}function DOe(s,e,t,n){let r=new WeakMap;function i(u){const p=n.render.frame,y=u.geometry,x=e.get(u,y);if(r.get(x)!==p&&(e.update(x),r.set(x,p)),u.isInstancedMesh&&(u.hasEventListener("dispose",c)===!1&&u.addEventListener("dispose",c),r.get(u)!==p&&(t.update(u.instanceMatrix,s.ARRAY_BUFFER),u.instanceColor!==null&&t.update(u.instanceColor,s.ARRAY_BUFFER),r.set(u,p))),u.isSkinnedMesh){const S=u.skeleton;r.get(S)!==p&&(S.update(),r.set(S,p))}return x}function a(){r=new WeakMap}function c(u){const p=u.target;p.removeEventListener("dispose",c),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:i,dispose:a}}const Fve=new n0,w3e=new GW(1,1),Bve=new lve,Uve=new nIe,zve=new BW,E3e=[],T3e=[],M3e=new Float32Array(16),C3e=new Float32Array(9),A3e=new Float32Array(4);function r_(s,e,t){const n=s[0];if(n<=0||n>0)return s;const r=e*t;let i=E3e[r];if(i===void 0&&(i=new Float32Array(r),E3e[r]=i),e!==0){n.toArray(i,0);for(let a=1,c=0;a!==e;++a)c+=t,s[a].toArray(i,c)}return i}function Pa(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function Ra(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function qk(s,e){let t=T3e[e];t===void 0&&(t=new Int32Array(e),T3e[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function OOe(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function LOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pa(t,e))return;s.uniform2fv(this.addr,e),Ra(t,e)}}function FOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Pa(t,e))return;s.uniform3fv(this.addr,e),Ra(t,e)}}function BOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pa(t,e))return;s.uniform4fv(this.addr,e),Ra(t,e)}}function UOe(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Pa(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),Ra(t,e)}else{if(Pa(t,n))return;A3e.set(n),s.uniformMatrix2fv(this.addr,!1,A3e),Ra(t,n)}}function zOe(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Pa(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),Ra(t,e)}else{if(Pa(t,n))return;C3e.set(n),s.uniformMatrix3fv(this.addr,!1,C3e),Ra(t,n)}}function VOe(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Pa(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),Ra(t,e)}else{if(Pa(t,n))return;M3e.set(n),s.uniformMatrix4fv(this.addr,!1,M3e),Ra(t,n)}}function GOe(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function jOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pa(t,e))return;s.uniform2iv(this.addr,e),Ra(t,e)}}function HOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Pa(t,e))return;s.uniform3iv(this.addr,e),Ra(t,e)}}function WOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pa(t,e))return;s.uniform4iv(this.addr,e),Ra(t,e)}}function $Oe(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function qOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pa(t,e))return;s.uniform2uiv(this.addr,e),Ra(t,e)}}function XOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Pa(t,e))return;s.uniform3uiv(this.addr,e),Ra(t,e)}}function YOe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pa(t,e))return;s.uniform4uiv(this.addr,e),Ra(t,e)}}function KOe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r);let i;this.type===s.SAMPLER_2D_SHADOW?(w3e.compareFunction=tve,i=w3e):i=Fve,t.setTexture2D(e||i,r)}function ZOe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||Uve,r)}function QOe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||zve,r)}function JOe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||Bve,r)}function eLe(s){switch(s){case 5126:return OOe;case 35664:return LOe;case 35665:return FOe;case 35666:return BOe;case 35674:return UOe;case 35675:return zOe;case 35676:return VOe;case 5124:case 35670:return GOe;case 35667:case 35671:return jOe;case 35668:case 35672:return HOe;case 35669:case 35673:return WOe;case 5125:return $Oe;case 36294:return qOe;case 36295:return XOe;case 36296:return YOe;case 35678:case 36198:case 36298:case 36306:case 35682:return KOe;case 35679:case 36299:case 36307:return ZOe;case 35680:case 36300:case 36308:case 36293:return QOe;case 36289:case 36303:case 36311:case 36292:return JOe}}function tLe(s,e){s.uniform1fv(this.addr,e)}function nLe(s,e){const t=r_(e,this.size,2);s.uniform2fv(this.addr,t)}function rLe(s,e){const t=r_(e,this.size,3);s.uniform3fv(this.addr,t)}function iLe(s,e){const t=r_(e,this.size,4);s.uniform4fv(this.addr,t)}function sLe(s,e){const t=r_(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function oLe(s,e){const t=r_(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function aLe(s,e){const t=r_(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function lLe(s,e){s.uniform1iv(this.addr,e)}function cLe(s,e){s.uniform2iv(this.addr,e)}function uLe(s,e){s.uniform3iv(this.addr,e)}function hLe(s,e){s.uniform4iv(this.addr,e)}function dLe(s,e){s.uniform1uiv(this.addr,e)}function fLe(s,e){s.uniform2uiv(this.addr,e)}function pLe(s,e){s.uniform3uiv(this.addr,e)}function mLe(s,e){s.uniform4uiv(this.addr,e)}function gLe(s,e,t){const n=this.cache,r=e.length,i=qk(t,r);Pa(n,i)||(s.uniform1iv(this.addr,i),Ra(n,i));for(let a=0;a!==r;++a)t.setTexture2D(e[a]||Fve,i[a])}function vLe(s,e,t){const n=this.cache,r=e.length,i=qk(t,r);Pa(n,i)||(s.uniform1iv(this.addr,i),Ra(n,i));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||Uve,i[a])}function yLe(s,e,t){const n=this.cache,r=e.length,i=qk(t,r);Pa(n,i)||(s.uniform1iv(this.addr,i),Ra(n,i));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||zve,i[a])}function xLe(s,e,t){const n=this.cache,r=e.length,i=qk(t,r);Pa(n,i)||(s.uniform1iv(this.addr,i),Ra(n,i));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||Bve,i[a])}function _Le(s){switch(s){case 5126:return tLe;case 35664:return nLe;case 35665:return rLe;case 35666:return iLe;case 35674:return sLe;case 35675:return oLe;case 35676:return aLe;case 5124:case 35670:return lLe;case 35667:case 35671:return cLe;case 35668:case 35672:return uLe;case 35669:case 35673:return hLe;case 5125:return dLe;case 36294:return fLe;case 36295:return pLe;case 36296:return mLe;case 35678:case 36198:case 36298:case 36306:case 35682:return gLe;case 35679:case 36299:case 36307:return vLe;case 35680:case 36300:case 36308:case 36293:return yLe;case 36289:case 36303:case 36311:case 36292:return xLe}}class bLe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=eLe(t.type)}}class SLe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=_Le(t.type)}}class wLe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const c=r[i];c.setValue(e,t[c.id],n)}}}const YV=/(\w+)(\])?(\[|\.)?/g;function P3e(s,e){s.seq.push(e),s.map[e.id]=e}function ELe(s,e,t){const n=s.name,r=n.length;for(YV.lastIndex=0;;){const i=YV.exec(n),a=YV.lastIndex;let c=i[1];const u=i[2]==="]",p=i[3];if(u&&(c=c|0),p===void 0||p==="["&&a+2===r){P3e(t,p===void 0?new bLe(c,s,e):new SLe(c,s,e));break}else{let x=t.map[c];x===void 0&&(x=new wLe(c),P3e(t,x)),t=x}}}class XI{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const i=e.getActiveUniform(t,r),a=e.getUniformLocation(t,i.name);ELe(i,a,this)}}setValue(e,t,n,r){const i=this.map[t];i!==void 0&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const c=t[i],u=n[c.id];u.needsUpdate!==!1&&c.setValue(e,u.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function R3e(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const TLe=37297;let MLe=0;function CLe(s,e){const t=s.split(`
`),n=[],r=Math.max(e-6,0),i=Math.min(e+6,t.length);for(let a=r;a<i;a++){const c=a+1;n.push(`${c===e?">":" "} ${c}: ${t[a]}`)}return n.join(`
`)}const I3e=new si;function ALe(s){Gr._getMatrix(I3e,Gr.workingColorSpace,s);const e=`mat3( ${I3e.elements.map(t=>t.toFixed(4))} )`;switch(Gr.getTransfer(s)){case uk:return[e,"LinearTransferOETF"];case Es:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",s),[e,"LinearTransferOETF"]}}function k3e(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),r=s.getShaderInfoLog(e).trim();if(n&&r==="")return"";const i=/ERROR: 0:(\d+)/.exec(r);if(i){const a=parseInt(i[1]);return t.toUpperCase()+`

`+r+`

`+CLe(s.getShaderSource(e),a)}else return r}function PLe(s,e){const t=ALe(e);return[`vec4 ${s}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function RLe(s,e){let t;switch(e){case z8e:t="Linear";break;case V8e:t="Reinhard";break;case G8e:t="Cineon";break;case j8e:t="ACESFilmic";break;case W8e:t="AgX";break;case $8e:t="Neutral";break;case H8e:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const XR=new Ae;function ILe(){Gr.getLuminanceCoefficients(XR);const s=XR.x.toFixed(4),e=XR.y.toFixed(4),t=XR.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${s}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function kLe(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(qw).join(`
`)}function NLe(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function DLe(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const i=s.getActiveAttrib(e,r),a=i.name;let c=1;i.type===s.FLOAT_MAT2&&(c=2),i.type===s.FLOAT_MAT3&&(c=3),i.type===s.FLOAT_MAT4&&(c=4),t[a]={type:i.type,location:s.getAttribLocation(e,a),locationSize:c}}return t}function qw(s){return s!==""}function N3e(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function D3e(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const OLe=/^[ \t]*#include +<([\w\d./]+)>/gm;function CH(s){return s.replace(OLe,FLe)}const LLe=new Map;function FLe(s,e){let t=ai[e];if(t===void 0){const n=LLe.get(e);if(n!==void 0)t=ai[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return CH(t)}const BLe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function O3e(s){return s.replace(BLe,ULe)}function ULe(s,e,t,n){let r="";for(let i=parseInt(e);i<parseInt(t);i++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return r}function L3e(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function zLe(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===N8e?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===pRe?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===Rg&&(e="SHADOWMAP_TYPE_VSM"),e}function VLe(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case kx:case Nx:e="ENVMAP_TYPE_CUBE";break;case jk:e="ENVMAP_TYPE_CUBE_UV";break}return e}function GLe(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case Nx:e="ENVMAP_MODE_REFRACTION";break}return e}function jLe(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case Gk:e="ENVMAP_BLENDING_MULTIPLY";break;case mRe:e="ENVMAP_BLENDING_MIX";break;case gRe:e="ENVMAP_BLENDING_ADD";break}return e}function HLe(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function WLe(s,e,t,n){const r=s.getContext(),i=t.defines;let a=t.vertexShader,c=t.fragmentShader;const u=zLe(t),p=VLe(t),y=GLe(t),x=jLe(t),S=HLe(t),M=kLe(t),I=NLe(i),L=r.createProgram();let B,A,V=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(B=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I].filter(qw).join(`
`),B.length>0&&(B+=`
`),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I].filter(qw).join(`
`),A.length>0&&(A+=`
`)):(B=[L3e(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(qw).join(`
`),A=[L3e(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+y:"",t.envMap?"#define "+x:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==b1?"#define TONE_MAPPING":"",t.toneMapping!==b1?ai.tonemapping_pars_fragment:"",t.toneMapping!==b1?RLe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ai.colorspace_pars_fragment,PLe("linearToOutputTexel",t.outputColorSpace),ILe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(qw).join(`
`)),a=CH(a),a=N3e(a,t),a=D3e(a,t),c=CH(c),c=N3e(c,t),c=D3e(c,t),a=O3e(a),c=O3e(c),t.isRawShaderMaterial!==!0&&(V=`#version 300 es
`,B=[M,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+B,A=["#define varying in",t.glslVersion===yH?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===yH?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const X=V+B+a,P=V+A+c,te=R3e(r,r.VERTEX_SHADER,X),oe=R3e(r,r.FRAGMENT_SHADER,P);r.attachShader(L,te),r.attachShader(L,oe),t.index0AttributeName!==void 0?r.bindAttribLocation(L,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(L,0,"position"),r.linkProgram(L);function ie(q){if(s.debug.checkShaderErrors){const De=r.getProgramInfoLog(L).trim(),Be=r.getShaderInfoLog(te).trim(),tt=r.getShaderInfoLog(oe).trim();let st=!0,de=!0;if(r.getProgramParameter(L,r.LINK_STATUS)===!1)if(st=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(r,L,te,oe);else{const ft=k3e(r,te,"vertex"),Se=k3e(r,oe,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(L,r.VALIDATE_STATUS)+`

Material Name: `+q.name+`
Material Type: `+q.type+`

Program Info Log: `+De+`
`+ft+`
`+Se)}else De!==""?console.warn("THREE.WebGLProgram: Program Info Log:",De):(Be===""||tt==="")&&(de=!1);de&&(q.diagnostics={runnable:st,programLog:De,vertexShader:{log:Be,prefix:B},fragmentShader:{log:tt,prefix:A}})}r.deleteShader(te),r.deleteShader(oe),K=new XI(r,L),re=DLe(r,L)}let K;this.getUniforms=function(){return K===void 0&&ie(this),K};let re;this.getAttributes=function(){return re===void 0&&ie(this),re};let se=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return se===!1&&(se=r.getProgramParameter(L,TLe)),se},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(L),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=MLe++,this.cacheKey=e,this.usedTimes=1,this.program=L,this.vertexShader=te,this.fragmentShader=oe,this}let $Le=0;class qLe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(i)===!1&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new XLe(e),t.set(e,n)),n}}class XLe{constructor(e){this.id=$Le++,this.code=e,this.usedTimes=0}}function YLe(s,e,t,n,r,i,a){const c=new LW,u=new qLe,p=new Set,y=[],x=r.logarithmicDepthBuffer,S=r.vertexTextures;let M=r.precision;const I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(re){return p.add(re),re===0?"uv":`uv${re}`}function B(re,se,q,De,Be){const tt=De.fog,st=Be.geometry,de=re.isMeshStandardMaterial?De.environment:null,ft=(re.isMeshStandardMaterial?t:e).get(re.envMap||de),Se=ft&&ft.mapping===jk?ft.image.height:null,rt=I[re.type];re.precision!==null&&(M=r.getMaxPrecision(re.precision),M!==re.precision&&console.warn("THREE.WebGLProgram.getParameters:",re.precision,"not supported, using",M,"instead."));const ut=st.morphAttributes.position||st.morphAttributes.normal||st.morphAttributes.color,Pe=ut!==void 0?ut.length:0;let vt=0;st.morphAttributes.position!==void 0&&(vt=1),st.morphAttributes.normal!==void 0&&(vt=2),st.morphAttributes.color!==void 0&&(vt=3);let Bt,ct,Pt,on;if(rt){const hr=v1[rt];Bt=hr.vertexShader,ct=hr.fragmentShader}else Bt=re.vertexShader,ct=re.fragmentShader,u.update(re),Pt=u.getVertexShaderID(re),on=u.getFragmentShaderID(re);const Gt=s.getRenderTarget(),hn=s.state.buffers.depth.getReversed(),Xn=Be.isInstancedMesh===!0,Fn=Be.isBatchedMesh===!0,Kr=!!re.map,Mi=!!re.matcap,Br=!!ft,Ue=!!re.aoMap,Ii=!!re.lightMap,ei=!!re.bumpMap,Ar=!!re.normalMap,On=!!re.displacementMap,Yr=!!re.emissiveMap,Yn=!!re.metalnessMap,vr=!!re.roughnessMap,Ci=re.anisotropy>0,Ie=re.clearcoat>0,pe=re.dispersion>0,wt=re.iridescence>0,Vt=re.sheen>0,qt=re.transmission>0,Ot=Ci&&!!re.anisotropyMap,Kn=Ie&&!!re.clearcoatMap,vn=Ie&&!!re.clearcoatNormalMap,Ln=Ie&&!!re.clearcoatRoughnessMap,Qn=wt&&!!re.iridescenceMap,jt=wt&&!!re.iridescenceThicknessMap,Rn=Vt&&!!re.sheenColorMap,rr=Vt&&!!re.sheenRoughnessMap,Jn=!!re.specularMap,_n=!!re.specularColorMap,tr=!!re.specularIntensityMap,je=qt&&!!re.transmissionMap,yn=qt&&!!re.thicknessMap,Yt=!!re.gradientMap,wn=!!re.alphaMap,tn=re.alphaTest>0,Wt=!!re.alphaHash,kn=!!re.extensions;let yr=b1;re.toneMapped&&(Gt===null||Gt.isXRRenderTarget===!0)&&(yr=s.toneMapping);const ki={shaderID:rt,shaderType:re.type,shaderName:re.name,vertexShader:Bt,fragmentShader:ct,defines:re.defines,customVertexShaderID:Pt,customFragmentShaderID:on,isRawShaderMaterial:re.isRawShaderMaterial===!0,glslVersion:re.glslVersion,precision:M,batching:Fn,batchingColor:Fn&&Be._colorsTexture!==null,instancing:Xn,instancingColor:Xn&&Be.instanceColor!==null,instancingMorph:Xn&&Be.morphTexture!==null,supportsVertexTextures:S,outputColorSpace:Gt===null?s.outputColorSpace:Gt.isXRRenderTarget===!0?Gt.texture.colorSpace:Ju,alphaToCoverage:!!re.alphaToCoverage,map:Kr,matcap:Mi,envMap:Br,envMapMode:Br&&ft.mapping,envMapCubeUVHeight:Se,aoMap:Ue,lightMap:Ii,bumpMap:ei,normalMap:Ar,displacementMap:S&&On,emissiveMap:Yr,normalMapObjectSpace:Ar&&re.normalMapType===ERe,normalMapTangentSpace:Ar&&re.normalMapType===Qx,metalnessMap:Yn,roughnessMap:vr,anisotropy:Ci,anisotropyMap:Ot,clearcoat:Ie,clearcoatMap:Kn,clearcoatNormalMap:vn,clearcoatRoughnessMap:Ln,dispersion:pe,iridescence:wt,iridescenceMap:Qn,iridescenceThicknessMap:jt,sheen:Vt,sheenColorMap:Rn,sheenRoughnessMap:rr,specularMap:Jn,specularColorMap:_n,specularIntensityMap:tr,transmission:qt,transmissionMap:je,thicknessMap:yn,gradientMap:Yt,opaque:re.transparent===!1&&re.blending===xv&&re.alphaToCoverage===!1,alphaMap:wn,alphaTest:tn,alphaHash:Wt,combine:re.combine,mapUv:Kr&&L(re.map.channel),aoMapUv:Ue&&L(re.aoMap.channel),lightMapUv:Ii&&L(re.lightMap.channel),bumpMapUv:ei&&L(re.bumpMap.channel),normalMapUv:Ar&&L(re.normalMap.channel),displacementMapUv:On&&L(re.displacementMap.channel),emissiveMapUv:Yr&&L(re.emissiveMap.channel),metalnessMapUv:Yn&&L(re.metalnessMap.channel),roughnessMapUv:vr&&L(re.roughnessMap.channel),anisotropyMapUv:Ot&&L(re.anisotropyMap.channel),clearcoatMapUv:Kn&&L(re.clearcoatMap.channel),clearcoatNormalMapUv:vn&&L(re.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ln&&L(re.clearcoatRoughnessMap.channel),iridescenceMapUv:Qn&&L(re.iridescenceMap.channel),iridescenceThicknessMapUv:jt&&L(re.iridescenceThicknessMap.channel),sheenColorMapUv:Rn&&L(re.sheenColorMap.channel),sheenRoughnessMapUv:rr&&L(re.sheenRoughnessMap.channel),specularMapUv:Jn&&L(re.specularMap.channel),specularColorMapUv:_n&&L(re.specularColorMap.channel),specularIntensityMapUv:tr&&L(re.specularIntensityMap.channel),transmissionMapUv:je&&L(re.transmissionMap.channel),thicknessMapUv:yn&&L(re.thicknessMap.channel),alphaMapUv:wn&&L(re.alphaMap.channel),vertexTangents:!!st.attributes.tangent&&(Ar||Ci),vertexColors:re.vertexColors,vertexAlphas:re.vertexColors===!0&&!!st.attributes.color&&st.attributes.color.itemSize===4,pointsUvs:Be.isPoints===!0&&!!st.attributes.uv&&(Kr||wn),fog:!!tt,useFog:re.fog===!0,fogExp2:!!tt&&tt.isFogExp2,flatShading:re.flatShading===!0,sizeAttenuation:re.sizeAttenuation===!0,logarithmicDepthBuffer:x,reverseDepthBuffer:hn,skinning:Be.isSkinnedMesh===!0,morphTargets:st.morphAttributes.position!==void 0,morphNormals:st.morphAttributes.normal!==void 0,morphColors:st.morphAttributes.color!==void 0,morphTargetsCount:Pe,morphTextureStride:vt,numDirLights:se.directional.length,numPointLights:se.point.length,numSpotLights:se.spot.length,numSpotLightMaps:se.spotLightMap.length,numRectAreaLights:se.rectArea.length,numHemiLights:se.hemi.length,numDirLightShadows:se.directionalShadowMap.length,numPointLightShadows:se.pointShadowMap.length,numSpotLightShadows:se.spotShadowMap.length,numSpotLightShadowsWithMaps:se.numSpotLightShadowsWithMaps,numLightProbes:se.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:re.dithering,shadowMapEnabled:s.shadowMap.enabled&&q.length>0,shadowMapType:s.shadowMap.type,toneMapping:yr,decodeVideoTexture:Kr&&re.map.isVideoTexture===!0&&Gr.getTransfer(re.map.colorSpace)===Es,decodeVideoTextureEmissive:Yr&&re.emissiveMap.isVideoTexture===!0&&Gr.getTransfer(re.emissiveMap.colorSpace)===Es,premultipliedAlpha:re.premultipliedAlpha,doubleSided:re.side===gl,flipSided:re.side===Qo,useDepthPacking:re.depthPacking>=0,depthPacking:re.depthPacking||0,index0AttributeName:re.index0AttributeName,extensionClipCullDistance:kn&&re.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(kn&&re.extensions.multiDraw===!0||Fn)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:re.customProgramCacheKey()};return ki.vertexUv1s=p.has(1),ki.vertexUv2s=p.has(2),ki.vertexUv3s=p.has(3),p.clear(),ki}function A(re){const se=[];if(re.shaderID?se.push(re.shaderID):(se.push(re.customVertexShaderID),se.push(re.customFragmentShaderID)),re.defines!==void 0)for(const q in re.defines)se.push(q),se.push(re.defines[q]);return re.isRawShaderMaterial===!1&&(V(se,re),X(se,re),se.push(s.outputColorSpace)),se.push(re.customProgramCacheKey),se.join()}function V(re,se){re.push(se.precision),re.push(se.outputColorSpace),re.push(se.envMapMode),re.push(se.envMapCubeUVHeight),re.push(se.mapUv),re.push(se.alphaMapUv),re.push(se.lightMapUv),re.push(se.aoMapUv),re.push(se.bumpMapUv),re.push(se.normalMapUv),re.push(se.displacementMapUv),re.push(se.emissiveMapUv),re.push(se.metalnessMapUv),re.push(se.roughnessMapUv),re.push(se.anisotropyMapUv),re.push(se.clearcoatMapUv),re.push(se.clearcoatNormalMapUv),re.push(se.clearcoatRoughnessMapUv),re.push(se.iridescenceMapUv),re.push(se.iridescenceThicknessMapUv),re.push(se.sheenColorMapUv),re.push(se.sheenRoughnessMapUv),re.push(se.specularMapUv),re.push(se.specularColorMapUv),re.push(se.specularIntensityMapUv),re.push(se.transmissionMapUv),re.push(se.thicknessMapUv),re.push(se.combine),re.push(se.fogExp2),re.push(se.sizeAttenuation),re.push(se.morphTargetsCount),re.push(se.morphAttributeCount),re.push(se.numDirLights),re.push(se.numPointLights),re.push(se.numSpotLights),re.push(se.numSpotLightMaps),re.push(se.numHemiLights),re.push(se.numRectAreaLights),re.push(se.numDirLightShadows),re.push(se.numPointLightShadows),re.push(se.numSpotLightShadows),re.push(se.numSpotLightShadowsWithMaps),re.push(se.numLightProbes),re.push(se.shadowMapType),re.push(se.toneMapping),re.push(se.numClippingPlanes),re.push(se.numClipIntersection),re.push(se.depthPacking)}function X(re,se){c.disableAll(),se.supportsVertexTextures&&c.enable(0),se.instancing&&c.enable(1),se.instancingColor&&c.enable(2),se.instancingMorph&&c.enable(3),se.matcap&&c.enable(4),se.envMap&&c.enable(5),se.normalMapObjectSpace&&c.enable(6),se.normalMapTangentSpace&&c.enable(7),se.clearcoat&&c.enable(8),se.iridescence&&c.enable(9),se.alphaTest&&c.enable(10),se.vertexColors&&c.enable(11),se.vertexAlphas&&c.enable(12),se.vertexUv1s&&c.enable(13),se.vertexUv2s&&c.enable(14),se.vertexUv3s&&c.enable(15),se.vertexTangents&&c.enable(16),se.anisotropy&&c.enable(17),se.alphaHash&&c.enable(18),se.batching&&c.enable(19),se.dispersion&&c.enable(20),se.batchingColor&&c.enable(21),re.push(c.mask),c.disableAll(),se.fog&&c.enable(0),se.useFog&&c.enable(1),se.flatShading&&c.enable(2),se.logarithmicDepthBuffer&&c.enable(3),se.reverseDepthBuffer&&c.enable(4),se.skinning&&c.enable(5),se.morphTargets&&c.enable(6),se.morphNormals&&c.enable(7),se.morphColors&&c.enable(8),se.premultipliedAlpha&&c.enable(9),se.shadowMapEnabled&&c.enable(10),se.doubleSided&&c.enable(11),se.flipSided&&c.enable(12),se.useDepthPacking&&c.enable(13),se.dithering&&c.enable(14),se.transmission&&c.enable(15),se.sheen&&c.enable(16),se.opaque&&c.enable(17),se.pointsUvs&&c.enable(18),se.decodeVideoTexture&&c.enable(19),se.decodeVideoTextureEmissive&&c.enable(20),se.alphaToCoverage&&c.enable(21),re.push(c.mask)}function P(re){const se=I[re.type];let q;if(se){const De=v1[se];q=yIe.clone(De.uniforms)}else q=re.uniforms;return q}function te(re,se){let q;for(let De=0,Be=y.length;De<Be;De++){const tt=y[De];if(tt.cacheKey===se){q=tt,++q.usedTimes;break}}return q===void 0&&(q=new WLe(s,se,re,i),y.push(q)),q}function oe(re){if(--re.usedTimes===0){const se=y.indexOf(re);y[se]=y[y.length-1],y.pop(),re.destroy()}}function ie(re){u.remove(re)}function K(){u.dispose()}return{getParameters:B,getProgramCacheKey:A,getUniforms:P,acquireProgram:te,releaseProgram:oe,releaseShaderCache:ie,programs:y,dispose:K}}function KLe(){let s=new WeakMap;function e(a){return s.has(a)}function t(a){let c=s.get(a);return c===void 0&&(c={},s.set(a,c)),c}function n(a){s.delete(a)}function r(a,c,u){s.get(a)[c]=u}function i(){s=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:i}}function ZLe(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function F3e(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function B3e(){const s=[];let e=0;const t=[],n=[],r=[];function i(){e=0,t.length=0,n.length=0,r.length=0}function a(x,S,M,I,L,B){let A=s[e];return A===void 0?(A={id:x.id,object:x,geometry:S,material:M,groupOrder:I,renderOrder:x.renderOrder,z:L,group:B},s[e]=A):(A.id=x.id,A.object=x,A.geometry=S,A.material=M,A.groupOrder=I,A.renderOrder=x.renderOrder,A.z=L,A.group=B),e++,A}function c(x,S,M,I,L,B){const A=a(x,S,M,I,L,B);M.transmission>0?n.push(A):M.transparent===!0?r.push(A):t.push(A)}function u(x,S,M,I,L,B){const A=a(x,S,M,I,L,B);M.transmission>0?n.unshift(A):M.transparent===!0?r.unshift(A):t.unshift(A)}function p(x,S){t.length>1&&t.sort(x||ZLe),n.length>1&&n.sort(S||F3e),r.length>1&&r.sort(S||F3e)}function y(){for(let x=e,S=s.length;x<S;x++){const M=s[x];if(M.id===null)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.group=null}}return{opaque:t,transmissive:n,transparent:r,init:i,push:c,unshift:u,finish:y,sort:p}}function QLe(){let s=new WeakMap;function e(n,r){const i=s.get(n);let a;return i===void 0?(a=new B3e,s.set(n,[a])):r>=i.length?(a=new B3e,i.push(a)):a=i[r],a}function t(){s=new WeakMap}return{get:e,dispose:t}}function JLe(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ae,color:new Pn};break;case"SpotLight":t={position:new Ae,direction:new Ae,color:new Pn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ae,color:new Pn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ae,skyColor:new Pn,groundColor:new Pn};break;case"RectAreaLight":t={color:new Pn,position:new Ae,halfWidth:new Ae,halfHeight:new Ae};break}return s[e.id]=t,t}}}function eFe(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new An};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new An};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new An,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let tFe=0;function nFe(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function rFe(s){const e=new JLe,t=eFe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new Ae);const r=new Ae,i=new or,a=new or;function c(p){let y=0,x=0,S=0;for(let re=0;re<9;re++)n.probe[re].set(0,0,0);let M=0,I=0,L=0,B=0,A=0,V=0,X=0,P=0,te=0,oe=0,ie=0;p.sort(nFe);for(let re=0,se=p.length;re<se;re++){const q=p[re],De=q.color,Be=q.intensity,tt=q.distance,st=q.shadow&&q.shadow.map?q.shadow.map.texture:null;if(q.isAmbientLight)y+=De.r*Be,x+=De.g*Be,S+=De.b*Be;else if(q.isLightProbe){for(let de=0;de<9;de++)n.probe[de].addScaledVector(q.sh.coefficients[de],Be);ie++}else if(q.isDirectionalLight){const de=e.get(q);if(de.color.copy(q.color).multiplyScalar(q.intensity),q.castShadow){const ft=q.shadow,Se=t.get(q);Se.shadowIntensity=ft.intensity,Se.shadowBias=ft.bias,Se.shadowNormalBias=ft.normalBias,Se.shadowRadius=ft.radius,Se.shadowMapSize=ft.mapSize,n.directionalShadow[M]=Se,n.directionalShadowMap[M]=st,n.directionalShadowMatrix[M]=q.shadow.matrix,V++}n.directional[M]=de,M++}else if(q.isSpotLight){const de=e.get(q);de.position.setFromMatrixPosition(q.matrixWorld),de.color.copy(De).multiplyScalar(Be),de.distance=tt,de.coneCos=Math.cos(q.angle),de.penumbraCos=Math.cos(q.angle*(1-q.penumbra)),de.decay=q.decay,n.spot[L]=de;const ft=q.shadow;if(q.map&&(n.spotLightMap[te]=q.map,te++,ft.updateMatrices(q),q.castShadow&&oe++),n.spotLightMatrix[L]=ft.matrix,q.castShadow){const Se=t.get(q);Se.shadowIntensity=ft.intensity,Se.shadowBias=ft.bias,Se.shadowNormalBias=ft.normalBias,Se.shadowRadius=ft.radius,Se.shadowMapSize=ft.mapSize,n.spotShadow[L]=Se,n.spotShadowMap[L]=st,P++}L++}else if(q.isRectAreaLight){const de=e.get(q);de.color.copy(De).multiplyScalar(Be),de.halfWidth.set(q.width*.5,0,0),de.halfHeight.set(0,q.height*.5,0),n.rectArea[B]=de,B++}else if(q.isPointLight){const de=e.get(q);if(de.color.copy(q.color).multiplyScalar(q.intensity),de.distance=q.distance,de.decay=q.decay,q.castShadow){const ft=q.shadow,Se=t.get(q);Se.shadowIntensity=ft.intensity,Se.shadowBias=ft.bias,Se.shadowNormalBias=ft.normalBias,Se.shadowRadius=ft.radius,Se.shadowMapSize=ft.mapSize,Se.shadowCameraNear=ft.camera.near,Se.shadowCameraFar=ft.camera.far,n.pointShadow[I]=Se,n.pointShadowMap[I]=st,n.pointShadowMatrix[I]=q.shadow.matrix,X++}n.point[I]=de,I++}else if(q.isHemisphereLight){const de=e.get(q);de.skyColor.copy(q.color).multiplyScalar(Be),de.groundColor.copy(q.groundColor).multiplyScalar(Be),n.hemi[A]=de,A++}}B>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Mn.LTC_FLOAT_1,n.rectAreaLTC2=Mn.LTC_FLOAT_2):(n.rectAreaLTC1=Mn.LTC_HALF_1,n.rectAreaLTC2=Mn.LTC_HALF_2)),n.ambient[0]=y,n.ambient[1]=x,n.ambient[2]=S;const K=n.hash;(K.directionalLength!==M||K.pointLength!==I||K.spotLength!==L||K.rectAreaLength!==B||K.hemiLength!==A||K.numDirectionalShadows!==V||K.numPointShadows!==X||K.numSpotShadows!==P||K.numSpotMaps!==te||K.numLightProbes!==ie)&&(n.directional.length=M,n.spot.length=L,n.rectArea.length=B,n.point.length=I,n.hemi.length=A,n.directionalShadow.length=V,n.directionalShadowMap.length=V,n.pointShadow.length=X,n.pointShadowMap.length=X,n.spotShadow.length=P,n.spotShadowMap.length=P,n.directionalShadowMatrix.length=V,n.pointShadowMatrix.length=X,n.spotLightMatrix.length=P+te-oe,n.spotLightMap.length=te,n.numSpotLightShadowsWithMaps=oe,n.numLightProbes=ie,K.directionalLength=M,K.pointLength=I,K.spotLength=L,K.rectAreaLength=B,K.hemiLength=A,K.numDirectionalShadows=V,K.numPointShadows=X,K.numSpotShadows=P,K.numSpotMaps=te,K.numLightProbes=ie,n.version=tFe++)}function u(p,y){let x=0,S=0,M=0,I=0,L=0;const B=y.matrixWorldInverse;for(let A=0,V=p.length;A<V;A++){const X=p[A];if(X.isDirectionalLight){const P=n.directional[x];P.direction.setFromMatrixPosition(X.matrixWorld),r.setFromMatrixPosition(X.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(B),x++}else if(X.isSpotLight){const P=n.spot[M];P.position.setFromMatrixPosition(X.matrixWorld),P.position.applyMatrix4(B),P.direction.setFromMatrixPosition(X.matrixWorld),r.setFromMatrixPosition(X.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(B),M++}else if(X.isRectAreaLight){const P=n.rectArea[I];P.position.setFromMatrixPosition(X.matrixWorld),P.position.applyMatrix4(B),a.identity(),i.copy(X.matrixWorld),i.premultiply(B),a.extractRotation(i),P.halfWidth.set(X.width*.5,0,0),P.halfHeight.set(0,X.height*.5,0),P.halfWidth.applyMatrix4(a),P.halfHeight.applyMatrix4(a),I++}else if(X.isPointLight){const P=n.point[S];P.position.setFromMatrixPosition(X.matrixWorld),P.position.applyMatrix4(B),S++}else if(X.isHemisphereLight){const P=n.hemi[L];P.direction.setFromMatrixPosition(X.matrixWorld),P.direction.transformDirection(B),L++}}}return{setup:c,setupView:u,state:n}}function U3e(s){const e=new rFe(s),t=[],n=[];function r(y){p.camera=y,t.length=0,n.length=0}function i(y){t.push(y)}function a(y){n.push(y)}function c(){e.setup(t)}function u(y){e.setupView(t,y)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:c,setupLightsView:u,pushLight:i,pushShadow:a}}function iFe(s){let e=new WeakMap;function t(r,i=0){const a=e.get(r);let c;return a===void 0?(c=new U3e(s),e.set(r,[c])):i>=a.length?(c=new U3e(s),a.push(c)):c=a[i],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const sFe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,oFe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function aFe(s,e,t){let n=new VW;const r=new An,i=new An,a=new xi,c=new Tve({depthPacking:wRe}),u=new YIe,p={},y=t.maxTextureSize,x={[E1]:Qo,[Qo]:E1,[gl]:gl},S=new r0({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new An},radius:{value:4}},vertexShader:sFe,fragmentShader:oFe}),M=S.clone();M.defines.HORIZONTAL_PASS=1;const I=new rs;I.setAttribute("position",new Qu(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new mn(I,S),B=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=N8e;let A=this.type;this.render=function(oe,ie,K){if(B.enabled===!1||B.autoUpdate===!1&&B.needsUpdate===!1||oe.length===0)return;const re=s.getRenderTarget(),se=s.getActiveCubeFace(),q=s.getActiveMipmapLevel(),De=s.state;De.setBlending(cc),De.buffers.color.setClear(1,1,1,1),De.buffers.depth.setTest(!0),De.setScissorTest(!1);const Be=A!==Rg&&this.type===Rg,tt=A===Rg&&this.type!==Rg;for(let st=0,de=oe.length;st<de;st++){const ft=oe[st],Se=ft.shadow;if(Se===void 0){console.warn("THREE.WebGLShadowMap:",ft,"has no shadow.");continue}if(Se.autoUpdate===!1&&Se.needsUpdate===!1)continue;r.copy(Se.mapSize);const rt=Se.getFrameExtents();if(r.multiply(rt),i.copy(Se.mapSize),(r.x>y||r.y>y)&&(r.x>y&&(i.x=Math.floor(y/rt.x),r.x=i.x*rt.x,Se.mapSize.x=i.x),r.y>y&&(i.y=Math.floor(y/rt.y),r.y=i.y*rt.y,Se.mapSize.y=i.y)),Se.map===null||Be===!0||tt===!0){const Pe=this.type!==Rg?{minFilter:R0,magFilter:R0}:{};Se.map!==null&&Se.map.dispose(),Se.map=new bl(r.x,r.y,Pe),Se.map.texture.name=ft.name+".shadowMap",Se.camera.updateProjectionMatrix()}s.setRenderTarget(Se.map),s.clear();const ut=Se.getViewportCount();for(let Pe=0;Pe<ut;Pe++){const vt=Se.getViewport(Pe);a.set(i.x*vt.x,i.y*vt.y,i.x*vt.z,i.y*vt.w),De.viewport(a),Se.updateMatrices(ft,Pe),n=Se.getFrustum(),P(ie,K,Se.camera,ft,this.type)}Se.isPointLightShadow!==!0&&this.type===Rg&&V(Se,K),Se.needsUpdate=!1}A=this.type,B.needsUpdate=!1,s.setRenderTarget(re,se,q)};function V(oe,ie){const K=e.update(L);S.defines.VSM_SAMPLES!==oe.blurSamples&&(S.defines.VSM_SAMPLES=oe.blurSamples,M.defines.VSM_SAMPLES=oe.blurSamples,S.needsUpdate=!0,M.needsUpdate=!0),oe.mapPass===null&&(oe.mapPass=new bl(r.x,r.y)),S.uniforms.shadow_pass.value=oe.map.texture,S.uniforms.resolution.value=oe.mapSize,S.uniforms.radius.value=oe.radius,s.setRenderTarget(oe.mapPass),s.clear(),s.renderBufferDirect(ie,null,K,S,L,null),M.uniforms.shadow_pass.value=oe.mapPass.texture,M.uniforms.resolution.value=oe.mapSize,M.uniforms.radius.value=oe.radius,s.setRenderTarget(oe.map),s.clear(),s.renderBufferDirect(ie,null,K,M,L,null)}function X(oe,ie,K,re){let se=null;const q=K.isPointLight===!0?oe.customDistanceMaterial:oe.customDepthMaterial;if(q!==void 0)se=q;else if(se=K.isPointLight===!0?u:c,s.localClippingEnabled&&ie.clipShadows===!0&&Array.isArray(ie.clippingPlanes)&&ie.clippingPlanes.length!==0||ie.displacementMap&&ie.displacementScale!==0||ie.alphaMap&&ie.alphaTest>0||ie.map&&ie.alphaTest>0||ie.alphaToCoverage===!0){const De=se.uuid,Be=ie.uuid;let tt=p[De];tt===void 0&&(tt={},p[De]=tt);let st=tt[Be];st===void 0&&(st=se.clone(),tt[Be]=st,ie.addEventListener("dispose",te)),se=st}if(se.visible=ie.visible,se.wireframe=ie.wireframe,re===Rg?se.side=ie.shadowSide!==null?ie.shadowSide:ie.side:se.side=ie.shadowSide!==null?ie.shadowSide:x[ie.side],se.alphaMap=ie.alphaMap,se.alphaTest=ie.alphaToCoverage===!0?.5:ie.alphaTest,se.map=ie.map,se.clipShadows=ie.clipShadows,se.clippingPlanes=ie.clippingPlanes,se.clipIntersection=ie.clipIntersection,se.displacementMap=ie.displacementMap,se.displacementScale=ie.displacementScale,se.displacementBias=ie.displacementBias,se.wireframeLinewidth=ie.wireframeLinewidth,se.linewidth=ie.linewidth,K.isPointLight===!0&&se.isMeshDistanceMaterial===!0){const De=s.properties.get(se);De.light=K}return se}function P(oe,ie,K,re,se){if(oe.visible===!1)return;if(oe.layers.test(ie.layers)&&(oe.isMesh||oe.isLine||oe.isPoints)&&(oe.castShadow||oe.receiveShadow&&se===Rg)&&(!oe.frustumCulled||n.intersectsObject(oe))){oe.modelViewMatrix.multiplyMatrices(K.matrixWorldInverse,oe.matrixWorld);const Be=e.update(oe),tt=oe.material;if(Array.isArray(tt)){const st=Be.groups;for(let de=0,ft=st.length;de<ft;de++){const Se=st[de],rt=tt[Se.materialIndex];if(rt&&rt.visible){const ut=X(oe,rt,re,se);oe.onBeforeShadow(s,oe,ie,K,Be,ut,Se),s.renderBufferDirect(K,null,Be,ut,oe,Se),oe.onAfterShadow(s,oe,ie,K,Be,ut,Se)}}}else if(tt.visible){const st=X(oe,tt,re,se);oe.onBeforeShadow(s,oe,ie,K,Be,st,null),s.renderBufferDirect(K,null,Be,st,oe,null),oe.onAfterShadow(s,oe,ie,K,Be,st,null)}}const De=oe.children;for(let Be=0,tt=De.length;Be<tt;Be++)P(De[Be],ie,K,re,se)}function te(oe){oe.target.removeEventListener("dispose",te);for(const K in p){const re=p[K],se=oe.target.uuid;se in re&&(re[se].dispose(),delete re[se])}}}const lFe={[Lj]:Fj,[Bj]:Vj,[Uj]:Gj,[Ix]:zj,[Fj]:Lj,[Vj]:Bj,[Gj]:Uj,[zj]:Ix};function cFe(s,e){function t(){let je=!1;const yn=new xi;let Yt=null;const wn=new xi(0,0,0,0);return{setMask:function(tn){Yt!==tn&&!je&&(s.colorMask(tn,tn,tn,tn),Yt=tn)},setLocked:function(tn){je=tn},setClear:function(tn,Wt,kn,yr,ki){ki===!0&&(tn*=yr,Wt*=yr,kn*=yr),yn.set(tn,Wt,kn,yr),wn.equals(yn)===!1&&(s.clearColor(tn,Wt,kn,yr),wn.copy(yn))},reset:function(){je=!1,Yt=null,wn.set(-1,0,0,0)}}}function n(){let je=!1,yn=!1,Yt=null,wn=null,tn=null;return{setReversed:function(Wt){if(yn!==Wt){const kn=e.get("EXT_clip_control");Wt?kn.clipControlEXT(kn.LOWER_LEFT_EXT,kn.ZERO_TO_ONE_EXT):kn.clipControlEXT(kn.LOWER_LEFT_EXT,kn.NEGATIVE_ONE_TO_ONE_EXT),yn=Wt;const yr=tn;tn=null,this.setClear(yr)}},getReversed:function(){return yn},setTest:function(Wt){Wt?Gt(s.DEPTH_TEST):hn(s.DEPTH_TEST)},setMask:function(Wt){Yt!==Wt&&!je&&(s.depthMask(Wt),Yt=Wt)},setFunc:function(Wt){if(yn&&(Wt=lFe[Wt]),wn!==Wt){switch(Wt){case Lj:s.depthFunc(s.NEVER);break;case Fj:s.depthFunc(s.ALWAYS);break;case Bj:s.depthFunc(s.LESS);break;case Ix:s.depthFunc(s.LEQUAL);break;case Uj:s.depthFunc(s.EQUAL);break;case zj:s.depthFunc(s.GEQUAL);break;case Vj:s.depthFunc(s.GREATER);break;case Gj:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}wn=Wt}},setLocked:function(Wt){je=Wt},setClear:function(Wt){tn!==Wt&&(yn&&(Wt=1-Wt),s.clearDepth(Wt),tn=Wt)},reset:function(){je=!1,Yt=null,wn=null,tn=null,yn=!1}}}function r(){let je=!1,yn=null,Yt=null,wn=null,tn=null,Wt=null,kn=null,yr=null,ki=null;return{setTest:function(hr){je||(hr?Gt(s.STENCIL_TEST):hn(s.STENCIL_TEST))},setMask:function(hr){yn!==hr&&!je&&(s.stencilMask(hr),yn=hr)},setFunc:function(hr,Qi,Eo){(Yt!==hr||wn!==Qi||tn!==Eo)&&(s.stencilFunc(hr,Qi,Eo),Yt=hr,wn=Qi,tn=Eo)},setOp:function(hr,Qi,Eo){(Wt!==hr||kn!==Qi||yr!==Eo)&&(s.stencilOp(hr,Qi,Eo),Wt=hr,kn=Qi,yr=Eo)},setLocked:function(hr){je=hr},setClear:function(hr){ki!==hr&&(s.clearStencil(hr),ki=hr)},reset:function(){je=!1,yn=null,Yt=null,wn=null,tn=null,Wt=null,kn=null,yr=null,ki=null}}}const i=new t,a=new n,c=new r,u=new WeakMap,p=new WeakMap;let y={},x={},S=new WeakMap,M=[],I=null,L=!1,B=null,A=null,V=null,X=null,P=null,te=null,oe=null,ie=new Pn(0,0,0),K=0,re=!1,se=null,q=null,De=null,Be=null,tt=null;const st=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let de=!1,ft=0;const Se=s.getParameter(s.VERSION);Se.indexOf("WebGL")!==-1?(ft=parseFloat(/^WebGL (\d)/.exec(Se)[1]),de=ft>=1):Se.indexOf("OpenGL ES")!==-1&&(ft=parseFloat(/^OpenGL ES (\d)/.exec(Se)[1]),de=ft>=2);let rt=null,ut={};const Pe=s.getParameter(s.SCISSOR_BOX),vt=s.getParameter(s.VIEWPORT),Bt=new xi().fromArray(Pe),ct=new xi().fromArray(vt);function Pt(je,yn,Yt,wn){const tn=new Uint8Array(4),Wt=s.createTexture();s.bindTexture(je,Wt),s.texParameteri(je,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(je,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let kn=0;kn<Yt;kn++)je===s.TEXTURE_3D||je===s.TEXTURE_2D_ARRAY?s.texImage3D(yn,0,s.RGBA,1,1,wn,0,s.RGBA,s.UNSIGNED_BYTE,tn):s.texImage2D(yn+kn,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,tn);return Wt}const on={};on[s.TEXTURE_2D]=Pt(s.TEXTURE_2D,s.TEXTURE_2D,1),on[s.TEXTURE_CUBE_MAP]=Pt(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),on[s.TEXTURE_2D_ARRAY]=Pt(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),on[s.TEXTURE_3D]=Pt(s.TEXTURE_3D,s.TEXTURE_3D,1,1),i.setClear(0,0,0,1),a.setClear(1),c.setClear(0),Gt(s.DEPTH_TEST),a.setFunc(Ix),ei(!1),Ar(v9e),Gt(s.CULL_FACE),Ue(cc);function Gt(je){y[je]!==!0&&(s.enable(je),y[je]=!0)}function hn(je){y[je]!==!1&&(s.disable(je),y[je]=!1)}function Xn(je,yn){return x[je]!==yn?(s.bindFramebuffer(je,yn),x[je]=yn,je===s.DRAW_FRAMEBUFFER&&(x[s.FRAMEBUFFER]=yn),je===s.FRAMEBUFFER&&(x[s.DRAW_FRAMEBUFFER]=yn),!0):!1}function Fn(je,yn){let Yt=M,wn=!1;if(je){Yt=S.get(yn),Yt===void 0&&(Yt=[],S.set(yn,Yt));const tn=je.textures;if(Yt.length!==tn.length||Yt[0]!==s.COLOR_ATTACHMENT0){for(let Wt=0,kn=tn.length;Wt<kn;Wt++)Yt[Wt]=s.COLOR_ATTACHMENT0+Wt;Yt.length=tn.length,wn=!0}}else Yt[0]!==s.BACK&&(Yt[0]=s.BACK,wn=!0);wn&&s.drawBuffers(Yt)}function Kr(je){return I!==je?(s.useProgram(je),I=je,!0):!1}const Mi={[L3]:s.FUNC_ADD,[O8e]:s.FUNC_SUBTRACT,[L8e]:s.FUNC_REVERSE_SUBTRACT};Mi[F8e]=s.MIN,Mi[B8e]=s.MAX;const Br={[mW]:s.ZERO,[gW]:s.ONE,[vW]:s.SRC_COLOR,[mE]:s.SRC_ALPHA,[U8e]:s.SRC_ALPHA_SATURATE,[bW]:s.DST_COLOR,[xW]:s.DST_ALPHA,[yW]:s.ONE_MINUS_SRC_COLOR,[gE]:s.ONE_MINUS_SRC_ALPHA,[SW]:s.ONE_MINUS_DST_COLOR,[_W]:s.ONE_MINUS_DST_ALPHA,[wW]:s.CONSTANT_COLOR,[EW]:s.ONE_MINUS_CONSTANT_COLOR,[TW]:s.CONSTANT_ALPHA,[MW]:s.ONE_MINUS_CONSTANT_ALPHA};function Ue(je,yn,Yt,wn,tn,Wt,kn,yr,ki,hr){if(je===cc){L===!0&&(hn(s.BLEND),L=!1);return}if(L===!1&&(Gt(s.BLEND),L=!0),je!==D8e){if(je!==B||hr!==re){if((A!==L3||P!==L3)&&(s.blendEquation(s.FUNC_ADD),A=L3,P=L3),hr)switch(je){case xv:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case Nj:s.blendFunc(s.ONE,s.ONE);break;case Dj:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case Oj:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",je);break}else switch(je){case xv:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case Nj:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case Dj:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case Oj:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",je);break}V=null,X=null,te=null,oe=null,ie.set(0,0,0),K=0,B=je,re=hr}return}tn=tn||yn,Wt=Wt||Yt,kn=kn||wn,(yn!==A||tn!==P)&&(s.blendEquationSeparate(Mi[yn],Mi[tn]),A=yn,P=tn),(Yt!==V||wn!==X||Wt!==te||kn!==oe)&&(s.blendFuncSeparate(Br[Yt],Br[wn],Br[Wt],Br[kn]),V=Yt,X=wn,te=Wt,oe=kn),(yr.equals(ie)===!1||ki!==K)&&(s.blendColor(yr.r,yr.g,yr.b,ki),ie.copy(yr),K=ki),B=je,re=!1}function Ii(je,yn){je.side===gl?hn(s.CULL_FACE):Gt(s.CULL_FACE);let Yt=je.side===Qo;yn&&(Yt=!Yt),ei(Yt),je.blending===xv&&je.transparent===!1?Ue(cc):Ue(je.blending,je.blendEquation,je.blendSrc,je.blendDst,je.blendEquationAlpha,je.blendSrcAlpha,je.blendDstAlpha,je.blendColor,je.blendAlpha,je.premultipliedAlpha),a.setFunc(je.depthFunc),a.setTest(je.depthTest),a.setMask(je.depthWrite),i.setMask(je.colorWrite);const wn=je.stencilWrite;c.setTest(wn),wn&&(c.setMask(je.stencilWriteMask),c.setFunc(je.stencilFunc,je.stencilRef,je.stencilFuncMask),c.setOp(je.stencilFail,je.stencilZFail,je.stencilZPass)),Yr(je.polygonOffset,je.polygonOffsetFactor,je.polygonOffsetUnits),je.alphaToCoverage===!0?Gt(s.SAMPLE_ALPHA_TO_COVERAGE):hn(s.SAMPLE_ALPHA_TO_COVERAGE)}function ei(je){se!==je&&(je?s.frontFace(s.CW):s.frontFace(s.CCW),se=je)}function Ar(je){je!==dRe?(Gt(s.CULL_FACE),je!==q&&(je===v9e?s.cullFace(s.BACK):je===fRe?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):hn(s.CULL_FACE),q=je}function On(je){je!==De&&(de&&s.lineWidth(je),De=je)}function Yr(je,yn,Yt){je?(Gt(s.POLYGON_OFFSET_FILL),(Be!==yn||tt!==Yt)&&(s.polygonOffset(yn,Yt),Be=yn,tt=Yt)):hn(s.POLYGON_OFFSET_FILL)}function Yn(je){je?Gt(s.SCISSOR_TEST):hn(s.SCISSOR_TEST)}function vr(je){je===void 0&&(je=s.TEXTURE0+st-1),rt!==je&&(s.activeTexture(je),rt=je)}function Ci(je,yn,Yt){Yt===void 0&&(rt===null?Yt=s.TEXTURE0+st-1:Yt=rt);let wn=ut[Yt];wn===void 0&&(wn={type:void 0,texture:void 0},ut[Yt]=wn),(wn.type!==je||wn.texture!==yn)&&(rt!==Yt&&(s.activeTexture(Yt),rt=Yt),s.bindTexture(je,yn||on[je]),wn.type=je,wn.texture=yn)}function Ie(){const je=ut[rt];je!==void 0&&je.type!==void 0&&(s.bindTexture(je.type,null),je.type=void 0,je.texture=void 0)}function pe(){try{s.compressedTexImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function wt(){try{s.compressedTexImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Vt(){try{s.texSubImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function qt(){try{s.texSubImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ot(){try{s.compressedTexSubImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Kn(){try{s.compressedTexSubImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function vn(){try{s.texStorage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ln(){try{s.texStorage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Qn(){try{s.texImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function jt(){try{s.texImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Rn(je){Bt.equals(je)===!1&&(s.scissor(je.x,je.y,je.z,je.w),Bt.copy(je))}function rr(je){ct.equals(je)===!1&&(s.viewport(je.x,je.y,je.z,je.w),ct.copy(je))}function Jn(je,yn){let Yt=p.get(yn);Yt===void 0&&(Yt=new WeakMap,p.set(yn,Yt));let wn=Yt.get(je);wn===void 0&&(wn=s.getUniformBlockIndex(yn,je.name),Yt.set(je,wn))}function _n(je,yn){const wn=p.get(yn).get(je);u.get(yn)!==wn&&(s.uniformBlockBinding(yn,wn,je.__bindingPointIndex),u.set(yn,wn))}function tr(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),a.setReversed(!1),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),y={},rt=null,ut={},x={},S=new WeakMap,M=[],I=null,L=!1,B=null,A=null,V=null,X=null,P=null,te=null,oe=null,ie=new Pn(0,0,0),K=0,re=!1,se=null,q=null,De=null,Be=null,tt=null,Bt.set(0,0,s.canvas.width,s.canvas.height),ct.set(0,0,s.canvas.width,s.canvas.height),i.reset(),a.reset(),c.reset()}return{buffers:{color:i,depth:a,stencil:c},enable:Gt,disable:hn,bindFramebuffer:Xn,drawBuffers:Fn,useProgram:Kr,setBlending:Ue,setMaterial:Ii,setFlipSided:ei,setCullFace:Ar,setLineWidth:On,setPolygonOffset:Yr,setScissorTest:Yn,activeTexture:vr,bindTexture:Ci,unbindTexture:Ie,compressedTexImage2D:pe,compressedTexImage3D:wt,texImage2D:Qn,texImage3D:jt,updateUBOMapping:Jn,uniformBlockBinding:_n,texStorage2D:vn,texStorage3D:Ln,texSubImage2D:Vt,texSubImage3D:qt,compressedTexSubImage2D:Ot,compressedTexSubImage3D:Kn,scissor:Rn,viewport:rr,reset:tr}}function uFe(s,e,t,n,r,i,a){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new An,y=new WeakMap;let x;const S=new WeakMap;let M=!1;try{M=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function I(Ie,pe){return M?new OffscreenCanvas(Ie,pe):xE("canvas")}function L(Ie,pe,wt){let Vt=1;const qt=Ci(Ie);if((qt.width>wt||qt.height>wt)&&(Vt=wt/Math.max(qt.width,qt.height)),Vt<1)if(typeof HTMLImageElement<"u"&&Ie instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ie instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ie instanceof ImageBitmap||typeof VideoFrame<"u"&&Ie instanceof VideoFrame){const Ot=Math.floor(Vt*qt.width),Kn=Math.floor(Vt*qt.height);x===void 0&&(x=I(Ot,Kn));const vn=pe?I(Ot,Kn):x;return vn.width=Ot,vn.height=Kn,vn.getContext("2d").drawImage(Ie,0,0,Ot,Kn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+qt.width+"x"+qt.height+") to ("+Ot+"x"+Kn+")."),vn}else return"data"in Ie&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+qt.width+"x"+qt.height+")."),Ie;return Ie}function B(Ie){return Ie.generateMipmaps}function A(Ie){s.generateMipmap(Ie)}function V(Ie){return Ie.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:Ie.isWebGL3DRenderTarget?s.TEXTURE_3D:Ie.isWebGLArrayRenderTarget||Ie.isCompressedArrayTexture?s.TEXTURE_2D_ARRAY:s.TEXTURE_2D}function X(Ie,pe,wt,Vt,qt=!1){if(Ie!==null){if(s[Ie]!==void 0)return s[Ie];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ie+"'")}let Ot=pe;if(pe===s.RED&&(wt===s.FLOAT&&(Ot=s.R32F),wt===s.HALF_FLOAT&&(Ot=s.R16F),wt===s.UNSIGNED_BYTE&&(Ot=s.R8)),pe===s.RED_INTEGER&&(wt===s.UNSIGNED_BYTE&&(Ot=s.R8UI),wt===s.UNSIGNED_SHORT&&(Ot=s.R16UI),wt===s.UNSIGNED_INT&&(Ot=s.R32UI),wt===s.BYTE&&(Ot=s.R8I),wt===s.SHORT&&(Ot=s.R16I),wt===s.INT&&(Ot=s.R32I)),pe===s.RG&&(wt===s.FLOAT&&(Ot=s.RG32F),wt===s.HALF_FLOAT&&(Ot=s.RG16F),wt===s.UNSIGNED_BYTE&&(Ot=s.RG8)),pe===s.RG_INTEGER&&(wt===s.UNSIGNED_BYTE&&(Ot=s.RG8UI),wt===s.UNSIGNED_SHORT&&(Ot=s.RG16UI),wt===s.UNSIGNED_INT&&(Ot=s.RG32UI),wt===s.BYTE&&(Ot=s.RG8I),wt===s.SHORT&&(Ot=s.RG16I),wt===s.INT&&(Ot=s.RG32I)),pe===s.RGB_INTEGER&&(wt===s.UNSIGNED_BYTE&&(Ot=s.RGB8UI),wt===s.UNSIGNED_SHORT&&(Ot=s.RGB16UI),wt===s.UNSIGNED_INT&&(Ot=s.RGB32UI),wt===s.BYTE&&(Ot=s.RGB8I),wt===s.SHORT&&(Ot=s.RGB16I),wt===s.INT&&(Ot=s.RGB32I)),pe===s.RGBA_INTEGER&&(wt===s.UNSIGNED_BYTE&&(Ot=s.RGBA8UI),wt===s.UNSIGNED_SHORT&&(Ot=s.RGBA16UI),wt===s.UNSIGNED_INT&&(Ot=s.RGBA32UI),wt===s.BYTE&&(Ot=s.RGBA8I),wt===s.SHORT&&(Ot=s.RGBA16I),wt===s.INT&&(Ot=s.RGBA32I)),pe===s.RGB&&wt===s.UNSIGNED_INT_5_9_9_9_REV&&(Ot=s.RGB9_E5),pe===s.RGBA){const Kn=qt?uk:Gr.getTransfer(Vt);wt===s.FLOAT&&(Ot=s.RGBA32F),wt===s.HALF_FLOAT&&(Ot=s.RGBA16F),wt===s.UNSIGNED_BYTE&&(Ot=Kn===Es?s.SRGB8_ALPHA8:s.RGBA8),wt===s.UNSIGNED_SHORT_4_4_4_4&&(Ot=s.RGBA4),wt===s.UNSIGNED_SHORT_5_5_5_1&&(Ot=s.RGB5_A1)}return(Ot===s.R16F||Ot===s.R32F||Ot===s.RG16F||Ot===s.RG32F||Ot===s.RGBA16F||Ot===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Ot}function P(Ie,pe){let wt;return Ie?pe===null||pe===H3||pe===Dx?wt=s.DEPTH24_STENCIL8:pe===ed?wt=s.DEPTH32F_STENCIL8:pe===vE&&(wt=s.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):pe===null||pe===H3||pe===Dx?wt=s.DEPTH_COMPONENT24:pe===ed?wt=s.DEPTH_COMPONENT32F:pe===vE&&(wt=s.DEPTH_COMPONENT16),wt}function te(Ie,pe){return B(Ie)===!0||Ie.isFramebufferTexture&&Ie.minFilter!==R0&&Ie.minFilter!==e0?Math.log2(Math.max(pe.width,pe.height))+1:Ie.mipmaps!==void 0&&Ie.mipmaps.length>0?Ie.mipmaps.length:Ie.isCompressedTexture&&Array.isArray(Ie.image)?pe.mipmaps.length:1}function oe(Ie){const pe=Ie.target;pe.removeEventListener("dispose",oe),K(pe),pe.isVideoTexture&&y.delete(pe)}function ie(Ie){const pe=Ie.target;pe.removeEventListener("dispose",ie),se(pe)}function K(Ie){const pe=n.get(Ie);if(pe.__webglInit===void 0)return;const wt=Ie.source,Vt=S.get(wt);if(Vt){const qt=Vt[pe.__cacheKey];qt.usedTimes--,qt.usedTimes===0&&re(Ie),Object.keys(Vt).length===0&&S.delete(wt)}n.remove(Ie)}function re(Ie){const pe=n.get(Ie);s.deleteTexture(pe.__webglTexture);const wt=Ie.source,Vt=S.get(wt);delete Vt[pe.__cacheKey],a.memory.textures--}function se(Ie){const pe=n.get(Ie);if(Ie.depthTexture&&(Ie.depthTexture.dispose(),n.remove(Ie.depthTexture)),Ie.isWebGLCubeRenderTarget)for(let Vt=0;Vt<6;Vt++){if(Array.isArray(pe.__webglFramebuffer[Vt]))for(let qt=0;qt<pe.__webglFramebuffer[Vt].length;qt++)s.deleteFramebuffer(pe.__webglFramebuffer[Vt][qt]);else s.deleteFramebuffer(pe.__webglFramebuffer[Vt]);pe.__webglDepthbuffer&&s.deleteRenderbuffer(pe.__webglDepthbuffer[Vt])}else{if(Array.isArray(pe.__webglFramebuffer))for(let Vt=0;Vt<pe.__webglFramebuffer.length;Vt++)s.deleteFramebuffer(pe.__webglFramebuffer[Vt]);else s.deleteFramebuffer(pe.__webglFramebuffer);if(pe.__webglDepthbuffer&&s.deleteRenderbuffer(pe.__webglDepthbuffer),pe.__webglMultisampledFramebuffer&&s.deleteFramebuffer(pe.__webglMultisampledFramebuffer),pe.__webglColorRenderbuffer)for(let Vt=0;Vt<pe.__webglColorRenderbuffer.length;Vt++)pe.__webglColorRenderbuffer[Vt]&&s.deleteRenderbuffer(pe.__webglColorRenderbuffer[Vt]);pe.__webglDepthRenderbuffer&&s.deleteRenderbuffer(pe.__webglDepthRenderbuffer)}const wt=Ie.textures;for(let Vt=0,qt=wt.length;Vt<qt;Vt++){const Ot=n.get(wt[Vt]);Ot.__webglTexture&&(s.deleteTexture(Ot.__webglTexture),a.memory.textures--),n.remove(wt[Vt])}n.remove(Ie)}let q=0;function De(){q=0}function Be(){const Ie=q;return Ie>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ie+" texture units while this GPU supports only "+r.maxTextures),q+=1,Ie}function tt(Ie){const pe=[];return pe.push(Ie.wrapS),pe.push(Ie.wrapT),pe.push(Ie.wrapR||0),pe.push(Ie.magFilter),pe.push(Ie.minFilter),pe.push(Ie.anisotropy),pe.push(Ie.internalFormat),pe.push(Ie.format),pe.push(Ie.type),pe.push(Ie.generateMipmaps),pe.push(Ie.premultiplyAlpha),pe.push(Ie.flipY),pe.push(Ie.unpackAlignment),pe.push(Ie.colorSpace),pe.join()}function st(Ie,pe){const wt=n.get(Ie);if(Ie.isVideoTexture&&Yn(Ie),Ie.isRenderTargetTexture===!1&&Ie.version>0&&wt.__version!==Ie.version){const Vt=Ie.image;if(Vt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Vt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{on(wt,Ie,pe);return}}t.bindTexture(s.TEXTURE_2D,wt.__webglTexture,s.TEXTURE0+pe)}function de(Ie,pe){const wt=n.get(Ie);if(Ie.version>0&&wt.__version!==Ie.version){on(wt,Ie,pe);return}t.bindTexture(s.TEXTURE_2D_ARRAY,wt.__webglTexture,s.TEXTURE0+pe)}function ft(Ie,pe){const wt=n.get(Ie);if(Ie.version>0&&wt.__version!==Ie.version){on(wt,Ie,pe);return}t.bindTexture(s.TEXTURE_3D,wt.__webglTexture,s.TEXTURE0+pe)}function Se(Ie,pe){const wt=n.get(Ie);if(Ie.version>0&&wt.__version!==Ie.version){Gt(wt,Ie,pe);return}t.bindTexture(s.TEXTURE_CUBE_MAP,wt.__webglTexture,s.TEXTURE0+pe)}const rt={[Wg]:s.REPEAT,[C0]:s.CLAMP_TO_EDGE,[Hj]:s.MIRRORED_REPEAT},ut={[R0]:s.NEAREST,[yRe]:s.NEAREST_MIPMAP_NEAREST,[gR]:s.NEAREST_MIPMAP_LINEAR,[e0]:s.LINEAR,[hV]:s.LINEAR_MIPMAP_NEAREST,[mv]:s.LINEAR_MIPMAP_LINEAR},Pe={[TRe]:s.NEVER,[IRe]:s.ALWAYS,[MRe]:s.LESS,[tve]:s.LEQUAL,[CRe]:s.EQUAL,[RRe]:s.GEQUAL,[ARe]:s.GREATER,[PRe]:s.NOTEQUAL};function vt(Ie,pe){if(pe.type===ed&&e.has("OES_texture_float_linear")===!1&&(pe.magFilter===e0||pe.magFilter===hV||pe.magFilter===gR||pe.magFilter===mv||pe.minFilter===e0||pe.minFilter===hV||pe.minFilter===gR||pe.minFilter===mv)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(Ie,s.TEXTURE_WRAP_S,rt[pe.wrapS]),s.texParameteri(Ie,s.TEXTURE_WRAP_T,rt[pe.wrapT]),(Ie===s.TEXTURE_3D||Ie===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Ie,s.TEXTURE_WRAP_R,rt[pe.wrapR]),s.texParameteri(Ie,s.TEXTURE_MAG_FILTER,ut[pe.magFilter]),s.texParameteri(Ie,s.TEXTURE_MIN_FILTER,ut[pe.minFilter]),pe.compareFunction&&(s.texParameteri(Ie,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(Ie,s.TEXTURE_COMPARE_FUNC,Pe[pe.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(pe.magFilter===R0||pe.minFilter!==gR&&pe.minFilter!==mv||pe.type===ed&&e.has("OES_texture_float_linear")===!1)return;if(pe.anisotropy>1||n.get(pe).__currentAnisotropy){const wt=e.get("EXT_texture_filter_anisotropic");s.texParameterf(Ie,wt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(pe.anisotropy,r.getMaxAnisotropy())),n.get(pe).__currentAnisotropy=pe.anisotropy}}}function Bt(Ie,pe){let wt=!1;Ie.__webglInit===void 0&&(Ie.__webglInit=!0,pe.addEventListener("dispose",oe));const Vt=pe.source;let qt=S.get(Vt);qt===void 0&&(qt={},S.set(Vt,qt));const Ot=tt(pe);if(Ot!==Ie.__cacheKey){qt[Ot]===void 0&&(qt[Ot]={texture:s.createTexture(),usedTimes:0},a.memory.textures++,wt=!0),qt[Ot].usedTimes++;const Kn=qt[Ie.__cacheKey];Kn!==void 0&&(qt[Ie.__cacheKey].usedTimes--,Kn.usedTimes===0&&re(pe)),Ie.__cacheKey=Ot,Ie.__webglTexture=qt[Ot].texture}return wt}function ct(Ie,pe,wt){return Math.floor(Math.floor(Ie/wt)/pe)}function Pt(Ie,pe,wt,Vt){const Ot=Ie.updateRanges;if(Ot.length===0)t.texSubImage2D(s.TEXTURE_2D,0,0,0,pe.width,pe.height,wt,Vt,pe.data);else{Ot.sort((jt,Rn)=>jt.start-Rn.start);let Kn=0;for(let jt=1;jt<Ot.length;jt++){const Rn=Ot[Kn],rr=Ot[jt],Jn=Rn.start+Rn.count,_n=ct(rr.start,pe.width,4),tr=ct(Rn.start,pe.width,4);rr.start<=Jn+1&&_n===tr&&ct(rr.start+rr.count-1,pe.width,4)===_n?Rn.count=Math.max(Rn.count,rr.start+rr.count-Rn.start):(++Kn,Ot[Kn]=rr)}Ot.length=Kn+1;const vn=s.getParameter(s.UNPACK_ROW_LENGTH),Ln=s.getParameter(s.UNPACK_SKIP_PIXELS),Qn=s.getParameter(s.UNPACK_SKIP_ROWS);s.pixelStorei(s.UNPACK_ROW_LENGTH,pe.width);for(let jt=0,Rn=Ot.length;jt<Rn;jt++){const rr=Ot[jt],Jn=Math.floor(rr.start/4),_n=Math.ceil(rr.count/4),tr=Jn%pe.width,je=Math.floor(Jn/pe.width),yn=_n,Yt=1;s.pixelStorei(s.UNPACK_SKIP_PIXELS,tr),s.pixelStorei(s.UNPACK_SKIP_ROWS,je),t.texSubImage2D(s.TEXTURE_2D,0,tr,je,yn,Yt,wt,Vt,pe.data)}Ie.clearUpdateRanges(),s.pixelStorei(s.UNPACK_ROW_LENGTH,vn),s.pixelStorei(s.UNPACK_SKIP_PIXELS,Ln),s.pixelStorei(s.UNPACK_SKIP_ROWS,Qn)}}function on(Ie,pe,wt){let Vt=s.TEXTURE_2D;(pe.isDataArrayTexture||pe.isCompressedArrayTexture)&&(Vt=s.TEXTURE_2D_ARRAY),pe.isData3DTexture&&(Vt=s.TEXTURE_3D);const qt=Bt(Ie,pe),Ot=pe.source;t.bindTexture(Vt,Ie.__webglTexture,s.TEXTURE0+wt);const Kn=n.get(Ot);if(Ot.version!==Kn.__version||qt===!0){t.activeTexture(s.TEXTURE0+wt);const vn=Gr.getPrimaries(Gr.workingColorSpace),Ln=pe.colorSpace===kf?null:Gr.getPrimaries(pe.colorSpace),Qn=pe.colorSpace===kf||vn===Ln?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,pe.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pe.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,pe.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qn);let jt=L(pe.image,!1,r.maxTextureSize);jt=vr(pe,jt);const Rn=i.convert(pe.format,pe.colorSpace),rr=i.convert(pe.type);let Jn=X(pe.internalFormat,Rn,rr,pe.colorSpace,pe.isVideoTexture);vt(Vt,pe);let _n;const tr=pe.mipmaps,je=pe.isVideoTexture!==!0,yn=Kn.__version===void 0||qt===!0,Yt=Ot.dataReady,wn=te(pe,jt);if(pe.isDepthTexture)Jn=P(pe.format===Ox,pe.type),yn&&(je?t.texStorage2D(s.TEXTURE_2D,1,Jn,jt.width,jt.height):t.texImage2D(s.TEXTURE_2D,0,Jn,jt.width,jt.height,0,Rn,rr,null));else if(pe.isDataTexture)if(tr.length>0){je&&yn&&t.texStorage2D(s.TEXTURE_2D,wn,Jn,tr[0].width,tr[0].height);for(let tn=0,Wt=tr.length;tn<Wt;tn++)_n=tr[tn],je?Yt&&t.texSubImage2D(s.TEXTURE_2D,tn,0,0,_n.width,_n.height,Rn,rr,_n.data):t.texImage2D(s.TEXTURE_2D,tn,Jn,_n.width,_n.height,0,Rn,rr,_n.data);pe.generateMipmaps=!1}else je?(yn&&t.texStorage2D(s.TEXTURE_2D,wn,Jn,jt.width,jt.height),Yt&&Pt(pe,jt,Rn,rr)):t.texImage2D(s.TEXTURE_2D,0,Jn,jt.width,jt.height,0,Rn,rr,jt.data);else if(pe.isCompressedTexture)if(pe.isCompressedArrayTexture){je&&yn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,wn,Jn,tr[0].width,tr[0].height,jt.depth);for(let tn=0,Wt=tr.length;tn<Wt;tn++)if(_n=tr[tn],pe.format!==yl)if(Rn!==null)if(je){if(Yt)if(pe.layerUpdates.size>0){const kn=m3e(_n.width,_n.height,pe.format,pe.type);for(const yr of pe.layerUpdates){const ki=_n.data.subarray(yr*kn/_n.data.BYTES_PER_ELEMENT,(yr+1)*kn/_n.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,tn,0,0,yr,_n.width,_n.height,1,Rn,ki)}pe.clearLayerUpdates()}else t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,tn,0,0,0,_n.width,_n.height,jt.depth,Rn,_n.data)}else t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,tn,Jn,_n.width,_n.height,jt.depth,0,_n.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else je?Yt&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,tn,0,0,0,_n.width,_n.height,jt.depth,Rn,rr,_n.data):t.texImage3D(s.TEXTURE_2D_ARRAY,tn,Jn,_n.width,_n.height,jt.depth,0,Rn,rr,_n.data)}else{je&&yn&&t.texStorage2D(s.TEXTURE_2D,wn,Jn,tr[0].width,tr[0].height);for(let tn=0,Wt=tr.length;tn<Wt;tn++)_n=tr[tn],pe.format!==yl?Rn!==null?je?Yt&&t.compressedTexSubImage2D(s.TEXTURE_2D,tn,0,0,_n.width,_n.height,Rn,_n.data):t.compressedTexImage2D(s.TEXTURE_2D,tn,Jn,_n.width,_n.height,0,_n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):je?Yt&&t.texSubImage2D(s.TEXTURE_2D,tn,0,0,_n.width,_n.height,Rn,rr,_n.data):t.texImage2D(s.TEXTURE_2D,tn,Jn,_n.width,_n.height,0,Rn,rr,_n.data)}else if(pe.isDataArrayTexture)if(je){if(yn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,wn,Jn,jt.width,jt.height,jt.depth),Yt)if(pe.layerUpdates.size>0){const tn=m3e(jt.width,jt.height,pe.format,pe.type);for(const Wt of pe.layerUpdates){const kn=jt.data.subarray(Wt*tn/jt.data.BYTES_PER_ELEMENT,(Wt+1)*tn/jt.data.BYTES_PER_ELEMENT);t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,Wt,jt.width,jt.height,1,Rn,rr,kn)}pe.clearLayerUpdates()}else t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,jt.width,jt.height,jt.depth,Rn,rr,jt.data)}else t.texImage3D(s.TEXTURE_2D_ARRAY,0,Jn,jt.width,jt.height,jt.depth,0,Rn,rr,jt.data);else if(pe.isData3DTexture)je?(yn&&t.texStorage3D(s.TEXTURE_3D,wn,Jn,jt.width,jt.height,jt.depth),Yt&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,jt.width,jt.height,jt.depth,Rn,rr,jt.data)):t.texImage3D(s.TEXTURE_3D,0,Jn,jt.width,jt.height,jt.depth,0,Rn,rr,jt.data);else if(pe.isFramebufferTexture){if(yn)if(je)t.texStorage2D(s.TEXTURE_2D,wn,Jn,jt.width,jt.height);else{let tn=jt.width,Wt=jt.height;for(let kn=0;kn<wn;kn++)t.texImage2D(s.TEXTURE_2D,kn,Jn,tn,Wt,0,Rn,rr,null),tn>>=1,Wt>>=1}}else if(tr.length>0){if(je&&yn){const tn=Ci(tr[0]);t.texStorage2D(s.TEXTURE_2D,wn,Jn,tn.width,tn.height)}for(let tn=0,Wt=tr.length;tn<Wt;tn++)_n=tr[tn],je?Yt&&t.texSubImage2D(s.TEXTURE_2D,tn,0,0,Rn,rr,_n):t.texImage2D(s.TEXTURE_2D,tn,Jn,Rn,rr,_n);pe.generateMipmaps=!1}else if(je){if(yn){const tn=Ci(jt);t.texStorage2D(s.TEXTURE_2D,wn,Jn,tn.width,tn.height)}Yt&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,Rn,rr,jt)}else t.texImage2D(s.TEXTURE_2D,0,Jn,Rn,rr,jt);B(pe)&&A(Vt),Kn.__version=Ot.version,pe.onUpdate&&pe.onUpdate(pe)}Ie.__version=pe.version}function Gt(Ie,pe,wt){if(pe.image.length!==6)return;const Vt=Bt(Ie,pe),qt=pe.source;t.bindTexture(s.TEXTURE_CUBE_MAP,Ie.__webglTexture,s.TEXTURE0+wt);const Ot=n.get(qt);if(qt.version!==Ot.__version||Vt===!0){t.activeTexture(s.TEXTURE0+wt);const Kn=Gr.getPrimaries(Gr.workingColorSpace),vn=pe.colorSpace===kf?null:Gr.getPrimaries(pe.colorSpace),Ln=pe.colorSpace===kf||Kn===vn?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,pe.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pe.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,pe.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ln);const Qn=pe.isCompressedTexture||pe.image[0].isCompressedTexture,jt=pe.image[0]&&pe.image[0].isDataTexture,Rn=[];for(let Wt=0;Wt<6;Wt++)!Qn&&!jt?Rn[Wt]=L(pe.image[Wt],!0,r.maxCubemapSize):Rn[Wt]=jt?pe.image[Wt].image:pe.image[Wt],Rn[Wt]=vr(pe,Rn[Wt]);const rr=Rn[0],Jn=i.convert(pe.format,pe.colorSpace),_n=i.convert(pe.type),tr=X(pe.internalFormat,Jn,_n,pe.colorSpace),je=pe.isVideoTexture!==!0,yn=Ot.__version===void 0||Vt===!0,Yt=qt.dataReady;let wn=te(pe,rr);vt(s.TEXTURE_CUBE_MAP,pe);let tn;if(Qn){je&&yn&&t.texStorage2D(s.TEXTURE_CUBE_MAP,wn,tr,rr.width,rr.height);for(let Wt=0;Wt<6;Wt++){tn=Rn[Wt].mipmaps;for(let kn=0;kn<tn.length;kn++){const yr=tn[kn];pe.format!==yl?Jn!==null?je?Yt&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn,0,0,yr.width,yr.height,Jn,yr.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn,tr,yr.width,yr.height,0,yr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):je?Yt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn,0,0,yr.width,yr.height,Jn,_n,yr.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn,tr,yr.width,yr.height,0,Jn,_n,yr.data)}}}else{if(tn=pe.mipmaps,je&&yn){tn.length>0&&wn++;const Wt=Ci(Rn[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,wn,tr,Wt.width,Wt.height)}for(let Wt=0;Wt<6;Wt++)if(jt){je?Yt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,0,0,0,Rn[Wt].width,Rn[Wt].height,Jn,_n,Rn[Wt].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,0,tr,Rn[Wt].width,Rn[Wt].height,0,Jn,_n,Rn[Wt].data);for(let kn=0;kn<tn.length;kn++){const ki=tn[kn].image[Wt].image;je?Yt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn+1,0,0,ki.width,ki.height,Jn,_n,ki.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn+1,tr,ki.width,ki.height,0,Jn,_n,ki.data)}}else{je?Yt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,0,0,0,Jn,_n,Rn[Wt]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,0,tr,Jn,_n,Rn[Wt]);for(let kn=0;kn<tn.length;kn++){const yr=tn[kn];je?Yt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn+1,0,0,Jn,_n,yr.image[Wt]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Wt,kn+1,tr,Jn,_n,yr.image[Wt])}}}B(pe)&&A(s.TEXTURE_CUBE_MAP),Ot.__version=qt.version,pe.onUpdate&&pe.onUpdate(pe)}Ie.__version=pe.version}function hn(Ie,pe,wt,Vt,qt,Ot){const Kn=i.convert(wt.format,wt.colorSpace),vn=i.convert(wt.type),Ln=X(wt.internalFormat,Kn,vn,wt.colorSpace),Qn=n.get(pe),jt=n.get(wt);if(jt.__renderTarget=pe,!Qn.__hasExternalTextures){const Rn=Math.max(1,pe.width>>Ot),rr=Math.max(1,pe.height>>Ot);qt===s.TEXTURE_3D||qt===s.TEXTURE_2D_ARRAY?t.texImage3D(qt,Ot,Ln,Rn,rr,pe.depth,0,Kn,vn,null):t.texImage2D(qt,Ot,Ln,Rn,rr,0,Kn,vn,null)}t.bindFramebuffer(s.FRAMEBUFFER,Ie),Yr(pe)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Vt,qt,jt.__webglTexture,0,On(pe)):(qt===s.TEXTURE_2D||qt>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&qt<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,Vt,qt,jt.__webglTexture,Ot),t.bindFramebuffer(s.FRAMEBUFFER,null)}function Xn(Ie,pe,wt){if(s.bindRenderbuffer(s.RENDERBUFFER,Ie),pe.depthBuffer){const Vt=pe.depthTexture,qt=Vt&&Vt.isDepthTexture?Vt.type:null,Ot=P(pe.stencilBuffer,qt),Kn=pe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,vn=On(pe);Yr(pe)?c.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,vn,Ot,pe.width,pe.height):wt?s.renderbufferStorageMultisample(s.RENDERBUFFER,vn,Ot,pe.width,pe.height):s.renderbufferStorage(s.RENDERBUFFER,Ot,pe.width,pe.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,Kn,s.RENDERBUFFER,Ie)}else{const Vt=pe.textures;for(let qt=0;qt<Vt.length;qt++){const Ot=Vt[qt],Kn=i.convert(Ot.format,Ot.colorSpace),vn=i.convert(Ot.type),Ln=X(Ot.internalFormat,Kn,vn,Ot.colorSpace),Qn=On(pe);wt&&Yr(pe)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,Qn,Ln,pe.width,pe.height):Yr(pe)?c.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Qn,Ln,pe.width,pe.height):s.renderbufferStorage(s.RENDERBUFFER,Ln,pe.width,pe.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function Fn(Ie,pe){if(pe&&pe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,Ie),!(pe.depthTexture&&pe.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Vt=n.get(pe.depthTexture);Vt.__renderTarget=pe,(!Vt.__webglTexture||pe.depthTexture.image.width!==pe.width||pe.depthTexture.image.height!==pe.height)&&(pe.depthTexture.image.width=pe.width,pe.depthTexture.image.height=pe.height,pe.depthTexture.needsUpdate=!0),st(pe.depthTexture,0);const qt=Vt.__webglTexture,Ot=On(pe);if(pe.depthTexture.format===yE)Yr(pe)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,qt,0,Ot):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,qt,0);else if(pe.depthTexture.format===Ox)Yr(pe)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,qt,0,Ot):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,qt,0);else throw new Error("Unknown depthTexture format")}function Kr(Ie){const pe=n.get(Ie),wt=Ie.isWebGLCubeRenderTarget===!0;if(pe.__boundDepthTexture!==Ie.depthTexture){const Vt=Ie.depthTexture;if(pe.__depthDisposeCallback&&pe.__depthDisposeCallback(),Vt){const qt=()=>{delete pe.__boundDepthTexture,delete pe.__depthDisposeCallback,Vt.removeEventListener("dispose",qt)};Vt.addEventListener("dispose",qt),pe.__depthDisposeCallback=qt}pe.__boundDepthTexture=Vt}if(Ie.depthTexture&&!pe.__autoAllocateDepthBuffer){if(wt)throw new Error("target.depthTexture not supported in Cube render targets");const Vt=Ie.texture.mipmaps;Vt&&Vt.length>0?Fn(pe.__webglFramebuffer[0],Ie):Fn(pe.__webglFramebuffer,Ie)}else if(wt){pe.__webglDepthbuffer=[];for(let Vt=0;Vt<6;Vt++)if(t.bindFramebuffer(s.FRAMEBUFFER,pe.__webglFramebuffer[Vt]),pe.__webglDepthbuffer[Vt]===void 0)pe.__webglDepthbuffer[Vt]=s.createRenderbuffer(),Xn(pe.__webglDepthbuffer[Vt],Ie,!1);else{const qt=Ie.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Ot=pe.__webglDepthbuffer[Vt];s.bindRenderbuffer(s.RENDERBUFFER,Ot),s.framebufferRenderbuffer(s.FRAMEBUFFER,qt,s.RENDERBUFFER,Ot)}}else{const Vt=Ie.texture.mipmaps;if(Vt&&Vt.length>0?t.bindFramebuffer(s.FRAMEBUFFER,pe.__webglFramebuffer[0]):t.bindFramebuffer(s.FRAMEBUFFER,pe.__webglFramebuffer),pe.__webglDepthbuffer===void 0)pe.__webglDepthbuffer=s.createRenderbuffer(),Xn(pe.__webglDepthbuffer,Ie,!1);else{const qt=Ie.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Ot=pe.__webglDepthbuffer;s.bindRenderbuffer(s.RENDERBUFFER,Ot),s.framebufferRenderbuffer(s.FRAMEBUFFER,qt,s.RENDERBUFFER,Ot)}}t.bindFramebuffer(s.FRAMEBUFFER,null)}function Mi(Ie,pe,wt){const Vt=n.get(Ie);pe!==void 0&&hn(Vt.__webglFramebuffer,Ie,Ie.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),wt!==void 0&&Kr(Ie)}function Br(Ie){const pe=Ie.texture,wt=n.get(Ie),Vt=n.get(pe);Ie.addEventListener("dispose",ie);const qt=Ie.textures,Ot=Ie.isWebGLCubeRenderTarget===!0,Kn=qt.length>1;if(Kn||(Vt.__webglTexture===void 0&&(Vt.__webglTexture=s.createTexture()),Vt.__version=pe.version,a.memory.textures++),Ot){wt.__webglFramebuffer=[];for(let vn=0;vn<6;vn++)if(pe.mipmaps&&pe.mipmaps.length>0){wt.__webglFramebuffer[vn]=[];for(let Ln=0;Ln<pe.mipmaps.length;Ln++)wt.__webglFramebuffer[vn][Ln]=s.createFramebuffer()}else wt.__webglFramebuffer[vn]=s.createFramebuffer()}else{if(pe.mipmaps&&pe.mipmaps.length>0){wt.__webglFramebuffer=[];for(let vn=0;vn<pe.mipmaps.length;vn++)wt.__webglFramebuffer[vn]=s.createFramebuffer()}else wt.__webglFramebuffer=s.createFramebuffer();if(Kn)for(let vn=0,Ln=qt.length;vn<Ln;vn++){const Qn=n.get(qt[vn]);Qn.__webglTexture===void 0&&(Qn.__webglTexture=s.createTexture(),a.memory.textures++)}if(Ie.samples>0&&Yr(Ie)===!1){wt.__webglMultisampledFramebuffer=s.createFramebuffer(),wt.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,wt.__webglMultisampledFramebuffer);for(let vn=0;vn<qt.length;vn++){const Ln=qt[vn];wt.__webglColorRenderbuffer[vn]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,wt.__webglColorRenderbuffer[vn]);const Qn=i.convert(Ln.format,Ln.colorSpace),jt=i.convert(Ln.type),Rn=X(Ln.internalFormat,Qn,jt,Ln.colorSpace,Ie.isXRRenderTarget===!0),rr=On(Ie);s.renderbufferStorageMultisample(s.RENDERBUFFER,rr,Rn,Ie.width,Ie.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+vn,s.RENDERBUFFER,wt.__webglColorRenderbuffer[vn])}s.bindRenderbuffer(s.RENDERBUFFER,null),Ie.depthBuffer&&(wt.__webglDepthRenderbuffer=s.createRenderbuffer(),Xn(wt.__webglDepthRenderbuffer,Ie,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Ot){t.bindTexture(s.TEXTURE_CUBE_MAP,Vt.__webglTexture),vt(s.TEXTURE_CUBE_MAP,pe);for(let vn=0;vn<6;vn++)if(pe.mipmaps&&pe.mipmaps.length>0)for(let Ln=0;Ln<pe.mipmaps.length;Ln++)hn(wt.__webglFramebuffer[vn][Ln],Ie,pe,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Ln);else hn(wt.__webglFramebuffer[vn],Ie,pe,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+vn,0);B(pe)&&A(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Kn){for(let vn=0,Ln=qt.length;vn<Ln;vn++){const Qn=qt[vn],jt=n.get(Qn);t.bindTexture(s.TEXTURE_2D,jt.__webglTexture),vt(s.TEXTURE_2D,Qn),hn(wt.__webglFramebuffer,Ie,Qn,s.COLOR_ATTACHMENT0+vn,s.TEXTURE_2D,0),B(Qn)&&A(s.TEXTURE_2D)}t.unbindTexture()}else{let vn=s.TEXTURE_2D;if((Ie.isWebGL3DRenderTarget||Ie.isWebGLArrayRenderTarget)&&(vn=Ie.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(vn,Vt.__webglTexture),vt(vn,pe),pe.mipmaps&&pe.mipmaps.length>0)for(let Ln=0;Ln<pe.mipmaps.length;Ln++)hn(wt.__webglFramebuffer[Ln],Ie,pe,s.COLOR_ATTACHMENT0,vn,Ln);else hn(wt.__webglFramebuffer,Ie,pe,s.COLOR_ATTACHMENT0,vn,0);B(pe)&&A(vn),t.unbindTexture()}Ie.depthBuffer&&Kr(Ie)}function Ue(Ie){const pe=Ie.textures;for(let wt=0,Vt=pe.length;wt<Vt;wt++){const qt=pe[wt];if(B(qt)){const Ot=V(Ie),Kn=n.get(qt).__webglTexture;t.bindTexture(Ot,Kn),A(Ot),t.unbindTexture()}}}const Ii=[],ei=[];function Ar(Ie){if(Ie.samples>0){if(Yr(Ie)===!1){const pe=Ie.textures,wt=Ie.width,Vt=Ie.height;let qt=s.COLOR_BUFFER_BIT;const Ot=Ie.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Kn=n.get(Ie),vn=pe.length>1;if(vn)for(let Qn=0;Qn<pe.length;Qn++)t.bindFramebuffer(s.FRAMEBUFFER,Kn.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qn,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,Kn.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qn,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,Kn.__webglMultisampledFramebuffer);const Ln=Ie.texture.mipmaps;Ln&&Ln.length>0?t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Kn.__webglFramebuffer[0]):t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Kn.__webglFramebuffer);for(let Qn=0;Qn<pe.length;Qn++){if(Ie.resolveDepthBuffer&&(Ie.depthBuffer&&(qt|=s.DEPTH_BUFFER_BIT),Ie.stencilBuffer&&Ie.resolveStencilBuffer&&(qt|=s.STENCIL_BUFFER_BIT)),vn){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,Kn.__webglColorRenderbuffer[Qn]);const jt=n.get(pe[Qn]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,jt,0)}s.blitFramebuffer(0,0,wt,Vt,0,0,wt,Vt,qt,s.NEAREST),u===!0&&(Ii.length=0,ei.length=0,Ii.push(s.COLOR_ATTACHMENT0+Qn),Ie.depthBuffer&&Ie.resolveDepthBuffer===!1&&(Ii.push(Ot),ei.push(Ot),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,ei)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Ii))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),vn)for(let Qn=0;Qn<pe.length;Qn++){t.bindFramebuffer(s.FRAMEBUFFER,Kn.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qn,s.RENDERBUFFER,Kn.__webglColorRenderbuffer[Qn]);const jt=n.get(pe[Qn]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,Kn.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qn,s.TEXTURE_2D,jt,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Kn.__webglMultisampledFramebuffer)}else if(Ie.depthBuffer&&Ie.resolveDepthBuffer===!1&&u){const pe=Ie.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[pe])}}}function On(Ie){return Math.min(r.maxSamples,Ie.samples)}function Yr(Ie){const pe=n.get(Ie);return Ie.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&pe.__useRenderToTexture!==!1}function Yn(Ie){const pe=a.render.frame;y.get(Ie)!==pe&&(y.set(Ie,pe),Ie.update())}function vr(Ie,pe){const wt=Ie.colorSpace,Vt=Ie.format,qt=Ie.type;return Ie.isCompressedTexture===!0||Ie.isVideoTexture===!0||wt!==Ju&&wt!==kf&&(Gr.getTransfer(wt)===Es?(Vt!==yl||qt!==t0)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",wt)),pe}function Ci(Ie){return typeof HTMLImageElement<"u"&&Ie instanceof HTMLImageElement?(p.width=Ie.naturalWidth||Ie.width,p.height=Ie.naturalHeight||Ie.height):typeof VideoFrame<"u"&&Ie instanceof VideoFrame?(p.width=Ie.displayWidth,p.height=Ie.displayHeight):(p.width=Ie.width,p.height=Ie.height),p}this.allocateTextureUnit=Be,this.resetTextureUnits=De,this.setTexture2D=st,this.setTexture2DArray=de,this.setTexture3D=ft,this.setTextureCube=Se,this.rebindTextures=Mi,this.setupRenderTarget=Br,this.updateRenderTargetMipmap=Ue,this.updateMultisampleRenderTarget=Ar,this.setupDepthRenderbuffer=Kr,this.setupFrameBufferTexture=hn,this.useMultisampledRTT=Yr}function hFe(s,e){function t(n,r=kf){let i;const a=Gr.getTransfer(r);if(n===t0)return s.UNSIGNED_BYTE;if(n===AW)return s.UNSIGNED_SHORT_4_4_4_4;if(n===PW)return s.UNSIGNED_SHORT_5_5_5_1;if(n===Y8e)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===q8e)return s.BYTE;if(n===X8e)return s.SHORT;if(n===vE)return s.UNSIGNED_SHORT;if(n===CW)return s.INT;if(n===H3)return s.UNSIGNED_INT;if(n===ed)return s.FLOAT;if(n===W3)return s.HALF_FLOAT;if(n===K8e)return s.ALPHA;if(n===Z8e)return s.RGB;if(n===yl)return s.RGBA;if(n===yE)return s.DEPTH_COMPONENT;if(n===Ox)return s.DEPTH_STENCIL;if(n===Q8e)return s.RED;if(n===RW)return s.RED_INTEGER;if(n===J8e)return s.RG;if(n===IW)return s.RG_INTEGER;if(n===kW)return s.RGBA_INTEGER;if(n===VI||n===GI||n===jI||n===HI)if(a===Es)if(i=e.get("WEBGL_compressed_texture_s3tc_srgb"),i!==null){if(n===VI)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===GI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===jI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===HI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(i=e.get("WEBGL_compressed_texture_s3tc"),i!==null){if(n===VI)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===GI)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===jI)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===HI)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===Wj||n===$j||n===qj||n===Xj)if(i=e.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(n===Wj)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===$j)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===qj)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Xj)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Yj||n===Kj||n===Zj)if(i=e.get("WEBGL_compressed_texture_etc"),i!==null){if(n===Yj||n===Kj)return a===Es?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Zj)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===Qj||n===Jj||n===eH||n===tH||n===nH||n===rH||n===iH||n===sH||n===oH||n===aH||n===lH||n===cH||n===uH||n===hH)if(i=e.get("WEBGL_compressed_texture_astc"),i!==null){if(n===Qj)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Jj)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===eH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===tH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===nH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===rH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===iH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===sH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===oH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===aH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===lH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===cH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===uH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===hH)return a===Es?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===WI||n===dH||n===fH)if(i=e.get("EXT_texture_compression_bptc"),i!==null){if(n===WI)return a===Es?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===dH)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===fH)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===eve||n===pH||n===mH||n===gH)if(i=e.get("EXT_texture_compression_rgtc"),i!==null){if(n===WI)return i.COMPRESSED_RED_RGTC1_EXT;if(n===pH)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===mH)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===gH)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Dx?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}const dFe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,fFe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class pFe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const r=new n0,i=e.properties.get(r);i.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new r0({vertexShader:dFe,fragmentShader:fFe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new mn(new Ev(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class mFe extends nh{constructor(e,t){super();const n=this;let r=null,i=1,a=null,c="local-floor",u=1,p=null,y=null,x=null,S=null,M=null,I=null;const L=new pFe,B=t.getContextAttributes();let A=null,V=null;const X=[],P=[],te=new An;let oe=null;const ie=new Ja;ie.viewport=new xi;const K=new Ja;K.viewport=new xi;const re=[ie,K],se=new mke;let q=null,De=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ct){let Pt=X[ct];return Pt===void 0&&(Pt=new NV,X[ct]=Pt),Pt.getTargetRaySpace()},this.getControllerGrip=function(ct){let Pt=X[ct];return Pt===void 0&&(Pt=new NV,X[ct]=Pt),Pt.getGripSpace()},this.getHand=function(ct){let Pt=X[ct];return Pt===void 0&&(Pt=new NV,X[ct]=Pt),Pt.getHandSpace()};function Be(ct){const Pt=P.indexOf(ct.inputSource);if(Pt===-1)return;const on=X[Pt];on!==void 0&&(on.update(ct.inputSource,ct.frame,p||a),on.dispatchEvent({type:ct.type,data:ct.inputSource}))}function tt(){r.removeEventListener("select",Be),r.removeEventListener("selectstart",Be),r.removeEventListener("selectend",Be),r.removeEventListener("squeeze",Be),r.removeEventListener("squeezestart",Be),r.removeEventListener("squeezeend",Be),r.removeEventListener("end",tt),r.removeEventListener("inputsourceschange",st);for(let ct=0;ct<X.length;ct++){const Pt=P[ct];Pt!==null&&(P[ct]=null,X[ct].disconnect(Pt))}q=null,De=null,L.reset(),e.setRenderTarget(A),M=null,S=null,x=null,r=null,V=null,Bt.stop(),n.isPresenting=!1,e.setPixelRatio(oe),e.setSize(te.width,te.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ct){i=ct,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ct){c=ct,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||a},this.setReferenceSpace=function(ct){p=ct},this.getBaseLayer=function(){return S!==null?S:M},this.getBinding=function(){return x},this.getFrame=function(){return I},this.getSession=function(){return r},this.setSession=async function(ct){if(r=ct,r!==null){if(A=e.getRenderTarget(),r.addEventListener("select",Be),r.addEventListener("selectstart",Be),r.addEventListener("selectend",Be),r.addEventListener("squeeze",Be),r.addEventListener("squeezestart",Be),r.addEventListener("squeezeend",Be),r.addEventListener("end",tt),r.addEventListener("inputsourceschange",st),B.xrCompatible!==!0&&await t.makeXRCompatible(),oe=e.getPixelRatio(),e.getSize(te),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let on=null,Gt=null,hn=null;B.depth&&(hn=B.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,on=B.stencil?Ox:yE,Gt=B.stencil?Dx:H3);const Xn={colorFormat:t.RGBA8,depthFormat:hn,scaleFactor:i};x=new XRWebGLBinding(r,t),S=x.createProjectionLayer(Xn),r.updateRenderState({layers:[S]}),e.setPixelRatio(1),e.setSize(S.textureWidth,S.textureHeight,!1),V=new bl(S.textureWidth,S.textureHeight,{format:yl,type:t0,depthTexture:new GW(S.textureWidth,S.textureHeight,Gt,void 0,void 0,void 0,void 0,void 0,void 0,on),stencilBuffer:B.stencil,colorSpace:e.outputColorSpace,samples:B.antialias?4:0,resolveDepthBuffer:S.ignoreDepthValues===!1,resolveStencilBuffer:S.ignoreDepthValues===!1})}else{const on={antialias:B.antialias,alpha:!0,depth:B.depth,stencil:B.stencil,framebufferScaleFactor:i};M=new XRWebGLLayer(r,t,on),r.updateRenderState({baseLayer:M}),e.setPixelRatio(1),e.setSize(M.framebufferWidth,M.framebufferHeight,!1),V=new bl(M.framebufferWidth,M.framebufferHeight,{format:yl,type:t0,colorSpace:e.outputColorSpace,stencilBuffer:B.stencil,resolveDepthBuffer:M.ignoreDepthValues===!1,resolveStencilBuffer:M.ignoreDepthValues===!1})}V.isXRRenderTarget=!0,this.setFoveation(u),p=null,a=await r.requestReferenceSpace(c),Bt.setContext(r),Bt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return L.getDepthTexture()};function st(ct){for(let Pt=0;Pt<ct.removed.length;Pt++){const on=ct.removed[Pt],Gt=P.indexOf(on);Gt>=0&&(P[Gt]=null,X[Gt].disconnect(on))}for(let Pt=0;Pt<ct.added.length;Pt++){const on=ct.added[Pt];let Gt=P.indexOf(on);if(Gt===-1){for(let Xn=0;Xn<X.length;Xn++)if(Xn>=P.length){P.push(on),Gt=Xn;break}else if(P[Xn]===null){P[Xn]=on,Gt=Xn;break}if(Gt===-1)break}const hn=X[Gt];hn&&hn.connect(on)}}const de=new Ae,ft=new Ae;function Se(ct,Pt,on){de.setFromMatrixPosition(Pt.matrixWorld),ft.setFromMatrixPosition(on.matrixWorld);const Gt=de.distanceTo(ft),hn=Pt.projectionMatrix.elements,Xn=on.projectionMatrix.elements,Fn=hn[14]/(hn[10]-1),Kr=hn[14]/(hn[10]+1),Mi=(hn[9]+1)/hn[5],Br=(hn[9]-1)/hn[5],Ue=(hn[8]-1)/hn[0],Ii=(Xn[8]+1)/Xn[0],ei=Fn*Ue,Ar=Fn*Ii,On=Gt/(-Ue+Ii),Yr=On*-Ue;if(Pt.matrixWorld.decompose(ct.position,ct.quaternion,ct.scale),ct.translateX(Yr),ct.translateZ(On),ct.matrixWorld.compose(ct.position,ct.quaternion,ct.scale),ct.matrixWorldInverse.copy(ct.matrixWorld).invert(),hn[10]===-1)ct.projectionMatrix.copy(Pt.projectionMatrix),ct.projectionMatrixInverse.copy(Pt.projectionMatrixInverse);else{const Yn=Fn+On,vr=Kr+On,Ci=ei-Yr,Ie=Ar+(Gt-Yr),pe=Mi*Kr/vr*Yn,wt=Br*Kr/vr*Yn;ct.projectionMatrix.makePerspective(Ci,Ie,pe,wt,Yn,vr),ct.projectionMatrixInverse.copy(ct.projectionMatrix).invert()}}function rt(ct,Pt){Pt===null?ct.matrixWorld.copy(ct.matrix):ct.matrixWorld.multiplyMatrices(Pt.matrixWorld,ct.matrix),ct.matrixWorldInverse.copy(ct.matrixWorld).invert()}this.updateCamera=function(ct){if(r===null)return;let Pt=ct.near,on=ct.far;L.texture!==null&&(L.depthNear>0&&(Pt=L.depthNear),L.depthFar>0&&(on=L.depthFar)),se.near=K.near=ie.near=Pt,se.far=K.far=ie.far=on,(q!==se.near||De!==se.far)&&(r.updateRenderState({depthNear:se.near,depthFar:se.far}),q=se.near,De=se.far),ie.layers.mask=ct.layers.mask|2,K.layers.mask=ct.layers.mask|4,se.layers.mask=ie.layers.mask|K.layers.mask;const Gt=ct.parent,hn=se.cameras;rt(se,Gt);for(let Xn=0;Xn<hn.length;Xn++)rt(hn[Xn],Gt);hn.length===2?Se(se,ie,K):se.projectionMatrix.copy(ie.projectionMatrix),ut(ct,se,Gt)};function ut(ct,Pt,on){on===null?ct.matrix.copy(Pt.matrixWorld):(ct.matrix.copy(on.matrixWorld),ct.matrix.invert(),ct.matrix.multiply(Pt.matrixWorld)),ct.matrix.decompose(ct.position,ct.quaternion,ct.scale),ct.updateMatrixWorld(!0),ct.projectionMatrix.copy(Pt.projectionMatrix),ct.projectionMatrixInverse.copy(Pt.projectionMatrixInverse),ct.isPerspectiveCamera&&(ct.fov=Lx*2*Math.atan(1/ct.projectionMatrix.elements[5]),ct.zoom=1)}this.getCamera=function(){return se},this.getFoveation=function(){if(!(S===null&&M===null))return u},this.setFoveation=function(ct){u=ct,S!==null&&(S.fixedFoveation=ct),M!==null&&M.fixedFoveation!==void 0&&(M.fixedFoveation=ct)},this.hasDepthSensing=function(){return L.texture!==null},this.getDepthSensingMesh=function(){return L.getMesh(se)};let Pe=null;function vt(ct,Pt){if(y=Pt.getViewerPose(p||a),I=Pt,y!==null){const on=y.views;M!==null&&(e.setRenderTargetFramebuffer(V,M.framebuffer),e.setRenderTarget(V));let Gt=!1;on.length!==se.cameras.length&&(se.cameras.length=0,Gt=!0);for(let Fn=0;Fn<on.length;Fn++){const Kr=on[Fn];let Mi=null;if(M!==null)Mi=M.getViewport(Kr);else{const Ue=x.getViewSubImage(S,Kr);Mi=Ue.viewport,Fn===0&&(e.setRenderTargetTextures(V,Ue.colorTexture,Ue.depthStencilTexture),e.setRenderTarget(V))}let Br=re[Fn];Br===void 0&&(Br=new Ja,Br.layers.enable(Fn),Br.viewport=new xi,re[Fn]=Br),Br.matrix.fromArray(Kr.transform.matrix),Br.matrix.decompose(Br.position,Br.quaternion,Br.scale),Br.projectionMatrix.fromArray(Kr.projectionMatrix),Br.projectionMatrixInverse.copy(Br.projectionMatrix).invert(),Br.viewport.set(Mi.x,Mi.y,Mi.width,Mi.height),Fn===0&&(se.matrix.copy(Br.matrix),se.matrix.decompose(se.position,se.quaternion,se.scale)),Gt===!0&&se.cameras.push(Br)}const hn=r.enabledFeatures;if(hn&&hn.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&x){const Fn=x.getDepthInformation(on[0]);Fn&&Fn.isValid&&Fn.texture&&L.init(e,Fn,r.renderState)}}for(let on=0;on<X.length;on++){const Gt=P[on],hn=X[on];Gt!==null&&hn!==void 0&&hn.update(Gt,Pt,p||a)}Pe&&Pe(ct,Pt),Pt.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Pt}),I=null}const Bt=new Lve;Bt.setAnimationLoop(vt),this.setAnimationLoop=function(ct){Pe=ct},this.dispose=function(){}}}const j8=new ua,gFe=new or;function vFe(s,e){function t(B,A){B.matrixAutoUpdate===!0&&B.updateMatrix(),A.value.copy(B.matrix)}function n(B,A){A.color.getRGB(B.fogColor.value,pve(s)),A.isFog?(B.fogNear.value=A.near,B.fogFar.value=A.far):A.isFogExp2&&(B.fogDensity.value=A.density)}function r(B,A,V,X,P){A.isMeshBasicMaterial||A.isMeshLambertMaterial?i(B,A):A.isMeshToonMaterial?(i(B,A),x(B,A)):A.isMeshPhongMaterial?(i(B,A),y(B,A)):A.isMeshStandardMaterial?(i(B,A),S(B,A),A.isMeshPhysicalMaterial&&M(B,A,P)):A.isMeshMatcapMaterial?(i(B,A),I(B,A)):A.isMeshDepthMaterial?i(B,A):A.isMeshDistanceMaterial?(i(B,A),L(B,A)):A.isMeshNormalMaterial?i(B,A):A.isLineBasicMaterial?(a(B,A),A.isLineDashedMaterial&&c(B,A)):A.isPointsMaterial?u(B,A,V,X):A.isSpriteMaterial?p(B,A):A.isShadowMaterial?(B.color.value.copy(A.color),B.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}function i(B,A){B.opacity.value=A.opacity,A.color&&B.diffuse.value.copy(A.color),A.emissive&&B.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(B.map.value=A.map,t(A.map,B.mapTransform)),A.alphaMap&&(B.alphaMap.value=A.alphaMap,t(A.alphaMap,B.alphaMapTransform)),A.bumpMap&&(B.bumpMap.value=A.bumpMap,t(A.bumpMap,B.bumpMapTransform),B.bumpScale.value=A.bumpScale,A.side===Qo&&(B.bumpScale.value*=-1)),A.normalMap&&(B.normalMap.value=A.normalMap,t(A.normalMap,B.normalMapTransform),B.normalScale.value.copy(A.normalScale),A.side===Qo&&B.normalScale.value.negate()),A.displacementMap&&(B.displacementMap.value=A.displacementMap,t(A.displacementMap,B.displacementMapTransform),B.displacementScale.value=A.displacementScale,B.displacementBias.value=A.displacementBias),A.emissiveMap&&(B.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,B.emissiveMapTransform)),A.specularMap&&(B.specularMap.value=A.specularMap,t(A.specularMap,B.specularMapTransform)),A.alphaTest>0&&(B.alphaTest.value=A.alphaTest);const V=e.get(A),X=V.envMap,P=V.envMapRotation;X&&(B.envMap.value=X,j8.copy(P),j8.x*=-1,j8.y*=-1,j8.z*=-1,X.isCubeTexture&&X.isRenderTargetTexture===!1&&(j8.y*=-1,j8.z*=-1),B.envMapRotation.value.setFromMatrix4(gFe.makeRotationFromEuler(j8)),B.flipEnvMap.value=X.isCubeTexture&&X.isRenderTargetTexture===!1?-1:1,B.reflectivity.value=A.reflectivity,B.ior.value=A.ior,B.refractionRatio.value=A.refractionRatio),A.lightMap&&(B.lightMap.value=A.lightMap,B.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,B.lightMapTransform)),A.aoMap&&(B.aoMap.value=A.aoMap,B.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,B.aoMapTransform))}function a(B,A){B.diffuse.value.copy(A.color),B.opacity.value=A.opacity,A.map&&(B.map.value=A.map,t(A.map,B.mapTransform))}function c(B,A){B.dashSize.value=A.dashSize,B.totalSize.value=A.dashSize+A.gapSize,B.scale.value=A.scale}function u(B,A,V,X){B.diffuse.value.copy(A.color),B.opacity.value=A.opacity,B.size.value=A.size*V,B.scale.value=X*.5,A.map&&(B.map.value=A.map,t(A.map,B.uvTransform)),A.alphaMap&&(B.alphaMap.value=A.alphaMap,t(A.alphaMap,B.alphaMapTransform)),A.alphaTest>0&&(B.alphaTest.value=A.alphaTest)}function p(B,A){B.diffuse.value.copy(A.color),B.opacity.value=A.opacity,B.rotation.value=A.rotation,A.map&&(B.map.value=A.map,t(A.map,B.mapTransform)),A.alphaMap&&(B.alphaMap.value=A.alphaMap,t(A.alphaMap,B.alphaMapTransform)),A.alphaTest>0&&(B.alphaTest.value=A.alphaTest)}function y(B,A){B.specular.value.copy(A.specular),B.shininess.value=Math.max(A.shininess,1e-4)}function x(B,A){A.gradientMap&&(B.gradientMap.value=A.gradientMap)}function S(B,A){B.metalness.value=A.metalness,A.metalnessMap&&(B.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,B.metalnessMapTransform)),B.roughness.value=A.roughness,A.roughnessMap&&(B.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,B.roughnessMapTransform)),A.envMap&&(B.envMapIntensity.value=A.envMapIntensity)}function M(B,A,V){B.ior.value=A.ior,A.sheen>0&&(B.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),B.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(B.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,B.sheenColorMapTransform)),A.sheenRoughnessMap&&(B.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,B.sheenRoughnessMapTransform))),A.clearcoat>0&&(B.clearcoat.value=A.clearcoat,B.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(B.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,B.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(B.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,B.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(B.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,B.clearcoatNormalMapTransform),B.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===Qo&&B.clearcoatNormalScale.value.negate())),A.dispersion>0&&(B.dispersion.value=A.dispersion),A.iridescence>0&&(B.iridescence.value=A.iridescence,B.iridescenceIOR.value=A.iridescenceIOR,B.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],B.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(B.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,B.iridescenceMapTransform)),A.iridescenceThicknessMap&&(B.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,B.iridescenceThicknessMapTransform))),A.transmission>0&&(B.transmission.value=A.transmission,B.transmissionSamplerMap.value=V.texture,B.transmissionSamplerSize.value.set(V.width,V.height),A.transmissionMap&&(B.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,B.transmissionMapTransform)),B.thickness.value=A.thickness,A.thicknessMap&&(B.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,B.thicknessMapTransform)),B.attenuationDistance.value=A.attenuationDistance,B.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(B.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(B.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,B.anisotropyMapTransform))),B.specularIntensity.value=A.specularIntensity,B.specularColor.value.copy(A.specularColor),A.specularColorMap&&(B.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,B.specularColorMapTransform)),A.specularIntensityMap&&(B.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,B.specularIntensityMapTransform))}function I(B,A){A.matcap&&(B.matcap.value=A.matcap)}function L(B,A){const V=e.get(A).light;B.referencePosition.value.setFromMatrixPosition(V.matrixWorld),B.nearDistance.value=V.shadow.camera.near,B.farDistance.value=V.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function yFe(s,e,t,n){let r={},i={},a=[];const c=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function u(V,X){const P=X.program;n.uniformBlockBinding(V,P)}function p(V,X){let P=r[V.id];P===void 0&&(I(V),P=y(V),r[V.id]=P,V.addEventListener("dispose",B));const te=X.program;n.updateUBOMapping(V,te);const oe=e.render.frame;i[V.id]!==oe&&(S(V),i[V.id]=oe)}function y(V){const X=x();V.__bindingPointIndex=X;const P=s.createBuffer(),te=V.__size,oe=V.usage;return s.bindBuffer(s.UNIFORM_BUFFER,P),s.bufferData(s.UNIFORM_BUFFER,te,oe),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,X,P),P}function x(){for(let V=0;V<c;V++)if(a.indexOf(V)===-1)return a.push(V),V;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function S(V){const X=r[V.id],P=V.uniforms,te=V.__cache;s.bindBuffer(s.UNIFORM_BUFFER,X);for(let oe=0,ie=P.length;oe<ie;oe++){const K=Array.isArray(P[oe])?P[oe]:[P[oe]];for(let re=0,se=K.length;re<se;re++){const q=K[re];if(M(q,oe,re,te)===!0){const De=q.__offset,Be=Array.isArray(q.value)?q.value:[q.value];let tt=0;for(let st=0;st<Be.length;st++){const de=Be[st],ft=L(de);typeof de=="number"||typeof de=="boolean"?(q.__data[0]=de,s.bufferSubData(s.UNIFORM_BUFFER,De+tt,q.__data)):de.isMatrix3?(q.__data[0]=de.elements[0],q.__data[1]=de.elements[1],q.__data[2]=de.elements[2],q.__data[3]=0,q.__data[4]=de.elements[3],q.__data[5]=de.elements[4],q.__data[6]=de.elements[5],q.__data[7]=0,q.__data[8]=de.elements[6],q.__data[9]=de.elements[7],q.__data[10]=de.elements[8],q.__data[11]=0):(de.toArray(q.__data,tt),tt+=ft.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,De,q.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function M(V,X,P,te){const oe=V.value,ie=X+"_"+P;if(te[ie]===void 0)return typeof oe=="number"||typeof oe=="boolean"?te[ie]=oe:te[ie]=oe.clone(),!0;{const K=te[ie];if(typeof oe=="number"||typeof oe=="boolean"){if(K!==oe)return te[ie]=oe,!0}else if(K.equals(oe)===!1)return K.copy(oe),!0}return!1}function I(V){const X=V.uniforms;let P=0;const te=16;for(let ie=0,K=X.length;ie<K;ie++){const re=Array.isArray(X[ie])?X[ie]:[X[ie]];for(let se=0,q=re.length;se<q;se++){const De=re[se],Be=Array.isArray(De.value)?De.value:[De.value];for(let tt=0,st=Be.length;tt<st;tt++){const de=Be[tt],ft=L(de),Se=P%te,rt=Se%ft.boundary,ut=Se+rt;P+=rt,ut!==0&&te-ut<ft.storage&&(P+=te-ut),De.__data=new Float32Array(ft.storage/Float32Array.BYTES_PER_ELEMENT),De.__offset=P,P+=ft.storage}}}const oe=P%te;return oe>0&&(P+=te-oe),V.__size=P,V.__cache={},this}function L(V){const X={boundary:0,storage:0};return typeof V=="number"||typeof V=="boolean"?(X.boundary=4,X.storage=4):V.isVector2?(X.boundary=8,X.storage=8):V.isVector3||V.isColor?(X.boundary=16,X.storage=12):V.isVector4?(X.boundary=16,X.storage=16):V.isMatrix3?(X.boundary=48,X.storage=48):V.isMatrix4?(X.boundary=64,X.storage=64):V.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",V),X}function B(V){const X=V.target;X.removeEventListener("dispose",B);const P=a.indexOf(X.__bindingPointIndex);a.splice(P,1),s.deleteBuffer(r[X.id]),delete r[X.id],delete i[X.id]}function A(){for(const V in r)s.deleteBuffer(r[V]);a=[],r={},i={}}return{bind:u,update:p,dispose:A}}class hx{constructor(e={}){const{canvas:t=XRe(),context:n=null,depth:r=!0,stencil:i=!1,alpha:a=!1,antialias:c=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:p=!1,powerPreference:y="default",failIfMajorPerformanceCaveat:x=!1,reverseDepthBuffer:S=!1}=e;this.isWebGLRenderer=!0;let M;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");M=n.getContextAttributes().alpha}else M=a;const I=new Uint32Array(4),L=new Int32Array(4);let B=null,A=null;const V=[],X=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=b1,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const P=this;let te=!1;this._outputColorSpace=qr;let oe=0,ie=0,K=null,re=-1,se=null;const q=new xi,De=new xi;let Be=null;const tt=new Pn(0);let st=0,de=t.width,ft=t.height,Se=1,rt=null,ut=null;const Pe=new xi(0,0,de,ft),vt=new xi(0,0,de,ft);let Bt=!1;const ct=new VW;let Pt=!1,on=!1;const Gt=new or,hn=new or,Xn=new Ae,Fn=new xi,Kr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Mi=!1;function Br(){return K===null?Se:1}let Ue=n;function Ii(ye,at){return t.getContext(ye,at)}try{const ye={alpha:!0,depth:r,stencil:i,antialias:c,premultipliedAlpha:u,preserveDrawingBuffer:p,powerPreference:y,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${LE}`),t.addEventListener("webglcontextlost",wn,!1),t.addEventListener("webglcontextrestored",tn,!1),t.addEventListener("webglcontextcreationerror",Wt,!1),Ue===null){const at="webgl2";if(Ue=Ii(at,ye),Ue===null)throw Ii(at)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ye){throw console.error("THREE.WebGLRenderer: "+ye.message),ye}let ei,Ar,On,Yr,Yn,vr,Ci,Ie,pe,wt,Vt,qt,Ot,Kn,vn,Ln,Qn,jt,Rn,rr,Jn,_n,tr,je;function yn(){ei=new POe(Ue),ei.init(),_n=new hFe(Ue,ei),Ar=new SOe(Ue,ei,e,_n),On=new cFe(Ue,ei),Ar.reverseDepthBuffer&&S&&On.buffers.depth.setReversed(!0),Yr=new kOe(Ue),Yn=new KLe,vr=new uFe(Ue,ei,On,Yn,Ar,_n,Yr),Ci=new EOe(P),Ie=new AOe(P),pe=new Bke(Ue),tr=new _Oe(Ue,pe),wt=new ROe(Ue,pe,Yr,tr),Vt=new DOe(Ue,wt,pe,Yr),Rn=new NOe(Ue,Ar,vr),Ln=new wOe(Yn),qt=new YLe(P,Ci,Ie,ei,Ar,tr,Ln),Ot=new vFe(P,Yn),Kn=new QLe,vn=new iFe(ei),jt=new xOe(P,Ci,Ie,On,Vt,M,u),Qn=new aFe(P,Vt,Ar),je=new yFe(Ue,Yr,Ar,On),rr=new bOe(Ue,ei,Yr),Jn=new IOe(Ue,ei,Yr),Yr.programs=qt.programs,P.capabilities=Ar,P.extensions=ei,P.properties=Yn,P.renderLists=Kn,P.shadowMap=Qn,P.state=On,P.info=Yr}yn();const Yt=new mFe(P,Ue);this.xr=Yt,this.getContext=function(){return Ue},this.getContextAttributes=function(){return Ue.getContextAttributes()},this.forceContextLoss=function(){const ye=ei.get("WEBGL_lose_context");ye&&ye.loseContext()},this.forceContextRestore=function(){const ye=ei.get("WEBGL_lose_context");ye&&ye.restoreContext()},this.getPixelRatio=function(){return Se},this.setPixelRatio=function(ye){ye!==void 0&&(Se=ye,this.setSize(de,ft,!1))},this.getSize=function(ye){return ye.set(de,ft)},this.setSize=function(ye,at,Tt=!0){if(Yt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}de=ye,ft=at,t.width=Math.floor(ye*Se),t.height=Math.floor(at*Se),Tt===!0&&(t.style.width=ye+"px",t.style.height=at+"px"),this.setViewport(0,0,ye,at)},this.getDrawingBufferSize=function(ye){return ye.set(de*Se,ft*Se).floor()},this.setDrawingBufferSize=function(ye,at,Tt){de=ye,ft=at,Se=Tt,t.width=Math.floor(ye*Tt),t.height=Math.floor(at*Tt),this.setViewport(0,0,ye,at)},this.getCurrentViewport=function(ye){return ye.copy(q)},this.getViewport=function(ye){return ye.copy(Pe)},this.setViewport=function(ye,at,Tt,gt){ye.isVector4?Pe.set(ye.x,ye.y,ye.z,ye.w):Pe.set(ye,at,Tt,gt),On.viewport(q.copy(Pe).multiplyScalar(Se).round())},this.getScissor=function(ye){return ye.copy(vt)},this.setScissor=function(ye,at,Tt,gt){ye.isVector4?vt.set(ye.x,ye.y,ye.z,ye.w):vt.set(ye,at,Tt,gt),On.scissor(De.copy(vt).multiplyScalar(Se).round())},this.getScissorTest=function(){return Bt},this.setScissorTest=function(ye){On.setScissorTest(Bt=ye)},this.setOpaqueSort=function(ye){rt=ye},this.setTransparentSort=function(ye){ut=ye},this.getClearColor=function(ye){return ye.copy(jt.getClearColor())},this.setClearColor=function(){jt.setClearColor(...arguments)},this.getClearAlpha=function(){return jt.getClearAlpha()},this.setClearAlpha=function(){jt.setClearAlpha(...arguments)},this.clear=function(ye=!0,at=!0,Tt=!0){let gt=0;if(ye){let lt=!1;if(K!==null){const Kt=K.texture.format;lt=Kt===kW||Kt===IW||Kt===RW}if(lt){const Kt=K.texture.type,bn=Kt===t0||Kt===H3||Kt===vE||Kt===Dx||Kt===AW||Kt===PW,Cn=jt.getClearColor(),Nn=jt.getClearAlpha(),fr=Cn.r,ar=Cn.g,Bn=Cn.b;bn?(I[0]=fr,I[1]=ar,I[2]=Bn,I[3]=Nn,Ue.clearBufferuiv(Ue.COLOR,0,I)):(L[0]=fr,L[1]=ar,L[2]=Bn,L[3]=Nn,Ue.clearBufferiv(Ue.COLOR,0,L))}else gt|=Ue.COLOR_BUFFER_BIT}at&&(gt|=Ue.DEPTH_BUFFER_BIT),Tt&&(gt|=Ue.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ue.clear(gt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",wn,!1),t.removeEventListener("webglcontextrestored",tn,!1),t.removeEventListener("webglcontextcreationerror",Wt,!1),jt.dispose(),Kn.dispose(),vn.dispose(),Yn.dispose(),Ci.dispose(),Ie.dispose(),Vt.dispose(),tr.dispose(),je.dispose(),qt.dispose(),Yt.dispose(),Yt.removeEventListener("sessionstart",ru),Yt.removeEventListener("sessionend",I0),i0.stop()};function wn(ye){ye.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),te=!0}function tn(){console.log("THREE.WebGLRenderer: Context Restored."),te=!1;const ye=Yr.autoReset,at=Qn.enabled,Tt=Qn.autoUpdate,gt=Qn.needsUpdate,lt=Qn.type;yn(),Yr.autoReset=ye,Qn.enabled=at,Qn.autoUpdate=Tt,Qn.needsUpdate=gt,Qn.type=lt}function Wt(ye){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ye.statusMessage)}function kn(ye){const at=ye.target;at.removeEventListener("dispose",kn),yr(at)}function yr(ye){ki(ye),Yn.remove(ye)}function ki(ye){const at=Yn.get(ye).programs;at!==void 0&&(at.forEach(function(Tt){qt.releaseProgram(Tt)}),ye.isShaderMaterial&&qt.releaseShaderCache(ye))}this.renderBufferDirect=function(ye,at,Tt,gt,lt,Kt){at===null&&(at=Kr);const bn=lt.isMesh&&lt.matrixWorld.determinant()<0,Cn=hd(ye,at,Tt,gt,lt);On.setMaterial(gt,bn);let Nn=Tt.index,fr=1;if(gt.wireframe===!0){if(Nn=wt.getWireframeAttribute(Tt),Nn===void 0)return;fr=2}const ar=Tt.drawRange,Bn=Tt.attributes.position;let Pr=ar.start*fr,_r=(ar.start+ar.count)*fr;Kt!==null&&(Pr=Math.max(Pr,Kt.start*fr),_r=Math.min(_r,(Kt.start+Kt.count)*fr)),Nn!==null?(Pr=Math.max(Pr,0),_r=Math.min(_r,Nn.count)):Bn!=null&&(Pr=Math.max(Pr,0),_r=Math.min(_r,Bn.count));const Oi=_r-Pr;if(Oi<0||Oi===1/0)return;tr.setup(lt,gt,Cn,Tt,Nn);let is,Dr=rr;if(Nn!==null&&(is=pe.get(Nn),Dr=Jn,Dr.setIndex(is)),lt.isMesh)gt.wireframe===!0?(On.setLineWidth(gt.wireframeLinewidth*Br()),Dr.setMode(Ue.LINES)):Dr.setMode(Ue.TRIANGLES);else if(lt.isLine){let jn=gt.linewidth;jn===void 0&&(jn=1),On.setLineWidth(jn*Br()),lt.isLineSegments?Dr.setMode(Ue.LINES):lt.isLineLoop?Dr.setMode(Ue.LINE_LOOP):Dr.setMode(Ue.LINE_STRIP)}else lt.isPoints?Dr.setMode(Ue.POINTS):lt.isSprite&&Dr.setMode(Ue.TRIANGLES);if(lt.isBatchedMesh)if(lt._multiDrawInstances!==null)_x("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Dr.renderMultiDrawInstances(lt._multiDrawStarts,lt._multiDrawCounts,lt._multiDrawCount,lt._multiDrawInstances);else if(ei.get("WEBGL_multi_draw"))Dr.renderMultiDraw(lt._multiDrawStarts,lt._multiDrawCounts,lt._multiDrawCount);else{const jn=lt._multiDrawStarts,vs=lt._multiDrawCounts,Ur=lt._multiDrawCount,lo=Nn?pe.get(Nn).bytesPerElement:1,wl=Yn.get(gt).currentProgram.getUniforms();for(let Mo=0;Mo<Ur;Mo++)wl.setValue(Ue,"_gl_DrawID",Mo),Dr.render(jn[Mo]/lo,vs[Mo])}else if(lt.isInstancedMesh)Dr.renderInstances(Pr,Oi,lt.count);else if(Tt.isInstancedBufferGeometry){const jn=Tt._maxInstanceCount!==void 0?Tt._maxInstanceCount:1/0,vs=Math.min(Tt.instanceCount,jn);Dr.renderInstances(Pr,Oi,vs)}else Dr.render(Pr,Oi)};function hr(ye,at,Tt){ye.transparent===!0&&ye.side===gl&&ye.forceSinglePass===!1?(ye.side=Qo,ye.needsUpdate=!0,sh(ye,at,Tt),ye.side=E1,ye.needsUpdate=!0,sh(ye,at,Tt),ye.side=gl):sh(ye,at,Tt)}this.compile=function(ye,at,Tt=null){Tt===null&&(Tt=ye),A=vn.get(Tt),A.init(at),X.push(A),Tt.traverseVisible(function(lt){lt.isLight&&lt.layers.test(at.layers)&&(A.pushLight(lt),lt.castShadow&&A.pushShadow(lt))}),ye!==Tt&&ye.traverseVisible(function(lt){lt.isLight&&lt.layers.test(at.layers)&&(A.pushLight(lt),lt.castShadow&&A.pushShadow(lt))}),A.setupLights();const gt=new Set;return ye.traverse(function(lt){if(!(lt.isMesh||lt.isPoints||lt.isLine||lt.isSprite))return;const Kt=lt.material;if(Kt)if(Array.isArray(Kt))for(let bn=0;bn<Kt.length;bn++){const Cn=Kt[bn];hr(Cn,Tt,lt),gt.add(Cn)}else hr(Kt,Tt,lt),gt.add(Kt)}),A=X.pop(),gt},this.compileAsync=function(ye,at,Tt=null){const gt=this.compile(ye,at,Tt);return new Promise(lt=>{function Kt(){if(gt.forEach(function(bn){Yn.get(bn).currentProgram.isReady()&&gt.delete(bn)}),gt.size===0){lt(ye);return}setTimeout(Kt,10)}ei.get("KHR_parallel_shader_compile")!==null?Kt():setTimeout(Kt,10)})};let Qi=null;function Eo(ye){Qi&&Qi(ye)}function ru(){i0.stop()}function I0(){i0.start()}const i0=new Lve;i0.setAnimationLoop(Eo),typeof self<"u"&&i0.setContext(self),this.setAnimationLoop=function(ye){Qi=ye,Yt.setAnimationLoop(ye),ye===null?i0.stop():i0.start()},Yt.addEventListener("sessionstart",ru),Yt.addEventListener("sessionend",I0),this.render=function(ye,at){if(at!==void 0&&at.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(te===!0)return;if(ye.matrixWorldAutoUpdate===!0&&ye.updateMatrixWorld(),at.parent===null&&at.matrixWorldAutoUpdate===!0&&at.updateMatrixWorld(),Yt.enabled===!0&&Yt.isPresenting===!0&&(Yt.cameraAutoUpdate===!0&&Yt.updateCamera(at),at=Yt.getCamera()),ye.isScene===!0&&ye.onBeforeRender(P,ye,at,K),A=vn.get(ye,X.length),A.init(at),X.push(A),hn.multiplyMatrices(at.projectionMatrix,at.matrixWorldInverse),ct.setFromProjectionMatrix(hn),on=this.localClippingEnabled,Pt=Ln.init(this.clippingPlanes,on),B=Kn.get(ye,V.length),B.init(),V.push(B),Yt.enabled===!0&&Yt.isPresenting===!0){const Kt=P.xr.getDepthSensingMesh();Kt!==null&&k0(Kt,at,-1/0,P.sortObjects)}k0(ye,at,0,P.sortObjects),B.finish(),P.sortObjects===!0&&B.sort(rt,ut),Mi=Yt.enabled===!1||Yt.isPresenting===!1||Yt.hasDepthSensing()===!1,Mi&&jt.addToRenderList(B,ye),this.info.render.frame++,Pt===!0&&Ln.beginShadows();const Tt=A.state.shadowsArray;Qn.render(Tt,ye,at),Pt===!0&&Ln.endShadows(),this.info.autoReset===!0&&this.info.reset();const gt=B.opaque,lt=B.transmissive;if(A.setupLights(),at.isArrayCamera){const Kt=at.cameras;if(lt.length>0)for(let bn=0,Cn=Kt.length;bn<Cn;bn++){const Nn=Kt[bn];su(gt,lt,ye,Nn)}Mi&&jt.render(ye);for(let bn=0,Cn=Kt.length;bn<Cn;bn++){const Nn=Kt[bn];iu(B,ye,Nn,Nn.viewport)}}else lt.length>0&&su(gt,lt,ye,at),Mi&&jt.render(ye),iu(B,ye,at);K!==null&&ie===0&&(vr.updateMultisampleRenderTarget(K),vr.updateRenderTargetMipmap(K)),ye.isScene===!0&&ye.onAfterRender(P,ye,at),tr.resetDefaultState(),re=-1,se=null,X.pop(),X.length>0?(A=X[X.length-1],Pt===!0&&Ln.setGlobalState(P.clippingPlanes,A.state.camera)):A=null,V.pop(),V.length>0?B=V[V.length-1]:B=null};function k0(ye,at,Tt,gt){if(ye.visible===!1)return;if(ye.layers.test(at.layers)){if(ye.isGroup)Tt=ye.renderOrder;else if(ye.isLOD)ye.autoUpdate===!0&&ye.update(at);else if(ye.isLight)A.pushLight(ye),ye.castShadow&&A.pushShadow(ye);else if(ye.isSprite){if(!ye.frustumCulled||ct.intersectsSprite(ye)){gt&&Fn.setFromMatrixPosition(ye.matrixWorld).applyMatrix4(hn);const bn=Vt.update(ye),Cn=ye.material;Cn.visible&&B.push(ye,bn,Cn,Tt,Fn.z,null)}}else if((ye.isMesh||ye.isLine||ye.isPoints)&&(!ye.frustumCulled||ct.intersectsObject(ye))){const bn=Vt.update(ye),Cn=ye.material;if(gt&&(ye.boundingSphere!==void 0?(ye.boundingSphere===null&&ye.computeBoundingSphere(),Fn.copy(ye.boundingSphere.center)):(bn.boundingSphere===null&&bn.computeBoundingSphere(),Fn.copy(bn.boundingSphere.center)),Fn.applyMatrix4(ye.matrixWorld).applyMatrix4(hn)),Array.isArray(Cn)){const Nn=bn.groups;for(let fr=0,ar=Nn.length;fr<ar;fr++){const Bn=Nn[fr],Pr=Cn[Bn.materialIndex];Pr&&Pr.visible&&B.push(ye,bn,Pr,Tt,Fn.z,Bn)}}else Cn.visible&&B.push(ye,bn,Cn,Tt,Fn.z,null)}}const Kt=ye.children;for(let bn=0,Cn=Kt.length;bn<Cn;bn++)k0(Kt[bn],at,Tt,gt)}function iu(ye,at,Tt,gt){const lt=ye.opaque,Kt=ye.transmissive,bn=ye.transparent;A.setupLightsView(Tt),Pt===!0&&Ln.setGlobalState(P.clippingPlanes,Tt),gt&&On.viewport(q.copy(gt)),lt.length>0&&ea(lt,at,Tt),Kt.length>0&&ea(Kt,at,Tt),bn.length>0&&ea(bn,at,Tt),On.buffers.depth.setTest(!0),On.buffers.depth.setMask(!0),On.buffers.color.setMask(!0),On.setPolygonOffset(!1)}function su(ye,at,Tt,gt){if((Tt.isScene===!0?Tt.overrideMaterial:null)!==null)return;A.state.transmissionRenderTarget[gt.id]===void 0&&(A.state.transmissionRenderTarget[gt.id]=new bl(1,1,{generateMipmaps:!0,type:ei.has("EXT_color_buffer_half_float")||ei.has("EXT_color_buffer_float")?W3:t0,minFilter:mv,samples:4,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Gr.workingColorSpace}));const Kt=A.state.transmissionRenderTarget[gt.id],bn=gt.viewport||q;Kt.setSize(bn.z*P.transmissionResolutionScale,bn.w*P.transmissionResolutionScale);const Cn=P.getRenderTarget();P.setRenderTarget(Kt),P.getClearColor(tt),st=P.getClearAlpha(),st<1&&P.setClearColor(16777215,.5),P.clear(),Mi&&jt.render(Tt);const Nn=P.toneMapping;P.toneMapping=b1;const fr=gt.viewport;if(gt.viewport!==void 0&&(gt.viewport=void 0),A.setupLightsView(gt),Pt===!0&&Ln.setGlobalState(P.clippingPlanes,gt),ea(ye,Tt,gt),vr.updateMultisampleRenderTarget(Kt),vr.updateRenderTargetMipmap(Kt),ei.has("WEBGL_multisampled_render_to_texture")===!1){let ar=!1;for(let Bn=0,Pr=at.length;Bn<Pr;Bn++){const _r=at[Bn],Oi=_r.object,is=_r.geometry,Dr=_r.material,jn=_r.group;if(Dr.side===gl&&Oi.layers.test(gt.layers)){const vs=Dr.side;Dr.side=Qo,Dr.needsUpdate=!0,ih(Oi,Tt,gt,is,Dr,jn),Dr.side=vs,Dr.needsUpdate=!0,ar=!0}}ar===!0&&(vr.updateMultisampleRenderTarget(Kt),vr.updateRenderTargetMipmap(Kt))}P.setRenderTarget(Cn),P.setClearColor(tt,st),fr!==void 0&&(gt.viewport=fr),P.toneMapping=Nn}function ea(ye,at,Tt){const gt=at.isScene===!0?at.overrideMaterial:null;for(let lt=0,Kt=ye.length;lt<Kt;lt++){const bn=ye[lt],Cn=bn.object,Nn=bn.geometry,fr=bn.group;let ar=bn.material;ar.allowOverride===!0&&gt!==null&&(ar=gt),Cn.layers.test(Tt.layers)&&ih(Cn,at,Tt,Nn,ar,fr)}}function ih(ye,at,Tt,gt,lt,Kt){ye.onBeforeRender(P,at,Tt,gt,lt,Kt),ye.modelViewMatrix.multiplyMatrices(Tt.matrixWorldInverse,ye.matrixWorld),ye.normalMatrix.getNormalMatrix(ye.modelViewMatrix),lt.onBeforeRender(P,at,Tt,gt,ye,Kt),lt.transparent===!0&&lt.side===gl&&lt.forceSinglePass===!1?(lt.side=Qo,lt.needsUpdate=!0,P.renderBufferDirect(Tt,at,gt,lt,ye,Kt),lt.side=E1,lt.needsUpdate=!0,P.renderBufferDirect(Tt,at,gt,lt,ye,Kt),lt.side=gl):P.renderBufferDirect(Tt,at,gt,lt,ye,Kt),ye.onAfterRender(P,at,Tt,gt,lt,Kt)}function sh(ye,at,Tt){at.isScene!==!0&&(at=Kr);const gt=Yn.get(ye),lt=A.state.lights,Kt=A.state.shadowsArray,bn=lt.state.version,Cn=qt.getParameters(ye,lt.state,Kt,at,Tt),Nn=qt.getProgramCacheKey(Cn);let fr=gt.programs;gt.environment=ye.isMeshStandardMaterial?at.environment:null,gt.fog=at.fog,gt.envMap=(ye.isMeshStandardMaterial?Ie:Ci).get(ye.envMap||gt.environment),gt.envMapRotation=gt.environment!==null&&ye.envMap===null?at.environmentRotation:ye.envMapRotation,fr===void 0&&(ye.addEventListener("dispose",kn),fr=new Map,gt.programs=fr);let ar=fr.get(Nn);if(ar!==void 0){if(gt.currentProgram===ar&&gt.lightsStateVersion===bn)return ao(ye,Cn),ar}else Cn.uniforms=qt.getUniforms(ye),ye.onBeforeCompile(Cn,P),ar=qt.acquireProgram(Cn,Nn),fr.set(Nn,ar),gt.uniforms=Cn.uniforms;const Bn=gt.uniforms;return(!ye.isShaderMaterial&&!ye.isRawShaderMaterial||ye.clipping===!0)&&(Bn.clippingPlanes=Ln.uniform),ao(ye,Cn),gt.needsLights=oh(ye),gt.lightsStateVersion=bn,gt.needsLights&&(Bn.ambientLightColor.value=lt.state.ambient,Bn.lightProbe.value=lt.state.probe,Bn.directionalLights.value=lt.state.directional,Bn.directionalLightShadows.value=lt.state.directionalShadow,Bn.spotLights.value=lt.state.spot,Bn.spotLightShadows.value=lt.state.spotShadow,Bn.rectAreaLights.value=lt.state.rectArea,Bn.ltc_1.value=lt.state.rectAreaLTC1,Bn.ltc_2.value=lt.state.rectAreaLTC2,Bn.pointLights.value=lt.state.point,Bn.pointLightShadows.value=lt.state.pointShadow,Bn.hemisphereLights.value=lt.state.hemi,Bn.directionalShadowMap.value=lt.state.directionalShadowMap,Bn.directionalShadowMatrix.value=lt.state.directionalShadowMatrix,Bn.spotShadowMap.value=lt.state.spotShadowMap,Bn.spotLightMatrix.value=lt.state.spotLightMatrix,Bn.spotLightMap.value=lt.state.spotLightMap,Bn.pointShadowMap.value=lt.state.pointShadowMap,Bn.pointShadowMatrix.value=lt.state.pointShadowMatrix),gt.currentProgram=ar,gt.uniformsList=null,ar}function zf(ye){if(ye.uniformsList===null){const at=ye.currentProgram.getUniforms();ye.uniformsList=XI.seqWithValue(at.seq,ye.uniforms)}return ye.uniformsList}function ao(ye,at){const Tt=Yn.get(ye);Tt.outputColorSpace=at.outputColorSpace,Tt.batching=at.batching,Tt.batchingColor=at.batchingColor,Tt.instancing=at.instancing,Tt.instancingColor=at.instancingColor,Tt.instancingMorph=at.instancingMorph,Tt.skinning=at.skinning,Tt.morphTargets=at.morphTargets,Tt.morphNormals=at.morphNormals,Tt.morphColors=at.morphColors,Tt.morphTargetsCount=at.morphTargetsCount,Tt.numClippingPlanes=at.numClippingPlanes,Tt.numIntersection=at.numClipIntersection,Tt.vertexAlphas=at.vertexAlphas,Tt.vertexTangents=at.vertexTangents,Tt.toneMapping=at.toneMapping}function hd(ye,at,Tt,gt,lt){at.isScene!==!0&&(at=Kr),vr.resetTextureUnits();const Kt=at.fog,bn=gt.isMeshStandardMaterial?at.environment:null,Cn=K===null?P.outputColorSpace:K.isXRRenderTarget===!0?K.texture.colorSpace:Ju,Nn=(gt.isMeshStandardMaterial?Ie:Ci).get(gt.envMap||bn),fr=gt.vertexColors===!0&&!!Tt.attributes.color&&Tt.attributes.color.itemSize===4,ar=!!Tt.attributes.tangent&&(!!gt.normalMap||gt.anisotropy>0),Bn=!!Tt.morphAttributes.position,Pr=!!Tt.morphAttributes.normal,_r=!!Tt.morphAttributes.color;let Oi=b1;gt.toneMapped&&(K===null||K.isXRRenderTarget===!0)&&(Oi=P.toneMapping);const is=Tt.morphAttributes.position||Tt.morphAttributes.normal||Tt.morphAttributes.color,Dr=is!==void 0?is.length:0,jn=Yn.get(gt),vs=A.state.lights;if(Pt===!0&&(on===!0||ye!==se)){const co=ye===se&&gt.id===re;Ln.setState(gt,ye,co)}let Ur=!1;gt.version===jn.__version?(jn.needsLights&&jn.lightsStateVersion!==vs.state.version||jn.outputColorSpace!==Cn||lt.isBatchedMesh&&jn.batching===!1||!lt.isBatchedMesh&&jn.batching===!0||lt.isBatchedMesh&&jn.batchingColor===!0&&lt.colorTexture===null||lt.isBatchedMesh&&jn.batchingColor===!1&&lt.colorTexture!==null||lt.isInstancedMesh&&jn.instancing===!1||!lt.isInstancedMesh&&jn.instancing===!0||lt.isSkinnedMesh&&jn.skinning===!1||!lt.isSkinnedMesh&&jn.skinning===!0||lt.isInstancedMesh&&jn.instancingColor===!0&&lt.instanceColor===null||lt.isInstancedMesh&&jn.instancingColor===!1&&lt.instanceColor!==null||lt.isInstancedMesh&&jn.instancingMorph===!0&&lt.morphTexture===null||lt.isInstancedMesh&&jn.instancingMorph===!1&&lt.morphTexture!==null||jn.envMap!==Nn||gt.fog===!0&&jn.fog!==Kt||jn.numClippingPlanes!==void 0&&(jn.numClippingPlanes!==Ln.numPlanes||jn.numIntersection!==Ln.numIntersection)||jn.vertexAlphas!==fr||jn.vertexTangents!==ar||jn.morphTargets!==Bn||jn.morphNormals!==Pr||jn.morphColors!==_r||jn.toneMapping!==Oi||jn.morphTargetsCount!==Dr)&&(Ur=!0):(Ur=!0,jn.__version=gt.version);let lo=jn.currentProgram;Ur===!0&&(lo=sh(gt,at,lt));let wl=!1,Mo=!1,s0=!1;const Li=lo.getUniforms(),ys=jn.uniforms;if(On.useProgram(lo.program)&&(wl=!0,Mo=!0,s0=!0),gt.id!==re&&(re=gt.id,Mo=!0),wl||se!==ye){On.buffers.depth.getReversed()?(Gt.copy(ye.projectionMatrix),KRe(Gt),ZRe(Gt),Li.setValue(Ue,"projectionMatrix",Gt)):Li.setValue(Ue,"projectionMatrix",ye.projectionMatrix),Li.setValue(Ue,"viewMatrix",ye.matrixWorldInverse);const ks=Li.map.cameraPosition;ks!==void 0&&ks.setValue(Ue,Xn.setFromMatrixPosition(ye.matrixWorld)),Ar.logarithmicDepthBuffer&&Li.setValue(Ue,"logDepthBufFC",2/(Math.log(ye.far+1)/Math.LN2)),(gt.isMeshPhongMaterial||gt.isMeshToonMaterial||gt.isMeshLambertMaterial||gt.isMeshBasicMaterial||gt.isMeshStandardMaterial||gt.isShaderMaterial)&&Li.setValue(Ue,"isOrthographic",ye.isOrthographicCamera===!0),se!==ye&&(se=ye,Mo=!0,s0=!0)}if(lt.isSkinnedMesh){Li.setOptional(Ue,lt,"bindMatrix"),Li.setOptional(Ue,lt,"bindMatrixInverse");const co=lt.skeleton;co&&(co.boneTexture===null&&co.computeBoneTexture(),Li.setValue(Ue,"boneTexture",co.boneTexture,vr))}lt.isBatchedMesh&&(Li.setOptional(Ue,lt,"batchingTexture"),Li.setValue(Ue,"batchingTexture",lt._matricesTexture,vr),Li.setOptional(Ue,lt,"batchingIdTexture"),Li.setValue(Ue,"batchingIdTexture",lt._indirectTexture,vr),Li.setOptional(Ue,lt,"batchingColorTexture"),lt._colorsTexture!==null&&Li.setValue(Ue,"batchingColorTexture",lt._colorsTexture,vr));const xs=Tt.morphAttributes;if((xs.position!==void 0||xs.normal!==void 0||xs.color!==void 0)&&Rn.update(lt,Tt,lo),(Mo||jn.receiveShadow!==lt.receiveShadow)&&(jn.receiveShadow=lt.receiveShadow,Li.setValue(Ue,"receiveShadow",lt.receiveShadow)),gt.isMeshGouraudMaterial&&gt.envMap!==null&&(ys.envMap.value=Nn,ys.flipEnvMap.value=Nn.isCubeTexture&&Nn.isRenderTargetTexture===!1?-1:1),gt.isMeshStandardMaterial&&gt.envMap===null&&at.environment!==null&&(ys.envMapIntensity.value=at.environmentIntensity),Mo&&(Li.setValue(Ue,"toneMappingExposure",P.toneMappingExposure),jn.needsLights&&fc(ys,s0),Kt&&gt.fog===!0&&Ot.refreshFogUniforms(ys,Kt),Ot.refreshMaterialUniforms(ys,gt,Se,ft,A.state.transmissionRenderTarget[ye.id]),XI.upload(Ue,zf(jn),ys,vr)),gt.isShaderMaterial&&gt.uniformsNeedUpdate===!0&&(XI.upload(Ue,zf(jn),ys,vr),gt.uniformsNeedUpdate=!1),gt.isSpriteMaterial&&Li.setValue(Ue,"center",lt.center),Li.setValue(Ue,"modelViewMatrix",lt.modelViewMatrix),Li.setValue(Ue,"normalMatrix",lt.normalMatrix),Li.setValue(Ue,"modelMatrix",lt.matrixWorld),gt.isShaderMaterial||gt.isRawShaderMaterial){const co=gt.uniformsGroups;for(let ks=0,ti=co.length;ks<ti;ks++){const Co=co[ks];je.update(Co,lo),je.bind(Co,lo)}}return lo}function fc(ye,at){ye.ambientLightColor.needsUpdate=at,ye.lightProbe.needsUpdate=at,ye.directionalLights.needsUpdate=at,ye.directionalLightShadows.needsUpdate=at,ye.pointLights.needsUpdate=at,ye.pointLightShadows.needsUpdate=at,ye.spotLights.needsUpdate=at,ye.spotLightShadows.needsUpdate=at,ye.rectAreaLights.needsUpdate=at,ye.hemisphereLights.needsUpdate=at}function oh(ye){return ye.isMeshLambertMaterial||ye.isMeshToonMaterial||ye.isMeshPhongMaterial||ye.isMeshStandardMaterial||ye.isShadowMaterial||ye.isShaderMaterial&&ye.lights===!0}this.getActiveCubeFace=function(){return oe},this.getActiveMipmapLevel=function(){return ie},this.getRenderTarget=function(){return K},this.setRenderTargetTextures=function(ye,at,Tt){const gt=Yn.get(ye);gt.__autoAllocateDepthBuffer=ye.resolveDepthBuffer===!1,gt.__autoAllocateDepthBuffer===!1&&(gt.__useRenderToTexture=!1),Yn.get(ye.texture).__webglTexture=at,Yn.get(ye.depthTexture).__webglTexture=gt.__autoAllocateDepthBuffer?void 0:Tt,gt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ye,at){const Tt=Yn.get(ye);Tt.__webglFramebuffer=at,Tt.__useDefaultFramebuffer=at===void 0};const To=Ue.createFramebuffer();this.setRenderTarget=function(ye,at=0,Tt=0){K=ye,oe=at,ie=Tt;let gt=!0,lt=null,Kt=!1,bn=!1;if(ye){const Nn=Yn.get(ye);if(Nn.__useDefaultFramebuffer!==void 0)On.bindFramebuffer(Ue.FRAMEBUFFER,null),gt=!1;else if(Nn.__webglFramebuffer===void 0)vr.setupRenderTarget(ye);else if(Nn.__hasExternalTextures)vr.rebindTextures(ye,Yn.get(ye.texture).__webglTexture,Yn.get(ye.depthTexture).__webglTexture);else if(ye.depthBuffer){const Bn=ye.depthTexture;if(Nn.__boundDepthTexture!==Bn){if(Bn!==null&&Yn.has(Bn)&&(ye.width!==Bn.image.width||ye.height!==Bn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");vr.setupDepthRenderbuffer(ye)}}const fr=ye.texture;(fr.isData3DTexture||fr.isDataArrayTexture||fr.isCompressedArrayTexture)&&(bn=!0);const ar=Yn.get(ye).__webglFramebuffer;ye.isWebGLCubeRenderTarget?(Array.isArray(ar[at])?lt=ar[at][Tt]:lt=ar[at],Kt=!0):ye.samples>0&&vr.useMultisampledRTT(ye)===!1?lt=Yn.get(ye).__webglMultisampledFramebuffer:Array.isArray(ar)?lt=ar[Tt]:lt=ar,q.copy(ye.viewport),De.copy(ye.scissor),Be=ye.scissorTest}else q.copy(Pe).multiplyScalar(Se).floor(),De.copy(vt).multiplyScalar(Se).floor(),Be=Bt;if(Tt!==0&&(lt=To),On.bindFramebuffer(Ue.FRAMEBUFFER,lt)&&gt&&On.drawBuffers(ye,lt),On.viewport(q),On.scissor(De),On.setScissorTest(Be),Kt){const Nn=Yn.get(ye.texture);Ue.framebufferTexture2D(Ue.FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Ue.TEXTURE_CUBE_MAP_POSITIVE_X+at,Nn.__webglTexture,Tt)}else if(bn){const Nn=Yn.get(ye.texture),fr=at;Ue.framebufferTextureLayer(Ue.FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Nn.__webglTexture,Tt,fr)}else if(ye!==null&&Tt!==0){const Nn=Yn.get(ye.texture);Ue.framebufferTexture2D(Ue.FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Ue.TEXTURE_2D,Nn.__webglTexture,Tt)}re=-1},this.readRenderTargetPixels=function(ye,at,Tt,gt,lt,Kt,bn,Cn=0){if(!(ye&&ye.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Nn=Yn.get(ye).__webglFramebuffer;if(ye.isWebGLCubeRenderTarget&&bn!==void 0&&(Nn=Nn[bn]),Nn){On.bindFramebuffer(Ue.FRAMEBUFFER,Nn);try{const fr=ye.textures[Cn],ar=fr.format,Bn=fr.type;if(!Ar.textureFormatReadable(ar)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ar.textureTypeReadable(Bn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}at>=0&&at<=ye.width-gt&&Tt>=0&&Tt<=ye.height-lt&&(ye.textures.length>1&&Ue.readBuffer(Ue.COLOR_ATTACHMENT0+Cn),Ue.readPixels(at,Tt,gt,lt,_n.convert(ar),_n.convert(Bn),Kt))}finally{const fr=K!==null?Yn.get(K).__webglFramebuffer:null;On.bindFramebuffer(Ue.FRAMEBUFFER,fr)}}},this.readRenderTargetPixelsAsync=async function(ye,at,Tt,gt,lt,Kt,bn,Cn=0){if(!(ye&&ye.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Nn=Yn.get(ye).__webglFramebuffer;if(ye.isWebGLCubeRenderTarget&&bn!==void 0&&(Nn=Nn[bn]),Nn)if(at>=0&&at<=ye.width-gt&&Tt>=0&&Tt<=ye.height-lt){On.bindFramebuffer(Ue.FRAMEBUFFER,Nn);const fr=ye.textures[Cn],ar=fr.format,Bn=fr.type;if(!Ar.textureFormatReadable(ar))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ar.textureTypeReadable(Bn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Pr=Ue.createBuffer();Ue.bindBuffer(Ue.PIXEL_PACK_BUFFER,Pr),Ue.bufferData(Ue.PIXEL_PACK_BUFFER,Kt.byteLength,Ue.STREAM_READ),ye.textures.length>1&&Ue.readBuffer(Ue.COLOR_ATTACHMENT0+Cn),Ue.readPixels(at,Tt,gt,lt,_n.convert(ar),_n.convert(Bn),0);const _r=K!==null?Yn.get(K).__webglFramebuffer:null;On.bindFramebuffer(Ue.FRAMEBUFFER,_r);const Oi=Ue.fenceSync(Ue.SYNC_GPU_COMMANDS_COMPLETE,0);return Ue.flush(),await YRe(Ue,Oi,4),Ue.bindBuffer(Ue.PIXEL_PACK_BUFFER,Pr),Ue.getBufferSubData(Ue.PIXEL_PACK_BUFFER,0,Kt),Ue.deleteBuffer(Pr),Ue.deleteSync(Oi),Kt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ye,at=null,Tt=0){const gt=Math.pow(2,-Tt),lt=Math.floor(ye.image.width*gt),Kt=Math.floor(ye.image.height*gt),bn=at!==null?at.x:0,Cn=at!==null?at.y:0;vr.setTexture2D(ye,0),Ue.copyTexSubImage2D(Ue.TEXTURE_2D,Tt,0,0,bn,Cn,lt,Kt),On.unbindTexture()};const va=Ue.createFramebuffer(),Vf=Ue.createFramebuffer();this.copyTextureToTexture=function(ye,at,Tt=null,gt=null,lt=0,Kt=null){Kt===null&&(lt!==0?(_x("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Kt=lt,lt=0):Kt=0);let bn,Cn,Nn,fr,ar,Bn,Pr,_r,Oi;const is=ye.isCompressedTexture?ye.mipmaps[Kt]:ye.image;if(Tt!==null)bn=Tt.max.x-Tt.min.x,Cn=Tt.max.y-Tt.min.y,Nn=Tt.isBox3?Tt.max.z-Tt.min.z:1,fr=Tt.min.x,ar=Tt.min.y,Bn=Tt.isBox3?Tt.min.z:0;else{const xs=Math.pow(2,-lt);bn=Math.floor(is.width*xs),Cn=Math.floor(is.height*xs),ye.isDataArrayTexture?Nn=is.depth:ye.isData3DTexture?Nn=Math.floor(is.depth*xs):Nn=1,fr=0,ar=0,Bn=0}gt!==null?(Pr=gt.x,_r=gt.y,Oi=gt.z):(Pr=0,_r=0,Oi=0);const Dr=_n.convert(at.format),jn=_n.convert(at.type);let vs;at.isData3DTexture?(vr.setTexture3D(at,0),vs=Ue.TEXTURE_3D):at.isDataArrayTexture||at.isCompressedArrayTexture?(vr.setTexture2DArray(at,0),vs=Ue.TEXTURE_2D_ARRAY):(vr.setTexture2D(at,0),vs=Ue.TEXTURE_2D),Ue.pixelStorei(Ue.UNPACK_FLIP_Y_WEBGL,at.flipY),Ue.pixelStorei(Ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,at.premultiplyAlpha),Ue.pixelStorei(Ue.UNPACK_ALIGNMENT,at.unpackAlignment);const Ur=Ue.getParameter(Ue.UNPACK_ROW_LENGTH),lo=Ue.getParameter(Ue.UNPACK_IMAGE_HEIGHT),wl=Ue.getParameter(Ue.UNPACK_SKIP_PIXELS),Mo=Ue.getParameter(Ue.UNPACK_SKIP_ROWS),s0=Ue.getParameter(Ue.UNPACK_SKIP_IMAGES);Ue.pixelStorei(Ue.UNPACK_ROW_LENGTH,is.width),Ue.pixelStorei(Ue.UNPACK_IMAGE_HEIGHT,is.height),Ue.pixelStorei(Ue.UNPACK_SKIP_PIXELS,fr),Ue.pixelStorei(Ue.UNPACK_SKIP_ROWS,ar),Ue.pixelStorei(Ue.UNPACK_SKIP_IMAGES,Bn);const Li=ye.isDataArrayTexture||ye.isData3DTexture,ys=at.isDataArrayTexture||at.isData3DTexture;if(ye.isDepthTexture){const xs=Yn.get(ye),co=Yn.get(at),ks=Yn.get(xs.__renderTarget),ti=Yn.get(co.__renderTarget);On.bindFramebuffer(Ue.READ_FRAMEBUFFER,ks.__webglFramebuffer),On.bindFramebuffer(Ue.DRAW_FRAMEBUFFER,ti.__webglFramebuffer);for(let Co=0;Co<Nn;Co++)Li&&(Ue.framebufferTextureLayer(Ue.READ_FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Yn.get(ye).__webglTexture,lt,Bn+Co),Ue.framebufferTextureLayer(Ue.DRAW_FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Yn.get(at).__webglTexture,Kt,Oi+Co)),Ue.blitFramebuffer(fr,ar,bn,Cn,Pr,_r,bn,Cn,Ue.DEPTH_BUFFER_BIT,Ue.NEAREST);On.bindFramebuffer(Ue.READ_FRAMEBUFFER,null),On.bindFramebuffer(Ue.DRAW_FRAMEBUFFER,null)}else if(lt!==0||ye.isRenderTargetTexture||Yn.has(ye)){const xs=Yn.get(ye),co=Yn.get(at);On.bindFramebuffer(Ue.READ_FRAMEBUFFER,va),On.bindFramebuffer(Ue.DRAW_FRAMEBUFFER,Vf);for(let ks=0;ks<Nn;ks++)Li?Ue.framebufferTextureLayer(Ue.READ_FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,xs.__webglTexture,lt,Bn+ks):Ue.framebufferTexture2D(Ue.READ_FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Ue.TEXTURE_2D,xs.__webglTexture,lt),ys?Ue.framebufferTextureLayer(Ue.DRAW_FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,co.__webglTexture,Kt,Oi+ks):Ue.framebufferTexture2D(Ue.DRAW_FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Ue.TEXTURE_2D,co.__webglTexture,Kt),lt!==0?Ue.blitFramebuffer(fr,ar,bn,Cn,Pr,_r,bn,Cn,Ue.COLOR_BUFFER_BIT,Ue.NEAREST):ys?Ue.copyTexSubImage3D(vs,Kt,Pr,_r,Oi+ks,fr,ar,bn,Cn):Ue.copyTexSubImage2D(vs,Kt,Pr,_r,fr,ar,bn,Cn);On.bindFramebuffer(Ue.READ_FRAMEBUFFER,null),On.bindFramebuffer(Ue.DRAW_FRAMEBUFFER,null)}else ys?ye.isDataTexture||ye.isData3DTexture?Ue.texSubImage3D(vs,Kt,Pr,_r,Oi,bn,Cn,Nn,Dr,jn,is.data):at.isCompressedArrayTexture?Ue.compressedTexSubImage3D(vs,Kt,Pr,_r,Oi,bn,Cn,Nn,Dr,is.data):Ue.texSubImage3D(vs,Kt,Pr,_r,Oi,bn,Cn,Nn,Dr,jn,is):ye.isDataTexture?Ue.texSubImage2D(Ue.TEXTURE_2D,Kt,Pr,_r,bn,Cn,Dr,jn,is.data):ye.isCompressedTexture?Ue.compressedTexSubImage2D(Ue.TEXTURE_2D,Kt,Pr,_r,is.width,is.height,Dr,is.data):Ue.texSubImage2D(Ue.TEXTURE_2D,Kt,Pr,_r,bn,Cn,Dr,jn,is);Ue.pixelStorei(Ue.UNPACK_ROW_LENGTH,Ur),Ue.pixelStorei(Ue.UNPACK_IMAGE_HEIGHT,lo),Ue.pixelStorei(Ue.UNPACK_SKIP_PIXELS,wl),Ue.pixelStorei(Ue.UNPACK_SKIP_ROWS,Mo),Ue.pixelStorei(Ue.UNPACK_SKIP_IMAGES,s0),Kt===0&&at.generateMipmaps&&Ue.generateMipmap(vs),On.unbindTexture()},this.copyTextureToTexture3D=function(ye,at,Tt=null,gt=null,lt=0){return _x('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(ye,at,Tt,gt,lt)},this.initRenderTarget=function(ye){Yn.get(ye).__webglFramebuffer===void 0&&vr.setupRenderTarget(ye)},this.initTexture=function(ye){ye.isCubeTexture?vr.setTextureCube(ye,0):ye.isData3DTexture?vr.setTexture3D(ye,0):ye.isDataArrayTexture||ye.isCompressedArrayTexture?vr.setTexture2DArray(ye,0):vr.setTexture2D(ye,0),On.unbindTexture()},this.resetState=function(){oe=0,ie=0,K=null,On.reset(),tr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return x1}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Gr._getDrawingBufferColorSpace(e),t.unpackColorSpace=Gr._getUnpackColorSpace()}}const KV=!0,ZV=document.location.hash.search("editor")>-1;var gk=(s=>(s.LOAD_COMPLETE="Events::loadComplete",s))(gk||{});const AH=new nh;function QV(s,e,t,n){return new(t||(t=Promise))(function(r,i){function a(p){try{u(n.next(p))}catch(y){i(y)}}function c(p){try{u(n.throw(p))}catch(y){i(y)}}function u(p){var y;p.done?r(p.value):(y=p.value,y instanceof t?y:new t(function(x){x(y)})).then(a,c)}u((n=n.apply(s,[])).next())})}const xFe=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function z3e(s){return s=s.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const Vve=typeof window>"u",m1=(()=>{if(Vve)return;const{userAgent:s,platform:e,maxTouchPoints:t}=window.navigator,n=/(iphone|ipod|ipad)/i.test(s),r=e==="iPad"||e==="MacIntel"&&t>0&&!window.MSStream;return{isIpad:r,isMobile:/android/i.test(s)||n||r,isSafari12:/Version\/12.+Safari/.test(s),isFirefox:/Firefox/.test(s)}})();function _Fe(s,e,t){if(!t)return[e];const n=function(p){const y=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,x=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,S=p.createShader(35633),M=p.createShader(35632),I=p.createProgram();if(!(M&&S&&I))return;p.shaderSource(S,y),p.shaderSource(M,x),p.compileShader(S),p.compileShader(M),p.attachShader(I,S),p.attachShader(I,M),p.linkProgram(I),p.detachShader(I,S),p.detachShader(I,M),p.deleteShader(S),p.deleteShader(M),p.useProgram(I);const L=p.createBuffer();p.bindBuffer(34962,L),p.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const B=p.getAttribLocation(I,"aPosition");p.vertexAttribPointer(B,3,5126,!1,0,0),p.enableVertexAttribArray(B),p.clearColor(1,1,1,1),p.clear(16384),p.viewport(0,0,1,1),p.drawArrays(4,0,3);const A=new Uint8Array(4);return p.readPixels(0,0,1,1,6408,5121,A),p.deleteProgram(I),p.deleteBuffer(L),A.join("")}(s),r="801621810",i="8016218135",a="80162181161",c=m1!=null&&m1.isIpad?[["a7",a,12],["a8",i,15],["a8x",i,15],["a9",i,15],["a9x",i,15],["a10",i,15],["a10x",i,15],["a12",r,15],["a12x",r,15],["a12z",r,15],["a14",r,15],["a15",r,15],["m1",r,15],["m2",r,15]]:[["a7",a,12],["a8",i,12],["a9",i,15],["a10",i,15],["a11",r,15],["a12",r,15],["a13",r,15],["a14",r,15],["a15",r,15],["a16",r,15],["a17",r,15]];let u;return n==="80162181255"?u=c.filter(([,,p])=>p>=14):(u=c.filter(([,p])=>p===n),u.length||(u=c)),u.map(([p])=>`apple ${p} gpu`)}let V3e=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}};const JV=[],G3e=[];function bFe(s,e){if(s===e)return 0;const t=s;s.length>e.length&&(s=e,e=t);let n=s.length,r=e.length;for(;n>0&&s.charCodeAt(~-n)===e.charCodeAt(~-r);)n--,r--;let i,a=0;for(;a<n&&s.charCodeAt(a)===e.charCodeAt(a);)a++;if(n-=a,r-=a,n===0)return r;let c,u,p=0,y=0,x=0;for(;y<n;)G3e[y]=s.charCodeAt(a+y),JV[y]=++y;for(;x<r;)for(i=e.charCodeAt(a+x),c=x++,p=x,y=0;y<n;y++)u=i===G3e[y]?c:c+1,c=JV[y],p=JV[y]=c>p?u>p?p+1:u:u>c?c+1:u;return p}function SFe(s){return s!=null}const wFe=({mobileTiers:s=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:n,failIfMajorPerformanceCaveat:r=!1,benchmarksURL:i="https://unpkg.com/detect-gpu@5.0.70/dist/benchmarks"}={})=>QV(void 0,void 0,void 0,function*(){const a={};if(Vve)return{tier:0,type:"SSR"};const{isIpad:c=!!(m1!=null&&m1.isIpad),isMobile:u=!!(m1!=null&&m1.isMobile),screenSize:p=window.screen,loadBenchmarks:y=te=>QV(void 0,void 0,void 0,function*(){const oe=yield fetch(`${i}/${te}`).then(ie=>ie.json());if(parseInt(oe.shift().split(".")[0],10)<4)throw new V3e("Detect GPU benchmark data is out of date. Please update to version 4x");return oe})}=t;let{renderer:x}=t;const S=(te,oe,ie,K,re)=>({device:re,fps:K,gpu:ie,isMobile:u,tier:te,type:oe});let M,I="";if(x)x=z3e(x),M=[x];else{const te=n||function(ie,K=!1){const re={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:K,powerPreference:"high-performance",stencil:!1};ie&&delete re.powerPreference;const se=window.document.createElement("canvas"),q=se.getContext("webgl",re)||se.getContext("experimental-webgl",re);return q??void 0}(m1==null?void 0:m1.isSafari12,r);if(!te)return S(0,"WEBGL_UNSUPPORTED");const oe=m1!=null&&m1.isFirefox?null:te.getExtension("WEBGL_debug_renderer_info");if(x=oe?te.getParameter(oe.UNMASKED_RENDERER_WEBGL):te.getParameter(te.RENDERER),!x)return S(1,"FALLBACK");I=x,x=z3e(x),M=function(ie,K,re){return K==="apple gpu"?_Fe(ie,K,re):[K]}(te,x,u)}const L=(yield Promise.all(M.map(function(te){var oe;return QV(this,void 0,void 0,function*(){const ie=(Bt=>{const ct=u?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const Pt of ct)if(Bt.includes(Pt))return Pt})(te);if(!ie)return;const K=`${u?"m":"d"}-${ie}${c?"-ipad":""}.json`,re=a[K]=(oe=a[K])!==null&&oe!==void 0?oe:y(K);let se;try{se=yield re}catch(Bt){if(Bt instanceof V3e)throw Bt;return}const q=function(Bt){var ct;const Pt=(Bt=Bt.replace(/\([^)]+\)/,"")).match(/\d+/)||Bt.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(ct=Pt==null?void 0:Pt.join("").replace(/\W|amd/g,""))!==null&&ct!==void 0?ct:""}(te);let De=se.filter(([,Bt])=>Bt===q);De.length||(De=se.filter(([Bt])=>Bt.includes(te)));const Be=De.length;if(Be===0)return;const tt=te.split(/[.,()\[\]/\s]/g).sort().filter((Bt,ct,Pt)=>ct===0||Bt!==Pt[ct-1]).join(" ");let st,[de,,,,ft]=Be>1?De.map(Bt=>[Bt,bFe(tt,Bt[2])]).sort(([,Bt],[,ct])=>Bt-ct)[0][0]:De[0],Se=Number.MAX_VALUE;const{devicePixelRatio:rt}=window,ut=p.width*rt*p.height*rt;for(const Bt of ft){const[ct,Pt]=Bt,on=ct*Pt,Gt=Math.abs(ut-on);Gt<Se&&(Se=Gt,st=Bt)}if(!st)return;const[,,Pe,vt]=st;return[Se,Pe,de,vt]})}))).filter(SFe).sort(([te=Number.MAX_VALUE,oe],[ie=Number.MAX_VALUE,K])=>te===ie?oe-K:te-ie);if(!L.length){const te=xFe.find(oe=>x.includes(oe));return te?S(0,"BLOCKLISTED",te):S(1,"FALLBACK",`${x} (${I})`)}const[,B,A,V]=L[0];if(B===-1)return S(0,"BLOCKLISTED",A,B,V);const X=u?s:e;let P=0;for(let te=0;te<X.length;te++)B>=X[te]&&(P=te);return S(P,"BENCHMARK",A,B,V)});function EFe(s){let e=0;const t=performance.now();function n(){e++;const r=performance.now();if(r-t>=100){const i=e/((r-t)/1e3),a=Math.round(i/30)*30;s(a)}else requestAnimationFrame(n)}requestAnimationFrame(n)}function TFe(s=!1,e=!1){return new Promise(t=>{wFe().then(n=>{let r=!1;const i=document.createElement("canvas"),a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(r="transferControlToOffscreen"in i,a){const u=navigator.userAgent.match(/version\/(\d+)/i);r=(u?parseInt(u[1]):0)>=17}const c={dpr:devicePixelRatio,fps:30,width:innerWidth,height:innerHeight,mobile:n.isMobile!==void 0?n.isMobile:!1,supportOffScreenCanvas:r,supportWebGPU:!!navigator.gpu,quality:"Low",dev:s,editor:e};n.tier===3?c.quality="High":n.tier===2&&(c.quality="Medium"),EFe(u=>{c.fps=u,t(c)})})})}class MFe{constructor(){Xe(this,"assets",{audio:new Map,image:new Map,json:new Map,model:new Map,video:new Map});Xe(this,"components",new Map);Xe(this,"settings",{dpr:1,fps:30,width:0,height:0,mobile:!1,supportOffScreenCanvas:!1,supportWebGPU:!1,quality:"Low",dev:!1,editor:!1});Xe(this,"onUpdateCallback");Xe(this,"playing",!1);Xe(this,"rafID",-1);Xe(this,"play",()=>{this.playing||(this.playing=!0,this.onUpdate())});Xe(this,"pause",()=>{this.playing&&(this.playing=!1,cancelAnimationFrame(this.rafID),this.rafID=-1)});Xe(this,"onUpdate",()=>{this.update(),this.isApp&&this.draw(),this.onUpdateCallback&&this.onUpdateCallback(),this.rafID=requestAnimationFrame(this.onUpdate)})}dispose(){this.pause(),this.components.forEach(e=>e.dispose()),this.components.clear()}detectSettings(e=!1,t=!1){return new Promise(n=>{TFe(e,t).then(r=>{this.settings=r,n()})})}update(){}draw(){}addComponent(e,t){this.components.set(e,t)}get debugEnabled(){return this.settings.dev}get isApp(){return!this.editor}set isApp(e){this.editor=!e}get editor(){return this.settings.editor}set editor(e){this.settings.editor=e}}var CFe=I8e();class Gve{constructor(e,t=!1,n=!1){Xe(this,"name");Xe(this,"_debug",!1);Xe(this,"_editor",!1);Xe(this,"broadcastChannel");this.name=e,this._debug=t,this._editor=n,t&&(this.broadcastChannel=new BroadcastChannel(e),this.broadcastChannel.addEventListener("message",this.messageHandler.bind(this)))}dispose(){var e,t;(e=this.broadcastChannel)==null||e.removeEventListener("message",this.messageHandler.bind(this)),(t=this.broadcastChannel)==null||t.close()}get debug(){return this._debug}get editor(){return this._editor}send(e){var n;if(this.editor&&e.target==="app"||!this.editor&&e.target==="editor")try{(n=this.broadcastChannel)==null||n.postMessage(e)}catch(r){console.log("Hermes - Error sending message:"),console.log(r),console.log(e)}}messageHandler(e){const t=e.data;t.target==="app"?this.handleApp(t):this.handleEditor(t)}handleApp(e){}handleEditor(e){}}const jve=()=>{};function vk(s){return s.substring(0,1).toUpperCase()+s.substring(1)}function AFe(s){const e=JSON.stringify(s);return navigator.clipboard.writeText(e),e}function P0(){return Math.round(Math.random()*1e6).toString()}function PFe(s){return s.r!==void 0&&s.g!==void 0&&s.b!==void 0}function j3e(s){const e=Math.round(s.r*255),t=Math.round(s.g*255),n=Math.round(s.b*255),r=u=>{const p=u.toString(16);return p.length===1?"0"+p:p},i=r(e),a=r(t),c=r(n);return"#"+i+a+c}function RFe(s,e,t,n,r){const i=1-s;return i*i*i*e+3*i*i*s*t+3*i*s*s*n+s*s*s*r}function IFe(s,e,t){if(s.type!=="bezier"||s.handles.length!==4)throw new Error("Invalid keyframe data for Bzier interpolation.");const[n,r]=s.handles,i=(t-s.position)/(e.position-s.position);return RFe(i,s.value,s.value+n,e.value+r,e.value)}class kFe extends Gve{constructor(t=!1,n=!1){super("RemoteTheatre",t,n);Xe(this,"project");Xe(this,"sheets",new Map);Xe(this,"sheetObjects",new Map);Xe(this,"sheetObjectCBs",new Map);Xe(this,"sheetObjectUnsubscribe",new Map);Xe(this,"activeSheet");Xe(this,"studio")}dispose(){this.project=void 0,this.sheets=new Map,this.sheetObjects=new Map,this.sheetObjectCBs=new Map,this.sheetObjectUnsubscribe=new Map}loadProject(t,n){return console.log(t,n),this.project=CFe.getProject(t,{state:n}),new Promise((r,i)=>{var a;(a=this.project)==null||a.ready.then(()=>{if(n){const c=n.sheetsById;console.log("loaded sheets",c);for(const u in c)this.sheet(u)}r()}).catch(()=>i())})}getSheetInstance(t,n){return n!==void 0?`${t}-${n}`:t}sheet(t,n){var a;if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const r=this.getSheetInstance(t,n);let i=this.sheets.get(r);return i!==void 0||(i=(a=this.project)==null?void 0:a.sheet(t,n),this.sheets.set(r,i)),i}playSheet(t,n,r){return new Promise(i=>{var a;(a=this.sheet(t,r))==null||a.sequence.play(n).then(c=>i(c)),this.send({event:"playSheet",target:"editor",data:{sheet:t,instance:r,value:n}})})}pauseSheet(t,n){var r;(r=this.sheet(t,n))==null||r.sequence.pause(),this.send({event:"pauseSheet",target:"editor",data:{sheet:t,instance:n}})}clearSheetObjects(t){this.sheetObjects.forEach((n,r)=>{r.search(`${t}_`)>-1&&this.unsubscribe(n)})}sheetObject(t,n,r,i,a){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const c=this.sheet(t,a);if(c===void 0)return;const p=`${this.getSheetInstance(t,a)}_${n}`;let y=this.sheetObjects.get(p),x=r;y!==void 0&&(x={...r,...y.value}),y=c.object(n,x,{reconfigure:!0}),this.sheetObjects.set(p,y),this.sheetObjectCBs.set(p,i!==void 0?i:jve);function S(I,L,B){if(typeof B=="object")if(PFe(B))I[L]={r:B.r,g:B.g,b:B.b,a:B.a};else for(const A in B){const V=B[A];typeof V=="object"&&S(B,A,V)}}const M=y.onValuesChange(I=>{const L=this.sheetObjectCBs.get(p);if(this.editor){for(const B in I){const A=I[B];typeof A=="object"&&S(I,B,A)}this.send({event:"updateSheetObject",target:"app",data:{sheet:t,sheetObject:p,values:I}}),L&&L(I)}else L&&L(I)});return this.sheetObjectUnsubscribe.set(p,M),y}getSheetObjectKeyframes(t,n,r){const i=this.sheet(t);if(i===void 0)return[];const a=`${t}_${n}`,c=this.sheetObjects.get(a);return c===void 0?[]:i.sequence.__experimental_getKeyframes(c.props[r])}getSheetObjectVectors(t,n){const r=this.sheet(t);if(r===void 0)return[];const i=`${t}_${n}`,a=this.sheetObjects.get(i);if(a===void 0)return[];const c=[],u=r.sequence.__experimental_getKeyframes(a.props.x),p=r.sequence.__experimental_getKeyframes(a.props.y),y=r.sequence.__experimental_getKeyframes(a.props.z),x=new Set;return u.forEach(M=>x.add(M.position)),p.forEach(M=>x.add(M.position)),y.forEach(M=>x.add(M.position)),Array.from(x).sort((M,I)=>M-I).forEach(M=>{const I=(L,B)=>{const A=L.find((P,te)=>{var oe;return P.position<=B&&(((oe=L[te+1])==null?void 0:oe.position)||1/0)>B}),V=L.find(P=>P.position>B);if(!A)return(V==null?void 0:V.value)||0;if(!V||A.position===B)return A.value;if(A.type==="bezier")return IFe(A,V,B);const X=(B-A.position)/(V.position-A.position);return A.value+X*(V.value-A.value)};c.push({position:M,x:I(u,M),y:I(p,M),z:I(y,M)})}),c}update(t){}unsubscribe(t){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const n=t.address.sheetId,r=t.address.objectKey,i=this.sheets.get(n);i==null||i.detachObject(r);const a=`${n}_${r}`,c=this.sheetObjectUnsubscribe.get(a);c!==void 0&&(this.sheetObjects.delete(a),this.sheetObjectCBs.delete(a),this.sheetObjectUnsubscribe.delete(a),c())}handleApp(t){var r,i;let n;switch(t.event){case"setSheet":n=this.sheets.get(t.data.sheet),n!==void 0?(r=this.studio)==null||r.setSelection([n]):console.log(`Hermes - Can't set Sheet: ${t.data.sheet}`,n);break;case"setSheetObject":n=this.sheetObjects.get(`${t.data.sheet}_${t.data.key}`),n!==void 0?(i=this.studio)==null||i.setSelection([n]):console.log(`Hermes - Can't set Sheet Object: ${t.data.sheet}, ${t.data.key}: ${t.data.sheet}_${t.data.key}`,n);break;case"updateSheetObject":n=this.sheets.get(t.data.sheet),n!==void 0&&n.sequence.pause(),n=this.sheetObjectCBs.get(t.data.sheetObject),n!==void 0?n(t.data.values):console.log(`Hermes - Can't update Sheet Object: ${t.data.sheetObject}, ${t.data.sheet}`,n);break;case"updateTimeline":n=this.sheets.get(t.data.sheet),n!==void 0?n.sequence.position=t.data.position:console.log(`Hermes - Can't update sheet position: ${t.data.sheet}, ${t.data.position}`);break}}handleEditor(t){var n,r;switch(t.event){case"playSheet":(n=this.sheet(t.data.sheet,t.data.instance))==null||n.sequence.play(t.data.value);break;case"pauseSheet":(r=this.sheet(t.data.sheet,t.data.instance))==null||r.sequence.pause();break}}getSheetNames(){const t=[];return this.sheets.forEach((n,r)=>{t.push(r)}),t}handleEditorApp(){var t,n,r;if(this.editor){(t=this.studio)==null||t.ui.restore(),(n=this.studio)==null||n.onSelectionChange(u=>{u.length<1||u.forEach(p=>{let y=p.address.sheetId,x="setSheet",S={};switch(p.type){case"Theatre_Sheet_PublicAPI":x="setSheet",S={sheet:p.address.sheetId},this.activeSheet=this.sheets.get(p.address.sheetId);break;case"Theatre_SheetObject_PublicAPI":x="setSheetObject",y+=`_${p.address.objectKey}`,S={id:y,sheet:p.address.sheetId,key:p.address.objectKey},this.activeSheet=this.sheets.get(p.address.sheetId);break}this.send({event:x,target:"app",data:S})})});let i=-1;const a=()=>{if(this.activeSheet!==void 0&&i!==this.activeSheet.sequence.position){i=this.activeSheet.sequence.position;const u=this.activeSheet;this.send({event:"updateTimeline",target:"app",data:{position:i,sheet:u.address.sheetId}})}},c=()=>{a(),requestAnimationFrame(c)};a(),c()}else(r=this.studio)==null||r.ui.hide()}}const JW=new rs;JW.setAttribute("position",new Er([-.5,-.5,0,1.5,-.5,0,-.5,1.5,0],3));JW.setAttribute("normal",new Er([0,0,1,0,0,1],3));JW.setAttribute("uv",new Er([0,0,2,0,0,2],2));new zx(-.5,.5,.5,-.5,0,100);const H3e=s=>{s==null||s.dispose()},Hve=s=>{if(s)if(Array.isArray(s))s.forEach(e=>Hve(e));else{for(const e in s){const t=s[e];t!==null&&t instanceof n0&&H3e(t)}if(s.isShaderMaterial===!0){const e=s;for(const t in e.uniforms){const n=e.uniforms[t];n.value!==null&&n.value instanceof n0&&H3e(n.value)}}s.dispose()}},od=s=>{var e;if(s){for(;s.children.length>0;){const t=s.children[0];t.type==="Audio"?(t.pause(),t.parent&&t.parent.remove(t)):od(t)}if(s.parent&&s.parent.remove(s),s.isMesh){const t=s;(e=t.geometry)==null||e.dispose(),Hve(t.material)}s.dispose!==void 0&&s.dispose()}};let PH=0;const W3e=()=>{PH=0},Vx=s=>{if(!s)return;let e=s.name.replaceAll(" ","").replaceAll("/",".");if(e.length===0&&(e=`obj_${PH}`,PH++),s.parent!==null&&s.parent.uuid.length>0&&(e=`${s.parent.uuid}.${e}`),s.uuid=e,s.isMesh!==void 0){const t=s;if(Array.isArray(t.material))t.material.forEach((n,r)=>{n.uuid=`${e}.material.${r}`});else{const n=t.material;n.uuid=`${e}.material`}}s.children.forEach(t=>Vx(t))};class ml{static init(){this.inited||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.inited=!0)}static renderToBlob(e){this.init();const t=e.repeat.clone(),n=e.offset.clone();if(e.repeat.set(1,1),e.offset.set(0,0),this.context!==null){this.context.clearRect(0,0,this.width,this.height);const r=e.image;if(r!=null&&r.width>0){this.canvas.title=e.sourceFile;const i=this.canvas.width/r.width,a=this.renderToCanvas(e);this.context.drawImage(a,0,0,r.width*i,r.height*i)}}return e.repeat.copy(t),e.offset.copy(n),this.canvas.toDataURL("image/png")}static renderToCanvas(e){if(this.material===null){this.camera=new zx(-.5,.5,.5,-.5,0,100),this.scene=new _E,this.material=new eh;const t=new rs;t.setAttribute("position",new Er([-.5,-.5,0,1.5,-.5,0,-.5,1.5,0],3)),t.setAttribute("normal",new Er([0,0,1,0,0,1],3)),t.setAttribute("uv",new Er([0,0,2,0,0,2],2));const n=new mn(t,this.material);this.scene.add(n)}if(e.isRenderTargetTexture)this.material.map=e,this.renderer.render(this.scene,this.camera);else{const t=this.renderer.outputColorSpace,n=e.colorSpace;this.renderer.outputColorSpace=Ju,e.colorSpace=Ju,this.material.map=e,this.renderer.render(this.scene,this.camera),this.renderer.outputColorSpace=t,e.colorSpace=n}return this.renderer.domElement}}Xe(ml,"renderer"),Xe(ml,"canvas"),Xe(ml,"context",null),Xe(ml,"scene",null),Xe(ml,"camera",null),Xe(ml,"material",null),Xe(ml,"inited",!1),Xe(ml,"width",100),Xe(ml,"height",100);function NFe(s){if(s.name==="cameras")return"camera";if(s.name==="interactive")return"interactive";if(s.name==="lights")return"light";if(s.name==="ui")return"ui";if(s.name==="utils")return"utils";const e=s.type;return e.search("Helper")>-1?"icon_utils":e.search("Camera")>-1?"camera":e.search("Light")>-1?"light":"obj3D"}function rx(s){const e={name:s.name,type:s.type,uuid:s.uuid,children:[]};return s.children.forEach(t=>{e.children.push(rx(t))}),e}function DFe(s){const e={};for(const t in s){const n=s[t].value;e[t]={value:n},n===null?e[t].value={src:"",offset:[0,0],repeat:[1,1]}:n!==void 0&&n.isTexture&&(e[t].value={src:n.image.src,offset:[n.offset.x,n.offset.y],repeat:[n.repeat.x,n.repeat.y]})}return e}function OFe(s){switch(s){case"blendSrcAlpha":case"blendDstAlpha":case"blendEquationAlpha":case"clippingPlanes":case"shadowSide":case"precision":return!0}return!1}function k7(s){const e={};for(const t in s){if(t.substring(0,1)==="_"||t.substring(0,2)==="is"||OFe(t))continue;const n=typeof s[t],r=s[t];switch(n){case"boolean":case"number":case"string":e[t]=r;break;case"object":r!==null?(e[t]=r,r.isTexture?e[t]={src:ml.renderToBlob(r),offset:[r.offset.x,r.offset.y],repeat:[r.repeat.x,r.repeat.y]}:t==="uniforms"&&(e[t]=DFe(e[t]))):t==="glslVersion"?e[t]="":e[t]={src:"",offset:[0,0],repeat:[1,1]};break}}return s.anisotropy!==void 0&&(e.anisotropy=s.anisotropy),s.clearcoat!==void 0&&(e.clearcoat=s.clearcoat),s.iridescence!==void 0&&(e.iridescence=s.iridescence),s.dispersion!==void 0&&(e.dispersion=s.dispersion),s.sheen!==void 0&&(e.sheen=s.sheen),s.transmission!==void 0&&(e.transmission=s.transmission),s.transmission!==void 0&&(e.transmission=s.transmission),e}function eG(s){s.updateMatrix();const e={name:s.name,type:s.type,uuid:s.uuid,visible:s.visible,matrix:s.matrix.elements,animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};s.animations.forEach(n=>{e.animations.push({name:n.name,duration:n.duration,blendMode:n.blendMode})});const t=s.type.toLowerCase();if(t.search("mesh")>-1){const n=s;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(k7(i))}),e.material=r}else e.material=k7(n.material)}else if(t.search("points")>-1){const n=s;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(k7(i))}),e.material=r}else e.material=k7(n.material)}else if(t.search("line")>-1){const n=s;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(k7(i))}),e.material=r}else e.material=k7(n.material)}else t.search("camera")>-1?s.type==="PerspectiveCamera"?e.perspectiveCameraInfo={fov:s.fov,zoom:s.zoom,near:s.near,far:s.far,focus:s.focus,aspect:s.aspect,filmGauge:s.filmGauge,filmOffset:s.filmOffset}:s.type==="OrthographicCamera"&&(e.orthographicCameraInfo={zoom:s.zoom,near:s.near,far:s.far,left:s.left,right:s.right,top:s.top,bottom:s.bottom}):t.search("light")>-1&&(e.lightInfo={color:s.color,intensity:s.intensity,decay:s.decay,distance:s.distance,angle:s.angle,penumbra:s.penumbra,groundColor:s.groundColor,width:s.width,height:s.height});return e}function LFe(s,e){const t=e.split(".");switch(t.length){case 1:return s[t[0]];case 2:return s[t[0]][t[1]];case 3:return s[t[0]][t[1]][t[2]];case 4:return s[t[0]][t[1]][t[2]][t[3]];case 5:return s[t[0]][t[1]][t[2]][t[3]][t[4]];case 6:return s[t[0]][t[1]][t[2]][t[3]][t[4]][t[5]]}}function FFe(s,e){for(const t in e)s[t]=e[t]}function Ko(s,e,t){if(s===void 0){console.log(`Hermes - Can't set props: ${e}`,t);return}const n=e.split("."),r=n.length;if(typeof t!="object")switch(r){case 1:s[n[0]]=t;break;case 2:s[n[0]][n[1]]=t;break;case 3:s[n[0]][n[1]][n[2]]=t;break;case 4:s[n[0]][n[1]][n[2]][n[3]]=t;break;case 5:s[n[0]][n[1]][n[2]][n[3]][n[4]]=t;break}else{let a;switch(r){case 1:a=s[n[0]];break;case 2:a=s[n[0]][n[1]];break;case 3:a=s[n[0]][n[1]][n[2]];break;case 4:a=s[n[0]][n[1]][n[2]][n[3]];break;case 5:a=s[n[0]][n[1]][n[2]][n[3]][n[4]];break}a!=null?FFe(a,t):console.log(`Hermes - Can't set props because target isn't found: ${e}`,t)}}function e$(s){return new Promise((e,t)=>{const n=new Image;n.onload=()=>{const r=new n0(n);r.wrapS=Wg,r.wrapT=Wg,r.needsUpdate=!0,e(r)},n.onerror=t,n.src=s})}function rv(s,e,t){return Math.min(e,Math.max(s,t))}function $3e(s,e,t){return(t-s)/(e-s)}function RH(s,e,t){return s*(1-t)+e*t}function Rf(s,e=1){return Number(s.toFixed(e))}var li=(s=>(s.CUSTOM="ToolEvents::custom",s.SELECT_DROPDOWN="ToolEvents::selectDropdown",s.DRAG_UPDATE="ToolEvents::dragUpdate",s.ADD_SCENE="ToolEvents::addScene",s.REFRESH_SCENE="ToolEvents::refreshScene",s.REMOVE_SCENE="ToolEvents::removeScene",s.SET_SCENE="ToolEvents::setScene",s.SET_OBJECT="ToolEvents::setObject",s.CLEAR_OBJECT="ToolEvents::clearObject",s.ADD_CAMERA="ToolEvents::addCamera",s.REMOVE_CAMERA="ToolEvents::removeCamera",s.ADD_GROUP="ToolEvents::addGroup",s.REMOVE_GROUP="ToolEvents::removeGroup",s.ADD_SPLINE="ToolEvents::addSpline",s.ADD_RENDERER="ToolEvents::addRenderer",s.UPDATE_RENDERER="ToolEvents::updateRenderer",s))(li||{});class BFe extends Gve{constructor(t,n=!1,r=!1){super("RemoteThree",n,r);Xe(this,"name");Xe(this,"canvas",null);Xe(this,"inputElement",null);Xe(this,"scene");Xe(this,"scenes",new Map);Xe(this,"renderer");Xe(this,"renderTargets",new Map);Xe(this,"renderTargetsResize",new Map);Xe(this,"groups",new Map);Xe(this,"_listeners",{});this.name=t}dispose(){var t;this.scenes.forEach(n=>{od(n)}),this.scenes.clear(),this.scene&&od(this.scene),this.renderTargets.forEach(n=>{n.dispose()}),this.renderTargets.clear(),(t=this.renderer)==null||t.dispose()}addEventListener(t,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(n)===-1&&r[t].push(n)}hasEventListener(t,n){const r=this._listeners;return r===void 0?!1:r[t]!==void 0&&r[t].indexOf(n)!==-1}removeEventListener(t,n){const r=this._listeners;if(r===void 0)return;const i=r[t];if(i!==void 0){const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}dispatchEvent(t){const n=this._listeners;if(n===void 0)return;const r=n[t.type];if(r!==void 0){const i={...t,target:this},a=r.slice(0);for(let c=0,u=a.length;c<u;c++)a[c].call(this,i)}}getObjectByUUID(t){const n=t.split(".")[0],r=this.scenes.get(n);if(r!==void 0)return r.getObjectByProperty("uuid",t)}getObject(t){if(!this.debug)return;this.renderer!==void 0&&(ml.renderer=this.renderer);const n=this.getObjectByUUID(t);n&&this.setObject(n)}setObject(t){this.renderer!==void 0&&(ml.renderer=this.renderer);const n=eG(t);this.dispatchEvent({type:"ToolEvents::setObject",value:n})}requestMethod(t,n,r,i){const a=this.getObjectByUUID(t);if(a)try{i!==void 0?LFe(a,i)[n](r):a[n](r)}catch(c){console.log("Hermes - Error requesting method:",t,n,r),console.log(c)}}updateObject(t,n,r){this.send({event:"updateObject",target:"app",data:{uuid:t,key:n,value:r}})}createTexture(t,n,r){this.send({event:"createTexture",target:"app",data:{uuid:t,key:n,value:r}})}onUpdateObject(t,n,r){const i=this.getObjectByUUID(t);i&&Ko(i,n,r)}onCreateTexture(t,n,r){const i=this.getObjectByUUID(t);if(i){const a=c=>{const u=n.split(".");switch(u.length){case 1:i[u[0]]=c;break;case 2:i[u[0]][u[1]]=c;break;case 3:i[u[0]][u[1]][u[2]]=c;break;case 4:i[u[0]][u[1]][u[2]][u[3]]=c;break;case 5:i[u[0]][u[1]][u[2]][u[3]][u[4]]=c;break}i.material.needsUpdate=!0};r.src.length>0?e$(r.src).then(c=>{c.offset.set(r.offset[0],r.offset[1]),c.repeat.set(r.repeat[0],r.repeat[1]),a(c)}):a(null)}}addGroup(t){this.groups.get(t.title)===void 0&&(this.groups.set(t.title,{title:t.title,onUpdate:t.onUpdate}),this.send({event:"addGroup",target:"editor",data:JSON.stringify(t)}))}removeGroup(t){this.groups.get(t)!==void 0&&(this.groups.delete(t),this.send({event:"removeGroup",target:"editor",data:t}))}updateGroup(t,n,r){this.send({event:"updateGroup",target:"app",data:JSON.stringify({group:t,prop:n,value:r})})}addSplineCurve(t){setTimeout(()=>{this.send({event:"addSpline",target:"editor",data:JSON.stringify(t.toJSON())})},1)}addSplineObject(t){setTimeout(()=>{this.send({event:"addSpline",target:"editor",data:JSON.stringify(t)})},1)}setRenderer(t,n=null){if(this.renderer=t,this.canvas=t.domElement,this.inputElement=n!==null?n:this.canvas,!this.debug)return;const r=`#${t.getClearColor(new Pn).getHexString()}`;this.send({event:"addRenderer",target:"editor",data:{autoClear:t.autoClear,autoClearColor:t.autoClearColor,autoClearDepth:t.autoClearDepth,autoClearStencil:t.autoClearStencil,outputColorSpace:t.outputColorSpace,localClippingEnabled:t.localClippingEnabled,clearColor:r,clearAlpha:t.getClearAlpha(),colorManagement:Gr.enabled,toneMapping:t.toneMapping,toneMappingExposure:t.toneMappingExposure,type:t.isWebGLRenderer?"WebGLRenderer":"WebGPURenderer"}})}updateRenderer(t){this.send({event:"updateRenderer",target:"app",data:t})}addScene(t){if(t===void 0||(this.scenes.set(t.name,t),!this.debug))return;W3e(),Vx(t);const n=rx(t);this.send({event:"addScene",target:"editor",data:n})}refreshScene(t){if(!this.debug)return;const n=this.scenes.get(t);if(n!==void 0){const r=rx(n);this.send({event:"refreshScene",target:"app",data:r})}}removeScene(t){if(t===void 0||(this.scenes.delete(t.name),!this.debug))return;const n=rx(t);this.send({event:"removeScene",target:"editor",data:n})}removeAllScenes(){this.scenes.forEach(t=>this.removeScene(t))}getScene(t){let n=null;return this.scene!==void 0&&this.scene.uuid.search(t)>-1?this.scene:(this.scenes.forEach((r,i)=>{t.search(i)>-1&&(n=r)}),n)}setScene(t){if(t===void 0||(this.scene=t,!this.debug))return;this.renderer!==void 0&&(ml.renderer=this.renderer),W3e(),Vx(t);const n=rx(t);this.send({event:"setScene",target:"editor",data:n})}requestSize(){this.send({event:"requestSize",target:"app"})}addCamera(t){if(!this.debug)return;const n=eG(t);this.send({event:"addCamera",target:"editor",data:n})}removeCamera(t){if(!this.debug)return;const n=eG(t);this.send({event:"removeCamera",target:"editor",data:n})}handleApp(t){switch(t.event){case"refreshScene":this.send({event:"refreshScene",target:"editor",data:rx(this.scenes.get(t.data.name))});break;case"updateRenderer":this.renderer&&(this.renderer.autoClearColor=t.data.autoClearColor,this.renderer.outputColorSpace=t.data.outputColorSpace,this.renderer.localClippingEnabled=t.data.localClippingEnabled,this.renderer.setClearColor(t.data.clearColor,t.data.clearAlpha),this.renderer.toneMapping=t.data.toneMapping,this.renderer.toneMappingExposure=t.data.toneMappingExposure,Gr.enabled=t.data.colorManagement);break}if(t.event==="updateGroup"){const n=JSON.parse(t.data),r=this.groups.get(n.group);r==null||r.onUpdate(n.prop,n.value)}}handleEditor(t){switch(t.event){case"addScene":this.dispatchEvent({type:"ToolEvents::addScene",value:t.data});break;case"refreshScene":this.dispatchEvent({type:"ToolEvents::refreshScene",value:t.data});break;case"removeScene":this.dispatchEvent({type:"ToolEvents::removeScene",value:t.data});break;case"setScene":this.dispatchEvent({type:"ToolEvents::setScene",value:t.data});break;case"addCamera":this.dispatchEvent({type:"ToolEvents::addCamera",value:t.data});break;case"removeCamera":this.dispatchEvent({type:"ToolEvents::removeCamera",value:t.data});break;case"addGroup":this.dispatchEvent({type:"ToolEvents::addGroup",value:t.data});break;case"removeGroup":this.dispatchEvent({type:"ToolEvents::removeGroup",value:t.data});break;case"addSpline":this.dispatchEvent({type:"ToolEvents::addSpline",value:t.data});break;case"addRenderer":this.dispatchEvent({type:"ToolEvents::addRenderer",value:t.data})}}messageHandler(t){const n=t.data;if(n.event==="updateObject"){this.onUpdateObject(n.data.uuid,n.data.key,n.data.value);return}else if(n.event==="createTexture"){this.onCreateTexture(n.data.uuid,n.data.key,n.data.value);return}else if(n.event==="requestSize"){n.target==="app"?this.send({event:"requestSize",target:"editor",data:{width:this.width,height:this.height}}):this.scenes.forEach(r=>{r.resize!==void 0&&r.resize(n.data.width,n.data.height)});return}n.target==="app"?this.handleApp(n):this.handleEditor(n)}addRT(t,n=!0,r){const i=new bl(32,32,r);i.texture.name=t,this.renderTargets.set(t,i),this.renderTargetsResize.set(t,n)}removeRT(t){this.renderTargets.delete(t),this.renderTargetsResize.delete(t)}resize(t,n){var a,c;const r=this.dpr;this.renderTargets.forEach((u,p)=>{this.renderTargetsResize.get(p)&&u.setSize(t*r,n*r)});const i=!(((a=this.renderer)==null?void 0:a.domElement)instanceof OffscreenCanvas);(c=this.renderer)==null||c.setSize(t,n,i)}set dpr(t){var n;(n=this.renderer)==null||n.setPixelRatio(rv(1,2,t))}get dpr(){var t;return this.renderer!==void 0?(t=this.renderer)==null?void 0:t.getPixelRatio():1}get width(){return this.renderer!==void 0?this.renderer.domElement.width/this.dpr:0}get height(){return this.renderer!==void 0?this.renderer.domElement.height/this.dpr:0}}function UFe(s){const t=s.app.components.get("theatre");return t.studio=k8e,t.handleEditorApp(),null}function zFe(s){return Ke.jsxs("div",{className:"editor",ref:s.ref,style:s.style,children:[Ke.jsx("div",{className:"header",children:s.header}),s.children,Ke.jsx("div",{className:"footer",children:s.footer})]})}class VFe{constructor(e,t){this.nodes=e,this.info=t,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,n)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(t,n)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Lf{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let n=this.weakMap;for(let r=0;r<e.length-1;r++){const i=e[r];n.has(i)===!1&&n.set(i,new WeakMap),n=n.get(i)}return n.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return!1;return t.delete(e[e.length-1])}}const hl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let q3e=1234567;const sE=Math.PI/180,Gx=180/Math.PI;function Fg(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(hl[s&255]+hl[s>>8&255]+hl[s>>16&255]+hl[s>>24&255]+"-"+hl[e&255]+hl[e>>8&255]+"-"+hl[e>>16&15|64]+hl[e>>24&255]+"-"+hl[t&63|128]+hl[t>>8&255]+"-"+hl[t>>16&255]+hl[t>>24&255]+hl[n&255]+hl[n>>8&255]+hl[n>>16&255]+hl[n>>24&255]).toLowerCase()}function yi(s,e,t){return Math.max(e,Math.min(t,s))}function t$(s,e){return(s%e+e)%e}function iv(s,e,t,n,r){return n+(s-e)*(r-n)/(t-e)}function GFe(s,e,t){return s!==e?(t-s)/(e-s):0}function V3(s,e,t){return(1-t)*s+t*e}function jFe(s,e,t,n){return V3(s,e,1-Math.exp(-t*n))}function HFe(s,e=1){return e-Math.abs(t$(s,e*2)-e)}function WFe(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function $Fe(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function qFe(s,e){return s+Math.floor(Math.random()*(e-s+1))}function XFe(s,e){return s+Math.random()*(e-s)}function YFe(s){return s*(.5-Math.random())}function KFe(s){s!==void 0&&(q3e=s);let e=q3e+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function yk(s){return s*sE}function Wve(s){return s*Gx}function ZFe(s){return(s&s-1)===0&&s!==0}function QFe(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function JFe(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function eBe(s,e,t,n,r){const i=Math.cos,a=Math.sin,c=i(t/2),u=a(t/2),p=i((e+n)/2),y=a((e+n)/2),x=i((e-n)/2),S=a((e-n)/2),M=i((n-e)/2),I=a((n-e)/2);switch(r){case"XYX":s.set(c*y,u*x,u*S,c*p);break;case"YZY":s.set(u*S,c*y,u*x,c*p);break;case"ZXZ":s.set(u*x,u*S,c*y,c*p);break;case"XZX":s.set(c*y,u*I,u*M,c*p);break;case"YXY":s.set(u*M,c*y,u*I,c*p);break;case"ZYZ":s.set(u*I,u*M,c*y,c*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ac(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function Qr(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const tBe={DEG2RAD:sE,RAD2DEG:Gx,generateUUID:Fg,clamp:yi,euclideanModulo:t$,mapLinear:iv,inverseLerp:GFe,lerp:V3,damp:jFe,pingpong:HFe,smoothstep:WFe,smootherstep:$Fe,randInt:qFe,randFloat:XFe,randFloatSpread:YFe,seededRandom:KFe,degToRad:yk,radToDeg:Wve,isPowerOfTwo:ZFe,ceilPowerOfTwo:QFe,floorPowerOfTwo:JFe,setQuaternionFromProperEuler:eBe,normalize:Qr,denormalize:ac},$ve="177",nBe=0,rBe=1,iBe=2,sBe=0,oBe=1,YI=3,Bg=0,eu=1,Sx=2,jx=0,Ug=1,xk=2,_k=3,bk=4,oE=5,Nf=100,qve=101,Xve=102,aBe=103,lBe=104,N3=200,Yve=201,Kve=202,Zve=203,Sk=204,wk=205,Qve=206,Jve=207,eye=208,tye=209,nye=210,rye=0,iye=1,sye=2,Ek=3,oye=4,aye=5,lye=6,cye=7,Xk=0,cBe=1,uBe=2,wx=0,hBe=1,dBe=2,fBe=3,pBe=4,mBe=6,gBe=7,n$=300,CE=301,Tk=302,r$=303,i$=304,IH=306,Hx=1e3,z3=1001,Wx=1002,Ca=1003,uye=1004,AE=1005,th=1006,kH=1007,zg=1008,lc=1009,aE=1010,lE=1011,dx=1012,sc=1013,Zo=1014,Zu=1015,td=1016,vBe=1017,yBe=1018,G3=1020,hye=35902,xBe=1021,s$=1022,nd=1023,S1=1026,Vg=1027,o$=1028,a$=1029,yv=1030,l$=1031,_Be=1032,c$=1033,tG=33776,KI=33777,ZI=33778,QI=33779,X3e=35840,Y3e=35841,K3e=35842,Z3e=35843,Q3e=36196,NH=37492,DH=37496,OH=37808,LH=37809,FH=37810,BH=37811,UH=37812,zH=37813,VH=37814,GH=37815,jH=37816,HH=37817,WH=37818,$H=37819,qH=37820,XH=37821,nG=36492,bBe=36283,J3e=36284,e4e=36285,t4e=36286,q3=0,SBe=1,$g="",Yu="srgb",Ex="srgb-linear",Mk="linear",Vr="srgb",wBe=0,sv=7680,EBe=7681,TBe=7682,MBe=7683,CBe=34055,ABe=34056,PBe=5386,RBe=512,IBe=513,kBe=514,NBe=515,DBe=516,OBe=517,LBe=518,YH=519,dye=512,u$=513,fye=514,pye=515,mye=516,gye=517,vye=518,yye=519,Ck=35044,fx=35048,Zc=2e3,X3=2001;class nu{constructor(e,t,n,r,i,a,c,u,p){nu.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,u,p)}set(e,t,n,r,i,a,c,u,p){const y=this.elements;return y[0]=e,y[1]=r,y[2]=c,y[3]=t,y[4]=i,y[5]=u,y[6]=n,y[7]=a,y[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[3],u=n[6],p=n[1],y=n[4],x=n[7],S=n[2],M=n[5],I=n[8],L=r[0],B=r[3],A=r[6],V=r[1],X=r[4],P=r[7],te=r[2],oe=r[5],ie=r[8];return i[0]=a*L+c*V+u*te,i[3]=a*B+c*X+u*oe,i[6]=a*A+c*P+u*ie,i[1]=p*L+y*V+x*te,i[4]=p*B+y*X+x*oe,i[7]=p*A+y*P+x*ie,i[2]=S*L+M*V+I*te,i[5]=S*B+M*X+I*oe,i[8]=S*A+M*P+I*ie,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],u=e[6],p=e[7],y=e[8];return t*a*y-t*c*p-n*i*y+n*c*u+r*i*p-r*a*u}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],u=e[6],p=e[7],y=e[8],x=y*a-c*p,S=c*u-y*i,M=p*i-a*u,I=t*x+n*S+r*M;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/I;return e[0]=x*L,e[1]=(r*p-y*n)*L,e[2]=(c*n-r*a)*L,e[3]=S*L,e[4]=(y*t-r*u)*L,e[5]=(r*i-c*t)*L,e[6]=M*L,e[7]=(n*u-p*t)*L,e[8]=(a*t-n*i)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,c){const u=Math.cos(i),p=Math.sin(i);return this.set(n*u,n*p,-n*(u*a+p*c)+a+e,-r*p,r*u,-r*(-p*a+u*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(rG.makeScale(e,t)),this}rotate(e){return this.premultiply(rG.makeRotation(-e)),this}translate(e,t){return this.premultiply(rG.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const rG=new nu;function xye(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function KH(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function FBe(){const s=KH("canvas");return s.style.display="block",s}const n4e={};function qg(s){s in n4e||(n4e[s]=!0,console.warn(s))}const r4e=new nu().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),i4e=new nu().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function BBe(){const s={enabled:!0,workingColorSpace:Ex,spaces:{},convert:function(r,i,a){return this.enabled===!1||i===a||!i||!a||(this.spaces[i].transfer===Vr&&(r.r=Gg(r.r),r.g=Gg(r.g),r.b=Gg(r.b)),this.spaces[i].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[i].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Vr&&(r.r=Tx(r.r),r.g=Tx(r.g),r.b=Tx(r.b))),r},workingToColorSpace:function(r,i){return this.convert(r,this.workingColorSpace,i)},colorSpaceToWorking:function(r,i){return this.convert(r,i,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===$g?Mk:this.spaces[r].transfer},getLuminanceCoefficients:function(r,i=this.workingColorSpace){return r.fromArray(this.spaces[i].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,i,a){return r.copy(this.spaces[i].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,i){return qg("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(r,i)},toWorkingColorSpace:function(r,i){return qg("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(r,i)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[Ex]:{primaries:e,whitePoint:n,transfer:Mk,toXYZ:r4e,fromXYZ:i4e,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Yu},outputColorSpaceConfig:{drawingBufferColorSpace:Yu}},[Yu]:{primaries:e,whitePoint:n,transfer:Vr,toXYZ:r4e,fromXYZ:i4e,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Yu}}}),s}const Us=BBe();function Gg(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function Tx(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}const _ye={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_3={h:0,s:0,l:0},YR={h:0,s:0,l:0};function iG(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class Zi{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Yu){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Us.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Us.workingColorSpace){return this.r=e,this.g=t,this.b=n,Us.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Us.workingColorSpace){if(e=t$(e,1),t=yi(t,0,1),n=yi(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=iG(a,i,e+1/3),this.g=iG(a,i,e),this.b=iG(a,i,e-1/3)}return Us.colorSpaceToWorking(this,r),this}setStyle(e,t=Yu){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],c=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],a=i.length;if(a===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Yu){const n=_ye[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Gg(e.r),this.g=Gg(e.g),this.b=Gg(e.b),this}copyLinearToSRGB(e){return this.r=Tx(e.r),this.g=Tx(e.g),this.b=Tx(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Yu){return Us.workingToColorSpace(dl.copy(this),e),Math.round(yi(dl.r*255,0,255))*65536+Math.round(yi(dl.g*255,0,255))*256+Math.round(yi(dl.b*255,0,255))}getHexString(e=Yu){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Us.workingColorSpace){Us.workingToColorSpace(dl.copy(this),t);const n=dl.r,r=dl.g,i=dl.b,a=Math.max(n,r,i),c=Math.min(n,r,i);let u,p;const y=(c+a)/2;if(c===a)u=0,p=0;else{const x=a-c;switch(p=y<=.5?x/(a+c):x/(2-a-c),a){case n:u=(r-i)/x+(r<i?6:0);break;case r:u=(i-n)/x+2;break;case i:u=(n-r)/x+4;break}u/=6}return e.h=u,e.s=p,e.l=y,e}getRGB(e,t=Us.workingColorSpace){return Us.workingToColorSpace(dl.copy(this),t),e.r=dl.r,e.g=dl.g,e.b=dl.b,e}getStyle(e=Yu){Us.workingToColorSpace(dl.copy(this),e);const t=dl.r,n=dl.g,r=dl.b;return e!==Yu?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(_3),this.setHSL(_3.h+e,_3.s+t,_3.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(_3),e.getHSL(YR);const n=V3(_3.h,YR.h,t),r=V3(_3.s,YR.s,t),i=V3(_3.l,YR.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const dl=new Zi;Zi.NAMES=_ye;class Yk{constructor(e,t,n,r){Yk.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=r,this}}class i_{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,c){let u=n[r+0],p=n[r+1],y=n[r+2],x=n[r+3];const S=i[a+0],M=i[a+1],I=i[a+2],L=i[a+3];if(c===0){e[t+0]=u,e[t+1]=p,e[t+2]=y,e[t+3]=x;return}if(c===1){e[t+0]=S,e[t+1]=M,e[t+2]=I,e[t+3]=L;return}if(x!==L||u!==S||p!==M||y!==I){let B=1-c;const A=u*S+p*M+y*I+x*L,V=A>=0?1:-1,X=1-A*A;if(X>Number.EPSILON){const te=Math.sqrt(X),oe=Math.atan2(te,A*V);B=Math.sin(B*oe)/te,c=Math.sin(c*oe)/te}const P=c*V;if(u=u*B+S*P,p=p*B+M*P,y=y*B+I*P,x=x*B+L*P,B===1-c){const te=1/Math.sqrt(u*u+p*p+y*y+x*x);u*=te,p*=te,y*=te,x*=te}}e[t]=u,e[t+1]=p,e[t+2]=y,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,i,a){const c=n[r],u=n[r+1],p=n[r+2],y=n[r+3],x=i[a],S=i[a+1],M=i[a+2],I=i[a+3];return e[t]=c*I+y*x+u*M-p*S,e[t+1]=u*I+y*S+p*x-c*M,e[t+2]=p*I+y*M+c*S-u*x,e[t+3]=y*I-c*x-u*S-p*M,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,a=e._order,c=Math.cos,u=Math.sin,p=c(n/2),y=c(r/2),x=c(i/2),S=u(n/2),M=u(r/2),I=u(i/2);switch(a){case"XYZ":this._x=S*y*x+p*M*I,this._y=p*M*x-S*y*I,this._z=p*y*I+S*M*x,this._w=p*y*x-S*M*I;break;case"YXZ":this._x=S*y*x+p*M*I,this._y=p*M*x-S*y*I,this._z=p*y*I-S*M*x,this._w=p*y*x+S*M*I;break;case"ZXY":this._x=S*y*x-p*M*I,this._y=p*M*x+S*y*I,this._z=p*y*I+S*M*x,this._w=p*y*x-S*M*I;break;case"ZYX":this._x=S*y*x-p*M*I,this._y=p*M*x+S*y*I,this._z=p*y*I-S*M*x,this._w=p*y*x+S*M*I;break;case"YZX":this._x=S*y*x+p*M*I,this._y=p*M*x+S*y*I,this._z=p*y*I-S*M*x,this._w=p*y*x-S*M*I;break;case"XZY":this._x=S*y*x-p*M*I,this._y=p*M*x-S*y*I,this._z=p*y*I+S*M*x,this._w=p*y*x+S*M*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],c=t[5],u=t[9],p=t[2],y=t[6],x=t[10],S=n+c+x;if(S>0){const M=.5/Math.sqrt(S+1);this._w=.25/M,this._x=(y-u)*M,this._y=(i-p)*M,this._z=(a-r)*M}else if(n>c&&n>x){const M=2*Math.sqrt(1+n-c-x);this._w=(y-u)/M,this._x=.25*M,this._y=(r+a)/M,this._z=(i+p)/M}else if(c>x){const M=2*Math.sqrt(1+c-n-x);this._w=(i-p)/M,this._x=(r+a)/M,this._y=.25*M,this._z=(u+y)/M}else{const M=2*Math.sqrt(1+x-n-c);this._w=(a-r)/M,this._x=(i+p)/M,this._y=(u+y)/M,this._z=.25*M}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(yi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,c=t._x,u=t._y,p=t._z,y=t._w;return this._x=n*y+a*c+r*p-i*u,this._y=r*y+a*u+i*c-n*p,this._z=i*y+a*p+n*u-r*c,this._w=a*y-n*c-r*u-i*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let c=a*e._w+n*e._x+r*e._y+i*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const u=1-c*c;if(u<=Number.EPSILON){const M=1-t;return this._w=M*a+t*this._w,this._x=M*n+t*this._x,this._y=M*r+t*this._y,this._z=M*i+t*this._z,this.normalize(),this}const p=Math.sqrt(u),y=Math.atan2(p,c),x=Math.sin((1-t)*y)/p,S=Math.sin(t*y)/p;return this._w=a*x+this._w*S,this._x=n*x+this._x*S,this._y=r*x+this._y*S,this._z=i*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class pt{constructor(e=0,t=0,n=0){pt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(s4e.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(s4e.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,c=e.z,u=e.w,p=2*(a*r-c*n),y=2*(c*t-i*r),x=2*(i*n-a*t);return this.x=t+u*p+a*x-c*y,this.y=n+u*y+c*p-i*x,this.z=r+u*x+i*y-a*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=yi(this.x,e.x,t.x),this.y=yi(this.y,e.y,t.y),this.z=yi(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=yi(this.x,e,t),this.y=yi(this.y,e,t),this.z=yi(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(yi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,c=t.y,u=t.z;return this.x=r*u-i*c,this.y=i*a-n*u,this.z=n*c-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return sG.copy(this).projectOnVector(e),this.sub(sG)}reflect(e){return this.sub(sG.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(yi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const sG=new pt,s4e=new i_;class Is{constructor(e,t,n,r,i,a,c,u,p,y,x,S,M,I,L,B){Is.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,u,p,y,x,S,M,I,L,B)}set(e,t,n,r,i,a,c,u,p,y,x,S,M,I,L,B){const A=this.elements;return A[0]=e,A[4]=t,A[8]=n,A[12]=r,A[1]=i,A[5]=a,A[9]=c,A[13]=u,A[2]=p,A[6]=y,A[10]=x,A[14]=S,A[3]=M,A[7]=I,A[11]=L,A[15]=B,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Is().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/N7.setFromMatrixColumn(e,0).length(),i=1/N7.setFromMatrixColumn(e,1).length(),a=1/N7.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),c=Math.sin(n),u=Math.cos(r),p=Math.sin(r),y=Math.cos(i),x=Math.sin(i);if(e.order==="XYZ"){const S=a*y,M=a*x,I=c*y,L=c*x;t[0]=u*y,t[4]=-u*x,t[8]=p,t[1]=M+I*p,t[5]=S-L*p,t[9]=-c*u,t[2]=L-S*p,t[6]=I+M*p,t[10]=a*u}else if(e.order==="YXZ"){const S=u*y,M=u*x,I=p*y,L=p*x;t[0]=S+L*c,t[4]=I*c-M,t[8]=a*p,t[1]=a*x,t[5]=a*y,t[9]=-c,t[2]=M*c-I,t[6]=L+S*c,t[10]=a*u}else if(e.order==="ZXY"){const S=u*y,M=u*x,I=p*y,L=p*x;t[0]=S-L*c,t[4]=-a*x,t[8]=I+M*c,t[1]=M+I*c,t[5]=a*y,t[9]=L-S*c,t[2]=-a*p,t[6]=c,t[10]=a*u}else if(e.order==="ZYX"){const S=a*y,M=a*x,I=c*y,L=c*x;t[0]=u*y,t[4]=I*p-M,t[8]=S*p+L,t[1]=u*x,t[5]=L*p+S,t[9]=M*p-I,t[2]=-p,t[6]=c*u,t[10]=a*u}else if(e.order==="YZX"){const S=a*u,M=a*p,I=c*u,L=c*p;t[0]=u*y,t[4]=L-S*x,t[8]=I*x+M,t[1]=x,t[5]=a*y,t[9]=-c*y,t[2]=-p*y,t[6]=M*x+I,t[10]=S-L*x}else if(e.order==="XZY"){const S=a*u,M=a*p,I=c*u,L=c*p;t[0]=u*y,t[4]=-x,t[8]=p*y,t[1]=S*x+L,t[5]=a*y,t[9]=M*x-I,t[2]=I*x-M,t[6]=c*y,t[10]=L*x+S}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(UBe,e,zBe)}lookAt(e,t,n){const r=this.elements;return ju.subVectors(e,t),ju.lengthSq()===0&&(ju.z=1),ju.normalize(),b3.crossVectors(n,ju),b3.lengthSq()===0&&(Math.abs(n.z)===1?ju.x+=1e-4:ju.z+=1e-4,ju.normalize(),b3.crossVectors(n,ju)),b3.normalize(),KR.crossVectors(ju,b3),r[0]=b3.x,r[4]=KR.x,r[8]=ju.x,r[1]=b3.y,r[5]=KR.y,r[9]=ju.y,r[2]=b3.z,r[6]=KR.z,r[10]=ju.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[4],u=n[8],p=n[12],y=n[1],x=n[5],S=n[9],M=n[13],I=n[2],L=n[6],B=n[10],A=n[14],V=n[3],X=n[7],P=n[11],te=n[15],oe=r[0],ie=r[4],K=r[8],re=r[12],se=r[1],q=r[5],De=r[9],Be=r[13],tt=r[2],st=r[6],de=r[10],ft=r[14],Se=r[3],rt=r[7],ut=r[11],Pe=r[15];return i[0]=a*oe+c*se+u*tt+p*Se,i[4]=a*ie+c*q+u*st+p*rt,i[8]=a*K+c*De+u*de+p*ut,i[12]=a*re+c*Be+u*ft+p*Pe,i[1]=y*oe+x*se+S*tt+M*Se,i[5]=y*ie+x*q+S*st+M*rt,i[9]=y*K+x*De+S*de+M*ut,i[13]=y*re+x*Be+S*ft+M*Pe,i[2]=I*oe+L*se+B*tt+A*Se,i[6]=I*ie+L*q+B*st+A*rt,i[10]=I*K+L*De+B*de+A*ut,i[14]=I*re+L*Be+B*ft+A*Pe,i[3]=V*oe+X*se+P*tt+te*Se,i[7]=V*ie+X*q+P*st+te*rt,i[11]=V*K+X*De+P*de+te*ut,i[15]=V*re+X*Be+P*ft+te*Pe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],c=e[5],u=e[9],p=e[13],y=e[2],x=e[6],S=e[10],M=e[14],I=e[3],L=e[7],B=e[11],A=e[15];return I*(+i*u*x-r*p*x-i*c*S+n*p*S+r*c*M-n*u*M)+L*(+t*u*M-t*p*S+i*a*S-r*a*M+r*p*y-i*u*y)+B*(+t*p*x-t*c*M-i*a*x+n*a*M+i*c*y-n*p*y)+A*(-r*c*y-t*u*x+t*c*S+r*a*x-n*a*S+n*u*y)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],u=e[6],p=e[7],y=e[8],x=e[9],S=e[10],M=e[11],I=e[12],L=e[13],B=e[14],A=e[15],V=x*B*p-L*S*p+L*u*M-c*B*M-x*u*A+c*S*A,X=I*S*p-y*B*p-I*u*M+a*B*M+y*u*A-a*S*A,P=y*L*p-I*x*p+I*c*M-a*L*M-y*c*A+a*x*A,te=I*x*u-y*L*u-I*c*S+a*L*S+y*c*B-a*x*B,oe=t*V+n*X+r*P+i*te;if(oe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ie=1/oe;return e[0]=V*ie,e[1]=(L*S*i-x*B*i-L*r*M+n*B*M+x*r*A-n*S*A)*ie,e[2]=(c*B*i-L*u*i+L*r*p-n*B*p-c*r*A+n*u*A)*ie,e[3]=(x*u*i-c*S*i-x*r*p+n*S*p+c*r*M-n*u*M)*ie,e[4]=X*ie,e[5]=(y*B*i-I*S*i+I*r*M-t*B*M-y*r*A+t*S*A)*ie,e[6]=(I*u*i-a*B*i-I*r*p+t*B*p+a*r*A-t*u*A)*ie,e[7]=(a*S*i-y*u*i+y*r*p-t*S*p-a*r*M+t*u*M)*ie,e[8]=P*ie,e[9]=(I*x*i-y*L*i-I*n*M+t*L*M+y*n*A-t*x*A)*ie,e[10]=(a*L*i-I*c*i+I*n*p-t*L*p-a*n*A+t*c*A)*ie,e[11]=(y*c*i-a*x*i-y*n*p+t*x*p+a*n*M-t*c*M)*ie,e[12]=te*ie,e[13]=(y*L*r-I*x*r+I*n*S-t*L*S-y*n*B+t*x*B)*ie,e[14]=(I*c*r-a*L*r-I*n*u+t*L*u+a*n*B-t*c*B)*ie,e[15]=(a*x*r-y*c*r+y*n*u-t*x*u-a*n*S+t*c*S)*ie,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,c=e.y,u=e.z,p=i*a,y=i*c;return this.set(p*a+n,p*c-r*u,p*u+r*c,0,p*c+r*u,y*c+n,y*u-r*a,0,p*u-r*c,y*u+r*a,i*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,c=t._z,u=t._w,p=i+i,y=a+a,x=c+c,S=i*p,M=i*y,I=i*x,L=a*y,B=a*x,A=c*x,V=u*p,X=u*y,P=u*x,te=n.x,oe=n.y,ie=n.z;return r[0]=(1-(L+A))*te,r[1]=(M+P)*te,r[2]=(I-X)*te,r[3]=0,r[4]=(M-P)*oe,r[5]=(1-(S+A))*oe,r[6]=(B+V)*oe,r[7]=0,r[8]=(I+X)*ie,r[9]=(B-V)*ie,r[10]=(1-(S+L))*ie,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=N7.set(r[0],r[1],r[2]).length();const a=N7.set(r[4],r[5],r[6]).length(),c=N7.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],bf.copy(this);const p=1/i,y=1/a,x=1/c;return bf.elements[0]*=p,bf.elements[1]*=p,bf.elements[2]*=p,bf.elements[4]*=y,bf.elements[5]*=y,bf.elements[6]*=y,bf.elements[8]*=x,bf.elements[9]*=x,bf.elements[10]*=x,t.setFromRotationMatrix(bf),n.x=i,n.y=a,n.z=c,this}makePerspective(e,t,n,r,i,a,c=Zc){const u=this.elements,p=2*i/(t-e),y=2*i/(n-r),x=(t+e)/(t-e),S=(n+r)/(n-r);let M,I;if(c===Zc)M=-(a+i)/(a-i),I=-2*a*i/(a-i);else if(c===X3)M=-a/(a-i),I=-a*i/(a-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return u[0]=p,u[4]=0,u[8]=x,u[12]=0,u[1]=0,u[5]=y,u[9]=S,u[13]=0,u[2]=0,u[6]=0,u[10]=M,u[14]=I,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,n,r,i,a,c=Zc){const u=this.elements,p=1/(t-e),y=1/(n-r),x=1/(a-i),S=(t+e)*p,M=(n+r)*y;let I,L;if(c===Zc)I=(a+i)*x,L=-2*x;else if(c===X3)I=i*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return u[0]=2*p,u[4]=0,u[8]=0,u[12]=-S,u[1]=0,u[5]=2*y,u[9]=0,u[13]=-M,u[2]=0,u[6]=0,u[10]=L,u[14]=-I,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const N7=new pt,bf=new Is,UBe=new pt(0,0,0),zBe=new pt(1,1,1),b3=new pt,KR=new pt,ju=new pt;class ci{constructor(e=0,t=0){ci.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=yi(this.x,e.x,t.x),this.y=yi(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=yi(this.x,e,t),this.y=yi(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(yi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(yi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ri{constructor(e=0,t=0,n=0,r=1){Ri.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const u=e.elements,p=u[0],y=u[4],x=u[8],S=u[1],M=u[5],I=u[9],L=u[2],B=u[6],A=u[10];if(Math.abs(y-S)<.01&&Math.abs(x-L)<.01&&Math.abs(I-B)<.01){if(Math.abs(y+S)<.1&&Math.abs(x+L)<.1&&Math.abs(I+B)<.1&&Math.abs(p+M+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const X=(p+1)/2,P=(M+1)/2,te=(A+1)/2,oe=(y+S)/4,ie=(x+L)/4,K=(I+B)/4;return X>P&&X>te?X<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(X),r=oe/n,i=ie/n):P>te?P<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(P),n=oe/r,i=K/r):te<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(te),n=ie/i,r=K/i),this.set(n,r,i,t),this}let V=Math.sqrt((B-I)*(B-I)+(x-L)*(x-L)+(S-y)*(S-y));return Math.abs(V)<.001&&(V=1),this.x=(B-I)/V,this.y=(x-L)/V,this.z=(S-y)/V,this.w=Math.acos((p+M+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=yi(this.x,e.x,t.x),this.y=yi(this.y,e.y,t.y),this.z=yi(this.z,e.z,t.z),this.w=yi(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=yi(this.x,e,t),this.y=yi(this.y,e,t),this.z=yi(this.z,e,t),this.w=yi(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(yi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}function PE(s,e=0){let t=3735928559^e,n=1103547991^e;if(s instanceof Array)for(let r=0,i;r<s.length;r++)i=s[r],t=Math.imul(t^i,2654435761),n=Math.imul(n^i,1597334677);else for(let r=0,i;r<s.length;r++)i=s.charCodeAt(r),t=Math.imul(t^i,2654435761),n=Math.imul(n^i,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}const VBe=s=>PE(s),h$=s=>PE(s),Ak=(...s)=>PE(s);function bye(s,e=!1){const t=[];s.isNode===!0&&(t.push(s.id),s=s.getSelf());for(const{property:n,childNode:r}of Pk(s))t.push(PE(n.slice(0,-4)),r.getCacheKey(e));return PE(t)}function*Pk(s,e=!1){for(const t in s){if(t.startsWith("_")===!0)continue;const n=s[t];if(Array.isArray(n)===!0)for(let r=0;r<n.length;r++){const i=n[r];i&&(i.isNode===!0||e&&typeof i.toJSON=="function")&&(yield{property:t,index:r,childNode:i})}else if(n&&n.isNode===!0)yield{property:t,childNode:n};else if(typeof n=="object")for(const r in n){const i=n[r];i&&(i.isNode===!0||e&&typeof i.toJSON=="function")&&(yield{property:t,index:r,childNode:i})}}}const GBe=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),o4e=new WeakMap;function jBe(s){return GBe.get(s)}function Rk(s){if(s==null)return null;const e=typeof s;return s.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":s.isVector2===!0?"vec2":s.isVector3===!0?"vec3":s.isVector4===!0?"vec4":s.isMatrix2===!0?"mat2":s.isMatrix3===!0?"mat3":s.isMatrix4===!0?"mat4":s.isColor===!0?"color":s instanceof ArrayBuffer?"ArrayBuffer":null}function Sye(s,...e){const t=s?s.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),s==="color"?new Zi(...e):t==="vec2"?new ci(...e):t==="vec3"?new pt(...e):t==="vec4"?new Ri(...e):t==="mat2"?new Yk(...e):t==="mat3"?new nu(...e):t==="mat4"?new Is(...e):s==="bool"?e[0]||!1:s==="float"||s==="int"||s==="uint"?e[0]||0:s==="string"?e[0]||"":s==="ArrayBuffer"?WBe(e[0]):null}function wye(s){let e=o4e.get(s);return e===void 0&&(e={},o4e.set(s,e)),e}function HBe(s){let e="";const t=new Uint8Array(s);for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function WBe(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0)).buffer}let $Be=0;function qBe(s){const e=Object.keys(s);let t=Object.getPrototypeOf(s);for(;t;){const n=Object.getOwnPropertyDescriptors(t);for(const r in n)if(n[r]!==void 0){const i=n[r];i&&typeof i.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class XBe{constructor(e,t,n,r,i,a,c,u,p,y){this.id=$Be++,this._nodes=e,this._geometries=t,this.renderer=n,this.object=r,this.material=i,this.scene=a,this.camera=c,this.lightsNode=u,this.context=p,this.geometry=r.geometry,this.version=i.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=y,this.clippingContextCacheKey=y!==null?y.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],r=new Set;for(const i of e){const a=i.node&&i.node.attribute?i.node.attribute:t.getAttribute(i.name);if(a===void 0)continue;n.push(a);const c=a.isInterleavedBufferAttribute?a.data:a;r.add(c)}return this.attributes=n,this.vertexBuffers=Array.from(r.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:r,drawRange:i}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),c=this.getIndex(),u=c!==null;let p=1;if(n.isInstancedBufferGeometry===!0?p=n.instanceCount:e.count!==void 0&&(p=Math.max(0,e.count)),p===0)return null;if(a.instanceCount=p,e.isBatchedMesh===!0)return a;let y=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(y=2);let x=i.start*y,S=(i.start+i.count)*y;r!==null&&(x=Math.max(x,r.start*y),S=Math.min(S,(r.start+r.count)*y));const M=n.attributes.position;let I=1/0;u?I=c.count:M!=null&&(I=M.count),x=Math.max(x,0),S=Math.min(S,I);const L=S-x;return L<0||L===1/0?null:(a.vertexCount=L,a.firstVertex=x,a)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const r=e.attributes[n];t+=n+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const n of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[n];t+="morph-"+n+",";for(let i=0,a=r.length;i<a;i++){const c=r[i];t+=c.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let n=t.customProgramCacheKey();for(const r of qBe(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const i=t[r];let a;if(i!==null){const c=typeof i;c==="number"?a=i!==0?"1":"0":c==="object"?(a="{",i.isTexture&&(a+=i.mapping),a+="}"):a=String(i)}else a=String(i);n+=a+","}return n+=this.clippingContextCacheKey+",",e.geometry&&(n+=this.getGeometryCacheKey()),e.skeleton&&(n+=e.skeleton.bones.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(n+=e._colorsTexture.uuid+",")),e.count>1&&(n+=e.uuid+","),n+=e.receiveShadow+",",VBe(n)}get needsGeometryUpdate(){return this.geometry.id!==this.object.geometry.id}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=Ak(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=Ak(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const H8=[];class YBe{constructor(e,t,n,r,i,a){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=r,this.bindings=i,this.info=a,this.chainMaps={}}get(e,t,n,r,i,a,c,u){const p=this.getChainMap(u);H8[0]=e,H8[1]=t,H8[2]=a,H8[3]=i;let y=p.get(H8);return y===void 0?(y=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,i,a,c,u),p.set(H8,y)):(y.updateClipping(c),y.needsGeometryUpdate&&y.setGeometry(e.geometry),(y.version!==t.version||y.needsUpdate)&&(y.initialCacheKey!==y.getCacheKey()?(y.dispose(),y=this.get(e,t,n,r,i,a,c,u)):y.version=t.version)),H8.length=0,y}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Lf)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,r,i,a,c,u,p,y,x){const S=this.getChainMap(x),M=new XBe(e,t,n,r,i,a,c,u,p,y);return M.onDispose=()=>{this.pipelines.delete(M),this.bindings.delete(M),this.nodes.delete(M),S.delete(M.getChainArray())},M}}class J3{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const rd={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},F3=16,KBe=211,ZBe=212;class QBe extends J3{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(n.version===void 0)t===rd.VERTEX?this.backend.createAttribute(e):t===rd.INDEX?this.backend.createIndexAttribute(e):t===rd.STORAGE?this.backend.createStorageAttribute(e):t===rd.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(n.version<r.version||r.usage===fx)&&(this.backend.updateAttribute(e),n.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}const Ng=JBe();function JBe(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),r=new Uint32Array(512);for(let u=0;u<256;++u){const p=u-127;p<-27?(n[u]=0,n[u|256]=32768,r[u]=24,r[u|256]=24):p<-14?(n[u]=1024>>-p-14,n[u|256]=1024>>-p-14|32768,r[u]=-p-1,r[u|256]=-p-1):p<=15?(n[u]=p+15<<10,n[u|256]=p+15<<10|32768,r[u]=13,r[u|256]=13):p<128?(n[u]=31744,n[u|256]=64512,r[u]=24,r[u|256]=24):(n[u]=31744,n[u|256]=64512,r[u]=13,r[u|256]=13)}const i=new Uint32Array(2048),a=new Uint32Array(64),c=new Uint32Array(64);for(let u=1;u<1024;++u){let p=u<<13,y=0;for(;(p&8388608)===0;)p<<=1,y-=8388608;p&=-8388609,y+=947912704,i[u]=p|y}for(let u=1024;u<2048;++u)i[u]=939524096+(u-1024<<13);for(let u=1;u<31;++u)a[u]=u<<23;a[31]=1199570944,a[32]=2147483648;for(let u=33;u<63;++u)a[u]=2147483648+(u-32<<23);a[63]=3347054592;for(let u=1;u<64;++u)u!==32&&(c[u]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:i,exponentTable:a,offsetTable:c}}function Hu(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=yi(s,-65504,65504),Ng.floatView[0]=s;const e=Ng.uint32View[0],t=e>>23&511;return Ng.baseTable[t]+((e&8388607)>>Ng.shiftTable[t])}function ZR(s){const e=s>>10;return Ng.uint32View[0]=Ng.mantissaTable[Ng.offsetTable[e]+(s&1023)]+Ng.exponentTable[e],Ng.floatView[0]}const la=new pt,QR=new ci;let eUe=0;class id{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:eUe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Ck,this.updateRanges=[],this.gpuType=Zu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)QR.fromBufferAttribute(this,t),QR.applyMatrix3(e),this.setXY(t,QR.x,QR.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.applyMatrix3(e),this.setXYZ(t,la.x,la.y,la.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.applyMatrix4(e),this.setXYZ(t,la.x,la.y,la.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.applyNormalMatrix(e),this.setXYZ(t,la.x,la.y,la.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.transformDirection(e),this.setXYZ(t,la.x,la.y,la.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=ac(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Qr(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ac(t,this.array)),t}setX(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ac(t,this.array)),t}setY(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ac(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ac(t,this.array)),t}setW(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array),r=Qr(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array),r=Qr(r,this.array),i=Qr(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Ck&&(e.usage=this.usage),e}}class Eye extends id{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Tye extends id{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Mye extends id{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=ZR(this.array[e*this.itemSize]);return this.normalized&&(t=ac(t,this.array)),t}setX(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize]=Hu(t),this}getY(e){let t=ZR(this.array[e*this.itemSize+1]);return this.normalized&&(t=ac(t,this.array)),t}setY(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize+1]=Hu(t),this}getZ(e){let t=ZR(this.array[e*this.itemSize+2]);return this.normalized&&(t=ac(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize+2]=Hu(t),this}getW(e){let t=ZR(this.array[e*this.itemSize+3]);return this.normalized&&(t=ac(t,this.array)),t}setW(e,t){return this.normalized&&(t=Qr(t,this.array)),this.array[e*this.itemSize+3]=Hu(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array)),this.array[e+0]=Hu(t),this.array[e+1]=Hu(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array),r=Qr(r,this.array)),this.array[e+0]=Hu(t),this.array[e+1]=Hu(n),this.array[e+2]=Hu(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array),r=Qr(r,this.array),i=Qr(i,this.array)),this.array[e+0]=Hu(t),this.array[e+1]=Hu(n),this.array[e+2]=Hu(r),this.array[e+3]=Hu(i),this}}class uc extends id{constructor(e,t,n){super(new Float32Array(e),t,n)}}function Cye(s){return s.index!==null?s.index.version:s.attributes.position.version}function a4e(s){const e=[],t=s.index,n=s.attributes.position;if(t!==null){const i=t.array;for(let a=0,c=i.length;a<c;a+=3){const u=i[a+0],p=i[a+1],y=i[a+2];e.push(u,p,p,y,y,u)}}else{const i=n.array;for(let a=0,c=i.length/3-1;a<c;a+=3){const u=a+0,p=a+1,y=a+2;e.push(u,p,p,y,y,u)}}const r=new(xye(e)?Tye:Eye)(e,1);return r.version=Cye(s),r}class tUe extends J3{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,n=this.get(t);n.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const i=t.index,a=e.getAttributes();i!==null&&this.attributes.delete(i);for(const u of a)this.attributes.delete(u);const c=this.wireframes.get(t);c!==void 0&&this.attributes.delete(c),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const i of t)i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute?this.updateAttribute(i,rd.STORAGE):this.updateAttribute(i,rd.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,rd.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,rd.INDIRECT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:n}=e;let r=t.index;if(n.wireframe===!0){const i=this.wireframes;let a=i.get(t);a===void 0?(a=a4e(t),i.set(t,a)):a.version!==Cye(t)&&(this.attributes.delete(a),a=a4e(t),i.set(t,a)),r=a}return r}}class nUe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class Aye{constructor(e){this.cacheKey=e,this.usedTimes=0}}class rUe extends Aye{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class iUe extends Aye{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let sUe=0;class oG{constructor(e,t,n,r=null,i=null){this.id=sUe++,this.code=e,this.stage=t,this.name=n,this.transforms=r,this.attributes=i,this.usedTimes=0}}class oUe extends J3{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);const a=this.nodes.getForCompute(e);let c=this.programs.compute.get(a.computeShader);c===void 0&&(i&&i.computeProgram.usedTimes===0&&this._releaseProgram(i.computeProgram),c=new oG(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,c),n.createProgram(c));const u=this._getComputeCacheKey(e,c);let p=this.caches.get(u);p===void 0&&(i&&i.usedTimes===0&&this._releasePipeline(i),p=this._getComputePipeline(e,c,u,t)),p.usedTimes++,c.usedTimes++,r.version=e.version,r.pipeline=p}return r.pipeline}getForRender(e,t=null){const{backend:n}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);const a=e.getNodeBuilderState(),c=e.material?e.material.name:"";let u=this.programs.vertex.get(a.vertexShader);u===void 0&&(i&&i.vertexProgram.usedTimes===0&&this._releaseProgram(i.vertexProgram),u=new oG(a.vertexShader,"vertex",c),this.programs.vertex.set(a.vertexShader,u),n.createProgram(u));let p=this.programs.fragment.get(a.fragmentShader);p===void 0&&(i&&i.fragmentProgram.usedTimes===0&&this._releaseProgram(i.fragmentProgram),p=new oG(a.fragmentShader,"fragment",c),this.programs.fragment.set(a.fragmentShader,p),n.createProgram(p));const y=this._getRenderCacheKey(e,u,p);let x=this.caches.get(y);x===void 0?(i&&i.usedTimes===0&&this._releasePipeline(i),x=this._getRenderPipeline(e,u,p,y,t)):e.pipeline=x,x.usedTimes++,u.usedTimes++,p.usedTimes++,r.pipeline=x}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,r){n=n||this._getComputeCacheKey(e,t);let i=this.caches.get(n);return i===void 0&&(i=new iUe(n,t),this.caches.set(n,i),this.backend.createComputePipeline(i,r)),i}_getRenderPipeline(e,t,n,r,i){r=r||this._getRenderCacheKey(e,t,n);let a=this.caches.get(r);return a===void 0&&(a=new rUe(r,t,n),this.caches.set(r,a),e.pipeline=a,this.backend.createRenderPipeline(e,i)),a}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class aUe extends J3{constructor(e,t,n,r,i,a){super(),this.backend=e,this.textures=n,this.pipelines=i,this.attributes=r,this.nodes=t,this.info=a,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const n=t.attribute,r=n.isIndirectStorageBufferAttribute?rd.INDIRECT:rd.STORAGE;this.attributes.update(n,r)}}_update(e,t){const{backend:n}=this;let r=!1,i=!0,a=0,c=0;for(const u of e.bindings)if(!(u.isNodeUniformsGroup&&this.nodes.updateGroup(u)===!1)){if(u.isStorageBuffer){const p=u.attribute,y=p.isIndirectStorageBufferAttribute?rd.INDIRECT:rd.STORAGE;this.attributes.update(p,y)}if(u.isUniformBuffer)u.update()&&n.updateBinding(u);else if(u.isSampler)u.update();else if(u.isSampledTexture){const p=this.textures.get(u.texture);u.needsBindingsUpdate(p.generation)&&(r=!0);const y=u.update(),x=u.texture;y&&this.textures.updateTexture(x);const S=n.get(x);if(S.externalTexture!==void 0||p.isDefaultTexture?i=!1:(a=a*10+x.id,c+=x.version),n.isWebGPUBackend===!0&&S.texture===void 0&&S.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",u,y,x,u.textureNode.value,r),this.textures.updateTexture(x),r=!0),x.isStorageTexture===!0){const M=this.get(x);u.store===!0?M.needsMipmap=!0:this.textures.needsMipmaps(x)&&M.needsMipmap===!0&&(this.backend.generateMipmaps(x),M.needsMipmap=!1)}}}r===!0&&this.backend.updateBindings(e,t,i?a:0,c)}}function lUe(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?s.z-e.z:s.id-e.id}function l4e(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function c4e(s){return(s.transmission>0||s.transmissionNode)&&s.side===Sx&&s.forceSinglePass===!1}class cUe{constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,r,i,a,c){let u=this.renderItems[this.renderItemsIndex];return u===void 0?(u={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:i,group:a,clippingContext:c},this.renderItems[this.renderItemsIndex]=u):(u.id=e.id,u.object=e,u.geometry=t,u.material=n,u.groupOrder=r,u.renderOrder=e.renderOrder,u.z=i,u.group=a,u.clippingContext=c),this.renderItemsIndex++,u}push(e,t,n,r,i,a,c){const u=this.getNextRenderItem(e,t,n,r,i,a,c);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0?(c4e(n)&&this.transparentDoublePass.push(u),this.transparent.push(u)):this.opaque.push(u)}unshift(e,t,n,r,i,a,c){const u=this.getNextRenderItem(e,t,n,r,i,a,c);n.transparent===!0||n.transmission>0?(c4e(n)&&this.transparentDoublePass.unshift(u),this.transparent.unshift(u)):this.opaque.unshift(u)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||lUe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||l4e),this.transparent.length>1&&this.transparent.sort(t||l4e)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}const mw=[];class uUe{constructor(e){this.lighting=e,this.lists=new Lf}get(e,t){const n=this.lists;mw[0]=e,mw[1]=t;let r=n.get(mw);return r===void 0&&(r=new cUe(this.lighting,e,t),n.set(mw,r)),mw.length=0,r}dispose(){this.lists=new Lf}}let hUe=0;class dUe{constructor(){this.id=hUe++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Ri,this.scissor=!1,this.scissorValue=new Ri,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return Pye(this)}}function Pye(s){const{textures:e,activeCubeFace:t}=s,n=[t];for(const r of e)n.push(r.id);return h$(n)}let Av=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,a=r.length;i<a;i++)r[i].call(this,e);e.target=null}}};const u4e=new Is,h4e=new i_;class ad{constructor(e=0,t=0,n=0,r=ad.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],c=r[8],u=r[1],p=r[5],y=r[9],x=r[2],S=r[6],M=r[10];switch(t){case"XYZ":this._y=Math.asin(yi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-y,M),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(S,p),this._z=0);break;case"YXZ":this._x=Math.asin(-yi(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(c,M),this._z=Math.atan2(u,p)):(this._y=Math.atan2(-x,i),this._z=0);break;case"ZXY":this._x=Math.asin(yi(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,M),this._z=Math.atan2(-a,p)):(this._y=0,this._z=Math.atan2(u,i));break;case"ZYX":this._y=Math.asin(-yi(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,M),this._z=Math.atan2(u,i)):(this._x=0,this._z=Math.atan2(-a,p));break;case"YZX":this._z=Math.asin(yi(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-y,p),this._y=Math.atan2(-x,i)):(this._x=0,this._y=Math.atan2(c,M));break;case"XZY":this._z=Math.asin(-yi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(S,p),this._y=Math.atan2(c,i)):(this._x=Math.atan2(-y,M),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return u4e.makeRotationFromQuaternion(e),this.setFromRotationMatrix(u4e,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return h4e.setFromEuler(this),this.setFromQuaternion(h4e,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ad.DEFAULT_ORDER="XYZ";class fUe{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let pUe=0;const d4e=new pt,D7=new i_,Eg=new Is,JR=new pt,gw=new pt,mUe=new pt,gUe=new i_,f4e=new pt(1,0,0),p4e=new pt(0,1,0),m4e=new pt(0,0,1),g4e={type:"added"},vUe={type:"removed"},O7={type:"childadded",child:null},aG={type:"childremoved",child:null};class Aa extends Av{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:pUe++}),this.uuid=Fg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Aa.DEFAULT_UP.clone();const e=new pt,t=new ad,n=new i_,r=new pt(1,1,1);function i(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(i),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Is},normalMatrix:{value:new nu}}),this.matrix=new Is,this.matrixWorld=new Is,this.matrixAutoUpdate=Aa.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Aa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new fUe,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return D7.setFromAxisAngle(e,t),this.quaternion.multiply(D7),this}rotateOnWorldAxis(e,t){return D7.setFromAxisAngle(e,t),this.quaternion.premultiply(D7),this}rotateX(e){return this.rotateOnAxis(f4e,e)}rotateY(e){return this.rotateOnAxis(p4e,e)}rotateZ(e){return this.rotateOnAxis(m4e,e)}translateOnAxis(e,t){return d4e.copy(e).applyQuaternion(this.quaternion),this.position.add(d4e.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(f4e,e)}translateY(e){return this.translateOnAxis(p4e,e)}translateZ(e){return this.translateOnAxis(m4e,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Eg.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?JR.copy(e):JR.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),gw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Eg.lookAt(gw,JR,this.up):Eg.lookAt(JR,gw,this.up),this.quaternion.setFromRotationMatrix(Eg),r&&(Eg.extractRotation(r.matrixWorld),D7.setFromRotationMatrix(Eg),this.quaternion.premultiply(D7.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(g4e),O7.child=e,this.dispatchEvent(O7),O7.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(vUe),aG.child=e,this.dispatchEvent(aG),aG.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Eg.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Eg.multiply(e.parent.matrixWorld)),e.applyMatrix4(Eg),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(g4e),O7.child=e,this.dispatchEvent(O7),O7.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gw,e,mUe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gw,gUe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(c=>({...c})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function i(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const u=c.shapes;if(Array.isArray(u))for(let p=0,y=u.length;p<y;p++){const x=u[p];i(e.shapes,x)}else i(e.shapes,u)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let u=0,p=this.material.length;u<p;u++)c.push(i(e.materials,this.material[u]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){const u=this.animations[c];r.animations.push(i(e.animations,u))}}if(t){const c=a(e.geometries),u=a(e.materials),p=a(e.textures),y=a(e.images),x=a(e.shapes),S=a(e.skeletons),M=a(e.animations),I=a(e.nodes);c.length>0&&(n.geometries=c),u.length>0&&(n.materials=u),p.length>0&&(n.textures=p),y.length>0&&(n.images=y),x.length>0&&(n.shapes=x),S.length>0&&(n.skeletons=S),M.length>0&&(n.animations=M),I.length>0&&(n.nodes=I)}return n.object=r,n;function a(c){const u=[];for(const p in c){const y=c[p];delete y.metadata,u.push(y)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Aa.DEFAULT_UP=new pt(0,1,0);Aa.DEFAULT_MATRIX_AUTO_UPDATE=!0;Aa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;class d$ extends Aa{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ad,this.environmentIntensity=1,this.environmentRotation=new ad,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class f$ extends Aa{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Is,this.projectionMatrix=new Is,this.projectionMatrixInverse=new Is,this.coordinateSystem=Zc}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const vw=[],yUe=new d$,xUe=new f$;class _Ue{constructor(){this.chainMaps={}}get(e,t,n=null){vw[0]=e,vw[1]=t;let r;if(n===null)r="default";else{const c=n.texture.format;r=`${n.textures.length}:${c}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const i=this._getChainMap(r);let a=i.get(vw);return a===void 0&&(a=new dUe,i.set(vw,a)),vw.length=0,n!==null&&(a.sampleCount=n.samples===0?1:n.samples),a}getForClear(e=null){return this.get(yUe,xUe,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Lf)}dispose(){this.chainMaps={}}}let L7;class bUe{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{L7===void 0&&(L7=KH("canvas")),L7.width=e.width,L7.height=e.height;const r=L7.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=L7}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=KH("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let a=0;a<i.length;a++)i[a]=Gg(i[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Gg(t[n]/255)*255):t[n]=Gg(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let SUe=0;class p${constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:SUe++}),this.uuid=Fg(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let a=0,c=r.length;a<c;a++)r[a].isDataTexture?i.push(lG(r[a].image)):i.push(lG(r[a]))}else i=lG(r);n.url=i}return t||(e.images[this.uuid]=n),n}}function lG(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?bUe.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let wUe=0;const cG=new pt;class _l extends Av{constructor(e=_l.DEFAULT_IMAGE,t=_l.DEFAULT_MAPPING,n=z3,r=z3,i=th,a=zg,c=nd,u=lc,p=_l.DEFAULT_ANISOTROPY,y=$g){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wUe++}),this.uuid=Fg(),this.name="",this.source=new p$(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=u,this.offset=new ci(0,0),this.repeat=new ci(1,1),this.center=new ci(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new nu,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(cG).x}get height(){return this.source.getSize(cG).y}get depth(){return this.source.getSize(cG).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==n$)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Hx:e.x=e.x-Math.floor(e.x);break;case z3:e.x=e.x<0?0:1;break;case Wx:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Hx:e.y=e.y-Math.floor(e.y);break;case z3:e.y=e.y<0?0:1;break;case Wx:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}_l.DEFAULT_IMAGE=null;_l.DEFAULT_MAPPING=n$;_l.DEFAULT_ANISOTROPY=1;class w1 extends _l{constructor(e,t,n=Zo,r,i,a,c=Ca,u=Ca,p,y=S1,x=1){if(y!==S1&&y!==Vg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const S={width:e,height:t,depth:x};super(S,r,i,a,c,u,y,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new p$(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const EUe=new pt;class TUe extends J3{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),r=e.samples===0?1:e.samples,i=n.depthTextureMips||(n.depthTextureMips={}),a=e.textures,c=this.getSize(a[0]),u=c.width>>t,p=c.height>>t;let y=e.depthTexture||i[t];const x=e.depthBuffer===!0||e.stencilBuffer===!0;let S=!1;y===void 0&&x&&(y=new w1,y.format=e.stencilBuffer?Vg:S1,y.type=e.stencilBuffer?G3:Zo,y.image.width=u,y.image.height=p,y.image.depth=c.depth,y.isArrayTexture=e.multiview===!0&&c.depth>1,i[t]=y),(n.width!==c.width||c.height!==n.height)&&(S=!0,y&&(y.needsUpdate=!0,y.image.width=u,y.image.height=p,y.image.depth=y.isArrayTexture?y.image.depth:1)),n.width=c.width,n.height=c.height,n.textures=a,n.depthTexture=y||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==r&&(S=!0,y&&(y.needsUpdate=!0),n.sampleCount=r);const M={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let I=0;I<a.length;I++){const L=a[I];S&&(L.needsUpdate=!0),this.updateTexture(L,M)}y&&this.updateTexture(y,M)}if(n.initialized!==!0){n.initialized=!0;const I=()=>{e.removeEventListener("dispose",I);for(let L=0;L<a.length;L++)this._destroyTexture(a[L]);y&&this._destroyTexture(y),this.delete(e)};e.addEventListener("dispose",I)}}updateTexture(e,t={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,i=this.backend;if(r&&n.initialized===!0&&(i.destroySampler(e),i.destroyTexture(e)),e.isFramebufferTexture){const p=this.renderer.getRenderTarget();p?e.type=p.texture.type:e.type=lc}const{width:a,height:c,depth:u}=this.getSize(e);if(t.width=a,t.height=c,t.depth=u,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,a,c):1,r||e.isStorageTexture===!0)i.createSampler(e),i.createTexture(e,t),n.generation=e.version;else if(n.initialized!==!0&&i.createSampler(e),e.version>0){const y=e.image;if(y===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(y.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const x=[];for(const S of e.images)x.push(S);t.images=x}else t.image=y;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(i.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&i.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&i.generateMipmaps(e)}}else i.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;if(n.initialized!==!0){n.initialized=!0,n.generation=e.version,this.info.memory.textures++;const p=()=>{e.removeEventListener("dispose",p),this._destroyTexture(e)};e.addEventListener("dispose",p)}n.version=e.version}getSize(e,t=EUe){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let r;return e.isCompressedTexture?e.mipmaps?r=e.mipmaps.length:r=1:r=Math.floor(Math.log2(Math.max(t,n)))+1,r}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class m$ extends Zi{constructor(e,t,n,r=1){super(e,t,n),this.a=r}set(e,t,n,r=1){return this.a=r,super.set(e,t,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}const eI={VERTEX:"vertex"},pi={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Og={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},MUe=["fragment","vertex"],v4e=["setup","analyze","generate"],y4e=[...MUe,"compute"],s_=["x","y","z","w"],CUe={analyze:"setup",generate:"analyze"};let AUe=0,Xr=class extends Av{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=pi.NONE,this.updateBeforeType=pi.NONE,this.updateAfterType=pi.NONE,this.uuid=tBe.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:AUe++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,pi.FRAME)}onRenderUpdate(e){return this.onUpdate(e,pi.RENDER)}onObjectUpdate(e){return this.onUpdate(e,pi.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of Pk(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=Ak(bye(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())t["node"+n++]=r;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(this.parents===!0){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(n===1){const r=e.getNodeProperties(this);for(const i of Object.values(r))i&&i.isNode===!0&&i.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&n.isNode===!0)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);const r=e.getDataFromNode(this);r.buildStages=r.buildStages||{},r.buildStages[e.buildStage]=!0;const i=CUe[e.buildStage];if(i&&r.buildStages[i]!==!0){const u=e.getBuildStage();e.setBuildStage(i),this.build(e),e.setBuildStage(u)}e.addNode(this),e.addChain(this);let a=null;const c=e.getBuildStage();if(c==="setup"){this.updateReference(e);const u=e.getNodeProperties(this);if(u.initialized!==!0){u.initialized=!0,u.outputNode=this.setup(e)||u.outputNode||null;for(const p of Object.values(u))if(p&&p.isNode===!0){if(p.parents===!0){const y=e.getNodeProperties(p);y.parents=y.parents||[],y.parents.push(this)}p.build(e)}}a=u.outputNode}else if(c==="analyze")this.analyze(e,t);else if(c==="generate")if(this.generate.length===1){const p=this.getNodeType(e),y=e.getDataFromNode(this);a=y.snippet,a===void 0?y.generated===void 0?(y.generated=!0,a=this.generate(e)||"",y.snippet=a):(console.warn("THREE.Node: Recursion detected.",this),a=""):y.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),a=e.format(a,p,t)}else a=this.generate(e,t)||"";return e.removeChain(this),e.addSequentialNode(this),a}getSerializeChildren(){return Pk(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:i,childNode:a}of t)i!==void 0?(n[r]===void 0&&(n[r]=Number.isInteger(i)?[]:{}),n[r][i]=a.toJSON(e.meta).uuid):n[r]=a.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const i of e.inputNodes[n])r.push(t[i]);this[n]=r}else if(typeof e.inputNodes[n]=="object"){const r={};for(const i in e.inputNodes[n]){const a=e.inputNodes[n][i];r[i]=t[a]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let i=e.nodes[t];i===void 0&&(i={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta);function a(c){const u=[];for(const p in c){const y=c[p];delete y.metadata,u.push(y)}return u}if(r){const c=a(e.textures),u=a(e.images),p=a(e.nodes);c.length>0&&(i.textures=c),u.length>0&&(i.images=u),p.length>0&&(i.nodes=p)}return i}};class ma extends Xr{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),i=e.getDataFromNode(this);if(i.propertyName!==void 0)return e.format(i.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const a=super.build(e,r),c=e.getVarFromNode(this,null,r),u=e.getPropertyName(c);return e.addLineFlowCode(`${u} = ${a}`,this),i.snippet=a,i.propertyName=u,e.format(i.propertyName,r,t)}}return super.build(e,t)}}class UE extends Xr{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e),n=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${n}[ ${r} ]`}}class Rye extends Xr{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))(n===null||e.getTypeLength(t)===e.getTypeLength(r))&&(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),i=n.build(e,r);return e.format(i,r,t)}}class PUe extends ma{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),r=e.getTypeLength(n),i=this.nodes,a=e.getComponentType(n),c=[];let u=0;for(const y of i){if(u>=r){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${n}()' type.`);break}let x=y.getNodeType(e),S=e.getTypeLength(x),M;u+S>r&&(console.error(`THREE.TSL: Length of '${n}()' data exceeds maximum length of output type.`),S=r-u,x=e.getTypeFromLength(S)),u+=S,M=y.build(e,x);const I=e.getComponentType(x);I!==a&&(M=e.format(M,I,a)),c.push(M)}const p=`${e.getType(n)}( ${c.join(", ")} )`;return e.format(p,n,t)}}const RUe=s_.join("");class x4e extends Xr{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(s_.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let i=null;if(r>1){let a=null;this.getVectorLength()>=r&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const u=n.build(e,a);this.components.length===r&&this.components===RUe.slice(0,this.components.length)?i=e.format(u,a,t):i=e.format(`${u}.${this.components}`,this.getNodeType(e),t)}else i=n.build(e,t);return i}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class IUe extends ma{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,i=this.getNodeType(e),a=e.getComponentType(r.getNodeType(e)),c=e.getTypeFromLength(n.length,a),u=r.build(e,c),p=t.build(e,i),y=e.getTypeLength(i),x=[];for(let S=0;S<y;S++){const M=s_[S];M===n[0]?(x.push(u),S+=n.length-1):x.push(p+"."+M)}return`${e.getType(i)}( ${x.join(", ")} )`}}class kUe extends ma{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),i=n.build(e),a=e.getVarFromNode(this),c=e.getPropertyName(a);e.addLineFlowCode(c+" = "+i,this);const u=e.getTypeLength(r),p=[];let y=0;for(let x=0;x<u;x++){const S=s_[x];S===t[y]?(p.push("1.0 - "+(c+"."+S)),y++):p.push(c+"."+S)}return`${e.getType(r)}( ${p.join(", ")} )`}}class g$ extends Xr{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?Rk(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Rk(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=HBe(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?Sye(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const _4e=/float|u?int/;class Kg extends g${static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return _4e.test(n)&&_4e.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class NUe extends Xr{static get type(){return"MemberNode"}constructor(e,t){super(),this.node=e,this.property=t,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let $x=null;const px=new Map;function Lt(s,e){if(px.has(s)){console.warn(`THREE.TSL: Redefinition of method chaining '${s}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${s} is not a function`);px.set(s,e)}const Iye=s=>s.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),b4e=s=>Iye(s).split("").sort().join(""),kye={setup(s,e){const t=e.shift();return s(Qk(t),...e)},get(s,e,t){if(typeof e=="string"&&s[e]===void 0){if(s.isStackNode!==!0&&e==="assign")return(...n)=>($x.assign(t,...n),t);if(px.has(e)){const n=px.get(e);return s.isStackNode?(...r)=>t.add(n(...r)):(...r)=>n(t,...r)}else{if(e==="self")return s;if(e.endsWith("Assign")&&px.has(e.slice(0,e.length-6))){const n=px.get(e.slice(0,e.length-6));return s.isStackNode?(...r)=>t.assign(r[0],n(...r)):(...r)=>t.assign(n(t,...r))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=Iye(e),sn(new x4e(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=b4e(e.slice(3).toLowerCase()),n=>sn(new IUe(s,e,sn(n)));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=b4e(e.slice(4).toLowerCase()),()=>sn(new kUe(sn(s),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),sn(new x4e(s,e));if(/^\d+$/.test(e)===!0)return sn(new UE(t,new Kg(Number(e),"uint")));if(/^get$/.test(e)===!0)return n=>sn(new NUe(t,n))}}}return Reflect.get(s,e,t)},set(s,e,t,n){return typeof e=="string"&&s[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(n[e].assign(t),!0):Reflect.set(s,e,t,n)}},uG=new WeakMap,S4e=new WeakMap,DUe=function(s,e=null){const t=Rk(s);if(t==="node"){let n=uG.get(s);return n===void 0&&(n=new Proxy(s,kye),uG.set(s,n),uG.set(n,n)),n}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return sn(ZH(s,e));if(t==="shader")return en(s)}return s},OUe=function(s,e=null){for(const t in s)s[t]=sn(s[t],e);return s},LUe=function(s,e=null){const t=s.length;for(let n=0;n<t;n++)s[n]=sn(s[n],e);return s},FUe=function(s,e=null,t=null,n=null){const r=y=>sn(n!==null?Object.assign(y,n):y);let i,a=e,c,u;function p(y){let x;return a?x=/[a-z]/i.test(a)?a+"()":a:x=s.type,c!==void 0&&y.length<c?(console.error(`THREE.TSL: "${x}" parameter length is less than minimum required.`),y.concat(new Array(c-y.length).fill(0))):u!==void 0&&y.length>u?(console.error(`THREE.TSL: "${x}" parameter length exceeds limit.`),y.slice(0,u)):y}return e===null?i=(...y)=>r(new s(...Mx(p(y)))):t!==null?(t=sn(t),i=(...y)=>r(new s(e,...Mx(p(y)),t))):i=(...y)=>r(new s(e,...Mx(p(y)))),i.setParameterLength=(...y)=>(y.length===1?c=u=y[0]:y.length===2&&([c,u]=y),i),i.setName=y=>(a=y,i),i},BUe=function(s,...e){return sn(new s(...Mx(e)))};class UUe extends Xr{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,inputNodes:n}=this,r=e.getNodeProperties(t),i=t.namespace&&t.namespace===e.namespace?e.getNamespace("once"):"once";if(r[i])return r[i];let a=null;if(t.layout){let c=S4e.get(e.constructor);c===void 0&&(c=new WeakMap,S4e.set(e.constructor,c));let u=c.get(t);u===void 0&&(u=sn(e.buildFunctionNode(t)),c.set(t,u)),e.addInclude(u),a=sn(u.call(n))}else{const c=t.jsFunc,u=n!==null||c.length>1?c(n||[],e):c(e);a=sn(u)}return t.once&&(r[i]=a),a}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getOutputNamespace();return t[n]=t[n]||this.setupOutput(e),t[n]}build(e,t=null){let n=null;const r=e.getBuildStage(),i=e.getNodeProperties(this),a=e.getOutputNamespace(),c=this.getOutputNode(e);if(r==="setup"){const u=e.getNamespace("initialized");i[u]!==!0&&(i[u]=!0,i[a]=this.getOutputNode(e),i[a].build(e)),n=i[a]}else r==="analyze"?c.build(e,t):r==="generate"&&(n=c.build(e,t)||"");return n}}class zUe extends Xr{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1,this.namespace=null}setLayout(e){return this.layout=e,this}call(e=null){return Qk(e),sn(new UUe(this,e))}setup(){return this.call()}}const VUe=[!1,!0],GUe=[0,1,2,3],jUe=[-1,-2],Nye=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],v$=new Map;for(const s of VUe)v$.set(s,new Kg(s));const y$=new Map;for(const s of GUe)y$.set(s,new Kg(s,"uint"));const x$=new Map([...y$].map(s=>new Kg(s.value,"int")));for(const s of jUe)x$.set(s,new Kg(s,"int"));const Kk=new Map([...x$].map(s=>new Kg(s.value)));for(const s of Nye)Kk.set(s,new Kg(s));for(const s of Nye)Kk.set(-s,new Kg(-s));const Zk={bool:v$,uint:y$,ints:x$,float:Kk},w4e=new Map([...v$,...Kk]),ZH=(s,e)=>w4e.has(s)?w4e.get(s):s.isNode===!0?s:new Kg(s,e),HUe=s=>{try{return s.getNodeType()}catch{return}},ga=function(s,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(s)&&t.every(r=>typeof r!="object"))&&(t=[Sye(s,...t)]),t.length===1&&e!==null&&e.has(t[0]))return sn(e.get(t[0]));if(t.length===1){const r=ZH(t[0],s);return HUe(r)===s?sn(r):sn(new Rye(r,s))}const n=t.map(r=>ZH(r));return sn(new PUe(n,s))}},E4e=s=>typeof s=="object"&&s!==null?s.value:s,WUe=s=>s!=null?s.nodeType||s.convertTo||(typeof s=="string"?s:null):null;function Xw(s,e){return new Proxy(new zUe(s,e),kye)}const sn=(s,e=null)=>DUe(s,e),Qk=(s,e=null)=>new OUe(s,e),Mx=(s,e=null)=>new LUe(s,e),nn=(...s)=>new FUe(...s),xn=(...s)=>new BUe(...s);let $Ue=0;const en=(s,e=null)=>{let t=null;e!==null&&(typeof e=="object"?t=e.return:(typeof e=="string"?t=e:console.error("THREE.TSL: Invalid layout type."),e=null));const n=new Xw(s,t),r=(...i)=>{let a;Qk(i),i[0]&&(i[0].isNode||Object.getPrototypeOf(i[0])!==Object.prototype)?a=[...i]:a=i[0];const u=n.call(a);return t==="void"&&u.toStack(),u};if(r.shaderNode=n,r.id=n.id,r.getNodeType=(...i)=>n.getNodeType(...i),r.getCacheKey=(...i)=>n.getCacheKey(...i),r.setLayout=i=>(n.setLayout(i),r),r.once=(i=null)=>(n.once=!0,n.namespace=i,r),e!==null){if(typeof e.inputs!="object"){const i={name:"fn"+$Ue++,type:t,inputs:[]};for(const a in e)a!=="return"&&i.inputs.push({name:a,type:e[a]});e=i}r.setLayout(e)}return r},Ik=s=>{$x=s},Dye=()=>$x,Jo=(...s)=>$x.If(...s);function Oye(s){return $x&&$x.add(s),s}Lt("toStack",Oye);const qUe=new ga("color"),Ut=new ga("float",Zk.float),zs=new ga("int",Zk.ints),XUe=new ga("uint",Zk.uint),_$=new ga("bool",Zk.bool),Sn=new ga("vec2"),Ig=new ga("ivec2"),YUe=new ga("uvec2"),KUe=new ga("bvec2"),zt=new ga("vec3"),ZUe=new ga("ivec3"),QUe=new ga("uvec3"),JUe=new ga("bvec3"),$r=new ga("vec4"),eze=new ga("ivec4"),tze=new ga("uvec4"),nze=new ga("bvec4"),b$=new ga("mat2"),hc=new ga("mat3"),Cx=new ga("mat4");Lt("toColor",qUe);Lt("toFloat",Ut);Lt("toInt",zs);Lt("toUint",XUe);Lt("toBool",_$);Lt("toVec2",Sn);Lt("toIVec2",Ig);Lt("toUVec2",YUe);Lt("toBVec2",KUe);Lt("toVec3",zt);Lt("toIVec3",ZUe);Lt("toUVec3",QUe);Lt("toBVec3",JUe);Lt("toVec4",$r);Lt("toIVec4",eze);Lt("toUVec4",tze);Lt("toBVec4",nze);Lt("toMat2",b$);Lt("toMat3",hc);Lt("toMat4",Cx);const rze=nn(UE).setParameterLength(2),ize=(s,e)=>sn(new Rye(sn(s),e));Lt("element",rze);Lt("convert",ize);Lt("append",s=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),Oye(s)));class sze extends ma{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return s_.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,r=e.getNodeProperties(this);r.sourceNode=n,r.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:r}=e.getNodeProperties(this),i=this.needsSplitAssign(e),a=n.getNodeType(e),c=n.build(e),u=r.build(e,a),p=r.getNodeType(e),y=e.getDataFromNode(this);let x;if(y.initialized===!0)t!=="void"&&(x=c);else if(i){const S=e.getVarFromNode(this,null,a),M=e.getPropertyName(S);e.addLineFlowCode(`${M} = ${u}`,this);const I=n.node,B=I.node.context({assign:!0}).build(e);for(let A=0;A<I.components.length;A++){const V=I.components[A];e.addLineFlowCode(`${B}.${V} = ${M}[ ${A} ]`,this)}t!=="void"&&(x=c)}else x=`${c} = ${u}`,(t==="void"||p==="void")&&(e.addLineFlowCode(x,this),t!=="void"&&(x=c));return y.initialized=!0,e.format(x,a,t)}}const oze=nn(sze).setParameterLength(2);Lt("assign",oze);class T4e extends ma{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const aze=(...s)=>{let e;if(s.length===1){const t=s[0];e=new T4e(null,t.length,t)}else{const t=s[0],n=s[1];e=new T4e(t,n)}return sn(e)};Lt("toArray",(s,e)=>aze(Array(e).fill(s)));class Lye extends Xr{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const lze=s=>new Lye(s),S$=(s,e=0)=>new Lye(s,!0,e),cze=S$("frame"),kr=S$("render"),Fye=lze("object");class zE extends g${static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=Fye}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const n=this.getSelf();return e=e.bind(n),super.onUpdate(r=>{const i=e(r,n);i!==void 0&&(this.value=i)},t)}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let i=e.getNodeFromHash(r);i===void 0&&(e.setHashNode(this,r),i=this);const a=i.getInputType(e),c=e.getUniformFromNode(i,a,e.shaderStage,this.name||e.context.label),u=e.getPropertyName(c);return e.context.label!==void 0&&delete e.context.label,e.format(u,n,t)}}const Nr=(s,e)=>{const t=WUe(e||s),n=s&&s.isNode===!0?s.node&&s.node.value||s.value:s;return sn(new zE(n,t))};class cs extends Xr{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const Bye=(s,e)=>sn(new cs(s,e)),kk=(s,e)=>sn(new cs(s,e,!0)),Ki=xn(cs,"vec4","DiffuseColor"),M4e=xn(cs,"vec3","EmissiveColor"),Dg=xn(cs,"float","Roughness"),Nk=xn(cs,"float","Metalness"),QH=xn(cs,"float","Clearcoat"),Dk=xn(cs,"float","ClearcoatRoughness"),mx=xn(cs,"vec3","Sheen"),w$=xn(cs,"float","SheenRoughness"),E$=xn(cs,"float","Iridescence"),Uye=xn(cs,"float","IridescenceIOR"),zye=xn(cs,"float","IridescenceThickness"),JH=xn(cs,"float","AlphaT"),ov=xn(cs,"float","Anisotropy"),JI=xn(cs,"vec3","AnisotropyT"),Ax=xn(cs,"vec3","AnisotropyB"),qu=xn(cs,"color","SpecularColor"),Ok=xn(cs,"float","SpecularF90"),eW=xn(cs,"float","Shininess"),cE=xn(cs,"vec4","Output"),hG=xn(cs,"float","dashSize"),C4e=xn(cs,"float","gapSize"),ek=xn(cs,"float","IOR"),tW=xn(cs,"float","Transmission"),Vye=xn(cs,"float","Thickness"),Gye=xn(cs,"float","AttenuationDistance"),jye=xn(cs,"color","AttenuationColor"),Hye=xn(cs,"float","Dispersion");class uze extends ma{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),i=this.parameters,a=(u,p)=>{const y=p.type,x=y==="pointer";let S;return x?S="&"+u.build(e):S=u.build(e,y),S};if(Array.isArray(i)){if(i.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),i.length=r.length;else if(i.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");i.length<r.length;)i.push(Ut(0));for(let u=0;u<i.length;u++)t.push(a(i[u],r[u]))}else for(const u of r){const p=i[u.name];p!==void 0?t.push(a(p,u)):(console.error(`THREE.TSL: Input '${u.name}' not found in 'Fn()'.`),t.push(a(Ut(0),u)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}const hze=(s,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?Mx(e):Qk(e[0]),sn(new uze(sn(s),e)));Lt("call",hze);const dze={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class oo extends ma{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let i=new oo(e,t,n);for(let a=0;a<r.length-1;a++)i=new oo(e,i,r[a]);t=i,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(dze[this.op],t)}getNodeType(e){const t=this.op,n=this.aNode,r=this.bNode,i=n.getNodeType(e),a=r?r.getNodeType(e):null;if(i==="void"||a==="void")return"void";if(t==="%")return i;if(t==="~"||t==="&"||t==="|"||t==="^"||t===">>"||t==="<<")return e.getIntegerType(i);if(t==="!"||t==="&&"||t==="||"||t==="^^")return"bool";if(t==="=="||t==="!="||t==="<"||t===">"||t==="<="||t===">="){const c=Math.max(e.getTypeLength(i),e.getTypeLength(a));return c>1?`bvec${c}`:"bool"}else{if(e.isMatrix(i)){if(a==="float")return i;if(e.isVector(a))return e.getVectorFromMatrix(i);if(e.isMatrix(a))return i}else if(e.isMatrix(a)){if(i==="float")return a;if(e.isVector(i))return e.getVectorFromMatrix(a)}return e.getTypeLength(a)>e.getTypeLength(i)?a:i}}generate(e,t){const n=this.op,{aNode:r,bNode:i}=this,a=this.getNodeType(e);let c=null,u=null;a!=="void"?(c=r.getNodeType(e),u=i?i.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="||n==="!="?e.isVector(c)?u=c:e.isVector(u)?c=u:c!==u&&(c=u="float"):n===">>"||n==="<<"?(c=a,u=e.changeComponentType(u,"uint")):n==="%"?(c=a,u=e.isInteger(c)&&e.isInteger(u)?u:c):e.isMatrix(c)?u==="float"?u="float":e.isVector(u)?u=e.getVectorFromMatrix(c):e.isMatrix(u)||(c=u=a):e.isMatrix(u)?c==="float"?c="float":e.isVector(c)?c=e.getVectorFromMatrix(u):c=u=a:c=u=a):c=u=a;const p=r.build(e,c),y=i?i.build(e,u):null,x=e.getFunctionOperator(n);if(t!=="void"){const S=e.renderer.coordinateSystem===Zc;if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">=")return S?e.isVector(c)?e.format(`${this.getOperatorMethod(e,t)}( ${p}, ${y} )`,a,t):e.format(`( ${p} ${n} ${y} )`,a,t):e.format(`( ${p} ${n} ${y} )`,a,t);if(n==="%")return e.isInteger(u)?e.format(`( ${p} % ${y} )`,a,t):e.format(`${this.getOperatorMethod(e,a)}( ${p}, ${y} )`,a,t);if(n==="!"||n==="~")return e.format(`(${n}${p})`,c,t);if(x)return e.format(`${x}( ${p}, ${y} )`,a,t);if(e.isMatrix(c)&&u==="float")return e.format(`( ${y} ${n} ${p} )`,a,t);if(c==="float"&&e.isMatrix(u))return e.format(`${p} ${n} ${y}`,a,t);{let M=`( ${p} ${n} ${y} )`;return!S&&a==="bool"&&e.isVector(c)&&e.isVector(u)&&(M=`all${M}`),e.format(M,a,t)}}else if(c!=="void")return x?e.format(`${x}( ${p}, ${y} )`,a,t):e.isMatrix(c)&&u==="float"?e.format(`${y} ${n} ${p}`,a,t):e.format(`${p} ${n} ${y}`,a,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const dc=nn(oo,"+").setParameterLength(2,1/0).setName("add"),oc=nn(oo,"-").setParameterLength(2,1/0).setName("sub"),_i=nn(oo,"*").setParameterLength(2,1/0).setName("mul"),T1=nn(oo,"/").setParameterLength(2,1/0).setName("div"),Jk=nn(oo,"%").setParameterLength(2).setName("mod"),Wye=nn(oo,"==").setParameterLength(2).setName("equal"),fze=nn(oo,"!=").setParameterLength(2).setName("notEqual"),pze=nn(oo,"<").setParameterLength(2).setName("lessThan"),mze=nn(oo,">").setParameterLength(2).setName("greaterThan"),gze=nn(oo,"<=").setParameterLength(2).setName("lessThanEqual"),vze=nn(oo,">=").setParameterLength(2).setName("greaterThanEqual"),yze=nn(oo,"&&").setParameterLength(2,1/0).setName("and"),xze=nn(oo,"||").setParameterLength(2,1/0).setName("or"),_ze=nn(oo,"!").setParameterLength(1).setName("not"),bze=nn(oo,"^^").setParameterLength(2).setName("xor"),Sze=nn(oo,"&").setParameterLength(2).setName("bitAnd"),wze=nn(oo,"~").setParameterLength(2).setName("bitNot"),Eze=nn(oo,"|").setParameterLength(2).setName("bitOr"),Tze=nn(oo,"^").setParameterLength(2).setName("bitXor"),Mze=nn(oo,"<<").setParameterLength(2).setName("shiftLeft"),Cze=nn(oo,">>").setParameterLength(2).setName("shiftRight"),Aze=en(([s])=>(s.addAssign(1),s)),Pze=en(([s])=>(s.subAssign(1),s)),Rze=en(([s])=>{const e=zs(s).toConst();return s.addAssign(1),e}),Ize=en(([s])=>{const e=zs(s).toConst();return s.subAssign(1),e});Lt("add",dc);Lt("sub",oc);Lt("mul",_i);Lt("div",T1);Lt("mod",Jk);Lt("equal",Wye);Lt("notEqual",fze);Lt("lessThan",pze);Lt("greaterThan",mze);Lt("lessThanEqual",gze);Lt("greaterThanEqual",vze);Lt("and",yze);Lt("or",xze);Lt("not",_ze);Lt("xor",bze);Lt("bitAnd",Sze);Lt("bitNot",wze);Lt("bitOr",Eze);Lt("bitXor",Tze);Lt("shiftLeft",Mze);Lt("shiftRight",Cze);Lt("incrementBefore",Aze);Lt("decrementBefore",Pze);Lt("increment",Rze);Lt("decrement",Ize);const kze=(s,e)=>(console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),Jk(s,e)),Nze=(s,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),Jk(zs(s),zs(e)));Lt("remainder",kze);Lt("modInt",Nze);class ht extends ma{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){if(super(),(e===ht.MAX||e===ht.MIN)&&arguments.length>3){let i=new ht(e,t,n);for(let a=2;a<arguments.length-1;a++)i=new ht(e,i,arguments[a]);t=i,n=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),a=e.isMatrix(n)?0:e.getTypeLength(n),c=e.isMatrix(r)?0:e.getTypeLength(r);return i>a&&i>c?t:a>c?n:c>i?r:t}getNodeType(e){const t=this.method;return t===ht.LENGTH||t===ht.DISTANCE||t===ht.DOT?"float":t===ht.CROSS?"vec3":t===ht.ALL||t===ht.ANY?"bool":t===ht.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:r}=this;let i=null;if(r===ht.ONE_MINUS)i=oc(1,t);else if(r===ht.RECIPROCAL)i=T1(1,t);else if(r===ht.DIFFERENCE)i=Qh(oc(t,n));else if(r===ht.TRANSFORM_DIRECTION){let a=t,c=n;e.isMatrix(a.getNodeType(e))?c=$r(zt(c),0):a=$r(zt(a),0);const u=_i(a,c).xyz;i=IE(u)}return i!==null?i:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const i=this.getNodeType(e),a=this.getInputType(e),c=this.aNode,u=this.bNode,p=this.cNode,y=e.renderer.coordinateSystem;if(r===ht.NEGATE)return e.format("( - "+c.build(e,a)+" )",i,t);{const x=[];return r===ht.CROSS?x.push(c.build(e,i),u.build(e,i)):y===Zc&&r===ht.STEP?x.push(c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":a),u.build(e,a)):y===Zc&&(r===ht.MIN||r===ht.MAX)?x.push(c.build(e,a),u.build(e,e.getTypeLength(u.getNodeType(e))===1?"float":a)):r===ht.REFRACT?x.push(c.build(e,a),u.build(e,a),p.build(e,"float")):r===ht.MIX?x.push(c.build(e,a),u.build(e,a),p.build(e,e.getTypeLength(p.getNodeType(e))===1?"float":a)):(y===X3&&r===ht.ATAN&&u!==null&&(r="atan2"),e.shaderStage!=="fragment"&&(r===ht.DFDX||r===ht.DFDY)&&(console.warn(`THREE.TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),x.push(c.build(e,a)),u!==null&&x.push(u.build(e,a)),p!==null&&x.push(p.build(e,a))),e.format(`${e.getMethod(r,i)}( ${x.join(", ")} )`,i,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}ht.ALL="all";ht.ANY="any";ht.RADIANS="radians";ht.DEGREES="degrees";ht.EXP="exp";ht.EXP2="exp2";ht.LOG="log";ht.LOG2="log2";ht.SQRT="sqrt";ht.INVERSE_SQRT="inversesqrt";ht.FLOOR="floor";ht.CEIL="ceil";ht.NORMALIZE="normalize";ht.FRACT="fract";ht.SIN="sin";ht.COS="cos";ht.TAN="tan";ht.ASIN="asin";ht.ACOS="acos";ht.ATAN="atan";ht.ABS="abs";ht.SIGN="sign";ht.LENGTH="length";ht.NEGATE="negate";ht.ONE_MINUS="oneMinus";ht.DFDX="dFdx";ht.DFDY="dFdy";ht.ROUND="round";ht.RECIPROCAL="reciprocal";ht.TRUNC="trunc";ht.FWIDTH="fwidth";ht.TRANSPOSE="transpose";ht.BITCAST="bitcast";ht.EQUALS="equals";ht.MIN="min";ht.MAX="max";ht.STEP="step";ht.REFLECT="reflect";ht.DISTANCE="distance";ht.DIFFERENCE="difference";ht.DOT="dot";ht.CROSS="cross";ht.POW="pow";ht.TRANSFORM_DIRECTION="transformDirection";ht.MIX="mix";ht.CLAMP="clamp";ht.REFRACT="refract";ht.SMOOTHSTEP="smoothstep";ht.FACEFORWARD="faceforward";const Dze=Ut(1e-6),Oze=Ut(Math.PI),Lze=nn(ht,ht.ALL).setParameterLength(1),Fze=nn(ht,ht.ANY).setParameterLength(1),Bze=nn(ht,ht.RADIANS).setParameterLength(1),Uze=nn(ht,ht.DEGREES).setParameterLength(1),$ye=nn(ht,ht.EXP).setParameterLength(1),RE=nn(ht,ht.EXP2).setParameterLength(1),qye=nn(ht,ht.LOG).setParameterLength(1),jg=nn(ht,ht.LOG2).setParameterLength(1),T$=nn(ht,ht.SQRT).setParameterLength(1),zze=nn(ht,ht.INVERSE_SQRT).setParameterLength(1),_v=nn(ht,ht.FLOOR).setParameterLength(1),M$=nn(ht,ht.CEIL).setParameterLength(1),IE=nn(ht,ht.NORMALIZE).setParameterLength(1),e4=nn(ht,ht.FRACT).setParameterLength(1),If=nn(ht,ht.SIN).setParameterLength(1),D3=nn(ht,ht.COS).setParameterLength(1),Vze=nn(ht,ht.TAN).setParameterLength(1),Gze=nn(ht,ht.ASIN).setParameterLength(1),Xye=nn(ht,ht.ACOS).setParameterLength(1),Yye=nn(ht,ht.ATAN).setParameterLength(1,2),Qh=nn(ht,ht.ABS).setParameterLength(1),Lk=nn(ht,ht.SIGN).setParameterLength(1),Hg=nn(ht,ht.LENGTH).setParameterLength(1),jze=nn(ht,ht.NEGATE).setParameterLength(1),Hze=nn(ht,ht.ONE_MINUS).setParameterLength(1),Kye=nn(ht,ht.DFDX).setParameterLength(1),Zye=nn(ht,ht.DFDY).setParameterLength(1),Wze=nn(ht,ht.ROUND).setParameterLength(1),$ze=nn(ht,ht.RECIPROCAL).setParameterLength(1),qze=nn(ht,ht.TRUNC).setParameterLength(1),Xze=nn(ht,ht.FWIDTH).setParameterLength(1),Yze=nn(ht,ht.TRANSPOSE).setParameterLength(1),Kze=(s,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),Wye(s,e)),qx=nn(ht,ht.MIN).setParameterLength(2,1/0),Sl=nn(ht,ht.MAX).setParameterLength(2,1/0),Qye=nn(ht,ht.STEP).setParameterLength(2),Zze=nn(ht,ht.REFLECT).setParameterLength(2),Qze=nn(ht,ht.DISTANCE).setParameterLength(2),Jze=nn(ht,ht.DIFFERENCE).setParameterLength(2),C$=nn(ht,ht.DOT).setParameterLength(2),Jye=nn(ht,ht.CROSS).setParameterLength(2),eN=nn(ht,ht.POW).setParameterLength(2),e6e=nn(ht,ht.POW,2).setParameterLength(1),eVe=nn(ht,ht.POW,3).setParameterLength(1),tVe=nn(ht,ht.POW,4).setParameterLength(1),nVe=nn(ht,ht.TRANSFORM_DIRECTION).setParameterLength(2),rVe=s=>_i(Lk(s),eN(Qh(s),1/3)),t6e=s=>C$(s,s),Ks=nn(ht,ht.MIX).setParameterLength(3),Xg=(s,e=0,t=1)=>sn(new ht(ht.CLAMP,sn(s),sn(e),sn(t))),n6e=s=>Xg(s),r6e=nn(ht,ht.REFRACT).setParameterLength(3),Y3=nn(ht,ht.SMOOTHSTEP).setParameterLength(3),iVe=nn(ht,ht.FACEFORWARD).setParameterLength(3),sVe=en(([s])=>{const n=43758.5453,r=C$(s.xy,Sn(12.9898,78.233)),i=Jk(r,Oze);return e4(If(i).mul(n))}),oVe=(s,e,t)=>Ks(e,t,s),aVe=(s,e,t)=>Y3(e,t,s),lVe=(s,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),Yye(s,e));Lt("all",Lze);Lt("any",Fze);Lt("equals",Kze);Lt("radians",Bze);Lt("degrees",Uze);Lt("exp",$ye);Lt("exp2",RE);Lt("log",qye);Lt("log2",jg);Lt("sqrt",T$);Lt("inverseSqrt",zze);Lt("floor",_v);Lt("ceil",M$);Lt("normalize",IE);Lt("fract",e4);Lt("sin",If);Lt("cos",D3);Lt("tan",Vze);Lt("asin",Gze);Lt("acos",Xye);Lt("atan",Yye);Lt("abs",Qh);Lt("sign",Lk);Lt("length",Hg);Lt("lengthSq",t6e);Lt("negate",jze);Lt("oneMinus",Hze);Lt("dFdx",Kye);Lt("dFdy",Zye);Lt("round",Wze);Lt("reciprocal",$ze);Lt("trunc",qze);Lt("fwidth",Xze);Lt("atan2",lVe);Lt("min",qx);Lt("max",Sl);Lt("step",Qye);Lt("reflect",Zze);Lt("distance",Qze);Lt("dot",C$);Lt("cross",Jye);Lt("pow",eN);Lt("pow2",e6e);Lt("pow3",eVe);Lt("pow4",tVe);Lt("transformDirection",nVe);Lt("mix",oVe);Lt("clamp",Xg);Lt("refract",r6e);Lt("smoothstep",aVe);Lt("faceForward",iVe);Lt("difference",Jze);Lt("saturate",n6e);Lt("cbrt",rVe);Lt("transpose",Yze);Lt("rand",sVe);class cVe extends Xr{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(t===void 0)return this.setup(e),this.getNodeType(e);const r=t.getNodeType(e);if(n!==null){const i=n.getNodeType(e);if(e.getTypeLength(i)>e.getTypeLength(r))return i}return r}setup(e){const t=this.condNode.cache(),n=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=i,r!==null&&(e.getDataFromNode(r).parentNodeBlock=i);const a=e.getNodeProperties(this);a.condNode=t,a.ifNode=n.context({nodeBlock:n}),a.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:i,ifNode:a,elseNode:c}=e.getNodeProperties(this),u=e.currentFunctionNode,p=t!=="void",y=p?Bye(n).build(e):"";r.nodeProperty=y;const x=i.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${x} ) {

`).addFlowTab();let S=a.build(e,n);if(S&&(p?S=y+" = "+S+";":(S="return "+S+";",u===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),S="// "+S))),e.removeFlowTab().addFlowCode(e.tab+"	"+S+`

`+e.tab+"}"),c!==null){e.addFlowCode(` else {

`).addFlowTab();let M=c.build(e,n);M&&(p?M=y+" = "+M+";":(M="return "+M+";",u===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),M="// "+M))),e.removeFlowTab().addFlowCode(e.tab+"	"+M+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(y,n,t)}}const xl=nn(cVe).setParameterLength(2,3);Lt("select",xl);const uVe=(...s)=>(console.warn("THREE.TSL: cond() has been renamed to select()."),xl(...s));Lt("cond",uVe);class i6e extends Xr{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const n=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(n),r}}const A$=nn(i6e).setParameterLength(1,2),hVe=(s,e)=>A$(s,{label:e});Lt("context",A$);Lt("label",hVe);class tk extends Xr{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:n,readOnly:r}=this,{renderer:i}=e,a=i.backend.isWebGPUBackend===!0;let c=!1,u=!1;r&&(c=e.isDeterministic(t),u=a?r:c);const p=e.getVectorType(this.getNodeType(e)),y=t.build(e,p),x=e.getVarFromNode(this,n,p,void 0,u),S=e.getPropertyName(x);let M=S;if(u)if(a)M=c?`const ${S}`:`let ${S}`;else{const I=e.getArrayCount(t);M=`const ${e.getVar(x.type,S,I)}`}return e.addLineFlowCode(`${M} = ${y}`,this),S}}const P$=nn(tk),dVe=(s,e=null)=>P$(s,e).toStack(),fVe=(s,e=null)=>P$(s,e,!0).toStack();Lt("toVar",dVe);Lt("toConst",fVe);const pVe=s=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),P$(s));Lt("temp",pVe);class mVe extends Xr{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(n===void 0){const r=this.name,i=this.getNodeType(e),a=this.interpolationType,c=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,r,i,a,c),t.node=this.node}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(eI.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(eI.VERTEX,this.node)}generate(e){const t=e.getNodeProperties(this),n=this.setupVarying(e);if(t.propertyName===void 0){const r=this.getNodeType(e),i=e.getPropertyName(n,eI.VERTEX);e.flowNodeFromShaderStage(eI.VERTEX,this.node,r,i),t.propertyName=i}return e.getPropertyName(n)}}const Uf=nn(mVe).setParameterLength(1,2),gVe=s=>Uf(s);Lt("toVarying",Uf);Lt("toVertexStage",gVe);Lt("varying",(...s)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),Uf(...s)));Lt("vertexStage",(...s)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),Uf(...s)));const vVe=en(([s])=>{const e=s.mul(.9478672986).add(.0521327014).pow(2.4),t=s.mul(.0773993808),n=s.lessThanEqual(.04045);return Ks(e,t,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),yVe=en(([s])=>{const e=s.pow(.41666).mul(1.055).sub(.055),t=s.mul(12.92),n=s.lessThanEqual(.0031308);return Ks(e,t,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),R$="WorkingColorSpace",xVe="OutputColorSpace";class s6e extends ma{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===R$?Us.workingColorSpace:t===xVe?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let i=t;return Us.enabled===!1||n===r||!n||!r||(Us.getTransfer(n)===Vr&&(i=$r(vVe(i.rgb),i.a)),Us.getPrimaries(n)!==Us.getPrimaries(r)&&(i=$r(hc(Us._getMatrix(new nu,n,r)).mul(i.rgb),i.a)),Us.getTransfer(r)===Vr&&(i=$r(yVe(i.rgb),i.a))),i}}const _Ve=(s,e)=>sn(new s6e(sn(s),R$,e)),I$=(s,e)=>sn(new s6e(sn(s),e,R$));Lt("workingToColorSpace",_Ve);Lt("colorSpaceToWorking",I$);let bVe=class extends UE{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class o6e extends Xr{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=pi.OBJECT}setGroup(e){return this.group=e,this}element(e){return sn(new bVe(this,sn(e)))}setNodeType(e){const t=Nr(null,e).getSelf();this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const SVe=(s,e,t)=>sn(new o6e(s,e,t));class wVe extends o6e{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(kr)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const EVe=(s,e,t=null)=>sn(new wVe(s,e,t));class TVe extends ma{static get type(){return"ToneMappingNode"}constructor(e,t=CVe,n=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return Ak(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(n===wx)return t;let r=null;const i=e.renderer.library.getToneMappingFunction(n);return i!==null?r=$r(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const MVe=(s,e,t)=>sn(new TVe(s,sn(e),sn(t))),CVe=EVe("toneMappingExposure","float");Lt("toneMapping",(s,e,t)=>MVe(e,t,s));const ec=new pt;class k${constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ec.fromBufferAttribute(this,t),ec.applyMatrix4(e),this.setXYZ(t,ec.x,ec.y,ec.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ec.fromBufferAttribute(this,t),ec.applyNormalMatrix(e),this.setXYZ(t,ec.x,ec.y,ec.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ec.fromBufferAttribute(this,t),ec.transformDirection(e),this.setXYZ(t,ec.x,ec.y,ec.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=ac(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Qr(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Qr(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Qr(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Qr(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Qr(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ac(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ac(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ac(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ac(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array),r=Qr(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Qr(t,this.array),n=Qr(n,this.array),r=Qr(r,this.array),i=Qr(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return new id(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new k$(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class a6e{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Ck,this.updateRanges=[],this.version=0,this.uuid=Fg()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fg()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fg()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}class AVe extends g${static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=Ck,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),n=this.value,r=e.getTypeLength(t),i=this.bufferStride||r,a=this.bufferOffset,c=n.isInterleavedBuffer===!0?n:new a6e(n,i),u=new k$(c,r,a);c.setUsage(this.usage),this.attribute=u,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let i=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,i=r):i=Uf(this).build(e,t),i}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const N$=(s,e=null,t=0,n=0)=>sn(new AVe(s,e,t,n)),PVe=(s,e=null,t=0,n=0)=>N$(s,e,t,n).setUsage(fx),A4e=(s,e=null,t=0,n=0)=>N$(s,e,t,n).setInstanced(!0),P4e=(s,e=null,t=0,n=0)=>PVe(s,e,t,n).setInstanced(!0);Lt("toAttribute",s=>N$(s.value));class RVe extends Xr{static get type(){return"ComputeNode"}constructor(e,t,n=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=pi.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let n=t[0];for(let r=1;r<t.length;r++)n*=t[r];this.dispatchCount=Math.ceil(e/n)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const n=e.getNodeProperties(this);n.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if(n==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const i=e.getNodeProperties(this).outputComputeNode;if(i)return i.build(e,t)}}}const IVe=(s,e,t)=>sn(new RVe(sn(s),e,t));Lt("compute",IVe);class kVe extends Xr{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const i=this.node.build(e,...t);return e.setCache(n),i}}const nk=(s,e)=>sn(new kVe(sn(s),e)),NVe=(s,e)=>s.context({namespace:e});Lt("cache",nk);class DVe extends Xr{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const OVe=nn(DVe).setParameterLength(2);Lt("bypass",OVe);class l6e extends Xr{static get type(){return"RemapNode"}constructor(e,t,n,r=Ut(0),i=Ut(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=i,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:i,doClamp:a}=this;let c=e.sub(t).div(n.sub(t));return a===!0&&(c=c.clamp()),c.mul(i.sub(r)).add(r)}}const LVe=nn(l6e,null,null,{doClamp:!1}).setParameterLength(3,5),FVe=nn(l6e).setParameterLength(3,5);Lt("remap",LVe);Lt("remapClamp",FVe);class rk extends Xr{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if(n==="void")e.addLineFlowCode(r,this);else return e.format(r,n,t)}}const Xx=nn(rk).setParameterLength(1,2),BVe=s=>(s?xl(s,Xx("discard")):Xx("discard")).toStack();Lt("discard",BVe);class UVe extends ma{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const n=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||wx,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||$g;return n!==wx&&(t=t.toneMapping(n)),r!==$g&&r!==Us.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const zVe=(s,e=null,t=null)=>sn(new UVe(sn(s),e,t));Lt("renderOutput",zVe);class VVe extends ma{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",i="-".repeat(r.length);let a="";return a+="// #"+r+`#
`,a+=e.flow.code.replace(/^\t/mg,"")+`
`,a+="/* ... */ "+n+` /* ... */
`,a+="// #"+i+`#
`,t!==null?t(e,a):console.log(a),n}}const GVe=(s,e=null)=>sn(new VVe(sn(s),e));Lt("debug",GVe);class c6e extends Xr{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const i=e.geometry.getAttribute(t),a=e.getTypeFromAttribute(i),c=e.getAttribute(t,a);return e.shaderStage==="vertex"?e.format(c.name,a,n):Uf(this).build(e,n)}else return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const K3=(s,e=null)=>sn(new c6e(s,e));class Zs extends Xr{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let r;if(n===Zs.VERTEX)r=e.getVertexIndex();else if(n===Zs.INSTANCE)r=e.getInstanceIndex();else if(n===Zs.DRAW)r=e.getDrawIndex();else if(n===Zs.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(n===Zs.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(n===Zs.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let i;return e.shaderStage==="vertex"||e.shaderStage==="compute"?i=r:i=Uf(this).build(e,t),i}}Zs.VERTEX="vertex";Zs.INSTANCE="instance";Zs.SUBGROUP="subgroup";Zs.INVOCATION_LOCAL="invocationLocal";Zs.INVOCATION_SUBGROUP="invocationSubgroup";Zs.DRAW="draw";const jVe=xn(Zs,Zs.VERTEX),D$=xn(Zs,Zs.INSTANCE);Zs.SUBGROUP;Zs.INVOCATION_SUBGROUP;Zs.INVOCATION_LOCAL;const HVe=xn(Zs,Zs.DRAW);class WVe extends cs{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class $Ve extends Xr{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.outputNode?this.outputNode.getMemberType(e,t):"void"}add(e){return this.nodes.push(e),this}If(e,t){const n=new Xw(t);return this._currentCond=xl(e,n),this.add(this._currentCond)}ElseIf(e,t){const n=new Xw(t),r=xl(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new Xw(e),this}Switch(e){return this._expressionNode=sn(e),this}Case(...e){const t=[];if(e.length>=2)for(let c=0;c<e.length-1;c++)t.push(this._expressionNode.equal(sn(e[c])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const n=e[e.length-1],r=new Xw(n);let i=t[0];for(let c=1;c<t.length;c++)i=i.or(t[c]);const a=xl(i,r);return this._currentCond===null?(this._currentCond=a,this.add(this._currentCond)):(this._currentCond.elseNode=a,this._currentCond=a,this)}Default(e){return this.Else(e),this}build(e,...t){const n=Dye();Ik(this);const r=e.buildStage;for(const i of this.nodes)if(r==="setup")i.build(e);else if(r==="analyze")i.build(e,this);else if(r==="generate"){const a=e.getDataFromNode(i,"any").stages,c=a&&a[e.shaderStage];if(i.isVarNode&&c&&c.length===1&&c[0]&&c[0].isStackNode)continue;i.build(e,"void")}return Ik(n),this.outputNode?this.outputNode.build(e,...t):super.build(e,...t)}else(...e){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const dG=nn($Ve).setParameterLength(0,1);class qVe extends Xr{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const n={};for(let a=0,c=this.params.length-1;a<c;a++){const u=this.params[a],p=u.isNode!==!0&&u.name||this.getVarName(a),y=u.isNode!==!0&&u.type||"int";n[p]=Xx(p,y)}const r=e.addStack();t.returnsNode=this.params[this.params.length-1](n,e),t.stackNode=r;const i=this.params[0];return i.isNode!==!0&&typeof i.update=="function"&&(t.updateNode=en(this.params[0].update)(n)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let c=0,u=n.length-1;c<u;c++){const p=n[c];let y=!1,x=null,S=null,M=null,I=null,L=null,B=null;p.isNode?p.getNodeType(e)==="bool"?(y=!0,I="bool",S=p.build(e,I)):(I="int",M=this.getVarName(c),x="0",S=p.build(e,I),L="<"):(I=p.type||"int",M=p.name||this.getVarName(c),x=p.start,S=p.end,L=p.condition,B=p.update,typeof x=="number"?x=e.generateConst(I,x):x&&x.isNode&&(x=x.build(e,I)),typeof S=="number"?S=e.generateConst(I,S):S&&S.isNode&&(S=S.build(e,I)),x!==void 0&&S===void 0?(x=x+" - 1",S="0",L=">="):S!==void 0&&x===void 0&&(x="0",L="<"),L===void 0&&(Number(x)>Number(S)?L=">=":L="<"));let A;if(y)A=`while ( ${S} )`;else{const V={start:x,end:S},X=V.start,P=V.end;let te;const oe=()=>L.includes("<")?"+=":"-=";if(B!=null)switch(typeof B){case"function":te=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":te=M+" "+oe()+" "+e.generateConst(I,B);break;case"string":te=M+" "+B;break;default:B.isNode?te=M+" "+oe()+" "+B.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),te="break /* invalid update */")}else I==="int"||I==="uint"?B=L.includes("<")?"++":"--":B=oe()+" 1.",te=M+" "+B;const ie=e.getVar(I,M)+" = "+X,K=M+" "+L+" "+P;A=`for ( ${ie}; ${K}; ${te} )`}e.addFlowCode((c===0?`
`:"")+e.tab+A+` {

`).addFlowTab()}const i=r.build(e,"void"),a=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+i);for(let c=0,u=this.params.length-1;c<u;c++)e.addFlowCode((c===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),a}}const Df=(...s)=>sn(new qVe(Mx(s,"int"))).toStack(),XVe=()=>Xx("break").toStack();class VE{constructor(e=new pt(1/0,1/0,1/0),t=new pt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Sf.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Sf.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Sf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const i=n.getAttribute("position");if(t===!0&&i!==void 0&&e.isInstancedMesh!==!0)for(let a=0,c=i.count;a<c;a++)e.isMesh===!0?e.getVertexPosition(a,Sf):Sf.fromBufferAttribute(i,a),Sf.applyMatrix4(e.matrixWorld),this.expandByPoint(Sf);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),tI.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),tI.copy(n.boundingBox)),tI.applyMatrix4(e.matrixWorld),this.union(tI)}const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Sf),Sf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(yw),nI.subVectors(this.max,yw),F7.subVectors(e.a,yw),B7.subVectors(e.b,yw),U7.subVectors(e.c,yw),S3.subVectors(B7,F7),w3.subVectors(U7,B7),W8.subVectors(F7,U7);let t=[0,-S3.z,S3.y,0,-w3.z,w3.y,0,-W8.z,W8.y,S3.z,0,-S3.x,w3.z,0,-w3.x,W8.z,0,-W8.x,-S3.y,S3.x,0,-w3.y,w3.x,0,-W8.y,W8.x,0];return!fG(t,F7,B7,U7,nI)||(t=[1,0,0,0,1,0,0,0,1],!fG(t,F7,B7,U7,nI))?!1:(rI.crossVectors(S3,w3),t=[rI.x,rI.y,rI.z],fG(t,F7,B7,U7,nI))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Sf).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Sf).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Tg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Tg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Tg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Tg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Tg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Tg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Tg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Tg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Tg),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Tg=[new pt,new pt,new pt,new pt,new pt,new pt,new pt,new pt],Sf=new pt,tI=new VE,F7=new pt,B7=new pt,U7=new pt,S3=new pt,w3=new pt,W8=new pt,yw=new pt,nI=new pt,rI=new pt,$8=new pt;function fG(s,e,t,n,r){for(let i=0,a=s.length-3;i<=a;i+=3){$8.fromArray(s,i);const c=r.x*Math.abs($8.x)+r.y*Math.abs($8.y)+r.z*Math.abs($8.z),u=e.dot($8),p=t.dot($8),y=n.dot($8);if(Math.max(-Math.max(u,p,y),Math.min(u,p,y))>c)return!1}return!0}const YVe=new VE,xw=new pt,pG=new pt;class tN{constructor(e=new pt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):YVe.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;xw.subVectors(e,this.center);const t=xw.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(xw,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(pG.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(xw.copy(e.center).add(pG)),this.expandByPoint(xw.copy(e.center).sub(pG))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const R4e=new tN;class Ts extends Xr{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=pi.OBJECT,this.uniformNode=new zE(null)}getNodeType(){const e=this.scope;if(e===Ts.WORLD_MATRIX)return"mat4";if(e===Ts.POSITION||e===Ts.VIEW_POSITION||e===Ts.DIRECTION||e===Ts.SCALE)return"vec3";if(e===Ts.RADIUS)return"float"}update(e){const t=this.object3d,n=this.uniformNode,r=this.scope;if(r===Ts.WORLD_MATRIX)n.value=t.matrixWorld;else if(r===Ts.POSITION)n.value=n.value||new pt,n.value.setFromMatrixPosition(t.matrixWorld);else if(r===Ts.SCALE)n.value=n.value||new pt,n.value.setFromMatrixScale(t.matrixWorld);else if(r===Ts.DIRECTION)n.value=n.value||new pt,t.getWorldDirection(n.value);else if(r===Ts.VIEW_POSITION){const i=e.camera;n.value=n.value||new pt,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(i.matrixWorldInverse)}else if(r===Ts.RADIUS){const i=e.object.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),R4e.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),n.value=R4e.radius}}generate(e){const t=this.scope;return t===Ts.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===Ts.POSITION||t===Ts.VIEW_POSITION||t===Ts.DIRECTION||t===Ts.SCALE?this.uniformNode.nodeType="vec3":t===Ts.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Ts.WORLD_MATRIX="worldMatrix";Ts.POSITION="position";Ts.SCALE="scale";Ts.VIEW_POSITION="viewPosition";Ts.DIRECTION="direction";Ts.RADIUS="radius";const KVe=nn(Ts,Ts.POSITION).setParameterLength(1);class u6e extends zE{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const h6e=(s,e,t)=>sn(new u6e(s,e,t));class ZVe extends UE{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,n)}}class QVe extends u6e{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?Rk(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=pi.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if(n==="float"||n==="int"||n==="uint")for(let r=0;r<e.length;r++){const i=r*4;t[i]=e[r]}else if(n==="color")for(let r=0;r<e.length;r++){const i=r*4,a=e[r];t[i]=a.r,t[i+1]=a.g,t[i+2]=a.b||0}else if(n==="mat2")for(let r=0;r<e.length;r++){const i=r*4,a=e[r];t[i]=a.elements[0],t[i+1]=a.elements[1],t[i+2]=a.elements[2],t[i+3]=a.elements[3]}else if(n==="mat3")for(let r=0;r<e.length;r++){const i=r*16,a=e[r];t[i]=a.elements[0],t[i+1]=a.elements[1],t[i+2]=a.elements[2],t[i+4]=a.elements[3],t[i+5]=a.elements[4],t[i+6]=a.elements[5],t[i+8]=a.elements[6],t[i+9]=a.elements[7],t[i+10]=a.elements[8],t[i+15]=1}else if(n==="mat4")for(let r=0;r<e.length;r++){const i=r*16,a=e[r];for(let c=0;c<a.elements.length;c++)t[i+c]=a.elements[c]}else for(let r=0;r<e.length;r++){const i=r*4,a=e[r];t[i]=a.x,t[i+1]=a.y,t[i+2]=a.z||0,t[i+3]=a.w||0}}setup(e){const t=this.array.length,n=this.elementType;let r=Float32Array;const i=this.paddedType,a=e.getTypeLength(i);return n.charAt(0)==="i"&&(r=Int32Array),n.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*a),this.bufferCount=t,this.bufferType=i,super.setup(e)}element(e){return sn(new ZVe(this,sn(e)))}}const y1=(s,e)=>sn(new QVe(s,e));class JVe extends Xr{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const nN=nn(JVe).setParameterLength(1),d6e=Nr(0,"uint").label("u_cameraIndex").setGroup(S$("cameraIndex")).toVarying("v_cameraIndex"),hv=Nr("float").label("cameraNear").setGroup(kr).onRenderUpdate(({camera:s})=>s.near),dv=Nr("float").label("cameraFar").setGroup(kr).onRenderUpdate(({camera:s})=>s.far),O$=en(({camera:s})=>{let e;if(s.isArrayCamera&&s.cameras.length>0){const t=[];for(const r of s.cameras)t.push(r.projectionMatrix);e=y1(t).setGroup(kr).label("cameraProjectionMatrices").element(s.isMultiViewCamera?nN("gl_ViewID_OVR"):d6e).toVar("cameraProjectionMatrix")}else e=Nr("mat4").label("cameraProjectionMatrix").setGroup(kr).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),Zg=en(({camera:s})=>{let e;if(s.isArrayCamera&&s.cameras.length>0){const t=[];for(const r of s.cameras)t.push(r.matrixWorldInverse);e=y1(t).setGroup(kr).label("cameraViewMatrices").element(s.isMultiViewCamera?nN("gl_ViewID_OVR"):d6e).toVar("cameraViewMatrix")}else e=Nr("mat4").label("cameraViewMatrix").setGroup(kr).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),eGe=Nr(new pt).label("cameraPosition").setGroup(kr).onRenderUpdate(({camera:s},e)=>e.value.setFromMatrixPosition(s.matrixWorld));class ld extends Ts{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}ld.DIRECTION;const Mv=xn(ld,ld.WORLD_MATRIX);ld.POSITION;ld.SCALE;ld.VIEW_POSITION;ld.RADIUS;const tGe=Nr(new nu).onObjectUpdate(({object:s},e)=>e.value.getNormalMatrix(s.matrixWorld)),rN=en(s=>s.renderer.overrideNodes.modelViewMatrix||nGe).once()().toVar("modelViewMatrix"),nGe=Zg.mul(Mv),I4e=en(s=>(s.context.isHighPrecisionModelViewMatrix=!0,Nr("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),k4e=en(s=>{const e=s.context.isHighPrecisionModelViewMatrix;return Nr("mat3").onObjectUpdate(({object:t,camera:n})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),iN=K3("position","vec3"),vl=iN.toVarying("positionLocal"),N4e=iN.toVarying("positionPrevious"),kE=en(s=>Mv.mul(vl).xyz.toVarying(s.getNamespace("v_positionWorld")),"vec3").once("POSITION")(),f6e=en(s=>vl.transformDirection(Mv).toVarying(s.getNamespace("v_positionWorldDirection")).normalize().toVar("positionWorldDirection"),"vec3").once("POSITION")(),fa=en(s=>s.context.setupPositionView().toVarying(s.getNamespace("v_positionView")),"vec3").once("POSITION")(),So=fa.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class rGe extends ma{static get type(){return"EquirectUVNode"}constructor(e=f6e){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan(e.x).mul(1/(Math.PI*2)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Sn(t,n)}}const p6e=nn(rGe).setParameterLength(0,1);class iGe extends Xr{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:n}=e;return t.coordinateSystem===Zc&&n.side===eu?"false":e.getFrontFacing()}}const sGe=xn(iGe),sN=Ut(sGe).mul(2).sub(1),m6e=K3("normal","vec3"),M1=en(s=>s.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),zt(0,1,0)):m6e,"vec3").once()().toVar("normalLocal"),oGe=fa.dFdx().cross(fa.dFdy()).normalize().toVar("normalFlat"),C1=en(s=>{let e;return s.material.flatShading===!0?e=oGe:e=Uf(g6e(M1),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),L$=en(s=>{let e=C1.transformDirection(Zg);return s.material.flatShading!==!0&&(e=Uf(e,"v_normalWorld")),e},"vec3").once()().normalize().toVar("normalWorld"),ha=en(s=>{let e=s.context.setupNormal().context({getUV:null});return s.material.flatShading!==!0&&(e=e.mul(sN)),e},"vec3").once()().toVar("transformedNormalView"),F$=ha.transformDirection(Zg).toVar("transformedNormalWorld"),Yw=en(s=>{let e=s.context.setupClearcoatNormal().context({getUV:null});return s.material.flatShading!==!0&&(e=e.mul(sN)),e},"vec3").once()().toVar("transformedClearcoatNormalView"),aGe=en(([s,e=Mv])=>{const t=hc(e),n=s.div(zt(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(n).xyz}),g6e=en(([s],e)=>{const t=e.renderer.overrideNodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(s);const n=tGe.mul(s);return Zg.transformDirection(n)});class lGe extends ma{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=zt(So.z,0,So.x.negate()).normalize(),t=So.cross(e);return Sn(e.dot(ha),t.dot(ha)).mul(.495).add(.5)}}const cGe=xn(lGe);class uGe extends zE{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=pi.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&n.width!==void 0){const{width:r,height:i}=n;this.value=Math.log2(Math.max(r,i))}}}const hGe=nn(uGe).setParameterLength(1),dGe=s=>sn(s).mul(.5).add(.5);class fGe extends ma{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const i=t.cos(),a=t.sin();return b$(i,a,a.negate(),i).mul(n)}else{const i=t,a=Cx($r(1,0,0,0),$r(0,D3(i.x),If(i.x).negate(),0),$r(0,If(i.x),D3(i.x),0),$r(0,0,0,1)),c=Cx($r(D3(i.y),0,If(i.y),0),$r(0,1,0,0),$r(If(i.y).negate(),0,D3(i.y),0),$r(0,0,0,1)),u=Cx($r(D3(i.z),If(i.z).negate(),0,0),$r(If(i.z),D3(i.z),0,0),$r(0,0,1,0),$r(0,0,0,1));return a.mul(c).mul(u).mul($r(n,1)).xyz}}}const v6e=nn(fGe).setParameterLength(2);let _w,bw;class ca extends Xr{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===ca.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=pi.NONE;return(this.scope===ca.SIZE||this.scope===ca.VIEWPORT)&&(e=pi.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===ca.VIEWPORT?t!==null?bw.copy(t.viewport):(e.getViewport(bw),bw.multiplyScalar(e.getPixelRatio())):t!==null?(_w.width=t.width,_w.height=t.height):e.getDrawingBufferSize(_w)}setup(){const e=this.scope;let t=null;return e===ca.SIZE?t=Nr(_w||(_w=new ci)):e===ca.VIEWPORT?t=Nr(bw||(bw=new Ri)):t=Sn(oN.div(nW)),t}generate(e){if(this.scope===ca.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(nW).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}ca.COORDINATE="coordinate";ca.VIEWPORT="viewport";ca.SIZE="size";ca.UV="uv";const Px=xn(ca,ca.UV),nW=xn(ca,ca.SIZE),oN=xn(ca,ca.COORDINATE),uE=xn(ca,ca.VIEWPORT);uE.zw;uE.xy;const GE=(s=0)=>K3("uv"+(s>0?s:""),"vec2");class pGe extends Xr{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const Rx=nn(pGe).setParameterLength(1,2),y6e=new _l;class o_ extends zE{static get type(){return"TextureNode"}constructor(e=y6e,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=pi.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===Zo?"uvec4":this.value.type===sc?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return GE(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=Nr(this.value.matrix)),this._matrixUniform.mul(zt(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?pi.OBJECT:pi.NONE,this}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.image instanceof ImageBitmap&&n.flipY===!0||n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0||n.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(zs(Rx(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||n.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let r=this.uvNode;(r===null||e.context.forceUVContext===!0)&&e.context.getUV&&(r=e.context.getUV(this,e)),r||(r=this.getDefaultUV()),this.updateMatrix===!0&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);let i=this.levelNode;i===null&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,t,n,r,i,a,c,u){const p=this.value;let y;return r?y=e.generateTextureLevel(p,t,n,r,a):i?y=e.generateTextureBias(p,t,n,i,a):u?y=e.generateTextureGrad(p,t,n,u,a):c?y=e.generateTextureCompare(p,t,n,c,a):this.sampler===!1?y=e.generateTextureLoad(p,t,n,a):y=e.generateTexture(p,t,n,a),y}generate(e,t){const n=this.value,r=e.getNodeProperties(this),i=super.generate(e,"property");if(/^sampler/.test(t))return i+"_sampler";if(e.isReference(t))return i;{const a=e.getDataFromNode(this);let c=a.propertyName;if(c===void 0){const{uvNode:y,levelNode:x,biasNode:S,compareNode:M,depthNode:I,gradNode:L}=r,B=this.generateUV(e,y),A=x?x.build(e,"float"):null,V=S?S.build(e,"float"):null,X=I?I.build(e,"int"):null,P=M?M.build(e,"float"):null,te=L?[L[0].build(e,"vec2"),L[1].build(e,"vec2")]:null,oe=e.getVarFromNode(this);c=e.getPropertyName(oe);const ie=this.generateSnippet(e,i,B,A,V,X,P,te);e.addLineFlowCode(`${c} = ${ie}`,this),a.snippet=ie,a.propertyName=c}let u=c;const p=this.getNodeType(e);return e.needsToWorkingColorSpace(n)&&(u=I$(Xx(u,p),n.colorSpace).setup(e).build(e,p)),e.format(u,p,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=sn(e),t.referenceNode=this.getSelf(),sn(t)}blur(e){const t=this.clone();t.biasNode=sn(e).mul(hGe(t)),t.referenceNode=this.getSelf();const n=t.value;return t.generateMipmaps===!1&&(n&&n.generateMipmaps===!1||n.minFilter===Ca||n.magFilter===Ca)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),sn(t)}level(e){const t=this.clone();return t.levelNode=sn(e),t.referenceNode=this.getSelf(),sn(t)}size(e){return Rx(this,e)}bias(e){const t=this.clone();return t.biasNode=sn(e),t.referenceNode=this.getSelf(),sn(t)}compare(e){const t=this.clone();return t.compareNode=sn(e),t.referenceNode=this.getSelf(),sn(t)}grad(e,t){const n=this.clone();return n.gradNode=[sn(e),sn(t)],n.referenceNode=this.getSelf(),sn(n)}depth(e){const t=this.clone();return t.depthNode=sn(e),t.referenceNode=this.getSelf(),sn(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const mGe=nn(o_).setParameterLength(1,4).setName("texture"),ji=(s=y6e,e=null,t=null,n=null)=>{let r;return s&&s.isTextureNode===!0?(r=sn(s.clone()),r.referenceNode=s.getSelf(),e!==null&&(r.uvNode=sn(e)),t!==null&&(r.levelNode=sn(t)),n!==null&&(r.biasNode=sn(n))):r=mGe(s,e,t,n),r},Cf=(...s)=>ji(...s).setSampler(!1);class gGe extends _l{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ca,this.minFilter=Ca,this.generateMipmaps=!1,this.needsUpdate=!0}}const Sw=new ci;class x6e extends o_{static get type(){return"ViewportTextureNode"}constructor(e=Px,t=null,n=null){n===null&&(n=new gGe,n.minFilter=zg),super(n,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=pi.FRAME}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(Sw);const n=this.value;(n.image.width!==Sw.width||n.image.height!==Sw.height)&&(n.image.width=Sw.width,n.image.height=Sw.height,n.needsUpdate=!0);const r=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const _6e=nn(x6e,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let mG=null;class vGe extends x6e{static get type(){return"ViewportDepthTextureNode"}constructor(e=Px,t=null){mG===null&&(mG=new w1),super(e,t,mG)}}const yGe=nn(vGe).setParameterLength(0,2);class Qc extends Xr{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Qc.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===Qc.DEPTH_BASE)n!==null&&(r=w6e().assign(n));else if(t===Qc.DEPTH)e.isPerspectiveCamera?r=xGe(fa.z,hv,dv):r=hE(fa.z,hv,dv);else if(t===Qc.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const i=b6e(n,hv,dv);r=hE(i,hv,dv)}else r=n;else r=hE(fa.z,hv,dv);return r}}Qc.DEPTH_BASE="depthBase";Qc.DEPTH="depth";Qc.LINEAR_DEPTH="linearDepth";const hE=(s,e,t)=>s.add(e).div(e.sub(t)),xGe=(s,e,t)=>e.add(s).mul(t).div(t.sub(e).mul(s)),b6e=(s,e,t)=>e.mul(t).div(t.sub(e).mul(s).sub(t)),S6e=(s,e,t)=>{e=e.max(1e-6).toVar();const n=jg(s.negate().div(e)),r=jg(t.div(e));return n.div(r)},w6e=nn(Qc,Qc.DEPTH_BASE),E6e=xn(Qc,Qc.DEPTH),_Ge=nn(Qc,Qc.LINEAR_DEPTH).setParameterLength(0,1);yGe();E6e.assign=s=>w6e(s);const gG=new pt,bGe=new pt,SGe=new nu;class O3{constructor(e=new pt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=gG.subVectors(n,t).cross(bGe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(gG),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||SGe.getNormalMatrix(e),r=this.coplanarPoint(gG).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}class Pv extends Av{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:th,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Ri(0,0,e,t),this.scissorTest=!1,this.viewport=new Ri(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new _l(r);this.textures=[];const a=n.count;for(let c=0;c<a;c++)this.textures[c]=i.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:th,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new p$(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}new O3;new pt;new pt;new pt;new Is;new pt(0,0,-1);new Ri;new pt;new pt;new Ri;new ci;const wGe=new Pv;Px.flipX();wGe.depthTexture=new w1(1,1);let EGe=0;class tu extends Av{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:EGe++}),this.uuid=Fg(),this.name="",this.type="Material",this.blending=Ug,this.side=Bg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Sk,this.blendDst=wk,this.blendEquation=Nf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Zi(0,0,0),this.blendAlpha=0,this.depthFunc=Ek,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=YH,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=sv,this.stencilZFail=sv,this.stencilZPass=sv,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Ug&&(n.blending=this.blending),this.side!==Bg&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Sk&&(n.blendSrc=this.blendSrc),this.blendDst!==wk&&(n.blendDst=this.blendDst),this.blendEquation!==Nf&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Ek&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==YH&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==sv&&(n.stencilFail=this.stencilFail),this.stencilZFail!==sv&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==sv&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(i){const a=[];for(const c in i){const u=i[c];delete u.metadata,a.push(u)}return a}if(t){const i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const D4e=new ad,vG=new Is,TGe=Nr(0).onReference(({material:s})=>s).onObjectUpdate(({material:s})=>s.refractionRatio),yG=Nr(1).onReference(({material:s})=>s).onObjectUpdate(function({material:s,scene:e}){return s.envMap?s.envMapIntensity:e.environmentIntensity}),T6e=Nr(new Is).onReference(function(s){return s.material}).onObjectUpdate(function({material:s,scene:e}){const t=e.environment!==null&&s.envMap===null?e.environmentRotation:s.envMapRotation;return t?(D4e.copy(t),vG.makeRotationFromEuler(D4e)):vG.identity(),vG}),MGe=So.negate().reflect(ha),CGe=So.negate().refract(ha,TGe),AGe=MGe.transformDirection(Zg).toVar("reflectVector"),PGe=CGe.transformDirection(Zg).toVar("reflectVector");class aN extends _l{constructor(e=[],t=CE,n,r,i,a,c,u,p,y){super(e,t,n,r,i,a,c,u,p,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}const RGe=new aN;class IGe extends o_{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===CE?AGe:e.mapping===Tk?PGe:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),zt(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return(e.renderer.coordinateSystem===X3||!n.isRenderTargetTexture)&&(t=zt(t.x.negate(),t.yz)),T6e.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const kGe=nn(IGe).setParameterLength(1,4).setName("cubeTexture"),NE=(s=RGe,e=null,t=null,n=null)=>{let r;return s&&s.isCubeTextureNode===!0?(r=sn(s.clone()),r.referenceNode=s.getSelf(),e!==null&&(r.uvNode=sn(e)),t!==null&&(r.levelNode=sn(t)),n!==null&&(r.biasNode=sn(n))):r=kGe(s,e,t,n),r};class NGe extends UE{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class B$ extends Xr{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=pi.OBJECT}element(e){return sn(new NGe(this,sn(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;this.count!==null?t=h6e(null,e,this.count):Array.isArray(this.getValueFromReference())?t=y1(null,e):e==="texture"?t=ji(null):e==="cubeTexture"?t=NE(null):t=Nr(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Rs=(s,e,t)=>sn(new B$(s,e,t)),O4e=(s,e,t,n)=>sn(new B$(s,e,n,t));class DGe extends B${static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const B3=(s,e,t=null)=>sn(new DGe(s,e,t)),M6e=en(s=>(s.geometry.hasAttribute("tangent")===!1&&s.geometry.computeTangents(),K3("tangent","vec4")))(),U$=M6e.xyz.toVar("tangentLocal"),C6e=rN.mul($r(U$,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),OGe=en(([s,e],t)=>{let n=s.mul(M6e.w).xyz;return t.material.flatShading!==!0&&(n=Uf(n,e)),n}).once(),LGe=OGe(C1.cross(C6e),"v_bitangentView").normalize().toVar("bitangentView"),Kw=hc(C6e,LGe,C1),FGe=(()=>{let s=Ax.cross(So);return s=s.cross(Ax).normalize(),s=Ks(s,ha,ov.mul(Dg.oneMinus()).oneMinus().pow2().pow2()).normalize(),s})(),BGe=en(s=>{const{eye_pos:e,surf_norm:t,mapN:n,uv:r}=s,i=e.dFdx(),a=e.dFdy(),c=r.dFdx(),u=r.dFdy(),p=t,y=a.cross(p),x=p.cross(i),S=y.mul(c.x).add(x.mul(u.x)),M=y.mul(c.y).add(x.mul(u.y)),I=S.dot(S).max(M.dot(M)),L=sN.mul(I.inverseSqrt());return dc(S.mul(n.x,L),M.mul(n.y,L),p.mul(n.z)).normalize()});class UGe extends ma{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=q3}setup(e){const{normalMapType:t,scaleNode:n}=this;let r=this.node.mul(2).sub(1);n!==null&&(r=zt(r.xy.mul(n),r.z));let i=null;return t===SBe?i=g6e(r):t===q3&&(e.hasGeometryAttribute("tangent")===!0?i=Kw.mul(r).normalize():i=BGe({eye_pos:fa,surf_norm:C1,mapN:r,uv:GE()})),i}}const L4e=nn(UGe).setParameterLength(1,2),zGe=en(({textureNode:s,bumpScale:e})=>{const t=r=>s.cache().context({getUV:i=>r(i.uvNode||GE()),forceUVContext:!0}),n=Ut(t(r=>r));return Sn(Ut(t(r=>r.add(r.dFdx()))).sub(n),Ut(t(r=>r.add(r.dFdy()))).sub(n)).mul(e)}),VGe=en(s=>{const{surf_pos:e,surf_norm:t,dHdxy:n}=s,r=e.dFdx().normalize(),i=e.dFdy().normalize(),a=t,c=i.cross(a),u=a.cross(r),p=r.dot(c).mul(sN),y=p.sign().mul(n.x.mul(c).add(n.y.mul(u)));return p.abs().mul(t).sub(y).normalize()});class GGe extends ma{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=zGe({textureNode:this.textureNode,bumpScale:e});return VGe({surf_pos:fa,surf_norm:C1,dHdxy:t})}}const jGe=nn(GGe).setParameterLength(1,2),F4e=new Map;class Dt extends Xr{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=F4e.get(e);return n===void 0&&(n=B3(e,t),F4e.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===Dt.COLOR){const i=t.color!==void 0?this.getColor(n):zt();t.map&&t.map.isTexture===!0?r=i.mul(this.getTexture("map")):r=i}else if(n===Dt.OPACITY){const i=this.getFloat(n);t.alphaMap&&t.alphaMap.isTexture===!0?r=i.mul(this.getTexture("alpha")):r=i}else if(n===Dt.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=Ut(1);else if(n===Dt.SPECULAR_INTENSITY){const i=this.getFloat(n);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=i.mul(this.getTexture(n).a):r=i}else if(n===Dt.SPECULAR_COLOR){const i=this.getColor(n);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=i.mul(this.getTexture(n).rgb):r=i}else if(n===Dt.ROUGHNESS){const i=this.getFloat(n);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).g):r=i}else if(n===Dt.METALNESS){const i=this.getFloat(n);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=i.mul(this.getTexture(n).b):r=i}else if(n===Dt.EMISSIVE){const i=this.getFloat("emissiveIntensity"),a=this.getColor(n).mul(i);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=a.mul(this.getTexture(n)):r=a}else if(n===Dt.NORMAL)t.normalMap?(r=L4e(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):t.bumpMap?r=jGe(this.getTexture("bump").r,this.getFloat("bumpScale")):r=C1;else if(n===Dt.CLEARCOAT){const i=this.getFloat(n);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=i.mul(this.getTexture(n).r):r=i}else if(n===Dt.CLEARCOAT_ROUGHNESS){const i=this.getFloat(n);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).r):r=i}else if(n===Dt.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=L4e(this.getTexture(n),this.getCache(n+"Scale","vec2")):r=C1;else if(n===Dt.SHEEN){const i=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=i.mul(this.getTexture("sheenColor").rgb):r=i}else if(n===Dt.SHEEN_ROUGHNESS){const i=this.getFloat(n);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).a):r=i,r=r.clamp(.07,1)}else if(n===Dt.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const i=this.getTexture(n);r=b$(ww.x,ww.y,ww.y.negate(),ww.x).mul(i.rg.mul(2).sub(Sn(1)).normalize().mul(i.b))}else r=ww;else if(n===Dt.IRIDESCENCE_THICKNESS){const i=Rs("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const a=Rs("0","float",t.iridescenceThicknessRange);r=i.sub(a).mul(this.getTexture(n).g).add(a)}else r=i}else if(n===Dt.TRANSMISSION){const i=this.getFloat(n);t.transmissionMap?r=i.mul(this.getTexture(n).r):r=i}else if(n===Dt.THICKNESS){const i=this.getFloat(n);t.thicknessMap?r=i.mul(this.getTexture(n).g):r=i}else if(n===Dt.IOR)r=this.getFloat(n);else if(n===Dt.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===Dt.AO)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===Dt.LINE_DASH_OFFSET)r=t.dashOffset?this.getFloat(n):Ut(0);else{const i=this.getNodeType(e);r=this.getCache(n,i)}return r}}Dt.ALPHA_TEST="alphaTest";Dt.COLOR="color";Dt.OPACITY="opacity";Dt.SHININESS="shininess";Dt.SPECULAR="specular";Dt.SPECULAR_STRENGTH="specularStrength";Dt.SPECULAR_INTENSITY="specularIntensity";Dt.SPECULAR_COLOR="specularColor";Dt.REFLECTIVITY="reflectivity";Dt.ROUGHNESS="roughness";Dt.METALNESS="metalness";Dt.NORMAL="normal";Dt.CLEARCOAT="clearcoat";Dt.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Dt.CLEARCOAT_NORMAL="clearcoatNormal";Dt.EMISSIVE="emissive";Dt.ROTATION="rotation";Dt.SHEEN="sheen";Dt.SHEEN_ROUGHNESS="sheenRoughness";Dt.ANISOTROPY="anisotropy";Dt.IRIDESCENCE="iridescence";Dt.IRIDESCENCE_IOR="iridescenceIOR";Dt.IRIDESCENCE_THICKNESS="iridescenceThickness";Dt.IOR="ior";Dt.TRANSMISSION="transmission";Dt.THICKNESS="thickness";Dt.ATTENUATION_DISTANCE="attenuationDistance";Dt.ATTENUATION_COLOR="attenuationColor";Dt.LINE_SCALE="scale";Dt.LINE_DASH_SIZE="dashSize";Dt.LINE_GAP_SIZE="gapSize";Dt.LINE_WIDTH="linewidth";Dt.LINE_DASH_OFFSET="dashOffset";Dt.POINT_SIZE="size";Dt.DISPERSION="dispersion";Dt.LIGHT_MAP="light";Dt.AO="ao";const HGe=xn(Dt,Dt.ALPHA_TEST),WGe=xn(Dt,Dt.COLOR),$Ge=xn(Dt,Dt.SHININESS),qGe=xn(Dt,Dt.EMISSIVE),A6e=xn(Dt,Dt.OPACITY),XGe=xn(Dt,Dt.SPECULAR),B4e=xn(Dt,Dt.SPECULAR_INTENSITY),YGe=xn(Dt,Dt.SPECULAR_COLOR),ik=xn(Dt,Dt.SPECULAR_STRENGTH),xG=xn(Dt,Dt.REFLECTIVITY),KGe=xn(Dt,Dt.ROUGHNESS),ZGe=xn(Dt,Dt.METALNESS),QGe=xn(Dt,Dt.NORMAL),JGe=xn(Dt,Dt.CLEARCOAT),eje=xn(Dt,Dt.CLEARCOAT_ROUGHNESS),tje=xn(Dt,Dt.CLEARCOAT_NORMAL),nje=xn(Dt,Dt.ROTATION),rje=xn(Dt,Dt.SHEEN),ije=xn(Dt,Dt.SHEEN_ROUGHNESS),sje=xn(Dt,Dt.ANISOTROPY),oje=xn(Dt,Dt.IRIDESCENCE),aje=xn(Dt,Dt.IRIDESCENCE_IOR),lje=xn(Dt,Dt.IRIDESCENCE_THICKNESS),cje=xn(Dt,Dt.TRANSMISSION),uje=xn(Dt,Dt.THICKNESS),hje=xn(Dt,Dt.IOR),dje=xn(Dt,Dt.ATTENUATION_DISTANCE),fje=xn(Dt,Dt.ATTENUATION_COLOR),pje=xn(Dt,Dt.LINE_SCALE),mje=xn(Dt,Dt.LINE_DASH_SIZE),gje=xn(Dt,Dt.LINE_GAP_SIZE);Dt.LINE_WIDTH;const vje=xn(Dt,Dt.LINE_DASH_OFFSET),yje=xn(Dt,Dt.POINT_SIZE),xje=xn(Dt,Dt.DISPERSION),P6e=xn(Dt,Dt.LIGHT_MAP),_je=xn(Dt,Dt.AO),ww=Nr(new ci).onReference(function(s){return s.material}).onRenderUpdate(function({material:s}){this.value.set(s.anisotropy*Math.cos(s.anisotropyRotation),s.anisotropy*Math.sin(s.anisotropyRotation))}),R6e=en(s=>s.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class bje extends a6e{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Sje extends id{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}class wje extends Xr{static get type(){return"InstanceNode"}constructor(e,t,n=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=n,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=pi.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:t,instanceMatrix:n,instanceColor:r}=this;let{instanceMatrixNode:i,instanceColorNode:a}=this;if(i===null){if(t<=1e3)i=h6e(n.array,"mat4",Math.max(t,1)).element(D$);else{const u=new bje(n.array,16,1);this.buffer=u;const p=n.usage===fx?P4e:A4e,y=[p(u,"vec4",16,0),p(u,"vec4",16,4),p(u,"vec4",16,8),p(u,"vec4",16,12)];i=Cx(...y)}this.instanceMatrixNode=i}if(r&&a===null){const u=new Sje(r.array,3),p=r.usage===fx?P4e:A4e;this.bufferColor=u,a=zt(p(u,"vec3",3,0)),this.instanceColorNode=a}const c=i.mul(vl).xyz;if(vl.assign(c),e.hasGeometryAttribute("normal")){const u=aGe(M1,i);M1.assign(u)}this.instanceColorNode!==null&&kk("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==fx&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==fx&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}class Eje extends wje{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:n,instanceColor:r}=e;super(t,n,r),this.instancedMesh=e}}const Tje=nn(Eje).setParameterLength(1);class Mje extends Xr{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=D$:this.batchingIdNode=HVe);const n=en(([I])=>{const L=zs(Rx(Cf(this.batchMesh._indirectTexture),0).x),B=zs(I).mod(L),A=zs(I).div(L);return Cf(this.batchMesh._indirectTexture,Ig(B,A)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(zs(this.batchingIdNode)),r=this.batchMesh._matricesTexture,i=zs(Rx(Cf(r),0).x),a=Ut(n).mul(4).toInt().toVar(),c=a.mod(i),u=a.div(i),p=Cx(Cf(r,Ig(c,u)),Cf(r,Ig(c.add(1),u)),Cf(r,Ig(c.add(2),u)),Cf(r,Ig(c.add(3),u))),y=this.batchMesh._colorsTexture;if(y!==null){const L=en(([B])=>{const A=zs(Rx(Cf(y),0).x),V=B,X=V.mod(A),P=V.div(A);return Cf(y,Ig(X,P)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(n);kk("vec3","vBatchColor").assign(L)}const x=hc(p);vl.assign(p.mul(vl));const S=M1.div(zt(x[0].dot(x[0]),x[1].dot(x[1]),x[2].dot(x[2]))),M=x.mul(S).xyz;M1.assign(M),e.hasGeometryAttribute("tangent")&&U$.mulAssign(x)}}const Cje=nn(Mje).setParameterLength(1),U4e=new WeakMap;class Aje extends Xr{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=pi.OBJECT,this.skinIndexNode=K3("skinIndex","uvec4"),this.skinWeightNode=K3("skinWeight","vec4"),this.bindMatrixNode=Rs("bindMatrix","mat4"),this.bindMatrixInverseNode=Rs("bindMatrixInverse","mat4"),this.boneMatricesNode=O4e("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=vl,this.toPositionNode=vl,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:a}=this,c=e.element(n.x),u=e.element(n.y),p=e.element(n.z),y=e.element(n.w),x=i.mul(t),S=dc(c.mul(r.x).mul(x),u.mul(r.y).mul(x),p.mul(r.z).mul(x),y.mul(r.w).mul(x));return a.mul(S).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=M1){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:a}=this,c=e.element(n.x),u=e.element(n.y),p=e.element(n.z),y=e.element(n.w);let x=dc(r.x.mul(c),r.y.mul(u),r.z.mul(p),r.w.mul(y));return x=a.mul(x).mul(i),x.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=O4e("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,N4e)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||wye(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&N4e.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const n=this.getSkinnedNormal();M1.assign(n),e.hasGeometryAttribute("tangent")&&U$.assign(n)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;U4e.get(t)!==e.frameId&&(U4e.set(t,e.frameId),this.previousBoneMatricesNode!==null&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const Pje=s=>sn(new Aje(s));class Rje extends _l{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Ca,this.minFilter=Ca,this.wrapR=z3,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}const _G=new WeakMap,Wu=new Ri,z4e=en(({bufferMap:s,influence:e,stride:t,width:n,depth:r,offset:i})=>{const a=zs(jVe).mul(t).add(i),c=a.div(n),u=a.sub(c.mul(n));return Cf(s,Ig(u,c)).depth(r).xyz.mul(e)});function Ije(s){const e=s.morphAttributes.position!==void 0,t=s.morphAttributes.normal!==void 0,n=s.morphAttributes.color!==void 0,r=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,i=r!==void 0?r.length:0;let a=_G.get(s);if(a===void 0||a.count!==i){let V=function(){B.dispose(),_G.delete(s),s.removeEventListener("dispose",V)};var c=V;a!==void 0&&a.texture.dispose();const u=s.morphAttributes.position||[],p=s.morphAttributes.normal||[],y=s.morphAttributes.color||[];let x=0;e===!0&&(x=1),t===!0&&(x=2),n===!0&&(x=3);let S=s.attributes.position.count*x,M=1;const I=4096;S>I&&(M=Math.ceil(S/I),S=I);const L=new Float32Array(S*M*4*i),B=new Rje(L,S,M,i);B.type=Zu,B.needsUpdate=!0;const A=x*4;for(let X=0;X<i;X++){const P=u[X],te=p[X],oe=y[X],ie=S*M*4*X;for(let K=0;K<P.count;K++){const re=K*A;e===!0&&(Wu.fromBufferAttribute(P,K),L[ie+re+0]=Wu.x,L[ie+re+1]=Wu.y,L[ie+re+2]=Wu.z,L[ie+re+3]=0),t===!0&&(Wu.fromBufferAttribute(te,K),L[ie+re+4]=Wu.x,L[ie+re+5]=Wu.y,L[ie+re+6]=Wu.z,L[ie+re+7]=0),n===!0&&(Wu.fromBufferAttribute(oe,K),L[ie+re+8]=Wu.x,L[ie+re+9]=Wu.y,L[ie+re+10]=Wu.z,L[ie+re+11]=oe.itemSize===4?Wu.w:1)}}a={count:i,texture:B,stride:x,size:new ci(S,M)},_G.set(s,a),s.addEventListener("dispose",V)}return a}class kje extends Xr{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=Nr(1),this.updateType=pi.OBJECT}setup(e){const{geometry:t}=e,n=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,i=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,a=i!==void 0?i.length:0,{texture:c,stride:u,size:p}=Ije(t);n===!0&&vl.mulAssign(this.morphBaseInfluence),r===!0&&M1.mulAssign(this.morphBaseInfluence);const y=zs(p.width);Df(a,({i:x})=>{const S=Ut(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?S.assign(Cf(this.mesh.morphTexture,Ig(zs(x).add(1),zs(D$))).r):S.assign(Rs("morphTargetInfluences","float").element(x).toVar()),Jo(S.notEqual(0),()=>{n===!0&&vl.addAssign(z4e({bufferMap:c,influence:S,stride:u,width:y,depth:x,offset:zs(0)})),r===!0&&M1.addAssign(z4e({bufferMap:c,influence:S,stride:u,width:y,depth:x,offset:zs(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,n)=>t+n,0)}}const Nje=nn(kje).setParameterLength(1);class a_ extends Xr{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class Dje extends a_{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class Oje extends i6e{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,r=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n=zt().toVar("directDiffuse"),r=zt().toVar("directSpecular"),i=zt().toVar("indirectDiffuse"),a=zt().toVar("indirectSpecular"),c={directDiffuse:n,directSpecular:r,indirectDiffuse:i,indirectSpecular:a};return{radiance:zt().toVar("radiance"),irradiance:zt().toVar("irradiance"),iblIrradiance:zt().toVar("iblIrradiance"),ambientOcclusion:Ut(1).toVar("ambientOcclusion"),reflectedLight:c,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const Lje=nn(Oje);class Fje extends a_{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}class sd extends Xr{static get type(){return"ClippingNode"}constructor(e=sd.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===sd.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,r):this.scope===sd.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(n,r)}setupAlphaToCoverage(e,t){return en(()=>{const n=Ut().toVar("distanceToPlane"),r=Ut().toVar("distanceToGradient"),i=Ut(1).toVar("clipOpacity"),a=t.length;if(this.hardwareClipping===!1&&a>0){const u=y1(t);Df(a,({i:p})=>{const y=u.element(p);n.assign(fa.dot(y.xyz).negate().add(y.w)),r.assign(n.fwidth().div(2)),i.mulAssign(Y3(r.negate(),r,n))})}const c=e.length;if(c>0){const u=y1(e),p=Ut(1).toVar("intersectionClipOpacity");Df(c,({i:y})=>{const x=u.element(y);n.assign(fa.dot(x.xyz).negate().add(x.w)),r.assign(n.fwidth().div(2)),p.mulAssign(Y3(r.negate(),r,n).oneMinus())}),i.mulAssign(p.oneMinus())}Ki.a.mulAssign(i),Ki.a.equal(0).discard()})()}setupDefault(e,t){return en(()=>{const n=t.length;if(this.hardwareClipping===!1&&n>0){const i=y1(t);Df(n,({i:a})=>{const c=i.element(a);fa.dot(c.xyz).greaterThan(c.w).discard()})}const r=e.length;if(r>0){const i=y1(e),a=_$(!0).toVar("clipped");Df(r,({i:c})=>{const u=i.element(c);a.assign(fa.dot(u.xyz).greaterThan(u.w).and(a))}),a.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),en(()=>{const r=y1(e),i=nN(t.getClipDistance());Df(n,({i:a})=>{const c=r.element(a),u=fa.dot(c.xyz).sub(c.w).negate();i.element(a).assign(u)})})()}}sd.ALPHA_TO_COVERAGE="alphaToCoverage";sd.DEFAULT="default";sd.HARDWARE="hardware";const Bje=()=>sn(new sd),Uje=()=>sn(new sd(sd.ALPHA_TO_COVERAGE)),zje=()=>sn(new sd(sd.HARDWARE)),Vje=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class Gje{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=Vje,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:n,material:r,object:i}=e;if(t={material:this.getMaterialData(r),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:i.matrixWorld.clone()},i.center&&(t.center=i.center.clone()),i.morphTargetInfluences&&(t.morphTargetInfluences=i.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:a,height:c}=e.context;t.bufferWidth=a,t.bufferHeight=c}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const r=e[n];t[n]={version:r.version}}return t}containsNode(e){const t=e.material;for(const n in t)if(t[n]&&t[n].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const r=e[n];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[n]={id:r.id,version:r.version}:t[n]=r.clone():t[n]=r)}return t}equals(e){const{object:t,material:n,geometry:r}=e,i=this.getRenderObjectData(e);if(i.worldMatrix.equals(t.matrixWorld)!==!0)return i.worldMatrix.copy(t.matrixWorld),!1;const a=i.material;for(const L in a){const B=a[L],A=n[L];if(B.equals!==void 0){if(B.equals(A)===!1)return B.copy(A),!1}else if(A.isTexture===!0){if(B.id!==A.id||B.version!==A.version)return B.id=A.id,B.version=A.version,!1}else if(B!==A)return a[L]=A,!1}if(a.transmission>0){const{width:L,height:B}=e.context;if(i.bufferWidth!==L||i.bufferHeight!==B)return i.bufferWidth=L,i.bufferHeight=B,!1}const c=i.geometry,u=r.attributes,p=c.attributes,y=Object.keys(p),x=Object.keys(u);if(c.id!==r.id)return c.id=r.id,!1;if(y.length!==x.length)return i.geometry.attributes=this.getAttributesData(u),!1;for(const L of y){const B=p[L],A=u[L];if(A===void 0)return delete p[L],!1;if(B.version!==A.version)return B.version=A.version,!1}const S=r.index,M=c.indexVersion,I=S?S.version:null;if(M!==I)return c.indexVersion=I,!1;if(c.drawRange.start!==r.drawRange.start||c.drawRange.count!==r.drawRange.count)return c.drawRange.start=r.drawRange.start,c.drawRange.count=r.drawRange.count,!1;if(i.morphTargetInfluences){let L=!1;for(let B=0;B<i.morphTargetInfluences.length;B++)i.morphTargetInfluences[B]!==t.morphTargetInfluences[B]&&(L=!0);if(L)return!0}return i.center&&i.center.equals(t.center)===!1?(i.center.copy(t.center),!0):(e.bundle!==null&&(i.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const r=e.object.static===!0,i=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return r||i?!1:this.equals(e)!==!0}}const jje=.05,V4e=en(([s])=>e4(_i(1e4,If(_i(17,s.x).add(_i(.1,s.y)))).mul(dc(.1,Qh(If(_i(13,s.y).add(s.x))))))),G4e=en(([s])=>V4e(Sn(V4e(s.xy),s.z))),Hje=en(([s])=>{const e=Sl(Hg(Kye(s.xyz)),Hg(Zye(s.xyz))),t=Ut(1).div(Ut(jje).mul(e)).toVar("pixScale"),n=Sn(RE(_v(jg(t))),RE(M$(jg(t)))),r=Sn(G4e(_v(n.x.mul(s.xyz))),G4e(_v(n.y.mul(s.xyz)))),i=e4(jg(t)),a=dc(_i(i.oneMinus(),r.x),_i(i,r.y)),c=qx(i,i.oneMinus()),u=zt(a.mul(a).div(_i(2,c).mul(oc(1,c))),a.sub(_i(.5,c)).div(oc(1,c)),oc(1,oc(1,a).mul(oc(1,a)).div(_i(2,c).mul(oc(1,c))))),p=a.lessThan(c.oneMinus()).select(a.lessThan(c).select(u.x,u.y),u.z);return Xg(p,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class Wje extends c6e{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),n=e.hasGeometryAttribute(t);let r;return n===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new Ri(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const $je=(s=0)=>sn(new Wje(s));class pa extends tu{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+bye(this)}build(e){this.setup(e)}setupObserver(e){return new Gje(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,n=t.getRenderTarget();e.addStack();const r=this.setupVertex(e),i=this.vertexNode||r;e.stack.outputNode=i,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let a;const c=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(n!==null?n.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const u=this.setupLighting(e);c!==null&&e.stack.add(c);const p=$r(u,Ki.a).max(0);a=this.setupOutput(e,p),cE.assign(a);const y=this.outputNode!==null;if(y&&(a=this.outputNode),n!==null){const x=t.getMRT(),S=this.mrtNode;x!==null?(y&&cE.assign(a),a=x,S!==null&&(a=x.merge(S))):S!==null&&(a=S)}}else{let u=this.fragmentNode;u.isOutputStructNode!==!0&&(u=$r(u)),a=this.setupOutput(e,u)}e.stack.outputNode=a,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:n}=e.clippingContext;let r=null;if(t.length>0||n.length>0){const i=e.renderer.samples;this.alphaToCoverage&&i>1?r=Uje():e.stack.add(Bje())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(zje()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:n}=e;let r=this.depthNode;if(r===null){const i=t.getMRT();i&&i.has("depth")?r=i.get("depth"):t.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?r=S6e(fa.z,hv,dv):r=hE(fa.z,hv,dv))}r!==null&&E6e.assign(r).toStack()}setupPositionView(){return rN.mul(vl).xyz}setupModelViewProjection(){return O$.mul(fa)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),R6e}setupPosition(e){const{object:t,geometry:n}=e;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&Nje(t).toStack(),t.isSkinnedMesh===!0&&Pje(t).toStack(),this.displacementMap){const r=B3("displacementMap","texture"),i=B3("displacementScale","float"),a=B3("displacementBias","float");vl.addAssign(M1.normalize().mul(r.x.mul(i).add(a)))}return t.isBatchedMesh&&Cje(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&Tje(t).toStack(),this.positionNode!==null&&vl.assign(NVe(this.positionNode,"POSITION")),vl}setupDiffuseColor({object:e,geometry:t}){this.maskNode!==null&&_$(this.maskNode).not().discard();let n=this.colorNode?$r(this.colorNode):WGe;this.vertexColors===!0&&t.hasAttribute("color")&&(n=n.mul($je())),e.instanceColor&&(n=kk("vec3","vInstanceColor").mul(n)),e.isBatchedMesh&&e._colorsTexture&&(n=kk("vec3","vBatchColor").mul(n)),Ki.assign(n);const r=this.opacityNode?Ut(this.opacityNode):A6e;Ki.a.assign(Ki.a.mul(r));let i=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(i=this.alphaTestNode!==null?Ut(this.alphaTestNode):HGe,Ki.a.lessThanEqual(i).discard()),this.alphaHash===!0&&Ki.a.lessThan(Hje(vl)).discard(),this.transparent===!1&&this.blending===Ug&&this.alphaToCoverage===!1?Ki.a.assign(1):i===null&&Ki.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return this.lights===!0?zt(0):Ki.rgb}setupNormal(){return this.normalNode?zt(this.normalNode):QGe}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?B3("envMap","cubeTexture"):B3("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Fje(P6e)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),this.aoNode!==null||e.material.aoMap){const a=this.aoNode!==null?this.aoNode:_je;t.push(new Dje(a))}let i=this.lightsNode||e.lightsNode;return t.length>0&&(i=e.renderer.lighting.createNode([...i.getLights(),...t])),i}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:r,emissiveNode:i}=this,c=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let u=this.setupOutgoingLight(e);if(c&&c.getScope().hasLights){const p=this.setupLightingModel(e)||null;u=Lje(c,p,n,r)}else n!==null&&(u=zt(r!==null?Ks(u,n,r):n));return(i&&i.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(M4e.assign(zt(i||qGe)),u=u.add(M4e)),u}setupFog(e,t){const n=e.fogNode;return n&&(cE.assign(t),t=$r(n)),t}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),t}setDefaultValues(e){for(const n in e){const r=e[n];this[n]===void 0&&(this[n]=r,r&&r.clone&&(this[n]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&t[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const n=tu.prototype.toJSON.call(this,e),r=Pk(this);n.inputNodes={};for(const{property:a,childNode:c}of r)n.inputNodes[a]=c.toJSON(e).uuid;function i(a){const c=[];for(const u in a){const p=a[u];delete p.metadata,c.push(p)}return c}if(t){const a=i(e.textures),c=i(e.images),u=i(e.nodes);a.length>0&&(n.textures=a),c.length>0&&(n.images=c),u.length>0&&(n.nodes=u)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}let qje=0;const Yh=new Is,bG=new Aa,z7=new pt,$u=new VE,Ew=new VE,Za=new pt;class Qg extends Av{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:qje++}),this.uuid=Fg(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(xye(e)?Tye:Eye)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new nu().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Yh.makeRotationFromQuaternion(e),this.applyMatrix4(Yh),this}rotateX(e){return Yh.makeRotationX(e),this.applyMatrix4(Yh),this}rotateY(e){return Yh.makeRotationY(e),this.applyMatrix4(Yh),this}rotateZ(e){return Yh.makeRotationZ(e),this.applyMatrix4(Yh),this}translate(e,t,n){return Yh.makeTranslation(e,t,n),this.applyMatrix4(Yh),this}scale(e,t,n){return Yh.makeScale(e,t,n),this.applyMatrix4(Yh),this}lookAt(e){return bG.lookAt(e),bG.updateMatrix(),this.applyMatrix4(bG.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(z7).negate(),this.translate(z7.x,z7.y,z7.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new uc(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const i=e[r];t.setXYZ(r,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new VE);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new pt(-1/0,-1/0,-1/0),new pt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const i=t[n];$u.setFromBufferAttribute(i),this.morphTargetsRelative?(Za.addVectors(this.boundingBox.min,$u.min),this.boundingBox.expandByPoint(Za),Za.addVectors(this.boundingBox.max,$u.max),this.boundingBox.expandByPoint(Za)):(this.boundingBox.expandByPoint($u.min),this.boundingBox.expandByPoint($u.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new tN);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new pt,1/0);return}if(e){const n=this.boundingSphere.center;if($u.setFromBufferAttribute(e),t)for(let i=0,a=t.length;i<a;i++){const c=t[i];Ew.setFromBufferAttribute(c),this.morphTargetsRelative?(Za.addVectors($u.min,Ew.min),$u.expandByPoint(Za),Za.addVectors($u.max,Ew.max),$u.expandByPoint(Za)):($u.expandByPoint(Ew.min),$u.expandByPoint(Ew.max))}$u.getCenter(n);let r=0;for(let i=0,a=e.count;i<a;i++)Za.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Za));if(t)for(let i=0,a=t.length;i<a;i++){const c=t[i],u=this.morphTargetsRelative;for(let p=0,y=c.count;p<y;p++)Za.fromBufferAttribute(c,p),u&&(z7.fromBufferAttribute(e,p),Za.add(z7)),r=Math.max(r,n.distanceToSquared(Za))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new id(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),c=[],u=[];for(let K=0;K<n.count;K++)c[K]=new pt,u[K]=new pt;const p=new pt,y=new pt,x=new pt,S=new ci,M=new ci,I=new ci,L=new pt,B=new pt;function A(K,re,se){p.fromBufferAttribute(n,K),y.fromBufferAttribute(n,re),x.fromBufferAttribute(n,se),S.fromBufferAttribute(i,K),M.fromBufferAttribute(i,re),I.fromBufferAttribute(i,se),y.sub(p),x.sub(p),M.sub(S),I.sub(S);const q=1/(M.x*I.y-I.x*M.y);isFinite(q)&&(L.copy(y).multiplyScalar(I.y).addScaledVector(x,-M.y).multiplyScalar(q),B.copy(x).multiplyScalar(M.x).addScaledVector(y,-I.x).multiplyScalar(q),c[K].add(L),c[re].add(L),c[se].add(L),u[K].add(B),u[re].add(B),u[se].add(B))}let V=this.groups;V.length===0&&(V=[{start:0,count:e.count}]);for(let K=0,re=V.length;K<re;++K){const se=V[K],q=se.start,De=se.count;for(let Be=q,tt=q+De;Be<tt;Be+=3)A(e.getX(Be+0),e.getX(Be+1),e.getX(Be+2))}const X=new pt,P=new pt,te=new pt,oe=new pt;function ie(K){te.fromBufferAttribute(r,K),oe.copy(te);const re=c[K];X.copy(re),X.sub(te.multiplyScalar(te.dot(re))).normalize(),P.crossVectors(oe,re);const q=P.dot(u[K])<0?-1:1;a.setXYZW(K,X.x,X.y,X.z,q)}for(let K=0,re=V.length;K<re;++K){const se=V[K],q=se.start,De=se.count;for(let Be=q,tt=q+De;Be<tt;Be+=3)ie(e.getX(Be+0)),ie(e.getX(Be+1)),ie(e.getX(Be+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new id(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let S=0,M=n.count;S<M;S++)n.setXYZ(S,0,0,0);const r=new pt,i=new pt,a=new pt,c=new pt,u=new pt,p=new pt,y=new pt,x=new pt;if(e)for(let S=0,M=e.count;S<M;S+=3){const I=e.getX(S+0),L=e.getX(S+1),B=e.getX(S+2);r.fromBufferAttribute(t,I),i.fromBufferAttribute(t,L),a.fromBufferAttribute(t,B),y.subVectors(a,i),x.subVectors(r,i),y.cross(x),c.fromBufferAttribute(n,I),u.fromBufferAttribute(n,L),p.fromBufferAttribute(n,B),c.add(y),u.add(y),p.add(y),n.setXYZ(I,c.x,c.y,c.z),n.setXYZ(L,u.x,u.y,u.z),n.setXYZ(B,p.x,p.y,p.z)}else for(let S=0,M=t.count;S<M;S+=3)r.fromBufferAttribute(t,S+0),i.fromBufferAttribute(t,S+1),a.fromBufferAttribute(t,S+2),y.subVectors(a,i),x.subVectors(r,i),y.cross(x),n.setXYZ(S+0,y.x,y.y,y.z),n.setXYZ(S+1,y.x,y.y,y.z),n.setXYZ(S+2,y.x,y.y,y.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Za.fromBufferAttribute(e,t),Za.normalize(),e.setXYZ(t,Za.x,Za.y,Za.z)}toNonIndexed(){function e(c,u){const p=c.array,y=c.itemSize,x=c.normalized,S=new p.constructor(u.length*y);let M=0,I=0;for(let L=0,B=u.length;L<B;L++){c.isInterleavedBufferAttribute?M=u[L]*c.data.stride+c.offset:M=u[L]*y;for(let A=0;A<y;A++)S[I++]=p[M++]}return new id(S,y,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Qg,n=this.index.array,r=this.attributes;for(const c in r){const u=r[c],p=e(u,n);t.setAttribute(c,p)}const i=this.morphAttributes;for(const c in i){const u=[],p=i[c];for(let y=0,x=p.length;y<x;y++){const S=p[y],M=e(S,n);u.push(M)}t.morphAttributes[c]=u}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,u=a.length;c<u;c++){const p=a[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const p in u)u[p]!==void 0&&(e[p]=u[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n){const p=n[u];e.data.attributes[u]=p.toJSON(e.data)}const r={};let i=!1;for(const u in this.morphAttributes){const p=this.morphAttributes[u],y=[];for(let x=0,S=p.length;x<S;x++){const M=p[x];y.push(M.toJSON(e.data))}y.length>0&&(r[u]=y,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const y=r[p];this.setAttribute(p,y.clone(t))}const i=e.morphAttributes;for(const p in i){const y=[],x=i[p];for(let S=0,M=x.length;S<M;S++)y.push(x[S].clone(t));this.morphAttributes[p]=y}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let p=0,y=a.length;p<y;p++){const x=a[p];this.addGroup(x.start,x.count,x.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Mg=new pt,SG=new pt,iI=new pt,E3=new pt,wG=new pt,sI=new pt,EG=new pt;class Xje{constructor(e=new pt,t=new pt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Mg)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Mg.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Mg.copy(this.origin).addScaledVector(this.direction,t),Mg.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){SG.copy(e).add(t).multiplyScalar(.5),iI.copy(t).sub(e).normalize(),E3.copy(this.origin).sub(SG);const i=e.distanceTo(t)*.5,a=-this.direction.dot(iI),c=E3.dot(this.direction),u=-E3.dot(iI),p=E3.lengthSq(),y=Math.abs(1-a*a);let x,S,M,I;if(y>0)if(x=a*u-c,S=a*c-u,I=i*y,x>=0)if(S>=-I)if(S<=I){const L=1/y;x*=L,S*=L,M=x*(x+a*S+2*c)+S*(a*x+S+2*u)+p}else S=i,x=Math.max(0,-(a*S+c)),M=-x*x+S*(S+2*u)+p;else S=-i,x=Math.max(0,-(a*S+c)),M=-x*x+S*(S+2*u)+p;else S<=-I?(x=Math.max(0,-(-a*i+c)),S=x>0?-i:Math.min(Math.max(-i,-u),i),M=-x*x+S*(S+2*u)+p):S<=I?(x=0,S=Math.min(Math.max(-i,-u),i),M=S*(S+2*u)+p):(x=Math.max(0,-(a*i+c)),S=x>0?i:Math.min(Math.max(-i,-u),i),M=-x*x+S*(S+2*u)+p);else S=a>0?-i:i,x=Math.max(0,-(a*S+c)),M=-x*x+S*(S+2*u)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(SG).addScaledVector(iI,S),M}intersectSphere(e,t){Mg.subVectors(e.center,this.origin);const n=Mg.dot(this.direction),r=Mg.dot(Mg)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),c=n-a,u=n+a;return u<0?null:c<0?this.at(u,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,c,u;const p=1/this.direction.x,y=1/this.direction.y,x=1/this.direction.z,S=this.origin;return p>=0?(n=(e.min.x-S.x)*p,r=(e.max.x-S.x)*p):(n=(e.max.x-S.x)*p,r=(e.min.x-S.x)*p),y>=0?(i=(e.min.y-S.y)*y,a=(e.max.y-S.y)*y):(i=(e.max.y-S.y)*y,a=(e.min.y-S.y)*y),n>a||i>r||((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),x>=0?(c=(e.min.z-S.z)*x,u=(e.max.z-S.z)*x):(c=(e.max.z-S.z)*x,u=(e.min.z-S.z)*x),n>u||c>r)||((c>n||n!==n)&&(n=c),(u<r||r!==r)&&(r=u),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Mg)!==null}intersectTriangle(e,t,n,r,i){wG.subVectors(t,e),sI.subVectors(n,e),EG.crossVectors(wG,sI);let a=this.direction.dot(EG),c;if(a>0){if(r)return null;c=1}else if(a<0)c=-1,a=-a;else return null;E3.subVectors(this.origin,e);const u=c*this.direction.dot(sI.crossVectors(E3,sI));if(u<0)return null;const p=c*this.direction.dot(wG.cross(E3));if(p<0||u+p>a)return null;const y=-c*E3.dot(EG);return y<0?null:this.at(y/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}const wf=new pt,Cg=new pt,TG=new pt,Ag=new pt,V7=new pt,G7=new pt,j4e=new pt,MG=new pt,CG=new pt,AG=new pt,PG=new Ri,RG=new Ri,IG=new Ri;class Of{constructor(e=new pt,t=new pt,n=new pt){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),wf.subVectors(e,t),r.cross(wf);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){wf.subVectors(r,t),Cg.subVectors(n,t),TG.subVectors(e,t);const a=wf.dot(wf),c=wf.dot(Cg),u=wf.dot(TG),p=Cg.dot(Cg),y=Cg.dot(TG),x=a*p-c*c;if(x===0)return i.set(0,0,0),null;const S=1/x,M=(p*u-c*y)*S,I=(a*y-c*u)*S;return i.set(1-M-I,I,M)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ag)===null?!1:Ag.x>=0&&Ag.y>=0&&Ag.x+Ag.y<=1}static getInterpolation(e,t,n,r,i,a,c,u){return this.getBarycoord(e,t,n,r,Ag)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(i,Ag.x),u.addScaledVector(a,Ag.y),u.addScaledVector(c,Ag.z),u)}static getInterpolatedAttribute(e,t,n,r,i,a){return PG.setScalar(0),RG.setScalar(0),IG.setScalar(0),PG.fromBufferAttribute(e,t),RG.fromBufferAttribute(e,n),IG.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(PG,i.x),a.addScaledVector(RG,i.y),a.addScaledVector(IG,i.z),a}static isFrontFacing(e,t,n,r){return wf.subVectors(n,t),Cg.subVectors(e,t),wf.cross(Cg).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return wf.subVectors(this.c,this.b),Cg.subVectors(this.a,this.b),wf.cross(Cg).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Of.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Of.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return Of.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Of.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Of.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,c;V7.subVectors(r,n),G7.subVectors(i,n),MG.subVectors(e,n);const u=V7.dot(MG),p=G7.dot(MG);if(u<=0&&p<=0)return t.copy(n);CG.subVectors(e,r);const y=V7.dot(CG),x=G7.dot(CG);if(y>=0&&x<=y)return t.copy(r);const S=u*x-y*p;if(S<=0&&u>=0&&y<=0)return a=u/(u-y),t.copy(n).addScaledVector(V7,a);AG.subVectors(e,i);const M=V7.dot(AG),I=G7.dot(AG);if(I>=0&&M<=I)return t.copy(i);const L=M*p-u*I;if(L<=0&&p>=0&&I<=0)return c=p/(p-I),t.copy(n).addScaledVector(G7,c);const B=y*I-M*x;if(B<=0&&x-y>=0&&M-I>=0)return j4e.subVectors(i,r),c=(x-y)/(x-y+(M-I)),t.copy(r).addScaledVector(j4e,c);const A=1/(B+L+S);return a=L*A,c=S*A,t.copy(n).addScaledVector(V7,a).addScaledVector(G7,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}class U3 extends tu{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Zi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ad,this.combine=Xk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const H4e=new Is,q8=new Xje,oI=new tN,W4e=new pt,aI=new pt,lI=new pt,cI=new pt,kG=new pt,uI=new pt,$4e=new pt,hI=new pt;class Yg extends Aa{constructor(e=new Qg,t=new U3){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const c=this.morphTargetInfluences;if(i&&c){uI.set(0,0,0);for(let u=0,p=i.length;u<p;u++){const y=c[u],x=i[u];y!==0&&(kG.fromBufferAttribute(x,e),a?uI.addScaledVector(kG,y):uI.addScaledVector(kG.sub(t),y))}t.add(uI)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),oI.copy(n.boundingSphere),oI.applyMatrix4(i),q8.copy(e.ray).recast(e.near),!(oI.containsPoint(q8.origin)===!1&&(q8.intersectSphere(oI,W4e)===null||q8.origin.distanceToSquared(W4e)>(e.far-e.near)**2))&&(H4e.copy(i).invert(),q8.copy(e.ray).applyMatrix4(H4e),!(n.boundingBox!==null&&q8.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,q8)))}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,c=i.index,u=i.attributes.position,p=i.attributes.uv,y=i.attributes.uv1,x=i.attributes.normal,S=i.groups,M=i.drawRange;if(c!==null)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const B=S[I],A=a[B.materialIndex],V=Math.max(B.start,M.start),X=Math.min(c.count,Math.min(B.start+B.count,M.start+M.count));for(let P=V,te=X;P<te;P+=3){const oe=c.getX(P),ie=c.getX(P+1),K=c.getX(P+2);r=dI(this,A,e,n,p,y,x,oe,ie,K),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=B.materialIndex,t.push(r))}}else{const I=Math.max(0,M.start),L=Math.min(c.count,M.start+M.count);for(let B=I,A=L;B<A;B+=3){const V=c.getX(B),X=c.getX(B+1),P=c.getX(B+2);r=dI(this,a,e,n,p,y,x,V,X,P),r&&(r.faceIndex=Math.floor(B/3),t.push(r))}}else if(u!==void 0)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const B=S[I],A=a[B.materialIndex],V=Math.max(B.start,M.start),X=Math.min(u.count,Math.min(B.start+B.count,M.start+M.count));for(let P=V,te=X;P<te;P+=3){const oe=P,ie=P+1,K=P+2;r=dI(this,A,e,n,p,y,x,oe,ie,K),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=B.materialIndex,t.push(r))}}else{const I=Math.max(0,M.start),L=Math.min(u.count,M.start+M.count);for(let B=I,A=L;B<A;B+=3){const V=B,X=B+1,P=B+2;r=dI(this,a,e,n,p,y,x,V,X,P),r&&(r.faceIndex=Math.floor(B/3),t.push(r))}}}}function Yje(s,e,t,n,r,i,a,c){let u;if(e.side===eu?u=n.intersectTriangle(a,i,r,!0,c):u=n.intersectTriangle(r,i,a,e.side===Bg,c),u===null)return null;hI.copy(c),hI.applyMatrix4(s.matrixWorld);const p=t.ray.origin.distanceTo(hI);return p<t.near||p>t.far?null:{distance:p,point:hI.clone(),object:s}}function dI(s,e,t,n,r,i,a,c,u,p){s.getVertexPosition(c,aI),s.getVertexPosition(u,lI),s.getVertexPosition(p,cI);const y=Yje(s,e,t,n,aI,lI,cI,$4e);if(y){const x=new pt;Of.getBarycoord($4e,aI,lI,cI,x),r&&(y.uv=Of.getInterpolatedAttribute(r,c,u,p,x,new ci)),i&&(y.uv1=Of.getInterpolatedAttribute(i,c,u,p,x,new ci)),a&&(y.normal=Of.getInterpolatedAttribute(a,c,u,p,x,new pt),y.normal.dot(n.direction)>0&&y.normal.multiplyScalar(-1));const S={a:c,b:u,c:p,normal:new pt,materialIndex:0};Of.getNormal(aI,lI,cI,S.normal),y.face=S,y.barycoord=x}return y}class z$ extends f${constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,c=r+t,u=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=p*this.view.offsetX,a=i+p*this.view.width,c-=y*this.view.offsetY,u=c-y*this.view.height}this.projectionMatrix.makeOrthographic(i,a,c,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const NG=new z$(-1,1,1,-1,0,1);class Kje extends Qg{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new uc([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new uc(t,2))}}const Zje=new Kje;class V$ extends Yg{constructor(e=null){super(Zje,e),this.camera=NG,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,NG)}render(e){e.render(this,NG)}}const lN=1/6,I6e=s=>_i(lN,_i(s,_i(s,s.negate().add(3)).sub(3)).add(1)),rW=s=>_i(lN,_i(s,_i(s,_i(3,s).sub(6))).add(4)),k6e=s=>_i(lN,_i(s,_i(s,_i(-3,s).add(3)).add(3)).add(1)),iW=s=>_i(lN,eN(s,3)),q4e=s=>I6e(s).add(rW(s)),X4e=s=>k6e(s).add(iW(s)),Y4e=s=>dc(-1,rW(s).div(I6e(s).add(rW(s)))),K4e=s=>dc(1,iW(s).div(k6e(s).add(iW(s)))),Z4e=(s,e,t)=>{const n=s.uvNode,r=_i(n,e.zw).add(.5),i=_v(r),a=e4(r),c=q4e(a.x),u=X4e(a.x),p=Y4e(a.x),y=K4e(a.x),x=Y4e(a.y),S=K4e(a.y),M=Sn(i.x.add(p),i.y.add(x)).sub(.5).mul(e.xy),I=Sn(i.x.add(y),i.y.add(x)).sub(.5).mul(e.xy),L=Sn(i.x.add(p),i.y.add(S)).sub(.5).mul(e.xy),B=Sn(i.x.add(y),i.y.add(S)).sub(.5).mul(e.xy),A=q4e(a.y).mul(dc(c.mul(s.sample(M).level(t)),u.mul(s.sample(I).level(t)))),V=X4e(a.y).mul(dc(c.mul(s.sample(L).level(t)),u.mul(s.sample(B).level(t))));return A.add(V)},Qje=en(([s,e=Ut(3)])=>{const t=Sn(s.size(zs(e))),n=Sn(s.size(zs(e.add(1)))),r=T1(1,t),i=T1(1,n),a=Z4e(s,$r(r,t),_v(e)),c=Z4e(s,$r(i,n),M$(e));return e4(e).mix(a,c)}),Tw=new ad,DG=new Is;class Jc extends Xr{static get type(){return"SceneNode"}constructor(e=Jc.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=this.scene!==null?this.scene:e.scene;let r;return t===Jc.BACKGROUND_BLURRINESS?r=Rs("backgroundBlurriness","float",n):t===Jc.BACKGROUND_INTENSITY?r=Rs("backgroundIntensity","float",n):t===Jc.BACKGROUND_ROTATION?r=Nr("mat4").label("backgroundRotation").setGroup(kr).onRenderUpdate(()=>{const i=n.background;return i!==null&&i.isTexture&&i.mapping!==n$?(Tw.copy(n.backgroundRotation),Tw.x*=-1,Tw.y*=-1,Tw.z*=-1,DG.makeRotationFromEuler(Tw)):DG.identity(),DG}):console.error("THREE.SceneNode: Unknown scope:",t),r}}Jc.BACKGROUND_BLURRINESS="backgroundBlurriness";Jc.BACKGROUND_INTENSITY="backgroundIntensity";Jc.BACKGROUND_ROTATION="backgroundRotation";const Jje=xn(Jc,Jc.BACKGROUND_BLURRINESS),Q4e=xn(Jc,Jc.BACKGROUND_INTENSITY),eHe=xn(Jc,Jc.BACKGROUND_ROTATION),tHe=en(({texture:s,uv:e})=>{const n=zt().toVar();return Jo(e.x.lessThan(1e-4),()=>{n.assign(zt(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{n.assign(zt(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{n.assign(zt(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{n.assign(zt(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{n.assign(zt(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{n.assign(zt(0,0,-1))}).Else(()=>{const i=s.sample(e.add(zt(-.01,0,0))).r.sub(s.sample(e.add(zt(.01,0,0))).r),a=s.sample(e.add(zt(0,-.01,0))).r.sub(s.sample(e.add(zt(0,.01,0))).r),c=s.sample(e.add(zt(0,0,-.01))).r.sub(s.sample(e.add(zt(0,0,.01))).r);n.assign(zt(i,a,c))}),n.normalize()});class nHe extends o_{static get type(){return"Texture3DNode"}constructor(e,t=null,n=null){super(e,t,n),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return zt(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(zs(Rx(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}normal(e){return tHe({texture:this,uv:e})}}const rHe=nn(nHe).setParameterLength(1,3),fI=new ci;class iHe extends o_{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class J4e extends iHe{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class cN extends ma{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const i=new w1;i.isRenderTargetTexture=!0,i.name="depth";const a=new Pv(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:td,...r});a.texture.name="output",a.depthTexture=i,this.renderTarget=a,this._textures={output:a.texture,depth:i},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=Nr(0),this._cameraFar=Nr(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=pi.FRAME,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=sn(new J4e(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=sn(new J4e(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=b6e(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=hE(i,n,r)}return t}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.texture.type=e.getColorBufferType(),this.scope===cN.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let r,i;const a=t.getOutputRenderTarget();a&&a.isXRRenderTarget===!0?(i=1,r=t.xr.getCamera(),t.xr.updateCamera(r),fI.set(a.width,a.height)):(r=this.camera,i=t.getPixelRatio(),t.getSize(fI)),this._pixelRatio=i,this.setSize(fI.width,fI.height);const c=t.getRenderTarget(),u=t.getMRT(),p=r.layers.mask;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const y in this._previousTextures)this.toggleTexture(y);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(n,r),t.setRenderTarget(c),t.setMRT(u),r.layers.mask=p}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}cN.COLOR="color";cN.DEPTH="depth";const sHe=en(([s,e])=>s.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),oHe=en(([s,e])=>(s=s.mul(e),s.div(s.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),aHe=en(([s,e])=>{s=s.mul(e),s=s.sub(.004).max(0);const t=s.mul(s.mul(6.2).add(.5)),n=s.mul(s.mul(6.2).add(1.7)).add(.06);return t.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),lHe=en(([s])=>{const e=s.mul(s.add(.0245786)).sub(90537e-9),t=s.mul(s.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),cHe=en(([s,e])=>{const t=hc(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=hc(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return s=s.mul(e).div(.6),s=t.mul(s),s=lHe(s),s=n.mul(s),s.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),uHe=hc(zt(1.6605,-.1246,-.0182),zt(-.5876,1.1329,-.1006),zt(-.0728,-.0083,1.1187)),hHe=hc(zt(.6274,.0691,.0164),zt(.3293,.9195,.088),zt(.0433,.0113,.8956)),dHe=en(([s])=>{const e=zt(s).toVar(),t=zt(e.mul(e)).toVar(),n=zt(t.mul(t)).toVar();return Ut(15.5).mul(n.mul(t)).sub(_i(40.14,n.mul(e))).add(_i(31.96,n).sub(_i(6.868,t.mul(e))).add(_i(.4298,t).add(_i(.1191,e).sub(.00232))))}),fHe=en(([s,e])=>{const t=zt(s).toVar(),n=hc(zt(.856627153315983,.137318972929847,.11189821299995),zt(.0951212405381588,.761241990602591,.0767994186031903),zt(.0482516061458583,.101439036467562,.811302368396859)),r=hc(zt(1.1271005818144368,-.1413297634984383,-.14132976349843826),zt(-.11060664309660323,1.157823702216272,-.11060664309660294),zt(-.016493938717834573,-.016493938717834257,1.2519364065950405)),i=Ut(-12.47393),a=Ut(4.026069);return t.mulAssign(e),t.assign(hHe.mul(t)),t.assign(n.mul(t)),t.assign(Sl(t,1e-10)),t.assign(jg(t)),t.assign(t.sub(i).div(a.sub(i))),t.assign(Xg(t,0,1)),t.assign(dHe(t)),t.assign(r.mul(t)),t.assign(eN(Sl(zt(0),t),zt(2.2))),t.assign(uHe.mul(t)),t.assign(Xg(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),pHe=en(([s,e])=>{const t=Ut(.76),n=Ut(.15);s=s.mul(e);const r=qx(s.r,qx(s.g,s.b)),i=xl(r.lessThan(.08),r.sub(_i(6.25,r.mul(r))),.04);s.subAssign(i);const a=Sl(s.r,Sl(s.g,s.b));Jo(a.lessThan(t),()=>s);const c=oc(1,t),u=oc(1,c.mul(c).div(a.add(c.sub(t))));s.mulAssign(u.div(a));const p=oc(1,T1(1,n.mul(a.sub(u)).add(1)));return Ks(s,zt(u),p)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class Ma extends Xr{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class mHe extends Ma{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),r=n.name,i=n.type,a=e.getCodeFromNode(this,i);r!==""&&(a.name=r);const c=e.getPropertyName(a),u=this.getNodeFunction(e).getCode(c);return a.code=u+`
`,t==="property"?c:e.format(`${c}()`,i,t)}}function N6e(s){let e;const t=s.context.getViewZ;return t!==void 0&&(e=t(this)),(e||fa.z).negate()}const gHe=en(([s,e],t)=>{const n=N6e(t);return Y3(s,e,n)}),vHe=en(([s],e)=>{const t=N6e(e);return s.mul(s,t,t).negate().exp().oneMinus()}),e5e=en(([s,e])=>$r(e.toFloat().mix(cE.rgb,s.toVec3()),cE.a));class yHe extends Xr{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}nn(yHe);class A1 extends Xr{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,r=this.method,i=this.getNodeType(e),a=this.getInputType(e),c=this.pointerNode,u=this.valueNode,p=[];p.push(`&${c.build(e,a)}`),u!==null&&p.push(u.build(e,a));const y=`${e.getMethod(r,i)}( ${p.join(", ")} )`;if(n.length===1&&n[0].isStackNode===!0)e.addLineFlowCode(y,this);else return t.constNode===void 0&&(t.constNode=Xx(y,i).toConst()),t.constNode.build(e)}}A1.ATOMIC_LOAD="atomicLoad";A1.ATOMIC_STORE="atomicStore";A1.ATOMIC_ADD="atomicAdd";A1.ATOMIC_SUB="atomicSub";A1.ATOMIC_MAX="atomicMax";A1.ATOMIC_MIN="atomicMin";A1.ATOMIC_AND="atomicAnd";A1.ATOMIC_OR="atomicOr";A1.ATOMIC_XOR="atomicXor";nn(A1);let pI;function uN(s){pI=pI||new WeakMap;let e=pI.get(s);return e===void 0&&pI.set(s,e={}),e}function D6e(s){const e=uN(s);return e.shadowMatrix||(e.shadowMatrix=Nr("mat4").setGroup(kr).onRenderUpdate(t=>((s.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&s.shadow.updateMatrices(s),s.shadow.matrix)))}function xHe(s,e=kE){const t=D6e(s).mul(e);return t.xyz.div(t.w)}function O6e(s){const e=uN(s);return e.position||(e.position=Nr(new pt).setGroup(kr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(s.matrixWorld)))}function _He(s){const e=uN(s);return e.targetPosition||(e.targetPosition=Nr(new pt).setGroup(kr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(s.target.matrixWorld)))}function L6e(s){const e=uN(s);return e.viewPosition||(e.viewPosition=Nr(new pt).setGroup(kr).onRenderUpdate(({camera:t},n)=>{n.value=n.value||new pt,n.value.setFromMatrixPosition(s.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)}))}const F6e=s=>Zg.transformDirection(O6e(s).sub(_He(s))),bHe=s=>s.sort((e,t)=>e.id-t.id),SHe=(s,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===s)return t;return null},OG=new WeakMap,Mw=[];class B6e extends Xr{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=zt().toVar(),this.totalSpecularNode=zt().toVar(),this.outgoingLightNode=zt().toVar(),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let n=0;n<e.length;n++){const r=e[n];if(Mw.push(r.id),Mw.push(r.castShadow?1:0),r.isSpotLight===!0){const i=r.map!==null?r.map.id:-1,a=r.colorNode?r.colorNode.getCacheKey():-1;Mw.push(i,a)}}const t=h$(Mw);return Mw.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const n of this._lightNodes)t.push(n.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const n of t.nodes)n.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,r=bHe(this._lights),i=e.renderer.library;for(const a of r)if(a.isNode)t.push(sn(a));else{let c=null;if(n!==null&&(c=SHe(a.id,n)),c===null){const u=i.getLightNodeClass(a.constructor);if(u===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${a.constructor.name}`);continue}let p=null;OG.has(a)?p=OG.get(a):(p=sn(new u(a)),OG.set(a,p)),t.push(p)}}this._lightNodes=t}setupDirectLight(e,t,n){const{lightingModel:r,reflectedLight:i}=e.context;r.direct({...n,lightNode:t,reflectedLight:i},e)}setupDirectRectAreaLight(e,t,n){const{lightingModel:r,reflectedLight:i}=e.context;r.directRectArea({...n,lightNode:t,reflectedLight:i},e)}setupLights(e,t){for(const n of t)n.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let n=this.outgoingLightNode;const r=e.context,i=r.lightingModel,a=e.getNodeProperties(this);if(i){const{totalDiffuseNode:c,totalSpecularNode:u}=this;r.outgoingLight=n;const p=e.addStack();a.nodes=p.nodes,i.start(e);const{backdrop:y,backdropAlpha:x}=r,{directDiffuse:S,directSpecular:M,indirectDiffuse:I,indirectSpecular:L}=r.reflectedLight;let B=S.add(I);y!==null&&(x!==null?B=zt(x.mix(B,y)):B=zt(y),r.material.transparent=!0),c.assign(B),u.assign(M.add(L)),n.assign(c.add(u)),i.finish(e),n=n.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=t,n}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class wHe extends Xr{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=pi.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){U6e.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||kE)}}const U6e=Bye("vec3","shadowPositionWorld");function EHe(s,e={}){return e.toneMapping=s.toneMapping,e.toneMappingExposure=s.toneMappingExposure,e.outputColorSpace=s.outputColorSpace,e.renderTarget=s.getRenderTarget(),e.activeCubeFace=s.getActiveCubeFace(),e.activeMipmapLevel=s.getActiveMipmapLevel(),e.renderObjectFunction=s.getRenderObjectFunction(),e.pixelRatio=s.getPixelRatio(),e.mrt=s.getMRT(),e.clearColor=s.getClearColor(e.clearColor||new Zi),e.clearAlpha=s.getClearAlpha(),e.autoClear=s.autoClear,e.scissorTest=s.getScissorTest(),e}function THe(s,e){return e=EHe(s,e),s.setMRT(null),s.setRenderObjectFunction(null),s.setClearColor(0,1),s.autoClear=!0,e}function MHe(s,e){s.toneMapping=e.toneMapping,s.toneMappingExposure=e.toneMappingExposure,s.outputColorSpace=e.outputColorSpace,s.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),s.setRenderObjectFunction(e.renderObjectFunction),s.setPixelRatio(e.pixelRatio),s.setMRT(e.mrt),s.setClearColor(e.clearColor,e.clearAlpha),s.autoClear=e.autoClear,s.setScissorTest(e.scissorTest)}function CHe(s,e={}){return e.background=s.background,e.backgroundNode=s.backgroundNode,e.overrideMaterial=s.overrideMaterial,e}function AHe(s,e){return e=CHe(s,e),s.background=null,s.backgroundNode=null,s.overrideMaterial=null,e}function PHe(s,e){s.background=e.background,s.backgroundNode=e.backgroundNode,s.overrideMaterial=e.overrideMaterial}function RHe(s,e,t){return t=THe(s,t),t=AHe(e,t),t}function IHe(s,e,t){MHe(s,t),PHe(e,t)}const t5e=new WeakMap,kHe=en(({depthTexture:s,shadowCoord:e,depthLayer:t})=>{let n=ji(s,e.xy).label("t_basic");return s.isArrayTexture&&(n=n.depth(t)),n.compare(e.z)}),NHe=en(({depthTexture:s,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(B,A)=>{let V=ji(s,B);return s.isArrayTexture&&(V=V.depth(n)),V.compare(A)},i=Rs("mapSize","vec2",t).setGroup(kr),a=Rs("radius","float",t).setGroup(kr),c=Sn(1).div(i),u=c.x.negate().mul(a),p=c.y.negate().mul(a),y=c.x.mul(a),x=c.y.mul(a),S=u.div(2),M=p.div(2),I=y.div(2),L=x.div(2);return dc(r(e.xy.add(Sn(u,p)),e.z),r(e.xy.add(Sn(0,p)),e.z),r(e.xy.add(Sn(y,p)),e.z),r(e.xy.add(Sn(S,M)),e.z),r(e.xy.add(Sn(0,M)),e.z),r(e.xy.add(Sn(I,M)),e.z),r(e.xy.add(Sn(u,0)),e.z),r(e.xy.add(Sn(S,0)),e.z),r(e.xy,e.z),r(e.xy.add(Sn(I,0)),e.z),r(e.xy.add(Sn(y,0)),e.z),r(e.xy.add(Sn(S,L)),e.z),r(e.xy.add(Sn(0,L)),e.z),r(e.xy.add(Sn(I,L)),e.z),r(e.xy.add(Sn(u,x)),e.z),r(e.xy.add(Sn(0,x)),e.z),r(e.xy.add(Sn(y,x)),e.z)).mul(1/17)}),DHe=en(({depthTexture:s,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(x,S)=>{let M=ji(s,x);return s.isArrayTexture&&(M=M.depth(n)),M.compare(S)},i=Rs("mapSize","vec2",t).setGroup(kr),a=Sn(1).div(i),c=a.x,u=a.y,p=e.xy,y=e4(p.mul(i).add(.5));return p.subAssign(y.mul(a)),dc(r(p,e.z),r(p.add(Sn(c,0)),e.z),r(p.add(Sn(0,u)),e.z),r(p.add(a),e.z),Ks(r(p.add(Sn(c.negate(),0)),e.z),r(p.add(Sn(c.mul(2),0)),e.z),y.x),Ks(r(p.add(Sn(c.negate(),u)),e.z),r(p.add(Sn(c.mul(2),u)),e.z),y.x),Ks(r(p.add(Sn(0,u.negate())),e.z),r(p.add(Sn(0,u.mul(2))),e.z),y.y),Ks(r(p.add(Sn(c,u.negate())),e.z),r(p.add(Sn(c,u.mul(2))),e.z),y.y),Ks(Ks(r(p.add(Sn(c.negate(),u.negate())),e.z),r(p.add(Sn(c.mul(2),u.negate())),e.z),y.x),Ks(r(p.add(Sn(c.negate(),u.mul(2))),e.z),r(p.add(Sn(c.mul(2),u.mul(2))),e.z),y.x),y.y)).mul(1/9)}),OHe=en(({depthTexture:s,shadowCoord:e,depthLayer:t})=>{const n=Ut(1).toVar();let r=ji(s).sample(e.xy);s.isArrayTexture&&(r=r.depth(t)),r=r.rg;const i=Qye(e.z,r.x);return Jo(i.notEqual(Ut(1)),()=>{const a=e.z.sub(r.x),c=Sl(0,r.y.mul(r.y));let u=c.div(c.add(a.mul(a)));u=Xg(oc(u,.3).div(.95-.3)),n.assign(Xg(Sl(i,u)))}),n}),LHe=en(([s,e,t])=>{let n=kE.sub(s).length();return n=n.sub(e).div(t.sub(e)),n=n.saturate(),n}),FHe=s=>{const e=s.shadow.camera,t=Rs("near","float",e).setGroup(kr),n=Rs("far","float",e).setGroup(kr),r=KVe(s);return LHe(r,t,n)},BHe=s=>{let e=t5e.get(s);if(e===void 0){const t=s.isPointLight?FHe(s):null;e=new pa,e.colorNode=$r(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,t5e.set(s,e)}return e},n5e=new Lf,j7=[],UHe=(s,e,t,n)=>{j7[0]=s,j7[1]=e;let r=n5e.get(j7);return(r===void 0||r.shadowType!==t||r.useVelocity!==n)&&(r=(i,a,c,u,p,y,...x)=>{(i.castShadow===!0||i.receiveShadow&&t===YI)&&(n&&(wye(i).useVelocity=!0),i.onBeforeShadow(s,i,c,e.camera,u,a.overrideMaterial,y),s.renderObject(i,a,c,u,p,y,...x),i.onAfterShadow(s,i,c,e.camera,u,a.overrideMaterial,y))},r.shadowType=t,r.useVelocity=n,n5e.set(j7,r)),j7[0]=null,j7[1]=null,r},zHe=en(({samples:s,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const i=Ut(0).toVar("meanVertical"),a=Ut(0).toVar("squareMeanVertical"),c=s.lessThanEqual(Ut(1)).select(Ut(0),Ut(2).div(s.sub(1))),u=s.lessThanEqual(Ut(1)).select(Ut(0),Ut(-1));Df({start:zs(0),end:zs(s),type:"int",condition:"<"},({i:y})=>{const x=u.add(Ut(y).mul(c));let S=n.sample(dc(oN.xy,Sn(0,x).mul(e)).div(t));n.value.isArrayTexture&&(S=S.depth(r)),S=S.x,i.addAssign(S),a.addAssign(S.mul(S))}),i.divAssign(s),a.divAssign(s);const p=T$(a.sub(i.mul(i)));return Sn(i,p)}),VHe=en(({samples:s,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const i=Ut(0).toVar("meanHorizontal"),a=Ut(0).toVar("squareMeanHorizontal"),c=s.lessThanEqual(Ut(1)).select(Ut(0),Ut(2).div(s.sub(1))),u=s.lessThanEqual(Ut(1)).select(Ut(0),Ut(-1));Df({start:zs(0),end:zs(s),type:"int",condition:"<"},({i:y})=>{const x=u.add(Ut(y).mul(c));let S=n.sample(dc(oN.xy,Sn(x,0).mul(e)).div(t));n.value.isArrayTexture&&(S=S.depth(r)),i.addAssign(S.x),a.addAssign(dc(S.y.mul(S.y),S.x.mul(S.x)))}),i.divAssign(s),a.divAssign(s);const p=T$(a.sub(i.mul(i)));return Sn(i,p)}),GHe=[kHe,NHe,DHe,OHe];let LG;const mI=new V$;class z6e extends wHe{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:i,depthLayer:a}){const c=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),u=t({depthTexture:n,shadowCoord:r,shadow:i,depthLayer:a});return c.select(u,Ut(1))}setupShadowCoord(e,t){const{shadow:n}=this,{renderer:r}=e,i=Rs("bias","float",n).setGroup(kr);let a=t,c;if(n.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)a=a.xyz.div(a.w),c=a.z,r.coordinateSystem===X3&&(c=c.mul(2).sub(1));else{const u=a.w;a=a.xy.div(u);const p=Rs("near","float",n.camera).setGroup(kr),y=Rs("far","float",n.camera).setGroup(kr);c=S6e(u.negate(),p,y)}return a=zt(a.x,a.y.oneMinus(),c.add(i)),a}getShadowFilterFn(e){return GHe[e]}setupRenderTarget(e,t){const n=new w1(e.mapSize.width,e.mapSize.height);n.name="ShadowDepthTexture",n.compareFunction=u$;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=n,{shadowMap:r,depthTexture:n}}setupShadow(e){const{renderer:t}=e,{light:n,shadow:r}=this,i=t.shadowMap.type,{depthTexture:a,shadowMap:c}=this.setupRenderTarget(r,e);if(r.camera.updateProjectionMatrix(),i===YI&&r.isPointLightShadow!==!0){a.compareFunction=null,c.depth>1?(c._vsmShadowMapVertical||(c._vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:yv,type:td,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=c._vsmShadowMapVertical,c._vsmShadowMapHorizontal||(c._vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:yv,type:td,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=c._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:yv,type:td,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:yv,type:td,depthBuffer:!1}));let A=ji(a);a.isArrayTexture&&(A=A.depth(this.depthLayer));let V=ji(this.vsmShadowMapVertical.texture);a.isArrayTexture&&(V=V.depth(this.depthLayer));const X=Rs("blurSamples","float",r).setGroup(kr),P=Rs("radius","float",r).setGroup(kr),te=Rs("mapSize","vec2",r).setGroup(kr);let oe=this.vsmMaterialVertical||(this.vsmMaterialVertical=new pa);oe.fragmentNode=zHe({samples:X,radius:P,size:te,shadowPass:A,depthLayer:this.depthLayer}).context(e.getSharedContext()),oe.name="VSMVertical",oe=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new pa),oe.fragmentNode=VHe({samples:X,radius:P,size:te,shadowPass:V,depthLayer:this.depthLayer}).context(e.getSharedContext()),oe.name="VSMHorizontal"}const u=Rs("intensity","float",r).setGroup(kr),p=Rs("normalBias","float",r).setGroup(kr),y=D6e(n).mul(U6e.add(F$.mul(p))),x=this.setupShadowCoord(e,y),S=r.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(S===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const M=i===YI&&r.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:a,I=this.setupShadowFilter(e,{filterFn:S,shadowTexture:c.texture,depthTexture:M,shadowCoord:x,shadow:r,depthLayer:this.depthLayer});let L=ji(c.texture,x);a.isArrayTexture&&(L=L.depth(this.depthLayer));const B=Ks(1,I.rgb.mix(L,1),u.mul(L.a)).toVar();return this.shadowMap=c,this.shadow.map=c,B}setup(e){if(e.renderer.shadowMap.enabled!==!1)return en(()=>{let t=this._node;return this.setupShadowPosition(e),t===null&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:i,scene:a}=e;t.updateMatrices(r),n.setSize(t.mapSize.width,t.mapSize.height,n.depth),i.render(a,t.camera)}updateShadow(e){const{shadowMap:t,light:n,shadow:r}=this,{renderer:i,scene:a,camera:c}=e,u=i.shadowMap.type,p=t.depthTexture.version;this._depthVersionCached=p;const y=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=c.layers.mask);const x=i.getRenderObjectFunction(),S=i.getMRT(),M=S?S.has("velocity"):!1;LG=RHe(i,a,LG),a.overrideMaterial=BHe(n),i.setRenderObjectFunction(UHe(i,r,u,M)),i.setClearColor(0,0),i.setRenderTarget(t),this.renderShadow(e),i.setRenderObjectFunction(x),u===YI&&r.isPointLightShadow!==!0&&this.vsmPass(i),r.camera.layers.mask=y,IHe(i,a,LG)}vsmPass(e){const{shadow:t}=this,n=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,n),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,n),e.setRenderTarget(this.vsmShadowMapVertical),mI.material=this.vsmMaterialVertical,mI.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),mI.material=this.vsmMaterialHorizontal,mI.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const jHe=(s,e)=>sn(new z6e(s,e)),HHe=new Zi,p1=en(([s,e])=>{const t=s.toVar(),n=Qh(t),r=T1(1,Sl(n.x,Sl(n.y,n.z)));n.mulAssign(r),t.mulAssign(r.mul(e.mul(2).oneMinus()));const i=Sn(t.xy).toVar(),c=e.mul(1.5).oneMinus();return Jo(n.z.greaterThanEqual(c),()=>{Jo(t.z.greaterThan(0),()=>{i.x.assign(oc(4,t.x))})}).ElseIf(n.x.greaterThanEqual(c),()=>{const u=Lk(t.x);i.x.assign(t.z.mul(u).add(u.mul(2)))}).ElseIf(n.y.greaterThanEqual(c),()=>{const u=Lk(t.y);i.x.assign(t.x.add(u.mul(2)).add(2)),i.y.assign(t.z.mul(u).sub(2))}),Sn(.125,.25).mul(i).add(Sn(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),WHe=en(({depthTexture:s,bd3D:e,dp:t,texelSize:n})=>ji(s,p1(e,n.y)).compare(t)),$He=en(({depthTexture:s,bd3D:e,dp:t,texelSize:n,shadow:r})=>{const i=Rs("radius","float",r).setGroup(kr),a=Sn(-1,1).mul(i).mul(n.y);return ji(s,p1(e.add(a.xyy),n.y)).compare(t).add(ji(s,p1(e.add(a.yyy),n.y)).compare(t)).add(ji(s,p1(e.add(a.xyx),n.y)).compare(t)).add(ji(s,p1(e.add(a.yyx),n.y)).compare(t)).add(ji(s,p1(e,n.y)).compare(t)).add(ji(s,p1(e.add(a.xxy),n.y)).compare(t)).add(ji(s,p1(e.add(a.yxy),n.y)).compare(t)).add(ji(s,p1(e.add(a.xxx),n.y)).compare(t)).add(ji(s,p1(e.add(a.yxx),n.y)).compare(t)).mul(1/9)}),qHe=en(({filterFn:s,depthTexture:e,shadowCoord:t,shadow:n})=>{const r=t.xyz.toVar(),i=r.length(),a=Nr("float").setGroup(kr).onRenderUpdate(()=>n.camera.near),c=Nr("float").setGroup(kr).onRenderUpdate(()=>n.camera.far),u=Rs("bias","float",n).setGroup(kr),p=Nr(n.mapSize).setGroup(kr),y=Ut(1).toVar();return Jo(i.sub(c).lessThanEqual(0).and(i.sub(a).greaterThanEqual(0)),()=>{const x=i.sub(a).div(c.sub(a)).toVar();x.addAssign(u);const S=r.normalize(),M=Sn(1).div(p.mul(Sn(4,2)));y.assign(s({depthTexture:e,bd3D:S,dp:x,texelSize:M,shadow:n}))}),y}),r5e=new Ri,H7=new ci,Cw=new ci;class XHe extends z6e{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===sBe?WHe:$He}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:i,shadow:a}){return qHe({filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:i,shadow:a})}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:i,scene:a}=e,c=t.getFrameExtents();Cw.copy(t.mapSize),Cw.multiply(c),n.setSize(Cw.width,Cw.height),H7.copy(t.mapSize);const u=i.autoClear,p=i.getClearColor(HHe),y=i.getClearAlpha();i.autoClear=!1,i.setClearColor(t.clearColor,t.clearAlpha),i.clear();const x=t.getViewportCount();for(let S=0;S<x;S++){const M=t.getViewport(S),I=H7.x*M.x,L=Cw.y-H7.y-H7.y*M.y;r5e.set(I,L,H7.x*M.z,H7.y*M.w),n.viewport.copy(r5e),t.updateMatrices(r,S),i.render(a,t.camera)}i.autoClear=u,i.setClearColor(p,y)}}const YHe=(s,e)=>sn(new XHe(s,e));class Rv extends a_{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new Zi,this.colorNode=e&&e.colorNode||Nr(this.color).setGroup(kr),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=pi.FRAME}getHash(){return this.light.uuid}getLightVector(e){return L6e(this.light).sub(e.context.positionView||fa)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return jHe(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const r=this.light.shadow.shadowNode;let i;r!==void 0?i=sn(r):i=this.setupShadowNode(),this.shadowNode=i,this.shadowColorNode=n=this.colorNode.mul(i),this.baseColorNode=this.colorNode}this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const V6e=en(({lightDistance:s,cutoffDistance:e,decayExponent:t})=>{const n=s.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(n.mul(s.div(e).pow4().oneMinus().clamp().pow2()),n)}),KHe=({color:s,lightVector:e,cutoffDistance:t,decayExponent:n})=>{const r=e.normalize(),i=e.length(),a=V6e({lightDistance:i,cutoffDistance:t,decayExponent:n}),c=s.mul(a);return{lightDirection:r,lightColor:c}};class ZHe extends Rv{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=Nr(0).setGroup(kr),this.decayExponentNode=Nr(2).setGroup(kr)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return YHe(this.light)}setupDirect(e){return KHe({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const i5e=Ut(1),sW=Ut(-2),gI=Ut(.8),FG=Ut(-1),vI=Ut(.4),BG=Ut(2),yI=Ut(.305),UG=Ut(3),s5e=Ut(.21),QHe=Ut(4),o5e=Ut(4),JHe=Ut(16),eWe=en(([s])=>{const e=zt(Qh(s)).toVar(),t=Ut(-1).toVar();return Jo(e.x.greaterThan(e.z),()=>{Jo(e.x.greaterThan(e.y),()=>{t.assign(xl(s.x.greaterThan(0),0,3))}).Else(()=>{t.assign(xl(s.y.greaterThan(0),1,4))})}).Else(()=>{Jo(e.z.greaterThan(e.y),()=>{t.assign(xl(s.z.greaterThan(0),2,5))}).Else(()=>{t.assign(xl(s.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),tWe=en(([s,e])=>{const t=Sn().toVar();return Jo(e.equal(0),()=>{t.assign(Sn(s.z,s.y).div(Qh(s.x)))}).ElseIf(e.equal(1),()=>{t.assign(Sn(s.x.negate(),s.z.negate()).div(Qh(s.y)))}).ElseIf(e.equal(2),()=>{t.assign(Sn(s.x.negate(),s.y).div(Qh(s.z)))}).ElseIf(e.equal(3),()=>{t.assign(Sn(s.z.negate(),s.y).div(Qh(s.x)))}).ElseIf(e.equal(4),()=>{t.assign(Sn(s.x.negate(),s.z).div(Qh(s.y)))}).Else(()=>{t.assign(Sn(s.x,s.y).div(Qh(s.z)))}),_i(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),nWe=en(([s])=>{const e=Ut(0).toVar();return Jo(s.greaterThanEqual(gI),()=>{e.assign(i5e.sub(s).mul(FG.sub(sW)).div(i5e.sub(gI)).add(sW))}).ElseIf(s.greaterThanEqual(vI),()=>{e.assign(gI.sub(s).mul(BG.sub(FG)).div(gI.sub(vI)).add(FG))}).ElseIf(s.greaterThanEqual(yI),()=>{e.assign(vI.sub(s).mul(UG.sub(BG)).div(vI.sub(yI)).add(BG))}).ElseIf(s.greaterThanEqual(s5e),()=>{e.assign(yI.sub(s).mul(QHe.sub(UG)).div(yI.sub(s5e)).add(UG))}).Else(()=>{e.assign(Ut(-2).mul(jg(_i(1.16,s))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),rWe=en(([s,e])=>{const t=s.toVar();t.assign(_i(2,t).sub(1));const n=zt(t,1).toVar();return Jo(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),iWe=en(([s,e,t,n,r,i])=>{const a=Ut(t),c=zt(e),u=Xg(nWe(a),sW,i),p=e4(u),y=_v(u),x=zt(oW(s,c,y,n,r,i)).toVar();return Jo(p.notEqual(0),()=>{const S=zt(oW(s,c,y.add(1),n,r,i)).toVar();x.assign(Ks(x,S,p))}),x}),oW=en(([s,e,t,n,r,i])=>{const a=Ut(t).toVar(),c=zt(e),u=Ut(eWe(c)).toVar(),p=Ut(Sl(o5e.sub(a),0)).toVar();a.assign(Sl(a,o5e));const y=Ut(RE(a)).toVar(),x=Sn(tWe(c,u).mul(y.sub(2)).add(1)).toVar();return Jo(u.greaterThan(2),()=>{x.y.addAssign(y),u.subAssign(3)}),x.x.addAssign(u.mul(y)),x.x.addAssign(p.mul(_i(3,JHe))),x.y.addAssign(_i(4,RE(i).sub(y))),x.x.mulAssign(n),x.y.mulAssign(r),s.sample(x).grad(Sn(),Sn())}),zG=en(({envMap:s,mipInt:e,outputDirection:t,theta:n,axis:r,CUBEUV_TEXEL_WIDTH:i,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:c})=>{const u=D3(n),p=t.mul(u).add(r.cross(t).mul(If(n))).add(r.mul(r.dot(t).mul(u.oneMinus())));return oW(s,p,e,i,a,c)}),sWe=en(({n:s,latitudinal:e,poleAxis:t,outputDirection:n,weights:r,samples:i,dTheta:a,mipInt:c,envMap:u,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x})=>{const S=zt(xl(e,t,Jye(t,n))).toVar();Jo(S.equal(zt(0)),()=>{S.assign(zt(n.z,0,n.x.negate()))}),S.assign(IE(S));const M=zt().toVar();return M.addAssign(r.element(0).mul(zG({theta:0,axis:S,outputDirection:n,mipInt:c,envMap:u,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x}))),Df({start:zs(1),end:s},({i:I})=>{Jo(I.greaterThanEqual(i),()=>{XVe()});const L=Ut(a.mul(Ut(I))).toVar();M.addAssign(r.element(I).mul(zG({theta:L.mul(-1),axis:S,outputDirection:n,mipInt:c,envMap:u,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x}))),M.addAssign(r.element(I).mul(zG({theta:L,axis:S,outputDirection:n,mipInt:c,envMap:u,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x})))}),$r(M,1)}),T3=new pt,a5e=new ci,l5e=new ci;class Ku extends f${constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Gx*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(sE*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Gx*2*Math.atan(Math.tan(sE*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){T3.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(T3.x,T3.y).multiplyScalar(-e/T3.z),T3.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(T3.x,T3.y).multiplyScalar(-e/T3.z)}getViewSize(e,t){return this.getViewBounds(e,a5e,l5e),t.subVectors(l5e,a5e)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(sE*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const u=a.fullWidth,p=a.fullHeight;i+=a.offsetX*r/u,t-=a.offsetY*n/p,r*=a.width/u,n*=a.height/p}const c=this.filmOffset;c!==0&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class jE extends Qg{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const c=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const u=[],p=[],y=[],x=[];let S=0,M=0;I("z","y","x",-1,-1,n,t,e,a,i,0),I("z","y","x",1,-1,n,t,-e,a,i,1),I("x","z","y",1,1,e,n,t,r,a,2),I("x","z","y",1,-1,e,n,-t,r,a,3),I("x","y","z",1,-1,e,t,n,r,i,4),I("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(u),this.setAttribute("position",new uc(p,3)),this.setAttribute("normal",new uc(y,3)),this.setAttribute("uv",new uc(x,2));function I(L,B,A,V,X,P,te,oe,ie,K,re){const se=P/ie,q=te/K,De=P/2,Be=te/2,tt=oe/2,st=ie+1,de=K+1;let ft=0,Se=0;const rt=new pt;for(let ut=0;ut<de;ut++){const Pe=ut*q-Be;for(let vt=0;vt<st;vt++){const Bt=vt*se-De;rt[L]=Bt*V,rt[B]=Pe*X,rt[A]=tt,p.push(rt.x,rt.y,rt.z),rt[L]=0,rt[B]=0,rt[A]=oe>0?1:-1,y.push(rt.x,rt.y,rt.z),x.push(vt/ie),x.push(1-ut/K),ft+=1}}for(let ut=0;ut<K;ut++)for(let Pe=0;Pe<ie;Pe++){const vt=S+Pe+st*ut,Bt=S+Pe+st*(ut+1),ct=S+(Pe+1)+st*(ut+1),Pt=S+(Pe+1)+st*ut;u.push(vt,Bt,Pt),u.push(Bt,ct,Pt),Se+=6}c.addGroup(M,Se,re),M+=Se,S+=ft}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jE(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}const gx=4,c5e=[.125,.215,.35,.446,.526,.582],fv=20,VG=new z$(-1,1,1,-1,0,1),oWe=new Ku(90,1),u5e=new Zi;let GG=null,jG=0,HG=0;const av=(1+Math.sqrt(5))/2,W7=1/av,h5e=[new pt(-av,W7,0),new pt(av,W7,0),new pt(-W7,0,av),new pt(W7,0,av),new pt(0,av,-W7),new pt(0,av,W7),new pt(-1,1,-1),new pt(1,1,-1),new pt(-1,1,1),new pt(1,1,1)],aWe=new pt,G6e=new WeakMap,lWe=[3,1,5,0,4,2],WG=rWe(GE(),K3("faceIndex")).normalize(),G$=zt(WG.x,WG.y,WG.z);class cWe{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,n=.1,r=100,i={}){const{size:a=256,position:c=aWe,renderTarget:u=null}=i;if(this._setSize(a),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const y=u||this._allocateTarget();return i.renderTarget=y,this.fromSceneAsync(e,t,n,r,i),y}GG=this._renderer.getRenderTarget(),jG=this._renderer.getActiveCubeFace(),HG=this._renderer.getActiveMipmapLevel();const p=u||this._allocateTarget();return p.depthBuffer=!0,this._init(p),this._sceneToCubeUV(e,n,r,p,c),t>0&&this._blur(p,0,0,t),this._applyPMREM(p),this._cleanup(p),p}async fromSceneAsync(e,t=0,n=.1,r=100,i={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,t,n,r,i)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=f5e(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=p5e(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===CE||e.mapping===Tk?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(GG,jG,HG),e.scissorTest=!1,xI(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),GG=this._renderer.getRenderTarget(),jG=this._renderer.getActiveCubeFace(),HG=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTarget();return this._init(n),this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return d5e(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=d5e(e.width,e.height);const{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=uWe(t)),this._blurMaterial=hWe(t,e.width,e.height)}}async _compileMaterial(e){const t=new Yg(this._lodPlanes[0],e);await this._renderer.compile(t,VG)}_sceneToCubeUV(e,t,n,r,i){const a=oWe;a.near=t,a.far=n;const c=[1,1,1,1,-1,1],u=[1,-1,1,-1,1,-1],p=this._renderer,y=p.autoClear;p.getClearColor(u5e),p.autoClear=!1;let x=this._backgroundBox;if(x===null){const I=new U3({name:"PMREM.Background",side:eu,depthWrite:!1,depthTest:!1});x=new Yg(new jE,I)}let S=!1;const M=e.background;M?M.isColor&&(x.material.color.copy(M),e.background=null,S=!0):(x.material.color.copy(u5e),S=!0),p.setRenderTarget(r),p.clear(),S&&p.render(x,a);for(let I=0;I<6;I++){const L=I%3;L===0?(a.up.set(0,c[I],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+u[I],i.y,i.z)):L===1?(a.up.set(0,0,c[I]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+u[I],i.z)):(a.up.set(0,c[I],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+u[I]));const B=this._cubeSize;xI(r,L*B,I>2?B:0,B,B),p.render(e,a)}p.autoClear=y,e.background=M}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===CE||e.mapping===Tk;r?this._cubemapMaterial===null&&(this._cubemapMaterial=f5e(e)):this._equirectMaterial===null&&(this._equirectMaterial=p5e(e));const i=r?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;const a=this._lodMeshes[0];a.material=i;const c=this._cubeSize;xI(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(a,VG)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),c=h5e[(r-i-1)%h5e.length];this._blur(e,i-1,i,a,c)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,c){const u=this._renderer,p=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const y=3,x=this._lodMeshes[r];x.material=p;const S=G6e.get(p),M=this._sizeLods[n]-1,I=isFinite(i)?Math.PI/(2*M):2*Math.PI/(2*fv-1),L=i/I,B=isFinite(i)?1+Math.floor(y*L):fv;B>fv&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${B} samples when the maximum is set to ${fv}`);const A=[];let V=0;for(let ie=0;ie<fv;++ie){const K=ie/L,re=Math.exp(-K*K/2);A.push(re),ie===0?V+=re:ie<B&&(V+=2*re)}for(let ie=0;ie<A.length;ie++)A[ie]=A[ie]/V;e.texture.frame=(e.texture.frame||0)+1,S.envMap.value=e.texture,S.samples.value=B,S.weights.array=A,S.latitudinal.value=a==="latitudinal"?1:0,c&&(S.poleAxis.value=c);const{_lodMax:X}=this;S.dTheta.value=I,S.mipInt.value=X-n;const P=this._sizeLods[r],te=3*P*(r>X-gx?r-X+gx:0),oe=4*(this._cubeSize-P);xI(t,te,oe,3*P,2*P),u.setRenderTarget(t),u.render(x,VG)}}function uWe(s){const e=[],t=[],n=[],r=[];let i=s;const a=s-gx+1+c5e.length;for(let c=0;c<a;c++){const u=Math.pow(2,i);t.push(u);let p=1/u;c>s-gx?p=c5e[c-s+gx-1]:c===0&&(p=0),n.push(p);const y=1/(u-2),x=-y,S=1+y,M=[x,x,S,x,S,S,x,x,S,S,x,S],I=6,L=6,B=3,A=2,V=1,X=new Float32Array(B*L*I),P=new Float32Array(A*L*I),te=new Float32Array(V*L*I);for(let ie=0;ie<I;ie++){const K=ie%3*2/3-1,re=ie>2?0:-1,se=[K,re,0,K+2/3,re,0,K+2/3,re+1,0,K,re,0,K+2/3,re+1,0,K,re+1,0],q=lWe[ie];X.set(se,B*L*q),P.set(M,A*L*q);const De=[q,q,q,q,q,q];te.set(De,V*L*q)}const oe=new Qg;oe.setAttribute("position",new id(X,B)),oe.setAttribute("uv",new id(P,A)),oe.setAttribute("faceIndex",new id(te,V)),e.push(oe),r.push(new Yg(oe,null)),i>gx&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n,lodMeshes:r}}function d5e(s,e){const t={magFilter:th,minFilter:th,generateMipmaps:!1,type:td,format:nd,colorSpace:Ex},n=new Pv(s,e,t);return n.texture.mapping=IH,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function xI(s,e,t,n,r){s.viewport.set(e,t,n,r),s.scissor.set(e,t,n,r)}function j$(s){const e=new pa;return e.depthTest=!1,e.depthWrite=!1,e.blending=jx,e.name=`PMREM_${s}`,e}function hWe(s,e,t){const n=y1(new Array(fv).fill(0)),r=Nr(new pt(0,1,0)),i=Nr(0),a=Ut(fv),c=Nr(0),u=Nr(1),p=ji(null),y=Nr(0),x=Ut(1/e),S=Ut(1/t),M=Ut(s),I={n:a,latitudinal:c,weights:n,poleAxis:r,outputDirection:G$,dTheta:i,samples:u,envMap:p,mipInt:y,CUBEUV_TEXEL_WIDTH:x,CUBEUV_TEXEL_HEIGHT:S,CUBEUV_MAX_MIP:M},L=j$("blur");return L.fragmentNode=sWe({...I,latitudinal:c.equal(1)}),G6e.set(L,I),L}function f5e(s){const e=j$("cubemap");return e.fragmentNode=NE(s,G$),e}function p5e(s){const e=j$("equirect");return e.fragmentNode=ji(s,p6e(G$),0),e}const m5e=new WeakMap;function dWe(s){const e=Math.log2(s)-2,t=1/s;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function fWe(s,e,t){const n=pWe(e);let r=n.get(s);if((r!==void 0?r.pmremVersion:-1)!==s.pmremVersion){const a=s.image;if(s.isCubeTexture)if(gWe(a))r=t.fromCubemap(s,r);else return null;else if(vWe(a))r=t.fromEquirectangular(s,r);else return null;r.pmremVersion=s.pmremVersion,n.set(s,r)}return r.texture}function pWe(s){let e=m5e.get(s);return e===void 0&&(e=new WeakMap,m5e.set(s,e)),e}class mWe extends ma{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const r=new _l;r.isRenderTargetTexture=!0,this._texture=ji(r),this._width=Nr(0),this._height=Nr(0),this._maxMip=Nr(0),this.updateBeforeType=pi.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=dWe(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const n=t?t.pmremVersion:-1,r=this._value;n!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=fWe(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new cWe(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this)),t=T6e.mul(zt(t.x,t.y.negate(),t.z));let n=this.levelNode;return n===null&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),iWe(this._texture,t,n,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function gWe(s){if(s==null)return!1;let e=0;const t=6;for(let n=0;n<t;n++)s[n]!==void 0&&e++;return e===t}function vWe(s){return s==null?!1:s.height>0}const j6e=nn(mWe).setParameterLength(1,3);en(([s=GE()],{renderer:e,material:t})=>{const n=t6e(s.mul(2).sub(1));let r;if(t.alphaToCoverage&&e.samples>1){const i=Ut(n.fwidth()).toVar();r=Y3(i.oneMinus(),i.add(1),n).oneMinus()}else r=xl(n.greaterThan(1),0,1);return r});const DE=en(({f0:s,f90:e,dotVH:t})=>{const n=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return s.mul(n.oneMinus()).add(e.mul(n))}),yWe=en(({alpha:s,dotNL:e,dotNV:t})=>{const n=s.pow2(),r=e.mul(n.add(n.oneMinus().mul(t.pow2())).sqrt()),i=t.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return T1(.5,r.add(i).max(Dze))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),xWe=en(({alphaT:s,alphaB:e,dotTV:t,dotBV:n,dotTL:r,dotBL:i,dotNV:a,dotNL:c})=>{const u=c.mul(zt(s.mul(t),e.mul(n),a).length()),p=a.mul(zt(s.mul(r),e.mul(i),c).length());return T1(.5,u.add(p)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),_We=en(({alpha:s,dotNH:e})=>{const t=s.pow2(),n=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),bWe=Ut(1/Math.PI),SWe=en(({alphaT:s,alphaB:e,dotNH:t,dotTH:n,dotBH:r})=>{const i=s.mul(e),a=zt(e.mul(n),s.mul(r),i.mul(t)),c=a.dot(a),u=i.div(c);return bWe.mul(i.mul(u.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),g5e=en(s=>{const{lightDirection:e,f0:t,f90:n,roughness:r,f:i,USE_IRIDESCENCE:a,USE_ANISOTROPY:c}=s,u=s.normalView||ha,p=r.pow2(),y=e.add(So).normalize(),x=u.dot(e).clamp(),S=u.dot(So).clamp(),M=u.dot(y).clamp(),I=So.dot(y).clamp();let L=DE({f0:t,f90:n,dotVH:I}),B,A;if(E4e(a)&&(L=E$.mix(L,i)),E4e(c)){const V=JI.dot(e),X=JI.dot(So),P=JI.dot(y),te=Ax.dot(e),oe=Ax.dot(So),ie=Ax.dot(y);B=xWe({alphaT:JH,alphaB:p,dotTV:X,dotBV:oe,dotTL:V,dotBL:te,dotNV:S,dotNL:x}),A=SWe({alphaT:JH,alphaB:p,dotNH:M,dotTH:P,dotBH:ie})}else B=yWe({alpha:p,dotNL:x,dotNV:S}),A=_We({alpha:p,dotNH:M});return L.mul(B).mul(A)}),Yx=en(s=>s.diffuseColor.mul(1/Math.PI)),H6e=en(({roughness:s,dotNV:e})=>{const t=$r(-1,-.0275,-.572,.022),n=$r(1,.0425,1.04,-.04),r=s.mul(t).add(n),i=r.x.mul(r.x).min(e.mul(-9.28).exp2()).mul(r.x).add(r.y);return Sn(-1.04,1.04).mul(i).add(r.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),wWe=en(({f:s,f90:e,dotVH:t})=>{const n=t.oneMinus().saturate(),r=n.mul(n),i=n.mul(r,r).clamp(0,.9999);return s.sub(zt(e).mul(i)).div(i.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),EWe=en(s=>{if(s.geometry.hasAttribute("normal")===!1)return Ut(0);const e=C1.dFdx().abs().max(C1.dFdy().abs());return e.x.max(e.y).max(e.z)}),W6e=en(s=>{const{roughness:e}=s,t=EWe();let n=e.max(.0525);return n=n.add(t),n=n.min(1),n}),TWe=en(([s,e])=>{const t=s.x,n=s.y,r=s.z;let i=e.element(0).mul(.886227);return i=i.add(e.element(1).mul(2*.511664).mul(n)),i=i.add(e.element(2).mul(2*.511664).mul(r)),i=i.add(e.element(3).mul(2*.511664).mul(t)),i=i.add(e.element(4).mul(2*.429043).mul(t).mul(n)),i=i.add(e.element(5).mul(2*.429043).mul(n).mul(r)),i=i.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),i=i.add(e.element(7).mul(2*.429043).mul(t).mul(r)),i=i.add(e.element(8).mul(.429043).mul(_i(t,t).sub(_i(n,n)))),i});class H$ extends Qg{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(a+c,Math.PI);let p=0;const y=[],x=new pt,S=new pt,M=[],I=[],L=[],B=[];for(let A=0;A<=n;A++){const V=[],X=A/n;let P=0;A===0&&a===0?P=.5/t:A===n&&u===Math.PI&&(P=-.5/t);for(let te=0;te<=t;te++){const oe=te/t;x.x=-e*Math.cos(r+oe*i)*Math.sin(a+X*c),x.y=e*Math.cos(a+X*c),x.z=e*Math.sin(r+oe*i)*Math.sin(a+X*c),I.push(x.x,x.y,x.z),S.copy(x).normalize(),L.push(S.x,S.y,S.z),B.push(oe+P,1-X),V.push(p++)}y.push(V)}for(let A=0;A<n;A++)for(let V=0;V<t;V++){const X=y[A][V+1],P=y[A][V],te=y[A+1][V],oe=y[A+1][V+1];(A!==0||a>0)&&M.push(X,P,oe),(A!==n-1||u<Math.PI)&&M.push(P,te,oe)}this.setIndex(M),this.setAttribute("position",new uc(I,3)),this.setAttribute("normal",new uc(L,3)),this.setAttribute("uv",new uc(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new H$(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}const Ef=new m$;class MWe extends J3{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const r=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background;let a=!1;if(i===null)r._clearColor.getRGB(Ef),Ef.a=r._clearColor.a;else if(i.isColor===!0)i.getRGB(Ef),Ef.a=1,a=!0;else if(i.isNode===!0){const p=this.get(e),y=i;Ef.copy(r._clearColor);let x=p.backgroundMesh;if(x===void 0){let B=function(){i.removeEventListener("dispose",B),x.material.dispose(),x.geometry.dispose()};var u=B;const M=A$($r(y).mul(Q4e),{getUV:()=>eHe.mul(L$),getTextureLevel:()=>Jje});let I=R6e;I=I.setZ(I.w);const L=new pa;L.name="Background.material",L.side=eu,L.depthTest=!1,L.depthWrite=!1,L.allowOverride=!1,L.fog=!1,L.lights=!1,L.vertexNode=I,L.colorNode=M,p.backgroundMeshNode=M,p.backgroundMesh=x=new Yg(new H$(1,32,32),L),x.frustumCulled=!1,x.name="Background.mesh",x.onBeforeRender=function(A,V,X){this.matrixWorld.copyPosition(X.matrixWorld)},i.addEventListener("dispose",B)}const S=y.getCacheKey();p.backgroundCacheKey!==S&&(p.backgroundMeshNode.node=$r(y).mul(Q4e),p.backgroundMeshNode.needsUpdate=!0,x.material.needsUpdate=!0,p.backgroundCacheKey=S),t.unshift(x,x.geometry,x.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);const c=r.xr.getEnvironmentBlendMode();if(c==="additive"?Ef.set(0,0,0,1):c==="alpha-blend"&&Ef.set(0,0,0,0),r.autoClear===!0||a===!0){const p=n.clearColorValue;p.r=Ef.r,p.g=Ef.g,p.b=Ef.b,p.a=Ef.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(p.r*=p.a,p.g*=p.a,p.b*=p.a),n.depthClearValue=r._clearDepth,n.stencilClearValue=r._clearStencil,n.clearColor=r.autoClearColor===!0,n.clearDepth=r.autoClearDepth===!0,n.clearStencil=r.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let CWe=0;class aW{constructor(e="",t=[],n=0,r=[]){this.name=e,this.bindings=t,this.index=n,this.bindingsReference=r,this.id=CWe++}}class AWe{constructor(e,t,n,r,i,a,c,u,p,y=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=y,this.nodeAttributes=r,this.bindings=i,this.updateNodes=a,this.updateBeforeNodes=c,this.updateAfterNodes=u,this.observer=p,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new aW(t.name,[],t.index,t);e.push(r);for(const i of t.bindings)r.bindings.push(i.clone())}else e.push(t);return e}}function $6e(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const r=s[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function PWe(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}const RWe=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,IWe=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class kWe extends tu{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=RWe,this.fragmentShader=IWe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=$6e(e.uniforms),this.uniformsGroups=PWe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class NWe extends Pv{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}const $7=-90,q7=1;class q6e extends Aa{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ku($7,q7,e,t);r.layers=this.layers,this.add(r);const i=new Ku($7,q7,e,t);i.layers=this.layers,this.add(i);const a=new Ku($7,q7,e,t);a.layers=this.layers,this.add(a);const c=new Ku($7,q7,e,t);c.layers=this.layers,this.add(c);const u=new Ku($7,q7,e,t);u.layers=this.layers,this.add(u);const p=new Ku($7,q7,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,c,u]=t;for(const p of t)this.remove(p);if(e===Zc)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===X3)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,c,u,p,y]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),M=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const L=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,c),e.setRenderTarget(n,3,r),e.render(t,u),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=L,e.setRenderTarget(n,5,r),e.render(t,y),e.setRenderTarget(x,S,M),e.xr.enabled=I,n.texture.needsPMREMUpdate=!0}}class DWe extends NWe{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new aN(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new jE(5,5,5),i=new kWe({name:"CubemapFromEquirect",uniforms:$6e(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:eu,blending:jx});i.uniforms.tEquirect.value=t;const a=new Yg(r,i),c=t.minFilter;return t.minFilter===zg&&(t.minFilter=th),new q6e(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}class X6e extends DWe{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i=new jE(5,5,5),a=p6e(f6e),c=new pa;c.colorNode=ji(t,a,0),c.side=eu,c.blending=jx;const u=new Yg(i,c),p=new d$;p.add(u),t.minFilter===zg&&(t.minFilter=th);const y=new q6e(1,10,this),x=e.getMRT();return e.setMRT(null),y.update(e,p),e.setMRT(x),t.minFilter=n,t.currentGenerateMipmaps=r,u.geometry.dispose(),u.material.dispose(),this}}const dE=new WeakMap;class OWe extends ma{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=NE(null);const t=new aN;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=pi.RENDER}updateBefore(e){const{renderer:t,material:n}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const i=r.isTextureNode?r.value:n[r.property];if(i&&i.isTexture){const a=i.mapping;if(a===r$||a===i$){if(dE.has(i)){const c=dE.get(i);v5e(c,i.mapping),this._cubeTexture=c}else{const c=i.image;if(LWe(c)){const u=new X6e(c.height);u.fromEquirectangularTexture(t,i),v5e(u.texture,i.mapping),this._cubeTexture=u.texture,dE.set(i,u.texture),i.addEventListener("dispose",Y6e)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function LWe(s){return s==null?!1:s.height>0}function Y6e(s){const e=s.target;e.removeEventListener("dispose",Y6e);const t=dE.get(e);t!==void 0&&(dE.delete(e),t.dispose())}function v5e(s,e){e===r$?s.mapping=CE:e===i$&&(s.mapping=Tk)}const K6e=nn(OWe).setParameterLength(1);class hN{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class y5e{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class FWe{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class Z6e{constructor(e,t,n=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=n,this.count=r}}class BWe extends Z6e{constructor(e,t,n=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=n,this.interpolationSampling=r}}class UWe{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let zWe=0;class $G{constructor(e=null){this.id=zWe++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class VWe{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class t4{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class GWe extends t4{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class jWe extends t4{constructor(e,t=new ci){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class HWe extends t4{constructor(e,t=new pt){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class WWe extends t4{constructor(e,t=new Ri){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class $We extends t4{constructor(e,t=new Zi){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class qWe extends t4{constructor(e,t=new Yk){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class XWe extends t4{constructor(e,t=new nu){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class YWe extends t4{constructor(e,t=new Is){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class KWe extends GWe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class ZWe extends jWe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class QWe extends HWe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class JWe extends WWe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class e$e extends $We{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class t$e extends qWe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class n$e extends XWe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class r$e extends YWe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const x5e=new WeakMap,i$e=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),_I=s=>/e/g.test(s)?String(s).replace(/\+/g,""):(s=Number(s),s+(s%1?"":".0"));class Q6e{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=dG(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new $G,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}getBindGroupsCache(){let e=x5e.get(this.renderer);return e===void 0&&(e=new Lf,x5e.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new Pv(e,t,n)}createCubeRenderTarget(e,t){return new X6e(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const n=this.getBindGroupsCache(),r=[];let i=!0;for(const c of t)r.push(c),i=i&&c.groupNode.shared!==!0;let a;return i?(a=n.get(r),a===void 0&&(a=new aW(e,r,this.bindingsIndexes[e].group,r),n.set(r,a))):a=new aW(e,r,this.bindingsIndexes[e].group,r),a}getBindGroupArray(e,t){const n=this.bindings[t];let r=n[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},n=this.bindings;for(const r of y4e)for(const i in n[r]){const a=n[r][i];(t[i]||(t[i]=[])).push(...a)}e=[];for(const r in t){const i=t[r],a=this._getBindGroup(r,i);e.push(a)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,n)=>t.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==pi.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==pi.NONE&&this.updateBeforeNodes.push(e.getSelf()),n!==pi.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===th||e.magFilter===kH||e.magFilter===AE||e.magFilter===zg||e.minFilter===th||e.minFilter===kH||e.minFilter===AE||e.minFilter===zg}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new $G(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,n=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let i=0;i<t;i++){const a=n?n[i]:null;a!==null?r+=a.build(this,e):r+=this.generateConst(e),i<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,n=null){const r=[];for(const i of t){const{name:a,type:c}=i;n&&n[a]&&n[a].isNode?r.push(n[a].build(this,c)):r.push(this.generateConst(c))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new Zi:e==="vec2"?t=new ci:e==="vec3"?t=new pt:e==="vec4"&&(t=new Ri)),e==="float")return _I(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${_I(t.r)}, ${_I(t.g)}, ${_I(t.b)} )`;const n=this.getTypeLength(e),r=this.getComponentType(e),i=a=>this.generateConst(r,a);if(n===2)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)} )`;if(n===3)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)} )`;if(n===4&&e!=="mat2")return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)}, ${i(t.w)} )`;if(n>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(i).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const n=this.attributes;for(const i of n)if(i.name===e)return i;const r=new y5e(e,t);return this.registerDeclaration(r),n.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===sc)return"int";if(t===Zo)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let n=jBe(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(n=n.replace("vec","mat")),r+n}getTypeFromArray(e){return i$e.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,r=e.itemSize,i=e.normalized;let a;return!(e instanceof Mye)&&i!==!0&&(a=this.getTypeFromArray(n)),this.getTypeFromLength(r,a)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return n!==null?Number(n[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=dG(this.stack),this.stacks.push(Dye()||this.stack),Ik(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,Ik(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let r=n.getData(e);return r===void 0&&(r={},n.setData(e,r)),r[t]===void 0&&(r[t]={}),r[t]}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e);let r=n.bufferAttribute;if(r===void 0){const i=this.uniforms.index++;r=new y5e("nodeAttribute"+i,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}getStructTypeFromNode(e,t,n=null,r=this.shaderStage){const i=this.getDataFromNode(e,r,this.globalCache);let a=i.structType;if(a===void 0){const c=this.structs.index++;n===null&&(n="StructType"+c),a=new VWe(n,t),this.structs[r].push(a),i.structType=a}return a}getOutputStructTypeFromNode(e,t){const n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}getUniformFromNode(e,t,n=this.shaderStage,r=null){const i=this.getDataFromNode(e,n,this.globalCache);let a=i.uniform;if(a===void 0){const c=this.uniforms.index++;a=new FWe(r||"nodeUniform"+c,t,e),this.uniforms[n].push(a),this.registerDeclaration(a),i.uniform=a}return a}getArrayCount(e){let t=null;return e.isArrayNode?t=e.count:e.isVarNode&&e.node.isArrayNode&&(t=e.node.count),t}getVarFromNode(e,t=null,n=e.getNodeType(this),r=this.shaderStage,i=!1){const a=this.getDataFromNode(e,r);let c=a.variable;if(c===void 0){const u=i?"_const":"_var",p=this.vars[r]||(this.vars[r]=[]),y=this.vars[u]||(this.vars[u]=0);t===null&&(t=(i?"nodeConst":"nodeVar")+y,this.vars[u]++);const x=this.getArrayCount(e);c=new Z6e(t,n,i,x),i||p.push(c),this.registerDeclaration(c),a.variable=c}return c}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,n=e.getNodeType(this),r=null,i=null){const a=this.getDataFromNode(e,"any");let c=a.varying;if(c===void 0){const u=this.varyings,p=u.length;t===null&&(t="nodeVarying"+p),c=new BWe(t,n,r,i),u.push(c),this.registerDeclaration(c),a.varying=c}return c}get namespace(){return this.context.namespace}getOutputNamespace(){return this.getNamespace("outputNode")}getNamespace(e=""){const t=this.namespace;let n;return t?n=e?t+"_"+e:t:n=e,n}registerDeclaration(e){const t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let i=1,a=r;for(;n[a]!==void 0;)a=r+"_"+i++;i>1&&(e.name=a,console.warn(`THREE.TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${a}'.`)),n[a]=e}getCodeFromNode(e,t,n=this.shaderStage){const r=this.getDataFromNode(e);let i=r.code;if(i===void 0){const a=this.codes[n]||(this.codes[n]=[]),c=a.length;i=new UWe("nodeCode"+c,t),a.push(i),r.code=i}return i}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:r}=this.getDataFromNode(e);let i=!0,a=t;for(;a;){if(r.get(a)===!0){i=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(i)for(const c of n)this.addLineFlowCode(c)}addLineFlowCodeBlock(e,t,n){const r=this.getDataFromNode(e),i=r.flowCodes||(r.flowCodes=[]),a=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);i.push(t),a.set(n,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new mHe,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let a=0;const c=Object.values(this);return{next:()=>({value:c[a],done:a++>=c.length})}}};for(const a of t.inputs)n[a.name]=new WVe(a.type,a.name);e.layout=null;const r=e.call(n),i=this.flowStagesNode(r,t.type);return e.layout=t,i}flowStagesNode(e,t=null){const n=this.flow,r=this.vars,i=this.declarations,a=this.cache,c=this.buildStage,u=this.stack,p={code:""};this.flow=p,this.vars={},this.declarations={},this.cache=new $G,this.stack=dG();for(const y of v4e)this.setBuildStage(y),p.result=e.build(this,t);return p.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.declarations=i,this.cache=a,this.stack=u,this.setBuildStage(c),p}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}flowNodeFromShaderStage(e,t,n=null,r=null){const i=this.tab,a=this.cache,c=this.shaderStage,u=this.context;this.setShaderStage(e);const p={...this.context};delete p.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=p;let y=null;if(this.buildStage==="generate"){const x=this.flowChildNode(t,n);r!==null&&(x.code+=`${this.tab+r} = ${x.result};
`),this.flowCode[e]=this.flowCode[e]+x.code,y=x}else y=t.build(this);return this.setShaderStage(c),this.cache=a,this.tab=i,this.context=u,y}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,n=null){return`${n!==null?this.generateArrayDeclaration(e,n):this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(n!==void 0)for(const r of n)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(t!==void 0)for(const r of t)n+=r.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:n}=this;if(t!==null){let r=n.library.fromMaterial(t);r===null&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new pa),r.build(this)}else this.addFlow("compute",e);for(const r of v4e){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const i of y4e){this.setShaderStage(i);const a=this.flowNodes[i];for(const c of a)r==="generate"?this.flowNode(c):c.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new KWe(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new ZWe(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new QWe(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new JWe(e);if(t==="color")return new e$e(e);if(t==="mat2")return new t$e(e);if(t==="mat3")return new n$e(e);if(t==="mat4")return new r$e(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,n){if(t=this.getVectorType(t),n=this.getVectorType(n),t===n||n===null||this.isReference(n))return e;const r=this.getTypeLength(t),i=this.getTypeLength(n);return r===16&&i===9?`${this.getType(n)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&i===4?`${this.getType(n)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||i>4||i===0?e:r===i?`${this.getType(n)}( ${e} )`:r>i?(e=n==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,i)}`,this.format(e,this.getTypeFromLength(i,this.getComponentType(t)),n)):i===4&&r>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&i>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${$ve} - Node System
`}*[Symbol.iterator](){}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}}class _5e{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return n===void 0&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===pi.FRAME){const{frameMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.frameId&&e.updateBefore(this)!==!1&&r.set(n,this.frameId)}else if(t===pi.RENDER){const{renderMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.renderId&&e.updateBefore(this)!==!1&&r.set(n,this.renderId)}else t===pi.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===pi.FRAME){const{frameMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.frameId&&e.updateAfter(this)!==!1&&r.set(n,this.frameId)}else if(t===pi.RENDER){const{renderMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.renderId&&e.updateAfter(this)!==!1&&r.set(n,this.renderId)}else t===pi.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===pi.FRAME){const{frameMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.frameId&&e.update(this)!==!1&&r.set(n,this.frameId)}else if(t===pi.RENDER){const{renderMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.renderId&&e.update(this)!==!1&&r.set(n,this.renderId)}else t===pi.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class W${constructor(e,t,n=null,r="",i=!1){this.type=e,this.name=t,this.count=n,this.qualifier=r,this.isConst=i}}W$.isNodeFunctionInput=!0;class s$e extends Rv{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:F6e(this.light),lightColor:e}}}const qG=new Is,bI=new Is;let Aw=null;class o$e extends Rv{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=Nr(new pt).setGroup(kr),this.halfWidth=Nr(new pt).setGroup(kr),this.updateType=pi.RENDER}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;bI.identity(),qG.copy(t.matrixWorld),qG.premultiply(n),bI.extractRotation(qG),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(bI),this.halfHeight.value.applyMatrix4(bI)}setupDirectRectArea(e){let t,n;e.isAvailable("float32Filterable")?(t=ji(Aw.LTC_FLOAT_1),n=ji(Aw.LTC_FLOAT_2)):(t=ji(Aw.LTC_HALF_1),n=ji(Aw.LTC_HALF_2));const{colorNode:r,light:i}=this,a=L6e(i);return{lightColor:r,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}static setLTC(e){Aw=e}}class $$ extends Rv{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=Nr(0).setGroup(kr),this.penumbraCosNode=Nr(0).setGroup(kr),this.cutoffDistanceNode=Nr(0).setGroup(kr),this.decayExponentNode=Nr(0).setGroup(kr),this.colorNode=Nr(this.color).setGroup(kr)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:n,penumbraCosNode:r}=this;return Y3(n,r,t)}getLightCoord(e){const t=e.getNodeProperties(this);let n=t.projectionUV;return n===void 0&&(n=xHe(this.light,e.context.positionWorld),t.projectionUV=n),n}setupDirect(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:r,light:i}=this,a=this.getLightVector(e),c=a.normalize(),u=c.dot(F6e(i)),p=this.getSpotAttenuation(e,u),y=a.length(),x=V6e({lightDistance:y,cutoffDistance:n,decayExponent:r});let S=t.mul(p).mul(x),M,I;return i.colorNode?(I=this.getLightCoord(e),M=i.colorNode(I)):i.map&&(I=this.getLightCoord(e),M=ji(i.map,I.xy).onRenderUpdate(()=>i.map)),M&&(S=I.mul(2).sub(1).abs().lessThan(1).all().select(S.mul(M),S)),{lightColor:S,lightDirection:c}}}class a$e extends $${static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const n=this.light.iesMap;let r=null;if(n&&n.isTexture===!0){const i=t.acos().mul(1/Math.PI);r=ji(n,Sn(i,0),0).r}else r=super.getSpotAttenuation(t);return r}}const l$e=en(([s,e])=>{const t=s.abs().sub(e);return Hg(Sl(t,0)).add(qx(Sl(t.x,t.y),0))});class c$e extends $${static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let n=1;t.map!==null&&(n=t.map.width/t.map.height),t.shadow.aspect=n}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=this.penumbraCosNode,n=this.getLightCoord(e),r=n.xyz.div(n.w),i=l$e(r.xy.sub(Sn(.5)),Sn(.5)),a=T1(-1,oc(1,Xye(t)).sub(1));return n6e(i.mul(-2).mul(a))}}class u$e extends Rv{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class h$e extends Rv{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=O6e(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=Nr(new Zi).setGroup(kr)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:r}=this,a=L$.dot(r).mul(.5).add(.5),c=Ks(n,t,a);e.context.irradiance.addAssign(c)}}class d$e extends Rv{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let n=0;n<9;n++)t.push(new pt);this.lightProbe=y1(t)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=TWe(L$,this.lightProbe);e.context.irradiance.addAssign(t)}}const b5e=new WeakMap;class f$e extends a_{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const x=n.isTextureNode?n.value:t[n.property];let S=b5e.get(x);S===void 0&&(S=j6e(x),b5e.set(x,S)),n=S}const i=t.useAnisotropy===!0||t.anisotropy>0?FGe:ha,a=n.context(S5e(Dg,i)).mul(yG),c=n.context(p$e(F$)).mul(Math.PI).mul(yG),u=nk(a),p=nk(c);e.context.radiance.addAssign(u),e.context.iblIrradiance.addAssign(p);const y=e.context.lightingModel.clearcoatRadiance;if(y){const x=n.context(S5e(Dk,Yw)).mul(yG),S=nk(x);y.addAssign(S)}}}const S5e=(s,e)=>{let t=null;return{getUV:()=>(t===null&&(t=So.negate().reflect(e),t=s.mul(s).mix(t,e).normalize(),t=t.transformDirection(Zg)),t),getTextureLevel:()=>s}},p$e=s=>({getUV:()=>s,getTextureLevel:()=>Ut(1)});class q$ extends a_{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=K6e(this.envNode)}}class J6e{parseFunction(){console.warn("Abstract function.")}}class X${constructor(e,t,n="",r=""){this.type=e,this.inputs=t,this.name=n,this.precision=r}getCode(){console.warn("Abstract function.")}}X$.isNodeFunction=!0;const m$e=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,g$e=/[a-z_0-9]+/ig,w5e="#pragma main",v$e=s=>{s=s.trim();const e=s.indexOf(w5e),t=e!==-1?s.slice(e+w5e.length):s,n=t.match(m$e);if(n!==null&&n.length===5){const r=n[4],i=[];let a=null;for(;(a=g$e.exec(r))!==null;)i.push(a);const c=[];let u=0;for(;u<i.length;){const I=i[u][0]==="const";I===!0&&u++;let L=i[u][0];L==="in"||L==="out"||L==="inout"?u++:L="";const B=i[u++][0];let A=Number.parseInt(i[u][0]);Number.isNaN(A)===!1?u++:A=null;const V=i[u++][0];c.push(new W$(B,V,A,L,I))}const p=t.substring(n[0].length),y=n[3]!==void 0?n[3]:"",x=n[2],S=n[1]!==void 0?n[1]:"",M=e!==-1?s.slice(0,e):"";return{type:x,inputs:c,name:y,precision:S,inputsCode:r,blockCode:p,headerCode:M}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class y$e extends X${constructor(e){const{type:t,inputs:n,name:r,precision:i,inputsCode:a,blockCode:c,headerCode:u}=v$e(e);super(t,n,r,i),this.inputsCode=a,this.blockCode=c,this.headerCode=u}getCode(e=this.name){let t;const n=this.blockCode;if(n!==""){const{type:r,inputsCode:i,headerCode:a,precision:c}=this;let u=`${r} ${e} ( ${i.trim()} )`;c!==""&&(u=`${c} ${u}`),t=a+u+n}else t="";return t}}class x$e extends J6e{parseFunction(e){return new y$e(e)}}class e7e extends hN{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,n=e.reflectedLight,r=e.irradianceLightMap;n.indirectDiffuse.assign($r(0)),r?n.indirectDiffuse.addAssign(r):n.indirectDiffuse.addAssign($r(1,1,1,0)),n.indirectDiffuse.mulAssign(t),n.indirectDiffuse.mulAssign(Ki.rgb)}finish(e){const{material:t,context:n}=e,r=n.outgoingLight,i=e.context.environment;if(i)switch(t.combine){case Xk:r.rgb.assign(Ks(r.rgb,r.rgb.mul(i.rgb),ik.mul(xG)));break;case cBe:r.rgb.assign(Ks(r.rgb,i.rgb,ik.mul(xG)));break;case uBe:r.rgb.addAssign(i.rgb.mul(ik.mul(xG)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const _$e=()=>Ut(.25),b$e=en(({dotNH:s})=>eW.mul(Ut(.5)).add(1).mul(Ut(1/Math.PI)).mul(s.pow(eW))),S$e=en(({lightDirection:s})=>{const e=s.add(So).normalize(),t=ha.dot(e).clamp(),n=So.dot(e).clamp(),r=DE({f0:qu,f90:1,dotVH:n}),i=_$e(),a=b$e({dotNH:t});return r.mul(i).mul(a)});class t7e extends e7e{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const i=ha.dot(e).clamp().mul(t);n.directDiffuse.addAssign(i.mul(Yx({diffuseColor:Ki.rgb}))),this.specular===!0&&n.directSpecular.addAssign(i.mul(S$e({lightDirection:e})).mul(ik))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(Yx({diffuseColor:Ki}))),r.indirectDiffuse.mulAssign(t)}}const n7e=en(s=>{const{dotNV:e,specularColor:t,specularF90:n,roughness:r}=s,i=H6e({dotNV:e,roughness:r});return t.mul(i.x).add(n.mul(i.y))}),w$e=en(({roughness:s,dotNH:e})=>{const t=s.pow2(),n=Ut(1).div(t),i=e.pow2().oneMinus().max(.0078125);return Ut(2).add(n).mul(i.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),E$e=en(({dotNV:s,dotNL:e})=>Ut(1).div(Ut(4).mul(e.add(s).sub(e.mul(s))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),T$e=en(({lightDirection:s})=>{const e=s.add(So).normalize(),t=ha.dot(s).clamp(),n=ha.dot(So).clamp(),r=ha.dot(e).clamp(),i=w$e({roughness:w$,dotNH:r}),a=E$e({dotNV:n,dotNL:t});return mx.mul(i).mul(a)}),M$e=en(({N:s,V:e,roughness:t})=>{const i=.0078125,a=s.dot(e).saturate(),c=Sn(t,a.oneMinus().sqrt());return c.assign(c.mul(.984375).add(i)),c}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),C$e=en(({f:s})=>{const e=s.length();return Sl(e.mul(e).add(s.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),SI=en(({v1:s,v2:e})=>{const t=s.dot(e),n=t.abs().toVar(),r=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),i=n.add(4.1616724).mul(n).add(3.417594).toVar(),a=r.div(i),c=t.greaterThan(0).select(a,Sl(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return s.cross(e).mul(c)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),E5e=en(({N:s,V:e,P:t,mInv:n,p0:r,p1:i,p2:a,p3:c})=>{const u=i.sub(r).toVar(),p=c.sub(r).toVar(),y=u.cross(p),x=zt().toVar();return Jo(y.dot(t.sub(r)).greaterThanEqual(0),()=>{const S=e.sub(s.mul(e.dot(s))).normalize(),M=s.cross(S).negate(),I=n.mul(hc(S,M,s).transpose()).toVar(),L=I.mul(r.sub(t)).normalize().toVar(),B=I.mul(i.sub(t)).normalize().toVar(),A=I.mul(a.sub(t)).normalize().toVar(),V=I.mul(c.sub(t)).normalize().toVar(),X=zt(0).toVar();X.addAssign(SI({v1:L,v2:B})),X.addAssign(SI({v1:B,v2:A})),X.addAssign(SI({v1:A,v2:V})),X.addAssign(SI({v1:V,v2:L})),x.assign(zt(C$e({f:X})))}),x}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),T5e=en(([s,e,t,n,r])=>{const i=zt(r6e(e.negate(),IE(s),T1(1,n))),a=zt(Hg(r[0].xyz),Hg(r[1].xyz),Hg(r[2].xyz));return IE(i).mul(t.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),A$e=en(([s,e])=>s.mul(Xg(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),P$e=_6e(),R$e=_6e(),M5e=en(([s,e,t],{material:n})=>{const i=(n.side===eu?P$e:R$e).sample(s),a=jg(nW.x).mul(A$e(e,t));return Qje(i,a)}),C5e=en(([s,e,t])=>(Jo(t.notEqual(0),()=>{const n=qye(e).negate().div(t);return $ye(n.negate().mul(s))}),zt(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),I$e=en(([s,e,t,n,r,i,a,c,u,p,y,x,S,M,I])=>{let L,B;if(I){L=$r().toVar(),B=zt().toVar();const te=y.sub(1).mul(I.mul(.025)),oe=zt(y.sub(te),y,y.add(te));Df({start:0,end:3},({i:ie})=>{const K=oe.element(ie),re=T5e(s,e,x,K,c),se=a.add(re),q=p.mul(u.mul($r(se,1))),De=Sn(q.xy.div(q.w)).toVar();De.addAssign(1),De.divAssign(2),De.assign(Sn(De.x,De.y.oneMinus()));const Be=M5e(De,t,K);L.element(ie).assign(Be.element(ie)),L.a.addAssign(Be.a),B.element(ie).assign(n.element(ie).mul(C5e(Hg(re),S,M).element(ie)))}),L.a.divAssign(3)}else{const te=T5e(s,e,x,y,c),oe=a.add(te),ie=p.mul(u.mul($r(oe,1))),K=Sn(ie.xy.div(ie.w)).toVar();K.addAssign(1),K.divAssign(2),K.assign(Sn(K.x,K.y.oneMinus())),L=M5e(K,t,y),B=n.mul(C5e(Hg(te),S,M))}const A=B.rgb.mul(L.rgb),V=s.dot(e).clamp(),X=zt(n7e({dotNV:V,specularColor:r,specularF90:i,roughness:t})),P=B.r.add(B.g,B.b).div(3);return $r(X.oneMinus().mul(A),L.a.oneMinus().mul(P).oneMinus())}),k$e=hc(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),N$e=s=>{const e=s.sqrt();return zt(1).add(e).div(zt(1).sub(e))},A5e=(s,e)=>s.sub(e).div(s.add(e)).pow2(),D$e=(s,e)=>{const t=s.mul(2*Math.PI*1e-9),n=zt(54856e-17,44201e-17,52481e-17),r=zt(1681e3,1795300,2208400),i=zt(43278e5,93046e5,66121e5),a=Ut(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let c=n.mul(i.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(i).exp());return c=zt(c.x.add(a),c.y,c.z).div(10685e-11),k$e.mul(c)},O$e=en(({outsideIOR:s,eta2:e,cosTheta1:t,thinFilmThickness:n,baseF0:r})=>{const i=Ks(s,e,Y3(0,.03,n)),c=s.div(i).pow2().mul(t.pow2().oneMinus()).oneMinus();Jo(c.lessThan(0),()=>zt(1));const u=c.sqrt(),p=A5e(i,s),y=DE({f0:p,f90:1,dotVH:t}),x=y.oneMinus(),S=i.lessThan(s).select(Math.PI,0),M=Ut(Math.PI).sub(S),I=N$e(r.clamp(0,.9999)),L=A5e(I,i.toVec3()),B=DE({f0:L,f90:1,dotVH:u}),A=zt(I.x.lessThan(i).select(Math.PI,0),I.y.lessThan(i).select(Math.PI,0),I.z.lessThan(i).select(Math.PI,0)),V=i.mul(n,u,2),X=zt(M).add(A),P=y.mul(B).clamp(1e-5,.9999),te=P.sqrt(),oe=x.pow2().mul(B).div(zt(1).sub(P)),K=y.add(oe).toVar(),re=oe.sub(x).toVar();return Df({start:1,end:2,condition:"<=",name:"m"},({m:se})=>{re.mulAssign(te);const q=D$e(Ut(se).mul(V),Ut(se).mul(X)).mul(2);K.addAssign(re.mul(q))}),K.max(zt(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),L$e=en(({normal:s,viewDir:e,roughness:t})=>{const n=s.dot(e).saturate(),r=t.pow2(),i=xl(t.lessThan(.25),Ut(-339.2).mul(r).add(Ut(161.4).mul(t)).sub(25.9),Ut(-8.48).mul(r).add(Ut(14.3).mul(t)).sub(9.95)),a=xl(t.lessThan(.25),Ut(44).mul(r).sub(Ut(23.7).mul(t)).add(3.26),Ut(1.97).mul(r).sub(Ut(3.27).mul(t)).add(.72));return xl(t.lessThan(.25),0,Ut(.1).mul(t).sub(.025)).add(i.mul(n).add(a).exp()).mul(1/Math.PI).saturate()}),XG=zt(.04),YG=Ut(1);class r7e extends hN{constructor(e=!1,t=!1,n=!1,r=!1,i=!1,a=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=r,this.transmission=i,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=zt().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=zt().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=zt().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=zt().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=zt().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=ha.dot(So).clamp();this.iridescenceFresnel=O$e({outsideIOR:Ut(1),eta2:Uye,cosTheta1:t,thinFilmThickness:zye,baseF0:qu}),this.iridescenceF0=wWe({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=kE,n=eGe.sub(kE).normalize(),r=F$,i=e.context;i.backdrop=I$e(r,n,Dg,Ki,qu,Ok,t,Mv,Zg,O$,ek,Vye,jye,Gye,this.dispersion?Hye:null),i.backdropAlpha=tW,Ki.a.mulAssign(Ks(1,i.backdrop.a,tW))}super.start(e)}computeMultiscattering(e,t,n){const r=ha.dot(So).clamp(),i=H6e({roughness:Dg,dotNV:r}),c=(this.iridescenceF0?E$.mix(qu,this.iridescenceF0):qu).mul(i.x).add(n.mul(i.y)),p=i.x.add(i.y).oneMinus(),y=qu.add(qu.oneMinus().mul(.047619)),x=c.mul(y).div(p.mul(y).oneMinus());e.addAssign(c),t.addAssign(x.mul(p))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const i=ha.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(i.mul(T$e({lightDirection:e}))),this.clearcoat===!0){const c=Yw.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(c.mul(g5e({lightDirection:e,f0:XG,f90:YG,roughness:Dk,normalView:Yw})))}n.directDiffuse.addAssign(i.mul(Yx({diffuseColor:Ki.rgb}))),n.directSpecular.addAssign(i.mul(g5e({lightDirection:e,f0:qu,f90:1,roughness:Dg,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:r,reflectedLight:i,ltc_1:a,ltc_2:c}){const u=t.add(n).sub(r),p=t.sub(n).sub(r),y=t.sub(n).add(r),x=t.add(n).add(r),S=ha,M=So,I=fa.toVar(),L=M$e({N:S,V:M,roughness:Dg}),B=a.sample(L).toVar(),A=c.sample(L).toVar(),V=hc(zt(B.x,0,B.y),zt(0,1,0),zt(B.z,0,B.w)).toVar(),X=qu.mul(A.x).add(qu.oneMinus().mul(A.y)).toVar();i.directSpecular.addAssign(e.mul(X).mul(E5e({N:S,V:M,P:I,mInv:V,p0:u,p1:p,p2:y,p3:x}))),i.directDiffuse.addAssign(e.mul(Ki).mul(E5e({N:S,V:M,P:I,mInv:hc(1,0,0,0,1,0,0,0,1),p0:u,p1:p,p2:y,p3:x})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:n}=e.context;n.indirectDiffuse.addAssign(t.mul(Yx({diffuseColor:Ki})))}indirectSpecular(e){const{radiance:t,iblIrradiance:n,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(n.mul(mx,L$e({normal:ha,viewDir:So,roughness:w$}))),this.clearcoat===!0){const y=Yw.dot(So).clamp(),x=n7e({dotNV:y,specularColor:XG,specularF90:YG,roughness:Dk});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(x))}const i=zt().toVar("singleScattering"),a=zt().toVar("multiScattering"),c=n.mul(1/Math.PI);this.computeMultiscattering(i,a,Ok);const u=i.add(a),p=Ki.mul(u.r.max(u.g).max(u.b).oneMinus());r.indirectSpecular.addAssign(t.mul(i)),r.indirectSpecular.addAssign(a.mul(c)),r.indirectDiffuse.addAssign(p.mul(c))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:n}=e.context,i=ha.dot(So).clamp().add(t),a=Dg.mul(-16).oneMinus().negate().exp2(),c=t.sub(i.pow(a).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(c)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const n=Yw.dot(So).clamp(),r=DE({dotVH:n,f0:XG,f90:YG}),i=t.mul(QH.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(QH));t.assign(i)}if(this.sheen===!0){const n=mx.r.max(mx.g).max(mx.b).mul(.157).oneMinus(),r=t.mul(n).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const P5e=new WeakMap,l1=[],X8=[];class F$e extends J3{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new _5e,this.nodeBuilderCache=new Map,this.callHashCache=new Lf,this.groupsData=new Lf,this.cacheLib={}}updateGroup(e){const t=e.groupNode,n=t.name;if(n===Fye.name)return!0;if(n===kr.name){const i=this.get(e),a=this.nodeFrame.renderId;return i.renderId!==a?(i.renderId=a,!0):!1}if(n===cze.name){const i=this.get(e),a=this.nodeFrame.frameId;return i.frameId!==a?(i.frameId=a,!0):!1}l1[0]=t,l1[1]=e;let r=this.groupsData.get(l1);return r===void 0&&this.groupsData.set(l1,r={}),l1.length=0,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:r}=this,i=this.getForRenderCacheKey(e);if(n=r.get(i),n===void 0){const a=this.backend.createNodeBuilder(e.object,this.renderer);a.scene=e.scene,a.material=e.material,a.camera=e.camera,a.context.material=e.material,a.lightsNode=e.lightsNode,a.environmentNode=this.getEnvironmentNode(e.scene),a.fogNode=this.getFogNode(e.scene),a.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&a.enableMultiview(),a.build(),n=this._createNodeBuilderState(a),r.set(i,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new AWe(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){l1[0]=e,l1[1]=t;const n=this.renderer.info.calls,r=this.callHashCache.get(l1)||{};if(r.callId!==n){const i=this.getEnvironmentNode(e),a=this.getFogNode(e);t&&X8.push(t.getCacheKey(!0)),i&&X8.push(i.getCacheKey()),a&&X8.push(a.getCacheKey()),X8.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),X8.push(this.renderer.shadowMap.enabled?1:0),r.callId=n,r.cacheKey=h$(X8),this.callHashCache.set(l1,r),X8.length=0}return l1.length=0,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==n||r){const i=this.getCacheNode("background",n,()=>{if(n.isCubeTexture===!0||n.mapping===r$||n.mapping===i$||n.mapping===IH){if(e.backgroundBlurriness>0||n.mapping===IH)return j6e(n);{let a;return n.isCubeTexture===!0?a=NE(n):a=ji(n),K6e(a)}}else{if(n.isTexture===!0)return ji(n,Px.flipY()).setUpdateMatrix(!0);n.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",n)}},r);t.backgroundNode=i,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,n,r=!1){const i=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let a=i.get(t);return(a===void 0||r)&&(a=n(),i.set(t,a)),a}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){const r=this.getCacheNode("fog",n,()=>{if(n.isFogExp2){const i=Rs("color","color",n).setGroup(kr),a=Rs("density","float",n).setGroup(kr);return e5e(i,vHe(a))}else if(n.isFog){const i=Rs("color","color",n).setGroup(kr),a=Rs("near","float",n).setGroup(kr),c=Rs("far","float",n).setGroup(kr);return e5e(i,gHe(a,c))}else console.error("THREE.Renderer: Unsupported fog configuration.",n)});t.fogNode=r,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){const r=this.getCacheNode("environment",n,()=>{if(n.isCubeTexture===!0)return NE(n);if(n.isTexture===!0)return ji(n);console.error("Nodes: Unsupported environment configuration.",n)});t.environmentNode=r,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,r=null,i=null){const a=this.nodeFrame;return a.renderer=e,a.scene=t,a.object=n,a.camera=r,a.material=i,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return P5e.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),r=e.isArrayTexture?rHe(e,zt(Px,nN("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):ji(e,Px).renderOutput(t.toneMapping,t.currentColorSpace);return P5e.set(e,n),r}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const r of n.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const r of n.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new _5e,this.nodeBuilderCache=new Map,this.cacheLib={}}}const KG=new O3;class Fk{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new nu,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,n){const r=e.length;for(let i=0;i<r;i++){KG.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const a=t[n+i],c=KG.normal;a.x=-c.x,a.y=-c.y,a.z=-c.z,a.w=KG.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,i=r.length;let a,c;if(this.clipIntersection?(a=this.intersectionPlanes,c=e.intersectionPlanes.length):(a=this.unionPlanes,c=e.unionPlanes.length),a.length!==c+i){a.length=c+i;for(let u=0;u<i;u++)a[c+u]=new Ri;n=!0}this.projectPlanes(r,a,c),n&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new Fk(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class B$e{constructor(e,t){this.bundleGroup=e,this.camera=t}}const Pw=[];class U$e{constructor(){this.bundles=new Lf}get(e,t){const n=this.bundles;Pw[0]=e,Pw[1]=t;let r=n.get(Pw);return r===void 0&&(r=new B$e(e,t),n.set(Pw,r)),Pw.length=0,r}dispose(){this.bundles=new Lf}}class i7e{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){t=new n;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}addClass(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}const z$e=new B6e,Rw=[];class V$e extends Lf{constructor(){super()}createNode(e=[]){return new B6e().setLights(e)}getNode(e,t){if(e.isQuadMesh)return z$e;Rw[0]=e,Rw[1]=t;let n=this.get(Rw);return n===void 0&&(n=this.createNode(),this.set(Rw,n)),Rw.length=0,n}}class G$e extends Ku{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class wI extends Aa{constructor(){super(),this.isGroup=!0,this.type="Group"}}const j$e={type:"move"};class H$e{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wI,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wI,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new pt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new pt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wI,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new pt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new pt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const c=this._targetRay,u=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){a=!0;for(const L of e.hand.values()){const B=t.getJointPose(L,n),A=this._getHandJoint(p,L);B!==null&&(A.matrix.fromArray(B.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=B.radius),A.visible=B!==null}const y=p.joints["index-finger-tip"],x=p.joints["thumb-tip"],S=y.position.distanceTo(x.position),M=.02,I=.005;p.inputState.pinching&&S>M+I?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&S<=M-I&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1));c!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&i!==null&&(r=i),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(j$e)))}return c!==null&&(c.visible=r!==null),u!==null&&(u.visible=i!==null),p!==null&&(p.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new wI;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Zw extends Pv{constructor(e=1,t=1,n={}){super(e,t,n),this.isXRRenderTarget=!0,this.hasExternalTextures=!1,this.autoAllocateDepthBuffer=!0}copy(e){return super.copy(e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}class Y$ extends Qg{constructor(e=1,t=1,n=1,r=32,i=1,a=!1,c=0,u=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:c,thetaLength:u};const p=this;r=Math.floor(r),i=Math.floor(i);const y=[],x=[],S=[],M=[];let I=0;const L=[],B=n/2;let A=0;V(),a===!1&&(e>0&&X(!0),t>0&&X(!1)),this.setIndex(y),this.setAttribute("position",new uc(x,3)),this.setAttribute("normal",new uc(S,3)),this.setAttribute("uv",new uc(M,2));function V(){const P=new pt,te=new pt;let oe=0;const ie=(t-e)/n;for(let K=0;K<=i;K++){const re=[],se=K/i,q=se*(t-e)+e;for(let De=0;De<=r;De++){const Be=De/r,tt=Be*u+c,st=Math.sin(tt),de=Math.cos(tt);te.x=q*st,te.y=-se*n+B,te.z=q*de,x.push(te.x,te.y,te.z),P.set(st,ie,de).normalize(),S.push(P.x,P.y,P.z),M.push(Be,1-se),re.push(I++)}L.push(re)}for(let K=0;K<r;K++)for(let re=0;re<i;re++){const se=L[re][K],q=L[re+1][K],De=L[re+1][K+1],Be=L[re][K+1];(e>0||re!==0)&&(y.push(se,q,Be),oe+=3),(t>0||re!==i-1)&&(y.push(q,De,Be),oe+=3)}p.addGroup(A,oe,0),A+=oe}function X(P){const te=I,oe=new ci,ie=new pt;let K=0;const re=P===!0?e:t,se=P===!0?1:-1;for(let De=1;De<=r;De++)x.push(0,B*se,0),S.push(0,se,0),M.push(.5,.5),I++;const q=I;for(let De=0;De<=r;De++){const tt=De/r*u+c,st=Math.cos(tt),de=Math.sin(tt);ie.x=re*de,ie.y=B*se,ie.z=re*st,x.push(ie.x,ie.y,ie.z),S.push(0,se,0),oe.x=st*.5+.5,oe.y=de*.5*se+.5,M.push(oe.x,oe.y),I++}for(let De=0;De<r;De++){const Be=te+De,tt=q+De;P===!0?y.push(tt,tt+1,Be):y.push(tt+1,tt,Be),K+=3}p.addGroup(A,K,P===!0?1:2),A+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Y$(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class K$ extends Qg{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,c=Math.floor(n),u=Math.floor(r),p=c+1,y=u+1,x=e/c,S=t/u,M=[],I=[],L=[],B=[];for(let A=0;A<y;A++){const V=A*S-a;for(let X=0;X<p;X++){const P=X*x-i;I.push(P,-V,0),L.push(0,0,1),B.push(X/c),B.push(1-A/u)}}for(let A=0;A<u;A++)for(let V=0;V<c;V++){const X=V+p*A,P=V+p*(A+1),te=V+1+p*(A+1),oe=V+1+p*A;M.push(X,P,oe),M.push(P,te,oe)}this.setIndex(M),this.setAttribute("position",new uc(I,3)),this.setAttribute("normal",new uc(L,3)),this.setAttribute("uv",new uc(B,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new K$(e.width,e.height,e.widthSegments,e.heightSegments)}}const R5e=new pt,I5e=new pt;class W$e extends Av{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Ku,this._cameraL.viewport=new Ri,this._cameraR=new Ku,this._cameraR.viewport=new Ri,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new G$e,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._frameBufferTargets=null,this._createXRLayer=Z$e.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new ci,this._onSessionEvent=X$e.bind(this),this._onSessionEnd=Y$e.bind(this),this._onInputSourcesChange=K$e.bind(this),this._onAnimationFrame=Q$e.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,n,r,i,a,c,u={}){const p=new K$(e,t),y=new Zw(i,a,{format:nd,type:lc,depthTexture:new w1(i,a,u.stencil?G3:Zo,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?Vg:S1),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});y.autoAllocateDepthBuffer=!0;const x=new U3({color:16777215,side:Bg});x.map=y.texture,x.map.offset.y=1,x.map.repeat.y=-1;const S=new Yg(p,x);S.position.copy(n),S.quaternion.copy(r);const M={type:"quad",width:e,height:t,translation:n,quaternion:r,pixelwidth:i,pixelheight:a,plane:S,material:x,rendercall:c,renderTarget:y};if(this._layers.push(M),this._session!==null){M.plane.material=new U3({color:16777215,side:Bg}),M.plane.material.blending=oE,M.plane.material.blendEquation=Nf,M.plane.material.blendSrc=N3,M.plane.material.blendDst=N3,M.xrlayer=this._createXRLayer(M);const I=this._session.renderState.layers;I.unshift(M.xrlayer),this._session.updateRenderState({layers:I})}else y.isXRRenderTarget=!1;return S}createCylinderLayer(e,t,n,r,i,a,c,u,p={}){const y=new Y$(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),x=new Zw(a,c,{format:nd,type:lc,depthTexture:new w1(a,c,p.stencil?G3:Zo,void 0,void 0,void 0,void 0,void 0,void 0,p.stencil?Vg:S1),stencilBuffer:p.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});x.autoAllocateDepthBuffer=!0;const S=new U3({color:16777215,side:eu});S.map=x.texture,S.map.offset.y=1,S.map.repeat.y=-1;const M=new Yg(y,S);M.position.copy(r),M.quaternion.copy(i);const I={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:r,quaternion:i,pixelwidth:a,pixelheight:c,plane:M,material:S,rendercall:u,renderTarget:x};if(this._layers.push(I),this._session!==null){I.plane.material=new U3({color:16777215,side:eu}),I.plane.material.blending=oE,I.plane.material.blendEquation=Nf,I.plane.material.blendSrc=N3,I.plane.material.blendDst=N3,I.xrlayer=this._createXRLayer(I);const L=this._session.renderState.layers;L.unshift(I.xrlayer),this._session.updateRenderState({layers:L})}else x.isXRRenderTarget=!1;return M}renderLayers(){const e=new pt,t=new i_,n=this._renderer,r=this.isPresenting,i=n.getOutputRenderTarget(),a=n._frameBufferTarget;this.isPresenting=!1;const c=new ci;n.getSize(c);const u=n._quad;for(const p of this._layers)if(p.renderTarget.isXRRenderTarget=this._session!==null,p.renderTarget.hasExternalTextures=p.renderTarget.isXRRenderTarget,p.renderTarget.isXRRenderTarget&&this._supportsLayers){p.xrlayer.transform=new XRRigidTransform(p.plane.getWorldPosition(e),p.plane.getWorldQuaternion(t));const y=this._glBinding.getSubImage(p.xrlayer,this._xrFrame);n.backend.setXRRenderTargetTextures(p.renderTarget,y.colorTexture,void 0),n._setXRLayerSize(p.renderTarget.width,p.renderTarget.height),n.setOutputRenderTarget(p.renderTarget),n.setRenderTarget(null),n._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:x,quad:S}=this._frameBufferTargets.get(p.renderTarget)||{frameBufferTarget:null,quad:null};x?(n._frameBufferTarget=x,n._quad=S):(n._quad=new V$(new pa),this._frameBufferTargets.set(p.renderTarget,{frameBufferTarget:n._getFrameBufferTarget(),quad:n._quad})),p.rendercall(),n._frameBufferTarget=null}else n.setRenderTarget(p.renderTarget),p.rendercall();n.setRenderTarget(null),n.setOutputRenderTarget(i),n._frameBufferTarget=a,n._setXRLayerSize(c.x,c.y),n._quad=u,this.isPresenting=r}getSession(){return this._session}async setSession(e){const t=this._renderer,n=t.backend;this._gl=t.getContext();const r=this._gl,i=r.getContextAttributes();if(this._session=e,e!==null){if(n.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await n.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._useLayers===!0){let a=null,c=null,u=null;t.depth&&(u=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,a=t.stencil?Vg:S1,c=t.stencil?G3:Zo);const p={colorFormat:r.RGBA8,depthFormat:u,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(p.textureType="texture-array",this._useMultiview=!0);const y=new XRWebGLBinding(e,r),x=y.createProjectionLayer(p),S=[x];this._glBinding=y,this._glProjLayer=x,t.setPixelRatio(1),t._setXRLayerSize(x.textureWidth,x.textureHeight);const M=this._useMultiview?2:1,I=new w1(x.textureWidth,x.textureHeight,c,void 0,void 0,void 0,void 0,void 0,void 0,a,M);if(this._xrRenderTarget=new Zw(x.textureWidth,x.textureHeight,{format:nd,type:lc,colorSpace:t.outputColorSpace,depthTexture:I,stencilBuffer:t.stencil,samples:i.antialias?4:0,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget.hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const L of this._layers)L.plane.material=new U3({color:16777215,side:L.type==="cylinder"?eu:Bg}),L.plane.material.blending=oE,L.plane.material.blendEquation=Nf,L.plane.material.blendSrc=N3,L.plane.material.blendDst=N3,L.xrlayer=this._createXRLayer(L),S.unshift(L.xrlayer);e.updateRenderState({layers:S})}else{const a={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},c=new XRWebGLLayer(e,r,a);this._glBaseLayer=c,e.updateRenderState({baseLayer:c}),t.setPixelRatio(1),t._setXRLayerSize(c.framebufferWidth,c.framebufferHeight),this._xrRenderTarget=new Zw(c.framebufferWidth,c.framebufferHeight,{format:nd,type:lc,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:c.ignoreDepthValues===!1,resolveStencilBuffer:c.ignoreDepthValues===!1}),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const n=e.near,r=e.far,i=this._cameraXR,a=this._cameraL,c=this._cameraR;i.near=c.near=a.near=n,i.far=c.far=a.far=r,i.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==i.near||this._currentDepthFar!==i.far)&&(t.updateRenderState({depthNear:i.near,depthFar:i.far}),this._currentDepthNear=i.near,this._currentDepthFar=i.far),a.layers.mask=e.layers.mask|2,c.layers.mask=e.layers.mask|4,i.layers.mask=a.layers.mask|c.layers.mask;const u=e.parent,p=i.cameras;k5e(i,u);for(let y=0;y<p.length;y++)k5e(p[y],u);p.length===2?$$e(i,a,c):i.projectionMatrix.copy(a.projectionMatrix),q$e(e,i,u)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new H$e,this._controllers[e]=t),t}}function $$e(s,e,t){R5e.setFromMatrixPosition(e.matrixWorld),I5e.setFromMatrixPosition(t.matrixWorld);const n=R5e.distanceTo(I5e),r=e.projectionMatrix.elements,i=t.projectionMatrix.elements,a=r[14]/(r[10]-1),c=r[14]/(r[10]+1),u=(r[9]+1)/r[5],p=(r[9]-1)/r[5],y=(r[8]-1)/r[0],x=(i[8]+1)/i[0],S=a*y,M=a*x,I=n/(-y+x),L=I*-y;if(e.matrixWorld.decompose(s.position,s.quaternion,s.scale),s.translateX(L),s.translateZ(I),s.matrixWorld.compose(s.position,s.quaternion,s.scale),s.matrixWorldInverse.copy(s.matrixWorld).invert(),r[10]===-1)s.projectionMatrix.copy(e.projectionMatrix),s.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const B=a+I,A=c+I,V=S-L,X=M+(n-L),P=u*c/A*B,te=p*c/A*B;s.projectionMatrix.makePerspective(V,X,P,te,B,A),s.projectionMatrixInverse.copy(s.projectionMatrix).invert()}}function k5e(s,e){e===null?s.matrixWorld.copy(s.matrix):s.matrixWorld.multiplyMatrices(e.matrixWorld,s.matrix),s.matrixWorldInverse.copy(s.matrixWorld).invert()}function q$e(s,e,t){t===null?s.matrix.copy(e.matrixWorld):(s.matrix.copy(t.matrixWorld),s.matrix.invert(),s.matrix.multiply(e.matrixWorld)),s.matrix.decompose(s.position,s.quaternion,s.scale),s.updateMatrixWorld(!0),s.projectionMatrix.copy(e.projectionMatrix),s.projectionMatrixInverse.copy(e.projectionMatrixInverse),s.isPerspectiveCamera&&(s.fov=Gx*2*Math.atan(1/s.projectionMatrix.elements[5]),s.zoom=1)}function X$e(s){const e=this._controllerInputSources.indexOf(s.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const n=this.getReferenceSpace();t.update(s.inputSource,s.frame,n),t.dispatchEvent({type:s.type,data:s.inputSource})}}function Y$e(){const s=this._session,e=this._renderer;s.removeEventListener("select",this._onSessionEvent),s.removeEventListener("selectstart",this._onSessionEvent),s.removeEventListener("selectend",this._onSessionEvent),s.removeEventListener("squeeze",this._onSessionEvent),s.removeEventListener("squeezestart",this._onSessionEvent),s.removeEventListener("squeezeend",this._onSessionEvent),s.removeEventListener("end",this._onSessionEnd),s.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const n=this._controllerInputSources[t];n!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(n))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const t of this._layers)t.renderTarget=new Zw(t.pixelwidth,t.pixelheight,{format:nd,type:lc,depthTexture:new w1(t.pixelwidth,t.pixelheight,t.stencilBuffer?G3:Zo,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?Vg:S1),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function K$e(s){const e=this._controllers,t=this._controllerInputSources;for(let n=0;n<s.removed.length;n++){const r=s.removed[n],i=t.indexOf(r);i>=0&&(t[i]=null,e[i].disconnect(r))}for(let n=0;n<s.added.length;n++){const r=s.added[n];let i=t.indexOf(r);if(i===-1){for(let c=0;c<e.length;c++)if(c>=t.length){t.push(r),i=c;break}else if(t[c]===null){t[c]=r,i=c;break}if(i===-1)break}const a=e[i];a&&a.connect(r)}}function Z$e(s){return s.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(s.translation,s.quaternion),width:s.width/2,height:s.height/2,space:this._referenceSpace,viewPixelWidth:s.pixelwidth,viewPixelHeight:s.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(s.translation,s.quaternion),radius:s.radius,centralAngle:s.centralAngle,aspectRatio:s.aspectRatio,space:this._referenceSpace,viewPixelWidth:s.pixelwidth,viewPixelHeight:s.pixelheight,clearOnAccess:!1})}function Q$e(s,e){if(e===void 0)return;const t=this._cameraXR,n=this._renderer,r=n.backend,i=this._glBaseLayer,a=this.getReferenceSpace(),c=e.getViewerPose(a);if(this._xrFrame=e,c!==null){const u=c.views;this._glBaseLayer!==null&&r.setXRTarget(i.framebuffer);let p=!1;u.length!==t.cameras.length&&(t.cameras.length=0,p=!0);for(let y=0;y<u.length;y++){const x=u[y];let S;if(this._useLayers===!0){const I=this._glBinding.getViewSubImage(this._glProjLayer,x);S=I.viewport,y===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,I.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:I.depthStencilTexture)}else S=i.getViewport(x);let M=this._cameras[y];M===void 0&&(M=new Ku,M.layers.enable(y),M.viewport=new Ri,this._cameras[y]=M),M.matrix.fromArray(x.transform.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale),M.projectionMatrix.fromArray(x.projectionMatrix),M.projectionMatrixInverse.copy(M.projectionMatrix).invert(),M.viewport.set(S.x,S.y,S.width,S.height),y===0&&(t.matrix.copy(M.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),p===!0&&t.cameras.push(M)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let u=0;u<this._controllers.length;u++){const p=this._controllerInputSources[u],y=this._controllers[u];p!==null&&y!==void 0&&y.update(p,e,a)}this._currentAnimationLoop&&this._currentAnimationLoop(s,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const Y8=new tN,EI=new pt;class Z${constructor(e=new O3,t=new O3,n=new O3,r=new O3,i=new O3,a=new O3){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(i),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Zc){const n=this.planes,r=e.elements,i=r[0],a=r[1],c=r[2],u=r[3],p=r[4],y=r[5],x=r[6],S=r[7],M=r[8],I=r[9],L=r[10],B=r[11],A=r[12],V=r[13],X=r[14],P=r[15];if(n[0].setComponents(u-i,S-p,B-M,P-A).normalize(),n[1].setComponents(u+i,S+p,B+M,P+A).normalize(),n[2].setComponents(u+a,S+y,B+I,P+V).normalize(),n[3].setComponents(u-a,S-y,B-I,P-V).normalize(),n[4].setComponents(u-c,S-x,B-L,P-X).normalize(),t===Zc)n[5].setComponents(u+c,S+x,B+L,P+X).normalize();else if(t===X3)n[5].setComponents(c,x,L,X).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Y8.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Y8.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Y8)}intersectsSprite(e){return Y8.center.set(0,0,0),Y8.radius=.7071067811865476,Y8.applyMatrix4(e.matrixWorld),this.intersectsSphere(Y8)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(EI.x=r.normal.x>0?e.max.x:e.min.x,EI.y=r.normal.y>0?e.max.y:e.min.y,EI.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(EI)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const c1=new Is,u1=new Z$;class Q${constructor(){this.coordinateSystem=Zc}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(c1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),u1.setFromProjectionMatrix(c1,this.coordinateSystem),u1.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(c1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),u1.setFromProjectionMatrix(c1,this.coordinateSystem),u1.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(c1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),u1.setFromProjectionMatrix(c1,this.coordinateSystem),u1.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(c1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),u1.setFromProjectionMatrix(c1,this.coordinateSystem),u1.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(c1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),u1.setFromProjectionMatrix(c1,this.coordinateSystem),u1.containsPoint(e))return!0}return!1}clone(){return new Q$}}const N5e=new d$,TI=new ci,ZG=new Ri,QG=new Z$,JG=new Q$,MI=new Is,M3=new Ri;class J$e{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:r=!0,depth:i=!0,stencil:a=!1,antialias:c=!1,samples:u=0,getFallback:p=null,colorBufferType:y=td,multiview:x=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=u||c===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=n,this.outputColorSpace=Yu,this.toneMapping=wx,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=i,this.stencil=a,this.info=new nUe,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new i7e,this.lighting=new V$e,this._getFallback=p,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Ri(0,0,this._width,this._height),this._scissor=new Ri(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new V$(new pa),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const S=this.alpha===!0?0:1;this._clearColor=new m$(0,0,0,S),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=y,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:oBe},this.xr=new W$e(this,x),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(M,I,L)=>{await this.compileAsync(M,I);const B=this._renderLists.get(M,I),A=this._renderContexts.get(M,I,this._renderTarget),V=M.overrideMaterial||L.material,X=this._objects.get(L,V,M,I,B.lightsNode,A,A.clippingContext),{fragmentShader:P,vertexShader:te}=X.getNodeBuilderState();return{fragmentShader:P,vertexShader:te}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=n=this._getFallback(r),await n.init(this)}catch(i){t(i);return}else{t(r);return}}this._nodes=new F$e(this,n),this._animation=new VFe(this._nodes,this.info),this._attributes=new QBe(n),this._background=new MWe(this,this._nodes),this._geometries=new tUe(this._attributes,this.info),this._textures=new TUe(this,n,this.info),this._pipelines=new oUe(n,this._nodes),this._bindings=new aUe(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new YBe(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new uUe(this.lighting),this._bundles=new U$e,this._renderContexts=new _Ue,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,i=r.renderId,a=this._currentRenderContext,c=this._currentRenderObjectFunction,u=this._compilationPromises,p=e.isScene===!0?e:N5e;n===null&&(n=e);const y=this._renderTarget,x=this._renderContexts.get(n,t,y),S=this._activeMipmapLevel,M=[];this._currentRenderContext=x,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=M,r.renderId++,r.update(),x.depth=this.depth,x.stencil=this.stencil,x.clippingContext||(x.clippingContext=new Fk),x.clippingContext.updateGlobal(p,t),p.onBeforeRender(this,e,t,y);const I=this._renderLists.get(e,t);if(I.begin(),this._projectObject(e,t,0,I,x.clippingContext),n!==e&&n.traverseVisible(function(X){X.isLight&&X.layers.test(t.layers)&&I.pushLight(X)}),I.finish(),y!==null){this._textures.updateRenderTarget(y,S);const X=this._textures.get(y);x.textures=X.textures,x.depthTexture=X.depthTexture}else x.textures=null,x.depthTexture=null;this._background.update(p,I,x);const L=I.opaque,B=I.transparent,A=I.transparentDoublePass,V=I.lightsNode;this.opaque===!0&&L.length>0&&this._renderObjects(L,t,p,V),this.transparent===!0&&B.length>0&&this._renderTransparents(B,A,t,p,V),r.renderId=i,this._currentRenderContext=a,this._currentRenderObjectFunction=c,this._compilationPromises=u,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(M)}async renderAsync(e,t){this._initialized===!1&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=I4e,this.overrideNodes.modelNormalViewMatrix=k4e):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===I4e&&this.overrideNodes.modelNormalViewMatrix===k4e}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:r,camera:i,renderList:a}=e,c=this._currentRenderContext,u=this._bundles.get(r,i),p=this.backend.get(u);p.renderContexts===void 0&&(p.renderContexts=new Set);const y=r.version!==p.version,x=p.renderContexts.has(c)===!1||y;if(p.renderContexts.add(c),x){this.backend.beginBundle(c),(p.renderObjects===void 0||y)&&(p.renderObjects=[]),this._currentRenderBundle=u;const{transparentDoublePass:S,transparent:M,opaque:I}=a;this.opaque===!0&&I.length>0&&this._renderObjects(I,i,t,n),this.transparent===!0&&M.length>0&&this._renderTransparents(M,S,i,t,n),this._currentRenderBundle=null,this.backend.finishBundle(c,u),p.version=r.version}else{const{renderObjects:S}=p;for(let M=0,I=S.length;M<I;M++){const L=S[M];this._nodes.needsRefresh(L)&&(this._nodes.updateBefore(L),this._nodes.updateForRender(L),this._bindings.updateForRender(L),this._nodes.updateAfter(L))}}this.backend.addBundle(c,u)}render(e,t){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(e!==wx===!1&&t!==Ex===!1)return null;const{width:i,height:a}=this.getDrawingBufferSize(TI),{depth:c,stencil:u}=this;let p=this._frameBufferTarget;p===null&&(p=new Pv(i,a,{depthBuffer:c,stencilBuffer:u,type:this._colorBufferType,format:nd,colorSpace:Ex,generateMipmaps:!1,minFilter:th,magFilter:th,samples:this.samples}),p.isPostProcessingRenderTarget=!0,this._frameBufferTarget=p);const y=this.getOutputRenderTarget();return p.depthBuffer=c,p.stencilBuffer=u,y!==null?p.setSize(y.width,y.height,y.depth):p.setSize(i,a,1),p.viewport.copy(this._viewport),p.scissor.copy(this._scissor),p.viewport.multiplyScalar(this._pixelRatio),p.scissor.multiplyScalar(this._pixelRatio),p.scissorTest=this._scissorTest,p.multiview=y!==null?y.multiview:!1,p.resolveDepthBuffer=y!==null?y.resolveDepthBuffer:!0,p.autoAllocateDepthBuffer=y!==null?y.autoAllocateDepthBuffer:!1,p}_renderScene(e,t,n=!0){if(this._isDeviceLost===!0)return;const r=n?this._getFrameBufferTarget():null,i=this._nodes.nodeFrame,a=i.renderId,c=this._currentRenderContext,u=this._currentRenderObjectFunction,p=e.isScene===!0?e:N5e,y=this._renderTarget||this._outputRenderTarget,x=this._activeCubeFace,S=this._activeMipmapLevel;let M;r!==null?(M=r,this.setRenderTarget(M)):M=y;const I=this._renderContexts.get(e,t,M);this._currentRenderContext=I,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,i.renderId=this.info.calls;const L=this.coordinateSystem,B=this.xr;if(t.coordinateSystem!==L&&B.isPresenting===!1&&(t.coordinateSystem=L,t.updateProjectionMatrix(),t.isArrayCamera))for(const Be of t.cameras)Be.coordinateSystem=L,Be.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),B.enabled===!0&&B.isPresenting===!0&&(B.cameraAutoUpdate===!0&&B.updateCamera(t),t=B.getCamera());let A=this._viewport,V=this._scissor,X=this._pixelRatio;M!==null&&(A=M.viewport,V=M.scissor,X=1),this.getDrawingBufferSize(TI),ZG.set(0,0,TI.width,TI.height);const P=A.minDepth===void 0?0:A.minDepth,te=A.maxDepth===void 0?1:A.maxDepth;I.viewportValue.copy(A).multiplyScalar(X).floor(),I.viewportValue.width>>=S,I.viewportValue.height>>=S,I.viewportValue.minDepth=P,I.viewportValue.maxDepth=te,I.viewport=I.viewportValue.equals(ZG)===!1,I.scissorValue.copy(V).multiplyScalar(X).floor(),I.scissor=this._scissorTest&&I.scissorValue.equals(ZG)===!1,I.scissorValue.width>>=S,I.scissorValue.height>>=S,I.clippingContext||(I.clippingContext=new Fk),I.clippingContext.updateGlobal(p,t),p.onBeforeRender(this,e,t,M);const oe=t.isArrayCamera?JG:QG;t.isArrayCamera||(MI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),oe.setFromProjectionMatrix(MI,L));const ie=this._renderLists.get(e,t);if(ie.begin(),this._projectObject(e,t,0,ie,I.clippingContext),ie.finish(),this.sortObjects===!0&&ie.sort(this._opaqueSort,this._transparentSort),M!==null){this._textures.updateRenderTarget(M,S);const Be=this._textures.get(M);I.textures=Be.textures,I.depthTexture=Be.depthTexture,I.width=Be.width,I.height=Be.height,I.renderTarget=M,I.depth=M.depthBuffer,I.stencil=M.stencilBuffer}else I.textures=null,I.depthTexture=null,I.width=this.domElement.width,I.height=this.domElement.height,I.depth=this.depth,I.stencil=this.stencil;I.width>>=S,I.height>>=S,I.activeCubeFace=x,I.activeMipmapLevel=S,I.occlusionQueryCount=ie.occlusionQueryCount,this._background.update(p,ie,I),I.camera=t,this.backend.beginRender(I);const{bundles:K,lightsNode:re,transparentDoublePass:se,transparent:q,opaque:De}=ie;return K.length>0&&this._renderBundles(K,p,re),this.opaque===!0&&De.length>0&&this._renderObjects(De,t,p,re),this.transparent===!0&&q.length>0&&this._renderTransparents(q,se,t,p,re),this.backend.finishRender(I),i.renderId=a,this._currentRenderContext=c,this._currentRenderObjectFunction=u,r!==null&&(this.setRenderTarget(y,x,S),this._renderOutput(M)),p.onAfterRender(this,e,t,M),I}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const n=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,r){const i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,n,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,r,i=0,a=1){const c=this._viewport;e.isVector4?c.copy(e):c.set(e,t,n,r),c.minDepth=i,c.maxDepth=a}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,n);const r=this._renderTarget||this._getFrameBufferTarget();let i=null;if(r!==null){this._textures.updateRenderTarget(r);const a=this._textures.get(r);i=this._renderContexts.getForClear(r),i.textures=a.textures,i.depthTexture=a.depthTexture,i.width=a.width,i.height=a.height,i.renderTarget=r,i.depth=r.depthBuffer,i.stencil=r.stencilBuffer,i.clearColorValue=this.backend.getClearColor(),i.activeCubeFace=this.getActiveCubeFace(),i.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,i),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){this._initialized===!1&&await this.init(),this.clear(e,t,n)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:wx}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Ex}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,n=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,i=this._pipelines,a=this._bindings,c=this._nodes,u=Array.isArray(e)?e:[e];if(u[0]===void 0||u[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const p of u){if(i.has(p)===!1){const S=()=>{p.removeEventListener("dispose",S),i.delete(p),a.delete(p),c.delete(p)};p.addEventListener("dispose",S);const M=p.onInitFunction;M!==null&&M.call(p,{renderer:this})}c.updateForCompute(p),a.updateForCompute(p);const y=a.getForCompute(p),x=i.getForCompute(p,y);r.compute(e,p,y,x)}r.finishCompute(e),t.renderId=n}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=M3.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=M3.copy(t).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=M3.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,r;n!==null?r=n.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),n=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,n,t)}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,i,a)}async readRenderTargetPixelsAsync(e,t,n,r,i,a=0,c=0){return this.backend.copyTextureToBuffer(e.textures[a],t,n,r,i,c)}_projectObject(e,t,n,r,i){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(i=i.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const u=t.isArrayCamera?JG:QG;if(!e.frustumCulled||u.intersectsSprite(e,t)){this.sortObjects===!0&&M3.setFromMatrixPosition(e.matrixWorld).applyMatrix4(MI);const{geometry:p,material:y}=e;y.visible&&r.push(e,p,y,n,M3.z,null,i)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const u=t.isArrayCamera?JG:QG;if(!e.frustumCulled||u.intersectsObject(e,t)){const{geometry:p,material:y}=e;if(this.sortObjects===!0&&(p.boundingSphere===null&&p.computeBoundingSphere(),M3.copy(p.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(MI)),Array.isArray(y)){const x=p.groups;for(let S=0,M=x.length;S<M;S++){const I=x[S],L=y[I.materialIndex];L&&L.visible&&r.push(e,p,L,n,M3.z,I,i)}}else y.visible&&r.push(e,p,y,n,M3.z,null,i)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const u=r;r=this._renderLists.get(e,t),r.begin(),u.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const c=e.children;for(let u=0,p=c.length;u<p;u++)this._projectObject(c[u],t,n,r,i)}_renderBundles(e,t,n){for(const r of e)this._renderBundle(r,t,n)}_renderTransparents(e,t,n,r,i){if(t.length>0){for(const{material:a}of t)a.side=eu;this._renderObjects(t,n,r,i,"backSide");for(const{material:a}of t)a.side=Bg;this._renderObjects(e,n,r,i);for(const{material:a}of t)a.side=Sx}else this._renderObjects(e,n,r,i)}_renderObjects(e,t,n,r,i=null){for(let a=0,c=e.length;a<c;a++){const{object:u,geometry:p,material:y,group:x,clippingContext:S}=e[a];this._currentRenderObjectFunction(u,n,t,p,y,x,r,S,i)}}renderObject(e,t,n,r,i,a,c,u=null,p=null){let y,x,S;if(e.onBeforeRender(this,t,n,r,i,a),i.allowOverride===!0&&t.overrideMaterial!==null){const M=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(y=M.positionNode,M.positionNode=i.positionNode),M.alphaTest=i.alphaTest,M.alphaMap=i.alphaMap,M.transparent=i.transparent||i.transmission>0,M.isShadowPassMaterial&&(M.side=i.shadowSide===null?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(S=M.depthNode,M.depthNode=i.depthNode),i.castShadowNode&&i.castShadowNode.isNode&&(x=M.colorNode,M.colorNode=i.castShadowNode),i.castShadowPositionNode&&i.castShadowPositionNode.isNode&&(y=M.positionNode,M.positionNode=i.castShadowPositionNode)),i=M}i.transparent===!0&&i.side===Sx&&i.forceSinglePass===!1?(i.side=eu,this._handleObjectFunction(e,i,t,n,c,a,u,"backSide"),i.side=Bg,this._handleObjectFunction(e,i,t,n,c,a,u,p),i.side=Sx):this._handleObjectFunction(e,i,t,n,c,a,u,p),y!==void 0&&(t.overrideMaterial.positionNode=y),S!==void 0&&(t.overrideMaterial.depthNode=S),x!==void 0&&(t.overrideMaterial.colorNode=x),e.onAfterRender(this,t,n,r,i,a)}_renderObjectDirect(e,t,n,r,i,a,c,u){const p=this._objects.get(e,t,n,r,i,this._currentRenderContext,c,u);p.drawRange=e.geometry.drawRange,p.group=a;const y=this._nodes.needsRefresh(p);y&&(this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p)),this._pipelines.updateForRender(p),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(p),p.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(p,this.info),y&&this._nodes.updateAfter(p)}_createObjectPipeline(e,t,n,r,i,a,c,u){const p=this._objects.get(e,t,n,r,i,this._currentRenderContext,c,u);p.drawRange=e.geometry.drawRange,p.group=a,this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p),this._pipelines.getForRender(p,this._compilationPromises),this._nodes.updateAfter(p)}get compile(){return this.compileAsync}}class J${constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function eqe(s){return s+(F3-s%F3)%F3}class s7e extends J${constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return eqe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class o7e extends s7e{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let tqe=0;class a7e extends o7e{constructor(e,t){super("UniformBuffer_"+tqe++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class nqe extends o7e{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let n=0,r=this.uniforms.length;n<r;n++){const i=this.uniforms[n],a=i.boundary,c=i.itemSize*e,u=t%F3,p=u%a,y=u+p;t+=p,y!==0&&F3-y<c&&(t+=F3-y),i.offset=t/e,t+=c}return Math.ceil(t/F3)*F3}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i]!==r){const c=this._getBufferForType(a);c[i]=n[i]=r,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y){const c=this._getBufferForType(a);c[i+0]=n[i+0]=r.x,c[i+1]=n[i+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z){const c=this._getBufferForType(a);c[i+0]=n[i+0]=r.x,c[i+1]=n[i+1]=r.y,c[i+2]=n[i+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z||n[i+4]!==r.w){const c=this._getBufferForType(a);c[i+0]=n[i+0]=r.x,c[i+1]=n[i+1]=r.y,c[i+2]=n[i+2]=r.z,c[i+3]=n[i+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.r||n[i+1]!==r.g||n[i+2]!==r.b){const a=this.buffer;a[i+0]=n[i+0]=r.r,a[i+1]=n[i+1]=r.g,a[i+2]=n[i+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;if(n[i+0]!==r[0]||n[i+1]!==r[1]||n[i+2]!==r[2]||n[i+4]!==r[3]||n[i+5]!==r[4]||n[i+6]!==r[5]||n[i+8]!==r[6]||n[i+9]!==r[7]||n[i+10]!==r[8]){const a=this.buffer;a[i+0]=n[i+0]=r[0],a[i+1]=n[i+1]=r[1],a[i+2]=n[i+2]=r[2],a[i+4]=n[i+4]=r[3],a[i+5]=n[i+5]=r[4],a[i+6]=n[i+6]=r[5],a[i+8]=n[i+8]=r[6],a[i+9]=n[i+9]=r[7],a[i+10]=n[i+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;return iqe(n,r,i)===!1&&(this.buffer.set(r,i),rqe(n,r,i),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function rqe(s,e,t){for(let n=0,r=e.length;n<r;n++)s[t+n]=e[n]}function iqe(s,e,t){for(let n=0,r=e.length;n<r;n++)if(s[t+n]!==e[n])return!1;return!0}let sqe=0;class l7e extends nqe{constructor(e,t){super(e),this.id=sqe++,this.groupNode=t,this.isNodeUniformsGroup=!0}}let oqe=0;class aqe extends J${constructor(e,t){super(e),this.id=oqe++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}}class dN extends aqe{constructor(e,t,n,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class c7e extends dN{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledCubeTexture=!0}}class u7e extends dN{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledTexture3D=!0}}class lqe extends _l{constructor(e=null,t=1,n=1,r,i,a,c,u,p=Ca,y=Ca,x,S){super(null,a,c,u,p,y,r,i,x,S),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const cqe={textureDimensions:"textureSize",equals:"equal"},uqe={low:"lowp",medium:"mediump",high:"highp"},D5e={swizzleAssign:!0,storageBuffer:!1},O5e={perspective:"smooth",linear:"noperspective"},L5e={centroid:"centroid","flat first":"flat","flat either":"flat"},F5e=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class hqe extends Q6e{constructor(e,t){super(e,t,new x$e),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==$g}getMethod(e){return cqe[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(this.getType(a.type)+" "+a.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const n=t.array,r=t.count*t.itemSize,{itemSize:i}=t,a=t.array.constructor.name.toLowerCase().includes("int");let c=a?a$:o$;i===2?c=a?l$:yv:i===3?c=a?_Be:s$:i===4&&(c=a?c$:nd);const u={Float32Array:Zu,Uint8Array:lc,Uint16Array:dx,Uint32Array:Zo,Int8Array:aE,Int16Array:lE,Int32Array:sc,Uint8ClampedArray:lc},p=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/i))));let y=Math.ceil(r/i/p);p*y*i<r&&y++;const x=p*y*i,S=new n.constructor(x);S.set(n,0),t.array=S;const M=new lqe(t.array,p,y,c,u[t.array.constructor.name]||Zu);M.needsUpdate=!0,M.isPBOTexture=!0;const I=new o_(M,null,null);I.setPrecision("high"),t.pboNode=I,t.pbo=I.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,r=t.value;if(this.renderer.backend.has(r)){const y=this.renderer.backend.get(r);y.pbo=r.pbo}const i=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),a=this.getPropertyName(i);this.increaseUsage(n);const c=n.build(this,"uint"),u=this.getDataFromNode(e);let p=u.propertyName;if(p===void 0){const y=this.getVarFromNode(e);p=this.getPropertyName(y);const x=this.getDataFromNode(t);let S=x.propertySizeName;S===void 0&&(S=p+"Size",this.getVarFromNode(t,S,"uint"),this.addLineFlowCode(`${S} = uint( textureSize( ${a}, 0 ).x )`,e),x.propertySizeName=S);const{itemSize:M}=r,I="."+s_.join("").slice(0,M),L=`ivec2(${c} % ${S}, ${c} / ${S})`,B=this.generateTextureLoad(null,a,L,null,"0");let A="vec4";r.pbo.type===Zo?A="uvec4":r.pbo.type===sc&&(A="ivec4"),this.addLineFlowCode(`${p} = ${A}(${B})${I}`,e),u.propertyName=p}return p}generateTextureLoad(e,t,n,r,i="0"){return r?`texelFetch( ${t}, ivec3( ${n}, ${r} ), ${i} )`:`texelFetch( ${t}, ${n}, ${i} )`}generateTexture(e,t,n,r){return e.isDepthTexture?(r&&(n=`vec4( ${n}, ${r} )`),`texture( ${t}, ${n} ).x`):(r&&(n=`vec3( ${n}, ${r} )`),`texture( ${t}, ${n} )`)}generateTextureLevel(e,t,n,r){return`textureLod( ${t}, ${n}, ${r} )`}generateTextureBias(e,t,n,r){return`texture( ${t}, ${n}, ${r} )`}generateTextureGrad(e,t,n,r){return`textureGrad( ${t}, ${n}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return i?`texture( ${t}, vec4( ${n}, ${i}, ${r} ) )`:`texture( ${t}, vec3( ${n}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],n=[],r={};for(const a of t){let c=null,u=!1;if(a.type==="texture"||a.type==="texture3D"){const y=a.node.value;let x="";(y.isDataTexture===!0||y.isData3DTexture===!0)&&(y.type===Zo?x="u":y.type===sc&&(x="i")),a.type==="texture3D"&&y.isArrayTexture===!1?c=`${x}sampler3D ${a.name};`:y.compareFunction?y.isArrayTexture===!0?c=`sampler2DArrayShadow ${a.name};`:c=`sampler2DShadow ${a.name};`:y.isArrayTexture===!0||y.isDataArrayTexture===!0||y.isCompressedArrayTexture===!0?c=`${x}sampler2DArray ${a.name};`:c=`${x}sampler2D ${a.name};`}else if(a.type==="cubeTexture")c=`samplerCube ${a.name};`;else if(a.type==="buffer"){const y=a.node,x=this.getType(y.bufferType),S=y.bufferCount,M=S>0?S:"";c=`${y.name} {
	${x} ${a.name}[${M}];
};
`}else c=`${this.getVectorType(a.type)} ${this.getPropertyName(a,e)};`,u=!0;const p=a.node.precision;if(p!==null&&(c=uqe[p]+" "+c),u){c="	"+c;const y=a.groupNode.name;(r[y]||(r[y]=[])).push(c)}else c="uniform "+c,n.push(c)}let i="";for(const a in r){const c=r[a];i+=this._getGLSLUniformStruct(e+"_"+a,c.join(`
`))+`
`}return i+=n.join(`
`),i}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==sc){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let r=0;for(const i of n)t+=`layout( location = ${r++} ) in ${i.type} ${i.name};
`}return t}getStructMembers(e){const t=[];for(const n of e.members)t.push(`	${n.type} ${n.name};`);return t.join(`
`)}getStructs(e){const t=[],n=this.structs[e],r=[];for(const i of n)if(i.output)for(const a of i.members)r.push(`layout( location = ${a.index} ) out ${a.type} ${a.name};`);else{let a="struct "+i.name+` {
`;a+=this.getStructMembers(i),a+=`
};
`,t.push(a)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const r of n){e==="compute"&&(r.needsInterpolation=!0);const i=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const a=O5e[r.interpolationType]||r.interpolationType,c=L5e[r.interpolationSampling]||"";t+=`${a} ${c} out ${i} ${r.name};
`}else{const a=i.includes("int")||i.includes("uv")||i.includes("iv")?"flat ":"";t+=`${a}out ${i} ${r.name};
`}else t+=`${i} ${r.name};
`}else if(e==="fragment"){for(const r of n)if(r.needsInterpolation){const i=this.getType(r.type);if(r.interpolationType){const a=O5e[r.interpolationType]||r.interpolationType,c=L5e[r.interpolationSampling]||"";t+=`${a} ${c} in ${i} ${r.name};
`}else{const a=i.includes("int")||i.includes("uv")||i.includes("iv")?"flat ":"";t+=`${a}in ${i} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((n,r)=>n*r,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const r=this.extensions[n]||(this.extensions[n]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:r,behavior:i}of n.values())t.push(`#extension ${r} : ${i}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=D5e[e];if(t===void 0){let n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance";break}if(n!==void 0){const r=this.renderer.backend.extensions;r.has(n)&&(r.get(n),t=!0)}D5e[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const r=e[n],i=this.getPropertyName(r.attributeNode);i&&(t+=`${r.varyingName} = ${i};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${F5e}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${F5e}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n=`// code

`;n+=this.flowCode[t];const r=this.flowNodes[t],i=r[r.length-1];for(const c of r){const u=this.getFlowData(c),p=c.name;p&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${p}
	`),n+=`${u.code}
	`,c===i&&t!=="compute"&&(n+=`// result
	`,t==="vertex"?(n+="gl_Position = ",n+=`${u.result};`):t==="fragment"&&(c.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${u.result};`)))}const a=e[t];a.extensions=this.getExtensions(t),a.uniforms=this.getUniforms(t),a.attributes=this.getAttributes(t),a.varyings=this.getVaryings(t),a.vars=this.getVars(t),a.structs=this.getStructs(t),a.codes=this.getCodes(t),a.transforms=this.getTransforms(t),a.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);let c=a.uniformGPU;if(c===void 0){const u=e.groupNode,p=u.name,y=this.getBindGroupArray(p,n);if(t==="texture")c=new dN(i.name,i.node,u),y.push(c);else if(t==="cubeTexture")c=new c7e(i.name,i.node,u),y.push(c);else if(t==="texture3D")c=new u7e(i.name,i.node,u),y.push(c);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,i.name=`buffer${e.id}`;const x=new a7e(e,u);x.name=e.name,y.push(x),c=x}else{const x=this.uniformGroups[n]||(this.uniformGroups[n]={});let S=x[p];S===void 0&&(S=new l7e(n+"_"+p,u),x[p]=S,y.push(S)),c=this.getNodeUniform(i,t),S.addUniform(c)}a.uniformGPU=c}return i}}let ej=null,X7=null;class h7e{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){qg("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t){qg(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const n=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=n,n}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return ej=ej||new ci,this.renderer.getDrawingBufferSize(ej)}setScissorTest(){}getClearColor(){const e=this.renderer;return X7=X7||new m$,e.getClearColor(X7),X7.getRGB(X7),X7}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:FBe(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${$ve} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let dqe=0;class fqe{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class pqe{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:r}=n,i=e.array,a=e.usage||r.STATIC_DRAW,c=e.isInterleavedBufferAttribute?e.data:e,u=n.get(c);let p=u.bufferGPU;p===void 0&&(p=this._createBuffer(r,t,i,a),u.bufferGPU=p,u.bufferType=t,u.version=c.version);let y;if(i instanceof Float32Array)y=r.FLOAT;else if(i instanceof Uint16Array)e.isFloat16BufferAttribute?y=r.HALF_FLOAT:y=r.UNSIGNED_SHORT;else if(i instanceof Int16Array)y=r.SHORT;else if(i instanceof Uint32Array)y=r.UNSIGNED_INT;else if(i instanceof Int32Array)y=r.INT;else if(i instanceof Int8Array)y=r.BYTE;else if(i instanceof Uint8Array)y=r.UNSIGNED_BYTE;else if(i instanceof Uint8ClampedArray)y=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+i);let x={bufferGPU:p,bufferType:t,type:y,byteLength:i.byteLength,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:y===r.INT||y===r.UNSIGNED_INT||e.gpuType===sc,id:dqe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const S=this._createBuffer(r,t,i,a);x=new fqe(x,S)}n.set(e,x)}updateAttribute(e){const t=this.backend,{gl:n}=t,r=e.array,i=e.isInterleavedBufferAttribute?e.data:e,a=t.get(i),c=a.bufferType,u=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(c,a.bufferGPU),u.length===0)n.bufferSubData(c,0,r);else{for(let p=0,y=u.length;p<y;p++){const x=u[p];n.bufferSubData(c,x.start*r.BYTES_PER_ELEMENT,r,x.start,x.count)}i.clearUpdateRanges()}n.bindBuffer(c,null),a.version=i.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:i}=t.get(r),a=e.array,c=a.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,i);const u=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,u),n.bufferData(n.COPY_WRITE_BUFFER,c,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,c),await t.utils._clientWaitAsync();const p=new e.array.constructor(a.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,u),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,p),n.deleteBuffer(u),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),p.buffer}_createBuffer(e,t,n,r){const i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,r),e.bindBuffer(t,null),i}}let tj,Iw;class mqe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;tj={[Nf]:e.FUNC_ADD,[qve]:e.FUNC_SUBTRACT,[Xve]:e.FUNC_REVERSE_SUBTRACT},Iw={[N3]:e.ZERO,[Yve]:e.ONE,[Kve]:e.SRC_COLOR,[Sk]:e.SRC_ALPHA,[nye]:e.SRC_ALPHA_SATURATE,[eye]:e.DST_COLOR,[Qve]:e.DST_ALPHA,[Zve]:e.ONE_MINUS_SRC_COLOR,[wk]:e.ONE_MINUS_SRC_ALPHA,[tye]:e.ONE_MINUS_DST_COLOR,[Jve]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),n=e.getParameter(e.VIEWPORT);this.currentScissor=new Ri().fromArray(t),this.currentViewport=new Ri().fromArray(n),this._tempVec4=new Ri}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==nBe?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===rBe?t.cullFace(t.BACK):e===iBe?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,n,r,i,a,c,u){const{gl:p}=this;if(e===jx){this.currentBlendingEnabled===!0&&(this.disable(p.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(p.BLEND),this.currentBlendingEnabled=!0),e!==oE){if(e!==this.currentBlending||u!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==Nf||this.currentBlendEquationAlpha!==Nf)&&(p.blendEquation(p.FUNC_ADD),this.currentBlendEquation=Nf,this.currentBlendEquationAlpha=Nf),u)switch(e){case Ug:p.blendFuncSeparate(p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case xk:p.blendFunc(p.ONE,p.ONE);break;case _k:p.blendFuncSeparate(p.ZERO,p.ONE_MINUS_SRC_COLOR,p.ZERO,p.ONE);break;case bk:p.blendFuncSeparate(p.ZERO,p.SRC_COLOR,p.ZERO,p.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Ug:p.blendFuncSeparate(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case xk:p.blendFunc(p.SRC_ALPHA,p.ONE);break;case _k:p.blendFuncSeparate(p.ZERO,p.ONE_MINUS_SRC_COLOR,p.ZERO,p.ONE);break;case bk:p.blendFunc(p.ZERO,p.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=u}return}i=i||t,a=a||n,c=c||r,(t!==this.currentBlendEquation||i!==this.currentBlendEquationAlpha)&&(p.blendEquationSeparate(tj[t],tj[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),(n!==this.currentBlendSrc||r!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||c!==this.currentBlendDstAlpha)&&(p.blendFuncSeparate(Iw[n],Iw[r],Iw[a],Iw[c]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=c),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case rye:t.depthFunc(t.NEVER);break;case iye:t.depthFunc(t.ALWAYS);break;case sye:t.depthFunc(t.LESS);break;case Ek:t.depthFunc(t.LEQUAL);break;case oye:t.depthFunc(t.EQUAL);break;case aye:t.depthFunc(t.GEQUAL);break;case lye:t.depthFunc(t.GREATER);break;case cye:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,n,r){const i=this._tempVec4.set(e,t,n,r);if(this.currentScissor.equals(i)===!1){const{gl:a}=this;a.scissor(i.x,i.y,i.z,i.w),this.currentScissor.copy(i)}}viewport(e,t,n,r){const i=this._tempVec4.set(e,t,n,r);if(this.currentViewport.equals(i)===!1){const{gl:a}=this;a.viewport(i.x,i.y,i.z,i.w),this.currentViewport.copy(i)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t,n){const{gl:r}=this;e.side===Sx?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let i=e.side===eu;t&&(i=!i),this.setFlipSided(i),e.blending===Ug&&e.transparent===!1?this.setBlending(jx):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(let u=0;u<8;u++)u<n?this.enable(12288+u):this.disable(12288+u)}setPolygonOffset(e,t,n){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==n)&&(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const n=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(n.bindVertexArray(e),t!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:r}=this;return r[e]!==t?(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:n}=this;let r=[],i=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const a=e.textures;if(r.length!==a.length||r[0]!==n.COLOR_ATTACHMENT0){for(let c=0,u=a.length;c<u;c++)r[c]=n.COLOR_ATTACHMENT0+c;r.length=a.length,i=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,i=!0);i&&n.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:r,currentTextureSlot:i,currentBoundTextures:a,maxTextures:c}=this;n===void 0&&(i===null?n=r.TEXTURE0+c-1:n=i);let u=a[n];u===void 0&&(u={type:void 0,texture:void 0},a[n]=u),(u.type!==e||u.texture!==t)&&(i!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),u.type=e,u.texture=t)}bindBufferBase(e,t,n){const{gl:r}=this,i=`${e}-${t}`;return this.currentBoundBufferBases[i]!==n?(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[i]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,r=n[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class gqe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=$g){const{gl:n,extensions:r}=this;let i;const a=Us.getTransfer(t);if(e===lc)return n.UNSIGNED_BYTE;if(e===vBe)return n.UNSIGNED_SHORT_4_4_4_4;if(e===yBe)return n.UNSIGNED_SHORT_5_5_5_1;if(e===hye)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===aE)return n.BYTE;if(e===lE)return n.SHORT;if(e===dx)return n.UNSIGNED_SHORT;if(e===sc)return n.INT;if(e===Zo)return n.UNSIGNED_INT;if(e===Zu)return n.FLOAT;if(e===td)return n.HALF_FLOAT;if(e===xBe)return n.ALPHA;if(e===s$)return n.RGB;if(e===nd)return n.RGBA;if(e===S1)return n.DEPTH_COMPONENT;if(e===Vg)return n.DEPTH_STENCIL;if(e===o$)return n.RED;if(e===a$)return n.RED_INTEGER;if(e===yv)return n.RG;if(e===l$)return n.RG_INTEGER;if(e===c$)return n.RGBA_INTEGER;if(e===tG||e===KI||e===ZI||e===QI)if(a===Vr)if(i=r.get("WEBGL_compressed_texture_s3tc_srgb"),i!==null){if(e===tG)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===KI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===ZI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===QI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(i=r.get("WEBGL_compressed_texture_s3tc"),i!==null){if(e===tG)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===KI)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===ZI)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===QI)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===X3e||e===Y3e||e===K3e||e===Z3e)if(i=r.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(e===X3e)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Y3e)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===K3e)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Z3e)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===Q3e||e===NH||e===DH)if(i=r.get("WEBGL_compressed_texture_etc"),i!==null){if(e===Q3e||e===NH)return a===Vr?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===DH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===OH||e===LH||e===FH||e===BH||e===UH||e===zH||e===VH||e===GH||e===jH||e===HH||e===WH||e===$H||e===qH||e===XH)if(i=r.get("WEBGL_compressed_texture_astc"),i!==null){if(e===OH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===LH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===FH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===BH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===UH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===zH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===VH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===GH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===jH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===HH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===WH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===$H)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===qH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===XH)return a===Vr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===nG)if(i=r.get("EXT_texture_compression_bptc"),i!==null){if(e===nG)return a===Vr?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===bBe||e===J3e||e===e4e||e===t4e)if(i=r.get("EXT_texture_compression_rgtc"),i!==null){if(e===nG)return i.COMPRESSED_RED_RGTC1_EXT;if(e===J3e)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===e4e)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===t4e)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===G3?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,r)=>{function i(){const a=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(t),r();return}if(a===e.TIMEOUT_EXPIRED){requestAnimationFrame(i);return}e.deleteSync(t),n()}i()})}}let B5e=!1,CI,nj,U5e;class vqe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},B5e===!1&&(this._init(),B5e=!0)}_init(){const e=this.gl;CI={[Hx]:e.REPEAT,[z3]:e.CLAMP_TO_EDGE,[Wx]:e.MIRRORED_REPEAT},nj={[Ca]:e.NEAREST,[uye]:e.NEAREST_MIPMAP_NEAREST,[AE]:e.NEAREST_MIPMAP_LINEAR,[th]:e.LINEAR,[kH]:e.LINEAR_MIPMAP_NEAREST,[zg]:e.LINEAR_MIPMAP_LINEAR},U5e={[dye]:e.NEVER,[yye]:e.ALWAYS,[u$]:e.LESS,[pye]:e.LEQUAL,[fye]:e.EQUAL,[vye]:e.GEQUAL,[mye]:e.GREATER,[gye]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let n;return e.isCubeTexture===!0?n=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=t.TEXTURE_3D:n=t.TEXTURE_2D,n}getInternalFormat(e,t,n,r,i=!1){const{gl:a,extensions:c}=this;if(e!==null){if(a[e]!==void 0)return a[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let u=t;if(t===a.RED&&(n===a.FLOAT&&(u=a.R32F),n===a.HALF_FLOAT&&(u=a.R16F),n===a.UNSIGNED_BYTE&&(u=a.R8),n===a.UNSIGNED_SHORT&&(u=a.R16),n===a.UNSIGNED_INT&&(u=a.R32UI),n===a.BYTE&&(u=a.R8I),n===a.SHORT&&(u=a.R16I),n===a.INT&&(u=a.R32I)),t===a.RED_INTEGER&&(n===a.UNSIGNED_BYTE&&(u=a.R8UI),n===a.UNSIGNED_SHORT&&(u=a.R16UI),n===a.UNSIGNED_INT&&(u=a.R32UI),n===a.BYTE&&(u=a.R8I),n===a.SHORT&&(u=a.R16I),n===a.INT&&(u=a.R32I)),t===a.RG&&(n===a.FLOAT&&(u=a.RG32F),n===a.HALF_FLOAT&&(u=a.RG16F),n===a.UNSIGNED_BYTE&&(u=a.RG8),n===a.UNSIGNED_SHORT&&(u=a.RG16),n===a.UNSIGNED_INT&&(u=a.RG32UI),n===a.BYTE&&(u=a.RG8I),n===a.SHORT&&(u=a.RG16I),n===a.INT&&(u=a.RG32I)),t===a.RG_INTEGER&&(n===a.UNSIGNED_BYTE&&(u=a.RG8UI),n===a.UNSIGNED_SHORT&&(u=a.RG16UI),n===a.UNSIGNED_INT&&(u=a.RG32UI),n===a.BYTE&&(u=a.RG8I),n===a.SHORT&&(u=a.RG16I),n===a.INT&&(u=a.RG32I)),t===a.RGB){const p=i?Mk:Us.getTransfer(r);n===a.FLOAT&&(u=a.RGB32F),n===a.HALF_FLOAT&&(u=a.RGB16F),n===a.UNSIGNED_BYTE&&(u=a.RGB8),n===a.UNSIGNED_SHORT&&(u=a.RGB16),n===a.UNSIGNED_INT&&(u=a.RGB32UI),n===a.BYTE&&(u=a.RGB8I),n===a.SHORT&&(u=a.RGB16I),n===a.INT&&(u=a.RGB32I),n===a.UNSIGNED_BYTE&&(u=p===Vr?a.SRGB8:a.RGB8),n===a.UNSIGNED_SHORT_5_6_5&&(u=a.RGB565),n===a.UNSIGNED_SHORT_5_5_5_1&&(u=a.RGB5_A1),n===a.UNSIGNED_SHORT_4_4_4_4&&(u=a.RGB4),n===a.UNSIGNED_INT_5_9_9_9_REV&&(u=a.RGB9_E5)}if(t===a.RGB_INTEGER&&(n===a.UNSIGNED_BYTE&&(u=a.RGB8UI),n===a.UNSIGNED_SHORT&&(u=a.RGB16UI),n===a.UNSIGNED_INT&&(u=a.RGB32UI),n===a.BYTE&&(u=a.RGB8I),n===a.SHORT&&(u=a.RGB16I),n===a.INT&&(u=a.RGB32I)),t===a.RGBA){const p=i?Mk:Us.getTransfer(r);n===a.FLOAT&&(u=a.RGBA32F),n===a.HALF_FLOAT&&(u=a.RGBA16F),n===a.UNSIGNED_BYTE&&(u=a.RGBA8),n===a.UNSIGNED_SHORT&&(u=a.RGBA16),n===a.UNSIGNED_INT&&(u=a.RGBA32UI),n===a.BYTE&&(u=a.RGBA8I),n===a.SHORT&&(u=a.RGBA16I),n===a.INT&&(u=a.RGBA32I),n===a.UNSIGNED_BYTE&&(u=p===Vr?a.SRGB8_ALPHA8:a.RGBA8),n===a.UNSIGNED_SHORT_4_4_4_4&&(u=a.RGBA4),n===a.UNSIGNED_SHORT_5_5_5_1&&(u=a.RGB5_A1)}return t===a.RGBA_INTEGER&&(n===a.UNSIGNED_BYTE&&(u=a.RGBA8UI),n===a.UNSIGNED_SHORT&&(u=a.RGBA16UI),n===a.UNSIGNED_INT&&(u=a.RGBA32UI),n===a.BYTE&&(u=a.RGBA8I),n===a.SHORT&&(u=a.RGBA16I),n===a.INT&&(u=a.RGBA32I)),t===a.DEPTH_COMPONENT&&(n===a.UNSIGNED_SHORT&&(u=a.DEPTH_COMPONENT16),n===a.UNSIGNED_INT&&(u=a.DEPTH_COMPONENT24),n===a.FLOAT&&(u=a.DEPTH_COMPONENT32F)),t===a.DEPTH_STENCIL&&n===a.UNSIGNED_INT_24_8&&(u=a.DEPTH24_STENCIL8),(u===a.R16F||u===a.R32F||u===a.RG16F||u===a.RG32F||u===a.RGBA16F||u===a.RGBA32F)&&c.get("EXT_color_buffer_float"),u}setTextureParameters(e,t){const{gl:n,extensions:r,backend:i}=this,a=Us.getPrimaries(Us.workingColorSpace),c=t.colorSpace===$g?null:Us.getPrimaries(t.colorSpace),u=t.colorSpace===$g||a===c?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,u),n.texParameteri(e,n.TEXTURE_WRAP_S,CI[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,CI[t.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||n.texParameteri(e,n.TEXTURE_WRAP_R,CI[t.wrapR])),n.texParameteri(e,n.TEXTURE_MAG_FILTER,nj[t.magFilter]);const p=t.mipmaps!==void 0&&t.mipmaps.length>0,y=t.minFilter===th&&p?zg:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,nj[y]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,U5e[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===Ca||t.minFilter!==AE&&t.minFilter!==zg||t.type===Zu&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const x=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,x.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:r}=this,i=this.getGLTextureType(e);let a=r[i];a===void 0&&(a=t.createTexture(),n.state.bindTexture(i,a),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),r[i]=a),n.set(e,{textureGPU:a,glTextureType:i,isDefault:!0})}createTexture(e,t){const{gl:n,backend:r}=this,{levels:i,width:a,height:c,depth:u}=t,p=r.utils.convert(e.format,e.colorSpace),y=r.utils.convert(e.type),x=this.getInternalFormat(e.internalFormat,p,y,e.colorSpace,e.isVideoTexture),S=n.createTexture(),M=this.getGLTextureType(e);r.state.bindTexture(M,S),this.setTextureParameters(M,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,i,x,a,c,u):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,i,x,a,c,u):e.isVideoTexture||n.texStorage2D(M,i,x,a,c),r.set(e,{textureGPU:S,glTextureType:M,glFormat:p,glType:y,glInternalFormat:x})}copyBufferToTexture(e,t){const{gl:n,backend:r}=this,{textureGPU:i,glTextureType:a,glFormat:c,glType:u}=r.get(t),{width:p,height:y}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(a,i),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(a,0,0,0,p,y,c,u,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:r,height:i}=t,{textureGPU:a,glTextureType:c,glFormat:u,glType:p,glInternalFormat:y}=this.backend.get(e);if(!(e.isRenderTargetTexture||a===void 0))if(this.backend.state.bindTexture(c,a),this.setTextureParameters(c,e),e.isCompressedTexture){const x=e.mipmaps,S=t.image;for(let M=0;M<x.length;M++){const I=x[M];e.isCompressedArrayTexture?e.format!==n.RGBA?u!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,M,0,0,0,I.width,I.height,S.depth,u,I.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,M,0,0,0,I.width,I.height,S.depth,u,p,I.data):u!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,M,0,0,I.width,I.height,u,I.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const x=t.images;for(let S=0;S<6;S++){const M=z5e(x[S]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+S,0,0,0,r,i,u,p,M)}}else if(e.isDataArrayTexture||e.isArrayTexture){const x=t.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,x.width,x.height,x.depth,u,p,x.data)}else if(e.isData3DTexture){const x=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,x.width,x.height,x.depth,u,p,x.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(c,0,y,u,p,t.image);else{const x=z5e(t.image);n.texSubImage2D(c,0,0,0,r,i,u,p,x)}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:r,glTextureType:i}=n.get(e);n.state.bindTexture(i,r),t.generateMipmap(i)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const i in r.framebuffers)t.deleteFramebuffer(r.framebuffers[i]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let i=0;i<r.msaaRenderbuffers.length;i++)t.deleteRenderbuffer(r.msaaRenderbuffers[i]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:n}=this,{textureGPU:r,renderTarget:i}=n.get(e);this.deallocateRenderBuffers(i),t.deleteTexture(r),n.delete(e)}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){const{gl:c,backend:u}=this,{state:p}=this.backend,{textureGPU:y,glTextureType:x,glType:S,glFormat:M}=u.get(t);p.bindTexture(x,y);let I,L,B,A,V,X,P,te,oe;const ie=e.isCompressedTexture?e.mipmaps[a]:e.image;if(n!==null)I=n.max.x-n.min.x,L=n.max.y-n.min.y,B=n.isBox3?n.max.z-n.min.z:1,A=n.min.x,V=n.min.y,X=n.isBox3?n.min.z:0;else{const tt=Math.pow(2,-i);I=Math.floor(ie.width*tt),L=Math.floor(ie.height*tt),e.isDataArrayTexture||e.isArrayTexture?B=ie.depth:e.isData3DTexture?B=Math.floor(ie.depth*tt):B=1,A=0,V=0,X=0}r!==null?(P=r.x,te=r.y,oe=r.z):(P=0,te=0,oe=0),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,t.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,t.unpackAlignment);const K=c.getParameter(c.UNPACK_ROW_LENGTH),re=c.getParameter(c.UNPACK_IMAGE_HEIGHT),se=c.getParameter(c.UNPACK_SKIP_PIXELS),q=c.getParameter(c.UNPACK_SKIP_ROWS),De=c.getParameter(c.UNPACK_SKIP_IMAGES);c.pixelStorei(c.UNPACK_ROW_LENGTH,ie.width),c.pixelStorei(c.UNPACK_IMAGE_HEIGHT,ie.height),c.pixelStorei(c.UNPACK_SKIP_PIXELS,A),c.pixelStorei(c.UNPACK_SKIP_ROWS,V),c.pixelStorei(c.UNPACK_SKIP_IMAGES,X);const Be=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const tt=u.get(e),st=u.get(t),de=u.get(tt.renderTarget),ft=u.get(st.renderTarget),Se=de.framebuffers[tt.cacheKey],rt=ft.framebuffers[st.cacheKey];p.bindFramebuffer(c.READ_FRAMEBUFFER,Se),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,rt);let ut=c.COLOR_BUFFER_BIT;e.isDepthTexture&&(ut=c.DEPTH_BUFFER_BIT),c.blitFramebuffer(A,V,I,L,P,te,I,L,ut,c.NEAREST),p.bindFramebuffer(c.READ_FRAMEBUFFER,null),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,null)}else Be?e.isDataTexture||e.isData3DTexture?c.texSubImage3D(x,a,P,te,oe,I,L,B,M,S,ie.data):t.isCompressedArrayTexture?c.compressedTexSubImage3D(x,a,P,te,oe,I,L,B,M,ie.data):c.texSubImage3D(x,a,P,te,oe,I,L,B,M,S,ie):e.isDataTexture?c.texSubImage2D(x,a,P,te,I,L,M,S,ie.data):e.isCompressedTexture?c.compressedTexSubImage2D(x,a,P,te,ie.width,ie.height,M,ie.data):c.texSubImage2D(x,a,P,te,I,L,M,S,ie);c.pixelStorei(c.UNPACK_ROW_LENGTH,K),c.pixelStorei(c.UNPACK_IMAGE_HEIGHT,re),c.pixelStorei(c.UNPACK_SKIP_PIXELS,se),c.pixelStorei(c.UNPACK_SKIP_ROWS,q),c.pixelStorei(c.UNPACK_SKIP_IMAGES,De),a===0&&t.generateMipmaps&&c.generateMipmap(x),p.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:r}=this,{state:i}=this.backend,{textureGPU:a}=this.backend.get(e),{x:c,y:u,z:p,w:y}=n,x=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,S=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(x){const M=c!==0||u!==0;let I,L;if(e.isDepthTexture===!0?(I=r.DEPTH_BUFFER_BIT,L=r.DEPTH_ATTACHMENT,t.stencil&&(I|=r.STENCIL_BUFFER_BIT)):(I=r.COLOR_BUFFER_BIT,L=r.COLOR_ATTACHMENT0),M){const B=this.backend.get(t.renderTarget),A=B.framebuffers[t.getCacheKey()],V=B.msaaFrameBuffer;i.bindFramebuffer(r.DRAW_FRAMEBUFFER,A),i.bindFramebuffer(r.READ_FRAMEBUFFER,V);const X=S-u-y;r.blitFramebuffer(c,X,c+p,X+y,c,X,c+p,X+y,I,r.NEAREST),i.bindFramebuffer(r.READ_FRAMEBUFFER,A),i.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,c,X,p,y),i.unbindTexture()}else{const B=r.createFramebuffer();i.bindFramebuffer(r.DRAW_FRAMEBUFFER,B),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,L,r.TEXTURE_2D,a,0),r.blitFramebuffer(0,0,p,y,0,0,p,y,I,r.NEAREST),r.deleteFramebuffer(B)}}else i.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,c,S-y-u,p,y),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,n,r=!1){const{gl:i}=this,a=t.renderTarget,{depthTexture:c,depthBuffer:u,stencilBuffer:p,width:y,height:x}=a;if(i.bindRenderbuffer(i.RENDERBUFFER,e),u&&!p){let S=i.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(i.RENDERBUFFER,a.samples,S,y,x):n>0?(c&&c.isDepthTexture&&c.type===i.FLOAT&&(S=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,n,S,y,x)):i.renderbufferStorage(i.RENDERBUFFER,S,y,x),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else u&&p&&(n>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,n,i.DEPTH24_STENCIL8,y,x):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,y,x),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,n,r,i,a){const{backend:c,gl:u}=this,{textureGPU:p,glFormat:y,glType:x}=this.backend.get(e),S=u.createFramebuffer();u.bindFramebuffer(u.READ_FRAMEBUFFER,S);const M=e.isCubeTexture?u.TEXTURE_CUBE_MAP_POSITIVE_X+a:u.TEXTURE_2D;u.framebufferTexture2D(u.READ_FRAMEBUFFER,u.COLOR_ATTACHMENT0,M,p,0);const I=this._getTypedArrayType(x),L=this._getBytesPerTexel(x,y),A=r*i*L,V=u.createBuffer();u.bindBuffer(u.PIXEL_PACK_BUFFER,V),u.bufferData(u.PIXEL_PACK_BUFFER,A,u.STREAM_READ),u.readPixels(t,n,r,i,y,x,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),await c.utils._clientWaitAsync();const X=new I(A/I.BYTES_PER_ELEMENT);return u.bindBuffer(u.PIXEL_PACK_BUFFER,V),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,X),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),u.deleteFramebuffer(S),X}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let r=0;if(e===n.UNSIGNED_BYTE&&(r=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(r=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(r=4),t===n.RGBA)return r*4;if(t===n.RGB)return r*3;if(t===n.ALPHA)return r}}function z5e(s){return s.isDataTexture?s.image.data:typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?s:s.data}class yqe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class xqe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const V5e={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class _qe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:r,object:i,type:a,info:c,index:u}=this;u!==0?n.drawElements(r,t,a,e):n.drawArrays(r,e,t),c.update(i,t,1)}renderInstances(e,t,n){const{gl:r,mode:i,type:a,index:c,object:u,info:p}=this;n!==0&&(c!==0?r.drawElementsInstanced(i,t,a,e,n):r.drawArraysInstanced(i,e,t,n),p.update(u,t,n))}renderMultiDraw(e,t,n){const{extensions:r,mode:i,object:a,info:c}=this;if(n===0)return;const u=r.get("WEBGL_multi_draw");if(u===null)for(let p=0;p<n;p++)this.render(e[p],t[p]);else{this.index!==0?u.multiDrawElementsWEBGL(i,t,0,this.type,e,0,n):u.multiDrawArraysWEBGL(i,e,0,t,0,n);let p=0;for(let y=0;y<n;y++)p+=t[y];c.update(a,p,1)}}renderMultiDrawInstances(e,t,n,r){const{extensions:i,mode:a,object:c,info:u}=this;if(n===0)return;const p=i.get("WEBGL_multi_draw");if(p===null)for(let y=0;y<n;y++)this.renderInstances(e[y],t[y],r[y]);else{this.index!==0?p.multiDrawElementsInstancedWEBGL(a,t,0,this.type,e,0,r,0,n):p.multiDrawArraysInstancedWEBGL(a,e,0,t,0,r,0,n);let y=0;for(let x=0;x<n;x++)y+=t[x]*r[x];u.update(c,y,1)}}}class d7e{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class bqe extends d7e{constructor(e,t,n=2048){if(super(n),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return qg(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e.id,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t==null||this.activeQuery!==null)return;const n=this.queries[t];if(n)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){console.error("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){console.error("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[r,i]of this.queryStates)if(i==="ended"){const a=this.queries[r];e.push(this.resolveQuery(a))}if(e.length===0)return this.lastValue;const n=(await Promise.all(e)).reduce((r,i)=>r+i,0);return this.lastValue=n,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,n}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let n,r=!1;const i=()=>{n&&(clearTimeout(n),n=null)},a=u=>{r||(r=!0,i(),t(u))},c=()=>{if(this.isDisposed){a(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){a(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){n=setTimeout(c,1);return}const y=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(y)/1e6)}catch(u){console.error("Error checking query:",u),t(this.lastValue)}};c()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}const G5e=new ci;class j5e extends h7e{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,n={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",n);function i(a){a.preventDefault();const c={api:"WebGL",message:a.statusMessage||"Unknown reason",reason:null,originalEvent:a};e.onDeviceLost(c)}this._onContextLost=i,e.domElement.addEventListener("webglcontextlost",i,!1),this.gl=r,this.extensions=new yqe(this),this.capabilities=new xqe(this),this.attributeUtils=new pqe(this),this.textureUtils=new vqe(this),this.bufferRenderer=new _qe(this),this.state=new mqe(this),this.utils=new gqe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return Zc}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,n=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),n!==null){const i=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:i}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t]||(this.timestampQueryPool[t]=new bqe(this.gl,t,2048));const n=this.timestampQueryPool[t];n.allocateQueriesForContext(e)!==null&&n.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:t}=this,n=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:i,height:a}=this.getDrawingBufferSize(G5e);t.viewport(0,0,i,a)}if(e.scissor){const{x:i,y:a,width:c,height:u}=e.scissorValue;t.scissor(i,e.height-u-a,c,u)}this.initTimestampQuery(e),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const r=e.occlusionQueryCount;r>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(r),n.occlusionQueryObjects=new Array(r),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,r=this.get(e),i=r.previousContext;n.resetVertexState();const a=e.occlusionQueryCount;a>0&&(a>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const c=e.textures;if(c!==null)for(let u=0;u<c.length;u++){const p=c[u];p.generateMipmaps&&this.generateMipmaps(p)}if(this._currentContext=i,e.textures!==null&&e.renderTarget){const u=this.get(e.renderTarget),{resolveDepthBuffer:p,samples:y}=e.renderTarget;if(y>0&&this._useMultisampledExtension(e.renderTarget)===!1){const x=u.framebuffers[e.getCacheKey()],S=t.COLOR_BUFFER_BIT,M=u.msaaFrameBuffer,I=e.textures;n.bindFramebuffer(t.READ_FRAMEBUFFER,M),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,x);for(let L=0;L<I.length;L++)if(e.scissor){const{x:B,y:A,width:V,height:X}=e.scissorValue,P=e.height-X-A;t.blitFramebuffer(B,P,B+V,P+X,B,P,B+V,P+X,S,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,u.invalidationArray,B,P,V,X)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,S,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,u.invalidationArray)}else if(p===!1&&u.framebuffers){const x=u.framebuffers[e.getCacheKey()];n.bindFramebuffer(t.DRAW_FRAMEBUFFER,x),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,u.depthInvalidationArray)}}if(i!==null)if(this._setFramebuffer(i),i.viewport)this.updateViewport(i);else{const{width:u,height:p}=this.getDrawingBufferSize(G5e);n.viewport(0,0,u,p)}this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const i=new WeakSet,{gl:a}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const c=()=>{let u=0;for(let p=0;p<n.length;p++){const y=n[p];y!==null&&a.getQueryParameter(y,a.QUERY_RESULT_AVAILABLE)&&(a.getQueryParameter(y,a.QUERY_RESULT)===0&&i.add(r[p]),n[p]=null,a.deleteQuery(y),u++)}u<n.length?requestAnimationFrame(c):t.occluded=i};c()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:n,y:r,width:i,height:a}=e.viewportValue;t.viewport(n,e.height-a-r,i,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,n,r=null,i=!0){const{gl:a,renderer:c}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let u=0;if(e&&(u|=a.COLOR_BUFFER_BIT),t&&(u|=a.DEPTH_BUFFER_BIT),n&&(u|=a.STENCIL_BUFFER_BIT),u!==0){let p;r.clearColorValue?p=r.clearColorValue:p=this.getClearColor();const y=c.getClearDepth(),x=c.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)a.clearColor(p.r,p.g,p.b,p.a),a.clear(u);else{if(i&&this._setFramebuffer(r),e)for(let S=0;S<r.textures.length;S++)S===0?a.clearBufferfv(a.COLOR,S,[p.r,p.g,p.b,p.a]):a.clearBufferfv(a.COLOR,S,[0,0,0,1]);t&&n?a.clearBufferfi(a.DEPTH_STENCIL,0,y,x):t?a.clearBufferfv(a.DEPTH,0,[y]):n&&a.clearBufferiv(a.STENCIL,0,[x])}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,n,r){const{state:i,gl:a}=this;this.discard===!1&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:c,transformBuffers:u,attributes:p}=this.get(r),y=this._getVaoKey(p),x=this.vaoCache[y];x===void 0?this._createVao(p):i.setVertexState(x),i.useProgram(c),this._bindUniforms(n);const S=this._getTransformFeedback(u);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,S),a.beginTransformFeedback(a.POINTS),p[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,t.count):a.drawArrays(a.POINTS,0,t.count),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(let M=0;M<u.length;M++){const I=u[M];I.pbo&&this.textureUtils.copyBufferToTexture(I.transformBuffer,I.pbo),I.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:n,material:r,context:i,hardwareClippingPlanes:a}=e,{programGPU:c}=this.get(n),{gl:u,state:p}=this,y=this.get(i),x=e.getDrawParameters();if(x===null)return;this._bindUniforms(e.getBindings());const S=t.isMesh&&t.matrixWorld.determinant()<0;p.setMaterial(r,S,a),p.useProgram(c);const M=this.get(e);let I=M.staticVao;if(I===void 0||M.geometryId!==e.geometry.id){const ie=this._getVaoKey(e.getAttributes());if(I=this.vaoCache[ie],I===void 0){let K;({vaoGPU:I,staticVao:K}=this._createVao(e.getAttributes())),K&&(M.staticVao=I,M.geometryId=e.geometry.id)}}const L=e.getIndex(),B=L!==null?this.get(L).bufferGPU:null;p.setVertexState(I,B);const A=y.lastOcclusionObject;if(A!==t&&A!==void 0){if(A!==null&&A.occlusionTest===!0&&(u.endQuery(u.ANY_SAMPLES_PASSED),y.occlusionQueryIndex++),t.occlusionTest===!0){const ie=u.createQuery();u.beginQuery(u.ANY_SAMPLES_PASSED,ie),y.occlusionQueries[y.occlusionQueryIndex]=ie,y.occlusionQueryObjects[y.occlusionQueryIndex]=t}y.lastOcclusionObject=t}const V=this.bufferRenderer;t.isPoints?V.mode=u.POINTS:t.isLineSegments?V.mode=u.LINES:t.isLine?V.mode=u.LINE_STRIP:t.isLineLoop?V.mode=u.LINE_LOOP:r.wireframe===!0?(p.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),V.mode=u.LINES):V.mode=u.TRIANGLES;const{vertexCount:X,instanceCount:P}=x;let{firstVertex:te}=x;if(V.object=t,L!==null){te*=L.array.BYTES_PER_ELEMENT;const ie=this.get(L);V.index=L.count,V.type=ie.type}else V.index=0;const oe=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(qg("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),V.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?V.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):qg("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):P>1?V.renderInstances(te,X,P):V.render(te,X)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const ie=this.get(e.camera),K=e.camera.cameras,re=e.getBindingGroup("cameraIndex").bindings[0];if(ie.indexesGPU===void 0||ie.indexesGPU.length!==K.length){const st=new Uint32Array([0,0,0,0]),de=[];for(let ft=0,Se=K.length;ft<Se;ft++){const rt=u.createBuffer();st[0]=ft,u.bindBuffer(u.UNIFORM_BUFFER,rt),u.bufferData(u.UNIFORM_BUFFER,st,u.STATIC_DRAW),de.push(rt)}ie.indexesGPU=de}const se=this.get(re),q=this.renderer.getPixelRatio(),De=this._currentContext.renderTarget,Be=this._isRenderCameraDepthArray(this._currentContext),tt=this._currentContext.activeCubeFace;if(Be){const st=this.get(De.depthTexture);if(st.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){st.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:de}=De;for(let ft=0,Se=K.length;ft<Se;ft++)this.renderer._activeCubeFace=ft,this._currentContext.activeCubeFace=ft,this._setFramebuffer(this._currentContext),this.clear(!1,!0,de,this._currentContext,!1);this.renderer._activeCubeFace=tt,this._currentContext.activeCubeFace=tt}}for(let st=0,de=K.length;st<de;st++){const ft=K[st];if(t.layers.test(ft.layers)){Be&&(this.renderer._activeCubeFace=st,this._currentContext.activeCubeFace=st,this._setFramebuffer(this._currentContext));const Se=ft.viewport;if(Se!==void 0){const rt=Se.x*q,ut=Se.y*q,Pe=Se.width*q,vt=Se.height*q;p.viewport(Math.floor(rt),Math.floor(e.context.height-vt-ut),Math.floor(Pe),Math.floor(vt))}p.bindBufferBase(u.UNIFORM_BUFFER,se.index,ie.indexesGPU[st]),oe()}this._currentContext.activeCubeFace=tt,this.renderer._activeCubeFace=tt}}else oe()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,i,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,a)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new hqe(e,t)}createProgram(e){const t=this.gl,{stage:n,code:r}=e,i=n==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,r),t.compileShader(i),this.set(e,{shaderGPU:i})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const n=this.gl,r=e.pipeline,{fragmentProgram:i,vertexProgram:a}=r,c=n.createProgram(),u=this.get(i).shaderGPU,p=this.get(a).shaderGPU;if(n.attachShader(c,u),n.attachShader(c,p),n.linkProgram(c),this.set(r,{programGPU:c,fragmentShader:u,vertexShader:p}),t!==null&&this.parallel){const y=new Promise(x=>{const S=this.parallel,M=()=>{n.getProgramParameter(c,S.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),x()):requestAnimationFrame(M)};M()});t.push(y);return}this._completeCompile(e,r)}_handleSource(e,t){const n=e.split(`
`),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let c=i;c<a;c++){const u=c+1;r.push(`${u===t?">":" "} ${u}: ${n[c]}`)}return r.join(`
`)}_getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const c=parseInt(a[1]);return n.toUpperCase()+`

`+i+`

`+this._handleSource(e.getShaderSource(t),c)}else return i}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const r=this.gl,i=r.getProgramInfoLog(e).trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,n,t);else{const a=this._getShaderErrors(r,n,"vertex"),c=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+i+`
`+a+`
`+c)}else i!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}_completeCompile(e,t){const{state:n,gl:r}=this,i=this.get(t),{programGPU:a,fragmentShader:c,vertexShader:u}=i;r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,c,u),n.useProgram(a);const p=e.getBindings();this._setupBindings(p,a),this.set(t,{programGPU:a})}createComputePipeline(e,t){const{state:n,gl:r}=this,i={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(i);const{computeProgram:a}=e,c=r.createProgram(),u=this.get(i).shaderGPU,p=this.get(a).shaderGPU,y=a.transforms,x=[],S=[];for(let B=0;B<y.length;B++){const A=y[B];x.push(A.varyingName),S.push(A.attributeNode)}r.attachShader(c,u),r.attachShader(c,p),r.transformFeedbackVaryings(c,x,r.SEPARATE_ATTRIBS),r.linkProgram(c),r.getProgramParameter(c,r.LINK_STATUS)===!1&&this._logProgramError(c,u,p),n.useProgram(c),this._setupBindings(t,c);const M=a.attributes,I=[],L=[];for(let B=0;B<M.length;B++){const A=M[B].node.attribute;I.push(A),this.has(A)||this.attributeUtils.createAttribute(A,r.ARRAY_BUFFER)}for(let B=0;B<S.length;B++){const A=S[B].attribute;this.has(A)||this.attributeUtils.createAttribute(A,r.ARRAY_BUFFER);const V=this.get(A);L.push(V)}this.set(e,{programGPU:c,transformBuffers:L,attributes:I})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let n=0,r=0;for(const i of t){this.set(i,{textures:r,uniformBuffers:n});for(const a of i.bindings)a.isUniformBuffer&&n++,a.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let r=n.uniformBuffers,i=n.textures;for(const a of e.bindings)if(a.isUniformsGroup||a.isUniformBuffer){const c=a.buffer,u=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,u),t.bufferData(t.UNIFORM_BUFFER,c,t.DYNAMIC_DRAW),this.set(a,{index:r++,bufferGPU:u})}else if(a.isSampledTexture){const{textureGPU:c,glTextureType:u}=this.get(a.texture);this.set(a,{index:i++,textureGPU:c,glTextureType:u})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,i=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(V5e).filter(r=>V5e[r]===e),n=this.extensions;for(let r=0;r<t.length;r++)if(n.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){this.textureUtils.copyTextureToTexture(e,t,n,r,i,a)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}_setFramebuffer(e){const{gl:t,state:n}=this;let r=null;if(e.textures!==null){const i=e.renderTarget,a=this.get(i),{samples:c,depthBuffer:u,stencilBuffer:p}=i,y=i.isWebGLCubeRenderTarget===!0,x=i.isRenderTarget3D===!0,S=i.depth>1,M=i.isXRRenderTarget===!0,I=M===!0&&i.hasExternalTextures===!0;let L=a.msaaFrameBuffer,B=a.depthRenderbuffer;const A=this.extensions.get("WEBGL_multisampled_render_to_texture"),V=this.extensions.get("OVR_multiview2"),X=this._useMultisampledExtension(i),P=Pye(e);let te;if(y?(a.cubeFramebuffers||(a.cubeFramebuffers={}),te=a.cubeFramebuffers[P]):M&&I===!1?te=this._xrFramebuffer:(a.framebuffers||(a.framebuffers={}),te=a.framebuffers[P]),te===void 0){te=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,te);const oe=e.textures,ie=[];if(y){a.cubeFramebuffers[P]=te;const{textureGPU:re}=this.get(oe[0]),se=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+se,re,0)}else{a.framebuffers[P]=te;for(let re=0;re<oe.length;re++){const se=oe[re],q=this.get(se);q.renderTarget=e.renderTarget,q.cacheKey=P;const De=t.COLOR_ATTACHMENT0+re;if(i.multiview)V.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,De,q.textureGPU,0,c,0,2);else if(x||S){const Be=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,De,q.textureGPU,0,Be)}else X?A.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,De,t.TEXTURE_2D,q.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,De,t.TEXTURE_2D,q.textureGPU,0)}n.drawBuffers(e,te)}const K=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(i.autoAllocateDepthBuffer===!0){const re=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(re,e,0,X),a.xrDepthRenderbuffer=re,ie.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,re),t.framebufferRenderbuffer(t.FRAMEBUFFER,K,t.RENDERBUFFER,re)}else if(e.depthTexture!==null){ie.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const re=this.get(e.depthTexture);if(re.renderTarget=e.renderTarget,re.cacheKey=P,i.multiview)V.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,K,re.textureGPU,0,c,0,2);else if(I&&X)A.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,K,t.TEXTURE_2D,re.textureGPU,0,c);else if(e.depthTexture.isArrayTexture){const se=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,K,re.textureGPU,0,se)}else t.framebufferTexture2D(t.FRAMEBUFFER,K,t.TEXTURE_2D,re.textureGPU,0)}a.depthInvalidationArray=ie}else{if(this._isRenderCameraDepthArray(e)){n.bindFramebuffer(t.FRAMEBUFFER,te);const ie=this.renderer._activeCubeFace,K=this.get(e.depthTexture),re=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,re,K.textureGPU,0,ie)}if(M||X||i.multiview){n.bindFramebuffer(t.FRAMEBUFFER,te);const ie=this.get(e.textures[0]);i.multiview?V.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,ie.textureGPU,0,c,0,2):X?A.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ie.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ie.textureGPU,0);const K=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(i.autoAllocateDepthBuffer===!0){const re=a.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,re),t.framebufferRenderbuffer(t.FRAMEBUFFER,K,t.RENDERBUFFER,re)}else{const re=this.get(e.depthTexture);i.multiview?V.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,K,re.textureGPU,0,c,0,2):X?A.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,K,t.TEXTURE_2D,re.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,K,t.TEXTURE_2D,re.textureGPU,0)}}}if(c>0&&X===!1&&!i.multiview){if(L===void 0){const oe=[];L=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,L);const ie=[],K=e.textures;for(let re=0;re<K.length;re++){if(ie[re]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,ie[re]),oe.push(t.COLOR_ATTACHMENT0+re),u){const De=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;oe.push(De)}const se=e.textures[re],q=this.get(se);t.renderbufferStorageMultisample(t.RENDERBUFFER,c,q.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+re,t.RENDERBUFFER,ie[re])}if(a.msaaFrameBuffer=L,a.msaaRenderbuffers=ie,B===void 0){B=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(B,e,c),a.depthRenderbuffer=B;const re=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;oe.push(re)}a.invalidationArray=oe}r=a.msaaFrameBuffer}else r=te}n.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let n=0;n<e.length;n++){const r=this.get(e[n]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,n=t.createVertexArray();let r="",i=!0;t.bindVertexArray(n);for(let a=0;a<e.length;a++){const c=e[a],u=this.get(c);r+=":"+u.id,t.bindBuffer(t.ARRAY_BUFFER,u.bufferGPU),t.enableVertexAttribArray(a),(c.isStorageBufferAttribute||c.isStorageInstancedBufferAttribute)&&(i=!1);let p,y;c.isInterleavedBufferAttribute===!0?(p=c.data.stride*u.bytesPerElement,y=c.offset*u.bytesPerElement):(p=0,y=0),u.isInteger?t.vertexAttribIPointer(a,c.itemSize,u.type,p,y):t.vertexAttribPointer(a,c.itemSize,u.type,c.normalized,p,y),c.isInstancedBufferAttribute&&!c.isInterleavedBufferAttribute?t.vertexAttribDivisor(a,c.meshPerAttribute):c.isInterleavedBufferAttribute&&c.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(a,c.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),this.vaoCache[r]=n,{vaoGPU:n,staticVao:i}}_getTransformFeedback(e){let t="";for(let i=0;i<e.length;i++)t+=":"+e[i].id;let n=this.transformFeedbackCache[t];if(n!==void 0)return n;const{gl:r}=this;n=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let i=0;i<e.length;i++){const a=e[i];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,i,a.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const r of e)for(const i of r.bindings){const c=this.get(i).index;if(i.isUniformsGroup||i.isUniformBuffer){const u=n.getUniformBlockIndex(t,i.name);n.uniformBlockBinding(t,u,c)}else if(i.isSampledTexture){const u=n.getUniformLocation(t,i.name);n.uniform1i(u,c)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const r of e)for(const i of r.bindings){const a=this.get(i),c=a.index;i.isUniformsGroup||i.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,c,a.bufferGPU):i.isSampledTexture&&n.bindTexture(a.glTextureType,a.textureGPU,t.TEXTURE0+c)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const vx={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},M0={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},rc={Store:"store"},ns={Load:"load",Clear:"clear"},rj={CCW:"ccw"},ij={None:"none",Front:"front",Back:"back"},Kx={Uint16:"uint16",Uint32:"uint32"},Ge={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},sj={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},pv={Linear:"linear",Nearest:"nearest"},Hr={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},K8={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},H5e={None:0,All:15},C3={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},oj={Storage:"storage",ReadOnlyStorage:"read-only-storage"},aj={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},W5e={NonFiltering:"non-filtering",Comparison:"comparison"},Z8={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},$5e={TwoD:"2d",ThreeD:"3d"},Qa={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},Sqe={All:"all"},AI={Vertex:"vertex",Instance:"instance"},lW={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class wqe extends J${constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class Eqe extends wqe{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){this.texture=this.textureNode.value}}class Tqe extends s7e{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let Mqe=0;class Cqe extends Tqe{constructor(e,t){super("StorageBuffer_"+Mqe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:Og.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class Aqe extends J3{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,n=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:pv.Linear}),this.flipYSampler=e.createSampler({minFilter:pv.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:n}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:vx.TriangleStrip,stripIndexFormat:Kx.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:vx.TriangleStrip,stripIndexFormat:Kx.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,n=0){const r=t.format,{width:i,height:a}=t.size,c=this.getTransferPipeline(r),u=this.getFlipYPipeline(r),p=this.device.createTexture({size:{width:i,height:a,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),y=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Qa.TwoD,baseArrayLayer:n}),x=p.createView({baseMipLevel:0,mipLevelCount:1,dimension:Qa.TwoD,baseArrayLayer:0}),S=this.device.createCommandEncoder({}),M=(I,L,B)=>{const A=I.getBindGroupLayout(0),V=this.device.createBindGroup({layout:A,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:L}]}),X=S.beginRenderPass({colorAttachments:[{view:B,loadOp:ns.Clear,storeOp:rc.Store,clearValue:[0,0,0,0]}]});X.setPipeline(I),X.setBindGroup(0,V),X.draw(4,1,0,0),X.end()};M(c,y,x),M(u,x,y),this.device.queue.submit([S.finish()]),p.destroy()}generateMipmaps(e,t,n=0){const r=this.get(e);r.useCount===void 0&&(r.useCount=0,r.layers=[]);const i=r.layers[n]||this._mipmapCreateBundles(e,t,n),a=this.device.createCommandEncoder({});this._mipmapRunBundles(a,i),this.device.queue.submit([a.finish()]),r.useCount!==0&&(r.layers[n]=i),r.useCount++}_mipmapCreateBundles(e,t,n){const r=this.getTransferPipeline(t.format),i=r.getBindGroupLayout(0);let a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Qa.TwoD,baseArrayLayer:n});const c=[];for(let u=1;u<t.mipLevelCount;u++){const p=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),y=e.createView({baseMipLevel:u,mipLevelCount:1,dimension:Qa.TwoD,baseArrayLayer:n}),x={colorAttachments:[{view:y,loadOp:ns.Clear,storeOp:rc.Store,clearValue:[0,0,0,0]}]},S=this.device.createRenderBundleEncoder({colorFormats:[t.format]});S.setPipeline(r),S.setBindGroup(0,p),S.draw(4,1,0,0),c.push({renderBundles:[S.finish()],passDescriptor:x}),a=y}return c}_mipmapRunBundles(e,t){const n=t.length;for(let r=0;r<n;r++){const i=t[r],a=e.beginRenderPass(i.passDescriptor);a.executeBundles(i.renderBundles),a.end()}}}const Pqe={[dye]:"never",[u$]:"less",[fye]:"equal",[pye]:"less-equal",[mye]:"greater",[vye]:"greater-equal",[yye]:"always",[gye]:"not-equal"},Rqe=[0,1,3,2,4,5];class Iqe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new w1,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,n=t.device,r=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===pv.Linear&&i.minFilter===pv.Linear&&i.mipmapFilter===pv.Linear&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(i.compare=Pqe[e.compareFunction]),r.sampler=n.createSampler(i)}createDefaultTexture(e){let t;const n=cW(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:i,height:a,depth:c,levels:u}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const p=this._getDimension(e),y=e.internalFormat||t.format||cW(e,n.device);r.format=y;const{samples:x,primarySamples:S,isMSAA:M}=n.utils.getTextureSampleData(e);let I=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(I|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(I|=GPUTextureUsage.RENDER_ATTACHMENT);const L={label:e.name,size:{width:i,height:a,depthOrArrayLayers:c},mipLevelCount:u,sampleCount:S,dimension:p,format:y,usage:I};if(e.isVideoTexture){const B=e.source.data,A=new VideoFrame(B);L.size.width=A.displayWidth,L.size.height=A.displayHeight,A.close(),r.externalTexture=B}else{if(y===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(L.textureBindingViewDimension=Qa.Cube),r.texture=n.device.createTexture(L)}if(M){const B=Object.assign({},L);B.label=B.label+"-msaa",B.sampleCount=x,r.msaaTexture=n.device.createTexture(B)}r.initialized=!0,r.textureDescriptorGPU=L}destroyTexture(e){const t=this.backend,n=t.get(e);n.texture!==void 0&&n.texture.destroy(),n.msaaTexture!==void 0&&n.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const n=this.backend.get(e);delete n.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let n=0;n<6;n++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,n);else{const n=e.image.depth||1;for(let r=0;r<n;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:n}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:n,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const n=this.backend,{width:r,height:i}=n.getDrawingBufferSize(),a=this.depthTexture,c=n.get(a).texture;let u,p;if(t?(u=Vg,p=G3):e&&(u=S1,p=Zo),c!==void 0){if(a.image.width===r&&a.image.height===i&&a.format===u&&a.type===p)return c;this.destroyTexture(a)}return a.name="depthBuffer",a.format=u,a.type=p,a.image.width=r,a.image.height=i,this.createTexture(a,{width:r,height:i}),n.get(a).texture}updateTexture(e,t){const n=this.backend.get(e),{textureDescriptorGPU:r}=n;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)this._copyBufferToTexture(t.image,n.texture,r,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let i=0;i<t.image.depth;i++)this._copyBufferToTexture(t.image,n.texture,r,i,e.flipY,i);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,n.texture,r,e.flipY,e.premultiplyAlpha);else if(e.isVideoTexture){const i=e.source.data;n.externalTexture=i}else this._copyImageToTexture(t.image,n.texture,r,0,e.flipY,e.premultiplyAlpha);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,n,r,i,a){const c=this.backend.device,u=this.backend.get(e),p=u.texture,y=u.textureDescriptorGPU.format,x=this._getBytesPerTexel(y);let S=r*x;S=Math.ceil(S/256)*256;const M=c.createBuffer({size:r*i*x,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),I=c.createCommandEncoder();I.copyTextureToBuffer({texture:p,origin:{x:t,y:n,z:a}},{buffer:M,bytesPerRow:S},{width:r,height:i});const L=this._getTypedArrayType(y);c.queue.submit([I.finish()]),await M.mapAsync(GPUMapMode.READ);const B=M.getMappedRange();return new L(B)}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new _l;n.minFilter=Ca,n.magFilter=Ca,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new aN;n.minFilter=Ca,n.magFilter=Ca,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,n,r,i){for(let a=0;a<6;a++){const c=e[a],u=r===!0?Rqe[a]:a;c.isDataTexture?this._copyBufferToTexture(c.image,t,n,u,r):this._copyImageToTexture(c,t,n,u,r,i)}}_copyImageToTexture(e,t,n,r,i,a){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:i},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r},premultipliedAlpha:a},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new Aqe(this.backend.device)),e}_generateMipmaps(e,t,n=0){this._getPassUtils().generateMipmaps(e,t,n)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,r,i,a=0){const c=this.backend.device,u=e.data,p=this._getBytesPerTexel(n.format),y=e.width*p;c.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},u,{offset:e.width*e.height*p*a,bytesPerRow:y},{width:e.width,height:e.height,depthOrArrayLayers:1}),i===!0&&this._flipY(t,n,r)}_copyCompressedBufferToTexture(e,t,n){const r=this.backend.device,i=this._getBlockData(n.format),a=n.size.depthOrArrayLayers>1;for(let c=0;c<e.length;c++){const u=e[c],p=u.width,y=u.height,x=a?n.size.depthOrArrayLayers:1,S=Math.ceil(p/i.width)*i.byteLength,M=S*Math.ceil(y/i.height);for(let I=0;I<x;I++)r.queue.writeTexture({texture:t,mipLevel:c,origin:{x:0,y:0,z:I}},u.data,{offset:I*M,bytesPerRow:S,rowsPerImage:Math.ceil(y/i.height)},{width:Math.ceil(p/i.width)*i.width,height:Math.ceil(y/i.height)*i.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===Ge.BC1RGBAUnorm||e===Ge.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ge.BC2RGBAUnorm||e===Ge.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ge.BC3RGBAUnorm||e===Ge.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ge.BC4RUnorm||e===Ge.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===Ge.BC5RGUnorm||e===Ge.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===Ge.BC6HRGBUFloat||e===Ge.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===Ge.BC7RGBAUnorm||e===Ge.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ge.ETC2RGB8Unorm||e===Ge.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ge.ETC2RGB8A1Unorm||e===Ge.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ge.ETC2RGBA8Unorm||e===Ge.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ge.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===Ge.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===Ge.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===Ge.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===Ge.ASTC4x4Unorm||e===Ge.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ge.ASTC5x4Unorm||e===Ge.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===Ge.ASTC5x5Unorm||e===Ge.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===Ge.ASTC6x5Unorm||e===Ge.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===Ge.ASTC6x6Unorm||e===Ge.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===Ge.ASTC8x5Unorm||e===Ge.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===Ge.ASTC8x6Unorm||e===Ge.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===Ge.ASTC8x8Unorm||e===Ge.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===Ge.ASTC10x5Unorm||e===Ge.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===Ge.ASTC10x6Unorm||e===Ge.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===Ge.ASTC10x8Unorm||e===Ge.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===Ge.ASTC10x10Unorm||e===Ge.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===Ge.ASTC12x10Unorm||e===Ge.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===Ge.ASTC12x12Unorm||e===Ge.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=sj.ClampToEdge;return e===Hx?t=sj.Repeat:e===Wx&&(t=sj.MirrorRepeat),t}_convertFilterMode(e){let t=pv.Linear;return(e===Ca||e===uye||e===AE)&&(t=pv.Nearest),t}_getBytesPerTexel(e){if(e===Ge.R8Unorm||e===Ge.R8Snorm||e===Ge.R8Uint||e===Ge.R8Sint)return 1;if(e===Ge.R16Uint||e===Ge.R16Sint||e===Ge.R16Float||e===Ge.RG8Unorm||e===Ge.RG8Snorm||e===Ge.RG8Uint||e===Ge.RG8Sint)return 2;if(e===Ge.R32Uint||e===Ge.R32Sint||e===Ge.R32Float||e===Ge.RG16Uint||e===Ge.RG16Sint||e===Ge.RG16Float||e===Ge.RGBA8Unorm||e===Ge.RGBA8UnormSRGB||e===Ge.RGBA8Snorm||e===Ge.RGBA8Uint||e===Ge.RGBA8Sint||e===Ge.BGRA8Unorm||e===Ge.BGRA8UnormSRGB||e===Ge.RGB9E5UFloat||e===Ge.RGB10A2Unorm||e===Ge.RG11B10UFloat||e===Ge.Depth32Float||e===Ge.Depth24Plus||e===Ge.Depth24PlusStencil8||e===Ge.Depth32FloatStencil8)return 4;if(e===Ge.RG32Uint||e===Ge.RG32Sint||e===Ge.RG32Float||e===Ge.RGBA16Uint||e===Ge.RGBA16Sint||e===Ge.RGBA16Float)return 8;if(e===Ge.RGBA32Uint||e===Ge.RGBA32Sint||e===Ge.RGBA32Float)return 16}_getTypedArrayType(e){if(e===Ge.R8Uint)return Uint8Array;if(e===Ge.R8Sint)return Int8Array;if(e===Ge.R8Unorm)return Uint8Array;if(e===Ge.R8Snorm)return Int8Array;if(e===Ge.RG8Uint)return Uint8Array;if(e===Ge.RG8Sint)return Int8Array;if(e===Ge.RG8Unorm)return Uint8Array;if(e===Ge.RG8Snorm)return Int8Array;if(e===Ge.RGBA8Uint)return Uint8Array;if(e===Ge.RGBA8Sint)return Int8Array;if(e===Ge.RGBA8Unorm)return Uint8Array;if(e===Ge.RGBA8Snorm)return Int8Array;if(e===Ge.R16Uint)return Uint16Array;if(e===Ge.R16Sint)return Int16Array;if(e===Ge.RG16Uint)return Uint16Array;if(e===Ge.RG16Sint)return Int16Array;if(e===Ge.RGBA16Uint)return Uint16Array;if(e===Ge.RGBA16Sint)return Int16Array;if(e===Ge.R16Float||e===Ge.RG16Float||e===Ge.RGBA16Float)return Uint16Array;if(e===Ge.R32Uint)return Uint32Array;if(e===Ge.R32Sint)return Int32Array;if(e===Ge.R32Float)return Float32Array;if(e===Ge.RG32Uint)return Uint32Array;if(e===Ge.RG32Sint)return Int32Array;if(e===Ge.RG32Float)return Float32Array;if(e===Ge.RGBA32Uint)return Uint32Array;if(e===Ge.RGBA32Sint)return Int32Array;if(e===Ge.RGBA32Float)return Float32Array;if(e===Ge.BGRA8Unorm||e===Ge.BGRA8UnormSRGB)return Uint8Array;if(e===Ge.RGB10A2Unorm||e===Ge.RGB9E5UFloat||e===Ge.RG11B10UFloat)return Uint32Array;if(e===Ge.Depth32Float)return Float32Array;if(e===Ge.Depth24Plus||e===Ge.Depth24PlusStencil8)return Uint32Array;if(e===Ge.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.isData3DTexture?t=$5e.ThreeD:t=$5e.TwoD,t}}function cW(s,e=null){const t=s.format,n=s.type,r=s.colorSpace,i=Us.getTransfer(r);let a;if(s.isCompressedTexture===!0||s.isCompressedArrayTexture===!0)switch(t){case KI:a=i===Vr?Ge.BC1RGBAUnormSRGB:Ge.BC1RGBAUnorm;break;case ZI:a=i===Vr?Ge.BC2RGBAUnormSRGB:Ge.BC2RGBAUnorm;break;case QI:a=i===Vr?Ge.BC3RGBAUnormSRGB:Ge.BC3RGBAUnorm;break;case NH:a=i===Vr?Ge.ETC2RGB8UnormSRGB:Ge.ETC2RGB8Unorm;break;case DH:a=i===Vr?Ge.ETC2RGBA8UnormSRGB:Ge.ETC2RGBA8Unorm;break;case OH:a=i===Vr?Ge.ASTC4x4UnormSRGB:Ge.ASTC4x4Unorm;break;case LH:a=i===Vr?Ge.ASTC5x4UnormSRGB:Ge.ASTC5x4Unorm;break;case FH:a=i===Vr?Ge.ASTC5x5UnormSRGB:Ge.ASTC5x5Unorm;break;case BH:a=i===Vr?Ge.ASTC6x5UnormSRGB:Ge.ASTC6x5Unorm;break;case UH:a=i===Vr?Ge.ASTC6x6UnormSRGB:Ge.ASTC6x6Unorm;break;case zH:a=i===Vr?Ge.ASTC8x5UnormSRGB:Ge.ASTC8x5Unorm;break;case VH:a=i===Vr?Ge.ASTC8x6UnormSRGB:Ge.ASTC8x6Unorm;break;case GH:a=i===Vr?Ge.ASTC8x8UnormSRGB:Ge.ASTC8x8Unorm;break;case jH:a=i===Vr?Ge.ASTC10x5UnormSRGB:Ge.ASTC10x5Unorm;break;case HH:a=i===Vr?Ge.ASTC10x6UnormSRGB:Ge.ASTC10x6Unorm;break;case WH:a=i===Vr?Ge.ASTC10x8UnormSRGB:Ge.ASTC10x8Unorm;break;case $H:a=i===Vr?Ge.ASTC10x10UnormSRGB:Ge.ASTC10x10Unorm;break;case qH:a=i===Vr?Ge.ASTC12x10UnormSRGB:Ge.ASTC12x10Unorm;break;case XH:a=i===Vr?Ge.ASTC12x12UnormSRGB:Ge.ASTC12x12Unorm;break;case nd:a=i===Vr?Ge.RGBA8UnormSRGB:Ge.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case nd:switch(n){case aE:a=Ge.RGBA8Snorm;break;case lE:a=Ge.RGBA16Sint;break;case dx:a=Ge.RGBA16Uint;break;case Zo:a=Ge.RGBA32Uint;break;case sc:a=Ge.RGBA32Sint;break;case lc:a=i===Vr?Ge.RGBA8UnormSRGB:Ge.RGBA8Unorm;break;case td:a=Ge.RGBA16Float;break;case Zu:a=Ge.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case s$:switch(n){case hye:a=Ge.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case o$:switch(n){case aE:a=Ge.R8Snorm;break;case lE:a=Ge.R16Sint;break;case dx:a=Ge.R16Uint;break;case Zo:a=Ge.R32Uint;break;case sc:a=Ge.R32Sint;break;case lc:a=Ge.R8Unorm;break;case td:a=Ge.R16Float;break;case Zu:a=Ge.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case yv:switch(n){case aE:a=Ge.RG8Snorm;break;case lE:a=Ge.RG16Sint;break;case dx:a=Ge.RG16Uint;break;case Zo:a=Ge.RG32Uint;break;case sc:a=Ge.RG32Sint;break;case lc:a=Ge.RG8Unorm;break;case td:a=Ge.RG16Float;break;case Zu:a=Ge.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case S1:switch(n){case dx:a=Ge.Depth16Unorm;break;case Zo:a=Ge.Depth24Plus;break;case Zu:a=Ge.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case Vg:switch(n){case G3:a=Ge.Depth24PlusStencil8;break;case Zu:e&&e.features.has(lW.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),a=Ge.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case a$:switch(n){case sc:a=Ge.R32Sint;break;case Zo:a=Ge.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case l$:switch(n){case sc:a=Ge.RG32Sint;break;case Zo:a=Ge.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case c$:switch(n){case sc:a=Ge.RGBA32Sint;break;case Zo:a=Ge.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}return a}const kqe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,Nqe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,q5e={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},Dqe=s=>{s=s.trim();const e=s.match(kqe);if(e!==null&&e.length===4){const t=e[2],n=[];let r=null;for(;(r=Nqe.exec(t))!==null;)n.push({name:r[1],type:r[2]});const i=[];for(let y=0;y<n.length;y++){const{name:x,type:S}=n[y];let M=S;M.startsWith("ptr")?M="pointer":(M.startsWith("texture")&&(M=S.split("<")[0]),M=q5e[M]),i.push(new W$(M,x))}const a=s.substring(e[0].length),c=e[3]||"void",u=e[1]!==void 0?e[1]:"";return{type:q5e[c]||c,inputs:i,name:u,inputsCode:t,blockCode:a,outputType:c}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class Oqe extends X${constructor(e){const{type:t,inputs:n,name:r,inputsCode:i,blockCode:a,outputType:c}=Dqe(e);super(t,n,r),this.inputsCode=i,this.blockCode=a,this.outputType=c}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class Lqe extends J6e{parseFunction(e){return new Oqe(e)}}const Y7=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},Fqe={[Og.READ_ONLY]:"read",[Og.WRITE_ONLY]:"write",[Og.READ_WRITE]:"read_write"},X5e={[Hx]:"repeat",[z3]:"clamp",[Wx]:"mirror"},PI={vertex:Y7?Y7.VERTEX:1,fragment:Y7?Y7.FRAGMENT:2,compute:Y7?Y7.COMPUTE:4},Y5e={instance:!0,swizzleAssign:!1,storageBuffer:!0},Bqe={"^^":"tsl_xor"},Uqe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},K5e={},Zh={tsl_xor:new Ma("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new Ma("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new Ma("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new Ma("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new Ma("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new Ma("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new Ma("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new Ma("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new Ma("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new Ma("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new Ma("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new Ma("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new Ma(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},Qw={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(Zh.pow_float=new Ma("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),Zh.pow_vec2=new Ma("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[Zh.pow_float]),Zh.pow_vec3=new Ma("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[Zh.pow_float]),Zh.pow_vec4=new Ma("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[Zh.pow_float]),Qw.pow_float="tsl_pow_float",Qw.pow_vec2="tsl_pow_vec2",Qw.pow_vec3="tsl_pow_vec3",Qw.pow_vec4="tsl_pow_vec4");let f7e="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(f7e+=`diagnostic( off, derivative_uniformity );
`);class zqe extends Q6e{constructor(e,t){super(e,t,new Lqe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==$g}_generateTextureSample(e,t,n,r,i=this.shaderStage){return i==="fragment"?r?`textureSample( ${t}, ${t}_sampler, ${n}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this._generateTextureSampleLevel(e,t,n,"0",r)}_generateVideoSample(e,t,n=this.shaderStage){if(n==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${n} shader.`)}_generateTextureSampleLevel(e,t,n,r,i){return this.isUnfilterable(e)===!1?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,r):this.generateTextureLod(e,t,n,i,r)}generateWrapFunction(e){const t=`tsl_coord_${X5e[e.wrapS]}S_${X5e[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let n=K5e[t];if(n===void 0){const r=[],i=e.isData3DTexture?"vec3f":"vec2f";let a=`fn ${t}( coord : ${i} ) -> ${i} {

	return ${i}(
`;const c=(u,p)=>{u===Hx?(r.push(Zh.repeatWrapping_float),a+=`		tsl_repeatWrapping_float( coord.${p} )`):u===z3?(r.push(Zh.clampWrapping_float),a+=`		tsl_clampWrapping_float( coord.${p} )`):u===Wx?(r.push(Zh.mirrorWrapping_float),a+=`		tsl_mirrorWrapping_float( coord.${p} )`):(a+=`		coord.${p}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${u}" for vertex shader.`))};c(e.wrapS,"x"),a+=`,
`,c(e.wrapT,"y"),e.isData3DTexture&&(a+=`,
`,c(e.wrapR,"z")),a+=`
	);

}
`,K5e[t]=n=new Ma(a,r)}return n.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,n){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let i=r.dimensionsSnippet[n];if(r.dimensionsSnippet[n]===void 0){let a,c;const{primarySamples:u}=this.renderer.backend.utils.getTextureSampleData(e),p=u>1;e.isData3DTexture?c="vec3<u32>":c="vec2<u32>",p||e.isVideoTexture||e.isStorageTexture?a=t:a=`${t}${n?`, u32( ${n} )`:""}`,i=new tk(new rk(`textureDimensions( ${a} )`,c)),r.dimensionsSnippet[n]=i,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(r.arrayLayerCount=new tk(new rk(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new tk(new rk("6u","u32")))}return i.build(this)}generateFilteredTexture(e,t,n,r="0u"){this._include("biquadraticTexture");const i=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,r);return`tsl_biquadraticTexture( ${t}, ${i}( ${n} ), ${a}, u32( ${r} ) )`}generateTextureLod(e,t,n,r,i="0u"){const a=this.generateWrapFunction(e),c=this.generateTextureDimension(e,t,i),u=e.isData3DTexture?"vec3":"vec2",p=`${u}<u32>( ${a}( ${n} ) * ${u}<f32>( ${c} ) )`;return this.generateTextureLoad(e,t,p,r,i)}generateTextureLoad(e,t,n,r,i="0u"){let a;return e.isVideoTexture===!0?a=`textureLoad( ${t}, ${n} )`:r?a=`textureLoad( ${t}, ${n}, ${r}, u32( ${i} ) )`:(a=`textureLoad( ${t}, ${n}, u32( ${i} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,t,n,r,i){let a;return r?a=`textureStore( ${t}, ${n}, ${r}, ${i} )`:a=`textureStore( ${t}, ${n}, ${i} )`,a}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===Zu||this.isSampleCompare(e)===!1&&e.minFilter===Ca&&e.magFilter===Ca||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,n,r,i=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(t,n,i):this.isUnfilterable(e)?a=this.generateTextureLod(e,t,n,r,"0",i):a=this._generateTextureSample(e,t,n,r,i),a}generateTextureGrad(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${a} shader.`)}generateTextureCompare(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${i}, ${r} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}generateTextureLevel(e,t,n,r,i,a=this.shaderStage){let c=null;return e.isVideoTexture===!0?c=this._generateVideoSample(t,n,a):c=this._generateTextureSampleLevel(e,t,n,r,i),c}generateTextureBias(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${a} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="storageTexture"||r==="texture3D"?n:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?n:n+".value":e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=Bqe[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?Og.READ_ONLY:e.access}getStorageAccess(e,t){return Fqe[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);if(a.uniformGPU===void 0){let c;const u=e.groupNode,p=u.name,y=this.getBindGroupArray(p,n);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let x=null;const S=this.getNodeAccess(e,n);if(t==="texture"||t==="storageTexture"?x=new dN(i.name,i.node,u,S):t==="cubeTexture"?x=new c7e(i.name,i.node,u,S):t==="texture3D"&&(x=new u7e(i.name,i.node,u,S)),x.store=e.isStorageTextureNode===!0,x.setVisibility(PI[n]),this.isUnfilterable(e.value)===!1&&x.store===!1){const M=new Eqe(`${i.name}_sampler`,i.node,u);M.setVisibility(PI[n]),y.push(M,x),c=[M,x]}else y.push(x),c=[x]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const x=t==="buffer"?a7e:Cqe,S=new x(e,u);S.setVisibility(PI[n]),y.push(S),c=S,i.name=r||"NodeBuffer_"+i.id}else{const x=this.uniformGroups[n]||(this.uniformGroups[n]={});let S=x[p];S===void 0&&(S=new l7e(p,u),S.setVisibility(PI[n]),x[p]=S,y.push(S)),c=this.getNodeUniform(i,t),S.addUniform(c)}a.uniformGPU=c}return i}getBuiltin(e,t,n,r=this.shaderStage){const i=this.builtins[r]||(this.builtins[r]=new Map);return i.has(e)===!1&&i.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(a.name+" : "+this.getType(a.type));let i=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${n.vars}
${n.code}
`;return n.result&&(i+=`	return ${n.result};
`),i+=`
}
`,i}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(n!==void 0)for(const r of n)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],n=this.builtins[e];if(n!==void 0)for(const{name:r,property:i,type:a}of n.values())t.push(`@builtin( ${r} ) ${i} : ${a}`);return t.join(`,
	`)}getScopedArray(e,t,n,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:n,scope:r,bufferType:i,bufferCount:a}of this.scopedArrays.values()){const c=this.getType(i);t.push(`var<${r}> ${n}: array< ${c}, ${a} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&t.push(n);const r=this.getAttributesArray();for(let i=0,a=r.length;i<a;i++){const c=r[i],u=c.name,p=this.getType(c.type);t.push(`@location( ${i} ) ${u} : ${p}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const n of e.members){const r=e.output?"@location( "+n.index+" ) ":"";let i=this.getType(n.type);n.atomic&&(i="atomic< "+i+" >"),t.push(`	${r+n.name} : ${i}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const n=this.structs[e];if(n.length>0){const r=[];for(const i of n){let a=`struct ${i.name} {
`;a+=this.getStructMembers(i),a+=`
};`,r.push(a)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,n=null){let r=`var ${t} : `;return n!==null?r+=this.generateArrayDeclaration(e,n):r+=this.getType(e),r}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const i=this.varyings,a=this.vars[e];for(let c=0;c<i.length;c++){const u=i[c];if(u.needsInterpolation){let p=`@location( ${c} )`;if(u.interpolationType){const y=u.interpolationSampling!==null?`, ${u.interpolationSampling} )`:" )";p+=` @interpolate( ${u.interpolationType}${y}`}else/^(int|uint|ivec|uvec)/.test(u.type)&&(p+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${p} ${u.name} : ${this.getType(u.type)}`)}else e==="vertex"&&a.includes(u)===!1&&a.push(u)}}const n=this.getBuiltins(e);n&&t.push(n);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,n=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&n.structTypeNode!==null,i=n.value&&n.value.array&&typeof n.value.itemSize=="number"&&n.value.array.length>n.value.itemSize;return r&&!i}getUniforms(e){const t=this.uniforms[e],n=[],r=[],i=[],a={};for(const u of t){const p=u.groupNode.name,y=this.bindingsIndexes[p];if(u.type==="texture"||u.type==="cubeTexture"||u.type==="storageTexture"||u.type==="texture3D"){const x=u.node.value;this.isUnfilterable(x)===!1&&u.node.isStorageTextureNode!==!0&&(this.isSampleCompare(x)?n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${u.name}_sampler : sampler_comparison;`):n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${u.name}_sampler : sampler;`));let S,M="";const{primarySamples:I}=this.renderer.backend.utils.getTextureSampleData(x);if(I>1&&(M="_multisampled"),x.isCubeTexture===!0)S="texture_cube<f32>";else if(x.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&x.compareFunction===null?S=`texture${M}_2d<f32>`:S=`texture_depth${M}_2d${x.isArrayTexture===!0?"_array":""}`;else if(x.isArrayTexture===!0||x.isDataArrayTexture===!0||x.isCompressedArrayTexture===!0)S="texture_2d_array<f32>";else if(x.isVideoTexture===!0)S="texture_external";else if(x.isData3DTexture===!0)S="texture_3d<f32>";else if(u.node.isStorageTextureNode===!0){const L=cW(x),B=this.getStorageAccess(u.node,e);S=`texture_storage_2d<${L}, ${B}>`}else{const L=this.getComponentTypeFromTexture(x).charAt(0);S=`texture${M}_2d<${L}32>`}n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${u.name} : ${S};`)}else if(u.type==="buffer"||u.type==="storageBuffer"||u.type==="indirectStorageBuffer"){const x=u.node,S=this.getType(x.getNodeType(this)),M=x.bufferCount,I=M>0&&u.type==="buffer"?", "+M:"",L=x.isStorageBufferNode?`storage, ${this.getStorageAccess(x,e)}`:"uniform";if(this.isCustomStruct(u))r.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var<${L}> ${u.name} : ${S};`);else{const A=`	value : array< ${x.isAtomic?`atomic<${S}>`:`${S}`}${I} >`;r.push(this._getWGSLStructBinding(u.name,A,L,y.binding++,y.group))}}else{const x=this.getType(this.getVectorType(u.type)),S=u.groupNode.name;(a[S]||(a[S]={index:y.binding++,id:y.group,snippets:[]})).snippets.push(`	${u.name} : ${x}`)}}for(const u in a){const p=a[u];i.push(this._getWGSLStructBinding(u,p.snippets.join(`,
`),"uniform",p.index,p.id))}let c=n.join(`
`);return c+=r.join(`
`),c+=i.join(`
`),c}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const i=this.flowNodes[t],a=i[i.length-1],c=a.outputNode,u=c!==void 0&&c.isOutputStructNode===!0;for(const p of i){const y=this.getFlowData(p),x=p.name;if(x&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${x}
`),r+=`${y.code}
	`,p===a&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${y.result};`;else if(t==="fragment")if(u)n.returnType=c.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",r+=`return ${y.result};`;else{let S="	@location(0) color: vec4<f32>";const M=this.getBuiltins("output");M&&(S+=`,
	`+M),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",S),n.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${y.result};

	return output;`}}}n.flow=r}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let n;return t!==null&&(n=this._getWGSLMethod(e+"_"+t)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getType(e){return Uqe[e]||e}isAvailable(e){let t=Y5e[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),Y5e[e]=t),t}_getWGSLMethod(e){return Zh[e]!==void 0&&this._include(e),Qw[e]}_include(e){const t=Zh[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${f7e}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${t} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${t}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${t});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,n,r=0,i=0){const a=e+"Struct";return`${this._getWGSLStruct(a,t)}
@binding( ${r} ) @group( ${i} )
var<${n}> ${e} : ${a};`}}class Vqe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=Ge.Depth24PlusStencil8:e.depth&&(t=Ge.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const i=this.backend.renderer,a=i.getRenderTarget();t=a?a.samples:i.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const n=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:n?1:t,isMSAA:n}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return vx.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return vx.LineList;if(e.isLine)return vx.LineStrip;if(e.isMesh)return vx.TriangleList}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),t===2&&(t=4)),t}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===lc)return Ge.BGRA8Unorm;if(e===td)return Ge.RGBA16Float;throw new Error("Unsupported outputType")}}const Gqe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),jqe=new Map([[Mye,["float16"]]]),Hqe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class Wqe{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),r=this.backend,i=r.get(n);let a=i.buffer;if(a===void 0){const c=r.device;let u=n.array;if(e.normalized===!1){if(u.constructor===Int16Array||u.constructor===Int8Array)u=new Int32Array(u);else if((u.constructor===Uint16Array||u.constructor===Uint8Array)&&(u=new Uint32Array(u),t&GPUBufferUsage.INDEX))for(let x=0;x<u.length;x++)u[x]===65535&&(u[x]=4294967295)}if(n.array=u,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){u=new u.constructor(n.count*4);for(let x=0;x<n.count;x++)u.set(n.array.subarray(x*3,x*3+3),x*4);n.itemSize=4,n.array=u,i._force3to4BytesAlignment=!0}const p=u.byteLength,y=p+(4-p%4)%4;a=c.createBuffer({label:n.name,size:y,usage:t,mappedAtCreation:!0}),new u.constructor(a.getMappedRange()).set(u),a.unmap(),i.buffer=a}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,r=n.device,i=n.get(t),a=n.get(t).buffer;let c=t.array;if(i._force3to4BytesAlignment===!0){c=new c.constructor(t.count*4);for(let y=0;y<t.count;y++)c.set(t.array.subarray(y*3,y*3+3),y*4);t.array=c}const u=this._isTypedArray(c),p=t.updateRanges;if(p.length===0)r.queue.writeBuffer(a,0,c,0);else{const y=u?1:c.BYTES_PER_ELEMENT;for(let x=0,S=p.length;x<S;x++){const M=p[x];let I,L;if(i._force3to4BytesAlignment===!0){const A=Math.floor(M.start/3),V=Math.ceil(M.count/3);I=A*4*y,L=V*4*y}else I=M.start*y,L=M.count*y;const B=I*(u?c.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(a,B,c,I,L)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let r=0;r<t.length;r++){const i=t[r],a=i.array.BYTES_PER_ELEMENT,c=this._getBufferAttribute(i);let u=n.get(c);if(u===void 0){let x,S;i.isInterleavedBufferAttribute===!0?(x=i.data.stride*a,S=i.data.isInstancedInterleavedBuffer?AI.Instance:AI.Vertex):(x=i.itemSize*a,S=i.isInstancedBufferAttribute?AI.Instance:AI.Vertex),i.normalized===!1&&(i.array.constructor===Int16Array||i.array.constructor===Uint16Array)&&(x=4),u={arrayStride:x,attributes:[],stepMode:S},n.set(c,u)}const p=this._getVertexFormat(i),y=i.isInterleavedBufferAttribute===!0?i.offset*a:0;u.attributes.push({shaderLocation:r,offset:y,format:p})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,i=t.get(this._getBufferAttribute(e)).buffer,a=i.size,c=n.createBuffer({label:`${e.name}_readback`,size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),u=n.createCommandEncoder({label:`readback_encoder_${e.name}`});u.copyBufferToBuffer(i,0,c,0,a);const p=u.finish();n.queue.submit([p]),await c.mapAsync(GPUMapMode.READ);const y=c.getMappedRange(),x=new e.array.constructor(y.slice(0));return c.unmap(),x.buffer}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,r=e.array.constructor,i=e.constructor;let a;if(t===1)a=Hqe.get(r);else{const u=(jqe.get(i)||Gqe.get(r))[n?1:0];if(u){const p=r.BYTES_PER_ELEMENT*t,x=Math.floor((p+3)/4)*4/r.BYTES_PER_ELEMENT;if(x%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");a=`${u}x${x}`}}return a||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),a}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class $qe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,n=t.device,r=[];let i=0;for(const a of e.bindings){const c={binding:i++,visibility:a.visibility};if(a.isUniformBuffer||a.isStorageBuffer){const u={};a.isStorageBuffer&&(a.visibility&4&&(a.access===Og.READ_WRITE||a.access===Og.WRITE_ONLY)?u.type=oj.Storage:u.type=oj.ReadOnlyStorage),c.buffer=u}else if(a.isSampler){const u={};a.texture.isDepthTexture&&(a.texture.compareFunction!==null?u.type=W5e.Comparison:t.compatibilityMode&&(u.type=W5e.NonFiltering)),c.sampler=u}else if(a.isSampledTexture&&a.texture.isVideoTexture)c.externalTexture={};else if(a.isSampledTexture&&a.store){const u={};u.format=this.backend.get(a.texture).texture.format;const p=a.access;p===Og.READ_WRITE?u.access=aj.ReadWrite:p===Og.WRITE_ONLY?u.access=aj.WriteOnly:u.access=aj.ReadOnly,c.storageTexture=u}else if(a.isSampledTexture){const u={},{primarySamples:p}=t.utils.getTextureSampleData(a.texture);if(p>1&&(u.multisampled=!0,a.texture.isDepthTexture||(u.sampleType=Z8.UnfilterableFloat)),a.texture.isDepthTexture)t.compatibilityMode&&a.texture.compareFunction===null?u.sampleType=Z8.UnfilterableFloat:u.sampleType=Z8.Depth;else if(a.texture.isDataTexture||a.texture.isDataArrayTexture||a.texture.isData3DTexture){const y=a.texture.type;y===sc?u.sampleType=Z8.SInt:y===Zo?u.sampleType=Z8.UInt:y===Zu&&(this.backend.hasFeature("float32-filterable")?u.sampleType=Z8.Float:u.sampleType=Z8.UnfilterableFloat)}a.isSampledCubeTexture?u.viewDimension=Qa.Cube:a.texture.isArrayTexture||a.texture.isDataArrayTexture||a.texture.isCompressedArrayTexture?u.viewDimension=Qa.TwoDArray:a.isSampledTexture3D&&(u.viewDimension=Qa.ThreeD),c.texture=u}else console.error(`WebGPUBindingUtils: Unsupported binding "${a}".`);r.push(c)}return n.createBindGroupLayout({entries:r})}createBindings(e,t,n,r=0){const{backend:i,bindGroupLayoutCache:a}=this,c=i.get(e);let u=a.get(e.bindingsReference);u===void 0&&(u=this.createBindingsLayout(e),a.set(e.bindingsReference,u));let p;n>0&&(c.groups===void 0&&(c.groups=[],c.versions=[]),c.versions[n]===r&&(p=c.groups[n])),p===void 0&&(p=this.createBindGroup(e,u),n>0&&(c.groups[n]=p,c.versions[n]=r)),c.group=p,c.layout=u}updateBinding(e){const t=this.backend,n=t.device,r=e.buffer,i=t.get(e).buffer;n.queue.writeBuffer(i,0,r,0)}createBindGroupIndex(e,t){const r=this.backend.device,i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a=e[0],c=r.createBuffer({label:"bindingCameraIndex_"+a,size:16,usage:i});r.queue.writeBuffer(c,0,e,0);const u=[{binding:0,resource:{buffer:c}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+a,layout:t,entries:u})}createBindGroup(e,t){const n=this.backend,r=n.device;let i=0;const a=[];for(const c of e.bindings){if(c.isUniformBuffer){const u=n.get(c);if(u.buffer===void 0){const p=c.byteLength,y=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,x=r.createBuffer({label:"bindingBuffer_"+c.name,size:p,usage:y});u.buffer=x}a.push({binding:i,resource:{buffer:u.buffer}})}else if(c.isStorageBuffer){const u=n.get(c);if(u.buffer===void 0){const p=c.attribute;u.buffer=n.get(p).buffer}a.push({binding:i,resource:{buffer:u.buffer}})}else if(c.isSampler){const u=n.get(c.texture);a.push({binding:i,resource:u.sampler})}else if(c.isSampledTexture){const u=n.get(c.texture);let p;if(u.externalTexture!==void 0)p=r.importExternalTexture({source:u.externalTexture});else{const y=c.store?1:u.texture.mipLevelCount,x=`view-${u.texture.width}-${u.texture.height}-${y}`;if(p=u[x],p===void 0){const S=Sqe.All;let M;c.isSampledCubeTexture?M=Qa.Cube:c.isSampledTexture3D?M=Qa.ThreeD:c.texture.isArrayTexture||c.texture.isDataArrayTexture||c.texture.isCompressedArrayTexture?M=Qa.TwoDArray:M=Qa.TwoD,p=u[x]=u.texture.createView({aspect:S,dimension:M,mipLevelCount:y})}}a.push({binding:i,resource:p})}i++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:a})}}class qqe{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:r,geometry:i,pipeline:a}=e,{vertexProgram:c,fragmentProgram:u}=a,p=this.backend,y=p.device,x=p.utils,S=p.get(a),M=[];for(const Be of e.getBindings()){const tt=p.get(Be);M.push(tt.layout)}const I=p.attributeUtils.createShaderVertexBuffers(e);let L;r.blending!==jx&&(r.blending!==Ug||r.transparent!==!1)&&(L=this._getBlending(r));let B={};r.stencilWrite===!0&&(B={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const A=this._getColorWriteMask(r),V=[];if(e.context.textures!==null){const Be=e.context.textures;for(let tt=0;tt<Be.length;tt++){const st=x.getTextureFormatGPU(Be[tt]);V.push({format:st,blend:L,writeMask:A})}}else{const Be=x.getCurrentColorFormat(e.context);V.push({format:Be,blend:L,writeMask:A})}const X=p.get(c).module,P=p.get(u).module,te=this._getPrimitiveState(n,i,r),oe=this._getDepthCompare(r),ie=x.getCurrentDepthStencilFormat(e.context),K=this._getSampleCount(e.context),re={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},X,{buffers:I}),fragment:Object.assign({},P,{targets:V}),primitive:te,multisample:{count:K,alphaToCoverageEnabled:r.alphaToCoverage&&K>1},layout:y.createPipelineLayout({bindGroupLayouts:M})},se={},q=e.context.depth,De=e.context.stencil;if((q===!0||De===!0)&&(q===!0&&(se.format=ie,se.depthWriteEnabled=r.depthWrite,se.depthCompare=oe),De===!0&&(se.stencilFront=B,se.stencilBack={},se.stencilReadMask=r.stencilFuncMask,se.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(se.depthBias=r.polygonOffsetUnits,se.depthBiasSlopeScale=r.polygonOffsetFactor,se.depthBiasClamp=0),re.depthStencil=se),t===null)S.pipeline=y.createRenderPipeline(re);else{const Be=new Promise(tt=>{y.createRenderPipelineAsync(re).then(st=>{S.pipeline=st,tt()})});t.push(Be)}}createBundleEncoder(e,t="renderBundleEncoder"){const n=this.backend,{utils:r,device:i}=n,a=r.getCurrentDepthStencilFormat(e),c=r.getCurrentColorFormat(e),u=this._getSampleCount(e),p={label:t,colorFormats:[c],depthStencilFormat:a,sampleCount:u};return i.createRenderBundleEncoder(p)}createComputePipeline(e,t){const n=this.backend,r=n.device,i=n.get(e.computeProgram).module,a=n.get(e),c=[];for(const u of t){const p=n.get(u);c.push(p.layout)}a.pipeline=r.createComputePipeline({compute:i,layout:r.createPipelineLayout({bindGroupLayouts:c})})}_getBlending(e){let t,n;const r=e.blending,i=e.blendSrc,a=e.blendDst,c=e.blendEquation;if(r===oE){const u=e.blendSrcAlpha!==null?e.blendSrcAlpha:i,p=e.blendDstAlpha!==null?e.blendDstAlpha:a,y=e.blendEquationAlpha!==null?e.blendEquationAlpha:c;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(c)},n={srcFactor:this._getBlendFactor(u),dstFactor:this._getBlendFactor(p),operation:this._getBlendOperation(y)}}else{const u=e.premultipliedAlpha,p=(y,x,S,M)=>{t={srcFactor:y,dstFactor:x,operation:K8.Add},n={srcFactor:S,dstFactor:M,operation:K8.Add}};if(u)switch(r){case Ug:p(Hr.One,Hr.OneMinusSrcAlpha,Hr.One,Hr.OneMinusSrcAlpha);break;case xk:p(Hr.One,Hr.One,Hr.One,Hr.One);break;case _k:p(Hr.Zero,Hr.OneMinusSrc,Hr.Zero,Hr.One);break;case bk:p(Hr.Zero,Hr.Src,Hr.Zero,Hr.SrcAlpha);break}else switch(r){case Ug:p(Hr.SrcAlpha,Hr.OneMinusSrcAlpha,Hr.One,Hr.OneMinusSrcAlpha);break;case xk:p(Hr.SrcAlpha,Hr.One,Hr.SrcAlpha,Hr.One);break;case _k:p(Hr.Zero,Hr.OneMinusSrc,Hr.Zero,Hr.One);break;case bk:p(Hr.Zero,Hr.Src,Hr.Zero,Hr.Src);break}}if(t!==void 0&&n!==void 0)return{color:t,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case N3:t=Hr.Zero;break;case Yve:t=Hr.One;break;case Kve:t=Hr.Src;break;case Zve:t=Hr.OneMinusSrc;break;case Sk:t=Hr.SrcAlpha;break;case wk:t=Hr.OneMinusSrcAlpha;break;case eye:t=Hr.Dst;break;case tye:t=Hr.OneMinusDst;break;case Qve:t=Hr.DstAlpha;break;case Jve:t=Hr.OneMinusDstAlpha;break;case nye:t=Hr.SrcAlphaSaturated;break;case KBe:t=Hr.Constant;break;case ZBe:t=Hr.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case RBe:t=M0.Never;break;case YH:t=M0.Always;break;case IBe:t=M0.Less;break;case NBe:t=M0.LessEqual;break;case kBe:t=M0.Equal;break;case LBe:t=M0.GreaterEqual;break;case DBe:t=M0.Greater;break;case OBe:t=M0.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case sv:t=C3.Keep;break;case wBe:t=C3.Zero;break;case EBe:t=C3.Replace;break;case PBe:t=C3.Invert;break;case TBe:t=C3.IncrementClamp;break;case MBe:t=C3.DecrementClamp;break;case CBe:t=C3.IncrementWrap;break;case ABe:t=C3.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case Nf:t=K8.Add;break;case qve:t=K8.Subtract;break;case Xve:t=K8.ReverseSubtract;break;case aBe:t=K8.Min;break;case lBe:t=K8.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const r={},i=this.backend.utils;switch(r.topology=i.getPrimitiveTopology(e,n),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?Kx.Uint16:Kx.Uint32),n.side){case Bg:r.frontFace=rj.CCW,r.cullMode=ij.Back;break;case eu:r.frontFace=rj.CCW,r.cullMode=ij.Front;break;case Sx:r.frontFace=rj.CCW,r.cullMode=ij.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side);break}return r}_getColorWriteMask(e){return e.colorWrite===!0?H5e.All:H5e.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=M0.Always;else{const n=e.depthFunc;switch(n){case rye:t=M0.Never;break;case iye:t=M0.Always;break;case sye:t=M0.Less;break;case Ek:t=M0.LessEqual;break;case oye:t=M0.Equal;break;case aye:t=M0.GreaterEqual;break;case lye:t=M0.Greater;break;case cye:t=M0.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class Xqe extends d7e{constructor(e,t,n=2048){super(n),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return qg(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,n=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,n);const i=r.finish();if(this.device.queue.submit([i]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,n),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const a=new BigUint64Array(this.resultBuffer.getMappedRange(0,n));let c=0;for(const[,u]of e){const p=a[u],y=a[u+1],x=Number(y-p)/1e6;c+=x}return this.resultBuffer.unmap(),this.lastValue=c,c}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class Yqe extends h7e{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new Vqe(this),this.attributeUtils=new Wqe(this),this.bindingUtils=new $qe(this),this.pipelineUtils=new qqe(this),this.textureUtils=new Iqe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(t.device===void 0){const a={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},c=typeof navigator<"u"?await navigator.gpu.requestAdapter(a):null;if(c===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const u=Object.values(lW),p=[];for(const x of u)c.features.has(x)&&p.push(x);const y={requiredFeatures:p,requiredLimits:t.requiredLimits};n=await c.requestDevice(y)}else n=t.device;n.lost.then(a=>{const c={api:"WebGPU",message:a.message||"Unknown reason",reason:a.reason||null,originalEvent:a};e.onDeviceLost(c)});const r=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=n,this.context=r;const i=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(lW.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:i}),this.updateSize()}get coordinateSystem(){return X3}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const n=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(n.depth,n.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const n=e.renderTarget,r=this.get(n);let i=r.descriptors;if(i===void 0||r.width!==n.width||r.height!==n.height||r.dimensions!==n.dimensions||r.activeMipmapLevel!==e.activeMipmapLevel||r.activeCubeFace!==e.activeCubeFace||r.samples!==n.samples){i={},r.descriptors=i;const p=()=>{n.removeEventListener("dispose",p),this.delete(n)};n.hasEventListener("dispose",p)===!1&&n.addEventListener("dispose",p)}const a=e.getCacheKey();let c=i[a];if(c===void 0){const p=e.textures,y=[];let x;const S=this._isRenderCameraDepthArray(e);for(let M=0;M<p.length;M++){const I=this.get(p[M]),L={label:`colorAttachment_${M}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:Qa.TwoD};if(n.isRenderTarget3D)x=e.activeCubeFace,L.baseArrayLayer=0,L.dimension=Qa.ThreeD,L.depthOrArrayLayers=p[M].image.depth;else if(n.isRenderTarget&&p[M].image.depth>1)if(S===!0){const B=e.camera.cameras;for(let A=0;A<B.length;A++){const V={...L,baseArrayLayer:A,arrayLayerCount:1,dimension:Qa.TwoD},X=I.texture.createView(V);y.push({view:X,resolveTarget:void 0,depthSlice:void 0})}}else L.dimension=Qa.TwoDArray,L.depthOrArrayLayers=p[M].image.depth;if(S!==!0){const B=I.texture.createView(L);let A,V;I.msaaTexture!==void 0?(A=I.msaaTexture.createView(),V=B):(A=B,V=void 0),y.push({view:A,resolveTarget:V,depthSlice:x})}}if(c={textureViews:y},e.depth){const M=this.get(e.depthTexture),I={};e.depthTexture.isArrayTexture&&(I.dimension=Qa.TwoD,I.arrayLayerCount=1,I.baseArrayLayer=e.activeCubeFace),c.depthStencilView=M.texture.createView(I)}i[a]=c,r.width=n.width,r.height=n.height,r.samples=n.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace,r.dimensions=n.dimensions}const u={colorAttachments:[]};for(let p=0;p<c.textureViews.length;p++){const y=c.textureViews[p];let x={r:0,g:0,b:0,a:1};p===0&&t.clearValue&&(x=t.clearValue),u.colorAttachments.push({view:y.view,depthSlice:y.depthSlice,resolveTarget:y.resolveTarget,loadOp:t.loadOp||ns.Load,storeOp:t.storeOp||rc.Store,clearValue:x})}return c.depthStencilView&&(u.depthStencilAttachment={view:c.depthStencilView}),u}beginRender(e){const t=this.get(e),n=this.device,r=e.occlusionQueryCount;let i;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,i=n.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=i,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let a;e.textures===null?a=this._getDefaultRenderPassDescriptor():a=this._getRenderPassDescriptor(e,{loadOp:ns.Load}),this.initTimestampQuery(e,a),a.occlusionQuerySet=i;const c=a.depthStencilAttachment;if(e.textures!==null){const p=a.colorAttachments;for(let y=0;y<p.length;y++){const x=p[y];e.clearColor?(x.clearValue=y===0?e.clearColorValue:{r:0,g:0,b:0,a:1},x.loadOp=ns.Clear):x.loadOp=ns.Load,x.storeOp=rc.Store}}else{const p=a.colorAttachments[0];e.clearColor?(p.clearValue=e.clearColorValue,p.loadOp=ns.Clear):p.loadOp=ns.Load,p.storeOp=rc.Store}e.depth&&(e.clearDepth?(c.depthClearValue=e.clearDepthValue,c.depthLoadOp=ns.Clear):c.depthLoadOp=ns.Load,c.depthStoreOp=rc.Store),e.stencil&&(e.clearStencil?(c.stencilClearValue=e.clearStencilValue,c.stencilLoadOp=ns.Clear):c.stencilLoadOp=ns.Load,c.stencilStoreOp=rc.Store);const u=n.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const p=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==p.length?this._createDepthLayerDescriptors(e,t,a,p):this._updateDepthLayerDescriptors(e,t,p),t.bundleEncoders=[],t.bundleSets=[];for(let y=0;y<p.length;y++){const x=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+y),S={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(x),t.bundleSets.push(S)}t.currentPass=null}else{const p=u.beginRenderPass(a);if(t.currentPass=p,e.viewport&&this.updateViewport(e),e.scissor){const{x:y,y:x,width:S,height:M}=e.scissorValue;p.setScissorRect(y,x,S,M)}}t.descriptor=a,t.encoder=u,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,n,r){const i=n.depthStencilAttachment;t.layerDescriptors=[];const a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let c=0;c<r.length;c++){const u={...n,colorAttachments:[{...n.colorAttachments[0],view:n.colorAttachments[c].view}]};if(n.depthStencilAttachment){const p=c;a.viewCache[p]||(a.viewCache[p]=a.texture.createView({dimension:Qa.TwoD,baseArrayLayer:c,arrayLayerCount:1})),u.depthStencilAttachment={view:a.viewCache[p],depthLoadOp:i.depthLoadOp||ns.Clear,depthStoreOp:i.depthStoreOp||rc.Store,depthClearValue:i.depthClearValue||1},e.stencil&&(u.depthStencilAttachment.stencilLoadOp=i.stencilLoadOp,u.depthStencilAttachment.stencilStoreOp=i.stencilStoreOp,u.depthStencilAttachment.stencilClearValue=i.stencilClearValue)}else u.depthStencilAttachment={...i};t.layerDescriptors.push(u)}}_updateDepthLayerDescriptors(e,t,n){for(let r=0;r<n.length;r++){const i=t.layerDescriptors[r];if(i.depthStencilAttachment){const a=i.depthStencilAttachment;e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=ns.Clear):a.depthLoadOp=ns.Load),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=ns.Clear):a.stencilLoadOp=ns.Load)}}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const i=[];for(let a=0;a<t.bundleEncoders.length;a++){const c=t.bundleEncoders[a];i.push(c.finish())}for(let a=0;a<t.layerDescriptors.length;a++)if(a<i.length){const c=t.layerDescriptors[a],u=r.beginRenderPass(c);if(e.viewport){const{x:p,y,width:x,height:S,minDepth:M,maxDepth:I}=e.viewportValue;u.setViewport(p,y,x,S,M,I)}if(e.scissor){const{x:p,y,width:x,height:S}=e.scissorValue;u.setScissorRect(p,y,x,S)}u.executeBundles([i[a]]),u.end()}}else t.currentPass&&t.currentPass.end();if(n>0){const i=n*8;let a=this.occludedResolveCache.get(i);a===void 0&&(a=this.device.createBuffer({size:i,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(i,a));const c=this.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,a,0),t.encoder.copyBufferToBuffer(a,0,c,0,i),t.occlusionQueryBuffer=c,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const i=e.textures;for(let a=0;a<i.length;a++){const c=i[a];c.generateMipmaps===!0&&this.textureUtils.generateMipmaps(c)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const i=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const a=n.getMappedRange(),c=new BigUint64Array(a);for(let u=0;u<r.length;u++)c[u]===BigInt(0)&&i.add(r[u]);n.destroy(),t.occluded=i}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:i,height:a,minDepth:c,maxDepth:u}=e.viewportValue;t.setViewport(n,r,i,a,c,u)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,n,r=null){const i=this.device,a=this.renderer;let c=[],u,p,y,x;if(e){const I=this.getClearColor();p={r:I.r,g:I.g,b:I.b,a:I.a}}if(r===null){y=a.depth,x=a.stencil;const I=this._getDefaultRenderPassDescriptor();if(e){c=I.colorAttachments;const L=c[0];L.clearValue=p,L.loadOp=ns.Clear,L.storeOp=rc.Store}(y||x)&&(u=I.depthStencilAttachment)}else{y=r.depth,x=r.stencil;const I={loadOp:e?ns.Clear:ns.Load,clearValue:e?p:void 0};y&&(I.depthLoadOp=t?ns.Clear:ns.Load,I.depthClearValue=t?a.getClearDepth():void 0,I.depthStoreOp=rc.Store),x&&(I.stencilLoadOp=n?ns.Clear:ns.Load,I.stencilClearValue=n?a.getClearStencil():void 0,I.stencilStoreOp=rc.Store);const L=this._getRenderPassDescriptor(r,I);c=L.colorAttachments,u=L.depthStencilAttachment}y&&u&&u.depthLoadOp===void 0&&(t?(u.depthLoadOp=ns.Clear,u.depthClearValue=a.getClearDepth(),u.depthStoreOp=rc.Store):(u.depthLoadOp=ns.Load,u.depthStoreOp=rc.Store)),x&&u&&u.stencilLoadOp===void 0&&(n?(u.stencilLoadOp=ns.Clear,u.stencilClearValue=a.getClearStencil(),u.stencilStoreOp=rc.Store):(u.stencilLoadOp=ns.Load,u.stencilStoreOp=rc.Store));const S=i.createCommandEncoder({label:"clear"});S.beginRenderPass({colorAttachments:c,depthStencilAttachment:u}).end(),i.queue.submit([S.finish()])}beginCompute(e){const t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(e,n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,r){const{passEncoderGPU:i}=this.get(e),a=this.get(r).pipeline;this.pipelineUtils.setPipeline(i,a);for(let y=0,x=n.length;y<x;y++){const S=n[y],M=this.get(S);i.setBindGroup(y,M.group)}const c=this.device.limits.maxComputeWorkgroupsPerDimension,u=this.get(t);u.dispatchSize===void 0&&(u.dispatchSize={x:0,y:1,z:1});const{dispatchSize:p}=u;t.dispatchCount>c?(p.x=Math.min(t.dispatchCount,c),p.y=Math.ceil(t.dispatchCount/c)):p.x=t.dispatchCount,i.dispatchWorkgroups(p.x,p.y,p.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:n,material:r,context:i,pipeline:a}=e,c=e.getBindings(),u=this.get(i),p=this.get(a).pipeline,y=e.getIndex(),x=y!==null,S=e.getDrawParameters();if(S===null)return;const M=(L,B)=>{this.pipelineUtils.setPipeline(L,p),B.pipeline=p;const A=B.bindingGroups;for(let X=0,P=c.length;X<P;X++){const te=c[X],oe=this.get(te);A[te.index]!==te.id&&(L.setBindGroup(te.index,oe.group),A[te.index]=te.id)}if(x===!0&&B.index!==y){const X=this.get(y).buffer,P=y.array instanceof Uint16Array?Kx.Uint16:Kx.Uint32;L.setIndexBuffer(X,P),B.index=y}const V=e.getVertexBuffers();for(let X=0,P=V.length;X<P;X++){const te=V[X];if(B.attributes[X]!==te){const oe=this.get(te).buffer;L.setVertexBuffer(X,oe),B.attributes[X]=te}}i.stencil===!0&&r.stencilWrite===!0&&u.currentStencilRef!==r.stencilRef&&(L.setStencilReference(r.stencilRef),u.currentStencilRef=r.stencilRef)},I=(L,B)=>{if(M(L,B),n.isBatchedMesh===!0){const A=n._multiDrawStarts,V=n._multiDrawCounts,X=n._multiDrawCount,P=n._multiDrawInstances;P!==null&&qg("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let te=0;te<X;te++){const oe=P?P[te]:1,ie=oe>1?0:te;x===!0?L.drawIndexed(V[te],oe,A[te]/y.array.BYTES_PER_ELEMENT,0,ie):L.draw(V[te],oe,A[te],ie),t.update(n,V[te],oe)}}else if(x===!0){const{vertexCount:A,instanceCount:V,firstVertex:X}=S,P=e.getIndirect();if(P!==null){const te=this.get(P).buffer;L.drawIndexedIndirect(te,0)}else L.drawIndexed(A,V,X,0,0);t.update(n,A,V)}else{const{vertexCount:A,instanceCount:V,firstVertex:X}=S,P=e.getIndirect();if(P!==null){const te=this.get(P).buffer;L.drawIndirect(te,0)}else L.draw(A,V,X,0);t.update(n,A,V)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const L=this.get(e.camera),B=e.camera.cameras,A=e.getBindingGroup("cameraIndex");if(L.indexesGPU===void 0||L.indexesGPU.length!==B.length){const X=this.get(A),P=[],te=new Uint32Array([0,0,0,0]);for(let oe=0,ie=B.length;oe<ie;oe++){te[0]=oe;const K=this.bindingUtils.createBindGroupIndex(te,X.layout);P.push(K)}L.indexesGPU=P}const V=this.renderer.getPixelRatio();for(let X=0,P=B.length;X<P;X++){const te=B[X];if(n.layers.test(te.layers)){const oe=te.viewport;let ie=u.currentPass,K=u.currentSets;if(u.bundleEncoders){const re=u.bundleEncoders[X],se=u.bundleSets[X];ie=re,K=se}oe&&ie.setViewport(Math.floor(oe.x*V),Math.floor(oe.y*V),Math.floor(oe.width*V),Math.floor(oe.height*V),i.viewportValue.minDepth,i.viewportValue.maxDepth),A&&L.indexesGPU&&(ie.setBindGroup(A.index,L.indexesGPU[X]),K.bindingGroups[A.index]=A.id),I(ie,K)}}}else if(u.currentPass){if(u.occlusionQuerySet!==void 0){const L=u.lastOcclusionObject;L!==n&&(L!==null&&L.occlusionTest===!0&&(u.currentPass.endOcclusionQuery(),u.occlusionQueryIndex++),n.occlusionTest===!0&&(u.currentPass.beginOcclusionQuery(u.occlusionQueryIndex),u.occlusionQueryObjects[u.occlusionQueryIndex]=n),u.lastOcclusionObject=n)}I(u.currentPass,u.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:r}=e,i=this.utils,a=i.getSampleCountRenderContext(e.context),c=i.getCurrentColorSpace(e.context),u=i.getCurrentColorFormat(e.context),p=i.getCurrentDepthStencilFormat(e.context),y=i.getPrimitiveTopology(n,r);let x=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==a||t.colorSpace!==c||t.colorFormat!==u||t.depthStencilFormat!==p||t.primitiveTopology!==y||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=a,t.colorSpace=c,t.colorFormat=u,t.depthStencilFormat=p,t.primitiveTopology=y,t.clippingContextCacheKey=e.clippingContextCacheKey,x=!0),x}getRenderCacheKey(e){const{object:t,material:n}=e,r=this.utils,i=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,r.getSampleCountRenderContext(i),r.getCurrentColorSpace(i),r.getCurrentColorFormat(i),r.getCurrentDepthStencilFormat(i),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,i,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,a)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n]||(this.timestampQueryPool[n]=new Xqe(this.device,n,2048));const r=this.timestampQueryPool[n],i=r.allocateQueriesForContext(e);t.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:i,endOfPassWriteIndex:i+1}}createNodeBuilder(e,t){return new zqe(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),i=n.currentPass.finish();this.get(t).bundleGPU=i,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){let c=0,u=0,p=0,y=0,x=0,S=0,M=e.image.width,I=e.image.height,L=1;n!==null&&(n.isBox3===!0?(y=n.min.x,x=n.min.y,S=n.min.z,M=n.max.x-n.min.x,I=n.max.y-n.min.y,L=n.max.z-n.min.z):(y=n.min.x,x=n.min.y,M=n.max.x-n.min.x,I=n.max.y-n.min.y,L=1)),r!==null&&(c=r.x,u=r.y,p=r.z||0);const B=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),A=this.get(e).texture,V=this.get(t).texture;B.copyTextureToTexture({texture:A,mipLevel:i,origin:{x:y,y:x,z:S}},{texture:V,mipLevel:a,origin:{x:c,y:u,z:p}},[M,I,L]),this.device.queue.submit([B.finish()]),a===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,n){const r=this.get(t);let i=null;t.renderTarget?e.isDepthTexture?i=this.get(t.depthTexture).texture:i=this.get(t.textures[0]).texture:e.isDepthTexture?i=this.textureUtils.getDepthBuffer(t.depth,t.stencil):i=this.context.getCurrentTexture();const a=this.get(e).texture;if(i.format!==a.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",i.format,a.format);return}let c;if(r.currentPass?(r.currentPass.end(),c=r.encoder):c=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),c.copyTextureToTexture({texture:i,origin:[n.x,n.y,0]},{texture:a},[n.z,n.w]),r.currentPass){const{descriptor:u}=r;for(let p=0;p<u.colorAttachments.length;p++)u.colorAttachments[p].loadOp=ns.Load;if(t.depth&&(u.depthStencilAttachment.depthLoadOp=ns.Load),t.stencil&&(u.depthStencilAttachment.stencilLoadOp=ns.Load),r.currentPass=c.beginRenderPass(u),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:p,y,width:x,height:S}=t.scissorValue;r.currentPass.setScissorRect(p,y,x,S)}}else this.device.queue.submit([c.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}}class Kqe extends tu{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Zi(16777215),this.specular=new Zi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=q3,this.normalScale=new ci(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ad,this.combine=Xk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const Zqe=new Kqe;class Qqe extends pa{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(Zqe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new q$(t):null}setupLightingModel(){return new t7e}setupVariants(){const e=(this.shininessNode?Ut(this.shininessNode):$Ge).max(1e-4);eW.assign(e);const t=this.specularNode||XGe;qu.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}class p7e extends tu{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Zi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=q3,this.normalScale=new ci(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ad,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const Jqe=new p7e;class m7e extends pa{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(Jqe),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new f$e(t):null}setupLightingModel(){return new r7e}setupSpecular(){const e=Ks(zt(.04),Ki.rgb,Nk);qu.assign(e),Ok.assign(1)}setupVariants(){const e=this.metalnessNode?Ut(this.metalnessNode):ZGe;Nk.assign(e);let t=this.roughnessNode?Ut(this.roughnessNode):KGe;t=W6e({roughness:t}),Dg.assign(t),this.setupSpecular(),Ki.assign($r(Ki.rgb.mul(e.oneMinus()),Ki.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}class eXe extends p7e{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ci(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return yi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Zi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Zi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Zi(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const tXe=new eXe;class nXe extends m7e{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(tXe),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?Ut(this.iorNode):hje;ek.assign(e),qu.assign(Ks(qx(e6e(ek.sub(1).div(ek.add(1))).mul(YGe),zt(1)).mul(B4e),Ki.rgb,Nk)),Ok.assign(Ks(B4e,1,Nk))}setupLightingModel(){return new r7e(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?Ut(this.clearcoatNode):JGe,n=this.clearcoatRoughnessNode?Ut(this.clearcoatRoughnessNode):eje;QH.assign(t),Dk.assign(W6e({roughness:n}))}if(this.useSheen){const t=this.sheenNode?zt(this.sheenNode):rje,n=this.sheenRoughnessNode?Ut(this.sheenRoughnessNode):ije;mx.assign(t),w$.assign(n)}if(this.useIridescence){const t=this.iridescenceNode?Ut(this.iridescenceNode):oje,n=this.iridescenceIORNode?Ut(this.iridescenceIORNode):aje,r=this.iridescenceThicknessNode?Ut(this.iridescenceThicknessNode):lje;E$.assign(t),Uye.assign(n),zye.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?Sn(this.anisotropyNode):sje).toVar();ov.assign(t.length()),Jo(ov.equal(0),()=>{t.assign(Sn(1,0))}).Else(()=>{t.divAssign(Sn(ov)),ov.assign(ov.saturate())}),JH.assign(ov.pow2().mix(Dg.pow2(),1)),JI.assign(Kw[0].mul(t.x).add(Kw[1].mul(t.y))),Ax.assign(Kw[1].mul(t.x).sub(Kw[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?Ut(this.transmissionNode):cje,n=this.thicknessNode?Ut(this.thicknessNode):uje,r=this.attenuationDistanceNode?Ut(this.attenuationDistanceNode):dje,i=this.attenuationColorNode?zt(this.attenuationColorNode):fje;if(tW.assign(t),Vye.assign(n),Gye.assign(r),jye.assign(i),this.useDispersion){const a=this.dispersionNode?Ut(this.dispersionNode):xje;Hye.assign(a)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?zt(this.clearcoatNormalNode):tje}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const rXe=en(({normal:s,lightDirection:e,builder:t})=>{const n=s.dot(e),r=Sn(n.mul(.5).add(.5),0);if(t.material.gradientMap){const i=B3("gradientMap","texture").context({getUV:()=>r});return zt(i.r)}else{const i=r.fwidth().mul(.5);return Ks(zt(.7),zt(1),Y3(Ut(.7).sub(i.x),Ut(.7).add(i.x),r.x))}});class iXe extends hN{direct({lightDirection:e,lightColor:t,reflectedLight:n},r){const i=rXe({normal:m6e,lightDirection:e,builder:r}).mul(t);n.directDiffuse.addAssign(i.mul(Yx({diffuseColor:Ki.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(Yx({diffuseColor:Ki}))),r.indirectDiffuse.mulAssign(t)}}class sXe extends tu{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Zi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=q3,this.normalScale=new ci(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const oXe=new sXe;class aXe extends pa{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(oXe),this.setValues(e)}setupLightingModel(){return new iXe}}class lXe extends a_{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=Ut(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}const cXe=new U3;class uXe extends pa{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(cXe),this.setValues(e)}setupNormal(){return C1}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new q$(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new lXe(P6e)),t}setupOutgoingLight(){return Ki.rgb}setupLightingModel(){return new e7e}}class hXe extends tu{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Zi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=q3,this.normalScale=new ci(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ad,this.combine=Xk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const dXe=new hXe;class fXe extends pa{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(dXe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new q$(t):null}setupLightingModel(){return new t7e(!1)}}class pXe extends tu{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=q3,this.normalScale=new ci(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}const mXe=new pXe;class gXe extends pa{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(mXe),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?Ut(this.opacityNode):A6e;Ki.assign(I$($r(dGe(ha),e),Yu))}}class vXe extends tu{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Zi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=q3,this.normalScale=new ci(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}const yXe=new vXe;class xXe extends pa{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(yXe),this.setValues(e)}setupVariants(e){const t=cGe;let n;e.material.matcap?n=B3("matcap","texture").context({getUV:()=>t}):n=zt(Ks(.2,.8,t.y)),Ki.rgb.mulAssign(n.rgb)}}class g7e extends tu{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Zi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const _Xe=new g7e;class bXe extends pa{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(_Xe),this.setValues(e)}}class SXe extends g7e{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const wXe=new SXe;class EXe extends pa{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(wXe),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?Ut(this.offsetNode):vje,t=this.dashScaleNode?Ut(this.dashScaleNode):pje,n=this.dashSizeNode?Ut(this.dashSizeNode):mje,r=this.gapSizeNode?Ut(this.gapSizeNode):gje;hG.assign(n),C4e.assign(r);const i=Uf(K3("lineDistance").mul(t));(e?i.add(e):i).mod(hG.add(C4e)).greaterThan(hG).discard()}}class TXe extends tu{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Zi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const MXe=new TXe;class v7e extends pa{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(MXe),this.setValues(e)}setupPositionView(e){const{object:t,camera:n}=e,r=this.sizeAttenuation,{positionNode:i,rotationNode:a,scaleNode:c}=this,u=rN.mul(zt(i||0));let p=Sn(Mv[0].xyz.length(),Mv[1].xyz.length());if(c!==null&&(p=p.mul(Sn(c))),r===!1)if(n.isPerspectiveCamera)p=p.mul(u.z.negate());else{const M=Ut(2).div(O$.element(1).element(1));p=p.mul(M.mul(2))}let y=iN.xy;if(t.center&&t.center.isVector2===!0){const M=SVe("center","vec2",t);y=y.sub(M.sub(.5))}y=y.mul(p);const x=Ut(a||nje),S=v6e(y,x);return $r(u.xy.add(S),u.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}class CXe extends tu{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Zi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const AXe=new CXe;class PXe extends v7e{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(AXe),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return rN.mul(zt(e||vl)).xyz}setupVertex(e){const t=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return t;const{rotationNode:n,scaleNode:r,sizeNode:i}=this,a=iN.xy.toVar(),c=uE.z.div(uE.w);if(n&&n.isNode){const p=Ut(n);a.assign(v6e(a,p))}let u=i!==null?Sn(i):yje;return this.sizeAttenuation===!0&&(u=u.mul(u.div(fa.z.negate()))),r&&r.isNode&&(u=u.mul(Sn(r))),a.mulAssign(u.mul(2)),a.assign(a.div(uE.z)),a.y.assign(a.y.mul(c)),a.assign(a.mul(t.w)),t.addAssign($r(a,0,0)),t}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class RXe extends hN{constructor(){super(),this.shadowNode=Ut(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Ki.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Ki.rgb)}}class IXe extends tu{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Zi(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}const kXe=new IXe;class NXe extends pa{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(kXe),this.setValues(e)}setupLightingModel(){return new RXe}}class Iv extends Aa{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Zi(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}const lj=new Is,Z5e=new pt,Q5e=new pt;class eq{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ci(512,512),this.mapType=lc,this.map=null,this.mapPass=null,this.matrix=new Is,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Z$,this._frameExtents=new ci(1,1),this._viewportCount=1,this._viewports=[new Ri(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Z5e.setFromMatrixPosition(e.matrixWorld),t.position.copy(Z5e),Q5e.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Q5e),t.updateMatrixWorld(),lj.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lj),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(lj)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const J5e=new Is,kw=new pt,cj=new pt;class DXe extends eq{constructor(){super(new Ku(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ci(4,2),this._viewportCount=6,this._viewports=[new Ri(2,1,1,1),new Ri(0,1,1,1),new Ri(3,1,1,1),new Ri(1,1,1,1),new Ri(3,0,1,1),new Ri(1,0,1,1)],this._cubeDirections=[new pt(1,0,0),new pt(-1,0,0),new pt(0,0,1),new pt(0,0,-1),new pt(0,1,0),new pt(0,-1,0)],this._cubeUps=[new pt(0,1,0),new pt(0,1,0),new pt(0,1,0),new pt(0,1,0),new pt(0,0,1),new pt(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),kw.setFromMatrixPosition(e.matrixWorld),n.position.copy(kw),cj.copy(n.position),cj.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(cj),n.updateMatrixWorld(),r.makeTranslation(-kw.x,-kw.y,-kw.z),J5e.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(J5e)}}class OXe extends Iv{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new DXe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class LXe extends eq{constructor(){super(new z$(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class FXe extends Iv{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Aa.DEFAULT_UP),this.updateMatrix(),this.target=new Aa,this.shadow=new LXe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class BXe extends Iv{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class UXe extends eq{constructor(){super(new Ku(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Gx*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class tq extends Iv{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Aa.DEFAULT_UP),this.updateMatrix(),this.target=new Aa,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new UXe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class zXe extends Iv{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class VXe extends Iv{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Aa.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Zi(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}class GXe{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new pt)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*r)),t.addScaledVector(a[5],1.092548*(r*i)),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],1.092548*(n*i)),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*i),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*r),t.addScaledVector(a[5],2*.429043*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],2*.429043*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class jXe extends Iv{constructor(e=new GXe,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class HXe extends tq{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class WXe extends tq{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class $Xe extends i7e{constructor(){super(),this.addMaterial(Qqe,"MeshPhongMaterial"),this.addMaterial(m7e,"MeshStandardMaterial"),this.addMaterial(nXe,"MeshPhysicalMaterial"),this.addMaterial(aXe,"MeshToonMaterial"),this.addMaterial(uXe,"MeshBasicMaterial"),this.addMaterial(fXe,"MeshLambertMaterial"),this.addMaterial(gXe,"MeshNormalMaterial"),this.addMaterial(xXe,"MeshMatcapMaterial"),this.addMaterial(bXe,"LineBasicMaterial"),this.addMaterial(EXe,"LineDashedMaterial"),this.addMaterial(PXe,"PointsMaterial"),this.addMaterial(v7e,"SpriteMaterial"),this.addMaterial(NXe,"ShadowMaterial"),this.addLight(ZHe,OXe),this.addLight(s$e,FXe),this.addLight(o$e,BXe),this.addLight($$,tq),this.addLight(u$e,zXe),this.addLight(h$e,VXe),this.addLight(d$e,jXe),this.addLight(a$e,HXe),this.addLight(c$e,WXe),this.addToneMapping(sHe,hBe),this.addToneMapping(oHe,dBe),this.addToneMapping(aHe,fBe),this.addToneMapping(cHe,pBe),this.addToneMapping(fHe,mBe),this.addToneMapping(pHe,gBe)}}class RI extends J$e{constructor(e={}){let t;e.forceWebGL?t=j5e:(t=Yqe,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new j5e(e)));const n=new t(e);super(n,e),this.library=new $Xe,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class qXe extends Kc{constructor(e,t){const n=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],r=new rs;r.setAttribute("position",new Er(n,3)),r.computeBoundingSphere();const i=new Ff({fog:!1});super(r,i),this.light=e,this.color=t,this.type="RectAreaLightHelper";const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new rs;c.setAttribute("position",new Er(a,3)),c.computeBoundingSphere(),this.add(new mn(c,new eh({side:Qo,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const e8e={type:"change"},nq={type:"start"},y7e={type:"end"},II=new Jx,t8e=new k3,XXe=Math.cos(70*pl.DEG2RAD),Ea=new Ae,Xc=2*Math.PI,Ms={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},uj=1e-6;class YXe extends Ove{constructor(e,t=null){super(e,t),this.state=Ms.NONE,this.target=new Ae,this.cursor=new Ae,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:xx.ROTATE,MIDDLE:xx.DOLLY,RIGHT:xx.PAN},this.touches={ONE:sx.ROTATE,TWO:sx.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Ae,this._lastQuaternion=new ls,this._lastTargetPosition=new Ae,this._quat=new ls().setFromUnitVectors(e.up,new Ae(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new MH,this._sphericalDelta=new MH,this._scale=1,this._panOffset=new Ae,this._rotateStart=new An,this._rotateEnd=new An,this._rotateDelta=new An,this._panStart=new An,this._panEnd=new An,this._panDelta=new An,this._dollyStart=new An,this._dollyEnd=new An,this._dollyDelta=new An,this._dollyDirection=new Ae,this._mouse=new An,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=ZXe.bind(this),this._onPointerDown=KXe.bind(this),this._onPointerUp=QXe.bind(this),this._onContextMenu=sYe.bind(this),this._onMouseWheel=tYe.bind(this),this._onKeyDown=nYe.bind(this),this._onTouchStart=rYe.bind(this),this._onTouchMove=iYe.bind(this),this._onMouseDown=JXe.bind(this),this._onMouseMove=eYe.bind(this),this._interceptControlDown=oYe.bind(this),this._interceptControlUp=aYe.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(e8e),this.update(),this.state=Ms.NONE}update(e=null){const t=this.object.position;Ea.copy(t).sub(this.target),Ea.applyQuaternion(this._quat),this._spherical.setFromVector3(Ea),this.autoRotate&&this.state===Ms.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=Xc:n>Math.PI&&(n-=Xc),r<-Math.PI?r+=Xc:r>Math.PI&&(r-=Xc),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=a!=this._spherical.radius}if(Ea.setFromSpherical(this._spherical),Ea.applyQuaternion(this._quatInverse),t.copy(this.target).add(Ea),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let a=null;if(this.object.isPerspectiveCamera){const c=Ea.length();a=this._clampDistance(c*this._scale);const u=c-a;this.object.position.addScaledVector(this._dollyDirection,u),this.object.updateMatrixWorld(),i=!!u}else if(this.object.isOrthographicCamera){const c=new Ae(this._mouse.x,this._mouse.y,0);c.unproject(this.object);const u=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=u!==this.object.zoom;const p=new Ae(this._mouse.x,this._mouse.y,0);p.unproject(this.object),this.object.position.sub(p).add(c),this.object.updateMatrixWorld(),a=Ea.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;a!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(a).add(this.object.position):(II.origin.copy(this.object.position),II.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(II.direction))<XXe?this.object.lookAt(this.target):(t8e.setFromNormalAndCoplanarPoint(this.object.up,this.target),II.intersectPlane(t8e,this.target))))}else if(this.object.isOrthographicCamera){const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),a!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,i||this._lastPosition.distanceToSquared(this.object.position)>uj||8*(1-this._lastQuaternion.dot(this.object.quaternion))>uj||this._lastTargetPosition.distanceToSquared(this.target)>uj?(this.dispatchEvent(e8e),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Xc/60*this.autoRotateSpeed*e:Xc/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Ea.setFromMatrixColumn(t,0),Ea.multiplyScalar(-e),this._panOffset.add(Ea)}_panUp(e,t){this.screenSpacePanning===!0?Ea.setFromMatrixColumn(t,1):(Ea.setFromMatrixColumn(t,0),Ea.crossVectors(this.object.up,Ea)),Ea.multiplyScalar(e),this._panOffset.add(Ea)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;Ea.copy(r).sub(this.target);let i=Ea.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/n.clientHeight,this.object.matrix),this._panUp(2*t*i/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,i=t-n.top,a=n.width,c=n.height;this._mouse.x=r/a*2-1,this._mouse.y=-(i/c)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Xc*this._rotateDelta.x/t.clientHeight),this._rotateUp(Xc*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Xc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Xc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Xc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Xc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),i=.5*(e.pageY+n.y);this._rotateEnd.set(r,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Xc*this._rotateDelta.x/t.clientHeight),this._rotateUp(Xc*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=(e.pageX+t.x)*.5,c=(e.pageY+t.y)*.5;this._updateZoomParameters(a,c)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new An,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function KXe(s){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(s.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(s)&&(this._addPointer(s),s.pointerType==="touch"?this._onTouchStart(s):this._onMouseDown(s)))}function ZXe(s){this.enabled!==!1&&(s.pointerType==="touch"?this._onTouchMove(s):this._onMouseMove(s))}function QXe(s){switch(this._removePointer(s),this._pointers.length){case 0:this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(y7e),this.state=Ms.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function JXe(s){let e;switch(s.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case xx.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(s),this.state=Ms.DOLLY;break;case xx.ROTATE:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(s),this.state=Ms.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(s),this.state=Ms.ROTATE}break;case xx.PAN:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(s),this.state=Ms.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(s),this.state=Ms.PAN}break;default:this.state=Ms.NONE}this.state!==Ms.NONE&&this.dispatchEvent(nq)}function eYe(s){switch(this.state){case Ms.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(s);break;case Ms.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(s);break;case Ms.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(s);break}}function tYe(s){this.enabled===!1||this.enableZoom===!1||this.state!==Ms.NONE||(s.preventDefault(),this.dispatchEvent(nq),this._handleMouseWheel(this._customWheelEvent(s)),this.dispatchEvent(y7e))}function nYe(s){this.enabled!==!1&&this._handleKeyDown(s)}function rYe(s){switch(this._trackPointer(s),this._pointers.length){case 1:switch(this.touches.ONE){case sx.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(s),this.state=Ms.TOUCH_ROTATE;break;case sx.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(s),this.state=Ms.TOUCH_PAN;break;default:this.state=Ms.NONE}break;case 2:switch(this.touches.TWO){case sx.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(s),this.state=Ms.TOUCH_DOLLY_PAN;break;case sx.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(s),this.state=Ms.TOUCH_DOLLY_ROTATE;break;default:this.state=Ms.NONE}break;default:this.state=Ms.NONE}this.state!==Ms.NONE&&this.dispatchEvent(nq)}function iYe(s){switch(this._trackPointer(s),this.state){case Ms.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(s),this.update();break;case Ms.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(s),this.update();break;case Ms.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(s),this.update();break;case Ms.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(s),this.update();break;default:this.state=Ms.NONE}}function sYe(s){this.enabled!==!1&&s.preventDefault()}function oYe(s){s.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function aYe(s){s.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const _o={LEFT:1,RIGHT:2,MIDDLE:4},Mt=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),K7={NONE:0,IN:1,OUT:-1};function Q8(s){return s.isPerspectiveCamera}function I3(s){return s.isOrthographicCamera}const Z7=Math.PI*2,n8e=Math.PI/2,x7e=1e-5,Nw=Math.PI/180;function Mf(s,e,t){return Math.max(e,Math.min(t,s))}function Bs(s,e=x7e){return Math.abs(s)<e}function as(s,e,t=x7e){return Bs(s-e,t)}function r8e(s,e){return Math.round(s/e)*e}function Dw(s){return isFinite(s)?s:s<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Ow(s){return Math.abs(s)<Number.MAX_VALUE?s:s*(1/0)}function kI(s,e,t,n,r=1/0,i){n=Math.max(1e-4,n);const a=2/n,c=a*i,u=1/(1+c+.48*c*c+.235*c*c*c);let p=s-e;const y=e,x=r*n;p=Mf(p,-x,x),e=s-p;const S=(t.value+a*p)*i;t.value=(t.value-a*S)*u;let M=e+(p+S)*u;return y-s>0==M>y&&(M=y,t.value=(M-y)/i),M}function i8e(s,e,t,n,r=1/0,i,a){n=Math.max(1e-4,n);const c=2/n,u=c*i,p=1/(1+u+.48*u*u+.235*u*u*u);let y=e.x,x=e.y,S=e.z,M=s.x-y,I=s.y-x,L=s.z-S;const B=y,A=x,V=S,X=r*n,P=X*X,te=M*M+I*I+L*L;if(te>P){const st=Math.sqrt(te);M=M/st*X,I=I/st*X,L=L/st*X}y=s.x-M,x=s.y-I,S=s.z-L;const oe=(t.x+c*M)*i,ie=(t.y+c*I)*i,K=(t.z+c*L)*i;t.x=(t.x-c*oe)*p,t.y=(t.y-c*ie)*p,t.z=(t.z-c*K)*p,a.x=y+(M+oe)*p,a.y=x+(I+ie)*p,a.z=S+(L+K)*p;const re=B-s.x,se=A-s.y,q=V-s.z,De=a.x-B,Be=a.y-A,tt=a.z-V;return re*De+se*Be+q*tt>0&&(a.x=B,a.y=A,a.z=V,t.x=(a.x-B)/i,t.y=(a.y-A)/i,t.z=(a.z-V)/i),a}function hj(s,e){e.set(0,0),s.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=s.length,e.y/=s.length}function dj(s,e){return I3(s)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class lYe{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,a=r.length;i<a;i++)r[i].call(this,e)}}}var fj;const cYe="2.10.1",NI=1/8,uYe=/Mac/.test((fj=globalThis==null?void 0:globalThis.navigator)===null||fj===void 0?void 0:fj.platform);let Fr,s8e,DI,pj,Yc,ii,Xi,Q7,Lw,h1,d1,J8,o8e,a8e,Kh,Fw,J7,l8e,mj,c8e,gj,vj,OI;class g1 extends lYe{static install(e){Fr=e.THREE,s8e=Object.freeze(new Fr.Vector3(0,0,0)),DI=Object.freeze(new Fr.Vector3(0,1,0)),pj=Object.freeze(new Fr.Vector3(0,0,1)),Yc=new Fr.Vector2,ii=new Fr.Vector3,Xi=new Fr.Vector3,Q7=new Fr.Vector3,Lw=new Fr.Vector3,h1=new Fr.Vector3,d1=new Fr.Vector3,J8=new Fr.Vector3,o8e=new Fr.Vector3,a8e=new Fr.Vector3,Kh=new Fr.Spherical,Fw=new Fr.Spherical,J7=new Fr.Box3,l8e=new Fr.Box3,mj=new Fr.Sphere,c8e=new Fr.Quaternion,gj=new Fr.Quaternion,vj=new Fr.Matrix4,OI=new Fr.Raycaster}static get ACTION(){return Mt}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Mt.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=K7.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Fr.Vector3,this._focalOffsetVelocity=new Fr.Vector3,this._zoomVelocity={value:0},this._truckInternal=(A,V,X,P)=>{let te,oe;if(Q8(this._camera)){const ie=ii.copy(this._camera.position).sub(this._target),K=this._camera.getEffectiveFOV()*Nw,re=ie.length()*Math.tan(K*.5);te=this.truckSpeed*A*re/this._elementRect.height,oe=this.truckSpeed*V*re/this._elementRect.height}else if(I3(this._camera)){const ie=this._camera;te=this.truckSpeed*A*(ie.right-ie.left)/ie.zoom/this._elementRect.width,oe=this.truckSpeed*V*(ie.top-ie.bottom)/ie.zoom/this._elementRect.height}else return;P?(X?this.setFocalOffset(this._focalOffsetEnd.x+te,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(te,0,!0),this.forward(-oe,!0)):X?this.setFocalOffset(this._focalOffsetEnd.x+te,this._focalOffsetEnd.y+oe,this._focalOffsetEnd.z,!0):this.truck(te,oe,!0)},this._rotateInternal=(A,V)=>{const X=Z7*this.azimuthRotateSpeed*A/this._elementRect.height,P=Z7*this.polarRotateSpeed*V/this._elementRect.height;this.rotate(X,P,!0)},this._dollyInternal=(A,V,X)=>{const P=Math.pow(.95,-A*this.dollySpeed),te=this._sphericalEnd.radius,oe=this._sphericalEnd.radius*P,ie=Mf(oe,this.minDistance,this.maxDistance),K=ie-oe;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(oe,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(K,!0),this._dollyToNoClamp(ie,!0)):this._dollyToNoClamp(ie,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?oe:ie)-te,this._dollyControlCoord.set(V,X)),this._lastDollyDirection=Math.sign(-A)},this._zoomInternal=(A,V,X)=>{const P=Math.pow(.95,A*this.dollySpeed),te=this._zoom,oe=this._zoom*P;this.zoomTo(oe,!0),this.dollyToCursor&&(this._changedZoom+=oe-te,this._dollyControlCoord.set(V,X))},typeof Fr>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Fr.Quaternion().setFromUnitVectors(this._camera.up,DI),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Mt.NONE,this._target=new Fr.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Fr.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Fr.Spherical().setFromVector3(ii.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Fr.Vector3,new Fr.Vector3,new Fr.Vector3,new Fr.Vector3],this._updateNearPlaneCorners(),this._boundary=new Fr.Box3(new Fr.Vector3(-1/0,-1/0,-1/0),new Fr.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Fr.Vector2,this.mouseButtons={left:Mt.ROTATE,middle:Mt.DOLLY,right:Mt.TRUCK,wheel:Q8(this._camera)?Mt.DOLLY:I3(this._camera)?Mt.ZOOM:Mt.NONE},this.touches={one:Mt.TOUCH_ROTATE,two:Q8(this._camera)?Mt.TOUCH_DOLLY_TRUCK:I3(this._camera)?Mt.TOUCH_ZOOM_TRUCK:Mt.NONE,three:Mt.TOUCH_TRUCK};const n=new Fr.Vector2,r=new Fr.Vector2,i=new Fr.Vector2,a=A=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const P=this._domElement.getBoundingClientRect(),te=A.clientX/P.width,oe=A.clientY/P.height;if(te<this._interactiveArea.left||te>this._interactiveArea.right||oe<this._interactiveArea.top||oe>this._interactiveArea.bottom)return}const V=A.pointerType!=="mouse"?null:(A.buttons&_o.LEFT)===_o.LEFT?_o.LEFT:(A.buttons&_o.MIDDLE)===_o.MIDDLE?_o.MIDDLE:(A.buttons&_o.RIGHT)===_o.RIGHT?_o.RIGHT:null;if(V!==null){const P=this._findPointerByMouseButton(V);P&&this._disposePointer(P)}if((A.buttons&_o.LEFT)===_o.LEFT&&this._lockedPointer)return;const X={pointerId:A.pointerId,clientX:A.clientX,clientY:A.clientY,deltaX:0,deltaY:0,mouseButton:V};this._activePointers.push(X),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),this._isDragging=!0,S(A)},c=A=>{A.cancelable&&A.preventDefault();const V=A.pointerId,X=this._lockedPointer||this._findPointerById(V);if(X){if(X.clientX=A.clientX,X.clientY=A.clientY,X.deltaX=A.movementX,X.deltaY=A.movementY,this._state=0,A.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(A.buttons&_o.LEFT)===_o.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(A.buttons&_o.MIDDLE)===_o.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(A.buttons&_o.RIGHT)===_o.RIGHT&&(this._state=this._state|this.mouseButtons.right);M()}},u=A=>{const V=this._findPointerById(A.pointerId);if(!(V&&V===this._lockedPointer)){if(V&&this._disposePointer(V),A.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=Mt.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=Mt.NONE;I()}};let p=-1;const y=A=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Mt.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const oe=this._domElement.getBoundingClientRect(),ie=A.clientX/oe.width,K=A.clientY/oe.height;if(ie<this._interactiveArea.left||ie>this._interactiveArea.right||K<this._interactiveArea.top||K>this._interactiveArea.bottom)return}if(A.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Mt.ROTATE||this.mouseButtons.wheel===Mt.TRUCK){const oe=performance.now();p-oe<1e3&&this._getClientRect(this._elementRect),p=oe}const V=uYe?-1:-3,X=A.deltaMode===1||A.ctrlKey?A.deltaY/V:A.deltaY/(V*10),P=this.dollyToCursor?(A.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,te=this.dollyToCursor?(A.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Mt.ROTATE:{this._rotateInternal(A.deltaX,A.deltaY),this._isUserControllingRotate=!0;break}case Mt.TRUCK:{this._truckInternal(A.deltaX,A.deltaY,!1,!1),this._isUserControllingTruck=!0;break}case Mt.SCREEN_PAN:{this._truckInternal(A.deltaX,A.deltaY,!1,!0),this._isUserControllingTruck=!0;break}case Mt.OFFSET:{this._truckInternal(A.deltaX,A.deltaY,!0,!1),this._isUserControllingOffset=!0;break}case Mt.DOLLY:{this._dollyInternal(-X,P,te),this._isUserControllingDolly=!0;break}case Mt.ZOOM:{this._zoomInternal(-X,P,te),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},x=A=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===g1.ACTION.NONE){const V=A instanceof PointerEvent?A.pointerId:0,X=this._findPointerById(V);X&&this._disposePointer(X),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u);return}A.preventDefault()}},S=A=>{if(!this._enabled)return;if(hj(this._activePointers,Yc),this._getClientRect(this._elementRect),n.copy(Yc),r.copy(Yc),this._activePointers.length>=2){const X=Yc.x-this._activePointers[1].clientX,P=Yc.y-this._activePointers[1].clientY,te=Math.sqrt(X*X+P*P);i.set(0,te);const oe=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,ie=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(oe,ie)}if(this._state=0,!A)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in A&&A.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(A.buttons&_o.LEFT)===_o.LEFT&&(this._state=this._state|this.mouseButtons.left),(A.buttons&_o.MIDDLE)===_o.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(A.buttons&_o.RIGHT)===_o.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&Mt.ROTATE)===Mt.ROTATE||(this._state&Mt.TOUCH_ROTATE)===Mt.TOUCH_ROTATE||(this._state&Mt.TOUCH_DOLLY_ROTATE)===Mt.TOUCH_DOLLY_ROTATE||(this._state&Mt.TOUCH_ZOOM_ROTATE)===Mt.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Mt.TRUCK)===Mt.TRUCK||(this._state&Mt.SCREEN_PAN)===Mt.SCREEN_PAN||(this._state&Mt.TOUCH_TRUCK)===Mt.TOUCH_TRUCK||(this._state&Mt.TOUCH_SCREEN_PAN)===Mt.TOUCH_SCREEN_PAN||(this._state&Mt.TOUCH_DOLLY_TRUCK)===Mt.TOUCH_DOLLY_TRUCK||(this._state&Mt.TOUCH_DOLLY_SCREEN_PAN)===Mt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Mt.TOUCH_ZOOM_TRUCK)===Mt.TOUCH_ZOOM_TRUCK||(this._state&Mt.TOUCH_ZOOM_SCREEN_PAN)===Mt.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Mt.DOLLY)===Mt.DOLLY||(this._state&Mt.TOUCH_DOLLY)===Mt.TOUCH_DOLLY||(this._state&Mt.TOUCH_DOLLY_TRUCK)===Mt.TOUCH_DOLLY_TRUCK||(this._state&Mt.TOUCH_DOLLY_SCREEN_PAN)===Mt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Mt.TOUCH_DOLLY_OFFSET)===Mt.TOUCH_DOLLY_OFFSET||(this._state&Mt.TOUCH_DOLLY_ROTATE)===Mt.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Mt.ZOOM)===Mt.ZOOM||(this._state&Mt.TOUCH_ZOOM)===Mt.TOUCH_ZOOM||(this._state&Mt.TOUCH_ZOOM_TRUCK)===Mt.TOUCH_ZOOM_TRUCK||(this._state&Mt.TOUCH_ZOOM_SCREEN_PAN)===Mt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Mt.TOUCH_ZOOM_OFFSET)===Mt.TOUCH_ZOOM_OFFSET||(this._state&Mt.TOUCH_ZOOM_ROTATE)===Mt.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Mt.OFFSET)===Mt.OFFSET||(this._state&Mt.TOUCH_OFFSET)===Mt.TOUCH_OFFSET||(this._state&Mt.TOUCH_DOLLY_OFFSET)===Mt.TOUCH_DOLLY_OFFSET||(this._state&Mt.TOUCH_ZOOM_OFFSET)===Mt.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},M=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,hj(this._activePointers,Yc);const V=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,X=V?-V.deltaX:r.x-Yc.x,P=V?-V.deltaY:r.y-Yc.y;if(r.copy(Yc),((this._state&Mt.ROTATE)===Mt.ROTATE||(this._state&Mt.TOUCH_ROTATE)===Mt.TOUCH_ROTATE||(this._state&Mt.TOUCH_DOLLY_ROTATE)===Mt.TOUCH_DOLLY_ROTATE||(this._state&Mt.TOUCH_ZOOM_ROTATE)===Mt.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(X,P),this._isUserControllingRotate=!0),(this._state&Mt.DOLLY)===Mt.DOLLY||(this._state&Mt.ZOOM)===Mt.ZOOM){const te=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,oe=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,ie=this.dollyDragInverted?-1:1;(this._state&Mt.DOLLY)===Mt.DOLLY?(this._dollyInternal(ie*P*NI,te,oe),this._isUserControllingDolly=!0):(this._zoomInternal(ie*P*NI,te,oe),this._isUserControllingZoom=!0)}if((this._state&Mt.TOUCH_DOLLY)===Mt.TOUCH_DOLLY||(this._state&Mt.TOUCH_ZOOM)===Mt.TOUCH_ZOOM||(this._state&Mt.TOUCH_DOLLY_TRUCK)===Mt.TOUCH_DOLLY_TRUCK||(this._state&Mt.TOUCH_ZOOM_TRUCK)===Mt.TOUCH_ZOOM_TRUCK||(this._state&Mt.TOUCH_DOLLY_SCREEN_PAN)===Mt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Mt.TOUCH_ZOOM_SCREEN_PAN)===Mt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Mt.TOUCH_DOLLY_OFFSET)===Mt.TOUCH_DOLLY_OFFSET||(this._state&Mt.TOUCH_ZOOM_OFFSET)===Mt.TOUCH_ZOOM_OFFSET||(this._state&Mt.TOUCH_DOLLY_ROTATE)===Mt.TOUCH_DOLLY_ROTATE||(this._state&Mt.TOUCH_ZOOM_ROTATE)===Mt.TOUCH_ZOOM_ROTATE){const te=Yc.x-this._activePointers[1].clientX,oe=Yc.y-this._activePointers[1].clientY,ie=Math.sqrt(te*te+oe*oe),K=i.y-ie;i.set(0,ie);const re=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,se=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Mt.TOUCH_DOLLY)===Mt.TOUCH_DOLLY||(this._state&Mt.TOUCH_DOLLY_ROTATE)===Mt.TOUCH_DOLLY_ROTATE||(this._state&Mt.TOUCH_DOLLY_TRUCK)===Mt.TOUCH_DOLLY_TRUCK||(this._state&Mt.TOUCH_DOLLY_SCREEN_PAN)===Mt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Mt.TOUCH_DOLLY_OFFSET)===Mt.TOUCH_DOLLY_OFFSET?(this._dollyInternal(K*NI,re,se),this._isUserControllingDolly=!0):(this._zoomInternal(K*NI,re,se),this._isUserControllingZoom=!0)}((this._state&Mt.TRUCK)===Mt.TRUCK||(this._state&Mt.TOUCH_TRUCK)===Mt.TOUCH_TRUCK||(this._state&Mt.TOUCH_DOLLY_TRUCK)===Mt.TOUCH_DOLLY_TRUCK||(this._state&Mt.TOUCH_ZOOM_TRUCK)===Mt.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(X,P,!1,!1),this._isUserControllingTruck=!0),((this._state&Mt.SCREEN_PAN)===Mt.SCREEN_PAN||(this._state&Mt.TOUCH_SCREEN_PAN)===Mt.TOUCH_SCREEN_PAN||(this._state&Mt.TOUCH_DOLLY_SCREEN_PAN)===Mt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Mt.TOUCH_ZOOM_SCREEN_PAN)===Mt.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(X,P,!1,!0),this._isUserControllingTruck=!0),((this._state&Mt.OFFSET)===Mt.OFFSET||(this._state&Mt.TOUCH_OFFSET)===Mt.TOUCH_OFFSET||(this._state&Mt.TOUCH_DOLLY_OFFSET)===Mt.TOUCH_DOLLY_OFFSET||(this._state&Mt.TOUCH_ZOOM_OFFSET)===Mt.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(X,P,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},I=()=>{hj(this._activePointers,Yc),r.copy(Yc),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",L),this._domElement.ownerDocument.addEventListener("pointerlockerror",B),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),S())},this.unlockPointer=()=>{var A,V,X;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(A=this._domElement)===null||A===void 0||A.ownerDocument.exitPointerLock(),(V=this._domElement)===null||V===void 0||V.ownerDocument.removeEventListener("pointerlockchange",L),(X=this._domElement)===null||X===void 0||X.ownerDocument.removeEventListener("pointerlockerror",B),this.cancel()};const L=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},B=()=>{this.unlockPointer()};this._addAllEventListeners=A=>{this._domElement=A,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",a),this._domElement.addEventListener("pointercancel",u),this._domElement.addEventListener("wheel",y,{passive:!1}),this._domElement.addEventListener("contextmenu",x)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",a),this._domElement.removeEventListener("pointercancel",u),this._domElement.removeEventListener("wheel",y,{passive:!1}),this._domElement.removeEventListener("contextmenu",x),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("pointerlockchange",L),this._domElement.ownerDocument.removeEventListener("pointerlockerror",B))},this.cancel=()=>{this._state!==Mt.NONE&&(this._state=Mt.NONE,this._activePointers.length=0,I())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=Mf(e.width,0,1),this._interactiveArea.height=Mf(e.height,0,1),this._interactiveArea.x=Mf(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Mf(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const r=Mf(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=Mf(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const a=!n||as(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&as(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=K7.NONE,this._changedDolly=0,this._dollyToNoClamp(Mf(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const a=this._collisionTest(),c=as(a,this._spherical.radius);if(!(n>e)&&c)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,a)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const i=!t||as(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Lw).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||as(this._target.x,this._targetEnd.x,this.restThreshold)&&as(this._target.y,this._targetEnd.y,this.restThreshold)&&as(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=Mf(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||as(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),h1.setFromMatrixColumn(this._camera.matrix,0),d1.setFromMatrixColumn(this._camera.matrix,1),h1.multiplyScalar(e),d1.multiplyScalar(-t);const r=ii.copy(h1).add(d1),i=Xi.copy(this._targetEnd).add(r);return this.moveTo(i.x,i.y,i.z,n)}forward(e,t=!1){ii.setFromMatrixColumn(this._camera.matrix,0),ii.crossVectors(this._camera.up,ii),ii.multiplyScalar(e);const n=Xi.copy(this._targetEnd).add(ii);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return ii.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+ii.x,this._targetEnd.y+ii.y,this._targetEnd.z+ii.z,t)}moveTo(e,t,n,r=!1){this._isUserControllingTruck=!1;const i=ii.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const a=!r||as(this._target.x,this._targetEnd.x,this.restThreshold)&&as(this._target.y,this._targetEnd.y,this.restThreshold)&&as(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}lookInDirectionOf(e,t,n,r=!1){const c=ii.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(c.x,c.y,c.z,r)}fitToBox(e,t,{cover:n=!1,paddingLeft:r=0,paddingRight:i=0,paddingBottom:a=0,paddingTop:c=0}={}){const u=[],p=e.isBox3?J7.copy(e):J7.setFromObject(e);p.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const y=r8e(this._sphericalEnd.theta,n8e),x=r8e(this._sphericalEnd.phi,n8e);u.push(this.rotateTo(y,x,t));const S=ii.setFromSpherical(this._sphericalEnd).normalize(),M=c8e.setFromUnitVectors(S,pj),I=as(Math.abs(S.y),1);I&&M.multiply(gj.setFromAxisAngle(DI,y)),M.multiply(this._yAxisUpSpaceInverse);const L=l8e.makeEmpty();Xi.copy(p.min).applyQuaternion(M),L.expandByPoint(Xi),Xi.copy(p.min).setX(p.max.x).applyQuaternion(M),L.expandByPoint(Xi),Xi.copy(p.min).setY(p.max.y).applyQuaternion(M),L.expandByPoint(Xi),Xi.copy(p.max).setZ(p.min.z).applyQuaternion(M),L.expandByPoint(Xi),Xi.copy(p.min).setZ(p.max.z).applyQuaternion(M),L.expandByPoint(Xi),Xi.copy(p.max).setY(p.min.y).applyQuaternion(M),L.expandByPoint(Xi),Xi.copy(p.max).setX(p.min.x).applyQuaternion(M),L.expandByPoint(Xi),Xi.copy(p.max).applyQuaternion(M),L.expandByPoint(Xi),L.min.x-=r,L.min.y-=a,L.max.x+=i,L.max.y+=c,M.setFromUnitVectors(pj,S),I&&M.premultiply(gj.invert()),M.premultiply(this._yAxisUpSpace);const B=L.getSize(ii),A=L.getCenter(Xi).applyQuaternion(M);if(Q8(this._camera)){const V=this.getDistanceToFitBox(B.x,B.y,B.z,n);u.push(this.moveTo(A.x,A.y,A.z,t)),u.push(this.dollyTo(V,t)),u.push(this.setFocalOffset(0,0,0,t))}else if(I3(this._camera)){const V=this._camera,X=V.right-V.left,P=V.top-V.bottom,te=n?Math.max(X/B.x,P/B.y):Math.min(X/B.x,P/B.y);u.push(this.moveTo(A.x,A.y,A.z,t)),u.push(this.zoomTo(te,t)),u.push(this.setFocalOffset(0,0,0,t))}return Promise.all(u)}fitToSphere(e,t){const n=[],i="isObject3D"in e?g1.createBoundingSphere(e,mj):mj.copy(e);if(n.push(this.moveTo(i.center.x,i.center.y,i.center.z,t)),Q8(this._camera)){const a=this.getDistanceToFitSphere(i.radius);n.push(this.dollyTo(a,t))}else if(I3(this._camera)){const a=this._camera.right-this._camera.left,c=this._camera.top-this._camera.bottom,u=2*i.radius,p=Math.min(a/u,c/u);n.push(this.zoomTo(p,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,r,i,a,c=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=K7.NONE,this._changedDolly=0;const u=Xi.set(r,i,a),p=ii.set(e,t,n);this._targetEnd.copy(u),this._sphericalEnd.setFromVector3(p.sub(u).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,c||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const y=!c||as(this._target.x,this._targetEnd.x,this.restThreshold)&&as(this._target.y,this._targetEnd.y,this.restThreshold)&&as(this._target.z,this._targetEnd.z,this.restThreshold)&&as(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&as(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&as(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(y)}lerpLookAt(e,t,n,r,i,a,c,u,p,y,x,S,M,I=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=K7.NONE,this._changedDolly=0;const L=ii.set(r,i,a),B=Xi.set(e,t,n);Kh.setFromVector3(B.sub(L).applyQuaternion(this._yAxisUpSpace));const A=Q7.set(y,x,S),V=Xi.set(c,u,p);Fw.setFromVector3(V.sub(A).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(L.lerp(A,M));const X=Fw.theta-Kh.theta,P=Fw.phi-Kh.phi,te=Fw.radius-Kh.radius;this._sphericalEnd.set(Kh.radius+te*M,Kh.phi+P*M,Kh.theta+X*M),this.normalizeRotations(),this._needsUpdate=!0,I||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const oe=!I||as(this._target.x,this._targetEnd.x,this.restThreshold)&&as(this._target.y,this._targetEnd.y,this.restThreshold)&&as(this._target.z,this._targetEnd.z,this.restThreshold)&&as(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&as(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&as(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(oe)}setPosition(e,t,n,r=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n,r=!1){const i=this.getPosition(ii),a=this.setLookAt(i.x,i.y,i.z,e,t,n,r);return this._sphericalEnd.phi=Mf(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),a}setFocalOffset(e,t,n,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const i=!r||as(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&as(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&as(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),h1.setFromMatrixColumn(this._camera.matrixWorldInverse,0),d1.setFromMatrixColumn(this._camera.matrixWorldInverse,1),J8.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=ii.set(e,t,n),i=r.distanceTo(this._camera.position),a=r.sub(this._camera.position);h1.multiplyScalar(a.x),d1.multiplyScalar(a.y),J8.multiplyScalar(a.z),ii.copy(h1).add(d1).add(J8),ii.z=ii.z+i,this.dollyTo(i,!1),this.setFocalOffset(-ii.x,ii.y,-ii.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Fr.Vector4,typeof e=="number"?this._viewport.set(e,t,n,r):this._viewport.copy(e)}getDistanceToFitBox(e,t,n,r=!1){if(dj(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const i=e/t,a=this._camera.getEffectiveFOV()*Nw,c=this._camera.aspect;return((r?i>c:i<c)?t:e/c)*.5/Math.tan(a*.5)+n*.5}getDistanceToFitSphere(e){if(dj(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Nw,n=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,r=1<this._camera.aspect?t:n;return e/Math.sin(r*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Fr.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Fr.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new Fr.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Fr.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Z7,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Z7),this._spherical.theta+=Z7*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Z7)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!as(this._camera.up.x,this._cameraUp0.x)||!as(this._camera.up.y,this._cameraUp0.y)||!as(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const n=this.getPosition(ii);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,DI),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=ii.subVectors(this._target,this._camera.position).normalize(),t=Xi.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(ii);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,i=o8e.subVectors(this._targetEnd,this._target),a=a8e.subVectors(this._focalOffsetEnd,this._focalOffset),c=this._zoomEnd-this._zoom;if(Bs(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=kI(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,x,1/0,e),this._needsUpdate=!0}if(Bs(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=kI(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,x,1/0,e),this._needsUpdate=!0}if(Bs(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const x=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=kI(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,x,this.maxSpeed,e),this._needsUpdate=!0}if(Bs(i.x)&&Bs(i.y)&&Bs(i.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const x=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;i8e(this._target,this._targetEnd,this._targetVelocity,x,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Bs(a.x)&&Bs(a.y)&&Bs(a.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const x=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;i8e(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,x,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Bs(c))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const x=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=kI(this._zoom,this._zoomEnd,this._zoomVelocity,x,1/0,e)}if(this.dollyToCursor){if(Q8(this._camera)&&this._changedDolly!==0){const x=this._spherical.radius-this._lastDistance,S=this._camera,M=this._getCameraDirection(Lw),I=ii.copy(M).cross(S.up).normalize();I.lengthSq()===0&&(I.x=1);const L=Xi.crossVectors(I,M),B=this._sphericalEnd.radius*Math.tan(S.getEffectiveFOV()*Nw*.5),V=(this._sphericalEnd.radius-x-this._sphericalEnd.radius)/this._sphericalEnd.radius,X=Q7.copy(this._targetEnd).add(I.multiplyScalar(this._dollyControlCoord.x*B*S.aspect)).add(L.multiplyScalar(this._dollyControlCoord.y*B)),P=ii.copy(this._targetEnd).lerp(X,V),te=this._lastDollyDirection===K7.IN&&this._spherical.radius<=this.minDistance,oe=this._lastDollyDirection===K7.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(te||oe)){this._sphericalEnd.radius-=x,this._spherical.radius-=x;const K=Xi.copy(M).multiplyScalar(-x);P.add(K)}this._boundary.clampPoint(P,P);const ie=Xi.subVectors(P,this._targetEnd);this._targetEnd.copy(P),this._target.add(ie),this._changedDolly-=x,Bs(this._changedDolly)&&(this._changedDolly=0)}else if(I3(this._camera)&&this._changedZoom!==0){const x=this._zoom-this._lastZoom,S=this._camera,M=ii.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(S.near+S.far)/(S.near-S.far)).unproject(S),I=Xi.set(0,0,-1).applyQuaternion(S.quaternion),L=Q7.copy(M).add(I.multiplyScalar(-M.dot(S.up))),A=-(this._zoom-x-this._zoom)/this._zoom,V=this._getCameraDirection(Lw),X=this._targetEnd.dot(V),P=ii.copy(this._targetEnd).lerp(L,A),te=P.dot(V),oe=V.multiplyScalar(te-X);P.sub(oe),this._boundary.clampPoint(P,P);const ie=Xi.subVectors(P,this._targetEnd);this._targetEnd.copy(P),this._target.add(ie),this._changedZoom-=x,Bs(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const u=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,u),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Bs(this._focalOffset.x)||!Bs(this._focalOffset.y)||!Bs(this._focalOffset.z))&&(h1.setFromMatrixColumn(this._camera.matrix,0),d1.setFromMatrixColumn(this._camera.matrix,1),J8.setFromMatrixColumn(this._camera.matrix,2),h1.multiplyScalar(this._focalOffset.x),d1.multiplyScalar(-this._focalOffset.y),J8.multiplyScalar(this._focalOffset.z),ii.copy(h1).add(d1).add(J8),this._camera.position.add(ii),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),ii.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const y=this._needsUpdate;return y&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):y?(this.dispatchEvent({type:"update"}),Bs(t,this.restThreshold)&&Bs(n,this.restThreshold)&&Bs(r,this.restThreshold)&&Bs(i.x,this.restThreshold)&&Bs(i.y,this.restThreshold)&&Bs(i.z,this.restThreshold)&&Bs(a.x,this.restThreshold)&&Bs(a.y,this.restThreshold)&&Bs(a.z,this.restThreshold)&&Bs(c,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!y&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=y,this._needsUpdate=!1,y}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Dw(this.maxDistance),minZoom:this.minZoom,maxZoom:Dw(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Dw(this.maxPolarAngle),minAzimuthAngle:Dw(this.minAzimuthAngle),maxAzimuthAngle:Dw(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:ii.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=Ow(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=Ow(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=Ow(n.maxPolarAngle),this.minAzimuthAngle=Ow(n.minAzimuthAngle),this.maxAzimuthAngle=Ow(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),Kh.setFromVector3(ii.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Kh.theta,Kh.phi,t),this.dollyTo(Kh.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",cYe),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(r===0)return e;const i=Xi.copy(t).add(e),c=this._boundary.clampPoint(i,Q7).sub(i),u=c.lengthSq();if(u===0)return e.add(t);if(u===r)return e;if(n===0)return e.add(t).add(c);{const p=1+n*u/t.dot(c);return e.add(Xi.copy(t).multiplyScalar(p)).add(c.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(Q8(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*Nw,r=Math.tan(n*.5)*t,i=r*e.aspect;this._nearPlaneCorners[0].set(-i,-r,0),this._nearPlaneCorners[1].set(i,-r,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(-i,r,0)}else if(I3(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,i=e.top*t,a=e.bottom*t;this._nearPlaneCorners[0].set(n,i,0),this._nearPlaneCorners[1].set(r,i,0),this._nearPlaneCorners[2].set(r,a,0),this._nearPlaneCorners[3].set(n,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||dj(this._camera,"_collisionTest"))return e;const n=this._getTargetDirection(Lw);vj.lookAt(s8e,n,this._camera.up);for(let r=0;r<4;r++){const i=Xi.copy(this._nearPlaneCorners[r]);i.applyMatrix4(vj);const a=Q7.addVectors(this._target,i);OI.set(a,n),OI.far=this._spherical.radius+1;const c=OI.intersectObjects(this.colliderMeshes);c.length!==0&&c[0].distance<e&&(e=c[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const n=()=>{this.removeEventListener("rest",n),t()};this.addEventListener("rest",n)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Fr.Sphere){const n=t,r=n.center;J7.makeEmpty(),e.traverseVisible(a=>{a.isMesh&&J7.expandByObject(a)}),J7.getCenter(r);let i=0;return e.traverseVisible(a=>{if(!a.isMesh)return;const c=a;if(!c.geometry)return;const u=c.geometry.clone();u.applyMatrix4(c.matrixWorld);const y=u.attributes.position;for(let x=0,S=y.count;x<S;x++)ii.fromBufferAttribute(y,x),i=Math.max(i,r.distanceToSquared(ii))}),n.radius=Math.sqrt(i),n}}const Bk=s=>{const[e,t]=Tn.useState(s.options[s.index]),n=()=>{s.onToggle(!s.open)},r=a=>{a!==e&&(s.onSelect(a),t(a)),s.onToggle(!1)},i=s.open?`${s.options.length*31-1}px`:"0px";return Ke.jsxs("div",{className:`dropdown ${s.up===!0?"up":""}`,children:[Ke.jsx("div",{className:"dropdown-toggle",onClick:n,children:`${s.title}: ${e}`}),Ke.jsx("ul",{className:"dropdown-menu",style:{height:i},children:s.options.map(a=>Ke.jsx("li",{onClick:()=>r(a),children:a},a))})]})},ev=Tn.forwardRef(function(e,t){const n=["Renderer","Depth","Normals","UVs","Wireframe"],[r,i]=Tn.useState("Renderer"),[a,c]=Tn.useState(!1),[u,p]=Tn.useState(!1),[y,x]=Tn.useState(!1);return Ke.jsxs("div",{className:`CameraWindow ${e.name}`,children:[Ke.jsx("div",{ref:t,className:"clickable",onClick:()=>{y&&x(!1)}}),Ke.jsxs("div",{className:"options",children:[e.camera!==null&&Ke.jsx(Bk,{title:"Camera",index:e.options.indexOf(e.camera.name),open:y,options:e.options,onSelect:e.onSelectCamera,onToggle:S=>{S&&u&&p(!1),x(S)},up:!0}),Ke.jsx(Bk,{title:"Mode",index:n.indexOf(r),open:u,options:n,onSelect:S=>{if(S===r)return;const M=S;e.onSelectRenderMode(M),i(M)},onToggle:S=>{S&&y&&x(!1),a&&c(!1),p(S)},up:!0})]})]})}),hYe=`out vec3 worldPosition;
uniform float uDistance;

void main() {
  // Scale the plane by the drawing distance
  worldPosition = position.xzy * uDistance;
  worldPosition.xz += cameraPosition.xz;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(worldPosition, 1.0);
}`,dYe=`out vec4 fragColor;
in vec3 worldPosition;
uniform float uDivisions;
uniform float uScale;
uniform vec3 uColor;
uniform float uDistance;
uniform float uGridOpacity;
uniform float uSubgridOpacity;

#define minAlpha 0.00784313725490196

float getGrid(float gapSize) {
  vec2 worldPositionByDivision = worldPosition.xz / gapSize;

  // Inverted, 0 where line, >1 where there's no line
  // We use the worldPosition (which in this case we use similarly to UVs) differential to control the anti-aliasing
  // We need to do the -0.5)-0.5 trick because the result fades out from 0 to 1, and we want both
  // worldPositionByDivision == 0.3 and worldPositionByDivision == 0.7 to result in the same fade, i.e. 0.3,
  // otherwise only one side of the line will be anti-aliased
  vec2 grid = abs(fract(worldPositionByDivision-0.5)-0.5) / fwidth(worldPositionByDivision) / 2.0;
  float gridLine = min(grid.x, grid.y);

  // Uninvert and clamp
  return 1.0 - min(gridLine, 1.0);
}

void main() {
  float cameraDistanceToGridPlane = max(200.0, distance(cameraPosition.y, worldPosition.y));
  float cameraDistanceToFragmentOnGridPlane = distance(cameraPosition.xyz, worldPosition.xyz);

  // The size of the grid and subgrid are powers of each other and they are determined based on camera distance.
  // The current grid will become the next subgrid when it becomes too small, and its next power becomes the new grid.
  float subGridPower = pow(uDivisions, floor(log(cameraDistanceToGridPlane) / log(uDivisions)));
  float gridPower = subGridPower * uDivisions;

  // If we want to fade both the grid and its subgrid, we need to displays 3 different opacities, with the next grid being the third
  float nextGridPower = gridPower * uDivisions;

  // 1 where grid, 0 where no grid
  float subgrid = getGrid(subGridPower * uScale);
  float grid = getGrid(gridPower * uScale);
  float nextGrid = getGrid(nextGridPower * uScale);

  // Where we are between the introduction of the current grid power and when we switch to the next grid power
  float stepPercentage = (cameraDistanceToGridPlane - subGridPower)/(gridPower - subGridPower);

  // The last x percentage of the current step over which we want to fade
  float fadeRange = 0.3;

  // We calculate the fade percentage from the step percentage and the fade range
  float fadePercentage = max(stepPercentage - 1.0 + fadeRange, 0.0) / fadeRange;

  // Set base opacity based on how close we are to the drawing distance, with a cubic falloff
  float baseOpacity = subgrid * pow(1.0 - min(cameraDistanceToFragmentOnGridPlane / uDistance, 1.0), 3.0);

  // Shade the subgrid
  fragColor = vec4(uColor.rgb, (baseOpacity - fadePercentage) * uSubgridOpacity);

  // Somewhat arbitrary additional fade coefficient to counter anti-aliasing popping when switching between grid powers
  float fadeCoefficient = 0.5;

  // Shade the grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity - fadePercentage * (uGridOpacity - uSubgridOpacity) * fadeCoefficient, grid);

  // Shade the next grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity, nextGrid);

  if (fragColor.a <= minAlpha) discard;
}`;class fYe extends r0{constructor(e){super({extensions:{derivatives:!0},uniforms:{uScale:{value:(e==null?void 0:e.scale)!==void 0?e==null?void 0:e.scale:.1},uDivisions:{value:(e==null?void 0:e.divisions)!==void 0?e==null?void 0:e.divisions:10},uColor:{value:(e==null?void 0:e.color)!==void 0?e==null?void 0:e.color:new Pn(16777215)},uDistance:{value:(e==null?void 0:e.distance)!==void 0?e==null?void 0:e.distance:1e4},uSubgridOpacity:{value:(e==null?void 0:e.subgridOpacity)!==void 0?e==null?void 0:e.subgridOpacity:.15},uGridOpacity:{value:(e==null?void 0:e.gridOpacity)!==void 0?e==null?void 0:e.gridOpacity:.25}},glslVersion:yH,side:gl,transparent:!0,name:"InfiniteGrid",vertexShader:hYe,fragmentShader:dYe,depthTest:!1})}}class pYe extends mn{constructor(t){const n=new fYe(t);super(new Ev,n);Xe(this,"gridMaterial");this.gridMaterial=n,this.frustumCulled=!1,this.name="InfiniteGridHelper"}update(){this.gridMaterial.needsUpdate=!0}}function fE(s){const[e,t]=Tn.useState(s.open!==void 0?s.open:!1),[n,r]=Tn.useState(s.visible!==void 0?s.visible:!1),i=!e||s.children===void 0,a=()=>{s.three.dispatchEvent({type:li.REMOVE_SCENE,value:s.scene})};return Ke.jsxs("div",{className:`accordion ${i?"hide":""}`,children:[Ke.jsxs("button",{className:"toggle",onClick:()=>{const c=!e;s.onToggle!==void 0&&s.onToggle(c),t(c)},children:[Ke.jsx("p",{className:`status ${e?"open":""}`,children:"Toggle"}),Ke.jsx("p",{className:"label",children:vk(s.label)})]}),s.onRefresh?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("button",{className:"visibility",style:{opacity:n?1:.25},onClick:()=>{const u=s.three.getScene(s.scene.uuid);if(u){const p=!u.visible;u.visible=p,r(p)}}}),Ke.jsx("button",{className:"refresh",onClick:s.onRefresh}),Ke.jsx("button",{className:"remove",onClick:a})]}):null,s.button,Ke.jsx("div",{className:e?"open":"",children:Ke.jsx("div",{children:s.children})},Math.random())]})}function Jw(s){const[e,t]=Tn.useState(s.defaultValue);return Tn.useEffect(()=>{var M,I;let n=!1,r=-1,i=0,a=s.defaultValue,c=!1;const u=L=>{c=L.ctrlKey},p=L=>{var B;n=!0,i=Number((B=s.input.current)==null?void 0:B.value),r=L.clientX,document.addEventListener("mouseup",x,!1),document.addEventListener("mousemove",y,!1),document.addEventListener("contextmenu",x,!1)},y=L=>{if(!n)return;const B=s.step!==void 0?s.step:1,A=(L.clientX-r)*B*(c?10:1);a=Number((i+A).toFixed(4)),s.min!==void 0&&(a=Math.max(a,s.min)),s.max!==void 0&&(a=Math.min(a,s.max)),s.onChange!==void 0&&s.onChange(a),t(a)},x=()=>{n=!1,document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",y),document.removeEventListener("contextmenu",x)},S=L=>{const B=Number(L.target.value);s.onChange!==void 0&&s.onChange(B),t(B)};return(M=s.label.current)==null||M.addEventListener("mousedown",p,!1),s.sliderRef!==void 0&&((I=s.sliderRef.current)==null||I.addEventListener("input",S)),document.addEventListener("keydown",u,!1),document.addEventListener("keyup",u,!1),()=>{var L,B;(L=s.label.current)==null||L.removeEventListener("mousedown",p),s.sliderRef!==void 0&&((B=s.sliderRef.current)==null||B.removeEventListener("input",S)),document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",y),document.removeEventListener("contextmenu",x),document.removeEventListener("keydown",u),document.addEventListener("keyup",u,!1)}},[]),e}function bv(s){const e=Tn.useRef(null),t=Tn.useRef(null),[n,r]=Tn.useState(s.value);return Jw({label:s.labelRef,input:e,sliderRef:t,defaultValue:n,min:s.min,max:s.max,step:s.step,onChange:i=>{r(i),s.onChange!==void 0&&s.onChange(s.prop,i)}}),Ke.jsxs(Ke.Fragment,{children:[s.type==="number"&&Ke.jsx("input",{alt:s.alt,className:s.className,ref:e,type:"number",value:n,min:s.min,max:s.max,step:s.step,disabled:s.disabled,name:P0(),onChange:i=>{if(r(i.target.value),i.target.value.length===0)return;const a=Number(i.target.value);isNaN(a)||s.onChange!==void 0&&s.onChange(s.prop,a)}}),s.type==="range"&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("input",{type:"text",value:n.toString(),disabled:s.disabled,ref:e,className:"min",name:P0(),onChange:i=>{if(i.target.value.length===0)return;const a=Number(i.target.value);isNaN(a)||(r(a),s.onChange!==void 0&&s.onChange(s.prop,a))}}),Ke.jsx("input",{disabled:s.disabled,type:"range",value:n,min:s.min,max:s.max,step:s.step,ref:t,name:P0(),onChange:jve})]})]})}function mYe(s){const e=Tn.useRef(null),t=Tn.useRef(null),n=Tn.useRef(null),r=Tn.useRef(null),i=Tn.useRef(null),a=Tn.useRef(null),c=Tn.useRef(null),u=Tn.useRef(null),p=Tn.useRef(null),y=Tn.useRef(null),[x,S]=Tn.useState(s.value.x),[M,I]=Tn.useState(s.value.y),[L,B]=Tn.useState({min:Math.min(s.min,Math.min(s.value.x,s.value.y)),max:Math.max(s.max,Math.max(s.value.x,s.value.y))}),[A,V]=Tn.useState(!1);Jw({label:c,input:e,defaultValue:x,min:L.min,max:L.max,step:.01,onChange:re=>{S(re),s.onChange({target:{value:{x:re,y:M}}})}}),Jw({label:u,input:t,defaultValue:M,min:L.min,max:L.max,step:.01,onChange:re=>{I(re),s.onChange({target:{value:{x,y:re}}})}}),Jw({label:p,input:n,defaultValue:L.min,min:L.min-1,max:L.max+1,step:.01,onChange:re=>{B({min:re,max:L.max})}}),Jw({label:y,input:r,defaultValue:L.max,min:L.min-1,max:L.max+1,step:.01,onChange:re=>{B({min:L.min,max:re})}});function X(){A||(window.addEventListener("mousemove",te),window.addEventListener("mouseup",P),V(!0))}function P(){window.removeEventListener("mousemove",te),window.removeEventListener("mouseup",P),V(!1)}function te(re){const se=i.current.getBoundingClientRect(),q=rv(0,99,re.clientX-se.left)/99,De=1-rv(0,99,re.clientY-se.top)/99,Be=Rf(RH(L.min,L.max,q),3),tt=Rf(RH(L.min,L.max,De),3);s.onChange({target:{value:{x:Be,y:tt}}}),S(Be),I(tt)}function oe(){const re=Number(n.current.value);B({min:re,max:L.max}),x<re&&S(rv(re,L.max,x)),M<re&&I(rv(re,L.max,M))}function ie(){const re=Number(r.current.value);B({min:L.min,max:re}),x>re&&S(rv(L.min,re,x)),M>re&&I(rv(L.min,re,M))}Tn.useEffect(()=>{a.current.style.left=`${$3e(L.min,L.max,x)*100}%`,a.current.style.top=`${(1-$3e(L.min,L.max,M))*100}%`},[L,x,M]);const K=s.step!==void 0?s.step:.01;return Ke.jsxs("div",{className:"vector2",children:[Ke.jsxs("div",{className:"fields",children:[Ke.jsxs("div",{children:[Ke.jsx("span",{ref:c,children:"X"}),Ke.jsx("input",{ref:e,type:"number",value:x,min:L.min,max:L.max,step:K,name:P0(),onChange:re=>{if(S(re.target.value),re.target.value.length===0)return;const se=Number(re.target.value);isNaN(se)||(s.onChange({target:{value:{x:se,y:M}}}),se<L.min&&B({min:se,max:L.max}))}})]}),Ke.jsxs("div",{children:[Ke.jsx("span",{ref:u,children:"Y"}),Ke.jsx("input",{ref:t,type:"number",value:M,min:L.min,max:L.max,step:K,name:P0(),onChange:re=>{if(I(re.target.value),re.target.value.length===0)return;const se=Number(re.target.value);isNaN(se)||(s.onChange({target:{value:{x,y:se}}}),se>L.max&&B({min:L.min,max:se}))}})]}),Ke.jsxs("div",{children:[Ke.jsx("span",{ref:p,children:"Min"}),Ke.jsx("input",{ref:n,type:"number",value:L.min,step:K,name:P0(),onChange:oe})]}),Ke.jsxs("div",{children:[Ke.jsx("span",{ref:y,children:"Max"}),Ke.jsx("input",{ref:r,type:"number",value:L.max,step:K,name:P0(),onChange:ie})]})]}),Ke.jsxs("div",{className:"input",ref:i,onMouseDown:X,onMouseUp:P,children:[Ke.jsx("div",{className:"x"}),Ke.jsx("div",{className:"y"}),Ke.jsx("div",{className:"pt",ref:a})]})]})}function u8e(s){const e=s.value.x!==void 0&&s.value.y!==void 0&&s.value.z!==void 0,t=s.value.isEuler!==void 0,n=s.value.elements!==void 0,r=s.step!==void 0?s.step:.01,i=[];if(t){const a=Tn.useMemo(()=>s.value,[]);["_x","_y","_z"].forEach(u=>{const p=Tn.useRef(null);i.push(Ke.jsxs("div",{children:[Ke.jsx("span",{ref:p,children:u.substring(1).toUpperCase()}),Ke.jsx(bv,{value:Wve(a[u]),type:"number",prop:u,step:.1,labelRef:p,onChange:(y,x)=>{a[y]=yk(x),s.onChange({target:{value:a}})}})]},u))})}else if(e){const a=Tn.useMemo(()=>s.value,[]),c=(p,y)=>{a[p]=y,s.onChange({target:{value:a}})};["x","y","z"].forEach(p=>{const y=Tn.useRef(null);i.push(Ke.jsxs("div",{children:[Ke.jsx("label",{ref:y,children:p.toUpperCase()}),Ke.jsx(bv,{value:a[p],type:"number",prop:p,step:r,labelRef:y,onChange:c})]},p))})}else if(n){const a=Tn.useMemo(()=>s.value,[]),c=(u,p)=>{const y=Number(u);a.elements[y]=p,s.onChange({target:{value:a}})};for(let u=0;u<9;u++){const p=Tn.useRef(null);i.push(Ke.jsxs("div",{children:[Ke.jsx("label",{ref:p,children:u+1}),Ke.jsx(bv,{value:a.elements[u],type:"number",prop:u.toString(),step:r,labelRef:p,onChange:c})]},u.toString()))}}return Ke.jsx("div",{className:"grid3",children:i},Math.random().toString())}function gYe(s){const e=s.value.x!==void 0,t=s.step!==void 0?s.step:.01,n=[];if(e){const r=Tn.useMemo(()=>s.value,[]),i=(c,u)=>{r[c]=u,s.onChange({target:{value:r}})};["x","y","z","w"].forEach(c=>{const u=Tn.useRef(null);n.push(Ke.jsxs("div",{children:[Ke.jsx("label",{ref:u,children:c.toUpperCase()}),Ke.jsx(bv,{value:r[c],type:"number",prop:c,step:t,labelRef:u,onChange:i})]},c))})}else{const r=Tn.useMemo(()=>s.value,[]),i=(a,c)=>{const u=Number(a);r.elements[u]=c,s.onChange({target:{value:r}})};for(let a=0;a<16;a++){const c=Tn.useRef(null);n.push(Ke.jsxs("div",{children:[Ke.jsx("span",{ref:c,children:a+1}),Ke.jsx(bv,{value:r.elements[a],type:"number",prop:a.toString(),step:t,labelRef:c,onChange:i})]},a.toString()))}}return Ke.jsx("div",{className:"grid4",children:n})}function vYe(s){return!(s==="defaultAttributeValues"||s==="forceSinglePass"||s==="linecap"||s==="linejoin"||s==="linewidth"||s==="normalMapType"||s==="precision"||s==="shadowSide"||s==="uniformsGroups"||s==="uniformsNeedUpdate"||s==="userData"||s==="version"||s==="wireframeLinecap"||s==="wireframeLinejoin"||s==="wireframeLinewidth"||s.slice(0,4)==="clip"||s.slice(0,7)==="polygon"||s.slice(0,7)==="stencil"||s.slice(0,2)==="is")}function yYe(s){switch(s){case"Alpha Map":return"alphaMap";case"Anisotropy Map":return"anisotropyMap";case"AO Map":return"aoMap";case"Bump Map":return"bumpMap";case"Clearcoat Map":return"clearcoatMap";case"Clearcoat Normal Map":return"clearcoatNormalMap";case"Clearcoat Roughness Map":return"clearcoatRoughnessMap";case"Displacement Map":return"displacementMap";case"Emissive Map":return"emissiveMap";case"Gradient Map":return"gradientMap";case"Iridescence Map":return"iridescenceMap";case"Iridescence Thickness Map":return"iridescenceThicknessMap";case"Map":return"map";case"Matcap":return"matcap";case"Normal Map":return"normalMap";case"Roughness Map":return"roughnessMap";case"Sheen Color Map":return"sheenColorMap";case"Sheen Roughness Map":return"sheenRoughnessMap";case"Specular Color Map":return"specularColorMap";case"Specular Map Intensity":return"specularIntensityMap";case"Thickness Map":return"thicknessMap";case"Transmission Map":return"transmissionMap"}return s}function fN(s){switch(s){case"alphaHash":return"Alpha Hash";case"alphaMap":return"Alpha Map";case"alphaToCoverage":return"Alpha To Coverage";case"anisotropy":return"Anisotropy";case"anisotropyMap":return"Anisotropy Map";case"anisotropyRotation":return"Anisotropy Rotation";case"aoMap":return"AO Map";case"aoMapIntensity":return"AO Map Intensity";case"attenuationColor":return"Attenuation Color";case"attenuationDistance":return"Attenuation Distance";case"blendAlpha":return"Blend Alpha";case"blendColor":return"Blend Color";case"blendDst":return"Blend Dst";case"blendDstAlpha":return"Blend Dst Alha";case"blendEquation":return"Blend Equation";case"blendEquationAlpha":return"Blend Equation Alpha";case"blending":return"Blending";case"blendSrc":return"Blend Src";case"blendSrcAlpha":return"Blend Src Alpha";case"bumpMap":return"Bump Map";case"bumpScale":return"Bump Scale";case"clearcoat":return"Clearcoat";case"clearcoatMap":return"Clearcoat Map";case"clearcoatNormalMap":return"Clearcoat Normal Map";case"clearcoatNormalScale":return"Clearcoat Normal Scale";case"clearcoatRoughness":return"Clearcoat Roughness";case"clearcoatRoughnessMap":return"Clearcoat Roughness Map";case"color":return"Color";case"colorWrite":return"Color Write";case"defines":return"Defines";case"depthFunc":return"Depth Func";case"depthTest":return"Depth Test";case"depthWrite":return"Depth Write";case"dispersion":return"Dispersion";case"displacementBias":return"Displacement Bias";case"displacementMap":return"Displacement Map";case"displacementScale":return"Displacement Scale";case"dithering":return"Dithering";case"emissive":return"Emissive";case"emissiveMap":return"Emissive Map";case"emissiveIntensity":return"Emissive Intensity";case"envMap":return"Environment Map";case"envMapIntensity":return"Environment Map Intensity";case"envMapRotation":return"Environment Map Rotation";case"extensions":return"Extensions";case"flatShading":return"Flat Shading";case"fragmentShader":return"Fragment Shader";case"fog":return"Fog";case"glslVersion":return"GLSL Version";case"gradientMap":return"Gradient Map";case"ior":return"IOR";case"iridescence":return"Iridescence";case"iridescenceIOR":return"Iridescence IOR";case"iridescenceMap":return"Iridescence Map";case"iridescenceThicknessMap":return"Iridescence Thickness Map";case"iridescenceThicknessRange":return"Iridescence Thickness Range";case"lights":return"Lights";case"lightMap":return"Light Map";case"lightMapIntensity":return"Light Map Intensity";case"map":return"Map";case"matcap":return"Matcap";case"metalness":return"Metalness";case"metalnessMap":return"Metalness Map";case"name":return"Name";case"normalMap":return"Normal Map";case"normalScale":return"Normal Scale";case"premultipliedAlpha":return"Premultiplied Alpha";case"opacity":return"Opacity";case"reflectivity":return"Reflectivity";case"refractionRatio":return"Refraction Ratio";case"roughness":return"Roughness";case"roughnessMap":return"Roughness Map";case"sheen":return"Sheen";case"sheenColor":return"Sheen Color";case"sheenColorMap":return"Sheen Color Map";case"sheenRoughness":return"Sheen Roughness";case"sheenRoughnessMap":return"Sheen Roughness Map";case"shininess":return"Shininess";case"side":return"Side";case"size":return"Size";case"sizeAttenuation":return"Size Attenuation";case"specular":return"Specular";case"specularColor":return"Specular Color";case"specularColorMap":return"Specular Color Map";case"specularIntensity":return"Specular Intensity";case"specularIntensityMap":return"Specular Map Intensity";case"thickness":return"Thickness";case"thicknessMap":return"Thickness Map";case"toneMapped":return"Tone Mapped";case"transmission":return"Transmission";case"transmissionMap":return"Transmission Map";case"transparent":return"Transparent";case"type":return"Type";case"uuid":return"UUID";case"uniforms":return"Uniforms";case"vertexColors":return"Vertex Colors";case"vertexShader":return"Vertex Shader";case"visible":return"Visible";case"wireframe":return"Wireframe"}return s}function _7e(s){const e=s.toLowerCase();return e.search("intensity")>-1||e==="anisotropyrotation"||e==="blendalpha"||e==="bumpscale"||e==="clearcoatroughness"||e==="displacementbias"||e==="displacementscale"||e==="metalness"||e==="opacity"||e==="reflectivity"||e==="refractionratio"||e==="roughness"||e==="sheenroughness"}function xYe(){const s=document.createElement("input");return s.type="file",new Promise((e,t)=>{s.addEventListener("change",function(){if(s.files===null)t();else{const n=s.files[0],r=new FileReader;r.onload=function(i){e(i.target.result)},r.readAsDataURL(n)}}),s.click()})}const _Ye=[{title:"Front",value:E1},{title:"Back",value:Qo},{title:"Double",value:gl}],bYe=[{title:"No Blending",value:cc},{title:"Normal",value:xv},{title:"Additive",value:Nj},{title:"Subtractive",value:Dj},{title:"Multiply",value:Oj},{title:"Custom",value:D8e}],SYe=[{title:"Add",value:L3},{title:"Subtract",value:O8e},{title:"Reverse Subtract",value:L8e},{title:"Min",value:F8e},{title:"Max",value:B8e}],wYe=[{title:"Zero",value:mW},{title:"One",value:gW},{title:"Src Color",value:vW},{title:"One Minus Src Color",value:yW},{title:"Src Alpha",value:mE},{title:"One Minus Src Alpha",value:gE},{title:"Dst Alpha",value:xW},{title:"One Minus Dst Alpha",value:_W},{title:"Dst Color",value:bW},{title:"One Minus Dst Color",value:SW},{title:"Src Alpha Saturate",value:U8e},{title:"Constant Color",value:wW},{title:"One Minus Constant Color",value:EW},{title:"Constant Alpha",value:TW},{title:"One Minus Constant Alpha",value:MW}],EYe=[{title:"Zero",value:mW},{title:"One",value:gW},{title:"Src Color",value:vW},{title:"One Minus Src Color",value:yW},{title:"Src Alpha",value:mE},{title:"One Minus Src Alpha",value:gE},{title:"Dst Alpha",value:xW},{title:"One Minus Dst Alpha",value:_W},{title:"Dst Color",value:bW},{title:"One Minus Dst Color",value:SW},{title:"Constant Color",value:wW},{title:"One Minus Constant Color",value:EW},{title:"Constant Alpha",value:TW},{title:"One Minus Constant Alpha",value:MW}];function Bw(s,e){s.needsUpdate=!0,s.type="option",s.options=e}function TYe(s,e,t,n){return{type:"boolean",title:fN(s),prop:s,value:e,needsUpdate:!0,onChange:(r,i)=>{n.updateObject(t.uuid,`material.${s}`,i),n.updateObject(t.uuid,"material.needsUpdate",!0);const a=n.getScene(t.uuid);if(a!==null){const c=a.getObjectByProperty("uuid",t.uuid);Ko(c,`material.${s}`,i)}}}}function MYe(s,e,t,n){const r={type:"number",title:fN(s),prop:s,value:e,min:void 0,max:void 0,step:.01,needsUpdate:!0,onChange:(i,a)=>{n.updateObject(t.uuid,`material.${s}`,a),n.updateObject(t.uuid,"material.needsUpdate",!0);const c=n.getScene(t.uuid);if(c!==null){const u=c.getObjectByProperty("uuid",t.uuid);Ko(u,`material.${s}`,a)}}};switch(s){case"blending":Bw(r,bYe);break;case"blendDst":Bw(r,EYe);break;case"blendEquation":Bw(r,SYe);break;case"blendSrc":Bw(r,wYe);break;case"side":Bw(r,_Ye);break}return _7e(s)&&(r.value=Number(e),r.type="range",r.min=Math.min(0,r.value),r.max=Math.max(1,r.value),r.step=.01),r}function CYe(s,e,t,n){const r={type:"string",title:fN(s),prop:s,value:e,needsUpdate:!0,onChange:(a,c)=>{n.updateObject(t.uuid,`material.${s}`,c),n.updateObject(t.uuid,"material.needsUpdate",!0);const u=n.getScene(t.uuid);if(u!==null){const p=u.getObjectByProperty("uuid",t.uuid);Ko(p,`material.${s}`,c)}},onKeyDown:a=>{}};return(s==="vertexShader"||s==="fragmentShader")&&(r.type="field",r.disabled=!1,r.latest=r.value,r.onChange=(a,c)=>{r.latest=c,n.updateObject(t.uuid,`material.${s}`,c);const u=n.getScene(t.uuid);if(u!==null){const p=u.getObjectByProperty("uuid",t.uuid);Ko(p,`material.${s}`,c)}},r.onKeyDown=a=>{if(a.key==="Enter"&&(a.altKey||a.metaKey)){n.updateObject(t.uuid,"material.needsUpdate",!0);const c=n.getScene(t.uuid);if(c!==null){const u=c.getObjectByProperty("uuid",t.uuid);Ko(u,"material.needsUpdate",!0)}}}),r}function AYe(s){return s.x!==void 0&&s.y!==void 0&&s.z===void 0}function PYe(s){return s.x!==void 0&&s.y!==void 0&&s.z!==void 0&&s.w===void 0}function RYe(s){return s.x!==void 0&&s.y!==void 0&&s.z!==void 0&&s.w!==void 0}function uW(s){s.sort((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)}function eE(s,e,t,n,r="",i=!1){const a=fN(s).split(".")[0].replaceAll("[","").replaceAll("]",""),c=r.length>0?`${r}.${s}`:s,u=typeof e;if(u==="boolean"||u==="string")return{title:a,prop:c,type:u,value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Ko(S,`material.${c}`,y)}}};if(u==="number"){const p={title:a,prop:c,type:"number",value:e,step:.01,disabled:i,onChange:(y,x)=>{n.updateObject(t.uuid,`material.${c}`,x);const S=n.getScene(t.uuid);if(S!==null){const M=S.getObjectByProperty("uuid",t.uuid);Ko(M,`material.${c}`,x)}}};return _7e(a)&&(p.type="range",p.min=0,p.max=1),p}else{if(e.isColor)return{title:a,prop:c,type:"color",value:e,disabled:i,onChange:(p,y)=>{const x=new Pn(y);n.updateObject(t.uuid,`material.${c}`,x);const S=n.getScene(t.uuid);if(S!==null){const M=S.getObjectByProperty("uuid",t.uuid);Ko(M,`material.${c}`,x)}}};if(Array.isArray(e)){const p=[];for(const y in e){const x=e[y],S=`[${y.toString()}]`;if(x.value!==void 0){const M=eE(`${S}.value`,x.value,t,n,c,i);M!==void 0&&p.push(M)}else{const M=eE(S,x,t,n,c,i);M!==void 0&&p.push(M)}}if(p.length>0)return uW(p),{title:a,items:p}}else{if(AYe(e))return{title:a,prop:c,type:"vector2",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Ko(S,`material.${c}`,y)}}};if(PYe(e))return{title:a,prop:c,type:"grid3",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Ko(S,`material.${c}`,y)}}};if(RYe(e))return{title:a,prop:c,type:"grid4",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Ko(S,`material.${c}`,y)}}};if(e.isEuler)return{title:a,prop:c,type:"euler",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Ko(S,`material.${c}`,y)}}};if(e.src!==void 0)return{title:a,type:"image",value:e,disabled:i,onChange:(p,y)=>{const x=yYe(s),S=r.length>0?`${r}.${x}`:x;n.createTexture(t.uuid,`material.${S}`,y);const M=n.getScene(t.uuid);if(M!==null){const I=M.getObjectByProperty("uuid",t.uuid);if(I!==void 0){const L=B=>{const A=I.material,V=S.split(".");switch(V.length){case 1:A[V[0]]=B;break;case 2:A[V[0]][V[1]]=B;break;case 3:A[V[0]][V[1]][V[2]]=B;break;case 4:A[V[0]][V[1]][V[2]][V[3]]=B;break;case 5:A[V[0]][V[1]][V[2]][V[3]][V[4]]=B;break}A.needsUpdate=!0};y.src.length>0?e$(y.src).then(B=>{B.offset.set(y.offset[0],y.offset[1]),B.repeat.set(y.repeat[0],y.repeat[1]),L(B)}):L(null)}}}};if(e.elements!==void 0)return{title:a,prop:c,type:e.elements.length>9?"grid4":"grid3",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Ko(S,`material.${c}`,y)}}};{const p=[],y=s==="defines"||s==="extensions";try{for(const x in e){const S=e[x];if(S!==void 0)if(S.value!==void 0){const M=eE(`${x}.value`,S.value,t,n,c,y);M!==void 0&&p.push(M)}else{const M=eE(x,S,t,n,c,y);M!==void 0&&p.push(M)}}}catch{console.log("Hermes - Issue cycling through material object:",s,e)}if(p.length>0)return uW(p),{title:a,items:p}}}}}function h8e(s,e,t){const n=[];for(const r in s){if(!vYe(r))continue;const i=typeof s[r],a=s[r];if(i==="boolean")n.push(TYe(r,a,e,t));else if(i==="number")n.push(MYe(r,a,e,t));else if(i==="string")n.push(CYe(r,a,e,t));else if(i==="object"){const c=eE(r,a,e,t);c!==void 0&&n.push(c)}else a!==void 0&&console.log("Hermes - Other Material Prop Type:",r,i,a)}return uW(n),n.push({title:"Update Material",type:"button",onChange:()=>{t.updateObject(e.uuid,"material.needsUpdate",!0);const r=t.getScene(e.uuid);if(r!==null){const i=r.getObjectByProperty("uuid",e.uuid);Ko(i,"material.needsUpdate",!0)}}}),n}function IYe(s,e){function t(){return`${e.name}_material`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function i(c){localStorage.setItem(t(),c?"open":"closed")}const a=s.material;if(Array.isArray(a)){const c=[],u=a.length;for(let p=0;p<u;p++)c.push(Ke.jsx(cd,{three:e,title:`Material ${p}`,items:h8e(a[p],s,e)},`Material ${p}`));return Ke.jsx(Ke.Fragment,{children:c})}else return Ke.jsx(cd,{three:e,title:"Material",items:h8e(a,s,e),expanded:r,onToggle:c=>{i(c)}})}const d8e="data:image/gif;base64,R0lGODlhDgFkAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuZGJhM2RhM2I1LCAyMDIzLzEyLzE1LTEwOjQyOjM3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjUuNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyMDk3M0NEODAxQjQxMUVGODVGNENDMkUyMUExNDk1NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyMDk3M0NEOTAxQjQxMUVGODVGNENDMkUyMUExNDk1NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE4ODc3Qzg5MDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE4ODc3QzhBMDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAAAAAAAsAAAAAA4BZAAAAv+Mj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqTkJAGDQ+dnpuekmGgAKejpKuiZqmprKqoZKGyrbOlqrejub6xvLGyw8TFzcprurGuvqybxq7ETbrItsCz0l7Zpc+6p9/cS967w9/S2FTF0u/mzehK4Oqz3eTl9vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0XHDt6/AgypMiRJEuaPIkypcqVLFt+KwAAOw==";function kYe(s){const e=s.step!==void 0?s.step:.01,t=Tn.useRef(null),n=Tn.useRef(null),r=Tn.useRef(null),i=Tn.useRef(null),a=Tn.useRef(null),[c]=Tn.useState(s.value),[u,p]=Tn.useState(s.value.offset[0]),[y,x]=Tn.useState(s.value.offset[1]),[S,M]=Tn.useState(s.value.repeat[0]),[I,L]=Tn.useState(s.value.repeat[1]);function B(V,X,P,te,oe){if(s.onChange!==void 0){const ie=s.prop!==void 0?s.prop:s.title;s.onChange(ie,{src:V,offset:[X,P],repeat:[te,oe]})}}function A(V){const X=t.current.src,P=V.target.value;switch(V.target){case n.current:p(P),B(X,P,y,S,I);break;case r.current:x(P),B(X,u,P,S,I);break;case i.current:M(P),B(X,u,y,P,I);break;case a.current:L(P),B(X,u,y,S,P);break}}return Ke.jsxs("div",{className:"imageField",children:[Ke.jsx("img",{alt:s.title,ref:t,onClick:()=>{xYe().then(V=>{t.current.src=V,B(V,u,y,S,I)})},src:c.src.length>0?c.src:d8e}),Ke.jsxs("div",{className:"fields",children:[Ke.jsxs("div",{children:[Ke.jsx("span",{children:"Offset:"}),Ke.jsx("input",{ref:n,type:"number",value:u,step:e,name:P0(),onChange:A}),Ke.jsx("input",{ref:r,type:"number",value:y,step:e,name:P0(),onChange:A})]}),Ke.jsxs("div",{children:[Ke.jsx("span",{children:"Repeat:"}),Ke.jsx("input",{ref:i,type:"number",value:S,step:e,name:P0(),onChange:A}),Ke.jsx("input",{ref:a,type:"number",value:I,step:e,name:P0(),onChange:A})]}),Ke.jsx("button",{onClick:()=>{B("",u,y,S,I),t.current.src=d8e},children:"Clear"})]})]})}function sk(s){var p;let e=s.value;e!==void 0&&(e.isColor!==void 0?e=j3e(s.value):s.type==="color"&&(e=j3e(new Pn().setStyle(s.value,Ju))));const[t,n]=Tn.useState(e),r=Tn.useRef(null),i=y=>{let x=y.target.value;if(s.type==="boolean")x=y.target.checked;else if(s.type==="option"&&(typeof s.value=="number"?x=Number(x):typeof s.value=="boolean"?x=!!x:typeof s.value=="object"&&(x=JSON.parse(x)),s.options!==void 0)){const S=s.options.length;for(let M=0;M<S&&s.options[M].value!==x;M++);}n(x),s.onChange!==void 0&&s.onChange(s.prop!==void 0?s.prop:s.title,x)},a={};s.disabled&&(a.opacity=.8);const c=s.type==="field"||s.type==="string"&&(t.length>100||t.search(`
`)>-1),u=c||s.type==="image"||s.type==="vector2";return Ke.jsxs("div",{className:`field ${u?"block":""}`,style:a,children:[s.type!=="button"&&Ke.jsx("span",{ref:r,children:vk(s.title)},"fieldLabel"),s.type==="string"&&!c&&Ke.jsx("input",{type:"text",disabled:s.disabled,onChange:i,value:t,name:P0()}),(s.type==="field"||s.type==="string"&&c)&&Ke.jsx("textarea",{cols:50,rows:10,disabled:s.disabled!==void 0?s.disabled:!0,onChange:i,onKeyDown:y=>{s.onKeyDown!==void 0&&s.onKeyDown(y)},value:t,name:P0()}),s.type==="boolean"&&Ke.jsx("input",{type:"checkbox",disabled:s.disabled,onChange:i,checked:t,name:P0()}),s.type==="number"&&Ke.jsx(bv,{value:t,type:s.type,prop:s.prop!==void 0?s.prop:s.title,min:s.min,max:s.max,step:s.step,disabled:s.disabled,labelRef:r,onChange:s.onChange}),s.type==="range"&&Ke.jsx(bv,{value:t,type:s.type,prop:s.prop!==void 0?s.prop:s.title,min:s.min,max:s.max,step:s.step,disabled:s.disabled,labelRef:r,onChange:s.onChange}),s.type==="color"&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("input",{type:"text",value:t.toString(),onChange:i,disabled:s.disabled,className:"color",name:P0()}),Ke.jsx("input",{type:"color",value:t,onChange:i,disabled:s.disabled,name:P0()})]}),s.type==="button"&&Ke.jsx("button",{disabled:s.disabled,onClick:()=>{s.onChange!==void 0&&s.onChange(s.prop!==void 0?s.prop:s.title,!0)},children:s.title}),s.type==="image"&&Ke.jsx(kYe,{title:s.title,prop:s.prop,value:s.value,onChange:s.onChange}),s.type==="option"&&Ke.jsx(Ke.Fragment,{children:Ke.jsx("select",{onChange:i,disabled:s.disabled,defaultValue:s.value,name:P0(),children:(p=s.options)==null?void 0:p.map((y,x)=>Ke.jsx("option",{value:y.value,children:vk(y.title)},x))})}),s.type==="vector2"&&Ke.jsx(mYe,{step:s.step,value:t,min:0,max:1,onChange:i}),s.type==="grid3"&&Ke.jsx(u8e,{step:s.step,value:t,onChange:i}),s.type==="grid4"&&Ke.jsx(gYe,{step:s.step,value:t,onChange:i}),s.type==="euler"&&Ke.jsx(u8e,{step:s.step,value:t,onChange:i})]})}function NYe(s){return"items"in s}class cd extends Tn.Component{constructor(t){super(t);Xe(this,"subgroupNames",[]);Xe(this,"subgroupElements",[]);Xe(this,"valueOverrides",new Map);Xe(this,"three");this.three=t.three,this.state={lastUpdated:Date.now()}}addGroup(t){const n=[];t.items.forEach(a=>{n.push({type:a.type,prop:a.prop,title:a.title!==void 0?a.title:a.prop,value:a.value,min:a.min,max:a.max,step:a.step,options:a.options,disabled:a.disabled,onChange:(c,u)=>{t.onUpdate(c,u)}})});const r=Tn.createRef(),i=Ke.jsx(cd,{three:this.props.three,ref:r,title:t.title,expanded:t.expanded,items:n},Math.random());return this.subgroupNames.push(t.title),this.subgroupElements.push(i),this.setState({lastUpdated:Date.now()}),r}removeGroup(t){const n=this.subgroupNames.length;for(let r=0;r<n;r++){const i=this.subgroupNames[r];if(t===i){this.subgroupNames.splice(r,1),this.subgroupElements.splice(r,1),this.setState({lastUpdated:Date.now()});return}}}setField(t,n){this.valueOverrides.set(t,n),this.setState({lastUpdated:Date.now()})}render(){const t=[];return this.props.items.forEach(n=>{if(NYe(n))t.push(Ke.jsx(cd,{three:this.props.three,title:vk(n.title),items:n.items},Math.random()));else{const r=this.valueOverrides.get(n.title),i=r!==void 0?r:n.value;t.push(Ke.jsx(sk,{title:n.title,prop:n.prop,value:i,type:n.type,min:n.min,max:n.max,step:n.step,disabled:n.disabled,options:n.options,onChange:(a,c)=>{n.onChange!==void 0&&(this.valueOverrides.delete(n.title),n.onChange(a,c))},onKeyDown:a=>{n.onKeyDown!==void 0&&n.onKeyDown(a)}},Math.random()))}}),this.subgroupElements.forEach(n=>t.push(n)),Ke.jsx(fE,{three:this.props.three,label:this.props.title,open:this.props.expanded===!0,onToggle:n=>{var r;this.props.onToggle&&((r=this.props)==null||r.onToggle(n))},children:t})}}const Fi=class Fi extends Tn.Component{constructor(t){super(t);Xe(this,"addGroup",t=>{const n=JSON.parse(t.value),r=[];n.items.forEach(i=>{r.push({type:i.type,prop:i.prop,title:i.title!==void 0?i.title:i.prop,value:i.value,min:i.min,max:i.max,step:i.step,options:i.options,disabled:i.disabled,onChange:(a,c)=>{this.props.three.updateGroup(n.title,a,c)}})}),Fi.groups.push(Ke.jsx(cd,{three:this.props.three,title:n.title,items:r},Math.random())),Fi.groupTitles.push(n.title),this.setState({lastUpdate:Date.now()})});Xe(this,"removeGroup",t=>{const n=t.value,r=Fi.groupTitles.length;for(let i=0;i<r;i++)if(n===Fi.groupTitles[i]){Fi.groups.splice(i,1),Fi.groupTitles.splice(i,1),this.setState({lastUpdate:Date.now()});return}});this.state={lastUpdate:Date.now()},Fi.instance=this,Fi.three=t.three,t.three.addEventListener(li.ADD_GROUP,this.addGroup),t.three.addEventListener(li.REMOVE_GROUP,this.removeGroup)}componentWillUnmount(){this.props.three.removeEventListener(li.ADD_GROUP,this.addGroup),this.props.three.removeEventListener(li.REMOVE_GROUP,this.removeGroup)}render(){return Ke.jsx("div",{className:"customGroups",children:Fi.groups},this.state.lastUpdate)}static addEditorGroup(t){const n=Fi.groupTitles.length;for(let c=0;c<n;c++)if(Fi.groupTitles[c]===t.title)return Fi.groupsRefs[c];const r=[];t.items.forEach(c=>{r.push({type:c.type,prop:c.prop,title:c.title!==void 0?c.title:c.prop,value:c.value,min:c.min,max:c.max,step:c.step,options:c.options,disabled:c.disabled,onChange:(u,p)=>{t.onUpdate(u,p)}})}),t.subgroups&&t.subgroups.length>0&&t.subgroups.forEach(c=>{const u=[];c.items.forEach(p=>{u.push({type:p.type,prop:p.prop,title:p.title!==void 0?p.title:p.prop,value:p.value,min:p.min,max:p.max,step:p.step,options:p.options,disabled:p.disabled,onChange:(y,x)=>{c.onUpdate(y,x)}})}),r.push({three:Fi.three,title:c.title,expanded:c.expanded,items:u})});const i=Tn.createRef(),a=Ke.jsx(cd,{three:Fi.three,ref:i,title:t.title,expanded:t.expanded,items:r},Math.random());return Fi.groups.push(a),Fi.groupsRefs.push(i),Fi.groupTitles.push(t.title),setTimeout(()=>{Fi.instance.setState({lastUpdate:Date.now()})},0),i}static removeEditorGroup(t){const n=Fi.groupTitles.length;for(let r=0;r<n;r++)if(t===Fi.groupTitles[r]){Fi.groups.splice(r,1),Fi.groupTitles.splice(r,1),Fi.instance.setState({lastUpdate:Date.now()});return}}static removeAllGroups(){for(let t=Fi.groupTitles.length;t>0;t--)Fi.groups.splice(t,1),Fi.groupTitles.splice(t,1);Fi.instance.setState({lastUpdate:Date.now()})}};Xe(Fi,"instance"),Xe(Fi,"groups",[]),Xe(Fi,"groupsRefs",[]),Xe(Fi,"groupTitles",[]),Xe(Fi,"three");let j3=Fi;const zk=class zk extends Tn.Component{constructor(t){super(t);Xe(this,"matrix",new or);Xe(this,"position",new Ae);Xe(this,"rotation",new ua);Xe(this,"scale",new Ae);Xe(this,"open",!1);Xe(this,"updateTransform",(t,n)=>{const r=t==="rotation"?{x:n._x,y:n._y,z:n._z}:n;this.props.three.updateObject(this.props.object.uuid,t,r);const i=this.props.three.getScene(this.props.object.uuid);if(i){const a=i.getObjectByProperty("uuid",this.props.object.uuid);Ko(a,t,r)}});const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;this.open=r,this.saveExpanded(),this.state={lastUpdated:0,expanded:r},this.matrix.elements=t.object.matrix,t.object.uuid.length>0&&(this.position.setFromMatrixPosition(this.matrix),this.rotation.setFromRotationMatrix(this.matrix),this.scale.setFromMatrixScale(this.matrix)),zk.instance=this}update(){if(da.instance){const t=da.instance.selectedItem;if(t===void 0)return;this.position.x=Rf(t.position.x,3),this.position.y=Rf(t.position.y,3),this.position.z=Rf(t.position.z,3),this.rotation.copy(t.rotation),this.scale.x=Rf(t.scale.x,3),this.scale.y=Rf(t.scale.y,3),this.scale.z=Rf(t.scale.z,3),this.setState({lastUpdated:Date.now()})}}render(){return Ke.jsx(cd,{three:this.props.three,title:"Transform",expanded:this.open,items:[{title:"Position",prop:"position",type:"grid3",step:.1,value:this.position,onChange:this.updateTransform},{title:"Rotation",prop:"rotation",type:"euler",value:this.rotation,onChange:this.updateTransform},{title:"Scale",prop:"scale",type:"grid3",value:this.scale,onChange:this.updateTransform},{title:"Visible",prop:"visible",type:"boolean",value:this.props.object.visible,onChange:this.updateTransform}],onToggle:t=>{this.open=t,this.saveExpanded()}},this.state.lastUpdated)}saveExpanded(){localStorage.setItem(this.expandedName,this.open?"open":"closed")}get expandedName(){return`${this.props.three.name}_transform`}};Xe(zk,"instance");let Uk=zk;function yj(s){const[e,t]=Tn.useState(s.selected),n="toggle"+(e?" selected":"");return Ke.jsx("button",{className:n,onClick:()=>{const r=!e;t(r),s.onClick(r)},style:{backgroundImage:`url(${s.icon})`,backgroundPositionX:"center",backgroundPositionY:s.top!==void 0?`${s.top}px`:"center",backgroundSize:`${s.width!==void 0?`${s.width}px`:"26px"} ${s.height}px`}},s.name)}const DYe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {
  #include <uv_vertex>
  #include <color_vertex>
  #include <morphcolor_vertex>
  #include <batching_vertex>

  #if defined ( USE_SKINNING )
    #include <beginnormal_vertex>
    #include <morphnormal_vertex>
    #include <skinbase_vertex>
    #include <skinnormal_vertex>
    #include <defaultnormal_vertex>
  #endif

  #include <begin_vertex>
  #include <morphtarget_vertex>
  #include <skinning_vertex>
  #include <project_vertex>
  #include <logdepthbuf_vertex>
  #include <clipping_planes_vertex>
  #include <worldpos_vertex>
}`,OYe=`
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
  #include <clipping_planes_fragment>
  if (opacity < 0.015) discard;
  gl_FragColor = vec4(vec3(vUv, 0.0), opacity);
}`;class LYe extends r0{constructor(){super({defines:{USE_UV:""},uniforms:{opacity:{value:1}},vertexShader:DYe,fragmentShader:OYe,transparent:!0})}}const tv=new ME,fl=new Ae,A3=new Ae,so=new ls,f8e={X:new Ae(1,0,0),Y:new Ae(0,1,0),Z:new Ae(0,0,1)},xj={type:"change"},p8e={type:"mouseDown",mode:null},m8e={type:"mouseUp",mode:null},g8e={type:"objectChange"};class FYe extends Ove{constructor(e,t=null){super(void 0,t);const n=new jYe(this);this._root=n;const r=new HYe;this._gizmo=r,n.add(r);const i=new WYe;this._plane=i,n.add(i);const a=this;function c(X,P){let te=P;Object.defineProperty(a,X,{get:function(){return te!==void 0?te:P},set:function(oe){te!==oe&&(te=oe,i[X]=oe,r[X]=oe,a.dispatchEvent({type:X+"-changed",value:oe}),a.dispatchEvent(xj))}}),a[X]=P,i[X]=P,r[X]=P}c("camera",e),c("object",void 0),c("enabled",!0),c("axis",null),c("mode","translate"),c("translationSnap",null),c("rotationSnap",null),c("scaleSnap",null),c("space","world"),c("size",1),c("dragging",!1),c("showX",!0),c("showY",!0),c("showZ",!0),c("minX",-1/0),c("maxX",1/0),c("minY",-1/0),c("maxY",1/0),c("minZ",-1/0),c("maxZ",1/0);const u=new Ae,p=new Ae,y=new ls,x=new ls,S=new Ae,M=new ls,I=new Ae,L=new Ae,B=new Ae,A=0,V=new Ae;c("worldPosition",u),c("worldPositionStart",p),c("worldQuaternion",y),c("worldQuaternionStart",x),c("cameraPosition",S),c("cameraQuaternion",M),c("pointStart",I),c("pointEnd",L),c("rotationAxis",B),c("rotationAngle",A),c("eye",V),this._offset=new Ae,this._startNorm=new Ae,this._endNorm=new Ae,this._cameraScale=new Ae,this._parentPosition=new Ae,this._parentQuaternion=new ls,this._parentQuaternionInv=new ls,this._parentScale=new Ae,this._worldScaleStart=new Ae,this._worldQuaternionInv=new ls,this._worldScale=new Ae,this._positionStart=new Ae,this._quaternionStart=new ls,this._scaleStart=new Ae,this._getPointer=BYe.bind(this),this._onPointerDown=zYe.bind(this),this._onPointerHover=UYe.bind(this),this._onPointerMove=VYe.bind(this),this._onPointerUp=GYe.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;e!==null&&tv.setFromCamera(e,this.camera);const t=_j(this._gizmo.picker[this.mode],tv);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e!=null&&e.button!==0)&&this.axis!==null){e!==null&&tv.setFromCamera(e,this.camera);const t=_j(this._plane,tv,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,p8e.mode=this.mode,this.dispatchEvent(p8e)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let i=this.space;if(n==="scale"?i="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(i="world"),r===void 0||t===null||this.dragging===!1||e!==null&&e.button!==-1)return;e!==null&&tv.setFromCamera(e,this.camera);const a=_j(this._plane,tv,!0);if(a){if(this.pointEnd.copy(a.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),i==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),i==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(i==="local"&&(r.position.applyQuaternion(so.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),i==="world"&&(r.parent&&r.position.add(fl.setFromMatrixPosition(r.parent.matrixWorld)),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(fl.setFromMatrixPosition(r.parent.matrixWorld)))),r.position.x=Math.max(this.minX,Math.min(this.maxX,r.position.x)),r.position.y=Math.max(this.minY,Math.min(this.maxY,r.position.y)),r.position.z=Math.max(this.minZ,Math.min(this.maxZ,r.position.z));else if(n==="scale"){if(t.search("XYZ")!==-1){let c=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(c*=-1),A3.set(c,c,c)}else fl.copy(this.pointStart),A3.copy(this.pointEnd),fl.applyQuaternion(this._worldQuaternionInv),A3.applyQuaternion(this._worldQuaternionInv),A3.divide(fl),t.search("X")===-1&&(A3.x=1),t.search("Y")===-1&&(A3.y=1),t.search("Z")===-1&&(A3.z=1);r.scale.copy(this._scaleStart).multiply(A3),this.scaleSnap&&(t.search("X")!==-1&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const c=20/this.worldPosition.distanceTo(fl.setFromMatrixPosition(this.camera.matrixWorld));let u=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(fl.copy(this.rotationAxis).cross(this.eye))*c):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(f8e[t]),fl.copy(f8e[t]),i==="local"&&fl.applyQuaternion(this.worldQuaternion),fl.cross(this.eye),fl.length()===0?u=!0:this.rotationAngle=this._offset.dot(fl.normalize())*c),(t==="E"||u)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),i==="local"&&t!=="E"&&t!=="XYZE"?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(so.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(so.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(xj),this.dispatchEvent(g8e)}}pointerUp(e){e!==null&&e.button!==0||(this.dragging&&this.axis!==null&&(m8e.mode=this.mode,this.dispatchEvent(m8e)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this._root.dispose()}attach(e){return this.object=e,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(xj),this.dispatchEvent(g8e),this.pointStart.copy(this.pointEnd))}getRaycaster(){return tv}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function BYe(s){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:s.button};{const e=this.domElement.getBoundingClientRect();return{x:(s.clientX-e.left)/e.width*2-1,y:-(s.clientY-e.top)/e.height*2+1,button:s.button}}}function UYe(s){if(this.enabled)switch(s.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(s));break}}function zYe(s){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(s.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(s)),this.pointerDown(this._getPointer(s)))}function VYe(s){this.enabled&&this.pointerMove(this._getPointer(s))}function GYe(s){this.enabled&&(this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(s)))}function _j(s,e,t){const n=e.intersectObject(s,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const LI=new ua,Ps=new Ae(0,1,0),v8e=new Ae(0,0,0),y8e=new or,FI=new ls,ok=new ls,f1=new Ae,x8e=new or,tE=new Ae(1,0,0),lv=new Ae(0,1,0),nE=new Ae(0,0,1),BI=new Ae,Uw=new Ae,zw=new Ae;class jYe extends Ti{constructor(e){super(),this.isTransformControlsRoot=!0,this.controls=e,this.visible=!1}updateMatrixWorld(e){const t=this.controls;t.object!==void 0&&(t.object.updateMatrixWorld(),t.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):t.object.parent.matrixWorld.decompose(t._parentPosition,t._parentQuaternion,t._parentScale),t.object.matrixWorld.decompose(t.worldPosition,t.worldQuaternion,t._worldScale),t._parentQuaternionInv.copy(t._parentQuaternion).invert(),t._worldQuaternionInv.copy(t.worldQuaternion).invert()),t.camera.updateMatrixWorld(),t.camera.matrixWorld.decompose(t.cameraPosition,t.cameraQuaternion,t._cameraScale),t.camera.isOrthographicCamera?t.camera.getWorldDirection(t.eye).negate():t.eye.copy(t.cameraPosition).sub(t.worldPosition).normalize(),super.updateMatrixWorld(e)}dispose(){this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}}class HYe extends Ti{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new eh({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Ff({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const i=e.clone();i.color.setHex(16711680);const a=e.clone();a.color.setHex(65280);const c=e.clone();c.color.setHex(255);const u=e.clone();u.color.setHex(16711680),u.opacity=.5;const p=e.clone();p.color.setHex(65280),p.opacity=.5;const y=e.clone();y.color.setHex(255),y.opacity=.5;const x=e.clone();x.opacity=.25;const S=e.clone();S.color.setHex(16776960),S.opacity=.25,e.clone().color.setHex(16776960);const I=e.clone();I.color.setHex(7895160);const L=new qc(0,.04,.1,12);L.translate(0,.05,0);const B=new Ta(.08,.08,.08);B.translate(0,.04,0);const A=new rs;A.setAttribute("position",new Er([0,0,0,1,0,0],3));const V=new qc(.0075,.0075,.5,3);V.translate(0,.25,0);function X(st,de){const ft=new cv(st,.0075,3,64,de*Math.PI*2);return ft.rotateY(Math.PI/2),ft.rotateX(Math.PI/2),ft}function P(){const st=new rs;return st.setAttribute("position",new Er([0,0,0,1,1,1],3)),st}const te={X:[[new mn(L,i),[.5,0,0],[0,0,-Math.PI/2]],[new mn(L,i),[-.5,0,0],[0,0,Math.PI/2]],[new mn(V,i),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new mn(L,a),[0,.5,0]],[new mn(L,a),[0,-.5,0],[Math.PI,0,0]],[new mn(V,a)]],Z:[[new mn(L,c),[0,0,.5],[Math.PI/2,0,0]],[new mn(L,c),[0,0,-.5],[-Math.PI/2,0,0]],[new mn(V,c),null,[Math.PI/2,0,0]]],XYZ:[[new mn(new vv(.1,0),x.clone()),[0,0,0]]],XY:[[new mn(new Ta(.15,.15,.01),y.clone()),[.15,.15,0]]],YZ:[[new mn(new Ta(.15,.15,.01),u.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new mn(new Ta(.15,.15,.01),p.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},oe={X:[[new mn(new qc(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new mn(new qc(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new mn(new qc(.2,0,.6,4),n),[0,.3,0]],[new mn(new qc(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new mn(new qc(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new mn(new qc(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new mn(new vv(.2,0),n)]],XY:[[new mn(new Ta(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new mn(new Ta(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new mn(new Ta(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},ie={START:[[new mn(new vv(.01,2),r),null,null,null,"helper"]],END:[[new mn(new vv(.01,2),r),null,null,null,"helper"]],DELTA:[[new Kc(P(),r),null,null,null,"helper"]],X:[[new Kc(A,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Kc(A,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Kc(A,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},K={XYZE:[[new mn(X(.5,1),I),null,[0,Math.PI/2,0]]],X:[[new mn(X(.5,.5),i)]],Y:[[new mn(X(.5,.5),a),null,[0,0,-Math.PI/2]]],Z:[[new mn(X(.5,.5),c),null,[0,Math.PI/2,0]]],E:[[new mn(X(.75,1),S),null,[0,Math.PI/2,0]]]},re={AXIS:[[new Kc(A,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},se={XYZE:[[new mn(new Tv(.25,10,8),n)]],X:[[new mn(new cv(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new mn(new cv(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new mn(new cv(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new mn(new cv(.75,.1,2,24),n)]]},q={X:[[new mn(B,i),[.5,0,0],[0,0,-Math.PI/2]],[new mn(V,i),[0,0,0],[0,0,-Math.PI/2]],[new mn(B,i),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new mn(B,a),[0,.5,0]],[new mn(V,a)],[new mn(B,a),[0,-.5,0],[0,0,Math.PI]]],Z:[[new mn(B,c),[0,0,.5],[Math.PI/2,0,0]],[new mn(V,c),[0,0,0],[Math.PI/2,0,0]],[new mn(B,c),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new mn(new Ta(.15,.15,.01),y),[.15,.15,0]]],YZ:[[new mn(new Ta(.15,.15,.01),u),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new mn(new Ta(.15,.15,.01),p),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new mn(new Ta(.1,.1,.1),x.clone())]]},De={X:[[new mn(new qc(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new mn(new qc(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new mn(new qc(.2,0,.6,4),n),[0,.3,0]],[new mn(new qc(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new mn(new qc(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new mn(new qc(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new mn(new Ta(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new mn(new Ta(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new mn(new Ta(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new mn(new Ta(.2,.2,.2),n),[0,0,0]]]},Be={X:[[new Kc(A,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Kc(A,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Kc(A,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function tt(st){const de=new Ti;for(const ft in st)for(let Se=st[ft].length;Se--;){const rt=st[ft][Se][0].clone(),ut=st[ft][Se][1],Pe=st[ft][Se][2],vt=st[ft][Se][3],Bt=st[ft][Se][4];rt.name=ft,rt.tag=Bt,ut&&rt.position.set(ut[0],ut[1],ut[2]),Pe&&rt.rotation.set(Pe[0],Pe[1],Pe[2]),vt&&rt.scale.set(vt[0],vt[1],vt[2]),rt.updateMatrix();const ct=rt.geometry.clone();ct.applyMatrix4(rt.matrix),rt.geometry=ct,rt.renderOrder=1/0,rt.position.set(0,0,0),rt.rotation.set(0,0,0),rt.scale.set(1,1,1),de.add(rt)}return de}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=tt(te)),this.add(this.gizmo.rotate=tt(K)),this.add(this.gizmo.scale=tt(q)),this.add(this.picker.translate=tt(oe)),this.add(this.picker.rotate=tt(se)),this.add(this.picker.scale=tt(De)),this.add(this.helper.translate=tt(ie)),this.add(this.helper.rotate=tt(re)),this.add(this.helper.scale=tt(Be)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:ok;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let i=0;i<r.length;i++){const a=r[i];a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition);let c;if(this.camera.isOrthographicCamera?c=(this.camera.top-this.camera.bottom)/this.camera.zoom:c=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(c*this.size/4),a.tag==="helper"){a.visible=!1,a.name==="AXIS"?(a.visible=!!this.axis,this.axis==="X"&&(so.setFromEuler(LI.set(0,0,0)),a.quaternion.copy(n).multiply(so),Math.abs(Ps.copy(tE).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Y"&&(so.setFromEuler(LI.set(0,0,Math.PI/2)),a.quaternion.copy(n).multiply(so),Math.abs(Ps.copy(lv).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Z"&&(so.setFromEuler(LI.set(0,Math.PI/2,0)),a.quaternion.copy(n).multiply(so),Math.abs(Ps.copy(nE).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="XYZE"&&(so.setFromEuler(LI.set(0,Math.PI/2,0)),Ps.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(y8e.lookAt(v8e,Ps,lv)),a.quaternion.multiply(so),a.visible=this.dragging),this.axis==="E"&&(a.visible=!1)):a.name==="START"?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):a.name==="END"?(a.position.copy(this.worldPosition),a.visible=this.dragging):a.name==="DELTA"?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),fl.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),fl.applyQuaternion(this.worldQuaternionStart.clone().invert()),a.scale.copy(fl),a.visible=this.dragging):(a.quaternion.copy(n),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=this.axis.search(a.name)!==-1));continue}a.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(a.name==="X"&&Math.abs(Ps.copy(tE).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Y"&&Math.abs(Ps.copy(lv).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Z"&&Math.abs(Ps.copy(nE).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XY"&&Math.abs(Ps.copy(nE).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="YZ"&&Math.abs(Ps.copy(tE).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XZ"&&Math.abs(Ps.copy(lv).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1)):this.mode==="rotate"&&(FI.copy(n),Ps.copy(this.eye).applyQuaternion(so.copy(n).invert()),a.name.search("E")!==-1&&a.quaternion.setFromRotationMatrix(y8e.lookAt(this.eye,v8e,lv)),a.name==="X"&&(so.setFromAxisAngle(tE,Math.atan2(-Ps.y,Ps.z)),so.multiplyQuaternions(FI,so),a.quaternion.copy(so)),a.name==="Y"&&(so.setFromAxisAngle(lv,Math.atan2(Ps.x,Ps.z)),so.multiplyQuaternions(FI,so),a.quaternion.copy(so)),a.name==="Z"&&(so.setFromAxisAngle(nE,Math.atan2(Ps.y,Ps.x)),so.multiplyQuaternions(FI,so),a.quaternion.copy(so))),a.visible=a.visible&&(a.name.indexOf("X")===-1||this.showX),a.visible=a.visible&&(a.name.indexOf("Y")===-1||this.showY),a.visible=a.visible&&(a.name.indexOf("Z")===-1||this.showZ),a.visible=a.visible&&(a.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),a.material._color=a.material._color||a.material.color.clone(),a.material._opacity=a.material._opacity||a.material.opacity,a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled&&this.axis&&(a.name===this.axis||this.axis.split("").some(function(u){return a.name===u}))&&(a.material.color.setHex(16776960),a.material.opacity=1)}super.updateMatrixWorld(e)}}class WYe extends mn{constructor(){super(new Ev(1e5,1e5,2,2),new eh({visible:!1,wireframe:!0,side:gl,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),BI.copy(tE).applyQuaternion(t==="local"?this.worldQuaternion:ok),Uw.copy(lv).applyQuaternion(t==="local"?this.worldQuaternion:ok),zw.copy(nE).applyQuaternion(t==="local"?this.worldQuaternion:ok),Ps.copy(Uw),this.mode){case"translate":case"scale":switch(this.axis){case"X":Ps.copy(this.eye).cross(BI),f1.copy(BI).cross(Ps);break;case"Y":Ps.copy(this.eye).cross(Uw),f1.copy(Uw).cross(Ps);break;case"Z":Ps.copy(this.eye).cross(zw),f1.copy(zw).cross(Ps);break;case"XY":f1.copy(zw);break;case"YZ":f1.copy(BI);break;case"XZ":Ps.copy(zw),f1.copy(Uw);break;case"XYZ":case"E":f1.set(0,0,0);break}break;case"rotate":default:f1.set(0,0,0)}f1.length()===0?this.quaternion.copy(this.cameraQuaternion):(x8e.lookAt(fl.set(0,0,0),f1,Ps),this.quaternion.setFromRotationMatrix(x8e)),super.updateMatrixWorld(e)}}const Af=class Af extends nh{constructor(){super(...arguments);Xe(this,"three");Xe(this,"activeCamera");Xe(this,"controls",new Map);Xe(this,"visibility",new Map);Xe(this,"setScene",()=>{this.clear()})}setApp(t){this.three=t,this.three.addEventListener(li.SET_SCENE,this.setScene)}clear(){for(const t of this.controls.values()){t.detach(),t.disconnect();const n=t.getHelper();od(n)}this.controls=new Map,this.visibility=new Map}add(t){let n=this.controls.get(t);if(n===void 0){const r=document.querySelector(".clickable");n=new FYe(this.activeCamera,r),n.getHelper().name=t,n.setSize(.5),n.setSpace("local"),this.controls.set(t,n),this.visibility.set(t,!0),n.addEventListener("mouseDown",()=>{this.dispatchEvent({type:Af.DRAG_START})}),n.addEventListener("mouseUp",()=>{this.dispatchEvent({type:Af.DRAG_END})}),n.addEventListener("dragging-changed",i=>{var a;(a=da.instance)==null||a.toggleOrbitControls(i.value)})}return n}get(t){return this.controls.get(t)}remove(t){const n=this.get(t);return n===void 0?!1:(n.detach(),n.disconnect(),od(n.getHelper()),this.controls.delete(t),!0)}enabled(t){this.controls.forEach(n=>{n.enabled=t})}updateCamera(t,n){this.activeCamera=t,this.controls.forEach(r=>{r.camera!==t&&(r.camera=t,t.getWorldPosition(r.cameraPosition),t.getWorldQuaternion(r.cameraQuaternion)),r.domElement!==n&&(r.disconnect(),r.domElement=n,r.connect(n))})}show(){this.controls.forEach(t=>{const n=t.getHelper(),r=this.visibility.get(n.name);r!==void 0&&(n.visible=r)})}hide(){this.controls.forEach(t=>{const n=t.getHelper();this.visibility.set(n.name,n.visible),n.visible=!1})}static get instance(){return Af._instance||(Af._instance=new Af),Af._instance}};Xe(Af,"DRAG_START","Transform::dragStart"),Xe(Af,"DRAG_END","Transform::dragEnd"),Xe(Af,"_instance");let Xu=Af;const $Ye=new Ta,bj=new An;class Sj extends Ti{constructor(t,n){const r=new Pn(V3(.5,1,Math.random()),V3(.5,1,Math.random()),V3(.5,1,Math.random()));super();Xe(this,"curve",new Q9e);Xe(this,"line");Xe(this,"draggable");Xe(this,"curvePos");Xe(this,"tension",.5);Xe(this,"closed",!1);Xe(this,"subdivide",50);Xe(this,"curveType");Xe(this,"offset",1);Xe(this,"lineMaterial");Xe(this,"_camera");Xe(this,"_curvePercentage",0);Xe(this,"_draggableScale",10);Xe(this,"_transform");Xe(this,"raycaster");Xe(this,"draggedMat",new eh);Xe(this,"parentGroup");Xe(this,"group");Xe(this,"dispose",()=>{this._transform&&(this._transform.removeEventListener("objectChange",this.updateSpline),Xu.instance.remove(this.name)),this.disable(),this.parentGroup.removeGroup(this.name)});Xe(this,"hideTransform",()=>{var t;(t=this._transform)==null||t.detach()});Xe(this,"exportSpline",()=>{const t=[];this.draggable.children.forEach(n=>{t.push([Rf(n.position.x,3),Rf(n.position.y,3),Rf(n.position.z,3)])}),AFe({name:this.name,points:t,tension:this.tension,closed:this.closed,subdivide:this.subdivide,type:this.curveType}),console.log("Spline copied!")});Xe(this,"showPoints",(t=!0)=>{this.draggable.visible=t});Xe(this,"addPoints",(t=[])=>{if(t.length>0){const n=t.length-1;for(let r=0;r<n;r++)this.addPoint(t[r],!1);this.addPoint(t[n])}});Xe(this,"addPoint",(t,n=!0)=>{var c;const r=this.draggable.children.length,i=new mn($Ye,this.draggedMat);i.name=`point_${r}`,i.position.copy(t),i.scale.setScalar(this._draggableScale),this.draggable.add(i),(c=this._transform)==null||c.attach(i);const a=this.points.length>1;return a&&n&&this.updateSpline(),this.line.visible=a,this.updateCurrentPoint(),i});Xe(this,"addNextPt",()=>{const t=this.draggable.children.length,n=t>1?this.draggable.children[t-1].position.clone():new Ae,r=this.addPoint(n);this.updateField(r.position)});Xe(this,"removePoint",t=>{var n,r,i;if(((n=this._transform)==null?void 0:n.object)===t){(r=this._transform)==null||r.detach();const a=this.draggable.children[this.draggable.children.length-1];(i=this._transform)==null||i.attach(a),this.updateField(a.position)}od(t),this.updateSpline()});Xe(this,"removePointAt",t=>{const n=this.draggable.children[t];this.removePoint(n)});Xe(this,"removeSelectedPt",()=>{var t,n;((t=this._transform)==null?void 0:t.object)!==void 0&&this.removePoint((n=this._transform)==null?void 0:n.object)});Xe(this,"updateSpline",()=>{this.points.length<2||(this.curve=new Q9e(this.points,this.closed,this.curveType,this.tension),this.line.geometry.dispose(),this.line.geometry=new rs().setFromPoints(this.curve.getPoints(this.subdivide)),this.curvePos.position.copy(this.getPointAt(this._curvePercentage)))});Xe(this,"onMouseClick",t=>{var a,c;if(!da.instance||!da.instance.currentWindow||this._transform&&!this._transform.getHelper().visible)return;const r=da.instance.currentWindow.current.getBoundingClientRect();bj.x=(t.clientX-r.x)/r.width*2-1,bj.y=-((t.clientY-r.y)/r.height)*2+1,this.raycaster.setFromCamera(bj,this.camera);const i=this.raycaster.intersectObjects(this.draggable.children,!1);if(i.length>0){const u=i[0].object;u!==((a=this._transform)==null?void 0:a.object)&&((c=this._transform)==null||c.attach(u),this.updateField(u.position))}});Xe(this,"onUpdateTransform",()=>{this.updateCurrentPoint(),this.updateSpline()});Xe(this,"debugPoint",t=>{t.name,t.visible=this.draggable.visible});this.name=t,this.lineMaterial=new Ff({color:r}),this.line=new Kc(new rs,this.lineMaterial),this.line.name="line",this.line.visible=!1,this.add(this.line),this._camera=n,this.curveType="catmullrom",this.draggedMat.color=r,this.draggable=new Ti,this.draggable.name="draggablePoints",this.add(this.draggable),this.curvePos=new mn(new Tv(1.5),new eh({color:r})),this.curvePos.name="curvePos",this.curvePos.scale.setScalar(this._draggableScale),this.curvePos.visible=!1,this.add(this.curvePos),this.raycaster=new ME,this.raycaster.params.Line.threshold=3,this.enable()}enable(){document.addEventListener("pointerdown",this.onMouseClick)}disable(){document.removeEventListener("pointerdown",this.onMouseClick)}updateLastPoint(t){const n=this.draggable.children.length;n>0&&(this.draggable.children[n-1].position.copy(t),this.updateSpline())}updateField(t){var n;(n=this.group.current)==null||n.setField("Current Point",t)}getPointAt(t){return this.curve.points.length>1?this.curve.getPointAt(t):this.curve.points.length===1?this.curve.points[0]:new Ae}getTangentAt(t){return this.curve.getTangentAt(t)}get points(){const t=[];return this.draggable.children.forEach(n=>{t.push(n.position)}),t}get total(){return this.draggable.children.length}get draggableScale(){return this._draggableScale}set draggableScale(t){this._draggableScale=t,this.draggable.children.forEach(n=>n.scale.setScalar(t)),this.curvePos.scale.setScalar(t)}get camera(){return this._camera}set camera(t){this._camera=t,this._transform!==void 0&&(this._transform.camera=t)}get curvePercentage(){return this._curvePercentage}set curvePercentage(t){this._curvePercentage=t,this.curvePos.position.copy(this.getPointAt(t))}updateCurrentPoint(){var t,n;if((t=this._transform)!=null&&t.object&&this.group){const r=(n=this._transform)==null?void 0:n.object;r.name.search("point")>-1&&this.updateField(r.position)}}initDebug(t,n){var a;const r=this.draggable.children;this.visible=n,this.parentGroup=t,this._transform=Xu.instance.add(this.name),this._transform.camera=this._camera,this._transform.addEventListener("objectChange",this.onUpdateTransform),r.length>0&&this._transform.attach(r[r.length-1]),(a=da.instance)==null||a.helpersContainer.add(this._transform.getHelper());const i=r.length>0?r[r.length-1].position:{x:0,y:0,z:0};this.group=t.addGroup({title:this.name,expanded:n,items:[{prop:"Closed",type:"boolean",value:this.closed},{prop:"Visible",type:"boolean",value:this.visible},{prop:"Show Position",type:"boolean",value:this.curvePos.visible},{prop:"Show Points",type:"boolean",value:this.draggable.visible},{prop:"Color",type:"color",value:`#${this.draggedMat.color.getHexString()}`},{prop:"Curve",type:"option",options:[{title:"Catmullrom",value:"catmullrom"},{title:"Centripetal",value:"centripetal"},{title:"Chordal",value:"chordal"}]},{prop:"Draggable Scale",type:"range",min:.01,max:100,step:.01,value:this._draggableScale},{prop:"Subdivide",type:"range",min:1,max:1e3,step:1,value:this.subdivide},{prop:"Tension",type:"range",min:0,max:1,step:.01,value:this.tension},{prop:"New Pt Offset",type:"range",min:0,max:10,value:this.offset},{prop:"Curve At",type:"range",min:0,max:1,step:.01,value:0},{prop:"Toggle Transform",type:"button"},{prop:"Add Point",type:"button"},{prop:"Remove Point",type:"button"},{prop:"Export",type:"button"},{prop:"Delete",type:"button"},{prop:"Current Point",type:"grid3",value:i}],onUpdate:(c,u)=>{var p,y;switch(c){case"Closed":this.closed=u,this.updateSpline();break;case"Visible":this.visible=u;break;case"Color":this.lineMaterial.color.setStyle(u),this.draggedMat.color.setStyle(u);break;case"Curve":this.curveType=u,this.updateSpline();break;case"Draggable Scale":this.draggableScale=u;break;case"Subdivide":this.subdivide=u,this.updateSpline();break;case"Tension":this.tension=u,this.updateSpline();break;case"New Pt Offset":this.offset=u;break;case"Curve At":this.curvePos.position.copy(this.getPointAt(u));break;case"Show Position":this.curvePos.visible=u;break;case"Show Points":this.draggable.visible=u;break;case"Toggle Transform":this._transform&&(this._transform.getHelper().visible=!this._transform.getHelper().visible);break;case"Add Point":this.addNextPt();break;case"Remove Point":this.removeSelectedPt();break;case"Export":this.exportSpline();break;case"Delete":this.parent.currentSpline=null,od(this);break;case"Current Point":if(this.group.current&&((p=this._transform)!=null&&p.object)){const x=(y=this._transform)==null?void 0:y.object;x.name.search("point")>-1&&(x.position.copy(u),this.updateSpline())}break}}}),this.draggable.children.forEach(c=>{this.debugPoint(c)})}}let UI=0;class qYe extends Ti{constructor(t,n){super();Xe(this,"defaultScale",10);Xe(this,"currentSpline",null);Xe(this,"_camera");Xe(this,"group",null);Xe(this,"three");Xe(this,"splineDataText","");Xe(this,"createSpline",(t=[])=>{const n=`Spline ${UI+1}`,r=new Sj(n,this._camera);return r.addPoints(t),this.addSpline(r,!0),UI++,r});Xe(this,"createSplineFromArray",t=>{const n=[];return t.forEach(r=>{n.push(new Ae(r[0],r[1],r[2]))}),this.createSpline(n)});Xe(this,"createSplineFromCatmullRom",t=>this.createSpline(t.points));Xe(this,"createSplineFromJSON",t=>{const n=[];t.points.forEach(i=>{n.push(new Ae(i[0],i[1],i[2]))});const r=new Sj(t.name,this._camera);return r.closed=t.closed,r.subdivide=t.subdivide,r.tension=t.tension,r.type=t.type,r.addPoints(n),r.updateSpline(),this.addSpline(r,!1),r});Xe(this,"showPoints",(t=!0)=>{this.children.forEach(n=>{n.showPoints(t)})});Xe(this,"onAddSpline",t=>{const n=JSON.parse(t.value),r=n.name!==void 0?n.name:`Spline ${UI+1}`,i=new Sj(r,this.camera);n.tension!==void 0&&(i.tension=n.tension),n.closed!==void 0&&(i.closed=n.closed),n.subdivide!==void 0&&(i.subdivide=n.subdivide),n.type!==void 0&&(i.curveType=n.type);const a=[];n.points.forEach(c=>{a.push(new Ae(c[0],c[1],c[2]))}),i.addPoints(a),this.addSpline(i,!1),UI++});Xe(this,"isMouseDown",!1);Xe(this,"onClickCanvas",t=>{var u;if(t.button!==0)return;if(this._camera.type!=="OrthographicCamera"){console.warn("Spline Editor - 3D Camera not supported in Draw Mode");return}const r=t.target.getBoundingClientRect(),i=(t.clientX-r.left)/r.width*2-1,a=-((t.clientY-r.top)/r.height)*2+1;if(da.instance){const p=new ME;p.setFromCamera(new An(i,a),this._camera);const y=p.intersectObjects(da.instance.helpersContainer.children,!0);for(let x=0;x<y.length;x++){const S=y[x];if(!(S.object.isLine||S.object.isTransformControlsPlane)&&S.object.isObject3D)return}}this.currentSpline===null&&(this.currentSpline=this.createSpline());const c=this.mouseToSplinePos(i,a,r.width,r.height);(u=this.currentSpline)==null||u.addPoint(c),this.isMouseDown=!0});Xe(this,"onMouseMove",t=>{var u,p;if(!this.isMouseDown)return;const r=t.target.getBoundingClientRect(),i=(t.clientX-r.left)/r.width*2-1,a=-((t.clientY-r.top)/r.height)*2+1,c=this.mouseToSplinePos(i,a,r.width,r.height);(u=this.currentSpline)==null||u.updateLastPoint(c),(p=this.currentSpline)==null||p.updateField(c)});Xe(this,"onMouseUp",()=>{this.isMouseDown=!1});this.name="Spline Editor",this._camera=t,this.three=n,this.three.addEventListener(li.ADD_SPLINE,this.onAddSpline)}initDebug(){this.group=j3.addEditorGroup({title:this.name,items:[{type:"field",prop:"Spline Data",value:"",disabled:!1},{type:"button",prop:"Import Spline"},{type:"button",prop:"New Spline"},{type:"boolean",prop:"Show Points",value:!0},{type:"boolean",prop:"Draw Mode",value:!1},{type:"boolean",prop:"Visible",value:this.visible},{type:"range",prop:"Default Scale",min:0,max:50,step:.01,value:this.defaultScale}],onUpdate:(t,n)=>{switch(t){case"New Spline":this.createSpline();break;case"Spline Data":this.splineDataText=n;break;case"Import Spline":this.createSplineFromJSON(JSON.parse(this.splineDataText));break;case"Show Points":this.showPoints(n);break;case"Visible":this.visible=n;break;case"Default Scale":this.defaultScale=n;break;case"Draw Mode":n?this.enableClickToDraw():this.disableClickToDraw();break}}})}dispose(){this.three.removeEventListener(li.ADD_SPLINE,this.onAddSpline),j3.removeEditorGroup(this.name)}addSpline(t,n){var r;t.draggableScale=this.defaultScale,t.hideTransform(),((r=this.group)==null?void 0:r.current)!==null&&t.initDebug(this.group.current,n),this.add(t),this.currentSpline=t}enableClickToDraw(){document.querySelectorAll(".clickable").forEach(t=>{t.addEventListener("mousedown",this.onClickCanvas),t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mouseup",this.onMouseUp)})}disableClickToDraw(){document.querySelectorAll(".clickable").forEach(t=>{t.removeEventListener("mousedown",this.onClickCanvas),t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mouseup",this.onMouseUp)})}mouseToSplinePos(t,n,r,i){const a=new Ae,c=Math.PI/2,u=this._camera,p=u.zoom,y=u.rotation.x===-6123233995736766e-32&&u.rotation.y===0&&u.rotation.z===0,x=u.rotation.x===-Math.PI&&u.rotation.y===12246467991473532e-32&&u.rotation.z===Math.PI,S=u.rotation.x===-6162975822039155e-48&&u.rotation.y===-c&&u.rotation.z===0,M=u.rotation.x===-6162975822039155e-48&&u.rotation.y===c&&u.rotation.z===0,I=u.rotation.x===-1.5707953264174506&&u.rotation.y===0&&u.rotation.z===0,L=u.rotation.x===1.5707953264174506&&u.rotation.y===0&&u.rotation.z===0;let B=t,A=n;x||M?B*=-1:I&&(A*=-1);const V=r/2/p,X=i/2/p;if(this.currentSpline===null&&(this.currentSpline=this.createSpline()),y||x){const P=B*V+u.position.x,te=A*X+u.position.y;a.set(P,te,0)}else if(S||M){const P=B*V+u.position.z,te=A*X+u.position.y;a.set(0,te,P)}else if(I||L){const P=B*V+u.position.x,te=A*X+u.position.z;a.set(P,0,te)}return a}get camera(){return this._camera}set camera(t){this._camera=t,this.children.forEach(n=>{const r=n;r.camera=t})}}const _8e=["Single","Side by Side","Stacked","Quad"],XYe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC60lEQVRYhe2YT4hNcRTHP48xpmYaNAvRyEQxEhnKQljYsRm9/EmSyJiMFAsMZWNhJYoNIUVJ2VGiyb9ZzIpMpkQSahbGv9GMYWrM+1rc2zjvzvvdd+99rzdvMd+6de75nd+5387vnN/v/G5KEuWMKRNNIB8mCRaKiiL5qQb2ApuBuUAV0Ad0AJeB3sSeJRX6LJbULTf6JTUn9Z+KWMUpPyp/Avoa4CNQZ3Sj/lNpdL/xottR7AjOkHRUUpekN5I6JbVLavDH75lIfZN0UFKTpCWS0pJem/HeJBEMG6yV1ONYtgFJbZJ+GF1jDh+zJb03NuliEuwMkMo4yErS2RA/LcbuYVyCrm1mA7Dal/8Cu4FG4JD/HsTTkCy6a+SVMTPQuc1sBKb78nHghi+/A+YBxwL2lbhRY+ThuARdEVxu5JdGFvACr0otdoZ8Y4+Rn0Sn5sFFsMvI6YB9MzA1YJ8mN8k1wAHzfj4uQVdyrpI0aJL7oqTtkq4FiqPLyCOSbktqlbRL0jlJQ2b8QdwCUZ4qvhRStZL0XFK1pMd57CRvq5mfhKBriRfiFUMY6oD7eOdwPlQAN4G10dfWg+uouwXsiOssAj4AC+JMcEWwvnAuOTEr7gTXPmg34zagOwkbIIOXAo9CbDYBrcBXYN+4UUdy2sRflyS5zVNlfPX7ugpJW5V9nI7mmh+lYU0lCZ2B3TOnAVuAk0BTwC5nuhWro46KauBOQJch5OpRaoIW34GreGf+YZdRqS9NAj4Bp4ClQDvwOWxCqSM4ADQEdKE5XvbXzlITrAVe4TW+M6NMKDXBFLAMuAD0ACfIc7pMZBXXA2cY3/xmodQRHAL2A2+NLtj8ZiEKwUL/z2WMPAJcAVYALWSf8dZuDFGWeBHwKxm3sWYhiGG8Tfo6sA2vSfiSy4GrH3wGrDcfKSSKKf6v1E9yF0XK9Q1XBPuMXMw8HXTonQFwETwNzMFr64v1jzgFHIk9ybHEZYPJo65QlD3Bf2/Q/eaHPiSWAAAAAElFTkSuQmCC",YYe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAETklEQVRYhe2YXYhVVRTHf3d0/JhyUrMpFbImM+whSa3Mynww+4AeIgiKoozooQ+KyMyXIAujF6OXqHyI6iEKKYgIP/owsjSFqCkprdDUTEcjbWZ0HHV+Pex1ucfb9Z57Z9REXHA4Z++99l7/s/ZZ/7X2KaiczNLwfwPIk9MA+yunNMAG4DHgV+BvoB3YFff2TPstYEyfrajVroI6Sr1GvahsbJC63HzZq04pmztSvU5tVRuqYRiYg78JeBR4HPg5ntdmxovz9wJfA3uAxuibDLQCA+IqynnAQuBuYCnwMLC1rx48U12U8cZqdWqMDcx4cI16qTpYbVKHqa+ovWUeHKsujn7VL9ULq2HI+wY7gVeBJdGeFu3J4ZUiy/cAXeHRRuAQsC/GC0B3eG4BcH/0tUV7czUAeVsMsBF4Kha9HZgCvAncAuwPnXHA0wFuGLANuDrGuoGDwFxgTqzzQ7RX5FrP2eLsdb76vnogtme6+nE8H1YPlQXHwbi3q9eqn0e7Tb25VrsF68vFY0lb1AGcDTwItGQ8tQM4AIwGmqP/EPAu8A0wElgJfFGzxTo8mKWXu9Rd4ZF96jvqjSbauEC9Sn1O3R463epLaku99voCsFXdkAH3kNpcQW+IiT/bQne3eufxBtioPqP2mKhioXpWzpxb1T8C5Ifh4ZptVoriRmAIKdrI3Lujf3bobAPeJpF0NVkKrAFuI9HTOBIxnxFrF4OgQKKr/dnJlQA+AcwABgOHA4zAamA5cE7orQL+zAEHiWI+A2bFC7aSguheYCgpqAphZz3wSB7AecCICv2TgH8oFRib4gVqka0k0h8CXAxMBW6ooDejFoCvA9OBQUAvKWM0kDz4XUZvNKXtyZMWUl7vBbaQXq457PeEziDgx/KJlQAuIPFdMcEXv5OdYWBP9M8k8VpnDQCvB4aTSrCNJB5cSdrW3tBpIJVnR0qdUTxAfdGUOVTnmwqEanNmqltC/9OgqePKg5eom8PgdvW+oJ9Kupera0O3U50TL3lcAaI+oHaF4R3qa6Z822wq0Saq89T1lmSxOrxeW/Xm4uGkiqQDmECKuKHxHW0HdpMiewSpvGqKeR8Ay0iBsYIjg6261PE2o9Q3Yqv+MqWxO9R1Hl12qs+q49Vlppy82pSr+5xJKsko4AXgHlJ0t5NIeg3wLXAlqZhtIUV8J6nmWwX8QiLjdhL5TwMWkY4R6/rrwYKlMr1Y321QZ/vfwBijPqm+rF4Wc7PjE9QllurGVeoV5gRNHsAm9fnMom3qrKPoTjKdMXaYyrFygEWQ72XWW24qhPu8xcUc2UU6O8wFPjmK7jhgPHAuMJGUGQ6U6WwE5sfzTXGvei7KA9hFOiR9D/wOfFVFt4dS2tpfRe83Ur7/CPiJakfOGgBCypubatArl2r8VfOax/LfzABKtePAzHO/5FgC7KBEzB2kOrDfUm8mOeFySv9+OyFyGmB/5aQH+C9BVKmVCNuMZgAAAABJRU5ErkJggg==",KYe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQ0lEQVQ4jWP8////fwYqAxYozUhFM/8zkaKYWIWkGEq0b0ZdSjQY5i79TyWagRGaTUdzFEEw6lLqGzqwLoVVJ1StpwA9sBwbUqAh5gAAAABJRU5ErkJggg==",Vk=class Vk extends Tn.Component{constructor(t){super(t);Xe(this,"scene");Xe(this,"renderer");Xe(this,"currentScene");Xe(this,"scenes",new Map);Xe(this,"cameras",new Map);Xe(this,"controls",new Map);Xe(this,"currentCamera");Xe(this,"currentWindow");Xe(this,"helpersContainer",new gv);Xe(this,"grid",new pYe);Xe(this,"cameraHelpers",new Map);Xe(this,"lightHelpers",new Map);Xe(this,"interactionHelper",new Lke(25));Xe(this,"currentTransform");Xe(this,"splineEditor");Xe(this,"depthMaterial",new Tve);Xe(this,"normalsMaterial",new Eve);Xe(this,"uvMaterial",new LYe);Xe(this,"wireframeMaterial",new eh({opacity:.33,transparent:!0,wireframe:!0}));Xe(this,"playing",!1);Xe(this,"rafID",-1);Xe(this,"cameraControlsRafID",-1);Xe(this,"width",0);Xe(this,"height",0);Xe(this,"tlCam",null);Xe(this,"trCam",null);Xe(this,"blCam",null);Xe(this,"brCam",null);Xe(this,"tlRender","Renderer");Xe(this,"trRender","Renderer");Xe(this,"blRender","Renderer");Xe(this,"brRender","Renderer");Xe(this,"cameraVisibility",!0);Xe(this,"lightVisibility",!0);Xe(this,"gridVisibility",!0);Xe(this,"selectedItem");Xe(this,"debugCamera");Xe(this,"raycaster",new ME);Xe(this,"pointer",new An);Xe(this,"cameraControls");Xe(this,"canvasRef");Xe(this,"containerRef");Xe(this,"tlWindow");Xe(this,"trWindow");Xe(this,"blWindow");Xe(this,"brWindow");Xe(this,"editorCameras",["Top","Bottom","Left","Right","Front","Back","Orthographic","UI","Debug"]);Xe(this,"setupRenderer",t=>{this.renderer&&this.renderer.dispose();const n=this.canvasRef.current;this.props.three.canvas=n;const r=t.value;r.type==="WebGLRenderer"?(this.renderer=new hx({canvas:n,stencil:!1}),this.grid.visible=!0):r.type==="WebGPURenderer"&&(this.renderer=new RI({canvas:n,stencil:!1}),this.grid.visible=!1),this.renderer&&(this.renderer.autoClear=!1,this.renderer.shadowMap.enabled=!0,this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setClearColor(0),this.resize(),this.props.three.renderer=this.renderer)});Xe(this,"onUpdate",()=>{this.playing&&(this.update(),this.draw(),this.rafID=requestAnimationFrame(this.onUpdate))});Xe(this,"resize",()=>{var c;this.width=window.innerWidth-300,this.height=window.innerHeight,(c=this.renderer)==null||c.setSize(this.width,this.height);const t=Math.floor(this.width/2),n=Math.floor(this.height/2);this.props.three.resize(this.width,this.height),this.props.onSceneResize!==void 0&&this.currentScene!==void 0&&this.props.onSceneResize(this.currentScene,this.width,this.height);let r=this.width,i=this.height;switch(this.state.mode){case"Side by Side":r=t,i=this.height;break;case"Stacked":r=this.width,i=n;break;case"Quad":r=t,i=n;break}const a=r/i;this.cameras.forEach(u=>{var p;u instanceof zx?(u.left=r/-2,u.right=r/2,u.top=i/2,u.bottom=i/-2,u.name==="UI"&&(u.position.x=this.width/2,u.position.y=this.height/-2,u.position.z=100),u.updateProjectionMatrix()):u instanceof Ja&&(u.aspect=a,u.updateProjectionMatrix()),(p=this.cameraHelpers.get(u.name))==null||p.update()})});Xe(this,"addScene",t=>{const n=this.props.scenes.get(t.value.name);if(n!==void 0){const r=new n;r.visible=!1,this.props.onSceneAdd!==void 0&&this.props.onSceneAdd(r),this.props.three.scene=r,this.scenes.set(t.value.name,r),this.scene.add(r)}else console.log("Hermes - Scene not found:",t.value.name,this.props.scenes)});Xe(this,"sceneUpdate",t=>{this.currentScene!==void 0&&(this.currentScene.visible=!1,this.clearLightHelpers());const n=this.scene.getObjectByName(t.value.name);n!==void 0&&(this.currentScene=n,this.currentScene.visible=!0,this.addLightHelpers(this.currentScene))});Xe(this,"removeScene",t=>{const n=t.value.name;this.scenes.delete(n);const r=this.scene.getObjectByName(n);r&&setTimeout(()=>{od(r)},100),this.clearLightHelpers()});Xe(this,"addCamera",t=>{var a;const n=t.value,r=n.uuid,i=(a=this.props.three.scene)==null?void 0:a.getObjectByProperty("uuid",n.uuid);if(i!==void 0){const c=i;this.cameras.set(r,c);const u=new Oke(c);u.visible=this.cameraVisibility,this.cameraHelpers.set(r,u),this.helpersContainer.add(u),this.setState({lastUpdate:Date.now()})}});Xe(this,"removeCamera",t=>{const r=t.value.uuid,i=this.cameraHelpers.get(r);i!==void 0&&(this.helpersContainer.remove(i),i.dispose()),this.cameras.delete(r),this.setState({lastUpdate:Date.now()})});Xe(this,"onMouseMove",t=>{var x;const n=new An;(x=this.renderer)==null||x.getSize(n);const r=Math.min(t.clientX,n.x),i=Math.min(t.clientY,n.y);this.pointer.x=iv(r,0,n.x,-1,1),this.pointer.y=iv(i,0,n.y,1,-1);const a=n.x/2,c=n.y/2,u=()=>{r<a?this.pointer.x=iv(r,0,a,-1,1):this.pointer.x=iv(r,a,n.x,-1,1)},p=()=>{i<c?this.pointer.y=iv(i,0,c,1,-1):this.pointer.y=iv(i,c,n.y,1,-1)};switch(this.state.mode){case"Quad":u(),p();break;case"Side by Side":u();break;case"Stacked":p(),p();break}if(this.updateCamera(r,i,a,c),this.state.interactionMode==="Orbit"||this.currentScene===void 0)return;const y=this.raycaster.intersectObjects(this.currentScene.children);y.length>0&&this.interactionHelper.position.copy(y[0].point)});Xe(this,"onClick",t=>{if(this.state.interactionMode==="Orbit"||this.currentScene===void 0)return;const n=new An;if(this.renderer.getSize(n),t.clientX>=n.x)return;this.onMouseMove(t);const r=this.raycaster.intersectObjects(this.currentScene.children);r.length>0&&(this.props.three.getObject(r[0].object.uuid),this.interactionHelper.visible=!1,this.setState({interactionMode:"Orbit",lastUpdate:Date.now()}))});Xe(this,"onKey",t=>{if(this.selectedItem!==void 0){if(t.ctrlKey){if(this.currentCamera.name==="UI")return;const n=this.controls.get(this.currentCamera.name);t.key==="0"?(t.preventDefault(),this.clearControls(),this.cameraControls=new g1(this.currentCamera,this.currentWindow.current),this.selectedItem instanceof mn||this.selectedItem instanceof UW?(this.selectedItem.geometry.computeBoundingBox(),this.cameraControls.fitToBox(this.selectedItem.geometry.boundingBox,!0)):this.cameraControls.fitToSphere(this.selectedItem,!0),this.updateCameraControls(n,!0)):t.key==="1"?(t.preventDefault(),this.clearControls(),this.cameraControls=new g1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,Math.PI*.5,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="2"?(t.preventDefault(),this.clearControls(),this.cameraControls=new g1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,0,!0),this.cameraControls.moveTo(this.selectedItem.position.x,0,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="3"?(t.preventDefault(),this.clearControls(),this.cameraControls=new g1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI/2,Math.PI/2,!0),this.cameraControls.moveTo(0,this.selectedItem.position.y,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="4"?(t.preventDefault(),this.clearControls(),this.cameraControls=new g1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI,Math.PI/2,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="5"&&(t.preventDefault(),this.clearControls(),this.cameraControls=new g1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(yk(45),yk(45),!0),this.updateCameraControls(n))}else if(this.currentTransform!==void 0)switch(t.key){case"r":this.currentTransform.setMode("rotate");break;case"s":this.currentTransform.setMode("scale");break;case"t":this.currentTransform.setMode("translate");break;case"q":this.currentTransform.setSpace(this.currentTransform.space==="local"?"world":"local");break}}});Xe(this,"onSetSelectedItem",t=>{this.selectedItem!==void 0&&this.updateSelectedItemHelper(!1),this.selectedItem=void 0;const n=t.value.uuid;if(this.scenes.forEach(r=>{n.search(r.uuid)>-1&&(this.selectedItem=r.getObjectByProperty("uuid",n))}),this.selectedItem===void 0){console.log(`Hermes - Can't find selected item: ${t.value.uuid}, ${t.value.name}`);return}this.currentTransform!==void 0&&(this.currentTransform.removeEventListener("objectChange",this.onUpdateTransform),Xu.instance.remove(this.currentTransform.getHelper().name)),this.currentTransform=Xu.instance.add(t.value.name),this.currentTransform.attach(this.selectedItem),this.helpersContainer.add(this.currentTransform.getHelper()),this.currentTransform.addEventListener("objectChange",this.onUpdateTransform),this.updateSelectedItemHelper(!0)});Xe(this,"onUpdateTransform",()=>{this.selectedItem!==void 0&&(this.props.three.updateObject(this.selectedItem.uuid,"position",this.selectedItem.position),this.props.three.updateObject(this.selectedItem.uuid,"rotation",{x:this.selectedItem.rotation.x,y:this.selectedItem.rotation.y,z:this.selectedItem.rotation.z}),this.props.three.updateObject(this.selectedItem.uuid,"scale",this.selectedItem.scale),Uk.instance.update())});Xe(this,"clearLightHelpers",()=>{this.lightHelpers.forEach(t=>{this.helpersContainer.remove(t),t.dispose()}),this.lightHelpers.clear()});Xe(this,"addLightHelpers",t=>{t.traverse(n=>{if(n.type.search("Light")>-1){let r;switch(n.type){case"DirectionalLight":r=new Dke(n,100),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"HemisphereLight":r=new Nke(n,250),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"RectAreaLight":r=new qXe(n),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"PointLight":r=new Ike(n,100),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"SpotLight":r=new Pke(n),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break}}})});Xe(this,"updateCamera",(t,n,r,i)=>{switch(this.state.mode){case"Quad":n<i?t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam:t<r?this.currentCamera=this.blCam:this.currentCamera=this.brCam;break;case"Side by Side":t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break;case"Single":this.currentCamera=this.tlCam;break;case"Stacked":n<i?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break}this.splineEditor.camera=this.currentCamera,this.raycaster.setFromCamera(this.pointer,this.currentCamera),this.currentCamera===this.tlCam?this.currentWindow=this.tlWindow:this.currentCamera===this.trCam?this.currentWindow=this.trWindow:this.currentCamera===this.blCam?this.currentWindow=this.blWindow:this.currentCamera===this.brCam&&(this.currentWindow=this.brWindow),Xu.instance.updateCamera(this.currentCamera,this.currentWindow.current)});Xe(this,"updateCameraControls",(t,n=!1)=>{if(this.selectedItem===void 0)return;cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.cameraControls&&(this.cameraControls.smoothTime=.1);const r=.15,i=new kve;i.start(),this.selectedItem.getWorldPosition(t.target0);const a=()=>{const c=i.getDelta();this.cameraControls&&this.cameraControls.update(c),n&&(t.target.lerp(t.target0,r),t.object.position.lerp(t.position0,r),t.object.zoom=RH(t.object.zoom,t.zoom0,r),t.object.updateProjectionMatrix(),t.dispatchEvent({type:"change"})),i.getElapsedTime()>=.5?(cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.clearControls()):this.cameraControlsRafID=requestAnimationFrame(a)};a()});Xe(this,"clearControls",()=>{this.cameraControls!==void 0&&(this.cameraControls.disconnect(),this.cameraControls.dispose(),this.cameraControls=void 0)});Xe(this,"drawDouble",()=>{const t=this.getSceneOverride(this.tlRender),n=this.getSceneOverride(this.trRender),r=Math.floor(this.width/2),i=Math.floor(this.height/2);if(this.state.mode==="Side by Side")this.drawTo(0,0,r,this.height,this.tlCam,t),this.drawTo(r,0,r,this.height,this.trCam,n);else{const a=this.height-i;this.drawTo(0,a,this.width,i,this.tlCam,t),this.drawTo(0,0,this.width,i,this.trCam,n)}});Xe(this,"drawQuad",()=>{const t=this.getSceneOverride(this.tlRender),n=this.getSceneOverride(this.trRender),r=this.getSceneOverride(this.blRender),i=this.getSceneOverride(this.brRender),a=Math.floor(this.width/2),c=Math.floor(this.height/2);let u=0,p=0;p=this.height-c,u=0,this.drawTo(u,p,a,c,this.tlCam,t),u=a,this.drawTo(u,p,a,c,this.trCam,n),p=0,u=0,this.scene.overrideMaterial=r,this.drawTo(u,p,a,c,this.blCam,r),u=a,this.drawTo(u,p,a,c,this.brCam,i)});this.props.three.addEventListener(li.ADD_RENDERER,this.setupRenderer),this.scene=new _E,this.scene.name=this.scene.uuid="",this.canvasRef=Tn.createRef(),this.containerRef=Tn.createRef(),this.tlWindow=Tn.createRef(),this.trWindow=Tn.createRef(),this.blWindow=Tn.createRef(),this.brWindow=Tn.createRef();const n=t.three.name,r=localStorage,i=r.getItem(`${n}_mode`);this.state={mode:i!==null?i:"Single",modeOpen:!1,renderModeOpen:!1,interactionMode:"Orbit",interactionModeOpen:!1,lastUpdate:Date.now()},r.setItem(`${n}_mode`,this.state.mode),r.setItem(`${n}_tlCam`,r.getItem(`${n}_tlCam`)!==null?r.getItem(`${n}_tlCam`):"Debug"),r.setItem(`${n}_trCam`,r.getItem(`${n}_trCam`)!==null?r.getItem(`${n}_trCam`):"Orthographic"),r.setItem(`${n}_blCam`,r.getItem(`${n}_blCam`)!==null?r.getItem(`${n}_blCam`):"Front"),r.setItem(`${n}_brCam`,r.getItem(`${n}_brCam`)!==null?r.getItem(`${n}_brCam`):"Top"),r.setItem(`${n}_tlRender`,r.getItem(`${n}_tlRender`)!==null?r.getItem(`${n}_tlRender`):"Renderer"),r.setItem(`${n}_trRender`,r.getItem(`${n}_trRender`)!==null?r.getItem(`${n}_trRender`):"Renderer"),r.setItem(`${n}_blRender`,r.getItem(`${n}_blRender`)!==null?r.getItem(`${n}_blRender`):"Renderer"),r.setItem(`${n}_brRender`,r.getItem(`${n}_brRender`)!==null?r.getItem(`${n}_brRender`):"Renderer");const a={Vector2:An,Vector3:Ae,Vector4:xi,Quaternion:ls,Matrix4:or,Spherical:MH,Box3:Cv,Sphere:Q3,Raycaster:ME};g1.install({THREE:a}),this.setupScene(),this.setupTools();const c=localStorage.getItem(this.expandedCameraVisibility);c!==null&&(this.cameraVisibility=c==="open"),this.saveExpandedCameraVisibility();const u=localStorage.getItem(this.expandedLightVisibility);u!==null&&(this.lightVisibility=u==="open"),this.saveExpandedLightVisibility();const p=localStorage.getItem(this.expandedGridVisibility);p!==null&&(this.gridVisibility=p==="open"),this.grid.visible=this.gridVisibility,this.saveExpandedGridVisibility(),Vk.instance=this}componentDidMount(){this.enable(),this.assignControls(),this.resize(),this.play(),Xu.instance.setApp(this.props.three),Xu.instance.activeCamera=this.debugCamera}componentDidUpdate(t,n,r){n.mode!==this.state.mode&&(this.assignControls(),this.resize())}componentWillUnmount(){this.disable(),this.clear(),j3.removeEditorGroup("View Settings")}render(){const t=[];return this.cameras.forEach((n,r)=>{t.push(r)}),Ke.jsxs("div",{className:"multiview",children:[Ke.jsx("canvas",{ref:this.canvasRef}),Ke.jsxs("div",{className:`cameras ${this.state.mode==="Single"||this.state.mode==="Stacked"?"single":""}`,ref:this.containerRef,children:[this.state.mode==="Single"&&Ke.jsx(Ke.Fragment,{children:Ke.jsx(ev,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}})}),(this.state.mode==="Side by Side"||this.state.mode==="Stacked")&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(ev,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),Ke.jsx(ev,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.trCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}})]}),this.state.mode==="Quad"&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(ev,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),Ke.jsx(ev,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.trCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}}),Ke.jsx(ev,{name:"bl",camera:this.blCam,options:t,ref:this.blWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.blCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.blCam),this.blCam=r,localStorage.setItem(`${this.appID}_blCam`,r.name),this.createControls(r,this.blWindow.current))},onSelectRenderMode:n=>{this.blRender=n,localStorage.setItem(`${this.appID}_blRender`,n)}}),Ke.jsx(ev,{name:"br",camera:this.brCam,options:t,ref:this.brWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.brCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.brCam),this.brCam=r,localStorage.setItem(`${this.appID}_brCam`,r.name),this.createControls(r,this.brWindow.current))},onSelectRenderMode:n=>{this.brRender=n,localStorage.setItem(`${this.appID}_brRender`,n)}})]})]}),Ke.jsxs("div",{className:"settings",children:[Ke.jsx(Bk,{title:"View",index:_8e.indexOf(this.state.mode),options:_8e,onSelect:n=>{n!==this.state.mode&&(this.killControls(),this.setState({mode:n}),localStorage.setItem(`${this.appID}_mode`,n))},open:this.state.modeOpen,onToggle:n=>{this.setState({modeOpen:n,renderModeOpen:!1,interactionModeOpen:!1})}}),Ke.jsx(Bk,{title:"Interact",index:this.state.interactionMode==="Orbit"?0:1,options:["Orbit Mode","Selection Mode"],onSelect:n=>{this.interactionHelper.visible=n==="Selection Mode",this.setState({interactionMode:this.interactionHelper.visible?"Selection":"Orbit"})},open:this.state.interactionModeOpen,onToggle:n=>{this.setState({modeOpen:!1,renderModeOpen:!1,interactionModeOpen:n})}}),Ke.jsx(yj,{name:"cameraHelper",icon:XYe,selected:this.cameraVisibility,height:24,top:2,onClick:n=>{if(this.cameraVisibility=n,this.saveExpandedCameraVisibility(),this.cameraHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n){const r=this.cameraHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),Ke.jsx(yj,{name:"lightHelper",icon:YYe,selected:this.lightVisibility,height:24,top:4,onClick:n=>{if(this.lightVisibility=n,this.saveExpandedLightVisibility(),this.lightHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n&&this.selectedItem.isLight===!0){const r=this.lightHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),Ke.jsx(yj,{name:"gridHelper",icon:KYe,selected:this.gridVisibility,height:21,width:21,onClick:n=>{this.setGridVisibility(n)}})]},this.state.lastUpdate)]})}setupScene(){this.helpersContainer.name="helpers",this.scene.add(this.helpersContainer),this.scene.add(this.grid),this.interactionHelper.name="interactionHelper",this.interactionHelper.visible=!1,this.helpersContainer.add(this.interactionHelper);const t=(a,c)=>{const u=new zx(-100,100,100,-100,0,3e3);return u.name=a,u.position.copy(c),u.lookAt(0,0,0),this.cameras.set(a,u),u},n=1e3;t("Top",new Ae(0,n,0)),t("Bottom",new Ae(0,-n,0)),t("Left",new Ae(-n,0,0)),t("Right",new Ae(n,0,0)),t("Front",new Ae(0,0,n)),t("Back",new Ae(0,0,-n)),t("Orthographic",new Ae(n,n,n)),t("UI",new Ae),this.debugCamera=new Ja(60,1,.01,3e3),this.debugCamera.name="Debug",this.debugCamera.position.set(300,300,300),this.debugCamera.lookAt(0,0,0),this.cameras.set("Debug",this.debugCamera),this.currentCamera=this.debugCamera;const r=localStorage,i=this.props.three.name;this.tlCam=this.cameras.get(r.getItem(`${i}_tlCam`)),this.trCam=this.cameras.get(r.getItem(`${i}_trCam`)),this.blCam=this.cameras.get(r.getItem(`${i}_blCam`)),this.brCam=this.cameras.get(r.getItem(`${i}_brCam`)),this.tlCam===void 0&&(this.tlCam=this.cameras.get("Debug")),this.trCam===void 0&&(this.trCam=this.cameras.get("Orthographic")),this.blCam===void 0&&(this.blCam=this.cameras.get("Front")),this.brCam===void 0&&(this.brCam=this.cameras.get("Top")),j3.addEditorGroup({title:"Editor",items:[{type:"button",prop:"Hide All Transforms"},{type:"button",prop:"Resize"}],onUpdate:(a,c)=>{switch(a){case"Hide All Transforms":Xu.instance.hide();break;case"Resize":this.resize();break}},subgroups:[{title:"Debug Camera",items:[{type:"range",prop:"Near",step:1e-4,min:.001,max:1e3,value:this.debugCamera.near},{type:"range",prop:"Far",step:.001,min:.001,max:1e4,value:this.debugCamera.far}],onUpdate:(a,c)=>{switch(a){case"Near":this.debugCamera.near=c,this.debugCamera.updateProjectionMatrix();break;case"Far":this.debugCamera.far=c,this.debugCamera.updateProjectionMatrix();break}}},{title:"Grid",items:[{type:"number",prop:"Position",value:this.grid.position.y},{type:"boolean",prop:"Depth Test",value:this.grid.gridMaterial.depthTest}],onUpdate:(a,c)=>{switch(a){case"Position":this.grid.position.y=c;break;case"Depth Test":this.grid.gridMaterial.depthTest=c,this.grid.gridMaterial.needsUpdate=!0;break}}}]})}setupTools(){this.splineEditor=new qYe(this.currentCamera,this.three),this.splineEditor.initDebug(),this.helpersContainer.add(this.splineEditor)}play(){this.playing=!0,this.onUpdate()}pause(){this.playing=!1,cancelAnimationFrame(this.rafID),this.rafID=-1}toggleOrbitControls(t){this.controls.forEach(n=>{n.enabled=!t})}clear(){this.three.dispatchEvent({type:li.CLEAR_OBJECT}),j3.removeAllGroups(),this.clearLightHelpers(),this.clearControls(),this.currentTransform!==void 0&&(this.currentTransform.removeEventListener("objectChange",this.onUpdateTransform),Xu.instance.remove(this.currentTransform.getHelper().name)),this.currentTransform=void 0,Xu.instance.clear(),this.cameras.forEach(t=>{this.editorCameras.indexOf(t.name)<0&&this.three.dispatchEvent({type:li.REMOVE_CAMERA,value:t})}),this.currentCamera=this.debugCamera,this.currentScene=void 0,this.scenes.forEach(t=>{this.three.dispatchEvent({type:li.REMOVE_SCENE,value:t})}),this.scenes.clear()}setGridVisibility(t){this.gridVisibility=t,this.saveExpandedGridVisibility(),this.grid.visible=t}update(){var t,n;this.renderer&&(this.renderer instanceof hx?(t=this.renderer)==null||t.clear():this.renderer instanceof RI&&((n=this.renderer)==null||n.clearAsync())),this.controls.forEach(r=>r.update()),this.cameraHelpers.forEach(r=>r.update()),this.lightHelpers.forEach(r=>{r.update!==void 0&&r.update()}),this.props.onSceneUpdate!==void 0&&this.currentScene!==void 0&&this.props.onSceneUpdate(this.currentScene)}draw(){var t,n;switch(this.renderer&&(this.renderer instanceof hx?(t=this.renderer)==null||t.clear():this.renderer instanceof RI&&((n=this.renderer)==null||n.clearAsync())),this.state.mode){case"Single":this.drawSingle();break;case"Side by Side":case"Stacked":this.drawDouble();break;case"Quad":this.drawQuad();break}}enable(){const t=this.containerRef.current;t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("click",this.onClick),window.addEventListener("keydown",this.onKey),window.addEventListener("resize",this.resize),this.three.addEventListener(li.ADD_SCENE,this.addScene),this.three.addEventListener(li.SET_SCENE,this.sceneUpdate),this.three.addEventListener(li.REMOVE_SCENE,this.removeScene),this.three.addEventListener(li.ADD_CAMERA,this.addCamera),this.three.addEventListener(li.REMOVE_CAMERA,this.removeCamera),this.three.addEventListener(li.SET_OBJECT,this.onSetSelectedItem)}disable(){const t=this.containerRef.current;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("click",this.onClick),window.removeEventListener("keydown",this.onKey),window.removeEventListener("resize",this.resize),this.three.removeEventListener(li.ADD_SCENE,this.addScene),this.three.removeEventListener(li.SET_SCENE,this.sceneUpdate),this.three.removeEventListener(li.ADD_CAMERA,this.addCamera),this.three.removeEventListener(li.REMOVE_CAMERA,this.removeCamera),this.three.removeEventListener(li.SET_OBJECT,this.onSetSelectedItem)}updateSelectedItemHelper(t){if(this.selectedItem!==void 0)if(this.cameraVisibility){if(this.selectedItem.isLight===!0&&!this.lightVisibility){const n=this.lightHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}else{const n=this.cameraHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}createControls(t,n){const r=this.controls.get(t.name);if(r!==void 0&&r.dispose(),this.controls.delete(t.name),t.name==="UI")return;const i=new YXe(t,n);switch(i.enableDamping=!0,i.dampingFactor=.1,t.name){case"Top":case"Bottom":case"Left":case"Right":case"Front":case"Back":i.enableRotate=!1;break}this.controls.set(t.name,i)}clearCamera(t){const n=this.cameraHelpers.get(t.name);n!==void 0&&(this.helpersContainer.remove(n),n.dispose(),this.cameraHelpers.delete(t.name));const r=this.controls.get(t.name);r!==void 0&&(r.dispose(),this.controls.delete(t.name))}killControls(){this.controls.forEach((t,n)=>{t.dispose();const r=this.cameraHelpers.get(n);r!==void 0&&(this.helpersContainer.remove(r),r.dispose()),this.cameraHelpers.delete(n),this.controls.delete(n)}),this.controls.clear(),this.cameraHelpers.clear()}assignControls(){switch(this.state.mode){case"Single":this.createControls(this.tlCam,this.tlWindow.current);break;case"Side by Side":case"Stacked":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current);break;case"Quad":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current),this.createControls(this.blCam,this.blWindow.current),this.createControls(this.brCam,this.brWindow.current);break}}saveExpandedCameraVisibility(){localStorage.setItem(this.expandedCameraVisibility,this.cameraVisibility?"open":"closed")}saveExpandedLightVisibility(){localStorage.setItem(this.expandedLightVisibility,this.lightVisibility?"open":"closed")}saveExpandedGridVisibility(){localStorage.setItem(this.expandedGridVisibility,this.gridVisibility?"open":"closed")}getSceneOverride(t){switch(t){case"Depth":return this.depthMaterial;case"Normals":return this.normalsMaterial;case"Renderer":return null;case"UVs":return this.uvMaterial;case"Wireframe":return this.wireframeMaterial}return null}drawTo(t,n,r,i,a,c){var u,p,y,x;switch(a.name){case"Left":case"Right":this.grid.rotation.z=Math.PI/2;break;case"Front":case"Back":this.grid.rotation.x=Math.PI/2;break}this.scene.overrideMaterial=c,this.renderer&&((u=this.renderer)==null||u.setViewport(t,n,r,i),(p=this.renderer)==null||p.setScissor(t,n,r,i),this.renderer instanceof hx?(y=this.renderer)==null||y.render(this.scene,a):this.renderer instanceof RI&&((x=this.renderer)==null||x.renderAsync(this.scene,a))),this.grid.rotation.set(0,0,0)}drawSingle(){const t=this.getSceneOverride(this.tlRender);this.drawTo(0,0,this.width,this.height,this.tlCam,t)}get appID(){return this.props.three.name}get mode(){return this.state.mode}get three(){return this.props.three}get expandedCameraVisibility(){return`${this.appID}_multiviewCameraVisibility`}get expandedLightVisibility(){return`${this.appID}_multiviewLightVisibility`}get expandedGridVisibility(){return`${this.appID}_multiviewGridVisibility`}};Xe(Vk,"instance",null);let da=Vk;function b7e(s){if(s.child===void 0)return console.log("Hermes - No child attached"),null;const e=Tn.useRef(null),[t,n]=Tn.useState(!1),r=s.child.children.length>0,i=[];return s.child.children.length>0&&s.child.children.map((a,c)=>{i.push(Ke.jsx(b7e,{child:a,three:s.three},c))}),Tn.useEffect(()=>{if(s.child){const a=s.child.uuid.split(".")[0],c=s.three.getScene(a);if(c!==null)try{const u=c.getObjectByProperty("uuid",s.child.uuid);u!==void 0?e.current.style.opacity=u.visible?"1":"0.25":console.log(`Hermes - Can't find child: ${s.child.uuid}`)}catch(u){console.log("Error looking for child:",u),console.log(s.child),console.log(s.three.scenes),console.log(c)}else console.log(`Hermes (ChildObject) - Can't find Scene: ${a} with child UUID: ${s.child.uuid}`,s.three.scenes,s.three.scene,c)}},[t]),Ke.jsxs("div",{className:"childObject",children:[Ke.jsxs("div",{className:"child",children:[r?Ke.jsx("button",{className:"status",style:{backgroundPositionX:t?"-14px":"2px"},onClick:()=>{n(!t)}}):null,Ke.jsx("button",{className:"name",style:{left:r?"20px":"5px"},onClick:()=>{s.child!==void 0?(s.three.getObject(s.child.uuid),!t&&r&&n(!0)):console.log("Hermes - No child attached...")},children:s.child.name.length>0?`${s.child.name} (${s.child.type})`:`${s.child.type}::${s.child.uuid}`}),Ke.jsx("button",{className:"visibility",ref:e,onClick:()=>{if(s.child){const a=s.three.getScene(s.child.uuid);if(a!==null){const c=a.getObjectByProperty("uuid",s.child.uuid);if(c!==void 0){const u="visible",p=!c.visible;e.current.style.opacity=p?"1":"0.25",s.three.updateObject(s.child.uuid,u,p),Ko(c,u,p)}else console.log(`Hermes - Couldn't find object: ${s.child.uuid}`,a)}else console.log(`Hermes - Couldn't find object in scene: ${s.child.uuid}, ${s.child.name}`)}}}),Ke.jsx("div",{className:`icon ${NFe(s.child)}`})]}),Ke.jsx("div",{className:t?"open":"",children:Ke.jsx("div",{className:"container",children:i})})]},Math.random())}function wj(s){var t;const e=[];return(t=s.child)==null||t.children.map((n,r)=>{e.push(Ke.jsx(b7e,{child:n,scene:s.scene,three:s.three},r))}),Ke.jsx("div",{className:`scene ${s.class!==void 0?s.class:""}`,children:e})}function b8e(s){switch(s){case"fov":return"FOV";case"zoom":return"Zoom";case"near":return"Near";case"far":return"Far";case"focus":return"Focus";case"aspect":return"Aspect";case"filmGauge":return"Film Gauge";case"filmOffset":return"Film Offset";case"left":return"Left";case"right":return"Right";case"top":return"Top";case"bottom":return"Bottom"}return s}function ZYe(s,e){function t(){return`${e.name}_camera`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function i(c){localStorage.setItem(t(),c?"open":"closed")}const a=[];if(s.perspectiveCameraInfo!==void 0)for(const c in s.perspectiveCameraInfo)a.push({title:b8e(c),prop:c,type:"number",step:.01,value:s.perspectiveCameraInfo[c],onChange:(u,p)=>{e.updateObject(s.uuid,u,p),e.requestMethod(s.uuid,"updateProjectionMatrix");const y=e.getScene(s.uuid);if(y!==null){const x=y.getObjectByProperty("uuid",s.uuid);x!==void 0&&(Ko(x,u,p),x.updateProjectionMatrix())}}});else if(s.orthographicCameraInfo!==void 0)for(const c in s.orthographicCameraInfo)a.push({title:b8e(c),prop:c,type:"number",step:.01,value:s.orthographicCameraInfo[c],onChange:(u,p)=>{e.updateObject(s.uuid,u,p),e.requestMethod(s.uuid,"updateProjectionMatrix");const y=e.getScene(s.uuid);if(y!==null){const x=y.getObjectByProperty("uuid",s.uuid);x!==void 0&&(Ko(x,u,p),x.updateProjectionMatrix())}}});return Ke.jsx(cd,{three:e,title:"Camera",items:a,expanded:r,onToggle:c=>{i(c)}})}function S8e(s){switch(s){case"color":return"Color";case"intensity":return"Intensity";case"decay":return"Decay";case"distance":return"Distance";case"angle":return"Angle";case"penumbra":return"Penumbra";case"groundColor":return"Ground Color";case"width":return"Width";case"height":return"Height"}return s}function QYe(s,e){function t(){return`${e.name}_light`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function i(c){localStorage.setItem(t(),c?"open":"closed")}const a=[];if(s.lightInfo!==void 0)for(const c in s.lightInfo){const u=s.lightInfo[c];u!==void 0&&(u.isColor!==void 0?a.push({title:S8e(c),prop:c,type:"color",value:u,onChange:(p,y)=>{const x=new Pn(y);e.updateObject(s.uuid,p,x);const S=e.getScene(s.uuid);if(S!==null){const M=S.getObjectByProperty("uuid",s.uuid);Ko(M,p,x)}}}):a.push({title:S8e(c),prop:c,type:typeof u,value:u,step:typeof u=="number"?.01:void 0,onChange:(p,y)=>{e.updateObject(s.uuid,p,y);const x=e.getScene(s.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",s.uuid);Ko(S,p,y)}}}))}return Ke.jsx(cd,{three:e,title:"Light",items:a,expanded:r,onToggle:c=>{i(c)}})}function JYe(s){var S;const e=s.object,t=s.three;function n(){return`${t.name}_animation`}const r=localStorage.getItem(n()),i=r!==null?r==="open":!1;function a(M){localStorage.setItem(n(),M?"open":"closed")}const c=[],u=[];let p=0;e.animations.forEach(M=>{p=Math.max(p,M.duration),M.duration>0&&u.push({title:M.name,items:[{title:"Duration",type:"number",value:M.duration,disabled:!0},{title:"Blend Mode",type:"option",disabled:!0,options:[{title:"Normal",value:2500},{title:"Additive",value:2501}]}]})}),c.push({title:"Animations",items:u});let y;const x=t.getScene(e.uuid);if(x!==null){const M=x.getObjectByProperty("uuid",e.uuid);if(M!==void 0){const I=M.mixer;if(I!==void 0){const B=[{title:"Time Scale",type:"range",value:I.timeScale,step:.01,min:-1,max:2,onChange:(A,V)=>{I.timeScale=V,t.updateObject(e.uuid,"mixer.timeScale",V)}}];B.push({title:"Stop All",type:"button",onChange:()=>{I.stopAllAction(),t.requestMethod(e.uuid,"stopAllAction",void 0,"mixer")}}),c.push({title:"Mixer",items:B}),y=new Rke(M),(S=da.instance)==null||S.scene.add(y)}}}return Tn.useEffect(()=>()=>{y!==void 0&&od(y)},[]),Ke.jsx(cd,{three:s.three,title:"Animation",items:c,expanded:i,onToggle:M=>{a(M)}})}const Ej={name:"",uuid:"",type:"",visible:!1,matrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};function eKe(s){const[e,t]=Tn.useState(Ej);Tn.useEffect(()=>{function a(u){t(u.value)}function c(){t(Ej)}return s.three.addEventListener(li.CLEAR_OBJECT,c),s.three.addEventListener(li.SET_SCENE,c),s.three.addEventListener(li.SET_OBJECT,a),()=>{s.three.removeEventListener(li.CLEAR_OBJECT,c),s.three.removeEventListener(li.SET_SCENE,c),s.three.removeEventListener(li.SET_OBJECT,a)}},[]);const n=e.type.toLowerCase(),r=e.animations.length>0||e.mixer!==void 0,i=n.search("mesh")>-1||n.search("line")>-1||n.search("points")>-1;return Ke.jsx(fE,{three:s.three,label:"Inspector",button:e.uuid.length>0?Ke.jsx("button",{className:"remove",onClick:()=>{Xu.instance.remove(e.name),t(Ej)}}):void 0,children:Ke.jsx("div",{id:"Inspector",className:s.class,children:e.uuid.length>0&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(sk,{type:"string",title:"Name",prop:"name",value:e.name,disabled:!0}),Ke.jsx(sk,{type:"string",title:"Type",prop:"type",value:e.type,disabled:!0}),Ke.jsx(sk,{type:"string",title:"UUID",prop:"uuid",value:e.uuid,disabled:!0})]}),Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(Uk,{object:e,three:s.three}),r?Ke.jsx(JYe,{object:e,three:s.three}):null,n.search("camera")>-1?ZYe(e,s.three):null,n.search("light")>-1?QYe(e,s.three):null,i?IYe(e,s.three):null]})]})})},"Inspector")}class tKe extends Tn.Component{constructor(t){super(t);Xe(this,"autoClear",!0);Xe(this,"autoClearColor",!0);Xe(this,"autoClearDepth",!0);Xe(this,"autoClearStencil",!0);Xe(this,"outputColorSpace",qr);Xe(this,"localClippingEnabled",!1);Xe(this,"clearColor",new Pn(0));Xe(this,"clearAlpha",1);Xe(this,"toneMapping",b1);Xe(this,"toneMappingExposure",1);Xe(this,"type","");Xe(this,"onAddRenderer",t=>{const n=t.value;if(this.autoClear=n.autoClear,this.autoClearColor=n.autoClearColor,this.autoClearDepth=n.autoClearDepth,this.autoClearStencil=n.autoClearStencil,this.outputColorSpace=n.outputColorSpace,this.localClippingEnabled=n.localClippingEnabled,this.clearAlpha=n.clearAlpha,this.type=n.type,this.toneMapping=n.toneMapping,this.toneMappingExposure=n.toneMappingExposure,this.clearColor.setStyle(n.clearColor,Ju),Gr.enabled=n.colorManagement,da.instance){const r=da.instance.renderer;r&&(r.autoClearColor=this.autoClearColor,r.outputColorSpace=this.outputColorSpace,r.localClippingEnabled=this.localClippingEnabled,r.toneMapping=this.toneMapping,r.toneMappingExposure=this.toneMappingExposure,r.setClearColor(n.clearColor,this.clearAlpha))}this.setState({lastUpdated:Date.now()})});const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;if(this.state={expanded:r,lastUpdated:Date.now()},this.saveExpanded(r),da.instance){const i=da.instance.renderer;i&&(this.autoClear=i.autoClear,this.autoClearColor=i.autoClearColor,this.autoClearDepth=i.autoClearDepth,this.autoClearStencil=i.autoClearStencil,this.clearAlpha=i.getClearAlpha(),this.toneMapping=i.toneMapping,this.toneMappingExposure=i.toneMappingExposure,i instanceof hx&&(this.localClippingEnabled=i.localClippingEnabled,i.getClearColor(this.clearColor)))}this.props.three.addEventListener(li.ADD_RENDERER,this.onAddRenderer)}componentwillunmount(){this.props.three.removeEventListener(li.ADD_RENDERER,this.onAddRenderer)}render(){const t=()=>{if(da.instance){const n=da.instance.renderer;n&&(n.autoClearColor=this.autoClearColor,n.outputColorSpace=this.outputColorSpace,n.localClippingEnabled=this.localClippingEnabled,n.toneMapping=this.toneMapping,n.toneMappingExposure=this.toneMappingExposure,n.setClearColor(this.clearColor.getStyle(),this.clearAlpha),this.props.three.updateRenderer({autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,outputColorSpace:this.outputColorSpace,localClippingEnabled:this.localClippingEnabled,clearAlpha:this.clearAlpha,clearColor:this.clearColor.getStyle(),colorManagement:Gr.enabled,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure}))}};return Ke.jsx(cd,{three:this.props.three,title:"Renderer",expanded:this.state.expanded,items:[{type:"boolean",title:"Auto Clear",value:this.autoClear,onChange:(n,r)=>{this.autoClear=r}},{type:"boolean",title:"Auto Clear Color",value:this.autoClearColor,onChange:(n,r)=>{this.autoClearColor=r,t()}},{type:"boolean",title:"Auto Clear Depth",value:this.autoClearDepth,onChange:(n,r)=>{this.autoClearDepth=r,t()}},{type:"boolean",title:"Auto Clear Stencil",value:this.autoClearStencil,onChange:(n,r)=>{this.autoClearStencil=r,t()}},{type:"boolean",title:"Local Clipping",value:this.localClippingEnabled,onChange:(n,r)=>{this.localClippingEnabled=r,t()}},{type:"color",title:"Clear Color",value:`#${this.clearColor.getHexString()}`,onChange:(n,r)=>{this.clearColor.setStyle(r),t()}},{type:"range",title:"Clear Alpha",min:0,max:1,step:.01,value:this.clearAlpha,onChange:(n,r)=>{this.clearAlpha=r,t()}},{type:"boolean",title:"Color Management",value:Gr.enabled,onChange:(n,r)=>{Gr.enabled=r,t()}},{type:"option",title:"Color Space",value:this.outputColorSpace,options:[{title:"No Color Space",value:kf},{title:"SRB Color Space",value:qr},{title:"Linear SRB Color Space",value:Ju}],onChange:(n,r)=>{this.outputColorSpace=r,t()}},{type:"option",title:"Tone Mapping",value:this.toneMapping,options:[{title:"None ",value:b1},{title:"Linear ",value:z8e},{title:"Reinhard",value:V8e},{title:"Cineon ",value:G8e},{title:"ACES Filmic",value:j8e},{title:"AgX",value:W8e},{title:"Neutral",value:$8e},{title:"Custom",value:H8e}],onChange:(n,r)=>{this.toneMapping=r,t()}},{type:"range",title:"Tone Mapping Exposure",value:this.toneMappingExposure,min:0,max:2,step:.01,onChange:(n,r)=>{this.toneMappingExposure=r,t()}},{type:"string",title:"Type",value:this.type,disabled:!0},{type:"button",title:"Resize Scenes from Source",onChange:()=>{this.props.three.requestSize()}}],onToggle:n=>{this.setState({expanded:n}),this.saveExpanded(n)}},Math.random())}saveExpanded(t){localStorage.setItem(this.expandedName,t?"open":"closed")}get expandedName(){return`${this.props.three.name}_renderer`}}function nKe(s){const[e]=Tn.useState([]),[t]=Tn.useState([]),[n,r]=Tn.useState(0),i=p=>{const y=p.value;e.push(y),t.push(Ke.jsx(fE,{three:s.three,label:`Scene: ${y.name}`,scene:y,open:!1,visible:!1,onRefresh:()=>{s.three.refreshScene(y.name)},children:Ke.jsx(wj,{child:y,scene:y,three:s.three})},y.name)),r(Date.now())},a=p=>{const y=p.value;for(let x=0;x<e.length;x++)if(y.uuid===e[x].uuid){e[x]=y,t[x]=Ke.jsx(fE,{three:s.three,label:`Scene: ${y.name}`,scene:y,open:t[x].props.open,visible:t[x].props.visible,onRefresh:()=>{s.three.refreshScene(y.name)},children:Ke.jsx(wj,{child:y,scene:y,three:s.three})},y.name),r(Date.now());return}},c=p=>{const y=p.value;for(let x=0;x<e.length;x++)if(y.uuid===e[x].uuid){e.splice(x,1),t.splice(x,1),r(Date.now());return}},u=p=>{const y=p.value.name;for(let x=0;x<e.length;x++){const S=e[x],M=S.name===y;t[x]=Ke.jsx(fE,{three:s.three,label:`Scene: ${S.name}`,scene:S,open:M,visible:M,onRefresh:()=>{s.three.refreshScene(S.name)},children:Ke.jsx(wj,{child:S,scene:S,three:s.three})},S.name)}r(Date.now())};return Tn.useEffect(()=>(s.three.addEventListener(li.ADD_SCENE,i),s.three.addEventListener(li.SET_SCENE,u),s.three.addEventListener(li.REFRESH_SCENE,a),s.three.addEventListener(li.REMOVE_SCENE,c),()=>{s.three.removeEventListener(li.ADD_SCENE,i),s.three.removeEventListener(li.SET_SCENE,u),s.three.removeEventListener(li.REFRESH_SCENE,a),s.three.removeEventListener(li.REMOVE_SCENE,c)}),[]),Ke.jsxs("div",{id:"SidePanel",children:[Ke.jsx("div",{className:"scenes",children:t},n),Ke.jsx(eKe,{three:s.three}),Ke.jsx(tKe,{three:s.three}),Ke.jsx(j3,{three:s.three})]})}function rKe(s){return Ke.jsx(zFe,{children:Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(da,{three:s.three,scenes:s.scenes,onSceneAdd:s.onSceneAdd,onSceneResize:s.onSceneResize,onSceneUpdate:s.onSceneUpdate}),Ke.jsx(nKe,{three:s.three})]})})}async function iKe(){var n;for(;!document.getElementById("theatrejs-studio-root");)await new Promise(r=>setTimeout(r,100));const s=document.getElementById("theatrejs-studio-root");if(s===null||s.shadowRoot===null)return;const e=s.shadowRoot.getElementById("pointer-root");if(e===null)return;const t=e.children[0];if(t!==null){try{const i=t.children[1].children[1];(n=i.parentElement)==null||n.removeChild(i)}catch{}try{const r=t.children[3];r.style.top="0",r.style.right="300px"}catch{}}}/**
 * postprocessing v6.37.6 build Fri Jul 04 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var Tj=1/1e3,sKe=1e3,oKe=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(s){typeof document<"u"&&document.hidden!==void 0&&(s?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=s)}get delta(){return this._delta*Tj}get fixedDelta(){return this._fixedDelta*Tj}set fixedDelta(s){this._fixedDelta=s*sKe}get elapsed(){return this._elapsed*Tj}update(s){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(s!==void 0?s:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(s){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},aKe=(()=>{const s=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new rs;return t.setAttribute("position",new Qu(s,3)),t.setAttribute("uv",new Qu(e,2)),t})(),ud=class hW{static get fullscreenGeometry(){return aKe}constructor(e="Pass",t=new _E,n=new Hk){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new mn(hW.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new _E),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=FE){}render(e,t,n,r,i){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof bl||t instanceof rh||t instanceof n0||t instanceof hW)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},lKe=class extends ud{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(s,e,t,n,r){const i=s.state.buffers.stencil;i.setLocked(!1),i.setTest(!1)}},cKe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,S7e="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",rq=class extends r0{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new gs(null),opacity:new gs(1)},blending:cc,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:cKe,vertexShader:S7e})}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.uniforms.inputBuffer.value=s}getOpacity(s){return this.uniforms.opacity.value}setOpacity(s){this.uniforms.opacity.value=s}},uKe=class extends ud{constructor(s,e=!0){super("CopyPass"),this.fullscreenMaterial=new rq,this.needsSwap=!1,this.renderTarget=s,s===void 0&&(this.renderTarget=new bl(1,1,{minFilter:e0,magFilter:e0,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(s){this.autoResize=s}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(s){this.autoResize=s}render(s,e,t,n,r){this.fullscreenMaterial.inputBuffer=e.texture,s.setRenderTarget(this.renderToScreen?null:this.renderTarget),s.render(this.scene,this.camera)}setSize(s,e){this.autoResize&&this.renderTarget.setSize(s,e)}initialize(s,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==t0?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":s!==null&&s.outputColorSpace===qr&&(this.renderTarget.texture.colorSpace=qr))}},w8e=new Pn,w7e=class extends ud{constructor(s=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=s,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(s,e,t){this.color=s,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(s){this.overrideClearColor=s}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(s){this.overrideClearAlpha=s}render(s,e,t,n,r){const i=this.overrideClearColor,a=this.overrideClearAlpha,c=s.getClearAlpha(),u=i!==null,p=a>=0;u?(s.getClearColor(w8e),s.setClearColor(i,p?a:c)):p&&s.setClearAlpha(a),s.setRenderTarget(this.renderToScreen?null:e),s.clear(this.color,this.depth,this.stencil),u?s.setClearColor(w8e,c):p&&s.setClearAlpha(c)}},hKe=class extends ud{constructor(s,e){super("MaskPass",s,e),this.needsSwap=!1,this.clearPass=new w7e(!1,!1,!0),this.inverse=!1}set mainScene(s){this.scene=s}set mainCamera(s){this.camera=s}get inverted(){return this.inverse}set inverted(s){this.inverse=s}get clear(){return this.clearPass.enabled}set clear(s){this.clearPass.enabled=s}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(s){this.inverted=s}render(s,e,t,n,r){const i=s.getContext(),a=s.state.buffers,c=this.scene,u=this.camera,p=this.clearPass,y=this.inverted?0:1,x=1-y;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),a.stencil.setFunc(i.ALWAYS,y,4294967295),a.stencil.setClear(x),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(s,null):(p.render(s,e),p.render(s,t))),this.renderToScreen?(s.setRenderTarget(null),s.render(c,u)):(s.setRenderTarget(e),s.render(c,u),s.setRenderTarget(t),s.render(c,u)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(i.EQUAL,1,4294967295),a.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),a.stencil.setLocked(!0)}},dKe=class{constructor(s=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:n=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,r,n),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new uKe,this.depthTexture=null,this.passes=[],this.timer=new oKe,this.autoRenderToScreen=!0,this.setRenderer(s)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(s){const e=this.inputBuffer,t=this.multisampling;t>0&&s>0?(this.inputBuffer.samples=s,this.outputBuffer.samples=s,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==s&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,s),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(s){if(this.renderer=s,s!==null){const e=s.getSize(new An),t=s.getContext().getContextAttributes().alpha,n=this.inputBuffer.texture.type;n===t0&&s.outputColorSpace===qr&&(this.inputBuffer.texture.colorSpace=qr,this.outputBuffer.texture.colorSpace=qr,this.inputBuffer.dispose(),this.outputBuffer.dispose()),s.autoClear=!1,this.setSize(e.width,e.height);for(const r of this.passes)r.initialize(s,t,n)}}replaceRenderer(s,e=!0){const t=this.renderer,n=t.domElement.parentNode;return this.setRenderer(s),e&&n!==null&&(n.removeChild(t.domElement),n.appendChild(s.domElement)),t}createDepthTexture(){const s=this.depthTexture=new GW;return this.inputBuffer.depthTexture=s,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(s.format=Ox,s.type=Dx):s.type=H3,s}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const s of this.passes)s.setDepthTexture(null)}}createBuffer(s,e,t,n){const r=this.renderer,i=r===null?new An:r.getDrawingBufferSize(new An),a={minFilter:e0,magFilter:e0,stencilBuffer:e,depthBuffer:s,type:t},c=new bl(i.width,i.height,a);return n>0&&(c.ignoreDepthForMultisampleCopy=!1,c.samples=n),t===t0&&r!==null&&r.outputColorSpace===qr&&(c.texture.colorSpace=qr),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(s){for(const e of this.passes)e.mainScene=s}setMainCamera(s){for(const e of this.passes)e.mainCamera=s}addPass(s,e){const t=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new An),i=n.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(s.setRenderer(n),s.setSize(r.width,r.height),s.initialize(n,i,a),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),s.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,s):t.push(s),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),s.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(s of t)s.setDepthTexture(c)}else s.setDepthTexture(this.depthTexture)}removePass(s){const e=this.passes,t=e.indexOf(s);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const i=(c,u)=>c||u.needsDepthTexture;e.reduce(i,!1)||(s.getDepthTexture()===this.depthTexture&&s.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(s.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const s=this.passes;this.deleteDepthTexture(),s.length>0&&(this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!1),this.passes=[])}render(s){const e=this.renderer,t=this.copyPass;let n=this.inputBuffer,r=this.outputBuffer,i=!1,a,c,u;s===void 0&&(this.timer.update(),s=this.timer.getDelta());for(const p of this.passes)p.enabled&&(p.render(e,n,r,s,i),p.needsSwap&&(i&&(t.renderToScreen=p.renderToScreen,a=e.getContext(),c=e.state.buffers.stencil,c.setFunc(a.NOTEQUAL,1,4294967295),t.render(e,n,r,s,i),c.setFunc(a.EQUAL,1,4294967295)),u=n,n=r,r=u),p instanceof hKe?i=!0:p instanceof lKe&&(i=!1))}setSize(s,e,t){const n=this.renderer,r=n.getSize(new An);(s===void 0||e===void 0)&&(s=r.width,e=r.height),(r.width!==s||r.height!==e)&&n.setSize(s,e,t);const i=n.getDrawingBufferSize(new An);this.inputBuffer.setSize(i.width,i.height),this.outputBuffer.setSize(i.width,i.height);for(const a of this.passes)a.setSize(i.width,i.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const s of this.passes)s.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),ud.fullscreenGeometry.dispose()}},Sv={NONE:0,DEPTH:1,CONVOLUTION:2},Yi={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},fKe=class{constructor(){this.shaderParts=new Map([[Yi.FRAGMENT_HEAD,null],[Yi.FRAGMENT_MAIN_UV,null],[Yi.FRAGMENT_MAIN_IMAGE,null],[Yi.VERTEX_HEAD,null],[Yi.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Sv.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Ju}},Mj=!1,E8e=class{constructor(s=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(s),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case gl:t=this.materialsFlatShadedDoubleSide;break;case Qo:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case gl:t=this.materialsDoubleSide;break;case Qo:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(s){if(!(s instanceof r0))return s.clone();const e=s.uniforms,t=new Map;for(const r in e){const i=e[r].value;i.isRenderTargetTexture&&(e[r].value=null,t.set(r,i))}const n=s.clone();for(const r of t)e[r[0]].value=r[1],n.uniforms[r[0]].value=r[1];return n}setMaterial(s){if(this.disposeMaterials(),this.material=s,s!==null){const e=this.materials=[this.cloneMaterial(s),this.cloneMaterial(s),this.cloneMaterial(s)];for(const t of e)t.uniforms=Object.assign({},s.uniforms),t.side=E1;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.side=Qo,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.side=gl,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.flatShading=!0,n.side=Qo,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.flatShading=!0,n.side=gl,n})}}render(s,e,t){const n=s.shadowMap.enabled;if(s.shadowMap.enabled=!1,Mj){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),s.render(e,t);for(const i of r)i[0].material=i[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,s.render(e,t),e.overrideMaterial=r}s.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const s=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of s)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Mj}static set workaroundEnabled(s){Mj=s}},P3=-1,_1=class extends nh{constructor(s,e=P3,t=P3,n=1){super(),this.resizable=s,this.baseSize=new An(1,1),this.preferredSize=new An(e,t),this.target=this.preferredSize,this.s=n,this.effectiveSize=new An,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const s=this.baseSize,e=this.preferredSize,t=this.effectiveSize,n=this.scale;e.width!==P3?t.width=e.width:e.height!==P3?t.width=Math.round(e.height*(s.width/Math.max(s.height,1))):t.width=Math.round(s.width*n),e.height!==P3?t.height=e.height:e.width!==P3?t.height=Math.round(e.width/Math.max(s.width/Math.max(s.height,1),1)):t.height=Math.round(s.height*n)}get width(){return this.effectiveSize.width}set width(s){this.preferredWidth=s}get height(){return this.effectiveSize.height}set height(s){this.preferredHeight=s}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(s){this.s!==s&&(this.s=s,this.preferredSize.setScalar(P3),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(s){this.scale=s}get baseWidth(){return this.baseSize.width}set baseWidth(s){this.baseSize.width!==s&&(this.baseSize.width=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(s){this.baseWidth=s}get baseHeight(){return this.baseSize.height}set baseHeight(s){this.baseSize.height!==s&&(this.baseSize.height=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(s){this.baseHeight=s}setBaseSize(s,e){(this.baseSize.width!==s||this.baseSize.height!==e)&&(this.baseSize.set(s,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(s){this.preferredSize.width!==s&&(this.preferredSize.width=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(s){this.preferredWidth=s}get preferredHeight(){return this.preferredSize.height}set preferredHeight(s){this.preferredSize.height!==s&&(this.preferredSize.height=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(s){this.preferredHeight=s}setPreferredSize(s,e){(this.preferredSize.width!==s||this.preferredSize.height!==e)&&(this.preferredSize.set(s,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(s){this.s=s.scale,this.baseSize.set(s.baseWidth,s.baseHeight),this.preferredSize.set(s.preferredWidth,s.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return P3}},Ei={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},pKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),opacity);}",mKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",gKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),opacity);}",vKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",yKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),opacity);}",xKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),opacity);}",_Ke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),opacity);}",bKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),opacity);}",SKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),opacity);}",wKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),opacity);}",EKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),opacity);}",TKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),opacity);}",MKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),opacity);}",CKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),opacity);}",AKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),opacity);}",PKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),opacity);}",RKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",IKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),opacity);}",kKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",NKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),opacity);}",DKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),opacity);}",OKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),opacity);}",LKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",FKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),opacity);}",BKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),opacity);}",UKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),opacity);}",zKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",VKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),opacity);}",GKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),opacity);}",jKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",HKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),opacity);}",WKe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),opacity);}",$Ke=new Map([[Ei.ADD,pKe],[Ei.ALPHA,mKe],[Ei.AVERAGE,gKe],[Ei.COLOR,vKe],[Ei.COLOR_BURN,yKe],[Ei.COLOR_DODGE,xKe],[Ei.DARKEN,_Ke],[Ei.DIFFERENCE,bKe],[Ei.DIVIDE,SKe],[Ei.DST,null],[Ei.EXCLUSION,wKe],[Ei.HARD_LIGHT,EKe],[Ei.HARD_MIX,TKe],[Ei.HUE,MKe],[Ei.INVERT,CKe],[Ei.INVERT_RGB,AKe],[Ei.LIGHTEN,PKe],[Ei.LINEAR_BURN,RKe],[Ei.LINEAR_DODGE,IKe],[Ei.LINEAR_LIGHT,kKe],[Ei.LUMINOSITY,NKe],[Ei.MULTIPLY,DKe],[Ei.NEGATION,OKe],[Ei.NORMAL,LKe],[Ei.OVERLAY,FKe],[Ei.PIN_LIGHT,BKe],[Ei.REFLECT,UKe],[Ei.SATURATION,zKe],[Ei.SCREEN,VKe],[Ei.SOFT_LIGHT,GKe],[Ei.SRC,jKe],[Ei.SUBTRACT,HKe],[Ei.VIVID_LIGHT,WKe]]),qKe=class extends nh{constructor(s,e=1){super(),this._blendFunction=s,this.opacity=new gs(e)}getOpacity(){return this.opacity.value}setOpacity(s){this.opacity.value=s}get blendFunction(){return this._blendFunction}set blendFunction(s){this._blendFunction=s,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(s){this.blendFunction=s}getShaderCode(){return $Ke.get(this.blendFunction)}},iq=class extends nh{constructor(s,e,{attributes:t=Sv.NONE,blendFunction:n=Ei.NORMAL,defines:r=new Map,uniforms:i=new Map,extensions:a=null,vertexShader:c=null}={}){super(),this.name=s,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=c,this.defines=r,this.uniforms=i,this.extensions=a,this.blendMode=new qKe(n),this.blendMode.addEventListener("change",u=>this.setChanged()),this._inputColorSpace=Ju,this._outputColorSpace=kf}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(s){this._inputColorSpace=s,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(s){this._outputColorSpace=s,this.setChanged()}set mainScene(s){}set mainCamera(s){}getName(){return this.name}setRenderer(s){this.renderer=s}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(s){this.attributes=s,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(s){this.fragmentShader=s,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(s){this.vertexShader=s,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(s,e=FE){}update(s,e,t){}setSize(s,e){}initialize(s,e,t){}dispose(){for(const s of Object.keys(this)){const e=this[s];(e instanceof bl||e instanceof rh||e instanceof n0||e instanceof ud)&&this[s].dispose()}}},sq={MEDIUM:2,LARGE:3},XKe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,YKe="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",KKe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],ZKe=class extends r0{constructor(s=new xi){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new gs(null),texelSize:new gs(new xi),scale:new gs(1),kernel:new gs(0)},blending:cc,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:XKe,vertexShader:YKe}),this.setTexelSize(s.x,s.y),this.kernelSize=sq.MEDIUM}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.inputBuffer=s}get kernelSequence(){return KKe[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(s){this.uniforms.scale.value=s}getScale(){return this.uniforms.scale.value}setScale(s){this.uniforms.scale.value=s}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(s){this.uniforms.kernel.value=s}setKernel(s){this.kernel=s}setTexelSize(s,e){this.uniforms.texelSize.value.set(s,e,s*.5,e*.5)}setSize(s,e){const t=1/s,n=1/e;this.uniforms.texelSize.value.set(t,n,t*.5,n*.5)}},QKe=class extends ud{constructor({kernelSize:s=sq.MEDIUM,resolutionScale:e=.5,width:t=_1.AUTO_SIZE,height:n=_1.AUTO_SIZE,resolutionX:r=t,resolutionY:i=n}={}){super("KawaseBlurPass"),this.renderTargetA=new bl(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const a=this.resolution=new _1(this,r,i,e);a.addEventListener("change",c=>this.setSize(a.baseWidth,a.baseHeight)),this._blurMaterial=new ZKe,this._blurMaterial.kernelSize=s,this.copyMaterial=new rq}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(s){this._blurMaterial=s}get dithering(){return this.copyMaterial.dithering}set dithering(s){this.copyMaterial.dithering=s}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(s){this.blurMaterial.kernelSize=s}get width(){return this.resolution.width}set width(s){this.resolution.preferredWidth=s}get height(){return this.resolution.height}set height(s){this.resolution.preferredHeight=s}get scale(){return this.blurMaterial.scale}set scale(s){this.blurMaterial.scale=s}getScale(){return this.blurMaterial.scale}setScale(s){this.blurMaterial.scale=s}getKernelSize(){return this.kernelSize}setKernelSize(s){this.kernelSize=s}getResolutionScale(){return this.resolution.scale}setResolutionScale(s){this.resolution.scale=s}render(s,e,t,n,r){const i=this.scene,a=this.camera,c=this.renderTargetA,u=this.renderTargetB,p=this.blurMaterial,y=p.kernelSequence;let x=e;this.fullscreenMaterial=p;for(let S=0,M=y.length;S<M;++S){const I=(S&1)===0?c:u;p.kernel=y[S],p.inputBuffer=x.texture,s.setRenderTarget(I),s.render(i,a),x=I}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=x.texture,s.setRenderTarget(this.renderToScreen?null:t),s.render(i,a)}setSize(s,e){const t=this.resolution;t.setBaseSize(s,e);const n=t.width,r=t.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(s,e)}initialize(s,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==t0?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):s!==null&&s.outputColorSpace===qr&&(this.renderTargetA.texture.colorSpace=qr,this.renderTargetB.texture.colorSpace=qr))}static get AUTO_SIZE(){return _1.AUTO_SIZE}},JKe=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,eZe=class extends r0{constructor(s=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:LE.replace(/\D+/g,"")},uniforms:{inputBuffer:new gs(null),threshold:new gs(0),smoothing:new gs(1),range:new gs(null)},blending:cc,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:JKe,vertexShader:S7e}),this.colorOutput=s,this.luminanceRange=e}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.uniforms.inputBuffer.value=s}get threshold(){return this.uniforms.threshold.value}set threshold(s){this.smoothing>0||s>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=s}getThreshold(){return this.threshold}setThreshold(s){this.threshold=s}get smoothing(){return this.uniforms.smoothing.value}set smoothing(s){this.threshold>0||s>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=s}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(s){this.smoothing=s}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(s){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(s){s?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(s){return this.colorOutput}setColorOutputEnabled(s){this.colorOutput=s}get useRange(){return this.luminanceRange!==null}set useRange(s){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(s){s!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=s,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(s){this.luminanceRange=s}},tZe=class extends ud{constructor({renderTarget:s,luminanceRange:e,colorOutput:t,resolutionScale:n=1,width:r=_1.AUTO_SIZE,height:i=_1.AUTO_SIZE,resolutionX:a=r,resolutionY:c=i}={}){super("LuminancePass"),this.fullscreenMaterial=new eZe(t,e),this.needsSwap=!1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new bl(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const u=this.resolution=new _1(this,a,c,n);u.addEventListener("change",p=>this.setSize(u.baseWidth,u.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(s,e,t,n,r){const i=this.fullscreenMaterial;i.inputBuffer=e.texture,s.setRenderTarget(this.renderToScreen?null:this.renderTarget),s.render(this.scene,this.camera)}setSize(s,e){const t=this.resolution;t.setBaseSize(s,e),this.renderTarget.setSize(t.width,t.height)}initialize(s,e,t){t!==void 0&&t!==t0&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},nZe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,rZe="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",iZe=class extends r0{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new gs(null),texelSize:new gs(new An)},blending:cc,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:nZe,vertexShader:rZe})}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setSize(s,e){this.uniforms.texelSize.value.set(1/s,1/e)}},sZe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,oZe="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",aZe=class extends r0{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new gs(null),supportBuffer:new gs(null),texelSize:new gs(new An),radius:new gs(.85)},blending:cc,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:sZe,vertexShader:oZe})}set inputBuffer(s){this.uniforms.inputBuffer.value=s}set supportBuffer(s){this.uniforms.supportBuffer.value=s}get radius(){return this.uniforms.radius.value}set radius(s){this.uniforms.radius.value=s}setSize(s,e){this.uniforms.texelSize.value.set(1/s,1/e)}},lZe=class extends ud{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new bl(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new iZe,this.upsamplingMaterial=new aZe,this.resolution=new An}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(s){if(this.levels!==s){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<s;++t){const n=e.clone();n.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(n)}this.upsamplingMipmaps.push(e);for(let t=1,n=s-1;t<n;++t){const r=e.clone();r.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(r)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(s){this.upsamplingMaterial.radius=s}render(s,e,t,n,r){const{scene:i,camera:a}=this,{downsamplingMaterial:c,upsamplingMaterial:u}=this,{downsamplingMipmaps:p,upsamplingMipmaps:y}=this;let x=e;this.fullscreenMaterial=c;for(let S=0,M=p.length;S<M;++S){const I=p[S];c.setSize(x.width,x.height),c.inputBuffer=x.texture,s.setRenderTarget(I),s.render(i,a),x=I}this.fullscreenMaterial=u;for(let S=y.length-1;S>=0;--S){const M=y[S];u.setSize(x.width,x.height),u.inputBuffer=x.texture,u.supportBuffer=p[S].texture,s.setRenderTarget(M),s.render(i,a),x=M}}setSize(s,e){const t=this.resolution;t.set(s,e);let n=t.width,r=t.height;for(let i=0,a=this.downsamplingMipmaps.length;i<a;++i)n=Math.round(n*.5),r=Math.round(r*.5),this.downsamplingMipmaps[i].setSize(n,r),i<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[i].setSize(n,r)}initialize(s,e,t){if(t!==void 0){const n=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const r of n)r.texture.type=t;if(t!==t0)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(s!==null&&s.outputColorSpace===qr)for(const r of n)r.texture.colorSpace=qr}}dispose(){super.dispose();for(const s of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))s.dispose()}},cZe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,uZe=class extends iq{constructor({blendFunction:s=Ei.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:n=!0,intensity:r=1,radius:i=.85,levels:a=8,kernelSize:c=sq.LARGE,resolutionScale:u=.5,width:p=_1.AUTO_SIZE,height:y=_1.AUTO_SIZE,resolutionX:x=p,resolutionY:S=y}={}){super("BloomEffect",cZe,{blendFunction:s,uniforms:new Map([["map",new gs(null)],["intensity",new gs(r)]])}),this.renderTarget=new bl(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new QKe({kernelSize:c}),this.luminancePass=new tZe({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new lZe,this.mipmapBlurPass.enabled=n,this.mipmapBlurPass.radius=i,this.mipmapBlurPass.levels=a,this.uniforms.get("map").value=n?this.mipmapBlurPass.texture:this.renderTarget.texture;const M=this.resolution=new _1(this,x,S,u);M.addEventListener("change",I=>this.setSize(M.baseWidth,M.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(s){this.resolution.preferredWidth=s}get height(){return this.resolution.height}set height(s){this.resolution.preferredHeight=s}get dithering(){return this.blurPass.dithering}set dithering(s){this.blurPass.dithering=s}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(s){this.blurPass.kernelSize=s}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(s){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(s){this.uniforms.get("intensity").value=s}getIntensity(){return this.intensity}setIntensity(s){this.intensity=s}getResolutionScale(){return this.resolution.scale}setResolutionScale(s){this.resolution.scale=s}update(s,e,t){const n=this.renderTarget,r=this.luminancePass;r.enabled?(r.render(s,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(s,r.renderTarget):this.blurPass.render(s,r.renderTarget,n)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(s,e):this.blurPass.render(s,e,n)}setSize(s,e){const t=this.resolution;t.setBaseSize(s,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(s,e),this.mipmapBlurPass.setSize(s,e)}initialize(s,e,t){this.blurPass.initialize(s,e,t),this.luminancePass.initialize(s,e,t),this.mipmapBlurPass.initialize(s,e,t),t!==void 0&&(this.renderTarget.texture.type=t,s!==null&&s.outputColorSpace===qr&&(this.renderTarget.texture.colorSpace=qr))}},hZe=class extends ud{constructor(s,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=s,this.input=e}setInput(s){this.input=s}render(s,e,t,n,r){const i=this.fullscreenMaterial.uniforms;e!==null&&i!==void 0&&i[this.input]!==void 0&&(i[this.input].value=e.texture),s.setRenderTarget(this.renderToScreen?null:t),s.render(this.scene,this.camera)}initialize(s,e,t){t!==void 0&&t!==t0&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},dZe=`#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))
#define ONE_OVER_TWELVE 0.08333333333333333
varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;vec4 fxaa(const in vec4 inputColor,const in vec2 uv){float lumaCenter=luminance(inputColor.rgb);float lumaDown=luminance(texture2D(inputBuffer,vUvDown).rgb);float lumaUp=luminance(texture2D(inputBuffer,vUvUp).rgb);float lumaLeft=luminance(texture2D(inputBuffer,vUvLeft).rgb);float lumaRight=luminance(texture2D(inputBuffer,vUvRight).rgb);float lumaMin=min(lumaCenter,min(min(lumaDown,lumaUp),min(lumaLeft,lumaRight)));float lumaMax=max(lumaCenter,max(max(lumaDown,lumaUp),max(lumaLeft,lumaRight)));float lumaRange=lumaMax-lumaMin;if(lumaRange<max(EDGE_THRESHOLD_MIN,lumaMax*EDGE_THRESHOLD_MAX)){return inputColor;}float lumaDownLeft=luminance(texture2D(inputBuffer,vUvDownLeft).rgb);float lumaUpRight=luminance(texture2D(inputBuffer,vUvUpRight).rgb);float lumaUpLeft=luminance(texture2D(inputBuffer,vUvUpLeft).rgb);float lumaDownRight=luminance(texture2D(inputBuffer,vUvDownRight).rgb);float lumaDownUp=lumaDown+lumaUp;float lumaLeftRight=lumaLeft+lumaRight;float lumaLeftCorners=lumaDownLeft+lumaUpLeft;float lumaDownCorners=lumaDownLeft+lumaDownRight;float lumaRightCorners=lumaDownRight+lumaUpRight;float lumaUpCorners=lumaUpRight+lumaUpLeft;float edgeHorizontal=(abs(-2.0*lumaLeft+lumaLeftCorners)+abs(-2.0*lumaCenter+lumaDownUp)*2.0+abs(-2.0*lumaRight+lumaRightCorners));float edgeVertical=(abs(-2.0*lumaUp+lumaUpCorners)+abs(-2.0*lumaCenter+lumaLeftRight)*2.0+abs(-2.0*lumaDown+lumaDownCorners));bool isHorizontal=(edgeHorizontal>=edgeVertical);float stepLength=isHorizontal?texelSize.y:texelSize.x;float luma1=isHorizontal?lumaDown:lumaLeft;float luma2=isHorizontal?lumaUp:lumaRight;float gradient1=abs(luma1-lumaCenter);float gradient2=abs(luma2-lumaCenter);bool is1Steepest=gradient1>=gradient2;float gradientScaled=0.25*max(gradient1,gradient2);float lumaLocalAverage=0.0;if(is1Steepest){stepLength=-stepLength;lumaLocalAverage=0.5*(luma1+lumaCenter);}else{lumaLocalAverage=0.5*(luma2+lumaCenter);}vec2 currentUv=uv;if(isHorizontal){currentUv.y+=stepLength*0.5;}else{currentUv.x+=stepLength*0.5;}vec2 offset=isHorizontal?vec2(texelSize.x,0.0):vec2(0.0,texelSize.y);vec2 uv1=currentUv-offset*QUALITY(0);vec2 uv2=currentUv+offset*QUALITY(0);float lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);float lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd1-=lumaLocalAverage;lumaEnd2-=lumaLocalAverage;bool reached1=abs(lumaEnd1)>=gradientScaled;bool reached2=abs(lumaEnd2)>=gradientScaled;bool reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(1);}if(!reached2){uv2+=offset*QUALITY(1);}if(!reachedBoth){for(int i=2;i<SAMPLES;++i){if(!reached1){lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);lumaEnd1=lumaEnd1-lumaLocalAverage;}if(!reached2){lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd2=lumaEnd2-lumaLocalAverage;}reached1=abs(lumaEnd1)>=gradientScaled;reached2=abs(lumaEnd2)>=gradientScaled;reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(i);}if(!reached2){uv2+=offset*QUALITY(i);}if(reachedBoth){break;}}}float distance1=isHorizontal?(uv.x-uv1.x):(uv.y-uv1.y);float distance2=isHorizontal?(uv2.x-uv.x):(uv2.y-uv.y);bool isDirection1=distance1<distance2;float distanceFinal=min(distance1,distance2);float edgeThickness=(distance1+distance2);bool isLumaCenterSmaller=lumaCenter<lumaLocalAverage;bool correctVariation1=(lumaEnd1<0.0)!=isLumaCenterSmaller;bool correctVariation2=(lumaEnd2<0.0)!=isLumaCenterSmaller;bool correctVariation=isDirection1?correctVariation1:correctVariation2;float pixelOffset=-distanceFinal/edgeThickness+0.5;float finalOffset=correctVariation?pixelOffset:0.0;float lumaAverage=ONE_OVER_TWELVE*(2.0*(lumaDownUp+lumaLeftRight)+lumaLeftCorners+lumaRightCorners);float subPixelOffset1=clamp(abs(lumaAverage-lumaCenter)/lumaRange,0.0,1.0);float subPixelOffset2=(-2.0*subPixelOffset1+3.0)*subPixelOffset1*subPixelOffset1;float subPixelOffsetFinal=subPixelOffset2*subPixelOffset2*SUBPIXEL_QUALITY;finalOffset=max(finalOffset,subPixelOffsetFinal);vec2 finalUv=uv;if(isHorizontal){finalUv.y+=finalOffset*stepLength;}else{finalUv.x+=finalOffset*stepLength;}return texture2D(inputBuffer,finalUv);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=fxaa(inputColor,uv);}`,fZe="varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;void mainSupport(const in vec2 uv){vUvDown=uv+vec2(0.0,-1.0)*texelSize;vUvUp=uv+vec2(0.0,1.0)*texelSize;vUvRight=uv+vec2(1.0,0.0)*texelSize;vUvLeft=uv+vec2(-1.0,0.0)*texelSize;vUvDownLeft=uv+vec2(-1.0,-1.0)*texelSize;vUvUpRight=uv+vec2(1.0,1.0)*texelSize;vUvUpLeft=uv+vec2(-1.0,1.0)*texelSize;vUvDownRight=uv+vec2(1.0,-1.0)*texelSize;}",pZe=class extends iq{constructor({blendFunction:s=Ei.SRC}={}){super("FXAAEffect",dZe,{vertexShader:fZe,blendFunction:s,defines:new Map([["EDGE_THRESHOLD_MIN","0.0312"],["EDGE_THRESHOLD_MAX","0.125"],["SUBPIXEL_QUALITY","0.75"],["SAMPLES","12"]])})}get minEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MIN"))}set minEdgeThreshold(s){this.defines.set("EDGE_THRESHOLD_MIN",s.toFixed(12)),this.setChanged()}get maxEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MAX"))}set maxEdgeThreshold(s){this.defines.set("EDGE_THRESHOLD_MAX",s.toFixed(12)),this.setChanged()}get subpixelQuality(){return Number(this.defines.get("SUBPIXEL_QUALITY"))}set subpixelQuality(s){this.defines.set("SUBPIXEL_QUALITY",s.toFixed(12)),this.setChanged()}get samples(){return Number(this.defines.get("SAMPLES"))}set samples(s){this.defines.set("SAMPLES",s.toFixed(0)),this.setChanged()}},mZe=class extends ud{constructor(s,e,t=null){super("RenderPass",s,e),this.needsSwap=!1,this.clearPass=new w7e,this.overrideMaterialManager=t===null?null:new E8e(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(s){this.scene=s}set mainCamera(s){this.camera=s}get renderToScreen(){return super.renderToScreen}set renderToScreen(s){super.renderToScreen=s,this.clearPass.renderToScreen=s}get overrideMaterial(){const s=this.overrideMaterialManager;return s!==null?s.material:null}set overrideMaterial(s){const e=this.overrideMaterialManager;s!==null?e!==null?e.setMaterial(s):this.overrideMaterialManager=new E8e(s):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(s){this.overrideMaterial=s}get clear(){return this.clearPass.enabled}set clear(s){this.clearPass.enabled=s}getSelection(){return this.selection}setSelection(s){this.selection=s}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(s){this.ignoreBackground=s}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(s){this.skipShadowMapUpdate=s}getClearPass(){return this.clearPass}render(s,e,t,n,r){const i=this.scene,a=this.camera,c=this.selection,u=a.layers.mask,p=i.background,y=s.shadowMap.autoUpdate,x=this.renderToScreen?null:e;c!==null&&a.layers.set(c.getLayer()),this.skipShadowMapUpdate&&(s.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(i.background=null),this.clearPass.enabled&&this.clearPass.render(s,e),s.setRenderTarget(x),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(s,i,a):s.render(i,a),a.layers.mask=u,i.background=p,s.shadowMap.autoUpdate=y}},Vw={DEFAULT:0,ESKIL:1},gZe=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,vZe=class extends iq{constructor({blendFunction:s,eskil:e=!1,technique:t=e?Vw.ESKIL:Vw.DEFAULT,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",gZe,{blendFunction:s,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new gs(n)],["darkness",new gs(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(s){this.technique!==s&&(this.defines.set("VIGNETTE_TECHNIQUE",s.toFixed(0)),this.setChanged())}get eskil(){return this.technique===Vw.ESKIL}set eskil(s){this.technique=s?Vw.ESKIL:Vw.DEFAULT}getTechnique(){return this.technique}setTechnique(s){this.technique=s}get offset(){return this.uniforms.get("offset").value}set offset(s){this.uniforms.get("offset").value=s}getOffset(){return this.offset}setOffset(s){this.offset=s}get darkness(){return this.uniforms.get("darkness").value}set darkness(s){this.uniforms.get("darkness").value=s}getDarkness(){return this.darkness}setDarkness(s){this.darkness=s}},yZe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,xZe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",_Ze=class extends r0{constructor(s,e,t,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:LE.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new gs(null),depthBuffer:new gs(null),resolution:new gs(new An),texelSize:new gs(new An),cameraNear:new gs(.3),cameraFar:new gs(1e3),aspect:new gs(1),time:new gs(0)},blending:cc,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),s&&this.setShaderParts(s),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.uniforms.inputBuffer.value=s}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(s){this.uniforms.depthBuffer.value=s}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(s){this.defines.DEPTH_PACKING=s.toFixed(0),this.needsUpdate=!0}setDepthBuffer(s,e=FE){this.depthBuffer=s,this.depthPacking=e}setShaderData(s){this.setShaderParts(s.shaderParts),this.setDefines(s.defines),this.setUniforms(s.uniforms),this.setExtensions(s.extensions)}setShaderParts(s){return this.fragmentShader=yZe.replace(Yi.FRAGMENT_HEAD,s.get(Yi.FRAGMENT_HEAD)||"").replace(Yi.FRAGMENT_MAIN_UV,s.get(Yi.FRAGMENT_MAIN_UV)||"").replace(Yi.FRAGMENT_MAIN_IMAGE,s.get(Yi.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=xZe.replace(Yi.VERTEX_HEAD,s.get(Yi.VERTEX_HEAD)||"").replace(Yi.VERTEX_MAIN_SUPPORT,s.get(Yi.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(s){for(const e of s.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(s){for(const e of s.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(s){this.extensions={};for(const e of s)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(s){this.encodeOutput!==s&&(s?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(s){return this.encodeOutput}setOutputEncodingEnabled(s){this.encodeOutput=s}get time(){return this.uniforms.time.value}set time(s){this.uniforms.time.value=s}setDeltaTime(s){this.uniforms.time.value+=s}adoptCameraSettings(s){this.copyCameraSettings(s)}copyCameraSettings(s){s&&(this.uniforms.cameraNear.value=s.near,this.uniforms.cameraFar.value=s.far,s instanceof Ja?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(s,e){const t=this.uniforms;t.resolution.value.set(s,e),t.texelSize.value.set(1/s,1/e),t.aspect.value=s/e}static get Section(){return Yi}};function T8e(s,e,t){for(const n of e){const r="$1"+s+n.charAt(0).toUpperCase()+n.slice(1),i=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(i,r))}}function bZe(s,e,t){let n=e.getFragmentShader(),r=e.getVertexShader();const i=n!==void 0&&/mainImage/.test(n),a=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&(t.attributes&Sv.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!i&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const c=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,u=t.shaderParts;let p=u.get(Yi.FRAGMENT_HEAD)||"",y=u.get(Yi.FRAGMENT_MAIN_UV)||"",x=u.get(Yi.FRAGMENT_MAIN_IMAGE)||"",S=u.get(Yi.VERTEX_HEAD)||"",M=u.get(Yi.VERTEX_MAIN_SUPPORT)||"";const I=new Set,L=new Set;if(a&&(y+=`	${s}MainUv(UV);
`,t.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const V=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);M+=`	${s}MainSupport(`,M+=V?`vUv);
`:`);
`;for(const X of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const P of X[1].split(/\s*,\s*/))t.varyings.add(P),I.add(P),L.add(P);for(const X of r.matchAll(c))L.add(X[1])}for(const V of n.matchAll(c))L.add(V[1]);for(const V of e.defines.keys())L.add(V.replace(/\([\w\s,]*\)/g,""));for(const V of e.uniforms.keys())L.add(V);L.delete("while"),L.delete("for"),L.delete("if"),e.uniforms.forEach((V,X)=>t.uniforms.set(s+X.charAt(0).toUpperCase()+X.slice(1),V)),e.defines.forEach((V,X)=>t.defines.set(s+X.charAt(0).toUpperCase()+X.slice(1),V));const B=new Map([["fragment",n],["vertex",r]]);T8e(s,L,t.defines),T8e(s,L,B),n=B.get("fragment"),r=B.get("vertex");const A=e.blendMode;if(t.blendModes.set(A.blendFunction,A),i){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(x+=e.inputColorSpace===qr?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==kf?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const V=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;x+=`${s}MainImage(color0, UV, `,(t.attributes&Sv.DEPTH)!==0&&V.test(n)&&(x+="depth, ",t.readDepth=!0),x+=`color1);
	`;const X=s+"BlendOpacity";t.uniforms.set(X,A.opacity),x+=`color0 = blend${A.blendFunction}(color0, color1, ${X});

	`,p+=`uniform float ${X};

`}if(p+=n+`
`,r!==null&&(S+=r+`
`),u.set(Yi.FRAGMENT_HEAD,p),u.set(Yi.FRAGMENT_MAIN_UV,y),u.set(Yi.FRAGMENT_MAIN_IMAGE,x),u.set(Yi.VERTEX_HEAD,S),u.set(Yi.VERTEX_MAIN_SUPPORT,M),e.extensions!==null)for(const V of e.extensions)t.extensions.add(V)}}var SZe=class extends ud{constructor(s,...e){super("EffectPass"),this.fullscreenMaterial=new _Ze(null,null,null,s),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(s){for(const e of this.effects)e.mainScene=s}set mainCamera(s){this.fullscreenMaterial.copyCameraSettings(s);for(const e of this.effects)e.mainCamera=s}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(s){this.fullscreenMaterial.encodeOutput=s}get dithering(){return this.fullscreenMaterial.dithering}set dithering(s){const e=this.fullscreenMaterial;e.dithering=s,e.needsUpdate=!0}setEffects(s){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=s.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const s=new fKe;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===Ei.DST)s.attributes|=a.getAttributes()&Sv.DEPTH;else{if((s.attributes&a.getAttributes()&Sv.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${a.name})`);bZe("e"+e++,a,s)}let t=s.shaderParts.get(Yi.FRAGMENT_HEAD),n=s.shaderParts.get(Yi.FRAGMENT_MAIN_IMAGE),r=s.shaderParts.get(Yi.FRAGMENT_MAIN_UV);const i=/\bblend\b/g;for(const a of s.blendModes.values())t+=a.getShaderCode().replace(i,`blend${a.blendFunction}`)+`
`;(s.attributes&Sv.DEPTH)!==0?(s.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,s.colorSpace===qr&&(n+=`color0 = sRGBToLinear(color0);
	`),s.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,s.defines.set("UV","transformedUv")):s.defines.set("UV","vUv"),s.shaderParts.set(Yi.FRAGMENT_HEAD,t),s.shaderParts.set(Yi.FRAGMENT_MAIN_IMAGE,n),s.shaderParts.set(Yi.FRAGMENT_MAIN_UV,r);for(const[a,c]of s.shaderParts)c!==null&&s.shaderParts.set(a,c.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(s)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(s,e=FE){this.fullscreenMaterial.depthBuffer=s,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(s,e)}render(s,e,t,n,r){for(const i of this.effects)i.update(s,e,n);if(!this.skipRendering||this.renderToScreen){const i=this.fullscreenMaterial;i.inputBuffer=e.texture,i.time+=n*this.timeScale,s.setRenderTarget(this.renderToScreen?null:t),s.render(this.scene,this.camera)}}setSize(s,e){this.fullscreenMaterial.setSize(s,e);for(const t of this.effects)t.setSize(s,e)}initialize(s,e,t){this.renderer=s;for(const n of this.effects)n.initialize(s,e,t);this.updateMaterial(),t!==void 0&&t!==t0&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const s of this.effects)s.removeEventListener("change",this.listener),s.dispose()}handleEvent(s){switch(s.type){case"change":this.recompile();break}}};const wZe=`varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,EZe=`struct Light {
  float intensity;
  vec3 position;
  vec3 color;
};

uniform float time;
uniform float opacity;
uniform vec2 resolution;
uniform vec3 diffuse;
uniform vec3 mouse;
uniform sampler2D map;
uniform Light light;
uniform Light lights[3];
varying vec2 vUv;

#define MIN_ALPHA 2.0 / 255.0

void main() {
  if (opacity < MIN_ALPHA) discard;
  vec2 imageUV = vUv * 10.0;
  vec3 image = texture2D(map, imageUV).rgb;
  vec3 col = image * diffuse;
  col += (sin(time * 0.1) * 0.5 + 0.5) * 0.2;
  col += vec3(resolution, 0.0);
  col += mouse;
  gl_FragColor = vec4(col, opacity);
}`,TZe="data:image/png;base64,R0lGODlhCAAIAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OTc3NywgMjAyMy8wNi8yNS0yMzo1NzoxNCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjVENjQyODM4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjVENjQyODQ4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2NUQ2NDI4MThBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2NUQ2NDI4MjhBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAAAAAAALAAAAAAIAAgAAAIOjH8AprzRkHyspqSoNAUAOw==";class E7e extends r0{constructor(){super({vertexShader:wZe,fragmentShader:EZe,name:"ExampleScene/SimpleShader",transparent:!0,uniforms:{diffuse:{value:new Pn(16777215)},opacity:{value:1},time:{value:0},map:{value:null},resolution:{value:new An},mouse:{value:new Ae},v4:{value:new xi},euler:{value:new ua},testM3:{value:new si},testM4:{value:new or},light:{value:{position:new An(5,10),intensity:1,color:new Pn(16711935)}},lights:{value:[{position:new An(1,1),intensity:1,color:new Pn(16711680)},{position:new An(2,2),intensity:2,color:new Pn(65280)},{position:new An(3,3),intensity:3,color:new Pn(255)}]}}}),e$(TZe).then(e=>{this.uniforms.map.value=e})}update(e){this.uniforms.opacity.value=this.opacity,this.uniforms.time.value+=e}}function MZe(s){const e=new Map,t=new Map,n=s.clone();return T7e(s,n,function(r,i){e.set(i,r),t.set(r,i)}),n.traverse(function(r){if(!r.isSkinnedMesh)return;const i=r,a=e.get(r),c=a.skeleton.bones;i.skeleton=a.skeleton.clone(),i.bindMatrix.copy(a.bindMatrix),i.skeleton.bones=c.map(function(u){return t.get(u)}),i.bind(i.skeleton,i.bindMatrix)}),n}function T7e(s,e,t){t(s,e);for(let n=0;n<s.children.length;n++)T7e(s.children[n],e.children[n],t)}/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var Jh=Uint8Array,yx=Uint16Array,CZe=Int32Array,M7e=new Jh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),C7e=new Jh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),AZe=new Jh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),A7e=function(s,e){for(var t=new yx(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];for(var r=new CZe(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)r[i]=i-t[n]<<5|n;return{b:t,r}},P7e=A7e(M7e,2),R7e=P7e.b,PZe=P7e.r;R7e[28]=258,PZe[258]=28;var RZe=A7e(C7e,0),IZe=RZe.b,dW=new yx(32768);for(var Qs=0;Qs<32768;++Qs){var R3=(Qs&43690)>>1|(Qs&21845)<<1;R3=(R3&52428)>>2|(R3&13107)<<2,R3=(R3&61680)>>4|(R3&3855)<<4,dW[Qs]=((R3&65280)>>8|(R3&255)<<8)>>1}var pE=function(s,e,t){for(var n=s.length,r=0,i=new yx(e);r<n;++r)s[r]&&++i[s[r]-1];var a=new yx(e);for(r=1;r<e;++r)a[r]=a[r-1]+i[r-1]<<1;var c;if(t){c=new yx(1<<e);var u=15-e;for(r=0;r<n;++r)if(s[r])for(var p=r<<4|s[r],y=e-s[r],x=a[s[r]-1]++<<y,S=x|(1<<y)-1;x<=S;++x)c[dW[x]>>u]=p}else for(c=new yx(n),r=0;r<n;++r)s[r]&&(c[r]=dW[a[s[r]-1]++]>>15-s[r]);return c},HE=new Jh(288);for(var Qs=0;Qs<144;++Qs)HE[Qs]=8;for(var Qs=144;Qs<256;++Qs)HE[Qs]=9;for(var Qs=256;Qs<280;++Qs)HE[Qs]=7;for(var Qs=280;Qs<288;++Qs)HE[Qs]=8;var I7e=new Jh(32);for(var Qs=0;Qs<32;++Qs)I7e[Qs]=5;var kZe=pE(HE,9,1),NZe=pE(I7e,5,1),Cj=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},Tf=function(s,e,t){var n=e/8|0;return(s[n]|s[n+1]<<8)>>(e&7)&t},Aj=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},DZe=function(s){return(s+7)/8|0},OZe=function(s,e,t){return(t==null||t>s.length)&&(t=s.length),new Jh(s.subarray(e,t))},LZe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Pf=function(s,e,t){var n=new Error(e||LZe[s]);if(n.code=s,Error.captureStackTrace&&Error.captureStackTrace(n,Pf),!t)throw n;return n},FZe=function(s,e,t,n){var r=s.length,i=0;if(!r||e.f&&!e.l)return t||new Jh(0);var a=!t,c=a||e.i!=2,u=e.i;a&&(t=new Jh(r*3));var p=function(Kr){var Mi=t.length;if(Kr>Mi){var Br=new Jh(Math.max(Mi*2,Kr));Br.set(t),t=Br}},y=e.f||0,x=e.p||0,S=e.b||0,M=e.l,I=e.d,L=e.m,B=e.n,A=r*8;do{if(!M){y=Tf(s,x,1);var V=Tf(s,x+1,3);if(x+=3,V)if(V==1)M=kZe,I=NZe,L=9,B=5;else if(V==2){var oe=Tf(s,x,31)+257,ie=Tf(s,x+10,15)+4,K=oe+Tf(s,x+5,31)+1;x+=14;for(var re=new Jh(K),se=new Jh(19),q=0;q<ie;++q)se[AZe[q]]=Tf(s,x+q*3,7);x+=ie*3;for(var De=Cj(se),Be=(1<<De)-1,tt=pE(se,De,1),q=0;q<K;){var st=tt[Tf(s,x,Be)];x+=st&15;var X=st>>4;if(X<16)re[q++]=X;else{var de=0,ft=0;for(X==16?(ft=3+Tf(s,x,3),x+=2,de=re[q-1]):X==17?(ft=3+Tf(s,x,7),x+=3):X==18&&(ft=11+Tf(s,x,127),x+=7);ft--;)re[q++]=de}}var Se=re.subarray(0,oe),rt=re.subarray(oe);L=Cj(Se),B=Cj(rt),M=pE(Se,L,1),I=pE(rt,B,1)}else Pf(1);else{var X=DZe(x)+4,P=s[X-4]|s[X-3]<<8,te=X+P;if(te>r){u&&Pf(0);break}c&&p(S+P),t.set(s.subarray(X,te),S),e.b=S+=P,e.p=x=te*8,e.f=y;continue}if(x>A){u&&Pf(0);break}}c&&p(S+131072);for(var ut=(1<<L)-1,Pe=(1<<B)-1,vt=x;;vt=x){var de=M[Aj(s,x)&ut],Bt=de>>4;if(x+=de&15,x>A){u&&Pf(0);break}if(de||Pf(2),Bt<256)t[S++]=Bt;else if(Bt==256){vt=x,M=null;break}else{var ct=Bt-254;if(Bt>264){var q=Bt-257,Pt=M7e[q];ct=Tf(s,x,(1<<Pt)-1)+R7e[q],x+=Pt}var on=I[Aj(s,x)&Pe],Gt=on>>4;on||Pf(3),x+=on&15;var rt=IZe[Gt];if(Gt>3){var Pt=C7e[Gt];rt+=Aj(s,x)&(1<<Pt)-1,x+=Pt}if(x>A){u&&Pf(0);break}c&&p(S+131072);var hn=S+ct;if(S<rt){var Xn=i-rt,Fn=Math.min(rt,hn);for(Xn+S<0&&Pf(3);S<Fn;++S)t[S]=n[Xn+S]}for(;S<hn;++S)t[S]=t[S-rt]}}e.l=M,e.p=vt,e.b=S,e.f=y,M&&(y=1,e.m=L,e.d=I,e.n=B)}while(!y);return S!=t.length&&a?OZe(t,0,S):t.subarray(0,S)},BZe=new Jh(0),UZe=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&Pf(6,"invalid zlib data"),(s[1]>>5&1)==1&&Pf(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function zZe(s,e){return FZe(s.subarray(UZe(s),-4),{i:2},e,e)}var VZe=typeof TextDecoder<"u"&&new TextDecoder,GZe=0;try{VZe.decode(BZe,{stream:!0}),GZe=1}catch{}function k7e(s,e,t){const n=t.length-s-1;if(e>=t[n])return n-1;if(e<=t[s])return s;let r=s,i=n,a=Math.floor((r+i)/2);for(;e<t[a]||e>=t[a+1];)e<t[a]?i=a:r=a,a=Math.floor((r+i)/2);return a}function jZe(s,e,t,n){const r=[],i=[],a=[];r[0]=1;for(let c=1;c<=t;++c){i[c]=e-n[s+1-c],a[c]=n[s+c]-e;let u=0;for(let p=0;p<c;++p){const y=a[p+1],x=i[c-p],S=r[p]/(y+x);r[p]=u+y*S,u=x*S}r[c]=u}return r}function HZe(s,e,t,n){const r=k7e(s,n,e),i=jZe(r,n,s,e),a=new xi(0,0,0,0);for(let c=0;c<=s;++c){const u=t[r-s+c],p=i[c],y=u.w*p;a.x+=u.x*y,a.y+=u.y*y,a.z+=u.z*y,a.w+=u.w*p}return a}function WZe(s,e,t,n,r){const i=[];for(let x=0;x<=t;++x)i[x]=0;const a=[];for(let x=0;x<=n;++x)a[x]=i.slice(0);const c=[];for(let x=0;x<=t;++x)c[x]=i.slice(0);c[0][0]=1;const u=i.slice(0),p=i.slice(0);for(let x=1;x<=t;++x){u[x]=e-r[s+1-x],p[x]=r[s+x]-e;let S=0;for(let M=0;M<x;++M){const I=p[M+1],L=u[x-M];c[x][M]=I+L;const B=c[M][x-1]/c[x][M];c[M][x]=S+I*B,S=L*B}c[x][x]=S}for(let x=0;x<=t;++x)a[0][x]=c[x][t];for(let x=0;x<=t;++x){let S=0,M=1;const I=[];for(let L=0;L<=t;++L)I[L]=i.slice(0);I[0][0]=1;for(let L=1;L<=n;++L){let B=0;const A=x-L,V=t-L;x>=L&&(I[M][0]=I[S][0]/c[V+1][A],B=I[M][0]*c[A][V]);const X=A>=-1?1:-A,P=x-1<=V?L-1:t-x;for(let oe=X;oe<=P;++oe)I[M][oe]=(I[S][oe]-I[S][oe-1])/c[V+1][A+oe],B+=I[M][oe]*c[A+oe][V];x<=V&&(I[M][L]=-I[S][L-1]/c[V+1][x],B+=I[M][L]*c[x][V]),a[L][x]=B;const te=S;S=M,M=te}}let y=t;for(let x=1;x<=n;++x){for(let S=0;S<=t;++S)a[x][S]*=y;y*=t-x}return a}function $Ze(s,e,t,n,r){const i=r<s?r:s,a=[],c=k7e(s,n,e),u=WZe(c,n,s,i,e),p=[];for(let y=0;y<t.length;++y){const x=t[y].clone(),S=x.w;x.x*=S,x.y*=S,x.z*=S,p[y]=x}for(let y=0;y<=i;++y){const x=p[c-s].clone().multiplyScalar(u[y][0]);for(let S=1;S<=s;++S)x.add(p[c-s+S].clone().multiplyScalar(u[y][S]));a[y]=x}for(let y=i+1;y<=r+1;++y)a[y]=new xi(0,0,0);return a}function qZe(s,e){let t=1;for(let r=2;r<=s;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=s-e;++r)n*=r;return t/n}function XZe(s){const e=s.length,t=[],n=[];for(let i=0;i<e;++i){const a=s[i];t[i]=new Ae(a.x,a.y,a.z),n[i]=a.w}const r=[];for(let i=0;i<e;++i){const a=t[i].clone();for(let c=1;c<=i;++c)a.sub(r[i-c].clone().multiplyScalar(qZe(i,c)*n[c]));r[i]=a.divideScalar(n[0])}return r}function YZe(s,e,t,n,r){const i=$Ze(s,e,t,n,r);return XZe(i)}class KZe extends vve{constructor(e,t,n,r,i){super();const a=t?t.length-1:0,c=n?n.length:0;this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||a;for(let u=0;u<c;++u){const p=n[u];this.controlPoints[u]=new xi(p.x,p.y,p.z,p.w)}}getPoint(e,t=new Ae){const n=t,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=HZe(this.degree,this.knots,this.controlPoints,r);return i.w!==1&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}getTangent(e,t=new Ae){const n=t,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=YZe(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}toJSON(){const e=super.toJSON();return e.degree=this.degree,e.knots=[...this.knots],e.controlPoints=this.controlPoints.map(t=>t.toArray()),e.startKnot=this.startKnot,e.endKnot=this.endKnot,e}fromJSON(e){return super.fromJSON(e),this.degree=e.degree,this.knots=[...e.knots],this.controlPoints=e.controlPoints.map(t=>new xi(t[0],t[1],t[2],t[3])),this.startKnot=e.startKnot,this.endKnot=e.endKnot,this}}let fi,Yo,ic;class ZZe extends $3{constructor(e){super(e)}load(e,t,n,r){const i=this,a=i.path===""?pke.extractUrlBase(e):i.path,c=new oke(this.manager);c.setPath(i.path),c.setResponseType("arraybuffer"),c.setRequestHeader(i.requestHeader),c.setWithCredentials(i.withCredentials),c.load(e,function(u){try{t(i.parse(u,a))}catch(p){r?r(p):console.error(p),i.manager.itemError(e)}},n,r)}parse(e,t){if(rQe(e))fi=new nQe().parse(e);else{const r=O7e(e);if(!iQe(r))throw new Error("THREE.FBXLoader: Unknown format.");if(C8e(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+C8e(r));fi=new tQe().parse(r)}const n=new Ive(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new QZe(n,this.manager).parse(fi)}}class QZe{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Yo=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),i=new JZe().parse(r);return this.parseScene(r,i,n),ic}parseConnections(){const e=new Map;return"Connections"in fi&&fi.Connections.connections.forEach(function(n){const r=n[0],i=n[1],a=n[2];e.has(r)||e.set(r,{parents:[],children:[]});const c={ID:i,relationship:a};e.get(r).parents.push(c),e.has(i)||e.set(i,{parents:[],children:[]});const u={ID:r,relationship:a};e.get(i).children.push(u)}),e}parseImages(){const e={},t={};if("Video"in fi.Objects){const n=fi.Objects.Video;for(const r in n){const i=n[r],a=parseInt(r);if(e[a]=i.RelativeFilename||i.Filename,"Content"in i){const c=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,u=typeof i.Content=="string"&&i.Content!=="";if(c||u){const p=this.parseImage(n[r]);t[i.RelativeFilename||i.Filename]=p}}}}for(const n in e){const r=e[n];t[r]!==void 0?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let i;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),i="image/tga";break;case"webp":i="image/webp";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof t=="string")return"data:"+i+";base64,"+t;{const a=new Uint8Array(t);return window.URL.createObjectURL(new Blob([a],{type:i}))}}parseTextures(e){const t=new Map;if("Texture"in fi.Objects){const n=fi.Objects.Texture;for(const r in n){const i=this.parseTexture(n[r],e);t.set(parseInt(r),i)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,i=e.WrapModeV,a=r!==void 0?r.value:0,c=i!==void 0?i.value:0;if(n.wrapS=a===0?Wg:C0,n.wrapT=c===0?Wg:C0,"Scaling"in e){const u=e.Scaling.value;n.repeat.x=u[0],n.repeat.y=u[1]}if("Translation"in e){const u=e.Translation.value;n.offset.x=u[0],n.offset.y=u[1]}return n}loadTexture(e,t){const n=e.FileName.split(".").pop().toLowerCase();let r=this.manager.getHandler(`.${n}`);r===null&&(r=this.textureLoader);const i=r.path;i||r.setPath(this.textureLoader.path);const a=Yo.get(e.id).children;let c;if(a!==void 0&&a.length>0&&t[a[0].ID]!==void 0&&(c=t[a[0].ID],(c.indexOf("blob:")===0||c.indexOf("data:")===0)&&r.setPath(void 0)),c===void 0)return console.warn("FBXLoader: Undefined filename, creating placeholder texture."),new n0;const u=r.load(c);return r.setPath(i),u}parseMaterials(e){const t=new Map;if("Material"in fi.Objects){const n=fi.Objects.Material;for(const r in n){const i=this.parseMaterial(n[r],e);i!==null&&t.set(parseInt(r),i)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let i=e.ShadingModel;if(typeof i=="object"&&(i=i.value),!Yo.has(n))return null;const a=this.parseParameters(e,t,n);let c;switch(i.toLowerCase()){case"phong":c=new cx;break;case"lambert":c=new XIe;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),c=new cx;break}return c.setValues(a),c.name=r,c}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=Gr.colorSpaceToWorking(new Pn().fromArray(e.Diffuse.value),qr):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=Gr.colorSpaceToWorking(new Pn().fromArray(e.DiffuseColor.value),qr)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=Gr.colorSpaceToWorking(new Pn().fromArray(e.Emissive.value),qr):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=Gr.colorSpaceToWorking(new Pn().fromArray(e.EmissiveColor.value),qr)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),r.opacity=1-(e.TransparencyFactor?parseFloat(e.TransparencyFactor.value):0),(r.opacity===1||r.opacity===0)&&(r.opacity=e.Opacity?parseFloat(e.Opacity.value):null,r.opacity===null&&(r.opacity=1-(e.TransparentColor?parseFloat(e.TransparentColor.value[0]):0))),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=Gr.colorSpaceToWorking(new Pn().fromArray(e.Specular.value),qr):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=Gr.colorSpaceToWorking(new Pn().fromArray(e.SpecularColor.value),qr));const i=this;return Yo.get(n).children.forEach(function(a){const c=a.relationship;switch(c){case"Bump":r.bumpMap=i.getTexture(t,a.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(t,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(t,a.ID),r.map!==void 0&&(r.map.colorSpace=qr);break;case"DisplacementColor":r.displacementMap=i.getTexture(t,a.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(t,a.ID),r.emissiveMap!==void 0&&(r.emissiveMap.colorSpace=qr);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(t,a.ID);break;case"ReflectionColor":r.envMap=i.getTexture(t,a.ID),r.envMap!==void 0&&(r.envMap.mapping=ak,r.envMap.colorSpace=qr);break;case"SpecularColor":r.specularMap=i.getTexture(t,a.ID),r.specularMap!==void 0&&(r.specularMap.colorSpace=qr);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(t,a.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",c);break}}),r}getTexture(e,t){return"LayeredTexture"in fi.Objects&&t in fi.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Yo.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in fi.Objects){const n=fi.Objects.Deformer;for(const r in n){const i=n[r],a=Yo.get(parseInt(r));if(i.attrType==="Skin"){const c=this.parseSkeleton(a,n);c.ID=r,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=a.parents[0].ID,e[r]=c}else if(i.attrType==="BlendShape"){const c={id:r};c.rawTargets=this.parseMorphTargets(a,n),c.id=r,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=c}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(r){const i=t[r.ID];if(i.attrType!=="Cluster")return;const a={ID:r.ID,indices:[],weights:[],transformLink:new or().fromArray(i.TransformLink.a)};"Indexes"in i&&(a.indices=i.Indexes.a,a.weights=i.Weights.a),n.push(a)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const i=e.children[r],a=t[i.ID],c={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;c.geoID=Yo.get(parseInt(i.ID)).children.filter(function(u){return u.relationship===void 0})[0].ID,n.push(c)}return n}parseScene(e,t,n){ic=new gv;const r=this.parseModels(e.skeletons,t,n),i=fi.Objects.Model,a=this;r.forEach(function(u){const p=i[u.ID];a.setLookAtProperties(u,p),Yo.get(u.ID).parents.forEach(function(x){const S=r.get(x.ID);S!==void 0&&S.add(u)}),u.parent===null&&ic.add(u)}),this.bindSkeleton(e.skeletons,t,r),this.addGlobalSceneSettings(),ic.traverse(function(u){if(u.userData.transformData){u.parent&&(u.userData.transformData.parentMatrix=u.parent.matrix,u.userData.transformData.parentMatrixWorld=u.parent.matrixWorld);const p=D7e(u.userData.transformData);u.applyMatrix4(p),u.updateWorldMatrix()}});const c=new eQe().parse();ic.children.length===1&&ic.children[0].isGroup&&(ic.children[0].animations=c,ic=ic.children[0]),ic.animations=c}parseModels(e,t,n){const r=new Map,i=fi.Objects.Model;for(const a in i){const c=parseInt(a),u=i[a],p=Yo.get(c);let y=this.buildSkeleton(p,e,c,u.attrName);if(!y){switch(u.attrType){case"Camera":y=this.createCamera(p);break;case"Light":y=this.createLight(p);break;case"Mesh":y=this.createMesh(p,t,n);break;case"NurbsCurve":y=this.createCurve(p,t);break;case"LimbNode":case"Root":y=new _H;break;case"Null":default:y=new gv;break}y.name=u.attrName?Gi.sanitizeNodeName(u.attrName):"",y.userData.originalName=u.attrName,y.ID=c}this.getTransformData(y,u),r.set(c,y)}return r}buildSkeleton(e,t,n,r){let i=null;return e.parents.forEach(function(a){for(const c in t){const u=t[c];u.rawBones.forEach(function(p,y){if(p.ID===a.ID){const x=i;i=new _H,i.matrixWorld.copy(p.transformLink),i.name=r?Gi.sanitizeNodeName(r):"",i.userData.originalName=r,i.ID=n,u.bones[y]=i,x!==null&&i.add(x)}})}}),i}createCamera(e){let t,n;if(e.children.forEach(function(r){const i=fi.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)}),n===void 0)t=new Ti;else{let r=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(r=1);let i=1;n.NearPlane!==void 0&&(i=n.NearPlane.value/1e3);let a=1e3;n.FarPlane!==void 0&&(a=n.FarPlane.value/1e3);let c=window.innerWidth,u=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(c=n.AspectWidth.value,u=n.AspectHeight.value);const p=c/u;let y=45;n.FieldOfView!==void 0&&(y=n.FieldOfView.value);const x=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new Ja(y,p,i,a),x!==null&&t.setFocalLength(x);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),t=new Ti;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new Ti;break}}return t}createLight(e){let t,n;if(e.children.forEach(function(r){const i=fi.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)}),n===void 0)t=new Ti;else{let r;n.LightType===void 0?r=0:r=n.LightType.value;let i=16777215;n.Color!==void 0&&(i=Gr.colorSpaceToWorking(new Pn().fromArray(n.Color.value),qr));let a=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(a=0);let c=0;n.FarAttenuationEnd!==void 0&&(n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?c=0:c=n.FarAttenuationEnd.value);const u=1;switch(r){case 0:t=new o3e(i,a,c,u);break;case 1:t=new YW(i,a);break;case 2:let p=Math.PI/3;n.InnerAngle!==void 0&&(p=pl.degToRad(n.InnerAngle.value));let y=0;n.OuterAngle!==void 0&&(y=pl.degToRad(n.OuterAngle.value),y=Math.max(y,1)),t=new XW(i,a,c,p,y,u);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new o3e(i,a);break}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,i=null,a=null;const c=[];if(e.children.forEach(function(u){t.has(u.ID)&&(i=t.get(u.ID)),n.has(u.ID)&&c.push(n.get(u.ID))}),c.length>1?a=c:c.length>0?a=c[0]:(a=new cx({name:$3.DEFAULT_MATERIAL_NAME,color:13421772}),c.push(a)),"color"in i.attributes&&c.forEach(function(u){u.vertexColors=!0}),i.groups.length>0){let u=!1;for(let p=0,y=i.groups.length;p<y;p++){const x=i.groups[p];(x.materialIndex<0||x.materialIndex>=c.length)&&(x.materialIndex=c.length,u=!0)}if(u){const p=new cx;c.push(p)}}return i.FBX_Deformer?(r=new UW(i,a),r.normalizeSkinWeights()):r=new mn(i,a),r}createCurve(e,t){const n=e.children.reduce(function(i,a){return t.has(a.ID)&&(i=t.get(a.ID)),i},null),r=new Ff({name:$3.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Kc(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?n.eulerOrder=OE(t.RotationOrder.value):n.eulerOrder=OE(0),"Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&Yo.get(e.ID).children.forEach(function(r){if(r.relationship==="LookAtProperty"){const i=fi.Objects.Model[r.ID];if("Lcl_Translation"in i){const a=i.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(a),ic.add(e.target)):e.lookAt(new Ae().fromArray(a))}}})}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const i in e){const a=e[i];Yo.get(parseInt(a.ID)).parents.forEach(function(u){if(t.has(u.ID)){const p=u.ID;Yo.get(p).parents.forEach(function(x){n.has(x.ID)&&n.get(x.ID).bind(new zW(a.bones),r[x.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in fi.Objects){const t=fi.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach(function(i){e[i.Node]=new or().fromArray(i.Matrix.a)}):e[r.Node]=new or().fromArray(r.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in fi){if("AmbientColor"in fi.GlobalSettings){const e=fi.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(t!==0||n!==0||r!==0){const i=new Pn().setRGB(t,n,r,qr);ic.add(new dke(i,1))}}"UnitScaleFactor"in fi.GlobalSettings&&(ic.userData.unitScaleFactor=fi.GlobalSettings.UnitScaleFactor.value)}}}class JZe{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in fi.Objects){const n=fi.Objects.Geometry;for(const r in n){const i=Yo.get(parseInt(r)),a=this.parseGeometry(i,n[r],e);t.set(parseInt(r),a)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,i=[],a=e.parents.map(function(x){return fi.Objects.Model[x.ID]});if(a.length===0)return;const c=e.children.reduce(function(x,S){return r[S.ID]!==void 0&&(x=r[S.ID]),x},null);e.children.forEach(function(x){n.morphTargets[x.ID]!==void 0&&i.push(n.morphTargets[x.ID])});const u=a[0],p={};"RotationOrder"in u&&(p.eulerOrder=OE(u.RotationOrder.value)),"InheritType"in u&&(p.inheritType=parseInt(u.InheritType.value)),"GeometricTranslation"in u&&(p.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(p.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(p.scale=u.GeometricScaling.value);const y=D7e(p);return this.genGeometry(t,c,i,y)}genGeometry(e,t,n,r){const i=new rs;e.attrName&&(i.name=e.attrName);const a=this.parseGeoNode(e,t),c=this.genBuffers(a),u=new Er(c.vertex,3);if(u.applyMatrix4(r),i.setAttribute("position",u),c.colors.length>0&&i.setAttribute("color",new Er(c.colors,3)),t&&(i.setAttribute("skinIndex",new FW(c.weightsIndices,4)),i.setAttribute("skinWeight",new Er(c.vertexWeights,4)),i.FBX_Deformer=t),c.normal.length>0){const p=new si().getNormalMatrix(r),y=new Er(c.normal,3);y.applyNormalMatrix(p),i.setAttribute("normal",y)}if(c.uvs.forEach(function(p,y){const x=y===0?"uv":`uv${y}`;i.setAttribute(x,new Er(c.uvs[y],2))}),a.material&&a.material.mappingType!=="AllSame"){let p=c.materialIndex[0],y=0;if(c.materialIndex.forEach(function(x,S){x!==p&&(i.addGroup(y,S-y,p),p=x,y=S)}),i.groups.length>0){const x=i.groups[i.groups.length-1],S=x.start+x.count;S!==c.materialIndex.length&&i.addGroup(S,c.materialIndex.length-S,p)}i.groups.length===0&&i.addGroup(0,c.materialIndex.length,c.materialIndex[0])}return this.addMorphTargets(i,e,n,r),i}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach(function(r,i){r.indices.forEach(function(a,c){n.weightTable[a]===void 0&&(n.weightTable[a]=[]),n.weightTable[a].push({id:i,weight:r.weights[c]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,i=!1,a=[],c=[],u=[],p=[],y=[],x=[];const S=this;return e.vertexIndices.forEach(function(M,I){let L,B=!1;M<0&&(M=M^-1,B=!0);let A=[],V=[];if(a.push(M*3,M*3+1,M*3+2),e.color){const X=zI(I,n,M,e.color);u.push(X[0],X[1],X[2])}if(e.skeleton){if(e.weightTable[M]!==void 0&&e.weightTable[M].forEach(function(X){V.push(X.weight),A.push(X.id)}),V.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);const X=[0,0,0,0],P=[0,0,0,0];V.forEach(function(te,oe){let ie=te,K=A[oe];P.forEach(function(re,se,q){if(ie>re){q[se]=ie,ie=re;const De=X[se];X[se]=K,K=De}})}),A=X,V=P}for(;V.length<4;)V.push(0),A.push(0);for(let X=0;X<4;++X)y.push(V[X]),x.push(A[X])}if(e.normal){const X=zI(I,n,M,e.normal);c.push(X[0],X[1],X[2])}e.material&&e.material.mappingType!=="AllSame"&&(L=zI(I,n,M,e.material)[0],L<0&&(S.negativeMaterialIndices=!0,L=0)),e.uv&&e.uv.forEach(function(X,P){const te=zI(I,n,M,X);p[P]===void 0&&(p[P]=[]),p[P].push(te[0]),p[P].push(te[1])}),r++,B&&(S.genFace(t,e,a,L,c,u,p,y,x,r),n++,r=0,a=[],c=[],u=[],p=[],y=[],x=[])}),t}getNormalNewell(e){const t=new Ae(0,0,0);for(let n=0;n<e.length;n++){const r=e[n],i=e[(n+1)%e.length];t.x+=(r.y-i.y)*(r.z+i.z),t.y+=(r.z-i.z)*(r.x+i.x),t.z+=(r.x-i.x)*(r.y+i.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){const t=this.getNormalNewell(e),r=(Math.abs(t.z)>.5?new Ae(0,1,0):new Ae(0,0,1)).cross(t).normalize(),i=t.clone().cross(r).normalize();return{normal:t,tangent:r,bitangent:i}}flattenVertex(e,t,n){return new An(e.dot(t),e.dot(n))}genFace(e,t,n,r,i,a,c,u,p,y){let x;if(y>3){const S=[],M=t.baseVertexPositions||t.vertexPositions;for(let A=0;A<n.length;A+=3)S.push(new Ae(M[n[A]],M[n[A+1]],M[n[A+2]]));const{tangent:I,bitangent:L}=this.getNormalTangentAndBitangent(S),B=[];for(const A of S)B.push(this.flattenVertex(A,I,L));x=WW.triangulateShape(B,[])}else x=[[0,1,2]];for(const[S,M,I]of x)e.vertex.push(t.vertexPositions[n[S*3]]),e.vertex.push(t.vertexPositions[n[S*3+1]]),e.vertex.push(t.vertexPositions[n[S*3+2]]),e.vertex.push(t.vertexPositions[n[M*3]]),e.vertex.push(t.vertexPositions[n[M*3+1]]),e.vertex.push(t.vertexPositions[n[M*3+2]]),e.vertex.push(t.vertexPositions[n[I*3]]),e.vertex.push(t.vertexPositions[n[I*3+1]]),e.vertex.push(t.vertexPositions[n[I*3+2]]),t.skeleton&&(e.vertexWeights.push(u[S*4]),e.vertexWeights.push(u[S*4+1]),e.vertexWeights.push(u[S*4+2]),e.vertexWeights.push(u[S*4+3]),e.vertexWeights.push(u[M*4]),e.vertexWeights.push(u[M*4+1]),e.vertexWeights.push(u[M*4+2]),e.vertexWeights.push(u[M*4+3]),e.vertexWeights.push(u[I*4]),e.vertexWeights.push(u[I*4+1]),e.vertexWeights.push(u[I*4+2]),e.vertexWeights.push(u[I*4+3]),e.weightsIndices.push(p[S*4]),e.weightsIndices.push(p[S*4+1]),e.weightsIndices.push(p[S*4+2]),e.weightsIndices.push(p[S*4+3]),e.weightsIndices.push(p[M*4]),e.weightsIndices.push(p[M*4+1]),e.weightsIndices.push(p[M*4+2]),e.weightsIndices.push(p[M*4+3]),e.weightsIndices.push(p[I*4]),e.weightsIndices.push(p[I*4+1]),e.weightsIndices.push(p[I*4+2]),e.weightsIndices.push(p[I*4+3])),t.color&&(e.colors.push(a[S*3]),e.colors.push(a[S*3+1]),e.colors.push(a[S*3+2]),e.colors.push(a[M*3]),e.colors.push(a[M*3+1]),e.colors.push(a[M*3+2]),e.colors.push(a[I*3]),e.colors.push(a[I*3+1]),e.colors.push(a[I*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(i[S*3]),e.normal.push(i[S*3+1]),e.normal.push(i[S*3+2]),e.normal.push(i[M*3]),e.normal.push(i[M*3+1]),e.normal.push(i[M*3+2]),e.normal.push(i[I*3]),e.normal.push(i[I*3+1]),e.normal.push(i[I*3+2])),t.uv&&t.uv.forEach(function(L,B){e.uvs[B]===void 0&&(e.uvs[B]=[]),e.uvs[B].push(c[B][S*2]),e.uvs[B].push(c[B][S*2+1]),e.uvs[B].push(c[B][M*2]),e.uvs[B].push(c[B][M*2+1]),e.uvs[B].push(c[B][I*2]),e.uvs[B].push(c[B][I*2+1])})}addMorphTargets(e,t,n,r){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const i=this;n.forEach(function(a){a.rawTargets.forEach(function(c){const u=fi.Objects.Geometry[c.geoID];u!==void 0&&i.genMorphGeometry(e,t,u,r,c.name)})})}genMorphGeometry(e,t,n,r,i){const a=t.Vertices!==void 0?t.Vertices.a:[],c=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],u=n.Vertices!==void 0?n.Vertices.a:[],p=n.Indexes!==void 0?n.Indexes.a:[],y=e.attributes.position.count*3,x=new Float32Array(y);for(let L=0;L<p.length;L++){const B=p[L]*3;x[B]=u[L*3],x[B+1]=u[L*3+1],x[B+2]=u[L*3+2]}const S={vertexIndices:c,vertexPositions:x,baseVertexPositions:a},M=this.genBuffers(S),I=new Er(M.vertex,3);I.name=i||n.attrName,I.applyMatrix4(r),e.morphAttributes.position.push(I)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let i=[];return n==="IndexToDirect"&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let i=[];return n==="IndexToDirect"&&(i=e.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let i=[];n==="IndexToDirect"&&(i=e.ColorIndex.a);for(let a=0,c=new Pn;a<r.length;a+=4)c.fromArray(r,a),Gr.colorSpaceToWorking(c,qr),c.toArray(r,a);return{dataSize:4,buffer:r,indices:i,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,i=[];for(let a=0;a<r.length;++a)i.push(a);return{dataSize:1,buffer:r,indices:i,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new rs;const n=t-1,r=e.KnotVector.a,i=[],a=e.Points.a;for(let x=0,S=a.length;x<S;x+=4)i.push(new xi().fromArray(a,x));let c,u;if(e.Form==="Closed")i.push(i[0]);else if(e.Form==="Periodic"){c=n,u=r.length-1-c;for(let x=0;x<n;++x)i.push(i[x])}const y=new KZe(n,r,i,c,u).getPoints(i.length*12);return new rs().setFromPoints(y)}}class eQe{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const r=t[n],i=this.addClip(r);e.push(i)}return e}parseClips(){if(fi.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=fi.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const i={id:r.id,attr:r.attrName,curves:{}};t.set(i.id,i)}}return t}parseAnimationCurves(e){const t=fi.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(sQe),values:t[n].KeyValueFloat.a},i=Yo.get(r.id);if(i!==void 0){const a=i.parents[0].ID,c=i.parents[0].relationship;c.match(/X/)?e.get(a).curves.x=r:c.match(/Y/)?e.get(a).curves.y=r:c.match(/Z/)?e.get(a).curves.z=r:c.match(/DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=r)}}}parseAnimationLayers(e){const t=fi.Objects.AnimationLayer,n=new Map;for(const r in t){const i=[],a=Yo.get(parseInt(r));a!==void 0&&(a.children.forEach(function(u,p){if(e.has(u.ID)){const y=e.get(u.ID);if(y.curves.x!==void 0||y.curves.y!==void 0||y.curves.z!==void 0){if(i[p]===void 0){const x=Yo.get(u.ID).parents.filter(function(S){return S.relationship!==void 0})[0].ID;if(x!==void 0){const S=fi.Objects.Model[x.toString()];if(S===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",u);return}const M={modelName:S.attrName?Gi.sanitizeNodeName(S.attrName):"",ID:S.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};ic.traverse(function(I){I.ID===S.id&&(M.transform=I.matrix,I.userData.transformData&&(M.eulerOrder=I.userData.transformData.eulerOrder))}),M.transform||(M.transform=new or),"PreRotation"in S&&(M.preRotation=S.PreRotation.value),"PostRotation"in S&&(M.postRotation=S.PostRotation.value),i[p]=M}}i[p]&&(i[p][y.attr]=y)}else if(y.curves.morph!==void 0){if(i[p]===void 0){const x=Yo.get(u.ID).parents.filter(function(A){return A.relationship!==void 0})[0].ID,S=Yo.get(x).parents[0].ID,M=Yo.get(S).parents[0].ID,I=Yo.get(M).parents[0].ID,L=fi.Objects.Model[I],B={modelName:L.attrName?Gi.sanitizeNodeName(L.attrName):"",morphName:fi.Objects.Deformer[x].attrName};i[p]=B}i[p][y.attr]=y}}}),n.set(parseInt(r),i))}return n}parseAnimStacks(e){const t=fi.Objects.AnimationStack,n={};for(const r in t){const i=Yo.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(i[0].ID);n[r]={name:t[r].attrName,layer:a}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(r){t=t.concat(n.generateTracks(r))}),new EH(e.name,-1,t)}generateTracks(e){const t=[];let n=new Ae,r=new Ae;if(e.transform&&e.transform.decompose(n,new ls,r),n=n.toArray(),r=r.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");i!==void 0&&t.push(i)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const i=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);i!==void 0&&t.push(i)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");i!==void 0&&t.push(i)}if(e.DeformPercent!==void 0){const i=this.generateMorphTrack(e);i!==void 0&&t.push(i)}return t}generateVectorTrack(e,t,n,r){const i=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(i,t,n);return new TE(e+"."+r,i,a)}generateRotationTrack(e,t,n,r,i){let a,c;if(t.x!==void 0&&t.y!==void 0&&t.z!==void 0){const S=this.interpolateRotations(t.x,t.y,t.z,i);a=S[0],c=S[1]}const u=OE(0);n!==void 0&&(n=n.map(pl.degToRad),n.push(u),n=new ua().fromArray(n),n=new ls().setFromEuler(n)),r!==void 0&&(r=r.map(pl.degToRad),r.push(u),r=new ua().fromArray(r),r=new ls().setFromEuler(r).invert());const p=new ls,y=new ua,x=[];if(!c||!a)return new Ux(e+".quaternion",[0],[0]);for(let S=0;S<c.length;S+=3)y.set(c[S],c[S+1],c[S+2],i),p.setFromEuler(y),n!==void 0&&p.premultiply(n),r!==void 0&&p.multiply(r),S>2&&new ls().fromArray(x,(S-3)/3*4).dot(p)<0&&p.set(-p.x,-p.y,-p.z,-p.w),p.toArray(x,S/3*4);return new Ux(e+".quaternion",a,x)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(i){return i/100}),r=ic.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new EE(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(n,r){return n-r}),t.length>1){let n=1,r=t[0];for(let i=1;i<t.length;i++){const a=t[i];a!==r&&(t[n]=a,r=a,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,i=[];let a=-1,c=-1,u=-1;return e.forEach(function(p){if(t.x&&(a=t.x.times.indexOf(p)),t.y&&(c=t.y.times.indexOf(p)),t.z&&(u=t.z.times.indexOf(p)),a!==-1){const y=t.x.values[a];i.push(y),r[0]=y}else i.push(r[0]);if(c!==-1){const y=t.y.values[c];i.push(y),r[1]=y}else i.push(r[1]);if(u!==-1){const y=t.z.values[u];i.push(y),r[2]=y}else i.push(r[2])}),i}interpolateRotations(e,t,n,r){const i=[],a=[];i.push(e.times[0]),a.push(pl.degToRad(e.values[0])),a.push(pl.degToRad(t.values[0])),a.push(pl.degToRad(n.values[0]));for(let c=1;c<e.values.length;c++){const u=[e.values[c-1],t.values[c-1],n.values[c-1]];if(isNaN(u[0])||isNaN(u[1])||isNaN(u[2]))continue;const p=u.map(pl.degToRad),y=[e.values[c],t.values[c],n.values[c]];if(isNaN(y[0])||isNaN(y[1])||isNaN(y[2]))continue;const x=y.map(pl.degToRad),S=[y[0]-u[0],y[1]-u[1],y[2]-u[2]],M=[Math.abs(S[0]),Math.abs(S[1]),Math.abs(S[2])];if(M[0]>=180||M[1]>=180||M[2]>=180){const L=Math.max(...M)/180,B=new ua(...p,r),A=new ua(...x,r),V=new ls().setFromEuler(B),X=new ls().setFromEuler(A);V.dot(X)&&X.set(-X.x,-X.y,-X.z,-X.w);const P=e.times[c-1],te=e.times[c]-P,oe=new ls,ie=new ua;for(let K=0;K<1;K+=1/L)oe.copy(V.clone().slerp(X.clone(),K)),i.push(P+K*te),ie.setFromQuaternion(oe,r),a.push(ie.x),a.push(ie.y),a.push(ie.z)}else i.push(e.times[c]),a.push(pl.degToRad(e.values[c])),a.push(pl.degToRad(t.values[c])),a.push(pl.degToRad(n.values[c]))}return[i,a]}}class tQe{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new N7e,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(r,i){const a=r.match(/^[\s\t]*;/),c=r.match(/^[\s\t]*$/);if(a||c)return;const u=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),p=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),y=r.match("^\\t{"+(t.currentIndent-1)+"}}");u?t.parseNodeBegin(r,u):p?t.parseNodeProperty(r,p,n[++i]):y?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(u){return u.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:n},a=this.parseNodeAttr(r),c=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,i):n in c?(n==="PoseNode"?c.PoseNode.push(i):c[n].id!==void 0&&(c[n]={},c[n][c[n].id]=c[n]),a.id!==""&&(c[n][a.id]=i)):typeof a.id=="number"?(c[n]={},c[n][a.id]=i):n!=="Properties70"&&(n==="PoseNode"?c[n]=[i]:c[n]=i),typeof a.id=="number"&&(i.id=a.id),a.name!==""&&(i.attrName=a.name),a.type!==""&&(i.attrType=a.type),this.pushStack(i)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&i===","&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name==="Properties70"){this.parseNodeSpecialProperty(e,r,i);return}if(r==="C"){const u=i.split(",").slice(1),p=parseInt(u[0]),y=parseInt(u[1]);let x=i.split(",").slice(3);x=x.map(function(S){return S.trim().replace(/^"/,"")}),r="connections",i=[p,y],aQe(i,x),a[r]===void 0&&(a[r]=[])}r==="Node"&&(a.id=i),r in a&&Array.isArray(a[r])?a[r].push(i):r!=="a"?a[r]=i:a.a=i,this.setCurrentProp(a,r),r==="a"&&i.slice(-1)!==","&&(a.a=Rj(i))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=Rj(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map(function(y){return y.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=r[0],a=r[1],c=r[2],u=r[3];let p=r[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":p=parseFloat(p);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":p=Rj(p);break}this.getPrevNode()[i]={type:a,type2:c,flag:u,value:p},this.setCurrentProp(this.getPrevNode(),i)}}class nQe{parse(e){const t=new M8e(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new N7e;for(;!this.endOfContent(t);){const i=this.parseNode(t,n);i!==null&&r.add(i.name,i)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),c=e.getString(a);if(r===0)return null;const u=[];for(let S=0;S<i;S++)u.push(this.parseProperty(e));const p=u.length>0?u[0]:"",y=u.length>1?u[1]:"",x=u.length>2?u[2]:"";for(n.singleProperty=i===1&&e.getOffset()===r;r>e.getOffset();){const S=this.parseNode(e,t);S!==null&&this.parseSubNode(c,n,S)}return n.propertyList=u,typeof p=="number"&&(n.id=p),y!==""&&(n.attrName=y),x!==""&&(n.attrType=x),c!==""&&(n.name=c),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if(e==="Connections"&&n.name==="C"){const r=[];n.propertyList.forEach(function(i,a){a!==0&&r.push(i)}),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(n.name==="Properties70")Object.keys(n).forEach(function(i){t[i]=n[i]});else if(e==="Properties70"&&n.name==="P"){let r=n.propertyList[0],i=n.propertyList[1];const a=n.propertyList[2],c=n.propertyList[3];let u;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),i==="Color"||i==="ColorRGB"||i==="Vector"||i==="Vector3D"||i.indexOf("Lcl_")===0?u=[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:u=n.propertyList[4],t[r]={type:i,type2:a,flag:c,value:u}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),i=e.getUint32(),a=e.getUint32();if(i===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const c=zZe(new Uint8Array(e.getArrayBuffer(a))),u=new M8e(c.buffer);switch(t){case"b":case"c":return u.getBooleanArray(r);case"d":return u.getFloat64Array(r);case"f":return u.getFloat32Array(r);case"i":return u.getInt32Array(r);case"l":return u.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class M8e{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const r=n.indexOf(0);return r>=0&&(n=new Uint8Array(this.dv.buffer,t,r)),this._textDecoder.decode(n)}}class N7e{add(e,t){this[e]=t}}function rQe(s){const e="Kaydara FBX Binary  \0";return s.byteLength>=e.length&&e===O7e(s,0,e.length)}function iQe(s){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(r){const i=s[r-1];return s=s.slice(t+r),t++,i}for(let r=0;r<e.length;++r)if(n(1)===e[r])return!1;return!0}function C8e(s){const e=/FBXVersion: (\d+)/,t=s.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function sQe(s){return s/46186158e3}const oQe=[];function zI(s,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=s;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(r=n.indices[r]);const i=r*n.dataSize,a=i+n.dataSize;return lQe(oQe,n.buffer,i,a)}const Pj=new ua,ex=new Ae;function D7e(s){const e=new or,t=new or,n=new or,r=new or,i=new or,a=new or,c=new or,u=new or,p=new or,y=new or,x=new or,S=new or,M=s.inheritType?s.inheritType:0;s.translation&&e.setPosition(ex.fromArray(s.translation));const I=OE(0);if(s.preRotation){const q=s.preRotation.map(pl.degToRad);q.push(I),t.makeRotationFromEuler(Pj.fromArray(q))}if(s.rotation){const q=s.rotation.map(pl.degToRad);q.push(s.eulerOrder||I),n.makeRotationFromEuler(Pj.fromArray(q))}if(s.postRotation){const q=s.postRotation.map(pl.degToRad);q.push(I),r.makeRotationFromEuler(Pj.fromArray(q)),r.invert()}s.scale&&i.scale(ex.fromArray(s.scale)),s.scalingOffset&&c.setPosition(ex.fromArray(s.scalingOffset)),s.scalingPivot&&a.setPosition(ex.fromArray(s.scalingPivot)),s.rotationOffset&&u.setPosition(ex.fromArray(s.rotationOffset)),s.rotationPivot&&p.setPosition(ex.fromArray(s.rotationPivot)),s.parentMatrixWorld&&(x.copy(s.parentMatrix),y.copy(s.parentMatrixWorld));const L=t.clone().multiply(n).multiply(r),B=new or;B.extractRotation(y);const A=new or;A.copyPosition(y);const V=A.clone().invert().multiply(y),X=B.clone().invert().multiply(V),P=i,te=new or;if(M===0)te.copy(B).multiply(L).multiply(X).multiply(P);else if(M===1)te.copy(B).multiply(X).multiply(L).multiply(P);else{const De=new or().scale(new Ae().setFromMatrixScale(x)).clone().invert(),Be=X.clone().multiply(De);te.copy(B).multiply(L).multiply(Be).multiply(P)}const oe=p.clone().invert(),ie=a.clone().invert();let K=e.clone().multiply(u).multiply(p).multiply(t).multiply(n).multiply(r).multiply(oe).multiply(c).multiply(a).multiply(i).multiply(ie);const re=new or().copyPosition(K),se=y.clone().multiply(re);return S.copyPosition(se),K=S.clone().multiply(te),K.premultiply(y.invert()),K}function OE(s){s=s||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return s===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[s]}function Rj(s){return s.split(",").map(function(t){return parseFloat(t)})}function O7e(s,e,t){return e===void 0&&(e=0),t===void 0&&(t=s.byteLength),new TextDecoder().decode(new Uint8Array(s,e,t))}function aQe(s,e){for(let t=0,n=s.length,r=e.length;t<r;t++,n++)s[n]=e[t]}function lQe(s,e,t,n){for(let r=t,i=0;r<n;r++,i++)s[i]=e[r];return s}const pN=new Map,L7e=new Map,F7e=new Map,oq=new Map;function cQe(s,e){return new Promise((t,n)=>{new ake().setPath("images/milkyWay/").load(e,r=>{pN.set(s,r),t(r)},void 0,()=>{n()})})}function uQe(s,e){return new Promise((t,n)=>{new ZZe().setPath("./models/").loadAsync(e).then(r=>{r.traverse(i=>{i.isMesh&&(i.castShadow=!0,i.receiveShadow=!0)}),F7e.set(s,r),t(r)}).catch(r=>{console.log("Couldn't load:",e),console.log(r),n()})})}function hQe(s,e){return new Promise((t,n)=>{new Ive().load(e,r=>{r.wrapS=Wg,r.wrapT=Wg,r.needsUpdate=!0,oq.set(s,r),t(r)},void 0,()=>{n()})})}function dQe(s,e){return new Promise((t,n)=>{fetch(e).then(r=>{if(!r.ok)throw new Error(`Network response was not ok: ${r.status}`);return r.json()}).then(r=>{L7e.set(s,r),t(r)}).catch(()=>{console.log(`Couldn't load: ${e}`),n()})})}function fQe(s){return new Promise((e,t)=>{const n=[()=>cQe("environment",["dark-s_px.jpg","dark-s_nx.jpg","dark-s_py.jpg","dark-s_ny.jpg","dark-s_pz.jpg","dark-s_nz.jpg"]),()=>hQe("uv_grid","images/uv_grid_opengl.jpg"),()=>uQe("Flair","Flair.fbx"),()=>dQe("animation","json/animation.json")];Promise.all(n.map(r=>r())).then(()=>{const r=s.components.get("theatre"),i=L7e.get("animation");r.loadProject("RemoteApp",i).then(()=>{AH.dispatchEvent({type:gk.LOAD_COMPLETE}),e()})}).catch(r=>{console.log(r),t()})})}class B7e extends Ti{constructor(t){super();Xe(this,"mixer");this.name=t,this.scale.setScalar(.5);const n=F7e.get(t),r=MZe(n);this.add(r),this.mixer=new Ake(r),r.mixer=this.mixer,this.mixer.clipAction(r.animations[0]).play()}update(t){this.mixer.update(t)}get timeScale(){return this.mixer.timeScale}set timeScale(t){this.mixer.timeScale=t}}class aq extends _E{constructor(){super();Xe(this,"app");Xe(this,"camera");Xe(this,"renderer");Xe(this,"clock");this.clock=new kve,this.clock.start();const t=new Ti;t.name="cameras",this.add(t),this.camera=new Ja(90,1,10,1e3),this.camera.name="SceneCamera",this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),t.add(this.camera)}setup(t,n){this.app=t,this.renderer=n}init(){}dispose(){this.app.components.get("theatre").clearSheetObjects(this.name)}resize(t,n){this.camera.aspect=t/n,this.camera.updateProjectionMatrix()}update(){}draw(){this.renderer.isWebGLRenderer?this.renderer.render(this,this.camera):this.renderer.renderAsync(this,this.camera)}}let fW=[];function pQe(s,e,t=!0){ml.renderer=e.renderer;const n=[];n.push({type:"boolean",prop:"Enabled",value:s.enabled});let r=(a,c)=>{console.log("Default Handle Pass:",a,c)};if(s.name==="EffectPass")s.effects.forEach(a=>{a.uniforms.size>0&&a.uniforms.forEach((c,u)=>{if(u==="map")return;const p=`${a.name.replace("Effect","")} ${u}`;if(c.value===null&&t)n.push({prop:u,title:p,type:"image",value:{offset:[0,0],repeat:[1,1],src:""}});else if(c.value.isTexture&&t){const y=c.value,x=ml.renderToBlob(y);n.push({prop:u,title:p,type:"image",value:{offset:[y.offset.x,y.offset.y],repeat:[y.repeat.x,y.repeat.y],src:x}})}else typeof c.value=="number"?n.push({prop:u,title:p,type:"number",value:c.value,step:.01}):typeof c.value=="string"?n.push({prop:u,title:p,type:"string",value:c.value}):typeof c.value=="boolean"&&n.push({prop:u,title:p,type:"boolean",value:c.value})})}),r=(a,c)=>{s.effects.forEach(u=>{u.uniforms.size>0&&u.uniforms.forEach((p,y)=>{y===a&&(p.value=c)})})};else if(s.name==="ShaderPass"){const a=s.fullscreenMaterial;for(const c in a.uniforms){if(c==="inputBuffer"||c==="map")continue;const u=a.uniforms[c],p=`${a.name.replace("Material","")} ${c}`;if(u.value===null&&t)n.push({title:p,prop:c,type:"image",value:{offset:[0,0],repeat:[1,1],src:""}});else if(u.value.isTexture&&t){const y=u.value,x=ml.renderToBlob(y);n.push({title:p,prop:c,type:"image",value:{offset:[y.offset.x,y.offset.y],repeat:[y.repeat.x,y.repeat.y],src:x}})}else typeof u.value=="number"?n.push({title:p,prop:c,type:"number",value:u.value,step:.01}):typeof u.value=="string"?n.push({title:p,prop:c,type:"string",value:u.value}):typeof u.value=="boolean"&&n.push({title:p,prop:c,type:"boolean",value:u.value})}r=(c,u)=>{const p=a.uniforms[c];p.value=u}}else return;const i=`${s.name}: ${s.scene.name}`;e.addGroup({title:i,items:n,onUpdate:(a,c)=>{a==="Enabled"?s.enabled=c:r(a,c)}}),fW.push(i)}function mQe(s,e){s.passes.forEach(t=>{pQe(t,e)})}function gQe(s){fW.forEach(e=>{s.removeGroup(e)}),fW=[]}class U7e extends aq{constructor(){super();Xe(this,"dance");Xe(this,"composer");Xe(this,"customMat");this.name="Scene1"}init(){const t=pN.get("environment");this.background=t,this.camera.position.set(0,50,50),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createPost(),this.createAnimation(),Vx(this);const n=this.app.components.get("three");n.addScene(this),n.setScene(this),n.addCamera(this.camera)}dispose(){var n;const t=this.app.components.get("three");(n=this.composer)==null||n.dispose(),t.removeCamera(this.camera),super.dispose()}createLights(){const t=new Ti;t.name="lights",this.add(t);const n=new YW(16777215,.25);n.name="sun",n.castShadow=!0,n.position.set(0,50,50);const r=1024;n.shadow.camera.top=r,n.shadow.camera.bottom=-r,n.shadow.camera.left=-r,n.shadow.camera.right=r,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=10,n.shadow.camera.far=1e3,n.shadow.bias=-.001,t.add(n);const i=new lke(7320802,12872999,.5);i.name="hemi",t.add(i);const a=new XW(16777215,3);a.angle=5.8,a.decay=0,a.distance=1e3,a.penumbra=Math.PI,a.name="spotlight",a.castShadow=!0,a.shadow.mapSize.width=1024,a.shadow.mapSize.height=1024,a.shadow.camera.near=10,a.shadow.camera.far=1e3,a.shadow.bias=-.001,a.position.set(-50,200,200),a.lookAt(0,50,0),t.add(a)}createWorld(){const t=new Ti;t.name="world",this.add(t);const n=oq.get("uv_grid");n.repeat.setScalar(10),n.needsUpdate=!0;const r=new cx({map:n}),i=new mn(new Wk(500,36),r);i.name="floor",i.receiveShadow=!0,i.rotateX(-Math.PI/2),t.add(i),this.dance=new B7e("Flair"),this.dance.position.set(0,0,0),t.add(this.dance),this.createTestMaterials(t)}createTestMaterials(t){const n=new Tv(20),r=[],i=new mn(n,new eh({name:"BasicMaterial",transparent:!0}));i.name="Basic",t.add(i),r.push(i);const a=new mn(n,new Mve({transparent:!0}));a.name="Matcap",t.add(a),r.push(a);const c=new mn(n,new cx({name:"PhongMaterial",transparent:!0}));c.name="Phong",t.add(c),r.push(c);const u=new mn(n,new pk({name:"PhysicalMaterial",transparent:!0}));if(u.name="Physical",t.add(u),r.push(u),this.app.components.get("three").renderer.isWebGLRenderer){this.customMat=new E7e;const M=new mn(n,this.customMat);M.name="Shader",t.add(M),r.push(M)}const y=50,x=r.length,S=(x-1)/2*y;for(let M=0;M<x;M++){const I=M*y-S;r[M].position.set(I,100,-150),r[M].castShadow=!0}}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Break Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.playSheet(this.name,{iterationCount:1/0})}createPost(){var i,a,c;const t=this.app.components.get("three");this.composer=new dKe(t.renderer,{frameBufferType:W3}),(i=this.composer)==null||i.addPass(new mZe(this,this.camera));const n=new SZe(this.camera,new pZe,new uZe,new vZe);n.scene.name="FXAA/Bloom/Vignette",(a=this.composer)==null||a.addPass(n);const r=new hZe(new rq);r.scene.name="Display",(c=this.composer)==null||c.addPass(r),mQe(this.composer,t)}update(){var n;const t=this.clock.getDelta();(n=this.customMat)==null||n.update(t),this.dance.update(t)}draw(){var t;(t=this.composer)==null||t.render()}resize(t,n){var r;super.resize(t,n),this.app.isApp&&((r=this.composer)==null||r.setSize(t,n))}}class Zx{static init(){const e=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-448815e-12,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,907581e-12,1.12813,.997866,-896716e-12,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,879224e-12,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,655682e-12,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,462391e-12,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,304092e-12,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,173682e-12,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,778271e-13,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-627338e-12,.0306409,197672e-13,99168e-8,-158573e-10,.0314638,499803e-12,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,237499e-13,-999999e-13,282592e-10,114596e-15,100292e-11,-166369e-11,250354e-9,677492e-14,350752e-11,-637769e-11,357289e-9,631655e-13,826445e-11,-174689e-10,516179e-9,31851e-11,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],t=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,545037e-15,0,0,.999994,285095e-14,0,0,.999989,126931e-13,0,0,.999973,489938e-13,0,0,.999947,166347e-12,0,0,.999894,502694e-12,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,115855e-15,0,0,.999996,66947e-14,0,0,.999991,330863e-14,0,0,.999983,141737e-13,0,0,.999968,532626e-13,0,0,.99994,177431e-12,0,0,.999891,528835e-12,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,222338e-15,0,0,.999995,10967e-13,0,0,.999991,482132e-14,0,0,.999981,189434e-13,0,0,.999967,667716e-13,0,0,.999938,212066e-12,0,0,.999886,60977e-11,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,101739e-15,0,0,.999997,470132e-15,0,0,.999993,200436e-14,0,0,.999988,783682e-14,0,0,.999979,280338e-13,0,0,.999962,917033e-13,0,0,.999933,274514e-12,0,0,.999881,753201e-12,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,251859e-15,0,0,.999996,996192e-15,0,0,.999992,374531e-14,0,0,.999986,132022e-13,0,0,.999975,433315e-13,0,0,.999959,131956e-12,0,0,.999927,372249e-12,0,0,.999871,972461e-12,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,179597e-15,0,0,.999997,602367e-15,0,0,.999994,206835e-14,0,0,.99999,694952e-14,0,0,.999984,223363e-13,0,0,.999972,678578e-13,0,0,.999952,193571e-12,0,0,.999919,516594e-12,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,114608e-15,0,0,.999998,210507e-15,0,0,.999997,499595e-15,0,0,.999995,139897e-14,0,0,.999994,419818e-14,0,0,.999988,127042e-13,0,0,.999979,375153e-13,0,0,.999965,106206e-12,0,0,.999945,285381e-12,0,0,.999908,723611e-12,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,286798e-15,0,0,1,286877e-15,0,0,1,288094e-15,0,0,1,293506e-15,0,0,1,309262e-15,0,0,.999999,348593e-15,0,0,.999999,444582e-15,0,0,.999998,688591e-15,0,0,.999996,134391e-14,0,0,.999993,317438e-14,0,0,.999989,835609e-14,0,0,.999983,228677e-13,0,0,.999974,623361e-13,0,0,.999959,165225e-12,0,0,.999936,419983e-12,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,168222e-12,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,109018e-14,0,0,1,10904e-13,0,0,1,109393e-14,0,0,1,11095e-13,0,0,1,1154e-12,0,0,1,126089e-14,0,0,.999999,15059e-13,0,0,.999997,207899e-14,0,0,.999994,348164e-14,0,0,.999993,705728e-14,0,0,.999987,163692e-13,0,0,.999981,406033e-13,0,0,.999969,10245e-11,0,0,.999953,255023e-12,0,0,.999925,61511e-11,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,354014e-14,0,0,1,354073e-14,0,0,1,354972e-14,0,0,1,358929e-14,0,0,1,370093e-14,0,0,.999999,396194e-14,0,0,.999998,453352e-14,0,0,.999997,578828e-14,0,0,.999994,863812e-14,0,0,.999991,153622e-13,0,0,.999985,316356e-13,0,0,.999977,712781e-13,0,0,.999964,166725e-12,0,0,.999945,390501e-12,0,0,.999912,895622e-12,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,10153e-12,0,0,1,101544e-13,0,0,1,101751e-13,0,0,1,102662e-13,0,0,1,10521e-12,0,0,.999999,111049e-13,0,0,.999999,123408e-13,0,0,.999996,14924e-12,0,0,.999992,204471e-13,0,0,.999989,326539e-13,0,0,.99998,603559e-13,0,0,.999971,123936e-12,0,0,.999955,269058e-12,0,0,.999933,593604e-12,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,22038e-11,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,263344e-13,0,0,1,263373e-13,0,0,1,263815e-13,0,0,1,265753e-13,0,0,1,271132e-13,0,0,.999999,283279e-13,0,0,.999997,30833e-12,0,0,.999995,358711e-13,0,0,.999992,461266e-13,0,0,.999985,67574e-12,0,0,.999977,11358e-11,0,0,.999966,213657e-12,0,0,.999948,431151e-12,0,0,.999923,896656e-12,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,628647e-13,0,0,1,628705e-13,0,0,1,629587e-13,0,0,1,633441e-13,0,0,.999999,644087e-13,0,0,.999998,667856e-13,0,0,.999997,715889e-13,0,0,.999995,809577e-13,0,0,.999989,992764e-13,0,0,.999983,135834e-12,0,0,.999974,210482e-12,0,0,.999959,365215e-12,0,0,.999939,686693e-12,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,139968e-12,0,0,1,139979e-12,0,0,1,140145e-12,0,0,1,14087e-11,0,0,.999999,142865e-12,0,0,.999998,147279e-12,0,0,.999997,156057e-12,0,0,.999992,17276e-11,0,0,.999989,204352e-12,0,0,.99998,26494e-11,0,0,.999969,383435e-12,0,0,.999953,618641e-12,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,29368e-11,0,0,1,2937e-10,0,0,1,293998e-12,0,0,1,295298e-12,0,0,.999999,298865e-12,0,0,.999998,3067e-10,0,0,.999995,322082e-12,0,0,.999992,350767e-12,0,0,.999986,403538e-12,0,0,.999976,501372e-12,0,0,.999964,68562e-11,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,585473e-12,0,0,1,585507e-12,0,0,1,58602e-11,0,0,.999999,588259e-12,0,0,.999999,594381e-12,0,0,.999998,607754e-12,0,0,.999995,633729e-12,0,0,.99999,68137e-11,0,0,.999984,767003e-12,0,0,.999973,921212e-12,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,88288e-11,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],n=new Float32Array(e),r=new Float32Array(t),i=new Ww(n,64,64,yl,ed,ox,C0,C0,e0,R0,1),a=new Ww(r,64,64,yl,ed,ox,C0,C0,e0,R0,1);i.needsUpdate=!0,a.needsUpdate=!0;const c=new Uint16Array(e.length);e.forEach(function(x,S){c[S]=D9e.toHalfFloat(x)});const u=new Uint16Array(t.length);t.forEach(function(x,S){u[S]=D9e.toHalfFloat(x)});const p=new Ww(c,64,64,yl,W3,ox,C0,C0,e0,R0,1),y=new Ww(u,64,64,yl,W3,ox,C0,C0,e0,R0,1);return p.needsUpdate=!0,y.needsUpdate=!0,this.LTC_HALF_1=p,this.LTC_HALF_2=y,this.LTC_FLOAT_1=i,this.LTC_FLOAT_2=a,this}}Zx.LTC_HALF_1=null;Zx.LTC_HALF_2=null;Zx.LTC_FLOAT_1=null;Zx.LTC_FLOAT_2=null;class vQe{static init(){Zx.init();const{LTC_FLOAT_1:e,LTC_FLOAT_2:t,LTC_HALF_1:n,LTC_HALF_2:r}=Zx;Mn.LTC_FLOAT_1=e,Mn.LTC_FLOAT_2=t,Mn.LTC_HALF_1=n,Mn.LTC_HALF_2=r}}const A8e=new Ae;class z7e extends aq{constructor(){super();Xe(this,"renderTarget");Xe(this,"mesh");this.name="RTTScene",this.camera.position.set(0,0,100),this.camera.lookAt(A8e)}init(){const t=pN.get("environment").clone();this.background=t;const n=new YW(new Pn(16777215),1);n.name="sun",this.add(n),this.mesh=new mn(new $W(10,3,100,6),new pk({envMap:t,envMapIntensity:10})),this.mesh.name="normalMesh",this.add(this.mesh);const r=new mn(new Tv(10),new Eve);r.name="ball",r.position.set(25,25,0),this.add(r);const i=new mn(new Ev(200,200),new pk({envMap:t}));i.name="floor",i.rotation.x=-Math.PI/2,i.position.set(0,-20,0),this.add(i),this.renderTarget=new ave(512,512),Vx(this);const a=this.app.components.get("three");a.addScene(this),a.addCamera(this.camera)}dispose(){const t=this.app.components.get("three");t.removeCamera(this.camera),t.removeScene(this),super.dispose()}draw(){const t=this.clock.getElapsedTime(),n=100,r=t*.05*Math.PI*2,i=Math.cos(r)*n,a=Math.sin(r)*n;this.camera.position.set(i,0,a),this.camera.lookAt(A8e),this.renderer&&(this.renderer.isWebGLRenderer?(this.renderer.setRenderTarget(this.renderTarget),this.renderer.clear(),this.renderer.render(this,this.camera),this.renderer.setRenderTarget(null)):(this.renderer.setRenderTarget(this.renderTarget),this.renderer.clearAsync(),this.renderer.renderAsync(this,this.camera),this.renderer.setRenderTarget(null)))}}const P8e="Custom Group";class V7e extends aq{constructor(){super();Xe(this,"dance");Xe(this,"rttScene");Xe(this,"speed",1);this.name="Scene2",this.rttScene=new z7e}setup(t,n){super.setup(t,n),this.rttScene.setup(t,n)}init(){this.rttScene.init();const t=this.app.components.get("three");this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createAnimation(),Vx(this),t.addScene(this),t.addCamera(this.camera),t.setScene(this),t.renderer&&(this.renderer=t.renderer)}dispose(){const t=this.app.components.get("three");t.removeCamera(this.camera),t.removeGroup(P8e),od(this.rttScene),super.dispose()}createLights(){const t=this.app.components.get("three"),n=new Ti;n.name="lights",this.add(n);const r=new XW(16777215,3);if(r.angle=5.8,r.decay=0,r.distance=1e3,r.penumbra=Math.PI,r.name="spotlight",r.position.set(-250,200,200),r.lookAt(0,50,0),n.add(r),t.renderer!==void 0&&t.renderer.isWebGLRenderer){vQe.init();const i=new fke(16711680,1,300,100);i.name="rectLight",i.position.set(250,100,100),i.lookAt(0,50,0),n.add(i)}}createWorld(){const t=this.app.components.get("three"),n=pN.get("environment").clone();this.background=n;const r=new Ti;r.name="world",this.add(r);const i=oq.get("uv_grid");i.repeat.setScalar(10),i.needsUpdate=!0;const a=new pk({map:i,envMap:n}),c=new mn(new Wk(250,36),a);c.name="floor",c.receiveShadow=!0,c.position.y=-2,c.rotateX(-Math.PI/2),r.add(c);const u=new AIe(new Tv(50),new mve({size:.5}));u.name="points",u.position.set(-100,50,0),r.add(u);const p=new BE(new Tv(50),new Ff);p.name="lines",p.position.set(100,50,0),r.add(p);const y=new eh;y.map=this.rttScene.renderTarget.texture;const x=new mn(new Ev(100,100),y);if(x.name="rttExample",x.position.set(-75,50,-125),r.add(x),t.renderer.isWebGLRenderer){const S=new mn(new Ev(100,100),new E7e);S.name="customShaderMaterial",S.position.set(75,50,-125),r.add(S)}else x.scale.y=-1,y.side=Qo,y.needsUpdate=!0;this.dance=new B7e("Flair"),this.dance.name="flair",this.dance.traverse(S=>{if(S instanceof UW){const M=S;M.material=new Mve}}),r.add(this.dance),t.addGroup({title:P8e,items:[{title:"Speed",prop:"speed",value:1,min:0,max:2,step:.01,type:"range"},{title:"Name",prop:"name",value:"Hello World!",type:"string"},{title:"Color",prop:"color",value:new Pn(16711680),type:"color"}],onUpdate:(S,M)=>{switch(console.log(S,M),S){case"speed":this.speed=M;break}}})}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)})}update(){const t=this.clock.getDelta();this.dance.update(t*this.speed),this.rttScene.update(),this.rttScene.draw()}resize(t,n){super.resize(t,n),this.rttScene.resize(t,n)}}function yQe(s){Tn.useEffect(()=>{iKe()},[]);const e=s.app.components.get("three"),t=new Map;return t.set("Scene1",U7e),t.set("Scene2",V7e),t.set("RTTScene",z7e),Ke.jsx(rKe,{three:e,scenes:t,onSceneAdd:n=>{var r;n.setup(s.app,(r=da.instance)==null?void 0:r.renderer),n.init()},onSceneUpdate:n=>{n.update()}})}class G7e{constructor(e,t,n){this.id=0,this.name=e,this.fg=t,this.bg=n,this.gradient=null,this.PR=Math.round(window.devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=document.createElement("canvas"),this.canvas.width=this.WIDTH,this.canvas.height=this.HEIGHT,this.canvas.style.width="90px",this.canvas.style.height="48px",this.canvas.style.position="absolute",this.canvas.style.cssText="width:90px;height:48px;background-color: transparent !important;",this.context=this.canvas.getContext("2d"),this.initializeCanvas()}createGradient(){if(!this.context)throw new Error("No context");const e=this.context.createLinearGradient(0,this.GRAPH_Y,0,this.GRAPH_Y+this.GRAPH_HEIGHT);let t;const n=this.fg;switch(this.fg.toLowerCase()){case"#0ff":t="#006666";break;case"#0f0":t="#006600";break;case"#ff0":t="#666600";break;case"#e1e1e1":t="#666666";break;default:t=this.bg;break}return e.addColorStop(0,t),e.addColorStop(1,n),e}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.gradient=this.createGradient(),this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}update(e,t,n=0){if(!this.context||!this.gradient)return;const r=Math.min(1/0,e),i=Math.max(t,e);this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(`${e.toFixed(n)} ${this.name} (${r.toFixed(n)}-${parseFloat(i.toFixed(n))})`,this.TEXT_X,this.TEXT_Y)}updateGraph(e,t){if(!this.context||!this.gradient)return;e===0&&t===0&&(t=1),t=Math.max(t,e,.1),e=Math.max(e,0);const n=Math.round(this.GRAPH_X),r=Math.round(this.GRAPH_Y),i=Math.round(this.GRAPH_WIDTH),a=Math.round(this.GRAPH_HEIGHT),c=Math.round(this.PR);this.context.drawImage(this.canvas,n+c,r,i-c,a,n,r,i-c,a),this.context.fillStyle=this.bg,this.context.fillRect(n+i-c,r,c,a);const u=Math.min(a,Math.round(e/t*a));u>0&&(this.context.globalAlpha=.9,this.context.fillStyle=this.gradient,this.context.fillRect(n+i-c,r+(a-u),c,u)),this.context.globalAlpha=1}}class xQe extends G7e{constructor(e,t,n){super(e,t,n),this.vsyncValue=0,this.SMALL_HEIGHT=9*this.PR,this.HEIGHT=this.SMALL_HEIGHT,this.WIDTH=35*this.PR,this.TEXT_Y=0*this.PR,this.canvas.height=this.HEIGHT,this.canvas.width=this.WIDTH,this.canvas.style.height="9px",this.canvas.style.width="35px",this.canvas.style.cssText=`
            width: 35px;
            height: 9px;
            position: absolute;
            top: 0;
            left: 0;
            background-color: transparent !important;
            pointer-events: none;
        `,this.initializeCanvas()}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.context.globalAlpha=1)}update(e,t,n=0){this.context&&(this.vsyncValue=e,this.context.clearRect(0,0,this.WIDTH,this.HEIGHT),this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillText(`${e.toFixed(0)}Hz`,this.TEXT_X,this.TEXT_Y))}updateGraph(e,t){}setOffset(e,t){this.canvas.style.transform=`translate(${e}px, ${t}px)`}}const j7e=class ix{constructor({trackGPU:e=!1,trackCPT:t=!1,trackHz:n=!1,logsPerSecond:r=4,graphsPerSecond:i=30,samplesLog:a=40,samplesGraph:c=10,precision:u=2,minimal:p=!1,horizontal:y=!0,mode:x=0}={}){this.gl=null,this.ext=null,this.activeQuery=null,this.gpuQueries=[],this.threeRendererPatched=!1,this.frameTimes=[],this.renderCount=0,this.totalCpuDuration=0,this.totalGpuDuration=0,this.totalGpuDurationCompute=0,this.gpuPanel=null,this.gpuPanelCompute=null,this.vsyncPanel=null,this.averageFps={logs:[],graph:[]},this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.averageGpuCompute={logs:[],graph:[]},this.updateCounter=0,this.lastMin={},this.lastMax={},this.lastValue={},this.VSYNC_RATES=[{refreshRate:60,frameTime:16.67},{refreshRate:75,frameTime:13.33},{refreshRate:90,frameTime:11.11},{refreshRate:120,frameTime:8.33},{refreshRate:144,frameTime:6.94},{refreshRate:165,frameTime:6.06},{refreshRate:240,frameTime:4.17}],this.detectedVSync=null,this.frameTimeHistory=[],this.HISTORY_SIZE=120,this.VSYNC_THRESHOLD=.05,this.lastFrameTime=0,this.handleClick=M=>{M.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},this.handleResize=()=>{this.resizePanel(this.fpsPanel),this.resizePanel(this.msPanel),this.gpuPanel&&this.resizePanel(this.gpuPanel),this.gpuPanelCompute&&this.resizePanel(this.gpuPanelCompute)},this.mode=x,this.horizontal=y,this.minimal=p,this.trackGPU=e,this.trackCPT=t,this.trackHz=n,this.samplesLog=a,this.samplesGraph=c,this.precision=u,this.logsPerSecond=r,this.graphsPerSecond=i;const S=performance.now();this.prevGraphTime=S,this.dom=document.createElement("div"),this.initializeDOM(),this.beginTime=performance.now(),this.prevTextTime=this.beginTime,this.prevCpuTime=this.beginTime,this._panelId=0,this.fpsPanel=this.addPanel(new ix.Panel("FPS","#0ff","#002")),this.msPanel=this.addPanel(new ix.Panel("CPU","#0f0","#020")),this.trackHz===!0&&(this.vsyncPanel=new xQe("","#f0f","#202"),this.dom.appendChild(this.vsyncPanel.canvas),this.vsyncPanel.setOffset(56,35)),this.setupEventListeners()}initializeDOM(){this.dom.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      opacity: 0.9;
      z-index: 10000;
      ${this.minimal?"cursor: pointer;":""}
    `}setupEventListeners(){this.minimal?(this.dom.addEventListener("click",this.handleClick),this.showPanel(this.mode)):window.addEventListener("resize",this.handleResize)}async init(e){if(!e){console.error('Stats: The "canvas" parameter is undefined.');return}if(!this.handleThreeRenderer(e)&&!await this.handleWebGPURenderer(e))if(this.initializeWebGL(e)){this.trackGPU&&this.initializeGPUTracking();return}else console.error("Stats-gl: Failed to initialize WebGL context")}handleThreeRenderer(e){return e.isWebGLRenderer&&!this.threeRendererPatched?(this.patchThreeRenderer(e),this.gl=e.getContext(),this.trackGPU&&this.initializeGPUTracking(),!0):!1}async handleWebGPURenderer(e){return e.isWebGPURenderer?((this.trackGPU||this.trackCPT)&&(e.backend.trackTimestamp=!0,await e.hasFeatureAsync("timestamp-query")&&this.initializeWebGPUPanels()),this.info=e.info,this.patchThreeWebGPU(e),!0):!1}initializeWebGPUPanels(){this.trackGPU&&(this.gpuPanel=this.addPanel(new ix.Panel("GPU","#ff0","#220"))),this.trackCPT&&(this.gpuPanelCompute=this.addPanel(new ix.Panel("CPT","#e1e1e1","#212121")))}initializeWebGL(e){if(e instanceof WebGL2RenderingContext)this.gl=e;else if(e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas){if(this.gl=e.getContext("webgl2"),!this.gl)return console.error("Stats: Unable to obtain WebGL2 context."),!1}else return console.error("Stats: Invalid input type. Expected WebGL2RenderingContext, HTMLCanvasElement, or OffscreenCanvas."),!1;return!0}initializeGPUTracking(){this.gl&&(this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new ix.Panel("GPU","#ff0","#220"))))}begin(){this.beginProfiling("cpu-started"),!(!this.gl||!this.ext)&&(this.activeQuery&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.activeQuery=this.gl.createQuery(),this.activeQuery&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery))}end(){this.renderCount++,this.gl&&this.ext&&this.activeQuery&&(this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.gpuQueries.push({query:this.activeQuery}),this.activeQuery=null),this.endProfiling("cpu-started","cpu-finished","cpu-duration")}update(){this.endProfiling("cpu-started","cpu-finished","cpu-duration"),this.info?this.processWebGPUTimestamps():this.processGpuQueries(),this.updateAverages(),this.resetCounters()}processWebGPUTimestamps(){this.totalGpuDuration=this.info.render.timestamp,this.totalGpuDurationCompute=this.info.compute.timestamp}resetCounters(){this.renderCount=0,this.totalCpuDuration=0,this.beginTime=this.endInternal()}resizePanel(e){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=e.id*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=e.id*e.HEIGHT/e.PR+"px"))}addPanel(e){return e.canvas&&(this.dom.appendChild(e.canvas),e.id=this._panelId,this.resizePanel(e),this._panelId++),e}showPanel(e){for(let t=0;t<this.dom.children.length;t++){const n=this.dom.children[t];n.style.display=t===e?"block":"none"}this.mode=e}processGpuQueries(){!this.gl||!this.ext||(this.totalGpuDuration=0,this.gpuQueries.forEach((e,t)=>{if(this.gl){const n=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),r=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT);if(n&&!r){const a=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT)*1e-6;this.totalGpuDuration+=a,this.gl.deleteQuery(e.query),this.gpuQueries.splice(t,1)}}}))}detectVSync(e){if(this.lastFrameTime===0){this.lastFrameTime=e;return}const t=e-this.lastFrameTime;if(this.lastFrameTime=e,this.frameTimeHistory.push(t),this.frameTimeHistory.length>this.HISTORY_SIZE&&this.frameTimeHistory.shift(),this.frameTimeHistory.length<60)return;const n=this.frameTimeHistory.reduce((u,p)=>u+p)/this.frameTimeHistory.length,r=this.frameTimeHistory.reduce((u,p)=>u+Math.pow(p-n,2),0)/this.frameTimeHistory.length;if(Math.sqrt(r)>2){this.detectedVSync=null;return}let a=null,c=1/0;for(const u of this.VSYNC_RATES){const p=Math.abs(n-u.frameTime);p<c&&(c=p,a=u)}a&&c/a.frameTime<=this.VSYNC_THRESHOLD?this.detectedVSync=a:this.detectedVSync=null}endInternal(){var e;const t=performance.now();for(this.frameTimes.push(t);this.frameTimes.length>0&&this.frameTimes[0]<=t-1e3;)this.frameTimes.shift();const n=Math.round(this.frameTimes.length);this.addToAverage(n,this.averageFps);const r=t>=this.prevTextTime+1e3/this.logsPerSecond,i=t>=this.prevGraphTime+1e3/this.graphsPerSecond;if(this.updatePanelComponents(this.fpsPanel,this.averageFps,0,r,i),this.updatePanelComponents(this.msPanel,this.averageCpu,this.precision,r,i),this.gpuPanel&&this.updatePanelComponents(this.gpuPanel,this.averageGpu,this.precision,r,i),this.trackCPT&&this.gpuPanelCompute&&this.updatePanelComponents(this.gpuPanelCompute,this.averageGpuCompute,this.precision,r,i),r&&(this.prevTextTime=t),i&&(this.prevGraphTime=t),this.vsyncPanel!==null){this.detectVSync(t);const a=((e=this.detectedVSync)==null?void 0:e.refreshRate)||0;r&&a>0&&this.vsyncPanel.update(a,a)}return t}updatePanelComponents(e,t,n,r,i){if(!e||t.logs.length===0)return;e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const a=t.logs[t.logs.length-1];this.lastMax[e.name]=Math.max(...t.logs),this.lastMin[e.name]=Math.min(this.lastMin[e.name],a),this.lastValue[e.name]=this.lastValue[e.name]*.7+a*.3;const c=Math.max(Math.max(...t.logs),...t.graph.slice(-this.samplesGraph));this.updateCounter++,r&&e.update(this.lastValue[e.name],this.lastMax[e.name],n),i&&e.updateGraph(a,c)}beginProfiling(e){if(window.performance)try{window.performance.clearMarks(e),window.performance.mark(e)}catch(t){console.debug("Stats: Performance marking failed:",t)}}endProfiling(e,t,n){if(!(!window.performance||!t||!e))try{window.performance.getEntriesByName(e,"mark").length===0&&this.beginProfiling(e),window.performance.clearMarks(t),window.performance.mark(t),window.performance.clearMeasures(n);const i=performance.measure(n,e,t);this.totalCpuDuration+=i.duration,window.performance.clearMarks(e),window.performance.clearMarks(t),window.performance.clearMeasures(n)}catch(r){console.debug("Stats: Performance measurement failed:",r)}}updatePanel(e,t,n=2){if(!e||t.logs.length===0)return;const r=performance.now();e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const i=t.logs[t.logs.length-1],a=Math.max(...t.logs.slice(-30));this.lastMin[e.name]=Math.min(this.lastMin[e.name],i),this.lastMax[e.name]=Math.max(this.lastMax[e.name],i),this.lastValue[e.name]=this.lastValue[e.name]*.7+i*.3;const c=Math.max(a,...t.graph.slice(-this.samplesGraph));this.updateCounter++,this.updateCounter%(this.logsPerSecond*2)===0&&(this.lastMax[e.name]=a,this.lastMin[e.name]=i),e.update&&(r>=this.prevCpuTime+1e3/this.logsPerSecond&&e.update(this.lastValue[e.name],i,this.lastMax[e.name],c,n),r>=this.prevGraphTime+1e3/this.graphsPerSecond&&(e.updateGraph(i,c),this.prevGraphTime=r))}updateAverages(){this.addToAverage(this.totalCpuDuration,this.averageCpu),this.addToAverage(this.totalGpuDuration,this.averageGpu),this.info&&this.totalGpuDurationCompute!==void 0&&this.addToAverage(this.totalGpuDurationCompute,this.averageGpuCompute)}addToAverage(e,t){t.logs.push(e),t.logs.length>this.samplesLog&&(t.logs=t.logs.slice(-this.samplesLog)),t.graph.push(e),t.graph.length>this.samplesGraph&&(t.graph=t.graph.slice(-this.samplesGraph))}get domElement(){return this.dom}patchThreeWebGPU(e){const t=e.info.reset,n=this;e.info.reset=function(){n.beginProfiling("cpu-started"),t.call(this)}}patchThreeRenderer(e){const t=e.render,n=this;e.render=function(r,i){n.begin(),t.call(this,r,i),n.end()},this.threeRendererPatched=!0}};j7e.Panel=G7e;let _Qe=j7e,Pg,bo,Gw="";function bQe(s){const e=s.app,t=Tn.useRef(null),n=s.app.components.get("three");console.log("Settings",e.settings),e.isApp&&Tn.useEffect(()=>{const c=t.current;Pg=new hx({canvas:c,stencil:!1}),Pg.shadowMap.enabled=!0,Pg.setPixelRatio(devicePixelRatio),Pg.setClearColor(0),n.setRenderer(Pg,c);const u=new _Qe;u.init(Pg),document.body.appendChild(u.dom);let p=-1;const y=()=>{const S=window.innerWidth,M=window.innerHeight;bo==null||bo.resize(S,M),Pg.setSize(S,M)},x=()=>{bo==null||bo.update(),bo==null||bo.draw(),u.update(),p=requestAnimationFrame(x)};return window.addEventListener("resize",y),y(),x(),()=>{bo!==void 0&&(n.removeCamera(bo.camera),n.removeScene(bo),od(bo)),window.removeEventListener("resize",y),cancelAnimationFrame(p),p=-1,Pg.dispose()}},[]);const r=()=>{bo!==void 0&&(bo.camera!==void 0&&n.removeCamera(bo.camera),n.removeScene(bo),od(bo),gQe(n)),Gw==="scene1"?bo=new U7e:bo=new V7e,bo.setup(e,Pg),bo.init(),bo.resize(window.innerWidth,window.innerHeight)},i=()=>{Gw!=="scene1"&&(Gw="scene1",r())},a=()=>{Gw!=="scene2"&&(Gw="scene2",r())};return Ke.jsx(Ke.Fragment,{children:e.isApp&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("canvas",{ref:t}),Ke.jsxs("div",{style:{position:"absolute",bottom:"20px",left:"20px"},children:[Ke.jsx("button",{onClick:i,children:"Scene 1"}),Ke.jsx("button",{onClick:a,children:"Scene 2"})]})]})})}function SQe(s){const[e,t]=Tn.useState(!1);return Tn.useEffect(()=>{const n=()=>{AH.removeEventListener(gk.LOAD_COMPLETE,n),t(!0)};AH.addEventListener(gk.LOAD_COMPLETE,n),fQe(s.app)},[t]),Ke.jsxs(Ke.Fragment,{children:[!e&&Ke.jsx("p",{children:"Loading..."}),e&&s.app.isApp&&Ke.jsx(bQe,{app:s.app})]})}function wQe(){const[s,e]=Tn.useState(null);return Tn.useEffect(()=>{const t=new MFe;t.detectSettings(KV,ZV).then(()=>{t.addComponent("theatre",new kFe(KV,ZV));const n=new BFe("Hermes Example",KV,ZV);t.addComponent("three",n),e(t)})},[]),Ke.jsx(Ke.Fragment,{children:s!==null&&Ke.jsxs(Ke.Fragment,{children:[s.debugEnabled&&Ke.jsx(UFe,{app:s}),s.editor&&Ke.jsx(yQe,{app:s}),Ke.jsx(SQe,{app:s})]})})}k8e.initialize();cRe.createRoot(document.getElementById("root")).render(Ke.jsx(Ke.Fragment,{children:Ke.jsx(Ke.Fragment,{children:Ke.jsx(wQe,{})})}));
