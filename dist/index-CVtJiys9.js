var jIe=Object.defineProperty;var HIe=(i,e,t)=>e in i?jIe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Xe=(i,e,t)=>HIe(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var tl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ave(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var xG={exports:{}},Qw={},bG={exports:{}},Ai={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G3e;function WIe(){if(G3e)return Ai;G3e=1;var i=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function w(Ne){return Ne===null||typeof Ne!="object"?null:(Ne=x&&Ne[x]||Ne["@@iterator"],typeof Ne=="function"?Ne:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,F={};function U(Ne,ht,Ot){this.props=Ne,this.context=ht,this.refs=F,this.updater=Ot||C}U.prototype.isReactComponent={},U.prototype.setState=function(Ne,ht){if(typeof Ne!="object"&&typeof Ne!="function"&&Ne!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ne,ht,"setState")},U.prototype.forceUpdate=function(Ne){this.updater.enqueueForceUpdate(this,Ne,"forceUpdate")};function R(){}R.prototype=U.prototype;function B(Ne,ht,Ot){this.props=Ne,this.context=ht,this.refs=F,this.updater=Ot||C}var Y=B.prototype=new R;Y.constructor=B,N(Y,U.prototype),Y.isPureReactComponent=!0;var A=Array.isArray,ne=Object.prototype.hasOwnProperty,se={current:null},oe={key:!0,ref:!0,__self:!0,__source:!0};function G(Ne,ht,Ot){var wn,bn={},Tt=null,Gt=null;if(ht!=null)for(wn in ht.ref!==void 0&&(Gt=ht.ref),ht.key!==void 0&&(Tt=""+ht.key),ht)ne.call(ht,wn)&&!oe.hasOwnProperty(wn)&&(bn[wn]=ht[wn]);var $t=arguments.length-2;if($t===1)bn.children=Ot;else if(1<$t){for(var Ln=Array($t),jn=0;jn<$t;jn++)Ln[jn]=arguments[jn+2];bn.children=Ln}if(Ne&&Ne.defaultProps)for(wn in $t=Ne.defaultProps,$t)bn[wn]===void 0&&(bn[wn]=$t[wn]);return{$$typeof:i,type:Ne,key:Tt,ref:Gt,props:bn,_owner:se.current}}function ie(Ne,ht){return{$$typeof:i,type:Ne.type,key:ht,ref:Ne.ref,props:Ne.props,_owner:Ne._owner}}function Me(Ne){return typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===i}function X(Ne){var ht={"=":"=0",":":"=2"};return"$"+Ne.replace(/[=:]/g,function(Ot){return ht[Ot]})}var De=/\/+/g;function $e(Ne,ht){return typeof Ne=="object"&&Ne!==null&&Ne.key!=null?X(""+Ne.key):ht.toString(36)}function ot(Ne,ht,Ot,wn,bn){var Tt=typeof Ne;(Tt==="undefined"||Tt==="boolean")&&(Ne=null);var Gt=!1;if(Ne===null)Gt=!0;else switch(Tt){case"string":case"number":Gt=!0;break;case"object":switch(Ne.$$typeof){case i:case e:Gt=!0}}if(Gt)return Gt=Ne,bn=bn(Gt),Ne=wn===""?"."+$e(Gt,0):wn,A(bn)?(Ot="",Ne!=null&&(Ot=Ne.replace(De,"$&/")+"/"),ot(bn,ht,Ot,"",function(jn){return jn})):bn!=null&&(Me(bn)&&(bn=ie(bn,Ot+(!bn.key||Gt&&Gt.key===bn.key?"":(""+bn.key).replace(De,"$&/")+"/")+Ne)),ht.push(bn)),1;if(Gt=0,wn=wn===""?".":wn+":",A(Ne))for(var $t=0;$t<Ne.length;$t++){Tt=Ne[$t];var Ln=wn+$e(Tt,$t);Gt+=ot(Tt,ht,Ot,Ln,bn)}else if(Ln=w(Ne),typeof Ln=="function")for(Ne=Ln.call(Ne),$t=0;!(Tt=Ne.next()).done;)Tt=Tt.value,Ln=wn+$e(Tt,$t++),Gt+=ot(Tt,ht,Ot,Ln,bn);else if(Tt==="object")throw ht=String(Ne),Error("Objects are not valid as a React child (found: "+(ht==="[object Object]"?"object with keys {"+Object.keys(Ne).join(", ")+"}":ht)+"). If you meant to render a collection of children, use an array instead.");return Gt}function He(Ne,ht,Ot){if(Ne==null)return Ne;var wn=[],bn=0;return ot(Ne,wn,"","",function(Tt){return ht.call(Ot,Tt,bn++)}),wn}function ce(Ne){if(Ne._status===-1){var ht=Ne._result;ht=ht(),ht.then(function(Ot){(Ne._status===0||Ne._status===-1)&&(Ne._status=1,Ne._result=Ot)},function(Ot){(Ne._status===0||Ne._status===-1)&&(Ne._status=2,Ne._result=Ot)}),Ne._status===-1&&(Ne._status=0,Ne._result=ht)}if(Ne._status===1)return Ne._result.default;throw Ne._result}var Ge={current:null},Ie={transition:null},st={ReactCurrentDispatcher:Ge,ReactCurrentBatchConfig:Ie,ReactCurrentOwner:se};function bt(){throw Error("act(...) is not supported in production builds of React.")}return Ai.Children={map:He,forEach:function(Ne,ht,Ot){He(Ne,function(){ht.apply(this,arguments)},Ot)},count:function(Ne){var ht=0;return He(Ne,function(){ht++}),ht},toArray:function(Ne){return He(Ne,function(ht){return ht})||[]},only:function(Ne){if(!Me(Ne))throw Error("React.Children.only expected to receive a single React element child.");return Ne}},Ai.Component=U,Ai.Fragment=t,Ai.Profiler=r,Ai.PureComponent=B,Ai.StrictMode=n,Ai.Suspense=d,Ai.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=st,Ai.act=bt,Ai.cloneElement=function(Ne,ht,Ot){if(Ne==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Ne+".");var wn=N({},Ne.props),bn=Ne.key,Tt=Ne.ref,Gt=Ne._owner;if(ht!=null){if(ht.ref!==void 0&&(Tt=ht.ref,Gt=se.current),ht.key!==void 0&&(bn=""+ht.key),Ne.type&&Ne.type.defaultProps)var $t=Ne.type.defaultProps;for(Ln in ht)ne.call(ht,Ln)&&!oe.hasOwnProperty(Ln)&&(wn[Ln]=ht[Ln]===void 0&&$t!==void 0?$t[Ln]:ht[Ln])}var Ln=arguments.length-2;if(Ln===1)wn.children=Ot;else if(1<Ln){$t=Array(Ln);for(var jn=0;jn<Ln;jn++)$t[jn]=arguments[jn+2];wn.children=$t}return{$$typeof:i,type:Ne.type,key:bn,ref:Tt,props:wn,_owner:Gt}},Ai.createContext=function(Ne){return Ne={$$typeof:a,_currentValue:Ne,_currentValue2:Ne,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Ne.Provider={$$typeof:s,_context:Ne},Ne.Consumer=Ne},Ai.createElement=G,Ai.createFactory=function(Ne){var ht=G.bind(null,Ne);return ht.type=Ne,ht},Ai.createRef=function(){return{current:null}},Ai.forwardRef=function(Ne){return{$$typeof:c,render:Ne}},Ai.isValidElement=Me,Ai.lazy=function(Ne){return{$$typeof:y,_payload:{_status:-1,_result:Ne},_init:ce}},Ai.memo=function(Ne,ht){return{$$typeof:p,type:Ne,compare:ht===void 0?null:ht}},Ai.startTransition=function(Ne){var ht=Ie.transition;Ie.transition={};try{Ne()}finally{Ie.transition=ht}},Ai.unstable_act=bt,Ai.useCallback=function(Ne,ht){return Ge.current.useCallback(Ne,ht)},Ai.useContext=function(Ne){return Ge.current.useContext(Ne)},Ai.useDebugValue=function(){},Ai.useDeferredValue=function(Ne){return Ge.current.useDeferredValue(Ne)},Ai.useEffect=function(Ne,ht){return Ge.current.useEffect(Ne,ht)},Ai.useId=function(){return Ge.current.useId()},Ai.useImperativeHandle=function(Ne,ht,Ot){return Ge.current.useImperativeHandle(Ne,ht,Ot)},Ai.useInsertionEffect=function(Ne,ht){return Ge.current.useInsertionEffect(Ne,ht)},Ai.useLayoutEffect=function(Ne,ht){return Ge.current.useLayoutEffect(Ne,ht)},Ai.useMemo=function(Ne,ht){return Ge.current.useMemo(Ne,ht)},Ai.useReducer=function(Ne,ht,Ot){return Ge.current.useReducer(Ne,ht,Ot)},Ai.useRef=function(Ne){return Ge.current.useRef(Ne)},Ai.useState=function(Ne){return Ge.current.useState(Ne)},Ai.useSyncExternalStore=function(Ne,ht,Ot){return Ge.current.useSyncExternalStore(Ne,ht,Ot)},Ai.useTransition=function(){return Ge.current.useTransition()},Ai.version="18.3.1",Ai}var j3e;function bW(){return j3e||(j3e=1,bG.exports=WIe()),bG.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H3e;function qIe(){if(H3e)return Qw;H3e=1;var i=bW(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(c,d,p){var y,x={},w=null,C=null;p!==void 0&&(w=""+p),d.key!==void 0&&(w=""+d.key),d.ref!==void 0&&(C=d.ref);for(y in d)n.call(d,y)&&!s.hasOwnProperty(y)&&(x[y]=d[y]);if(c&&c.defaultProps)for(y in d=c.defaultProps,d)x[y]===void 0&&(x[y]=d[y]);return{$$typeof:e,type:c,key:w,ref:C,props:x,_owner:r.current}}return Qw.Fragment=t,Qw.jsx=a,Qw.jsxs=a,Qw}var W3e;function $Ie(){return W3e||(W3e=1,xG.exports=qIe()),xG.exports}var rt=$Ie(),Nn=bW(),SI={},SG={exports:{}},yu={},wG={exports:{}},TG={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q3e;function XIe(){return q3e||(q3e=1,function(i){function e(Ie,st){var bt=Ie.length;Ie.push(st);e:for(;0<bt;){var Ne=bt-1>>>1,ht=Ie[Ne];if(0<r(ht,st))Ie[Ne]=st,Ie[bt]=ht,bt=Ne;else break e}}function t(Ie){return Ie.length===0?null:Ie[0]}function n(Ie){if(Ie.length===0)return null;var st=Ie[0],bt=Ie.pop();if(bt!==st){Ie[0]=bt;e:for(var Ne=0,ht=Ie.length,Ot=ht>>>1;Ne<Ot;){var wn=2*(Ne+1)-1,bn=Ie[wn],Tt=wn+1,Gt=Ie[Tt];if(0>r(bn,bt))Tt<ht&&0>r(Gt,bn)?(Ie[Ne]=Gt,Ie[Tt]=bt,Ne=Tt):(Ie[Ne]=bn,Ie[wn]=bt,Ne=wn);else if(Tt<ht&&0>r(Gt,bt))Ie[Ne]=Gt,Ie[Tt]=bt,Ne=Tt;else break e}}return st}function r(Ie,st){var bt=Ie.sortIndex-st.sortIndex;return bt!==0?bt:Ie.id-st.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();i.unstable_now=function(){return a.now()-c}}var d=[],p=[],y=1,x=null,w=3,C=!1,N=!1,F=!1,U=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Y(Ie){for(var st=t(p);st!==null;){if(st.callback===null)n(p);else if(st.startTime<=Ie)n(p),st.sortIndex=st.expirationTime,e(d,st);else break;st=t(p)}}function A(Ie){if(F=!1,Y(Ie),!N)if(t(d)!==null)N=!0,ce(ne);else{var st=t(p);st!==null&&Ge(A,st.startTime-Ie)}}function ne(Ie,st){N=!1,F&&(F=!1,R(G),G=-1),C=!0;var bt=w;try{for(Y(st),x=t(d);x!==null&&(!(x.expirationTime>st)||Ie&&!X());){var Ne=x.callback;if(typeof Ne=="function"){x.callback=null,w=x.priorityLevel;var ht=Ne(x.expirationTime<=st);st=i.unstable_now(),typeof ht=="function"?x.callback=ht:x===t(d)&&n(d),Y(st)}else n(d);x=t(d)}if(x!==null)var Ot=!0;else{var wn=t(p);wn!==null&&Ge(A,wn.startTime-st),Ot=!1}return Ot}finally{x=null,w=bt,C=!1}}var se=!1,oe=null,G=-1,ie=5,Me=-1;function X(){return!(i.unstable_now()-Me<ie)}function De(){if(oe!==null){var Ie=i.unstable_now();Me=Ie;var st=!0;try{st=oe(!0,Ie)}finally{st?$e():(se=!1,oe=null)}}else se=!1}var $e;if(typeof B=="function")$e=function(){B(De)};else if(typeof MessageChannel<"u"){var ot=new MessageChannel,He=ot.port2;ot.port1.onmessage=De,$e=function(){He.postMessage(null)}}else $e=function(){U(De,0)};function ce(Ie){oe=Ie,se||(se=!0,$e())}function Ge(Ie,st){G=U(function(){Ie(i.unstable_now())},st)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Ie){Ie.callback=null},i.unstable_continueExecution=function(){N||C||(N=!0,ce(ne))},i.unstable_forceFrameRate=function(Ie){0>Ie||125<Ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<Ie?Math.floor(1e3/Ie):5},i.unstable_getCurrentPriorityLevel=function(){return w},i.unstable_getFirstCallbackNode=function(){return t(d)},i.unstable_next=function(Ie){switch(w){case 1:case 2:case 3:var st=3;break;default:st=w}var bt=w;w=st;try{return Ie()}finally{w=bt}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Ie,st){switch(Ie){case 1:case 2:case 3:case 4:case 5:break;default:Ie=3}var bt=w;w=Ie;try{return st()}finally{w=bt}},i.unstable_scheduleCallback=function(Ie,st,bt){var Ne=i.unstable_now();switch(typeof bt=="object"&&bt!==null?(bt=bt.delay,bt=typeof bt=="number"&&0<bt?Ne+bt:Ne):bt=Ne,Ie){case 1:var ht=-1;break;case 2:ht=250;break;case 5:ht=1073741823;break;case 4:ht=1e4;break;default:ht=5e3}return ht=bt+ht,Ie={id:y++,callback:st,priorityLevel:Ie,startTime:bt,expirationTime:ht,sortIndex:-1},bt>Ne?(Ie.sortIndex=bt,e(p,Ie),t(d)===null&&Ie===t(p)&&(F?(R(G),G=-1):F=!0,Ge(A,bt-Ne))):(Ie.sortIndex=ht,e(d,Ie),N||C||(N=!0,ce(ne))),Ie},i.unstable_shouldYield=X,i.unstable_wrapCallback=function(Ie){var st=w;return function(){var bt=w;w=st;try{return Ie.apply(this,arguments)}finally{w=bt}}}}(TG)),TG}var $3e;function YIe(){return $3e||($3e=1,wG.exports=XIe()),wG.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X3e;function KIe(){if(X3e)return yu;X3e=1;var i=bW(),e=YIe();function t(h){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+h,T=1;T<arguments.length;T++)g+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function s(h,g){a(h,g),a(h+"Capture",g)}function a(h,g){for(r[h]=g,h=0;h<g.length;h++)n.add(g[h])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},x={};function w(h){return d.call(x,h)?!0:d.call(y,h)?!1:p.test(h)?x[h]=!0:(y[h]=!0,!1)}function C(h,g,T,D){if(T!==null&&T.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return D?!1:T!==null?!T.acceptsBooleans:(h=h.toLowerCase().slice(0,5),h!=="data-"&&h!=="aria-");default:return!1}}function N(h,g,T,D){if(g===null||typeof g>"u"||C(h,g,T,D))return!0;if(D)return!1;if(T!==null)switch(T.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function F(h,g,T,D,W,J,fe){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=D,this.attributeNamespace=W,this.mustUseProperty=T,this.propertyName=h,this.type=g,this.sanitizeURL=J,this.removeEmptyString=fe}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(h){U[h]=new F(h,0,!1,h,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(h){var g=h[0];U[g]=new F(g,1,!1,h[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(h){U[h]=new F(h,2,!1,h.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(h){U[h]=new F(h,2,!1,h,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(h){U[h]=new F(h,3,!1,h.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(h){U[h]=new F(h,3,!0,h,null,!1,!1)}),["capture","download"].forEach(function(h){U[h]=new F(h,4,!1,h,null,!1,!1)}),["cols","rows","size","span"].forEach(function(h){U[h]=new F(h,6,!1,h,null,!1,!1)}),["rowSpan","start"].forEach(function(h){U[h]=new F(h,5,!1,h.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function B(h){return h[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(h){var g=h.replace(R,B);U[g]=new F(g,1,!1,h,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(h){var g=h.replace(R,B);U[g]=new F(g,1,!1,h,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(h){var g=h.replace(R,B);U[g]=new F(g,1,!1,h,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(h){U[h]=new F(h,1,!1,h.toLowerCase(),null,!1,!1)}),U.xlinkHref=new F("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(h){U[h]=new F(h,1,!1,h.toLowerCase(),null,!0,!0)});function Y(h,g,T,D){var W=U.hasOwnProperty(g)?U[g]:null;(W!==null?W.type!==0:D||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(N(g,T,W,D)&&(T=null),D||W===null?w(g)&&(T===null?h.removeAttribute(g):h.setAttribute(g,""+T)):W.mustUseProperty?h[W.propertyName]=T===null?W.type===3?!1:"":T:(g=W.attributeName,D=W.attributeNamespace,T===null?h.removeAttribute(g):(W=W.type,T=W===3||W===4&&T===!0?"":""+T,D?h.setAttributeNS(D,g,T):h.setAttribute(g,T))))}var A=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ne=Symbol.for("react.element"),se=Symbol.for("react.portal"),oe=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),ie=Symbol.for("react.profiler"),Me=Symbol.for("react.provider"),X=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),$e=Symbol.for("react.suspense"),ot=Symbol.for("react.suspense_list"),He=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),Ge=Symbol.for("react.offscreen"),Ie=Symbol.iterator;function st(h){return h===null||typeof h!="object"?null:(h=Ie&&h[Ie]||h["@@iterator"],typeof h=="function"?h:null)}var bt=Object.assign,Ne;function ht(h){if(Ne===void 0)try{throw Error()}catch(T){var g=T.stack.trim().match(/\n( *(at )?)/);Ne=g&&g[1]||""}return`
`+Ne+h}var Ot=!1;function wn(h,g){if(!h||Ot)return"";Ot=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(It){var D=It}Reflect.construct(h,[],g)}else{try{g.call()}catch(It){D=It}h.call(g.prototype)}else{try{throw Error()}catch(It){D=It}h()}}catch(It){if(It&&D&&typeof It.stack=="string"){for(var W=It.stack.split(`
`),J=D.stack.split(`
`),fe=W.length-1,Oe=J.length-1;1<=fe&&0<=Oe&&W[fe]!==J[Oe];)Oe--;for(;1<=fe&&0<=Oe;fe--,Oe--)if(W[fe]!==J[Oe]){if(fe!==1||Oe!==1)do if(fe--,Oe--,0>Oe||W[fe]!==J[Oe]){var Ye=`
`+W[fe].replace(" at new "," at ");return h.displayName&&Ye.includes("<anonymous>")&&(Ye=Ye.replace("<anonymous>",h.displayName)),Ye}while(1<=fe&&0<=Oe);break}}}finally{Ot=!1,Error.prepareStackTrace=T}return(h=h?h.displayName||h.name:"")?ht(h):""}function bn(h){switch(h.tag){case 5:return ht(h.type);case 16:return ht("Lazy");case 13:return ht("Suspense");case 19:return ht("SuspenseList");case 0:case 2:case 15:return h=wn(h.type,!1),h;case 11:return h=wn(h.type.render,!1),h;case 1:return h=wn(h.type,!0),h;default:return""}}function Tt(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case oe:return"Fragment";case se:return"Portal";case ie:return"Profiler";case G:return"StrictMode";case $e:return"Suspense";case ot:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case X:return(h.displayName||"Context")+".Consumer";case Me:return(h._context.displayName||"Context")+".Provider";case De:var g=h.render;return h=h.displayName,h||(h=g.displayName||g.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case He:return g=h.displayName||null,g!==null?g:Tt(h.type)||"Memo";case ce:g=h._payload,h=h._init;try{return Tt(h(g))}catch{}}return null}function Gt(h){var g=h.type;switch(h.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=g.render,h=h.displayName||h.name||"",g.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tt(g);case 8:return g===G?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function $t(h){switch(typeof h){case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function Ln(h){var g=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function jn(h){var g=Ln(h)?"checked":"value",T=Object.getOwnPropertyDescriptor(h.constructor.prototype,g),D=""+h[g];if(!h.hasOwnProperty(g)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var W=T.get,J=T.set;return Object.defineProperty(h,g,{configurable:!0,get:function(){return W.call(this)},set:function(fe){D=""+fe,J.call(this,fe)}}),Object.defineProperty(h,g,{enumerable:T.enumerable}),{getValue:function(){return D},setValue:function(fe){D=""+fe},stopTracking:function(){h._valueTracker=null,delete h[g]}}}}function fr(h){h._valueTracker||(h._valueTracker=jn(h))}function ds(h){if(!h)return!1;var g=h._valueTracker;if(!g)return!0;var T=g.getValue(),D="";return h&&(D=Ln(h)?h.checked?"true":"false":h.value),h=D,h!==T?(g.setValue(h),!0):!1}function Wr(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}function Br(h,g){var T=g.checked;return bt({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??h._wrapperState.initialChecked})}function Kr(h,g){var T=g.defaultValue==null?"":g.defaultValue,D=g.checked!=null?g.checked:g.defaultChecked;T=$t(g.value!=null?g.value:T),h._wrapperState={initialChecked:D,initialValue:T,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function Vr(h,g){g=g.checked,g!=null&&Y(h,"checked",g,!1)}function ai(h,g){Vr(h,g);var T=$t(g.value),D=g.type;if(T!=null)D==="number"?(T===0&&h.value===""||h.value!=T)&&(h.value=""+T):h.value!==""+T&&(h.value=""+T);else if(D==="submit"||D==="reset"){h.removeAttribute("value");return}g.hasOwnProperty("value")?hs(h,g.type,T):g.hasOwnProperty("defaultValue")&&hs(h,g.type,$t(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(h.defaultChecked=!!g.defaultChecked)}function qe(h,g,T){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var D=g.type;if(!(D!=="submit"&&D!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+h._wrapperState.initialValue,T||g===h.value||(h.value=g),h.defaultValue=g}T=h.name,T!==""&&(h.name=""),h.defaultChecked=!!h._wrapperState.initialChecked,T!==""&&(h.name=T)}function hs(h,g,T){(g!=="number"||Wr(h.ownerDocument)!==h)&&(T==null?h.defaultValue=""+h._wrapperState.initialValue:h.defaultValue!==""+T&&(h.defaultValue=""+T))}var ni=Array.isArray;function gi(h,g,T,D){if(h=h.options,g){g={};for(var W=0;W<T.length;W++)g["$"+T[W]]=!0;for(T=0;T<h.length;T++)W=g.hasOwnProperty("$"+h[T].value),h[T].selected!==W&&(h[T].selected=W),W&&D&&(h[T].defaultSelected=!0)}else{for(T=""+$t(T),g=null,W=0;W<h.length;W++){if(h[W].value===T){h[W].selected=!0,D&&(h[W].defaultSelected=!0);return}g!==null||h[W].disabled||(g=h[W])}g!==null&&(g.selected=!0)}}function Fn(h,g){if(g.dangerouslySetInnerHTML!=null)throw Error(t(91));return bt({},g,{value:void 0,defaultValue:void 0,children:""+h._wrapperState.initialValue})}function Pe(h,g){var T=g.value;if(T==null){if(T=g.children,g=g.defaultValue,T!=null){if(g!=null)throw Error(t(92));if(ni(T)){if(1<T.length)throw Error(t(93));T=T[0]}g=T}g==null&&(g=""),T=g}h._wrapperState={initialValue:$t(T)}}function de(h,g){var T=$t(g.value),D=$t(g.defaultValue);T!=null&&(T=""+T,T!==h.value&&(h.value=T),g.defaultValue==null&&h.defaultValue!==T&&(h.defaultValue=T)),D!=null&&(h.defaultValue=""+D)}function dt(h){var g=h.textContent;g===h._wrapperState.initialValue&&g!==""&&g!==null&&(h.value=g)}function qt(h){switch(h){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xt(h,g){return h==null||h==="http://www.w3.org/1999/xhtml"?qt(g):h==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":h}var Bt,$n=function(h){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,T,D,W){MSApp.execUnsafeLocalFunction(function(){return h(g,T,D,W)})}:h}(function(h,g){if(h.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in h)h.innerHTML=g;else{for(Bt=Bt||document.createElement("div"),Bt.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=Bt.firstChild;h.firstChild;)h.removeChild(h.firstChild);for(;g.firstChild;)h.appendChild(g.firstChild)}});function _n(h,g){if(g){var T=h.firstChild;if(T&&T===h.lastChild&&T.nodeType===3){T.nodeValue=g;return}}h.textContent=g}var tr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mr=["Webkit","ms","Moz","O"];Object.keys(tr).forEach(function(h){Mr.forEach(function(g){g=g+h.charAt(0).toUpperCase()+h.substring(1),tr[g]=tr[h]})});function Qt(h,g,T){return g==null||typeof g=="boolean"||g===""?"":T||typeof g!="number"||g===0||tr.hasOwnProperty(h)&&tr[h]?(""+g).trim():g+"px"}function pn(h,g){h=h.style;for(var T in g)if(g.hasOwnProperty(T)){var D=T.indexOf("--")===0,W=Qt(T,g[T],D);T==="float"&&(T="cssFloat"),D?h.setProperty(T,W):h[T]=W}}var Un=bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vn(h,g){if(g){if(Un[h]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(t(137,h));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(t(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(t(61))}if(g.style!=null&&typeof g.style!="object")throw Error(t(62))}}function Dn(h,g){if(h.indexOf("-")===-1)return typeof g.is=="string";switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var br=null;function Qe(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var gn=null,un=null,Cn=null;function on(h){if(h=Bd(h)){if(typeof gn!="function")throw Error(t(280));var g=h.stateNode;g&&(g=jc(g),gn(h.stateNode,h.type,g))}}function zt(h){un?Cn?Cn.push(h):Cn=[h]:un=h}function Gn(){if(un){var h=un,g=Cn;if(Cn=un=null,on(h),g)for(h=0;h<g.length;h++)on(g[h])}}function Ir(h,g){return h(g)}function zi(){}var Tr=!1;function Ms(h,g,T){if(Tr)return h(g,T);Tr=!0;try{return Ir(h,g,T)}finally{Tr=!1,(un!==null||Cn!==null)&&(zi(),Gn())}}function Ko(h,g){var T=h.stateNode;if(T===null)return null;var D=jc(T);if(D===null)return null;T=D[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(h=h.type,D=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!D;break e;default:h=!1}if(h)return null;if(T&&typeof T!="function")throw Error(t(231,g,typeof T));return T}var Iu=!1;if(c)try{var I0={};Object.defineProperty(I0,"passive",{get:function(){Iu=!0}}),window.addEventListener("test",I0,I0),window.removeEventListener("test",I0,I0)}catch{Iu=!1}function Dh(h,g,T,D,W,J,fe,Oe,Ye){var It=Array.prototype.slice.call(arguments,3);try{g.apply(T,It)}catch(nn){this.onError(nn)}}var Kl=!1,Nu=null,r0=!1,Ga=null,Ed={onError:function(h){Kl=!0,Nu=h}};function up(h,g,T,D,W,J,fe,Oe,Ye){Kl=!1,Nu=null,Dh.apply(Ed,arguments)}function Md(h,g,T,D,W,J,fe,Oe,Ye){if(up.apply(this,arguments),Kl){if(Kl){var It=Nu;Kl=!1,Nu=null}else throw Error(t(198));r0||(r0=!0,Ga=It)}}function ko(h){var g=h,T=h;if(h.alternate)for(;g.return;)g=g.return;else{h=g;do g=h,(g.flags&4098)!==0&&(T=g.return),h=g.return;while(h)}return g.tag===3?T:null}function Uc(h){if(h.tag===13){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function Zl(h){if(ko(h)!==h)throw Error(t(188))}function ku(h){var g=h.alternate;if(!g){if(g=ko(h),g===null)throw Error(t(188));return g!==h?null:h}for(var T=h,D=g;;){var W=T.return;if(W===null)break;var J=W.alternate;if(J===null){if(D=W.return,D!==null){T=D;continue}break}if(W.child===J.child){for(J=W.child;J;){if(J===T)return Zl(W),h;if(J===D)return Zl(W),g;J=J.sibling}throw Error(t(188))}if(T.return!==D.return)T=W,D=J;else{for(var fe=!1,Oe=W.child;Oe;){if(Oe===T){fe=!0,T=W,D=J;break}if(Oe===D){fe=!0,D=W,T=J;break}Oe=Oe.sibling}if(!fe){for(Oe=J.child;Oe;){if(Oe===T){fe=!0,T=J,D=W;break}if(Oe===D){fe=!0,D=J,T=W;break}Oe=Oe.sibling}if(!fe)throw Error(t(189))}}if(T.alternate!==D)throw Error(t(190))}if(T.tag!==3)throw Error(t(188));return T.stateNode.current===T?h:g}function Zo(h){return h=ku(h),h!==null?ja(h):null}function ja(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var g=ja(h);if(g!==null)return g;h=h.sibling}return null}var dp=e.unstable_scheduleCallback,Cd=e.unstable_cancelCallback,hp=e.unstable_shouldYield,fp=e.unstable_requestPaint,me=e.unstable_now,pt=e.unstable_getCurrentPriorityLevel,At=e.unstable_ImmediatePriority,St=e.unstable_UserBlockingPriority,_t=e.unstable_NormalPriority,Rn=e.unstable_LowPriority,Bn=e.unstable_IdlePriority,Mn=null,On=null;function Kn(h){if(On&&typeof On.onCommitFiberRoot=="function")try{On.onCommitFiberRoot(Mn,h,void 0,(h.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:li,zr=Math.log,pr=Math.LN2;function li(h){return h>>>=0,h===0?32:31-(zr(h)/pr|0)|0}var Ni=64,Ki=4194304;function ii(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function Os(h,g){var T=h.pendingLanes;if(T===0)return 0;var D=0,W=h.suspendedLanes,J=h.pingedLanes,fe=T&268435455;if(fe!==0){var Oe=fe&~W;Oe!==0?D=ii(Oe):(J&=fe,J!==0&&(D=ii(J)))}else fe=T&~W,fe!==0?D=ii(fe):J!==0&&(D=ii(J));if(D===0)return 0;if(g!==0&&g!==D&&(g&W)===0&&(W=D&-D,J=g&-g,W>=J||W===16&&(J&4194240)!==0))return g;if((D&4)!==0&&(D|=T&16),g=h.entangledLanes,g!==0)for(h=h.entanglements,g&=D;0<g;)T=31-ur(g),W=1<<T,D|=h[T],g&=~W;return D}function nr(h,g){switch(h){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qo(h,g){for(var T=h.suspendedLanes,D=h.pingedLanes,W=h.expirationTimes,J=h.pendingLanes;0<J;){var fe=31-ur(J),Oe=1<<fe,Ye=W[fe];Ye===-1?((Oe&T)===0||(Oe&D)!==0)&&(W[fe]=nr(Oe,g)):Ye<=g&&(h.expiredLanes|=Oe),J&=~Oe}}function si(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function ha(){var h=Ni;return Ni<<=1,(Ni&4194240)===0&&(Ni=64),h}function Xs(h){for(var g=[],T=0;31>T;T++)g.push(h);return g}function Do(h,g,T){h.pendingLanes|=g,g!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,g=31-ur(g),h[g]=T}function Bc(h,g){var T=h.pendingLanes&~g;h.pendingLanes=g,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=g,h.mutableReadLanes&=g,h.entangledLanes&=g,g=h.entanglements;var D=h.eventTimes;for(h=h.expirationTimes;0<T;){var W=31-ur(T),J=1<<W;g[W]=0,D[W]=-1,h[W]=-1,T&=~J}}function xi(h,g){var T=h.entangledLanes|=g;for(h=h.entanglements;T;){var D=31-ur(T),W=1<<D;W&g|h[D]&g&&(h[D]|=g),T&=~W}}var Nr=0;function Oo(h){return h&=-h,1<h?4<h?(h&268435455)!==0?16:536870912:4:1}var xs,i0,Aa,Ad,Ql,pp=!1,mp=[],Jl=null,Ha=null,ul=null,Du=new Map,Pd=new Map,ec=[],P2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gm(h,g){switch(h){case"focusin":case"focusout":Jl=null;break;case"dragenter":case"dragleave":Ha=null;break;case"mouseover":case"mouseout":ul=null;break;case"pointerover":case"pointerout":Du.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pd.delete(g.pointerId)}}function Oh(h,g,T,D,W,J){return h===null||h.nativeEvent!==J?(h={blockedOn:g,domEventName:T,eventSystemFlags:D,nativeEvent:J,targetContainers:[W]},g!==null&&(g=Bd(g),g!==null&&i0(g)),h):(h.eventSystemFlags|=D,g=h.targetContainers,W!==null&&g.indexOf(W)===-1&&g.push(W),h)}function B4(h,g,T,D,W){switch(g){case"focusin":return Jl=Oh(Jl,h,g,T,D,W),!0;case"dragenter":return Ha=Oh(Ha,h,g,T,D,W),!0;case"mouseover":return ul=Oh(ul,h,g,T,D,W),!0;case"pointerover":var J=W.pointerId;return Du.set(J,Oh(Du.get(J)||null,h,g,T,D,W)),!0;case"gotpointercapture":return J=W.pointerId,Pd.set(J,Oh(Pd.get(J)||null,h,g,T,D,W)),!0}return!1}function zc(h){var g=gl(h.target);if(g!==null){var T=ko(g);if(T!==null){if(g=T.tag,g===13){if(g=Uc(T),g!==null){h.blockedOn=g,Ql(h.priority,function(){Aa(T)});return}}else if(g===3&&T.stateNode.current.memoizedState.isDehydrated){h.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}h.blockedOn=null}function Ou(h){if(h.blockedOn!==null)return!1;for(var g=h.targetContainers;0<g.length;){var T=_p(h.domEventName,h.eventSystemFlags,g[0],h.nativeEvent);if(T===null){T=h.nativeEvent;var D=new T.constructor(T.type,T);br=D,T.target.dispatchEvent(D),br=null}else return g=Bd(T),g!==null&&i0(g),h.blockedOn=T,!1;g.shift()}return!0}function R2(h,g,T){Ou(h)&&T.delete(g)}function dl(){pp=!1,Jl!==null&&Ou(Jl)&&(Jl=null),Ha!==null&&Ou(Ha)&&(Ha=null),ul!==null&&Ou(ul)&&(ul=null),Du.forEach(R2),Pd.forEach(R2)}function N0(h,g){h.blockedOn===g&&(h.blockedOn=null,pp||(pp=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,dl)))}function Rd(h){function g(W){return N0(W,h)}if(0<mp.length){N0(mp[0],h);for(var T=1;T<mp.length;T++){var D=mp[T];D.blockedOn===h&&(D.blockedOn=null)}}for(Jl!==null&&N0(Jl,h),Ha!==null&&N0(Ha,h),ul!==null&&N0(ul,h),Du.forEach(g),Pd.forEach(g),T=0;T<ec.length;T++)D=ec[T],D.blockedOn===h&&(D.blockedOn=null);for(;0<ec.length&&(T=ec[0],T.blockedOn===null);)zc(T),T.blockedOn===null&&ec.shift()}var tc=A.ReactCurrentBatchConfig,gp=!0;function vm(h,g,T,D){var W=Nr,J=tc.transition;tc.transition=null;try{Nr=1,vp(h,g,T,D)}finally{Nr=W,tc.transition=J}}function I2(h,g,T,D){var W=Nr,J=tc.transition;tc.transition=null;try{Nr=4,vp(h,g,T,D)}finally{Nr=W,tc.transition=J}}function vp(h,g,T,D){if(gp){var W=_p(h,g,T,D);if(W===null)W2(h,g,D,yp,T),gm(h,D);else if(B4(W,h,g,T,D))D.stopPropagation();else if(gm(h,D),g&4&&-1<P2.indexOf(h)){for(;W!==null;){var J=Bd(W);if(J!==null&&xs(J),J=_p(h,g,T,D),J===null&&W2(h,g,D,yp,T),J===W)break;W=J}W!==null&&D.stopPropagation()}else W2(h,g,D,null,T)}}var yp=null;function _p(h,g,T,D){if(yp=null,h=Qe(D),h=gl(h),h!==null)if(g=ko(h),g===null)h=null;else if(T=g.tag,T===13){if(h=Uc(g),h!==null)return h;h=null}else if(T===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;h=null}else g!==h&&(h=null);return yp=h,null}function ym(h){switch(h){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pt()){case At:return 1;case St:return 4;case _t:case Rn:return 16;case Bn:return 536870912;default:return 16}default:return 16}}var nc=null,xp=null,Id=null;function _m(){if(Id)return Id;var h,g=xp,T=g.length,D,W="value"in nc?nc.value:nc.textContent,J=W.length;for(h=0;h<T&&g[h]===W[h];h++);var fe=T-h;for(D=1;D<=fe&&g[T-D]===W[J-D];D++);return Id=W.slice(h,1<D?1-D:void 0)}function bp(h){var g=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&g===13&&(h=13)):h=g,h===10&&(h=13),32<=h||h===13?h:0}function rc(){return!0}function Sp(){return!1}function Lo(h){function g(T,D,W,J,fe){this._reactName=T,this._targetInst=W,this.type=D,this.nativeEvent=J,this.target=fe,this.currentTarget=null;for(var Oe in h)h.hasOwnProperty(Oe)&&(T=h[Oe],this[Oe]=T?T(J):J[Oe]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?rc:Sp,this.isPropagationStopped=Sp,this}return bt(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=rc)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=rc)},persist:function(){},isPersistent:rc}),g}var Lu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},s0=Lo(Lu),hl=bt({},Lu,{view:0,detail:0}),Lh=Lo(hl),Fh,ic,Fu,sc=bt({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cp,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==Fu&&(Fu&&h.type==="mousemove"?(Fh=h.screenX-Fu.screenX,ic=h.screenY-Fu.screenY):ic=Fh=0,Fu=h),Fh)},movementY:function(h){return"movementY"in h?h.movementY:ic}}),io=Lo(sc),Vc=bt({},sc,{dataTransfer:0}),wp=Lo(Vc),N2=bt({},hl,{relatedTarget:0}),fl=Lo(N2),Uh=bt({},Lu,{animationName:0,elapsedTime:0,pseudoElement:0}),k2=Lo(Uh),D2=bt({},Lu,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),xm=Lo(D2),z4=bt({},Lu,{data:0}),Tp=Lo(z4),V4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ep={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mp(h){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(h):(h=Ep[h])?!!g[h]:!1}function Cp(){return Mp}var Bh=bt({},hl,{key:function(h){if(h.key){var g=V4[h.key]||h.key;if(g!=="Unidentified")return g}return h.type==="keypress"?(h=bp(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?bm[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cp,charCode:function(h){return h.type==="keypress"?bp(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?bp(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),Jo=Lo(Bh),G4=bt({},sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zh=Lo(G4),O2=bt({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cp}),L2=Lo(O2),fa=bt({},Lu,{propertyName:0,elapsedTime:0,pseudoElement:0}),F2=Lo(fa),j4=bt({},sc,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),U2=Lo(j4),B2=[9,13,27,32],Sm=c&&"CompositionEvent"in window,Ls=null;c&&"documentMode"in document&&(Ls=document.documentMode);var Nd=c&&"TextEvent"in window&&!Ls,pl=c&&(!Sm||Ls&&8<Ls&&11>=Ls),oc=" ",wm=!1;function Mi(h,g){switch(h){case"keyup":return B2.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uu(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var kd=!1;function Dd(h,g){switch(h){case"compositionend":return Uu(g);case"keypress":return g.which!==32?null:(wm=!0,oc);case"textInput":return h=g.data,h===oc&&wm?null:h;default:return null}}function Vh(h,g){if(kd)return h==="compositionend"||!Sm&&Mi(h,g)?(h=_m(),Id=xp=nc=null,kd=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return pl&&g.locale!=="ko"?null:g.data;default:return null}}var z2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tm(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g==="input"?!!z2[h.type]:g==="textarea"}function Od(h,g,T,D){zt(D),g=Im(g,"onChange"),0<g.length&&(T=new s0("onChange","change",null,T,D),h.push({event:T,listeners:g}))}var ml=null,Bu=null;function H4(h){Rm(h,0)}function ac(h){var g=Vu(h);if(ds(g))return h}function Ap(h,g){if(h==="change")return g}var V2=!1;if(c){var le;if(c){var Te="oninput"in document;if(!Te){var Je=document.createElement("div");Je.setAttribute("oninput","return;"),Te=typeof Je.oninput=="function"}le=Te}else le=!1;V2=le&&(!document.documentMode||9<document.documentMode)}function Lt(){ml&&(ml.detachEvent("onpropertychange",Cr),Bu=ml=null)}function Cr(h){if(h.propertyName==="value"&&ac(Bu)){var g=[];Od(g,Bu,h,Qe(h)),Ms(H4,g)}}function ki(h,g,T){h==="focusin"?(Lt(),ml=g,Bu=T,ml.attachEvent("onpropertychange",Cr)):h==="focusout"&&Lt()}function pa(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return ac(Bu)}function k0(h,g){if(h==="click")return ac(g)}function Gh(h,g){if(h==="input"||h==="change")return ac(g)}function Gc(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var ma=typeof Object.is=="function"?Object.is:Gc;function lc(h,g){if(ma(h,g))return!0;if(typeof h!="object"||h===null||typeof g!="object"||g===null)return!1;var T=Object.keys(h),D=Object.keys(g);if(T.length!==D.length)return!1;for(D=0;D<T.length;D++){var W=T[D];if(!d.call(g,W)||!ma(h[W],g[W]))return!1}return!0}function Pp(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function w6(h,g){var T=Pp(h);h=0;for(var D;T;){if(T.nodeType===3){if(D=h+T.textContent.length,h<=g&&D>=g)return{node:T,offset:g-h};h=D}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=Pp(T)}}function G2(h,g){return h&&g?h===g?!0:h&&h.nodeType===3?!1:g&&g.nodeType===3?G2(h,g.parentNode):"contains"in h?h.contains(g):h.compareDocumentPosition?!!(h.compareDocumentPosition(g)&16):!1:!1}function T6(){for(var h=window,g=Wr();g instanceof h.HTMLIFrameElement;){try{var T=typeof g.contentWindow.location.href=="string"}catch{T=!1}if(T)h=g.contentWindow;else break;g=Wr(h.document)}return g}function W4(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g&&(g==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||g==="textarea"||h.contentEditable==="true")}function E6(h){var g=T6(),T=h.focusedElem,D=h.selectionRange;if(g!==T&&T&&T.ownerDocument&&G2(T.ownerDocument.documentElement,T)){if(D!==null&&W4(T)){if(g=D.start,h=D.end,h===void 0&&(h=g),"selectionStart"in T)T.selectionStart=g,T.selectionEnd=Math.min(h,T.value.length);else if(h=(g=T.ownerDocument||document)&&g.defaultView||window,h.getSelection){h=h.getSelection();var W=T.textContent.length,J=Math.min(D.start,W);D=D.end===void 0?J:Math.min(D.end,W),!h.extend&&J>D&&(W=D,D=J,J=W),W=w6(T,J);var fe=w6(T,D);W&&fe&&(h.rangeCount!==1||h.anchorNode!==W.node||h.anchorOffset!==W.offset||h.focusNode!==fe.node||h.focusOffset!==fe.offset)&&(g=g.createRange(),g.setStart(W.node,W.offset),h.removeAllRanges(),J>D?(h.addRange(g),h.extend(fe.node,fe.offset)):(g.setEnd(fe.node,fe.offset),h.addRange(g)))}}for(g=[],h=T;h=h.parentNode;)h.nodeType===1&&g.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<g.length;T++)h=g[T],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var j2=c&&"documentMode"in document&&11>=document.documentMode,cc=null,q4=null,Rp=null,Em=!1;function M6(h,g,T){var D=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;Em||cc==null||cc!==Wr(D)||(D=cc,"selectionStart"in D&&W4(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),Rp&&lc(Rp,D)||(Rp=D,D=Im(q4,"onSelect"),0<D.length&&(g=new s0("onSelect","select",null,g,T),h.push({event:g,listeners:D}),g.target=cc)))}function Ip(h,g){var T={};return T[h.toLowerCase()]=g.toLowerCase(),T["Webkit"+h]="webkit"+g,T["Moz"+h]="moz"+g,T}var Ld={animationend:Ip("Animation","AnimationEnd"),animationiteration:Ip("Animation","AnimationIteration"),animationstart:Ip("Animation","AnimationStart"),transitionend:Ip("Transition","TransitionEnd")},$4={},Np={};c&&(Np=document.createElement("div").style,"AnimationEvent"in window||(delete Ld.animationend.animation,delete Ld.animationiteration.animation,delete Ld.animationstart.animation),"TransitionEvent"in window||delete Ld.transitionend.transition);function Mm(h){if($4[h])return $4[h];if(!Ld[h])return h;var g=Ld[h],T;for(T in g)if(g.hasOwnProperty(T)&&T in Np)return $4[h]=g[T];return h}var X4=Mm("animationend"),Y4=Mm("animationiteration"),Cm=Mm("animationstart"),Am=Mm("transitionend"),K4=new Map,Z4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fd(h,g){K4.set(h,g),s(g,[h])}for(var Pm=0;Pm<Z4.length;Pm++){var kp=Z4[Pm],C6=kp.toLowerCase(),Q4=kp[0].toUpperCase()+kp.slice(1);Fd(C6,"on"+Q4)}Fd(X4,"onAnimationEnd"),Fd(Y4,"onAnimationIteration"),Fd(Cm,"onAnimationStart"),Fd("dblclick","onDoubleClick"),Fd("focusin","onFocus"),Fd("focusout","onBlur"),Fd(Am,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),J4=new Set("cancel close invalid load scroll toggle".split(" ").concat(jh));function Dp(h,g,T){var D=h.type||"unknown-event";h.currentTarget=T,Md(D,g,void 0,h),h.currentTarget=null}function Rm(h,g){g=(g&4)!==0;for(var T=0;T<h.length;T++){var D=h[T],W=D.event;D=D.listeners;e:{var J=void 0;if(g)for(var fe=D.length-1;0<=fe;fe--){var Oe=D[fe],Ye=Oe.instance,It=Oe.currentTarget;if(Oe=Oe.listener,Ye!==J&&W.isPropagationStopped())break e;Dp(W,Oe,It),J=Ye}else for(fe=0;fe<D.length;fe++){if(Oe=D[fe],Ye=Oe.instance,It=Oe.currentTarget,Oe=Oe.listener,Ye!==J&&W.isPropagationStopped())break e;Dp(W,Oe,It),J=Ye}}}if(r0)throw h=Ga,r0=!1,Ga=null,h}function Cs(h,g){var T=g[qh];T===void 0&&(T=g[qh]=new Set);var D=h+"__bubble";T.has(D)||(e5(g,h,2,!1),T.add(D))}function H2(h,g,T){var D=0;g&&(D|=4),e5(T,h,D,g)}var Ud="_reactListening"+Math.random().toString(36).slice(2);function Op(h){if(!h[Ud]){h[Ud]=!0,n.forEach(function(T){T!=="selectionchange"&&(J4.has(T)||H2(T,!1,h),H2(T,!0,h))});var g=h.nodeType===9?h:h.ownerDocument;g===null||g[Ud]||(g[Ud]=!0,H2("selectionchange",!1,g))}}function e5(h,g,T,D){switch(ym(g)){case 1:var W=vm;break;case 4:W=I2;break;default:W=vp}T=W.bind(null,g,T,h),W=void 0,!Iu||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(W=!0),D?W!==void 0?h.addEventListener(g,T,{capture:!0,passive:W}):h.addEventListener(g,T,!0):W!==void 0?h.addEventListener(g,T,{passive:W}):h.addEventListener(g,T,!1)}function W2(h,g,T,D,W){var J=D;if((g&1)===0&&(g&2)===0&&D!==null)e:for(;;){if(D===null)return;var fe=D.tag;if(fe===3||fe===4){var Oe=D.stateNode.containerInfo;if(Oe===W||Oe.nodeType===8&&Oe.parentNode===W)break;if(fe===4)for(fe=D.return;fe!==null;){var Ye=fe.tag;if((Ye===3||Ye===4)&&(Ye=fe.stateNode.containerInfo,Ye===W||Ye.nodeType===8&&Ye.parentNode===W))return;fe=fe.return}for(;Oe!==null;){if(fe=gl(Oe),fe===null)return;if(Ye=fe.tag,Ye===5||Ye===6){D=J=fe;continue e}Oe=Oe.parentNode}}D=D.return}Ms(function(){var It=J,nn=Qe(T),dn=[];e:{var tn=K4.get(h);if(tn!==void 0){var Hn=s0,Qn=h;switch(h){case"keypress":if(bp(T)===0)break e;case"keydown":case"keyup":Hn=Jo;break;case"focusin":Qn="focus",Hn=fl;break;case"focusout":Qn="blur",Hn=fl;break;case"beforeblur":case"afterblur":Hn=fl;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Hn=io;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Hn=wp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Hn=L2;break;case X4:case Y4:case Cm:Hn=k2;break;case Am:Hn=F2;break;case"scroll":Hn=Lh;break;case"wheel":Hn=U2;break;case"copy":case"cut":case"paste":Hn=xm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Hn=zh}var ir=(g&4)!==0,Ys=!ir&&h==="scroll",xt=ir?tn!==null?tn+"Capture":null:tn;ir=[];for(var at=It,Ct;at!==null;){Ct=at;var yn=Ct.stateNode;if(Ct.tag===5&&yn!==null&&(Ct=yn,xt!==null&&(yn=Ko(at,xt),yn!=null&&ir.push(Lp(at,yn,Ct)))),Ys)break;at=at.return}0<ir.length&&(tn=new Hn(tn,Qn,null,T,nn),dn.push({event:tn,listeners:ir}))}}if((g&7)===0){e:{if(tn=h==="mouseover"||h==="pointerover",Hn=h==="mouseout"||h==="pointerout",tn&&T!==br&&(Qn=T.relatedTarget||T.fromElement)&&(gl(Qn)||Qn[o0]))break e;if((Hn||tn)&&(tn=nn.window===nn?nn:(tn=nn.ownerDocument)?tn.defaultView||tn.parentWindow:window,Hn?(Qn=T.relatedTarget||T.toElement,Hn=It,Qn=Qn?gl(Qn):null,Qn!==null&&(Ys=ko(Qn),Qn!==Ys||Qn.tag!==5&&Qn.tag!==6)&&(Qn=null)):(Hn=null,Qn=It),Hn!==Qn)){if(ir=io,yn="onMouseLeave",xt="onMouseEnter",at="mouse",(h==="pointerout"||h==="pointerover")&&(ir=zh,yn="onPointerLeave",xt="onPointerEnter",at="pointer"),Ys=Hn==null?tn:Vu(Hn),Ct=Qn==null?tn:Vu(Qn),tn=new ir(yn,at+"leave",Hn,T,nn),tn.target=Ys,tn.relatedTarget=Ct,yn=null,gl(nn)===It&&(ir=new ir(xt,at+"enter",Qn,T,nn),ir.target=Ct,ir.relatedTarget=Ys,yn=ir),Ys=yn,Hn&&Qn)t:{for(ir=Hn,xt=Qn,at=0,Ct=ir;Ct;Ct=Hh(Ct))at++;for(Ct=0,yn=xt;yn;yn=Hh(yn))Ct++;for(;0<at-Ct;)ir=Hh(ir),at--;for(;0<Ct-at;)xt=Hh(xt),Ct--;for(;at--;){if(ir===xt||xt!==null&&ir===xt.alternate)break t;ir=Hh(ir),xt=Hh(xt)}ir=null}else ir=null;Hn!==null&&t5(dn,tn,Hn,ir,!1),Qn!==null&&Ys!==null&&t5(dn,Ys,Qn,ir,!0)}}e:{if(tn=It?Vu(It):window,Hn=tn.nodeName&&tn.nodeName.toLowerCase(),Hn==="select"||Hn==="input"&&tn.type==="file")var dr=Ap;else if(Tm(tn))if(V2)dr=Gh;else{dr=pa;var Er=ki}else(Hn=tn.nodeName)&&Hn.toLowerCase()==="input"&&(tn.type==="checkbox"||tn.type==="radio")&&(dr=k0);if(dr&&(dr=dr(h,It))){Od(dn,dr,T,nn);break e}Er&&Er(h,tn,It),h==="focusout"&&(Er=tn._wrapperState)&&Er.controlled&&tn.type==="number"&&hs(tn,"number",tn.value)}switch(Er=It?Vu(It):window,h){case"focusin":(Tm(Er)||Er.contentEditable==="true")&&(cc=Er,q4=It,Rp=null);break;case"focusout":Rp=q4=cc=null;break;case"mousedown":Em=!0;break;case"contextmenu":case"mouseup":case"dragend":Em=!1,M6(dn,T,nn);break;case"selectionchange":if(j2)break;case"keydown":case"keyup":M6(dn,T,nn)}var Ar;if(Sm)e:{switch(h){case"compositionstart":var Dr="onCompositionStart";break e;case"compositionend":Dr="onCompositionEnd";break e;case"compositionupdate":Dr="onCompositionUpdate";break e}Dr=void 0}else kd?Mi(h,T)&&(Dr="onCompositionEnd"):h==="keydown"&&T.keyCode===229&&(Dr="onCompositionStart");Dr&&(pl&&T.locale!=="ko"&&(kd||Dr!=="onCompositionStart"?Dr==="onCompositionEnd"&&kd&&(Ar=_m()):(nc=nn,xp="value"in nc?nc.value:nc.textContent,kd=!0)),Er=Im(It,Dr),0<Er.length&&(Dr=new Tp(Dr,h,null,T,nn),dn.push({event:Dr,listeners:Er}),Ar?Dr.data=Ar:(Ar=Uu(T),Ar!==null&&(Dr.data=Ar)))),(Ar=Nd?Dd(h,T):Vh(h,T))&&(It=Im(It,"onBeforeInput"),0<It.length&&(nn=new Tp("onBeforeInput","beforeinput",null,T,nn),dn.push({event:nn,listeners:It}),nn.data=Ar))}Rm(dn,g)})}function Lp(h,g,T){return{instance:h,listener:g,currentTarget:T}}function Im(h,g){for(var T=g+"Capture",D=[];h!==null;){var W=h,J=W.stateNode;W.tag===5&&J!==null&&(W=J,J=Ko(h,T),J!=null&&D.unshift(Lp(h,J,W)),J=Ko(h,g),J!=null&&D.push(Lp(h,J,W))),h=h.return}return D}function Hh(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5);return h||null}function t5(h,g,T,D,W){for(var J=g._reactName,fe=[];T!==null&&T!==D;){var Oe=T,Ye=Oe.alternate,It=Oe.stateNode;if(Ye!==null&&Ye===D)break;Oe.tag===5&&It!==null&&(Oe=It,W?(Ye=Ko(T,J),Ye!=null&&fe.unshift(Lp(T,Ye,Oe))):W||(Ye=Ko(T,J),Ye!=null&&fe.push(Lp(T,Ye,Oe)))),T=T.return}fe.length!==0&&h.push({event:g,listeners:fe})}var A6=/\r\n?/g,P6=/\u0000|\uFFFD/g;function n5(h){return(typeof h=="string"?h:""+h).replace(A6,`
`).replace(P6,"")}function Nm(h,g,T){if(g=n5(g),n5(h)!==g&&T)throw Error(t(425))}function km(){}var q2=null,$2=null;function X2(h,g){return h==="textarea"||h==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var Y2=typeof setTimeout=="function"?setTimeout:void 0,R6=typeof clearTimeout=="function"?clearTimeout:void 0,r5=typeof Promise=="function"?Promise:void 0,I6=typeof queueMicrotask=="function"?queueMicrotask:typeof r5<"u"?function(h){return r5.resolve(null).then(h).catch(N6)}:Y2;function N6(h){setTimeout(function(){throw h})}function K2(h,g){var T=g,D=0;do{var W=T.nextSibling;if(h.removeChild(T),W&&W.nodeType===8)if(T=W.data,T==="/$"){if(D===0){h.removeChild(W),Rd(g);return}D--}else T!=="$"&&T!=="$?"&&T!=="$!"||D++;T=W}while(T);Rd(g)}function zu(h){for(;h!=null;h=h.nextSibling){var g=h.nodeType;if(g===1||g===3)break;if(g===8){if(g=h.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return h}function fs(h){h=h.previousSibling;for(var g=0;h;){if(h.nodeType===8){var T=h.data;if(T==="$"||T==="$!"||T==="$?"){if(g===0)return h;g--}else T==="/$"&&g++}h=h.previousSibling}return null}var Wh=Math.random().toString(36).slice(2),Ci="__reactFiber$"+Wh,Dm="__reactProps$"+Wh,o0="__reactContainer$"+Wh,qh="__reactEvents$"+Wh,Om="__reactListeners$"+Wh,$h="__reactHandles$"+Wh;function gl(h){var g=h[Ci];if(g)return g;for(var T=h.parentNode;T;){if(g=T[o0]||T[Ci]){if(T=g.alternate,g.child!==null||T!==null&&T.child!==null)for(h=fs(h);h!==null;){if(T=h[Ci])return T;h=fs(h)}return g}h=T,T=h.parentNode}return null}function Bd(h){return h=h[Ci]||h[o0],!h||h.tag!==5&&h.tag!==6&&h.tag!==13&&h.tag!==3?null:h}function Vu(h){if(h.tag===5||h.tag===6)return h.stateNode;throw Error(t(33))}function jc(h){return h[Dm]||null}var Hc=[],Gu=-1;function ju(h){return{current:h}}function is(h){0>Gu||(h.current=Hc[Gu],Hc[Gu]=null,Gu--)}function ps(h,g){Gu++,Hc[Gu]=h.current,h.current=g}var zd={},ga=ju(zd),Pa=ju(!1),Hu=zd;function Vd(h,g){var T=h.type.contextTypes;if(!T)return zd;var D=h.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===g)return D.__reactInternalMemoizedMaskedChildContext;var W={},J;for(J in T)W[J]=g[J];return D&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=g,h.__reactInternalMemoizedMaskedChildContext=W),W}function a0(h){return h=h.childContextTypes,h!=null}function Fp(){is(Pa),is(ga)}function i5(h,g,T){if(ga.current!==zd)throw Error(t(168));ps(ga,g),ps(Pa,T)}function s5(h,g,T){var D=h.stateNode;if(g=g.childContextTypes,typeof D.getChildContext!="function")return T;D=D.getChildContext();for(var W in D)if(!(W in g))throw Error(t(108,Gt(h)||"Unknown",W));return bt({},T,D)}function Lm(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||zd,Hu=ga.current,ps(ga,h),ps(Pa,Pa.current),!0}function k6(h,g,T){var D=h.stateNode;if(!D)throw Error(t(169));T?(h=s5(h,g,Hu),D.__reactInternalMemoizedMergedChildContext=h,is(Pa),is(ga),ps(ga,h)):is(Pa),ps(Pa,T)}var Wu=null,qu=!1,Z2=!1;function o5(h){Wu===null?Wu=[h]:Wu.push(h)}function Jx(h){qu=!0,o5(h)}function Gd(){if(!Z2&&Wu!==null){Z2=!0;var h=0,g=Nr;try{var T=Wu;for(Nr=1;h<T.length;h++){var D=T[h];do D=D(!0);while(D!==null)}Wu=null,qu=!1}catch(W){throw Wu!==null&&(Wu=Wu.slice(h+1)),dp(At,Gd),W}finally{Nr=g,Z2=!1}}return null}var uc=[],Wc=0,Q2=null,Xh=0,vl=[],D0=0,jd=null,yl=1,qc="";function Yh(h,g){uc[Wc++]=Xh,uc[Wc++]=Q2,Q2=h,Xh=g}function D6(h,g,T){vl[D0++]=yl,vl[D0++]=qc,vl[D0++]=jd,jd=h;var D=yl;h=qc;var W=32-ur(D)-1;D&=~(1<<W),T+=1;var J=32-ur(g)+W;if(30<J){var fe=W-W%5;J=(D&(1<<fe)-1).toString(32),D>>=fe,W-=fe,yl=1<<32-ur(g)+W|T<<W|D,qc=J+h}else yl=1<<J|T<<W|D,qc=h}function Kh(h){h.return!==null&&(Yh(h,1),D6(h,1,0))}function Fm(h){for(;h===Q2;)Q2=uc[--Wc],uc[Wc]=null,Xh=uc[--Wc],uc[Wc]=null;for(;h===jd;)jd=vl[--D0],vl[D0]=null,qc=vl[--D0],vl[D0]=null,yl=vl[--D0],vl[D0]=null}var O0=null,l0=null,As=!1,c0=null;function Um(h,g){var T=Sl(5,null,null,0);T.elementType="DELETED",T.stateNode=g,T.return=h,g=h.deletions,g===null?(h.deletions=[T],h.flags|=16):g.push(T)}function a5(h,g){switch(h.tag){case 5:var T=h.type;return g=g.nodeType!==1||T.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(h.stateNode=g,O0=h,l0=zu(g.firstChild),!0):!1;case 6:return g=h.pendingProps===""||g.nodeType!==3?null:g,g!==null?(h.stateNode=g,O0=h,l0=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(T=jd!==null?{id:yl,overflow:qc}:null,h.memoizedState={dehydrated:g,treeContext:T,retryLane:1073741824},T=Sl(18,null,null,0),T.stateNode=g,T.return=h,h.child=T,O0=h,l0=null,!0):!1;default:return!1}}function Hd(h){return(h.mode&1)!==0&&(h.flags&128)===0}function Up(h){if(As){var g=l0;if(g){var T=g;if(!a5(h,g)){if(Hd(h))throw Error(t(418));g=zu(T.nextSibling);var D=O0;g&&a5(h,g)?Um(D,T):(h.flags=h.flags&-4097|2,As=!1,O0=h)}}else{if(Hd(h))throw Error(t(418));h.flags=h.flags&-4097|2,As=!1,O0=h}}}function O6(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;O0=h}function Bm(h){if(h!==O0)return!1;if(!As)return O6(h),As=!0,!1;var g;if((g=h.tag!==3)&&!(g=h.tag!==5)&&(g=h.type,g=g!=="head"&&g!=="body"&&!X2(h.type,h.memoizedProps)),g&&(g=l0)){if(Hd(h))throw L6(),Error(t(418));for(;g;)Um(h,g),g=zu(g.nextSibling)}if(O6(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(t(317));e:{for(h=h.nextSibling,g=0;h;){if(h.nodeType===8){var T=h.data;if(T==="/$"){if(g===0){l0=zu(h.nextSibling);break e}g--}else T!=="$"&&T!=="$!"&&T!=="$?"||g++}h=h.nextSibling}l0=null}}else l0=O0?zu(h.stateNode.nextSibling):null;return!0}function L6(){for(var h=l0;h;)h=zu(h.nextSibling)}function Bp(){l0=O0=null,As=!1}function J2(h){c0===null?c0=[h]:c0.push(h)}var eb=A.ReactCurrentBatchConfig;function zm(h,g,T){if(h=T.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(t(309));var D=T.stateNode}if(!D)throw Error(t(147,h));var W=D,J=""+h;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===J?g.ref:(g=function(fe){var Oe=W.refs;fe===null?delete Oe[J]:Oe[J]=fe},g._stringRef=J,g)}if(typeof h!="string")throw Error(t(284));if(!T._owner)throw Error(t(290,h))}return h}function Vm(h,g){throw h=Object.prototype.toString.call(g),Error(t(31,h==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":h))}function Gm(h){var g=h._init;return g(h._payload)}function l5(h){function g(xt,at){if(h){var Ct=xt.deletions;Ct===null?(xt.deletions=[at],xt.flags|=16):Ct.push(at)}}function T(xt,at){if(!h)return null;for(;at!==null;)g(xt,at),at=at.sibling;return null}function D(xt,at){for(xt=new Map;at!==null;)at.key!==null?xt.set(at.key,at):xt.set(at.index,at),at=at.sibling;return xt}function W(xt,at){return xt=tu(xt,at),xt.index=0,xt.sibling=null,xt}function J(xt,at,Ct){return xt.index=Ct,h?(Ct=xt.alternate,Ct!==null?(Ct=Ct.index,Ct<at?(xt.flags|=2,at):Ct):(xt.flags|=2,at)):(xt.flags|=1048576,at)}function fe(xt){return h&&xt.alternate===null&&(xt.flags|=2),xt}function Oe(xt,at,Ct,yn){return at===null||at.tag!==6?(at=tv(Ct,xt.mode,yn),at.return=xt,at):(at=W(at,Ct),at.return=xt,at)}function Ye(xt,at,Ct,yn){var dr=Ct.type;return dr===oe?nn(xt,at,Ct.props.children,yn,Ct.key):at!==null&&(at.elementType===dr||typeof dr=="object"&&dr!==null&&dr.$$typeof===ce&&Gm(dr)===at.type)?(yn=W(at,Ct.props),yn.ref=zm(xt,at,Ct),yn.return=xt,yn):(yn=z3(Ct.type,Ct.key,Ct.props,null,xt.mode,yn),yn.ref=zm(xt,at,Ct),yn.return=xt,yn)}function It(xt,at,Ct,yn){return at===null||at.tag!==4||at.stateNode.containerInfo!==Ct.containerInfo||at.stateNode.implementation!==Ct.implementation?(at=nv(Ct,xt.mode,yn),at.return=xt,at):(at=W(at,Ct.children||[]),at.return=xt,at)}function nn(xt,at,Ct,yn,dr){return at===null||at.tag!==7?(at=of(Ct,xt.mode,yn,dr),at.return=xt,at):(at=W(at,Ct),at.return=xt,at)}function dn(xt,at,Ct){if(typeof at=="string"&&at!==""||typeof at=="number")return at=tv(""+at,xt.mode,Ct),at.return=xt,at;if(typeof at=="object"&&at!==null){switch(at.$$typeof){case ne:return Ct=z3(at.type,at.key,at.props,null,xt.mode,Ct),Ct.ref=zm(xt,null,at),Ct.return=xt,Ct;case se:return at=nv(at,xt.mode,Ct),at.return=xt,at;case ce:var yn=at._init;return dn(xt,yn(at._payload),Ct)}if(ni(at)||st(at))return at=of(at,xt.mode,Ct,null),at.return=xt,at;Vm(xt,at)}return null}function tn(xt,at,Ct,yn){var dr=at!==null?at.key:null;if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return dr!==null?null:Oe(xt,at,""+Ct,yn);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case ne:return Ct.key===dr?Ye(xt,at,Ct,yn):null;case se:return Ct.key===dr?It(xt,at,Ct,yn):null;case ce:return dr=Ct._init,tn(xt,at,dr(Ct._payload),yn)}if(ni(Ct)||st(Ct))return dr!==null?null:nn(xt,at,Ct,yn,null);Vm(xt,Ct)}return null}function Hn(xt,at,Ct,yn,dr){if(typeof yn=="string"&&yn!==""||typeof yn=="number")return xt=xt.get(Ct)||null,Oe(at,xt,""+yn,dr);if(typeof yn=="object"&&yn!==null){switch(yn.$$typeof){case ne:return xt=xt.get(yn.key===null?Ct:yn.key)||null,Ye(at,xt,yn,dr);case se:return xt=xt.get(yn.key===null?Ct:yn.key)||null,It(at,xt,yn,dr);case ce:var Er=yn._init;return Hn(xt,at,Ct,Er(yn._payload),dr)}if(ni(yn)||st(yn))return xt=xt.get(Ct)||null,nn(at,xt,yn,dr,null);Vm(at,yn)}return null}function Qn(xt,at,Ct,yn){for(var dr=null,Er=null,Ar=at,Dr=at=0,Uo=null;Ar!==null&&Dr<Ct.length;Dr++){Ar.index>Dr?(Uo=Ar,Ar=null):Uo=Ar.sibling;var Oi=tn(xt,Ar,Ct[Dr],yn);if(Oi===null){Ar===null&&(Ar=Uo);break}h&&Ar&&Oi.alternate===null&&g(xt,Ar),at=J(Oi,at,Dr),Er===null?dr=Oi:Er.sibling=Oi,Er=Oi,Ar=Uo}if(Dr===Ct.length)return T(xt,Ar),As&&Yh(xt,Dr),dr;if(Ar===null){for(;Dr<Ct.length;Dr++)Ar=dn(xt,Ct[Dr],yn),Ar!==null&&(at=J(Ar,at,Dr),Er===null?dr=Ar:Er.sibling=Ar,Er=Ar);return As&&Yh(xt,Dr),dr}for(Ar=D(xt,Ar);Dr<Ct.length;Dr++)Uo=Hn(Ar,xt,Dr,Ct[Dr],yn),Uo!==null&&(h&&Uo.alternate!==null&&Ar.delete(Uo.key===null?Dr:Uo.key),at=J(Uo,at,Dr),Er===null?dr=Uo:Er.sibling=Uo,Er=Uo);return h&&Ar.forEach(function(nu){return g(xt,nu)}),As&&Yh(xt,Dr),dr}function ir(xt,at,Ct,yn){var dr=st(Ct);if(typeof dr!="function")throw Error(t(150));if(Ct=dr.call(Ct),Ct==null)throw Error(t(151));for(var Er=dr=null,Ar=at,Dr=at=0,Uo=null,Oi=Ct.next();Ar!==null&&!Oi.done;Dr++,Oi=Ct.next()){Ar.index>Dr?(Uo=Ar,Ar=null):Uo=Ar.sibling;var nu=tn(xt,Ar,Oi.value,yn);if(nu===null){Ar===null&&(Ar=Uo);break}h&&Ar&&nu.alternate===null&&g(xt,Ar),at=J(nu,at,Dr),Er===null?dr=nu:Er.sibling=nu,Er=nu,Ar=Uo}if(Oi.done)return T(xt,Ar),As&&Yh(xt,Dr),dr;if(Ar===null){for(;!Oi.done;Dr++,Oi=Ct.next())Oi=dn(xt,Oi.value,yn),Oi!==null&&(at=J(Oi,at,Dr),Er===null?dr=Oi:Er.sibling=Oi,Er=Oi);return As&&Yh(xt,Dr),dr}for(Ar=D(xt,Ar);!Oi.done;Dr++,Oi=Ct.next())Oi=Hn(Ar,xt,Dr,Oi.value,yn),Oi!==null&&(h&&Oi.alternate!==null&&Ar.delete(Oi.key===null?Dr:Oi.key),at=J(Oi,at,Dr),Er===null?dr=Oi:Er.sibling=Oi,Er=Oi);return h&&Ar.forEach(function(cy){return g(xt,cy)}),As&&Yh(xt,Dr),dr}function Ys(xt,at,Ct,yn){if(typeof Ct=="object"&&Ct!==null&&Ct.type===oe&&Ct.key===null&&(Ct=Ct.props.children),typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case ne:e:{for(var dr=Ct.key,Er=at;Er!==null;){if(Er.key===dr){if(dr=Ct.type,dr===oe){if(Er.tag===7){T(xt,Er.sibling),at=W(Er,Ct.props.children),at.return=xt,xt=at;break e}}else if(Er.elementType===dr||typeof dr=="object"&&dr!==null&&dr.$$typeof===ce&&Gm(dr)===Er.type){T(xt,Er.sibling),at=W(Er,Ct.props),at.ref=zm(xt,Er,Ct),at.return=xt,xt=at;break e}T(xt,Er);break}else g(xt,Er);Er=Er.sibling}Ct.type===oe?(at=of(Ct.props.children,xt.mode,yn,Ct.key),at.return=xt,xt=at):(yn=z3(Ct.type,Ct.key,Ct.props,null,xt.mode,yn),yn.ref=zm(xt,at,Ct),yn.return=xt,xt=yn)}return fe(xt);case se:e:{for(Er=Ct.key;at!==null;){if(at.key===Er)if(at.tag===4&&at.stateNode.containerInfo===Ct.containerInfo&&at.stateNode.implementation===Ct.implementation){T(xt,at.sibling),at=W(at,Ct.children||[]),at.return=xt,xt=at;break e}else{T(xt,at);break}else g(xt,at);at=at.sibling}at=nv(Ct,xt.mode,yn),at.return=xt,xt=at}return fe(xt);case ce:return Er=Ct._init,Ys(xt,at,Er(Ct._payload),yn)}if(ni(Ct))return Qn(xt,at,Ct,yn);if(st(Ct))return ir(xt,at,Ct,yn);Vm(xt,Ct)}return typeof Ct=="string"&&Ct!==""||typeof Ct=="number"?(Ct=""+Ct,at!==null&&at.tag===6?(T(xt,at.sibling),at=W(at,Ct),at.return=xt,xt=at):(T(xt,at),at=tv(Ct,xt.mode,yn),at.return=xt,xt=at),fe(xt)):T(xt,at)}return Ys}var Zh=l5(!0),c5=l5(!1),e3=ju(null),jm=null,Qh=null,t3=null;function u5(){t3=Qh=jm=null}function d5(h){var g=e3.current;is(e3),h._currentValue=g}function zp(h,g,T){for(;h!==null;){var D=h.alternate;if((h.childLanes&g)!==g?(h.childLanes|=g,D!==null&&(D.childLanes|=g)):D!==null&&(D.childLanes&g)!==g&&(D.childLanes|=g),h===T)break;h=h.return}}function $u(h,g){jm=h,t3=Qh=null,h=h.dependencies,h!==null&&h.firstContext!==null&&((h.lanes&g)!==0&&(u0=!0),h.firstContext=null)}function _l(h){var g=h._currentValue;if(t3!==h)if(h={context:h,memoizedValue:g,next:null},Qh===null){if(jm===null)throw Error(t(308));Qh=h,jm.dependencies={lanes:0,firstContext:h}}else Qh=Qh.next=h;return g}var L0=null;function Vp(h){L0===null?L0=[h]:L0.push(h)}function h5(h,g,T,D){var W=g.interleaved;return W===null?(T.next=T,Vp(g)):(T.next=W.next,W.next=T),g.interleaved=T,Xu(h,D)}function Xu(h,g){h.lanes|=g;var T=h.alternate;for(T!==null&&(T.lanes|=g),T=h,h=h.return;h!==null;)h.childLanes|=g,T=h.alternate,T!==null&&(T.childLanes|=g),T=h,h=h.return;return T.tag===3?T.stateNode:null}var $c=!1;function n3(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function F6(h,g){h=h.updateQueue,g.updateQueue===h&&(g.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function F0(h,g){return{eventTime:h,lane:g,tag:0,payload:null,callback:null,next:null}}function dc(h,g,T){var D=h.updateQueue;if(D===null)return null;if(D=D.shared,(Di&2)!==0){var W=D.pending;return W===null?g.next=g:(g.next=W.next,W.next=g),D.pending=g,Xu(h,T)}return W=D.interleaved,W===null?(g.next=g,Vp(D)):(g.next=W.next,W.next=g),D.interleaved=g,Xu(h,T)}function r3(h,g,T){if(g=g.updateQueue,g!==null&&(g=g.shared,(T&4194240)!==0)){var D=g.lanes;D&=h.pendingLanes,T|=D,g.lanes=T,xi(h,T)}}function f5(h,g){var T=h.updateQueue,D=h.alternate;if(D!==null&&(D=D.updateQueue,T===D)){var W=null,J=null;if(T=T.firstBaseUpdate,T!==null){do{var fe={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};J===null?W=J=fe:J=J.next=fe,T=T.next}while(T!==null);J===null?W=J=g:J=J.next=g}else W=J=g;T={baseState:D.baseState,firstBaseUpdate:W,lastBaseUpdate:J,shared:D.shared,effects:D.effects},h.updateQueue=T;return}h=T.lastBaseUpdate,h===null?T.firstBaseUpdate=g:h.next=g,T.lastBaseUpdate=g}function Hm(h,g,T,D){var W=h.updateQueue;$c=!1;var J=W.firstBaseUpdate,fe=W.lastBaseUpdate,Oe=W.shared.pending;if(Oe!==null){W.shared.pending=null;var Ye=Oe,It=Ye.next;Ye.next=null,fe===null?J=It:fe.next=It,fe=Ye;var nn=h.alternate;nn!==null&&(nn=nn.updateQueue,Oe=nn.lastBaseUpdate,Oe!==fe&&(Oe===null?nn.firstBaseUpdate=It:Oe.next=It,nn.lastBaseUpdate=Ye))}if(J!==null){var dn=W.baseState;fe=0,nn=It=Ye=null,Oe=J;do{var tn=Oe.lane,Hn=Oe.eventTime;if((D&tn)===tn){nn!==null&&(nn=nn.next={eventTime:Hn,lane:0,tag:Oe.tag,payload:Oe.payload,callback:Oe.callback,next:null});e:{var Qn=h,ir=Oe;switch(tn=g,Hn=T,ir.tag){case 1:if(Qn=ir.payload,typeof Qn=="function"){dn=Qn.call(Hn,dn,tn);break e}dn=Qn;break e;case 3:Qn.flags=Qn.flags&-65537|128;case 0:if(Qn=ir.payload,tn=typeof Qn=="function"?Qn.call(Hn,dn,tn):Qn,tn==null)break e;dn=bt({},dn,tn);break e;case 2:$c=!0}}Oe.callback!==null&&Oe.lane!==0&&(h.flags|=64,tn=W.effects,tn===null?W.effects=[Oe]:tn.push(Oe))}else Hn={eventTime:Hn,lane:tn,tag:Oe.tag,payload:Oe.payload,callback:Oe.callback,next:null},nn===null?(It=nn=Hn,Ye=dn):nn=nn.next=Hn,fe|=tn;if(Oe=Oe.next,Oe===null){if(Oe=W.shared.pending,Oe===null)break;tn=Oe,Oe=tn.next,tn.next=null,W.lastBaseUpdate=tn,W.shared.pending=null}}while(!0);if(nn===null&&(Ye=dn),W.baseState=Ye,W.firstBaseUpdate=It,W.lastBaseUpdate=nn,g=W.shared.interleaved,g!==null){W=g;do fe|=W.lane,W=W.next;while(W!==g)}else J===null&&(W.shared.lanes=0);Kd|=fe,h.lanes=fe,h.memoizedState=dn}}function p5(h,g,T){if(h=g.effects,g.effects=null,h!==null)for(g=0;g<h.length;g++){var D=h[g],W=D.callback;if(W!==null){if(D.callback=null,D=T,typeof W!="function")throw Error(t(191,W));W.call(D)}}}var Wm={},Xc=ju(Wm),Gp=ju(Wm),qm=ju(Wm);function Wd(h){if(h===Wm)throw Error(t(174));return h}function i3(h,g){switch(ps(qm,g),ps(Gp,h),ps(Xc,Wm),h=g.nodeType,h){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:Xt(null,"");break;default:h=h===8?g.parentNode:g,g=h.namespaceURI||null,h=h.tagName,g=Xt(g,h)}is(Xc),ps(Xc,g)}function jp(){is(Xc),is(Gp),is(qm)}function U6(h){Wd(qm.current);var g=Wd(Xc.current),T=Xt(g,h.type);g!==T&&(ps(Gp,h),ps(Xc,T))}function s3(h){Gp.current===h&&(is(Xc),is(Gp))}var js=ju(0);function Yu(h){for(var g=h;g!==null;){if(g.tag===13){var T=g.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Jh=[];function Hp(){for(var h=0;h<Jh.length;h++)Jh[h]._workInProgressVersionPrimary=null;Jh.length=0}var $m=A.ReactCurrentDispatcher,qd=A.ReactCurrentBatchConfig,Ku=0,ss=null,Fs=null,ea=null,o3=!1,Wp=!1,Xm=0,B6=0;function so(){throw Error(t(321))}function qp(h,g){if(g===null)return!1;for(var T=0;T<g.length&&T<h.length;T++)if(!ma(h[T],g[T]))return!1;return!0}function a3(h,g,T,D,W,J){if(Ku=J,ss=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,$m.current=h===null||h.memoizedState===null?Kp:tb,h=T(D,W),Wp){J=0;do{if(Wp=!1,Xm=0,25<=J)throw Error(t(301));J+=1,ea=Fs=null,g.updateQueue=null,$m.current=v3,h=T(D,W)}while(Wp)}if($m.current=Kc,g=Fs!==null&&Fs.next!==null,Ku=0,ea=Fs=ss=null,o3=!1,g)throw Error(t(300));return h}function Ym(){var h=Xm!==0;return Xm=0,h}function Yc(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ea===null?ss.memoizedState=ea=h:ea=ea.next=h,ea}function xl(){if(Fs===null){var h=ss.alternate;h=h!==null?h.memoizedState:null}else h=Fs.next;var g=ea===null?ss.memoizedState:ea.next;if(g!==null)ea=g,Fs=h;else{if(h===null)throw Error(t(310));Fs=h,h={memoizedState:Fs.memoizedState,baseState:Fs.baseState,baseQueue:Fs.baseQueue,queue:Fs.queue,next:null},ea===null?ss.memoizedState=ea=h:ea=ea.next=h}return ea}function $p(h,g){return typeof g=="function"?g(h):g}function m5(h){var g=xl(),T=g.queue;if(T===null)throw Error(t(311));T.lastRenderedReducer=h;var D=Fs,W=D.baseQueue,J=T.pending;if(J!==null){if(W!==null){var fe=W.next;W.next=J.next,J.next=fe}D.baseQueue=W=J,T.pending=null}if(W!==null){J=W.next,D=D.baseState;var Oe=fe=null,Ye=null,It=J;do{var nn=It.lane;if((Ku&nn)===nn)Ye!==null&&(Ye=Ye.next={lane:0,action:It.action,hasEagerState:It.hasEagerState,eagerState:It.eagerState,next:null}),D=It.hasEagerState?It.eagerState:h(D,It.action);else{var dn={lane:nn,action:It.action,hasEagerState:It.hasEagerState,eagerState:It.eagerState,next:null};Ye===null?(Oe=Ye=dn,fe=D):Ye=Ye.next=dn,ss.lanes|=nn,Kd|=nn}It=It.next}while(It!==null&&It!==J);Ye===null?fe=D:Ye.next=Oe,ma(D,g.memoizedState)||(u0=!0),g.memoizedState=D,g.baseState=fe,g.baseQueue=Ye,T.lastRenderedState=D}if(h=T.interleaved,h!==null){W=h;do J=W.lane,ss.lanes|=J,Kd|=J,W=W.next;while(W!==h)}else W===null&&(T.lanes=0);return[g.memoizedState,T.dispatch]}function g5(h){var g=xl(),T=g.queue;if(T===null)throw Error(t(311));T.lastRenderedReducer=h;var D=T.dispatch,W=T.pending,J=g.memoizedState;if(W!==null){T.pending=null;var fe=W=W.next;do J=h(J,fe.action),fe=fe.next;while(fe!==W);ma(J,g.memoizedState)||(u0=!0),g.memoizedState=J,g.baseQueue===null&&(g.baseState=J),T.lastRenderedState=J}return[J,D]}function l3(){}function z6(h,g){var T=ss,D=xl(),W=g(),J=!ma(D.memoizedState,W);if(J&&(D.memoizedState=W,u0=!0),D=D.queue,d3(G6.bind(null,T,D,h),[h]),D.getSnapshot!==g||J||ea!==null&&ea.memoizedState.tag&1){if(T.flags|=2048,ef(9,c3.bind(null,T,D,W,g),void 0,null),Fo===null)throw Error(t(349));(Ku&30)!==0||V6(T,g,W)}return W}function V6(h,g,T){h.flags|=16384,h={getSnapshot:g,value:T},g=ss.updateQueue,g===null?(g={lastEffect:null,stores:null},ss.updateQueue=g,g.stores=[h]):(T=g.stores,T===null?g.stores=[h]:T.push(h))}function c3(h,g,T,D){g.value=T,g.getSnapshot=D,Zu(g)&&Xp(h)}function G6(h,g,T){return T(function(){Zu(g)&&Xp(h)})}function Zu(h){var g=h.getSnapshot;h=h.value;try{var T=g();return!ma(h,T)}catch{return!0}}function Xp(h){var g=Xu(h,1);g!==null&&z0(g,h,1,-1)}function u3(h){var g=Yc();return typeof h=="function"&&(h=h()),g.memoizedState=g.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$p,lastRenderedState:h},g.queue=h,h=h.dispatch=Qm.bind(null,ss,h),[g.memoizedState,h]}function ef(h,g,T,D){return h={tag:h,create:g,destroy:T,deps:D,next:null},g=ss.updateQueue,g===null?(g={lastEffect:null,stores:null},ss.updateQueue=g,g.lastEffect=h.next=h):(T=g.lastEffect,T===null?g.lastEffect=h.next=h:(D=T.next,T.next=h,h.next=D,g.lastEffect=h)),h}function v5(){return xl().memoizedState}function tf(h,g,T,D){var W=Yc();ss.flags|=h,W.memoizedState=ef(1|g,T,void 0,D===void 0?null:D)}function Km(h,g,T,D){var W=xl();D=D===void 0?null:D;var J=void 0;if(Fs!==null){var fe=Fs.memoizedState;if(J=fe.destroy,D!==null&&qp(D,fe.deps)){W.memoizedState=ef(g,T,J,D);return}}ss.flags|=h,W.memoizedState=ef(1|g,T,J,D)}function j6(h,g){return tf(8390656,8,h,g)}function d3(h,g){return Km(2048,8,h,g)}function h3(h,g){return Km(4,2,h,g)}function H6(h,g){return Km(4,4,h,g)}function Zm(h,g){if(typeof g=="function")return h=h(),g(h),function(){g(null)};if(g!=null)return h=h(),g.current=h,function(){g.current=null}}function y5(h,g,T){return T=T!=null?T.concat([h]):null,Km(4,4,Zm.bind(null,g,h),T)}function f3(){}function _5(h,g){var T=xl();g=g===void 0?null:g;var D=T.memoizedState;return D!==null&&g!==null&&qp(g,D[1])?D[0]:(T.memoizedState=[h,g],h)}function p3(h,g){var T=xl();g=g===void 0?null:g;var D=T.memoizedState;return D!==null&&g!==null&&qp(g,D[1])?D[0]:(h=h(),T.memoizedState=[h,g],h)}function W6(h,g,T){return(Ku&21)===0?(h.baseState&&(h.baseState=!1,u0=!0),h.memoizedState=T):(ma(T,g)||(T=ha(),ss.lanes|=T,Kd|=T,h.baseState=!0),g)}function Yp(h,g){var T=Nr;Nr=T!==0&&4>T?T:4,h(!0);var D=qd.transition;qd.transition={};try{h(!1),g()}finally{Nr=T,qd.transition=D}}function x5(){return xl().memoizedState}function b5(h,g,T){var D=eu(h);if(T={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null},m3(h))S5(g,T);else if(T=h5(h,g,T,D),T!==null){var W=oo();z0(T,h,D,W),g3(T,g,D)}}function Qm(h,g,T){var D=eu(h),W={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null};if(m3(h))S5(g,W);else{var J=h.alternate;if(h.lanes===0&&(J===null||J.lanes===0)&&(J=g.lastRenderedReducer,J!==null))try{var fe=g.lastRenderedState,Oe=J(fe,T);if(W.hasEagerState=!0,W.eagerState=Oe,ma(Oe,fe)){var Ye=g.interleaved;Ye===null?(W.next=W,Vp(g)):(W.next=Ye.next,Ye.next=W),g.interleaved=W;return}}catch{}finally{}T=h5(h,g,W,D),T!==null&&(W=oo(),z0(T,h,D,W),g3(T,g,D))}}function m3(h){var g=h.alternate;return h===ss||g!==null&&g===ss}function S5(h,g){Wp=o3=!0;var T=h.pending;T===null?g.next=g:(g.next=T.next,T.next=g),h.pending=g}function g3(h,g,T){if((T&4194240)!==0){var D=g.lanes;D&=h.pendingLanes,T|=D,g.lanes=T,xi(h,T)}}var Kc={readContext:_l,useCallback:so,useContext:so,useEffect:so,useImperativeHandle:so,useInsertionEffect:so,useLayoutEffect:so,useMemo:so,useReducer:so,useRef:so,useState:so,useDebugValue:so,useDeferredValue:so,useTransition:so,useMutableSource:so,useSyncExternalStore:so,useId:so,unstable_isNewReconciler:!1},Kp={readContext:_l,useCallback:function(h,g){return Yc().memoizedState=[h,g===void 0?null:g],h},useContext:_l,useEffect:j6,useImperativeHandle:function(h,g,T){return T=T!=null?T.concat([h]):null,tf(4194308,4,Zm.bind(null,g,h),T)},useLayoutEffect:function(h,g){return tf(4194308,4,h,g)},useInsertionEffect:function(h,g){return tf(4,2,h,g)},useMemo:function(h,g){var T=Yc();return g=g===void 0?null:g,h=h(),T.memoizedState=[h,g],h},useReducer:function(h,g,T){var D=Yc();return g=T!==void 0?T(g):g,D.memoizedState=D.baseState=g,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:g},D.queue=h,h=h.dispatch=b5.bind(null,ss,h),[D.memoizedState,h]},useRef:function(h){var g=Yc();return h={current:h},g.memoizedState=h},useState:u3,useDebugValue:f3,useDeferredValue:function(h){return Yc().memoizedState=h},useTransition:function(){var h=u3(!1),g=h[0];return h=Yp.bind(null,h[1]),Yc().memoizedState=h,[g,h]},useMutableSource:function(){},useSyncExternalStore:function(h,g,T){var D=ss,W=Yc();if(As){if(T===void 0)throw Error(t(407));T=T()}else{if(T=g(),Fo===null)throw Error(t(349));(Ku&30)!==0||V6(D,g,T)}W.memoizedState=T;var J={value:T,getSnapshot:g};return W.queue=J,j6(G6.bind(null,D,J,h),[h]),D.flags|=2048,ef(9,c3.bind(null,D,J,T,g),void 0,null),T},useId:function(){var h=Yc(),g=Fo.identifierPrefix;if(As){var T=qc,D=yl;T=(D&~(1<<32-ur(D)-1)).toString(32)+T,g=":"+g+"R"+T,T=Xm++,0<T&&(g+="H"+T.toString(32)),g+=":"}else T=B6++,g=":"+g+"r"+T.toString(32)+":";return h.memoizedState=g},unstable_isNewReconciler:!1},tb={readContext:_l,useCallback:_5,useContext:_l,useEffect:d3,useImperativeHandle:y5,useInsertionEffect:h3,useLayoutEffect:H6,useMemo:p3,useReducer:m5,useRef:v5,useState:function(){return m5($p)},useDebugValue:f3,useDeferredValue:function(h){var g=xl();return W6(g,Fs.memoizedState,h)},useTransition:function(){var h=m5($p)[0],g=xl().memoizedState;return[h,g]},useMutableSource:l3,useSyncExternalStore:z6,useId:x5,unstable_isNewReconciler:!1},v3={readContext:_l,useCallback:_5,useContext:_l,useEffect:d3,useImperativeHandle:y5,useInsertionEffect:h3,useLayoutEffect:H6,useMemo:p3,useReducer:g5,useRef:v5,useState:function(){return g5($p)},useDebugValue:f3,useDeferredValue:function(h){var g=xl();return Fs===null?g.memoizedState=h:W6(g,Fs.memoizedState,h)},useTransition:function(){var h=g5($p)[0],g=xl().memoizedState;return[h,g]},useMutableSource:l3,useSyncExternalStore:z6,useId:x5,unstable_isNewReconciler:!1};function U0(h,g){if(h&&h.defaultProps){g=bt({},g),h=h.defaultProps;for(var T in h)g[T]===void 0&&(g[T]=h[T]);return g}return g}function w5(h,g,T,D){g=h.memoizedState,T=T(D,g),T=T==null?g:bt({},g,T),h.memoizedState=T,h.lanes===0&&(h.updateQueue.baseState=T)}var Zc={isMounted:function(h){return(h=h._reactInternals)?ko(h)===h:!1},enqueueSetState:function(h,g,T){h=h._reactInternals;var D=oo(),W=eu(h),J=F0(D,W);J.payload=g,T!=null&&(J.callback=T),g=dc(h,J,W),g!==null&&(z0(g,h,W,D),r3(g,h,W))},enqueueReplaceState:function(h,g,T){h=h._reactInternals;var D=oo(),W=eu(h),J=F0(D,W);J.tag=1,J.payload=g,T!=null&&(J.callback=T),g=dc(h,J,W),g!==null&&(z0(g,h,W,D),r3(g,h,W))},enqueueForceUpdate:function(h,g){h=h._reactInternals;var T=oo(),D=eu(h),W=F0(T,D);W.tag=2,g!=null&&(W.callback=g),g=dc(h,W,D),g!==null&&(z0(g,h,D,T),r3(g,h,D))}};function bl(h,g,T,D,W,J,fe){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(D,J,fe):g.prototype&&g.prototype.isPureReactComponent?!lc(T,D)||!lc(W,J):!0}function Zp(h,g,T){var D=!1,W=zd,J=g.contextType;return typeof J=="object"&&J!==null?J=_l(J):(W=a0(g)?Hu:ga.current,D=g.contextTypes,J=(D=D!=null)?Vd(h,W):zd),g=new g(T,J),h.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Zc,h.stateNode=g,g._reactInternals=h,D&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=W,h.__reactInternalMemoizedMaskedChildContext=J),g}function Jm(h,g,T,D){h=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(T,D),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(T,D),g.state!==h&&Zc.enqueueReplaceState(g,g.state,null)}function eg(h,g,T,D){var W=h.stateNode;W.props=T,W.state=h.memoizedState,W.refs={},n3(h);var J=g.contextType;typeof J=="object"&&J!==null?W.context=_l(J):(J=a0(g)?Hu:ga.current,W.context=Vd(h,J)),W.state=h.memoizedState,J=g.getDerivedStateFromProps,typeof J=="function"&&(w5(h,g,J,T),W.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof W.getSnapshotBeforeUpdate=="function"||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(g=W.state,typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount(),g!==W.state&&Zc.enqueueReplaceState(W,W.state,null),Hm(h,T,W,D),W.state=h.memoizedState),typeof W.componentDidMount=="function"&&(h.flags|=4194308)}function Qp(h,g){try{var T="",D=g;do T+=bn(D),D=D.return;while(D);var W=T}catch(J){W=`
Error generating stack: `+J.message+`
`+J.stack}return{value:h,source:g,stack:W,digest:null}}function tg(h,g,T){return{value:h,source:null,stack:T??null,digest:g??null}}function y3(h,g){try{console.error(g.value)}catch(T){setTimeout(function(){throw T})}}var _3=typeof WeakMap=="function"?WeakMap:Map;function T5(h,g,T){T=F0(-1,T),T.tag=3,T.payload={element:null};var D=g.value;return T.callback=function(){I3||(I3=!0,N3=D),y3(h,g)},T}function ng(h,g,T){T=F0(-1,T),T.tag=3;var D=h.type.getDerivedStateFromError;if(typeof D=="function"){var W=g.value;T.payload=function(){return D(W)},T.callback=function(){y3(h,g)}}var J=h.stateNode;return J!==null&&typeof J.componentDidCatch=="function"&&(T.callback=function(){y3(h,g),typeof D!="function"&&(mc===null?mc=new Set([this]):mc.add(this));var fe=g.stack;this.componentDidCatch(g.value,{componentStack:fe!==null?fe:""})}),T}function q6(h,g,T){var D=h.pingCache;if(D===null){D=h.pingCache=new _3;var W=new Set;D.set(g,W)}else W=D.get(g),W===void 0&&(W=new Set,D.set(g,W));W.has(T)||(W.add(T),h=ob.bind(null,h,g,T),g.then(h,h))}function E5(h){do{var g;if((g=h.tag===13)&&(g=h.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return h;h=h.return}while(h!==null);return null}function rg(h,g,T,D,W){return(h.mode&1)===0?(h===g?h.flags|=65536:(h.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(g=F0(-1,1),g.tag=2,dc(T,g,1))),T.lanes|=1),h):(h.flags|=65536,h.lanes=W,h)}var M5=A.ReactCurrentOwner,u0=!1;function va(h,g,T,D){g.child=h===null?c5(g,null,T,D):Zh(g,h.child,T,D)}function x3(h,g,T,D,W){T=T.render;var J=g.ref;return $u(g,W),D=a3(h,g,T,D,J,W),T=Ym(),h!==null&&!u0?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~W,Qu(h,g,W)):(As&&T&&Kh(g),g.flags|=1,va(h,g,D,W),g.child)}function C5(h,g,T,D,W){if(h===null){var J=T.type;return typeof J=="function"&&!gg(J)&&J.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(g.tag=15,g.type=J,b3(h,g,J,D,W)):(h=z3(T.type,null,D,g,g.mode,W),h.ref=g.ref,h.return=g,g.child=h)}if(J=h.child,(h.lanes&W)===0){var fe=J.memoizedProps;if(T=T.compare,T=T!==null?T:lc,T(fe,D)&&h.ref===g.ref)return Qu(h,g,W)}return g.flags|=1,h=tu(J,D),h.ref=g.ref,h.return=g,g.child=h}function b3(h,g,T,D,W){if(h!==null){var J=h.memoizedProps;if(lc(J,D)&&h.ref===g.ref)if(u0=!1,g.pendingProps=D=J,(h.lanes&W)!==0)(h.flags&131072)!==0&&(u0=!0);else return g.lanes=h.lanes,Qu(h,g,W)}return Jp(h,g,T,D,W)}function A5(h,g,T){var D=g.pendingProps,W=D.children,J=h!==null?h.memoizedState:null;if(D.mode==="hidden")if((g.mode&1)===0)g.memoizedState={baseLanes:0,cachePool:null,transitions:null},ps(Xd,h0),h0|=T;else{if((T&1073741824)===0)return h=J!==null?J.baseLanes|T:T,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:h,cachePool:null,transitions:null},g.updateQueue=null,ps(Xd,h0),h0|=h,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=J!==null?J.baseLanes:T,ps(Xd,h0),h0|=D}else J!==null?(D=J.baseLanes|T,g.memoizedState=null):D=T,ps(Xd,h0),h0|=D;return va(h,g,W,T),g.child}function P5(h,g){var T=g.ref;(h===null&&T!==null||h!==null&&h.ref!==T)&&(g.flags|=512,g.flags|=2097152)}function Jp(h,g,T,D,W){var J=a0(T)?Hu:ga.current;return J=Vd(g,J),$u(g,W),T=a3(h,g,T,D,J,W),D=Ym(),h!==null&&!u0?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~W,Qu(h,g,W)):(As&&D&&Kh(g),g.flags|=1,va(h,g,T,W),g.child)}function R5(h,g,T,D,W){if(a0(T)){var J=!0;Lm(g)}else J=!1;if($u(g,W),g.stateNode===null)ig(h,g),Zp(g,T,D),eg(g,T,D,W),D=!0;else if(h===null){var fe=g.stateNode,Oe=g.memoizedProps;fe.props=Oe;var Ye=fe.context,It=T.contextType;typeof It=="object"&&It!==null?It=_l(It):(It=a0(T)?Hu:ga.current,It=Vd(g,It));var nn=T.getDerivedStateFromProps,dn=typeof nn=="function"||typeof fe.getSnapshotBeforeUpdate=="function";dn||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Oe!==D||Ye!==It)&&Jm(g,fe,D,It),$c=!1;var tn=g.memoizedState;fe.state=tn,Hm(g,D,fe,W),Ye=g.memoizedState,Oe!==D||tn!==Ye||Pa.current||$c?(typeof nn=="function"&&(w5(g,T,nn,D),Ye=g.memoizedState),(Oe=$c||bl(g,T,Oe,D,tn,Ye,It))?(dn||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount()),typeof fe.componentDidMount=="function"&&(g.flags|=4194308)):(typeof fe.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=D,g.memoizedState=Ye),fe.props=D,fe.state=Ye,fe.context=It,D=Oe):(typeof fe.componentDidMount=="function"&&(g.flags|=4194308),D=!1)}else{fe=g.stateNode,F6(h,g),Oe=g.memoizedProps,It=g.type===g.elementType?Oe:U0(g.type,Oe),fe.props=It,dn=g.pendingProps,tn=fe.context,Ye=T.contextType,typeof Ye=="object"&&Ye!==null?Ye=_l(Ye):(Ye=a0(T)?Hu:ga.current,Ye=Vd(g,Ye));var Hn=T.getDerivedStateFromProps;(nn=typeof Hn=="function"||typeof fe.getSnapshotBeforeUpdate=="function")||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Oe!==dn||tn!==Ye)&&Jm(g,fe,D,Ye),$c=!1,tn=g.memoizedState,fe.state=tn,Hm(g,D,fe,W);var Qn=g.memoizedState;Oe!==dn||tn!==Qn||Pa.current||$c?(typeof Hn=="function"&&(w5(g,T,Hn,D),Qn=g.memoizedState),(It=$c||bl(g,T,It,D,tn,Qn,Ye)||!1)?(nn||typeof fe.UNSAFE_componentWillUpdate!="function"&&typeof fe.componentWillUpdate!="function"||(typeof fe.componentWillUpdate=="function"&&fe.componentWillUpdate(D,Qn,Ye),typeof fe.UNSAFE_componentWillUpdate=="function"&&fe.UNSAFE_componentWillUpdate(D,Qn,Ye)),typeof fe.componentDidUpdate=="function"&&(g.flags|=4),typeof fe.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof fe.componentDidUpdate!="function"||Oe===h.memoizedProps&&tn===h.memoizedState||(g.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||Oe===h.memoizedProps&&tn===h.memoizedState||(g.flags|=1024),g.memoizedProps=D,g.memoizedState=Qn),fe.props=D,fe.state=Qn,fe.context=Ye,D=It):(typeof fe.componentDidUpdate!="function"||Oe===h.memoizedProps&&tn===h.memoizedState||(g.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||Oe===h.memoizedProps&&tn===h.memoizedState||(g.flags|=1024),D=!1)}return I5(h,g,T,D,J,W)}function I5(h,g,T,D,W,J){P5(h,g);var fe=(g.flags&128)!==0;if(!D&&!fe)return W&&k6(g,T,!1),Qu(h,g,J);D=g.stateNode,M5.current=g;var Oe=fe&&typeof T.getDerivedStateFromError!="function"?null:D.render();return g.flags|=1,h!==null&&fe?(g.child=Zh(g,h.child,null,J),g.child=Zh(g,null,Oe,J)):va(h,g,Oe,J),g.memoizedState=D.state,W&&k6(g,T,!0),g.child}function N5(h){var g=h.stateNode;g.pendingContext?i5(h,g.pendingContext,g.pendingContext!==g.context):g.context&&i5(h,g.context,!1),i3(h,g.containerInfo)}function k5(h,g,T,D,W){return Bp(),J2(W),g.flags|=256,va(h,g,T,D),g.child}var S3={dehydrated:null,treeContext:null,retryLane:0};function D5(h){return{baseLanes:h,cachePool:null,transitions:null}}function $6(h,g,T){var D=g.pendingProps,W=js.current,J=!1,fe=(g.flags&128)!==0,Oe;if((Oe=fe)||(Oe=h!==null&&h.memoizedState===null?!1:(W&2)!==0),Oe?(J=!0,g.flags&=-129):(h===null||h.memoizedState!==null)&&(W|=1),ps(js,W&1),h===null)return Up(g),h=g.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?((g.mode&1)===0?g.lanes=1:h.data==="$!"?g.lanes=8:g.lanes=1073741824,null):(fe=D.children,h=D.fallback,J?(D=g.mode,J=g.child,fe={mode:"hidden",children:fe},(D&1)===0&&J!==null?(J.childLanes=0,J.pendingProps=fe):J=vg(fe,D,0,null),h=of(h,D,T,null),J.return=g,h.return=g,J.sibling=h,g.child=J,g.child.memoizedState=D5(T),g.memoizedState=S3,h):w3(g,fe));if(W=h.memoizedState,W!==null&&(Oe=W.dehydrated,Oe!==null))return nb(h,g,fe,D,Oe,W,T);if(J){J=D.fallback,fe=g.mode,W=h.child,Oe=W.sibling;var Ye={mode:"hidden",children:D.children};return(fe&1)===0&&g.child!==W?(D=g.child,D.childLanes=0,D.pendingProps=Ye,g.deletions=null):(D=tu(W,Ye),D.subtreeFlags=W.subtreeFlags&14680064),Oe!==null?J=tu(Oe,J):(J=of(J,fe,T,null),J.flags|=2),J.return=g,D.return=g,D.sibling=J,g.child=D,D=J,J=g.child,fe=h.child.memoizedState,fe=fe===null?D5(T):{baseLanes:fe.baseLanes|T,cachePool:null,transitions:fe.transitions},J.memoizedState=fe,J.childLanes=h.childLanes&~T,g.memoizedState=S3,D}return J=h.child,h=J.sibling,D=tu(J,{mode:"visible",children:D.children}),(g.mode&1)===0&&(D.lanes=T),D.return=g,D.sibling=null,h!==null&&(T=g.deletions,T===null?(g.deletions=[h],g.flags|=16):T.push(h)),g.child=D,g.memoizedState=null,D}function w3(h,g){return g=vg({mode:"visible",children:g},h.mode,0,null),g.return=h,h.child=g}function T3(h,g,T,D){return D!==null&&J2(D),Zh(g,h.child,null,T),h=w3(g,g.pendingProps.children),h.flags|=2,g.memoizedState=null,h}function nb(h,g,T,D,W,J,fe){if(T)return g.flags&256?(g.flags&=-257,D=tg(Error(t(422))),T3(h,g,fe,D)):g.memoizedState!==null?(g.child=h.child,g.flags|=128,null):(J=D.fallback,W=g.mode,D=vg({mode:"visible",children:D.children},W,0,null),J=of(J,W,fe,null),J.flags|=2,D.return=g,J.return=g,D.sibling=J,g.child=D,(g.mode&1)!==0&&Zh(g,h.child,null,fe),g.child.memoizedState=D5(fe),g.memoizedState=S3,J);if((g.mode&1)===0)return T3(h,g,fe,null);if(W.data==="$!"){if(D=W.nextSibling&&W.nextSibling.dataset,D)var Oe=D.dgst;return D=Oe,J=Error(t(419)),D=tg(J,D,void 0),T3(h,g,fe,D)}if(Oe=(fe&h.childLanes)!==0,u0||Oe){if(D=Fo,D!==null){switch(fe&-fe){case 4:W=2;break;case 16:W=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:W=32;break;case 536870912:W=268435456;break;default:W=0}W=(W&(D.suspendedLanes|fe))!==0?0:W,W!==0&&W!==J.retryLane&&(J.retryLane=W,Xu(h,W),z0(D,h,W,-1))}return K5(),D=tg(Error(t(421))),T3(h,g,fe,D)}return W.data==="$?"?(g.flags|=128,g.child=h.child,g=ry.bind(null,h),W._reactRetry=g,null):(h=J.treeContext,l0=zu(W.nextSibling),O0=g,As=!0,c0=null,h!==null&&(vl[D0++]=yl,vl[D0++]=qc,vl[D0++]=jd,yl=h.id,qc=h.overflow,jd=g),g=w3(g,D.children),g.flags|=4096,g)}function Zi(h,g,T){h.lanes|=g;var D=h.alternate;D!==null&&(D.lanes|=g),zp(h.return,g,T)}function nf(h,g,T,D,W){var J=h.memoizedState;J===null?h.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:D,tail:T,tailMode:W}:(J.isBackwards=g,J.rendering=null,J.renderingStartTime=0,J.last=D,J.tail=T,J.tailMode=W)}function X6(h,g,T){var D=g.pendingProps,W=D.revealOrder,J=D.tail;if(va(h,g,D.children,T),D=js.current,(D&2)!==0)D=D&1|2,g.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=g.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&Zi(h,T,g);else if(h.tag===19)Zi(h,T,g);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===g)break e;for(;h.sibling===null;){if(h.return===null||h.return===g)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}D&=1}if(ps(js,D),(g.mode&1)===0)g.memoizedState=null;else switch(W){case"forwards":for(T=g.child,W=null;T!==null;)h=T.alternate,h!==null&&Yu(h)===null&&(W=T),T=T.sibling;T=W,T===null?(W=g.child,g.child=null):(W=T.sibling,T.sibling=null),nf(g,!1,W,T,J);break;case"backwards":for(T=null,W=g.child,g.child=null;W!==null;){if(h=W.alternate,h!==null&&Yu(h)===null){g.child=W;break}h=W.sibling,W.sibling=T,T=W,W=h}nf(g,!0,T,null,J);break;case"together":nf(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function ig(h,g){(g.mode&1)===0&&h!==null&&(h.alternate=null,g.alternate=null,g.flags|=2)}function Qu(h,g,T){if(h!==null&&(g.dependencies=h.dependencies),Kd|=g.lanes,(T&g.childLanes)===0)return null;if(h!==null&&g.child!==h.child)throw Error(t(153));if(g.child!==null){for(h=g.child,T=tu(h,h.pendingProps),g.child=T,T.return=g;h.sibling!==null;)h=h.sibling,T=T.sibling=tu(h,h.pendingProps),T.return=g;T.sibling=null}return g.child}function rb(h,g,T){switch(g.tag){case 3:N5(g),Bp();break;case 5:U6(g);break;case 1:a0(g.type)&&Lm(g);break;case 4:i3(g,g.stateNode.containerInfo);break;case 10:var D=g.type._context,W=g.memoizedProps.value;ps(e3,D._currentValue),D._currentValue=W;break;case 13:if(D=g.memoizedState,D!==null)return D.dehydrated!==null?(ps(js,js.current&1),g.flags|=128,null):(T&g.child.childLanes)!==0?$6(h,g,T):(ps(js,js.current&1),h=Qu(h,g,T),h!==null?h.sibling:null);ps(js,js.current&1);break;case 19:if(D=(T&g.childLanes)!==0,(h.flags&128)!==0){if(D)return X6(h,g,T);g.flags|=128}if(W=g.memoizedState,W!==null&&(W.rendering=null,W.tail=null,W.lastEffect=null),ps(js,js.current),D)break;return null;case 22:case 23:return g.lanes=0,A5(h,g,T)}return Qu(h,g,T)}var O5,L5,Y6,F5;O5=function(h,g){for(var T=g.child;T!==null;){if(T.tag===5||T.tag===6)h.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===g)break;for(;T.sibling===null;){if(T.return===null||T.return===g)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},L5=function(){},Y6=function(h,g,T,D){var W=h.memoizedProps;if(W!==D){h=g.stateNode,Wd(Xc.current);var J=null;switch(T){case"input":W=Br(h,W),D=Br(h,D),J=[];break;case"select":W=bt({},W,{value:void 0}),D=bt({},D,{value:void 0}),J=[];break;case"textarea":W=Fn(h,W),D=Fn(h,D),J=[];break;default:typeof W.onClick!="function"&&typeof D.onClick=="function"&&(h.onclick=km)}Vn(T,D);var fe;T=null;for(It in W)if(!D.hasOwnProperty(It)&&W.hasOwnProperty(It)&&W[It]!=null)if(It==="style"){var Oe=W[It];for(fe in Oe)Oe.hasOwnProperty(fe)&&(T||(T={}),T[fe]="")}else It!=="dangerouslySetInnerHTML"&&It!=="children"&&It!=="suppressContentEditableWarning"&&It!=="suppressHydrationWarning"&&It!=="autoFocus"&&(r.hasOwnProperty(It)?J||(J=[]):(J=J||[]).push(It,null));for(It in D){var Ye=D[It];if(Oe=W!=null?W[It]:void 0,D.hasOwnProperty(It)&&Ye!==Oe&&(Ye!=null||Oe!=null))if(It==="style")if(Oe){for(fe in Oe)!Oe.hasOwnProperty(fe)||Ye&&Ye.hasOwnProperty(fe)||(T||(T={}),T[fe]="");for(fe in Ye)Ye.hasOwnProperty(fe)&&Oe[fe]!==Ye[fe]&&(T||(T={}),T[fe]=Ye[fe])}else T||(J||(J=[]),J.push(It,T)),T=Ye;else It==="dangerouslySetInnerHTML"?(Ye=Ye?Ye.__html:void 0,Oe=Oe?Oe.__html:void 0,Ye!=null&&Oe!==Ye&&(J=J||[]).push(It,Ye)):It==="children"?typeof Ye!="string"&&typeof Ye!="number"||(J=J||[]).push(It,""+Ye):It!=="suppressContentEditableWarning"&&It!=="suppressHydrationWarning"&&(r.hasOwnProperty(It)?(Ye!=null&&It==="onScroll"&&Cs("scroll",h),J||Oe===Ye||(J=[])):(J=J||[]).push(It,Ye))}T&&(J=J||[]).push("style",T);var It=J;(g.updateQueue=It)&&(g.flags|=4)}},F5=function(h,g,T,D){T!==D&&(g.flags|=4)};function sg(h,g){if(!As)switch(h.tailMode){case"hidden":g=h.tail;for(var T=null;g!==null;)g.alternate!==null&&(T=g),g=g.sibling;T===null?h.tail=null:T.sibling=null;break;case"collapsed":T=h.tail;for(var D=null;T!==null;)T.alternate!==null&&(D=T),T=T.sibling;D===null?g||h.tail===null?h.tail=null:h.tail.sibling=null:D.sibling=null}}function Ra(h){var g=h.alternate!==null&&h.alternate.child===h.child,T=0,D=0;if(g)for(var W=h.child;W!==null;)T|=W.lanes|W.childLanes,D|=W.subtreeFlags&14680064,D|=W.flags&14680064,W.return=h,W=W.sibling;else for(W=h.child;W!==null;)T|=W.lanes|W.childLanes,D|=W.subtreeFlags,D|=W.flags,W.return=h,W=W.sibling;return h.subtreeFlags|=D,h.childLanes=T,g}function K6(h,g,T){var D=g.pendingProps;switch(Fm(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ra(g),null;case 1:return a0(g.type)&&Fp(),Ra(g),null;case 3:return D=g.stateNode,jp(),is(Pa),is(ga),Hp(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(h===null||h.child===null)&&(Bm(g)?g.flags|=4:h===null||h.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,c0!==null&&(hg(c0),c0=null))),L5(h,g),Ra(g),null;case 5:s3(g);var W=Wd(qm.current);if(T=g.type,h!==null&&g.stateNode!=null)Y6(h,g,T,D,W),h.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!D){if(g.stateNode===null)throw Error(t(166));return Ra(g),null}if(h=Wd(Xc.current),Bm(g)){D=g.stateNode,T=g.type;var J=g.memoizedProps;switch(D[Ci]=g,D[Dm]=J,h=(g.mode&1)!==0,T){case"dialog":Cs("cancel",D),Cs("close",D);break;case"iframe":case"object":case"embed":Cs("load",D);break;case"video":case"audio":for(W=0;W<jh.length;W++)Cs(jh[W],D);break;case"source":Cs("error",D);break;case"img":case"image":case"link":Cs("error",D),Cs("load",D);break;case"details":Cs("toggle",D);break;case"input":Kr(D,J),Cs("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!J.multiple},Cs("invalid",D);break;case"textarea":Pe(D,J),Cs("invalid",D)}Vn(T,J),W=null;for(var fe in J)if(J.hasOwnProperty(fe)){var Oe=J[fe];fe==="children"?typeof Oe=="string"?D.textContent!==Oe&&(J.suppressHydrationWarning!==!0&&Nm(D.textContent,Oe,h),W=["children",Oe]):typeof Oe=="number"&&D.textContent!==""+Oe&&(J.suppressHydrationWarning!==!0&&Nm(D.textContent,Oe,h),W=["children",""+Oe]):r.hasOwnProperty(fe)&&Oe!=null&&fe==="onScroll"&&Cs("scroll",D)}switch(T){case"input":fr(D),qe(D,J,!0);break;case"textarea":fr(D),dt(D);break;case"select":case"option":break;default:typeof J.onClick=="function"&&(D.onclick=km)}D=W,g.updateQueue=D,D!==null&&(g.flags|=4)}else{fe=W.nodeType===9?W:W.ownerDocument,h==="http://www.w3.org/1999/xhtml"&&(h=qt(T)),h==="http://www.w3.org/1999/xhtml"?T==="script"?(h=fe.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild)):typeof D.is=="string"?h=fe.createElement(T,{is:D.is}):(h=fe.createElement(T),T==="select"&&(fe=h,D.multiple?fe.multiple=!0:D.size&&(fe.size=D.size))):h=fe.createElementNS(h,T),h[Ci]=g,h[Dm]=D,O5(h,g,!1,!1),g.stateNode=h;e:{switch(fe=Dn(T,D),T){case"dialog":Cs("cancel",h),Cs("close",h),W=D;break;case"iframe":case"object":case"embed":Cs("load",h),W=D;break;case"video":case"audio":for(W=0;W<jh.length;W++)Cs(jh[W],h);W=D;break;case"source":Cs("error",h),W=D;break;case"img":case"image":case"link":Cs("error",h),Cs("load",h),W=D;break;case"details":Cs("toggle",h),W=D;break;case"input":Kr(h,D),W=Br(h,D),Cs("invalid",h);break;case"option":W=D;break;case"select":h._wrapperState={wasMultiple:!!D.multiple},W=bt({},D,{value:void 0}),Cs("invalid",h);break;case"textarea":Pe(h,D),W=Fn(h,D),Cs("invalid",h);break;default:W=D}Vn(T,W),Oe=W;for(J in Oe)if(Oe.hasOwnProperty(J)){var Ye=Oe[J];J==="style"?pn(h,Ye):J==="dangerouslySetInnerHTML"?(Ye=Ye?Ye.__html:void 0,Ye!=null&&$n(h,Ye)):J==="children"?typeof Ye=="string"?(T!=="textarea"||Ye!=="")&&_n(h,Ye):typeof Ye=="number"&&_n(h,""+Ye):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?Ye!=null&&J==="onScroll"&&Cs("scroll",h):Ye!=null&&Y(h,J,Ye,fe))}switch(T){case"input":fr(h),qe(h,D,!1);break;case"textarea":fr(h),dt(h);break;case"option":D.value!=null&&h.setAttribute("value",""+$t(D.value));break;case"select":h.multiple=!!D.multiple,J=D.value,J!=null?gi(h,!!D.multiple,J,!1):D.defaultValue!=null&&gi(h,!!D.multiple,D.defaultValue,!0);break;default:typeof W.onClick=="function"&&(h.onclick=km)}switch(T){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Ra(g),null;case 6:if(h&&g.stateNode!=null)F5(h,g,h.memoizedProps,D);else{if(typeof D!="string"&&g.stateNode===null)throw Error(t(166));if(T=Wd(qm.current),Wd(Xc.current),Bm(g)){if(D=g.stateNode,T=g.memoizedProps,D[Ci]=g,(J=D.nodeValue!==T)&&(h=O0,h!==null))switch(h.tag){case 3:Nm(D.nodeValue,T,(h.mode&1)!==0);break;case 5:h.memoizedProps.suppressHydrationWarning!==!0&&Nm(D.nodeValue,T,(h.mode&1)!==0)}J&&(g.flags|=4)}else D=(T.nodeType===9?T:T.ownerDocument).createTextNode(D),D[Ci]=g,g.stateNode=D}return Ra(g),null;case 13:if(is(js),D=g.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(As&&l0!==null&&(g.mode&1)!==0&&(g.flags&128)===0)L6(),Bp(),g.flags|=98560,J=!1;else if(J=Bm(g),D!==null&&D.dehydrated!==null){if(h===null){if(!J)throw Error(t(318));if(J=g.memoizedState,J=J!==null?J.dehydrated:null,!J)throw Error(t(317));J[Ci]=g}else Bp(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Ra(g),J=!1}else c0!==null&&(hg(c0),c0=null),J=!0;if(!J)return g.flags&65536?g:null}return(g.flags&128)!==0?(g.lanes=T,g):(D=D!==null,D!==(h!==null&&h.memoizedState!==null)&&D&&(g.child.flags|=8192,(g.mode&1)!==0&&(h===null||(js.current&1)!==0?Gr===0&&(Gr=3):K5())),g.updateQueue!==null&&(g.flags|=4),Ra(g),null);case 4:return jp(),L5(h,g),h===null&&Op(g.stateNode.containerInfo),Ra(g),null;case 10:return d5(g.type._context),Ra(g),null;case 17:return a0(g.type)&&Fp(),Ra(g),null;case 19:if(is(js),J=g.memoizedState,J===null)return Ra(g),null;if(D=(g.flags&128)!==0,fe=J.rendering,fe===null)if(D)sg(J,!1);else{if(Gr!==0||h!==null&&(h.flags&128)!==0)for(h=g.child;h!==null;){if(fe=Yu(h),fe!==null){for(g.flags|=128,sg(J,!1),D=fe.updateQueue,D!==null&&(g.updateQueue=D,g.flags|=4),g.subtreeFlags=0,D=T,T=g.child;T!==null;)J=T,h=D,J.flags&=14680066,fe=J.alternate,fe===null?(J.childLanes=0,J.lanes=h,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=fe.childLanes,J.lanes=fe.lanes,J.child=fe.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=fe.memoizedProps,J.memoizedState=fe.memoizedState,J.updateQueue=fe.updateQueue,J.type=fe.type,h=fe.dependencies,J.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),T=T.sibling;return ps(js,js.current&1|2),g.child}h=h.sibling}J.tail!==null&&me()>Ju&&(g.flags|=128,D=!0,sg(J,!1),g.lanes=4194304)}else{if(!D)if(h=Yu(fe),h!==null){if(g.flags|=128,D=!0,T=h.updateQueue,T!==null&&(g.updateQueue=T,g.flags|=4),sg(J,!0),J.tail===null&&J.tailMode==="hidden"&&!fe.alternate&&!As)return Ra(g),null}else 2*me()-J.renderingStartTime>Ju&&T!==1073741824&&(g.flags|=128,D=!0,sg(J,!1),g.lanes=4194304);J.isBackwards?(fe.sibling=g.child,g.child=fe):(T=J.last,T!==null?T.sibling=fe:g.child=fe,J.last=fe)}return J.tail!==null?(g=J.tail,J.rendering=g,J.tail=g.sibling,J.renderingStartTime=me(),g.sibling=null,T=js.current,ps(js,D?T&1|2:T&1),g):(Ra(g),null);case 22:case 23:return F3(),D=g.memoizedState!==null,h!==null&&h.memoizedState!==null!==D&&(g.flags|=8192),D&&(g.mode&1)!==0?(h0&1073741824)!==0&&(Ra(g),g.subtreeFlags&6&&(g.flags|=8192)):Ra(g),null;case 24:return null;case 25:return null}throw Error(t(156,g.tag))}function ib(h,g){switch(Fm(g),g.tag){case 1:return a0(g.type)&&Fp(),h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 3:return jp(),is(Pa),is(ga),Hp(),h=g.flags,(h&65536)!==0&&(h&128)===0?(g.flags=h&-65537|128,g):null;case 5:return s3(g),null;case 13:if(is(js),h=g.memoizedState,h!==null&&h.dehydrated!==null){if(g.alternate===null)throw Error(t(340));Bp()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 19:return is(js),null;case 4:return jp(),null;case 10:return d5(g.type._context),null;case 22:case 23:return F3(),null;case 24:return null;default:return null}}var E3=!1,ta=!1,Z6=typeof WeakSet=="function"?WeakSet:Set,Zn=null;function hc(h,g){var T=h.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(D){Us(h,g,D)}else T.current=null}function $d(h,g,T){try{T()}catch(D){Us(h,g,D)}}var M3=!1;function Q6(h,g){if(q2=gp,h=T6(),W4(h)){if("selectionStart"in h)var T={start:h.selectionStart,end:h.selectionEnd};else e:{T=(T=h.ownerDocument)&&T.defaultView||window;var D=T.getSelection&&T.getSelection();if(D&&D.rangeCount!==0){T=D.anchorNode;var W=D.anchorOffset,J=D.focusNode;D=D.focusOffset;try{T.nodeType,J.nodeType}catch{T=null;break e}var fe=0,Oe=-1,Ye=-1,It=0,nn=0,dn=h,tn=null;t:for(;;){for(var Hn;dn!==T||W!==0&&dn.nodeType!==3||(Oe=fe+W),dn!==J||D!==0&&dn.nodeType!==3||(Ye=fe+D),dn.nodeType===3&&(fe+=dn.nodeValue.length),(Hn=dn.firstChild)!==null;)tn=dn,dn=Hn;for(;;){if(dn===h)break t;if(tn===T&&++It===W&&(Oe=fe),tn===J&&++nn===D&&(Ye=fe),(Hn=dn.nextSibling)!==null)break;dn=tn,tn=dn.parentNode}dn=Hn}T=Oe===-1||Ye===-1?null:{start:Oe,end:Ye}}else T=null}T=T||{start:0,end:0}}else T=null;for($2={focusedElem:h,selectionRange:T},gp=!1,Zn=g;Zn!==null;)if(g=Zn,h=g.child,(g.subtreeFlags&1028)!==0&&h!==null)h.return=g,Zn=h;else for(;Zn!==null;){g=Zn;try{var Qn=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if(Qn!==null){var ir=Qn.memoizedProps,Ys=Qn.memoizedState,xt=g.stateNode,at=xt.getSnapshotBeforeUpdate(g.elementType===g.type?ir:U0(g.type,ir),Ys);xt.__reactInternalSnapshotBeforeUpdate=at}break;case 3:var Ct=g.stateNode.containerInfo;Ct.nodeType===1?Ct.textContent="":Ct.nodeType===9&&Ct.documentElement&&Ct.removeChild(Ct.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(yn){Us(g,g.return,yn)}if(h=g.sibling,h!==null){h.return=g.return,Zn=h;break}Zn=g.return}return Qn=M3,M3=!1,Qn}function e1(h,g,T){var D=g.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var W=D=D.next;do{if((W.tag&h)===h){var J=W.destroy;W.destroy=void 0,J!==void 0&&$d(g,T,J)}W=W.next}while(W!==D)}}function C3(h,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var T=g=g.next;do{if((T.tag&h)===h){var D=T.create;T.destroy=D()}T=T.next}while(T!==g)}}function U5(h){var g=h.ref;if(g!==null){var T=h.stateNode;switch(h.tag){case 5:h=T;break;default:h=T}typeof g=="function"?g(h):g.current=h}}function B5(h){var g=h.alternate;g!==null&&(h.alternate=null,B5(g)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(g=h.stateNode,g!==null&&(delete g[Ci],delete g[Dm],delete g[qh],delete g[Om],delete g[$h])),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function J6(h){return h.tag===5||h.tag===3||h.tag===4}function z5(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||J6(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function og(h,g,T){var D=h.tag;if(D===5||D===6)h=h.stateNode,g?T.nodeType===8?T.parentNode.insertBefore(h,g):T.insertBefore(h,g):(T.nodeType===8?(g=T.parentNode,g.insertBefore(h,T)):(g=T,g.appendChild(h)),T=T._reactRootContainer,T!=null||g.onclick!==null||(g.onclick=km));else if(D!==4&&(h=h.child,h!==null))for(og(h,g,T),h=h.sibling;h!==null;)og(h,g,T),h=h.sibling}function ag(h,g,T){var D=h.tag;if(D===5||D===6)h=h.stateNode,g?T.insertBefore(h,g):T.appendChild(h);else if(D!==4&&(h=h.child,h!==null))for(ag(h,g,T),h=h.sibling;h!==null;)ag(h,g,T),h=h.sibling}var na=null,B0=!1;function fc(h,g,T){for(T=T.child;T!==null;)V5(h,g,T),T=T.sibling}function V5(h,g,T){if(On&&typeof On.onCommitFiberUnmount=="function")try{On.onCommitFiberUnmount(Mn,T)}catch{}switch(T.tag){case 5:ta||hc(T,g);case 6:var D=na,W=B0;na=null,fc(h,g,T),na=D,B0=W,na!==null&&(B0?(h=na,T=T.stateNode,h.nodeType===8?h.parentNode.removeChild(T):h.removeChild(T)):na.removeChild(T.stateNode));break;case 18:na!==null&&(B0?(h=na,T=T.stateNode,h.nodeType===8?K2(h.parentNode,T):h.nodeType===1&&K2(h,T),Rd(h)):K2(na,T.stateNode));break;case 4:D=na,W=B0,na=T.stateNode.containerInfo,B0=!0,fc(h,g,T),na=D,B0=W;break;case 0:case 11:case 14:case 15:if(!ta&&(D=T.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){W=D=D.next;do{var J=W,fe=J.destroy;J=J.tag,fe!==void 0&&((J&2)!==0||(J&4)!==0)&&$d(T,g,fe),W=W.next}while(W!==D)}fc(h,g,T);break;case 1:if(!ta&&(hc(T,g),D=T.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=T.memoizedProps,D.state=T.memoizedState,D.componentWillUnmount()}catch(Oe){Us(T,g,Oe)}fc(h,g,T);break;case 21:fc(h,g,T);break;case 22:T.mode&1?(ta=(D=ta)||T.memoizedState!==null,fc(h,g,T),ta=D):fc(h,g,T);break;default:fc(h,g,T)}}function ey(h){var g=h.updateQueue;if(g!==null){h.updateQueue=null;var T=h.stateNode;T===null&&(T=h.stateNode=new Z6),g.forEach(function(D){var W=iy.bind(null,h,D);T.has(D)||(T.add(D),D.then(W,W))})}}function pc(h,g){var T=g.deletions;if(T!==null)for(var D=0;D<T.length;D++){var W=T[D];try{var J=h,fe=g,Oe=fe;e:for(;Oe!==null;){switch(Oe.tag){case 5:na=Oe.stateNode,B0=!1;break e;case 3:na=Oe.stateNode.containerInfo,B0=!0;break e;case 4:na=Oe.stateNode.containerInfo,B0=!0;break e}Oe=Oe.return}if(na===null)throw Error(t(160));V5(J,fe,W),na=null,B0=!1;var Ye=W.alternate;Ye!==null&&(Ye.return=null),W.return=null}catch(It){Us(W,g,It)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)A3(g,h),g=g.sibling}function A3(h,g){var T=h.alternate,D=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(pc(g,h),Qc(h),D&4){try{e1(3,h,h.return),C3(3,h)}catch(ir){Us(h,h.return,ir)}try{e1(5,h,h.return)}catch(ir){Us(h,h.return,ir)}}break;case 1:pc(g,h),Qc(h),D&512&&T!==null&&hc(T,T.return);break;case 5:if(pc(g,h),Qc(h),D&512&&T!==null&&hc(T,T.return),h.flags&32){var W=h.stateNode;try{_n(W,"")}catch(ir){Us(h,h.return,ir)}}if(D&4&&(W=h.stateNode,W!=null)){var J=h.memoizedProps,fe=T!==null?T.memoizedProps:J,Oe=h.type,Ye=h.updateQueue;if(h.updateQueue=null,Ye!==null)try{Oe==="input"&&J.type==="radio"&&J.name!=null&&Vr(W,J),Dn(Oe,fe);var It=Dn(Oe,J);for(fe=0;fe<Ye.length;fe+=2){var nn=Ye[fe],dn=Ye[fe+1];nn==="style"?pn(W,dn):nn==="dangerouslySetInnerHTML"?$n(W,dn):nn==="children"?_n(W,dn):Y(W,nn,dn,It)}switch(Oe){case"input":ai(W,J);break;case"textarea":de(W,J);break;case"select":var tn=W._wrapperState.wasMultiple;W._wrapperState.wasMultiple=!!J.multiple;var Hn=J.value;Hn!=null?gi(W,!!J.multiple,Hn,!1):tn!==!!J.multiple&&(J.defaultValue!=null?gi(W,!!J.multiple,J.defaultValue,!0):gi(W,!!J.multiple,J.multiple?[]:"",!1))}W[Dm]=J}catch(ir){Us(h,h.return,ir)}}break;case 6:if(pc(g,h),Qc(h),D&4){if(h.stateNode===null)throw Error(t(162));W=h.stateNode,J=h.memoizedProps;try{W.nodeValue=J}catch(ir){Us(h,h.return,ir)}}break;case 3:if(pc(g,h),Qc(h),D&4&&T!==null&&T.memoizedState.isDehydrated)try{Rd(g.containerInfo)}catch(ir){Us(h,h.return,ir)}break;case 4:pc(g,h),Qc(h);break;case 13:pc(g,h),Qc(h),W=h.child,W.flags&8192&&(J=W.memoizedState!==null,W.stateNode.isHidden=J,!J||W.alternate!==null&&W.alternate.memoizedState!==null||($5=me())),D&4&&ey(h);break;case 22:if(nn=T!==null&&T.memoizedState!==null,h.mode&1?(ta=(It=ta)||nn,pc(g,h),ta=It):pc(g,h),Qc(h),D&8192){if(It=h.memoizedState!==null,(h.stateNode.isHidden=It)&&!nn&&(h.mode&1)!==0)for(Zn=h,nn=h.child;nn!==null;){for(dn=Zn=nn;Zn!==null;){switch(tn=Zn,Hn=tn.child,tn.tag){case 0:case 11:case 14:case 15:e1(4,tn,tn.return);break;case 1:hc(tn,tn.return);var Qn=tn.stateNode;if(typeof Qn.componentWillUnmount=="function"){D=tn,T=tn.return;try{g=D,Qn.props=g.memoizedProps,Qn.state=g.memoizedState,Qn.componentWillUnmount()}catch(ir){Us(D,T,ir)}}break;case 5:hc(tn,tn.return);break;case 22:if(tn.memoizedState!==null){j5(dn);continue}}Hn!==null?(Hn.return=tn,Zn=Hn):j5(dn)}nn=nn.sibling}e:for(nn=null,dn=h;;){if(dn.tag===5){if(nn===null){nn=dn;try{W=dn.stateNode,It?(J=W.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none"):(Oe=dn.stateNode,Ye=dn.memoizedProps.style,fe=Ye!=null&&Ye.hasOwnProperty("display")?Ye.display:null,Oe.style.display=Qt("display",fe))}catch(ir){Us(h,h.return,ir)}}}else if(dn.tag===6){if(nn===null)try{dn.stateNode.nodeValue=It?"":dn.memoizedProps}catch(ir){Us(h,h.return,ir)}}else if((dn.tag!==22&&dn.tag!==23||dn.memoizedState===null||dn===h)&&dn.child!==null){dn.child.return=dn,dn=dn.child;continue}if(dn===h)break e;for(;dn.sibling===null;){if(dn.return===null||dn.return===h)break e;nn===dn&&(nn=null),dn=dn.return}nn===dn&&(nn=null),dn.sibling.return=dn.return,dn=dn.sibling}}break;case 19:pc(g,h),Qc(h),D&4&&ey(h);break;case 21:break;default:pc(g,h),Qc(h)}}function Qc(h){var g=h.flags;if(g&2){try{e:{for(var T=h.return;T!==null;){if(J6(T)){var D=T;break e}T=T.return}throw Error(t(160))}switch(D.tag){case 5:var W=D.stateNode;D.flags&32&&(_n(W,""),D.flags&=-33);var J=z5(h);ag(h,J,W);break;case 3:case 4:var fe=D.stateNode.containerInfo,Oe=z5(h);og(h,Oe,fe);break;default:throw Error(t(161))}}catch(Ye){Us(h,h.return,Ye)}h.flags&=-3}g&4096&&(h.flags&=-4097)}function sb(h,g,T){Zn=h,P3(h)}function P3(h,g,T){for(var D=(h.mode&1)!==0;Zn!==null;){var W=Zn,J=W.child;if(W.tag===22&&D){var fe=W.memoizedState!==null||E3;if(!fe){var Oe=W.alternate,Ye=Oe!==null&&Oe.memoizedState!==null||ta;Oe=E3;var It=ta;if(E3=fe,(ta=Ye)&&!It)for(Zn=W;Zn!==null;)fe=Zn,Ye=fe.child,fe.tag===22&&fe.memoizedState!==null?H5(W):Ye!==null?(Ye.return=fe,Zn=Ye):H5(W);for(;J!==null;)Zn=J,P3(J),J=J.sibling;Zn=W,E3=Oe,ta=It}G5(h)}else(W.subtreeFlags&8772)!==0&&J!==null?(J.return=W,Zn=J):G5(h)}}function G5(h){for(;Zn!==null;){var g=Zn;if((g.flags&8772)!==0){var T=g.alternate;try{if((g.flags&8772)!==0)switch(g.tag){case 0:case 11:case 15:ta||C3(5,g);break;case 1:var D=g.stateNode;if(g.flags&4&&!ta)if(T===null)D.componentDidMount();else{var W=g.elementType===g.type?T.memoizedProps:U0(g.type,T.memoizedProps);D.componentDidUpdate(W,T.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var J=g.updateQueue;J!==null&&p5(g,J,D);break;case 3:var fe=g.updateQueue;if(fe!==null){if(T=null,g.child!==null)switch(g.child.tag){case 5:T=g.child.stateNode;break;case 1:T=g.child.stateNode}p5(g,fe,T)}break;case 5:var Oe=g.stateNode;if(T===null&&g.flags&4){T=Oe;var Ye=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":Ye.autoFocus&&T.focus();break;case"img":Ye.src&&(T.src=Ye.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var It=g.alternate;if(It!==null){var nn=It.memoizedState;if(nn!==null){var dn=nn.dehydrated;dn!==null&&Rd(dn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ta||g.flags&512&&U5(g)}catch(tn){Us(g,g.return,tn)}}if(g===h){Zn=null;break}if(T=g.sibling,T!==null){T.return=g.return,Zn=T;break}Zn=g.return}}function j5(h){for(;Zn!==null;){var g=Zn;if(g===h){Zn=null;break}var T=g.sibling;if(T!==null){T.return=g.return,Zn=T;break}Zn=g.return}}function H5(h){for(;Zn!==null;){var g=Zn;try{switch(g.tag){case 0:case 11:case 15:var T=g.return;try{C3(4,g)}catch(Ye){Us(g,T,Ye)}break;case 1:var D=g.stateNode;if(typeof D.componentDidMount=="function"){var W=g.return;try{D.componentDidMount()}catch(Ye){Us(g,W,Ye)}}var J=g.return;try{U5(g)}catch(Ye){Us(g,J,Ye)}break;case 5:var fe=g.return;try{U5(g)}catch(Ye){Us(g,fe,Ye)}}}catch(Ye){Us(g,g.return,Ye)}if(g===h){Zn=null;break}var Oe=g.sibling;if(Oe!==null){Oe.return=g.return,Zn=Oe;break}Zn=g.return}}var W5=Math.ceil,lg=A.ReactCurrentDispatcher,t1=A.ReactCurrentOwner,d0=A.ReactCurrentBatchConfig,Di=0,Fo=null,_o=null,ra=0,h0=0,Xd=ju(0),Gr=0,Yd=null,Kd=0,R3=0,q5=0,rf=null,Wa=null,$5=0,Ju=1/0,Jc=null,I3=!1,N3=null,mc=null,cg=!1,gc=null,k3=0,n1=0,r1=null,D3=-1,ug=0;function oo(){return(Di&6)!==0?me():D3!==-1?D3:D3=me()}function eu(h){return(h.mode&1)===0?1:(Di&2)!==0&&ra!==0?ra&-ra:eb.transition!==null?(ug===0&&(ug=ha()),ug):(h=Nr,h!==0||(h=window.event,h=h===void 0?16:ym(h.type)),h)}function z0(h,g,T,D){if(50<n1)throw n1=0,r1=null,Error(t(185));Do(h,T,D),((Di&2)===0||h!==Fo)&&(h===Fo&&((Di&2)===0&&(R3|=T),Gr===4&&ed(h,ra)),qa(h,D),T===1&&Di===0&&(g.mode&1)===0&&(Ju=me()+500,qu&&Gd()))}function qa(h,g){var T=h.callbackNode;Qo(h,g);var D=Os(h,h===Fo?ra:0);if(D===0)T!==null&&Cd(T),h.callbackNode=null,h.callbackPriority=0;else if(g=D&-D,h.callbackPriority!==g){if(T!=null&&Cd(T),g===1)h.tag===0?Jx(Y5.bind(null,h)):o5(Y5.bind(null,h)),I6(function(){(Di&6)===0&&Gd()}),T=null;else{switch(Oo(D)){case 1:T=At;break;case 4:T=St;break;case 16:T=_t;break;case 536870912:T=Bn;break;default:T=_t}T=ev(T,O3.bind(null,h))}h.callbackPriority=g,h.callbackNode=T}}function O3(h,g){if(D3=-1,ug=0,(Di&6)!==0)throw Error(t(327));var T=h.callbackNode;if(i1()&&h.callbackNode!==T)return null;var D=Os(h,h===Fo?ra:0);if(D===0)return null;if((D&30)!==0||(D&h.expiredLanes)!==0||g)g=pg(h,D);else{g=D;var W=Di;Di|=2;var J=fg();(Fo!==h||ra!==g)&&(Jc=null,Ju=me()+500,f0(h,g));do try{Z5();break}catch(Oe){sf(h,Oe)}while(!0);u5(),lg.current=J,Di=W,_o!==null?g=0:(Fo=null,ra=0,g=Gr)}if(g!==0){if(g===2&&(W=si(h),W!==0&&(D=W,g=dg(h,W))),g===1)throw T=Yd,f0(h,0),ed(h,D),qa(h,me()),T;if(g===6)ed(h,D);else{if(W=h.current.alternate,(D&30)===0&&!X5(W)&&(g=pg(h,D),g===2&&(J=si(h),J!==0&&(D=J,g=dg(h,J))),g===1))throw T=Yd,f0(h,0),ed(h,D),qa(h,me()),T;switch(h.finishedWork=W,h.finishedLanes=D,g){case 0:case 1:throw Error(t(345));case 2:vc(h,Wa,Jc);break;case 3:if(ed(h,D),(D&130023424)===D&&(g=$5+500-me(),10<g)){if(Os(h,0)!==0)break;if(W=h.suspendedLanes,(W&D)!==D){oo(),h.pingedLanes|=h.suspendedLanes&W;break}h.timeoutHandle=Y2(vc.bind(null,h,Wa,Jc),g);break}vc(h,Wa,Jc);break;case 4:if(ed(h,D),(D&4194240)===D)break;for(g=h.eventTimes,W=-1;0<D;){var fe=31-ur(D);J=1<<fe,fe=g[fe],fe>W&&(W=fe),D&=~J}if(D=W,D=me()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*W5(D/1960))-D,10<D){h.timeoutHandle=Y2(vc.bind(null,h,Wa,Jc),D);break}vc(h,Wa,Jc);break;case 5:vc(h,Wa,Jc);break;default:throw Error(t(329))}}}return qa(h,me()),h.callbackNode===T?O3.bind(null,h):null}function dg(h,g){var T=rf;return h.current.memoizedState.isDehydrated&&(f0(h,g).flags|=256),h=pg(h,g),h!==2&&(g=Wa,Wa=T,g!==null&&hg(g)),h}function hg(h){Wa===null?Wa=h:Wa.push.apply(Wa,h)}function X5(h){for(var g=h;;){if(g.flags&16384){var T=g.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var D=0;D<T.length;D++){var W=T[D],J=W.getSnapshot;W=W.value;try{if(!ma(J(),W))return!1}catch{return!1}}}if(T=g.child,g.subtreeFlags&16384&&T!==null)T.return=g,g=T;else{if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function ed(h,g){for(g&=~q5,g&=~R3,h.suspendedLanes|=g,h.pingedLanes&=~g,h=h.expirationTimes;0<g;){var T=31-ur(g),D=1<<T;h[T]=-1,g&=~D}}function Y5(h){if((Di&6)!==0)throw Error(t(327));i1();var g=Os(h,0);if((g&1)===0)return qa(h,me()),null;var T=pg(h,g);if(h.tag!==0&&T===2){var D=si(h);D!==0&&(g=D,T=dg(h,D))}if(T===1)throw T=Yd,f0(h,0),ed(h,g),qa(h,me()),T;if(T===6)throw Error(t(345));return h.finishedWork=h.current.alternate,h.finishedLanes=g,vc(h,Wa,Jc),qa(h,me()),null}function L3(h,g){var T=Di;Di|=1;try{return h(g)}finally{Di=T,Di===0&&(Ju=me()+500,qu&&Gd())}}function Zd(h){gc!==null&&gc.tag===0&&(Di&6)===0&&i1();var g=Di;Di|=1;var T=d0.transition,D=Nr;try{if(d0.transition=null,Nr=1,h)return h()}finally{Nr=D,d0.transition=T,Di=g,(Di&6)===0&&Gd()}}function F3(){h0=Xd.current,is(Xd)}function f0(h,g){h.finishedWork=null,h.finishedLanes=0;var T=h.timeoutHandle;if(T!==-1&&(h.timeoutHandle=-1,R6(T)),_o!==null)for(T=_o.return;T!==null;){var D=T;switch(Fm(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&Fp();break;case 3:jp(),is(Pa),is(ga),Hp();break;case 5:s3(D);break;case 4:jp();break;case 13:is(js);break;case 19:is(js);break;case 10:d5(D.type._context);break;case 22:case 23:F3()}T=T.return}if(Fo=h,_o=h=tu(h.current,null),ra=h0=g,Gr=0,Yd=null,q5=R3=Kd=0,Wa=rf=null,L0!==null){for(g=0;g<L0.length;g++)if(T=L0[g],D=T.interleaved,D!==null){T.interleaved=null;var W=D.next,J=T.pending;if(J!==null){var fe=J.next;J.next=W,D.next=fe}T.pending=D}L0=null}return h}function sf(h,g){do{var T=_o;try{if(u5(),$m.current=Kc,o3){for(var D=ss.memoizedState;D!==null;){var W=D.queue;W!==null&&(W.pending=null),D=D.next}o3=!1}if(Ku=0,ea=Fs=ss=null,Wp=!1,Xm=0,t1.current=null,T===null||T.return===null){Gr=1,Yd=g,_o=null;break}e:{var J=h,fe=T.return,Oe=T,Ye=g;if(g=ra,Oe.flags|=32768,Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var It=Ye,nn=Oe,dn=nn.tag;if((nn.mode&1)===0&&(dn===0||dn===11||dn===15)){var tn=nn.alternate;tn?(nn.updateQueue=tn.updateQueue,nn.memoizedState=tn.memoizedState,nn.lanes=tn.lanes):(nn.updateQueue=null,nn.memoizedState=null)}var Hn=E5(fe);if(Hn!==null){Hn.flags&=-257,rg(Hn,fe,Oe,J,g),Hn.mode&1&&q6(J,It,g),g=Hn,Ye=It;var Qn=g.updateQueue;if(Qn===null){var ir=new Set;ir.add(Ye),g.updateQueue=ir}else Qn.add(Ye);break e}else{if((g&1)===0){q6(J,It,g),K5();break e}Ye=Error(t(426))}}else if(As&&Oe.mode&1){var Ys=E5(fe);if(Ys!==null){(Ys.flags&65536)===0&&(Ys.flags|=256),rg(Ys,fe,Oe,J,g),J2(Qp(Ye,Oe));break e}}J=Ye=Qp(Ye,Oe),Gr!==4&&(Gr=2),rf===null?rf=[J]:rf.push(J),J=fe;do{switch(J.tag){case 3:J.flags|=65536,g&=-g,J.lanes|=g;var xt=T5(J,Ye,g);f5(J,xt);break e;case 1:Oe=Ye;var at=J.type,Ct=J.stateNode;if((J.flags&128)===0&&(typeof at.getDerivedStateFromError=="function"||Ct!==null&&typeof Ct.componentDidCatch=="function"&&(mc===null||!mc.has(Ct)))){J.flags|=65536,g&=-g,J.lanes|=g;var yn=ng(J,Oe,g);f5(J,yn);break e}}J=J.return}while(J!==null)}Q5(T)}catch(dr){g=dr,_o===T&&T!==null&&(_o=T=T.return);continue}break}while(!0)}function fg(){var h=lg.current;return lg.current=Kc,h===null?Kc:h}function K5(){(Gr===0||Gr===3||Gr===2)&&(Gr=4),Fo===null||(Kd&268435455)===0&&(R3&268435455)===0||ed(Fo,ra)}function pg(h,g){var T=Di;Di|=2;var D=fg();(Fo!==h||ra!==g)&&(Jc=null,f0(h,g));do try{ty();break}catch(W){sf(h,W)}while(!0);if(u5(),Di=T,lg.current=D,_o!==null)throw Error(t(261));return Fo=null,ra=0,Gr}function ty(){for(;_o!==null;)U3(_o)}function Z5(){for(;_o!==null&&!hp();)U3(_o)}function U3(h){var g=s1(h.alternate,h,h0);h.memoizedProps=h.pendingProps,g===null?Q5(h):_o=g,t1.current=null}function Q5(h){var g=h;do{var T=g.alternate;if(h=g.return,(g.flags&32768)===0){if(T=K6(T,g,h0),T!==null){_o=T;return}}else{if(T=ib(T,g),T!==null){T.flags&=32767,_o=T;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{Gr=6,_o=null;return}}if(g=g.sibling,g!==null){_o=g;return}_o=g=h}while(g!==null);Gr===0&&(Gr=5)}function vc(h,g,T){var D=Nr,W=d0.transition;try{d0.transition=null,Nr=1,ny(h,g,T,D)}finally{d0.transition=W,Nr=D}return null}function ny(h,g,T,D){do i1();while(gc!==null);if((Di&6)!==0)throw Error(t(327));T=h.finishedWork;var W=h.finishedLanes;if(T===null)return null;if(h.finishedWork=null,h.finishedLanes=0,T===h.current)throw Error(t(177));h.callbackNode=null,h.callbackPriority=0;var J=T.lanes|T.childLanes;if(Bc(h,J),h===Fo&&(_o=Fo=null,ra=0),(T.subtreeFlags&2064)===0&&(T.flags&2064)===0||cg||(cg=!0,ev(_t,function(){return i1(),null})),J=(T.flags&15990)!==0,(T.subtreeFlags&15990)!==0||J){J=d0.transition,d0.transition=null;var fe=Nr;Nr=1;var Oe=Di;Di|=4,t1.current=null,Q6(h,T),A3(T,h),E6($2),gp=!!q2,$2=q2=null,h.current=T,sb(T),fp(),Di=Oe,Nr=fe,d0.transition=J}else h.current=T;if(cg&&(cg=!1,gc=h,k3=W),J=h.pendingLanes,J===0&&(mc=null),Kn(T.stateNode),qa(h,me()),g!==null)for(D=h.onRecoverableError,T=0;T<g.length;T++)W=g[T],D(W.value,{componentStack:W.stack,digest:W.digest});if(I3)throw I3=!1,h=N3,N3=null,h;return(k3&1)!==0&&h.tag!==0&&i1(),J=h.pendingLanes,(J&1)!==0?h===r1?n1++:(n1=0,r1=h):n1=0,Gd(),null}function i1(){if(gc!==null){var h=Oo(k3),g=d0.transition,T=Nr;try{if(d0.transition=null,Nr=16>h?16:h,gc===null)var D=!1;else{if(h=gc,gc=null,k3=0,(Di&6)!==0)throw Error(t(331));var W=Di;for(Di|=4,Zn=h.current;Zn!==null;){var J=Zn,fe=J.child;if((Zn.flags&16)!==0){var Oe=J.deletions;if(Oe!==null){for(var Ye=0;Ye<Oe.length;Ye++){var It=Oe[Ye];for(Zn=It;Zn!==null;){var nn=Zn;switch(nn.tag){case 0:case 11:case 15:e1(8,nn,J)}var dn=nn.child;if(dn!==null)dn.return=nn,Zn=dn;else for(;Zn!==null;){nn=Zn;var tn=nn.sibling,Hn=nn.return;if(B5(nn),nn===It){Zn=null;break}if(tn!==null){tn.return=Hn,Zn=tn;break}Zn=Hn}}}var Qn=J.alternate;if(Qn!==null){var ir=Qn.child;if(ir!==null){Qn.child=null;do{var Ys=ir.sibling;ir.sibling=null,ir=Ys}while(ir!==null)}}Zn=J}}if((J.subtreeFlags&2064)!==0&&fe!==null)fe.return=J,Zn=fe;else e:for(;Zn!==null;){if(J=Zn,(J.flags&2048)!==0)switch(J.tag){case 0:case 11:case 15:e1(9,J,J.return)}var xt=J.sibling;if(xt!==null){xt.return=J.return,Zn=xt;break e}Zn=J.return}}var at=h.current;for(Zn=at;Zn!==null;){fe=Zn;var Ct=fe.child;if((fe.subtreeFlags&2064)!==0&&Ct!==null)Ct.return=fe,Zn=Ct;else e:for(fe=at;Zn!==null;){if(Oe=Zn,(Oe.flags&2048)!==0)try{switch(Oe.tag){case 0:case 11:case 15:C3(9,Oe)}}catch(dr){Us(Oe,Oe.return,dr)}if(Oe===fe){Zn=null;break e}var yn=Oe.sibling;if(yn!==null){yn.return=Oe.return,Zn=yn;break e}Zn=Oe.return}}if(Di=W,Gd(),On&&typeof On.onPostCommitFiberRoot=="function")try{On.onPostCommitFiberRoot(Mn,h)}catch{}D=!0}return D}finally{Nr=T,d0.transition=g}}return!1}function mg(h,g,T){g=Qp(T,g),g=T5(h,g,1),h=dc(h,g,1),g=oo(),h!==null&&(Do(h,1,g),qa(h,g))}function Us(h,g,T){if(h.tag===3)mg(h,h,T);else for(;g!==null;){if(g.tag===3){mg(g,h,T);break}else if(g.tag===1){var D=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(mc===null||!mc.has(D))){h=Qp(T,h),h=ng(g,h,1),g=dc(g,h,1),h=oo(),g!==null&&(Do(g,1,h),qa(g,h));break}}g=g.return}}function ob(h,g,T){var D=h.pingCache;D!==null&&D.delete(g),g=oo(),h.pingedLanes|=h.suspendedLanes&T,Fo===h&&(ra&T)===T&&(Gr===4||Gr===3&&(ra&130023424)===ra&&500>me()-$5?f0(h,0):q5|=T),qa(h,g)}function J5(h,g){g===0&&((h.mode&1)===0?g=1:(g=Ki,Ki<<=1,(Ki&130023424)===0&&(Ki=4194304)));var T=oo();h=Xu(h,g),h!==null&&(Do(h,g,T),qa(h,T))}function ry(h){var g=h.memoizedState,T=0;g!==null&&(T=g.retryLane),J5(h,T)}function iy(h,g){var T=0;switch(h.tag){case 13:var D=h.stateNode,W=h.memoizedState;W!==null&&(T=W.retryLane);break;case 19:D=h.stateNode;break;default:throw Error(t(314))}D!==null&&D.delete(g),J5(h,T)}var s1;s1=function(h,g,T){if(h!==null)if(h.memoizedProps!==g.pendingProps||Pa.current)u0=!0;else{if((h.lanes&T)===0&&(g.flags&128)===0)return u0=!1,rb(h,g,T);u0=(h.flags&131072)!==0}else u0=!1,As&&(g.flags&1048576)!==0&&D6(g,Xh,g.index);switch(g.lanes=0,g.tag){case 2:var D=g.type;ig(h,g),h=g.pendingProps;var W=Vd(g,ga.current);$u(g,T),W=a3(null,g,D,h,W,T);var J=Ym();return g.flags|=1,typeof W=="object"&&W!==null&&typeof W.render=="function"&&W.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,a0(D)?(J=!0,Lm(g)):J=!1,g.memoizedState=W.state!==null&&W.state!==void 0?W.state:null,n3(g),W.updater=Zc,g.stateNode=W,W._reactInternals=g,eg(g,D,h,T),g=I5(null,g,D,!0,J,T)):(g.tag=0,As&&J&&Kh(g),va(null,g,W,T),g=g.child),g;case 16:D=g.elementType;e:{switch(ig(h,g),h=g.pendingProps,W=D._init,D=W(D._payload),g.type=D,W=g.tag=B3(D),h=U0(D,h),W){case 0:g=Jp(null,g,D,h,T);break e;case 1:g=R5(null,g,D,h,T);break e;case 11:g=x3(null,g,D,h,T);break e;case 14:g=C5(null,g,D,U0(D.type,h),T);break e}throw Error(t(306,D,""))}return g;case 0:return D=g.type,W=g.pendingProps,W=g.elementType===D?W:U0(D,W),Jp(h,g,D,W,T);case 1:return D=g.type,W=g.pendingProps,W=g.elementType===D?W:U0(D,W),R5(h,g,D,W,T);case 3:e:{if(N5(g),h===null)throw Error(t(387));D=g.pendingProps,J=g.memoizedState,W=J.element,F6(h,g),Hm(g,D,null,T);var fe=g.memoizedState;if(D=fe.element,J.isDehydrated)if(J={element:D,isDehydrated:!1,cache:fe.cache,pendingSuspenseBoundaries:fe.pendingSuspenseBoundaries,transitions:fe.transitions},g.updateQueue.baseState=J,g.memoizedState=J,g.flags&256){W=Qp(Error(t(423)),g),g=k5(h,g,D,T,W);break e}else if(D!==W){W=Qp(Error(t(424)),g),g=k5(h,g,D,T,W);break e}else for(l0=zu(g.stateNode.containerInfo.firstChild),O0=g,As=!0,c0=null,T=c5(g,null,D,T),g.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(Bp(),D===W){g=Qu(h,g,T);break e}va(h,g,D,T)}g=g.child}return g;case 5:return U6(g),h===null&&Up(g),D=g.type,W=g.pendingProps,J=h!==null?h.memoizedProps:null,fe=W.children,X2(D,W)?fe=null:J!==null&&X2(D,J)&&(g.flags|=32),P5(h,g),va(h,g,fe,T),g.child;case 6:return h===null&&Up(g),null;case 13:return $6(h,g,T);case 4:return i3(g,g.stateNode.containerInfo),D=g.pendingProps,h===null?g.child=Zh(g,null,D,T):va(h,g,D,T),g.child;case 11:return D=g.type,W=g.pendingProps,W=g.elementType===D?W:U0(D,W),x3(h,g,D,W,T);case 7:return va(h,g,g.pendingProps,T),g.child;case 8:return va(h,g,g.pendingProps.children,T),g.child;case 12:return va(h,g,g.pendingProps.children,T),g.child;case 10:e:{if(D=g.type._context,W=g.pendingProps,J=g.memoizedProps,fe=W.value,ps(e3,D._currentValue),D._currentValue=fe,J!==null)if(ma(J.value,fe)){if(J.children===W.children&&!Pa.current){g=Qu(h,g,T);break e}}else for(J=g.child,J!==null&&(J.return=g);J!==null;){var Oe=J.dependencies;if(Oe!==null){fe=J.child;for(var Ye=Oe.firstContext;Ye!==null;){if(Ye.context===D){if(J.tag===1){Ye=F0(-1,T&-T),Ye.tag=2;var It=J.updateQueue;if(It!==null){It=It.shared;var nn=It.pending;nn===null?Ye.next=Ye:(Ye.next=nn.next,nn.next=Ye),It.pending=Ye}}J.lanes|=T,Ye=J.alternate,Ye!==null&&(Ye.lanes|=T),zp(J.return,T,g),Oe.lanes|=T;break}Ye=Ye.next}}else if(J.tag===10)fe=J.type===g.type?null:J.child;else if(J.tag===18){if(fe=J.return,fe===null)throw Error(t(341));fe.lanes|=T,Oe=fe.alternate,Oe!==null&&(Oe.lanes|=T),zp(fe,T,g),fe=J.sibling}else fe=J.child;if(fe!==null)fe.return=J;else for(fe=J;fe!==null;){if(fe===g){fe=null;break}if(J=fe.sibling,J!==null){J.return=fe.return,fe=J;break}fe=fe.return}J=fe}va(h,g,W.children,T),g=g.child}return g;case 9:return W=g.type,D=g.pendingProps.children,$u(g,T),W=_l(W),D=D(W),g.flags|=1,va(h,g,D,T),g.child;case 14:return D=g.type,W=U0(D,g.pendingProps),W=U0(D.type,W),C5(h,g,D,W,T);case 15:return b3(h,g,g.type,g.pendingProps,T);case 17:return D=g.type,W=g.pendingProps,W=g.elementType===D?W:U0(D,W),ig(h,g),g.tag=1,a0(D)?(h=!0,Lm(g)):h=!1,$u(g,T),Zp(g,D,W),eg(g,D,W,T),I5(null,g,D,!0,h,T);case 19:return X6(h,g,T);case 22:return A5(h,g,T)}throw Error(t(156,g.tag))};function ev(h,g){return dp(h,g)}function sy(h,g,T,D){this.tag=h,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sl(h,g,T,D){return new sy(h,g,T,D)}function gg(h){return h=h.prototype,!(!h||!h.isReactComponent)}function B3(h){if(typeof h=="function")return gg(h)?1:0;if(h!=null){if(h=h.$$typeof,h===De)return 11;if(h===He)return 14}return 2}function tu(h,g){var T=h.alternate;return T===null?(T=Sl(h.tag,g,h.key,h.mode),T.elementType=h.elementType,T.type=h.type,T.stateNode=h.stateNode,T.alternate=h,h.alternate=T):(T.pendingProps=g,T.type=h.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=h.flags&14680064,T.childLanes=h.childLanes,T.lanes=h.lanes,T.child=h.child,T.memoizedProps=h.memoizedProps,T.memoizedState=h.memoizedState,T.updateQueue=h.updateQueue,g=h.dependencies,T.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},T.sibling=h.sibling,T.index=h.index,T.ref=h.ref,T}function z3(h,g,T,D,W,J){var fe=2;if(D=h,typeof h=="function")gg(h)&&(fe=1);else if(typeof h=="string")fe=5;else e:switch(h){case oe:return of(T.children,W,J,g);case G:fe=8,W|=8;break;case ie:return h=Sl(12,T,g,W|2),h.elementType=ie,h.lanes=J,h;case $e:return h=Sl(13,T,g,W),h.elementType=$e,h.lanes=J,h;case ot:return h=Sl(19,T,g,W),h.elementType=ot,h.lanes=J,h;case Ge:return vg(T,W,J,g);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case Me:fe=10;break e;case X:fe=9;break e;case De:fe=11;break e;case He:fe=14;break e;case ce:fe=16,D=null;break e}throw Error(t(130,h==null?h:typeof h,""))}return g=Sl(fe,T,g,W),g.elementType=h,g.type=D,g.lanes=J,g}function of(h,g,T,D){return h=Sl(7,h,D,g),h.lanes=T,h}function vg(h,g,T,D){return h=Sl(22,h,D,g),h.elementType=Ge,h.lanes=T,h.stateNode={isHidden:!1},h}function tv(h,g,T){return h=Sl(6,h,null,g),h.lanes=T,h}function nv(h,g,T){return g=Sl(4,h.children!==null?h.children:[],h.key,g),g.lanes=T,g.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},g}function rv(h,g,T,D,W){this.tag=g,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xs(0),this.expirationTimes=Xs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xs(0),this.identifierPrefix=D,this.onRecoverableError=W,this.mutableSourceEagerHydrationData=null}function V3(h,g,T,D,W,J,fe,Oe,Ye){return h=new rv(h,g,T,Oe,Ye),g===1?(g=1,J===!0&&(g|=8)):g=0,J=Sl(3,null,null,g),h.current=J,J.stateNode=h,J.memoizedState={element:D,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},n3(J),h}function oy(h,g,T){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:D==null?null:""+D,children:h,containerInfo:g,implementation:T}}function iv(h){if(!h)return zd;h=h._reactInternals;e:{if(ko(h)!==h||h.tag!==1)throw Error(t(170));var g=h;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(a0(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(t(171))}if(h.tag===1){var T=h.type;if(a0(T))return s5(h,T,g)}return g}function G3(h,g,T,D,W,J,fe,Oe,Ye){return h=V3(T,D,!0,h,W,J,fe,Oe,Ye),h.context=iv(null),T=h.current,D=oo(),W=eu(T),J=F0(D,W),J.callback=g??null,dc(T,J,W),h.current.lanes=W,Do(h,W,D),qa(h,D),h}function yg(h,g,T,D){var W=g.current,J=oo(),fe=eu(W);return T=iv(T),g.context===null?g.context=T:g.pendingContext=T,g=F0(J,fe),g.payload={element:h},D=D===void 0?null:D,D!==null&&(g.callback=D),h=dc(W,g,fe),h!==null&&(z0(h,W,fe,J),r3(h,W,fe)),fe}function _g(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return h.child.stateNode;default:return h.child.stateNode}}function sv(h,g){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var T=h.retryLane;h.retryLane=T!==0&&T<g?T:g}}function j3(h,g){sv(h,g),(h=h.alternate)&&sv(h,g)}function ay(){return null}var ov=typeof reportError=="function"?reportError:function(h){console.error(h)};function H3(h){this._internalRoot=h}xg.prototype.render=H3.prototype.render=function(h){var g=this._internalRoot;if(g===null)throw Error(t(409));yg(h,g,null,null)},xg.prototype.unmount=H3.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var g=h.containerInfo;Zd(function(){yg(null,h,null,null)}),g[o0]=null}};function xg(h){this._internalRoot=h}xg.prototype.unstable_scheduleHydration=function(h){if(h){var g=Ad();h={blockedOn:null,target:h,priority:g};for(var T=0;T<ec.length&&g!==0&&g<ec[T].priority;T++);ec.splice(T,0,h),T===0&&zc(h)}};function W3(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function bg(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11&&(h.nodeType!==8||h.nodeValue!==" react-mount-point-unstable "))}function av(){}function ly(h,g,T,D,W){if(W){if(typeof D=="function"){var J=D;D=function(){var It=_g(fe);J.call(It)}}var fe=G3(g,D,h,0,null,!1,!1,"",av);return h._reactRootContainer=fe,h[o0]=fe.current,Op(h.nodeType===8?h.parentNode:h),Zd(),fe}for(;W=h.lastChild;)h.removeChild(W);if(typeof D=="function"){var Oe=D;D=function(){var It=_g(Ye);Oe.call(It)}}var Ye=V3(h,0,!1,null,null,!1,!1,"",av);return h._reactRootContainer=Ye,h[o0]=Ye.current,Op(h.nodeType===8?h.parentNode:h),Zd(function(){yg(g,Ye,T,D)}),Ye}function Sg(h,g,T,D,W){var J=T._reactRootContainer;if(J){var fe=J;if(typeof W=="function"){var Oe=W;W=function(){var Ye=_g(fe);Oe.call(Ye)}}yg(g,fe,h,W)}else fe=ly(T,g,h,W,D);return _g(fe)}xs=function(h){switch(h.tag){case 3:var g=h.stateNode;if(g.current.memoizedState.isDehydrated){var T=ii(g.pendingLanes);T!==0&&(xi(g,T|1),qa(g,me()),(Di&6)===0&&(Ju=me()+500,Gd()))}break;case 13:Zd(function(){var D=Xu(h,1);if(D!==null){var W=oo();z0(D,h,1,W)}}),j3(h,1)}},i0=function(h){if(h.tag===13){var g=Xu(h,134217728);if(g!==null){var T=oo();z0(g,h,134217728,T)}j3(h,134217728)}},Aa=function(h){if(h.tag===13){var g=eu(h),T=Xu(h,g);if(T!==null){var D=oo();z0(T,h,g,D)}j3(h,g)}},Ad=function(){return Nr},Ql=function(h,g){var T=Nr;try{return Nr=h,g()}finally{Nr=T}},gn=function(h,g,T){switch(g){case"input":if(ai(h,T),g=T.name,T.type==="radio"&&g!=null){for(T=h;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<T.length;g++){var D=T[g];if(D!==h&&D.form===h.form){var W=jc(D);if(!W)throw Error(t(90));ds(D),ai(D,W)}}}break;case"textarea":de(h,T);break;case"select":g=T.value,g!=null&&gi(h,!!T.multiple,g,!1)}},Ir=L3,zi=Zd;var lv={usingClientEntryPoint:!1,Events:[Bd,Vu,jc,zt,Gn,L3]},o1={findFiberByHostInstance:gl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ab={bundleType:o1.bundleType,version:o1.version,rendererPackageName:o1.rendererPackageName,rendererConfig:o1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(h){return h=Zo(h),h===null?null:h.stateNode},findFiberByHostInstance:o1.findFiberByHostInstance||ay,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q3=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q3.isDisabled&&q3.supportsFiber)try{Mn=q3.inject(ab),On=q3}catch{}}return yu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lv,yu.createPortal=function(h,g){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W3(g))throw Error(t(200));return oy(h,g,null,T)},yu.createRoot=function(h,g){if(!W3(h))throw Error(t(299));var T=!1,D="",W=ov;return g!=null&&(g.unstable_strictMode===!0&&(T=!0),g.identifierPrefix!==void 0&&(D=g.identifierPrefix),g.onRecoverableError!==void 0&&(W=g.onRecoverableError)),g=V3(h,1,!1,null,null,T,!1,D,W),h[o0]=g.current,Op(h.nodeType===8?h.parentNode:h),new H3(g)},yu.findDOMNode=function(h){if(h==null)return null;if(h.nodeType===1)return h;var g=h._reactInternals;if(g===void 0)throw typeof h.render=="function"?Error(t(188)):(h=Object.keys(h).join(","),Error(t(268,h)));return h=Zo(g),h=h===null?null:h.stateNode,h},yu.flushSync=function(h){return Zd(h)},yu.hydrate=function(h,g,T){if(!bg(g))throw Error(t(200));return Sg(null,h,g,!0,T)},yu.hydrateRoot=function(h,g,T){if(!W3(h))throw Error(t(405));var D=T!=null&&T.hydratedSources||null,W=!1,J="",fe=ov;if(T!=null&&(T.unstable_strictMode===!0&&(W=!0),T.identifierPrefix!==void 0&&(J=T.identifierPrefix),T.onRecoverableError!==void 0&&(fe=T.onRecoverableError)),g=G3(g,null,h,1,T??null,W,!1,J,fe),h[o0]=g.current,Op(h),D)for(h=0;h<D.length;h++)T=D[h],W=T._getVersion,W=W(T._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[T,W]:g.mutableSourceEagerHydrationData.push(T,W);return new xg(g)},yu.render=function(h,g,T){if(!bg(g))throw Error(t(200));return Sg(null,h,g,!1,T)},yu.unmountComponentAtNode=function(h){if(!bg(h))throw Error(t(40));return h._reactRootContainer?(Zd(function(){Sg(null,null,h,!1,function(){h._reactRootContainer=null,h[o0]=null})}),!0):!1},yu.unstable_batchedUpdates=L3,yu.unstable_renderSubtreeIntoContainer=function(h,g,T,D){if(!bg(T))throw Error(t(200));if(h==null||h._reactInternals===void 0)throw Error(t(38));return Sg(h,g,T,!1,D)},yu.version="18.3.1-next-f1338f8080-20240426",yu}var Y3e;function ZIe(){if(Y3e)return SG.exports;Y3e=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),SG.exports=KIe(),SG.exports}var K3e;function QIe(){if(K3e)return SI;K3e=1;var i=ZIe();return SI.createRoot=i.createRoot,SI.hydrateRoot=i.hydrateRoot,SI}var JIe=QIe();const eNe=Ave(JIe);var PT={exports:{}},EG={},Z3e;function an(){return Z3e||(Z3e=1,function(i){var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,c=(le,Te,Je)=>Te in le?e(le,Te,{enumerable:!0,configurable:!0,writable:!0,value:Je}):le[Te]=Je,d=(le,Te)=>{for(var Je in Te||(Te={}))s.call(Te,Je)&&c(le,Je,Te[Je]);if(r)for(var Je of r(Te))a.call(Te,Je)&&c(le,Je,Te[Je]);return le},p=(le,Te)=>t(le,n(Te)),y=le=>e(le,"__esModule",{value:!0}),x=(le,Te)=>{y(le);for(var Je in Te)e(le,Je,{get:Te[Je],enumerable:!0})};x(i,{Atom:()=>Vh,PointerProxy:()=>V2,Ticker:()=>ac,getPointerParts:()=>hl,isPointer:()=>ic,isPrism:()=>Vc,iterateAndCountTicks:()=>Bu,iterateOver:()=>Ap,pointer:()=>Fh,pointerToPrism:()=>Od,prism:()=>oc,val:()=>ml});var w=Array.isArray,C=w,N=typeof tl=="object"&&tl&&tl.Object===Object&&tl,F=N,U=typeof self=="object"&&self&&self.Object===Object&&self,R=F||U||Function("return this")(),B=R,Y=B.Symbol,A=Y,ne=Object.prototype,se=ne.hasOwnProperty,oe=ne.toString,G=A?A.toStringTag:void 0;function ie(le){var Te=se.call(le,G),Je=le[G];try{le[G]=void 0;var Lt=!0}catch{}var Cr=oe.call(le);return Lt&&(Te?le[G]=Je:delete le[G]),Cr}var Me=ie,X=Object.prototype,De=X.toString;function $e(le){return De.call(le)}var ot=$e,He="[object Null]",ce="[object Undefined]",Ge=A?A.toStringTag:void 0;function Ie(le){return le==null?le===void 0?ce:He:Ge&&Ge in Object(le)?Me(le):ot(le)}var st=Ie;function bt(le){return le!=null&&typeof le=="object"}var Ne=bt,ht="[object Symbol]";function Ot(le){return typeof le=="symbol"||Ne(le)&&st(le)==ht}var wn=Ot,bn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tt=/^\w*$/;function Gt(le,Te){if(C(le))return!1;var Je=typeof le;return Je=="number"||Je=="symbol"||Je=="boolean"||le==null||wn(le)?!0:Tt.test(le)||!bn.test(le)||Te!=null&&le in Object(Te)}var $t=Gt;function Ln(le){var Te=typeof le;return le!=null&&(Te=="object"||Te=="function")}var jn=Ln,fr="[object AsyncFunction]",ds="[object Function]",Wr="[object GeneratorFunction]",Br="[object Proxy]";function Kr(le){if(!jn(le))return!1;var Te=st(le);return Te==ds||Te==Wr||Te==fr||Te==Br}var Vr=Kr,ai=B["__core-js_shared__"],qe=ai,hs=function(){var le=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return le?"Symbol(src)_1."+le:""}();function ni(le){return!!hs&&hs in le}var gi=ni,Fn=Function.prototype,Pe=Fn.toString;function de(le){if(le!=null){try{return Pe.call(le)}catch{}try{return le+""}catch{}}return""}var dt=de,qt=/[\\^$.*+?()[\]{}|]/g,Xt=/^\[object .+?Constructor\]$/,Bt=Function.prototype,$n=Object.prototype,_n=Bt.toString,tr=$n.hasOwnProperty,Mr=RegExp("^"+_n.call(tr).replace(qt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qt(le){if(!jn(le)||gi(le))return!1;var Te=Vr(le)?Mr:Xt;return Te.test(dt(le))}var pn=Qt;function Un(le,Te){return le==null?void 0:le[Te]}var Vn=Un;function Dn(le,Te){var Je=Vn(le,Te);return pn(Je)?Je:void 0}var br=Dn,Qe=br(Object,"create"),gn=Qe;function un(){this.__data__=gn?gn(null):{},this.size=0}var Cn=un;function on(le){var Te=this.has(le)&&delete this.__data__[le];return this.size-=Te?1:0,Te}var zt=on,Gn="__lodash_hash_undefined__",Ir=Object.prototype,zi=Ir.hasOwnProperty;function Tr(le){var Te=this.__data__;if(gn){var Je=Te[le];return Je===Gn?void 0:Je}return zi.call(Te,le)?Te[le]:void 0}var Ms=Tr,Ko=Object.prototype,Iu=Ko.hasOwnProperty;function I0(le){var Te=this.__data__;return gn?Te[le]!==void 0:Iu.call(Te,le)}var Dh=I0,Kl="__lodash_hash_undefined__";function Nu(le,Te){var Je=this.__data__;return this.size+=this.has(le)?0:1,Je[le]=gn&&Te===void 0?Kl:Te,this}var r0=Nu;function Ga(le){var Te=-1,Je=le==null?0:le.length;for(this.clear();++Te<Je;){var Lt=le[Te];this.set(Lt[0],Lt[1])}}Ga.prototype.clear=Cn,Ga.prototype.delete=zt,Ga.prototype.get=Ms,Ga.prototype.has=Dh,Ga.prototype.set=r0;var Ed=Ga;function up(){this.__data__=[],this.size=0}var Md=up;function ko(le,Te){return le===Te||le!==le&&Te!==Te}var Uc=ko;function Zl(le,Te){for(var Je=le.length;Je--;)if(Uc(le[Je][0],Te))return Je;return-1}var ku=Zl,Zo=Array.prototype,ja=Zo.splice;function dp(le){var Te=this.__data__,Je=ku(Te,le);if(Je<0)return!1;var Lt=Te.length-1;return Je==Lt?Te.pop():ja.call(Te,Je,1),--this.size,!0}var Cd=dp;function hp(le){var Te=this.__data__,Je=ku(Te,le);return Je<0?void 0:Te[Je][1]}var fp=hp;function me(le){return ku(this.__data__,le)>-1}var pt=me;function At(le,Te){var Je=this.__data__,Lt=ku(Je,le);return Lt<0?(++this.size,Je.push([le,Te])):Je[Lt][1]=Te,this}var St=At;function _t(le){var Te=-1,Je=le==null?0:le.length;for(this.clear();++Te<Je;){var Lt=le[Te];this.set(Lt[0],Lt[1])}}_t.prototype.clear=Md,_t.prototype.delete=Cd,_t.prototype.get=fp,_t.prototype.has=pt,_t.prototype.set=St;var Rn=_t,Bn=br(B,"Map"),Mn=Bn;function On(){this.size=0,this.__data__={hash:new Ed,map:new(Mn||Rn),string:new Ed}}var Kn=On;function ur(le){var Te=typeof le;return Te=="string"||Te=="number"||Te=="symbol"||Te=="boolean"?le!=="__proto__":le===null}var zr=ur;function pr(le,Te){var Je=le.__data__;return zr(Te)?Je[typeof Te=="string"?"string":"hash"]:Je.map}var li=pr;function Ni(le){var Te=li(this,le).delete(le);return this.size-=Te?1:0,Te}var Ki=Ni;function ii(le){return li(this,le).get(le)}var Os=ii;function nr(le){return li(this,le).has(le)}var Qo=nr;function si(le,Te){var Je=li(this,le),Lt=Je.size;return Je.set(le,Te),this.size+=Je.size==Lt?0:1,this}var ha=si;function Xs(le){var Te=-1,Je=le==null?0:le.length;for(this.clear();++Te<Je;){var Lt=le[Te];this.set(Lt[0],Lt[1])}}Xs.prototype.clear=Kn,Xs.prototype.delete=Ki,Xs.prototype.get=Os,Xs.prototype.has=Qo,Xs.prototype.set=ha;var Do=Xs,Bc="Expected a function";function xi(le,Te){if(typeof le!="function"||Te!=null&&typeof Te!="function")throw new TypeError(Bc);var Je=function(){var Lt=arguments,Cr=Te?Te.apply(this,Lt):Lt[0],ki=Je.cache;if(ki.has(Cr))return ki.get(Cr);var pa=le.apply(this,Lt);return Je.cache=ki.set(Cr,pa)||ki,pa};return Je.cache=new(xi.Cache||Do),Je}xi.Cache=Do;var Nr=xi,Oo=500;function xs(le){var Te=Nr(le,function(Lt){return Je.size===Oo&&Je.clear(),Lt}),Je=Te.cache;return Te}var i0=xs,Aa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ad=/\\(\\)?/g,Ql=i0(function(le){var Te=[];return le.charCodeAt(0)===46&&Te.push(""),le.replace(Aa,function(Je,Lt,Cr,ki){Te.push(Cr?ki.replace(Ad,"$1"):Lt||Je)}),Te}),pp=Ql;function mp(le,Te){for(var Je=-1,Lt=le==null?0:le.length,Cr=Array(Lt);++Je<Lt;)Cr[Je]=Te(le[Je],Je,le);return Cr}var Jl=mp,Ha=A?A.prototype:void 0,ul=Ha?Ha.toString:void 0;function Du(le){if(typeof le=="string")return le;if(C(le))return Jl(le,Du)+"";if(wn(le))return ul?ul.call(le):"";var Te=le+"";return Te=="0"&&1/le==-1/0?"-0":Te}var Pd=Du;function ec(le){return le==null?"":Pd(le)}var P2=ec;function gm(le,Te){return C(le)?le:$t(le,Te)?[le]:pp(P2(le))}var Oh=gm;function B4(le){if(typeof le=="string"||wn(le))return le;var Te=le+"";return Te=="0"&&1/le==-1/0?"-0":Te}var zc=B4;function Ou(le,Te){Te=Oh(Te,le);for(var Je=0,Lt=Te.length;le!=null&&Je<Lt;)le=le[zc(Te[Je++])];return Je&&Je==Lt?le:void 0}var R2=Ou;function dl(le,Te,Je){var Lt=le==null?void 0:R2(le,Te);return Lt===void 0?Je:Lt}var N0=dl;function Rd(le,Te){return function(Je){return le(Te(Je))}}var tc=Rd,gp=tc(Object.getPrototypeOf,Object),vm=gp,I2="[object Object]",vp=Function.prototype,yp=Object.prototype,_p=vp.toString,ym=yp.hasOwnProperty,nc=_p.call(Object);function xp(le){if(!Ne(le)||st(le)!=I2)return!1;var Te=vm(le);if(Te===null)return!0;var Je=ym.call(Te,"constructor")&&Te.constructor;return typeof Je=="function"&&Je instanceof Je&&_p.call(Je)==nc}var Id=xp;function _m(le){var Te=le==null?0:le.length;return Te?le[Te-1]:void 0}var bp=_m,rc=new WeakMap,Sp=new WeakMap,Lo=Symbol("pointerMeta"),Lu={get(le,Te){if(Te===Lo)return rc.get(le);let Je=Sp.get(le);Je||(Je=new Map,Sp.set(le,Je));const Lt=Je.get(Te);if(Lt!==void 0)return Lt;const Cr=rc.get(le),ki=Lh({root:Cr.root,path:[...Cr.path,Te]});return Je.set(Te,ki),ki}},s0=le=>le[Lo],hl=le=>{const{root:Te,path:Je}=s0(le);return{root:Te,path:Je}};function Lh(le){var Te;const Je={root:le.root,path:(Te=le.path)!=null?Te:[]},Lt={};return rc.set(Lt,Je),new Proxy(Lt,Lu)}var Fh=Lh,ic=le=>le&&!!s0(le);function Fu(le,Te,Je){return Te.length===0?Je(le):sc(le,Te,Je)}var sc=(le,Te,Je)=>{if(Te.length===0)return Je(le);if(Array.isArray(le)){let[Lt,...Cr]=Te;Lt=parseInt(String(Lt),10),isNaN(Lt)&&(Lt=0);const ki=le[Lt],pa=sc(ki,Cr,Je);if(ki===pa)return le;const k0=[...le];return k0.splice(Lt,1,pa),k0}else if(typeof le=="object"&&le!==null){const[Lt,...Cr]=Te,ki=le[Lt],pa=sc(ki,Cr,Je);return ki===pa?le:p(d({},le),{[Lt]:pa})}else{const[Lt,...Cr]=Te;return{[Lt]:sc(void 0,Cr,Je)}}},io=class{constructor(){this._head=void 0}peek(){return this._head&&this._head.data}pop(){const le=this._head;if(le)return this._head=le.next,le.data}push(le){const Te={next:this._head,data:le};this._head=Te}};function Vc(le){return!!(le&&le.isPrism&&le.isPrism===!0)}function wp(){const le=()=>{},Te=new io,Je=le;return{type:"Dataverse_discoveryMechanism",startIgnoringDependencies:()=>{Te.push(Je)},stopIgnoringDependencies:()=>{Te.peek()!==Je||Te.pop()},reportResolutionStart:Gc=>{const ma=Te.peek();ma&&ma(Gc),Te.push(Je)},reportResolutionEnd:Gc=>{Te.pop()},pushCollector:Gc=>{Te.push(Gc)},popCollector:Gc=>{if(Te.peek()!==Gc)throw new Error("Popped collector is not on top of the stack");Te.pop()}}}function N2(){const le="__dataverse_discoveryMechanism_sharedStack",Te=typeof window<"u"?window:typeof tl<"u"?tl:{};if(Te){const Je=Te[le];if(Je&&typeof Je=="object"&&Je.type==="Dataverse_discoveryMechanism")return Je;{const Lt=wp();return Te[le]=Lt,Lt}}else return wp()}var{startIgnoringDependencies:fl,stopIgnoringDependencies:Uh,reportResolutionEnd:k2,reportResolutionStart:D2,pushCollector:xm,popCollector:z4}=N2(),Tp=()=>{},V4=class{constructor(le,Te){this._fn=le,this._prismInstance=Te,this._didMarkDependentsAsStale=!1,this._isFresh=!1,this._cacheOfDendencyValues=new Map,this._dependents=new Set,this._dependencies=new Set,this._possiblyStaleDeps=new Set,this._scope=new Mp(this),this._lastValue=void 0,this._forciblySetToStale=!1,this._reactToDependencyGoingStale=Je=>{this._possiblyStaleDeps.add(Je),this._markAsStale()};for(const Je of this._dependencies)Je._addDependent(this._reactToDependencyGoingStale);fl(),this.getValue(),Uh()}get hasDependents(){return this._dependents.size>0}removeDependent(le){this._dependents.delete(le)}addDependent(le){this._dependents.add(le)}destroy(){for(const le of this._dependencies)le._removeDependent(this._reactToDependencyGoingStale);Cp(this._scope)}getValue(){if(!this._isFresh){const le=this._recalculate();this._lastValue=le,this._isFresh=!0,this._didMarkDependentsAsStale=!1,this._forciblySetToStale=!1}return this._lastValue}_recalculate(){let le;if(!this._forciblySetToStale&&this._possiblyStaleDeps.size>0){let Lt=!1;fl();for(const Cr of this._possiblyStaleDeps)if(this._cacheOfDendencyValues.get(Cr)!==Cr.getValue()){Lt=!0;break}if(Uh(),this._possiblyStaleDeps.clear(),!Lt)return this._lastValue}const Te=new Set;this._cacheOfDendencyValues.clear();const Je=Lt=>{Te.add(Lt),this._addDependency(Lt)};xm(Je),Jo.push(this._scope);try{le=this._fn()}catch(Lt){console.error(Lt)}finally{Jo.pop()!==this._scope&&console.warn("The Prism hook stack has slipped. This is a bug.")}z4(Je);for(const Lt of this._dependencies)Te.has(Lt)||this._removeDependency(Lt);this._dependencies=Te,fl();for(const Lt of Te)this._cacheOfDendencyValues.set(Lt,Lt.getValue());return Uh(),le}forceStale(){this._forciblySetToStale=!0,this._markAsStale()}_markAsStale(){if(!this._didMarkDependentsAsStale){this._didMarkDependentsAsStale=!0,this._isFresh=!1;for(const le of this._dependents)le(this._prismInstance)}}_addDependency(le){this._dependencies.has(le)||(this._dependencies.add(le),le._addDependent(this._reactToDependencyGoingStale))}_removeDependency(le){this._dependencies.has(le)&&(this._dependencies.delete(le),le._removeDependent(this._reactToDependencyGoingStale))}},bm={},Ep=class{constructor(le){this._fn=le,this.isPrism=!0,this._state={hot:!1,handle:void 0}}get isHot(){return this._state.hot}onChange(le,Te,Je=!1){const Lt=()=>{le.onThisOrNextTick(ki)};let Cr=bm;const ki=()=>{const k0=this.getValue();k0!==Cr&&(Cr=k0,Te(k0))};return this._addDependent(Lt),Je&&(Cr=this.getValue(),Te(Cr)),()=>{this._removeDependent(Lt),le.offThisOrNextTick(ki),le.offNextTick(ki)}}onStale(le){const Te=()=>{this._removeDependent(Je)},Je=()=>le();return this._addDependent(Je),Te}keepHot(){return this.onStale(()=>{})}_addDependent(le){this._state.hot||this._goHot(),this._state.handle.addDependent(le)}_goHot(){const le=new V4(this._fn,this);this._state={hot:!0,handle:le}}_removeDependent(le){const Te=this._state;if(!Te.hot)return;const Je=Te.handle;Je.removeDependent(le),Je.hasDependents||(this._state={hot:!1,handle:void 0},Je.destroy())}getValue(){D2(this);const le=this._state;let Te;return le.hot?Te=le.handle.getValue():Te=pl(this._fn),k2(this),Te}},Mp=class{constructor(le){this._hotHandle=le,this._refs=new Map,this.isPrismScope=!0,this.subs={},this.effects=new Map,this.memos=new Map}ref(le,Te){let Je=this._refs.get(le);if(Je!==void 0)return Je;{const Lt={current:Te};return this._refs.set(le,Lt),Lt}}effect(le,Te,Je){let Lt=this.effects.get(le);Lt===void 0&&(Lt={cleanup:Tp,deps:void 0},this.effects.set(le,Lt)),O2(Lt.deps,Je)&&(Lt.cleanup(),fl(),Lt.cleanup=Bh(Te,Tp).value,Uh(),Lt.deps=Je)}memo(le,Te,Je){let Lt=this.memos.get(le);return Lt===void 0&&(Lt={cachedValue:null,deps:void 0},this.memos.set(le,Lt)),O2(Lt.deps,Je)&&(fl(),Lt.cachedValue=Bh(Te,void 0).value,Uh(),Lt.deps=Je),Lt.cachedValue}state(le,Te){const{value:Je,setValue:Lt}=this.memo("state/"+le,()=>{const Cr={current:Te};return{value:Cr,setValue:pa=>{Cr.current=pa,this._hotHandle.forceStale()}}},[]);return[Je.current,Lt]}sub(le){return this.subs[le]||(this.subs[le]=new Mp(this._hotHandle)),this.subs[le]}cleanupEffects(){for(const le of this.effects.values())Bh(le.cleanup,void 0);this.effects.clear()}source(le,Te){return this.effect("$$source/blah",()=>le(()=>{this._hotHandle.forceStale()}),[le]),Te()}};function Cp(le){for(const Te of Object.values(le.subs))Cp(Te);le.cleanupEffects()}function Bh(le,Te){try{return{value:le(),ok:!0}}catch(Je){return setTimeout(function(){throw Je}),{value:Te,ok:!1}}}var Jo=new io;function G4(le,Te){const Je=Jo.peek();if(!Je)throw new Error("prism.ref() is called outside of a prism() call.");return Je.ref(le,Te)}function zh(le,Te,Je){const Lt=Jo.peek();if(!Lt)throw new Error("prism.effect() is called outside of a prism() call.");return Lt.effect(le,Te,Je)}function O2(le,Te){if(le===void 0||Te===void 0)return!0;const Je=le.length;if(Je!==Te.length)return!0;for(let Lt=0;Lt<Je;Lt++)if(le[Lt]!==Te[Lt])return!0;return!1}function L2(le,Te,Je){const Lt=Jo.peek();if(!Lt)throw new Error("prism.memo() is called outside of a prism() call.");return Lt.memo(le,Te,Je)}function fa(le,Te){const Je=Jo.peek();if(!Je)throw new Error("prism.state() is called outside of a prism() call.");return Je.state(le,Te)}function F2(){if(!Jo.peek())throw new Error("The parent function is called outside of a prism() call.")}function j4(le,Te){const Je=Jo.peek();if(!Je)throw new Error("prism.scope() is called outside of a prism() call.");const Lt=Je.sub(le);Jo.push(Lt);const Cr=Bh(Te,void 0).value;return Jo.pop(),Cr}function U2(le,Te,Je){return L2(le,()=>Ls(Te),Je).getValue()}function B2(){return!!Jo.peek()}function Sm(le,Te){const Je=Jo.peek();if(!Je)throw new Error("prism.source() is called outside of a prism() call.");return Je.source(le,Te)}var Ls=le=>new Ep(le),Nd=class{effect(le,Te,Je){console.warn("prism.effect() does not run in cold prisms")}memo(le,Te,Je){return Te()}state(le,Te){return[Te,()=>{}]}ref(le,Te){return{current:Te}}sub(le){return new Nd}source(le,Te){return Te()}};function pl(le){const Te=new Nd;Jo.push(Te);let Je;try{Je=le()}catch(Lt){console.error(Lt)}finally{Jo.pop()!==Te&&console.warn("The Prism hook stack has slipped. This is a bug.")}return Je}Ls.ref=G4,Ls.effect=zh,Ls.memo=L2,Ls.ensurePrism=F2,Ls.state=fa,Ls.scope=j4,Ls.sub=U2,Ls.inPrism=B2,Ls.source=Sm;var oc=Ls,wm;(function(le){le[le.Dict=0]="Dict",le[le.Array=1]="Array",le[le.Other=2]="Other"})(wm||(wm={}));var Mi=le=>Array.isArray(le)?1:Id(le)?0:2,Uu=(le,Te,Je=Mi(le))=>Je===0&&typeof Te=="string"||Je===1&&kd(Te)?le[Te]:void 0,kd=le=>{const Te=typeof le=="number"?le:parseInt(le,10);return!isNaN(Te)&&Te>=0&&Te<1/0&&(Te|0)===Te},Dd=class{constructor(le,Te){this._parent=le,this._path=Te,this.children=new Map,this.identityChangeListeners=new Set}addIdentityChangeListener(le){this.identityChangeListeners.add(le)}removeIdentityChangeListener(le){this.identityChangeListeners.delete(le),this._checkForGC()}removeChild(le){this.children.delete(le),this._checkForGC()}getChild(le){return this.children.get(le)}getOrCreateChild(le){let Te=this.children.get(le);return Te||(Te=Te=new Dd(this,this._path.concat([le])),this.children.set(le,Te)),Te}_checkForGC(){this.identityChangeListeners.size>0||this.children.size>0||this._parent&&this._parent.removeChild(bp(this._path))}},Vh=class{constructor(le){this.$$isPointerToPrismProvider=!0,this.pointer=Fh({root:this,path:[]}),this.prism=this.pointerToPrism(this.pointer),this._onPointerValueChange=(Te,Je)=>{const{path:Lt}=hl(Te),Cr=this._getOrCreateScopeForPath(Lt);return Cr.identityChangeListeners.add(Je),()=>{Cr.identityChangeListeners.delete(Je)}},this._currentState=le,this._rootScope=new Dd(void 0,[])}set(le){const Te=this._currentState;this._currentState=le,this._checkUpdates(this._rootScope,Te,le)}get(){return this._currentState}getByPointer(le){const Te=ic(le)?le:le(this.pointer),Je=hl(Te).path;return this._getIn(Je)}_getIn(le){return le.length===0?this.get():N0(this.get(),le)}reduce(le){this.set(le(this.get()))}reduceByPointer(le,Te){const Je=ic(le)?le:le(this.pointer),Lt=hl(Je).path,Cr=Fu(this.get(),Lt,Te);this.set(Cr)}setByPointer(le,Te){this.reduceByPointer(le,()=>Te)}_checkUpdates(le,Te,Je){if(Te===Je)return;for(const ki of le.identityChangeListeners)ki(Je);if(le.children.size===0)return;const Lt=Mi(Te),Cr=Mi(Je);if(!(Lt===2&&Lt===Cr))for(const[ki,pa]of le.children){const k0=Uu(Te,ki,Lt),Gh=Uu(Je,ki,Cr);this._checkUpdates(pa,k0,Gh)}}_getOrCreateScopeForPath(le){let Te=this._rootScope;for(const Je of le)Te=Te.getOrCreateChild(Je);return Te}pointerToPrism(le){const{path:Te}=hl(le),Je=Cr=>this._onPointerValueChange(le,Cr),Lt=()=>this._getIn(Te);return oc(()=>oc.source(Je,Lt))}},z2=new WeakMap;function Tm(le){return typeof le=="object"&&le!==null&&le.$$isPointerToPrismProvider===!0}var Od=le=>{const Te=s0(le);let Je=z2.get(Te);if(!Je){const Lt=Te.root;if(!Tm(Lt))throw new Error("Cannot run pointerToPrism() on a pointer whose root is not an PointerToPrismProvider");Je=Lt.pointerToPrism(le),z2.set(Te,Je)}return Je},ml=le=>ic(le)?Od(le).getValue():Vc(le)?le.getValue():le;function*Bu(le){let Te;if(ic(le))Te=Od(le);else if(Vc(le))Te=le;else throw new Error("Only pointers and prisms are supported");let Je=0;const Lt=Te.onStale(()=>{Je++});try{for(;;){const Cr=Je;Je=0,yield{value:Te.getValue(),ticks:Cr}}}finally{Lt()}}var H4=60*3,ac=class{constructor(le){this._conf=le,this._ticking=!1,this._dormant=!0,this._numberOfDormantTicks=0,this.__ticks=0,this._scheduledForThisOrNextTick=new Set,this._scheduledForNextTick=new Set,this._timeAtCurrentTick=0}get dormant(){return this._dormant}onThisOrNextTick(le){this._scheduledForThisOrNextTick.add(le),this._dormant&&this._goActive()}onNextTick(le){this._scheduledForNextTick.add(le),this._dormant&&this._goActive()}offThisOrNextTick(le){this._scheduledForThisOrNextTick.delete(le)}offNextTick(le){this._scheduledForNextTick.delete(le)}get time(){return this._ticking?this._timeAtCurrentTick:performance.now()}_goActive(){var le,Te;this._dormant&&(this._dormant=!1,(Te=(le=this._conf)==null?void 0:le.onActive)==null||Te.call(le))}_goDormant(){var le,Te;this._dormant||(this._dormant=!0,this._numberOfDormantTicks=0,(Te=(le=this._conf)==null?void 0:le.onDormant)==null||Te.call(le))}tick(le=performance.now()){if(this.__ticks++,!this._dormant&&this._scheduledForNextTick.size===0&&this._scheduledForThisOrNextTick.size===0&&(this._numberOfDormantTicks++,this._numberOfDormantTicks>=H4)){this._goDormant();return}this._ticking=!0,this._timeAtCurrentTick=le;for(const Te of this._scheduledForNextTick)this._scheduledForThisOrNextTick.add(Te);this._scheduledForNextTick.clear(),this._tick(0),this._ticking=!1}_tick(le){const Te=this.time;if(le>10&&console.warn("_tick() recursing for 10 times"),le>100)throw new Error("Maximum recursion limit for _tick()");const Je=this._scheduledForThisOrNextTick;this._scheduledForThisOrNextTick=new Set;for(const Lt of Je)Lt(Te);if(this._scheduledForThisOrNextTick.size>0)return this._tick(le+1)}};function*Ap(le){let Te;if(ic(le))Te=Od(le);else if(Vc(le))Te=le;else throw new Error("Only pointers and prisms are supported");const Je=new ac,Lt=Te.onChange(Je,Cr=>{});try{for(;;)Je.tick(),yield Te.getValue()}finally{Lt()}}var V2=class{constructor(le){this.$$isPointerToPrismProvider=!0,this._currentPointerBox=new Vh(le),this.pointer=Fh({root:this,path:[]})}setPointer(le){this._currentPointerBox.set(le)}pointerToPrism(le){const{path:Te}=s0(le);return oc(()=>{const Je=this._currentPointerBox.prism.getValue(),Lt=Te.reduce((Cr,ki)=>Cr[ki],Je);return ml(Lt)})}}}(EG)),EG}var RT={exports:{}};RT.exports;var Q3e;function Pve(){return Q3e||(Q3e=1,function(i,e){var t=Object.create,n=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,w=(b,I,V)=>I in b?n(b,I,{enumerable:!0,configurable:!0,writable:!0,value:V}):b[I]=V,C=(b,I)=>{for(var V in I||(I={}))y.call(I,V)&&w(b,V,I[V]);if(d)for(var V of d(I))x.call(I,V)&&w(b,V,I[V]);return b},N=(b,I)=>r(b,a(I)),F=(b,I)=>function(){return I||(0,b[c(b)[0]])((I={exports:{}}).exports,I),I.exports},U=(b,I)=>{for(var V in I)n(b,V,{get:I[V],enumerable:!0})},R=(b,I,V,te)=>{if(I&&typeof I=="object"||typeof I=="function")for(let he of c(I))!y.call(b,he)&&he!==V&&n(b,he,{get:()=>I[he],enumerable:!(te=s(I,he))||te.enumerable});return b},B=(b,I,V)=>(V=b!=null?t(p(b)):{},R(!b||!b.__esModule?n(V,"default",{value:b,enumerable:!0}):V,b)),Y=b=>R(n({},"__esModule",{value:!0}),b),A=(b,I,V)=>(w(b,typeof I!="symbol"?I+"":I,V),V),ne=F({"../node_modules/timing-function/lib/UnitBezier.js"(b,I){I.exports=function(){function V(te,he,ve,Be){this.set(te,he,ve,Be)}return V.prototype.set=function(te,he,ve,Be){this._cx=3*te,this._bx=3*(ve-te)-this._cx,this._ax=1-this._cx-this._bx,this._cy=3*he,this._by=3*(Be-he)-this._cy,this._ay=1-this._cy-this._by},V.epsilon=1e-6,V.prototype._sampleCurveX=function(te){return((this._ax*te+this._bx)*te+this._cx)*te},V.prototype._sampleCurveY=function(te){return((this._ay*te+this._by)*te+this._cy)*te},V.prototype._sampleCurveDerivativeX=function(te){return(3*this._ax*te+2*this._bx)*te+this._cx},V.prototype._solveCurveX=function(te,he){var ve,Be,lt,yt,Dt,rn;for(lt=void 0,yt=void 0,Dt=void 0,rn=void 0,ve=void 0,Be=void 0,Dt=te,Be=0;Be<8;){if(rn=this._sampleCurveX(Dt)-te,Math.abs(rn)<he)return Dt;if(ve=this._sampleCurveDerivativeX(Dt),Math.abs(ve)<he)break;Dt=Dt-rn/ve,Be++}if(lt=0,yt=1,Dt=te,Dt<lt)return lt;if(Dt>yt)return yt;for(;lt<yt;){if(rn=this._sampleCurveX(Dt),Math.abs(rn-te)<he)return Dt;te>rn?lt=Dt:yt=Dt,Dt=(yt-lt)*.5+lt}return Dt},V.prototype.solve=function(te,he){return this._sampleCurveY(this._solveCurveX(te,he))},V.prototype.solveSimple=function(te){return this._sampleCurveY(this._solveCurveX(te,1e-6))},V}()}}),se=F({"../node_modules/levenshtein-edit-distance/index.js"(b,I){var V,te;V=[],te=[];function he(ve,Be,lt){var yt,Dt,rn,ln,In,sr,er,Zr;if(ve===Be)return 0;if(yt=ve.length,Dt=Be.length,yt===0)return Dt;if(Dt===0)return yt;for(lt&&(ve=ve.toLowerCase(),Be=Be.toLowerCase()),er=0;er<yt;)te[er]=ve.charCodeAt(er),V[er]=++er;for(Zr=0;Zr<Dt;)for(rn=Be.charCodeAt(Zr),ln=In=Zr++,er=-1;++er<yt;)sr=rn===te[er]?In:In+1,In=V[er],V[er]=ln=In>ln?sr>ln?ln+1:sr:sr>In?In+1:sr;return ln}I.exports=he}}),oe=F({"../node_modules/propose/propose.js"(b,I){var V=se();function te(){var he,ve,Be,lt,yt,Dt=0,rn=arguments[0],ln=arguments[1],In=ln.length,sr=arguments[2];sr&&(lt=sr.threshold,yt=sr.ignoreCase),lt===void 0&&(lt=0);for(var er=0;er<In;++er)yt?ve=V(rn,ln[er],!0):ve=V(rn,ln[er]),ve>rn.length?he=1-ve/ln[er].length:he=1-ve/rn.length,he>Dt&&(Dt=he,Be=ln[er]);return Dt>=lt?Be:null}I.exports=te}}),G=F({"../node_modules/fast-deep-equal/index.js"(b,I){I.exports=function V(te,he){if(te===he)return!0;if(te&&he&&typeof te=="object"&&typeof he=="object"){if(te.constructor!==he.constructor)return!1;var ve,Be,lt;if(Array.isArray(te)){if(ve=te.length,ve!=he.length)return!1;for(Be=ve;Be--!==0;)if(!V(te[Be],he[Be]))return!1;return!0}if(te.constructor===RegExp)return te.source===he.source&&te.flags===he.flags;if(te.valueOf!==Object.prototype.valueOf)return te.valueOf()===he.valueOf();if(te.toString!==Object.prototype.toString)return te.toString()===he.toString();if(lt=Object.keys(te),ve=lt.length,ve!==Object.keys(he).length)return!1;for(Be=ve;Be--!==0;)if(!Object.prototype.hasOwnProperty.call(he,lt[Be]))return!1;for(Be=ve;Be--!==0;){var yt=lt[Be];if(!V(te[yt],he[yt]))return!1}return!0}return te!==te&&he!==he}}}),ie={};U(ie,{createRafDriver:()=>_y,getProject:()=>cC,notify:()=>l1,onChange:()=>$b,types:()=>Cb,val:()=>Xb}),i.exports=Y(ie);var Me={};U(Me,{createRafDriver:()=>_y,getProject:()=>cC,notify:()=>l1,onChange:()=>$b,types:()=>Cb,val:()=>Xb});var X=an(),De=class{constructor(){A(this,"atom",new X.Atom({projects:{}}))}add(b,I){this.atom.setByPointer(V=>V.projects[b],I)}get(b){return this.atom.get().projects[b]}has(b){return!!this.get(b)}},$e=new De,ot=$e,He=new WeakMap;function ce(b){return He.get(b)}function Ge(b,I){He.set(b,I)}var Ie=[],st=Array.isArray,bt=st,Ne=typeof tl=="object"&&tl&&tl.Object===Object&&tl,ht=Ne,Ot=typeof self=="object"&&self&&self.Object===Object&&self,wn=ht||Ot||Function("return this")(),bn=wn,Tt=bn.Symbol,Gt=Tt,$t=Object.prototype,Ln=$t.hasOwnProperty,jn=$t.toString,fr=Gt?Gt.toStringTag:void 0;function ds(b){var I=Ln.call(b,fr),V=b[fr];try{b[fr]=void 0;var te=!0}catch{}var he=jn.call(b);return te&&(I?b[fr]=V:delete b[fr]),he}var Wr=ds,Br=Object.prototype,Kr=Br.toString;function Vr(b){return Kr.call(b)}var ai=Vr,qe="[object Null]",hs="[object Undefined]",ni=Gt?Gt.toStringTag:void 0;function gi(b){return b==null?b===void 0?hs:qe:ni&&ni in Object(b)?Wr(b):ai(b)}var Fn=gi;function Pe(b){return b!=null&&typeof b=="object"}var de=Pe,dt="[object Symbol]";function qt(b){return typeof b=="symbol"||de(b)&&Fn(b)==dt}var Xt=qt,Bt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$n=/^\w*$/;function _n(b,I){if(bt(b))return!1;var V=typeof b;return V=="number"||V=="symbol"||V=="boolean"||b==null||Xt(b)?!0:$n.test(b)||!Bt.test(b)||I!=null&&b in Object(I)}var tr=_n;function Mr(b){var I=typeof b;return b!=null&&(I=="object"||I=="function")}var Qt=Mr,pn="[object AsyncFunction]",Un="[object Function]",Vn="[object GeneratorFunction]",Dn="[object Proxy]";function br(b){if(!Qt(b))return!1;var I=Fn(b);return I==Un||I==Vn||I==pn||I==Dn}var Qe=br,gn=bn["__core-js_shared__"],un=gn,Cn=function(){var b=/[^.]+$/.exec(un&&un.keys&&un.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}();function on(b){return!!Cn&&Cn in b}var zt=on,Gn=Function.prototype,Ir=Gn.toString;function zi(b){if(b!=null){try{return Ir.call(b)}catch{}try{return b+""}catch{}}return""}var Tr=zi,Ms=/[\\^$.*+?()[\]{}|]/g,Ko=/^\[object .+?Constructor\]$/,Iu=Function.prototype,I0=Object.prototype,Dh=Iu.toString,Kl=I0.hasOwnProperty,Nu=RegExp("^"+Dh.call(Kl).replace(Ms,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function r0(b){if(!Qt(b)||zt(b))return!1;var I=Qe(b)?Nu:Ko;return I.test(Tr(b))}var Ga=r0;function Ed(b,I){return b==null?void 0:b[I]}var up=Ed;function Md(b,I){var V=up(b,I);return Ga(V)?V:void 0}var ko=Md,Uc=ko(Object,"create"),Zl=Uc;function ku(){this.__data__=Zl?Zl(null):{},this.size=0}var Zo=ku;function ja(b){var I=this.has(b)&&delete this.__data__[b];return this.size-=I?1:0,I}var dp=ja,Cd="__lodash_hash_undefined__",hp=Object.prototype,fp=hp.hasOwnProperty;function me(b){var I=this.__data__;if(Zl){var V=I[b];return V===Cd?void 0:V}return fp.call(I,b)?I[b]:void 0}var pt=me,At=Object.prototype,St=At.hasOwnProperty;function _t(b){var I=this.__data__;return Zl?I[b]!==void 0:St.call(I,b)}var Rn=_t,Bn="__lodash_hash_undefined__";function Mn(b,I){var V=this.__data__;return this.size+=this.has(b)?0:1,V[b]=Zl&&I===void 0?Bn:I,this}var On=Mn;function Kn(b){var I=-1,V=b==null?0:b.length;for(this.clear();++I<V;){var te=b[I];this.set(te[0],te[1])}}Kn.prototype.clear=Zo,Kn.prototype.delete=dp,Kn.prototype.get=pt,Kn.prototype.has=Rn,Kn.prototype.set=On;var ur=Kn;function zr(){this.__data__=[],this.size=0}var pr=zr;function li(b,I){return b===I||b!==b&&I!==I}var Ni=li;function Ki(b,I){for(var V=b.length;V--;)if(Ni(b[V][0],I))return V;return-1}var ii=Ki,Os=Array.prototype,nr=Os.splice;function Qo(b){var I=this.__data__,V=ii(I,b);if(V<0)return!1;var te=I.length-1;return V==te?I.pop():nr.call(I,V,1),--this.size,!0}var si=Qo;function ha(b){var I=this.__data__,V=ii(I,b);return V<0?void 0:I[V][1]}var Xs=ha;function Do(b){return ii(this.__data__,b)>-1}var Bc=Do;function xi(b,I){var V=this.__data__,te=ii(V,b);return te<0?(++this.size,V.push([b,I])):V[te][1]=I,this}var Nr=xi;function Oo(b){var I=-1,V=b==null?0:b.length;for(this.clear();++I<V;){var te=b[I];this.set(te[0],te[1])}}Oo.prototype.clear=pr,Oo.prototype.delete=si,Oo.prototype.get=Xs,Oo.prototype.has=Bc,Oo.prototype.set=Nr;var xs=Oo,i0=ko(bn,"Map"),Aa=i0;function Ad(){this.size=0,this.__data__={hash:new ur,map:new(Aa||xs),string:new ur}}var Ql=Ad;function pp(b){var I=typeof b;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?b!=="__proto__":b===null}var mp=pp;function Jl(b,I){var V=b.__data__;return mp(I)?V[typeof I=="string"?"string":"hash"]:V.map}var Ha=Jl;function ul(b){var I=Ha(this,b).delete(b);return this.size-=I?1:0,I}var Du=ul;function Pd(b){return Ha(this,b).get(b)}var ec=Pd;function P2(b){return Ha(this,b).has(b)}var gm=P2;function Oh(b,I){var V=Ha(this,b),te=V.size;return V.set(b,I),this.size+=V.size==te?0:1,this}var B4=Oh;function zc(b){var I=-1,V=b==null?0:b.length;for(this.clear();++I<V;){var te=b[I];this.set(te[0],te[1])}}zc.prototype.clear=Ql,zc.prototype.delete=Du,zc.prototype.get=ec,zc.prototype.has=gm,zc.prototype.set=B4;var Ou=zc,R2="Expected a function";function dl(b,I){if(typeof b!="function"||I!=null&&typeof I!="function")throw new TypeError(R2);var V=function(){var te=arguments,he=I?I.apply(this,te):te[0],ve=V.cache;if(ve.has(he))return ve.get(he);var Be=b.apply(this,te);return V.cache=ve.set(he,Be)||ve,Be};return V.cache=new(dl.Cache||Ou),V}dl.Cache=Ou;var N0=dl,Rd=500;function tc(b){var I=N0(b,function(te){return V.size===Rd&&V.clear(),te}),V=I.cache;return I}var gp=tc,vm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,I2=/\\(\\)?/g,vp=gp(function(b){var I=[];return b.charCodeAt(0)===46&&I.push(""),b.replace(vm,function(V,te,he,ve){I.push(he?ve.replace(I2,"$1"):te||V)}),I}),yp=vp;function _p(b,I){for(var V=-1,te=b==null?0:b.length,he=Array(te);++V<te;)he[V]=I(b[V],V,b);return he}var ym=_p,nc=Gt?Gt.prototype:void 0,xp=nc?nc.toString:void 0;function Id(b){if(typeof b=="string")return b;if(bt(b))return ym(b,Id)+"";if(Xt(b))return xp?xp.call(b):"";var I=b+"";return I=="0"&&1/b==-1/0?"-0":I}var _m=Id;function bp(b){return b==null?"":_m(b)}var rc=bp;function Sp(b,I){return bt(b)?b:tr(b,I)?[b]:yp(rc(b))}var Lo=Sp;function Lu(b){if(typeof b=="string"||Xt(b))return b;var I=b+"";return I=="0"&&1/b==-1/0?"-0":I}var s0=Lu;function hl(b,I){I=Lo(I,b);for(var V=0,te=I.length;b!=null&&V<te;)b=b[s0(I[V++])];return V&&V==te?b:void 0}var Lh=hl;function Fh(b,I,V){var te=b==null?void 0:Lh(b,I);return te===void 0?V:te}var ic=Fh;function Fu(b,I){return I.length===0?b:ic(b,I)}var sc=class{constructor(){A(this,"_values",{})}get(b,I){if(this.has(b))return this._values[b];{const V=I();return this._values[b]=V,V}}has(b){return this._values.hasOwnProperty(b)}},io=an(),Vc=function(){try{var b=ko(Object,"defineProperty");return b({},"",{}),b}catch{}}(),wp=Vc;function N2(b,I,V){I=="__proto__"&&wp?wp(b,I,{configurable:!0,enumerable:!0,value:V,writable:!0}):b[I]=V}var fl=N2,Uh=Object.prototype,k2=Uh.hasOwnProperty;function D2(b,I,V){var te=b[I];(!(k2.call(b,I)&&Ni(te,V))||V===void 0&&!(I in b))&&fl(b,I,V)}var xm=D2,z4=9007199254740991,Tp=/^(?:0|[1-9]\d*)$/;function V4(b,I){var V=typeof b;return I=I??z4,!!I&&(V=="number"||V!="symbol"&&Tp.test(b))&&b>-1&&b%1==0&&b<I}var bm=V4;function Ep(b,I,V,te){if(!Qt(b))return b;I=Lo(I,b);for(var he=-1,ve=I.length,Be=ve-1,lt=b;lt!=null&&++he<ve;){var yt=s0(I[he]),Dt=V;if(yt==="__proto__"||yt==="constructor"||yt==="prototype")return b;if(he!=Be){var rn=lt[yt];Dt=te?te(rn,yt,lt):void 0,Dt===void 0&&(Dt=Qt(rn)?rn:bm(I[he+1])?[]:{})}xm(lt,yt,Dt),lt=lt[yt]}return b}var Mp=Ep;function Cp(b,I,V){return b==null?b:Mp(b,I,V)}var Bh=Cp,Jo=new WeakMap;function G4(b){return zh(b)}function zh(b){if(Jo.has(b))return Jo.get(b);const I=b.type==="compound"?L2(b):b.type==="enum"?O2(b):b.default;return Jo.set(b,I),I}function O2(b){const I={$case:b.defaultCase};for(const[V,te]of Object.entries(b.cases))I[V]=zh(te);return I}function L2(b){const I={};for(const[V,te]of Object.entries(b.props))I[V]=zh(te);return I}var fa=an(),F2=B(ne());function j4(b,I,V){return(0,fa.prism)(()=>{const te=(0,fa.val)(I);return fa.prism.memo("driver",()=>te?te.type==="BasicKeyframedTrack"?U2(b,te,V):(b.logger.error("Track type not yet supported."),(0,fa.prism)(()=>{})):(0,fa.prism)(()=>{}),[te]).getValue()})}function U2(b,I,V){return(0,fa.prism)(()=>{let te=fa.prism.ref("state",{started:!1}),he=te.current;const ve=V.getValue();return(!he.started||ve<he.validFrom||he.validTo<=ve)&&(te.current=he=Sm(b,V,I)),he.der.getValue()})}var B2=(0,fa.prism)(()=>{});function Sm(b,I,V){const te=I.getValue();if(V.keyframes.length===0)return{started:!0,validFrom:-1/0,validTo:1/0,der:B2};let he=0;for(;;){const ve=V.keyframes[he];if(!ve)return Ls.error;const Be=he===V.keyframes.length-1;if(te<ve.position)return he===0?Ls.beforeFirstKeyframe(ve):Ls.error;if(ve.position===te)return Be?Ls.lastKeyframe(ve):Ls.between(ve,V.keyframes[he+1],I);if(he===V.keyframes.length-1)return Ls.lastKeyframe(ve);{const lt=he+1;if(V.keyframes[lt].position<=te){he=lt;continue}else return Ls.between(ve,V.keyframes[he+1],I)}}}var Ls={beforeFirstKeyframe(b){return{started:!0,validFrom:-1/0,validTo:b.position,der:(0,fa.prism)(()=>({left:b.value,progression:0}))}},lastKeyframe(b){return{started:!0,validFrom:b.position,validTo:1/0,der:(0,fa.prism)(()=>({left:b.value,progression:0}))}},between(b,I,V){if(!b.connectedRight)return{started:!0,validFrom:b.position,validTo:I.position,der:(0,fa.prism)(()=>({left:b.value,progression:0}))};const te=ve=>(ve-b.position)/(I.position-b.position);if(!b.type||b.type==="bezier"){const ve=new F2.default(b.handles[2],b.handles[3],I.handles[0],I.handles[1]),Be=(0,fa.prism)(()=>{const lt=te(V.getValue()),yt=ve.solveSimple(lt);return{left:b.value,right:I.value,progression:yt}});return{started:!0,validFrom:b.position,validTo:I.position,der:Be}}const he=(0,fa.prism)(()=>{const ve=te(V.getValue()),Be=Math.floor(ve);return{left:b.value,right:I.value,progression:Be}});return{started:!0,validFrom:b.position,validTo:I.position,der:he}},error:{started:!0,validFrom:-1/0,validTo:1/0,der:B2}};function Nd(b,I,V){const he=V.get(b);if(he&&he.override===I)return he.merged;const ve=C({},b);for(const Be of Object.keys(I)){const lt=I[Be],yt=b[Be];ve[Be]=typeof lt=="object"&&typeof yt=="object"?Nd(yt,lt,V):lt===void 0?yt:lt}return V.set(b,{override:I,merged:ve}),ve}function pl(b,I){let V=b;for(const te of I)V=V[te];return V}var oc=an(),wm=(b,I)=>{const V=oc.prism.memo(b,()=>new oc.Atom(I),[]);return V.set(I),V},Mi=an(),Uu=an(),kd=/\s/;function Dd(b){for(var I=b.length;I--&&kd.test(b.charAt(I)););return I}var Vh=Dd,z2=/^\s+/;function Tm(b){return b&&b.slice(0,Vh(b)+1).replace(z2,"")}var Od=Tm,ml=NaN,Bu=/^[-+]0x[0-9a-f]+$/i,H4=/^0b[01]+$/i,ac=/^0o[0-7]+$/i,Ap=parseInt;function V2(b){if(typeof b=="number")return b;if(Xt(b))return ml;if(Qt(b)){var I=typeof b.valueOf=="function"?b.valueOf():b;b=Qt(I)?I+"":I}if(typeof b!="string")return b===0?b:+b;b=Od(b);var V=H4.test(b);return V||ac.test(b)?Ap(b.slice(2),V?2:8):Bu.test(b)?ml:+b}var le=V2,Te=1/0,Je=17976931348623157e292;function Lt(b){if(!b)return b===0?b:0;if(b=le(b),b===Te||b===-Te){var I=b<0?-1:1;return I*Je}return b===b?b:0}var Cr=Lt;function ki(b){var I=Cr(b),V=I%1;return I===I?V?I-V:I:0}var pa=ki;function k0(b){return b}var Gh=k0,Gc=ko(bn,"WeakMap"),ma=Gc,lc=Object.create,Pp=function(){function b(){}return function(I){if(!Qt(I))return{};if(lc)return lc(I);b.prototype=I;var V=new b;return b.prototype=void 0,V}}(),w6=Pp;function G2(b,I){var V=-1,te=b.length;for(I||(I=Array(te));++V<te;)I[V]=b[V];return I}var T6=G2;function W4(b,I){for(var V=-1,te=b==null?0:b.length;++V<te&&I(b[V],V,b)!==!1;);return b}var E6=W4;function j2(b,I,V,te){var he=!V;V||(V={});for(var ve=-1,Be=I.length;++ve<Be;){var lt=I[ve],yt=te?te(V[lt],b[lt],lt,V,b):void 0;yt===void 0&&(yt=b[lt]),he?fl(V,lt,yt):xm(V,lt,yt)}return V}var cc=j2,q4=9007199254740991;function Rp(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=q4}var Em=Rp;function M6(b){return b!=null&&Em(b.length)&&!Qe(b)}var Ip=M6,Ld=Object.prototype;function $4(b){var I=b&&b.constructor,V=typeof I=="function"&&I.prototype||Ld;return b===V}var Np=$4;function Mm(b,I){for(var V=-1,te=Array(b);++V<b;)te[V]=I(V);return te}var X4=Mm,Y4="[object Arguments]";function Cm(b){return de(b)&&Fn(b)==Y4}var Am=Cm,K4=Object.prototype,Z4=K4.hasOwnProperty,Fd=K4.propertyIsEnumerable,Pm=Am(function(){return arguments}())?Am:function(b){return de(b)&&Z4.call(b,"callee")&&!Fd.call(b,"callee")},kp=Pm;function C6(){return!1}var Q4=C6,jh=e&&!e.nodeType&&e,J4=jh&&!0&&i&&!i.nodeType&&i,Dp=J4&&J4.exports===jh,Rm=Dp?bn.Buffer:void 0,Cs=Rm?Rm.isBuffer:void 0,H2=Cs||Q4,Ud=H2,Op="[object Arguments]",e5="[object Array]",W2="[object Boolean]",Lp="[object Date]",Im="[object Error]",Hh="[object Function]",t5="[object Map]",A6="[object Number]",P6="[object Object]",n5="[object RegExp]",Nm="[object Set]",km="[object String]",q2="[object WeakMap]",$2="[object ArrayBuffer]",X2="[object DataView]",Y2="[object Float32Array]",R6="[object Float64Array]",r5="[object Int8Array]",I6="[object Int16Array]",N6="[object Int32Array]",K2="[object Uint8Array]",zu="[object Uint8ClampedArray]",fs="[object Uint16Array]",Wh="[object Uint32Array]",Ci={};Ci[Y2]=Ci[R6]=Ci[r5]=Ci[I6]=Ci[N6]=Ci[K2]=Ci[zu]=Ci[fs]=Ci[Wh]=!0,Ci[Op]=Ci[e5]=Ci[$2]=Ci[W2]=Ci[X2]=Ci[Lp]=Ci[Im]=Ci[Hh]=Ci[t5]=Ci[A6]=Ci[P6]=Ci[n5]=Ci[Nm]=Ci[km]=Ci[q2]=!1;function Dm(b){return de(b)&&Em(b.length)&&!!Ci[Fn(b)]}var o0=Dm;function qh(b){return function(I){return b(I)}}var Om=qh,$h=e&&!e.nodeType&&e,gl=$h&&!0&&i&&!i.nodeType&&i,Bd=gl&&gl.exports===$h,Vu=Bd&&ht.process,jc=function(){try{var b=gl&&gl.require&&gl.require("util").types;return b||Vu&&Vu.binding&&Vu.binding("util")}catch{}}(),Hc=jc,Gu=Hc&&Hc.isTypedArray,ju=Gu?Om(Gu):o0,is=ju,ps=Object.prototype,zd=ps.hasOwnProperty;function ga(b,I){var V=bt(b),te=!V&&kp(b),he=!V&&!te&&Ud(b),ve=!V&&!te&&!he&&is(b),Be=V||te||he||ve,lt=Be?X4(b.length,String):[],yt=lt.length;for(var Dt in b)(I||zd.call(b,Dt))&&!(Be&&(Dt=="length"||he&&(Dt=="offset"||Dt=="parent")||ve&&(Dt=="buffer"||Dt=="byteLength"||Dt=="byteOffset")||bm(Dt,yt)))&&lt.push(Dt);return lt}var Pa=ga;function Hu(b,I){return function(V){return b(I(V))}}var Vd=Hu,a0=Vd(Object.keys,Object),Fp=a0,i5=Object.prototype,s5=i5.hasOwnProperty;function Lm(b){if(!Np(b))return Fp(b);var I=[];for(var V in Object(b))s5.call(b,V)&&V!="constructor"&&I.push(V);return I}var k6=Lm;function Wu(b){return Ip(b)?Pa(b):k6(b)}var qu=Wu;function Z2(b){var I=[];if(b!=null)for(var V in Object(b))I.push(V);return I}var o5=Z2,Jx=Object.prototype,Gd=Jx.hasOwnProperty;function uc(b){if(!Qt(b))return o5(b);var I=Np(b),V=[];for(var te in b)te=="constructor"&&(I||!Gd.call(b,te))||V.push(te);return V}var Wc=uc;function Q2(b){return Ip(b)?Pa(b,!0):Wc(b)}var Xh=Q2;function vl(b,I){for(var V=-1,te=I.length,he=b.length;++V<te;)b[he+V]=I[V];return b}var D0=vl,jd=Vd(Object.getPrototypeOf,Object),yl=jd,qc="[object Object]",Yh=Function.prototype,D6=Object.prototype,Kh=Yh.toString,Fm=D6.hasOwnProperty,O0=Kh.call(Object);function l0(b){if(!de(b)||Fn(b)!=qc)return!1;var I=yl(b);if(I===null)return!0;var V=Fm.call(I,"constructor")&&I.constructor;return typeof V=="function"&&V instanceof V&&Kh.call(V)==O0}var As=l0;function c0(b,I,V){var te=-1,he=b.length;I<0&&(I=-I>he?0:he+I),V=V>he?he:V,V<0&&(V+=he),he=I>V?0:V-I>>>0,I>>>=0;for(var ve=Array(he);++te<he;)ve[te]=b[te+I];return ve}var Um=c0;function a5(b,I,V){var te=b.length;return V=V===void 0?te:V,!I&&V>=te?b:Um(b,I,V)}var Hd=a5,Up="\\ud800-\\udfff",O6="\\u0300-\\u036f",Bm="\\ufe20-\\ufe2f",L6="\\u20d0-\\u20ff",Bp=O6+Bm+L6,J2="\\ufe0e\\ufe0f",eb="\\u200d",zm=RegExp("["+eb+Up+Bp+J2+"]");function Vm(b){return zm.test(b)}var Gm=Vm;function l5(b){return b.split("")}var Zh=l5,c5="\\ud800-\\udfff",e3="\\u0300-\\u036f",jm="\\ufe20-\\ufe2f",Qh="\\u20d0-\\u20ff",t3=e3+jm+Qh,u5="\\ufe0e\\ufe0f",d5="["+c5+"]",zp="["+t3+"]",$u="\\ud83c[\\udffb-\\udfff]",_l="(?:"+zp+"|"+$u+")",L0="[^"+c5+"]",Vp="(?:\\ud83c[\\udde6-\\uddff]){2}",h5="[\\ud800-\\udbff][\\udc00-\\udfff]",Xu="\\u200d",$c=_l+"?",n3="["+u5+"]?",F6="(?:"+Xu+"(?:"+[L0,Vp,h5].join("|")+")"+n3+$c+")*",F0=n3+$c+F6,dc="(?:"+[L0+zp+"?",zp,Vp,h5,d5].join("|")+")",r3=RegExp($u+"(?="+$u+")|"+dc+F0,"g");function f5(b){return b.match(r3)||[]}var Hm=f5;function p5(b){return Gm(b)?Hm(b):Zh(b)}var Wm=p5;function Xc(b,I,V){return b===b&&(V!==void 0&&(b=b<=V?b:V),I!==void 0&&(b=b>=I?b:I)),b}var Gp=Xc;function qm(b,I,V){return V===void 0&&(V=I,I=void 0),V!==void 0&&(V=le(V),V=V===V?V:0),I!==void 0&&(I=le(I),I=I===I?I:0),Gp(le(b),I,V)}var Wd=qm;function i3(){this.__data__=new xs,this.size=0}var jp=i3;function U6(b){var I=this.__data__,V=I.delete(b);return this.size=I.size,V}var s3=U6;function js(b){return this.__data__.get(b)}var Yu=js;function Jh(b){return this.__data__.has(b)}var Hp=Jh,$m=200;function qd(b,I){var V=this.__data__;if(V instanceof xs){var te=V.__data__;if(!Aa||te.length<$m-1)return te.push([b,I]),this.size=++V.size,this;V=this.__data__=new Ou(te)}return V.set(b,I),this.size=V.size,this}var Ku=qd;function ss(b){var I=this.__data__=new xs(b);this.size=I.size}ss.prototype.clear=jp,ss.prototype.delete=s3,ss.prototype.get=Yu,ss.prototype.has=Hp,ss.prototype.set=Ku;var Fs=ss;function ea(b,I){return b&&cc(I,qu(I),b)}var o3=ea;function Wp(b,I){return b&&cc(I,Xh(I),b)}var Xm=Wp,B6=e&&!e.nodeType&&e,so=B6&&!0&&i&&!i.nodeType&&i,qp=so&&so.exports===B6,a3=qp?bn.Buffer:void 0,Ym=a3?a3.allocUnsafe:void 0;function Yc(b,I){if(I)return b.slice();var V=b.length,te=Ym?Ym(V):new b.constructor(V);return b.copy(te),te}var xl=Yc;function $p(b,I){for(var V=-1,te=b==null?0:b.length,he=0,ve=[];++V<te;){var Be=b[V];I(Be,V,b)&&(ve[he++]=Be)}return ve}var m5=$p;function g5(){return[]}var l3=g5,z6=Object.prototype,V6=z6.propertyIsEnumerable,c3=Object.getOwnPropertySymbols,G6=c3?function(b){return b==null?[]:(b=Object(b),m5(c3(b),function(I){return V6.call(b,I)}))}:l3,Zu=G6;function Xp(b,I){return cc(b,Zu(b),I)}var u3=Xp,ef=Object.getOwnPropertySymbols,v5=ef?function(b){for(var I=[];b;)D0(I,Zu(b)),b=yl(b);return I}:l3,tf=v5;function Km(b,I){return cc(b,tf(b),I)}var j6=Km;function d3(b,I,V){var te=I(b);return bt(b)?te:D0(te,V(b))}var h3=d3;function H6(b){return h3(b,qu,Zu)}var Zm=H6;function y5(b){return h3(b,Xh,tf)}var f3=y5,_5=ko(bn,"DataView"),p3=_5,W6=ko(bn,"Promise"),Yp=W6,x5=ko(bn,"Set"),b5=x5,Qm="[object Map]",m3="[object Object]",S5="[object Promise]",g3="[object Set]",Kc="[object WeakMap]",Kp="[object DataView]",tb=Tr(p3),v3=Tr(Aa),U0=Tr(Yp),w5=Tr(b5),Zc=Tr(ma),bl=Fn;(p3&&bl(new p3(new ArrayBuffer(1)))!=Kp||Aa&&bl(new Aa)!=Qm||Yp&&bl(Yp.resolve())!=S5||b5&&bl(new b5)!=g3||ma&&bl(new ma)!=Kc)&&(bl=function(b){var I=Fn(b),V=I==m3?b.constructor:void 0,te=V?Tr(V):"";if(te)switch(te){case tb:return Kp;case v3:return Qm;case U0:return S5;case w5:return g3;case Zc:return Kc}return I});var Zp=bl,Jm=Object.prototype,eg=Jm.hasOwnProperty;function Qp(b){var I=b.length,V=new b.constructor(I);return I&&typeof b[0]=="string"&&eg.call(b,"index")&&(V.index=b.index,V.input=b.input),V}var tg=Qp,y3=bn.Uint8Array,_3=y3;function T5(b){var I=new b.constructor(b.byteLength);return new _3(I).set(new _3(b)),I}var ng=T5;function q6(b,I){var V=I?ng(b.buffer):b.buffer;return new b.constructor(V,b.byteOffset,b.byteLength)}var E5=q6,rg=/\w*$/;function M5(b){var I=new b.constructor(b.source,rg.exec(b));return I.lastIndex=b.lastIndex,I}var u0=M5,va=Gt?Gt.prototype:void 0,x3=va?va.valueOf:void 0;function C5(b){return x3?Object(x3.call(b)):{}}var b3=C5;function A5(b,I){var V=I?ng(b.buffer):b.buffer;return new b.constructor(V,b.byteOffset,b.length)}var P5=A5,Jp="[object Boolean]",R5="[object Date]",I5="[object Map]",N5="[object Number]",k5="[object RegExp]",S3="[object Set]",D5="[object String]",$6="[object Symbol]",w3="[object ArrayBuffer]",T3="[object DataView]",nb="[object Float32Array]",Zi="[object Float64Array]",nf="[object Int8Array]",X6="[object Int16Array]",ig="[object Int32Array]",Qu="[object Uint8Array]",rb="[object Uint8ClampedArray]",O5="[object Uint16Array]",L5="[object Uint32Array]";function Y6(b,I,V){var te=b.constructor;switch(I){case w3:return ng(b);case Jp:case R5:return new te(+b);case T3:return E5(b,V);case nb:case Zi:case nf:case X6:case ig:case Qu:case rb:case O5:case L5:return P5(b,V);case I5:return new te;case N5:case D5:return new te(b);case k5:return u0(b);case S3:return new te;case $6:return b3(b)}}var F5=Y6;function sg(b){return typeof b.constructor=="function"&&!Np(b)?w6(yl(b)):{}}var Ra=sg,K6="[object Map]";function ib(b){return de(b)&&Zp(b)==K6}var E3=ib,ta=Hc&&Hc.isMap,Z6=ta?Om(ta):E3,Zn=Z6,hc="[object Set]";function $d(b){return de(b)&&Zp(b)==hc}var M3=$d,Q6=Hc&&Hc.isSet,e1=Q6?Om(Q6):M3,C3=e1,U5=1,B5=2,J6=4,z5="[object Arguments]",og="[object Array]",ag="[object Boolean]",na="[object Date]",B0="[object Error]",fc="[object Function]",V5="[object GeneratorFunction]",ey="[object Map]",pc="[object Number]",A3="[object Object]",Qc="[object RegExp]",sb="[object Set]",P3="[object String]",G5="[object Symbol]",j5="[object WeakMap]",H5="[object ArrayBuffer]",W5="[object DataView]",lg="[object Float32Array]",t1="[object Float64Array]",d0="[object Int8Array]",Di="[object Int16Array]",Fo="[object Int32Array]",_o="[object Uint8Array]",ra="[object Uint8ClampedArray]",h0="[object Uint16Array]",Xd="[object Uint32Array]",Gr={};Gr[z5]=Gr[og]=Gr[H5]=Gr[W5]=Gr[ag]=Gr[na]=Gr[lg]=Gr[t1]=Gr[d0]=Gr[Di]=Gr[Fo]=Gr[ey]=Gr[pc]=Gr[A3]=Gr[Qc]=Gr[sb]=Gr[P3]=Gr[G5]=Gr[_o]=Gr[ra]=Gr[h0]=Gr[Xd]=!0,Gr[B0]=Gr[fc]=Gr[j5]=!1;function Yd(b,I,V,te,he,ve){var Be,lt=I&U5,yt=I&B5,Dt=I&J6;if(V&&(Be=he?V(b,te,he,ve):V(b)),Be!==void 0)return Be;if(!Qt(b))return b;var rn=bt(b);if(rn){if(Be=tg(b),!lt)return T6(b,Be)}else{var ln=Zp(b),In=ln==fc||ln==V5;if(Ud(b))return xl(b,lt);if(ln==A3||ln==z5||In&&!he){if(Be=yt||In?{}:Ra(b),!lt)return yt?j6(b,Xm(Be,b)):u3(b,o3(Be,b))}else{if(!Gr[ln])return he?b:{};Be=F5(b,ln,lt)}}ve||(ve=new Fs);var sr=ve.get(b);if(sr)return sr;ve.set(b,Be),C3(b)?b.forEach(function(oi){Be.add(Yd(oi,I,V,oi,b,ve))}):Zn(b)&&b.forEach(function(oi,jr){Be.set(jr,Yd(oi,I,V,jr,b,ve))});var er=Dt?yt?f3:Zm:yt?Xh:qu,Zr=rn?void 0:er(b);return E6(Zr||b,function(oi,jr){Zr&&(jr=oi,oi=b[jr]),xm(Be,jr,Yd(oi,I,V,jr,b,ve))}),Be}var Kd=Yd,R3=1,q5=4;function rf(b){return Kd(b,R3|q5)}var Wa=rf,$5="__lodash_hash_undefined__";function Ju(b){return this.__data__.set(b,$5),this}var Jc=Ju;function I3(b){return this.__data__.has(b)}var N3=I3;function mc(b){var I=-1,V=b==null?0:b.length;for(this.__data__=new Ou;++I<V;)this.add(b[I])}mc.prototype.add=mc.prototype.push=Jc,mc.prototype.has=N3;var cg=mc;function gc(b,I){for(var V=-1,te=b==null?0:b.length;++V<te;)if(I(b[V],V,b))return!0;return!1}var k3=gc;function n1(b,I){return b.has(I)}var r1=n1,D3=1,ug=2;function oo(b,I,V,te,he,ve){var Be=V&D3,lt=b.length,yt=I.length;if(lt!=yt&&!(Be&&yt>lt))return!1;var Dt=ve.get(b),rn=ve.get(I);if(Dt&&rn)return Dt==I&&rn==b;var ln=-1,In=!0,sr=V&ug?new cg:void 0;for(ve.set(b,I),ve.set(I,b);++ln<lt;){var er=b[ln],Zr=I[ln];if(te)var oi=Be?te(Zr,er,ln,I,b,ve):te(er,Zr,ln,b,I,ve);if(oi!==void 0){if(oi)continue;In=!1;break}if(sr){if(!k3(I,function(jr,Vi){if(!r1(sr,Vi)&&(er===jr||he(er,jr,V,te,ve)))return sr.push(Vi)})){In=!1;break}}else if(!(er===Zr||he(er,Zr,V,te,ve))){In=!1;break}}return ve.delete(b),ve.delete(I),In}var eu=oo;function z0(b){var I=-1,V=Array(b.size);return b.forEach(function(te,he){V[++I]=[he,te]}),V}var qa=z0;function O3(b){var I=-1,V=Array(b.size);return b.forEach(function(te){V[++I]=te}),V}var dg=O3,hg=1,X5=2,ed="[object Boolean]",Y5="[object Date]",L3="[object Error]",Zd="[object Map]",F3="[object Number]",f0="[object RegExp]",sf="[object Set]",fg="[object String]",K5="[object Symbol]",pg="[object ArrayBuffer]",ty="[object DataView]",Z5=Gt?Gt.prototype:void 0,U3=Z5?Z5.valueOf:void 0;function Q5(b,I,V,te,he,ve,Be){switch(V){case ty:if(b.byteLength!=I.byteLength||b.byteOffset!=I.byteOffset)return!1;b=b.buffer,I=I.buffer;case pg:return!(b.byteLength!=I.byteLength||!ve(new _3(b),new _3(I)));case ed:case Y5:case F3:return Ni(+b,+I);case L3:return b.name==I.name&&b.message==I.message;case f0:case fg:return b==I+"";case Zd:var lt=qa;case sf:var yt=te&hg;if(lt||(lt=dg),b.size!=I.size&&!yt)return!1;var Dt=Be.get(b);if(Dt)return Dt==I;te|=X5,Be.set(b,I);var rn=eu(lt(b),lt(I),te,he,ve,Be);return Be.delete(b),rn;case K5:if(U3)return U3.call(b)==U3.call(I)}return!1}var vc=Q5,ny=1,i1=Object.prototype,mg=i1.hasOwnProperty;function Us(b,I,V,te,he,ve){var Be=V&ny,lt=Zm(b),yt=lt.length,Dt=Zm(I),rn=Dt.length;if(yt!=rn&&!Be)return!1;for(var ln=yt;ln--;){var In=lt[ln];if(!(Be?In in I:mg.call(I,In)))return!1}var sr=ve.get(b),er=ve.get(I);if(sr&&er)return sr==I&&er==b;var Zr=!0;ve.set(b,I),ve.set(I,b);for(var oi=Be;++ln<yt;){In=lt[ln];var jr=b[In],Vi=I[In];if(te)var ya=Be?te(Vi,jr,In,I,b,ve):te(jr,Vi,In,b,I,ve);if(!(ya===void 0?jr===Vi||he(jr,Vi,V,te,ve):ya)){Zr=!1;break}oi||(oi=In=="constructor")}if(Zr&&!oi){var bo=b.constructor,Bo=I.constructor;bo!=Bo&&"constructor"in b&&"constructor"in I&&!(typeof bo=="function"&&bo instanceof bo&&typeof Bo=="function"&&Bo instanceof Bo)&&(Zr=!1)}return ve.delete(b),ve.delete(I),Zr}var ob=Us,J5=1,ry="[object Arguments]",iy="[object Array]",s1="[object Object]",ev=Object.prototype,sy=ev.hasOwnProperty;function Sl(b,I,V,te,he,ve){var Be=bt(b),lt=bt(I),yt=Be?iy:Zp(b),Dt=lt?iy:Zp(I);yt=yt==ry?s1:yt,Dt=Dt==ry?s1:Dt;var rn=yt==s1,ln=Dt==s1,In=yt==Dt;if(In&&Ud(b)){if(!Ud(I))return!1;Be=!0,rn=!1}if(In&&!rn)return ve||(ve=new Fs),Be||is(b)?eu(b,I,V,te,he,ve):vc(b,I,yt,V,te,he,ve);if(!(V&J5)){var sr=rn&&sy.call(b,"__wrapped__"),er=ln&&sy.call(I,"__wrapped__");if(sr||er){var Zr=sr?b.value():b,oi=er?I.value():I;return ve||(ve=new Fs),he(Zr,oi,V,te,ve)}}return In?(ve||(ve=new Fs),ob(b,I,V,te,he,ve)):!1}var gg=Sl;function B3(b,I,V,te,he){return b===I?!0:b==null||I==null||!de(b)&&!de(I)?b!==b&&I!==I:gg(b,I,V,te,B3,he)}var tu=B3,z3=1,of=2;function vg(b,I,V,te){var he=V.length,ve=he,Be=!te;if(b==null)return!ve;for(b=Object(b);he--;){var lt=V[he];if(Be&&lt[2]?lt[1]!==b[lt[0]]:!(lt[0]in b))return!1}for(;++he<ve;){lt=V[he];var yt=lt[0],Dt=b[yt],rn=lt[1];if(Be&&lt[2]){if(Dt===void 0&&!(yt in b))return!1}else{var ln=new Fs;if(te)var In=te(Dt,rn,yt,b,I,ln);if(!(In===void 0?tu(rn,Dt,z3|of,te,ln):In))return!1}}return!0}var tv=vg;function nv(b){return b===b&&!Qt(b)}var rv=nv;function V3(b){for(var I=qu(b),V=I.length;V--;){var te=I[V],he=b[te];I[V]=[te,he,rv(he)]}return I}var oy=V3;function iv(b,I){return function(V){return V==null?!1:V[b]===I&&(I!==void 0||b in Object(V))}}var G3=iv;function yg(b){var I=oy(b);return I.length==1&&I[0][2]?G3(I[0][0],I[0][1]):function(V){return V===b||tv(V,b,I)}}var _g=yg;function sv(b,I){return b!=null&&I in Object(b)}var j3=sv;function ay(b,I,V){I=Lo(I,b);for(var te=-1,he=I.length,ve=!1;++te<he;){var Be=s0(I[te]);if(!(ve=b!=null&&V(b,Be)))break;b=b[Be]}return ve||++te!=he?ve:(he=b==null?0:b.length,!!he&&Em(he)&&bm(Be,he)&&(bt(b)||kp(b)))}var ov=ay;function H3(b,I){return b!=null&&ov(b,I,j3)}var xg=H3,W3=1,bg=2;function av(b,I){return tr(b)&&rv(I)?G3(s0(b),I):function(V){var te=ic(V,b);return te===void 0&&te===I?xg(V,b):tu(I,te,W3|bg)}}var ly=av;function Sg(b){return function(I){return I==null?void 0:I[b]}}var lv=Sg;function o1(b){return function(I){return Lh(I,b)}}var ab=o1;function q3(b){return tr(b)?lv(s0(b)):ab(b)}var h=q3;function g(b){return typeof b=="function"?b:b==null?Gh:typeof b=="object"?bt(b)?ly(b[0],b[1]):_g(b):h(b)}var T=g;function D(b){return function(I,V,te){for(var he=-1,ve=Object(I),Be=te(I),lt=Be.length;lt--;){var yt=Be[b?lt:++he];if(V(ve[yt],yt,ve)===!1)break}return I}}var W=D,J=W(),fe=J;function Oe(b,I){return b&&fe(b,I,qu)}var Ye=Oe,It=function(){return bn.Date.now()},nn=It,dn="Expected a function",tn=Math.max,Hn=Math.min;function Qn(b,I,V){var te,he,ve,Be,lt,yt,Dt=0,rn=!1,ln=!1,In=!0;if(typeof b!="function")throw new TypeError(dn);I=le(I)||0,Qt(V)&&(rn=!!V.leading,ln="maxWait"in V,ve=ln?tn(le(V.maxWait)||0,I):ve,In="trailing"in V?!!V.trailing:In);function sr(Qi){var ia=te,p0=he;return te=he=void 0,Dt=Qi,Be=b.apply(p0,ia),Be}function er(Qi){return Dt=Qi,lt=setTimeout(jr,I),rn?sr(Qi):Be}function Zr(Qi){var ia=Qi-yt,p0=Qi-Dt,El=I-ia;return ln?Hn(El,ve-p0):El}function oi(Qi){var ia=Qi-yt,p0=Qi-Dt;return yt===void 0||ia>=I||ia<0||ln&&p0>=ve}function jr(){var Qi=nn();if(oi(Qi))return Vi(Qi);lt=setTimeout(jr,Zr(Qi))}function Vi(Qi){return lt=void 0,In&&te?sr(Qi):(te=he=void 0,Be)}function ya(){lt!==void 0&&clearTimeout(lt),Dt=0,te=yt=he=lt=void 0}function bo(){return lt===void 0?Be:Vi(nn())}function Bo(){var Qi=nn(),ia=oi(Qi);if(te=arguments,he=this,yt=Qi,ia){if(lt===void 0)return er(yt);if(ln)return clearTimeout(lt),lt=setTimeout(jr,I),sr(yt)}return lt===void 0&&(lt=setTimeout(jr,I)),Be}return Bo.cancel=ya,Bo.flush=bo,Bo}var ir=Qn;function Ys(b){var I=b==null?0:b.length;return I?b[I-1]:void 0}var xt=Ys;function at(b,I){return I.length<2?b:Lh(b,Um(I,0,-1))}var Ct=at;function yn(b){return typeof b=="number"&&b==pa(b)}var dr=yn;function Er(b,I){var V={};return I=T(I),Ye(b,function(te,he,ve){fl(V,he,I(te,he,ve))}),V}var Ar=Er;function Dr(b,I){return I=Lo(I,b),b=Ct(b,I),b==null||delete b[s0(xt(I))]}var Uo=Dr,Oi=9007199254740991,nu=Math.floor;function cy(b,I){var V="";if(!b||I<1||I>Oi)return V;do I%2&&(V+=b),I=nu(I/2),I&&(b+=b);while(I);return V}var lb=cy,QE=lv("length"),cb=QE,ub="\\ud800-\\udfff",JE="\\u0300-\\u036f",eM="\\ufe20-\\ufe2f",tM="\\u20d0-\\u20ff",nM=JE+eM+tM,rM="\\ufe0e\\ufe0f",iM="["+ub+"]",uy="["+nM+"]",dy="\\ud83c[\\udffb-\\udfff]",sM="(?:"+uy+"|"+dy+")",db="[^"+ub+"]",hb="(?:\\ud83c[\\udde6-\\uddff]){2}",fb="[\\ud800-\\udbff][\\udc00-\\udfff]",oM="\\u200d",pb=sM+"?",mb="["+rM+"]?",Ps="(?:"+oM+"(?:"+[db,hb,fb].join("|")+")"+mb+pb+")*",aM=mb+pb+Ps,RD="(?:"+[db+uy+"?",uy,hb,fb,iM].join("|")+")",lM=RegExp(dy+"(?="+dy+")|"+RD+aM,"g");function cM(b){for(var I=lM.lastIndex=0;lM.test(b);)++I;return I}var uM=cM;function dM(b){return Gm(b)?uM(b):cb(b)}var hM=dM,ID=Math.ceil;function fM(b,I){I=I===void 0?" ":_m(I);var V=I.length;if(V<2)return V?lb(I,b):I;var te=lb(I,ID(b/hM(I)));return Gm(I)?Hd(Wm(te),0,b).join(""):te.slice(0,b)}var pM=fM;function ND(b,I,V){b=rc(b),I=pa(I);var te=I?hM(b):0;return I&&te<I?pM(I-te,V)+b:b}var cv=ND;function mM(b,I){return b==null?!0:Uo(b,I)}var gM=mM,hy=5*1e3,gb=class{constructor(b){A(this,"_cache",new sc),A(this,"_keepHotUntapDebounce"),Ge(this,b)}get type(){return"Theatre_SheetObject_PublicAPI"}get props(){return ce(this).propsP}get sheet(){return ce(this).sheet.publicApi}get project(){return ce(this).sheet.project.publicApi}get address(){return C({},ce(this).address)}_valuesPrism(){return this._cache.get("_valuesPrism",()=>{const b=ce(this);return(0,Uu.prism)(()=>(0,Uu.val)(b.getValues().getValue()))})}onValuesChange(b,I){return $b(this._valuesPrism(),b,I)}get value(){const b=this._valuesPrism();{if(!b.isHot){this._keepHotUntapDebounce!=null&&this._keepHotUntapDebounce.flush();const I=b.keepHot();this._keepHotUntapDebounce=ir(()=>{I(),this._keepHotUntapDebounce=void 0},hy)}this._keepHotUntapDebounce&&this._keepHotUntapDebounce()}return b.getValue()}set initialValue(b){ce(this).setInitialValue(b)}};function vM(b){const I=new WeakMap;return V=>(I.has(V)||I.set(V,b(V)),I.get(V))}function fy(b){return b.type==="compound"||b.type==="enum"}function py(b,I){if(!b)return;const[V,...te]=I;if(V===void 0)return b;if(!fy(b))return;const he=b.type==="enum"?b.cases[V]:b.props[V];return py(he,te)}function kD(b){return!fy(b)}var DD=class{constructor(b,I,V){this.sheet=b,this.template=I,this.nativeObject=V,A(this,"$$isPointerToPrismProvider",!0),A(this,"address"),A(this,"publicApi"),A(this,"_initialValue",new Mi.Atom({})),A(this,"_cache",new sc),A(this,"_logger"),A(this,"_internalUtilCtx"),this._logger=b._logger.named("SheetObject",I.address.objectKey),this._logger._trace("creating object"),this._internalUtilCtx={logger:this._logger.utilFor.internal()},this.address=N(C({},I.address),{sheetInstanceId:b.address.sheetInstanceId}),this.publicApi=new gb(this)}get type(){return"Theatre_SheetObject"}getValues(){return this._cache.get("getValues()",()=>(0,Mi.prism)(()=>{const b=(0,Mi.val)(this.template.getDefaultValues()),I=(0,Mi.val)(this._initialValue.pointer),V=Mi.prism.memo("withInitialCache",()=>new WeakMap,[]),te=Nd(b,I,V),he=(0,Mi.val)(this.template.getStaticValues()),ve=Mi.prism.memo("withStatics",()=>new WeakMap,[]);let lt=Nd(te,he,ve),yt;{const rn=Mi.prism.memo("seq",()=>this.getSequencedValues(),[]),ln=Mi.prism.memo("withSeqsCache",()=>new WeakMap,[]);yt=(0,Mi.val)((0,Mi.val)(rn)),lt=Nd(lt,yt,ln)}return wm("finalAtom",lt).pointer}))}getValueByPointer(b){const I=(0,Mi.val)(this.getValues()),{path:V}=(0,Mi.getPointerParts)(b);return(0,Mi.val)(pl(I,V))}pointerToPrism(b){const{path:I}=(0,Mi.getPointerParts)(b);return(0,Mi.prism)(()=>{const V=(0,Mi.val)(this.getValues());return(0,Mi.val)(pl(V,I))})}getSequencedValues(){return(0,Mi.prism)(()=>{const b=Mi.prism.memo("tracksToProcess",()=>this.template.getArrayOfValidSequenceTracks(),[]),I=(0,Mi.val)(b),V=new Mi.Atom({}),te=(0,Mi.val)(this.template.configPointer);return Mi.prism.effect("processTracks",()=>{const he=[];for(const{trackId:ve,pathToProp:Be}of I){const lt=this._trackIdToPrism(ve),yt=py(te,Be),Dt=yt.deserializeAndSanitize,rn=yt.interpolate,ln=()=>{const sr=lt.getValue();if(!sr)return V.setByPointer(Vi=>pl(Vi,Be),void 0);const er=Dt(sr.left),Zr=er===void 0?yt.default:er;if(sr.right===void 0)return V.setByPointer(Vi=>pl(Vi,Be),Zr);const oi=Dt(sr.right),jr=oi===void 0?yt.default:oi;return V.setByPointer(Vi=>pl(Vi,Be),rn(Zr,jr,sr.progression))},In=lt.onStale(ln);ln(),he.push(In)}return()=>{for(const ve of he)ve()}},[te,...I]),V.pointer})}_trackIdToPrism(b){const I=this.template.project.pointers.historic.sheetsById[this.address.sheetId].sequence.tracksByObject[this.address.objectKey].trackData[b],V=this.sheet.getSequence().positionPrism;return j4(this._internalUtilCtx,I,V)}get propsP(){return this._cache.get("propsP",()=>(0,Mi.pointer)({root:this,path:[]}))}validateValue(b,I){}setInitialValue(b){this.validateValue(this.propsP,b),this._initialValue.set(b)}};function bs(b){return function(V,te){return b(V,te())}}var wl={_hmm:yc(524),_todo:yc(522),_error:yc(521),errorDev:yc(529),errorPublic:yc(545),_kapow:yc(268),_warn:yc(265),warnDev:yc(273),warnPublic:yc(289),_debug:yc(137),debugDev:yc(145),_trace:yc(73),traceDev:yc(81)};function yc(b){return Object.freeze({audience:a1(b,8)?"internal":a1(b,16)?"dev":"public",category:a1(b,4)?"troubleshooting":a1(b,2)?"todo":"general",level:a1(b,512)?512:a1(b,256)?256:a1(b,128)?128:64})}function a1(b,I){return(b&I)===I}function Rs(b,I){return((I&32)===32?!0:(I&16)===16?b.dev:(I&8)===8?b.internal:!1)&&b.min<=I}var td={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(b,I,V){return this.create({names:[...b.names,{name:I,key:V}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(b){if(b.length<5)return b;const I=b.replace(this.collapseOnRE,"");return this.cssMemo.has(I)||this.cssMemo.set(I,this.css(b)),I},css(b){var I,V,te,he;const ve=this.cssMemo.get(b);if(ve)return ve;let Be="color:".concat((V=(I=this.color)==null?void 0:I.call(this,b))!=null?V:"hsl(".concat((b.charCodeAt(0)+b.charCodeAt(b.length-1))%360,", 100%, 60%)"));return(te=this.bold)!=null&&te.test(b)&&(Be+=";font-weight:600"),(he=this.italic)!=null&&he.test(b)&&(Be+=";font-style:italic"),this.cssMemo.set(b,Be),Be}}};function vb(b=console,I={}){const V=N(C({},td),{includes:C({},td.includes)}),te={styled:LD.bind(V,b),noStyle:my.bind(V,b)},he=yM.bind(V);function ve(){return V.loggingConsoleStyle&&V.loggerConsoleStyle?te.styled:te.noStyle}return V.create=ve(),{configureLogger(Be){var lt;Be==="console"?(V.loggerConsoleStyle=td.loggerConsoleStyle,V.create=ve()):Be.type==="console"?(V.loggerConsoleStyle=(lt=Be.style)!=null?lt:td.loggerConsoleStyle,V.create=ve()):Be.type==="keyed"?(V.creatExt=yt=>Be.keyed(yt.names),V.create=he):Be.type==="named"&&(V.creatExt=OD.bind(null,Be.named),V.create=he)},configureLogging(Be){var lt,yt,Dt,rn,ln;V.includes.dev=(lt=Be.dev)!=null?lt:td.includes.dev,V.includes.internal=(yt=Be.internal)!=null?yt:td.includes.internal,V.includes.min=(Dt=Be.min)!=null?Dt:td.includes.min,V.include=(rn=Be.include)!=null?rn:td.include,V.loggingConsoleStyle=(ln=Be.consoleStyle)!=null?ln:td.loggingConsoleStyle,V.create=ve()},getLogger(){return V.create({names:[]})}}}function OD(b,I){const V=[];for(let{name:te,key:he}of I.names)V.push(he==null?te:"".concat(te," (").concat(he,")"));return b(V)}function yM(b){const I=C(C({},this.includes),this.include(b)),V=this.filtered,te=this.named.bind(this,b),he=this.creatExt(b),ve=Rs(I,524),Be=Rs(I,522),lt=Rs(I,521),yt=Rs(I,529),Dt=Rs(I,545),rn=Rs(I,265),ln=Rs(I,268),In=Rs(I,273),sr=Rs(I,289),er=Rs(I,137),Zr=Rs(I,145),oi=Rs(I,73),jr=Rs(I,81),Vi=ve?he.error.bind(he,wl._hmm):V.bind(b,524),ya=Be?he.error.bind(he,wl._todo):V.bind(b,522),bo=lt?he.error.bind(he,wl._error):V.bind(b,521),Bo=yt?he.error.bind(he,wl.errorDev):V.bind(b,529),Qi=Dt?he.error.bind(he,wl.errorPublic):V.bind(b,545),ia=ln?he.warn.bind(he,wl._kapow):V.bind(b,268),p0=rn?he.warn.bind(he,wl._warn):V.bind(b,265),El=In?he.warn.bind(he,wl.warnDev):V.bind(b,273),nd=sr?he.warn.bind(he,wl.warnPublic):V.bind(b,273),rd=er?he.debug.bind(he,wl._debug):V.bind(b,137),th=Zr?he.debug.bind(he,wl.debugDev):V.bind(b,145),ru=oi?he.trace.bind(he,wl._trace):V.bind(b,73),Ia=jr?he.trace.bind(he,wl.traceDev):V.bind(b,81),Ss={_hmm:Vi,_todo:ya,_error:bo,errorDev:Bo,errorPublic:Qi,_kapow:ia,_warn:p0,warnDev:El,warnPublic:nd,_debug:rd,debugDev:th,_trace:ru,traceDev:Ia,lazy:{_hmm:ve?bs(Vi):Vi,_todo:Be?bs(ya):ya,_error:lt?bs(bo):bo,errorDev:yt?bs(Bo):Bo,errorPublic:Dt?bs(Qi):Qi,_kapow:ln?bs(ia):ia,_warn:rn?bs(p0):p0,warnDev:In?bs(El):El,warnPublic:sr?bs(nd):nd,_debug:er?bs(rd):rd,debugDev:Zr?bs(th):th,_trace:oi?bs(ru):ru,traceDev:jr?bs(Ia):Ia},named:te,utilFor:{internal(){return{debug:Ss._debug,error:Ss._error,warn:Ss._warn,trace:Ss._trace,named(sa,ms){return Ss.named(sa,ms).utilFor.internal()}}},dev(){return{debug:Ss.debugDev,error:Ss.errorDev,warn:Ss.warnDev,trace:Ss.traceDev,named(sa,ms){return Ss.named(sa,ms).utilFor.dev()}}},public(){return{error:Ss.errorPublic,warn:Ss.warnPublic,debug(sa,ms){Ss._warn('(public "debug" filtered out) '.concat(sa),ms)},trace(sa,ms){Ss._warn('(public "trace" filtered out) '.concat(sa),ms)},named(sa,ms){return Ss.named(sa,ms).utilFor.public()}}}}};return Ss}function LD(b,I){const V=C(C({},this.includes),this.include(I)),te=[];let he="";for(let yt=0;yt<I.names.length;yt++){const{name:Dt,key:rn}=I.names[yt];if(he+=" %c".concat(Dt),te.push(this.style.css(Dt)),rn!=null){const ln="%c#".concat(rn);he+=ln,te.push(this.style.css(ln))}}const ve=this.filtered,Be=this.named.bind(this,I),lt=[he,...te];return gy(ve,I,V,b,lt,FD(lt),Be)}function FD(b){const I=b.slice(0);for(let V=1;V<I.length;V++)I[V]+=";background-color:#e0005a;padding:2px;color:white";return I}function my(b,I){const V=C(C({},this.includes),this.include(I));let te="";for(let lt=0;lt<I.names.length;lt++){const{name:yt,key:Dt}=I.names[lt];te+=" ".concat(yt),Dt!=null&&(te+="#".concat(Dt))}const he=this.filtered,ve=this.named.bind(this,I),Be=[te];return gy(he,I,V,b,Be,Be,ve)}function gy(b,I,V,te,he,ve,Be){const lt=Rs(V,524),yt=Rs(V,522),Dt=Rs(V,521),rn=Rs(V,529),ln=Rs(V,545),In=Rs(V,265),sr=Rs(V,268),er=Rs(V,273),Zr=Rs(V,289),oi=Rs(V,137),jr=Rs(V,145),Vi=Rs(V,73),ya=Rs(V,81),bo=lt?te.error.bind(te,...he):b.bind(I,524),Bo=yt?te.error.bind(te,...he):b.bind(I,522),Qi=Dt?te.error.bind(te,...he):b.bind(I,521),ia=rn?te.error.bind(te,...he):b.bind(I,529),p0=ln?te.error.bind(te,...he):b.bind(I,545),El=sr?te.warn.bind(te,...ve):b.bind(I,268),nd=In?te.warn.bind(te,...he):b.bind(I,265),rd=er?te.warn.bind(te,...he):b.bind(I,273),th=Zr?te.warn.bind(te,...he):b.bind(I,273),ru=oi?te.info.bind(te,...he):b.bind(I,137),Ia=jr?te.info.bind(te,...he):b.bind(I,145),Ss=Vi?te.debug.bind(te,...he):b.bind(I,73),sa=ya?te.debug.bind(te,...he):b.bind(I,81),ms={_hmm:bo,_todo:Bo,_error:Qi,errorDev:ia,errorPublic:p0,_kapow:El,_warn:nd,warnDev:rd,warnPublic:th,_debug:ru,debugDev:Ia,_trace:Ss,traceDev:sa,lazy:{_hmm:lt?bs(bo):bo,_todo:yt?bs(Bo):Bo,_error:Dt?bs(Qi):Qi,errorDev:rn?bs(ia):ia,errorPublic:ln?bs(p0):p0,_kapow:sr?bs(El):El,_warn:In?bs(nd):nd,warnDev:er?bs(rd):rd,warnPublic:Zr?bs(th):th,_debug:oi?bs(ru):ru,debugDev:jr?bs(Ia):Ia,_trace:Vi?bs(Ss):Ss,traceDev:ya?bs(sa):sa},named:Be,utilFor:{internal(){return{debug:ms._debug,error:ms._error,warn:ms._warn,trace:ms._trace,named(Ks,cf){return ms.named(Ks,cf).utilFor.internal()}}},dev(){return{debug:ms.debugDev,error:ms.errorDev,warn:ms.warnDev,trace:ms.traceDev,named(Ks,cf){return ms.named(Ks,cf).utilFor.dev()}}},public(){return{error:ms.errorPublic,warn:ms.warnPublic,debug(Ks,cf){ms._warn('(public "debug" filtered out) '.concat(Ks),cf)},trace(Ks,cf){ms._warn('(public "trace" filtered out) '.concat(Ks),cf)},named(Ks,cf){return ms.named(Ks,cf).utilFor.public()}}}}};return ms}var _M=vb(console,{});_M.configureLogging({dev:!0,min:64});var uv=_M.getLogger().named("Theatre.js (default logger)").utilFor.dev(),yb=new WeakMap;function xM(b){const I=yb.get(b);if(I)return I;const V=new Map;return yb.set(b,V),_b([],b,V),V}function _b(b,I,V){for(const[te,he]of Object.entries(I.props))if(!fy(he)){const ve=[...b,te];V.set(JSON.stringify(ve),V.size),xb(ve,he,V)}for(const[te,he]of Object.entries(I.props))if(fy(he)){const ve=[...b,te];V.set(JSON.stringify(ve),V.size),xb(ve,he,V)}}function xb(b,I,V){if(I.type==="compound")_b(b,I,V);else{if(I.type==="enum")throw new Error("Enums aren't supported yet");V.set(JSON.stringify(b),V.size)}}function bb(b){return typeof b=="object"&&b!==null&&Object.keys(b).length===0}var bM=class{constructor(b,I,V,te,he){this.sheetTemplate=b,A(this,"address"),A(this,"type","Theatre_SheetObjectTemplate"),A(this,"_config"),A(this,"_temp_actions_atom"),A(this,"_cache",new sc),A(this,"project"),A(this,"pointerToSheetState"),A(this,"pointerToStaticOverrides"),this.address=N(C({},b.address),{objectKey:I}),this._config=new io.Atom(te),this._temp_actions_atom=new io.Atom(he),this.project=b.project,this.pointerToSheetState=this.sheetTemplate.project.pointers.historic.sheetsById[this.address.sheetId],this.pointerToStaticOverrides=this.pointerToSheetState.staticOverrides.byObject[this.address.objectKey]}get staticConfig(){return this._config.get()}get configPointer(){return this._config.pointer}get _temp_actions(){return this._temp_actions_atom.get()}get _temp_actionsPointer(){return this._temp_actions_atom.pointer}createInstance(b,I,V){return this._config.set(V),new DD(b,this,I)}reconfigure(b){this._config.set(b)}_temp_setActions(b){this._temp_actions_atom.set(b)}getDefaultValues(){return this._cache.get("getDefaultValues()",()=>(0,io.prism)(()=>{const b=(0,io.val)(this.configPointer);return G4(b)}))}getStaticValues(){return this._cache.get("getStaticValues",()=>(0,io.prism)(()=>{var b;const I=(b=(0,io.val)(this.pointerToStaticOverrides))!=null?b:{};return(0,io.val)(this.configPointer).deserializeAndSanitize(I)||{}}))}getArrayOfValidSequenceTracks(){return this._cache.get("getArrayOfValidSequenceTracks",()=>(0,io.prism)(()=>{const b=this.project.pointers.historic.sheetsById[this.address.sheetId],I=(0,io.val)(b.sequence.tracksByObject[this.address.objectKey].trackIdByPropPath);if(!I)return Ie;const V=[];if(!I)return Ie;const te=(0,io.val)(this.configPointer),he=Object.entries(I);for(const[Be,lt]of he){const yt=SM(Be);if(!yt)continue;const Dt=py(te,yt);Dt&&kD(Dt)&&V.push({pathToProp:yt,trackId:lt})}const ve=xM(te);return V.sort((Be,lt)=>{const yt=Be.pathToProp,Dt=lt.pathToProp,rn=ve.get(JSON.stringify(yt)),ln=ve.get(JSON.stringify(Dt));return rn>ln?1:-1}),V.length===0?Ie:V}))}getMapOfValidSequenceTracks_forStudio(){return this._cache.get("getMapOfValidSequenceTracks_forStudio",()=>(0,io.prism)(()=>{const b=(0,io.val)(this.getArrayOfValidSequenceTracks());let I={};for(const{pathToProp:V,trackId:te}of b)Bh(I,V,te);return I}))}getStaticButNotSequencedOverrides(){return this._cache.get("getStaticButNotSequencedOverrides",()=>(0,io.prism)(()=>{const b=(0,io.val)(this.getStaticValues()),I=(0,io.val)(this.getArrayOfValidSequenceTracks()),V=Wa(b);for(const{pathToProp:te}of I){gM(V,te);let he=te.slice(0,-1);for(;he.length>0;){const ve=Fu(V,he);if(!bb(ve))break;gM(V,he),he=he.slice(0,-1)}}if(!bb(V))return V}))}getDefaultsAtPointer(b){const{path:I}=(0,io.getPointerParts)(b),V=this.getDefaultValues().getValue();return Fu(V,I)}};function SM(b){try{return JSON.parse(b)}catch{uv.warn("property ".concat(JSON.stringify(b)," cannot be parsed. Skipping."));return}}var Sb=an(),wM=vM(b=>JSON.stringify(b));B(oe());var TM=class extends Error{},$3=class extends TM{},wb=an(),Tb=an(),vy=an(),xo=an();function af(){let b,I;const V=new Promise((he,ve)=>{b=Be=>{he(Be),te.status="resolved"},I=Be=>{ve(Be),te.status="rejected"}}),te={resolve:b,reject:I,promise:V,status:"pending"};return te}var UD=()=>{},dv=UD,EM=an(),MM=class{constructor(){A(this,"_stopPlayCallback",dv),A(this,"_state",new EM.Atom({position:0,playing:!1})),A(this,"statePointer"),this.statePointer=this._state.pointer}destroy(){}pause(){this._stopPlayCallback(),this.playing=!1,this._stopPlayCallback=dv}gotoPosition(b){this._updatePositionInState(b)}_updatePositionInState(b){this._state.setByPointer(I=>I.position,b)}getCurrentPosition(){return this._state.get().position}get playing(){return this._state.get().playing}set playing(b){this._state.setByPointer(I=>I.playing,b)}play(b,I,V,te,he){this.playing&&this.pause(),this.playing=!0;const ve=I[1]-I[0];{const In=this.getCurrentPosition();In<I[0]||In>I[1]?te==="normal"||te==="alternate"?this._updatePositionInState(I[0]):(te==="reverse"||te==="alternateReverse")&&this._updatePositionInState(I[1]):te==="normal"||te==="alternate"?In===I[1]&&this._updatePositionInState(I[0]):In===I[0]&&this._updatePositionInState(I[1])}const Be=af(),lt=he.time,yt=ve*b;let Dt=this.getCurrentPosition()-I[0];(te==="reverse"||te==="alternateReverse")&&(Dt=I[1]-this.getCurrentPosition());const rn=In=>{const er=Math.max(In-lt,0)/1e3,Zr=Math.min(er*V+Dt,yt);if(Zr!==yt){const oi=Math.floor(Zr/ve);let jr=Zr/ve%1*ve;if(te!=="normal")if(te==="reverse")jr=ve-jr;else{const Vi=oi%2===0;te==="alternate"?Vi||(jr=ve-jr):Vi&&(jr=ve-jr)}this._updatePositionInState(jr+I[0]),ln()}else{if(te==="normal")this._updatePositionInState(I[1]);else if(te==="reverse")this._updatePositionInState(I[0]);else{const oi=(b-1)%2===0;te==="alternate"?oi?this._updatePositionInState(I[1]):this._updatePositionInState(I[0]):oi?this._updatePositionInState(I[0]):this._updatePositionInState(I[1])}this.playing=!1,Be.resolve(!0)}};this._stopPlayCallback=()=>{he.offThisOrNextTick(rn),he.offNextTick(rn),this.playing&&Be.resolve(!1)};const ln=()=>he.onNextTick(rn);return he.onThisOrNextTick(rn),Be.promise}playDynamicRange(b,I){this.playing&&this.pause(),this.playing=!0;const V=af(),te=b.keepHot();V.promise.then(te,te);let he=I.time;const ve=lt=>{const yt=Math.max(lt-he,0);he=lt;const Dt=yt/1e3,rn=this.getCurrentPosition(),ln=b.getValue();if(rn<ln[0]||rn>ln[1])this.gotoPosition(ln[0]);else{let In=rn+Dt;In>ln[1]&&(In=ln[0]+(In-ln[1])),this.gotoPosition(In)}Be()};this._stopPlayCallback=()=>{I.offThisOrNextTick(ve),I.offNextTick(ve),V.resolve(!1)};const Be=()=>I.onNextTick(ve);return I.onThisOrNextTick(ve),V.promise}},CM=an(),BD="__TheatreJS_StudioBundle",Eb="__TheatreJS_CoreBundle",AM="__TheatreJS_Notifications",X3=b=>(...I)=>{var V;switch(b){case"success":{uv.debug(I.slice(0,2).join(`
`));break}case"info":{uv.debug(I.slice(0,2).join(`
`));break}case"warning":{uv.warn(I.slice(0,2).join(`
`));break}}return typeof window<"u"?(V=window[AM])==null?void 0:V.notify[b](...I):void 0},l1={warning:X3("warning"),success:X3("success"),info:X3("info"),error:X3("error")};typeof window<"u"&&(window.addEventListener("error",b=>{l1.error("An error occurred","<pre>".concat(b.message,`</pre>

See **console** for details.`))}),window.addEventListener("unhandledrejection",b=>{l1.error("An error occurred","<pre>".concat(b.reason,`</pre>

See **console** for details.`))}));var hv=class{constructor(b,I,V){this._decodedBuffer=b,this._audioContext=I,this._nodeDestination=V,A(this,"_mainGain"),A(this,"_state",new CM.Atom({position:0,playing:!1})),A(this,"statePointer"),A(this,"_stopPlayCallback",dv),this.statePointer=this._state.pointer,this._mainGain=this._audioContext.createGain(),this._mainGain.connect(this._nodeDestination)}playDynamicRange(b,I){const V=af();this._playing&&this.pause(),this._playing=!0;let te;const he=()=>{te==null||te(),te=this._loopInRange(b.getValue(),I).stop},ve=b.onStale(he);return he(),this._stopPlayCallback=()=>{te==null||te(),ve(),V.resolve(!1)},V.promise}_loopInRange(b,I){let te=this.getCurrentPosition();const he=b[1]-b[0];te<b[0]||te>b[1]?this._updatePositionInState(b[0]):te===b[1]&&this._updatePositionInState(b[0]),te=this.getCurrentPosition();const ve=this._audioContext.createBufferSource();ve.buffer=this._decodedBuffer,ve.connect(this._mainGain),ve.playbackRate.value=1,ve.loop=!0,ve.loopStart=b[0],ve.loopEnd=b[1];const Be=I.time;let lt=te-b[0];ve.start(0,te);const yt=ln=>{let Zr=(Math.max(ln-Be,0)/1e3*1+lt)/he%1*he;this._updatePositionInState(Zr+b[0]),Dt()},Dt=()=>I.onNextTick(yt);return I.onThisOrNextTick(yt),{stop:()=>{ve.stop(),ve.disconnect(),I.offThisOrNextTick(yt),I.offNextTick(yt)}}}get _playing(){return this._state.get().playing}set _playing(b){this._state.setByPointer(I=>I.playing,b)}destroy(){}pause(){this._stopPlayCallback(),this._playing=!1,this._stopPlayCallback=dv}gotoPosition(b){this._updatePositionInState(b)}_updatePositionInState(b){this._state.reduce(I=>N(C({},I),{position:b}))}getCurrentPosition(){return this._state.get().position}play(b,I,V,te,he){this._playing&&this.pause(),this._playing=!0;let ve=this.getCurrentPosition();const Be=I[1]-I[0];if(te!=="normal")throw new $3('Audio-controlled sequences can only be played in the "normal" direction. '+"'".concat(te,"' given."));ve<I[0]||ve>I[1]?this._updatePositionInState(I[0]):ve===I[1]&&this._updatePositionInState(I[0]),ve=this.getCurrentPosition();const lt=af(),yt=this._audioContext.createBufferSource();yt.buffer=this._decodedBuffer,yt.connect(this._mainGain),yt.playbackRate.value=V,b>1e3&&(l1.warning("Can't play sequences with audio more than 1000 times","The sequence will still play, but only 1000 times. The `iterationCount: ".concat(b,"` provided to `sequence.play()`\nis too high for a sequence with audio.\n\nTo fix this, either set `iterationCount` to a lower value, or remove the audio from the sequence."),[{url:"https://www.theatrejs.com/docs/latest/manual/audio",title:"Using Audio"},{url:"https://www.theatrejs.com/docs/latest/api/core#sequence.attachaudio",title:"Audio API"}]),b=1e3),b>1&&(yt.loop=!0,yt.loopStart=I[0],yt.loopEnd=I[1]);const Dt=he.time;let rn=ve-I[0];const ln=Be*b;yt.start(0,ve,ln-rn);const In=Zr=>{const jr=Math.max(Zr-Dt,0)/1e3,Vi=Math.min(jr*V+rn,ln);if(Vi!==ln){let ya=Vi/Be%1*Be;this._updatePositionInState(ya+I[0]),er()}else this._updatePositionInState(I[1]),this._playing=!1,sr(),lt.resolve(!0)},sr=()=>{yt.stop(),yt.disconnect()};this._stopPlayCallback=()=>{sr(),he.offThisOrNextTick(In),he.offNextTick(In),this._playing&&lt.resolve(!1)};const er=()=>he.onNextTick(In);return he.onThisOrNextTick(In),lt.promise}},PM=an(),yy=0;function _y(b){var I;const V=Be=>{te.tick(Be)},te=new PM.Ticker({onActive(){var Be;(Be=b==null?void 0:b.start)==null||Be.call(b)},onDormant(){var Be;(Be=b==null?void 0:b.stop)==null||Be.call(b)}}),he={tick:V,id:yy++,name:(I=b==null?void 0:b.name)!=null?I:"CustomRafDriver-".concat(yy),type:"Theatre_RafDriver_PublicAPI"},ve={type:"Theatre_RafDriver_PrivateAPI",publicApi:he,ticker:te,start:b==null?void 0:b.start,stop:b==null?void 0:b.stop};return Ge(he,ve),he}function zD(){let b=null;const te=_y({name:"DefaultCoreRafDriver",start:()=>{if(typeof window<"u"){const he=ve=>{te.tick(ve),b=window.requestAnimationFrame(he)};b=window.requestAnimationFrame(he)}else te.tick(0),setTimeout(()=>te.tick(1),0)},stop:()=>{typeof window<"u"&&b!==null&&window.cancelAnimationFrame(b)}});return te}var fv;function xy(){return fv||VD(zD()),fv}function by(){return xy().ticker}function VD(b){if(fv)throw new Error("`setCoreRafDriver()` is already called.");fv=ce(b)}var RM=class{get type(){return"Theatre_Sequence_PublicAPI"}constructor(b){Ge(this,b)}play(b){const I=ce(this);if(I._project.isReady()){const V=b!=null&&b.rafDriver?ce(b.rafDriver).ticker:by();return I.play(b??{},V)}else{const V=af();return V.resolve(!0),V.promise}}pause(){ce(this).pause()}get position(){return ce(this).position}set position(b){ce(this).position=b}__experimental_getKeyframes(b){return ce(this).getKeyframesOfSimpleProp(b)}async attachAudio(b){const{audioContext:I,destinationNode:V,decodedBuffer:te,gainNode:he}=await IM(b),ve=new hv(te,I,he);return ce(this).replacePlaybackController(ve),{audioContext:I,destinationNode:V,decodedBuffer:te,gainNode:he}}get pointer(){return ce(this).pointer}getMarkerPosition(b){return ce(this).getMarkerPosition(b)}goToAndPlay(b,I){const V=ce(this);if(V._project.isReady()){const te=I!=null&&I.rafDriver?ce(I.rafDriver).ticker:by();return V.goToAndPlay(b,I??{},te)}else{const te=af();return te.resolve(!0),te.promise}}goToAndStop(b){return ce(this).goToAndStop(b)}listen(b,I){return ce(this).listen(b,I)}unlisten(b,I){return ce(this).unlisten(b,I)}addSubSequence(b,I,V){return ce(this).addSubSequence(b,I,V)}removeSubSequence(b){return ce(this).removeSubSequence(b)}updateSubSequence(b,I){return ce(this).updateSubSequence(b,I)}};async function IM(b){function I(){if(b.audioContext)return Promise.resolve(b.audioContext);const Dt=new AudioContext;return Dt.state==="running"||typeof window>"u"?Promise.resolve(Dt):new Promise(rn=>{const ln=()=>{Dt.resume().catch(er=>{console.error(er)})},In=["mousedown","keydown","touchstart"],sr={capture:!0,passive:!1};In.forEach(er=>{window.addEventListener(er,ln,sr)}),Dt.addEventListener("statechange",()=>{Dt.state==="running"&&(In.forEach(er=>{window.removeEventListener(er,ln,sr)}),rn(Dt))})})}async function V(){if(b.source instanceof AudioBuffer)return b.source;const Dt=af();if(typeof b.source!="string")throw new Error("Error validating arguments to sequence.attachAudio(). args.source must either be a string or an instance of AudioBuffer.");let rn;try{rn=await fetch(b.source)}catch(er){throw console.error(er),new Error("Could not fetch '".concat(b.source,"'. Network error logged above."))}let ln;try{ln=await rn.arrayBuffer()}catch(er){throw console.error(er),new Error("Could not read '".concat(b.source,"' as an arrayBuffer."))}(await te).decodeAudioData(ln,Dt.resolve,Dt.reject);let sr;try{sr=await Dt.promise}catch(er){throw console.error(er),new Error("Could not decode ".concat(b.source," as an audio file."))}return sr}const te=I(),he=V(),[ve,Be]=await Promise.all([te,he]),lt=b.destinationNode||ve.destination,yt=ve.createGain();return yt.connect(lt),{audioContext:ve,decodedBuffer:Be,gainNode:yt,destinationNode:lt}}var NM=GD("Theatre_SheetObject");function GD(b){return I=>typeof I=="object"&&!!I&&I.type===b}var jD=class{constructor(b,I,V,te,he){this._project=b,this._sheet=I,this._lengthD=V,this._subUnitsPerUnitD=te,A(this,"address"),A(this,"publicApi"),A(this,"_playbackControllerBox"),A(this,"_prismOfStatePointer"),A(this,"_positionD"),A(this,"_positionFormatterD"),A(this,"_playableRangeD"),A(this,"_eventListeners",new Map),A(this,"_lastProcessedPosition",-1),A(this,"_processedEvents",new Set),A(this,"pointer",(0,vy.pointer)({root:this,path:[]})),A(this,"$$isPointerToPrismProvider",!0),A(this,"_logger"),A(this,"closestGridPosition",ve=>{const lt=1/this.subUnitsPerUnit;return parseFloat((Math.round(ve/lt)*lt).toFixed(3))}),this._logger=b._logger.named("Sheet",I.address.sheetId).named("Instance",I.address.sheetInstanceId),this.address=N(C({},this._sheet.address),{sequenceName:"default"}),this.publicApi=new RM(this),this._playbackControllerBox=new Tb.Atom(he??new MM),this._prismOfStatePointer=(0,xo.prism)(()=>this._playbackControllerBox.prism.getValue().statePointer),this._positionD=(0,xo.prism)(()=>{const ve=this._prismOfStatePointer.getValue();return(0,xo.val)(ve.position)}),this._positionFormatterD=(0,xo.prism)(()=>{const ve=(0,xo.val)(this._subUnitsPerUnitD);return new Mb(ve)}),this._positionD.onStale(()=>{const ve=this._positionD.getValue();this._processEventsForPositionChange(this._lastProcessedPosition,ve),this._processSubSequencesForPositionChange(this._lastProcessedPosition,ve),this._lastProcessedPosition=ve})}get type(){return"Theatre_Sequence"}listen(b,I){this._eventListeners.has(b)||this._eventListeners.set(b,new Set),this._eventListeners.get(b).add(I)}unlisten(b,I){const V=this._eventListeners.get(b);V&&(V.delete(I),V.size===0&&this._eventListeners.delete(b))}_processEventsForPositionChange(b,I){const V=this._getEvents();if(!V||V.length===0)return;const te=this.length;if(b>I&&b>te*.8&&I<te*.2){this._processedEvents.clear();return}const ve=Math.min(b,I),Be=Math.max(b,I);Math.abs(I-b)>.1&&this._processedEvents.clear();for(const lt of V)if(lt.position>ve&&lt.position<=Be){const yt="".concat(lt.id,"-").concat(lt.position);if(this._processedEvents.has(yt))continue;if(lt.name==="goTo"||this._processedEvents.add(yt),this._triggerEvent(lt),lt.name==="stop"){requestAnimationFrame(()=>{this.pause(),this._playbackControllerBox.get().gotoPosition(lt.position)});return}else if(lt.name==="goTo"&&lt.value!==void 0){requestAnimationFrame(()=>{if(this._processedEvents.clear(),typeof lt.value=="string"){const rn=this.getMarkerPosition(lt.value);rn!==void 0&&this._gotoPositionWithoutPausing(rn)}else typeof lt.value=="number"&&this._gotoPositionWithoutPausing(lt.value)});return}}}_triggerEvent(b){const I=this._eventListeners.get(b.name);I&&I.forEach(V=>{try{V(b)}catch(te){console.error("Error in sequence event listener:",te)}})}_processSubSequencesForPositionChange(b,I){var V,te;const he=this._getSubSequences();if(!(!he||he.length===0))for(const ve of he){const Be=ve.position,lt=(V=ve.duration)!=null?V:this._getSubSequenceDuration(ve.sheetId),yt=(te=ve.timeScale)!=null?te:1,Dt=Be+lt/yt;if(I>=Be&&I<=Dt){const ln=(I-Be)*yt;try{const sr=this._project.getOrCreateSheet(ve.sheetId,"default").getSequence();sr&&"_gotoPositionWithoutPausing"in sr&&sr._gotoPositionWithoutPausing(ln)}catch{this._logger._error("Sub-sequence references non-existent sheet: ".concat(ve.sheetId))}}}}_getSubSequenceDuration(b){var I;try{const te=this._project.getOrCreateSheet(b,"default").getSequence();return(I=te==null?void 0:te.length)!=null?I:0}catch{return 0}}_getEvents(){const b=this._project.pointers.historic.sheetsById[this._sheet.address.sheetId],I=(0,xo.val)(b.sequence);return(I==null?void 0:I.events)||[]}_getSubSequences(){const b=this._project.pointers.historic.sheetsById[this._sheet.address.sheetId],I=(0,xo.val)(b.sequence);return(I==null?void 0:I.subSequences)||[]}pointerToPrism(b){const{path:I}=(0,wb.getPointerParts)(b);if(I.length===0)return(0,xo.prism)(()=>({length:(0,xo.val)(this.pointer.length),playing:(0,xo.val)(this.pointer.playing),position:(0,xo.val)(this.pointer.position),subUnitsPerUnit:(0,xo.val)(this.pointer.subUnitsPerUnit)}));if(I.length>1)return(0,xo.prism)(()=>{});const[V]=I;return V==="length"?this._lengthD:V==="subUnitsPerUnit"?this._subUnitsPerUnitD:V==="position"?this._positionD:V==="playing"?(0,xo.prism)(()=>(0,xo.val)(this._prismOfStatePointer.getValue().playing)):(0,xo.prism)(()=>{})}getKeyframesOfSimpleProp(b){const{path:I,root:V}=(0,wb.getPointerParts)(b);if(!NM(V))throw new $3("Argument prop must be a pointer to a SheetObject property");const te=(0,xo.val)(this._project.pointers.historic.sheetsById[this._sheet.address.sheetId].sequence.tracksByObject[V.address.objectKey]);if(!te)return[];const{trackData:he,trackIdByPropPath:ve}=te,Be=wM(I),lt=ve[Be];if(!lt)return[];const yt=he[lt];return yt?yt.keyframes:[]}get positionFormatter(){return this._positionFormatterD.getValue()}get prismOfStatePointer(){return this._prismOfStatePointer}get length(){return this._lengthD.getValue()}get positionPrism(){return this._positionD}get position(){return this._playbackControllerBox.get().getCurrentPosition()}get subUnitsPerUnit(){return this._subUnitsPerUnitD.getValue()}get positionSnappedToGrid(){return this.closestGridPosition(this.position)}set position(b){let I=b;this.pause(),I>this.length&&(I=this.length);const V=this.length;this._playbackControllerBox.get().gotoPosition(I>V?V:I)}_gotoPositionWithoutPausing(b){let I=b;I>this.length&&(I=this.length);const V=this.length;this._playbackControllerBox.get().gotoPosition(I>V?V:I)}getDurationCold(){return this._lengthD.getValue()}get playing(){return(0,xo.val)(this._playbackControllerBox.get().statePointer.playing)}_makeRangeFromSequenceTemplate(){return(0,xo.prism)(()=>[0,(0,xo.val)(this._lengthD)])}playDynamicRange(b,I){return this._playbackControllerBox.get().playDynamicRange(b,I)}async play(b,I){const V=this.length,te=b&&b.range?b.range:[0,V],he=b&&typeof b.iterationCount=="number"?b.iterationCount:1,ve=b&&typeof b.rate<"u"?b.rate:1,Be=b&&b.direction?b.direction:"normal";return await this._play(he,[te[0],te[1]],ve,Be,I)}_play(b,I,V,te,he){return this._playbackControllerBox.get().play(b,I,V,te,he)}pause(){this._playbackControllerBox.get().pause()}replacePlaybackController(b){this.pause();const I=this._playbackControllerBox.get();this._playbackControllerBox.set(b);const V=I.getCurrentPosition();I.destroy(),b.gotoPosition(V)}getMarkerPosition(b){const I=this._project.pointers.historic.sheetsById[this._sheet.address.sheetId],V=(0,xo.val)(I.sequence.markers);if(!V)return;let te=V.find(he=>he.label===b);return te||(te=V.find(he=>{var ve;return((ve=he.label)==null?void 0:ve.toLowerCase())===b.toLowerCase()})),te||(te=V.find(he=>{var ve;return(ve=he.label)==null?void 0:ve.includes(b)})),te==null?void 0:te.position}async goToAndPlay(b,I,V){const te=this.getMarkerPosition(b);if(te===void 0)throw new Error('Marker "'.concat(b,'" not found in sequence "').concat(this._sheet.address.sheetId,'"'));return this.position=te,this.play(I,V)}goToAndStop(b){const I=this.getMarkerPosition(b);if(I===void 0)throw new Error('Marker "'.concat(b,'" not found in sequence "').concat(this._sheet.address.sheetId,'"'));this.position=I}addSubSequence(b,I,V){throw new Error("addSubSequence() can only be called when Theatre.js Studio is loaded.")}removeSubSequence(b){throw new Error("removeSubSequence() can only be called when Theatre.js Studio is loaded.")}updateSubSequence(b,I){throw new Error("updateSubSequence() can only be called when Theatre.js Studio is loaded.")}},Mb=class{constructor(b){this._fps=b}formatSubUnitForGrid(b){const I=b%1,V=1/this._fps;return Math.round(I/V)+"f"}formatFullUnitForGrid(b){let I=b,V="";if(I>=Tg){const he=Math.floor(I/Tg);V+=he+"h",I=I%Tg}if(I>=wg){const he=Math.floor(I/wg);V+=he+"m",I=I%wg}if(I>=c1){const he=Math.floor(I/c1);V+=he+"s",I=I%c1}const te=1/this._fps;if(I>=te){const he=Math.floor(I/te);V+=he+"f",I=I%te}return V.length===0?"0s":V}formatForPlayhead(b){let I=b,V="";if(I>=Tg){const he=Math.floor(I/Tg);V+=cv(he.toString(),2,"0")+"h",I=I%Tg}if(I>=wg){const he=Math.floor(I/wg);V+=cv(he.toString(),2,"0")+"m",I=I%wg}else V.length>0&&(V+="00m");if(I>=c1){const he=Math.floor(I/c1);V+=cv(he.toString(),2,"0")+"s",I=I%c1}else V+="00s";const te=1/this._fps;if(I>=te){const he=Math.round(I/te);V+=cv(he.toString(),2,"0")+"f",I=I%te}else I/te>.98?(V+=cv("1",2,"0")+"f",I=I%te):V+="00f";return V.length===0?"00s00f":V}formatBasic(b){return b.toFixed(2)+"s"}},c1=1,wg=c1*60,Tg=wg*60,Cb={};U(Cb,{boolean:()=>jM,compound:()=>Ib,file:()=>YD,image:()=>UM,number:()=>zM,rgba:()=>QD,string:()=>WM,stringLiteral:()=>mv});function kM(b,I){return b.length<=I?b:b.substr(0,I-3)+"..."}var Ab=b=>typeof b=="string"?'string("'.concat(kM(b,10),'")'):typeof b=="number"?"number(".concat(kM(String(b),10),")"):b===null?"null":b===void 0?"undefined":typeof b=="boolean"?String(b):Array.isArray(b)?"array":typeof b=="object"?"object":"unknown",Pb=Ab;function HD(b,{removeAlphaIfOpaque:I=!1}={}){const V=(b.a*255|256).toString(16).slice(1),te=(b.r*255|256).toString(16).slice(1)+(b.g*255|256).toString(16).slice(1)+(b.b*255|256).toString(16).slice(1)+(I&&V==="ff"?"":V);return"#".concat(te)}function Sy(b){return N(C({},b),{toString(){return HD(this,{removeAlphaIfOpaque:!0})}})}function WD(b){return Object.fromEntries(Object.entries(b).map(([I,V])=>[I,Wd(V,0,1)]))}function qD(b){function I(V){return V>=.0031308?1.055*V**(1/2.4)-.055:12.92*V}return WD({r:I(b.r),g:I(b.g),b:I(b.b),a:b.a})}function Rb(b){function I(V){return V>=.04045?((V+.055)/(1+.055))**2.4:V/12.92}return{r:I(b.r),g:I(b.g),b:I(b.b),a:b.a}}function DM(b){let I=.4122214708*b.r+.5363325363*b.g+.0514459929*b.b,V=.2119034982*b.r+.6806995451*b.g+.1073969566*b.b,te=.0883024619*b.r+.2817188376*b.g+.6299787005*b.b,he=Math.cbrt(I),ve=Math.cbrt(V),Be=Math.cbrt(te);return{L:.2104542553*he+.793617785*ve-.0040720468*Be,a:1.9779984951*he-2.428592205*ve+.4505937099*Be,b:.0259040371*he+.7827717662*ve-.808675766*Be,alpha:b.a}}function $D(b){let I=b.L+.3963377774*b.a+.2158037573*b.b,V=b.L-.1055613458*b.a-.0638541728*b.b,te=b.L-.0894841775*b.a-1.291485548*b.b,he=I*I*I,ve=V*V*V,Be=te*te*te;return{r:4.0767416621*he-3.3077115913*ve+.2309699292*Be,g:-1.2684380046*he+2.6097574011*ve-.3413193965*Be,b:-.0041960863*he-.7034186147*ve+1.707614701*Be,a:b.alpha}}var Qd=Symbol("TheatrePropType_Basic");function OM(b){return typeof b=="object"&&!!b&&b[Qd]==="TheatrePropType"}function XD(b){if(typeof b=="number")return zM(b);if(typeof b=="boolean")return jM(b);if(typeof b=="string")return WM(b);if(typeof b=="object"&&b){if(OM(b))return b;if(As(b))return Ib(b);throw new $3("This value is not a valid prop type: ".concat(Pb(b)))}else throw new $3("This value is not a valid prop type: ".concat(Pb(b)))}function LM(b){const I={};for(const V of Object.keys(b)){const te=b[V];OM(te)?I[V]=te:I[V]=XD(te)}return I}var Ib=(b,I={})=>{const V=LM(b),te=new WeakMap;return{type:"compound",props:V,valueType:null,[Qd]:"TheatrePropType",label:I.label,default:Ar(V,ve=>ve.default),deserializeAndSanitize:ve=>{if(typeof ve!="object"||!ve)return;if(te.has(ve))return te.get(ve);const Be={};let lt=!1;for(const[yt,Dt]of Object.entries(V))if(Object.prototype.hasOwnProperty.call(ve,yt)){const rn=Dt.deserializeAndSanitize(ve[yt]);rn!=null&&(lt=!0,Be[yt]=rn)}if(te.set(ve,Be),lt)return Be}}},YD=(b,I={})=>{const V=(te,he,ve)=>{var Be;return{type:"file",id:((Be=I.interpolate)!=null?Be:pv)(te.id,he.id,ve)}};return{type:"file",default:{type:"file",id:b},valueType:null,[Qd]:"TheatrePropType",label:I.label,interpolate:V,deserializeAndSanitize:FM}},FM=b=>{if(!b)return;let I=!0;if(typeof b.id!="string"&&![null,void 0].includes(b.id)&&(I=!1),b.type!=="file"&&(I=!1),!!I)return b},UM=(b,I={})=>{const V=(te,he,ve)=>{var Be;return{type:"image",id:((Be=I.interpolate)!=null?Be:pv)(te.id,he.id,ve)}};return{type:"image",default:{type:"image",id:b},valueType:null,[Qd]:"TheatrePropType",label:I.label,interpolate:V,deserializeAndSanitize:BM}},BM=b=>{if(!b)return;let I=!0;if(typeof b.id!="string"&&![null,void 0].includes(b.id)&&(I=!1),b.type!=="image"&&(I=!1),!!I)return b},zM=(b,I={})=>{var V;return N(C({type:"number",valueType:0,default:b,[Qd]:"TheatrePropType"},I||{}),{label:I.label,nudgeFn:(V=I.nudgeFn)!=null?V:eO,nudgeMultiplier:typeof I.nudgeMultiplier=="number"?I.nudgeMultiplier:void 0,interpolate:ZD,deserializeAndSanitize:KD(I.range)})},KD=b=>b?I=>{if(typeof I=="number"&&isFinite(I))return Wd(I,b[0],b[1])}:VM,VM=b=>typeof b=="number"&&isFinite(b)?b:void 0,ZD=(b,I,V)=>b+V*(I-b),QD=(b={r:0,g:0,b:0,a:1},I={})=>{const V={};for(const te of["r","g","b","a"])V[te]=Math.min(Math.max(b[te],0),1);return{type:"rgba",valueType:null,default:Sy(V),[Qd]:"TheatrePropType",label:I.label,interpolate:JD,deserializeAndSanitize:GM}},GM=b=>{if(!b)return;let I=!0;for(const te of["r","g","b","a"])(!Object.prototype.hasOwnProperty.call(b,te)||typeof b[te]!="number")&&(I=!1);if(!I)return;const V={};for(const te of["r","g","b","a"])V[te]=Math.min(Math.max(b[te],0),1);return Sy(V)},JD=(b,I,V)=>{const te=DM(Rb(b)),he=DM(Rb(I)),ve={L:(1-V)*te.L+V*he.L,a:(1-V)*te.a+V*he.a,b:(1-V)*te.b+V*he.b,alpha:(1-V)*te.alpha+V*he.alpha},Be=qD($D(ve));return Sy(Be)},jM=(b,I={})=>{var V;return{type:"boolean",default:b,valueType:null,[Qd]:"TheatrePropType",label:I.label,interpolate:(V=I.interpolate)!=null?V:pv,deserializeAndSanitize:HM}},HM=b=>typeof b=="boolean"?b:void 0;function pv(b){return b}var WM=(b,I={})=>{var V;return{type:"string",default:b,valueType:null,[Qd]:"TheatrePropType",label:I.label,interpolate:(V=I.interpolate)!=null?V:pv,deserializeAndSanitize:Y3}};function Y3(b){return typeof b=="string"?b:void 0}function mv(b,I,V={}){var te,he;return{type:"stringLiteral",default:b,valuesAndLabels:C({},I),[Qd]:"TheatrePropType",valueType:null,as:(te=V.as)!=null?te:"menu",label:V.label,interpolate:(he=V.interpolate)!=null?he:pv,deserializeAndSanitize(ve){if(typeof ve=="string"&&Object.prototype.hasOwnProperty.call(I,ve))return ve}}}var eO=({config:b,deltaX:I,deltaFraction:V,magnitude:te})=>{var he;const{range:ve}=b;return!b.nudgeMultiplier&&ve&&!ve.includes(1/0)&&!ve.includes(-1/0)?V*(ve[1]-ve[0])*te:I*te*((he=b.nudgeMultiplier)!=null?he:1)},qM=b=>b.replace(/^[\s\/]*/,"").replace(/[\s\/]*$/,"").replace(/\s*\/\s*/g," / ");function wy(b,I){return qM(b)}B(G());var tO=class{get type(){return"Theatre_Sheet_PublicAPI"}constructor(b){Ge(this,b)}object(b,I,V){const te=ce(this),he=wy(b),ve=te.getObject(he),Be=null,lt=V==null?void 0:V.__actions__THIS_API_IS_UNSTABLE_AND_WILL_CHANGE_IN_THE_NEXT_VERSION;if(ve)return lt&&ve.template._temp_setActions(lt),ve.publicApi;{const yt=Ib(I);return te.createObject(he,Be,yt,lt).publicApi}}__experimental_getExistingObject(b){const I=ce(this),V=wy(b),te=I.getObject(V);return te==null?void 0:te.publicApi}get sequence(){return ce(this).getSequence().publicApi}get project(){return ce(this).project.publicApi}get address(){return C({},ce(this).address)}detachObject(b){const I=ce(this),V=wy(b);if(!I.getObject(V)){l1.warning(`Couldn't delete object "`.concat(V,'"'),'There is no object with key "'.concat(V,`".

To fix this, make sure you are calling \`sheet.deleteObject("`).concat(V,'")` with the correct key.')),console.warn('Object key "'.concat(V,'" does not exist.'));return}I.deleteObject(V)}},K3=an(),nO=class{constructor(b,I){this.template=b,this.instanceId=I,A(this,"_objects",new K3.Atom({})),A(this,"_sequence"),A(this,"address"),A(this,"publicApi"),A(this,"project"),A(this,"objectsP",this._objects.pointer),A(this,"type","Theatre_Sheet"),A(this,"_logger"),this._logger=b.project._logger.named("Sheet",I),this._logger._trace("creating sheet"),this.project=b.project,this.address=N(C({},b.address),{sheetInstanceId:this.instanceId}),this.publicApi=new tO(this)}createObject(b,I,V,te={}){const ve=this.template.getObjectTemplate(b,I,V,te).createInstance(this,I,V);return this._objects.setByPointer(Be=>Be[b],ve),ve}getObject(b){return this._objects.get()[b]}deleteObject(b){this._objects.reduce(I=>{const V=C({},I);return delete V[b],V})}getSequence(){if(!this._sequence){const b=(0,K3.prism)(()=>{const V=(0,K3.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.length);return $M(V)}),I=(0,K3.prism)(()=>{const V=(0,K3.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.subUnitsPerUnit);return XM(V)});this._sequence=new jD(this.template.project,this,b,I)}return this._sequence}},$M=b=>typeof b=="number"&&isFinite(b)&&b>0?b:10,XM=b=>typeof b=="number"&&dr(b)&&b>=1&&b<=1e3?b:30,rO=class{constructor(b,I){this.project=b,A(this,"type","Theatre_SheetTemplate"),A(this,"address"),A(this,"_instances",new Sb.Atom({})),A(this,"instancesP",this._instances.pointer),A(this,"_objectTemplates",new Sb.Atom({})),A(this,"objectTemplatesP",this._objectTemplates.pointer),this.address=N(C({},b.address),{sheetId:I})}getInstance(b){let I=this._instances.get()[b];return I||(I=new nO(this,b),this._instances.setByPointer(V=>V[b],I)),I}getObjectTemplate(b,I,V,te){let he=this._objectTemplates.get()[b];return he||(he=new bM(this,b,I,V,te),this._objectTemplates.setByPointer(ve=>ve[b],he)),he}},Nb=an(),Ty=an(),YM=b=>new Promise(I=>setTimeout(I,b)),iO=YM;function _c(b){for(var I=arguments.length,V=Array(I>1?I-1:0),te=1;te<I;te++)V[te-1]=arguments[te];throw Error("[Immer] minified error nr: "+b+(V.length?" "+V.map(function(he){return"'"+he+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Eg(b){return!!b&&!!b[Tl]}function u1(b){return!!b&&(function(I){if(!I||typeof I!="object")return!1;var V=Object.getPrototypeOf(I);if(V===null)return!0;var te=Object.hasOwnProperty.call(V,"constructor")&&V.constructor;return te===Object||typeof te=="function"&&Function.toString.call(te)===Vb}(b)||Array.isArray(b)||!!b[oC]||!!b.constructor[oC]||Db(b)||My(b))}function kb(b){return Eg(b)||_c(23,b),b[Tl].t}function Z3(b,I,V){V===void 0&&(V=!1),Q3(b)===0?(V?Object.keys:Gb)(b).forEach(function(te){V&&typeof te=="symbol"||I(te,b[te],b)}):b.forEach(function(te,he){return I(he,te,b)})}function Q3(b){var I=b[Tl];return I?I.i>3?I.i-4:I.i:Array.isArray(b)?1:Db(b)?2:My(b)?3:0}function Ey(b,I){return Q3(b)===2?b.has(I):Object.prototype.hasOwnProperty.call(b,I)}function sO(b,I){return Q3(b)===2?b.get(I):b[I]}function KM(b,I,V){var te=Q3(b);te===2?b.set(I,V):te===3?(b.delete(I),b.add(V)):b[I]=V}function ZM(b,I){return b===I?b!==0||1/b==1/I:b!=b&&I!=I}function Db(b){return aO&&b instanceof Map}function My(b){return sC&&b instanceof Set}function Jd(b){return b.o||b.t}function Ob(b){if(Array.isArray(b))return Array.prototype.slice.call(b);var I=lO(b);delete I[Tl];for(var V=Gb(I),te=0;te<V.length;te++){var he=V[te],ve=I[he];ve.writable===!1&&(ve.writable=!0,ve.configurable=!0),(ve.get||ve.set)&&(I[he]={configurable:!0,writable:!0,enumerable:ve.enumerable,value:b[he]})}return Object.create(Object.getPrototypeOf(b),I)}function Lb(b,I){return I===void 0&&(I=!1),Cy(b)||Eg(b)||!u1(b)||(Q3(b)>1&&(b.set=b.add=b.clear=b.delete=QM),Object.freeze(b),I&&Z3(b,function(V,te){return Lb(te,!0)},!0)),b}function QM(){_c(2)}function Cy(b){return b==null||typeof b!="object"||Object.isFrozen(b)}function eh(b){var I=jb[b];return I||_c(18,b),I}function Ay(){return e9}function Py(b,I){I&&(eh("Patches"),b.u=[],b.s=[],b.v=I)}function Ry(b){Iy(b),b.p.forEach(oO),b.p=null}function Iy(b){b===e9&&(e9=b.l)}function JM(b){return e9={p:[],l:e9,h:b,m:!0,_:0}}function oO(b){var I=b[Tl];I.i===0||I.i===1?I.j():I.O=!0}function Mg(b,I){I._=I.p.length;var V=I.p[0],te=b!==void 0&&b!==V;return I.h.g||eh("ES5").S(I,b,te),te?(V[Tl].P&&(Ry(I),_c(4)),u1(b)&&(b=J3(I,b),I.l||gv(I,b)),I.u&&eh("Patches").M(V[Tl],b,I.u,I.s)):b=J3(I,V,[]),Ry(I),I.u&&I.v(I.u,I.s),b!==zb?b:void 0}function J3(b,I,V){if(Cy(I))return I;var te=I[Tl];if(!te)return Z3(I,function(ve,Be){return eC(b,te,I,ve,Be,V)},!0),I;if(te.A!==b)return I;if(!te.P)return gv(b,te.t,!0),te.t;if(!te.I){te.I=!0,te.A._--;var he=te.i===4||te.i===5?te.o=Ob(te.k):te.o;Z3(te.i===3?new Set(he):he,function(ve,Be){return eC(b,te,he,ve,Be,V)}),gv(b,he,!1),V&&b.u&&eh("Patches").R(te,V,b.u,b.s)}return te.o}function eC(b,I,V,te,he,ve){if(Eg(he)){var Be=J3(b,he,ve&&I&&I.i!==3&&!Ey(I.D,te)?ve.concat(te):void 0);if(KM(V,te,Be),!Eg(Be))return;b.m=!1}if(u1(he)&&!Cy(he)){if(!b.h.F&&b._<1)return;J3(b,he),I&&I.A.l||gv(b,he)}}function gv(b,I,V){V===void 0&&(V=!1),b.h.F&&b.m&&Lb(I,V)}function vv(b,I){var V=b[Tl];return(V?Jd(V):b)[I]}function tC(b,I){if(I in b)for(var V=Object.getPrototypeOf(b);V;){var te=Object.getOwnPropertyDescriptor(V,I);if(te)return te;V=Object.getPrototypeOf(V)}}function Fb(b){b.P||(b.P=!0,b.l&&Fb(b.l))}function Ny(b){b.o||(b.o=Ob(b.t))}function ky(b,I,V){var te=Db(I)?eh("MapSet").N(I,V):My(I)?eh("MapSet").T(I,V):b.g?function(he,ve){var Be=Array.isArray(he),lt={i:Be?1:0,A:ve?ve.A:Ay(),P:!1,I:!1,D:{},l:ve,t:he,k:null,o:null,j:null,C:!1},yt=lt,Dt=yv;Be&&(yt=[lt],Dt=_v);var rn=Proxy.revocable(yt,Dt),ln=rn.revoke,In=rn.proxy;return lt.k=In,lt.j=ln,In}(I,V):eh("ES5").J(I,V);return(V?V.A:Ay()).p.push(te),te}function nC(b){return Eg(b)||_c(22,b),function I(V){if(!u1(V))return V;var te,he=V[Tl],ve=Q3(V);if(he){if(!he.P&&(he.i<4||!eh("ES5").K(he)))return he.t;he.I=!0,te=rC(V,ve),he.I=!1}else te=rC(V,ve);return Z3(te,function(Be,lt){he&&sO(he.t,Be)===lt||KM(te,Be,I(lt))}),ve===3?new Set(te):te}(b)}function rC(b,I){switch(I){case 2:return new Map(b);case 3:return Array.from(b)}return Ob(b)}var iC,e9,Ub=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",aO=typeof Map<"u",sC=typeof Set<"u",Bb=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",zb=Ub?Symbol.for("immer-nothing"):((iC={})["immer-nothing"]=!0,iC),oC=Ub?Symbol.for("immer-draftable"):"__$immer_draftable",Tl=Ub?Symbol.for("immer-state"):"__$immer_state",Vb=""+Object.prototype.constructor,Gb=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:Object.getOwnPropertyNames,lO=Object.getOwnPropertyDescriptors||function(b){var I={};return Gb(b).forEach(function(V){I[V]=Object.getOwnPropertyDescriptor(b,V)}),I},jb={},yv={get:function(b,I){if(I===Tl)return b;var V=Jd(b);if(!Ey(V,I))return function(he,ve,Be){var lt,yt=tC(ve,Be);return yt?"value"in yt?yt.value:(lt=yt.get)===null||lt===void 0?void 0:lt.call(he.k):void 0}(b,V,I);var te=V[I];return b.I||!u1(te)?te:te===vv(b.t,I)?(Ny(b),b.o[I]=ky(b.A.h,te,b)):te},has:function(b,I){return I in Jd(b)},ownKeys:function(b){return Reflect.ownKeys(Jd(b))},set:function(b,I,V){var te=tC(Jd(b),I);if(te!=null&&te.set)return te.set.call(b.k,V),!0;if(!b.P){var he=vv(Jd(b),I),ve=he==null?void 0:he[Tl];if(ve&&ve.t===V)return b.o[I]=V,b.D[I]=!1,!0;if(ZM(V,he)&&(V!==void 0||Ey(b.t,I)))return!0;Ny(b),Fb(b)}return b.o[I]===V&&typeof V!="number"&&(V!==void 0||I in b.o)||(b.o[I]=V,b.D[I]=!0,!0)},deleteProperty:function(b,I){return vv(b.t,I)!==void 0||I in b.t?(b.D[I]=!1,Ny(b),Fb(b)):delete b.D[I],b.o&&delete b.o[I],!0},getOwnPropertyDescriptor:function(b,I){var V=Jd(b),te=Reflect.getOwnPropertyDescriptor(V,I);return te&&{writable:!0,configurable:b.i!==1||I!=="length",enumerable:te.enumerable,value:V[I]}},defineProperty:function(){_c(11)},getPrototypeOf:function(b){return Object.getPrototypeOf(b.t)},setPrototypeOf:function(){_c(12)}},_v={};Z3(yv,function(b,I){_v[b]=function(){return arguments[0]=arguments[0][0],I.apply(this,arguments)}}),_v.deleteProperty=function(b,I){return yv.deleteProperty.call(this,b[0],I)},_v.set=function(b,I,V){return yv.set.call(this,b[0],I,V,b[0])};var d1=function(){function b(V){var te=this;this.g=Bb,this.F=!0,this.produce=function(he,ve,Be){if(typeof he=="function"&&typeof ve!="function"){var lt=ve;ve=he;var yt=te;return function(sr){var er=this;sr===void 0&&(sr=lt);for(var Zr=arguments.length,oi=Array(Zr>1?Zr-1:0),jr=1;jr<Zr;jr++)oi[jr-1]=arguments[jr];return yt.produce(sr,function(Vi){var ya;return(ya=ve).call.apply(ya,[er,Vi].concat(oi))})}}var Dt;if(typeof ve!="function"&&_c(6),Be!==void 0&&typeof Be!="function"&&_c(7),u1(he)){var rn=JM(te),ln=ky(te,he,void 0),In=!0;try{Dt=ve(ln),In=!1}finally{In?Ry(rn):Iy(rn)}return typeof Promise<"u"&&Dt instanceof Promise?Dt.then(function(sr){return Py(rn,Be),Mg(sr,rn)},function(sr){throw Ry(rn),sr}):(Py(rn,Be),Mg(Dt,rn))}if(!he||typeof he!="object")return(Dt=ve(he))===zb?void 0:(Dt===void 0&&(Dt=he),te.F&&Lb(Dt,!0),Dt);_c(21,he)},this.produceWithPatches=function(he,ve){return typeof he=="function"?function(yt){for(var Dt=arguments.length,rn=Array(Dt>1?Dt-1:0),ln=1;ln<Dt;ln++)rn[ln-1]=arguments[ln];return te.produceWithPatches(yt,function(In){return he.apply(void 0,[In].concat(rn))})}:[te.produce(he,ve,function(yt,Dt){Be=yt,lt=Dt}),Be,lt];var Be,lt},typeof(V==null?void 0:V.useProxies)=="boolean"&&this.setUseProxies(V.useProxies),typeof(V==null?void 0:V.autoFreeze)=="boolean"&&this.setAutoFreeze(V.autoFreeze)}var I=b.prototype;return I.createDraft=function(V){u1(V)||_c(8),Eg(V)&&(V=nC(V));var te=JM(this),he=ky(this,V,void 0);return he[Tl].C=!0,Iy(te),he},I.finishDraft=function(V,te){var he=V&&V[Tl],ve=he.A;return Py(ve,te),Mg(void 0,ve)},I.setAutoFreeze=function(V){this.F=V},I.setUseProxies=function(V){V&&!Bb&&_c(20),this.g=V},I.applyPatches=function(V,te){var he;for(he=te.length-1;he>=0;he--){var ve=te[he];if(ve.path.length===0&&ve.op==="replace"){V=ve.value;break}}var Be=eh("Patches").$;return Eg(V)?Be(V,te):this.produce(V,function(lt){return Be(lt,te.slice(he+1))})},b}(),xc=new d1;xc.produce,xc.produceWithPatches.bind(xc),xc.setAutoFreeze.bind(xc),xc.setUseProxies.bind(xc),xc.applyPatches.bind(xc),xc.createDraft.bind(xc),xc.finishDraft.bind(xc);var cO={currentProjectStateDefinitionVersion:"0.4.0"},lf=cO;async function aC(b,I,V){if(await iO(0),b.transaction(({drafts:te})=>{var he;const ve=I.address.projectId;te.ephemeral.coreByProject[ve]={lastExportedObject:null,loadingState:{type:"loading"}},te.ahistoric.coreByProject[ve]={ahistoricStuff:""};function Be(){te.ephemeral.coreByProject[ve].loadingState={type:"loaded"},te.historic.coreByProject[ve]={sheetsById:{},definitionVersion:lf.currentProjectStateDefinitionVersion,revisionHistory:[]}}function lt(ln){te.ephemeral.coreByProject[ve].loadingState={type:"loaded"},te.historic.coreByProject[ve]=ln}function yt(){te.ephemeral.coreByProject[ve].loadingState={type:"loaded"}}function Dt(ln){te.ephemeral.coreByProject[ve].loadingState={type:"browserStateIsNotBasedOnDiskState",onDiskState:ln}}const rn=(he=kb(te.historic))==null?void 0:he.coreByProject[I.address.projectId];rn?V&&rn.revisionHistory.indexOf(V.revisionHistory[0])==-1?Dt(V):yt():V?lt(V):Be()}),V!=null&&V.sheetsById){const te=I.address.projectId;b.transaction(({stateEditors:he})=>{var ve,Be,lt,yt,Dt,rn,ln,In,sr,er,Zr,oi,jr,Vi,ya,bo,Bo,Qi,ia,p0,El,nd,rd,th;for(const[ru,Ia]of Object.entries(V.sheetsById)){if((ve=Ia==null?void 0:Ia.sequence)!=null&&ve.markers){const Ss=Ia.sequence.markers;(ln=(rn=(Dt=(yt=(lt=(Be=he==null?void 0:he.studio)==null?void 0:Be.historic)==null?void 0:lt.projects)==null?void 0:yt.stateByProjectId)==null?void 0:Dt.stateBySheetId)==null?void 0:rn.sequenceEditor)!=null&&ln.replaceMarkers&&he.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:{projectId:te,sheetId:ru},markers:Ss,snappingFunction:sa=>sa})}if((In=Ia==null?void 0:Ia.sequence)!=null&&In.events){const Ss=Ia.sequence.events;(Vi=(jr=(oi=(Zr=(er=(sr=he==null?void 0:he.studio)==null?void 0:sr.historic)==null?void 0:er.projects)==null?void 0:Zr.stateByProjectId)==null?void 0:oi.stateBySheetId)==null?void 0:jr.sequenceEditor)!=null&&Vi.replaceEvents&&he.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:{projectId:te,sheetId:ru},events:Ss,snappingFunction:sa=>sa})}if((ya=Ia==null?void 0:Ia.sequence)!=null&&ya.subSequences){const Ss=Ia.sequence.subSequences;if((El=(p0=(ia=(Qi=(Bo=(bo=he==null?void 0:he.studio)==null?void 0:bo.historic)==null?void 0:Bo.projects)==null?void 0:Qi.stateByProjectId)==null?void 0:ia.stateBySheetId)==null?void 0:p0.sequenceEditor)!=null&&El.replaceSubSequences){const sa=(th=(rd=(nd=he.studio.historic.projects.stateByProjectId[te])==null?void 0:nd.stateBySheetId[ru])==null?void 0:rd.sequenceEditor)==null?void 0:th.subSequenceSet,ms=sa?Ss.filter(Ks=>!sa.byId[Ks.id]):Ss;ms.length>0&&he.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceSubSequences({sheetAddress:{projectId:te,sheetId:ru},subSequences:ms,snappingFunction:Ks=>Ks})}}}})}}function lC(){}function Hb(b){var I,V;const te=(I=b==null?void 0:b.logging)!=null&&I.internal?(V=b.logging.min)!=null?V:256:1/0,he=te<=128,ve=te<=512,Be=vb(void 0,{_debug:he?console.debug.bind(console,"_coreLogger(TheatreInternalLogger) debug"):lC,_error:ve?console.error.bind(console,"_coreLogger(TheatreInternalLogger) error"):lC});if(b){const{logger:lt,logging:yt}=b;lt&&Be.configureLogger(lt),yt?Be.configureLogging(yt):Be.configureLogging({dev:!1})}return Be.getLogger().named("Theatre")}var uO=class{constructor(b,I={},V){this.config=I,this.publicApi=V,A(this,"pointers"),A(this,"_pointerProxies"),A(this,"address"),A(this,"_studioReadyDeferred"),A(this,"_assetStorageReadyDeferred"),A(this,"_readyPromise"),A(this,"_sheetTemplates",new Ty.Atom({})),A(this,"sheetTemplatesP",this._sheetTemplates.pointer),A(this,"_studio"),A(this,"assetStorage"),A(this,"type","Theatre_Project"),A(this,"_logger");var te;this._logger=Hb({logging:{dev:!0}}).named("Project",b),this._logger.traceDev("creating project"),this.address={projectId:b};const he=new Ty.Atom({ahistoric:{ahistoricStuff:""},historic:(te=I.state)!=null?te:{sheetsById:{},definitionVersion:lf.currentProjectStateDefinitionVersion,revisionHistory:[]},ephemeral:{loadingState:{type:"loaded"},lastExportedObject:null}});this._assetStorageReadyDeferred=af(),this.assetStorage={getAssetUrl:ve=>{var Be;return"".concat((Be=I.assets)==null?void 0:Be.baseUrl,"/").concat(ve)},createAsset:()=>{throw new Error("Please wait for Project.ready to use assets.")}},this._pointerProxies={historic:new Nb.PointerProxy(he.pointer.historic),ahistoric:new Nb.PointerProxy(he.pointer.ahistoric),ephemeral:new Nb.PointerProxy(he.pointer.ephemeral)},this.pointers={historic:this._pointerProxies.historic.pointer,ahistoric:this._pointerProxies.ahistoric.pointer,ephemeral:this._pointerProxies.ephemeral.pointer},ot.add(b,this),this._studioReadyDeferred=af(),this._readyPromise=Promise.all([this._studioReadyDeferred.promise,this._assetStorageReadyDeferred.promise]).then(()=>{}),I.state?setTimeout(()=>{this._studio||(this._studioReadyDeferred.resolve(void 0),this._assetStorageReadyDeferred.resolve(void 0),this._logger._trace("ready deferred resolved with no state"))},0):typeof window>"u"?console.error('Argument config.state in Theatre.getProject("'.concat(b,'", config) is empty. ')+"You can safely ignore this message if you're developing a Next.js/Remix project in development mode. But if you are shipping to your end-users, then you need to set config.state, otherwise your project's state will be empty and nothing will animate. Learn more at https://www.theatrejs.com/docs/latest/manual/projects#state"):setTimeout(()=>{if(!this._studio)throw new Error('Argument config.state in Theatre.getProject("'.concat(b,'", config) is empty. This is fine ')+"while you are using @tomorrowevening/theatre-core along with @tomorrowevening/theatre-studio. But since @tomorrowevening/theatre-studio "+'is not loaded, the state of project "'.concat(b,`" will be empty.

`)+`To fix this, you need to add @tomorrowevening/theatre-studio into the bundle and export the project's state. Learn how to do that at https://www.theatrejs.com/docs/latest/manual/projects#state
`)},1e3)}attachToStudio(b){if(this._studio){if(this._studio!==b)throw new Error("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));console.warn("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));return}this._studio=b,b.initialized.then(async()=>{var I;await aC(b,this,this.config.state),this._pointerProxies.historic.setPointer(b.atomP.historic.coreByProject[this.address.projectId]),this._pointerProxies.ahistoric.setPointer(b.atomP.ahistoric.coreByProject[this.address.projectId]),this._pointerProxies.ephemeral.setPointer(b.atomP.ephemeral.coreByProject[this.address.projectId]),await b.createAssetStorage(this,(I=this.config.assets)==null?void 0:I.baseUrl).then(V=>{this.assetStorage=V,this._assetStorageReadyDeferred.resolve(void 0)}),this._studioReadyDeferred.resolve(void 0)}).catch(I=>{throw console.error(I),I})}get isAttachedToStudio(){return!!this._studio}get ready(){return this._readyPromise}isReady(){return this._studioReadyDeferred.status==="resolved"&&this._assetStorageReadyDeferred.status==="resolved"}getOrCreateSheet(b,I="default"){let V=this._sheetTemplates.get()[b];return V||(V=new rO(this,b),this._sheetTemplates.reduce(te=>N(C({},te),{[b]:V}))),V.getInstance(I)}},dO=class{get type(){return"Theatre_Project_PublicAPI"}constructor(b,I={}){Ge(this,new uO(b,I,this))}get ready(){return ce(this).ready}get isReady(){return ce(this).isReady()}get address(){return C({},ce(this).address)}getAssetUrl(b){if(!this.isReady){console.error("Calling `project.getAssetUrl()` before `project.ready` is resolved, will always return `undefined`. Either use `project.ready.then(() => project.getAssetUrl())` or `await project.ready` before calling `project.getAssetUrl()`.");return}return b.id?ce(this).assetStorage.getAssetUrl(b.id):void 0}sheet(b,I="default"){const V=wy(b);return ce(this).getOrCreateSheet(V,I).publicApi}};B(G());var Wb=an(),qb=an();function cC(b,I={}){const V=ot.get(b);if(V)return V.publicApi;const he=Hb().named("Project",b);return I.state?(hO(b,I.state),he._debug("deep validated config.state on disk")):he._debug("no config.state"),new dO(b,I)}var uC=(b,I)=>{if(Array.isArray(I)||I==null||I.definitionVersion!==lf.currentProjectStateDefinitionVersion)throw new $3("Error validating conf.state in Theatre.getProject(".concat(JSON.stringify(b),", conf). The state seems to be formatted in a way that is unreadable to Theatre.js. Read more at https://www.theatrejs.com/docs/latest/manual/projects#state"))},hO=(b,I)=>{uC(b,I)};function $b(b,I,V){const te=V?ce(V).ticker:by();if((0,Wb.isPointer)(b))return(0,qb.pointerToPrism)(b).onChange(te,I,!0);if((0,qb.isPrism)(b))return b.onChange(te,I,!0);throw new Error("Called onChange(p) where p is neither a pointer nor a prism.")}function Xb(b){if((0,Wb.isPointer)(b))return(0,qb.pointerToPrism)(b).getValue();throw new Error("Called val(p) where p is not a pointer.")}var fO=class{constructor(){A(this,"_studio")}get type(){return"Theatre_CoreBundle"}get version(){return"1.0.19"}getBitsForStudio(b,I){if(this._studio)throw new Error("@tomorrowevening/theatre-core is already attached to @tomorrowevening/theatre-studio");this._studio=b;const V={projectsP:ot.atom.pointer.projects,privateAPI:ce,coreExports:Me,getCoreRafDriver:xy};I(V)}};pO();function pO(){if(typeof window>"u")return;const b=window[Eb];if(typeof b<"u")throw typeof b=="object"&&b&&typeof b.version=="string"?new Error(`It seems that the module '@tomorrowevening/theatre-core' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@tomorrowevening/theatre-core' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(Eb," seems to be already set by a module other than @tomorrowevening/theatre-core."));const I=new fO;window[Eb]=I;const V=window[BD];V&&V!==null&&V.type==="Theatre_StudioBundle"&&V.registerCoreBundle(I)}/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)
		*/}(RT,RT.exports)),RT.exports}PT.exports;var J3e;function tNe(){return J3e||(J3e=1,function(i,e){var t={},n=Object.create,r=Object.freeze,s=Object.defineProperty,a=Object.defineProperties,c=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertyNames,y=Object.getOwnPropertySymbols,x=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,N=(o,l)=>{if(l=Symbol[o])return l;throw Error("Symbol."+o+" is not defined")},F=Math.pow,U=(o,l,u)=>l in o?s(o,l,{enumerable:!0,configurable:!0,writable:!0,value:u}):o[l]=u,R=(o,l)=>{for(var u in l||(l={}))w.call(l,u)&&U(o,u,l[u]);if(y)for(var u of y(l))C.call(l,u)&&U(o,u,l[u]);return o},B=(o,l)=>a(o,d(l)),Y=(o,l)=>{var u={};for(var m in o)w.call(o,m)&&l.indexOf(m)<0&&(u[m]=o[m]);if(o!=null&&y)for(var m of y(o))l.indexOf(m)<0&&C.call(o,m)&&(u[m]=o[m]);return u},A=(o,l)=>()=>(o&&(l=o(o=0)),l),ne=(o,l)=>()=>(l||o((l={exports:{}}).exports,l),l.exports),se=(o,l)=>{for(var u in l)s(o,u,{get:l[u],enumerable:!0})},oe=(o,l,u,m)=>{if(l&&typeof l=="object"||typeof l=="function")for(let _ of p(l))!w.call(o,_)&&_!==u&&s(o,_,{get:()=>l[_],enumerable:!(m=c(l,_))||m.enumerable});return o},G=(o,l,u)=>(u=o!=null?n(x(o)):{},oe(l||!o||!o.__esModule?s(u,"default",{value:o,enumerable:!0}):u,o)),ie=o=>oe(s({},"__esModule",{value:!0}),o),Me=(o,l,u)=>(U(o,typeof l!="symbol"?l+"":l,u),u),X=(o,l)=>r(s(o,"raw",{value:r(o.slice())})),De=(o,l,u)=>new Promise((m,_)=>{var S=k=>{try{P(u.next(k))}catch(L){_(L)}},M=k=>{try{P(u.throw(k))}catch(L){_(L)}},P=k=>k.done?m(k.value):Promise.resolve(k.value).then(S,M);P((u=u.apply(o,l)).next())}),$e=function(o,l){this[0]=o,this[1]=l},ot=o=>{var l=o[N("asyncIterator")],u=!1,m,_={};return l==null?(l=o[N("iterator")](),m=S=>_[S]=M=>l[S](M)):(l=l.call(o),m=S=>_[S]=M=>{if(u){if(u=!1,S==="throw")throw M;return M}return u=!0,{done:!1,value:new $e(new Promise(P=>{var k=l[S](M);if(!(k instanceof Object))throw TypeError("Object expected");P(k)}),1)}}),_[N("iterator")]=()=>_,m("next"),"throw"in l?m("throw"):_.throw=S=>{throw S},"return"in l&&m("return"),_};function He(o){Ge=o}function ce(){return Ge}var Ge,Ie=A(()=>{});function st(o){return l=>typeof l=="object"&&!!l&&l.type===o}var bt,Ne,ht,Ot,wn,bn,Tt,Gt,$t=A(()=>{bt=st("Theatre_Project"),Ne=st("Theatre_Sheet"),ht=st("Theatre_SheetTemplate"),Ot=st("Theatre_SheetObject"),wn=st("Theatre_Sequence"),bn=st("Theatre_SheetObjectTemplate"),Tt=st("Theatre_Sheet_PublicAPI"),Gt=st("Theatre_SheetObject_PublicAPI")}),Ln,jn,fr=A(()=>{Ln=typeof tl=="object"&&tl&&tl.Object===Object&&tl,jn=Ln}),ds,Wr,Br,Kr=A(()=>{fr(),ds=typeof self=="object"&&self&&self.Object===Object&&self,Wr=jn||ds||Function("return this")(),Br=Wr}),Vr,ai,qe=A(()=>{Kr(),Vr=Br.Symbol,ai=Vr});function hs(o){var l=gi.call(o,Pe),u=o[Pe];try{o[Pe]=void 0;var m=!0}catch{}var _=Fn.call(o);return m&&(l?o[Pe]=u:delete o[Pe]),_}var ni,gi,Fn,Pe,de,dt=A(()=>{qe(),ni=Object.prototype,gi=ni.hasOwnProperty,Fn=ni.toString,Pe=ai?ai.toStringTag:void 0,de=hs});function qt(o){return Bt.call(o)}var Xt,Bt,$n,_n=A(()=>{Xt=Object.prototype,Bt=Xt.toString,$n=qt});function tr(o){return o==null?o===void 0?Qt:Mr:pn&&pn in Object(o)?de(o):$n(o)}var Mr,Qt,pn,Un,Vn=A(()=>{qe(),dt(),_n(),Mr="[object Null]",Qt="[object Undefined]",pn=ai?ai.toStringTag:void 0,Un=tr});function Dn(o){return o!=null&&typeof o=="object"}var br,Qe=A(()=>{br=Dn});function gn(o){return typeof o=="symbol"||br(o)&&Un(o)==un}var un,Cn,on=A(()=>{Vn(),Qe(),un="[object Symbol]",Cn=gn});function zt(o,l){for(var u=-1,m=o==null?0:o.length,_=Array(m);++u<m;)_[u]=l(o[u],u,o);return _}var Gn,Ir=A(()=>{Gn=zt}),zi,Tr,Ms=A(()=>{zi=Array.isArray,Tr=zi});function Ko(o){if(typeof o=="string")return o;if(Tr(o))return Gn(o,Ko)+"";if(Cn(o))return Dh?Dh.call(o):"";var l=o+"";return l=="0"&&1/o==-Iu?"-0":l}var Iu,I0,Dh,Kl,Nu=A(()=>{qe(),Ir(),Ms(),on(),Iu=1/0,I0=ai?ai.prototype:void 0,Dh=I0?I0.toString:void 0,Kl=Ko});function r0(o){for(var l=o.length;l--&&Ga.test(o.charAt(l)););return l}var Ga,Ed,up=A(()=>{Ga=/\s/,Ed=r0});function Md(o){return o&&o.slice(0,Ed(o)+1).replace(ko,"")}var ko,Uc,Zl=A(()=>{up(),ko=/^\s+/,Uc=Md});function ku(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}var Zo,ja=A(()=>{Zo=ku});function dp(o){if(typeof o=="number")return o;if(Cn(o))return Cd;if(Zo(o)){var l=typeof o.valueOf=="function"?o.valueOf():o;o=Zo(l)?l+"":l}if(typeof o!="string")return o===0?o:+o;o=Uc(o);var u=fp.test(o);return u||me.test(o)?pt(o.slice(2),u?2:8):hp.test(o)?Cd:+o}var Cd,hp,fp,me,pt,At,St=A(()=>{Zl(),ja(),on(),Cd=NaN,hp=/^[-+]0x[0-9a-f]+$/i,fp=/^0b[01]+$/i,me=/^0o[0-7]+$/i,pt=parseInt,At=dp});function _t(o){if(!o)return o===0?o:0;if(o=At(o),o===Rn||o===-Rn){var l=o<0?-1:1;return l*Bn}return o===o?o:0}var Rn,Bn,Mn,On=A(()=>{St(),Rn=1/0,Bn=17976931348623157e292,Mn=_t});function Kn(o){var l=Mn(o),u=l%1;return l===l?u?l-u:l:0}var ur,zr=A(()=>{On(),ur=Kn});function pr(o){return o}var li,Ni=A(()=>{li=pr});function Ki(o){if(!Zo(o))return!1;var l=Un(o);return l==Os||l==nr||l==ii||l==Qo}var ii,Os,nr,Qo,si,ha=A(()=>{Vn(),ja(),ii="[object AsyncFunction]",Os="[object Function]",nr="[object GeneratorFunction]",Qo="[object Proxy]",si=Ki}),Xs,Do,Bc=A(()=>{Kr(),Xs=Br["__core-js_shared__"],Do=Xs});function xi(o){return!!Nr&&Nr in o}var Nr,Oo,xs=A(()=>{Bc(),Nr=function(){var o=/[^.]+$/.exec(Do&&Do.keys&&Do.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Oo=xi});function i0(o){if(o!=null){try{return Ad.call(o)}catch{}try{return o+""}catch{}}return""}var Aa,Ad,Ql,pp=A(()=>{Aa=Function.prototype,Ad=Aa.toString,Ql=i0});function mp(o){if(!Zo(o)||Oo(o))return!1;var l=si(o)?P2:Ha;return l.test(Ql(o))}var Jl,Ha,ul,Du,Pd,ec,P2,gm,Oh=A(()=>{ha(),xs(),ja(),pp(),Jl=/[\\^$.*+?()[\]{}|]/g,Ha=/^\[object .+?Constructor\]$/,ul=Function.prototype,Du=Object.prototype,Pd=ul.toString,ec=Du.hasOwnProperty,P2=RegExp("^"+Pd.call(ec).replace(Jl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gm=mp});function B4(o,l){return o==null?void 0:o[l]}var zc,Ou=A(()=>{zc=B4});function R2(o,l){var u=zc(o,l);return gm(u)?u:void 0}var dl,N0=A(()=>{Oh(),Ou(),dl=R2}),Rd,tc,gp=A(()=>{N0(),Kr(),Rd=dl(Br,"WeakMap"),tc=Rd}),vm,I2,vp,yp=A(()=>{ja(),vm=Object.create,I2=function(){function o(){}return function(l){if(!Zo(l))return{};if(vm)return vm(l);o.prototype=l;var u=new o;return o.prototype=void 0,u}}(),vp=I2});function _p(o,l,u){switch(u.length){case 0:return o.call(l);case 1:return o.call(l,u[0]);case 2:return o.call(l,u[0],u[1]);case 3:return o.call(l,u[0],u[1],u[2])}return o.apply(l,u)}var ym,nc=A(()=>{ym=_p});function xp(){}var Id,_m=A(()=>{Id=xp});function bp(o,l){var u=-1,m=o.length;for(l||(l=Array(m));++u<m;)l[u]=o[u];return l}var rc,Sp=A(()=>{rc=bp});function Lo(o){var l=0,u=0;return function(){var m=hl(),_=s0-(m-u);if(u=m,_>0){if(++l>=Lu)return arguments[0]}else l=0;return o.apply(void 0,arguments)}}var Lu,s0,hl,Lh,Fh=A(()=>{Lu=800,s0=16,hl=Date.now,Lh=Lo});function ic(o){return function(){return o}}var Fu,sc=A(()=>{Fu=ic}),io,Vc,wp=A(()=>{N0(),io=function(){try{var o=dl(Object,"defineProperty");return o({},"",{}),o}catch{}}(),Vc=io}),N2,fl,Uh=A(()=>{sc(),wp(),Ni(),N2=Vc?function(o,l){return Vc(o,"toString",{configurable:!0,enumerable:!1,value:Fu(l),writable:!0})}:li,fl=N2}),k2,D2,xm=A(()=>{Uh(),Fh(),k2=Lh(fl),D2=k2});function z4(o,l){for(var u=-1,m=o==null?0:o.length;++u<m&&l(o[u],u,o)!==!1;);return o}var Tp,V4=A(()=>{Tp=z4});function bm(o,l,u,m){for(var _=o.length,S=u+(m?1:-1);m?S--:++S<_;)if(l(o[S],S,o))return S;return-1}var Ep,Mp=A(()=>{Ep=bm});function Cp(o){return o!==o}var Bh,Jo=A(()=>{Bh=Cp});function G4(o,l,u){for(var m=u-1,_=o.length;++m<_;)if(o[m]===l)return m;return-1}var zh,O2=A(()=>{zh=G4});function L2(o,l,u){return l===l?zh(o,l,u):Ep(o,Bh,u)}var fa,F2=A(()=>{Mp(),Jo(),O2(),fa=L2});function j4(o,l){var u=o==null?0:o.length;return!!u&&fa(o,l,0)>-1}var U2,B2=A(()=>{F2(),U2=j4});function Sm(o,l){var u=typeof o;return l=l??Ls,!!l&&(u=="number"||u!="symbol"&&Nd.test(o))&&o>-1&&o%1==0&&o<l}var Ls,Nd,pl,oc=A(()=>{Ls=9007199254740991,Nd=/^(?:0|[1-9]\d*)$/,pl=Sm});function wm(o,l,u){l=="__proto__"&&Vc?Vc(o,l,{configurable:!0,enumerable:!0,value:u,writable:!0}):o[l]=u}var Mi,Uu=A(()=>{wp(),Mi=wm});function kd(o,l){return o===l||o!==o&&l!==l}var Dd,Vh=A(()=>{Dd=kd});function z2(o,l,u){var m=o[l];(!(Od.call(o,l)&&Dd(m,u))||u===void 0&&!(l in o))&&Mi(o,l,u)}var Tm,Od,ml,Bu=A(()=>{Uu(),Vh(),Tm=Object.prototype,Od=Tm.hasOwnProperty,ml=z2});function H4(o,l,u,m){var _=!u;u||(u={});for(var S=-1,M=l.length;++S<M;){var P=l[S],k=m?m(u[P],o[P],P,u,o):void 0;k===void 0&&(k=o[P]),_?Mi(u,P,k):ml(u,P,k)}return u}var ac,Ap=A(()=>{Bu(),Uu(),ac=H4});function V2(o,l,u){return l=le(l===void 0?o.length-1:l,0),function(){for(var m=arguments,_=-1,S=le(m.length-l,0),M=Array(S);++_<S;)M[_]=m[l+_];_=-1;for(var P=Array(l+1);++_<l;)P[_]=m[_];return P[l]=u(M),ym(o,this,P)}}var le,Te,Je=A(()=>{nc(),le=Math.max,Te=V2});function Lt(o,l){return D2(Te(o,l,li),o+"")}var Cr,ki=A(()=>{Ni(),Je(),xm(),Cr=Lt});function pa(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=k0}var k0,Gh,Gc=A(()=>{k0=9007199254740991,Gh=pa});function ma(o){return o!=null&&Gh(o.length)&&!si(o)}var lc,Pp=A(()=>{ha(),Gc(),lc=ma});function w6(o,l,u){if(!Zo(u))return!1;var m=typeof l;return(m=="number"?lc(u)&&pl(l,u.length):m=="string"&&l in u)?Dd(u[l],o):!1}var G2,T6=A(()=>{Vh(),Pp(),oc(),ja(),G2=w6});function W4(o){var l=o&&o.constructor,u=typeof l=="function"&&l.prototype||E6;return o===u}var E6,j2,cc=A(()=>{E6=Object.prototype,j2=W4});function q4(o,l){for(var u=-1,m=Array(o);++u<o;)m[u]=l(u);return m}var Rp,Em=A(()=>{Rp=q4});function M6(o){return br(o)&&Un(o)==Ip}var Ip,Ld,$4=A(()=>{Vn(),Qe(),Ip="[object Arguments]",Ld=M6}),Np,Mm,X4,Y4,Cm,Am=A(()=>{$4(),Qe(),Np=Object.prototype,Mm=Np.hasOwnProperty,X4=Np.propertyIsEnumerable,Y4=Ld(function(){return arguments}())?Ld:function(o){return br(o)&&Mm.call(o,"callee")&&!X4.call(o,"callee")},Cm=Y4});function K4(){return!1}var Z4,Fd=A(()=>{Z4=K4}),Pm,kp,C6,Q4,jh,J4,Dp,Rm=A(()=>{Kr(),Fd(),Pm=e&&!e.nodeType&&e,kp=Pm&&!0&&i&&!i.nodeType&&i,C6=kp&&kp.exports===Pm,Q4=C6?Br.Buffer:void 0,jh=Q4?Q4.isBuffer:void 0,J4=jh||Z4,Dp=J4});function Cs(o){return br(o)&&Gh(o.length)&&!!fs[Un(o)]}var H2,Ud,Op,e5,W2,Lp,Im,Hh,t5,A6,P6,n5,Nm,km,q2,$2,X2,Y2,R6,r5,I6,N6,K2,zu,fs,Wh,Ci=A(()=>{Vn(),Gc(),Qe(),H2="[object Arguments]",Ud="[object Array]",Op="[object Boolean]",e5="[object Date]",W2="[object Error]",Lp="[object Function]",Im="[object Map]",Hh="[object Number]",t5="[object Object]",A6="[object RegExp]",P6="[object Set]",n5="[object String]",Nm="[object WeakMap]",km="[object ArrayBuffer]",q2="[object DataView]",$2="[object Float32Array]",X2="[object Float64Array]",Y2="[object Int8Array]",R6="[object Int16Array]",r5="[object Int32Array]",I6="[object Uint8Array]",N6="[object Uint8ClampedArray]",K2="[object Uint16Array]",zu="[object Uint32Array]",fs={},fs[$2]=fs[X2]=fs[Y2]=fs[R6]=fs[r5]=fs[I6]=fs[N6]=fs[K2]=fs[zu]=!0,fs[H2]=fs[Ud]=fs[km]=fs[Op]=fs[q2]=fs[e5]=fs[W2]=fs[Lp]=fs[Im]=fs[Hh]=fs[t5]=fs[A6]=fs[P6]=fs[n5]=fs[Nm]=!1,Wh=Cs});function Dm(o){return function(l){return o(l)}}var o0,qh=A(()=>{o0=Dm}),Om,$h,gl,Bd,Vu,jc,Hc=A(()=>{fr(),Om=e&&!e.nodeType&&e,$h=Om&&!0&&i&&!i.nodeType&&i,gl=$h&&$h.exports===Om,Bd=gl&&jn.process,Vu=function(){try{var o=$h&&$h.require&&$h.require("util").types;return o||Bd&&Bd.binding&&Bd.binding("util")}catch{}}(),jc=Vu}),Gu,ju,is,ps=A(()=>{Ci(),qh(),Hc(),Gu=jc&&jc.isTypedArray,ju=Gu?o0(Gu):Wh,is=ju});function zd(o,l){var u=Tr(o),m=!u&&Cm(o),_=!u&&!m&&Dp(o),S=!u&&!m&&!_&&is(o),M=u||m||_||S,P=M?Rp(o.length,String):[],k=P.length;for(var L in o)(l||Pa.call(o,L))&&!(M&&(L=="length"||_&&(L=="offset"||L=="parent")||S&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||pl(L,k)))&&P.push(L);return P}var ga,Pa,Hu,Vd=A(()=>{Em(),Am(),Ms(),Rm(),oc(),ps(),ga=Object.prototype,Pa=ga.hasOwnProperty,Hu=zd});function a0(o,l){return function(u){return o(l(u))}}var Fp,i5=A(()=>{Fp=a0}),s5,Lm,k6=A(()=>{i5(),s5=Fp(Object.keys,Object),Lm=s5});function Wu(o){if(!j2(o))return Lm(o);var l=[];for(var u in Object(o))Z2.call(o,u)&&u!="constructor"&&l.push(u);return l}var qu,Z2,o5,Jx=A(()=>{cc(),k6(),qu=Object.prototype,Z2=qu.hasOwnProperty,o5=Wu});function Gd(o){return lc(o)?Hu(o):o5(o)}var uc,Wc=A(()=>{Vd(),Jx(),Pp(),uc=Gd});function Q2(o){var l=[];if(o!=null)for(var u in Object(o))l.push(u);return l}var Xh,vl=A(()=>{Xh=Q2});function D0(o){if(!Zo(o))return Xh(o);var l=j2(o),u=[];for(var m in o)m=="constructor"&&(l||!yl.call(o,m))||u.push(m);return u}var jd,yl,qc,Yh=A(()=>{ja(),cc(),vl(),jd=Object.prototype,yl=jd.hasOwnProperty,qc=D0});function D6(o){return lc(o)?Hu(o,!0):qc(o)}var Kh,Fm=A(()=>{Vd(),Yh(),Pp(),Kh=D6});function O0(o,l){if(Tr(o))return!1;var u=typeof o;return u=="number"||u=="symbol"||u=="boolean"||o==null||Cn(o)?!0:As.test(o)||!l0.test(o)||l!=null&&o in Object(l)}var l0,As,c0,Um=A(()=>{Ms(),on(),l0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,As=/^\w*$/,c0=O0}),a5,Hd,Up=A(()=>{N0(),a5=dl(Object,"create"),Hd=a5});function O6(){this.__data__=Hd?Hd(null):{},this.size=0}var Bm,L6=A(()=>{Up(),Bm=O6});function Bp(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}var J2,eb=A(()=>{J2=Bp});function zm(o){var l=this.__data__;if(Hd){var u=l[o];return u===Vm?void 0:u}return l5.call(l,o)?l[o]:void 0}var Vm,Gm,l5,Zh,c5=A(()=>{Up(),Vm="__lodash_hash_undefined__",Gm=Object.prototype,l5=Gm.hasOwnProperty,Zh=zm});function e3(o){var l=this.__data__;return Hd?l[o]!==void 0:Qh.call(l,o)}var jm,Qh,t3,u5=A(()=>{Up(),jm=Object.prototype,Qh=jm.hasOwnProperty,t3=e3});function d5(o,l){var u=this.__data__;return this.size+=this.has(o)?0:1,u[o]=Hd&&l===void 0?zp:l,this}var zp,$u,_l=A(()=>{Up(),zp="__lodash_hash_undefined__",$u=d5});function L0(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var m=o[l];this.set(m[0],m[1])}}var Vp,h5=A(()=>{L6(),eb(),c5(),u5(),_l(),L0.prototype.clear=Bm,L0.prototype.delete=J2,L0.prototype.get=Zh,L0.prototype.has=t3,L0.prototype.set=$u,Vp=L0});function Xu(){this.__data__=[],this.size=0}var $c,n3=A(()=>{$c=Xu});function F6(o,l){for(var u=o.length;u--;)if(Dd(o[u][0],l))return u;return-1}var F0,dc=A(()=>{Vh(),F0=F6});function r3(o){var l=this.__data__,u=F0(l,o);if(u<0)return!1;var m=l.length-1;return u==m?l.pop():Hm.call(l,u,1),--this.size,!0}var f5,Hm,p5,Wm=A(()=>{dc(),f5=Array.prototype,Hm=f5.splice,p5=r3});function Xc(o){var l=this.__data__,u=F0(l,o);return u<0?void 0:l[u][1]}var Gp,qm=A(()=>{dc(),Gp=Xc});function Wd(o){return F0(this.__data__,o)>-1}var i3,jp=A(()=>{dc(),i3=Wd});function U6(o,l){var u=this.__data__,m=F0(u,o);return m<0?(++this.size,u.push([o,l])):u[m][1]=l,this}var s3,js=A(()=>{dc(),s3=U6});function Yu(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var m=o[l];this.set(m[0],m[1])}}var Jh,Hp=A(()=>{n3(),Wm(),qm(),jp(),js(),Yu.prototype.clear=$c,Yu.prototype.delete=p5,Yu.prototype.get=Gp,Yu.prototype.has=i3,Yu.prototype.set=s3,Jh=Yu}),$m,qd,Ku=A(()=>{N0(),Kr(),$m=dl(Br,"Map"),qd=$m});function ss(){this.size=0,this.__data__={hash:new Vp,map:new(qd||Jh),string:new Vp}}var Fs,ea=A(()=>{h5(),Hp(),Ku(),Fs=ss});function o3(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}var Wp,Xm=A(()=>{Wp=o3});function B6(o,l){var u=o.__data__;return Wp(l)?u[typeof l=="string"?"string":"hash"]:u.map}var so,qp=A(()=>{Xm(),so=B6});function a3(o){var l=so(this,o).delete(o);return this.size-=l?1:0,l}var Ym,Yc=A(()=>{qp(),Ym=a3});function xl(o){return so(this,o).get(o)}var $p,m5=A(()=>{qp(),$p=xl});function g5(o){return so(this,o).has(o)}var l3,z6=A(()=>{qp(),l3=g5});function V6(o,l){var u=so(this,o),m=u.size;return u.set(o,l),this.size+=u.size==m?0:1,this}var c3,G6=A(()=>{qp(),c3=V6});function Zu(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var m=o[l];this.set(m[0],m[1])}}var Xp,u3=A(()=>{ea(),Yc(),m5(),z6(),G6(),Zu.prototype.clear=Fs,Zu.prototype.delete=Ym,Zu.prototype.get=$p,Zu.prototype.has=l3,Zu.prototype.set=c3,Xp=Zu});function ef(o,l){if(typeof o!="function"||l!=null&&typeof l!="function")throw new TypeError(v5);var u=function(){var m=arguments,_=l?l.apply(this,m):m[0],S=u.cache;if(S.has(_))return S.get(_);var M=o.apply(this,m);return u.cache=S.set(_,M)||S,M};return u.cache=new(ef.Cache||Xp),u}var v5,tf,Km=A(()=>{u3(),v5="Expected a function",ef.Cache=Xp,tf=ef});function j6(o){var l=tf(o,function(m){return u.size===d3&&u.clear(),m}),u=l.cache;return l}var d3,h3,H6=A(()=>{Km(),d3=500,h3=j6}),Zm,y5,f3,_5,p3=A(()=>{H6(),Zm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,y5=/\\(\\)?/g,f3=h3(function(o){var l=[];return o.charCodeAt(0)===46&&l.push(""),o.replace(Zm,function(u,m,_,S){l.push(_?S.replace(y5,"$1"):m||u)}),l}),_5=f3});function W6(o){return o==null?"":Kl(o)}var Yp,x5=A(()=>{Nu(),Yp=W6});function b5(o,l){return Tr(o)?o:c0(o,l)?[o]:_5(Yp(o))}var Qm,m3=A(()=>{Ms(),Um(),p3(),x5(),Qm=b5});function S5(o){if(typeof o=="string"||Cn(o))return o;var l=o+"";return l=="0"&&1/o==-g3?"-0":l}var g3,Kc,Kp=A(()=>{on(),g3=1/0,Kc=S5});function tb(o,l){l=Qm(l,o);for(var u=0,m=l.length;o!=null&&u<m;)o=o[Kc(l[u++])];return u&&u==m?o:void 0}var v3,U0=A(()=>{m3(),Kp(),v3=tb});function w5(o,l,u){var m=o==null?void 0:v3(o,l);return m===void 0?u:m}var Zc,bl=A(()=>{U0(),Zc=w5});function Zp(o,l){for(var u=-1,m=l.length,_=o.length;++u<m;)o[_+u]=l[u];return o}var Jm,eg=A(()=>{Jm=Zp});function Qp(o){return Tr(o)||Cm(o)||!!(tg&&o&&o[tg])}var tg,y3,_3=A(()=>{qe(),Am(),Ms(),tg=ai?ai.isConcatSpreadable:void 0,y3=Qp});function T5(o,l,u,m,_){var S=-1,M=o.length;for(u||(u=y3),_||(_=[]);++S<M;){var P=o[S];l>0&&u(P)?l>1?T5(P,l-1,u,m,_):Jm(_,P):m||(_[_.length]=P)}return _}var ng,q6=A(()=>{eg(),_3(),ng=T5}),E5,rg,M5=A(()=>{i5(),E5=Fp(Object.getPrototypeOf,Object),rg=E5});function u0(o){if(!br(o)||Un(o)!=va)return!1;var l=rg(o);if(l===null)return!0;var u=A5.call(l,"constructor")&&l.constructor;return typeof u=="function"&&u instanceof u&&b3.call(u)==P5}var va,x3,C5,b3,A5,P5,Jp,R5=A(()=>{Vn(),M5(),Qe(),va="[object Object]",x3=Function.prototype,C5=Object.prototype,b3=x3.toString,A5=C5.hasOwnProperty,P5=b3.call(Object),Jp=u0});function I5(o){var l=Math[o];return function(u,m){if(u=At(u),m=m==null?0:k5(ur(m),292),m&&N5(u)){var _=(Yp(u)+"e").split("e"),S=l(_[0]+"e"+(+_[1]+m));return _=(Yp(S)+"e").split("e"),+(_[0]+"e"+(+_[1]-m))}return l(u)}}var N5,k5,S3,D5=A(()=>{Kr(),zr(),St(),x5(),N5=Br.isFinite,k5=Math.min,S3=I5});function $6(o,l,u){return o===o&&(u!==void 0&&(o=o<=u?o:u),l!==void 0&&(o=o>=l?o:l)),o}var w3,T3=A(()=>{w3=$6});function nb(o,l,u){return u===void 0&&(u=l,l=void 0),u!==void 0&&(u=At(u),u=u===u?u:0),l!==void 0&&(l=At(l),l=l===l?l:0),w3(At(o),l,u)}var Zi,nf=A(()=>{T3(),St(),Zi=nb});function X6(){this.__data__=new Jh,this.size=0}var ig,Qu=A(()=>{Hp(),ig=X6});function rb(o){var l=this.__data__,u=l.delete(o);return this.size=l.size,u}var O5,L5=A(()=>{O5=rb});function Y6(o){return this.__data__.get(o)}var F5,sg=A(()=>{F5=Y6});function Ra(o){return this.__data__.has(o)}var K6,ib=A(()=>{K6=Ra});function E3(o,l){var u=this.__data__;if(u instanceof Jh){var m=u.__data__;if(!qd||m.length<ta-1)return m.push([o,l]),this.size=++u.size,this;u=this.__data__=new Xp(m)}return u.set(o,l),this.size=u.size,this}var ta,Z6,Zn=A(()=>{Hp(),Ku(),u3(),ta=200,Z6=E3});function hc(o){var l=this.__data__=new Jh(o);this.size=l.size}var $d,M3=A(()=>{Hp(),Qu(),L5(),sg(),ib(),Zn(),hc.prototype.clear=ig,hc.prototype.delete=O5,hc.prototype.get=F5,hc.prototype.has=K6,hc.prototype.set=Z6,$d=hc});function Q6(o,l){return o&&ac(l,uc(l),o)}var e1,C3=A(()=>{Ap(),Wc(),e1=Q6});function U5(o,l){return o&&ac(l,Kh(l),o)}var B5,J6=A(()=>{Ap(),Fm(),B5=U5});function z5(o,l){if(l)return o.slice();var u=o.length,m=fc?fc(u):new o.constructor(u);return o.copy(m),m}var og,ag,na,B0,fc,V5,ey=A(()=>{Kr(),og=e&&!e.nodeType&&e,ag=og&&!0&&i&&!i.nodeType&&i,na=ag&&ag.exports===og,B0=na?Br.Buffer:void 0,fc=B0?B0.allocUnsafe:void 0,V5=z5});function pc(o,l){for(var u=-1,m=o==null?0:o.length,_=0,S=[];++u<m;){var M=o[u];l(M,u,o)&&(S[_++]=M)}return S}var A3,Qc=A(()=>{A3=pc});function sb(){return[]}var P3,G5=A(()=>{P3=sb}),j5,H5,W5,lg,t1,d0=A(()=>{Qc(),G5(),j5=Object.prototype,H5=j5.propertyIsEnumerable,W5=Object.getOwnPropertySymbols,lg=W5?function(o){return o==null?[]:(o=Object(o),A3(W5(o),function(l){return H5.call(o,l)}))}:P3,t1=lg});function Di(o,l){return ac(o,t1(o),l)}var Fo,_o=A(()=>{Ap(),d0(),Fo=Di}),ra,h0,Xd,Gr=A(()=>{eg(),M5(),d0(),G5(),ra=Object.getOwnPropertySymbols,h0=ra?function(o){for(var l=[];o;)Jm(l,t1(o)),o=rg(o);return l}:P3,Xd=h0});function Yd(o,l){return ac(o,Xd(o),l)}var Kd,R3=A(()=>{Ap(),Gr(),Kd=Yd});function q5(o,l,u){var m=l(o);return Tr(o)?m:Jm(m,u(o))}var rf,Wa=A(()=>{eg(),Ms(),rf=q5});function $5(o){return rf(o,uc,t1)}var Ju,Jc=A(()=>{Wa(),d0(),Wc(),Ju=$5});function I3(o){return rf(o,Kh,Xd)}var N3,mc=A(()=>{Wa(),Gr(),Fm(),N3=I3}),cg,gc,k3=A(()=>{N0(),Kr(),cg=dl(Br,"DataView"),gc=cg}),n1,r1,D3=A(()=>{N0(),Kr(),n1=dl(Br,"Promise"),r1=n1}),ug,oo,eu=A(()=>{N0(),Kr(),ug=dl(Br,"Set"),oo=ug}),z0,qa,O3,dg,hg,X5,ed,Y5,L3,Zd,F3,f0,sf,fg=A(()=>{k3(),Ku(),D3(),eu(),gp(),Vn(),pp(),z0="[object Map]",qa="[object Object]",O3="[object Promise]",dg="[object Set]",hg="[object WeakMap]",X5="[object DataView]",ed=Ql(gc),Y5=Ql(qd),L3=Ql(r1),Zd=Ql(oo),F3=Ql(tc),f0=Un,(gc&&f0(new gc(new ArrayBuffer(1)))!=X5||qd&&f0(new qd)!=z0||r1&&f0(r1.resolve())!=O3||oo&&f0(new oo)!=dg||tc&&f0(new tc)!=hg)&&(f0=function(o){var l=Un(o),u=l==qa?o.constructor:void 0,m=u?Ql(u):"";if(m)switch(m){case ed:return X5;case Y5:return z0;case L3:return O3;case Zd:return dg;case F3:return hg}return l}),sf=f0});function K5(o){var l=o.length,u=new o.constructor(l);return l&&typeof o[0]=="string"&&ty.call(o,"index")&&(u.index=o.index,u.input=o.input),u}var pg,ty,Z5,U3=A(()=>{pg=Object.prototype,ty=pg.hasOwnProperty,Z5=K5}),Q5,vc,ny=A(()=>{Kr(),Q5=Br.Uint8Array,vc=Q5});function i1(o){var l=new o.constructor(o.byteLength);return new vc(l).set(new vc(o)),l}var mg,Us=A(()=>{ny(),mg=i1});function ob(o,l){var u=l?mg(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.byteLength)}var J5,ry=A(()=>{Us(),J5=ob});function iy(o){var l=new o.constructor(o.source,s1.exec(o));return l.lastIndex=o.lastIndex,l}var s1,ev,sy=A(()=>{s1=/\w*$/,ev=iy});function Sl(o){return B3?Object(B3.call(o)):{}}var gg,B3,tu,z3=A(()=>{qe(),gg=ai?ai.prototype:void 0,B3=gg?gg.valueOf:void 0,tu=Sl});function of(o,l){var u=l?mg(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.length)}var vg,tv=A(()=>{Us(),vg=of});function nv(o,l,u){var m=o.constructor;switch(l){case j3:return mg(o);case rv:case V3:return new m(+o);case ay:return J5(o,u);case ov:case H3:case xg:case W3:case bg:case av:case ly:case Sg:case lv:return vg(o,u);case oy:return new m;case iv:case _g:return new m(o);case G3:return ev(o);case yg:return new m;case sv:return tu(o)}}var rv,V3,oy,iv,G3,yg,_g,sv,j3,ay,ov,H3,xg,W3,bg,av,ly,Sg,lv,o1,ab=A(()=>{Us(),ry(),sy(),z3(),tv(),rv="[object Boolean]",V3="[object Date]",oy="[object Map]",iv="[object Number]",G3="[object RegExp]",yg="[object Set]",_g="[object String]",sv="[object Symbol]",j3="[object ArrayBuffer]",ay="[object DataView]",ov="[object Float32Array]",H3="[object Float64Array]",xg="[object Int8Array]",W3="[object Int16Array]",bg="[object Int32Array]",av="[object Uint8Array]",ly="[object Uint8ClampedArray]",Sg="[object Uint16Array]",lv="[object Uint32Array]",o1=nv});function q3(o){return typeof o.constructor=="function"&&!j2(o)?vp(rg(o)):{}}var h,g=A(()=>{yp(),M5(),cc(),h=q3});function T(o){return br(o)&&sf(o)==D}var D,W,J=A(()=>{fg(),Qe(),D="[object Map]",W=T}),fe,Oe,Ye,It=A(()=>{J(),qh(),Hc(),fe=jc&&jc.isMap,Oe=fe?o0(fe):W,Ye=Oe});function nn(o){return br(o)&&sf(o)==dn}var dn,tn,Hn=A(()=>{fg(),Qe(),dn="[object Set]",tn=nn}),Qn,ir,Ys,xt=A(()=>{Hn(),qh(),Hc(),Qn=jc&&jc.isSet,ir=Qn?o0(Qn):tn,Ys=ir});function at(o,l,u,m,_,S){var M,P=l&Ct,k=l&yn,L=l&dr;if(u&&(M=_?u(o,m,_,S):u(o)),M!==void 0)return M;if(!Zo(o))return o;var z=Tr(o);if(z){if(M=Z5(o),!P)return rc(o,M)}else{var $=sf(o),H=$==nu||$==cy;if(Dp(o))return V5(o,P);if($==cb||$==Er||H&&!_){if(M=k||H?{}:h(o),!P)return k?Kd(o,B5(M,o)):Fo(o,e1(M,o))}else{if(!Ps[$])return _?o:{};M=o1(o,$,P)}}S||(S=new $d);var j=S.get(o);if(j)return j;S.set(o,M),Ys(o)?o.forEach(function(re){M.add(at(re,l,u,re,o,S))}):Ye(o)&&o.forEach(function(re,ae){M.set(ae,at(re,l,u,ae,o,S))});var K=L?k?N3:Ju:k?Kh:uc,Q=z?void 0:K(o);return Tp(Q||o,function(re,ae){Q&&(ae=re,re=o[ae]),ml(M,ae,at(re,l,u,ae,o,S))}),M}var Ct,yn,dr,Er,Ar,Dr,Uo,Oi,nu,cy,lb,QE,cb,ub,JE,eM,tM,nM,rM,iM,uy,dy,sM,db,hb,fb,oM,pb,mb,Ps,aM,RD=A(()=>{M3(),V4(),Bu(),C3(),J6(),ey(),Sp(),_o(),R3(),Jc(),mc(),fg(),U3(),ab(),g(),Ms(),Rm(),It(),ja(),xt(),Wc(),Fm(),Ct=1,yn=2,dr=4,Er="[object Arguments]",Ar="[object Array]",Dr="[object Boolean]",Uo="[object Date]",Oi="[object Error]",nu="[object Function]",cy="[object GeneratorFunction]",lb="[object Map]",QE="[object Number]",cb="[object Object]",ub="[object RegExp]",JE="[object Set]",eM="[object String]",tM="[object Symbol]",nM="[object WeakMap]",rM="[object ArrayBuffer]",iM="[object DataView]",uy="[object Float32Array]",dy="[object Float64Array]",sM="[object Int8Array]",db="[object Int16Array]",hb="[object Int32Array]",fb="[object Uint8Array]",oM="[object Uint8ClampedArray]",pb="[object Uint16Array]",mb="[object Uint32Array]",Ps={},Ps[Er]=Ps[Ar]=Ps[rM]=Ps[iM]=Ps[Dr]=Ps[Uo]=Ps[uy]=Ps[dy]=Ps[sM]=Ps[db]=Ps[hb]=Ps[lb]=Ps[QE]=Ps[cb]=Ps[ub]=Ps[JE]=Ps[eM]=Ps[tM]=Ps[fb]=Ps[oM]=Ps[pb]=Ps[mb]=!0,Ps[Oi]=Ps[nu]=Ps[nM]=!1,aM=at});function lM(o){return aM(o,cM|uM)}var cM,uM,dM,hM=A(()=>{RD(),cM=1,uM=4,dM=lM});function ID(o){return this.__data__.set(o,fM),this}var fM,pM,ND=A(()=>{fM="__lodash_hash_undefined__",pM=ID});function cv(o){return this.__data__.has(o)}var mM,gM=A(()=>{mM=cv});function hy(o){var l=-1,u=o==null?0:o.length;for(this.__data__=new Xp;++l<u;)this.add(o[l])}var gb,vM=A(()=>{u3(),ND(),gM(),hy.prototype.add=hy.prototype.push=pM,hy.prototype.has=mM,gb=hy});function fy(o,l){for(var u=-1,m=o==null?0:o.length;++u<m;)if(l(o[u],u,o))return!0;return!1}var py,kD=A(()=>{py=fy});function DD(o,l){return o.has(l)}var bs,wl=A(()=>{bs=DD});function yc(o,l,u,m,_,S){var M=u&a1,P=o.length,k=l.length;if(P!=k&&!(M&&k>P))return!1;var L=S.get(o),z=S.get(l);if(L&&z)return L==l&&z==o;var $=-1,H=!0,j=u&Rs?new gb:void 0;for(S.set(o,l),S.set(l,o);++$<P;){var K=o[$],Q=l[$];if(m)var re=M?m(Q,K,$,l,o,S):m(K,Q,$,o,l,S);if(re!==void 0){if(re)continue;H=!1;break}if(j){if(!py(l,function(ae,ue){if(!bs(j,ue)&&(K===ae||_(K,ae,u,m,S)))return j.push(ue)})){H=!1;break}}else if(!(K===Q||_(K,Q,u,m,S))){H=!1;break}}return S.delete(o),S.delete(l),H}var a1,Rs,td,vb=A(()=>{vM(),kD(),wl(),a1=1,Rs=2,td=yc});function OD(o){var l=-1,u=Array(o.size);return o.forEach(function(m,_){u[++l]=[_,m]}),u}var yM,LD=A(()=>{yM=OD});function FD(o){var l=-1,u=Array(o.size);return o.forEach(function(m){u[++l]=m}),u}var my,gy=A(()=>{my=FD});function _M(o,l,u,m,_,S,M){switch(u){case wb:if(o.byteLength!=l.byteLength||o.byteOffset!=l.byteOffset)return!1;o=o.buffer,l=l.buffer;case $3:return!(o.byteLength!=l.byteLength||!S(new vc(o),new vc(l)));case xM:case _b:case bM:return Dd(+o,+l);case xb:return o.name==l.name&&o.message==l.message;case SM:case wM:return o==l+"";case bb:var P=yM;case Sb:var k=m&uv;if(P||(P=my),o.size!=l.size&&!k)return!1;var L=M.get(o);if(L)return L==l;m|=yb,M.set(o,l);var z=td(P(o),P(l),m,_,S,M);return M.delete(o),z;case TM:if(vy)return vy.call(o)==vy.call(l)}return!1}var uv,yb,xM,_b,xb,bb,bM,SM,Sb,wM,TM,$3,wb,Tb,vy,xo,af=A(()=>{qe(),ny(),Vh(),vb(),LD(),gy(),uv=1,yb=2,xM="[object Boolean]",_b="[object Date]",xb="[object Error]",bb="[object Map]",bM="[object Number]",SM="[object RegExp]",Sb="[object Set]",wM="[object String]",TM="[object Symbol]",$3="[object ArrayBuffer]",wb="[object DataView]",Tb=ai?ai.prototype:void 0,vy=Tb?Tb.valueOf:void 0,xo=_M});function UD(o,l,u,m,_,S){var M=u&dv,P=Ju(o),k=P.length,L=Ju(l),z=L.length;if(k!=z&&!M)return!1;for(var $=k;$--;){var H=P[$];if(!(M?H in l:MM.call(l,H)))return!1}var j=S.get(o),K=S.get(l);if(j&&K)return j==l&&K==o;var Q=!0;S.set(o,l),S.set(l,o);for(var re=M;++$<k;){H=P[$];var ae=o[H],ue=l[H];if(m)var ye=M?m(ue,ae,H,l,o,S):m(ae,ue,H,o,l,S);if(!(ye===void 0?ae===ue||_(ae,ue,u,m,S):ye)){Q=!1;break}re||(re=H=="constructor")}if(Q&&!re){var Ae=o.constructor,Ce=l.constructor;Ae!=Ce&&"constructor"in o&&"constructor"in l&&!(typeof Ae=="function"&&Ae instanceof Ae&&typeof Ce=="function"&&Ce instanceof Ce)&&(Q=!1)}return S.delete(o),S.delete(l),Q}var dv,EM,MM,CM,BD=A(()=>{Jc(),dv=1,EM=Object.prototype,MM=EM.hasOwnProperty,CM=UD});function Eb(o,l,u,m,_,S){var M=Tr(o),P=Tr(l),k=M?l1:sf(o),L=P?l1:sf(l);k=k==X3?hv:k,L=L==X3?hv:L;var z=k==hv,$=L==hv,H=k==L;if(H&&Dp(o)){if(!Dp(l))return!1;M=!0,z=!1}if(H&&!z)return S||(S=new $d),M||is(o)?td(o,l,u,m,_,S):xo(o,l,k,u,m,_,S);if(!(u&AM)){var j=z&&yy.call(o,"__wrapped__"),K=$&&yy.call(l,"__wrapped__");if(j||K){var Q=j?o.value():o,re=K?l.value():l;return S||(S=new $d),_(Q,re,u,m,S)}}return H?(S||(S=new $d),CM(o,l,u,m,_,S)):!1}var AM,X3,l1,hv,PM,yy,_y,zD=A(()=>{M3(),vb(),af(),BD(),fg(),Ms(),Rm(),ps(),AM=1,X3="[object Arguments]",l1="[object Array]",hv="[object Object]",PM=Object.prototype,yy=PM.hasOwnProperty,_y=Eb});function fv(o,l,u,m,_){return o===l?!0:o==null||l==null||!br(o)&&!br(l)?o!==o&&l!==l:_y(o,l,u,m,fv,_)}var xy,by=A(()=>{zD(),Qe(),xy=fv});function VD(o,l,u,m){var _=u.length,S=_,M=!m;if(o==null)return!S;for(o=Object(o);_--;){var P=u[_];if(M&&P[2]?P[1]!==o[P[0]]:!(P[0]in o))return!1}for(;++_<S;){P=u[_];var k=P[0],L=o[k],z=P[1];if(M&&P[2]){if(L===void 0&&!(k in o))return!1}else{var $=new $d;if(m)var H=m(L,z,k,o,l,$);if(!(H===void 0?xy(z,L,RM|IM,m,$):H))return!1}}return!0}var RM,IM,NM,GD=A(()=>{M3(),by(),RM=1,IM=2,NM=VD});function jD(o){return o===o&&!Zo(o)}var Mb,c1=A(()=>{ja(),Mb=jD});function wg(o){for(var l=uc(o),u=l.length;u--;){var m=l[u],_=o[m];l[u]=[m,_,Mb(_)]}return l}var Tg,Cb=A(()=>{c1(),Wc(),Tg=wg});function kM(o,l){return function(u){return u==null?!1:u[o]===l&&(l!==void 0||o in Object(u))}}var Ab,Pb=A(()=>{Ab=kM});function HD(o){var l=Tg(o);return l.length==1&&l[0][2]?Ab(l[0][0],l[0][1]):function(u){return u===o||NM(u,o,l)}}var Sy,WD=A(()=>{GD(),Cb(),Pb(),Sy=HD});function qD(o,l){return o!=null&&l in Object(o)}var Rb,DM=A(()=>{Rb=qD});function $D(o,l,u){l=Qm(l,o);for(var m=-1,_=l.length,S=!1;++m<_;){var M=Kc(l[m]);if(!(S=o!=null&&u(o,M)))break;o=o[M]}return S||++m!=_?S:(_=o==null?0:o.length,!!_&&Gh(_)&&pl(M,_)&&(Tr(o)||Cm(o)))}var Qd,OM=A(()=>{m3(),Am(),Ms(),oc(),Gc(),Kp(),Qd=$D});function XD(o,l){return o!=null&&Qd(o,l,Rb)}var LM,Ib=A(()=>{DM(),OM(),LM=XD});function YD(o,l){return c0(o)&&Mb(l)?Ab(Kc(o),l):function(u){var m=Zc(u,o);return m===void 0&&m===l?LM(u,o):xy(l,m,FM|UM)}}var FM,UM,BM,zM=A(()=>{by(),bl(),Ib(),Um(),c1(),Pb(),Kp(),FM=1,UM=2,BM=YD});function KD(o){return function(l){return l==null?void 0:l[o]}}var VM,ZD=A(()=>{VM=KD});function QD(o){return function(l){return v3(l,o)}}var GM,JD=A(()=>{U0(),GM=QD});function jM(o){return c0(o)?VM(Kc(o)):GM(o)}var HM,pv=A(()=>{ZD(),JD(),Um(),Kp(),HM=jM});function WM(o){return typeof o=="function"?o:o==null?li:typeof o=="object"?Tr(o)?BM(o[0],o[1]):Sy(o):HM(o)}var Y3,mv=A(()=>{WD(),zM(),Ni(),Ms(),pv(),Y3=WM});function eO(o,l,u,m){for(var _=-1,S=o==null?0:o.length;++_<S;){var M=o[_];l(m,M,u(M),o)}return m}var qM,wy=A(()=>{qM=eO});function tO(o){return function(l,u,m){for(var _=-1,S=Object(l),M=m(l),P=M.length;P--;){var k=M[o?P:++_];if(u(S[k],k,S)===!1)break}return l}}var K3,nO=A(()=>{K3=tO}),$M,XM,rO=A(()=>{nO(),$M=K3(),XM=$M});function Nb(o,l){return o&&XM(o,l,uc)}var Ty,YM=A(()=>{rO(),Wc(),Ty=Nb});function iO(o,l){return function(u,m){if(u==null)return u;if(!lc(u))return o(u,m);for(var _=u.length,S=l?_:-1,M=Object(u);(l?S--:++S<_)&&m(M[S],S,M)!==!1;);return u}}var _c,Eg=A(()=>{Pp(),_c=iO}),u1,kb,Z3=A(()=>{YM(),Eg(),u1=_c(Ty),kb=u1});function Q3(o,l,u,m){return kb(o,function(_,S,M){l(m,_,u(_),M)}),m}var Ey,sO=A(()=>{Z3(),Ey=Q3});function KM(o,l){return function(u,m){var _=Tr(u)?qM:Ey,S=l?l():{};return _(u,o,Y3(m,2),S)}}var ZM,Db=A(()=>{wy(),sO(),mv(),Ms(),ZM=KM}),My,Jd,Ob=A(()=>{Kr(),My=function(){return Br.Date.now()},Jd=My});function Lb(o,l,u){var m,_,S,M,P,k,L=0,z=!1,$=!1,H=!0;if(typeof o!="function")throw new TypeError(QM);l=At(l)||0,Zo(u)&&(z=!!u.leading,$="maxWait"in u,S=$?Cy(At(u.maxWait)||0,l):S,H="trailing"in u?!!u.trailing:H);function j(Se){var ft=m,ke=_;return m=_=void 0,L=Se,M=o.apply(ke,ft),M}function K(Se){return L=Se,P=setTimeout(ae,l),z?j(Se):M}function Q(Se){var ft=Se-k,ke=Se-L,be=l-ft;return $?eh(be,S-ke):be}function re(Se){var ft=Se-k,ke=Se-L;return k===void 0||ft>=l||ft<0||$&&ke>=S}function ae(){var Se=Jd();if(re(Se))return ue(Se);P=setTimeout(ae,Q(Se))}function ue(Se){return P=void 0,H&&m?j(Se):(m=_=void 0,M)}function ye(){P!==void 0&&clearTimeout(P),L=0,m=k=_=P=void 0}function Ae(){return P===void 0?M:ue(Jd())}function Ce(){var Se=Jd(),ft=re(Se);if(m=arguments,_=this,k=Se,ft){if(P===void 0)return K(k);if($)return clearTimeout(P),P=setTimeout(ae,l),j(k)}return P===void 0&&(P=setTimeout(ae,l)),M}return Ce.cancel=ye,Ce.flush=Ae,Ce}var QM,Cy,eh,Ay,Py=A(()=>{ja(),Ob(),St(),QM="Expected a function",Cy=Math.max,eh=Math.min,Ay=Lb});function Ry(o,l,u){for(var m=-1,_=o==null?0:o.length;++m<_;)if(u(l,o[m]))return!0;return!1}var Iy,JM=A(()=>{Iy=Ry});function oO(o){var l=o==null?0:o.length;return l?o[l-1]:void 0}var Mg,J3=A(()=>{Mg=oO});function eC(o,l,u){var m=o==null?0:o.length;if(!m)return-1;var _=u==null?0:ur(u);return _<0&&(_=gv(m+_,0)),Ep(o,Y3(l,3),_)}var gv,vv,tC=A(()=>{Mp(),mv(),zr(),gv=Math.max,vv=eC});function Fb(o,l,u){var m=o==null?0:o.length;if(!m)return-1;var _=m-1;return u!==void 0&&(_=ur(u),_=u<0?Ny(m+_,0):ky(_,m-1)),Ep(o,Y3(l,3),_,!0)}var Ny,ky,nC,rC=A(()=>{Mp(),mv(),zr(),Ny=Math.max,ky=Math.min,nC=Fb});function iC(o,l){var u=-1,m=lc(o)?Array(o.length):[];return kb(o,function(_,S,M){m[++u]=l(_,S,M)}),m}var e9,Ub=A(()=>{Z3(),Pp(),e9=iC});function aO(o,l,u){return o>=Bb(l,u)&&o<sC(l,u)}var sC,Bb,zb,oC=A(()=>{sC=Math.max,Bb=Math.min,zb=aO});function Tl(o,l,u){return l=Mn(l),u===void 0?(u=l,l=0):u=Mn(u),o=At(o),zb(o,l,u)}var Vb,Gb=A(()=>{oC(),On(),St(),Vb=Tl});function lO(o){return typeof o=="number"&&o==ur(o)}var jb,yv=A(()=>{zr(),jb=lO}),_v,d1,xc=A(()=>{Uu(),Db(),_v=ZM(function(o,l,u){Mi(o,u,l)}),d1=_v});function cO(o,l){var u={};return l=Y3(l,3),Ty(o,function(m,_,S){Mi(u,_,l(m,_,S))}),u}var lf,aC=A(()=>{Uu(),YM(),mv(),lf=cO});function lC(o,l,u,m){if(!Zo(o))return o;l=Qm(l,o);for(var _=-1,S=l.length,M=S-1,P=o;P!=null&&++_<S;){var k=Kc(l[_]),L=u;if(k==="__proto__"||k==="constructor"||k==="prototype")return o;if(_!=M){var z=P[k];L=m?m(z,k,P):void 0,L===void 0&&(L=Zo(z)?z:pl(l[_+1])?[]:{})}ml(P,k,L),P=P[k]}return o}var Hb,uO=A(()=>{Bu(),m3(),oc(),ja(),Kp(),Hb=lC});function dO(o,l){var u=o.length;for(o.sort(l);u--;)o[u]=o[u].value;return o}var Wb,qb=A(()=>{Wb=dO});function cC(o,l){if(o!==l){var u=o!==void 0,m=o===null,_=o===o,S=Cn(o),M=l!==void 0,P=l===null,k=l===l,L=Cn(l);if(!P&&!L&&!S&&o>l||S&&M&&k&&!P&&!L||m&&M&&k||!u&&k||!_)return 1;if(!m&&!S&&!L&&o<l||L&&u&&_&&!m&&!S||P&&u&&_||!M&&_||!k)return-1}return 0}var uC,hO=A(()=>{on(),uC=cC});function $b(o,l,u){for(var m=-1,_=o.criteria,S=l.criteria,M=_.length,P=u.length;++m<M;){var k=uC(_[m],S[m]);if(k){if(m>=P)return k;var L=u[m];return k*(L=="desc"?-1:1)}}return o.index-l.index}var Xb,fO=A(()=>{hO(),Xb=$b});function pO(o,l,u){l.length?l=Gn(l,function(S){return Tr(S)?function(M){return v3(M,S.length===1?S[0]:S)}:S}):l=[li];var m=-1;l=Gn(l,o0(Y3));var _=e9(o,function(S,M,P){var k=Gn(l,function(L){return L(S)});return{criteria:k,index:++m,value:S}});return Wb(_,function(S,M){return Xb(S,M,u)})}var b,I=A(()=>{Ir(),U0(),mv(),Ub(),qb(),qh(),fO(),Ni(),Ms(),b=pO});function V(o,l,u,m){for(var _=u-1,S=o.length;++_<S;)if(m(o[_],l))return _;return-1}var te,he=A(()=>{te=V});function ve(o,l,u,m){var _=m?te:fa,S=-1,M=l.length,P=o;for(o===l&&(l=rc(l)),u&&(P=Gn(o,o0(u)));++S<M;)for(var k=0,L=l[S],z=u?u(L):L;(k=_(P,z,k,m))>-1;)P!==o&&lt.call(P,k,1),lt.call(o,k,1);return o}var Be,lt,yt,Dt=A(()=>{Ir(),F2(),he(),qh(),Sp(),Be=Array.prototype,lt=Be.splice,yt=ve});function rn(o,l){return o&&o.length&&l&&l.length?yt(o,l):o}var ln,In=A(()=>{Dt(),ln=rn}),sr,er,Zr=A(()=>{ki(),In(),sr=Cr(ln),er=sr}),oi,jr,Vi=A(()=>{D5(),oi=S3("round"),jr=oi});function ya(o,l,u){return o==null?o:Hb(o,l,u)}var bo,Bo=A(()=>{uO(),bo=ya}),Qi,ia,p0=A(()=>{q6(),I(),ki(),T6(),Qi=Cr(function(o,l){if(o==null)return[];var u=l.length;return u>1&&G2(o,l[0],l[1])?l=[]:u>2&&G2(l[0],l[1],l[2])&&(l=[l[0]]),b(o,ng(l,1),[])}),ia=Qi}),El,nd,rd,th=A(()=>{eu(),_m(),gy(),El=1/0,nd=oo&&1/my(new oo([,-0]))[1]==El?function(o){return new oo(o)}:Id,rd=nd});function ru(o,l,u){var m=-1,_=U2,S=o.length,M=!0,P=[],k=P;if(u)M=!1,_=Iy;else if(S>=Ia){var L=l?null:rd(o);if(L)return my(L);M=!1,_=bs,k=new gb}else k=l?[]:P;e:for(;++m<S;){var z=o[m],$=l?l(z):z;if(z=u||z!==0?z:0,M&&$===$){for(var H=k.length;H--;)if(k[H]===$)continue e;l&&k.push($),P.push(z)}else _(k,$,u)||(k!==P&&k.push($),P.push(z))}return P}var Ia,Ss,sa=A(()=>{vM(),B2(),JM(),wl(),th(),gy(),Ia=200,Ss=ru});function ms(o){return o&&o.length?Ss(o):[]}var Ks,cf=A(()=>{sa(),Ks=ms}),V0=A(()=>{nf(),Py(),tC(),Gb(),yv(),R5(),J3(),aC(),Km(),Vi(),cf()}),Oxe=ne((o,l)=>{var u;l.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:tl):m=>(u||(u=Promise.resolve())).then(m).catch(_=>setTimeout(()=>{throw _},0))}),Lxe=ne(o=>{var l=Symbol.for("react.element"),u=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),P=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),z=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),H=Symbol.iterator;function j(Re){return Re===null||typeof Re!="object"?null:(Re=H&&Re[H]||Re["@@iterator"],typeof Re=="function"?Re:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q=Object.assign,re={};function ae(Re,it,Ht){this.props=Re,this.context=it,this.refs=re,this.updater=Ht||K}ae.prototype.isReactComponent={},ae.prototype.setState=function(Re,it){if(typeof Re!="object"&&typeof Re!="function"&&Re!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Re,it,"setState")},ae.prototype.forceUpdate=function(Re){this.updater.enqueueForceUpdate(this,Re,"forceUpdate")};function ue(){}ue.prototype=ae.prototype;function ye(Re,it,Ht){this.props=Re,this.context=it,this.refs=re,this.updater=Ht||K}var Ae=ye.prototype=new ue;Ae.constructor=ye,Q(Ae,ae.prototype),Ae.isPureReactComponent=!0;var Ce=Array.isArray,Se=Object.prototype.hasOwnProperty,ft={current:null},ke={key:!0,ref:!0,__self:!0,__source:!0};function be(Re,it,Ht){var Kt,Et={},we=null,vt=null;if(it!=null)for(Kt in it.ref!==void 0&&(vt=it.ref),it.key!==void 0&&(we=""+it.key),it)Se.call(it,Kt)&&!ke.hasOwnProperty(Kt)&&(Et[Kt]=it[Kt]);var Mt=arguments.length-2;if(Mt===1)Et.children=Ht;else if(1<Mt){for(var Sn=Array(Mt),ar=0;ar<Mt;ar++)Sn[ar]=arguments[ar+2];Et.children=Sn}if(Re&&Re.defaultProps)for(Kt in Mt=Re.defaultProps,Mt)Et[Kt]===void 0&&(Et[Kt]=Mt[Kt]);return{$$typeof:l,type:Re,key:we,ref:vt,props:Et,_owner:ft.current}}function Ue(Re,it){return{$$typeof:l,type:Re.type,key:it,ref:Re.ref,props:Re.props,_owner:Re._owner}}function Ze(Re){return typeof Re=="object"&&Re!==null&&Re.$$typeof===l}function ze(Re){var it={"=":"=0",":":"=2"};return"$"+Re.replace(/[=:]/g,function(Ht){return it[Ht]})}var Ft=/\/+/g;function Ke(Re,it){return typeof Re=="object"&&Re!==null&&Re.key!=null?ze(""+Re.key):it.toString(36)}function Yt(Re,it,Ht,Kt,Et){var we=typeof Re;(we==="undefined"||we==="boolean")&&(Re=null);var vt=!1;if(Re===null)vt=!0;else switch(we){case"string":case"number":vt=!0;break;case"object":switch(Re.$$typeof){case l:case u:vt=!0}}if(vt)return vt=Re,Et=Et(vt),Re=Kt===""?"."+Ke(vt,0):Kt,Ce(Et)?(Ht="",Re!=null&&(Ht=Re.replace(Ft,"$&/")+"/"),Yt(Et,it,Ht,"",function(ar){return ar})):Et!=null&&(Ze(Et)&&(Et=Ue(Et,Ht+(!Et.key||vt&&vt.key===Et.key?"":(""+Et.key).replace(Ft,"$&/")+"/")+Re)),it.push(Et)),1;if(vt=0,Kt=Kt===""?".":Kt+":",Ce(Re))for(var Mt=0;Mt<Re.length;Mt++){we=Re[Mt];var Sn=Kt+Ke(we,Mt);vt+=Yt(we,it,Ht,Sn,Et)}else if(Sn=j(Re),typeof Sn=="function")for(Re=Sn.call(Re),Mt=0;!(we=Re.next()).done;)we=we.value,Sn=Kt+Ke(we,Mt++),vt+=Yt(we,it,Ht,Sn,Et);else if(we==="object")throw it=String(Re),Error("Objects are not valid as a React child (found: "+(it==="[object Object]"?"object with keys {"+Object.keys(Re).join(", ")+"}":it)+"). If you meant to render a collection of children, use an array instead.");return vt}function mt(Re,it,Ht){if(Re==null)return Re;var Kt=[],Et=0;return Yt(Re,Kt,"","",function(we){return it.call(Ht,we,Et++)}),Kt}function nt(Re){if(Re._status===-1){var it=Re._result;it=it(),it.then(function(Ht){(Re._status===0||Re._status===-1)&&(Re._status=1,Re._result=Ht)},function(Ht){(Re._status===0||Re._status===-1)&&(Re._status=2,Re._result=Ht)}),Re._status===-1&&(Re._status=0,Re._result=it)}if(Re._status===1)return Re._result.default;throw Re._result}var Ee={current:null},ct={transition:null},Nt={ReactCurrentDispatcher:Ee,ReactCurrentBatchConfig:ct,ReactCurrentOwner:ft};o.Children={map:mt,forEach:function(Re,it,Ht){mt(Re,function(){it.apply(this,arguments)},Ht)},count:function(Re){var it=0;return mt(Re,function(){it++}),it},toArray:function(Re){return mt(Re,function(it){return it})||[]},only:function(Re){if(!Ze(Re))throw Error("React.Children.only expected to receive a single React element child.");return Re}},o.Component=ae,o.Fragment=m,o.Profiler=S,o.PureComponent=ye,o.StrictMode=_,o.Suspense=L,o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nt,o.cloneElement=function(Re,it,Ht){if(Re==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Re+".");var Kt=Q({},Re.props),Et=Re.key,we=Re.ref,vt=Re._owner;if(it!=null){if(it.ref!==void 0&&(we=it.ref,vt=ft.current),it.key!==void 0&&(Et=""+it.key),Re.type&&Re.type.defaultProps)var Mt=Re.type.defaultProps;for(Sn in it)Se.call(it,Sn)&&!ke.hasOwnProperty(Sn)&&(Kt[Sn]=it[Sn]===void 0&&Mt!==void 0?Mt[Sn]:it[Sn])}var Sn=arguments.length-2;if(Sn===1)Kt.children=Ht;else if(1<Sn){Mt=Array(Sn);for(var ar=0;ar<Sn;ar++)Mt[ar]=arguments[ar+2];Kt.children=Mt}return{$$typeof:l,type:Re.type,key:Et,ref:we,props:Kt,_owner:vt}},o.createContext=function(Re){return Re={$$typeof:P,_currentValue:Re,_currentValue2:Re,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Re.Provider={$$typeof:M,_context:Re},Re.Consumer=Re},o.createElement=be,o.createFactory=function(Re){var it=be.bind(null,Re);return it.type=Re,it},o.createRef=function(){return{current:null}},o.forwardRef=function(Re){return{$$typeof:k,render:Re}},o.isValidElement=Ze,o.lazy=function(Re){return{$$typeof:$,_payload:{_status:-1,_result:Re},_init:nt}},o.memo=function(Re,it){return{$$typeof:z,type:Re,compare:it===void 0?null:it}},o.startTransition=function(Re){var it=ct.transition;ct.transition={};try{Re()}finally{ct.transition=it}},o.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},o.useCallback=function(Re,it){return Ee.current.useCallback(Re,it)},o.useContext=function(Re){return Ee.current.useContext(Re)},o.useDebugValue=function(){},o.useDeferredValue=function(Re){return Ee.current.useDeferredValue(Re)},o.useEffect=function(Re,it){return Ee.current.useEffect(Re,it)},o.useId=function(){return Ee.current.useId()},o.useImperativeHandle=function(Re,it,Ht){return Ee.current.useImperativeHandle(Re,it,Ht)},o.useInsertionEffect=function(Re,it){return Ee.current.useInsertionEffect(Re,it)},o.useLayoutEffect=function(Re,it){return Ee.current.useLayoutEffect(Re,it)},o.useMemo=function(Re,it){return Ee.current.useMemo(Re,it)},o.useReducer=function(Re,it,Ht){return Ee.current.useReducer(Re,it,Ht)},o.useRef=function(Re){return Ee.current.useRef(Re)},o.useState=function(Re){return Ee.current.useState(Re)},o.useSyncExternalStore=function(Re,it,Ht){return Ee.current.useSyncExternalStore(Re,it,Ht)},o.useTransition=function(){return Ee.current.useTransition()},o.version="18.2.0"}),et=ne((o,l)=>{l.exports=Lxe()}),Fxe=ne(o=>{function l(Ee,ct){var Nt=Ee.length;Ee.push(ct);e:for(;0<Nt;){var Re=Nt-1>>>1,it=Ee[Re];if(0<_(it,ct))Ee[Re]=ct,Ee[Nt]=it,Nt=Re;else break e}}function u(Ee){return Ee.length===0?null:Ee[0]}function m(Ee){if(Ee.length===0)return null;var ct=Ee[0],Nt=Ee.pop();if(Nt!==ct){Ee[0]=Nt;e:for(var Re=0,it=Ee.length,Ht=it>>>1;Re<Ht;){var Kt=2*(Re+1)-1,Et=Ee[Kt],we=Kt+1,vt=Ee[we];if(0>_(Et,Nt))we<it&&0>_(vt,Et)?(Ee[Re]=vt,Ee[we]=Nt,Re=we):(Ee[Re]=Et,Ee[Kt]=Nt,Re=Kt);else if(we<it&&0>_(vt,Nt))Ee[Re]=vt,Ee[we]=Nt,Re=we;else break e}}return ct}function _(Ee,ct){var Nt=Ee.sortIndex-ct.sortIndex;return Nt!==0?Nt:Ee.id-ct.id}typeof performance=="object"&&typeof performance.now=="function"?(S=performance,o.unstable_now=function(){return S.now()}):(M=Date,P=M.now(),o.unstable_now=function(){return M.now()-P});var S,M,P,k=[],L=[],z=1,$=null,H=3,j=!1,K=!1,Q=!1,re=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ye(Ee){for(var ct=u(L);ct!==null;){if(ct.callback===null)m(L);else if(ct.startTime<=Ee)m(L),ct.sortIndex=ct.expirationTime,l(k,ct);else break;ct=u(L)}}function Ae(Ee){if(Q=!1,ye(Ee),!K)if(u(k)!==null)K=!0,mt(Ce);else{var ct=u(L);ct!==null&&nt(Ae,ct.startTime-Ee)}}function Ce(Ee,ct){K=!1,Q&&(Q=!1,ae(ke),ke=-1),j=!0;var Nt=H;try{for(ye(ct),$=u(k);$!==null&&(!($.expirationTime>ct)||Ee&&!Ze());){var Re=$.callback;if(typeof Re=="function"){$.callback=null,H=$.priorityLevel;var it=Re($.expirationTime<=ct);ct=o.unstable_now(),typeof it=="function"?$.callback=it:$===u(k)&&m(k),ye(ct)}else m(k);$=u(k)}if($!==null)var Ht=!0;else{var Kt=u(L);Kt!==null&&nt(Ae,Kt.startTime-ct),Ht=!1}return Ht}finally{$=null,H=Nt,j=!1}}var Se=!1,ft=null,ke=-1,be=5,Ue=-1;function Ze(){return!(o.unstable_now()-Ue<be)}function ze(){if(ft!==null){var Ee=o.unstable_now();Ue=Ee;var ct=!0;try{ct=ft(!0,Ee)}finally{ct?Ft():(Se=!1,ft=null)}}else Se=!1}var Ft;typeof ue=="function"?Ft=function(){ue(ze)}:typeof MessageChannel<"u"?(Ke=new MessageChannel,Yt=Ke.port2,Ke.port1.onmessage=ze,Ft=function(){Yt.postMessage(null)}):Ft=function(){re(ze,0)};var Ke,Yt;function mt(Ee){ft=Ee,Se||(Se=!0,Ft())}function nt(Ee,ct){ke=re(function(){Ee(o.unstable_now())},ct)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Ee){Ee.callback=null},o.unstable_continueExecution=function(){K||j||(K=!0,mt(Ce))},o.unstable_forceFrameRate=function(Ee){0>Ee||125<Ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):be=0<Ee?Math.floor(1e3/Ee):5},o.unstable_getCurrentPriorityLevel=function(){return H},o.unstable_getFirstCallbackNode=function(){return u(k)},o.unstable_next=function(Ee){switch(H){case 1:case 2:case 3:var ct=3;break;default:ct=H}var Nt=H;H=ct;try{return Ee()}finally{H=Nt}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Ee,ct){switch(Ee){case 1:case 2:case 3:case 4:case 5:break;default:Ee=3}var Nt=H;H=Ee;try{return ct()}finally{H=Nt}},o.unstable_scheduleCallback=function(Ee,ct,Nt){var Re=o.unstable_now();switch(typeof Nt=="object"&&Nt!==null?(Nt=Nt.delay,Nt=typeof Nt=="number"&&0<Nt?Re+Nt:Re):Nt=Re,Ee){case 1:var it=-1;break;case 2:it=250;break;case 5:it=1073741823;break;case 4:it=1e4;break;default:it=5e3}return it=Nt+it,Ee={id:z++,callback:ct,priorityLevel:Ee,startTime:Nt,expirationTime:it,sortIndex:-1},Nt>Re?(Ee.sortIndex=Nt,l(L,Ee),u(k)===null&&Ee===u(L)&&(Q?(ae(ke),ke=-1):Q=!0,nt(Ae,Nt-Re))):(Ee.sortIndex=it,l(k,Ee),K||j||(K=!0,mt(Ce))),Ee},o.unstable_shouldYield=Ze,o.unstable_wrapCallback=function(Ee){var ct=H;return function(){var Nt=H;H=ct;try{return Ee.apply(this,arguments)}finally{H=Nt}}}}),Uxe=ne((o,l)=>{l.exports=Fxe()}),Bxe=ne(o=>{var l=et(),u=Uxe();function m(f){for(var v="https://reactjs.org/docs/error-decoder.html?invariant="+f,E=1;E<arguments.length;E++)v+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+f+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _=new Set,S={};function M(f,v){P(f,v),P(f+"Capture",v)}function P(f,v){for(S[f]=v,f=0;f<v.length;f++)_.add(v[f])}var k=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),L=Object.prototype.hasOwnProperty,z=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$={},H={};function j(f){return L.call(H,f)?!0:L.call($,f)?!1:z.test(f)?H[f]=!0:($[f]=!0,!1)}function K(f,v,E,O){if(E!==null&&E.type===0)return!1;switch(typeof v){case"function":case"symbol":return!0;case"boolean":return O?!1:E!==null?!E.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function Q(f,v,E,O){if(v===null||typeof v>"u"||K(f,v,E,O))return!0;if(O)return!1;if(E!==null)switch(E.type){case 3:return!v;case 4:return v===!1;case 5:return isNaN(v);case 6:return isNaN(v)||1>v}return!1}function re(f,v,E,O,q,ee,pe){this.acceptsBooleans=v===2||v===3||v===4,this.attributeName=O,this.attributeNamespace=q,this.mustUseProperty=E,this.propertyName=f,this.type=v,this.sanitizeURL=ee,this.removeEmptyString=pe}var ae={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){ae[f]=new re(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var v=f[0];ae[v]=new re(v,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){ae[f]=new re(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){ae[f]=new re(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){ae[f]=new re(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){ae[f]=new re(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){ae[f]=new re(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){ae[f]=new re(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){ae[f]=new re(f,5,!1,f.toLowerCase(),null,!1,!1)});var ue=/[\-:]([a-z])/g;function ye(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var v=f.replace(ue,ye);ae[v]=new re(v,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var v=f.replace(ue,ye);ae[v]=new re(v,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var v=f.replace(ue,ye);ae[v]=new re(v,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){ae[f]=new re(f,1,!1,f.toLowerCase(),null,!1,!1)}),ae.xlinkHref=new re("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){ae[f]=new re(f,1,!1,f.toLowerCase(),null,!0,!0)});function Ae(f,v,E,O){var q=ae.hasOwnProperty(v)?ae[v]:null;(q!==null?q.type!==0:O||!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(Q(v,E,q,O)&&(E=null),O||q===null?j(v)&&(E===null?f.removeAttribute(v):f.setAttribute(v,""+E)):q.mustUseProperty?f[q.propertyName]=E===null?q.type===3?!1:"":E:(v=q.attributeName,O=q.attributeNamespace,E===null?f.removeAttribute(v):(q=q.type,E=q===3||q===4&&E===!0?"":""+E,O?f.setAttributeNS(O,v,E):f.setAttribute(v,E))))}var Ce=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Se=Symbol.for("react.element"),ft=Symbol.for("react.portal"),ke=Symbol.for("react.fragment"),be=Symbol.for("react.strict_mode"),Ue=Symbol.for("react.profiler"),Ze=Symbol.for("react.provider"),ze=Symbol.for("react.context"),Ft=Symbol.for("react.forward_ref"),Ke=Symbol.for("react.suspense"),Yt=Symbol.for("react.suspense_list"),mt=Symbol.for("react.memo"),nt=Symbol.for("react.lazy"),Ee=Symbol.for("react.offscreen"),ct=Symbol.iterator;function Nt(f){return f===null||typeof f!="object"?null:(f=ct&&f[ct]||f["@@iterator"],typeof f=="function"?f:null)}var Re=Object.assign,it;function Ht(f){if(it===void 0)try{throw Error()}catch(E){var v=E.stack.trim().match(/\n( *(at )?)/);it=v&&v[1]||""}return`
`+it+f}var Kt=!1;function Et(f,v){if(!f||Kt)return"";Kt=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(v)if(v=function(){throw Error()},Object.defineProperty(v.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(v,[])}catch(kt){var O=kt}Reflect.construct(f,[],v)}else{try{v.call()}catch(kt){O=kt}f.call(v.prototype)}else{try{throw Error()}catch(kt){O=kt}f()}}catch(kt){if(kt&&O&&typeof kt.stack=="string"){for(var q=kt.stack.split(`
`),ee=O.stack.split(`
`),pe=q.length-1,Le=ee.length-1;1<=pe&&0<=Le&&q[pe]!==ee[Le];)Le--;for(;1<=pe&&0<=Le;pe--,Le--)if(q[pe]!==ee[Le]){if(pe!==1||Le!==1)do if(pe--,Le--,0>Le||q[pe]!==ee[Le]){var tt=`
`+q[pe].replace(" at new "," at ");return f.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",f.displayName)),tt}while(1<=pe&&0<=Le);break}}}finally{Kt=!1,Error.prepareStackTrace=E}return(f=f?f.displayName||f.name:"")?Ht(f):""}function we(f){switch(f.tag){case 5:return Ht(f.type);case 16:return Ht("Lazy");case 13:return Ht("Suspense");case 19:return Ht("SuspenseList");case 0:case 2:case 15:return f=Et(f.type,!1),f;case 11:return f=Et(f.type.render,!1),f;case 1:return f=Et(f.type,!0),f;default:return""}}function vt(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case ke:return"Fragment";case ft:return"Portal";case Ue:return"Profiler";case be:return"StrictMode";case Ke:return"Suspense";case Yt:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case ze:return(f.displayName||"Context")+".Consumer";case Ze:return(f._context.displayName||"Context")+".Provider";case Ft:var v=f.render;return f=f.displayName,f||(f=v.displayName||v.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case mt:return v=f.displayName||null,v!==null?v:vt(f.type)||"Memo";case nt:v=f._payload,f=f._init;try{return vt(f(v))}catch{}}return null}function Mt(f){var v=f.type;switch(f.tag){case 24:return"Cache";case 9:return(v.displayName||"Context")+".Consumer";case 10:return(v._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=v.render,f=f.displayName||f.name||"",v.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return v;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vt(v);case 8:return v===be?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v}return null}function Sn(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function ar(f){var v=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function yr(f){var v=ar(f)?"checked":"value",E=Object.getOwnPropertyDescriptor(f.constructor.prototype,v),O=""+f[v];if(!f.hasOwnProperty(v)&&typeof E<"u"&&typeof E.get=="function"&&typeof E.set=="function"){var q=E.get,ee=E.set;return Object.defineProperty(f,v,{configurable:!0,get:function(){return q.call(this)},set:function(pe){O=""+pe,ee.call(this,pe)}}),Object.defineProperty(f,v,{enumerable:E.enumerable}),{getValue:function(){return O},setValue:function(pe){O=""+pe},stopTracking:function(){f._valueTracker=null,delete f[v]}}}}function Pr(f){f._valueTracker||(f._valueTracker=yr(f))}function vi(f){if(!f)return!1;var v=f._valueTracker;if(!v)return!0;var E=v.getValue(),O="";return f&&(O=ar(f)?f.checked?"true":"false":f.value),f=O,f!==E?(v.setValue(f),!0):!1}function Is(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function ei(f,v){var E=v.checked;return Re({},v,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:E??f._wrapperState.initialChecked})}function uo(f,v){var E=v.defaultValue==null?"":v.defaultValue,O=v.checked!=null?v.checked:v.defaultChecked;E=Sn(v.value!=null?v.value:E),f._wrapperState={initialChecked:O,initialValue:E,controlled:v.type==="checkbox"||v.type==="radio"?v.checked!=null:v.value!=null}}function pi(f,v){v=v.checked,v!=null&&Ae(f,"checked",v,!1)}function wi(f,v){pi(f,v);var E=Sn(v.value),O=v.type;if(E!=null)O==="number"?(E===0&&f.value===""||f.value!=E)&&(f.value=""+E):f.value!==""+E&&(f.value=""+E);else if(O==="submit"||O==="reset"){f.removeAttribute("value");return}v.hasOwnProperty("value")?Go(f,v.type,E):v.hasOwnProperty("defaultValue")&&Go(f,v.type,Sn(v.defaultValue)),v.checked==null&&v.defaultChecked!=null&&(f.defaultChecked=!!v.defaultChecked)}function _0(f,v,E){if(v.hasOwnProperty("value")||v.hasOwnProperty("defaultValue")){var O=v.type;if(!(O!=="submit"&&O!=="reset"||v.value!==void 0&&v.value!==null))return;v=""+f._wrapperState.initialValue,E||v===f.value||(f.value=v),f.defaultValue=v}E=f.name,E!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,E!==""&&(f.name=E)}function Go(f,v,E){(v!=="number"||Is(f.ownerDocument)!==f)&&(E==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+E&&(f.defaultValue=""+E))}var lh=Array.isArray;function hu(f,v,E,O){if(f=f.options,v){v={};for(var q=0;q<E.length;q++)v["$"+E[q]]=!0;for(E=0;E<f.length;E++)q=v.hasOwnProperty("$"+f[E].value),f[E].selected!==q&&(f[E].selected=q),q&&O&&(f[E].defaultSelected=!0)}else{for(E=""+Sn(E),v=null,q=0;q<f.length;q++){if(f[q].value===E){f[q].selected=!0,O&&(f[q].defaultSelected=!0);return}v!==null||f[q].disabled||(v=f[q])}v!==null&&(v.selected=!0)}}function x0(f,v){if(v.dangerouslySetInnerHTML!=null)throw Error(m(91));return Re({},v,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function Hr(f,v){var E=v.value;if(E==null){if(E=v.children,v=v.defaultValue,E!=null){if(v!=null)throw Error(m(92));if(lh(E)){if(1<E.length)throw Error(m(93));E=E[0]}v=E}v==null&&(v=""),E=v}f._wrapperState={initialValue:Sn(E)}}function ci(f,v){var E=Sn(v.value),O=Sn(v.defaultValue);E!=null&&(E=""+E,E!==f.value&&(f.value=E),v.defaultValue==null&&f.defaultValue!==E&&(f.defaultValue=E)),O!=null&&(f.defaultValue=""+O)}function Xg(f){var v=f.textContent;v===f._wrapperState.initialValue&&v!==""&&v!==null&&(f.value=v)}function F7(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ch(f,v){return f==null||f==="http://www.w3.org/1999/xhtml"?F7(v):f==="http://www.w3.org/2000/svg"&&v==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var hR,Jme=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(v,E,O,q){MSApp.execUnsafeLocalFunction(function(){return f(v,E,O,q)})}:f}(function(f,v){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=v;else{for(hR=hR||document.createElement("div"),hR.innerHTML="<svg>"+v.valueOf().toString()+"</svg>",v=hR.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;v.firstChild;)f.appendChild(v.firstChild)}});function pw(f,v){if(v){var E=f.firstChild;if(E&&E===f.lastChild&&E.nodeType===3){E.nodeValue=v;return}}f.textContent=v}var mw={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},YPe=["Webkit","ms","Moz","O"];Object.keys(mw).forEach(function(f){YPe.forEach(function(v){v=v+f.charAt(0).toUpperCase()+f.substring(1),mw[v]=mw[f]})});function ege(f,v,E){return v==null||typeof v=="boolean"||v===""?"":E||typeof v!="number"||v===0||mw.hasOwnProperty(f)&&mw[f]?(""+v).trim():v+"px"}function tge(f,v){f=f.style;for(var E in v)if(v.hasOwnProperty(E)){var O=E.indexOf("--")===0,q=ege(E,v[E],O);E==="float"&&(E="cssFloat"),O?f.setProperty(E,q):f[E]=q}}var KPe=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oz(f,v){if(v){if(KPe[f]&&(v.children!=null||v.dangerouslySetInnerHTML!=null))throw Error(m(137,f));if(v.dangerouslySetInnerHTML!=null){if(v.children!=null)throw Error(m(60));if(typeof v.dangerouslySetInnerHTML!="object"||!("__html"in v.dangerouslySetInnerHTML))throw Error(m(61))}if(v.style!=null&&typeof v.style!="object")throw Error(m(62))}}function Lz(f,v){if(f.indexOf("-")===-1)return typeof v.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fz=null;function Uz(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Bz=null,U7=null,B7=null;function nge(f){if(f=Lw(f)){if(typeof Bz!="function")throw Error(m(280));var v=f.stateNode;v&&(v=UR(v),Bz(f.stateNode,f.type,v))}}function rge(f){U7?B7?B7.push(f):B7=[f]:U7=f}function ige(){if(U7){var f=U7,v=B7;if(B7=U7=null,nge(f),v)for(f=0;f<v.length;f++)nge(v[f])}}function sge(f,v){return f(v)}function oge(){}var zz=!1;function age(f,v,E){if(zz)return f(v,E);zz=!0;try{return sge(f,v,E)}finally{zz=!1,(U7!==null||B7!==null)&&(oge(),ige())}}function gw(f,v){var E=f.stateNode;if(E===null)return null;var O=UR(E);if(O===null)return null;E=O[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(f=f.type,O=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!O;break e;default:f=!1}if(f)return null;if(E&&typeof E!="function")throw Error(m(231,v,typeof E));return E}var Vz=!1;if(k)try{z7={},Object.defineProperty(z7,"passive",{get:function(){Vz=!0}}),window.addEventListener("test",z7,z7),window.removeEventListener("test",z7,z7)}catch{Vz=!1}var z7;function ZPe(f,v,E,O,q,ee,pe,Le,tt){var kt=Array.prototype.slice.call(arguments,3);try{v.apply(E,kt)}catch(hn){this.onError(hn)}}var vw=!1,fR=null,pR=!1,Gz=null,QPe={onError:function(f){vw=!0,fR=f}};function JPe(f,v,E,O,q,ee,pe,Le,tt){vw=!1,fR=null,ZPe.apply(QPe,arguments)}function eRe(f,v,E,O,q,ee,pe,Le,tt){if(JPe.apply(this,arguments),vw){if(vw){var kt=fR;vw=!1,fR=null}else throw Error(m(198));pR||(pR=!0,Gz=kt)}}function l8(f){var v=f,E=f;if(f.alternate)for(;v.return;)v=v.return;else{f=v;do v=f,v.flags&4098&&(E=v.return),f=v.return;while(f)}return v.tag===3?E:null}function lge(f){if(f.tag===13){var v=f.memoizedState;if(v===null&&(f=f.alternate,f!==null&&(v=f.memoizedState)),v!==null)return v.dehydrated}return null}function cge(f){if(l8(f)!==f)throw Error(m(188))}function tRe(f){var v=f.alternate;if(!v){if(v=l8(f),v===null)throw Error(m(188));return v!==f?null:f}for(var E=f,O=v;;){var q=E.return;if(q===null)break;var ee=q.alternate;if(ee===null){if(O=q.return,O!==null){E=O;continue}break}if(q.child===ee.child){for(ee=q.child;ee;){if(ee===E)return cge(q),f;if(ee===O)return cge(q),v;ee=ee.sibling}throw Error(m(188))}if(E.return!==O.return)E=q,O=ee;else{for(var pe=!1,Le=q.child;Le;){if(Le===E){pe=!0,E=q,O=ee;break}if(Le===O){pe=!0,O=q,E=ee;break}Le=Le.sibling}if(!pe){for(Le=ee.child;Le;){if(Le===E){pe=!0,E=ee,O=q;break}if(Le===O){pe=!0,O=ee,E=q;break}Le=Le.sibling}if(!pe)throw Error(m(189))}}if(E.alternate!==O)throw Error(m(190))}if(E.tag!==3)throw Error(m(188));return E.stateNode.current===E?f:v}function uge(f){return f=tRe(f),f!==null?dge(f):null}function dge(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var v=dge(f);if(v!==null)return v;f=f.sibling}return null}var hge=u.unstable_scheduleCallback,fge=u.unstable_cancelCallback,nRe=u.unstable_shouldYield,rRe=u.unstable_requestPaint,ba=u.unstable_now,iRe=u.unstable_getCurrentPriorityLevel,jz=u.unstable_ImmediatePriority,pge=u.unstable_UserBlockingPriority,mR=u.unstable_NormalPriority,sRe=u.unstable_LowPriority,mge=u.unstable_IdlePriority,gR=null,P1=null;function oRe(f){if(P1&&typeof P1.onCommitFiberRoot=="function")try{P1.onCommitFiberRoot(gR,f,void 0,(f.current.flags&128)===128)}catch{}}var kf=Math.clz32?Math.clz32:cRe,aRe=Math.log,lRe=Math.LN2;function cRe(f){return f>>>=0,f===0?32:31-(aRe(f)/lRe|0)|0}var vR=64,yR=4194304;function yw(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function _R(f,v){var E=f.pendingLanes;if(E===0)return 0;var O=0,q=f.suspendedLanes,ee=f.pingedLanes,pe=E&268435455;if(pe!==0){var Le=pe&~q;Le!==0?O=yw(Le):(ee&=pe,ee!==0&&(O=yw(ee)))}else pe=E&~q,pe!==0?O=yw(pe):ee!==0&&(O=yw(ee));if(O===0)return 0;if(v!==0&&v!==O&&!(v&q)&&(q=O&-O,ee=v&-v,q>=ee||q===16&&(ee&4194240)!==0))return v;if(O&4&&(O|=E&16),v=f.entangledLanes,v!==0)for(f=f.entanglements,v&=O;0<v;)E=31-kf(v),q=1<<E,O|=f[E],v&=~q;return O}function uRe(f,v){switch(f){case 1:case 2:case 4:return v+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dRe(f,v){for(var E=f.suspendedLanes,O=f.pingedLanes,q=f.expirationTimes,ee=f.pendingLanes;0<ee;){var pe=31-kf(ee),Le=1<<pe,tt=q[pe];tt===-1?(!(Le&E)||Le&O)&&(q[pe]=uRe(Le,v)):tt<=v&&(f.expiredLanes|=Le),ee&=~Le}}function Hz(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function gge(){var f=vR;return vR<<=1,!(vR&4194240)&&(vR=64),f}function Wz(f){for(var v=[],E=0;31>E;E++)v.push(f);return v}function _w(f,v,E){f.pendingLanes|=v,v!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,v=31-kf(v),f[v]=E}function hRe(f,v){var E=f.pendingLanes&~v;f.pendingLanes=v,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=v,f.mutableReadLanes&=v,f.entangledLanes&=v,v=f.entanglements;var O=f.eventTimes;for(f=f.expirationTimes;0<E;){var q=31-kf(E),ee=1<<q;v[q]=0,O[q]=-1,f[q]=-1,E&=~ee}}function qz(f,v){var E=f.entangledLanes|=v;for(f=f.entanglements;E;){var O=31-kf(E),q=1<<O;q&v|f[O]&v&&(f[O]|=v),E&=~q}}var Ns=0;function vge(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var yge,$z,_ge,xge,bge,Xz=!1,xR=[],T9=null,E9=null,M9=null,xw=new Map,bw=new Map,C9=[],fRe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sge(f,v){switch(f){case"focusin":case"focusout":T9=null;break;case"dragenter":case"dragleave":E9=null;break;case"mouseover":case"mouseout":M9=null;break;case"pointerover":case"pointerout":xw.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":bw.delete(v.pointerId)}}function Sw(f,v,E,O,q,ee){return f===null||f.nativeEvent!==ee?(f={blockedOn:v,domEventName:E,eventSystemFlags:O,nativeEvent:ee,targetContainers:[q]},v!==null&&(v=Lw(v),v!==null&&$z(v)),f):(f.eventSystemFlags|=O,v=f.targetContainers,q!==null&&v.indexOf(q)===-1&&v.push(q),f)}function pRe(f,v,E,O,q){switch(v){case"focusin":return T9=Sw(T9,f,v,E,O,q),!0;case"dragenter":return E9=Sw(E9,f,v,E,O,q),!0;case"mouseover":return M9=Sw(M9,f,v,E,O,q),!0;case"pointerover":var ee=q.pointerId;return xw.set(ee,Sw(xw.get(ee)||null,f,v,E,O,q)),!0;case"gotpointercapture":return ee=q.pointerId,bw.set(ee,Sw(bw.get(ee)||null,f,v,E,O,q)),!0}return!1}function wge(f){var v=c8(f.target);if(v!==null){var E=l8(v);if(E!==null){if(v=E.tag,v===13){if(v=lge(E),v!==null){f.blockedOn=v,bge(f.priority,function(){_ge(E)});return}}else if(v===3&&E.stateNode.current.memoizedState.isDehydrated){f.blockedOn=E.tag===3?E.stateNode.containerInfo:null;return}}}f.blockedOn=null}function bR(f){if(f.blockedOn!==null)return!1;for(var v=f.targetContainers;0<v.length;){var E=Kz(f.domEventName,f.eventSystemFlags,v[0],f.nativeEvent);if(E===null){E=f.nativeEvent;var O=new E.constructor(E.type,E);Fz=O,E.target.dispatchEvent(O),Fz=null}else return v=Lw(E),v!==null&&$z(v),f.blockedOn=E,!1;v.shift()}return!0}function Tge(f,v,E){bR(f)&&E.delete(v)}function mRe(){Xz=!1,T9!==null&&bR(T9)&&(T9=null),E9!==null&&bR(E9)&&(E9=null),M9!==null&&bR(M9)&&(M9=null),xw.forEach(Tge),bw.forEach(Tge)}function ww(f,v){f.blockedOn===v&&(f.blockedOn=null,Xz||(Xz=!0,u.unstable_scheduleCallback(u.unstable_NormalPriority,mRe)))}function Tw(f){function v(q){return ww(q,f)}if(0<xR.length){ww(xR[0],f);for(var E=1;E<xR.length;E++){var O=xR[E];O.blockedOn===f&&(O.blockedOn=null)}}for(T9!==null&&ww(T9,f),E9!==null&&ww(E9,f),M9!==null&&ww(M9,f),xw.forEach(v),bw.forEach(v),E=0;E<C9.length;E++)O=C9[E],O.blockedOn===f&&(O.blockedOn=null);for(;0<C9.length&&(E=C9[0],E.blockedOn===null);)wge(E),E.blockedOn===null&&C9.shift()}var V7=Ce.ReactCurrentBatchConfig,SR=!0;function gRe(f,v,E,O){var q=Ns,ee=V7.transition;V7.transition=null;try{Ns=1,Yz(f,v,E,O)}finally{Ns=q,V7.transition=ee}}function vRe(f,v,E,O){var q=Ns,ee=V7.transition;V7.transition=null;try{Ns=4,Yz(f,v,E,O)}finally{Ns=q,V7.transition=ee}}function Yz(f,v,E,O){if(SR){var q=Kz(f,v,E,O);if(q===null)dV(f,v,O,wR,E),Sge(f,O);else if(pRe(q,f,v,E,O))O.stopPropagation();else if(Sge(f,O),v&4&&-1<fRe.indexOf(f)){for(;q!==null;){var ee=Lw(q);if(ee!==null&&yge(ee),ee=Kz(f,v,E,O),ee===null&&dV(f,v,O,wR,E),ee===q)break;q=ee}q!==null&&O.stopPropagation()}else dV(f,v,O,null,E)}}var wR=null;function Kz(f,v,E,O){if(wR=null,f=Uz(O),f=c8(f),f!==null)if(v=l8(f),v===null)f=null;else if(E=v.tag,E===13){if(f=lge(v),f!==null)return f;f=null}else if(E===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;f=null}else v!==f&&(f=null);return wR=f,null}function Ege(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iRe()){case jz:return 1;case pge:return 4;case mR:case sRe:return 16;case mge:return 536870912;default:return 16}default:return 16}}var A9=null,Zz=null,TR=null;function Mge(){if(TR)return TR;var f,v=Zz,E=v.length,O,q="value"in A9?A9.value:A9.textContent,ee=q.length;for(f=0;f<E&&v[f]===q[f];f++);var pe=E-f;for(O=1;O<=pe&&v[E-O]===q[ee-O];O++);return TR=q.slice(f,1<O?1-O:void 0)}function ER(f){var v=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&v===13&&(f=13)):f=v,f===10&&(f=13),32<=f||f===13?f:0}function MR(){return!0}function Cge(){return!1}function ud(f){function v(E,O,q,ee,pe){this._reactName=E,this._targetInst=q,this.type=O,this.nativeEvent=ee,this.target=pe,this.currentTarget=null;for(var Le in f)f.hasOwnProperty(Le)&&(E=f[Le],this[Le]=E?E(ee):ee[Le]);return this.isDefaultPrevented=(ee.defaultPrevented!=null?ee.defaultPrevented:ee.returnValue===!1)?MR:Cge,this.isPropagationStopped=Cge,this}return Re(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var E=this.nativeEvent;E&&(E.preventDefault?E.preventDefault():typeof E.returnValue!="unknown"&&(E.returnValue=!1),this.isDefaultPrevented=MR)},stopPropagation:function(){var E=this.nativeEvent;E&&(E.stopPropagation?E.stopPropagation():typeof E.cancelBubble!="unknown"&&(E.cancelBubble=!0),this.isPropagationStopped=MR)},persist:function(){},isPersistent:MR}),v}var G7={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qz=ud(G7),Ew=Re({},G7,{view:0,detail:0}),yRe=ud(Ew),Jz,eV,Mw,CR=Re({},Ew,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nV,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==Mw&&(Mw&&f.type==="mousemove"?(Jz=f.screenX-Mw.screenX,eV=f.screenY-Mw.screenY):eV=Jz=0,Mw=f),Jz)},movementY:function(f){return"movementY"in f?f.movementY:eV}}),Age=ud(CR),_Re=Re({},CR,{dataTransfer:0}),xRe=ud(_Re),bRe=Re({},Ew,{relatedTarget:0}),tV=ud(bRe),SRe=Re({},G7,{animationName:0,elapsedTime:0,pseudoElement:0}),wRe=ud(SRe),TRe=Re({},G7,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),ERe=ud(TRe),MRe=Re({},G7,{data:0}),Pge=ud(MRe),CRe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ARe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PRe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function RRe(f){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(f):(f=PRe[f])?!!v[f]:!1}function nV(){return RRe}var IRe=Re({},Ew,{key:function(f){if(f.key){var v=CRe[f.key]||f.key;if(v!=="Unidentified")return v}return f.type==="keypress"?(f=ER(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?ARe[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nV,charCode:function(f){return f.type==="keypress"?ER(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?ER(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),NRe=ud(IRe),kRe=Re({},CR,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rge=ud(kRe),DRe=Re({},Ew,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nV}),ORe=ud(DRe),LRe=Re({},G7,{propertyName:0,elapsedTime:0,pseudoElement:0}),FRe=ud(LRe),URe=Re({},CR,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),BRe=ud(URe),zRe=[9,13,27,32],rV=k&&"CompositionEvent"in window,Cw=null;k&&"documentMode"in document&&(Cw=document.documentMode);var VRe=k&&"TextEvent"in window&&!Cw,Ige=k&&(!rV||Cw&&8<Cw&&11>=Cw),Nge=" ",kge=!1;function Dge(f,v){switch(f){case"keyup":return zRe.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oge(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var j7=!1;function GRe(f,v){switch(f){case"compositionend":return Oge(v);case"keypress":return v.which!==32?null:(kge=!0,Nge);case"textInput":return f=v.data,f===Nge&&kge?null:f;default:return null}}function jRe(f,v){if(j7)return f==="compositionend"||!rV&&Dge(f,v)?(f=Mge(),TR=Zz=A9=null,j7=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return Ige&&v.locale!=="ko"?null:v.data;default:return null}}var HRe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lge(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v==="input"?!!HRe[f.type]:v==="textarea"}function Fge(f,v,E,O){rge(O),v=OR(v,"onChange"),0<v.length&&(E=new Qz("onChange","change",null,E,O),f.push({event:E,listeners:v}))}var Aw=null,Pw=null;function WRe(f){n2e(f,0)}function AR(f){var v=X7(f);if(vi(v))return f}function qRe(f,v){if(f==="change")return v}var Uge=!1;k&&(k?(PR="oninput"in document,PR||(sV=document.createElement("div"),sV.setAttribute("oninput","return;"),PR=typeof sV.oninput=="function"),iV=PR):iV=!1,Uge=iV&&(!document.documentMode||9<document.documentMode));var iV,PR,sV;function Bge(){Aw&&(Aw.detachEvent("onpropertychange",zge),Pw=Aw=null)}function zge(f){if(f.propertyName==="value"&&AR(Pw)){var v=[];Fge(v,Pw,f,Uz(f)),age(WRe,v)}}function $Re(f,v,E){f==="focusin"?(Bge(),Aw=v,Pw=E,Aw.attachEvent("onpropertychange",zge)):f==="focusout"&&Bge()}function XRe(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return AR(Pw)}function YRe(f,v){if(f==="click")return AR(v)}function KRe(f,v){if(f==="input"||f==="change")return AR(v)}function ZRe(f,v){return f===v&&(f!==0||1/f===1/v)||f!==f&&v!==v}var Df=typeof Object.is=="function"?Object.is:ZRe;function Rw(f,v){if(Df(f,v))return!0;if(typeof f!="object"||f===null||typeof v!="object"||v===null)return!1;var E=Object.keys(f),O=Object.keys(v);if(E.length!==O.length)return!1;for(O=0;O<E.length;O++){var q=E[O];if(!L.call(v,q)||!Df(f[q],v[q]))return!1}return!0}function Vge(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function Gge(f,v){var E=Vge(f);f=0;for(var O;E;){if(E.nodeType===3){if(O=f+E.textContent.length,f<=v&&O>=v)return{node:E,offset:v-f};f=O}e:{for(;E;){if(E.nextSibling){E=E.nextSibling;break e}E=E.parentNode}E=void 0}E=Vge(E)}}function jge(f,v){return f&&v?f===v?!0:f&&f.nodeType===3?!1:v&&v.nodeType===3?jge(f,v.parentNode):"contains"in f?f.contains(v):f.compareDocumentPosition?!!(f.compareDocumentPosition(v)&16):!1:!1}function Hge(){for(var f=window,v=Is();v instanceof f.HTMLIFrameElement;){try{var E=typeof v.contentWindow.location.href=="string"}catch{E=!1}if(E)f=v.contentWindow;else break;v=Is(f.document)}return v}function oV(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v&&(v==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||v==="textarea"||f.contentEditable==="true")}function QRe(f){var v=Hge(),E=f.focusedElem,O=f.selectionRange;if(v!==E&&E&&E.ownerDocument&&jge(E.ownerDocument.documentElement,E)){if(O!==null&&oV(E)){if(v=O.start,f=O.end,f===void 0&&(f=v),"selectionStart"in E)E.selectionStart=v,E.selectionEnd=Math.min(f,E.value.length);else if(f=(v=E.ownerDocument||document)&&v.defaultView||window,f.getSelection){f=f.getSelection();var q=E.textContent.length,ee=Math.min(O.start,q);O=O.end===void 0?ee:Math.min(O.end,q),!f.extend&&ee>O&&(q=O,O=ee,ee=q),q=Gge(E,ee);var pe=Gge(E,O);q&&pe&&(f.rangeCount!==1||f.anchorNode!==q.node||f.anchorOffset!==q.offset||f.focusNode!==pe.node||f.focusOffset!==pe.offset)&&(v=v.createRange(),v.setStart(q.node,q.offset),f.removeAllRanges(),ee>O?(f.addRange(v),f.extend(pe.node,pe.offset)):(v.setEnd(pe.node,pe.offset),f.addRange(v)))}}for(v=[],f=E;f=f.parentNode;)f.nodeType===1&&v.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<v.length;E++)f=v[E],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var JRe=k&&"documentMode"in document&&11>=document.documentMode,H7=null,aV=null,Iw=null,lV=!1;function Wge(f,v,E){var O=E.window===E?E.document:E.nodeType===9?E:E.ownerDocument;lV||H7==null||H7!==Is(O)||(O=H7,"selectionStart"in O&&oV(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),Iw&&Rw(Iw,O)||(Iw=O,O=OR(aV,"onSelect"),0<O.length&&(v=new Qz("onSelect","select",null,v,E),f.push({event:v,listeners:O}),v.target=H7)))}function RR(f,v){var E={};return E[f.toLowerCase()]=v.toLowerCase(),E["Webkit"+f]="webkit"+v,E["Moz"+f]="moz"+v,E}var W7={animationend:RR("Animation","AnimationEnd"),animationiteration:RR("Animation","AnimationIteration"),animationstart:RR("Animation","AnimationStart"),transitionend:RR("Transition","TransitionEnd")},cV={},qge={};k&&(qge=document.createElement("div").style,"AnimationEvent"in window||(delete W7.animationend.animation,delete W7.animationiteration.animation,delete W7.animationstart.animation),"TransitionEvent"in window||delete W7.transitionend.transition);function IR(f){if(cV[f])return cV[f];if(!W7[f])return f;var v=W7[f],E;for(E in v)if(v.hasOwnProperty(E)&&E in qge)return cV[f]=v[E];return f}var $ge=IR("animationend"),Xge=IR("animationiteration"),Yge=IR("animationstart"),Kge=IR("transitionend"),Zge=new Map,Qge="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function P9(f,v){Zge.set(f,v),M(v,[f])}for(kR=0;kR<Qge.length;kR++)NR=Qge[kR],Jge=NR.toLowerCase(),e2e=NR[0].toUpperCase()+NR.slice(1),P9(Jge,"on"+e2e);var NR,Jge,e2e,kR;P9($ge,"onAnimationEnd"),P9(Xge,"onAnimationIteration"),P9(Yge,"onAnimationStart"),P9("dblclick","onDoubleClick"),P9("focusin","onFocus"),P9("focusout","onBlur"),P9(Kge,"onTransitionEnd"),P("onMouseEnter",["mouseout","mouseover"]),P("onMouseLeave",["mouseout","mouseover"]),P("onPointerEnter",["pointerout","pointerover"]),P("onPointerLeave",["pointerout","pointerover"]),M("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),M("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),M("onBeforeInput",["compositionend","keypress","textInput","paste"]),M("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),M("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),M("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eIe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nw));function t2e(f,v,E){var O=f.type||"unknown-event";f.currentTarget=E,eRe(O,v,void 0,f),f.currentTarget=null}function n2e(f,v){v=(v&4)!==0;for(var E=0;E<f.length;E++){var O=f[E],q=O.event;O=O.listeners;e:{var ee=void 0;if(v)for(var pe=O.length-1;0<=pe;pe--){var Le=O[pe],tt=Le.instance,kt=Le.currentTarget;if(Le=Le.listener,tt!==ee&&q.isPropagationStopped())break e;t2e(q,Le,kt),ee=tt}else for(pe=0;pe<O.length;pe++){if(Le=O[pe],tt=Le.instance,kt=Le.currentTarget,Le=Le.listener,tt!==ee&&q.isPropagationStopped())break e;t2e(q,Le,kt),ee=tt}}}if(pR)throw f=Gz,pR=!1,Gz=null,f}function ho(f,v){var E=v[vV];E===void 0&&(E=v[vV]=new Set);var O=f+"__bubble";E.has(O)||(r2e(v,f,2,!1),E.add(O))}function uV(f,v,E){var O=0;v&&(O|=4),r2e(E,f,O,v)}var DR="_reactListening"+Math.random().toString(36).slice(2);function kw(f){if(!f[DR]){f[DR]=!0,_.forEach(function(E){E!=="selectionchange"&&(eIe.has(E)||uV(E,!1,f),uV(E,!0,f))});var v=f.nodeType===9?f:f.ownerDocument;v===null||v[DR]||(v[DR]=!0,uV("selectionchange",!1,v))}}function r2e(f,v,E,O){switch(Ege(v)){case 1:var q=gRe;break;case 4:q=vRe;break;default:q=Yz}E=q.bind(null,v,E,f),q=void 0,!Vz||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(q=!0),O?q!==void 0?f.addEventListener(v,E,{capture:!0,passive:q}):f.addEventListener(v,E,!0):q!==void 0?f.addEventListener(v,E,{passive:q}):f.addEventListener(v,E,!1)}function dV(f,v,E,O,q){var ee=O;if(!(v&1)&&!(v&2)&&O!==null)e:for(;;){if(O===null)return;var pe=O.tag;if(pe===3||pe===4){var Le=O.stateNode.containerInfo;if(Le===q||Le.nodeType===8&&Le.parentNode===q)break;if(pe===4)for(pe=O.return;pe!==null;){var tt=pe.tag;if((tt===3||tt===4)&&(tt=pe.stateNode.containerInfo,tt===q||tt.nodeType===8&&tt.parentNode===q))return;pe=pe.return}for(;Le!==null;){if(pe=c8(Le),pe===null)return;if(tt=pe.tag,tt===5||tt===6){O=ee=pe;continue e}Le=Le.parentNode}}O=O.return}age(function(){var kt=ee,hn=Uz(E),mn=[];e:{var cn=Zge.get(f);if(cn!==void 0){var Jn=Qz,mr=f;switch(f){case"keypress":if(ER(E)===0)break e;case"keydown":case"keyup":Jn=NRe;break;case"focusin":mr="focus",Jn=tV;break;case"focusout":mr="blur",Jn=tV;break;case"beforeblur":case"afterblur":Jn=tV;break;case"click":if(E.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Jn=Age;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Jn=xRe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Jn=ORe;break;case $ge:case Xge:case Yge:Jn=wRe;break;case Kge:Jn=FRe;break;case"scroll":Jn=yRe;break;case"wheel":Jn=BRe;break;case"copy":case"cut":case"paste":Jn=ERe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Jn=Rge}var vr=(v&4)!==0,Sa=!vr&&f==="scroll",wt=vr?cn!==null?cn+"Capture":null:cn;vr=[];for(var ut=kt,Pt;ut!==null;){Pt=ut;var Tn=Pt.stateNode;if(Pt.tag===5&&Tn!==null&&(Pt=Tn,wt!==null&&(Tn=gw(ut,wt),Tn!=null&&vr.push(Dw(ut,Tn,Pt)))),Sa)break;ut=ut.return}0<vr.length&&(cn=new Jn(cn,mr,null,E,hn),mn.push({event:cn,listeners:vr}))}}if(!(v&7)){e:{if(cn=f==="mouseover"||f==="pointerover",Jn=f==="mouseout"||f==="pointerout",cn&&E!==Fz&&(mr=E.relatedTarget||E.fromElement)&&(c8(mr)||mr[Yg]))break e;if((Jn||cn)&&(cn=hn.window===hn?hn:(cn=hn.ownerDocument)?cn.defaultView||cn.parentWindow:window,Jn?(mr=E.relatedTarget||E.toElement,Jn=kt,mr=mr?c8(mr):null,mr!==null&&(Sa=l8(mr),mr!==Sa||mr.tag!==5&&mr.tag!==6)&&(mr=null)):(Jn=null,mr=kt),Jn!==mr)){if(vr=Age,Tn="onMouseLeave",wt="onMouseEnter",ut="mouse",(f==="pointerout"||f==="pointerover")&&(vr=Rge,Tn="onPointerLeave",wt="onPointerEnter",ut="pointer"),Sa=Jn==null?cn:X7(Jn),Pt=mr==null?cn:X7(mr),cn=new vr(Tn,ut+"leave",Jn,E,hn),cn.target=Sa,cn.relatedTarget=Pt,Tn=null,c8(hn)===kt&&(vr=new vr(wt,ut+"enter",mr,E,hn),vr.target=Pt,vr.relatedTarget=Sa,Tn=vr),Sa=Tn,Jn&&mr)t:{for(vr=Jn,wt=mr,ut=0,Pt=vr;Pt;Pt=q7(Pt))ut++;for(Pt=0,Tn=wt;Tn;Tn=q7(Tn))Pt++;for(;0<ut-Pt;)vr=q7(vr),ut--;for(;0<Pt-ut;)wt=q7(wt),Pt--;for(;ut--;){if(vr===wt||wt!==null&&vr===wt.alternate)break t;vr=q7(vr),wt=q7(wt)}vr=null}else vr=null;Jn!==null&&i2e(mn,cn,Jn,vr,!1),mr!==null&&Sa!==null&&i2e(mn,Sa,mr,vr,!0)}}e:{if(cn=kt?X7(kt):window,Jn=cn.nodeName&&cn.nodeName.toLowerCase(),Jn==="select"||Jn==="input"&&cn.type==="file")var xr=qRe;else if(Lge(cn))if(Uge)xr=KRe;else{xr=XRe;var Or=$Re}else(Jn=cn.nodeName)&&Jn.toLowerCase()==="input"&&(cn.type==="checkbox"||cn.type==="radio")&&(xr=YRe);if(xr&&(xr=xr(f,kt))){Fge(mn,xr,E,hn);break e}Or&&Or(f,cn,kt),f==="focusout"&&(Or=cn._wrapperState)&&Or.controlled&&cn.type==="number"&&Go(cn,"number",cn.value)}switch(Or=kt?X7(kt):window,f){case"focusin":(Lge(Or)||Or.contentEditable==="true")&&(H7=Or,aV=kt,Iw=null);break;case"focusout":Iw=aV=H7=null;break;case"mousedown":lV=!0;break;case"contextmenu":case"mouseup":case"dragend":lV=!1,Wge(mn,E,hn);break;case"selectionchange":if(JRe)break;case"keydown":case"keyup":Wge(mn,E,hn)}var Lr;if(rV)e:{switch(f){case"compositionstart":var Qr="onCompositionStart";break e;case"compositionend":Qr="onCompositionEnd";break e;case"compositionupdate":Qr="onCompositionUpdate";break e}Qr=void 0}else j7?Dge(f,E)&&(Qr="onCompositionEnd"):f==="keydown"&&E.keyCode===229&&(Qr="onCompositionStart");Qr&&(Ige&&E.locale!=="ko"&&(j7||Qr!=="onCompositionStart"?Qr==="onCompositionEnd"&&j7&&(Lr=Mge()):(A9=hn,Zz="value"in A9?A9.value:A9.textContent,j7=!0)),Or=OR(kt,Qr),0<Or.length&&(Qr=new Pge(Qr,f,null,E,hn),mn.push({event:Qr,listeners:Or}),Lr?Qr.data=Lr:(Lr=Oge(E),Lr!==null&&(Qr.data=Lr)))),(Lr=VRe?GRe(f,E):jRe(f,E))&&(kt=OR(kt,"onBeforeInput"),0<kt.length&&(hn=new Pge("onBeforeInput","beforeinput",null,E,hn),mn.push({event:hn,listeners:kt}),hn.data=Lr))}n2e(mn,v)})}function Dw(f,v,E){return{instance:f,listener:v,currentTarget:E}}function OR(f,v){for(var E=v+"Capture",O=[];f!==null;){var q=f,ee=q.stateNode;q.tag===5&&ee!==null&&(q=ee,ee=gw(f,E),ee!=null&&O.unshift(Dw(f,ee,q)),ee=gw(f,v),ee!=null&&O.push(Dw(f,ee,q))),f=f.return}return O}function q7(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function i2e(f,v,E,O,q){for(var ee=v._reactName,pe=[];E!==null&&E!==O;){var Le=E,tt=Le.alternate,kt=Le.stateNode;if(tt!==null&&tt===O)break;Le.tag===5&&kt!==null&&(Le=kt,q?(tt=gw(E,ee),tt!=null&&pe.unshift(Dw(E,tt,Le))):q||(tt=gw(E,ee),tt!=null&&pe.push(Dw(E,tt,Le)))),E=E.return}pe.length!==0&&f.push({event:v,listeners:pe})}var tIe=/\r\n?/g,nIe=/\u0000|\uFFFD/g;function s2e(f){return(typeof f=="string"?f:""+f).replace(tIe,`
`).replace(nIe,"")}function LR(f,v,E){if(v=s2e(v),s2e(f)!==v&&E)throw Error(m(425))}function FR(){}var hV=null,fV=null;function pV(f,v){return f==="textarea"||f==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var mV=typeof setTimeout=="function"?setTimeout:void 0,rIe=typeof clearTimeout=="function"?clearTimeout:void 0,o2e=typeof Promise=="function"?Promise:void 0,iIe=typeof queueMicrotask=="function"?queueMicrotask:typeof o2e<"u"?function(f){return o2e.resolve(null).then(f).catch(sIe)}:mV;function sIe(f){setTimeout(function(){throw f})}function gV(f,v){var E=v,O=0;do{var q=E.nextSibling;if(f.removeChild(E),q&&q.nodeType===8)if(E=q.data,E==="/$"){if(O===0){f.removeChild(q),Tw(v);return}O--}else E!=="$"&&E!=="$?"&&E!=="$!"||O++;E=q}while(E);Tw(v)}function R9(f){for(;f!=null;f=f.nextSibling){var v=f.nodeType;if(v===1||v===3)break;if(v===8){if(v=f.data,v==="$"||v==="$!"||v==="$?")break;if(v==="/$")return null}}return f}function a2e(f){f=f.previousSibling;for(var v=0;f;){if(f.nodeType===8){var E=f.data;if(E==="$"||E==="$!"||E==="$?"){if(v===0)return f;v--}else E==="/$"&&v++}f=f.previousSibling}return null}var $7=Math.random().toString(36).slice(2),R1="__reactFiber$"+$7,Ow="__reactProps$"+$7,Yg="__reactContainer$"+$7,vV="__reactEvents$"+$7,oIe="__reactListeners$"+$7,aIe="__reactHandles$"+$7;function c8(f){var v=f[R1];if(v)return v;for(var E=f.parentNode;E;){if(v=E[Yg]||E[R1]){if(E=v.alternate,v.child!==null||E!==null&&E.child!==null)for(f=a2e(f);f!==null;){if(E=f[R1])return E;f=a2e(f)}return v}f=E,E=f.parentNode}return null}function Lw(f){return f=f[R1]||f[Yg],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function X7(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(m(33))}function UR(f){return f[Ow]||null}var yV=[],Y7=-1;function I9(f){return{current:f}}function fo(f){0>Y7||(f.current=yV[Y7],yV[Y7]=null,Y7--)}function Js(f,v){Y7++,yV[Y7]=f.current,f.current=v}var N9={},Ll=I9(N9),fu=I9(!1),u8=N9;function K7(f,v){var E=f.type.contextTypes;if(!E)return N9;var O=f.stateNode;if(O&&O.__reactInternalMemoizedUnmaskedChildContext===v)return O.__reactInternalMemoizedMaskedChildContext;var q={},ee;for(ee in E)q[ee]=v[ee];return O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=v,f.__reactInternalMemoizedMaskedChildContext=q),q}function pu(f){return f=f.childContextTypes,f!=null}function BR(){fo(fu),fo(Ll)}function l2e(f,v,E){if(Ll.current!==N9)throw Error(m(168));Js(Ll,v),Js(fu,E)}function c2e(f,v,E){var O=f.stateNode;if(v=v.childContextTypes,typeof O.getChildContext!="function")return E;O=O.getChildContext();for(var q in O)if(!(q in v))throw Error(m(108,Mt(f)||"Unknown",q));return Re({},E,O)}function zR(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||N9,u8=Ll.current,Js(Ll,f),Js(fu,fu.current),!0}function u2e(f,v,E){var O=f.stateNode;if(!O)throw Error(m(169));E?(f=c2e(f,v,u8),O.__reactInternalMemoizedMergedChildContext=f,fo(fu),fo(Ll),Js(Ll,f)):fo(fu),Js(fu,E)}var Kg=null,VR=!1,_V=!1;function d2e(f){Kg===null?Kg=[f]:Kg.push(f)}function lIe(f){VR=!0,d2e(f)}function k9(){if(!_V&&Kg!==null){_V=!0;var f=0,v=Ns;try{var E=Kg;for(Ns=1;f<E.length;f++){var O=E[f];do O=O(!0);while(O!==null)}Kg=null,VR=!1}catch(q){throw Kg!==null&&(Kg=Kg.slice(f+1)),hge(jz,k9),q}finally{Ns=v,_V=!1}}return null}var Z7=[],Q7=0,GR=null,jR=0,uh=[],dh=0,d8=null,Zg=1,Qg="";function h8(f,v){Z7[Q7++]=jR,Z7[Q7++]=GR,GR=f,jR=v}function h2e(f,v,E){uh[dh++]=Zg,uh[dh++]=Qg,uh[dh++]=d8,d8=f;var O=Zg;f=Qg;var q=32-kf(O)-1;O&=~(1<<q),E+=1;var ee=32-kf(v)+q;if(30<ee){var pe=q-q%5;ee=(O&(1<<pe)-1).toString(32),O>>=pe,q-=pe,Zg=1<<32-kf(v)+q|E<<q|O,Qg=ee+f}else Zg=1<<ee|E<<q|O,Qg=f}function xV(f){f.return!==null&&(h8(f,1),h2e(f,1,0))}function bV(f){for(;f===GR;)GR=Z7[--Q7],Z7[Q7]=null,jR=Z7[--Q7],Z7[Q7]=null;for(;f===d8;)d8=uh[--dh],uh[dh]=null,Qg=uh[--dh],uh[dh]=null,Zg=uh[--dh],uh[dh]=null}var dd=null,hd=null,To=!1,Of=null;function f2e(f,v){var E=mh(5,null,null,0);E.elementType="DELETED",E.stateNode=v,E.return=f,v=f.deletions,v===null?(f.deletions=[E],f.flags|=16):v.push(E)}function p2e(f,v){switch(f.tag){case 5:var E=f.type;return v=v.nodeType!==1||E.toLowerCase()!==v.nodeName.toLowerCase()?null:v,v!==null?(f.stateNode=v,dd=f,hd=R9(v.firstChild),!0):!1;case 6:return v=f.pendingProps===""||v.nodeType!==3?null:v,v!==null?(f.stateNode=v,dd=f,hd=null,!0):!1;case 13:return v=v.nodeType!==8?null:v,v!==null?(E=d8!==null?{id:Zg,overflow:Qg}:null,f.memoizedState={dehydrated:v,treeContext:E,retryLane:1073741824},E=mh(18,null,null,0),E.stateNode=v,E.return=f,f.child=E,dd=f,hd=null,!0):!1;default:return!1}}function SV(f){return(f.mode&1)!==0&&(f.flags&128)===0}function wV(f){if(To){var v=hd;if(v){var E=v;if(!p2e(f,v)){if(SV(f))throw Error(m(418));v=R9(E.nextSibling);var O=dd;v&&p2e(f,v)?f2e(O,E):(f.flags=f.flags&-4097|2,To=!1,dd=f)}}else{if(SV(f))throw Error(m(418));f.flags=f.flags&-4097|2,To=!1,dd=f}}}function m2e(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;dd=f}function HR(f){if(f!==dd)return!1;if(!To)return m2e(f),To=!0,!1;var v;if((v=f.tag!==3)&&!(v=f.tag!==5)&&(v=f.type,v=v!=="head"&&v!=="body"&&!pV(f.type,f.memoizedProps)),v&&(v=hd)){if(SV(f))throw g2e(),Error(m(418));for(;v;)f2e(f,v),v=R9(v.nextSibling)}if(m2e(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(m(317));e:{for(f=f.nextSibling,v=0;f;){if(f.nodeType===8){var E=f.data;if(E==="/$"){if(v===0){hd=R9(f.nextSibling);break e}v--}else E!=="$"&&E!=="$!"&&E!=="$?"||v++}f=f.nextSibling}hd=null}}else hd=dd?R9(f.stateNode.nextSibling):null;return!0}function g2e(){for(var f=hd;f;)f=R9(f.nextSibling)}function J7(){hd=dd=null,To=!1}function TV(f){Of===null?Of=[f]:Of.push(f)}var cIe=Ce.ReactCurrentBatchConfig;function Lf(f,v){if(f&&f.defaultProps){v=Re({},v),f=f.defaultProps;for(var E in f)v[E]===void 0&&(v[E]=f[E]);return v}return v}var WR=I9(null),qR=null,e_=null,EV=null;function MV(){EV=e_=qR=null}function CV(f){var v=WR.current;fo(WR),f._currentValue=v}function AV(f,v,E){for(;f!==null;){var O=f.alternate;if((f.childLanes&v)!==v?(f.childLanes|=v,O!==null&&(O.childLanes|=v)):O!==null&&(O.childLanes&v)!==v&&(O.childLanes|=v),f===E)break;f=f.return}}function t_(f,v){qR=f,EV=e_=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&v&&(mu=!0),f.firstContext=null)}function hh(f){var v=f._currentValue;if(EV!==f)if(f={context:f,memoizedValue:v,next:null},e_===null){if(qR===null)throw Error(m(308));e_=f,qR.dependencies={lanes:0,firstContext:f}}else e_=e_.next=f;return v}var f8=null;function PV(f){f8===null?f8=[f]:f8.push(f)}function v2e(f,v,E,O){var q=v.interleaved;return q===null?(E.next=E,PV(v)):(E.next=q.next,q.next=E),v.interleaved=E,Jg(f,O)}function Jg(f,v){f.lanes|=v;var E=f.alternate;for(E!==null&&(E.lanes|=v),E=f,f=f.return;f!==null;)f.childLanes|=v,E=f.alternate,E!==null&&(E.childLanes|=v),E=f,f=f.return;return E.tag===3?E.stateNode:null}var D9=!1;function RV(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function y2e(f,v){f=f.updateQueue,v.updateQueue===f&&(v.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function e2(f,v){return{eventTime:f,lane:v,tag:0,payload:null,callback:null,next:null}}function O9(f,v,E){var O=f.updateQueue;if(O===null)return null;if(O=O.shared,es&2){var q=O.pending;return q===null?v.next=v:(v.next=q.next,q.next=v),O.pending=v,Jg(f,E)}return q=O.interleaved,q===null?(v.next=v,PV(O)):(v.next=q.next,q.next=v),O.interleaved=v,Jg(f,E)}function $R(f,v,E){if(v=v.updateQueue,v!==null&&(v=v.shared,(E&4194240)!==0)){var O=v.lanes;O&=f.pendingLanes,E|=O,v.lanes=E,qz(f,E)}}function _2e(f,v){var E=f.updateQueue,O=f.alternate;if(O!==null&&(O=O.updateQueue,E===O)){var q=null,ee=null;if(E=E.firstBaseUpdate,E!==null){do{var pe={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};ee===null?q=ee=pe:ee=ee.next=pe,E=E.next}while(E!==null);ee===null?q=ee=v:ee=ee.next=v}else q=ee=v;E={baseState:O.baseState,firstBaseUpdate:q,lastBaseUpdate:ee,shared:O.shared,effects:O.effects},f.updateQueue=E;return}f=E.lastBaseUpdate,f===null?E.firstBaseUpdate=v:f.next=v,E.lastBaseUpdate=v}function XR(f,v,E,O){var q=f.updateQueue;D9=!1;var ee=q.firstBaseUpdate,pe=q.lastBaseUpdate,Le=q.shared.pending;if(Le!==null){q.shared.pending=null;var tt=Le,kt=tt.next;tt.next=null,pe===null?ee=kt:pe.next=kt,pe=tt;var hn=f.alternate;hn!==null&&(hn=hn.updateQueue,Le=hn.lastBaseUpdate,Le!==pe&&(Le===null?hn.firstBaseUpdate=kt:Le.next=kt,hn.lastBaseUpdate=tt))}if(ee!==null){var mn=q.baseState;pe=0,hn=kt=tt=null,Le=ee;do{var cn=Le.lane,Jn=Le.eventTime;if((O&cn)===cn){hn!==null&&(hn=hn.next={eventTime:Jn,lane:0,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null});e:{var mr=f,vr=Le;switch(cn=v,Jn=E,vr.tag){case 1:if(mr=vr.payload,typeof mr=="function"){mn=mr.call(Jn,mn,cn);break e}mn=mr;break e;case 3:mr.flags=mr.flags&-65537|128;case 0:if(mr=vr.payload,cn=typeof mr=="function"?mr.call(Jn,mn,cn):mr,cn==null)break e;mn=Re({},mn,cn);break e;case 2:D9=!0}}Le.callback!==null&&Le.lane!==0&&(f.flags|=64,cn=q.effects,cn===null?q.effects=[Le]:cn.push(Le))}else Jn={eventTime:Jn,lane:cn,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null},hn===null?(kt=hn=Jn,tt=mn):hn=hn.next=Jn,pe|=cn;if(Le=Le.next,Le===null){if(Le=q.shared.pending,Le===null)break;cn=Le,Le=cn.next,cn.next=null,q.lastBaseUpdate=cn,q.shared.pending=null}}while(!0);if(hn===null&&(tt=mn),q.baseState=tt,q.firstBaseUpdate=kt,q.lastBaseUpdate=hn,v=q.shared.interleaved,v!==null){q=v;do pe|=q.lane,q=q.next;while(q!==v)}else ee===null&&(q.shared.lanes=0);g8|=pe,f.lanes=pe,f.memoizedState=mn}}function x2e(f,v,E){if(f=v.effects,v.effects=null,f!==null)for(v=0;v<f.length;v++){var O=f[v],q=O.callback;if(q!==null){if(O.callback=null,O=E,typeof q!="function")throw Error(m(191,q));q.call(O)}}}var b2e=new l.Component().refs;function IV(f,v,E,O){v=f.memoizedState,E=E(O,v),E=E==null?v:Re({},v,E),f.memoizedState=E,f.lanes===0&&(f.updateQueue.baseState=E)}var YR={isMounted:function(f){return(f=f._reactInternals)?l8(f)===f:!1},enqueueSetState:function(f,v,E){f=f._reactInternals;var O=Cc(),q=B9(f),ee=e2(O,q);ee.payload=v,E!=null&&(ee.callback=E),v=O9(f,ee,q),v!==null&&(Bf(v,f,q,O),$R(v,f,q))},enqueueReplaceState:function(f,v,E){f=f._reactInternals;var O=Cc(),q=B9(f),ee=e2(O,q);ee.tag=1,ee.payload=v,E!=null&&(ee.callback=E),v=O9(f,ee,q),v!==null&&(Bf(v,f,q,O),$R(v,f,q))},enqueueForceUpdate:function(f,v){f=f._reactInternals;var E=Cc(),O=B9(f),q=e2(E,O);q.tag=2,v!=null&&(q.callback=v),v=O9(f,q,O),v!==null&&(Bf(v,f,O,E),$R(v,f,O))}};function S2e(f,v,E,O,q,ee,pe){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(O,ee,pe):v.prototype&&v.prototype.isPureReactComponent?!Rw(E,O)||!Rw(q,ee):!0}function w2e(f,v,E){var O=!1,q=N9,ee=v.contextType;return typeof ee=="object"&&ee!==null?ee=hh(ee):(q=pu(v)?u8:Ll.current,O=v.contextTypes,ee=(O=O!=null)?K7(f,q):N9),v=new v(E,ee),f.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=YR,f.stateNode=v,v._reactInternals=f,O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=q,f.__reactInternalMemoizedMaskedChildContext=ee),v}function T2e(f,v,E,O){f=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(E,O),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(E,O),v.state!==f&&YR.enqueueReplaceState(v,v.state,null)}function NV(f,v,E,O){var q=f.stateNode;q.props=E,q.state=f.memoizedState,q.refs=b2e,RV(f);var ee=v.contextType;typeof ee=="object"&&ee!==null?q.context=hh(ee):(ee=pu(v)?u8:Ll.current,q.context=K7(f,ee)),q.state=f.memoizedState,ee=v.getDerivedStateFromProps,typeof ee=="function"&&(IV(f,v,ee,E),q.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(v=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),v!==q.state&&YR.enqueueReplaceState(q,q.state,null),XR(f,E,q,O),q.state=f.memoizedState),typeof q.componentDidMount=="function"&&(f.flags|=4194308)}function Fw(f,v,E){if(f=E.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(m(309));var O=E.stateNode}if(!O)throw Error(m(147,f));var q=O,ee=""+f;return v!==null&&v.ref!==null&&typeof v.ref=="function"&&v.ref._stringRef===ee?v.ref:(v=function(pe){var Le=q.refs;Le===b2e&&(Le=q.refs={}),pe===null?delete Le[ee]:Le[ee]=pe},v._stringRef=ee,v)}if(typeof f!="string")throw Error(m(284));if(!E._owner)throw Error(m(290,f))}return f}function KR(f,v){throw f=Object.prototype.toString.call(v),Error(m(31,f==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":f))}function E2e(f){var v=f._init;return v(f._payload)}function M2e(f){function v(wt,ut){if(f){var Pt=wt.deletions;Pt===null?(wt.deletions=[ut],wt.flags|=16):Pt.push(ut)}}function E(wt,ut){if(!f)return null;for(;ut!==null;)v(wt,ut),ut=ut.sibling;return null}function O(wt,ut){for(wt=new Map;ut!==null;)ut.key!==null?wt.set(ut.key,ut):wt.set(ut.index,ut),ut=ut.sibling;return wt}function q(wt,ut){return wt=V9(wt,ut),wt.index=0,wt.sibling=null,wt}function ee(wt,ut,Pt){return wt.index=Pt,f?(Pt=wt.alternate,Pt!==null?(Pt=Pt.index,Pt<ut?(wt.flags|=2,ut):Pt):(wt.flags|=2,ut)):(wt.flags|=1048576,ut)}function pe(wt){return f&&wt.alternate===null&&(wt.flags|=2),wt}function Le(wt,ut,Pt,Tn){return ut===null||ut.tag!==6?(ut=pG(Pt,wt.mode,Tn),ut.return=wt,ut):(ut=q(ut,Pt),ut.return=wt,ut)}function tt(wt,ut,Pt,Tn){var xr=Pt.type;return xr===ke?hn(wt,ut,Pt.props.children,Tn,Pt.key):ut!==null&&(ut.elementType===xr||typeof xr=="object"&&xr!==null&&xr.$$typeof===nt&&E2e(xr)===ut.type)?(Tn=q(ut,Pt.props),Tn.ref=Fw(wt,ut,Pt),Tn.return=wt,Tn):(Tn=mI(Pt.type,Pt.key,Pt.props,null,wt.mode,Tn),Tn.ref=Fw(wt,ut,Pt),Tn.return=wt,Tn)}function kt(wt,ut,Pt,Tn){return ut===null||ut.tag!==4||ut.stateNode.containerInfo!==Pt.containerInfo||ut.stateNode.implementation!==Pt.implementation?(ut=mG(Pt,wt.mode,Tn),ut.return=wt,ut):(ut=q(ut,Pt.children||[]),ut.return=wt,ut)}function hn(wt,ut,Pt,Tn,xr){return ut===null||ut.tag!==7?(ut=x8(Pt,wt.mode,Tn,xr),ut.return=wt,ut):(ut=q(ut,Pt),ut.return=wt,ut)}function mn(wt,ut,Pt){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return ut=pG(""+ut,wt.mode,Pt),ut.return=wt,ut;if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case Se:return Pt=mI(ut.type,ut.key,ut.props,null,wt.mode,Pt),Pt.ref=Fw(wt,null,ut),Pt.return=wt,Pt;case ft:return ut=mG(ut,wt.mode,Pt),ut.return=wt,ut;case nt:var Tn=ut._init;return mn(wt,Tn(ut._payload),Pt)}if(lh(ut)||Nt(ut))return ut=x8(ut,wt.mode,Pt,null),ut.return=wt,ut;KR(wt,ut)}return null}function cn(wt,ut,Pt,Tn){var xr=ut!==null?ut.key:null;if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number")return xr!==null?null:Le(wt,ut,""+Pt,Tn);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case Se:return Pt.key===xr?tt(wt,ut,Pt,Tn):null;case ft:return Pt.key===xr?kt(wt,ut,Pt,Tn):null;case nt:return xr=Pt._init,cn(wt,ut,xr(Pt._payload),Tn)}if(lh(Pt)||Nt(Pt))return xr!==null?null:hn(wt,ut,Pt,Tn,null);KR(wt,Pt)}return null}function Jn(wt,ut,Pt,Tn,xr){if(typeof Tn=="string"&&Tn!==""||typeof Tn=="number")return wt=wt.get(Pt)||null,Le(ut,wt,""+Tn,xr);if(typeof Tn=="object"&&Tn!==null){switch(Tn.$$typeof){case Se:return wt=wt.get(Tn.key===null?Pt:Tn.key)||null,tt(ut,wt,Tn,xr);case ft:return wt=wt.get(Tn.key===null?Pt:Tn.key)||null,kt(ut,wt,Tn,xr);case nt:var Or=Tn._init;return Jn(wt,ut,Pt,Or(Tn._payload),xr)}if(lh(Tn)||Nt(Tn))return wt=wt.get(Pt)||null,hn(ut,wt,Tn,xr,null);KR(ut,Tn)}return null}function mr(wt,ut,Pt,Tn){for(var xr=null,Or=null,Lr=ut,Qr=ut=0,w0=null;Lr!==null&&Qr<Pt.length;Qr++){Lr.index>Qr?(w0=Lr,Lr=null):w0=Lr.sibling;var as=cn(wt,Lr,Pt[Qr],Tn);if(as===null){Lr===null&&(Lr=w0);break}f&&Lr&&as.alternate===null&&v(wt,Lr),ut=ee(as,ut,Qr),Or===null?xr=as:Or.sibling=as,Or=as,Lr=w0}if(Qr===Pt.length)return E(wt,Lr),To&&h8(wt,Qr),xr;if(Lr===null){for(;Qr<Pt.length;Qr++)Lr=mn(wt,Pt[Qr],Tn),Lr!==null&&(ut=ee(Lr,ut,Qr),Or===null?xr=Lr:Or.sibling=Lr,Or=Lr);return To&&h8(wt,Qr),xr}for(Lr=O(wt,Lr);Qr<Pt.length;Qr++)w0=Jn(Lr,wt,Qr,Pt[Qr],Tn),w0!==null&&(f&&w0.alternate!==null&&Lr.delete(w0.key===null?Qr:w0.key),ut=ee(w0,ut,Qr),Or===null?xr=w0:Or.sibling=w0,Or=w0);return f&&Lr.forEach(function(G9){return v(wt,G9)}),To&&h8(wt,Qr),xr}function vr(wt,ut,Pt,Tn){var xr=Nt(Pt);if(typeof xr!="function")throw Error(m(150));if(Pt=xr.call(Pt),Pt==null)throw Error(m(151));for(var Or=xr=null,Lr=ut,Qr=ut=0,w0=null,as=Pt.next();Lr!==null&&!as.done;Qr++,as=Pt.next()){Lr.index>Qr?(w0=Lr,Lr=null):w0=Lr.sibling;var G9=cn(wt,Lr,as.value,Tn);if(G9===null){Lr===null&&(Lr=w0);break}f&&Lr&&G9.alternate===null&&v(wt,Lr),ut=ee(G9,ut,Qr),Or===null?xr=G9:Or.sibling=G9,Or=G9,Lr=w0}if(as.done)return E(wt,Lr),To&&h8(wt,Qr),xr;if(Lr===null){for(;!as.done;Qr++,as=Pt.next())as=mn(wt,as.value,Tn),as!==null&&(ut=ee(as,ut,Qr),Or===null?xr=as:Or.sibling=as,Or=as);return To&&h8(wt,Qr),xr}for(Lr=O(wt,Lr);!as.done;Qr++,as=Pt.next())as=Jn(Lr,wt,Qr,as.value,Tn),as!==null&&(f&&as.alternate!==null&&Lr.delete(as.key===null?Qr:as.key),ut=ee(as,ut,Qr),Or===null?xr=as:Or.sibling=as,Or=as);return f&&Lr.forEach(function(GIe){return v(wt,GIe)}),To&&h8(wt,Qr),xr}function Sa(wt,ut,Pt,Tn){if(typeof Pt=="object"&&Pt!==null&&Pt.type===ke&&Pt.key===null&&(Pt=Pt.props.children),typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case Se:e:{for(var xr=Pt.key,Or=ut;Or!==null;){if(Or.key===xr){if(xr=Pt.type,xr===ke){if(Or.tag===7){E(wt,Or.sibling),ut=q(Or,Pt.props.children),ut.return=wt,wt=ut;break e}}else if(Or.elementType===xr||typeof xr=="object"&&xr!==null&&xr.$$typeof===nt&&E2e(xr)===Or.type){E(wt,Or.sibling),ut=q(Or,Pt.props),ut.ref=Fw(wt,Or,Pt),ut.return=wt,wt=ut;break e}E(wt,Or);break}else v(wt,Or);Or=Or.sibling}Pt.type===ke?(ut=x8(Pt.props.children,wt.mode,Tn,Pt.key),ut.return=wt,wt=ut):(Tn=mI(Pt.type,Pt.key,Pt.props,null,wt.mode,Tn),Tn.ref=Fw(wt,ut,Pt),Tn.return=wt,wt=Tn)}return pe(wt);case ft:e:{for(Or=Pt.key;ut!==null;){if(ut.key===Or)if(ut.tag===4&&ut.stateNode.containerInfo===Pt.containerInfo&&ut.stateNode.implementation===Pt.implementation){E(wt,ut.sibling),ut=q(ut,Pt.children||[]),ut.return=wt,wt=ut;break e}else{E(wt,ut);break}else v(wt,ut);ut=ut.sibling}ut=mG(Pt,wt.mode,Tn),ut.return=wt,wt=ut}return pe(wt);case nt:return Or=Pt._init,Sa(wt,ut,Or(Pt._payload),Tn)}if(lh(Pt))return mr(wt,ut,Pt,Tn);if(Nt(Pt))return vr(wt,ut,Pt,Tn);KR(wt,Pt)}return typeof Pt=="string"&&Pt!==""||typeof Pt=="number"?(Pt=""+Pt,ut!==null&&ut.tag===6?(E(wt,ut.sibling),ut=q(ut,Pt),ut.return=wt,wt=ut):(E(wt,ut),ut=pG(Pt,wt.mode,Tn),ut.return=wt,wt=ut),pe(wt)):E(wt,ut)}return Sa}var n_=M2e(!0),C2e=M2e(!1),Uw={},I1=I9(Uw),Bw=I9(Uw),zw=I9(Uw);function p8(f){if(f===Uw)throw Error(m(174));return f}function kV(f,v){switch(Js(zw,v),Js(Bw,f),Js(I1,Uw),f=v.nodeType,f){case 9:case 11:v=(v=v.documentElement)?v.namespaceURI:ch(null,"");break;default:f=f===8?v.parentNode:v,v=f.namespaceURI||null,f=f.tagName,v=ch(v,f)}fo(I1),Js(I1,v)}function r_(){fo(I1),fo(Bw),fo(zw)}function A2e(f){p8(zw.current);var v=p8(I1.current),E=ch(v,f.type);v!==E&&(Js(Bw,f),Js(I1,E))}function DV(f){Bw.current===f&&(fo(I1),fo(Bw))}var jo=I9(0);function ZR(f){for(var v=f;v!==null;){if(v.tag===13){var E=v.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||E.data==="$?"||E.data==="$!"))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if(v.flags&128)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}var OV=[];function LV(){for(var f=0;f<OV.length;f++)OV[f]._workInProgressVersionPrimary=null;OV.length=0}var QR=Ce.ReactCurrentDispatcher,FV=Ce.ReactCurrentBatchConfig,m8=0,Ho=null,Xa=null,b0=null,JR=!1,Vw=!1,Gw=0,uIe=0;function Fl(){throw Error(m(321))}function UV(f,v){if(v===null)return!1;for(var E=0;E<v.length&&E<f.length;E++)if(!Df(f[E],v[E]))return!1;return!0}function BV(f,v,E,O,q,ee){if(m8=ee,Ho=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,QR.current=f===null||f.memoizedState===null?pIe:mIe,f=E(O,q),Vw){ee=0;do{if(Vw=!1,Gw=0,25<=ee)throw Error(m(301));ee+=1,b0=Xa=null,v.updateQueue=null,QR.current=gIe,f=E(O,q)}while(Vw)}if(QR.current=nI,v=Xa!==null&&Xa.next!==null,m8=0,b0=Xa=Ho=null,JR=!1,v)throw Error(m(300));return f}function zV(){var f=Gw!==0;return Gw=0,f}function N1(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return b0===null?Ho.memoizedState=b0=f:b0=b0.next=f,b0}function fh(){if(Xa===null){var f=Ho.alternate;f=f!==null?f.memoizedState:null}else f=Xa.next;var v=b0===null?Ho.memoizedState:b0.next;if(v!==null)b0=v,Xa=f;else{if(f===null)throw Error(m(310));Xa=f,f={memoizedState:Xa.memoizedState,baseState:Xa.baseState,baseQueue:Xa.baseQueue,queue:Xa.queue,next:null},b0===null?Ho.memoizedState=b0=f:b0=b0.next=f}return b0}function jw(f,v){return typeof v=="function"?v(f):v}function VV(f){var v=fh(),E=v.queue;if(E===null)throw Error(m(311));E.lastRenderedReducer=f;var O=Xa,q=O.baseQueue,ee=E.pending;if(ee!==null){if(q!==null){var pe=q.next;q.next=ee.next,ee.next=pe}O.baseQueue=q=ee,E.pending=null}if(q!==null){ee=q.next,O=O.baseState;var Le=pe=null,tt=null,kt=ee;do{var hn=kt.lane;if((m8&hn)===hn)tt!==null&&(tt=tt.next={lane:0,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null}),O=kt.hasEagerState?kt.eagerState:f(O,kt.action);else{var mn={lane:hn,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null};tt===null?(Le=tt=mn,pe=O):tt=tt.next=mn,Ho.lanes|=hn,g8|=hn}kt=kt.next}while(kt!==null&&kt!==ee);tt===null?pe=O:tt.next=Le,Df(O,v.memoizedState)||(mu=!0),v.memoizedState=O,v.baseState=pe,v.baseQueue=tt,E.lastRenderedState=O}if(f=E.interleaved,f!==null){q=f;do ee=q.lane,Ho.lanes|=ee,g8|=ee,q=q.next;while(q!==f)}else q===null&&(E.lanes=0);return[v.memoizedState,E.dispatch]}function GV(f){var v=fh(),E=v.queue;if(E===null)throw Error(m(311));E.lastRenderedReducer=f;var O=E.dispatch,q=E.pending,ee=v.memoizedState;if(q!==null){E.pending=null;var pe=q=q.next;do ee=f(ee,pe.action),pe=pe.next;while(pe!==q);Df(ee,v.memoizedState)||(mu=!0),v.memoizedState=ee,v.baseQueue===null&&(v.baseState=ee),E.lastRenderedState=ee}return[ee,O]}function P2e(){}function R2e(f,v){var E=Ho,O=fh(),q=v(),ee=!Df(O.memoizedState,q);if(ee&&(O.memoizedState=q,mu=!0),O=O.queue,jV(k2e.bind(null,E,O,f),[f]),O.getSnapshot!==v||ee||b0!==null&&b0.memoizedState.tag&1){if(E.flags|=2048,Hw(9,N2e.bind(null,E,O,q,v),void 0,null),S0===null)throw Error(m(349));m8&30||I2e(E,v,q)}return q}function I2e(f,v,E){f.flags|=16384,f={getSnapshot:v,value:E},v=Ho.updateQueue,v===null?(v={lastEffect:null,stores:null},Ho.updateQueue=v,v.stores=[f]):(E=v.stores,E===null?v.stores=[f]:E.push(f))}function N2e(f,v,E,O){v.value=E,v.getSnapshot=O,D2e(v)&&O2e(f)}function k2e(f,v,E){return E(function(){D2e(v)&&O2e(f)})}function D2e(f){var v=f.getSnapshot;f=f.value;try{var E=v();return!Df(f,E)}catch{return!0}}function O2e(f){var v=Jg(f,1);v!==null&&Bf(v,f,1,-1)}function L2e(f){var v=N1();return typeof f=="function"&&(f=f()),v.memoizedState=v.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jw,lastRenderedState:f},v.queue=f,f=f.dispatch=fIe.bind(null,Ho,f),[v.memoizedState,f]}function Hw(f,v,E,O){return f={tag:f,create:v,destroy:E,deps:O,next:null},v=Ho.updateQueue,v===null?(v={lastEffect:null,stores:null},Ho.updateQueue=v,v.lastEffect=f.next=f):(E=v.lastEffect,E===null?v.lastEffect=f.next=f:(O=E.next,E.next=f,f.next=O,v.lastEffect=f)),f}function F2e(){return fh().memoizedState}function eI(f,v,E,O){var q=N1();Ho.flags|=f,q.memoizedState=Hw(1|v,E,void 0,O===void 0?null:O)}function tI(f,v,E,O){var q=fh();O=O===void 0?null:O;var ee=void 0;if(Xa!==null){var pe=Xa.memoizedState;if(ee=pe.destroy,O!==null&&UV(O,pe.deps)){q.memoizedState=Hw(v,E,ee,O);return}}Ho.flags|=f,q.memoizedState=Hw(1|v,E,ee,O)}function U2e(f,v){return eI(8390656,8,f,v)}function jV(f,v){return tI(2048,8,f,v)}function B2e(f,v){return tI(4,2,f,v)}function z2e(f,v){return tI(4,4,f,v)}function V2e(f,v){if(typeof v=="function")return f=f(),v(f),function(){v(null)};if(v!=null)return f=f(),v.current=f,function(){v.current=null}}function G2e(f,v,E){return E=E!=null?E.concat([f]):null,tI(4,4,V2e.bind(null,v,f),E)}function HV(){}function j2e(f,v){var E=fh();v=v===void 0?null:v;var O=E.memoizedState;return O!==null&&v!==null&&UV(v,O[1])?O[0]:(E.memoizedState=[f,v],f)}function H2e(f,v){var E=fh();v=v===void 0?null:v;var O=E.memoizedState;return O!==null&&v!==null&&UV(v,O[1])?O[0]:(f=f(),E.memoizedState=[f,v],f)}function W2e(f,v,E){return m8&21?(Df(E,v)||(E=gge(),Ho.lanes|=E,g8|=E,f.baseState=!0),v):(f.baseState&&(f.baseState=!1,mu=!0),f.memoizedState=E)}function dIe(f,v){var E=Ns;Ns=E!==0&&4>E?E:4,f(!0);var O=FV.transition;FV.transition={};try{f(!1),v()}finally{Ns=E,FV.transition=O}}function q2e(){return fh().memoizedState}function hIe(f,v,E){var O=B9(f);if(E={lane:O,action:E,hasEagerState:!1,eagerState:null,next:null},$2e(f))X2e(v,E);else if(E=v2e(f,v,E,O),E!==null){var q=Cc();Bf(E,f,O,q),Y2e(E,v,O)}}function fIe(f,v,E){var O=B9(f),q={lane:O,action:E,hasEagerState:!1,eagerState:null,next:null};if($2e(f))X2e(v,q);else{var ee=f.alternate;if(f.lanes===0&&(ee===null||ee.lanes===0)&&(ee=v.lastRenderedReducer,ee!==null))try{var pe=v.lastRenderedState,Le=ee(pe,E);if(q.hasEagerState=!0,q.eagerState=Le,Df(Le,pe)){var tt=v.interleaved;tt===null?(q.next=q,PV(v)):(q.next=tt.next,tt.next=q),v.interleaved=q;return}}catch{}finally{}E=v2e(f,v,q,O),E!==null&&(q=Cc(),Bf(E,f,O,q),Y2e(E,v,O))}}function $2e(f){var v=f.alternate;return f===Ho||v!==null&&v===Ho}function X2e(f,v){Vw=JR=!0;var E=f.pending;E===null?v.next=v:(v.next=E.next,E.next=v),f.pending=v}function Y2e(f,v,E){if(E&4194240){var O=v.lanes;O&=f.pendingLanes,E|=O,v.lanes=E,qz(f,E)}}var nI={readContext:hh,useCallback:Fl,useContext:Fl,useEffect:Fl,useImperativeHandle:Fl,useInsertionEffect:Fl,useLayoutEffect:Fl,useMemo:Fl,useReducer:Fl,useRef:Fl,useState:Fl,useDebugValue:Fl,useDeferredValue:Fl,useTransition:Fl,useMutableSource:Fl,useSyncExternalStore:Fl,useId:Fl,unstable_isNewReconciler:!1},pIe={readContext:hh,useCallback:function(f,v){return N1().memoizedState=[f,v===void 0?null:v],f},useContext:hh,useEffect:U2e,useImperativeHandle:function(f,v,E){return E=E!=null?E.concat([f]):null,eI(4194308,4,V2e.bind(null,v,f),E)},useLayoutEffect:function(f,v){return eI(4194308,4,f,v)},useInsertionEffect:function(f,v){return eI(4,2,f,v)},useMemo:function(f,v){var E=N1();return v=v===void 0?null:v,f=f(),E.memoizedState=[f,v],f},useReducer:function(f,v,E){var O=N1();return v=E!==void 0?E(v):v,O.memoizedState=O.baseState=v,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:v},O.queue=f,f=f.dispatch=hIe.bind(null,Ho,f),[O.memoizedState,f]},useRef:function(f){var v=N1();return f={current:f},v.memoizedState=f},useState:L2e,useDebugValue:HV,useDeferredValue:function(f){return N1().memoizedState=f},useTransition:function(){var f=L2e(!1),v=f[0];return f=dIe.bind(null,f[1]),N1().memoizedState=f,[v,f]},useMutableSource:function(){},useSyncExternalStore:function(f,v,E){var O=Ho,q=N1();if(To){if(E===void 0)throw Error(m(407));E=E()}else{if(E=v(),S0===null)throw Error(m(349));m8&30||I2e(O,v,E)}q.memoizedState=E;var ee={value:E,getSnapshot:v};return q.queue=ee,U2e(k2e.bind(null,O,ee,f),[f]),O.flags|=2048,Hw(9,N2e.bind(null,O,ee,E,v),void 0,null),E},useId:function(){var f=N1(),v=S0.identifierPrefix;if(To){var E=Qg,O=Zg;E=(O&~(1<<32-kf(O)-1)).toString(32)+E,v=":"+v+"R"+E,E=Gw++,0<E&&(v+="H"+E.toString(32)),v+=":"}else E=uIe++,v=":"+v+"r"+E.toString(32)+":";return f.memoizedState=v},unstable_isNewReconciler:!1},mIe={readContext:hh,useCallback:j2e,useContext:hh,useEffect:jV,useImperativeHandle:G2e,useInsertionEffect:B2e,useLayoutEffect:z2e,useMemo:H2e,useReducer:VV,useRef:F2e,useState:function(){return VV(jw)},useDebugValue:HV,useDeferredValue:function(f){var v=fh();return W2e(v,Xa.memoizedState,f)},useTransition:function(){var f=VV(jw)[0],v=fh().memoizedState;return[f,v]},useMutableSource:P2e,useSyncExternalStore:R2e,useId:q2e,unstable_isNewReconciler:!1},gIe={readContext:hh,useCallback:j2e,useContext:hh,useEffect:jV,useImperativeHandle:G2e,useInsertionEffect:B2e,useLayoutEffect:z2e,useMemo:H2e,useReducer:GV,useRef:F2e,useState:function(){return GV(jw)},useDebugValue:HV,useDeferredValue:function(f){var v=fh();return Xa===null?v.memoizedState=f:W2e(v,Xa.memoizedState,f)},useTransition:function(){var f=GV(jw)[0],v=fh().memoizedState;return[f,v]},useMutableSource:P2e,useSyncExternalStore:R2e,useId:q2e,unstable_isNewReconciler:!1};function i_(f,v){try{var E="",O=v;do E+=we(O),O=O.return;while(O);var q=E}catch(ee){q=`
Error generating stack: `+ee.message+`
`+ee.stack}return{value:f,source:v,stack:q,digest:null}}function WV(f,v,E){return{value:f,source:null,stack:E??null,digest:v??null}}function qV(f,v){try{console.error(v.value)}catch(E){setTimeout(function(){throw E})}}var vIe=typeof WeakMap=="function"?WeakMap:Map;function K2e(f,v,E){E=e2(-1,E),E.tag=3,E.payload={element:null};var O=v.value;return E.callback=function(){cI||(cI=!0,oG=O),qV(f,v)},E}function Z2e(f,v,E){E=e2(-1,E),E.tag=3;var O=f.type.getDerivedStateFromError;if(typeof O=="function"){var q=v.value;E.payload=function(){return O(q)},E.callback=function(){qV(f,v)}}var ee=f.stateNode;return ee!==null&&typeof ee.componentDidCatch=="function"&&(E.callback=function(){qV(f,v),typeof O!="function"&&(F9===null?F9=new Set([this]):F9.add(this));var pe=v.stack;this.componentDidCatch(v.value,{componentStack:pe!==null?pe:""})}),E}function Q2e(f,v,E){var O=f.pingCache;if(O===null){O=f.pingCache=new vIe;var q=new Set;O.set(v,q)}else q=O.get(v),q===void 0&&(q=new Set,O.set(v,q));q.has(E)||(q.add(E),f=IIe.bind(null,f,v,E),v.then(f,f))}function J2e(f){do{var v;if((v=f.tag===13)&&(v=f.memoizedState,v=v!==null?v.dehydrated!==null:!0),v)return f;f=f.return}while(f!==null);return null}function e3e(f,v,E,O,q){return f.mode&1?(f.flags|=65536,f.lanes=q,f):(f===v?f.flags|=65536:(f.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(v=e2(-1,1),v.tag=2,O9(E,v,1))),E.lanes|=1),f)}var yIe=Ce.ReactCurrentOwner,mu=!1;function Mc(f,v,E,O){v.child=f===null?C2e(v,null,E,O):n_(v,f.child,E,O)}function t3e(f,v,E,O,q){E=E.render;var ee=v.ref;return t_(v,q),O=BV(f,v,E,O,ee,q),E=zV(),f!==null&&!mu?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~q,t2(f,v,q)):(To&&E&&xV(v),v.flags|=1,Mc(f,v,O,q),v.child)}function n3e(f,v,E,O,q){if(f===null){var ee=E.type;return typeof ee=="function"&&!fG(ee)&&ee.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(v.tag=15,v.type=ee,r3e(f,v,ee,O,q)):(f=mI(E.type,null,O,v,v.mode,q),f.ref=v.ref,f.return=v,v.child=f)}if(ee=f.child,!(f.lanes&q)){var pe=ee.memoizedProps;if(E=E.compare,E=E!==null?E:Rw,E(pe,O)&&f.ref===v.ref)return t2(f,v,q)}return v.flags|=1,f=V9(ee,O),f.ref=v.ref,f.return=v,v.child=f}function r3e(f,v,E,O,q){if(f!==null){var ee=f.memoizedProps;if(Rw(ee,O)&&f.ref===v.ref)if(mu=!1,v.pendingProps=O=ee,(f.lanes&q)!==0)f.flags&131072&&(mu=!0);else return v.lanes=f.lanes,t2(f,v,q)}return $V(f,v,E,O,q)}function i3e(f,v,E){var O=v.pendingProps,q=O.children,ee=f!==null?f.memoizedState:null;if(O.mode==="hidden")if(!(v.mode&1))v.memoizedState={baseLanes:0,cachePool:null,transitions:null},Js(o_,fd),fd|=E;else{if(!(E&1073741824))return f=ee!==null?ee.baseLanes|E:E,v.lanes=v.childLanes=1073741824,v.memoizedState={baseLanes:f,cachePool:null,transitions:null},v.updateQueue=null,Js(o_,fd),fd|=f,null;v.memoizedState={baseLanes:0,cachePool:null,transitions:null},O=ee!==null?ee.baseLanes:E,Js(o_,fd),fd|=O}else ee!==null?(O=ee.baseLanes|E,v.memoizedState=null):O=E,Js(o_,fd),fd|=O;return Mc(f,v,q,E),v.child}function s3e(f,v){var E=v.ref;(f===null&&E!==null||f!==null&&f.ref!==E)&&(v.flags|=512,v.flags|=2097152)}function $V(f,v,E,O,q){var ee=pu(E)?u8:Ll.current;return ee=K7(v,ee),t_(v,q),E=BV(f,v,E,O,ee,q),O=zV(),f!==null&&!mu?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~q,t2(f,v,q)):(To&&O&&xV(v),v.flags|=1,Mc(f,v,E,q),v.child)}function o3e(f,v,E,O,q){if(pu(E)){var ee=!0;zR(v)}else ee=!1;if(t_(v,q),v.stateNode===null)iI(f,v),w2e(v,E,O),NV(v,E,O,q),O=!0;else if(f===null){var pe=v.stateNode,Le=v.memoizedProps;pe.props=Le;var tt=pe.context,kt=E.contextType;typeof kt=="object"&&kt!==null?kt=hh(kt):(kt=pu(E)?u8:Ll.current,kt=K7(v,kt));var hn=E.getDerivedStateFromProps,mn=typeof hn=="function"||typeof pe.getSnapshotBeforeUpdate=="function";mn||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(Le!==O||tt!==kt)&&T2e(v,pe,O,kt),D9=!1;var cn=v.memoizedState;pe.state=cn,XR(v,O,pe,q),tt=v.memoizedState,Le!==O||cn!==tt||fu.current||D9?(typeof hn=="function"&&(IV(v,E,hn,O),tt=v.memoizedState),(Le=D9||S2e(v,E,Le,O,cn,tt,kt))?(mn||typeof pe.UNSAFE_componentWillMount!="function"&&typeof pe.componentWillMount!="function"||(typeof pe.componentWillMount=="function"&&pe.componentWillMount(),typeof pe.UNSAFE_componentWillMount=="function"&&pe.UNSAFE_componentWillMount()),typeof pe.componentDidMount=="function"&&(v.flags|=4194308)):(typeof pe.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=O,v.memoizedState=tt),pe.props=O,pe.state=tt,pe.context=kt,O=Le):(typeof pe.componentDidMount=="function"&&(v.flags|=4194308),O=!1)}else{pe=v.stateNode,y2e(f,v),Le=v.memoizedProps,kt=v.type===v.elementType?Le:Lf(v.type,Le),pe.props=kt,mn=v.pendingProps,cn=pe.context,tt=E.contextType,typeof tt=="object"&&tt!==null?tt=hh(tt):(tt=pu(E)?u8:Ll.current,tt=K7(v,tt));var Jn=E.getDerivedStateFromProps;(hn=typeof Jn=="function"||typeof pe.getSnapshotBeforeUpdate=="function")||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(Le!==mn||cn!==tt)&&T2e(v,pe,O,tt),D9=!1,cn=v.memoizedState,pe.state=cn,XR(v,O,pe,q);var mr=v.memoizedState;Le!==mn||cn!==mr||fu.current||D9?(typeof Jn=="function"&&(IV(v,E,Jn,O),mr=v.memoizedState),(kt=D9||S2e(v,E,kt,O,cn,mr,tt)||!1)?(hn||typeof pe.UNSAFE_componentWillUpdate!="function"&&typeof pe.componentWillUpdate!="function"||(typeof pe.componentWillUpdate=="function"&&pe.componentWillUpdate(O,mr,tt),typeof pe.UNSAFE_componentWillUpdate=="function"&&pe.UNSAFE_componentWillUpdate(O,mr,tt)),typeof pe.componentDidUpdate=="function"&&(v.flags|=4),typeof pe.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof pe.componentDidUpdate!="function"||Le===f.memoizedProps&&cn===f.memoizedState||(v.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||Le===f.memoizedProps&&cn===f.memoizedState||(v.flags|=1024),v.memoizedProps=O,v.memoizedState=mr),pe.props=O,pe.state=mr,pe.context=tt,O=kt):(typeof pe.componentDidUpdate!="function"||Le===f.memoizedProps&&cn===f.memoizedState||(v.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||Le===f.memoizedProps&&cn===f.memoizedState||(v.flags|=1024),O=!1)}return XV(f,v,E,O,ee,q)}function XV(f,v,E,O,q,ee){s3e(f,v);var pe=(v.flags&128)!==0;if(!O&&!pe)return q&&u2e(v,E,!1),t2(f,v,ee);O=v.stateNode,yIe.current=v;var Le=pe&&typeof E.getDerivedStateFromError!="function"?null:O.render();return v.flags|=1,f!==null&&pe?(v.child=n_(v,f.child,null,ee),v.child=n_(v,null,Le,ee)):Mc(f,v,Le,ee),v.memoizedState=O.state,q&&u2e(v,E,!0),v.child}function a3e(f){var v=f.stateNode;v.pendingContext?l2e(f,v.pendingContext,v.pendingContext!==v.context):v.context&&l2e(f,v.context,!1),kV(f,v.containerInfo)}function l3e(f,v,E,O,q){return J7(),TV(q),v.flags|=256,Mc(f,v,E,O),v.child}var YV={dehydrated:null,treeContext:null,retryLane:0};function KV(f){return{baseLanes:f,cachePool:null,transitions:null}}function c3e(f,v,E){var O=v.pendingProps,q=jo.current,ee=!1,pe=(v.flags&128)!==0,Le;if((Le=pe)||(Le=f!==null&&f.memoizedState===null?!1:(q&2)!==0),Le?(ee=!0,v.flags&=-129):(f===null||f.memoizedState!==null)&&(q|=1),Js(jo,q&1),f===null)return wV(v),f=v.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(v.mode&1?f.data==="$!"?v.lanes=8:v.lanes=1073741824:v.lanes=1,null):(pe=O.children,f=O.fallback,ee?(O=v.mode,ee=v.child,pe={mode:"hidden",children:pe},!(O&1)&&ee!==null?(ee.childLanes=0,ee.pendingProps=pe):ee=gI(pe,O,0,null),f=x8(f,O,E,null),ee.return=v,f.return=v,ee.sibling=f,v.child=ee,v.child.memoizedState=KV(E),v.memoizedState=YV,f):ZV(v,pe));if(q=f.memoizedState,q!==null&&(Le=q.dehydrated,Le!==null))return _Ie(f,v,pe,O,Le,q,E);if(ee){ee=O.fallback,pe=v.mode,q=f.child,Le=q.sibling;var tt={mode:"hidden",children:O.children};return!(pe&1)&&v.child!==q?(O=v.child,O.childLanes=0,O.pendingProps=tt,v.deletions=null):(O=V9(q,tt),O.subtreeFlags=q.subtreeFlags&14680064),Le!==null?ee=V9(Le,ee):(ee=x8(ee,pe,E,null),ee.flags|=2),ee.return=v,O.return=v,O.sibling=ee,v.child=O,O=ee,ee=v.child,pe=f.child.memoizedState,pe=pe===null?KV(E):{baseLanes:pe.baseLanes|E,cachePool:null,transitions:pe.transitions},ee.memoizedState=pe,ee.childLanes=f.childLanes&~E,v.memoizedState=YV,O}return ee=f.child,f=ee.sibling,O=V9(ee,{mode:"visible",children:O.children}),!(v.mode&1)&&(O.lanes=E),O.return=v,O.sibling=null,f!==null&&(E=v.deletions,E===null?(v.deletions=[f],v.flags|=16):E.push(f)),v.child=O,v.memoizedState=null,O}function ZV(f,v){return v=gI({mode:"visible",children:v},f.mode,0,null),v.return=f,f.child=v}function rI(f,v,E,O){return O!==null&&TV(O),n_(v,f.child,null,E),f=ZV(v,v.pendingProps.children),f.flags|=2,v.memoizedState=null,f}function _Ie(f,v,E,O,q,ee,pe){if(E)return v.flags&256?(v.flags&=-257,O=WV(Error(m(422))),rI(f,v,pe,O)):v.memoizedState!==null?(v.child=f.child,v.flags|=128,null):(ee=O.fallback,q=v.mode,O=gI({mode:"visible",children:O.children},q,0,null),ee=x8(ee,q,pe,null),ee.flags|=2,O.return=v,ee.return=v,O.sibling=ee,v.child=O,v.mode&1&&n_(v,f.child,null,pe),v.child.memoizedState=KV(pe),v.memoizedState=YV,ee);if(!(v.mode&1))return rI(f,v,pe,null);if(q.data==="$!"){if(O=q.nextSibling&&q.nextSibling.dataset,O)var Le=O.dgst;return O=Le,ee=Error(m(419)),O=WV(ee,O,void 0),rI(f,v,pe,O)}if(Le=(pe&f.childLanes)!==0,mu||Le){if(O=S0,O!==null){switch(pe&-pe){case 4:q=2;break;case 16:q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:q=32;break;case 536870912:q=268435456;break;default:q=0}q=q&(O.suspendedLanes|pe)?0:q,q!==0&&q!==ee.retryLane&&(ee.retryLane=q,Jg(f,q),Bf(O,f,q,-1))}return hG(),O=WV(Error(m(421))),rI(f,v,pe,O)}return q.data==="$?"?(v.flags|=128,v.child=f.child,v=NIe.bind(null,f),q._reactRetry=v,null):(f=ee.treeContext,hd=R9(q.nextSibling),dd=v,To=!0,Of=null,f!==null&&(uh[dh++]=Zg,uh[dh++]=Qg,uh[dh++]=d8,Zg=f.id,Qg=f.overflow,d8=v),v=ZV(v,O.children),v.flags|=4096,v)}function u3e(f,v,E){f.lanes|=v;var O=f.alternate;O!==null&&(O.lanes|=v),AV(f.return,v,E)}function QV(f,v,E,O,q){var ee=f.memoizedState;ee===null?f.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:O,tail:E,tailMode:q}:(ee.isBackwards=v,ee.rendering=null,ee.renderingStartTime=0,ee.last=O,ee.tail=E,ee.tailMode=q)}function d3e(f,v,E){var O=v.pendingProps,q=O.revealOrder,ee=O.tail;if(Mc(f,v,O.children,E),O=jo.current,O&2)O=O&1|2,v.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=v.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&u3e(f,E,v);else if(f.tag===19)u3e(f,E,v);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===v)break e;for(;f.sibling===null;){if(f.return===null||f.return===v)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}O&=1}if(Js(jo,O),!(v.mode&1))v.memoizedState=null;else switch(q){case"forwards":for(E=v.child,q=null;E!==null;)f=E.alternate,f!==null&&ZR(f)===null&&(q=E),E=E.sibling;E=q,E===null?(q=v.child,v.child=null):(q=E.sibling,E.sibling=null),QV(v,!1,q,E,ee);break;case"backwards":for(E=null,q=v.child,v.child=null;q!==null;){if(f=q.alternate,f!==null&&ZR(f)===null){v.child=q;break}f=q.sibling,q.sibling=E,E=q,q=f}QV(v,!0,E,null,ee);break;case"together":QV(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function iI(f,v){!(v.mode&1)&&f!==null&&(f.alternate=null,v.alternate=null,v.flags|=2)}function t2(f,v,E){if(f!==null&&(v.dependencies=f.dependencies),g8|=v.lanes,!(E&v.childLanes))return null;if(f!==null&&v.child!==f.child)throw Error(m(153));if(v.child!==null){for(f=v.child,E=V9(f,f.pendingProps),v.child=E,E.return=v;f.sibling!==null;)f=f.sibling,E=E.sibling=V9(f,f.pendingProps),E.return=v;E.sibling=null}return v.child}function xIe(f,v,E){switch(v.tag){case 3:a3e(v),J7();break;case 5:A2e(v);break;case 1:pu(v.type)&&zR(v);break;case 4:kV(v,v.stateNode.containerInfo);break;case 10:var O=v.type._context,q=v.memoizedProps.value;Js(WR,O._currentValue),O._currentValue=q;break;case 13:if(O=v.memoizedState,O!==null)return O.dehydrated!==null?(Js(jo,jo.current&1),v.flags|=128,null):E&v.child.childLanes?c3e(f,v,E):(Js(jo,jo.current&1),f=t2(f,v,E),f!==null?f.sibling:null);Js(jo,jo.current&1);break;case 19:if(O=(E&v.childLanes)!==0,f.flags&128){if(O)return d3e(f,v,E);v.flags|=128}if(q=v.memoizedState,q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),Js(jo,jo.current),O)break;return null;case 22:case 23:return v.lanes=0,i3e(f,v,E)}return t2(f,v,E)}var h3e,JV,f3e,p3e;h3e=function(f,v){for(var E=v.child;E!==null;){if(E.tag===5||E.tag===6)f.appendChild(E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===v)break;for(;E.sibling===null;){if(E.return===null||E.return===v)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},JV=function(){},f3e=function(f,v,E,O){var q=f.memoizedProps;if(q!==O){f=v.stateNode,p8(I1.current);var ee=null;switch(E){case"input":q=ei(f,q),O=ei(f,O),ee=[];break;case"select":q=Re({},q,{value:void 0}),O=Re({},O,{value:void 0}),ee=[];break;case"textarea":q=x0(f,q),O=x0(f,O),ee=[];break;default:typeof q.onClick!="function"&&typeof O.onClick=="function"&&(f.onclick=FR)}Oz(E,O);var pe;E=null;for(kt in q)if(!O.hasOwnProperty(kt)&&q.hasOwnProperty(kt)&&q[kt]!=null)if(kt==="style"){var Le=q[kt];for(pe in Le)Le.hasOwnProperty(pe)&&(E||(E={}),E[pe]="")}else kt!=="dangerouslySetInnerHTML"&&kt!=="children"&&kt!=="suppressContentEditableWarning"&&kt!=="suppressHydrationWarning"&&kt!=="autoFocus"&&(S.hasOwnProperty(kt)?ee||(ee=[]):(ee=ee||[]).push(kt,null));for(kt in O){var tt=O[kt];if(Le=q!=null?q[kt]:void 0,O.hasOwnProperty(kt)&&tt!==Le&&(tt!=null||Le!=null))if(kt==="style")if(Le){for(pe in Le)!Le.hasOwnProperty(pe)||tt&&tt.hasOwnProperty(pe)||(E||(E={}),E[pe]="");for(pe in tt)tt.hasOwnProperty(pe)&&Le[pe]!==tt[pe]&&(E||(E={}),E[pe]=tt[pe])}else E||(ee||(ee=[]),ee.push(kt,E)),E=tt;else kt==="dangerouslySetInnerHTML"?(tt=tt?tt.__html:void 0,Le=Le?Le.__html:void 0,tt!=null&&Le!==tt&&(ee=ee||[]).push(kt,tt)):kt==="children"?typeof tt!="string"&&typeof tt!="number"||(ee=ee||[]).push(kt,""+tt):kt!=="suppressContentEditableWarning"&&kt!=="suppressHydrationWarning"&&(S.hasOwnProperty(kt)?(tt!=null&&kt==="onScroll"&&ho("scroll",f),ee||Le===tt||(ee=[])):(ee=ee||[]).push(kt,tt))}E&&(ee=ee||[]).push("style",E);var kt=ee;(v.updateQueue=kt)&&(v.flags|=4)}},p3e=function(f,v,E,O){E!==O&&(v.flags|=4)};function Ww(f,v){if(!To)switch(f.tailMode){case"hidden":v=f.tail;for(var E=null;v!==null;)v.alternate!==null&&(E=v),v=v.sibling;E===null?f.tail=null:E.sibling=null;break;case"collapsed":E=f.tail;for(var O=null;E!==null;)E.alternate!==null&&(O=E),E=E.sibling;O===null?v||f.tail===null?f.tail=null:f.tail.sibling=null:O.sibling=null}}function Ul(f){var v=f.alternate!==null&&f.alternate.child===f.child,E=0,O=0;if(v)for(var q=f.child;q!==null;)E|=q.lanes|q.childLanes,O|=q.subtreeFlags&14680064,O|=q.flags&14680064,q.return=f,q=q.sibling;else for(q=f.child;q!==null;)E|=q.lanes|q.childLanes,O|=q.subtreeFlags,O|=q.flags,q.return=f,q=q.sibling;return f.subtreeFlags|=O,f.childLanes=E,v}function bIe(f,v,E){var O=v.pendingProps;switch(bV(v),v.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ul(v),null;case 1:return pu(v.type)&&BR(),Ul(v),null;case 3:return O=v.stateNode,r_(),fo(fu),fo(Ll),LV(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(f===null||f.child===null)&&(HR(v)?v.flags|=4:f===null||f.memoizedState.isDehydrated&&!(v.flags&256)||(v.flags|=1024,Of!==null&&(cG(Of),Of=null))),JV(f,v),Ul(v),null;case 5:DV(v);var q=p8(zw.current);if(E=v.type,f!==null&&v.stateNode!=null)f3e(f,v,E,O,q),f.ref!==v.ref&&(v.flags|=512,v.flags|=2097152);else{if(!O){if(v.stateNode===null)throw Error(m(166));return Ul(v),null}if(f=p8(I1.current),HR(v)){O=v.stateNode,E=v.type;var ee=v.memoizedProps;switch(O[R1]=v,O[Ow]=ee,f=(v.mode&1)!==0,E){case"dialog":ho("cancel",O),ho("close",O);break;case"iframe":case"object":case"embed":ho("load",O);break;case"video":case"audio":for(q=0;q<Nw.length;q++)ho(Nw[q],O);break;case"source":ho("error",O);break;case"img":case"image":case"link":ho("error",O),ho("load",O);break;case"details":ho("toggle",O);break;case"input":uo(O,ee),ho("invalid",O);break;case"select":O._wrapperState={wasMultiple:!!ee.multiple},ho("invalid",O);break;case"textarea":Hr(O,ee),ho("invalid",O)}Oz(E,ee),q=null;for(var pe in ee)if(ee.hasOwnProperty(pe)){var Le=ee[pe];pe==="children"?typeof Le=="string"?O.textContent!==Le&&(ee.suppressHydrationWarning!==!0&&LR(O.textContent,Le,f),q=["children",Le]):typeof Le=="number"&&O.textContent!==""+Le&&(ee.suppressHydrationWarning!==!0&&LR(O.textContent,Le,f),q=["children",""+Le]):S.hasOwnProperty(pe)&&Le!=null&&pe==="onScroll"&&ho("scroll",O)}switch(E){case"input":Pr(O),_0(O,ee,!0);break;case"textarea":Pr(O),Xg(O);break;case"select":case"option":break;default:typeof ee.onClick=="function"&&(O.onclick=FR)}O=q,v.updateQueue=O,O!==null&&(v.flags|=4)}else{pe=q.nodeType===9?q:q.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=F7(E)),f==="http://www.w3.org/1999/xhtml"?E==="script"?(f=pe.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof O.is=="string"?f=pe.createElement(E,{is:O.is}):(f=pe.createElement(E),E==="select"&&(pe=f,O.multiple?pe.multiple=!0:O.size&&(pe.size=O.size))):f=pe.createElementNS(f,E),f[R1]=v,f[Ow]=O,h3e(f,v,!1,!1),v.stateNode=f;e:{switch(pe=Lz(E,O),E){case"dialog":ho("cancel",f),ho("close",f),q=O;break;case"iframe":case"object":case"embed":ho("load",f),q=O;break;case"video":case"audio":for(q=0;q<Nw.length;q++)ho(Nw[q],f);q=O;break;case"source":ho("error",f),q=O;break;case"img":case"image":case"link":ho("error",f),ho("load",f),q=O;break;case"details":ho("toggle",f),q=O;break;case"input":uo(f,O),q=ei(f,O),ho("invalid",f);break;case"option":q=O;break;case"select":f._wrapperState={wasMultiple:!!O.multiple},q=Re({},O,{value:void 0}),ho("invalid",f);break;case"textarea":Hr(f,O),q=x0(f,O),ho("invalid",f);break;default:q=O}Oz(E,q),Le=q;for(ee in Le)if(Le.hasOwnProperty(ee)){var tt=Le[ee];ee==="style"?tge(f,tt):ee==="dangerouslySetInnerHTML"?(tt=tt?tt.__html:void 0,tt!=null&&Jme(f,tt)):ee==="children"?typeof tt=="string"?(E!=="textarea"||tt!=="")&&pw(f,tt):typeof tt=="number"&&pw(f,""+tt):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(S.hasOwnProperty(ee)?tt!=null&&ee==="onScroll"&&ho("scroll",f):tt!=null&&Ae(f,ee,tt,pe))}switch(E){case"input":Pr(f),_0(f,O,!1);break;case"textarea":Pr(f),Xg(f);break;case"option":O.value!=null&&f.setAttribute("value",""+Sn(O.value));break;case"select":f.multiple=!!O.multiple,ee=O.value,ee!=null?hu(f,!!O.multiple,ee,!1):O.defaultValue!=null&&hu(f,!!O.multiple,O.defaultValue,!0);break;default:typeof q.onClick=="function"&&(f.onclick=FR)}switch(E){case"button":case"input":case"select":case"textarea":O=!!O.autoFocus;break e;case"img":O=!0;break e;default:O=!1}}O&&(v.flags|=4)}v.ref!==null&&(v.flags|=512,v.flags|=2097152)}return Ul(v),null;case 6:if(f&&v.stateNode!=null)p3e(f,v,f.memoizedProps,O);else{if(typeof O!="string"&&v.stateNode===null)throw Error(m(166));if(E=p8(zw.current),p8(I1.current),HR(v)){if(O=v.stateNode,E=v.memoizedProps,O[R1]=v,(ee=O.nodeValue!==E)&&(f=dd,f!==null))switch(f.tag){case 3:LR(O.nodeValue,E,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&LR(O.nodeValue,E,(f.mode&1)!==0)}ee&&(v.flags|=4)}else O=(E.nodeType===9?E:E.ownerDocument).createTextNode(O),O[R1]=v,v.stateNode=O}return Ul(v),null;case 13:if(fo(jo),O=v.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(To&&hd!==null&&v.mode&1&&!(v.flags&128))g2e(),J7(),v.flags|=98560,ee=!1;else if(ee=HR(v),O!==null&&O.dehydrated!==null){if(f===null){if(!ee)throw Error(m(318));if(ee=v.memoizedState,ee=ee!==null?ee.dehydrated:null,!ee)throw Error(m(317));ee[R1]=v}else J7(),!(v.flags&128)&&(v.memoizedState=null),v.flags|=4;Ul(v),ee=!1}else Of!==null&&(cG(Of),Of=null),ee=!0;if(!ee)return v.flags&65536?v:null}return v.flags&128?(v.lanes=E,v):(O=O!==null,O!==(f!==null&&f.memoizedState!==null)&&O&&(v.child.flags|=8192,v.mode&1&&(f===null||jo.current&1?Ya===0&&(Ya=3):hG())),v.updateQueue!==null&&(v.flags|=4),Ul(v),null);case 4:return r_(),JV(f,v),f===null&&kw(v.stateNode.containerInfo),Ul(v),null;case 10:return CV(v.type._context),Ul(v),null;case 17:return pu(v.type)&&BR(),Ul(v),null;case 19:if(fo(jo),ee=v.memoizedState,ee===null)return Ul(v),null;if(O=(v.flags&128)!==0,pe=ee.rendering,pe===null)if(O)Ww(ee,!1);else{if(Ya!==0||f!==null&&f.flags&128)for(f=v.child;f!==null;){if(pe=ZR(f),pe!==null){for(v.flags|=128,Ww(ee,!1),O=pe.updateQueue,O!==null&&(v.updateQueue=O,v.flags|=4),v.subtreeFlags=0,O=E,E=v.child;E!==null;)ee=E,f=O,ee.flags&=14680066,pe=ee.alternate,pe===null?(ee.childLanes=0,ee.lanes=f,ee.child=null,ee.subtreeFlags=0,ee.memoizedProps=null,ee.memoizedState=null,ee.updateQueue=null,ee.dependencies=null,ee.stateNode=null):(ee.childLanes=pe.childLanes,ee.lanes=pe.lanes,ee.child=pe.child,ee.subtreeFlags=0,ee.deletions=null,ee.memoizedProps=pe.memoizedProps,ee.memoizedState=pe.memoizedState,ee.updateQueue=pe.updateQueue,ee.type=pe.type,f=pe.dependencies,ee.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),E=E.sibling;return Js(jo,jo.current&1|2),v.child}f=f.sibling}ee.tail!==null&&ba()>a_&&(v.flags|=128,O=!0,Ww(ee,!1),v.lanes=4194304)}else{if(!O)if(f=ZR(pe),f!==null){if(v.flags|=128,O=!0,E=f.updateQueue,E!==null&&(v.updateQueue=E,v.flags|=4),Ww(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!pe.alternate&&!To)return Ul(v),null}else 2*ba()-ee.renderingStartTime>a_&&E!==1073741824&&(v.flags|=128,O=!0,Ww(ee,!1),v.lanes=4194304);ee.isBackwards?(pe.sibling=v.child,v.child=pe):(E=ee.last,E!==null?E.sibling=pe:v.child=pe,ee.last=pe)}return ee.tail!==null?(v=ee.tail,ee.rendering=v,ee.tail=v.sibling,ee.renderingStartTime=ba(),v.sibling=null,E=jo.current,Js(jo,O?E&1|2:E&1),v):(Ul(v),null);case 22:case 23:return dG(),O=v.memoizedState!==null,f!==null&&f.memoizedState!==null!==O&&(v.flags|=8192),O&&v.mode&1?fd&1073741824&&(Ul(v),v.subtreeFlags&6&&(v.flags|=8192)):Ul(v),null;case 24:return null;case 25:return null}throw Error(m(156,v.tag))}function SIe(f,v){switch(bV(v),v.tag){case 1:return pu(v.type)&&BR(),f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 3:return r_(),fo(fu),fo(Ll),LV(),f=v.flags,f&65536&&!(f&128)?(v.flags=f&-65537|128,v):null;case 5:return DV(v),null;case 13:if(fo(jo),f=v.memoizedState,f!==null&&f.dehydrated!==null){if(v.alternate===null)throw Error(m(340));J7()}return f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 19:return fo(jo),null;case 4:return r_(),null;case 10:return CV(v.type._context),null;case 22:case 23:return dG(),null;case 24:return null;default:return null}}var sI=!1,Bl=!1,wIe=typeof WeakSet=="function"?WeakSet:Set,lr=null;function s_(f,v){var E=f.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(O){aa(f,v,O)}else E.current=null}function m3e(f,v,E){try{E()}catch(O){aa(f,v,O)}}var g3e=!1;function TIe(f,v){if(hV=SR,f=Hge(),oV(f)){if("selectionStart"in f)var E={start:f.selectionStart,end:f.selectionEnd};else e:{E=(E=f.ownerDocument)&&E.defaultView||window;var O=E.getSelection&&E.getSelection();if(O&&O.rangeCount!==0){E=O.anchorNode;var q=O.anchorOffset,ee=O.focusNode;O=O.focusOffset;try{E.nodeType,ee.nodeType}catch{E=null;break e}var pe=0,Le=-1,tt=-1,kt=0,hn=0,mn=f,cn=null;t:for(;;){for(var Jn;mn!==E||q!==0&&mn.nodeType!==3||(Le=pe+q),mn!==ee||O!==0&&mn.nodeType!==3||(tt=pe+O),mn.nodeType===3&&(pe+=mn.nodeValue.length),(Jn=mn.firstChild)!==null;)cn=mn,mn=Jn;for(;;){if(mn===f)break t;if(cn===E&&++kt===q&&(Le=pe),cn===ee&&++hn===O&&(tt=pe),(Jn=mn.nextSibling)!==null)break;mn=cn,cn=mn.parentNode}mn=Jn}E=Le===-1||tt===-1?null:{start:Le,end:tt}}else E=null}E=E||{start:0,end:0}}else E=null;for(fV={focusedElem:f,selectionRange:E},SR=!1,lr=v;lr!==null;)if(v=lr,f=v.child,(v.subtreeFlags&1028)!==0&&f!==null)f.return=v,lr=f;else for(;lr!==null;){v=lr;try{var mr=v.alternate;if(v.flags&1024)switch(v.tag){case 0:case 11:case 15:break;case 1:if(mr!==null){var vr=mr.memoizedProps,Sa=mr.memoizedState,wt=v.stateNode,ut=wt.getSnapshotBeforeUpdate(v.elementType===v.type?vr:Lf(v.type,vr),Sa);wt.__reactInternalSnapshotBeforeUpdate=ut}break;case 3:var Pt=v.stateNode.containerInfo;Pt.nodeType===1?Pt.textContent="":Pt.nodeType===9&&Pt.documentElement&&Pt.removeChild(Pt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(m(163))}}catch(Tn){aa(v,v.return,Tn)}if(f=v.sibling,f!==null){f.return=v.return,lr=f;break}lr=v.return}return mr=g3e,g3e=!1,mr}function qw(f,v,E){var O=v.updateQueue;if(O=O!==null?O.lastEffect:null,O!==null){var q=O=O.next;do{if((q.tag&f)===f){var ee=q.destroy;q.destroy=void 0,ee!==void 0&&m3e(v,E,ee)}q=q.next}while(q!==O)}}function oI(f,v){if(v=v.updateQueue,v=v!==null?v.lastEffect:null,v!==null){var E=v=v.next;do{if((E.tag&f)===f){var O=E.create;E.destroy=O()}E=E.next}while(E!==v)}}function eG(f){var v=f.ref;if(v!==null){var E=f.stateNode;switch(f.tag){case 5:f=E;break;default:f=E}typeof v=="function"?v(f):v.current=f}}function v3e(f){var v=f.alternate;v!==null&&(f.alternate=null,v3e(v)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(v=f.stateNode,v!==null&&(delete v[R1],delete v[Ow],delete v[vV],delete v[oIe],delete v[aIe])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function y3e(f){return f.tag===5||f.tag===3||f.tag===4}function _3e(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||y3e(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function tG(f,v,E){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?E.nodeType===8?E.parentNode.insertBefore(f,v):E.insertBefore(f,v):(E.nodeType===8?(v=E.parentNode,v.insertBefore(f,E)):(v=E,v.appendChild(f)),E=E._reactRootContainer,E!=null||v.onclick!==null||(v.onclick=FR));else if(O!==4&&(f=f.child,f!==null))for(tG(f,v,E),f=f.sibling;f!==null;)tG(f,v,E),f=f.sibling}function nG(f,v,E){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?E.insertBefore(f,v):E.appendChild(f);else if(O!==4&&(f=f.child,f!==null))for(nG(f,v,E),f=f.sibling;f!==null;)nG(f,v,E),f=f.sibling}var K0=null,Ff=!1;function L9(f,v,E){for(E=E.child;E!==null;)x3e(f,v,E),E=E.sibling}function x3e(f,v,E){if(P1&&typeof P1.onCommitFiberUnmount=="function")try{P1.onCommitFiberUnmount(gR,E)}catch{}switch(E.tag){case 5:Bl||s_(E,v);case 6:var O=K0,q=Ff;K0=null,L9(f,v,E),K0=O,Ff=q,K0!==null&&(Ff?(f=K0,E=E.stateNode,f.nodeType===8?f.parentNode.removeChild(E):f.removeChild(E)):K0.removeChild(E.stateNode));break;case 18:K0!==null&&(Ff?(f=K0,E=E.stateNode,f.nodeType===8?gV(f.parentNode,E):f.nodeType===1&&gV(f,E),Tw(f)):gV(K0,E.stateNode));break;case 4:O=K0,q=Ff,K0=E.stateNode.containerInfo,Ff=!0,L9(f,v,E),K0=O,Ff=q;break;case 0:case 11:case 14:case 15:if(!Bl&&(O=E.updateQueue,O!==null&&(O=O.lastEffect,O!==null))){q=O=O.next;do{var ee=q,pe=ee.destroy;ee=ee.tag,pe!==void 0&&(ee&2||ee&4)&&m3e(E,v,pe),q=q.next}while(q!==O)}L9(f,v,E);break;case 1:if(!Bl&&(s_(E,v),O=E.stateNode,typeof O.componentWillUnmount=="function"))try{O.props=E.memoizedProps,O.state=E.memoizedState,O.componentWillUnmount()}catch(Le){aa(E,v,Le)}L9(f,v,E);break;case 21:L9(f,v,E);break;case 22:E.mode&1?(Bl=(O=Bl)||E.memoizedState!==null,L9(f,v,E),Bl=O):L9(f,v,E);break;default:L9(f,v,E)}}function b3e(f){var v=f.updateQueue;if(v!==null){f.updateQueue=null;var E=f.stateNode;E===null&&(E=f.stateNode=new wIe),v.forEach(function(O){var q=kIe.bind(null,f,O);E.has(O)||(E.add(O),O.then(q,q))})}}function Uf(f,v){var E=v.deletions;if(E!==null)for(var O=0;O<E.length;O++){var q=E[O];try{var ee=f,pe=v,Le=pe;e:for(;Le!==null;){switch(Le.tag){case 5:K0=Le.stateNode,Ff=!1;break e;case 3:K0=Le.stateNode.containerInfo,Ff=!0;break e;case 4:K0=Le.stateNode.containerInfo,Ff=!0;break e}Le=Le.return}if(K0===null)throw Error(m(160));x3e(ee,pe,q),K0=null,Ff=!1;var tt=q.alternate;tt!==null&&(tt.return=null),q.return=null}catch(kt){aa(q,v,kt)}}if(v.subtreeFlags&12854)for(v=v.child;v!==null;)S3e(v,f),v=v.sibling}function S3e(f,v){var E=f.alternate,O=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Uf(v,f),k1(f),O&4){try{qw(3,f,f.return),oI(3,f)}catch(vr){aa(f,f.return,vr)}try{qw(5,f,f.return)}catch(vr){aa(f,f.return,vr)}}break;case 1:Uf(v,f),k1(f),O&512&&E!==null&&s_(E,E.return);break;case 5:if(Uf(v,f),k1(f),O&512&&E!==null&&s_(E,E.return),f.flags&32){var q=f.stateNode;try{pw(q,"")}catch(vr){aa(f,f.return,vr)}}if(O&4&&(q=f.stateNode,q!=null)){var ee=f.memoizedProps,pe=E!==null?E.memoizedProps:ee,Le=f.type,tt=f.updateQueue;if(f.updateQueue=null,tt!==null)try{Le==="input"&&ee.type==="radio"&&ee.name!=null&&pi(q,ee),Lz(Le,pe);var kt=Lz(Le,ee);for(pe=0;pe<tt.length;pe+=2){var hn=tt[pe],mn=tt[pe+1];hn==="style"?tge(q,mn):hn==="dangerouslySetInnerHTML"?Jme(q,mn):hn==="children"?pw(q,mn):Ae(q,hn,mn,kt)}switch(Le){case"input":wi(q,ee);break;case"textarea":ci(q,ee);break;case"select":var cn=q._wrapperState.wasMultiple;q._wrapperState.wasMultiple=!!ee.multiple;var Jn=ee.value;Jn!=null?hu(q,!!ee.multiple,Jn,!1):cn!==!!ee.multiple&&(ee.defaultValue!=null?hu(q,!!ee.multiple,ee.defaultValue,!0):hu(q,!!ee.multiple,ee.multiple?[]:"",!1))}q[Ow]=ee}catch(vr){aa(f,f.return,vr)}}break;case 6:if(Uf(v,f),k1(f),O&4){if(f.stateNode===null)throw Error(m(162));q=f.stateNode,ee=f.memoizedProps;try{q.nodeValue=ee}catch(vr){aa(f,f.return,vr)}}break;case 3:if(Uf(v,f),k1(f),O&4&&E!==null&&E.memoizedState.isDehydrated)try{Tw(v.containerInfo)}catch(vr){aa(f,f.return,vr)}break;case 4:Uf(v,f),k1(f);break;case 13:Uf(v,f),k1(f),q=f.child,q.flags&8192&&(ee=q.memoizedState!==null,q.stateNode.isHidden=ee,!ee||q.alternate!==null&&q.alternate.memoizedState!==null||(sG=ba())),O&4&&b3e(f);break;case 22:if(hn=E!==null&&E.memoizedState!==null,f.mode&1?(Bl=(kt=Bl)||hn,Uf(v,f),Bl=kt):Uf(v,f),k1(f),O&8192){if(kt=f.memoizedState!==null,(f.stateNode.isHidden=kt)&&!hn&&f.mode&1)for(lr=f,hn=f.child;hn!==null;){for(mn=lr=hn;lr!==null;){switch(cn=lr,Jn=cn.child,cn.tag){case 0:case 11:case 14:case 15:qw(4,cn,cn.return);break;case 1:s_(cn,cn.return);var mr=cn.stateNode;if(typeof mr.componentWillUnmount=="function"){O=cn,E=cn.return;try{v=O,mr.props=v.memoizedProps,mr.state=v.memoizedState,mr.componentWillUnmount()}catch(vr){aa(O,E,vr)}}break;case 5:s_(cn,cn.return);break;case 22:if(cn.memoizedState!==null){E3e(mn);continue}}Jn!==null?(Jn.return=cn,lr=Jn):E3e(mn)}hn=hn.sibling}e:for(hn=null,mn=f;;){if(mn.tag===5){if(hn===null){hn=mn;try{q=mn.stateNode,kt?(ee=q.style,typeof ee.setProperty=="function"?ee.setProperty("display","none","important"):ee.display="none"):(Le=mn.stateNode,tt=mn.memoizedProps.style,pe=tt!=null&&tt.hasOwnProperty("display")?tt.display:null,Le.style.display=ege("display",pe))}catch(vr){aa(f,f.return,vr)}}}else if(mn.tag===6){if(hn===null)try{mn.stateNode.nodeValue=kt?"":mn.memoizedProps}catch(vr){aa(f,f.return,vr)}}else if((mn.tag!==22&&mn.tag!==23||mn.memoizedState===null||mn===f)&&mn.child!==null){mn.child.return=mn,mn=mn.child;continue}if(mn===f)break e;for(;mn.sibling===null;){if(mn.return===null||mn.return===f)break e;hn===mn&&(hn=null),mn=mn.return}hn===mn&&(hn=null),mn.sibling.return=mn.return,mn=mn.sibling}}break;case 19:Uf(v,f),k1(f),O&4&&b3e(f);break;case 21:break;default:Uf(v,f),k1(f)}}function k1(f){var v=f.flags;if(v&2){try{e:{for(var E=f.return;E!==null;){if(y3e(E)){var O=E;break e}E=E.return}throw Error(m(160))}switch(O.tag){case 5:var q=O.stateNode;O.flags&32&&(pw(q,""),O.flags&=-33);var ee=_3e(f);nG(f,ee,q);break;case 3:case 4:var pe=O.stateNode.containerInfo,Le=_3e(f);tG(f,Le,pe);break;default:throw Error(m(161))}}catch(tt){aa(f,f.return,tt)}f.flags&=-3}v&4096&&(f.flags&=-4097)}function EIe(f,v,E){lr=f,w3e(f)}function w3e(f,v,E){for(var O=(f.mode&1)!==0;lr!==null;){var q=lr,ee=q.child;if(q.tag===22&&O){var pe=q.memoizedState!==null||sI;if(!pe){var Le=q.alternate,tt=Le!==null&&Le.memoizedState!==null||Bl;Le=sI;var kt=Bl;if(sI=pe,(Bl=tt)&&!kt)for(lr=q;lr!==null;)pe=lr,tt=pe.child,pe.tag===22&&pe.memoizedState!==null?M3e(q):tt!==null?(tt.return=pe,lr=tt):M3e(q);for(;ee!==null;)lr=ee,w3e(ee),ee=ee.sibling;lr=q,sI=Le,Bl=kt}T3e(f)}else q.subtreeFlags&8772&&ee!==null?(ee.return=q,lr=ee):T3e(f)}}function T3e(f){for(;lr!==null;){var v=lr;if(v.flags&8772){var E=v.alternate;try{if(v.flags&8772)switch(v.tag){case 0:case 11:case 15:Bl||oI(5,v);break;case 1:var O=v.stateNode;if(v.flags&4&&!Bl)if(E===null)O.componentDidMount();else{var q=v.elementType===v.type?E.memoizedProps:Lf(v.type,E.memoizedProps);O.componentDidUpdate(q,E.memoizedState,O.__reactInternalSnapshotBeforeUpdate)}var ee=v.updateQueue;ee!==null&&x2e(v,ee,O);break;case 3:var pe=v.updateQueue;if(pe!==null){if(E=null,v.child!==null)switch(v.child.tag){case 5:E=v.child.stateNode;break;case 1:E=v.child.stateNode}x2e(v,pe,E)}break;case 5:var Le=v.stateNode;if(E===null&&v.flags&4){E=Le;var tt=v.memoizedProps;switch(v.type){case"button":case"input":case"select":case"textarea":tt.autoFocus&&E.focus();break;case"img":tt.src&&(E.src=tt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(v.memoizedState===null){var kt=v.alternate;if(kt!==null){var hn=kt.memoizedState;if(hn!==null){var mn=hn.dehydrated;mn!==null&&Tw(mn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(m(163))}Bl||v.flags&512&&eG(v)}catch(cn){aa(v,v.return,cn)}}if(v===f){lr=null;break}if(E=v.sibling,E!==null){E.return=v.return,lr=E;break}lr=v.return}}function E3e(f){for(;lr!==null;){var v=lr;if(v===f){lr=null;break}var E=v.sibling;if(E!==null){E.return=v.return,lr=E;break}lr=v.return}}function M3e(f){for(;lr!==null;){var v=lr;try{switch(v.tag){case 0:case 11:case 15:var E=v.return;try{oI(4,v)}catch(tt){aa(v,E,tt)}break;case 1:var O=v.stateNode;if(typeof O.componentDidMount=="function"){var q=v.return;try{O.componentDidMount()}catch(tt){aa(v,q,tt)}}var ee=v.return;try{eG(v)}catch(tt){aa(v,ee,tt)}break;case 5:var pe=v.return;try{eG(v)}catch(tt){aa(v,pe,tt)}}}catch(tt){aa(v,v.return,tt)}if(v===f){lr=null;break}var Le=v.sibling;if(Le!==null){Le.return=v.return,lr=Le;break}lr=v.return}}var MIe=Math.ceil,aI=Ce.ReactCurrentDispatcher,rG=Ce.ReactCurrentOwner,ph=Ce.ReactCurrentBatchConfig,es=0,S0=null,Da=null,Z0=0,fd=0,o_=I9(0),Ya=0,$w=null,g8=0,lI=0,iG=0,Xw=null,gu=null,sG=0,a_=1/0,n2=null,cI=!1,oG=null,F9=null,uI=!1,U9=null,dI=0,Yw=0,aG=null,hI=-1,fI=0;function Cc(){return es&6?ba():hI!==-1?hI:hI=ba()}function B9(f){return f.mode&1?es&2&&Z0!==0?Z0&-Z0:cIe.transition!==null?(fI===0&&(fI=gge()),fI):(f=Ns,f!==0||(f=window.event,f=f===void 0?16:Ege(f.type)),f):1}function Bf(f,v,E,O){if(50<Yw)throw Yw=0,aG=null,Error(m(185));_w(f,E,O),(!(es&2)||f!==S0)&&(f===S0&&(!(es&2)&&(lI|=E),Ya===4&&z9(f,Z0)),vu(f,O),E===1&&es===0&&!(v.mode&1)&&(a_=ba()+500,VR&&k9()))}function vu(f,v){var E=f.callbackNode;dRe(f,v);var O=_R(f,f===S0?Z0:0);if(O===0)E!==null&&fge(E),f.callbackNode=null,f.callbackPriority=0;else if(v=O&-O,f.callbackPriority!==v){if(E!=null&&fge(E),v===1)f.tag===0?lIe(A3e.bind(null,f)):d2e(A3e.bind(null,f)),iIe(function(){!(es&6)&&k9()}),E=null;else{switch(vge(O)){case 1:E=jz;break;case 4:E=pge;break;case 16:E=mR;break;case 536870912:E=mge;break;default:E=mR}E=L3e(E,C3e.bind(null,f))}f.callbackPriority=v,f.callbackNode=E}}function C3e(f,v){if(hI=-1,fI=0,es&6)throw Error(m(327));var E=f.callbackNode;if(l_()&&f.callbackNode!==E)return null;var O=_R(f,f===S0?Z0:0);if(O===0)return null;if(O&30||O&f.expiredLanes||v)v=pI(f,O);else{v=O;var q=es;es|=2;var ee=R3e();(S0!==f||Z0!==v)&&(n2=null,a_=ba()+500,y8(f,v));do try{PIe();break}catch(Le){P3e(f,Le)}while(!0);MV(),aI.current=ee,es=q,Da!==null?v=0:(S0=null,Z0=0,v=Ya)}if(v!==0){if(v===2&&(q=Hz(f),q!==0&&(O=q,v=lG(f,q))),v===1)throw E=$w,y8(f,0),z9(f,O),vu(f,ba()),E;if(v===6)z9(f,O);else{if(q=f.current.alternate,!(O&30)&&!CIe(q)&&(v=pI(f,O),v===2&&(ee=Hz(f),ee!==0&&(O=ee,v=lG(f,ee))),v===1))throw E=$w,y8(f,0),z9(f,O),vu(f,ba()),E;switch(f.finishedWork=q,f.finishedLanes=O,v){case 0:case 1:throw Error(m(345));case 2:_8(f,gu,n2);break;case 3:if(z9(f,O),(O&130023424)===O&&(v=sG+500-ba(),10<v)){if(_R(f,0)!==0)break;if(q=f.suspendedLanes,(q&O)!==O){Cc(),f.pingedLanes|=f.suspendedLanes&q;break}f.timeoutHandle=mV(_8.bind(null,f,gu,n2),v);break}_8(f,gu,n2);break;case 4:if(z9(f,O),(O&4194240)===O)break;for(v=f.eventTimes,q=-1;0<O;){var pe=31-kf(O);ee=1<<pe,pe=v[pe],pe>q&&(q=pe),O&=~ee}if(O=q,O=ba()-O,O=(120>O?120:480>O?480:1080>O?1080:1920>O?1920:3e3>O?3e3:4320>O?4320:1960*MIe(O/1960))-O,10<O){f.timeoutHandle=mV(_8.bind(null,f,gu,n2),O);break}_8(f,gu,n2);break;case 5:_8(f,gu,n2);break;default:throw Error(m(329))}}}return vu(f,ba()),f.callbackNode===E?C3e.bind(null,f):null}function lG(f,v){var E=Xw;return f.current.memoizedState.isDehydrated&&(y8(f,v).flags|=256),f=pI(f,v),f!==2&&(v=gu,gu=E,v!==null&&cG(v)),f}function cG(f){gu===null?gu=f:gu.push.apply(gu,f)}function CIe(f){for(var v=f;;){if(v.flags&16384){var E=v.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var O=0;O<E.length;O++){var q=E[O],ee=q.getSnapshot;q=q.value;try{if(!Df(ee(),q))return!1}catch{return!1}}}if(E=v.child,v.subtreeFlags&16384&&E!==null)E.return=v,v=E;else{if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function z9(f,v){for(v&=~iG,v&=~lI,f.suspendedLanes|=v,f.pingedLanes&=~v,f=f.expirationTimes;0<v;){var E=31-kf(v),O=1<<E;f[E]=-1,v&=~O}}function A3e(f){if(es&6)throw Error(m(327));l_();var v=_R(f,0);if(!(v&1))return vu(f,ba()),null;var E=pI(f,v);if(f.tag!==0&&E===2){var O=Hz(f);O!==0&&(v=O,E=lG(f,O))}if(E===1)throw E=$w,y8(f,0),z9(f,v),vu(f,ba()),E;if(E===6)throw Error(m(345));return f.finishedWork=f.current.alternate,f.finishedLanes=v,_8(f,gu,n2),vu(f,ba()),null}function uG(f,v){var E=es;es|=1;try{return f(v)}finally{es=E,es===0&&(a_=ba()+500,VR&&k9())}}function v8(f){U9!==null&&U9.tag===0&&!(es&6)&&l_();var v=es;es|=1;var E=ph.transition,O=Ns;try{if(ph.transition=null,Ns=1,f)return f()}finally{Ns=O,ph.transition=E,es=v,!(es&6)&&k9()}}function dG(){fd=o_.current,fo(o_)}function y8(f,v){f.finishedWork=null,f.finishedLanes=0;var E=f.timeoutHandle;if(E!==-1&&(f.timeoutHandle=-1,rIe(E)),Da!==null)for(E=Da.return;E!==null;){var O=E;switch(bV(O),O.tag){case 1:O=O.type.childContextTypes,O!=null&&BR();break;case 3:r_(),fo(fu),fo(Ll),LV();break;case 5:DV(O);break;case 4:r_();break;case 13:fo(jo);break;case 19:fo(jo);break;case 10:CV(O.type._context);break;case 22:case 23:dG()}E=E.return}if(S0=f,Da=f=V9(f.current,null),Z0=fd=v,Ya=0,$w=null,iG=lI=g8=0,gu=Xw=null,f8!==null){for(v=0;v<f8.length;v++)if(E=f8[v],O=E.interleaved,O!==null){E.interleaved=null;var q=O.next,ee=E.pending;if(ee!==null){var pe=ee.next;ee.next=q,O.next=pe}E.pending=O}f8=null}return f}function P3e(f,v){do{var E=Da;try{if(MV(),QR.current=nI,JR){for(var O=Ho.memoizedState;O!==null;){var q=O.queue;q!==null&&(q.pending=null),O=O.next}JR=!1}if(m8=0,b0=Xa=Ho=null,Vw=!1,Gw=0,rG.current=null,E===null||E.return===null){Ya=1,$w=v,Da=null;break}e:{var ee=f,pe=E.return,Le=E,tt=v;if(v=Z0,Le.flags|=32768,tt!==null&&typeof tt=="object"&&typeof tt.then=="function"){var kt=tt,hn=Le,mn=hn.tag;if(!(hn.mode&1)&&(mn===0||mn===11||mn===15)){var cn=hn.alternate;cn?(hn.updateQueue=cn.updateQueue,hn.memoizedState=cn.memoizedState,hn.lanes=cn.lanes):(hn.updateQueue=null,hn.memoizedState=null)}var Jn=J2e(pe);if(Jn!==null){Jn.flags&=-257,e3e(Jn,pe,Le,ee,v),Jn.mode&1&&Q2e(ee,kt,v),v=Jn,tt=kt;var mr=v.updateQueue;if(mr===null){var vr=new Set;vr.add(tt),v.updateQueue=vr}else mr.add(tt);break e}else{if(!(v&1)){Q2e(ee,kt,v),hG();break e}tt=Error(m(426))}}else if(To&&Le.mode&1){var Sa=J2e(pe);if(Sa!==null){!(Sa.flags&65536)&&(Sa.flags|=256),e3e(Sa,pe,Le,ee,v),TV(i_(tt,Le));break e}}ee=tt=i_(tt,Le),Ya!==4&&(Ya=2),Xw===null?Xw=[ee]:Xw.push(ee),ee=pe;do{switch(ee.tag){case 3:ee.flags|=65536,v&=-v,ee.lanes|=v;var wt=K2e(ee,tt,v);_2e(ee,wt);break e;case 1:Le=tt;var ut=ee.type,Pt=ee.stateNode;if(!(ee.flags&128)&&(typeof ut.getDerivedStateFromError=="function"||Pt!==null&&typeof Pt.componentDidCatch=="function"&&(F9===null||!F9.has(Pt)))){ee.flags|=65536,v&=-v,ee.lanes|=v;var Tn=Z2e(ee,Le,v);_2e(ee,Tn);break e}}ee=ee.return}while(ee!==null)}N3e(E)}catch(xr){v=xr,Da===E&&E!==null&&(Da=E=E.return);continue}break}while(!0)}function R3e(){var f=aI.current;return aI.current=nI,f===null?nI:f}function hG(){(Ya===0||Ya===3||Ya===2)&&(Ya=4),S0===null||!(g8&268435455)&&!(lI&268435455)||z9(S0,Z0)}function pI(f,v){var E=es;es|=2;var O=R3e();(S0!==f||Z0!==v)&&(n2=null,y8(f,v));do try{AIe();break}catch(q){P3e(f,q)}while(!0);if(MV(),es=E,aI.current=O,Da!==null)throw Error(m(261));return S0=null,Z0=0,Ya}function AIe(){for(;Da!==null;)I3e(Da)}function PIe(){for(;Da!==null&&!nRe();)I3e(Da)}function I3e(f){var v=O3e(f.alternate,f,fd);f.memoizedProps=f.pendingProps,v===null?N3e(f):Da=v,rG.current=null}function N3e(f){var v=f;do{var E=v.alternate;if(f=v.return,v.flags&32768){if(E=SIe(E,v),E!==null){E.flags&=32767,Da=E;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Ya=6,Da=null;return}}else if(E=bIe(E,v,fd),E!==null){Da=E;return}if(v=v.sibling,v!==null){Da=v;return}Da=v=f}while(v!==null);Ya===0&&(Ya=5)}function _8(f,v,E){var O=Ns,q=ph.transition;try{ph.transition=null,Ns=1,RIe(f,v,E,O)}finally{ph.transition=q,Ns=O}return null}function RIe(f,v,E,O){do l_();while(U9!==null);if(es&6)throw Error(m(327));E=f.finishedWork;var q=f.finishedLanes;if(E===null)return null;if(f.finishedWork=null,f.finishedLanes=0,E===f.current)throw Error(m(177));f.callbackNode=null,f.callbackPriority=0;var ee=E.lanes|E.childLanes;if(hRe(f,ee),f===S0&&(Da=S0=null,Z0=0),!(E.subtreeFlags&2064)&&!(E.flags&2064)||uI||(uI=!0,L3e(mR,function(){return l_(),null})),ee=(E.flags&15990)!==0,E.subtreeFlags&15990||ee){ee=ph.transition,ph.transition=null;var pe=Ns;Ns=1;var Le=es;es|=4,rG.current=null,TIe(f,E),S3e(E,f),QRe(fV),SR=!!hV,fV=hV=null,f.current=E,EIe(E),rRe(),es=Le,Ns=pe,ph.transition=ee}else f.current=E;if(uI&&(uI=!1,U9=f,dI=q),ee=f.pendingLanes,ee===0&&(F9=null),oRe(E.stateNode),vu(f,ba()),v!==null)for(O=f.onRecoverableError,E=0;E<v.length;E++)q=v[E],O(q.value,{componentStack:q.stack,digest:q.digest});if(cI)throw cI=!1,f=oG,oG=null,f;return dI&1&&f.tag!==0&&l_(),ee=f.pendingLanes,ee&1?f===aG?Yw++:(Yw=0,aG=f):Yw=0,k9(),null}function l_(){if(U9!==null){var f=vge(dI),v=ph.transition,E=Ns;try{if(ph.transition=null,Ns=16>f?16:f,U9===null)var O=!1;else{if(f=U9,U9=null,dI=0,es&6)throw Error(m(331));var q=es;for(es|=4,lr=f.current;lr!==null;){var ee=lr,pe=ee.child;if(lr.flags&16){var Le=ee.deletions;if(Le!==null){for(var tt=0;tt<Le.length;tt++){var kt=Le[tt];for(lr=kt;lr!==null;){var hn=lr;switch(hn.tag){case 0:case 11:case 15:qw(8,hn,ee)}var mn=hn.child;if(mn!==null)mn.return=hn,lr=mn;else for(;lr!==null;){hn=lr;var cn=hn.sibling,Jn=hn.return;if(v3e(hn),hn===kt){lr=null;break}if(cn!==null){cn.return=Jn,lr=cn;break}lr=Jn}}}var mr=ee.alternate;if(mr!==null){var vr=mr.child;if(vr!==null){mr.child=null;do{var Sa=vr.sibling;vr.sibling=null,vr=Sa}while(vr!==null)}}lr=ee}}if(ee.subtreeFlags&2064&&pe!==null)pe.return=ee,lr=pe;else e:for(;lr!==null;){if(ee=lr,ee.flags&2048)switch(ee.tag){case 0:case 11:case 15:qw(9,ee,ee.return)}var wt=ee.sibling;if(wt!==null){wt.return=ee.return,lr=wt;break e}lr=ee.return}}var ut=f.current;for(lr=ut;lr!==null;){pe=lr;var Pt=pe.child;if(pe.subtreeFlags&2064&&Pt!==null)Pt.return=pe,lr=Pt;else e:for(pe=ut;lr!==null;){if(Le=lr,Le.flags&2048)try{switch(Le.tag){case 0:case 11:case 15:oI(9,Le)}}catch(xr){aa(Le,Le.return,xr)}if(Le===pe){lr=null;break e}var Tn=Le.sibling;if(Tn!==null){Tn.return=Le.return,lr=Tn;break e}lr=Le.return}}if(es=q,k9(),P1&&typeof P1.onPostCommitFiberRoot=="function")try{P1.onPostCommitFiberRoot(gR,f)}catch{}O=!0}return O}finally{Ns=E,ph.transition=v}}return!1}function k3e(f,v,E){v=i_(E,v),v=K2e(f,v,1),f=O9(f,v,1),v=Cc(),f!==null&&(_w(f,1,v),vu(f,v))}function aa(f,v,E){if(f.tag===3)k3e(f,f,E);else for(;v!==null;){if(v.tag===3){k3e(v,f,E);break}else if(v.tag===1){var O=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(F9===null||!F9.has(O))){f=i_(E,f),f=Z2e(v,f,1),v=O9(v,f,1),f=Cc(),v!==null&&(_w(v,1,f),vu(v,f));break}}v=v.return}}function IIe(f,v,E){var O=f.pingCache;O!==null&&O.delete(v),v=Cc(),f.pingedLanes|=f.suspendedLanes&E,S0===f&&(Z0&E)===E&&(Ya===4||Ya===3&&(Z0&130023424)===Z0&&500>ba()-sG?y8(f,0):iG|=E),vu(f,v)}function D3e(f,v){v===0&&(f.mode&1?(v=yR,yR<<=1,!(yR&130023424)&&(yR=4194304)):v=1);var E=Cc();f=Jg(f,v),f!==null&&(_w(f,v,E),vu(f,E))}function NIe(f){var v=f.memoizedState,E=0;v!==null&&(E=v.retryLane),D3e(f,E)}function kIe(f,v){var E=0;switch(f.tag){case 13:var O=f.stateNode,q=f.memoizedState;q!==null&&(E=q.retryLane);break;case 19:O=f.stateNode;break;default:throw Error(m(314))}O!==null&&O.delete(v),D3e(f,E)}var O3e;O3e=function(f,v,E){if(f!==null)if(f.memoizedProps!==v.pendingProps||fu.current)mu=!0;else{if(!(f.lanes&E)&&!(v.flags&128))return mu=!1,xIe(f,v,E);mu=!!(f.flags&131072)}else mu=!1,To&&v.flags&1048576&&h2e(v,jR,v.index);switch(v.lanes=0,v.tag){case 2:var O=v.type;iI(f,v),f=v.pendingProps;var q=K7(v,Ll.current);t_(v,E),q=BV(null,v,O,f,q,E);var ee=zV();return v.flags|=1,typeof q=="object"&&q!==null&&typeof q.render=="function"&&q.$$typeof===void 0?(v.tag=1,v.memoizedState=null,v.updateQueue=null,pu(O)?(ee=!0,zR(v)):ee=!1,v.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,RV(v),q.updater=YR,v.stateNode=q,q._reactInternals=v,NV(v,O,f,E),v=XV(null,v,O,!0,ee,E)):(v.tag=0,To&&ee&&xV(v),Mc(null,v,q,E),v=v.child),v;case 16:O=v.elementType;e:{switch(iI(f,v),f=v.pendingProps,q=O._init,O=q(O._payload),v.type=O,q=v.tag=OIe(O),f=Lf(O,f),q){case 0:v=$V(null,v,O,f,E);break e;case 1:v=o3e(null,v,O,f,E);break e;case 11:v=t3e(null,v,O,f,E);break e;case 14:v=n3e(null,v,O,Lf(O.type,f),E);break e}throw Error(m(306,O,""))}return v;case 0:return O=v.type,q=v.pendingProps,q=v.elementType===O?q:Lf(O,q),$V(f,v,O,q,E);case 1:return O=v.type,q=v.pendingProps,q=v.elementType===O?q:Lf(O,q),o3e(f,v,O,q,E);case 3:e:{if(a3e(v),f===null)throw Error(m(387));O=v.pendingProps,ee=v.memoizedState,q=ee.element,y2e(f,v),XR(v,O,null,E);var pe=v.memoizedState;if(O=pe.element,ee.isDehydrated)if(ee={element:O,isDehydrated:!1,cache:pe.cache,pendingSuspenseBoundaries:pe.pendingSuspenseBoundaries,transitions:pe.transitions},v.updateQueue.baseState=ee,v.memoizedState=ee,v.flags&256){q=i_(Error(m(423)),v),v=l3e(f,v,O,E,q);break e}else if(O!==q){q=i_(Error(m(424)),v),v=l3e(f,v,O,E,q);break e}else for(hd=R9(v.stateNode.containerInfo.firstChild),dd=v,To=!0,Of=null,E=C2e(v,null,O,E),v.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if(J7(),O===q){v=t2(f,v,E);break e}Mc(f,v,O,E)}v=v.child}return v;case 5:return A2e(v),f===null&&wV(v),O=v.type,q=v.pendingProps,ee=f!==null?f.memoizedProps:null,pe=q.children,pV(O,q)?pe=null:ee!==null&&pV(O,ee)&&(v.flags|=32),s3e(f,v),Mc(f,v,pe,E),v.child;case 6:return f===null&&wV(v),null;case 13:return c3e(f,v,E);case 4:return kV(v,v.stateNode.containerInfo),O=v.pendingProps,f===null?v.child=n_(v,null,O,E):Mc(f,v,O,E),v.child;case 11:return O=v.type,q=v.pendingProps,q=v.elementType===O?q:Lf(O,q),t3e(f,v,O,q,E);case 7:return Mc(f,v,v.pendingProps,E),v.child;case 8:return Mc(f,v,v.pendingProps.children,E),v.child;case 12:return Mc(f,v,v.pendingProps.children,E),v.child;case 10:e:{if(O=v.type._context,q=v.pendingProps,ee=v.memoizedProps,pe=q.value,Js(WR,O._currentValue),O._currentValue=pe,ee!==null)if(Df(ee.value,pe)){if(ee.children===q.children&&!fu.current){v=t2(f,v,E);break e}}else for(ee=v.child,ee!==null&&(ee.return=v);ee!==null;){var Le=ee.dependencies;if(Le!==null){pe=ee.child;for(var tt=Le.firstContext;tt!==null;){if(tt.context===O){if(ee.tag===1){tt=e2(-1,E&-E),tt.tag=2;var kt=ee.updateQueue;if(kt!==null){kt=kt.shared;var hn=kt.pending;hn===null?tt.next=tt:(tt.next=hn.next,hn.next=tt),kt.pending=tt}}ee.lanes|=E,tt=ee.alternate,tt!==null&&(tt.lanes|=E),AV(ee.return,E,v),Le.lanes|=E;break}tt=tt.next}}else if(ee.tag===10)pe=ee.type===v.type?null:ee.child;else if(ee.tag===18){if(pe=ee.return,pe===null)throw Error(m(341));pe.lanes|=E,Le=pe.alternate,Le!==null&&(Le.lanes|=E),AV(pe,E,v),pe=ee.sibling}else pe=ee.child;if(pe!==null)pe.return=ee;else for(pe=ee;pe!==null;){if(pe===v){pe=null;break}if(ee=pe.sibling,ee!==null){ee.return=pe.return,pe=ee;break}pe=pe.return}ee=pe}Mc(f,v,q.children,E),v=v.child}return v;case 9:return q=v.type,O=v.pendingProps.children,t_(v,E),q=hh(q),O=O(q),v.flags|=1,Mc(f,v,O,E),v.child;case 14:return O=v.type,q=Lf(O,v.pendingProps),q=Lf(O.type,q),n3e(f,v,O,q,E);case 15:return r3e(f,v,v.type,v.pendingProps,E);case 17:return O=v.type,q=v.pendingProps,q=v.elementType===O?q:Lf(O,q),iI(f,v),v.tag=1,pu(O)?(f=!0,zR(v)):f=!1,t_(v,E),w2e(v,O,q),NV(v,O,q,E),XV(null,v,O,!0,f,E);case 19:return d3e(f,v,E);case 22:return i3e(f,v,E)}throw Error(m(156,v.tag))};function L3e(f,v){return hge(f,v)}function DIe(f,v,E,O){this.tag=f,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mh(f,v,E,O){return new DIe(f,v,E,O)}function fG(f){return f=f.prototype,!(!f||!f.isReactComponent)}function OIe(f){if(typeof f=="function")return fG(f)?1:0;if(f!=null){if(f=f.$$typeof,f===Ft)return 11;if(f===mt)return 14}return 2}function V9(f,v){var E=f.alternate;return E===null?(E=mh(f.tag,v,f.key,f.mode),E.elementType=f.elementType,E.type=f.type,E.stateNode=f.stateNode,E.alternate=f,f.alternate=E):(E.pendingProps=v,E.type=f.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=f.flags&14680064,E.childLanes=f.childLanes,E.lanes=f.lanes,E.child=f.child,E.memoizedProps=f.memoizedProps,E.memoizedState=f.memoizedState,E.updateQueue=f.updateQueue,v=f.dependencies,E.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},E.sibling=f.sibling,E.index=f.index,E.ref=f.ref,E}function mI(f,v,E,O,q,ee){var pe=2;if(O=f,typeof f=="function")fG(f)&&(pe=1);else if(typeof f=="string")pe=5;else e:switch(f){case ke:return x8(E.children,q,ee,v);case be:pe=8,q|=8;break;case Ue:return f=mh(12,E,v,q|2),f.elementType=Ue,f.lanes=ee,f;case Ke:return f=mh(13,E,v,q),f.elementType=Ke,f.lanes=ee,f;case Yt:return f=mh(19,E,v,q),f.elementType=Yt,f.lanes=ee,f;case Ee:return gI(E,q,ee,v);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case Ze:pe=10;break e;case ze:pe=9;break e;case Ft:pe=11;break e;case mt:pe=14;break e;case nt:pe=16,O=null;break e}throw Error(m(130,f==null?f:typeof f,""))}return v=mh(pe,E,v,q),v.elementType=f,v.type=O,v.lanes=ee,v}function x8(f,v,E,O){return f=mh(7,f,O,v),f.lanes=E,f}function gI(f,v,E,O){return f=mh(22,f,O,v),f.elementType=Ee,f.lanes=E,f.stateNode={isHidden:!1},f}function pG(f,v,E){return f=mh(6,f,null,v),f.lanes=E,f}function mG(f,v,E){return v=mh(4,f.children!==null?f.children:[],f.key,v),v.lanes=E,v.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},v}function LIe(f,v,E,O,q){this.tag=v,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wz(0),this.expirationTimes=Wz(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wz(0),this.identifierPrefix=O,this.onRecoverableError=q,this.mutableSourceEagerHydrationData=null}function gG(f,v,E,O,q,ee,pe,Le,tt){return f=new LIe(f,v,E,Le,tt),v===1?(v=1,ee===!0&&(v|=8)):v=0,ee=mh(3,null,null,v),f.current=ee,ee.stateNode=f,ee.memoizedState={element:O,isDehydrated:E,cache:null,transitions:null,pendingSuspenseBoundaries:null},RV(ee),f}function FIe(f,v,E){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ft,key:O==null?null:""+O,children:f,containerInfo:v,implementation:E}}function F3e(f){if(!f)return N9;f=f._reactInternals;e:{if(l8(f)!==f||f.tag!==1)throw Error(m(170));var v=f;do{switch(v.tag){case 3:v=v.stateNode.context;break e;case 1:if(pu(v.type)){v=v.stateNode.__reactInternalMemoizedMergedChildContext;break e}}v=v.return}while(v!==null);throw Error(m(171))}if(f.tag===1){var E=f.type;if(pu(E))return c2e(f,E,v)}return v}function U3e(f,v,E,O,q,ee,pe,Le,tt){return f=gG(E,O,!0,f,q,ee,pe,Le,tt),f.context=F3e(null),E=f.current,O=Cc(),q=B9(E),ee=e2(O,q),ee.callback=v??null,O9(E,ee,q),f.current.lanes=q,_w(f,q,O),vu(f,O),f}function vI(f,v,E,O){var q=v.current,ee=Cc(),pe=B9(q);return E=F3e(E),v.context===null?v.context=E:v.pendingContext=E,v=e2(ee,pe),v.payload={element:f},O=O===void 0?null:O,O!==null&&(v.callback=O),f=O9(q,v,pe),f!==null&&(Bf(f,q,pe,ee),$R(f,q,pe)),pe}function yI(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function B3e(f,v){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var E=f.retryLane;f.retryLane=E!==0&&E<v?E:v}}function vG(f,v){B3e(f,v),(f=f.alternate)&&B3e(f,v)}function UIe(){return null}var z3e=typeof reportError=="function"?reportError:function(f){console.error(f)};function yG(f){this._internalRoot=f}_I.prototype.render=yG.prototype.render=function(f){var v=this._internalRoot;if(v===null)throw Error(m(409));vI(f,v,null,null)},_I.prototype.unmount=yG.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var v=f.containerInfo;v8(function(){vI(null,f,null,null)}),v[Yg]=null}};function _I(f){this._internalRoot=f}_I.prototype.unstable_scheduleHydration=function(f){if(f){var v=xge();f={blockedOn:null,target:f,priority:v};for(var E=0;E<C9.length&&v!==0&&v<C9[E].priority;E++);C9.splice(E,0,f),E===0&&wge(f)}};function _G(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function xI(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function V3e(){}function BIe(f,v,E,O,q){if(q){if(typeof O=="function"){var ee=O;O=function(){var kt=yI(pe);ee.call(kt)}}var pe=U3e(v,O,f,0,null,!1,!1,"",V3e);return f._reactRootContainer=pe,f[Yg]=pe.current,kw(f.nodeType===8?f.parentNode:f),v8(),pe}for(;q=f.lastChild;)f.removeChild(q);if(typeof O=="function"){var Le=O;O=function(){var kt=yI(tt);Le.call(kt)}}var tt=gG(f,0,!1,null,null,!1,!1,"",V3e);return f._reactRootContainer=tt,f[Yg]=tt.current,kw(f.nodeType===8?f.parentNode:f),v8(function(){vI(v,tt,E,O)}),tt}function bI(f,v,E,O,q){var ee=E._reactRootContainer;if(ee){var pe=ee;if(typeof q=="function"){var Le=q;q=function(){var tt=yI(pe);Le.call(tt)}}vI(v,pe,f,q)}else pe=BIe(E,v,f,q,O);return yI(pe)}yge=function(f){switch(f.tag){case 3:var v=f.stateNode;if(v.current.memoizedState.isDehydrated){var E=yw(v.pendingLanes);E!==0&&(qz(v,E|1),vu(v,ba()),!(es&6)&&(a_=ba()+500,k9()))}break;case 13:v8(function(){var O=Jg(f,1);if(O!==null){var q=Cc();Bf(O,f,1,q)}}),vG(f,1)}},$z=function(f){if(f.tag===13){var v=Jg(f,134217728);if(v!==null){var E=Cc();Bf(v,f,134217728,E)}vG(f,134217728)}},_ge=function(f){if(f.tag===13){var v=B9(f),E=Jg(f,v);if(E!==null){var O=Cc();Bf(E,f,v,O)}vG(f,v)}},xge=function(){return Ns},bge=function(f,v){var E=Ns;try{return Ns=f,v()}finally{Ns=E}},Bz=function(f,v,E){switch(v){case"input":if(wi(f,E),v=E.name,E.type==="radio"&&v!=null){for(E=f;E.parentNode;)E=E.parentNode;for(E=E.querySelectorAll("input[name="+JSON.stringify(""+v)+'][type="radio"]'),v=0;v<E.length;v++){var O=E[v];if(O!==f&&O.form===f.form){var q=UR(O);if(!q)throw Error(m(90));vi(O),wi(O,q)}}}break;case"textarea":ci(f,E);break;case"select":v=E.value,v!=null&&hu(f,!!E.multiple,v,!1)}},sge=uG,oge=v8;var zIe={usingClientEntryPoint:!1,Events:[Lw,X7,UR,rge,ige,uG]},Kw={findFiberByHostInstance:c8,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},VIe={bundleType:Kw.bundleType,version:Kw.version,rendererPackageName:Kw.rendererPackageName,rendererConfig:Kw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ce.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=uge(f),f===null?null:f.stateNode},findFiberByHostInstance:Kw.findFiberByHostInstance||UIe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(Zw=__REACT_DEVTOOLS_GLOBAL_HOOK__,!Zw.isDisabled&&Zw.supportsFiber))try{gR=Zw.inject(VIe),P1=Zw}catch{}var Zw;o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zIe,o.createPortal=function(f,v){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_G(v))throw Error(m(200));return FIe(f,v,null,E)},o.createRoot=function(f,v){if(!_G(f))throw Error(m(299));var E=!1,O="",q=z3e;return v!=null&&(v.unstable_strictMode===!0&&(E=!0),v.identifierPrefix!==void 0&&(O=v.identifierPrefix),v.onRecoverableError!==void 0&&(q=v.onRecoverableError)),v=gG(f,1,!1,null,null,E,!1,O,q),f[Yg]=v.current,kw(f.nodeType===8?f.parentNode:f),new yG(v)},o.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var v=f._reactInternals;if(v===void 0)throw typeof f.render=="function"?Error(m(188)):(f=Object.keys(f).join(","),Error(m(268,f)));return f=uge(v),f=f===null?null:f.stateNode,f},o.flushSync=function(f){return v8(f)},o.hydrate=function(f,v,E){if(!xI(v))throw Error(m(200));return bI(null,f,v,!0,E)},o.hydrateRoot=function(f,v,E){if(!_G(f))throw Error(m(405));var O=E!=null&&E.hydratedSources||null,q=!1,ee="",pe=z3e;if(E!=null&&(E.unstable_strictMode===!0&&(q=!0),E.identifierPrefix!==void 0&&(ee=E.identifierPrefix),E.onRecoverableError!==void 0&&(pe=E.onRecoverableError)),v=U3e(v,null,f,1,E??null,q,!1,ee,pe),f[Yg]=v.current,kw(f),O)for(f=0;f<O.length;f++)E=O[f],q=E._getVersion,q=q(E._source),v.mutableSourceEagerHydrationData==null?v.mutableSourceEagerHydrationData=[E,q]:v.mutableSourceEagerHydrationData.push(E,q);return new _I(v)},o.render=function(f,v,E){if(!xI(v))throw Error(m(200));return bI(null,f,v,!1,E)},o.unmountComponentAtNode=function(f){if(!xI(f))throw Error(m(40));return f._reactRootContainer?(v8(function(){bI(null,null,f,!1,function(){f._reactRootContainer=null,f[Yg]=null})}),!0):!1},o.unstable_batchedUpdates=uG,o.unstable_renderSubtreeIntoContainer=function(f,v,E,O){if(!xI(E))throw Error(m(200));if(f==null||f._reactInternals===void 0)throw Error(m(38));return bI(f,v,E,!1,O)},o.version="18.2.0-next-9e3b772b8-20220608"}),Cg=ne((o,l)=>{function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(m){console.error(m)}}u(),l.exports=Bxe()});function zxe(o){let[,l]=(0,t9.useState)(0);return(0,t9.useCallback)(()=>{l(u=>u+1)},[])}function ri(o,l,u){let m=(0,t9.useCallback)(o,l),_=(0,t9.useRef)(null);_.current?_.current.set(m):_.current=new dC.Atom(m);let S=(0,t9.useRef)(null);return S.current||(S.current=(0,dC.prism)(()=>_.current.prism.getValue()())),W$(S.current,u)}function Vxe(){hC||(hC=!0,(0,q$.default)(()=>{(0,$$.unstable_batchedUpdates)(function(){for(var o,l;uf.length>0;){let u=uf.shift();Dy.delete(u);let m;xv&&((o=u.debug)==null||o.history.push("queue reached"));try{m=u.der.getValue()}catch(_){xv&&((l=u.debug)==null||l.history.push("queue: der.getValue() errored")),console.error("A `der.getValue()` in `usePrismInstance(der)` threw an error. This may be a zombie child issue, so we're gonna try to get its value again in a normal react render phase.If you see the same error again, then you either have an error in your prism code, or the deps array in `usePrism(fn, deps)` is missing a dependency and causing the prism to read stale values."),console.error(_),u.runUpdate();continue}m!==u.lastValue&&(u.lastValue=m,u.runUpdate())}hC=!1},1)}))}function W$(o,l){var u;let m=zxe(),_=(0,t9.useRef)(void 0);_.current||(mO++,_.current={order:mO,runUpdate:()=>{_.current.unmounted||m()},der:o,lastValue:void 0,unmounted:!1,queueUpdate:()=>{var M;xv&&((M=_.current.debug)==null||M.history.push("queueUpdate()")),X$(_.current)},untap:o.onStale(()=>{xv&&_.current.debug.history.push("onStale(cb)"),_.current.queueUpdate()})},xv&&(_.current.debug={label:l,traceOfFirstTimeRender:new Error,history:[]})),(0,t9.useLayoutEffect)(()=>function(){_.current.unmounted=!0,_.current.untap(),gO(_.current)},[]),gO(_.current);let S=_.current.der.getValue();return _.current.lastValue=S,xv&&((u=_.current.debug)==null||u.history.push("rendered")),S}var dC,q$,t9,$$,xv,qr,mO,uf,Dy,hC,X$,Y$,gO,Sr=A(()=>{dC=an(),V0(),q$=G(Oxe()),t9=G(et()),$$=G(Cg()),xv=!1,qr=(o,l)=>ri(()=>(0,dC.val)(o),[o],l),mO=0,uf=[],Dy=new Set,hC=!1,X$=o=>{Y$(o),Vxe()},Y$=o=>{if(!Dy.has(o))if(Dy.add(o),uf.length===0)uf.push(o);else{let l=vv(uf,u=>u.order>=o.order);l===-1?uf.push(o):uf[l].order>o.order&&uf.splice(l,0,o)}},gO=o=>{if(!Dy.has(o))return;Dy.delete(o);let l=vv(uf,u=>u===o);uf.splice(l,1)}}),Gxe=ne(o=>{var l=60103,u=60106,m=60107,_=60108,S=60114,M=60109,P=60110,k=60112,L=60113,z=60120,$=60115,H=60116,j=60121,K=60122,Q=60117,re=60129,ae=60131;typeof Symbol=="function"&&Symbol.for&&(ue=Symbol.for,l=ue("react.element"),u=ue("react.portal"),m=ue("react.fragment"),_=ue("react.strict_mode"),S=ue("react.profiler"),M=ue("react.provider"),P=ue("react.context"),k=ue("react.forward_ref"),L=ue("react.suspense"),z=ue("react.suspense_list"),$=ue("react.memo"),H=ue("react.lazy"),j=ue("react.block"),K=ue("react.server.block"),Q=ue("react.fundamental"),re=ue("react.debug_trace_mode"),ae=ue("react.legacy_hidden"));var ue;function ye(Ke){if(typeof Ke=="object"&&Ke!==null){var Yt=Ke.$$typeof;switch(Yt){case l:switch(Ke=Ke.type,Ke){case m:case S:case _:case L:case z:return Ke;default:switch(Ke=Ke&&Ke.$$typeof,Ke){case P:case k:case H:case $:case M:return Ke;default:return Yt}}case u:return Yt}}}var Ae=M,Ce=l,Se=k,ft=m,ke=H,be=$,Ue=u,Ze=S,ze=_,Ft=L;o.ContextConsumer=P,o.ContextProvider=Ae,o.Element=Ce,o.ForwardRef=Se,o.Fragment=ft,o.Lazy=ke,o.Memo=be,o.Portal=Ue,o.Profiler=Ze,o.StrictMode=ze,o.Suspense=Ft,o.isAsyncMode=function(){return!1},o.isConcurrentMode=function(){return!1},o.isContextConsumer=function(Ke){return ye(Ke)===P},o.isContextProvider=function(Ke){return ye(Ke)===M},o.isElement=function(Ke){return typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===l},o.isForwardRef=function(Ke){return ye(Ke)===k},o.isFragment=function(Ke){return ye(Ke)===m},o.isLazy=function(Ke){return ye(Ke)===H},o.isMemo=function(Ke){return ye(Ke)===$},o.isPortal=function(Ke){return ye(Ke)===u},o.isProfiler=function(Ke){return ye(Ke)===S},o.isStrictMode=function(Ke){return ye(Ke)===_},o.isSuspense=function(Ke){return ye(Ke)===L},o.isValidElementType=function(Ke){return typeof Ke=="string"||typeof Ke=="function"||Ke===m||Ke===S||Ke===re||Ke===_||Ke===L||Ke===z||Ke===ae||typeof Ke=="object"&&Ke!==null&&(Ke.$$typeof===H||Ke.$$typeof===$||Ke.$$typeof===M||Ke.$$typeof===P||Ke.$$typeof===k||Ke.$$typeof===Q||Ke.$$typeof===j||Ke[0]===K)},o.typeOf=ye}),jxe=ne((o,l)=>{l.exports=Gxe()}),K$=ne((o,l)=>{l.exports=function(u,m,_,S){var M=_?_.call(S,u,m):void 0;if(M!==void 0)return!!M;if(u===m)return!0;if(typeof u!="object"||!u||typeof m!="object"||!m)return!1;var P=Object.keys(u),k=Object.keys(m);if(P.length!==k.length)return!1;for(var L=Object.prototype.hasOwnProperty.bind(m),z=0;z<P.length;z++){var $=P[z];if(!L($))return!1;var H=u[$],j=m[$];if(M=_?_.call(S,H,j,$):void 0,M===!1||M===void 0&&H!==j)return!1}return!0}});function Hxe(o){function l(it,Ht,Kt,Et,we){for(var vt=0,Mt=0,Sn=0,ar=0,yr,Pr,vi=0,Is=0,ei,uo=ei=yr=0,pi=0,wi=0,_0=0,Go=0,lh=Kt.length,hu=lh-1,x0,Hr="",ci="",Xg="",F7="",ch;pi<lh;){if(Pr=Kt.charCodeAt(pi),pi===hu&&Mt+ar+Sn+vt!==0&&(Mt!==0&&(Pr=Mt===47?10:47),ar=Sn=vt=0,lh++,hu++),Mt+ar+Sn+vt===0){if(pi===hu&&(0<wi&&(Hr=Hr.replace(H,"")),0<Hr.trim().length)){switch(Pr){case 32:case 9:case 59:case 13:case 10:break;default:Hr+=Kt.charAt(pi)}Pr=59}switch(Pr){case 123:for(Hr=Hr.trim(),yr=Hr.charCodeAt(0),ei=1,Go=++pi;pi<lh;){switch(Pr=Kt.charCodeAt(pi)){case 123:ei++;break;case 125:ei--;break;case 47:switch(Pr=Kt.charCodeAt(pi+1)){case 42:case 47:e:{for(uo=pi+1;uo<hu;++uo)switch(Kt.charCodeAt(uo)){case 47:if(Pr===42&&Kt.charCodeAt(uo-1)===42&&pi+2!==uo){pi=uo+1;break e}break;case 10:if(Pr===47){pi=uo+1;break e}}pi=uo}}break;case 91:Pr++;case 40:Pr++;case 34:case 39:for(;pi++<hu&&Kt.charCodeAt(pi)!==Pr;);}if(ei===0)break;pi++}switch(ei=Kt.substring(Go,pi),yr===0&&(yr=(Hr=Hr.replace($,"").trim()).charCodeAt(0)),yr){case 64:switch(0<wi&&(Hr=Hr.replace(H,"")),Pr=Hr.charCodeAt(1),Pr){case 100:case 109:case 115:case 45:wi=Ht;break;default:wi=mt}if(ei=l(Ht,wi,ei,Pr,we+1),Go=ei.length,0<Ee&&(wi=u(mt,Hr,_0),ch=P(3,ei,wi,Ht,Ft,ze,Go,Pr,we,Et),Hr=wi.join(""),ch!==void 0&&(Go=(ei=ch.trim()).length)===0&&(Pr=0,ei="")),0<Go)switch(Pr){case 115:Hr=Hr.replace(Se,M);case 100:case 109:case 45:ei=Hr+"{"+ei+"}";break;case 107:Hr=Hr.replace(ue,"$1 $2"),ei=Hr+"{"+ei+"}",ei=Yt===1||Yt===2&&S("@"+ei,3)?"@-webkit-"+ei+"@"+ei:"@"+ei;break;default:ei=Hr+ei,Et===112&&(ei=(ci+=ei,""))}else ei="";break;default:ei=l(Ht,u(Ht,Hr,_0),ei,Et,we+1)}Xg+=ei,ei=_0=wi=uo=yr=0,Hr="",Pr=Kt.charCodeAt(++pi);break;case 125:case 59:if(Hr=(0<wi?Hr.replace(H,""):Hr).trim(),1<(Go=Hr.length))switch(uo===0&&(yr=Hr.charCodeAt(0),yr===45||96<yr&&123>yr)&&(Go=(Hr=Hr.replace(" ",":")).length),0<Ee&&(ch=P(1,Hr,Ht,it,Ft,ze,ci.length,Et,we,Et))!==void 0&&(Go=(Hr=ch.trim()).length)===0&&(Hr="\0\0"),yr=Hr.charCodeAt(0),Pr=Hr.charCodeAt(1),yr){case 0:break;case 64:if(Pr===105||Pr===99){F7+=Hr+Kt.charAt(pi);break}default:Hr.charCodeAt(Go-1)!==58&&(ci+=_(Hr,yr,Pr,Hr.charCodeAt(2)))}_0=wi=uo=yr=0,Hr="",Pr=Kt.charCodeAt(++pi)}}switch(Pr){case 13:case 10:Mt===47?Mt=0:1+yr===0&&Et!==107&&0<Hr.length&&(wi=1,Hr+="\0"),0<Ee*Nt&&P(0,Hr,Ht,it,Ft,ze,ci.length,Et,we,Et),ze=1,Ft++;break;case 59:case 125:if(Mt+ar+Sn+vt===0){ze++;break}default:switch(ze++,x0=Kt.charAt(pi),Pr){case 9:case 32:if(ar+vt+Mt===0)switch(vi){case 44:case 58:case 9:case 32:x0="";break;default:Pr!==32&&(x0=" ")}break;case 0:x0="\\0";break;case 12:x0="\\f";break;case 11:x0="\\v";break;case 38:ar+Mt+vt===0&&(wi=_0=1,x0="\f"+x0);break;case 108:if(ar+Mt+vt+Ke===0&&0<uo)switch(pi-uo){case 2:vi===112&&Kt.charCodeAt(pi-3)===58&&(Ke=vi);case 8:Is===111&&(Ke=Is)}break;case 58:ar+Mt+vt===0&&(uo=pi);break;case 44:Mt+Sn+ar+vt===0&&(wi=1,x0+="\r");break;case 34:case 39:Mt===0&&(ar=ar===Pr?0:ar===0?Pr:ar);break;case 91:ar+Mt+Sn===0&&vt++;break;case 93:ar+Mt+Sn===0&&vt--;break;case 41:ar+Mt+vt===0&&Sn--;break;case 40:if(ar+Mt+vt===0){if(yr===0)switch(2*vi+3*Is){case 533:break;default:yr=1}Sn++}break;case 64:Mt+Sn+ar+vt+uo+ei===0&&(ei=1);break;case 42:case 47:if(!(0<ar+vt+Sn))switch(Mt){case 0:switch(2*Pr+3*Kt.charCodeAt(pi+1)){case 235:Mt=47;break;case 220:Go=pi,Mt=42}break;case 42:Pr===47&&vi===42&&Go+2!==pi&&(Kt.charCodeAt(Go+2)===33&&(ci+=Kt.substring(Go,pi+1)),x0="",Mt=0)}}Mt===0&&(Hr+=x0)}Is=vi,vi=Pr,pi++}if(Go=ci.length,0<Go){if(wi=Ht,0<Ee&&(ch=P(2,ci,wi,it,Ft,ze,Go,Et,we,Et),ch!==void 0&&(ci=ch).length===0))return F7+ci+Xg;if(ci=wi.join(",")+"{"+ci+"}",Yt*Ke!==0){switch(Yt!==2||S(ci,2)||(Ke=0),Ke){case 111:ci=ci.replace(Ae,":-moz-$1")+ci;break;case 112:ci=ci.replace(ye,"::-webkit-input-$1")+ci.replace(ye,"::-moz-$1")+ci.replace(ye,":-ms-input-$1")+ci}Ke=0}}return F7+ci+Xg}function u(it,Ht,Kt){var Et=Ht.trim().split(re);Ht=Et;var we=Et.length,vt=it.length;switch(vt){case 0:case 1:var Mt=0;for(it=vt===0?"":it[0]+" ";Mt<we;++Mt)Ht[Mt]=m(it,Ht[Mt],Kt).trim();break;default:var Sn=Mt=0;for(Ht=[];Mt<we;++Mt)for(var ar=0;ar<vt;++ar)Ht[Sn++]=m(it[ar]+" ",Et[Mt],Kt).trim()}return Ht}function m(it,Ht,Kt){var Et=Ht.charCodeAt(0);switch(33>Et&&(Et=(Ht=Ht.trim()).charCodeAt(0)),Et){case 38:return Ht.replace(ae,"$1"+it.trim());case 58:return it.trim()+Ht.replace(ae,"$1"+it.trim());default:if(0<1*Kt&&0<Ht.indexOf("\f"))return Ht.replace(ae,(it.charCodeAt(0)===58?"":"$1")+it.trim())}return it+Ht}function _(it,Ht,Kt,Et){var we=it+";",vt=2*Ht+3*Kt+4*Et;if(vt===944){it=we.indexOf(":",9)+1;var Mt=we.substring(it,we.length-1).trim();return Mt=we.substring(0,it).trim()+Mt+";",Yt===1||Yt===2&&S(Mt,1)?"-webkit-"+Mt+Mt:Mt}if(Yt===0||Yt===2&&!S(we,1))return we;switch(vt){case 1015:return we.charCodeAt(10)===97?"-webkit-"+we+we:we;case 951:return we.charCodeAt(3)===116?"-webkit-"+we+we:we;case 963:return we.charCodeAt(5)===110?"-webkit-"+we+we:we;case 1009:if(we.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+we+we;case 978:return"-webkit-"+we+"-moz-"+we+we;case 1019:case 983:return"-webkit-"+we+"-moz-"+we+"-ms-"+we+we;case 883:if(we.charCodeAt(8)===45)return"-webkit-"+we+we;if(0<we.indexOf("image-set(",11))return we.replace(Ze,"$1-webkit-$2")+we;break;case 932:if(we.charCodeAt(4)===45)switch(we.charCodeAt(5)){case 103:return"-webkit-box-"+we.replace("-grow","")+"-webkit-"+we+"-ms-"+we.replace("grow","positive")+we;case 115:return"-webkit-"+we+"-ms-"+we.replace("shrink","negative")+we;case 98:return"-webkit-"+we+"-ms-"+we.replace("basis","preferred-size")+we}return"-webkit-"+we+"-ms-"+we+we;case 964:return"-webkit-"+we+"-ms-flex-"+we+we;case 1023:if(we.charCodeAt(8)!==99)break;return Mt=we.substring(we.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+Mt+"-webkit-"+we+"-ms-flex-pack"+Mt+we;case 1005:return K.test(we)?we.replace(j,":-webkit-")+we.replace(j,":-moz-")+we:we;case 1e3:switch(Mt=we.substring(13).trim(),Ht=Mt.indexOf("-")+1,Mt.charCodeAt(0)+Mt.charCodeAt(Ht)){case 226:Mt=we.replace(Ce,"tb");break;case 232:Mt=we.replace(Ce,"tb-rl");break;case 220:Mt=we.replace(Ce,"lr");break;default:return we}return"-webkit-"+we+"-ms-"+Mt+we;case 1017:if(we.indexOf("sticky",9)===-1)break;case 975:switch(Ht=(we=it).length-10,Mt=(we.charCodeAt(Ht)===33?we.substring(0,Ht):we).substring(it.indexOf(":",7)+1).trim(),vt=Mt.charCodeAt(0)+(Mt.charCodeAt(7)|0)){case 203:if(111>Mt.charCodeAt(8))break;case 115:we=we.replace(Mt,"-webkit-"+Mt)+";"+we;break;case 207:case 102:we=we.replace(Mt,"-webkit-"+(102<vt?"inline-":"")+"box")+";"+we.replace(Mt,"-webkit-"+Mt)+";"+we.replace(Mt,"-ms-"+Mt+"box")+";"+we}return we+";";case 938:if(we.charCodeAt(5)===45)switch(we.charCodeAt(6)){case 105:return Mt=we.replace("-items",""),"-webkit-"+we+"-webkit-box-"+Mt+"-ms-flex-"+Mt+we;case 115:return"-webkit-"+we+"-ms-flex-item-"+we.replace(ke,"")+we;default:return"-webkit-"+we+"-ms-flex-line-pack"+we.replace("align-content","").replace(ke,"")+we}break;case 973:case 989:if(we.charCodeAt(3)!==45||we.charCodeAt(4)===122)break;case 931:case 953:if(Ue.test(it)===!0)return(Mt=it.substring(it.indexOf(":")+1)).charCodeAt(0)===115?_(it.replace("stretch","fill-available"),Ht,Kt,Et).replace(":fill-available",":stretch"):we.replace(Mt,"-webkit-"+Mt)+we.replace(Mt,"-moz-"+Mt.replace("fill-",""))+we;break;case 962:if(we="-webkit-"+we+(we.charCodeAt(5)===102?"-ms-"+we:"")+we,Kt+Et===211&&we.charCodeAt(13)===105&&0<we.indexOf("transform",10))return we.substring(0,we.indexOf(";",27)+1).replace(Q,"$1-webkit-$2")+we}return we}function S(it,Ht){var Kt=it.indexOf(Ht===1?":":"{"),Et=it.substring(0,Ht!==3?Kt:10);return Kt=it.substring(Kt+1,it.length-1),ct(Ht!==2?Et:Et.replace(be,"$1"),Kt,Ht)}function M(it,Ht){var Kt=_(Ht,Ht.charCodeAt(0),Ht.charCodeAt(1),Ht.charCodeAt(2));return Kt!==Ht+";"?Kt.replace(ft," or ($1)").substring(4):"("+Ht+")"}function P(it,Ht,Kt,Et,we,vt,Mt,Sn,ar,yr){for(var Pr=0,vi=Ht,Is;Pr<Ee;++Pr)switch(Is=nt[Pr].call(z,it,vi,Kt,Et,we,vt,Mt,Sn,ar,yr)){case void 0:case!1:case!0:case null:break;default:vi=Is}if(vi!==Ht)return vi}function k(it){switch(it){case void 0:case null:Ee=nt.length=0;break;default:if(typeof it=="function")nt[Ee++]=it;else if(typeof it=="object")for(var Ht=0,Kt=it.length;Ht<Kt;++Ht)k(it[Ht]);else Nt=!!it|0}return k}function L(it){return it=it.prefix,it!==void 0&&(ct=null,it?typeof it!="function"?Yt=1:(Yt=2,ct=it):Yt=0),L}function z(it,Ht){var Kt=it;if(33>Kt.charCodeAt(0)&&(Kt=Kt.trim()),Re=Kt,Kt=[Re],0<Ee){var Et=P(-1,Ht,Kt,Kt,Ft,ze,0,0,0,0);Et!==void 0&&typeof Et=="string"&&(Ht=Et)}var we=l(mt,Kt,Ht,0,0);return 0<Ee&&(Et=P(-2,we,Kt,Kt,Ft,ze,we.length,0,0,0),Et!==void 0&&(we=Et)),Re="",Ke=0,ze=Ft=1,we}var $=/^\0+/g,H=/[\0\r\f]/g,j=/: */g,K=/zoo|gra/,Q=/([,: ])(transform)/g,re=/,\r+?/g,ae=/([\t\r\n ])*\f?&/g,ue=/@(k\w+)\s*(\S*)\s*/,ye=/::(place)/g,Ae=/:(read-only)/g,Ce=/[svh]\w+-[tblr]{2}/,Se=/\(\s*(.*)\s*\)/g,ft=/([\s\S]*?);/g,ke=/-self|flex-/g,be=/[^]*?(:[rp][el]a[\w-]+)[^]*/,Ue=/stretch|:\s*\w+\-(?:conte|avail)/,Ze=/([^-])(image-set\()/,ze=1,Ft=1,Ke=0,Yt=1,mt=[],nt=[],Ee=0,ct=null,Nt=0,Re="";return z.use=k,z.set=L,o!==void 0&&L(o),z}var Z$,Wxe=A(()=>{Z$=Hxe}),Q$,J$,qxe=A(()=>{Q$={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},J$=Q$});function $xe(o){var l=Object.create(null);return function(u){return l[u]===void 0&&(l[u]=o(u)),l[u]}}var eX,Xxe=A(()=>{eX=$xe}),tX,nX,vO,Yxe=A(()=>{Xxe(),tX=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,nX=eX(function(o){return tX.test(o)||o.charCodeAt(0)===111&&o.charCodeAt(1)===110&&o.charCodeAt(2)<91}),vO=nX}),Kxe=ne(o=>{var l=typeof Symbol=="function"&&Symbol.for,u=l?Symbol.for("react.element"):60103,m=l?Symbol.for("react.portal"):60106,_=l?Symbol.for("react.fragment"):60107,S=l?Symbol.for("react.strict_mode"):60108,M=l?Symbol.for("react.profiler"):60114,P=l?Symbol.for("react.provider"):60109,k=l?Symbol.for("react.context"):60110,L=l?Symbol.for("react.async_mode"):60111,z=l?Symbol.for("react.concurrent_mode"):60111,$=l?Symbol.for("react.forward_ref"):60112,H=l?Symbol.for("react.suspense"):60113,j=l?Symbol.for("react.suspense_list"):60120,K=l?Symbol.for("react.memo"):60115,Q=l?Symbol.for("react.lazy"):60116,re=l?Symbol.for("react.block"):60121,ae=l?Symbol.for("react.fundamental"):60117,ue=l?Symbol.for("react.responder"):60118,ye=l?Symbol.for("react.scope"):60119;function Ae(Se){if(typeof Se=="object"&&Se!==null){var ft=Se.$$typeof;switch(ft){case u:switch(Se=Se.type,Se){case L:case z:case _:case M:case S:case H:return Se;default:switch(Se=Se&&Se.$$typeof,Se){case k:case $:case Q:case K:case P:return Se;default:return ft}}case m:return ft}}}function Ce(Se){return Ae(Se)===z}o.AsyncMode=L,o.ConcurrentMode=z,o.ContextConsumer=k,o.ContextProvider=P,o.Element=u,o.ForwardRef=$,o.Fragment=_,o.Lazy=Q,o.Memo=K,o.Portal=m,o.Profiler=M,o.StrictMode=S,o.Suspense=H,o.isAsyncMode=function(Se){return Ce(Se)||Ae(Se)===L},o.isConcurrentMode=Ce,o.isContextConsumer=function(Se){return Ae(Se)===k},o.isContextProvider=function(Se){return Ae(Se)===P},o.isElement=function(Se){return typeof Se=="object"&&Se!==null&&Se.$$typeof===u},o.isForwardRef=function(Se){return Ae(Se)===$},o.isFragment=function(Se){return Ae(Se)===_},o.isLazy=function(Se){return Ae(Se)===Q},o.isMemo=function(Se){return Ae(Se)===K},o.isPortal=function(Se){return Ae(Se)===m},o.isProfiler=function(Se){return Ae(Se)===M},o.isStrictMode=function(Se){return Ae(Se)===S},o.isSuspense=function(Se){return Ae(Se)===H},o.isValidElementType=function(Se){return typeof Se=="string"||typeof Se=="function"||Se===_||Se===z||Se===M||Se===S||Se===H||Se===j||typeof Se=="object"&&Se!==null&&(Se.$$typeof===Q||Se.$$typeof===K||Se.$$typeof===P||Se.$$typeof===k||Se.$$typeof===$||Se.$$typeof===ae||Se.$$typeof===ue||Se.$$typeof===ye||Se.$$typeof===re)},o.typeOf=Ae}),Zxe=ne((o,l)=>{l.exports=Kxe()}),Qxe=ne((o,l)=>{var u=Zxe(),m={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},_={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},S={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},M={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},P={};P[u.ForwardRef]=S,P[u.Memo]=M;function k(re){return u.isMemo(re)?M:P[re.$$typeof]||m}var L=Object.defineProperty,z=Object.getOwnPropertyNames,$=Object.getOwnPropertySymbols,H=Object.getOwnPropertyDescriptor,j=Object.getPrototypeOf,K=Object.prototype;function Q(re,ae,ue){if(typeof ae!="string"){if(K){var ye=j(ae);ye&&ye!==K&&Q(re,ye,ue)}var Ae=z(ae);$&&(Ae=Ae.concat($(ae)));for(var Ce=k(re),Se=k(ae),ft=0;ft<Ae.length;++ft){var ke=Ae[ft];if(!_[ke]&&!(ue&&ue[ke])&&!(Se&&Se[ke])&&!(Ce&&Ce[ke])){var be=H(ae,ke);try{L(re,ke,be)}catch{}}}}return re}l.exports=Q});function df(){return(df=Object.assign||function(o){for(var l=1;l<arguments.length;l++){var u=arguments[l];for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(o[m]=u[m])}return o}).apply(this,arguments)}function Yb(o){return typeof o=="function"}function rX(o){return o.displayName||o.name||"Component"}function yO(o){return o&&typeof o.styledComponentId=="string"}function Ag(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];throw new Error("An error occurred. See https://git.io/JUIaE#"+o+" for more information."+(u.length>0?" Args: "+u.join(", "):""))}function _O(o){var l,u="";for(l=Math.abs(o);l>52;l=l/52|0)u=MO(l%52)+u;return(MO(l%52)+u).replace(CX,"$1-$2")}function iX(o){for(var l=0;l<o.length;l+=1){var u=o[l];if(Yb(u)&&!yO(u))return!1}return!0}function sX(o){var l,u,m,_,S=o===void 0?Pg:o,M=S.options,P=M===void 0?Pg:M,k=S.plugins,L=k===void 0?Kb:k,z=new Z$(P),$=[],H=function(Q){function re(ae){if(ae)try{Q(ae+"}")}catch{}}return function(ae,ue,ye,Ae,Ce,Se,ft,ke,be,Ue){switch(ae){case 1:if(be===0&&ue.charCodeAt(0)===64)return Q(ue+";"),"";break;case 2:if(ke===0)return ue+"/*|*/";break;case 3:switch(ke){case 102:case 112:return Q(ye[0]+ue),"";default:return ue+(Ue===0?"/*|*/":"")}case-2:ue.split("/*|*/}").forEach(re)}}}(function(Q){$.push(Q)}),j=function(Q,re,ae){return re===0&&IX.indexOf(ae[u.length])!==-1||ae.match(_)?Q:"."+l};function K(Q,re,ae,ue){ue===void 0&&(ue="&");var ye=Q.replace(RX,""),Ae=re&&ae?ae+" "+re+" { "+ye+" }":ye;return l=ue,u=re,m=new RegExp("\\"+u+"\\b","g"),_=new RegExp("(\\"+u+"\\b){2,}"),z(ae||!re?"":re,Ae)}return z.use([].concat(L,[function(Q,re,ae){Q===2&&ae.length&&ae[0].lastIndexOf(u)>0&&(ae[0]=ae[0].replace(m,j))},H,function(Q){if(Q===-2){var re=$;return $=[],re}}])),K.hash=L.length?L.reduce(function(Q,re){return re.name||Ag(15),Sv(Q,re.name)},5381).toString():"",K}function xO(){return(0,_a.useContext)(vC)||NX}function oX(){return(0,_a.useContext)(yC)||_C}function aX(o){var l=(0,_a.useState)(o.stylisPlugins),u=l[0],m=l[1],_=xO(),S=(0,_a.useMemo)(function(){var P=_;return o.sheet?P=o.sheet:o.target&&(P=P.reconstructWithOptions({target:o.target},!1)),o.disableCSSOMInjection&&(P=P.reconstructWithOptions({useCSSOMInjection:!1})),P},[o.disableCSSOMInjection,o.sheet,o.target]),M=(0,_a.useMemo)(function(){return sX({options:{prefix:!o.disableVendorPrefixes},plugins:u})},[o.disableVendorPrefixes,u]);return(0,_a.useEffect)(function(){(0,hX.default)(u,o.stylisPlugins)||m(o.stylisPlugins)},[o.stylisPlugins]),_a.default.createElement(vC.Provider,{value:S},_a.default.createElement(yC.Provider,{value:M},o.children))}function lX(o){return DX.test(o)?o.replace(OX,FX).replace(LX,"-ms-"):o}function bv(o,l,u,m){if(Array.isArray(o)){for(var _,S=[],M=0,P=o.length;M<P;M+=1)(_=bv(o[M],l,u,m))!==""&&(Array.isArray(_)?S.push.apply(S,_):S.push(_));return S}if(AO(o))return"";if(yO(o))return"."+o.styledComponentId;if(Yb(o)){if(typeof(L=o)!="function"||L.prototype&&L.prototype.isReactComponent||!l)return o;var k=o(l);return bv(k,l,u,m)}var L;return o instanceof kX?u?(o.inject(u,m),o.getName(m)):o:pC(o)?function z($,H){var j,K,Q=[];for(var re in $)$.hasOwnProperty(re)&&!AO($[re])&&(Array.isArray($[re])&&$[re].isCss||Yb($[re])?Q.push(lX(re)+":",$[re],";"):pC($[re])?Q.push.apply(Q,z($[re],re)):Q.push(lX(re)+": "+(j=re,(K=$[re])==null||typeof K=="boolean"||K===""?"":typeof K!="number"||K===0||j in J$||j.startsWith("--")?String(K).trim():K+"px")+";"));return H?[H+" {"].concat(Q,["}"]):Q}(o):o.toString()}function id(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];return Yb(o)||pC(o)?PO(bv(wO(Kb,[o].concat(u)))):u.length===0&&o.length===1&&typeof o[0]=="string"?o:PO(bv(wO(o,u)))}function bO(o){return o.replace(UX,"-").replace(BX,"")}function fC(o){return typeof o=="string"&&!0}function Jxe(o,l,u){var m=o[u];xC(l)&&xC(m)?cX(m,l):o[u]=l}function cX(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];for(var _=0,S=u;_<S.length;_++){var M=S[_];if(xC(M))for(var P in M)zX(P)&&Jxe(o,M[P],P)}return o}function uX(o,l,u){var m=yO(o),_=!fC(o),S=l.attrs,M=S===void 0?Kb:S,P=l.componentId,k=P===void 0?function(ue,ye){var Ae=typeof ue!="string"?"sc":bO(ue);SC[Ae]=(SC[Ae]||0)+1;var Ce=Ae+"-"+IO("5.3.11"+Ae+SC[Ae]);return ye?ye+"-"+Ce:Ce}(l.displayName,l.parentComponentId):P,L=l.displayName,z=L===void 0?function(ue){return fC(ue)?"styled."+ue:"Styled("+rX(ue)+")"}(o):L,$=l.displayName&&l.componentId?bO(l.displayName)+"-"+l.componentId:l.componentId||k,H=m&&o.attrs?Array.prototype.concat(o.attrs,M).filter(Boolean):M,j=l.shouldForwardProp;m&&o.shouldForwardProp&&(j=l.shouldForwardProp?function(ue,ye,Ae){return o.shouldForwardProp(ue,ye,Ae)&&l.shouldForwardProp(ue,ye,Ae)}:o.shouldForwardProp);var K,Q=new PX(u,$,m?o.componentStyle:void 0),re=Q.isStatic&&M.length===0,ae=function(ue,ye){return function(Ae,Ce,Se,ft){var ke=Ae.attrs,be=Ae.componentStyle,Ue=Ae.defaultProps,Ze=Ae.foldedComponentIds,ze=Ae.shouldForwardProp,Ft=Ae.styledComponentId,Ke=Ae.target,Yt=function(Et,we,vt){Et===void 0&&(Et=Pg);var Mt=df({},we,{theme:Et}),Sn={};return vt.forEach(function(ar){var yr,Pr,vi,Is=ar;for(yr in Yb(Is)&&(Is=Is(Mt)),Is)Mt[yr]=Sn[yr]=yr==="className"?(Pr=Sn[yr],vi=Is[yr],Pr&&vi?Pr+" "+vi:Pr||vi):Is[yr]}),[Mt,Sn]}(RO(Ce,(0,_a.useContext)(bC),Ue)||Pg,Ce,ke),mt=Yt[0],nt=Yt[1],Ee=function(Et,we,vt,Mt){var Sn=xO(),ar=oX(),yr=we?Et.generateAndInjectStyles(Pg,Sn,ar):Et.generateAndInjectStyles(vt,Sn,ar);return yr}(be,ft,mt),ct=Se,Nt=nt.$as||Ce.$as||nt.as||Ce.as||Ke,Re=fC(Nt),it=nt!==Ce?df({},Ce,{},nt):Ce,Ht={};for(var Kt in it)Kt[0]!=="$"&&Kt!=="as"&&(Kt==="forwardedAs"?Ht.as=it[Kt]:(ze?ze(Kt,vO,Nt):!Re||vO(Kt))&&(Ht[Kt]=it[Kt]));return Ce.style&&nt.style!==Ce.style&&(Ht.style=df({},Ce.style,{},nt.style)),Ht.className=Array.prototype.concat(Ze,Ft,Ee!==Ft?Ee:null,Ce.className,nt.className).filter(Boolean).join(" "),Ht.ref=ct,(0,_a.createElement)(Nt,Ht)}(K,ue,ye,re)};return ae.displayName=z,(K=_a.default.forwardRef(ae)).attrs=H,K.componentStyle=Q,K.displayName=z,K.shouldForwardProp=j,K.foldedComponentIds=m?Array.prototype.concat(o.foldedComponentIds,o.styledComponentId):Kb,K.styledComponentId=$,K.target=m?o.target:o,K.withComponent=function(ue){var ye=l.componentId,Ae=function(Se,ft){if(Se==null)return{};var ke,be,Ue={},Ze=Object.keys(Se);for(be=0;be<Ze.length;be++)ke=Ze[be],ft.indexOf(ke)>=0||(Ue[ke]=Se[ke]);return Ue}(l,["componentId"]),Ce=ye&&ye+"-"+(fC(ue)?ue:bO(rX(ue)));return uX(ue,df({},Ae,{attrs:H,componentId:Ce}),u)},Object.defineProperty(K,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(ue){this._foldedDefaultProps=m?cX({},o.defaultProps,ue):ue}}),Object.defineProperty(K,"toString",{value:function(){return"."+K.styledComponentId}}),_&&(0,fX.default)(K,o,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),K}function dX(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];var _=id.apply(void 0,[o].concat(u)),S="sc-global-"+IO(JSON.stringify(_)),M=new VX(_,S);function P(L){var z=xO(),$=oX(),H=(0,_a.useContext)(bC),j=(0,_a.useRef)(z.allocateGSInstance(S)).current;return z.server&&k(j,L,z,H,$),(0,_a.useLayoutEffect)(function(){if(!z.server)return k(j,L,z,H,$),function(){return M.removeStyles(j,z)}},[j,L,z,H,$]),null}function k(L,z,$,H,j){if(M.isStatic)M.renderStyles(L,mX,$,j);else{var K=df({},z,{theme:RO(z,H,P.defaultProps)});M.renderStyles(L,K,$,j)}}return _a.default.memo(P)}var SO,_a,hX,fX,wO,pC,Kb,Pg,Rg,mC,pX,mX,gX,Zb,Qb,Oy,Jb,vX,yX,_X,xX,bX,SX,gC,TO,wX,TX,EX,EO,MX,Ly,CX,MO,Sv,CO,AX,PX,RX,IX,vC,yC,NX,_C,kX,DX,OX,LX,FX,AO,PO,RO,UX,BX,IO,xC,zX,bC,SC,wC,VX,ge,Jt=A(()=>{SO=G(jxe()),_a=G(et()),hX=G(K$()),Wxe(),qxe(),Yxe(),fX=G(Qxe()),wO=function(o,l){for(var u=[o[0]],m=0,_=l.length;m<_;m+=1)u.push(l[m],o[m+1]);return u},pC=function(o){return o!==null&&typeof o=="object"&&(o.toString?o.toString():Object.prototype.toString.call(o))==="[object Object]"&&!(0,SO.typeOf)(o)},Kb=Object.freeze([]),Pg=Object.freeze({}),Rg=typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_ATTR||t.SC_ATTR)||"data-styled",mC=typeof window<"u"&&"HTMLElement"in window,pX=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&t.REACT_APP_SC_DISABLE_SPEEDY!==""?t.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&t.REACT_APP_SC_DISABLE_SPEEDY:t.SC_DISABLE_SPEEDY!==void 0&&t.SC_DISABLE_SPEEDY!==""&&t.SC_DISABLE_SPEEDY!=="false"&&t.SC_DISABLE_SPEEDY)),mX={},gX=function(){function o(u){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=u}var l=o.prototype;return l.indexOfGroup=function(u){for(var m=0,_=0;_<u;_++)m+=this.groupSizes[_];return m},l.insertRules=function(u,m){if(u>=this.groupSizes.length){for(var _=this.groupSizes,S=_.length,M=S;u>=M;)(M<<=1)<0&&Ag(16,""+u);this.groupSizes=new Uint32Array(M),this.groupSizes.set(_),this.length=M;for(var P=S;P<M;P++)this.groupSizes[P]=0}for(var k=this.indexOfGroup(u+1),L=0,z=m.length;L<z;L++)this.tag.insertRule(k,m[L])&&(this.groupSizes[u]++,k++)},l.clearGroup=function(u){if(u<this.length){var m=this.groupSizes[u],_=this.indexOfGroup(u),S=_+m;this.groupSizes[u]=0;for(var M=_;M<S;M++)this.tag.deleteRule(_)}},l.getGroup=function(u){var m="";if(u>=this.length||this.groupSizes[u]===0)return m;for(var _=this.groupSizes[u],S=this.indexOfGroup(u),M=S+_,P=S;P<M;P++)m+=this.tag.getRule(P)+`/*!sc*/
`;return m},o}(),Zb=new Map,Qb=new Map,Oy=1,Jb=function(o){if(Zb.has(o))return Zb.get(o);for(;Qb.has(Oy);)Oy++;var l=Oy++;return Zb.set(o,l),Qb.set(l,o),l},vX=function(o){return Qb.get(o)},yX=function(o,l){l>=Oy&&(Oy=l+1),Zb.set(o,l),Qb.set(l,o)},_X="style["+Rg+'][data-styled-version="5.3.11"]',xX=new RegExp("^"+Rg+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),bX=function(o,l,u){for(var m,_=u.split(","),S=0,M=_.length;S<M;S++)(m=_[S])&&o.registerName(l,m)},SX=function(o,l){for(var u=(l.textContent||"").split(`/*!sc*/
`),m=[],_=0,S=u.length;_<S;_++){var M=u[_].trim();if(M){var P=M.match(xX);if(P){var k=0|parseInt(P[1],10),L=P[2];k!==0&&(yX(L,k),bX(o,L,P[3]),o.getTag().insertRules(k,m)),m.length=0}else m.push(M)}}},gC=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},TO=function(o){var l=document.head,u=o||l,m=document.createElement("style"),_=function(P){for(var k=P.childNodes,L=k.length;L>=0;L--){var z=k[L];if(z&&z.nodeType===1&&z.hasAttribute(Rg))return z}}(u),S=_!==void 0?_.nextSibling:null;m.setAttribute(Rg,"active"),m.setAttribute("data-styled-version","5.3.11");var M=gC();return M&&m.setAttribute("nonce",M),u.insertBefore(m,S),m},wX=function(){function o(u){var m=this.element=TO(u);m.appendChild(document.createTextNode("")),this.sheet=function(_){if(_.sheet)return _.sheet;for(var S=document.styleSheets,M=0,P=S.length;M<P;M++){var k=S[M];if(k.ownerNode===_)return k}Ag(17)}(m),this.length=0}var l=o.prototype;return l.insertRule=function(u,m){try{return this.sheet.insertRule(m,u),this.length++,!0}catch{return!1}},l.deleteRule=function(u){this.sheet.deleteRule(u),this.length--},l.getRule=function(u){var m=this.sheet.cssRules[u];return m!==void 0&&typeof m.cssText=="string"?m.cssText:""},o}(),TX=function(){function o(u){var m=this.element=TO(u);this.nodes=m.childNodes,this.length=0}var l=o.prototype;return l.insertRule=function(u,m){if(u<=this.length&&u>=0){var _=document.createTextNode(m),S=this.nodes[u];return this.element.insertBefore(_,S||null),this.length++,!0}return!1},l.deleteRule=function(u){this.element.removeChild(this.nodes[u]),this.length--},l.getRule=function(u){return u<this.length?this.nodes[u].textContent:""},o}(),EX=function(){function o(u){this.rules=[],this.length=0}var l=o.prototype;return l.insertRule=function(u,m){return u<=this.length&&(this.rules.splice(u,0,m),this.length++,!0)},l.deleteRule=function(u){this.rules.splice(u,1),this.length--},l.getRule=function(u){return u<this.length?this.rules[u]:""},o}(),EO=mC,MX={isServer:!mC,useCSSOMInjection:!pX},Ly=function(){function o(u,m,_){u===void 0&&(u=Pg),m===void 0&&(m={}),this.options=df({},MX,{},u),this.gs=m,this.names=new Map(_),this.server=!!u.isServer,!this.server&&mC&&EO&&(EO=!1,function(S){for(var M=document.querySelectorAll(_X),P=0,k=M.length;P<k;P++){var L=M[P];L&&L.getAttribute(Rg)!=="active"&&(SX(S,L),L.parentNode&&L.parentNode.removeChild(L))}}(this))}o.registerId=function(u){return Jb(u)};var l=o.prototype;return l.reconstructWithOptions=function(u,m){return m===void 0&&(m=!0),new o(df({},this.options,{},u),this.gs,m&&this.names||void 0)},l.allocateGSInstance=function(u){return this.gs[u]=(this.gs[u]||0)+1},l.getTag=function(){return this.tag||(this.tag=(_=(m=this.options).isServer,S=m.useCSSOMInjection,M=m.target,u=_?new EX(M):S?new wX(M):new TX(M),new gX(u)));var u,m,_,S,M},l.hasNameForId=function(u,m){return this.names.has(u)&&this.names.get(u).has(m)},l.registerName=function(u,m){if(Jb(u),this.names.has(u))this.names.get(u).add(m);else{var _=new Set;_.add(m),this.names.set(u,_)}},l.insertRules=function(u,m,_){this.registerName(u,m),this.getTag().insertRules(Jb(u),_)},l.clearNames=function(u){this.names.has(u)&&this.names.get(u).clear()},l.clearRules=function(u){this.getTag().clearGroup(Jb(u)),this.clearNames(u)},l.clearTag=function(){this.tag=void 0},l.toString=function(){return function(u){for(var m=u.getTag(),_=m.length,S="",M=0;M<_;M++){var P=vX(M);if(P!==void 0){var k=u.names.get(P),L=m.getGroup(M);if(k&&L&&k.size){var z=Rg+".g"+M+'[id="'+P+'"]',$="";k!==void 0&&k.forEach(function(H){H.length>0&&($+=H+",")}),S+=""+L+z+'{content:"'+$+`"}/*!sc*/
`}}}return S}(this)},o}(),CX=/(a)(d)/gi,MO=function(o){return String.fromCharCode(o+(o>25?39:97))},Sv=function(o,l){for(var u=l.length;u;)o=33*o^l.charCodeAt(--u);return o},CO=function(o){return Sv(5381,o)},AX=CO("5.3.11"),PX=function(){function o(l,u,m){this.rules=l,this.staticRulesId="",this.isStatic=(m===void 0||m.isStatic)&&iX(l),this.componentId=u,this.baseHash=Sv(AX,u),this.baseStyle=m,Ly.registerId(u)}return o.prototype.generateAndInjectStyles=function(l,u,m){var _=this.componentId,S=[];if(this.baseStyle&&S.push(this.baseStyle.generateAndInjectStyles(l,u,m)),this.isStatic&&!m.hash)if(this.staticRulesId&&u.hasNameForId(_,this.staticRulesId))S.push(this.staticRulesId);else{var M=bv(this.rules,l,u,m).join(""),P=_O(Sv(this.baseHash,M)>>>0);if(!u.hasNameForId(_,P)){var k=m(M,"."+P,void 0,_);u.insertRules(_,P,k)}S.push(P),this.staticRulesId=P}else{for(var L=this.rules.length,z=Sv(this.baseHash,m.hash),$="",H=0;H<L;H++){var j=this.rules[H];if(typeof j=="string")$+=j;else if(j){var K=bv(j,l,u,m),Q=Array.isArray(K)?K.join(""):K;z=Sv(z,Q+H),$+=Q}}if($){var re=_O(z>>>0);if(!u.hasNameForId(_,re)){var ae=m($,"."+re,void 0,_);u.insertRules(_,re,ae)}S.push(re)}}return S.join(" ")},o}(),RX=/^\s*\/\/.*$/gm,IX=[":","[",".","#"],vC=_a.default.createContext(),vC.Consumer,yC=_a.default.createContext(),NX=(yC.Consumer,new Ly),_C=sX(),kX=function(){function o(l,u){var m=this;this.inject=function(_,S){S===void 0&&(S=_C);var M=m.name+S.hash;_.hasNameForId(m.id,M)||_.insertRules(m.id,M,S(m.rules,M,"@keyframes"))},this.toString=function(){return Ag(12,String(m.name))},this.name=l,this.id="sc-keyframes-"+l,this.rules=u}return o.prototype.getName=function(l){return l===void 0&&(l=_C),this.name+l.hash},o}(),DX=/([A-Z])/,OX=/([A-Z])/g,LX=/^ms-/,FX=function(o){return"-"+o.toLowerCase()},AO=function(o){return o==null||o===!1||o===""},PO=function(o){return Array.isArray(o)&&(o.isCss=!0),o},RO=function(o,l,u){return u===void 0&&(u=Pg),o.theme!==u.theme&&o.theme||l||u.theme},UX=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,BX=/(^-|-$)/g,IO=function(o){return _O(CO(o)>>>0)},xC=function(o){return typeof o=="function"||typeof o=="object"&&o!==null&&!Array.isArray(o)},zX=function(o){return o!=="__proto__"&&o!=="constructor"&&o!=="prototype"},bC=_a.default.createContext(),bC.Consumer,SC={},wC=function(o){return function l(u,m,_){if(_===void 0&&(_=Pg),!(0,SO.isValidElementType)(m))return Ag(1,String(m));var S=function(){return u(m,_,id.apply(void 0,arguments))};return S.withConfig=function(M){return l(u,m,df({},_,{},M))},S.attrs=function(M){return l(u,m,df({},_,{attrs:Array.prototype.concat(_.attrs,M).filter(Boolean)}))},S}(uX,o)},["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(o){wC[o]=wC(o)}),VX=function(){function o(u,m){this.rules=u,this.componentId=m,this.isStatic=iX(u),Ly.registerId(this.componentId+1)}var l=o.prototype;return l.createStyles=function(u,m,_,S){var M=S(bv(this.rules,m,_,S).join(""),""),P=this.componentId+u;_.insertRules(P,P,M)},l.removeStyles=function(u,m){m.clearRules(this.componentId+u)},l.renderStyles=function(u,m,_,S){u>2&&Ly.registerId(this.componentId+u),this.removeStyles(u,_),this.createStyles(u,m,_,S)},o}(),function(){function o(){var u=this;this._emitSheetCSS=function(){var m=u.instance.toString();if(!m)return"";var _=gC();return"<style "+[_&&'nonce="'+_+'"',Rg+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+m+"</style>"},this.getStyleTags=function(){return u.sealed?Ag(2):u._emitSheetCSS()},this.getStyleElement=function(){var m;if(u.sealed)return Ag(2);var _=((m={})[Rg]="",m["data-styled-version"]="5.3.11",m.dangerouslySetInnerHTML={__html:u.instance.toString()},m),S=gC();return S&&(_.nonce=S),[_a.default.createElement("style",df({},_,{key:"sc-0-0"}))]},this.seal=function(){u.sealed=!0},this.instance=new Ly({isServer:!0}),this.sealed=!1}var l=o.prototype;return l.collectStyles=function(u){return this.sealed?Ag(2):_a.default.createElement(aX,{sheet:this.instance},u)},l.interleaveWithNodeStream=function(u){return Ag(3)},o}(),ge=wC});function wv(){return wv=Object.assign||function(o){for(var l=1;l<arguments.length;l++){var u=arguments[l];for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(o[m]=u[m])}return o},wv.apply(this,arguments)}var ebe=A(()=>{});function tbe(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}var nbe=A(()=>{});function eS(o,l){return eS=Object.setPrototypeOf||function(u,m){return u.__proto__=m,u},eS(o,l)}var NO=A(()=>{});function rbe(o,l){o.prototype=Object.create(l.prototype),o.prototype.constructor=o,eS(o,l)}var ibe=A(()=>{NO()});function kO(o){return kO=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},kO(o)}var sbe=A(()=>{});function obe(o){return Function.toString.call(o).indexOf("[native code]")!==-1}var abe=A(()=>{});function lbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cbe=A(()=>{});function TC(o,l,u){return lbe()?TC=Reflect.construct:TC=function(m,_,S){var M=[null];M.push.apply(M,_);var P=Function.bind.apply(m,M),k=new P;return S&&eS(k,S.prototype),k},TC.apply(null,arguments)}var ube=A(()=>{NO(),cbe()});function DO(o){var l=typeof Map=="function"?new Map:void 0;return DO=function(u){if(u===null||!obe(u))return u;if(typeof u!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l<"u"){if(l.has(u))return l.get(u);l.set(u,m)}function m(){return TC(u,arguments,kO(this).constructor)}return m.prototype=Object.create(u.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),eS(m,u)},DO(o)}var dbe=A(()=>{sbe(),NO(),abe(),ube()}),hbe=A(()=>{});function fbe(o){return o.charAt(0).toUpperCase()+o.slice(1)}function pbe(o,l){if(!o)return l.toLowerCase();var u=o.split("-");if(u.length>1)return u.splice(1,0,l),u.reduce(function(_,S){return""+_+fbe(S)});var m=o.replace(/([a-z])([A-Z])/g,"$1"+l+"$2");return o===m?""+o+l:m}function mbe(o,l){for(var u={},m=0;m<l.length;m+=1)(l[m]||l[m]===0)&&(u[pbe(o,XX[m])]=l[m]);return u}function GX(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];var _=u[0],S=u[1],M=S===void 0?_:S,P=u[2],k=P===void 0?_:P,L=u[3],z=L===void 0?M:L,$=[_,M,k,z];return mbe(o,$)}function OO(o){return Math.round(o*255)}function gbe(o,l,u){return OO(o)+","+OO(l)+","+OO(u)}function EC(o,l,u,m){if(m===void 0&&(m=gbe),l===0)return m(u,u,u);var _=(o%360+360)%360/60,S=(1-Math.abs(2*u-1))*l,M=S*(1-Math.abs(_%2-1)),P=0,k=0,L=0;_>=0&&_<1?(P=S,k=M):_>=1&&_<2?(P=M,k=S):_>=2&&_<3?(k=S,L=M):_>=3&&_<4?(k=M,L=S):_>=4&&_<5?(P=M,L=S):_>=5&&_<6&&(P=S,L=M);var z=u-S/2,$=P+z,H=k+z,j=L+z;return m($,H,j)}function vbe(o){if(typeof o!="string")return o;var l=o.toLowerCase();return zO[l]?"#"+zO[l]:o}function jX(o){if(typeof o!="string")throw new hf(3);var l=vbe(o);if(l.match(YX))return{red:parseInt(""+l[1]+l[2],16),green:parseInt(""+l[3]+l[4],16),blue:parseInt(""+l[5]+l[6],16)};if(l.match(KX)){var u=parseFloat((parseInt(""+l[7]+l[8],16)/255).toFixed(2));return{red:parseInt(""+l[1]+l[2],16),green:parseInt(""+l[3]+l[4],16),blue:parseInt(""+l[5]+l[6],16),alpha:u}}if(l.match(ZX))return{red:parseInt(""+l[1]+l[1],16),green:parseInt(""+l[2]+l[2],16),blue:parseInt(""+l[3]+l[3],16)};if(l.match(QX)){var m=parseFloat((parseInt(""+l[4]+l[4],16)/255).toFixed(2));return{red:parseInt(""+l[1]+l[1],16),green:parseInt(""+l[2]+l[2],16),blue:parseInt(""+l[3]+l[3],16),alpha:m}}var _=AC.exec(l);if(_)return{red:parseInt(""+_[1],10),green:parseInt(""+_[2],10),blue:parseInt(""+_[3],10)};var S=JX.exec(l.substring(0,50));if(S)return{red:parseInt(""+S[1],10),green:parseInt(""+S[2],10),blue:parseInt(""+S[3],10),alpha:parseFloat(""+S[4])};var M=eY.exec(l);if(M){var P=parseInt(""+M[1],10),k=parseInt(""+M[2],10)/100,L=parseInt(""+M[3],10)/100,z="rgb("+EC(P,k,L)+")",$=AC.exec(z);if(!$)throw new hf(4,l,z);return{red:parseInt(""+$[1],10),green:parseInt(""+$[2],10),blue:parseInt(""+$[3],10)}}var H=tY.exec(l.substring(0,50));if(H){var j=parseInt(""+H[1],10),K=parseInt(""+H[2],10)/100,Q=parseInt(""+H[3],10)/100,re="rgb("+EC(j,K,Q)+")",ae=AC.exec(re);if(!ae)throw new hf(4,l,re);return{red:parseInt(""+ae[1],10),green:parseInt(""+ae[2],10),blue:parseInt(""+ae[3],10),alpha:parseFloat(""+H[4])}}throw new hf(5)}function ybe(o){var l=o.red/255,u=o.green/255,m=o.blue/255,_=Math.max(l,u,m),S=Math.min(l,u,m),M=(_+S)/2;if(_===S)return o.alpha!==void 0?{hue:0,saturation:0,lightness:M,alpha:o.alpha}:{hue:0,saturation:0,lightness:M};var P,k=_-S,L=M>.5?k/(2-_-S):k/(_+S);switch(_){case l:P=(u-m)/k+(u<m?6:0);break;case u:P=(m-l)/k+2;break;default:P=(l-u)/k+4;break}return P*=60,o.alpha!==void 0?{hue:P,saturation:L,lightness:M,alpha:o.alpha}:{hue:P,saturation:L,lightness:M}}function LO(o){return ybe(jX(o))}function Tv(o){var l=o.toString(16);return l.length===1?"0"+l:l}function FO(o){return Tv(Math.round(o*255))}function _be(o,l,u){return PC("#"+FO(o)+FO(l)+FO(u))}function HX(o,l,u){return EC(o,l,u,_be)}function xbe(o,l,u){if(typeof o=="object"&&l===void 0&&u===void 0)return HX(o.hue,o.saturation,o.lightness);throw new hf(1)}function bbe(o,l,u,m){if(typeof o=="object"&&l===void 0&&u===void 0&&m===void 0)return o.alpha>=1?HX(o.hue,o.saturation,o.lightness):"rgba("+EC(o.hue,o.saturation,o.lightness)+","+o.alpha+")";throw new hf(2)}function WX(o,l,u){if(typeof o=="number"&&typeof l=="number"&&typeof u=="number")return PC("#"+Tv(o)+Tv(l)+Tv(u));if(typeof o=="object"&&l===void 0&&u===void 0)return PC("#"+Tv(o.red)+Tv(o.green)+Tv(o.blue));throw new hf(6)}function qX(o,l,u,m){if(typeof o=="object"&&l===void 0&&u===void 0&&m===void 0)return o.alpha>=1?WX(o.red,o.green,o.blue):"rgba("+o.red+","+o.green+","+o.blue+","+o.alpha+")";throw new hf(7)}function UO(o){if(typeof o!="object")throw new hf(8);if(rY(o))return qX(o);if(nY(o))return WX(o);if(sY(o))return bbe(o);if(iY(o))return xbe(o);throw new hf(8)}function $X(o,l,u){return function(){var m=u.concat(Array.prototype.slice.call(arguments));return m.length>=l?o.apply(this,m):$X(o,l,m)}}function MC(o){return $X(o,o.length,[])}function CC(o,l,u){return Math.max(o,Math.min(l,u))}function Sbe(o,l){if(l==="transparent")return l;var u=LO(l);return UO(wv({},u,{lightness:CC(0,1,u.lightness-parseFloat(o))}))}function wbe(o,l){if(l==="transparent")return l;var u=LO(l);return UO(wv({},u,{lightness:CC(0,1,u.lightness+parseFloat(o))}))}function Tbe(o,l){if(l==="transparent")return l;var u=LO(l);return UO(wv({},u,{saturation:CC(0,1,u.saturation+parseFloat(o))}))}function Ebe(o,l){if(l==="transparent")return l;var u=jX(l),m=typeof u.alpha=="number"?u.alpha:1,_=wv({},u,{alpha:CC(0,1,+(m*100-parseFloat(o)*100).toFixed(2)/100)});return qX(_)}function BO(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];return oY.indexOf(o)>=0&&o?wv({},GX.apply(void 0,[""].concat(u)),{position:o}):GX.apply(void 0,["",o].concat(u))}var hf,XX,zO,YX,KX,ZX,QX,AC,JX,eY,tY,PC,nY,rY,iY,sY,VO,Fy,RC,h1,oY,ff=A(()=>{ebe(),nbe(),ibe(),dbe(),hbe(),hf=function(o){rbe(l,o);function l(u){var m;return m=o.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+u+" for more information.")||this,tbe(m)}return l}(DO(Error)),XX=["Top","Right","Bottom","Left"],zO={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},YX=/^#[a-fA-F0-9]{6}$/,KX=/^#[a-fA-F0-9]{8}$/,ZX=/^#[a-fA-F0-9]{3}$/,QX=/^#[a-fA-F0-9]{4}$/,AC=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,JX=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,eY=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,tY=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,PC=function(o){return o.length===7&&o[1]===o[2]&&o[3]===o[4]&&o[5]===o[6]?"#"+o[1]+o[3]+o[5]:o},nY=function(o){return typeof o.red=="number"&&typeof o.green=="number"&&typeof o.blue=="number"&&(typeof o.alpha!="number"||typeof o.alpha>"u")},rY=function(o){return typeof o.red=="number"&&typeof o.green=="number"&&typeof o.blue=="number"&&typeof o.alpha=="number"},iY=function(o){return typeof o.hue=="number"&&typeof o.saturation=="number"&&typeof o.lightness=="number"&&(typeof o.alpha!="number"||typeof o.alpha>"u")},sY=function(o){return typeof o.hue=="number"&&typeof o.saturation=="number"&&typeof o.lightness=="number"&&typeof o.alpha=="number"},VO=MC(Sbe),Fy=MC(wbe),RC=MC(Tbe),h1=MC(Ebe),oY=["absolute","fixed","relative","static","sticky"]});function Mbe(o,l,u){return l in o?Object.defineProperty(o,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[l]=u,o}function aY(o,l){var u=Object.keys(o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),u.push.apply(u,m)}return u}function Ev(o){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?aY(Object(u),!0).forEach(function(m){Mbe(o,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(u)):aY(Object(u)).forEach(function(m){Object.defineProperty(o,m,Object.getOwnPropertyDescriptor(u,m))})}return o}function Uy(o,l){if(o==null)return{};var u={},m=Object.keys(o),_,S;for(S=0;S<m.length;S++)_=m[S],!(l.indexOf(_)>=0)&&(u[_]=o[_]);return u}var tS=A(()=>{}),lY,GO,cY=A(()=>{lY=G(et()),GO=(0,lY.createContext)({})});function Cbe(o,l,u){return l in o?Object.defineProperty(o,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[l]=u,o}function uY(o,l){var u=Object.keys(o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),u.push.apply(u,m)}return u}function By(o){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?uY(Object(u),!0).forEach(function(m){Cbe(o,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(u)):uY(Object(u)).forEach(function(m){Object.defineProperty(o,m,Object.getOwnPropertyDescriptor(u,m))})}return o}function jO(o,l){if(o==null)return{};var u={},m=Object.keys(o),_,S;for(S=0;S<m.length;S++)_=m[S],!(l.indexOf(_)>=0)&&(u[_]=o[_]);return u}function Abe(o,l){if(o){if(typeof o=="string")return dY(o,l);var u=Object.prototype.toString.call(o).slice(8,-1);if(u==="Object"&&o.constructor&&(u=o.constructor.name),u==="Map"||u==="Set")return Array.from(o);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return dY(o,l)}}function dY(o,l){(l==null||l>o.length)&&(l=o.length);for(var u=0,m=new Array(l);u<l;u++)m[u]=o[u];return m}function hY(o,l){var u;if(typeof Symbol>"u"||o[Symbol.iterator]==null){if(Array.isArray(o)||(u=Abe(o))||l){u&&(o=u);var m=0;return function(){return m>=o.length?{done:!0}:{done:!1,value:o[m++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return u=o[Symbol.iterator](),u.next.bind(u)}var IC=A(()=>{});function Pbe(o){return typeof o=="function"}var HO,fY,Rbe=A(()=>{HO=G(et()),cY(),IC(),fY=function(o,l,u){u===void 0&&(u=l.children);var m=(0,HO.useContext)(GO);if(m.useCreateElement)return m.useCreateElement(o,l,u);if(typeof o=="string"&&Pbe(u)){l.children;var _=jO(l,["children"]);return u(_)}return(0,HO.createElement)(o,l,u)}});function Ibe(o,l,u){return l in o?Object.defineProperty(o,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[l]=u,o}function pY(o,l){var u=Object.keys(o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),u.push.apply(u,m)}return u}function zy(o){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?pY(Object(u),!0).forEach(function(m){Ibe(o,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(u)):pY(Object(u)).forEach(function(m){Object.defineProperty(o,m,Object.getOwnPropertyDescriptor(u,m))})}return o}function Nbe(o,l){if(o==null)return{};var u={},m=Object.keys(o),_,S;for(S=0;S<m.length;S++)_=m[S],!(l.indexOf(_)>=0)&&(u[_]=o[_]);return u}var mY=A(()=>{});function kbe(o){return typeof o=="object"&&o!=null}var Dbe=A(()=>{});function WO(o){var l;if(!kbe(o))return!1;var u=Object.getPrototypeOf(o);return u==null?!0:((l=u.constructor)===null||l===void 0?void 0:l.toString())===Object.toString()}var gY=A(()=>{Dbe()});function vY(o,l){for(var u=Object.keys(o),m={},_={},S=0,M=u;S<M.length;S++){var P=M[S];l.indexOf(P)>=0?m[P]=o[P]:_[P]=o[P]}return[m,_]}function yY(o,l){if(l===void 0&&(l=[]),!WO(o.state))return vY(o,l);var u=vY(o,[].concat(l,["state"])),m=u[0],_=u[1],S=m.state,M=Nbe(m,["state"]);return[zy(zy({},S),M),_]}var Obe=A(()=>{mY(),gY()});function NC(o,l){if(o===l)return!0;if(!o||!l||typeof o!="object"||typeof l!="object")return!1;var u=Object.keys(o),m=Object.keys(l),_=u.length;if(m.length!==_)return!1;for(var S=0,M=u;S<M.length;S++){var P=M[S];if(o[P]!==l[P])return!1}return!0}var qO=A(()=>{});function _Y(o){return o.name==="normalizePropsAreEqualInner"?o:function(l,u){return!WO(l.state)||!WO(u.state)?o(l,u):o(zy(zy({},l.state),l),zy(zy({},u.state),u))}}var Lbe=A(()=>{mY(),gY()});function Fbe(o){return(0,$O.forwardRef)(o)}function Ube(o,l){return(0,$O.memo)(o,l)}function nS(o){var l=o.as,u=o.useHook,m=o.memo,_=o.propsAreEqual,S=_===void 0?u==null?void 0:u.unstable_propsAreEqual:_,M=o.keys,P=M===void 0?(u==null?void 0:u.__keys)||[]:M,k=o.useCreateElement,L=k===void 0?fY:k,z=function($,H){var j=$.as,K=j===void 0?l:j,Q=jO($,["as"]);if(u){var re,ae=yY(Q,P),ue=ae[0],ye=ae[1],Ae=u(ue,By({ref:H},ye)),Ce=Ae.wrapElement,Se=jO(Ae,["wrapElement"]),ft=((re=K.render)===null||re===void 0?void 0:re.__keys)||K.__keys,ke=ft&&yY(Q,ft)[0],be=ke?By(By({},Se),ke):Se,Ue=L(K,be);return Ce?Ce(Ue):Ue}return L(K,By({ref:H},Q))};return z=Fbe(z),m&&(z=Ube(z,S&&_Y(S))),z.__keys=P,z.unstable_propsAreEqual=_Y(S||NC),z}var $O,rS=A(()=>{$O=G(et()),IC(),Rbe(),Obe(),qO(),Lbe()});function xY(o,l){(0,XO.useDebugValue)(o);var u=(0,XO.useContext)(GO);return u[o]!=null?u[o]:l}var XO,bY=A(()=>{XO=G(et()),cY()});function Bbe(o,l,u){l===void 0&&(l={}),u===void 0&&(u={});var m="use"+o+"Props";(0,SY.useDebugValue)(m);var _=xY(m);return _?_(l,u):u}var SY,zbe=A(()=>{SY=G(et()),bY()});function Vbe(o,l,u){l===void 0&&(l={}),u===void 0&&(u={});var m="use"+o+"Options";(0,wY.useDebugValue)(m);var _=xY(m);return _?By(By({},l),_(l,u)):l}var wY,Gbe=A(()=>{wY=G(et()),bY(),IC()});function jbe(o){return Array.isArray(o)?o:typeof o<"u"?[o]:[]}var Hbe=A(()=>{});function iS(o){var l,u,m=jbe(o.compose),_=function(P,k){if(o.useOptions&&(P=o.useOptions(P,k)),o.name&&(P=Vbe(o.name,P,k)),o.compose)for(var L=hY(m),z;!(z=L()).done;){var $=z.value;P=$.__useOptions(P,k)}return P},S=function(P,k,L){if(P===void 0&&(P={}),k===void 0&&(k={}),L===void 0&&(L=!1),L||(P=_(P,k)),o.useProps&&(k=o.useProps(P,k)),o.name&&(k=Bbe(o.name,P,k)),o.compose)if(o.useComposeOptions&&(P=o.useComposeOptions(P,k)),o.useComposeProps)k=o.useComposeProps(P,k);else for(var z=hY(m),$;!($=z()).done;){var H=$.value;k=H(P,k,!0)}var j={},K=k||{};for(var Q in K)K[Q]!==void 0&&(j[Q]=K[Q]);return j};S.__useOptions=_;var M=m.reduce(function(P,k){return P.push.apply(P,k.__keys||[]),P},[]);return S.__keys=[].concat(M,((l=o.useState)===null||l===void 0?void 0:l.__keys)||[],o.keys||[]),S.unstable_propsAreEqual=o.propsAreEqual||((u=m[0])===null||u===void 0?void 0:u.unstable_propsAreEqual)||NC,S}var sS=A(()=>{G(et()),zbe(),IC(),Gbe(),qO(),Hbe()});function TY(o,l){l===void 0&&(l=null),o&&(typeof o=="function"?o(l):o.current=l)}function EY(o,l){return(0,MY.useMemo)(function(){return o==null&&l==null?null:function(u){TY(o,u),TY(l,u)}},[o,l])}var MY,CY=A(()=>{MY=G(et())});function YO(o){if(o.tagName==="BUTTON")return!0;if(o.tagName==="INPUT"){var l=o;return AY.indexOf(l.type)!==-1}return!1}var AY,KO=A(()=>{AY=["button","color","file","image","reset","submit"]}),ZO=A(()=>{}),Wbe=A(()=>{ZO(),G(et())}),kC=A(()=>{ZO(),G(et()),Wbe()});function qbe(o){return o?o.ownerDocument||o:document}var PY=A(()=>{});function $be(o){return RY}var RY,Xbe=A(()=>{PY();try{RY=window}catch{}});function Ybe(){var o=$be();return!!(typeof o<"u"&&o.document&&o.document.createElement)}var DC,QO=A(()=>{Xbe(),DC=Ybe()}),JO,eL,tL=A(()=>{JO=G(et()),QO(),eL=DC?JO.useLayoutEffect:JO.useEffect});function Vy(o){var l=(0,IY.useRef)(o);return eL(function(){l.current=o}),l}var IY,NY=A(()=>{IY=G(et()),tL()});function Kbe(o){return o.target===o.currentTarget}var Zbe=A(()=>{});function Qbe(o){var l=qbe(o),u=l.activeElement;return u!=null&&u.nodeName?u:null}var Jbe=A(()=>{PY()});function kY(o,l){return o===l||o.contains(l)}var DY=A(()=>{});function eSe(o){var l=Qbe(o);if(!l)return!1;if(kY(o,l))return!0;var u=l.getAttribute("aria-activedescendant");return u?u===o.id?!0:!!o.querySelector("#"+u):!1}var tSe=A(()=>{Jbe(),DY()});function nSe(o){return!kY(o.currentTarget,o.target)}var rSe=A(()=>{DY()});function OC(o){return DC?window.navigator.userAgent.indexOf(o)!==-1:!1}var iSe=A(()=>{QO()});function sSe(o,l){return"matches"in o?o.matches(l):"msMatchesSelector"in o?o.msMatchesSelector(l):o.webkitMatchesSelector(l)}var oSe=A(()=>{});function aSe(o){var l=o;return l.offsetWidth>0||l.offsetHeight>0||o.getClientRects().length>0}function lSe(o){return sSe(o,OY)&&aSe(o)}var OY,cSe=A(()=>{oSe(),OY="input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), a[href], button:not([disabled]), [tabindex], iframe, object, embed, area[href], audio[controls], video[controls], [contenteditable]:not([contenteditable='false'])"}),LY,LC,FY=A(()=>{tS(),rS(),sS(),qO(),LY=["unstable_system"],LC=iS({name:"Role",keys:LY,propsAreEqual:function(o,l){var u=o.unstable_system,m=Uy(o,["unstable_system"]),_=l.unstable_system,S=Uy(l,["unstable_system"]);return u!==_&&!NC(u,_)?!1:NC(m,S)}}),nS({as:"div",useHook:LC})});function UY(o){!eSe(o)&&lSe(o)&&o.focus()}function uSe(o){return o.tagName==="BUTTON"||o.tagName==="INPUT"||o.tagName==="SELECT"||o.tagName==="TEXTAREA"||o.tagName==="A"}function dSe(o){return o.tagName==="BUTTON"||o.tagName==="INPUT"||o.tagName==="SELECT"||o.tagName==="TEXTAREA"}function hSe(o,l,u,m){return o?l&&!u?-1:void 0:l?m:m||0}function nL(o,l){return(0,Gy.useCallback)(function(u){var m;(m=o.current)===null||m===void 0||m.call(o,u),!u.defaultPrevented&&l&&(u.stopPropagation(),u.preventDefault())},[o,l])}var Gy,BY,zY,rL,fSe=A(()=>{tS(),rS(),sS(),Gy=G(et()),CY(),KO(),kC(),NY(),tL(),tSe(),rSe(),iSe(),cSe(),FY(),BY=["disabled","focusable"],zY=OC("Mac")&&!OC("Chrome")&&(OC("Safari")||OC("Firefox")),rL=iS({name:"Tabbable",compose:LC,keys:BY,useOptions:function(o,l){var u=l.disabled;return Ev({disabled:u},o)},useProps:function(o,l){var u=l.ref,m=l.tabIndex,_=l.onClickCapture,S=l.onMouseDownCapture,M=l.onMouseDown,P=l.onKeyPressCapture,k=l.style,L=Uy(l,["ref","tabIndex","onClickCapture","onMouseDownCapture","onMouseDown","onKeyPressCapture","style"]),z=(0,Gy.useRef)(null),$=Vy(_),H=Vy(S),j=Vy(M),K=Vy(P),Q=!!o.disabled&&!o.focusable,re=(0,Gy.useState)(!0),ae=re[0],ue=re[1],ye=(0,Gy.useState)(!0),Ae=ye[0],Ce=ye[1],Se=o.disabled?Ev({pointerEvents:"none"},k):k;eL(function(){var Ze=z.current;Ze&&(uSe(Ze)||ue(!1),dSe(Ze)||Ce(!1))},[]);var ft=nL($,o.disabled),ke=nL(H,o.disabled),be=nL(K,o.disabled),Ue=(0,Gy.useCallback)(function(Ze){var ze;(ze=j.current)===null||ze===void 0||ze.call(j,Ze);var Ft=Ze.currentTarget;if(!Ze.defaultPrevented&&zY&&!nSe(Ze)&&YO(Ft)){var Ke=requestAnimationFrame(function(){Ft.removeEventListener("mouseup",Yt,!0),UY(Ft)}),Yt=function(){cancelAnimationFrame(Ke),UY(Ft)};Ft.addEventListener("mouseup",Yt,{once:!0,capture:!0})}},[]);return Ev({ref:EY(z,u),style:Se,tabIndex:hSe(Q,ae,Ae,m),disabled:Q&&Ae?!0:void 0,"aria-disabled":o.disabled?!0:void 0,onClickCapture:ft,onMouseDownCapture:ke,onMouseDown:Ue,onKeyPressCapture:be},L)}}),nS({as:"div",useHook:rL})});function pSe(o){var l=o.currentTarget;return o.isTrusted?YO(l)||l.tagName==="INPUT"||l.tagName==="TEXTAREA"||l.tagName==="A"||l.tagName==="SELECT":!1}var FC,VY,iL,mSe=A(()=>{tS(),rS(),sS(),FC=G(et()),KO(),kC(),NY(),Zbe(),fSe(),VY=["unstable_clickOnEnter","unstable_clickOnSpace"],iL=iS({name:"Clickable",compose:rL,keys:VY,useOptions:function(o){var l=o.unstable_clickOnEnter,u=l===void 0?!0:l,m=o.unstable_clickOnSpace,_=m===void 0?!0:m,S=Uy(o,["unstable_clickOnEnter","unstable_clickOnSpace"]);return Ev({unstable_clickOnEnter:u,unstable_clickOnSpace:_},S)},useProps:function(o,l){var u=l.onKeyDown,m=l.onKeyUp,_=Uy(l,["onKeyDown","onKeyUp"]),S=(0,FC.useState)(!1),M=S[0],P=S[1],k=Vy(u),L=Vy(m),z=(0,FC.useCallback)(function(H){var j;if((j=k.current)===null||j===void 0||j.call(k,H),!H.defaultPrevented&&!o.disabled&&!H.metaKey&&Kbe(H)){var K=o.unstable_clickOnEnter&&H.key==="Enter",Q=o.unstable_clickOnSpace&&H.key===" ";if(K||Q){if(pSe(H))return;H.preventDefault(),K?H.currentTarget.click():Q&&P(!0)}}},[o.disabled,o.unstable_clickOnEnter,o.unstable_clickOnSpace]),$=(0,FC.useCallback)(function(H){var j;if((j=L.current)===null||j===void 0||j.call(L,H),!H.defaultPrevented&&!o.disabled&&!H.metaKey){var K=o.unstable_clickOnSpace&&H.key===" ";M&&K&&(P(!1),H.currentTarget.click())}},[o.disabled,o.unstable_clickOnSpace,M]);return Ev({"data-active":M||void 0,onKeyDown:z,onKeyUp:$},_)}}),nS({as:"button",memo:!0,useHook:iL})}),oS,GY,jY,HY,gSe=A(()=>{tS(),rS(),sS(),oS=G(et()),CY(),KO(),kC(),mSe(),GY=[],jY=iS({name:"Button",compose:iL,keys:GY,useProps:function(o,l){var u=l.ref,m=Uy(l,["ref"]),_=(0,oS.useRef)(null),S=(0,oS.useState)(void 0),M=S[0],P=S[1],k=(0,oS.useState)("button"),L=k[0],z=k[1];return(0,oS.useEffect)(function(){var $=_.current;$&&(YO($)||($.tagName!=="A"&&P("button"),z(void 0)))},[]),Ev({ref:EY(_,u),role:M,type:L},m)}}),HY=nS({as:"button",memo:!0,useHook:jY})}),WY,qY,$Y,vSe=A(()=>{tS(),rS(),sS(),FY(),WY=[],qY=iS({name:"Group",compose:LC,keys:WY,useProps:function(o,l){return Ev({role:"group"},l)}}),$Y=nS({as:"div",useHook:qY})});function ySe(){return DC?document.body:null}var XY,jy,_Se=A(()=>{XY=G(et()),tL(),QO(),G(Cg()),jy=(0,XY.createContext)(ySe())}),sL,xSe=A(()=>{typeof window<"u"&&(sL={get passive(){}},window.addEventListener("testPassive",null,sL),window.removeEventListener("testPassive",null,sL))}),Mv=A(()=>{G(et()),kC(),gSe(),vSe(),G(Cg()),_Se(),xSe(),ZO()});function bi(o){let l=(0,oL.useMemo)(()=>{let _=o;return{get current(){return _},set current(S){_=S,m(S)}}},[]),[u,m]=(0,oL.useState)(()=>o);return[l,u]}var oL,Ji=A(()=>{oL=G(et())});function bSe(o){return l=>Ml.default.createElement(eK,null,Ml.default.createElement(o,R({},l)))}var Ml,YY,KY,Wi,Hy,ZY,QY,JY,aL,lL,eK,os=A(()=>{ff(),Jt(),Jt(),Ml=G(et()),YY=G(Cg()),Mv(),Ji(),Wi=id(KY||(KY=X([`
  #pointer-root & {
    pointer-events: none;
  }
  #pointer-root.normal & {
    pointer-events: auto;
  }
`]))),Hy={panel:{bg:"#282b2f",head:{title:{color:"#bbb"},punctuation:{color:"#808080"}},body:{compoudThing:{label:{get color(){return Fy(.6,Hy.panel.bg)}}}}}},QY=typeof window<"u"?dX(ZY||(ZY=X([`
  :host {
    all: initial;
    color: white;
    font: 11px -apple-system, BlinkMacSystemFont, Segoe WPC, Segoe Editor,
      HelveticaNeue-Light, Ubuntu, Droid Sans, sans-serif;
  }

  * {
    padding: 0;
    margin: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    list-style: none;
  }
`]))):{},aL=ge.div(JY||(JY=X([`
  z-index: 51;
  position: fixed;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  pointer-events: none;
`]))),lL=o=>Ml.default.createElement(aX,{disableVendorPrefixes:!0,target:o.target},Ml.default.createElement(Ml.default.Fragment,null,Ml.default.createElement(QY,null),o.children)),eK=o=>{let[l,u]=(0,Ml.useState)(null),[m,_]=(0,Ml.useState)(null);(0,Ml.useLayoutEffect)(()=>{if(!l)return;let{parentNode:P}=l;if(!P)return;let k=P.shadowRoot?parent.shadowRoot:P.attachShadow({mode:"open"});_(k)},[l]);let[S,M]=bi(void 0);return m?YY.default.createPortal(Ml.default.createElement(lL,{target:m},Ml.default.createElement(Ml.default.Fragment,null,Ml.default.createElement(aL,{ref:S}),Ml.default.createElement(jy.Provider,{value:M},o.children))),m):Ml.default.createElement("template",{ref:u,"shadow-root":"open"},o.children)}}),Cv,tK,nK,cL,rK,UC,iK,sK,oK,aK,BC,f1,n9=A(()=>{os(),Jt(),Cv={get outlinePanel(){return 1},get propsPanel(){return Cv.outlinePanel},get sequenceEditorPanel(){return this.outlinePanel-1},get toolbar(){return this.outlinePanel+1},get pluginPanes(){return this.sequenceEditorPanel-1}},tK=Hy.panel.bg,cL=ge.span(nK||(nK=X([`
  white-space: nowrap;
`]))),UC=ge.span(rK||(rK=X([`
  white-space: nowrap;
  color: `,`;
`])),Hy.panel.head.punctuation.color),sK=ge.div(iK||(iK=X([`
  background: `,`;
  flex-grow: 1;
  overflow-y: scroll;
  padding: 0;
`])),tK),oK=18,BC=ge.div(aK||(aK=X([`
  height: `,`px;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  padding: 0 10px;
  position: relative;
  color: #adadadb3;
  border-bottom: 1px solid rgb(0 0 0 / 13%);
  background-color: #25272b;
  font-size: 10px;
  font-weight: 500;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
`])),oK),f1=100}),lK,pf,Wy=A(()=>{lK=()=>{},pf=lK});function SSe(o){return uL.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),uL.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.775 2.781a.5.5 0 01.5.5v1.7H4.67c.108-.957.92-1.7 1.905-1.7h6.608a1.917 1.917 0 110 3.834H6.574c-.78 0-1.452-.466-1.751-1.135H2.275v5.03h2.39a2.032 2.032 0 012.023-1.854h6.38a2.031 2.031 0 110 4.063h-6.38c-.83 0-1.543-.497-1.858-1.21H1.775a.5.5 0 01-.5-.5V3.281a.5.5 0 01.5-.5zm4.799 1.5h6.608a.917.917 0 110 1.834H6.574a.917.917 0 110-1.834zm.114 5.875h6.38a1.031 1.031 0 110 2.063h-6.38a1.032 1.032 0 110-2.063z",fill:"currentColor"}))}var uL,cK,wSe=A(()=>{uL=G(et()),cK=SSe});function TSe(o){return dL.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),dL.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 10.5L4 6.654 5.2 5.5 8 8.385 10.8 5.5 12 6.654 8 10.5z",fill:"currentColor"}))}var dL,uK,ESe=A(()=>{dL=G(et()),uK=TSe});function MSe(o){return hL.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),hL.createElement("path",{d:"M8.339 4.5l-2.055.644 4.451 1.393v2.748l-2.966.928-2.504-.783V6.738l2.42.758 2.055-.644-4.458-1.395L4 5.858v4.463L7.768 11.5 12 10.175V5.646L8.339 4.5z",fill:"currentColor"}))}var hL,fL,CSe=A(()=>{hL=G(et()),fL=MSe});function ASe(o){return pL.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),pL.createElement("path",{d:"M6.8 11.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6zm6-7.2h-2.4v-.6A1.8 1.8 0 008.6 2H7.4a1.8 1.8 0 00-1.8 1.8v.6H3.2a.6.6 0 100 1.2h.6v6.6A1.8 1.8 0 005.6 14h4.8a1.8 1.8 0 001.8-1.8V5.6h.6a.6.6 0 100-1.2zm-6-.6a.6.6 0 01.6-.6h1.2a.6.6 0 01.6.6v.6H6.8v-.6zm4.2 8.4a.6.6 0 01-.6.6H5.6a.6.6 0 01-.6-.6V5.6h6v6.6zm-1.8-.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6z",fill:"currentColor"}))}var pL,mL,PSe=A(()=>{pL=G(et()),mL=ASe}),zC=A(()=>{wSe(),ESe(),CSe(),PSe()}),p1,dK,VC,hK,fK,pK,mK,gK,vK,yK,_K,xK,bK,SK,wK,TK,EK,MK,gL,CK=A(()=>{p1=G(et()),Jt(),Wy(),os(),zC(),VC=ge.li(dK||(dK=X([`
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  justify-content: flex-start;
  flex-direction: column;
  align-items: flex-start;
`]))),fK=ge.div(hK||(hK=X([""]))),mK=ge(fK)(pK||(pK=X([`
  position: relative;
  margin-top: 2px;
  margin-bottom: 2px;
  margin-left: calc(4px + var(--depth) * 16px);
  padding-left: 4px;
  padding-right: 8px;
  gap: 4px;
  height: 21px;
  line-height: 0;
  box-sizing: border-box;
  display: flex;
  flex-wrap: nowrap;
  align-items: center;
  pointer-events: none;
  white-space: nowrap;

  border-radius: 2px;
  box-shadow: 0 3px 4px -1px rgba(0, 0, 0, 0.48);

  color: rgba(255, 255, 255, 0.9);
  background: rgba(40, 43, 47, 0.65);
  backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);

  &.descendant-is-selected {
    background: rgba(29, 53, 59, 0.7);
  }

  `,`;
  &:not(.not-selectable):not(.selected):hover {
    background: rgba(59, 63, 69, 0.9);

    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &:not(.not-selectable):not(.selected):active {
    background: rgba(82, 88, 96, 0.9);
    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &.selected {
    background: rgba(30, 88, 102, 0.7);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Wi),vK=id(gK||(gK=X([`
  font-weight: 500;
  font-size: 11px;
  & {
  }
`]))),_K=ge.span(yK||(yK=X([`
  `,`;

  `,`;
  position: relative;
  // Compensate for border bottom
  top: 0.5px;
  display: flex;
  height: 20px;
  align-items: center;
  box-sizing: border-box;
`])),vK,Wi),bK=ge.div(xK||(xK=X([`
  font-weight: 500;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  opacity: 0.99;
`]))),wK=ge.span(SK||(SK=X([`
  font-size: 9px;
  position: relative;
  display: block;
  transition: transform 0.1s ease-out;

  &:hover {
    transform: rotate(-20deg);
  }

  `,`.collapsed & {
    transform: rotate(-90deg);

    &:hover {
      transform: rotate(-70deg);
    }
  }
`])),VC),EK=ge.ul(TK||(TK=X([`
  margin: 0;
  padding: 0;
  list-style: none;

  `,`.collapsed & {
    display: none;
  }
`])),VC),MK=({label:o,children:l,depth:u,select:m,selectionStatus:_,labelDecoration:S,collapsed:M=!1,setIsCollapsed:P,draggable:k,onDragStart:L,onDragEnd:z})=>{let $=l!==void 0;return p1.default.createElement(VC,{style:{"--depth":u},className:M?"collapsed":""},p1.default.createElement(mK,{className:_,onClick:m??pf,"data-header":!0,draggable:k,onDragStart:L,onDragEnd:z},p1.default.createElement(bK,null,$?p1.default.createElement(wK,{onClick:H=>{H.stopPropagation(),H.preventDefault(),P==null||P(!M)}},p1.default.createElement(uK,null)):p1.default.createElement(fL,null)),p1.default.createElement(_K,null,p1.default.createElement("span",null,o)),S),$&&p1.default.createElement(EK,null,l))},gL=MK});function RSe(o){return Object.keys(o)}function ISe(o){return Object.keys((0,m1.val)(o.sheetTemplatesP))}function NSe(){let o=Ks(nh().filter(l=>Ne(l)||Ot(l)).map(l=>Ot(l)?l.sheet:l))[0];if(o)return o.getSequence()}var m1,nh,AK,qy=A(()=>{m1=an(),$t(),V0(),Ie(),nh=()=>{var o;let l=(0,m1.val)(ce().projectsP),u=((o=(0,m1.val)(ce().atomP.historic.panels.outlinePanel.selection))!=null?o:[]).map(m=>{let _=l[m.projectId];if(!_)return;if(m.type==="Project")return _;if(!(0,m1.val)(_.sheetTemplatesP[m.sheetId]))return;let S=AK(_,m.sheetId);if(!S)return;if(m.type==="Sheet")return S;let M=(0,m1.val)(S.objectsP[m.objectKey]);if(M)return M});return Ks(u.filter(m=>typeof m<"u"))},AK=(o,l)=>{let u=ce().atomP.historic.projects.stateByProjectId[o.address.projectId],m=(0,m1.val)(u.stateBySheetId[l].selectedInstanceId),_=(0,m1.val)(o.sheetTemplatesP[l]);if(_){if(m)return(0,m1.val)(_.instancesP[m]);{let S=(0,m1.val)(_.instancesP);return S[RSe(S)[0]]}}}}),aS,PK,kSe=A(()=>{Ie(),qy(),Sr(),aS=G(et()),CK(),PK=({sheet:o,depth:l})=>{let u=(0,aS.useCallback)(()=>{ce().transaction(({stateEditors:S})=>{S.studio.historic.panels.outline.selection.set([o])})},[o]),m=(0,aS.useCallback)(S=>{let M={type:"theatre-sheet",projectId:o.address.projectId,sheetId:o.address.sheetId,sheetInstanceId:o.address.sheetInstanceId};S.dataTransfer.setData("application/json",JSON.stringify(M)),S.dataTransfer.effectAllowed="copy",document.body.classList.add("dragging-sheet")},[o]),_=(0,aS.useCallback)(()=>{document.body.classList.remove("dragging-sheet")},[]);return ri(()=>{let S=nh();return aS.default.createElement(gL,{depth:l,select:u,selectionStatus:S.some(M=>M===o)?"selected":S.some(M=>M.type==="Theatre_SheetObject"&&M.sheet===o)?"descendant-is-selected":"not-selected",label:"".concat(o.address.sheetId,": ").concat(o.address.sheetInstanceId),draggable:!0,onDragStart:m,onDragEnd:_})},[l,m,_])}}),vL,$y,RK,IK,NK,kK,DSe=A(()=>{Sr(),vL=an(),$y=G(et()),Jt(),kSe(),ge.div(RK||(RK=X([`
  display: flex;
`]))),ge.li(IK||(IK=X([`
  color: `,`;
`])),o=>o.isSelected?"white":"hsl(1, 1%, 80%)"),ge.div(NK||(NK=X([""]))),kK=({sheetId:o,depth:l,project:u})=>ri(()=>{let m=(0,vL.val)(u.sheetTemplatesP[o]);if(!m)return $y.default.createElement($y.default.Fragment,null);let _=(0,vL.val)(m.instancesP);return $y.default.createElement($y.default.Fragment,null,Object.entries(_).map(([S,M])=>$y.default.createElement(PK,{key:M.address.sheetInstanceId,sheet:M,depth:l})))},[l,o,u])}),GC,DK,OK,OSe=A(()=>{qy(),Sr(),GC=G(et()),DSe(),DK=({project:o,depth:l})=>ri(()=>{if(!o)return null;let u=ISe(o);return GC.default.createElement(GC.default.Fragment,null,u.map(m=>GC.default.createElement(kK,{depth:l,sheetId:m,key:"sheet-".concat(m),project:o})))},[o,l]),OK=DK});function LSe(o){var l;let u=o.type==="namespace"?"namespace:".concat(o.sheet.address.sheetId,":").concat(o.path.join("/")):o.type==="Theatre_Project"?"project":o.type==="Theatre_Sheet"?"sheetInstance:".concat(o.address.sheetId,":").concat(o.address.sheetInstanceId):"unknown",m=o.type==="namespace"?o.sheet.address.projectId:o.address.projectId,_=(l=qr(ce().atomP.ahistoric.projects.stateByProjectId[m].collapsedItemsInOutline[u]))!=null?l:!1,S=(0,LK.useCallback)(M=>{ce().transaction(({stateEditors:P})=>{P.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline.set({projectId:m,isCollapsed:M,itemKey:u})})},[u]);return{collapsed:_,setCollapsed:S}}var LK,FSe=A(()=>{LK=G(et()),Ie(),Sr()}),lS,FK,UK,BK,zK,VK,USe=A(()=>{lS=G(et()),CK(),OSe(),Ie(),Sr(),qy(),FK=an(),Jt(),FSe(),BK=ge.div(UK||(UK=X([`
  color: #ff6363;
  margin-left: 11px;
  background: #4c282d;
  padding: 2px 8px;
  border-radius: 2px;
  font-size: 10px;
  box-shadow: 0 2px 8px -4px black;
`]))),zK=({depth:o,project:l})=>{let u=ri(()=>nh(),[]),m=ri(()=>{let P=l.address.projectId,k=(0,FK.val)(ce().atomP.ephemeral.coreByProject[P].loadingState);return(k==null?void 0:k.type)==="browserStateIsNotBasedOnDiskState"},[l]),_=(0,lS.useCallback)(()=>{ce().transaction(({stateEditors:P})=>{P.studio.historic.panels.outline.selection.set([l])})},[l]),{collapsed:S,setCollapsed:M}=LSe(l);return lS.default.createElement(gL,{depth:o,label:l.address.projectId,setIsCollapsed:M,collapsed:S,labelDecoration:m?lS.default.createElement(BK,null,"Has Conflicts"):null,children:lS.default.createElement(OK,{project:l,depth:o+1}),selectionStatus:u.includes(l)?"selected":u.some(P=>P.address.projectId===l.address.projectId)?"descendant-is-selected":"not-selected",select:_})},VK=zK}),GK,yL,jK,HK,WK,qK,BSe=A(()=>{GK=an(),Sr(),Ie(),yL=G(et()),Jt(),USe(),HK=ge.ul(jK||(jK=X([`
  list-style: none;
  margin: 0;
  padding: 0;
  padding-right: 4px;
`]))),WK=o=>ri(()=>{let l=(0,GK.val)(ce().projectsP);return yL.default.createElement(HK,null,Object.keys(l).map(u=>{let m=l[u];return yL.default.createElement(VK,{depth:0,project:m,key:"projectListItem-".concat(u)})}))},[]),qK=WK});function zSe(o){let[l,u]=(0,_L.useState)(!1);return(0,_L.useEffect)(()=>{let m=S=>{let M=l?200:50,P=56,k=S.x<M;k&&(k=S.y>P),u(!!k)};document.addEventListener("mousemove",m);let _=()=>{u(!1)};return document.addEventListener("mouseleave",_),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseleave",_)}},[l]),l}var _L,VSe=A(()=>{_L=G(et())}),cS,Xy,xL,$K,XK,YK,KK,jC,uS,ZK,GSe=A(()=>{cS=G(et()),Jt(),n9(),BSe(),Sr(),Ie(),VSe(),Xy=an(),os(),xL="44px",XK=ge.div($K||($K=X([`
  `,`;
  background-color: transparent;
  position: absolute;
  left: 8px;
  z-index: `,`;

  top: calc(`,` + 8px);
  height: fit-content;
  max-height: calc(100% - `,`);
  overflow-y: scroll;
  overflow-x: hidden;
  padding: 0;
  user-select: none;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;

  display: `,`;

  &:hover {
    display: block;
  }

  // Create a small buffer on the bottom to aid selecting the bottom item in a long, scrolling list
  &::after {
    content: '';
    display: block;
    height: 20px;
  }
`])),Wi,Cv.outlinePanel,xL,xL,({pin:o})=>o?"block":"none"),YK=()=>{var o;let l=(o=qr(ce().atomP.ahistoric.pinOutline))!=null?o:!0,u=qr(ZK),m=zSe();return(0,cS.useLayoutEffect)(()=>{jC.set(m)},[m]),(0,cS.useEffect)(()=>()=>{uS.set(!1),jC.set(!1)},[]),cS.default.createElement(XK,{pin:l||u,onMouseEnter:()=>{uS.set(!0)},onMouseLeave:()=>{uS.set(!1)}},cS.default.createElement(qK,null))},KK=YK,jC=new Xy.Atom(!1),uS=new Xy.Atom(!1),ZK=(0,Xy.prism)(()=>{let o=(0,Xy.val)(uS.prism),l=(0,Xy.val)(jC.prism);return o||l})});function jSe(){let[o,l]=(0,bL.useState)(!1),u=(0,bL.useMemo)(()=>{let m=new Set;return()=>{let _=()=>{m.delete(_),l(m.size>0)};return m.add(_),l(!0),_}},[]);return[o,u]}var bL,HSe=A(()=>{bL=G(et())}),QK,JK,eZ,WSe=A(()=>{QK=G(et()),JK=function(o){(0,QK.useEffect)(o,[])},eZ=JK}),tZ,nZ,rZ,qSe=A(()=>{tZ=G(et()),WSe(),nZ=function(o){var l=(0,tZ.useRef)(o);l.current=o,eZ(function(){return function(){return l.current()}})},rZ=nZ}),HC,iZ,sZ,$Se=A(()=>{HC=G(et()),qSe(),iZ=function(o){var l=(0,HC.useRef)(0),u=(0,HC.useState)(o),m=u[0],_=u[1],S=(0,HC.useCallback)(function(M){cancelAnimationFrame(l.current),l.current=requestAnimationFrame(function(){_(M)})},[]);return rZ(function(){cancelAnimationFrame(l.current)}),[m,S]},sZ=iZ});function XSe(o){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];o&&o.addEventListener&&o.addEventListener.apply(o,l)}function YSe(o){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];o&&o.removeEventListener&&o.removeEventListener.apply(o,l)}var WC,KSe=A(()=>{WC=typeof window<"u"}),oZ,aZ,qC,SL=A(()=>{oZ=G(et()),$Se(),KSe(),aZ=function(o,l){o===void 0&&(o=1/0),l===void 0&&(l=1/0);var u=sZ({width:WC?window.innerWidth:o,height:WC?window.innerHeight:l}),m=u[0],_=u[1];return(0,oZ.useEffect)(function(){if(WC){var S=function(){_({width:window.innerWidth,height:window.innerHeight})};return XSe(window,"resize",S),function(){YSe(window,"resize",S)}}},[]),m},qC=aZ}),wL,$C,XC,TL,Yy,lZ,EL,Ky=A(()=>{wL=an(),Sr(),Ie(),HSe(),$C=G(et()),SL(),XC=(o,l)=>{let u=o.left/l.width,m=(o.left+o.width)/l.width,_=o.top/l.height,S=(o.height+o.top)/l.height;return{edges:{left:u<=.5?{from:"screenLeft",distance:u}:{from:"screenRight",distance:1-u},right:m<=.5?{from:"screenLeft",distance:m}:{from:"screenRight",distance:1-m},top:_<=.5?{from:"screenTop",distance:_}:{from:"screenBottom",distance:1-_},bottom:S<=.5?{from:"screenTop",distance:S}:{from:"screenBottom",distance:1-S}}}},TL=$C.default.createContext(null),Yy=()=>(0,$C.useContext)(TL),lZ=({panelId:o,children:l,defaultPosition:u,minDims:m})=>{let _=qC(800,200),[S,M]=jSe(),{stuff:P}=ri(()=>{var k;let{edges:L}=(k=(0,wL.val)(ce().atomP.historic.panelPositions[o]))!=null?k:u,z=Math.floor(_.width*(L.left.from==="screenLeft"?L.left.distance:1-L.left.distance)),$=Math.floor(_.width*(L.right.from==="screenLeft"?L.right.distance:1-L.right.distance)),H=Math.floor(_.height*(L.top.from==="screenTop"?L.top.distance:1-L.top.distance)),j=Math.floor(_.height*(L.bottom.from==="screenTop"?L.bottom.distance:1-L.bottom.distance)),K=Math.max($-z,m.width),Q=Math.max(j-H,m.height);return{stuff:{dims:wL.prism.memo("dims",()=>({width:K,left:z,top:H,height:Q}),[K,z,H,Q]),panelId:o,minDims:m,boundsHighlighted:S,addBoundsHighlightLock:M}}},[o,_,S,M]);return $C.default.createElement(TL.Provider,{value:P},l)},EL=lZ}),Ig,cZ,mf,uZ,dZ,hZ,fZ,ML,pZ,iu,mZ,Cl=A(()=>{Ig=G(et()),Jt(),cZ="pointer-root",mf="--lockedCursor",dZ=ge.div(uZ||(uZ=X([`
  pointer-events: auto;
  &.normal {
    pointer-events: none;
  }
`]))),fZ=ge.div(hZ||(hZ=X([`
  position: absolute;
  inset: 0;
  pointer-events: none;

  #pointer-root:not(.normal) > & {
    pointer-events: auto;
  }
`]))),ML=(0,Ig.createContext)({}),pZ=o=>{var l,u,m,_;let[S,M]=(0,Ig.useState)([]),P=(0,Ig.useMemo)(()=>({getLock:(L,z)=>{let $={className:L,cursor:z};return M(H=>[...H,$]),()=>{M(H=>H.filter(j=>j!==$))}}}),[]),k=(u=(l=S[0])==null?void 0:l.cursor)!=null?u:"";return Ig.default.createElement(ML.Provider,{value:P},Ig.default.createElement(dZ,{id:cZ,className:((_=(m=S[0])==null?void 0:m.className)!=null?_:"normal")+" "+o.className},Ig.default.createElement(fZ,{style:{cursor:k,[mf]:k}},o.children)))},iu=(o,l,u)=>{let m=(0,Ig.useContext)(ML);(0,Ig.useLayoutEffect)(()=>{if(o)return m.getLock(l,u)},[o,l,u])},mZ=pZ});function gZ(o){return dS.default.createElement(CL.Provider,{value:o.logger},o.children)}function Zy(o,l){let u=(0,dS.useContext)(CL);return(0,dS.useMemo)(()=>o?u.named(o,l):u,[u,o,l])}var dS,CL,Av=A(()=>{dS=G(et()),CL=dS.default.createContext(null)});function ZSe(){let o=Zy("PointerCapturing"),l=gf.default.useRef(null),u=()=>l.current!=null;return m=>{let _,S=M=>(_=M,l.current=M,M);return{capturing:{capturePointer(M){if(o._debug("Capturing pointer",{forDebugName:m,reason:M}),l.current!=null)throw new Error('"'.concat(m,'" attempted capturing pointer for "').concat(M,'" while already captured by "').concat(l.current.debugOwnerName,'" for "').concat(l.current.debugReason,'"'));let P=S({debugOwnerName:m,debugReason:M});return{isCapturing(){return P===l.current},release(){return P===l.current?(o._debug("Releasing pointer",{forDebugName:m,reason:M}),S(null),!0):!1}}},isPointerBeingCaptured:u},forceRelease(){_&&l.current===_&&(o._debug("Force releasing pointer",{localCapture:_}),S(null))}}}}function QSe(o){let l=ZSe();return gf.default.createElement(AL.Provider,{value:l},gf.default.createElement(yZ,{children:o.children}))}function vZ(o){let l=(0,gf.useContext)(AL),u=(0,gf.useMemo)(()=>l(o),[o,l]);return(0,gf.useEffect)(()=>()=>{u.forceRelease()},[u]),u.capturing}var gf,AL,yZ,PL=A(()=>{gf=G(et()),Av(),AL=gf.default.createContext(null),yZ=gf.default.memo(({children:o})=>gf.default.createElement(gf.default.Fragment,null,o))}),RL,JSe=A(()=>{RL=typeof window<"u"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)});function ao(o,l){let u=(0,Qy.useRef)(l);u.current=l;let m=l.shouldPointerLock&&!RL,_=(0,Qy.useRef)({domDragStarted:!1}),{capturePointer:S}=vZ("useDrag for ".concat(l.debugName)),M=(0,Qy.useRef)({onDrag:pf,onDragEnd:pf,onClick:pf}),P=(0,Qy.useRef)(),[k,L]=bi(!1);return(0,Qy.useLayoutEffect)(()=>{if(!o)return;let z=()=>{let ue=_.current.domDragStarted&&_.current.detection.detected;k.current!==ue&&(k.current=ue)},$=ue=>{if(!_.current.domDragStarted)return;let ye=_.current;if(!ewe(ue,ye)&&(ye.detection.detected||(ye.detection.totalDistanceMoved+=Math.abs(ue.movementY)+Math.abs(ue.movementX),ye.detection.totalDistanceMoved>_Z&&(m&&o.requestPointerLock(),ye.detection={detected:!0,dragMovement:{x:0,y:0},dragEventCount:0},z())),ye.detection.detected)){ye.detection.dragEventCount+=1;let{dragMovement:Ae}=ye.detection;if(m)Ae.x+=ue.movementX,Ae.y+=ue.movementY;else{let{startPos:Ce}=ye;Ae.x=ue.screenX-Ce.x,Ae.y=ue.screenY-Ce.y}M.current.onDrag(Ae.x,Ae.y,ue,ue.movementX,ue.movementY)}},H=ue=>{if(K(),!_.current.domDragStarted)return;let ye=_.current.detection.detected;_.current={domDragStarted:!1},l.shouldPointerLock&&!RL&&document.exitPointerLock(),M.current.onDragEnd(ye),window.focus(),ye||M.current.onClick(ue),z()},j=()=>{document.addEventListener("mousemove",$),document.addEventListener("mouseup",H)},K=()=>{var ue;(ue=P.current)==null||ue.release(),document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",H)},Q=ue=>{u.current.disabled||_.current.domDragStarted&&_.current.detection.detected&&(u.current.dontBlockMouseDown||(ue.stopPropagation(),ue.preventDefault()),_.current.detection={detected:!1,totalDistanceMoved:0},z())},re=ue=>{var ye,Ae,Ce,Se;(ye=P.current)==null||ye.release();let ft=u.current;if(ft.disabled===!0||!((Ae=ft.buttons)!=null?Ae:[0]).includes(ue.button))return;let ke=ft.onDragStart(ue);ke!==!1&&(M.current.onDrag=ke.onDrag,M.current.onDragEnd=(Ce=ke.onDragEnd)!=null?Ce:pf,M.current.onClick=(Se=ke.onClick)!=null?Se:pf,P.current=S("Drag start"),ft.dontBlockMouseDown||(ue.stopPropagation(),ue.preventDefault()),_.current={domDragStarted:!0,startPos:{x:ue.screenX,y:ue.screenY},detection:{detected:!1,totalDistanceMoved:0}},z(),j())},ae=ue=>{re(ue)};return o.addEventListener("mousedown",ae),o.addEventListener("click",Q),()=>{var ue,ye;K(),o.removeEventListener("mousedown",ae),o.removeEventListener("click",Q),_.current.domDragStarted&&((ye=(ue=M.current).onDragEnd)==null||ye.call(ue,_.current.detection.detected)),_.current={domDragStarted:!1},z()}},[o]),iu(L&&!!l.lockCSSCursorTo,"dragging",l.lockCSSCursorTo),[L]}function ewe(o,l){return(!l.detection.detected||l.detection.detected&&l.detection.dragEventCount<3)&&(Math.abs(o.movementX)>IL||Math.abs(o.movementY)>IL)}var Qy,_Z,IL,oa=A(()=>{Qy=G(et()),Cl(),PL(),Wy(),JSe(),Ji(),_Z=3,IL=100}),hS,xZ,bZ,SZ,NL,wZ=A(()=>{Ji(),Ie(),oa(),hS=G(et()),Jt(),Ky(),Cl(),V0(),n9(),bZ=ge.div(xZ||(xZ=X([`
  cursor: move;
`]))),SZ=o=>{let l=Yy(),u=(0,hS.useRef)(l);u.current=l;let[m,_]=bi(null),S=(0,hS.useMemo)(()=>({debugName:"PanelDragZone",lockCursorTo:"move",onDragStart(){let L=u.current,z,$=l.addBoundsHighlightLock(),H=L.panelId;if(H.startsWith("pane-")){let j=H.slice(5);ce().paneManager.bringPaneToFront(j)}return{onDrag(j,K){let Q=B(R({},L.dims),{top:Zi(L.dims.top+K,0,window.innerHeight-f1),left:Zi(L.dims.left+j,-L.dims.width+f1,window.innerWidth-f1)}),re=XC(Q,{width:window.innerWidth,height:window.innerHeight});z==null||z.discard(),z=ce().tempTransaction(({stateEditors:ae})=>{ae.studio.historic.panelPositions.setPanelPosition({position:re,panelId:L.panelId})})},onDragEnd(j){$(),j?z==null||z.commit():z==null||z.discard()}}}}),[]),[M]=ao(_,S);iu(M,"dragging","move");let[P,k]=(0,hS.useMemo)(()=>{let L;return[function(){if(L){let z=L;L=void 0,z()}L=l.addBoundsHighlightLock()},function(){if(L){let z=L;L=void 0,z()}}]},[]);return hS.default.createElement(bZ,B(R({},o),{ref:m,onMouseEnter:P,onMouseLeave:k}))},NL=SZ}),fS,kL,TZ,DL,EZ,OL,MZ,LL,CZ,AZ,PZ,RZ,IZ,FL,NZ,kZ,DZ,OZ,LZ,pS,FZ,UZ,BZ,zZ,VZ,GZ,jZ,HZ,WZ,UL,qZ,Ng,twe=A(()=>{Ji(),Ie(),oa(),ff(),fS=G(et()),Jt(),Ky(),os(),V0(),n9(),kL=an(),DL=ge.div(TZ||(TZ=X([`
  position: absolute;
  `,`;
  &:after {
    position: absolute;
    inset: -5px;
    display: block;
    content: ' ';
  }

  opacity: 0;
  background-color: #478698;

  &.isHighlighted {
    opacity: 0.7;
  }

  &.isDragging {
    opacity: 1;
    /* background-color: `,`; */
  }

  &:hover {
    opacity: 1;
  }
`])),Wi,Fy(.2,"#478698")),OL=ge(DL)(EZ||(EZ=X([`
  /**
  The horizintal/vertical resize handles have z-index:-1 and are offset 1px outside of the panel
  to make sure they don't occlude any element that pops out of the panel (like the Playhead in SequenceEditorPanel).

  This means that panels will always need an extra 1px margin for their resize handles to be visible, but that's not a problem
  that we have to deal with right now (if it is at all a problem).
  
   */
  z-index: -1;
`]))),LL=ge(OL)(MZ||(MZ=X([`
  left: 0px;
  right: 0px;
  height: 1px;
`]))),AZ=ge(LL)(CZ||(CZ=X([`
  top: -1px;
`]))),RZ=ge(LL)(PZ||(PZ=X([`
  bottom: -1px;
`]))),FL=ge(OL)(IZ||(IZ=X([`
  z-index: -1;
  top: -1px;
  bottom: -1px;
  width: 1px;
`]))),kZ=ge(FL)(NZ||(NZ=X([`
  left: -1px;
`]))),OZ=ge(FL)(DZ||(DZ=X([`
  right: -1px;
`]))),pS=ge(DL)(LZ||(LZ=X([`
  // The angles have z-index: 10 to make sure they _do_ occlude other elements in the panel.
  z-index: 10;
  width: 8px;
  height: 8px;
`]))),UZ=ge(pS)(FZ||(FZ=X([`
  top: 0;
  left: 0;
`]))),zZ=ge(pS)(BZ||(BZ=X([`
  top: 0;
  right: 0;
`]))),GZ=ge(pS)(VZ||(VZ=X([`
  bottom: 0;
  left: 0;
`]))),HZ=ge(pS)(jZ||(jZ=X([`
  bottom: 0;
  right: 0;
`]))),WZ={Top:AZ,TopLeft:UZ,TopRight:zZ,Bottom:RZ,BottomLeft:GZ,BottomRight:HZ,Left:kZ,Right:OZ},UL={Top:"ns-resize",Bottom:"ns-resize",Left:"ew-resize",Right:"ew-resize",TopLeft:"nw-resize",TopRight:"ne-resize",BottomLeft:"sw-resize",BottomRight:"se-resize"},qZ=({which:o})=>{let l=Yy(),u=(0,fS.useRef)(l);u.current=l;let m=(0,fS.useRef)(0),[_,S]=bi(null),M=(0,fS.useMemo)(()=>({debugName:"PanelResizeHandle",lockCursorTo:UL[o],onDragStart(){var z;let $,H=u.current,j=l.addBoundsHighlightLock();return m.current=(z=(0,kL.val)(ce().atomP.historic.panels.sequenceEditor.dopesheetLeftWidth))!=null?z:225,{onDrag(K,Q){var re;let ae=(re=(0,kL.val)(ce().atomP.historic.panels.sequenceEditor.rightPanelOpen))!=null?re:!0,ue=R({},H.dims);if(o.startsWith("Bottom"))ue.height=Math.max(ue.height+Q,H.minDims.height);else if(o.startsWith("Top")){let Ae=ue.top+ue.height,Ce=Zi(ue.top+Q,0,Math.min(Ae-H.minDims.height,window.innerHeight-f1)),Se=Ae-Ce;ue.height=Se,ue.top=Ce}if(o.endsWith("Left")){let Ae=ue.left+ue.width,Ce=Math.min(ue.left+K,Math.min(Ae-H.minDims.width,window.innerWidth-f1)),Se=Ae-Ce;ue.width=Se,ue.left=Ce}else o.endsWith("Right")&&(ue.width=Math.max(ue.width+K,Math.max(H.minDims.width,f1-H.dims.left)));let ye=XC(ue,{width:window.innerWidth,height:window.innerHeight});$==null||$.discard(),$=ce().tempTransaction(({stateEditors:Ae})=>{if(!ae&&(o==="BottomRight"||o==="TopRight")&&H.panelId==="sequenceEditor"){let Ce=Math.max(225,m.current+K);Ae.studio.historic.panels.sequenceEditor.setDopesheetLeftWidth(Ce)}Ae.studio.historic.panelPositions.setPanelPosition({position:ye,panelId:H.panelId})})},onDragEnd(K){j(),K?$==null||$.commit():$==null||$.discard()}}}}),[o]),[P]=ao(S,M),k=WZ[o],L=o.length<=6;return fS.default.createElement(k,{ref:_,className:[P?"isDragging":"",l.boundsHighlighted&&L?"isHighlighted":""].join(" "),style:{cursor:UL[o]}})},Ng=qZ}),vf,$Z,XZ,nwe=A(()=>{vf=G(et()),twe(),$Z=o=>vf.default.createElement(vf.default.Fragment,null,vf.default.createElement(Ng,{which:"Bottom"}),vf.default.createElement(Ng,{which:"Top"}),vf.default.createElement(Ng,{which:"Left"}),vf.default.createElement(Ng,{which:"Right"}),vf.default.createElement(Ng,{which:"TopLeft"}),vf.default.createElement(Ng,{which:"TopRight"}),vf.default.createElement(Ng,{which:"BottomLeft"}),vf.default.createElement(Ng,{which:"BottomRight"})),XZ=$Z}),YC,YZ,KZ,ZZ,BL,QZ=A(()=>{os(),YC=G(et()),Jt(),Ky(),nwe(),KZ=ge.div(YZ||(YZ=X([`
  position: absolute;
  user-select: none;
  box-sizing: border-box;
  `,`;
  /* box-shadow: 1px 2px 10px -5px black; */

  z-index: 1000;
`])),Wi),ZZ=YC.default.forwardRef((o,l)=>{let u=Yy(),m=o,{style:_,children:S}=m,M=Y(m,["style","children"]);return YC.default.createElement(KZ,B(R({ref:l},M),{style:R({width:u.dims.width+"px",height:u.dims.height+"px",top:u.dims.top+"px",left:u.dims.left+"px"},_??{})}),YC.default.createElement(XZ,null),S)}),BL=ZZ}),rwe=ne((o,l)=>{(function(u,m){typeof o=="object"&&typeof l<"u"?m(o,et()):(u=typeof globalThis<"u"?globalThis:u||self,m(u.ReactErrorBoundary={},u.React))})(o,function(u,m){function _(j){if(j&&j.__esModule)return j;var K=Object.create(null);return j&&Object.keys(j).forEach(function(Q){if(Q!=="default"){var re=Object.getOwnPropertyDescriptor(j,Q);Object.defineProperty(K,Q,re.get?re:{enumerable:!0,get:function(){return j[Q]}})}}),K.default=j,Object.freeze(K)}var S=_(m);function M(j,K){return M=Object.setPrototypeOf||function(Q,re){return Q.__proto__=re,Q},M(j,K)}function P(j,K){j.prototype=Object.create(K.prototype),j.prototype.constructor=j,M(j,K)}var k=function(j,K){return j===void 0&&(j=[]),K===void 0&&(K=[]),j.length!==K.length||j.some(function(Q,re){return!Object.is(Q,K[re])})},L={error:null},z=function(j){P(K,j);function K(){for(var re,ae=arguments.length,ue=new Array(ae),ye=0;ye<ae;ye++)ue[ye]=arguments[ye];return re=j.call.apply(j,[this].concat(ue))||this,re.state=L,re.updatedWithError=!1,re.resetErrorBoundary=function(){for(var Ae,Ce=arguments.length,Se=new Array(Ce),ft=0;ft<Ce;ft++)Se[ft]=arguments[ft];re.props.onReset==null||(Ae=re.props).onReset.apply(Ae,Se),re.reset()},re}K.getDerivedStateFromError=function(re){return{error:re}};var Q=K.prototype;return Q.reset=function(){this.updatedWithError=!1,this.setState(L)},Q.componentDidCatch=function(re,ae){var ue,ye;(ue=(ye=this.props).onError)==null||ue.call(ye,re,ae)},Q.componentDidMount=function(){var re=this.state.error;re!==null&&(this.updatedWithError=!0)},Q.componentDidUpdate=function(re){var ae=this.state.error,ue=this.props.resetKeys;if(ae!==null&&!this.updatedWithError){this.updatedWithError=!0;return}if(ae!==null&&k(re.resetKeys,ue)){var ye,Ae;(ye=(Ae=this.props).onResetKeysChange)==null||ye.call(Ae,re.resetKeys,ue),this.reset()}},Q.render=function(){var re=this.state.error,ae=this.props,ue=ae.fallbackRender,ye=ae.FallbackComponent,Ae=ae.fallback;if(re!==null){var Ce={error:re,resetErrorBoundary:this.resetErrorBoundary};if(S.isValidElement(Ae))return Ae;if(typeof ue=="function")return ue(Ce);if(ye)return S.createElement(ye,Ce);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},K}(S.Component);function $(j,K){var Q=function(ae){return S.createElement(z,K,S.createElement(j,ae))},re=j.displayName||j.name||"Unknown";return Q.displayName="withErrorBoundary("+re+")",Q}function H(j){var K=S.useState(null),Q=K[0],re=K[1];if(j!=null)throw j;if(Q!=null)throw Q;return re}u.ErrorBoundary=z,u.useErrorHandler=H,u.withErrorBoundary=$,Object.defineProperty(u,"__esModule",{value:!0})})}),iwe=A(()=>{}),zL,VL,GL,JZ=A(()=>{zL=G(et()),VL={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},GL=zL.default.createContext&&zL.default.createContext(VL)});function eQ(o){return o&&o.map(function(l,u){return e7.default.createElement(l.tag,kg({key:u},l.attr),eQ(l.child))})}function Jy(o){return function(l){return e7.default.createElement(swe,kg({attr:kg({},o.attr)},l),eQ(o.child))}}function swe(o){var l=function(u){var m=o.attr,_=o.size,S=o.title,M=tQ(o,["attr","size","title"]),P=_||u.size||"1em",k;return u.className&&(k=u.className),o.className&&(k=(k?k+" ":"")+o.className),e7.default.createElement("svg",kg({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},u.attr,m,M,{className:k,style:kg(kg({color:o.color||u.color},u.style),o.style),height:P,width:P,xmlns:"http://www.w3.org/2000/svg"}),S&&e7.default.createElement("title",null,S),o.children)};return GL!==void 0?e7.default.createElement(GL.Consumer,null,function(u){return l(u)}):l(VL)}var e7,kg,tQ,owe=A(()=>{e7=G(et()),JZ(),kg=function(){return kg=Object.assign||function(o){for(var l,u=1,m=arguments.length;u<m;u++){l=arguments[u];for(var _ in l)Object.prototype.hasOwnProperty.call(l,_)&&(o[_]=l[_])}return o},kg.apply(this,arguments)},tQ=function(o,l){var u={};for(var m in o)Object.prototype.hasOwnProperty.call(o,m)&&l.indexOf(m)<0&&(u[m]=o[m]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,m=Object.getOwnPropertySymbols(o);_<m.length;_++)l.indexOf(m[_])<0&&Object.prototype.propertyIsEnumerable.call(o,m[_])&&(u[m[_]]=o[m[_]]);return u}}),xa=A(()=>{iwe(),owe(),JZ()}),awe=A(()=>{xa()}),lwe=A(()=>{xa()});function cwe(o){return Jy({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}}]})(o)}var uwe=A(()=>{xa()}),dwe=A(()=>{xa()}),hwe=A(()=>{xa()});function fwe(o){return Jy({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5 5-5z"}}]})(o)}function pwe(o){return Jy({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3l5 5z"}}]})(o)}var mwe=A(()=>{xa()}),gwe=A(()=>{xa()}),vwe=A(()=>{xa()}),ywe=A(()=>{xa()}),_we=A(()=>{xa()}),xwe=A(()=>{xa()}),bwe=A(()=>{xa()}),Swe=A(()=>{xa()}),wwe=A(()=>{xa()}),Twe=A(()=>{xa()});function Ewe(o){return Jy({attr:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"}}]})(o)}var Mwe=A(()=>{xa()}),Cwe=A(()=>{xa()}),Awe=A(()=>{xa()}),Pwe=A(()=>{xa()});function Rwe(o){return Jy({attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M6 9.65685L7.41421 11.0711L11.6569 6.82843L15.8995 11.0711L17.3137 9.65685L11.6569 4L6 9.65685Z",fill:"currentColor"}},{tag:"path",attr:{d:"M6 14.4433L7.41421 13.0291L11.6569 17.2717L15.8995 13.0291L17.3137 14.4433L11.6569 20.1001L6 14.4433Z",fill:"currentColor"}}]})(o)}var Iwe=A(()=>{xa()});function Nwe(o){return Jy({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M14 10.44l-.413.56H2.393L2 10.46 7.627 5h.827L14 10.44z"}}]})(o)}var kwe=A(()=>{xa()}),mS=A(()=>{awe(),lwe(),uwe(),dwe(),hwe(),mwe(),gwe(),vwe(),ywe(),_we(),xwe(),bwe(),Swe(),wwe(),Twe(),Mwe(),Cwe(),Awe(),Pwe(),Iwe(),kwe()}),m0,nQ,rQ,iQ,sQ,oQ,aQ,lQ,cQ,uQ,dQ,hQ,fQ,pQ,mQ,gQ,vQ,yQ,_Q,xQ,Dwe=A(()=>{m0=G(et()),Jt(),n9(),Ky(),wZ(),QZ(),nQ=G(rwe()),mS(),Ie(),n9(),Sr(),rQ={edges:{left:{from:"screenLeft",distance:.3},right:{from:"screenRight",distance:.3},top:{from:"screenTop",distance:.3},bottom:{from:"screenBottom",distance:.3}}},iQ={width:300,height:300},sQ=({paneInstance:o})=>m0.default.createElement(EL,{panelId:"pane-".concat(o.instanceId),defaultPosition:rQ,minDims:iQ},m0.default.createElement(_Q,{paneInstance:o})),aQ=ge(BL)(oQ||(oQ=X([`
  display: flex;
  flex-direction: column;

  box-shadow: 0px 5px 12px -4px rgb(0 0 0 / 22%);
  z-index: `,`;
`])),o=>o.$zIndex),cQ=ge.div(lQ||(lQ=X([`
  width: 100%;
`]))),dQ=ge.div(uQ||(uQ=X([`
  display: flex;
  align-items: center;
  opacity: 1;
  position: absolute;
  right: 4px;
  top: 0;
  bottom: 0;
`]))),fQ=ge.button(hQ||(hQ=X([`
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 2px;
  font-size: 11px;
  height: 10px;
  width: 18px;
  color: #adadadb3;
  background: transparent;
  border: none;
  cursor: pointer;
  &:hover {
    color: white;
  }
`]))),mQ=ge(sK)(pQ||(pQ=X([`
  position: relative;
  overflow: hidden;

  &:after {
    z-index: 10;
    position: absolute;
    inset: 0;
    display: block;
    content: ' ';
    pointer-events: none;

    #pointer-root:not(.normal) & {
      pointer-events: auto;
    }
  }
`]))),vQ=ge.div(gQ||(gQ=X([`
  padding: 12px;

  & > pre {
    border: 1px solid #ff62624f;
    background-color: rgb(255 0 0 / 5%);
    margin: 8px 0;
    padding: 8px;
    font-family: monospace;
    overflow: scroll;
    color: #ff9896;
  }
`]))),yQ=o=>m0.default.createElement(vQ,null,"An Error occurred rendering this pane. Open the console for more info.",m0.default.createElement("pre",null,JSON.stringify({message:o.error.message,stack:o.error.stack},null,2))),_Q=({paneInstance:o})=>{var l;let[u,m]=(0,m0.useState)(null),_=o.definition.mount;(0,m0.useLayoutEffect)(()=>{if(!u)return;let L=_({paneId:o.instanceId,node:u});if(typeof L=="function")return L},[u,_,o.instanceId]);let S=(0,m0.useCallback)(()=>{ce().paneManager.destroyPane(o.instanceId)},[o]),M=(0,m0.useCallback)(()=>{ce().paneManager.bringPaneToFront(o.instanceId)},[o]),P=((l=qr(ce().atomP.historic.paneFocusOrder))!=null?l:[]).indexOf(o.instanceId),k=P>=0?Cv.pluginPanes+P:Cv.pluginPanes;return m0.default.createElement(aQ,{"data-testid":"theatre-pane-wrapper-".concat(o.instanceId),$zIndex:k,onMouseDown:M},m0.default.createElement(NL,null,m0.default.createElement(BC,null,m0.default.createElement(dQ,null,m0.default.createElement(fQ,{onClick:S,title:"Close Pane"},m0.default.createElement(cwe,null))),m0.default.createElement(cQ,null,o.instanceId))),m0.default.createElement(nQ.ErrorBoundary,{FallbackComponent:yQ},m0.default.createElement(mQ,{"data-testid":"theatre-pane-content-".concat(o.instanceId),ref:m})))},xQ=sQ});function t7(o){return JSON.stringify(jL(o))}function jL(o){return Jp(o)?Object.keys(o).sort().reduce((l,u)=>(l[u]=jL(o[u]),l),{}):Array.isArray(o)?o.map(jL):o}var Owe=A(()=>{V0()}),bQ,n7,SQ=A(()=>{bQ="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",n7=(o=21)=>{let l="",u=o;for(;u--;)l+=bQ[Math.random()*64|0];return l}});function wQ(){return n7(10)}function Lwe(){return n7(10)}function TQ(){return n7(10)}function EQ(){return n7(10)}var g0,yf=A(()=>{Owe(),SQ(),g0={forSheet(){return"sheet"},forSheetObject(o){return t7({o:o.address.objectKey})},forSubSequence(o){return t7({ss:o})},forSheetObjectProp(o,l){return t7({o:o.address.objectKey,p:l})},forTrackKeyframe(o,l,u){return t7({o:o.address.objectKey,t:l,k:u})},forSheetObjectAggregateKeyframe(o,l){return g0.forCompoundPropAggregateKeyframe(o,[],l)},forSheetAggregateKeyframe(o,l){return t7({o:o.address.sheetId,pos:l})},forCompoundPropAggregateKeyframe(o,l,u){return t7({o:o.address.objectKey,p:l,pos:u})}}}),HL,WL,MQ=A(()=>{HL=an(),WL=(o,l)=>{let u=HL.prism.memo(o,()=>new HL.Atom(l),[]);return u.set(l),u}}),CQ,_f,Dg=A(()=>{Jt(),_f=id(CQ||(CQ=X([`
  font-weight: 300;
  font-size: 11px;
  color: `,`;
  text-shadow: 0.5px 0.5px 2px rgba(0, 0, 0, 0.3);
`])),o=>o.isHighlighted==="self"?"#CCC":"#919191")});function r7(o,l){let u=o;for(let m of l)u=u[m];return u}var gS=A(()=>{});function Fwe(){let o=0,l=new RQ.Atom({hasLock:!1});return{replaceLock(u,m){let _=o++,S=l.get();return S.hasLock&&S.cleanup(),l.set({hasLock:!0,lockId:_,cleanup:m,deepPath:Uwe(AQ(u))}),function(){let M=l.get();M.hasLock&&M.lockId===_&&(M.cleanup(),l.set({hasLock:!1}))}},getIsPropHighlightedD(u){let m=r7(l.pointer.deepPath,AQ(u));return(0,IQ.prism)(()=>{let _=(0,PQ.val)(m);return _===!0?"self":_?"descendent":null})}}}function AQ(o){return[o.projectId,o.sheetId,o.objectKey,...o.pathToProp]}function Uwe(o){let l={};return bo(l,o,!0),l}var PQ,RQ,IQ,NQ,Bwe=A(()=>{PQ=an(),RQ=an(),IQ=an(),gS(),Bo(),NQ=Fwe()});function qL(o,l){(0,kQ.useLayoutEffect)(()=>{if(!o||l.type!=="propWithChildren"&&l.type!=="primitiveProp"&&l.type!=="sheetObject")return;let u=null,m=B(R({},l.sheetObject.address),{pathToProp:l.type==="sheetObject"?[]:l.pathToProp});function _(){u=NQ.replaceLock(m,()=>{})}function S(){u==null||u()}return o.addEventListener("mouseenter",_),o.addEventListener("mouseleave",S),()=>{u==null||u(),o.removeEventListener("mouseenter",_),o.removeEventListener("mouseleave",S)}},[o])}var kQ,$L=A(()=>{kQ=G(et()),Bwe()});function XL(o){let[l,u]=(0,YL.useState)(null);return(0,YL.useLayoutEffect)(()=>(o&&u(o.getBoundingClientRect()),()=>{u(null)}),[o]),l}var YL,DQ=A(()=>{YL=G(et())}),vS,KC,OQ,LQ,FQ,UQ,BQ,zQ,VQ=A(()=>{Wy(),vS=G(et()),Jt(),KC=26,LQ=ge.li(OQ||(OQ=X([`
  height: `,`px;
  padding: 0 12px;
  margin: 0;
  display: flex;
  align-items: center;
  font-size: 11px;
  font-weight: 400;
  position: relative;
  color: `,`;
  cursor: `,`;

  &:after {
    position: absolute;
    inset: 2px 1px;
    display: block;
    content: ' ';
    pointer-events: none;
    z-index: -1;
    border-radius: 3px;
  }

  &:hover:after {
    background-color: `,`;
  }
`])),KC,o=>o.enabled?"white":"#8f8f8f",o=>o.enabled?"normal":"not-allowed",o=>o.enabled?"rgba(63, 174, 191, 0.75)":"initial"),UQ=ge.span(FQ||(FQ=X([""]))),BQ=o=>vS.default.createElement(LQ,{onClick:o.enabled?o.onClick:pf,enabled:o.enabled,title:o.enabled?void 0:"Disabled"},vS.default.createElement(UQ,null,vS.default.createElement(vS.default.Fragment,null,o.label))),zQ=BQ});function zwe(o){let l=(0,KL.useRef)(o);l.current=o,(0,KL.useEffect)(()=>{let u=m=>l.current(m);return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[])}var KL,Vwe=A(()=>{KL=G(et())}),yS,GQ,jQ,HQ,WQ,qQ,$Q,XQ,ZL,YQ=A(()=>{yS=G(et()),VQ(),Jt(),ff(),os(),GQ=190,jQ=!0,WQ=ge.ul(HQ||(HQ=X([`
  position: absolute;
  min-width: `,`px;
  z-index: 10000;
  background: `,`;
  backdrop-filter: blur(2px);
  color: white;
  list-style-type: none;
  padding: 2px 0;
  margin: 0;
  border-radius: 1px;
  cursor: default;
  `,`;
  border-radius: 3px;
`])),GQ,h1(.2,"#111"),Wi),$Q=ge.div(qQ||(qQ=X([`
  padding: 4px 10px;
  border-bottom: 1px solid #6262626d;
  color: #adadadb3;
  font-size: 11px;
  font-weight: 500;
`]))),XQ=yS.default.forwardRef((o,l)=>yS.default.createElement(WQ,{ref:l},jQ&&o.displayName?yS.default.createElement($Q,null,o.displayName):null,o.items.map((u,m)=>yS.default.createElement(zQ,{key:"item-".concat(m),label:u.label,enabled:u.enabled!==!1,onClick:_=>{u.callback&&u.callback(_),o.onRequestClose()}})))),ZL=XQ}),KQ,ZQ,ZC,QQ,_S,JQ,eJ,Gwe=A(()=>{DQ(),KQ=G(et()),ZQ=G(et()),ZC=G(et()),QQ=G(Cg()),SL(),VQ(),Mv(),Vwe(),YQ(),_S=20,JQ=o=>{let[l,u]=(0,ZC.useState)(null),m=XL(l),_=qC();(0,ZC.useLayoutEffect)(()=>{if(!m||!l)return;let P={left:m.width/2,top:KC/2+(o.displayName?KC:0)},k={left:o.clickPoint.clientX-P.left,top:o.clickPoint.clientY-P.top};k.left<0?k.left=0:k.left+m.width>_.width&&(k.left=_.width-m.width),k.top<0?k.top=0:k.top+m.height>_.height&&(k.top=_.height-m.height),l.style.left=k.left+"px",l.style.top=k.top+"px";let L=z=>{(z.clientX<k.left-_S||z.clientX>k.left+m.width+_S||z.clientY<k.top-_S||z.clientY>k.top+m.height+_S)&&o.onRequestClose()};return window.addEventListener("mousemove",L),()=>{window.removeEventListener("mousemove",L)}},[m,l,o.clickPoint,_,o.onRequestClose]);let S=(0,ZQ.useContext)(jy);zwe(P=>{P.key==="Escape"&&o.onRequestClose()});let M=(0,KQ.useMemo)(()=>{let P=Array.isArray(o.items)?o.items:o.items();return P.length>0?P:[{label:o.displayName?"No actions for ".concat(o.displayName):"No actions found",enabled:!1}]},[o.items]);return(0,QQ.createPortal)(ZC.default.createElement(ZL,{items:M,onRequestClose:o.onRequestClose,displayName:o.displayName,ref:u}),S)},eJ=JQ}),QC,tJ,nJ,jwe=A(()=>{QC=G(et()),tJ=(o,l)=>{let[u,m]=(0,QC.useState)({isOpen:!1}),_=(0,QC.useCallback)(()=>m({isOpen:!1}),[]);return(0,QC.useEffect)(()=>{if(!o||l.disabled===!0){m({isOpen:!1});return}let S=M=>{m({isOpen:!0,event:M}),M.preventDefault(),M.stopPropagation()};return o.addEventListener("contextmenu",S),()=>{o.removeEventListener("contextmenu",S)}},[o,l.disabled]),[u,_]},nJ=tJ}),rJ,iJ,sJ,Hwe=A(()=>{Jt(),iJ=ge.input.attrs({type:"checkbox"})(rJ||(rJ=X([`
  outline: none;
`]))),sJ=iJ});function Wwe({propConfig:o,editingTools:l,value:u,autoFocus:m}){let _=(0,QL.useCallback)(S=>{l.permanentlySetValue(!!S.target.checked)},[o,l]);return QL.default.createElement(aJ,{checked:u,onChange:_,autoFocus:m})}var QL,oJ,aJ,lJ,qwe=A(()=>{QL=G(et()),Jt(),Hwe(),aJ=ge(sJ)(oJ||(oJ=X([`
  margin-left: 6px;

  :focus {
    outline: 1px solid #555;
  }
`]))),lJ=Wwe});function JC(o){return l=>{o.forEach(u=>{typeof u=="function"?u(l):u!=null&&(u.current=l)})}}var eA=A(()=>{});function JL(o,l,u){(0,cJ.useEffect)(()=>{if(!o||u===!1)return;let m=Array.isArray(o)?o.filter(S=>S):[o],_=S=>{m.every(M=>!S.composedPath().includes(M))&&l(S)};return window.addEventListener("mousedown",_,{capture:!0,passive:!1}),()=>{window.removeEventListener("mousedown",_,{capture:!0,passive:!1})}},[o,u])}var cJ,eF=A(()=>{cJ=G(et())});function $we(o){return isNaN(o)?"NaN":jb(o)?o.toFixed(0):jr(o,3).toString()}var uJ,dJ,Og,hJ,tA,fJ,pJ,mJ,gJ,vJ,yJ,_J,xJ,i7,xS=A(()=>{V0(),uJ=G(et()),dJ=G(et()),Og=G(et()),Jt(),eA(),Ji(),eF(),oa(),tA=ge.div(hJ||(hJ=X([`
  height: 100%;
  width: 100%;
  position: relative;
  z-index: 0;
  box-sizing: border-box;
  display: flex;
  align-items: center;

  &:after {
    position: absolute;
    inset: 1px 0 2px;
    display: block;
    content: ' ';
    background-color: transparent;
    border: 1px solid transparent;
    z-index: -2;
    box-sizing: border-box;
    border-radius: 1px;
  }

  &:hover,
  &.dragging,
  &.editingViaKeyboard {
    &:after {
      background-color: #10101042;
      border-color: #00000059;
    }
  }
`]))),pJ=ge.input(fJ||(fJ=X([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: ew-resize;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;

  &:focus {
    cursor: text;
  }
`]))),gJ=ge.div(mJ||(mJ=X([`
  position: absolute;
  inset: 3px 2px 4px;
  transform: scale(var(--percentage), 1);
  transform-origin: top left;
  background-color: #2d5561;
  z-index: -1;
  border-radius: 2px;
  pointer-events: none;

  `,".dragging &, ",`.noFocus:hover & {
    background-color: #338198;
  }
`])),tA,tA),yJ=ge.div(vJ||(vJ=X([`
  display: contents;
`]))),_J=o=>!0,xJ=o=>{var l;let[u]=bi({mode:"noFocus"}),m=(l=o.isValid)!=null?l:_J,_=(0,Og.useRef)(o);_.current=o;let S=(0,Og.useRef)(null);JL(S.current,()=>{S.current.blur()},u.current.mode==="editingViaKeyboard");let M=(0,Og.useRef)(null),P=(0,Og.useMemo)(()=>{let re=ke=>{let be=ke.target,{value:Ue}=be,Ze=u.current;u.current=B(R({},Ze),{currentEditedValueInString:Ue});let ze=parseFloat(Ue);!isFinite(ze)||!m(ze)||_.current.temporarilySetValue(ze)},ae=()=>{u.current.mode==="editingViaKeyboard"&&(ue(),u.current={mode:"noFocus"}),o.onBlur&&o.onBlur()},ue=()=>{let ke=u.current,be=parseFloat(ke.currentEditedValueInString);!isFinite(be)||!m(be)||ke.valueBeforeEditing===be?_.current.discardTemporaryValue():_.current.permanentlySetValue(be)},ye=ke=>{ke.key==="Escape"?(_.current.discardTemporaryValue(),u.current={mode:"noFocus"},S.current.blur()):(ke.key==="Enter"||ke.key==="Tab")&&(ue(),S.current.blur())},Ae=ke=>{u.current.mode==="noFocus"&&(S.current.focus(),ke.preventDefault()),ke.stopPropagation()},Ce=()=>{u.current.mode==="noFocus"?Se():u.current.mode},Se=()=>{let ke=_.current.value;u.current={mode:"editingViaKeyboard",currentEditedValueInString:String(ke),valueBeforeEditing:ke},setTimeout(()=>{S.current.focus(),S.current.setSelectionRange(0,100)})},ft;return{inputChange:re,onBlur:ae,transitionToDraggingMode:()=>{var ke;let be=_.current.value;ft=(ke=S.current)==null?void 0:ke.getBoundingClientRect().width,u.current={mode:"dragging"};let Ue=be,Ze=be;return M.current=document.body.style.cursor,{onDrag(ze,Ft,Ke,Yt){let mt=Ke.altKey?Yt/10:Yt,nt=Ze+o.nudge({deltaX:mt,deltaFraction:mt/ft,magnitude:1});Ze=o.range?Zi(nt,o.range[0],o.range[1]):nt,_.current.temporarilySetValue(Ze)},onDragEnd(ze){ze?(Ue===Ze?_.current.discardTemporaryValue():_.current.permanentlySetValue(Ze),u.current={mode:"noFocus"}):(_.current.discardTemporaryValue(),u.current={mode:"noFocus"})},onClick(){S.current.focus(),S.current.setSelectionRange(0,100)}}},onInputKeyDown:ye,onClick:Ae,onFocus:Ce}},[]);(0,uJ.useEffect)(()=>()=>{P.onBlur()},[]);let k=u.current.mode!=="editingViaKeyboard"?$we(o.value):u.current.currentEditedValueInString;typeof k=="number"&&isNaN(k)&&(k="NaN");let L=[S];o.inputRef&&L.push(o.inputRef);let z=Og.default.createElement(pJ,{key:"input",type:"text",onChange:P.inputChange,value:k,onBlur:P.onBlur,onKeyDown:P.onInputKeyDown,onClick:P.onClick,onFocus:P.onFocus,ref:JC(L),onMouseDown:re=>{re.stopPropagation()},onDoubleClick:re=>{re.preventDefault(),re.stopPropagation()},autoFocus:o.autoFocus}),{range:$}=o,H=parseFloat(k),j=$?Og.default.createElement(gJ,{style:{"--percentage":Zi((H-$[0])/($[1]-$[0]),0,1)}}):null,[K,Q]=(0,dJ.useState)(null);return ao(K,{debugName:"form/BasicNumberInput",onDragStart:P.transitionToDraggingMode,lockCSSCursorTo:"ew-resize",shouldPointerLock:!0,disabled:u.current.mode==="editingViaKeyboard"}),Og.default.createElement(tA,{className:o.className+" "+u.current.mode},Og.default.createElement(yJ,{ref:Q},z),j)},i7=xJ});function Xwe({propConfig:o,editingTools:l,value:u,autoFocus:m}){let _=(0,tF.useCallback)(S=>o.nudgeFn(B(R({},S),{config:o})),[o]);return tF.default.createElement(i7,{value:u,temporarilySetValue:l.temporarilySetValue,discardTemporaryValue:l.discardTemporaryValue,permanentlySetValue:l.permanentlySetValue,range:o.range,nudge:_,autoFocus:m})}var tF,bJ,Ywe=A(()=>{xS(),tF=G(et()),bJ=Xwe});function Kwe({value:o,onChange:l,options:u,autoFocus:m}){let _=(0,bS.useCallback)(S=>{l(String(S.target.value))},[l]);return bS.default.createElement(nF,{role:"radiogroup"},Object.keys(u).map((S,M)=>bS.default.createElement(TJ,{key:"label-"+M,"data-checked":o===S},u[S],bS.default.createElement(MJ,{type:"radio",checked:o===S,value:S,onChange:_,name:"switchbox",autoFocus:m}))))}var bS,SJ,nF,wJ,TJ,EJ,MJ,CJ,Zwe=A(()=>{ff(),bS=G(et()),Jt(),nF=ge.form(SJ||(SJ=X([`
  display: flex;
  flex-direction: row;
  align-items: stretch;
  vertical-align: middle;
  justify-content: stretch;
  height: 24px;
  width: 100%;
`]))),TJ=ge.label(wJ||(wJ=X([`
  padding: 0 0.5em;
  background: transparent;
  /* background: #373748; */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-grow: 1;
  color: #a7a7a7;
  border: 1px solid transparent;
  box-sizing: border-box;
  border-right-width: 0px;

  & + &:last-child {
    border-right-width: 1px;
  }

  `,`:hover > & {
    border-color: #1c2123;
    /* background-color: #373748; */
    /* color: `,`; */
  }

  &&:hover {
    background-color: #464654;
  }

  &&[data-checked='true'] {
    color: white;
    background: #3f3f4c;
  }
`])),nF,VO(.1,"white")),MJ=ge.input(EJ||(EJ=X([`
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 0;
  height: 0;
`]))),CJ=Kwe});function Qwe({value:o,onChange:l,options:u,className:m,autoFocus:_}){let S=(0,Pv.useCallback)(M=>{l(String(M.target.value))},[l]);return Pv.default.createElement(PJ,null,Pv.default.createElement(kJ,{className:m,value:o,onChange:S,autoFocus:_},Object.keys(u).map((M,P)=>Pv.default.createElement("option",{key:"option-"+P,value:M},u[M]))),Pv.default.createElement(IJ,null,Pv.default.createElement(Rwe,null)))}var Pv,AJ,PJ,RJ,IJ,NJ,kJ,DJ,Jwe=A(()=>{Pv=G(et()),Jt(),mS(),PJ=ge.div(AJ||(AJ=X([`
  width: 100%;
  position: relative;
`]))),IJ=ge.div(RJ||(RJ=X([`
  position: absolute;
  right: 0px;
  top: 0;
  bottom: 0;
  width: 1.5em;
  font-size: 14px;
  display: flex;
  align-items: center;
  color: #6b7280;
  pointer-events: none;
`]))),kJ=ge.select(NJ||(NJ=X([`
  appearance: none;
  background-color: transparent;
  box-sizing: border-box;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.85);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  text-align: left;
  width: 100%;
  border-radius: 2px;
  /*
  looks like putting percentages in the height of a select box doesn't work in Firefox. Not sure why.
  So we're hard-coding the height to 26px, unlike all other inputs that use a relative height.
  */
  height: 26px /* calc(100% - 4px); */;

  @supports (-moz-appearance: none) {
    /* Ugly hack to remove the extra left padding that shows up only in Firefox */
    text-indent: -2px;
  }

  &:hover,
  &:focus {
    background-color: #10101042;
    border-color: #00000059;
  }
`]))),DJ=Qwe});function eTe({propConfig:o,editingTools:l,value:u,autoFocus:m}){let _=(0,nA.useCallback)(S=>{l.permanentlySetValue(S)},[o,l]);return o.as==="menu"?nA.default.createElement(DJ,{value:u,onChange:_,options:o.valuesAndLabels,autoFocus:m}):nA.default.createElement(CJ,{value:u,onChange:_,options:o.valuesAndLabels,autoFocus:m})}var nA,OJ,tTe=A(()=>{nA=G(et()),Zwe(),Jwe(),OJ=eTe}),LJ,SS,FJ,UJ,BJ,zJ,r9,s7=A(()=>{Jt(),LJ=G(et()),SS=G(et()),eA(),Ji(),eF(),UJ=ge.input.attrs({type:"text"})(FJ||(FJ=X([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;
  border: 1px solid transparent;
  box-sizing: border-box;

  &:hover {
    background-color: #10101042;
    border-color: #00000059;
  }

  &:hover,
  &:focus {
    cursor: text;
    background-color: #10101042;
    border-color: #00000059;
  }

  &.invalid {
    border-color: red;
  }
`]))),BJ=o=>!0,zJ=o=>{var l,u;let[m]=bi({mode:"noFocus"}),_=(l=o.isValid)!=null?l:BJ,S=(0,SS.useRef)(o);S.current=o;let M=(0,SS.useRef)(null);JL(M.current,()=>{M.current.blur()},m.current.mode==="editingViaKeyboard");let P=(0,SS.useMemo)(()=>{let z=ae=>{let ue=ae.target,{value:ye}=ue,Ae=m.current;m.current=B(R({},Ae),{currentEditedValueInString:ye}),_(ye)&&S.current.temporarilySetValue(ye)},$=()=>{var ae,ue;m.current.mode==="editingViaKeyboard"&&(H(),m.current={mode:"noFocus"}),(ue=(ae=S.current).onBlur)==null||ue.call(ae)},H=()=>{let ae=m.current,ue=ae.currentEditedValueInString;_(ue)?ae.valueBeforeEditing===ue?S.current.discardTemporaryValue():S.current.permanentlySetValue(ue):S.current.discardTemporaryValue()},j=ae=>{ae.key==="Escape"?(S.current.discardTemporaryValue(),m.current={mode:"noFocus"},M.current.blur()):(ae.key==="Enter"||ae.key==="Tab")&&(H(),M.current.blur())},K=ae=>{m.current.mode==="noFocus"&&(M.current.focus(),ae.preventDefault()),ae.stopPropagation()},Q=()=>{m.current.mode==="noFocus"?re():m.current.mode},re=()=>{let ae=S.current.value;m.current={mode:"editingViaKeyboard",currentEditedValueInString:String(ae),valueBeforeEditing:ae},setTimeout(()=>{M.current.focus()})};return{inputChange:z,onBlur:$,onInputKeyDown:j,onClick:K,onFocus:Q}},[]);(0,LJ.useEffect)(()=>()=>{P.onBlur()},[]);let k=m.current.mode!=="editingViaKeyboard"?o.value:m.current.currentEditedValueInString,L=[M];return o.inputRef&&L.push(o.inputRef),SS.default.createElement(UJ,{key:"input",type:"text",className:"".concat((u=o.className)!=null?u:""," ").concat(_(k)?"":"invalid"),onChange:P.inputChange,value:k,onBlur:P.onBlur,onKeyDown:P.onInputKeyDown,onClick:P.onClick,onFocus:P.onFocus,ref:JC(L),onMouseDown:z=>{z.stopPropagation()},onDoubleClick:z=>{z.preventDefault(),z.stopPropagation()},autoFocus:o.autoFocus})},r9=zJ});function nTe({editingTools:o,value:l,autoFocus:u}){return VJ.default.createElement(r9,{value:l,temporarilySetValue:o.temporarilySetValue,discardTemporaryValue:o.discardTemporaryValue,permanentlySetValue:o.permanentlySetValue,autoFocus:u})}var VJ,GJ,rTe=A(()=>{VJ=G(et()),s7(),GJ=nTe});function iTe(o){o=o.trim().toLowerCase();let l=o.match(sF);if(!l)return{r:0,g:0,b:0,a:1};let u=sTe(l[1]);return{r:parseInt(u.substr(0,2),16)/255,g:parseInt(u.substr(2,2),16)/255,b:parseInt(u.substr(4,2),16)/255,a:parseInt(u.substr(6,2),16)/255}}function rF(o,{removeAlphaIfOpaque:l=!1}={}){let u=(o.a*255|256).toString(16).slice(1),m=(o.r*255|256).toString(16).slice(1)+(o.g*255|256).toString(16).slice(1)+(o.b*255|256).toString(16).slice(1)+(l&&u==="ff"?"":u);return"#".concat(m)}function iF(o){return B(R({},o),{toString(){return rF(this,{removeAlphaIfOpaque:!0})}})}function sTe(o){switch(o.length){case 3:return"".concat(o.repeat(2),"ff");case 4:let l=o.substr(0,3),u=o[3];return"".concat(l.repeat(2)).concat(u.repeat(2));case 6:return"".concat(o,"ff")}return o}var sF,jJ=A(()=>{sF=/^#*([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i});function rA(o){let l=(0,oF.useRef)(o),u=(0,oF.useRef)(m=>{l.current&&l.current(m)});return l.current=o,u.current}var oF,HJ=A(()=>{oF=G(et())}),Rv,iA=A(()=>{Rv=(o,l=0,u=1)=>o>u?u:o<l?l:o}),wS,aF,WJ,lF,cF=A(()=>{wS=G(et()),aF=(0,wS.createContext)(void 0),WJ=({children:o})=>{let[l,u]=(0,wS.useState)(!1);return wS.default.createElement(aF.Provider,{value:{editing:l,setEditing:u}},o)},lF=()=>(0,wS.useContext)(aF)}),i9,o7,qJ,sA,uF,dF,$J,XJ,YJ,KJ,TS,oA=A(()=>{i9=G(et()),HJ(),iA(),Jt(),cF(),o7=o=>"touches"in o,qJ=(o,l)=>{for(let u=0;u<o.length;u++)if(o[u].identifier===l)return o[u];return o[0]},sA=o=>o&&o.ownerDocument.defaultView||self,uF=(o,l,u)=>{let m=o.getBoundingClientRect(),_=o7(l)?qJ(l.touches,u):l;return{left:Rv((_.pageX-(m.left+sA(o).pageXOffset))/m.width),top:Rv((_.pageY-(m.top+sA(o).pageYOffset))/m.height)}},dF=o=>{!o7(o)&&o.preventDefault()},$J=(o,l)=>l&&!o7(o),YJ=ge.div(XJ||(XJ=X([`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  outline: none;
  /* Don't trigger the default scrolling behavior when the event is originating from this element */
  touch-action: none;
`]))),KJ=o=>{var l=o,{onMove:u,onKey:m}=l,_=Y(l,["onMove","onKey"]);let S=(0,i9.useRef)(null),M=rA(u),P=rA(m),k=(0,i9.useRef)(null),L=(0,i9.useRef)(!1),{setEditing:z}=lF(),[$,H,j]=(0,i9.useMemo)(()=>{let K=({nativeEvent:ye})=>{let Ae=S.current;if(Ae&&(dF(ye),!($J(ye,L.current)||!Ae))){if(o7(ye)){L.current=!0;let Ce=ye.changedTouches||[];Ce.length&&(k.current=Ce[0].identifier)}Ae.focus(),z(!0),M(uF(Ae,ye,k.current)),ue(!0)}},Q=ye=>{dF(ye),(o7(ye)?ye.touches.length>0:ye.buttons>0)&&S.current?M(uF(S.current,ye,k.current)):(z(!1),ue(!1))},re=ye=>{z(!1),ue(!1)},ae=ye=>{let Ae=ye.which||ye.keyCode;Ae<37||Ae>40||(ye.preventDefault(),P({left:Ae===39?.05:Ae===37?-.05:0,top:Ae===40?.05:Ae===38?-.05:0}))};function ue(ye){let Ae=L.current,Ce=S.current,Se=sA(Ce),ft=ye?Se.addEventListener:Se.removeEventListener;ft(Ae?"touchmove":"mousemove",Q),ft(Ae?"touchend":"mouseup",re)}return[K,ae,ue]},[P,M]);return(0,i9.useEffect)(()=>j,[j]),i9.default.createElement(YJ,B(R({},_),{onTouchStart:$,onMouseDown:$,ref:S,onKeyDown:H,tabIndex:0,role:"slider"}))},TS=i9.default.memo(KJ)}),hF,ZJ,QJ,JJ,eee,tee,nee,aA,fF=A(()=>{hF=G(et()),Jt(),oA(),QJ=ge(TS)(ZJ||(ZJ=X([""]))),eee=ge.div(JJ||(JJ=X([`
  position: absolute;
  z-index: 1;
  box-sizing: border-box;
  width: 16px;
  height: 16px;
  transform: translate(-50%, -50%);
  background-color: #fff;
  border: 1px solid #ffffff00;
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);

  `,`:focus & {
    transform: translate(-50%, -50%) scale(1.1);
  }
`])),QJ),nee=ge.div(tee||(tee=X([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;
`]))),aA=({className:o,color:l,left:u,top:m=.5})=>{let _={top:"".concat(m*100,"%"),left:"".concat(u*100,"%")};return hF.default.createElement(eee,{style:_,className:o},hF.default.createElement(nee,{style:{backgroundColor:l}}))}}),Al,lA=A(()=>{Al=(o,l=0,u=Math.pow(10,l))=>Math.round(u*o)/u}),pF,cA,uA,ree,iee,dA=A(()=>{lA(),pF=({h:o,s:l,v:u,a:m})=>{let _=(200-l)*u/100;return{h:Al(o),s:Al(_>0&&_<200?l*u/100/(_<=100?_:200-_)*100:0),l:Al(_/2),a:Al(m,2)}},cA=o=>{let{h:l,s:u,l:m}=pF(o);return"hsl(".concat(l,", ").concat(u,"%, ").concat(m,"%)")},uA=o=>{let{h:l,s:u,l:m,a:_}=pF(o);return"hsla(".concat(l,", ").concat(u,"%, ").concat(m,"%, ").concat(_,")")},ree=({h:o,s:l,v:u,a:m})=>{o=o/360*6,l=l/100,u=u/100;let _=Math.floor(o),S=u*(1-l),M=u*(1-(o-_)*l),P=u*(1-(1-o+_)*l),k=_%6;return{r:Al([u,M,S,S,P,u][k]*255),g:Al([P,u,u,M,S,S][k]*255),b:Al([S,S,P,u,u,M][k]*255),a:Al(m,2)}},iee=({r:o,g:l,b:u,a:m})=>{let _=Math.max(o,l,u),S=_-Math.min(o,l,u),M=S?_===o?(l-u)/S:_===l?2+(u-o)/S:4+(o-l)/S:0;return{h:Al(60*(M<0?M+6:M)),s:Al(_?S/_*100:0),v:Al(_/255*100),a:m}}}),ES,see,oee,aee,lee,cee,uee,oTe=A(()=>{ES=G(et()),oA(),fF(),dA(),iA(),lA(),Jt(),oee=ge.div(see||(see=X([`
  position: relative;
  height: 16px;
  border-radius: 2px;

  background: linear-gradient(
    to right,
    #f00 0%,
    #ff0 17%,
    #0f0 33%,
    #0ff 50%,
    #00f 67%,
    #f0f 83%,
    #f00 100%
  );
`]))),lee=ge(aA)(aee||(aee=X([`
  z-index: 2;
`]))),cee=({className:o,hue:l,onChange:u})=>ES.default.createElement(oee,{className:o},ES.default.createElement(TS,{onMove:m=>{u({h:360*m.left})},onKey:m=>{u({h:Rv(l+m.left*360,0,360)})},"aria-label":"Hue","aria-valuetext":Al(l)},ES.default.createElement(lee,{left:l/360,color:cA({h:l,s:100,v:100,a:1})}))),uee=ES.default.memo(cee)}),MS,dee,hee,fee,pee,mee,gee,aTe=A(()=>{MS=G(et()),oA(),fF(),dA(),iA(),lA(),Jt(),hee=ge.div(dee||(dee=X([`
  position: relative;
  flex-grow: 1;
  border-color: transparent; /* Fixes https://github.com/omgovich/react-colorful/issues/139 */
  border-bottom: 12px solid #000;
  border-radius: 2px;
  background-image: linear-gradient(to top, #000, rgba(0, 0, 0, 0)),
    linear-gradient(to right, #fff, rgba(255, 255, 255, 0));

  // Improve elements rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),pee=ge(aA)(fee||(fee=X([`
  z-index: 3;
`]))),mee=({hsva:o,onChange:l})=>{let u=S=>{l({s:S.left*100,v:100-S.top*100})},m=S=>{l({s:Rv(o.s+S.left*100,0,100),v:Rv(o.v-S.top*100,0,100)})},_={backgroundColor:cA({h:o.h,s:100,v:100,a:1})};return MS.default.createElement(hee,{style:_},MS.default.createElement(TS,{onMove:u,onKey:m,"aria-label":"Color","aria-valuetext":"Saturation ".concat(Al(o.s),"%, Brightness ").concat(Al(o.v),"%")},MS.default.createElement(pee,{top:1-o.v/100,left:o.s/100,color:cA(o)})))},gee=MS.default.memo(mee)}),CS,vee,yee,_ee,xee,bee,See,wee,lTe=A(()=>{CS=G(et()),oA(),fF(),dA(),iA(),lA(),Jt(),yee=ge.div(vee||(vee=X([`
  position: relative;
  height: 16px;
  border-radius: 2px;
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),xee=ge.div.attrs(({colorFrom:o,colorTo:l})=>({style:{backgroundImage:"linear-gradient(90deg, ".concat(o,", ").concat(l,")")}}))(_ee||(_ee=X([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;

  // Improve rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),See=ge(aA)(bee||(bee=X([`
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),wee=({className:o,hsva:l,onChange:u})=>{let m=P=>{u({a:P.left})},_=P=>{u({a:Rv(l.a+P.left)})},S=uA(Object.assign({},l,{a:0})),M=uA(Object.assign({},l,{a:1}));return CS.default.createElement(yee,{className:o},CS.default.createElement(xee,{colorFrom:S,colorTo:M}),CS.default.createElement(TS,{onMove:m,onKey:_,"aria-label":"Alpha","aria-valuetext":"".concat(Al(l.a*100),"%")},CS.default.createElement(See,{left:l.a,color:uA(l)})))}}),hA,Tee=A(()=>{hA=(o,l)=>{if(o===l)return!0;for(let u in o)if(o[u]!==l[u])return!1;return!0}});function cTe(o,l,u,m){let{editing:_}=lF(),[S,M]=(0,Lg.useState)(l),P=rA(u),k=rA(m),L=_?S:l,[z,$]=(0,Lg.useState)(()=>o.toHsva(L)),H=(0,Lg.useRef)({color:L,hsva:z}),j=(0,Lg.useRef)({color:L,hsva:z});(0,Lg.useEffect)(()=>{_&&M(H.current.color)},[_]),(0,Lg.useEffect)(()=>{let Q=o.fromHsva(z);_?!hA(z,H.current.hsva)&&!o.equal(Q,H.current.color)&&(H.current={hsva:z,color:Q},M(Q),P(Q)):!hA(z,j.current.hsva)&&!o.equal(Q,j.current.color)&&(j.current={hsva:z,color:Q},H.current={hsva:z,color:Q},k(Q))},[_,z,o,P,k]),(0,Lg.useEffect)(()=>{if(!_&&!o.equal(L,j.current.color)){let Q=o.toHsva(L);j.current={hsva:Q,color:L},$(Q)}},[_,L,o]);let K=(0,Lg.useCallback)(Q=>{$(re=>Object.assign({},re,Q))},[]);return[z,K]}var Lg,uTe=A(()=>{Lg=G(et()),Tee(),HJ(),cF()}),a7,Eee,Mee,Cee,dTe=A(()=>{a7=G(et()),oTe(),aTe(),lTe(),uTe(),Jt(),Mee=ge.div(Eee||(Eee=X([`
  position: relative;
  display: flex;
  gap: 4px;
  flex-direction: column;
  width: 200px;
  height: 200px;
  user-select: none;
  cursor: default;
`]))),Cee=o=>{var l=o,{className:u,colorModel:m,color:_=m.defaultColor,temporarilySetValue:S,permanentlySetValue:M,discardTemporaryValue:P}=l,k=Y(l,["className","colorModel","color","temporarilySetValue","permanentlySetValue","discardTemporaryValue"]);let[L,z]=cTe(m,_,S,M);return(0,a7.useEffect)(()=>()=>{P()},[]),a7.default.createElement(Mee,R({},k),a7.default.createElement(gee,{hsva:L,onChange:z}),a7.default.createElement(uee,{hue:L.h,onChange:z}),a7.default.createElement(wee,{hsva:L,onChange:z}))}}),mF,Aee,Pee,Ree,Iee,hTe=A(()=>{mF=G(et()),dTe(),Tee(),dA(),cF(),Aee=o=>({r:o.r/255,g:o.g/255,b:o.b/255,a:o.a}),Pee=o=>({r:o.r*255,g:o.g*255,b:o.b*255,a:o.a}),Ree={defaultColor:{r:0,g:0,b:0,a:1},toHsva:o=>iee(Pee(o)),fromHsva:o=>Aee(ree(o)),equal:hA},Iee=o=>mF.default.createElement(WJ,null,mF.default.createElement(Cee,B(R({},o),{permanentlySetValue:l=>{o.permanentlySetValue(l)},colorModel:Ree})))}),fTe=A(()=>{hTe()}),Nee,kee,gF,Dee=A(()=>{Nee=G(et()),kee=(0,Nee.createContext)({}),gF=kee});function pTe(o,l,u){let m=_=>{let S=o.getBoundingClientRect();(_.clientX<S.left-l||_.clientX>S.left+S.width+l||_.clientY<S.top-l||_.clientY>S.top+S.height+l)&&u(_)};return window.addEventListener("mousemove",m),()=>{window.removeEventListener("mousemove",m)}}var mTe=A(()=>{}),Oee,fA,vF,Lee,yF,Fee=A(()=>{Oee=G(et()),fA=G(et()),SL(),DQ(),Dee(),Ji(),eF(),mTe(),Wy(),V0(),vF=8,Lee=o=>{var l,u;let m=o.children(),[_,S]=bi(null),M=m.props.style?R({},m.props.style):{};M.position="absolute";let P=XL(S),k=XL(o.target),L=qC(),[z,$]=(0,fA.useState)({});return(0,fA.useLayoutEffect)(()=>{var H,j,K;if(!P||!S||!k)return;let Q=(H=o.verticalGap)!=null?H:8,re={},ae=(j=o.verticalPlacement)!=null?j:"bottom",ue=0,ye=0;ae==="bottom"?k.bottom+P.height+Q<L.height?(ae="bottom",ue=k.bottom+Q,re.top="0px"):k.top>P.height+Q?(ae="top",ue=k.top-(P.height+Q),re.bottom="0px",re.transform="rotateZ(180deg)"):ae="overlay":ae==="top"&&(k.top>P.height+Q?(ae="top",ue=k.top-(P.height+Q),re.bottom="0px",re.transform="rotateZ(180deg)"):k.bottom+P.height+Q<L.height?(ae="bottom",ue=k.bottom+Q,re.top="0px"):ae="overlay");let Ae=0;if(ae!=="overlay"){let Ue=k.left+k.width/2;Ue<P.width/2?(ye=Q,Ae=Math.max(Ue-Q,vF)):Ue+P.width/2>L.width?(ye=L.width-(Q+P.width),Ae=Math.min(Ue-ye,P.width-vF)):(ye=Ue-P.width/2,Ae=P.width/2),re.left=Ae+"px"}let{minX:Ce=-1/0,maxX:Se=1/0,minY:ft=-1/0,maxY:ke=1/0}=(K=o.constraints)!=null?K:{},be={left:Zi(ye,Ce,Se-P.width),top:Zi(ue,ft,ke+P.height)};if(S.style.left=be.left+"px",S.style.top=be.top+"px",$(re),o.onPointerOutside)return pTe(S,o.onPointerOutside.threshold,o.onPointerOutside.callback)},[P,S,o.target,k,L,o.onPointerOutside]),JL([S,(l=o.target)!=null?l:null],(u=o.onClickOutside)!=null?u:pf),Oee.default.createElement(gF.Provider,{value:z},(0,fA.cloneElement)(m,{ref:_,style:M}))},yF=Lee});function su(o,l){let{isPointerBeingCaptured:u}=vZ("usePopover"),[m,_]=bi({isOpen:!1}),S=(0,Pl.useRef)(o),M=(0,Pl.useCallback)(H=>{m.current={isOpen:!1}},[]),P=(0,Pl.useCallback)((H,j)=>{var K;let Q=typeof S.current=="function"?S.current():S.current;function re(){L.childHasFocusRef.current||Q.closeOnClickOutside!==!1&&M("clicked outside popover")}m.current={isOpen:!0,clickPoint:{clientX:H.clientX,clientY:H.clientY},target:j,opts:Q,onClickOutside:re,onPointerOutside:Q.closeWhenPointerIsDistant===!1?void 0:{threshold:(K=Q.pointerDistanceThreshold)!=null?K:100,callback:()=>{L.childHasFocusRef.current||u()||M("pointer outside")}}}},[]),k=(0,Pl.useCallback)((...H)=>{m.current.isOpen?M("toggled"):P(...H)},[]),L=gTe({state:_}),[,z]=(0,Pl.useContext)(kF);(0,Pl.useEffect)(()=>{let H;return _.isOpen&&(H=z()),()=>H==null?void 0:H()},[_.isOpen]);let $=(0,Pl.useContext)(jy);return{node:_.isOpen?(0,Uee.createPortal)(Pl.default.createElement(_F.Provider,{value:L.childPopoverLock},Pl.default.createElement(yF,{children:l,target:_.target,onClickOutside:_.onClickOutside,onPointerOutside:_.onPointerOutside,constraints:_.opts.constraints,verticalGap:_.opts.verticalGap})),$):Pl.default.createElement(Pl.default.Fragment,null),open:P,close:M,toggle:k,isOpen:_.isOpen}}function gTe(o){let l=(0,Pl.useContext)(_F);(0,Pl.useEffect)(()=>{if(o.state.isOpen){let m=l.takeFocus();return()=>{m.releaseFocus()}}},[o.state.isOpen]);let u=(0,Pl.useRef)(!1);return{childHasFocusRef:u,childPopoverLock:{takeFocus(){return u.current=!0,{releaseFocus(){u.current=!1}}}}}}var Pl,Uee,_F,xf=A(()=>{PL(),Ji(),Pl=G(et()),Uee=G(Cg()),Mv(),Fee(),bne(),_F=Pl.default.createContext({takeFocus(){return{releaseFocus(){}}}})}),Fg,Bee,zee,Vee,Gee,jee,Hee,Wee,qee,$ee,Xee,Yee,Kee,vTe=A(()=>{Fg=G(et()),Jt(),Dee(),zee=ge.div(Bee||(Bee=X([`
  position: absolute;
  width: 0;
  height: 0;
  color: var(--popover-arrow-color);
  pointer-events: none;
`]))),Gee=ge.div(Vee||(Vee=X([`
  width: 12px;
  height: 8px;
  position: absolute;
  left: -7px;
  top: -8px;
  text-align: center;
  line-height: 0;
`]))),Hee=ge.path(jee||(jee=X([`
  fill: var(--popover-bg);
`]))),qee=ge.path(Wee||(Wee=X([`
  fill: var(--popover-inner-stroke);
`]))),Xee=ge.path($ee||($ee=X([`
  fill: var(--popover-outer-stroke);
`]))),Yee=(0,Fg.forwardRef)(({className:o},l)=>{let u=(0,Fg.useContext)(gF);return Fg.default.createElement(zee,{className:o,ref:l,style:R({},u)},Fg.default.createElement(Gee,null,Fg.default.createElement("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Fg.default.createElement(Xee,{d:"M6 0L0 6H12L6 0Z"}),Fg.default.createElement(qee,{d:"M6 1.5L0 7.5H12L6 1.5Z"}),Fg.default.createElement(Hee,{d:"M6 3L0 9H12L6 3Z"}))))}),Kee=Yee}),pA,xF,Zee,Qee,Jee,ou,bf=A(()=>{os(),ff(),pA=G(et()),Jt(),vTe(),xF=h1(.05,"#2a2a31"),Qee=ge.div(Zee||(Zee=X([`
  position: absolute;
  --popover-bg: `,`;
  --popover-inner-stroke: #505159;
  --popover-outer-stroke: #111;

  background: var(--popover-bg);

  color: white;
  padding: 0;
  margin: 0;
  cursor: default;
  `,`;
  border-radius: 3px;
  z-index: 10000;
  border: 1px solid var(--popover-inner-stroke);
  box-shadow: 0 0 0 1px var(--popover-outer-stroke), 0 6px 8px -4px black;
  backdrop-filter: blur(8px);

  & a {
    color: inherit;
  }
`])),xF,Wi),Jee=pA.default.forwardRef(({children:o,className:l,showPopoverEdgeTriangle:u=!0},m)=>pA.default.createElement(Qee,{className:l,ref:m},u?pA.default.createElement(Kee,null):void 0,o)),ou=Jee});function yTe({editingTools:o,value:l,autoFocus:u}){let m=(0,g1.useRef)(null),_=(0,g1.useCallback)(M=>{let P=iF(iTe(M));o.permanentlySetValue(P)},[o]),S=su({debugName:"RgbaPropEditor"},()=>g1.default.createElement(ate,null,g1.default.createElement(Iee,{color:{r:l.r,g:l.g,b:l.b,a:l.a},temporarilySetValue:M=>{let P=iF(M);o.temporarilySetValue(P)},permanentlySetValue:M=>{let P=iF(M);o.permanentlySetValue(P)},discardTemporaryValue:o.discardTemporaryValue})));return g1.default.createElement(g1.default.Fragment,null,g1.default.createElement(tte,null,g1.default.createElement(rte,{rgbaColor:l,ref:m,onClick:M=>{S.toggle(M,m.current)}}),g1.default.createElement(ste,{value:rF(l,{removeAlphaIfOpaque:!0}),temporarilySetValue:bF,discardTemporaryValue:bF,permanentlySetValue:_,isValid:M=>!!M.match(sF),autoFocus:u})),S.node)}var g1,ete,tte,nte,rte,ite,ste,bF,ote,ate,lte,_Te=A(()=>{jJ(),jJ(),g1=G(et()),fTe(),Jt(),xf(),s7(),bf(),tte=ge.div(ete||(ete=X([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),rte=ge.div.attrs(o=>({style:{background:rF(o.rgbaColor)}}))(nte||(nte=X([`
  height: 18px;
  aspect-ratio: 1;
  border-radius: 99999px;
`]))),ste=ge(r9)(ite||(ite=X([`
  flex: 1;
`]))),bF=()=>{},ate=ge.div(ote||(ote=X([`
  position: absolute;
  background-color: `,`;
  color: white;
  margin: 0;
  cursor: default;
  border-radius: 3px;
  z-index: 10000;
  backdrop-filter: blur(8px);

  padding: 4px;
  pointer-events: all;

  border: none;
  box-shadow: none;
`])),xF),lte=yTe});function xTe({propConfig:o,editingTools:l,value:u,autoFocus:m}){let[_,S]=Sf.default.useState();(0,Sf.useEffect)(()=>{S(u?l.getAssetUrl(u):void 0)},[u]);let M=(0,Sf.useCallback)(k=>De(this,null,function*(){let L=k.target.files[0];l.permanentlySetValue({type:"image",id:void 0});let z=yield l.createAsset(L);z?l.permanentlySetValue({type:"image",id:z}):l.permanentlySetValue(u),k.target.value=null}),[l,u]),P=!(u!=null&&u.id);return Sf.default.createElement(SF,{empty:P},Sf.default.createElement(mte,{empty:P,title:P?"Upload image":'"'.concat(u.id,'" (Click to upload new image)')},Sf.default.createElement(vte,{type:"file",onChange:M,accept:"image/*,.hdr",autoFocus:m}),_?Sf.default.createElement(_te,{src:_}):Sf.default.createElement(dte,null)),!P&&Sf.default.createElement(bte,{title:"Delete image",onClick:()=>{l.permanentlySetValue({type:"image",id:void 0})}},Sf.default.createElement(mL,null)))}var Sf,cte,SF,ute,dte,hte,fte,pte,mte,gte,vte,yte,_te,xte,bte,Ste,bTe=A(()=>{zC(),Sf=G(et()),Jt(),SF=ge.div(cte||(cte=X([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),dte=ge.div(ute||(ute=X([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),mte=ge.label(pte||(pte=X([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),o=>o.empty?id(hte||(hte=X([""]))):id(fte||(fte=X([""])))),vte=ge.input.attrs({type:"file"})(gte||(gte=X([`
  display: none;
`]))),_te=ge.img(yte||(yte=X([`
  position: absolute;
  inset: 0;
  height: 100%;
  aspect-ratio: 1;

  object-fit: cover;
`]))),bte=ge.button(xte||(xte=X([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),SF),Ste=xTe});function STe({propConfig:o,editingTools:l,value:u,autoFocus:m}){let[_,S]=wf.default.useState();(0,wf.useEffect)(()=>{S(u?l.getAssetUrl(u):void 0)},[u]);let M=(0,wf.useCallback)(k=>De(this,null,function*(){let L=k.target.files[0];l.permanentlySetValue({type:"file",id:void 0});let z=yield l.createAsset(L);z?l.permanentlySetValue({type:"file",id:z}):l.permanentlySetValue(u),k.target.value=null}),[l,u]),P=!(u!=null&&u.id);return wf.default.createElement(wF,{empty:P},wf.default.createElement(Pte,{empty:P,title:P?"Upload file":'"'.concat(u.id,'" (Click to upload new file)')},wf.default.createElement(Ite,{type:"file",onChange:M,autoFocus:m}),_?wf.default.createElement(fL,null):wf.default.createElement(Ete,null)),!P&&wf.default.createElement(kte,{title:"Delete file",onClick:()=>{l.permanentlySetValue({type:"file",id:void 0})}},wf.default.createElement(mL,null)))}var wf,wte,wF,Tte,Ete,Mte,Cte,Ate,Pte,Rte,Ite,Nte,kte,Dte,wTe=A(()=>{zC(),wf=G(et()),Jt(),wF=ge.div(wte||(wte=X([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),Ete=ge.div(Tte||(Tte=X([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),Pte=ge.label(Ate||(Ate=X([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),o=>o.empty?id(Mte||(Mte=X([""]))):id(Cte||(Cte=X([""])))),Ite=ge.input.attrs({type:"file"})(Rte||(Rte=X([`
  display: none;
`]))),kte=ge.button(Nte||(Nte=X([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),wF),Dte=STe}),TF,Ote=A(()=>{qwe(),Ywe(),tTe(),rTe(),_Te(),bTe(),wTe(),TF={number:bJ,string:GJ,boolean:lJ,stringLiteral:OJ,rgba:lte,image:Ste,file:Dte}});function mA(o){let l=new WeakMap;return u=>(l.has(u)||l.set(u,o(u)),l.get(u))}var EF=A(()=>{});function v1(o){return o.type==="compound"||o.type==="enum"}function l7(o,l){if(!o)return;let[u,...m]=l;if(u===void 0)return o;if(!v1(o))return;let _=o.type==="enum"?o.cases[u]:o.props[u];return l7(_,m)}function gA(o,l){let u=l.deserializeAndSanitize(o);return u===void 0?l.default:u}function TTe(o){return!v1(o)}function*c7(o,l){if(o.type==="compound")for(let u in o.props)yield*ot(c7(o.props[u],[...l,u]));else{if(o.type==="enum")throw new Error("Not implemented yet");return yield{path:l,conf:o}}}var MF,s9=A(()=>{EF(),MF=mA(o=>{if(o.type==="enum")throw new Error("Not implemented yet for enums");for(let l in o.props){let u=o.props[l];if(v1(u)){if(MF(u))return!0}else return!0}return!1})});function o9(o,l){return l.length===0?o:Zc(o,l)}var vA=A(()=>{bl()});function Lte(o,l){return o==null?null:o instanceof Element&&o.matches(l)?o:Lte(o.parentElement,l)}var ETe=A(()=>{});function MTe(o){let l=new _A.Atom(void 0),u=new _A.Atom({}),m=new _A.Atom({}),_=0;return{addRelatedFlags(S,M){let P=String(++_),k=M.map(L=>{let z={flag:L.flag},$=[L.affects,S,P];return m.setByPointer(H=>r7(H,$),z),$});return()=>{for(let L of k)m.setByPointer(z=>r7(z,L),void 0)}},usePresenceFlag(S){},setUserHover(S){let M=l.get();M!==S&&(M&&u.setByPointer(P=>P[M],!1),l.set(S),S&&u.setByPointer(P=>P[S],!0))}}}function u7(o){let l=yA.default.useContext(AF),u=l.usePresenceFlag(o);return{attrs:{[xA]:o},flag:u,useRelations(m,_){(0,CF.useEffect)(()=>o&&l.addRelatedFlags(o,m()),[o,..._])}}}function CTe(o){let l=yA.default.useContext(AF),u=Zy("PresenceListeners");(0,CF.useEffect)(()=>{let m;if(!o)return;let _=S=>{if(S.target instanceof Node){let M=Lte(S.target,"[".concat(xA,"]"));if(M){let P=M.getAttribute(xA);m!==P&&(m=P,l.setUserHover(P||void 0),u._debug("Updated current hover",{itemKey:P}));return}m!=null&&(m=null,l.setUserHover(void 0),u._debug("Cleared current hover"))}};return o.addEventListener("mouseover",_),()=>{o.removeEventListener("mouseover",_),m!=null&&(m=null,u._debug("Cleared current hover as part of cleanup"))}},[o,l])}var yA,CF,Fte,_A,Ute,AF,xA,AS=A(()=>{yA=G(et()),CF=G(et()),Av(),Fte=an(),_A=an(),Sr(),ETe(),gS(),Ute=(0,Fte.prism)(()=>{}),Ute.keepHot(),AF=yA.default.createContext(MTe()),xA="data-pi-key"}),G0,Bte,PS,zte,PF,a9,Vte,RF,Gte,jte,Hte,bA,Wte,qte,$te,Xte,Yte,Kte,RS,Zte,IF,SA=A(()=>{os(),ff(),G0=G(et()),Jt(),AS(),PS=ge.div(Bte||(Bte=X([`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 16px;
  margin: 0 0px 0 2px;
  position: relative;
  z-index: 0;
  opacity: 0.7;

  &:after {
    position: absolute;
    left: -14px;
    right: -14px;
    top: -2px;
    bottom: -2px;
    content: ' ';
    display: none;
    z-index: -1;
    background: `,`;
  }

  &:hover {
    opacity: 1;
    &:after {
      display: block;
    }
  }
`])),h1(.2,"black")),PF=ge.div(zte||(zte=X([`
  background: none;
  position: relative;
  border: 0;
  transition: transform 0.1s ease-out;
  z-index: 0;
  outline: none;
  cursor: pointer;

  &:after {
    display: none;
    `,`:hover & {
      display: block;
    }
    position: absolute;
    left: -4px;
    right: -4px;
    top: -4px;
    bottom: -4px;
    content: ' ';
    z-index: -1;
  }
`])),PS),a9={offColor:"#555",onColor:"#e0c917"},RF=ge(PF)(Vte||(Vte=X([`
  &:hover {
    color: #e0c917;
  }

  color: `,`;
`])),o=>o.presence===2?"white":o.isOn?a9.onColor:a9.offColor),jte=id(Gte||(Gte=X([`
  pointer-events: none !important;
`]))),bA=ge(PF)(Hte||(Hte=X([`
  color: `,`;

  `,`;
`])),o=>o.flag===2?"white":o.available?a9.onColor:a9.offColor,o=>o.available?Wi:jte),qte=ge(bA)(Wte||(Wte=X([`
  transform: translateX(2px);
  `,`:hover & {
    transform: translateX(-7px);
  }
`])),PS),Xte=ge(bA)($te||($te=X([`
  transform: translateX(-2px);
  `,`:hover & {
    transform: translateX(7px);
  }
`])),PS),(o=>{let l=ge.g(Yte||(Yte=X([`
    stroke-width: 1;
    `,`:hover & path {
      stroke-width: 3;
    }
  `])),bA);o.Prev=()=>G0.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G0.default.createElement(l,{transform:"translate(6 3)"},G0.default.createElement("path",{d:"M4 1L1 4L4 7",stroke:"currentColor"}))),o.Next=()=>G0.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G0.default.createElement(l,{transform:"translate(1 3)"},G0.default.createElement("path",{d:"M1 1L4 4L1 7",stroke:"currentColor"})));let u=ge.g(Kte||(Kte=X([`
    stroke-width: 0;
    `,`:hover & path {
      stroke: currentColor;
      stroke-width: 2;
    }
  `])),RF);o.Cur=()=>G0.default.createElement("svg",{width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G0.default.createElement(u,{transform:"translate(1 4)"},G0.default.createElement("path",{d:"M3 0L6 3L3 6L0 3L3 0Z",fill:"currentColor"})))})(RS||(RS={})),Zte=o=>{var l,u,m,_,S;let M=u7((l=o.prev)==null?void 0:l.itemKey),P=u7(((u=o.cur)==null?void 0:u.type)==="on"?o.cur.itemKey:void 0),k=u7((m=o.next)==null?void 0:m.itemKey);return G0.default.createElement(PS,null,G0.default.createElement(qte,R({available:!!o.prev,onClick:(_=o.prev)==null?void 0:_.jump,flag:M.flag},M.attrs),G0.default.createElement(RS.Prev,null)),G0.default.createElement(RF,R({isOn:o.cur.type==="on",onClick:o.cur.toggle,presence:P.flag},P.attrs),G0.default.createElement(RS.Cur,null)),G0.default.createElement(Xte,R({available:!!o.next,onClick:(S=o.next)==null?void 0:S.jump,flag:k.flag},k.attrs),G0.default.createElement(RS.Next,null)))},IF=Zte}),wA,IS,Qte,Jte,ene,tne,nne,rne,ine,NS,sne=A(()=>{ff(),wA=G(et()),Jt(),Ie(),SA(),s9(),IS={defaultState:{color:h1(.95,"#C4C4C4"),hoverColor:h1(.15,a9.onColor)},withStaticOverride:{color:h1(.85,"#C4C4C4"),hoverColor:h1(.15,a9.onColor)}},Jte=ge.div(Qte||(Qte=X([`
  width: 16px;
  margin: 0 0px 0 2px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  color: `,`;

  &:hover {
    color: `,`;
  }
`])),o=>o.hasStaticOverride?IS.withStaticOverride.color:IS.defaultState.color,o=>o.hasStaticOverride?IS.withStaticOverride.hoverColor:IS.defaultState.hoverColor),tne=ge.div(ene||(ene=X([`
  width: 5px;
  height: 5px;
  border-radius: 1px;
  transform: rotate(45deg);
  /* border: 1px solid currentColor; */
  background-color: currentColor;
`]))),rne=ge.div(nne||(nne=X([`
  width: 5px;
  height: 5px;
  background-color: currentColor;
  border-radius: 1px;
  transform: rotate(45deg);
`]))),ine=o=>{let{hasStaticOverride:l,obj:u,propConfig:m,pathToProp:_}=o;return wA.default.createElement(Jte,{hasStaticOverride:l,onClick:()=>{ce().transaction(({stateEditors:S})=>{for(let{path:M,conf:P}of c7(m,_)){if(v1(P))continue;let k=B(R({},u.address),{pathToProp:M});S.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(k,m)}})},title:"Sequence this prop"},l?wA.default.createElement(rne,{title:"The default value is overridden"}):wA.default.createElement(tne,{title:"This is the default value for this prop"}))},NS=ine});function one(o,l,u){if(!l||l.data.keyframes.length===0)return ane;let m=NF.get(l.data);if(m&&m[0]===u)return m[1];function _(M){if(!l)return;let P=l.data.keyframes[M];return P&&{kf:P,track:l,itemKey:g0.forTrackKeyframe(o,l.id,P.id)}}let S=(()=>{let M=l.data.keyframes.findIndex(k=>k.position>=u);if(M===-1)return{prev:_(l.data.keyframes.length-1)};let P=_(M);return P.kf.position===u?{prev:_(M-1),cur:P,next:_(M+1)}:{next:P,prev:_(M-1)}})();return NF.set(l.data,[u,S]),S}var NF,ane,lne=A(()=>{yf(),NF=new WeakMap,ane={}}),cne,ATe=A(()=>{cne={}});function une(o,l,u){let m=(0,rh.getPointerParts)(o).path;return ri(()=>{if(!MF(u))return{type:"AllStatic",beingScrubbed:!1,contextMenuItems:[],controlIndicators:Iv.default.createElement(NS,{hasStaticOverride:!1,obj:l,pathToProp:m,propConfig:u})};let _=!!(0,rh.val)(Zc(ce().atomP.ephemeral.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].stateByObjectKey[l.address.objectKey].valuesBeingScrubbed,(0,rh.getPointerParts)(o).path)),S=[],M={beingScrubbed:_,contextMenuItems:S,controlIndicators:Iv.default.createElement(Iv.default.Fragment,null)},P=(0,rh.val)(l.template.getMapOfValidSequenceTracks_forStudio()),k=o9(P,m),L=k!==void 0&&Object.keys(k).length!==0,z=[],$=(0,rh.val)(l.template.getStaticButNotSequencedOverrides()),H=o9($??cne,m)!==void 0;if(L)for(let j of c7(u,[])){if(v1(j.conf))continue;let K=o9(k,j.path);typeof K!="string"?H=!0:z.push(K)}if((H||L)&&S.push({label:"Reset all to default",callback:()=>{ce().transaction(({unset:j})=>{j(o)})}}),L&&S.push({label:"Make all static",callback:()=>{ce().transaction(({stateEditors:j})=>{for(let{path:K,conf:Q}of c7(u,[])){if(v1(Q))continue;let re=B(R({},l.address),{pathToProp:[...m,...K]}),ae=r7(o,K);j.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic(B(R({},re),{value:l.getValueByPointer(ae)}))}})}}),(!L||L&&H)&&S.push({label:"Sequence all",callback:()=>{ce().transaction(({stateEditors:j})=>{for(let{path:K,conf:Q}of c7(u,m)){if(v1(Q))continue;let re=B(R({},l.address),{pathToProp:K});j.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(re,u)}})}}),L){let j=rh.prism.memo("controlIndicators",()=>Iv.default.createElement(PTe,{pointerToProp:o,obj:l,possibleSequenceTrackIds:k,listOfDescendantTrackIds:z}),[k,z]);return B(R({},M),{type:"HasSequences",controlIndicators:j})}else return B(R({},M),{type:"AllStatic",controlIndicators:Iv.default.createElement(NS,{hasStaticOverride:H,obj:l,pathToProp:m,propConfig:u})})},[])}function PTe({pointerToProp:o,obj:l,possibleSequenceTrackIds:u,listOfDescendantTrackIds:m}){return ri(()=>{let _=(0,rh.getPointerParts)(o).path,S=(0,rh.val)(l.sheet.getSequence().positionPrism),M=m.map(j=>({trackId:j,track:(0,rh.val)(l.template.project.pointers.historic.sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[j])})).filter(({track:j})=>!!j).map(j=>B(R({},j),{nearbies:one(l,{id:j.trackId,data:j.track,sheetObject:l},S)})),P=M.find(({nearbies:j})=>!!j.cur),k=M.every(({nearbies:j})=>!!j.cur),L=M.reduce((j,K)=>K.nearbies.prev&&(j===void 0||K.nearbies.prev.kf.position>j.kf.position)?K.nearbies.prev:j,void 0),z=M.reduce((j,K)=>K.nearbies.next&&(j===void 0||K.nearbies.next.kf.position<j.kf.position)?K.nearbies.next:j,void 0),$=()=>{k?ce().transaction(j=>{j.unset(o)}):P?ce().transaction(j=>{j.set(o,(0,rh.val)(o))}):ce().transaction(j=>{j.set(o,(0,rh.val)(o))})},H={cur:P?{type:"on",itemKey:g0.forCompoundPropAggregateKeyframe(l,_,S),toggle:$}:{toggle:$,type:"off"},prev:L!==void 0?{position:L.kf.position,itemKey:g0.forCompoundPropAggregateKeyframe(l,_,L.kf.position),jump:()=>{l.sheet.getSequence().position=L.kf.position}}:void 0,next:z!==void 0?{position:z.kf.position,itemKey:g0.forCompoundPropAggregateKeyframe(l,_,z.kf.position),jump:()=>{l.sheet.getSequence().position=z.kf.position}}:void 0};return Iv.default.createElement(IF,R({},H))},[o,l,u,m])}var rh,Iv,dne=A(()=>{Ie(),vA(),Sr(),rh=an(),bl(),Iv=G(et()),sne(),s9(),yf(),gS(),SA(),lne(),ATe()});function RTe(o,l,u){return(0,Tf.prism)(()=>{var m;let _=(0,Tf.getPointerParts)(o).path,S=l.getValueByPointer(o),M=Tf.prism.memo("editPropValue",()=>{let K=null;return{temporarilySetValue(Q){K||(K=ce().scrub()),K.capture(re=>{re.set(o,Q)})},discardTemporaryValue(){K&&(K.discard(),K=null)},permanentlySetValue(Q){K?(K.capture(re=>{re.set(o,Q)}),K.commit(),K=null):ce().transaction(re=>{re.set(o,Q)})}}},[]),P={createAsset:K=>l.sheet.project.assetStorage.createAsset(K),getAssetUrl:K=>K.id?l.sheet.project.assetStorage.getAssetUrl(K.id):void 0},k=(0,Tf.val)(Zc(ce().atomP.ephemeral.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].stateByObjectKey[l.address.objectKey].valuesBeingScrubbed,(0,Tf.getPointerParts)(o).path))===!0,L=[],z=B(R(R({},M),P),{value:S,beingScrubbed:k,contextMenuItems:L,controlIndicators:d7.default.createElement(d7.default.Fragment,null)}),$=TTe(u);if($){let K=(0,Tf.val)(l.template.getMapOfValidSequenceTracks_forStudio()),Q=o9(K,_);if(typeof Q=="string"){L.push({label:"Make static",callback:()=>{ce().transaction(({stateEditors:Se})=>{let ft=B(R({},l.address),{pathToProp:_});Se.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic(B(R({},ft),{value:l.getValueByPointer(o)}))})}});let re=Q,ae=Tf.prism.sub("lcr",()=>{let Se=(0,Tf.val)(l.template.project.pointers.historic.sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[re]),ft=(0,Tf.val)(l.sheet.getSequence().positionPrism);return one(l,Se&&{data:Se,id:re,sheetObject:l},ft)},[re]),ue;z.beingScrubbed?ue="Sequenced_OnKeyframe_BeingScrubbed":ae.cur?ue="Sequenced_OnKeyframe":((m=ae.prev)==null?void 0:m.kf.connectedRight)===!0?ue="Sequenced_BeingInterpolated":ue="Sequened_NotBeingInterpolated";let ye=()=>{ae.cur?ce().transaction(Se=>{Se.unset(o)}):ce().transaction(Se=>{Se.set(o,z.value)})},Ae={cur:ae.cur?{type:"on",itemKey:ae.cur.itemKey,toggle:ye}:{type:"off",toggle:ye},prev:ae.prev!==void 0?{itemKey:ae.prev.itemKey,position:ae.prev.kf.position,jump:()=>{l.sheet.getSequence().position=ae.prev.kf.position}}:void 0,next:ae.next!==void 0?{itemKey:ae.next.itemKey,position:ae.next.kf.position,jump:()=>{l.sheet.getSequence().position=ae.next.kf.position}}:void 0},Ce=d7.default.createElement(IF,R({},Ae));return B(R({},z),{type:"Sequenced",shade:ue,nearbyKeyframes:ae,controlIndicators:Ce})}}let H=(0,Tf.val)(l.template.getStaticValues()),j=o9(H,_);return typeof j<"u"&&L.push({label:"Reset to default",callback:()=>{ce().transaction(({unset:K})=>{K(o)})}}),$&&L.push({label:"Sequence",callback:()=>{ce().transaction(({stateEditors:K})=>{let Q=B(R({},l.address),{pathToProp:_});K.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(Q,u)})}}),typeof j<"u"?B(R({},z),{type:"Static",shade:z.beingScrubbed?"Static_BeingScrubbed":"Static",controlIndicators:d7.default.createElement(NS,{hasStaticOverride:!0,obj:l,pathToProp:_,propConfig:u})}):B(R({},z),{type:"Default",shade:"Default",controlIndicators:d7.default.createElement(NS,{hasStaticOverride:!0,obj:l,pathToProp:_,propConfig:u})})})}function ITe(o,l,u){if(TA.has(o))return TA.get(o);{let m=RTe(o,l,u);return TA.set(o,m),m}}function NTe(o,l,u){let m=ITe(o,l,u);return W$(m)}var d7,Tf,TA,kTe=A(()=>{bl(),d7=G(et()),Tf=an(),Ie(),vA(),Sr(),s9(),sne(),lne(),SA(),TA=new WeakMap});function DTe(o){return EA.has(o)||EA.set(o,(hne++).toString()),EA.get(o)}var EA,hne,OTe=A(()=>{EA=new WeakMap,hne=0}),fne,h7,pne,mne,gne,vne,yne,kF,_ne,xne,bne=A(()=>{Sr(),fne=G(et()),Jt(),$t(),n9(),os(),h7=an(),pne="32px",ge.div(mne||(mne=X([`
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  position: fixed;
  right: 8px;
  top: 50px;
  // Temporary, see comment about CSS grid in SingleRowPropEditor.
  width: 280px;
  height: fit-content;
  z-index: `,`;

  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border-radius: 2px;

  display: `,`;

  &:hover {
    display: block;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Wi,Cv.propsPanel,({pin:o})=>o?"block":"none"),ge.div(gne||(gne=X([`
  margin: 0 10px;
  color: #919191;
  font-weight: 500;
  font-size: 10px;
  user-select: none;
  `,`;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`])),Wi),ge.div(vne||(vne=X([`
  height: `,`;
  display: flex;
  align-items: center;
`])),pne),ge.div(yne||(yne=X([`
  `,`;
  max-height: calc(100vh - 100px);
  overflow-y: scroll;
  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
  padding: 0;
  user-select: none;

  /* Set the font-size for input values in the detail panel */
  font-size: 12px;
`])),Wi),kF=(0,fne.createContext)([!1,()=>()=>{}]),_ne=new h7.Atom(!1),xne=new h7.Atom(!1),(0,h7.prism)(()=>{let o=(0,h7.val)(xne.prism),l=(0,h7.val)(_ne.prism);return o||l})});function Rl(o,l){let[u,m]=nJ(o,l),[,_]=(0,f7.useContext)(kF);return(0,f7.useEffect)(()=>{var S;let M;return u.isOpen&&((S=l.onOpen)==null||S.call(l),M=_()),()=>M==null?void 0:M()},[u.isOpen,l.onOpen]),[u.isOpen?f7.default.createElement(eJ,{items:l.menuItems,displayName:l.displayName,clickPoint:u.event,onRequestClose:m}):Sne,m,u.isOpen]}var f7,Sne,Il=A(()=>{f7=G(et()),Gwe(),jwe(),bne(),Sne=f7.default.createElement(f7.default.Fragment,null)}),Ug,wne,DF,Tne,MA,Ene,OF,Mne,Cne,Ane,Pne,Rne,Ine,Nne,kne,Dne,LF,CA=A(()=>{os(),Ug=G(et()),mS(),Jt(),Dg(),$L(),Il(),DF=ge.li(wne||(wne=X([`
  --depth: `,`;
  margin: 0;
  padding: 0;
  list-style: none;
`])),o=>o.depth-1),MA=ge.div(Tne||(Tne=X([`
  border-bottom: 1px solid #7695b705;
`]))),OF=ge(MA)(Ene||(Ene=X([`
  padding-left: calc(var(--depth) * 10px);

  display: flex;
  align-items: stretch;
  color: `,`;

  box-sizing: border-box;

  `,`;
`])),Hy.panel.body.compoudThing.label.color,o=>o.isSelected&&"background: blue"),Cne=ge.span(Mne||(Mne=X([`
  `,`;
  overflow-x: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding-right: 4px;
  line-height: 26px;
  flex-wrap: nowrap;
  width: 100%;

  `,`:hover & {
    color: #ccc;
  }
`])),_f,OF),Pne=ge.span(Ane||(Ane=X([`
  color: #6a9955;
  font-size: 12px;
  margin-right: auto;
  margin-left: 8px;
  opacity: 0.8;
  font-weight: normal;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`]))),Ine=ge.span(Rne||(Rne=X([`
  width: 12px;
  padding: 8px;
  font-size: 9px;
  display: flex;
  align-items: center;

  transition: transform 0.05s ease-out, color 0.1s ease-out;
  transform: rotateZ(`,`deg);
  color: #66686a;

  &:hover {
    transform: rotateZ(`,`deg);
    color: #c0c4c9;
  }
`])),o=>o.isCollapsed?0:90,o=>o.isCollapsed?15:75),kne=ge.ul(Nne||(Nne=X([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),Dne=({leaf:o,label:l,children:u,isSelectable:m,isSelected:_,toggleSelect:S,toggleCollapsed:M,isCollapsed:P,valueDisplay:k,contextMenuItems:L})=>{let z=Array.isArray(u)&&u.length>0,$=(0,Ug.useRef)(null);qL($.current,o);let[H]=Rl($.current,{menuItems:L??[]});return o.shouldRender?Ug.default.createElement(DF,{depth:o.depth},H,Ug.default.createElement(OF,{ref:$,style:{height:o.nodeHeight+"px"},isSelectable:m===!0,isSelected:_===!0,onClick:S,isEven:o.n%2===0},Ug.default.createElement(Ine,{isCollapsed:P,onClick:M},Ug.default.createElement(Ewe,null)),Ug.default.createElement(Cne,{onClick:M},l),k&&Ug.default.createElement(Pne,null,k)),z&&Ug.default.createElement(kne,null,u)):null},LF=Dne});function LTe(o,l){if(o.length!==l.length)return!1;for(let u=0;u<o.length;u++)if(o[u]!==l[u])return!1;return!0}function FF(o){var l;let u=[];for(;;){let m=u.length,_=(l=o[0])==null?void 0:l[m];if(_===void 0)return u;for(let S of o)if(_!==S[m])return u;u.push(_)}}var Ef,UF,l9=A(()=>{EF(),Ef=mA(o=>JSON.stringify(o)),UF=o=>JSON.parse(o)});function FTe(o,l){let u=(0,BF.useRef)({combo:o,listener:l});u.current={combo:o,listener:l},(0,BF.useEffect)(()=>{function m(M){M.key===u.current.combo&&u.current.listener({down:!0,event:M})}function _(M){M.key===u.current.combo&&u.current.listener({down:!1,event:M})}function S(M){u.current.listener({down:!1,event:void 0})}return document.addEventListener("keydown",m),document.addEventListener("keyup",_),window.addEventListener("blur",S),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",_),window.removeEventListener("blur",S)}},[])}var BF,UTe=A(()=>{BF=G(et())});function One(o){let[l,u]=(0,Lne.useState)(!1);return FTe(o,({down:m})=>{u(m)}),l}var Lne,Fne=A(()=>{Lne=G(et()),UTe()});function BTe(o){let l=(0,zF.useMemo)(()=>new Une.Atom(o),[]);return(0,zF.useLayoutEffect)(()=>{l.set(o)},[o]),l}var Une,zF,zTe=A(()=>{Une=an(),zF=G(et())});function Bne(o,l,u){let m=(0,VF.pointer)({root:{},path:[]}),_=l(m);bo(o,(0,VF.getPointerParts)(_).path,u)}var VF,VTe=A(()=>{VF=an(),Bo()}),AA,zne,Nl,Mf=A(()=>{AA="data-pos",zne={checkIfMouseEventSnapToPos(o,l){let u=o.composedPath().find(m=>m instanceof Element&&m!==(l==null?void 0:l.ignore)&&m.hasAttribute(AA));if(u){let m=parseFloat(u.getAttribute(AA));if(isFinite(m))return m}return null},includePositionSnapAttrs(o){return{[AA]:o}}},Nl=zne});function PA(o){let l=o.type==="sheet"?jTe(o):GF(o);return{byPosition:GTe(l),tracks:l}}function GTe(o){let l=new Map;for(let u of o)for(let m of u.data.keyframes){let _=l.get(m.position);_||(_=[],l.set(m.position,_)),_.push({kf:m,track:u,itemKey:g0.forTrackKeyframe(u.sheetObject,u.id,m.id)})}return l}function jTe(o){return o.children.filter(l=>l.type==="sheetObject").flatMap(GF)}function GF(o){return o.children.flatMap(l=>l.type==="propWithChildren"?GF(l):HTe(l))}function HTe(o){let l=o.sheetObject,u=l.address.projectId,m=ce().atomP.historic.coreByProject[u].sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey],_=(0,jF.val)(m.trackIdByPropPath[Ef(o.pathToProp)]);if(!_)return[];let S=(0,jF.val)(m.trackData[_]);return S?[{id:_,data:S,sheetObject:l}]:[]}var jF,RA=A(()=>{Ie(),jF=an(),yf(),l9()});function WTe(o,l){let[u,m]=bi(null),_=Zy("useCaptureSelection");return ao(l,(0,p7.useMemo)(()=>({debugName:"DopeSheetSelectionView/useCaptureSelection",dontBlockMouseDown:!0,lockCSSCursorTo:"cell",onDragStart(S){if(!S.shiftKey||S.target instanceof HTMLInputElement)return!1;let M=l.getBoundingClientRect(),P=S.clientX-M.left-(0,ih.val)(o.scaledSpace.leftPadding),k=(0,ih.val)(o.scaledSpace.toUnitSpace)(P);return u.current={h:[k,k],v:[S.clientY-M.top,S.clientY-M.top]},(0,ih.val)(o.selectionAtom).set({current:void 0}),{onDrag(L,z,$){let H=l.getBoundingClientRect(),j=$.clientX-H.left-(0,ih.val)(o.scaledSpace.leftPadding),K=(0,ih.val)(o.scaledSpace.toUnitSpace)(j);u.current={h:[u.current.h[0],K],v:[u.current.v[0],$.clientY-H.top]};let Q=HF.boundsToSelection(_,(0,ih.val)(o),u.current);(0,ih.val)(o.selectionAtom).set({current:Q})},onDragEnd(L){u.current=null}}}}),[o,l,u])),m}var ih,p7,Nv,Vne,Gne,jne,HF,Hne,Wne,WF,qne,$ne,qTe=A(()=>{Ie(),oa(),Fne(),zTe(),VTe(),Ji(),Sr(),ih=an(),p7=G(et()),Jt(),Mf(),RA(),Av(),Nv=5,Gne=ge.div(Vne||(Vne=X([`
  cursor: `,`;
`])),o=>o.isShiftDown?"cell":"default"),jne=({layoutP:o,children:l,height:u})=>{let[m,_]=bi(null),S=One("Shift"),M=WTe(o,_),P=(0,p7.useRef)(M);return P.current=M,p7.default.createElement(Gne,{style:{height:u+"px"},ref:m,isShiftDown:S,className:"selectionview"},M&&p7.default.createElement(qne,{state:M,layoutP:o}),l)},(o=>{let l=(M,P,k,L,z)=>{let $=PA(k);if(k.top+k.nodeHeight/2+Nv>L.v[0]&&k.top+k.nodeHeight/2-Nv<L.v[1])for(let[H,j]of $.byPosition){let K=P.scaledSpace.toUnitSpace(Nv);if(!(H+K<=L.h[0]||H-K>=L.h[1]))for(let Q of j)Bne(z,re=>re[Q.track.sheetObject.address.objectKey].byTrackId[Q.track.id].byKeyframeId[Q.kf.id],!0)}m(M,P,k,L,z)},u={sheet(M,P,k,L,z){l(M,P,k,L,z)},propWithChildren(M,P,k,L,z){l(M,P,k,L,z)},sheetObject(M,P,k,L,z){l(M,P,k,L,z)},primitiveProp(M,P,k,L,z){let{sheetObject:$,trackId:H}=k;if(!H)return;let j=(0,ih.val)(ce().atomP.historic.coreByProject[$.address.projectId].sheetsById[$.address.sheetId].sequence.tracksByObject[$.address.objectKey].trackData[H]);if(!(L.v[0]>k.top+k.nodeHeight/2+Nv||k.top+k.nodeHeight/2-Nv>L.v[1]))for(let K of j.keyframes){let Q=P.scaledSpace.toUnitSpace(Nv);if(!(K.position+Q<=L.h[0])){if(K.position-Q>=L.h[1])break;Bne(z,re=>re[$.address.objectKey].byTrackId[H].byKeyframeId[K.id],!0)}}}},m=(M,P,k,L,z)=>{if("children"in k)for(let $ of k.children)_(M,P,$,L,z)};function _(M,P,k,L,z){if(!k.shouldRender){m(M,P,k,L,z);return}if(L.v[0]>k.top+k.heightIncludingChildren||k.top>L.v[1])return;let $=u[k.type];$?$(M,P,k,L,z):m(M,P,k,L,z)}function S(M,P,k){let L={};k=WF(k);let z=P.tree;_(M.utilFor.internal(),P,z,k,L);let $=P.tree.sheet;return{type:"DopeSheetSelection",byObjectKey:L,getDragHandlers(H){return{debugName:"DopeSheetSelectionView/boundsToSelection",onDragStart(){let j,K=P.scaledSpace.toUnitSpace;return{onDrag(Q,re,ae){j&&(j.discard(),j=void 0);let ue=Nl.checkIfMouseEventSnapToPos(ae,{ignore:H.domNode}),ye=ue!=null?ue-H.positionAtStartOfDrag:K(Q);j=ce().tempTransaction(({stateEditors:Ae})=>{let Ce=Ae.coreByProject.historic.sheetsById.sequence.transformKeyframes;for(let Se of Object.keys(L)){let{byTrackId:ft}=L[Se];for(let ke of Object.keys(ft)){let{byKeyframeId:be}=ft[ke];Ce({trackId:ke,keyframeIds:Object.keys(be),translate:ye,scale:1,origin:0,snappingFunction:$.getSequence().closestGridPosition,objectKey:Se,projectId:H.projectId,sheetId:H.sheetId})}}})},onDragEnd(Q){Q?j==null||j.commit():j==null||j.discard()}}}}},delete(){ce().transaction(({stateEditors:H})=>{let j=H.coreByProject.historic.sheetsById.sequence.deleteKeyframes;for(let K of Object.keys(L)){let{byTrackId:Q}=L[K];for(let re of Object.keys(Q)){let{byKeyframeId:ae}=Q[re];j(B(R({},$.address),{objectKey:K,trackId:re,keyframeIds:Object.keys(ae)}))}}})}}}o.boundsToSelection=S})(HF||(HF={})),Wne=ge.div(Hne||(Hne=X([`
  position: absolute;
  background: rgba(255, 255, 255, 0.1);
  border: 1px dashed rgba(255, 255, 255, 0.4);
  box-sizing: border-box;
`]))),WF=o=>({h:[...o.h].sort((l,u)=>l-u),v:[...o.v].sort((l,u)=>l-u)}),qne=({state:o,layoutP:l})=>{let u=BTe(o);return ri(()=>{let m=(0,ih.val)(u.pointer),_=WF(m),S=(0,ih.val)(l.scaledSpace.fromUnitSpace),M=(0,ih.val)(l.scaledSpace.leftPadding),P=_.h.map(S).map(H=>H+M),k=_.v[0],L=_.v[1]-_.v[0],z=P[0],$=P[1]-P[0];return p7.default.createElement(Wne,{style:{top:k+"px",height:L+"px",left:z+"px",width:$+"px"}})},[l,u])},$ne=jne}),sd,Xne,Yne,Kne,qF,$F,XF,Zne,Qne,Jne,IA=A(()=>{Wy(),sd=G(et()),Jt(),M1(),Xne=an(),Kne=ge.div(Yne||(Yne=X([`
  position: absolute;
  top: 30px;
  right: 0;
  left: 0;
  bottom: 0;
  overflow-x: hidden;
  overflow-y: scroll;
  z-index: `,`;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
`])),()=>Rf.scrollableArea),qF=(0,sd.createContext)(pf),$F=(0,sd.createContext)(null),XF=()=>(0,sd.useContext)($F),Zne=()=>(0,sd.useContext)(qF),Qne=o=>{let l=(0,sd.useRef)(null),u=(0,sd.useCallback)(S=>{l.current.scrollBy(0,S.deltaY)},[]),m=(0,sd.useMemo)(()=>new Xne.Atom({scrollTop:0,clientHeight:0}),[]),_=(0,sd.useCallback)(()=>{l.current&&m.set({scrollTop:l.current.scrollTop,clientHeight:l.current.clientHeight})},[m]);return(0,sd.useLayoutEffect)(()=>{l.current&&m.set({scrollTop:l.current.scrollTop,clientHeight:l.current.clientHeight});let S=l.current;if(!S)return;let M=new ResizeObserver(()=>{m.set({scrollTop:S.scrollTop,clientHeight:S.clientHeight})});return M.observe(S),()=>M.disconnect()},[m]),sd.default.createElement($F.Provider,{value:m.pointer},sd.default.createElement(qF.Provider,{value:u},sd.default.createElement(Kne,{ref:l,onScroll:_,id:"VerticalScrollContainer"},o.children)))},Jne=Qne}),YF,ere=A(()=>{YF='data:image/svg+xml,<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">%0D%0A  <path d="M1 7V1H7" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A  <path d="M7 33H1L1 27" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A  <path d="M33 27V33H27" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A  <path d="M27 1L33 1V7" stroke="%2374FFDE" stroke-width="0.25" />%0D%0A</svg>'}),Cf,NA=A(()=>{Cf=(o,l=o)=>`
  left: `.concat(o*-.5,`px;
  top: `).concat(l*-.5,`px;
  width: `).concat(o,`px;
  height: `).concat(l,`px;
`)}),kA,tre,nre,$Te=A(()=>{kA=an(),tre=(0,kA.prism)(()=>{let[o,l]=kA.prism.state("pos",null);return kA.prism.effect("setupListeners",()=>{let u=m=>{l(m)};return document.addEventListener("mousemove",u),()=>{document.removeEventListener("mousemove",u)}},[]),o}),nre=tre}),Bg,bc,kS,rre,ire,sre,KF,y1,_1,DA,ore,are,$a=A(()=>{Bg=an(),$Te(),V0(),bc=G(et()),kS=(0,bc.createContext)(null),rre=0,ire=({children:o,layoutP:l})=>{let u=(0,bc.useMemo)(()=>new Bg.Atom([]),[]),m=(0,bc.useMemo)(()=>(0,Bg.prism)(()=>{let M=Bg.prism.memo("p",()=>ore(l),[l]).getValue(),P=(0,Bg.val)(u.pointer);return P.length>0?Mg(P).position:M}),[l]),_=(0,bc.useCallback)(()=>{let M=rre++;return u.reduce(P=>[...P,{id:M,position:[-1,0]}]),{set:P=>{u.reduce(k=>{let L=k.findIndex($=>$.id===M);if(L===-1)return console.warn("Lock is already freed. This is a bug."),k;let z=[...k];return z.splice(L,1,{id:M,position:[P,P===-1?0:1]}),z})},unlock:()=>{u.reduce(P=>P.filter(k=>k.id!==M))}}},[]),S={currentD:m,getLock:_};return bc.default.createElement(kS.Provider,{value:S},o)},sre=()=>(0,bc.useContext)(kS).currentD,KF=()=>{let{getLock:o}=(0,bc.useContext)(kS),l=(0,bc.useRef)();return(0,bc.useLayoutEffect)(()=>()=>{var u;(u=l.current)==null||u.unlock()},[]),(0,bc.useMemo)(()=>{let u;return(m,_)=>{var S,M;(u==null?void 0:u.shouldLock)!==m&&(m?l.current=o():(S=l.current)==null||S.unlock()),(u==null?void 0:u.pos)!==_&&m&&((M=l.current)==null||M.set(_)),u={shouldLock:m,pos:_}}},[o])},y1=(o,l)=>{let{getLock:u}=(0,bc.useContext)(kS),m=(0,bc.useRef)();(0,bc.useLayoutEffect)(()=>{if(o)return m.current=u(),()=>{m.current.unlock()}},[o,u]),(0,bc.useLayoutEffect)(()=>{o&&m.current.set(l)},[l,o])},_1=o=>({[DA]:o==="hide"?o:o.toFixed(3)}),DA="data-theatre-lock-framestamp-to",ore=o=>(0,Bg.prism)(()=>{let l=(0,Bg.val)(o.rightDims),u=(0,Bg.val)(o.clippedSpace.toUnitSpace),m=(0,Bg.val)(nre);if(!m)return[-1,0];for(let z of m.composedPath()){if(!(z instanceof HTMLElement||z instanceof SVGElement))break;if(z.hasAttribute(DA)){let $=z.getAttribute(DA);if(typeof $!="string")continue;if($==="hide")return[-1,0];let H=parseFloat($);if(isFinite(H)&&H>=0)return[H,2]}}let{clientX:_,clientY:S}=m,{screenX:M,screenY:P,width:k,height:L}=l;if(Vb(_,M,M+k)&&Vb(S,P+16,P+L)){let z=_-M;return[u(z),3]}else return[-1,0]}),are=ire}),lre,DS,ZF,cre,ure,Sc,QF=A(()=>{os(),Cl(),Jt(),ere(),NA(),Mf(),$a(),lre=12,DS=34,ZF="beingDragged",Sc={BEING_DRAGGED_CLASS:ZF,CSS:id(cre||(cre=X([`
    position: absolute;
    `,`;
    `,`;

    &.`,` {
      pointer-events: none !important;
    }
  `])),Cf(lre),Wi,ZF),CSS_WHEN_SOMETHING_DRAGGING:id(ure||(ure=X([`
    pointer-events: auto;
    cursor: var(`,`);

    //  thing
    // This box extends the hitzone so the user does not
    // accidentally leave the hitzone
    &:hover:after {
      position: absolute;
      top: calc(50% - `,`px);
      left: calc(50% - `,`px);
      width: `,`px;
      height: `,`px;
      display: block;
      content: ' ';
      background: url(`,`) no-repeat 100% 100%;
      // This icon might also fit: GiConvergenceTarget
    }
  `])),mf,DS/2,DS/2,DS,DS,YF),reactProps(o){return B(R(R({},_1(o.position)),Nl.includePositionSnapAttrs(o.position)),{className:o.isDragging?Sc.BEING_DRAGGED_CLASS:""})}}});function OA(){OS.set({mode:"snapToAll"})}function m7(){OS.set({mode:"snapToNone"})}function XTe(o){OS.set({mode:"snapToSome",positions:o})}function YTe(o,l){return Object.fromEntries(Object.entries(o).map(([u,m])=>[u,Object.fromEntries(Object.entries(m.trackData).map(([_,S])=>[_,S.keyframes.filter(M=>l(M,{trackId:_,trackData:S,objectKey:u})).map(M=>M.position)]))]))}var dre,hre,JF,fre,pre,mre,gre,vre,eU,OS,yre,g7=A(()=>{dre=an(),hre=an(),JF=G(et()),Jt(),QF(),pre=ge.div(fre||(fre=X([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  #pointer-root.draggingPositionInSequenceEditor & {
    `,`
  }
`])),Sc.CSS,Sc.CSS_WHEN_SOMETHING_DRAGGING),gre=ge.div(mre||(mre=X([`
  position: absolute;
`]))),vre=o=>JF.default.createElement(gre,{style:{top:"".concat(o.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,hre.val)(o.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(o.position,"px))")}},JF.default.createElement(pre,R({},Sc.reactProps({isDragging:!1,position:o.position})))),eU=vre,OS=new dre.Atom({mode:"snapToNone"}),yre=OS.prism});function KTe(o,l){let u=(0,kv.useMemo)(()=>({debugName:"HorizontallyScrollableArea",onDragStart(_){if(_.target instanceof HTMLInputElement||_.shiftKey||_.altKey||_.ctrlKey||_.metaKey||_.composedPath().some($=>$ instanceof HTMLElement&&$.draggable===!0))return!1;let S=_.clientX-l.getBoundingClientRect().left,M=Zi((0,zo.val)(o.clippedSpace.toUnitSpace)(S),0,1/0),P=(0,zo.val)(o.seeker.setIsSeeking),k=(0,zo.val)(o.sheet).getSequence();k.position=M;let L=M,z=(0,zo.val)(o.scaledSpace.toUnitSpace);return P(!0),OA(),{onDrag($,H,j){let K=z($),Q=Zi(L+K,0,k.length),re=Nl.checkIfMouseEventSnapToPos(j,{});re!=null&&(Q=re),k.position=Q},onDragEnd(){P(!1),m7()}}}}),[o,l]),[m]=ao(l,u);iu(m,"draggingPositionInSequenceEditor","ew-resize")}function ZTe(o,l){let u=Zne();(0,kv.useLayoutEffect)(()=>{if(!l)return;let m=S=>{if(S.ctrlKey){S.preventDefault(),S.stopPropagation();let M=S.clientX-l.getBoundingClientRect().left,P=(0,zo.val)(o.clippedSpace.toUnitSpace)(M),k=(0,zo.val)(o.clippedSpace.range),L=1+tU(S.deltaY,[-50,50])*.03,z=lf(k,j=>(j-P)*L+P),$=(0,zo.val)(o.sheet).getSequence().length,H=$+$*.25;(0,zo.val)(o.clippedSpace.setRange)(QTe(z,[0,H]));return}else if(S.shiftKey){S.preventDefault(),S.stopPropagation();let M=(0,zo.val)(o.sheet).getSequence().length,P=(0,zo.val)(o.clippedSpace.range),k=(P.end-P.start)/M,L=tU(S.deltaY||S.deltaX,[-50,50])*.05*k,z=lf(P,$=>$+L);(0,zo.val)(o.clippedSpace.setRange)(z);return}else{u(S),S.preventDefault(),S.stopPropagation();let M=(0,zo.val)(o.scaledSpace.toUnitSpace)(S.deltaX*1),P=(0,zo.val)(o.clippedSpace.range),k=lf(P,L=>L+M);(0,zo.val)(o.clippedSpace.setRange)(k);return}},_={capture:!0,passive:!1};return l.addEventListener("wheel",m,_),()=>{l.removeEventListener("wheel",m,_)}},[l,o]),ao(l,(0,kv.useMemo)(()=>({onDragStart(m){let _=(0,zo.val)(o.clippedSpace.range),S=(0,zo.val)(o.clippedSpace.setRange),M=(0,zo.val)(o.scaledSpace.toUnitSpace);return m.preventDefault(),m.stopPropagation(),{onDrag(P,k,L,z,$){u({deltaY:-$});let H=-M(P),j=lf(_,K=>K+H);S(j)}}},debugName:"HorizontallyScrollableArea Middle Button Drag",buttons:[1],lockCSSCursorTo:"grabbing"}),[o]))}function tU(o,[l,u]){return Math.max(Math.min(o,u),l)}function QTe(o,l){return lf(o,u=>tU(u,l))}function JTe(o,l){(0,kv.useLayoutEffect)(()=>{if(!l)return;let u=(0,zo.prism)(()=>{let M=(0,zo.val)(o.clippedSpace.range);return(0,zo.val)(o.scaledSpace.fromUnitSpace)(M.start)}),m=()=>{let M=u.getValue();l.scrollLeft=M},_=u.onStale(m);m();let S=setTimeout(m,100);return()=>{clearTimeout(S),_()}},[o,l])}var zo,kv,_re,xre,bre,LA,nU=A(()=>{oa(),Ji(),Sr(),zo=an(),V0(),kv=G(et()),Jt(),IA(),os(),Cl(),Mf(),g7(),xre=ge.div(_re||(_re=X([`
  position: absolute;
  right: 0;
  overflow-x: scroll;
  overflow-y: hidden;
  `,`;

  // hide the scrollbar on Gecko
  scrollbar-width: none;

  // hide the scrollbar on Webkit/Blink
  &::-webkit-scrollbar {
    display: none;
  }
`])),Wi),bre=kv.default.memo(({layoutP:o,children:l,height:u})=>{let{width:m,unitSpaceToScaledSpaceMultiplier:_}=ri(()=>({width:(0,zo.val)(o.rightDims.width),unitSpaceToScaledSpaceMultiplier:(0,zo.val)(o.scaledSpace.fromUnitSpace)(1)}),[o]),[S,M]=bi(null);return ZTe(o,M),KTe(o,M),JTe(o,M),kv.default.createElement(xre,{ref:S,style:{width:m+"px",height:u+"px","--unitSpaceToScaledSpaceMultiplier":_}},l)}),LA=bre}),FA,Sre,wre,Tre,Ere,Mre,Cre,Are,Dv,UA=A(()=>{FA=G(et()),Jt(),wre=ge.li(Sre||(Sre=X([`
  margin: 0;
  padding: 0;
  list-style: none;
  box-sizing: border-box;
  position: relative;
`]))),Ere=ge.div(Tre||(Tre=X([`
  box-sizing: border-box;
  width: 100%;
  position: relative;

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -40px;
    top: 0;
    bottom: 0;
    right: 0;
    box-sizing: border-box;
    border-bottom: 1px solid #252b3869;
    background: `,`;
  }
`])),o=>o.isEven?"transparent":"#6b8fb505"),Cre=ge.ul(Mre||(Mre=X([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),Are=({leaf:o,children:l,node:u,isCollapsed:m})=>{let _=Array.isArray(l)&&l.length>0;return o.shouldRender?FA.default.createElement(wre,null,FA.default.createElement(Ere,{style:{height:o.nodeHeight+"px"},isEven:o.n%2===0},u),_&&FA.default.createElement(Cre,null,l)):null},Dv=Are}),eEe=ne((o,l)=>{(function(){var u=this,m={};typeof o<"u"?l.exports=m:u.fuzzy=m,m.simpleFilter=function(_,S){return S.filter(function(M){return m.test(_,M)})},m.test=function(_,S){return m.match(_,S)!==null},m.match=function(_,S,M){M=M||{};var P=0,k=[],L=S.length,z=0,$=0,H=M.pre||"",j=M.post||"",K=M.caseSensitive&&S||S.toLowerCase(),Q;_=M.caseSensitive&&_||_.toLowerCase();for(var re=0;re<L;re++)Q=S[re],K[re]===_[P]?(Q=H+Q+j,P+=1,$+=1+$):$=0,z+=$,k[k.length]=Q;return P===_.length?(z=K===_?1/0:z,{rendered:k.join(""),score:z}):null},m.filter=function(_,S,M){return!S||S.length===0?[]:typeof _!="string"?S:(M=M||{},S.reduce(function(P,k,L,z){var $=k;M.extract&&($=M.extract(k));var H=m.match(_,$,M);return H!=null&&(P[P.length]={string:H.rendered,score:H.score,index:L,original:k}),P},[]).sort(function(P,k){var L=k.score-P.score;return L||P.index-k.index}))}})()});function tEe(o,l){let[u,m]=(0,BA.useState)(!1),_=(0,BA.useRef)(l);return u||(_.current=l),(0,BA.useMemo)(()=>o(m),_.current)}var BA,nEe=A(()=>{BA=G(et())}),rU,c9,zA=A(()=>{rU="rgba(26, 28, 30, 0.97);",c9="#272B2F"});function Pre(o,l,u,m){let _=tEe(S=>({debugName:"CurveSegmentEditor/useKeyframeDrag",lockCSSCursorTo:"move",onDragStart(){return S(!0),{onDrag(M,P){o&&u.onCurveChange(m(M,P))},onDragEnd(M){S(!1),u.onCancelCurveChange()}}}}),[o,u.onCurveChange,u.onCancelCurveChange]);ao(l,_)}var qi,VA,LS,v7,Rre,FS,Ire,GA,Nre,kre,Dre,y7,Ore,Ov,Lre,Fre,iU,Ure,jA,Bre,sU,zre,Vre,rEe=A(()=>{qi=G(et()),oa(),Ji(),nf(),Jt(),os(),nEe(),zA(),VA=.12,LS=1+VA*2,v7=.01,Rre=8,FS=(1-v7)/(Rre-1),Ire="#3EAAA4",GA="#3EAAA4",Nre="#3EAAA4",kre="#3EAAA4",Dre="#3EAAA4",y7="#3EAAA4",Ore="#3EAAA4",Ov="#B3B3B3",Lre="#3eaaa4",Fre="#67dfd8",iU=["goldenrod","cornflowerblue","dodgerblue","lawngreen"],jA=ge.circle(Ure||(Ure=X([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.04px;
  pointer-events: none;
  transition: r 0.15s;
  fill: `,`;
`])),Lre),sU=ge.circle(Bre||(Bre=X([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.09px;
  cursor: move;
  `,`;
  &:hover {
    opacity: 0.4;
  }
  &:hover + `,` {
    fill: `,`;
  }
`])),Wi,jA,Fre),zre=o=>{let{curveConnection:{left:l,right:u},backgroundConnections:m}=o,_=Math.min(0,1-u.handles[1],1-l.handles[3]),S=Math.max(1,1-u.handles[1],1-l.handles[3]),M=Math.max(1,S-_),P=ae=>(ae-_)/M,[k,L]=bi(null),z=LS/((L==null?void 0:L.clientWidth)||1),$=LS/((L==null?void 0:L.clientHeight)||1),[H,j]=bi(null);Pre(L,j,o,(ae,ue)=>{let ye=Zi(l.handles[2]+ae*z,0,1),Ae=l.handles[3]-ue*$;return[ye,Ae,u.handles[0],u.handles[1]]});let[K,Q]=bi(null);Pre(L,Q,o,(ae,ue)=>{let ye=Zi(u.handles[0]+ae*z,0,1),Ae=u.handles[1]-ue*$;return[l.handles[2],l.handles[3],ye,Ae]});let re=ae=>"M0 ".concat(P(1)," C").concat(ae.left.handles[2]," ").concat(P(1-ae.left.handles[3])," ").concat(ae.right.handles[0]," ").concat(P(1-ae.right.handles[1])," 1 ").concat(P(0));return qi.default.createElement("svg",{height:"100%",width:"100%",ref:k,viewBox:"".concat(-VA," ").concat(-VA," ").concat(LS," ").concat(LS),xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",fill:"none"},qi.default.createElement("linearGradient",{id:"myGradient",gradientTransform:"rotate(90)"},qi.default.createElement("stop",{offset:P(-1),stopColor:Ore}),qi.default.createElement("stop",{offset:P(0),stopColor:y7}),qi.default.createElement("stop",{offset:P(.3),stopColor:Dre}),qi.default.createElement("stop",{offset:P(.5),stopColor:kre}),qi.default.createElement("stop",{offset:P(.7),stopColor:Nre}),qi.default.createElement("stop",{offset:P(1),stopColor:GA}),qi.default.createElement("stop",{offset:P(2),stopColor:Ire})),qi.default.createElement("pattern",{id:"dot-background-pattern-1",width:FS,height:FS/M,y:-_/M},qi.default.createElement("rect",{width:v7,height:v7,fill:Ov,opacity:.3})),qi.default.createElement("rect",{x:0,y:0,width:"1",height:1,fill:"url(#dot-background-pattern-1)"}),qi.default.createElement("pattern",{id:"dot-background-pattern-2",width:FS,height:FS},qi.default.createElement("rect",{width:v7,height:v7,fill:Ov})),qi.default.createElement("rect",{x:0,y:P(0),width:"1",height:P(1)-P(0),fill:"url(#dot-background-pattern-2)"}),!l.type||l.type==="bezier"?qi.default.createElement(qi.default.Fragment,null,qi.default.createElement("line",{x1:0,y1:P(1),x2:l.handles[2],y2:P(1-l.handles[3]),stroke:Ov,strokeWidth:"0.01"}),qi.default.createElement("line",{x1:1,y1:P(0),x2:u.handles[0],y2:P(1-u.handles[1]),stroke:Ov,strokeWidth:"0.01"}),qi.default.createElement("path",{d:re(o.curveConnection),stroke:"none",fill:"url('#myGradient')",opacity:"0.1"}),m.map((ae,ue)=>qi.default.createElement("path",{key:ae.objectKey+"/"+ae.left.id,d:re(ae),stroke:iU[ue%iU.length],opacity:.6,strokeWidth:"0.01"})),qi.default.createElement("path",{d:re(o.curveConnection),stroke:"url('#myGradient')",strokeWidth:"0.02"}),qi.default.createElement("circle",{cx:0,cy:P(1),r:"0.025",stroke:GA,strokeWidth:"0.02",fill:c9}),qi.default.createElement("circle",{cx:1,cy:P(0),r:"0.025",stroke:y7,strokeWidth:"0.02",fill:c9}),qi.default.createElement(sU,{ref:H,cx:l.handles[2],cy:P(1-l.handles[3]),fill:GA,opacity:.2}),qi.default.createElement(jA,{cx:l.handles[2],cy:P(1-l.handles[3])}),qi.default.createElement(sU,{ref:K,cx:u.handles[0],cy:P(1-u.handles[1]),fill:y7,opacity:.2}),qi.default.createElement(jA,{cx:u.handles[0],cy:P(1-u.handles[1])})):qi.default.createElement(qi.default.Fragment,null,qi.default.createElement("line",{x1:0,y1:P(1),x2:1,y2:P(1),stroke:Ov,strokeWidth:"0.01"}),qi.default.createElement("line",{x1:1,y1:P(1),x2:1,y2:0,stroke:Ov,strokeWidth:"0.01"}),qi.default.createElement("circle",{cx:0,cy:1,r:"0.025",stroke:y7,strokeWidth:"0.02",fill:c9}),qi.default.createElement("circle",{cx:1,cy:0,r:"0.025",stroke:y7,strokeWidth:"0.02",fill:c9})))},Vre=zre}),Gre,zg,oU,jre,Hre,Wre,qre,$re=A(()=>{Gre=an(),Ji(),zg=G(et()),oU=(0,zg.createContext)(null),jre=0,Hre=()=>{let o=(0,zg.useMemo)(()=>jre++,[]),{cur:l,set:u}=(0,zg.useContext)(oU),[m,_]=bi(!1),S=(0,zg.useCallback)((M,P)=>{u(M?o:-1,P)},[]);return(0,zg.useEffect)(()=>l.onStale(()=>{let M=l.getValue()===o;m.current!==M&&(m.current=M)}),[l,o]),[_,S]},Wre=({children:o})=>{let l=(0,zg.useMemo)(()=>new Gre.Atom(-1),[]),u=l.prism,m=(0,zg.useMemo)(()=>{let _;return(S,M)=>{let P=_!==void 0;_!==void 0&&(clearTimeout(_),_=void 0),M===0||P?l.set(S):_=setTimeout(()=>{l.set(S),_=void 0},M)}},[]);return zg.default.createElement(oU.Provider,{value:{cur:u,set:m}},o)},qre=Wre});function HA(o,l){let u=o.enabled!==!1,[m,_]=Hre(),[S,M]=bi(null);(0,Yre.useEffect)(()=>{if(!u)return;let k=S.current;if(!k)return;let L=()=>{var $;return _(!0,($=o.enterDelay)!=null?$:400)},z=()=>{var $;return _(!1,($=o.exitDelay)!=null?$:200)};return k.addEventListener("mouseenter",L),k.addEventListener("mouseleave",z),()=>{k.removeEventListener("mouseenter",L),k.removeEventListener("mouseleave",z)}},[S,u,o.enterDelay,o.exitDelay]);let P=(0,Xre.useContext)(jy);return[u&&m&&M?(0,Kre.createPortal)(WA.default.createElement(yF,{children:l,target:M,onClickOutside:pf,verticalPlacement:o.verticalPlacement,verticalGap:o.verticalGap}),P):WA.default.createElement(WA.default.Fragment,null),S,m]}var Xre,Yre,WA,Kre,qA=A(()=>{Ji(),Xre=G(et()),Yre=G(et()),WA=G(et()),Fee(),Kre=G(Cg()),$re(),Mv(),Wy()});function $A(o){return o.map(l=>l.toFixed(3)).join(", ")}function XA(o){if(!o||(o==null?void 0:o.length)>Zre)return null;let l=o.split(",");if(l.length!==4)return null;let u=l.map(m=>Number(m.trim()));return!u.every(m=>isFinite(m))||u[0]<0||u[0]>1||u[2]<0||u[2]>1?null:u}function iEe(o,l,u={threshold:.02}){if(!o||!l)return!1;let m=0;for(let _=0;_<4;_++)m+=Math.abs(o[_]-l[_]);return m<u.threshold}var Zre,YA,Qre=A(()=>{Zre=128,YA=[{label:"Quad Out",value:"0.250, 0.460, 0.450, 0.940"},{label:"Quad In Out",value:"0.455, 0.030, 0.515, 0.955"},{label:"Quad In",value:"0.550, 0.085, 0.680, 0.530"},{label:"Cubic Out",value:"0.215, 0.610, 0.355, 1.000"},{label:"Cubic In Out",value:"0.645, 0.045, 0.355, 1.000"},{label:"Cubic In",value:"0.550, 0.055, 0.675, 0.190"},{label:"Quart Out",value:"0.165, 0.840, 0.440, 1.000"},{label:"Quart In Out",value:"0.770, 0.000, 0.175, 1.000"},{label:"Quart In",value:"0.895, 0.030, 0.685, 0.220"},{label:"Quint Out",value:"0.230, 1.000, 0.320, 1.000"},{label:"Quint In Out",value:"0.860, 0.000, 0.070, 1.000"},{label:"Quint In",value:"0.755, 0.050, 0.855, 0.060"},{label:"Sine Out",value:"0.390, 0.575, 0.565, 1.000"},{label:"Sine In Out",value:"0.445, 0.050, 0.550, 0.950"},{label:"Sine In",value:"0.470, 0.000, 0.745, 0.715"},{label:"Expo Out",value:"0.190, 1.000, 0.220, 1.000"},{label:"Expo In Out",value:"1.000, 0.000, 0.000, 1.000"},{label:"Expo In",value:"0.780, 0.000, 0.810, 0.00"},{label:"Circ Out",value:"0.075, 0.820, 0.165, 1.000"},{label:"Circ In Out",value:"0.785, 0.135, 0.150, 0.860"},{label:"Circ In",value:"0.600, 0.040, 0.980, 0.335"},{label:"Back Out",value:"0.175, 0.885, 0.320, 1.275"},{label:"Back In Out",value:"0.680, -0.550, 0.265, 1.550"},{label:"Back In",value:"0.600, -0.280, 0.735, 0.045"},{label:"linear",value:"0.5, 0.5, 0.5, 0.5"},{label:"In Out",value:"0.42,0,0.58,1"},{label:"Hold",value:"0, 0, Infinity, Infinity"}]}),kl,KA,Lv,aU,Jre,eie,US,lU,cU,tie,nie,sEe=A(()=>{kl=G(et()),KA=.75,Lv=.1,aU=1+KA*2,Jre="#F5F5F5",eie="#888888",US="#4f4f4f",lU="rgba(255, 255, 255, 0.1)",cU=o=>1-o,tie=o=>{let{easing:l,isSelected:u}=o,m=u?Jre:eie,_="".concat(-KA," ").concat(-KA," ").concat(aU," ").concat(aU);if(l){let S=[l[0],cU(l[1])],M=[l[2],cU(l[3])];return kl.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},kl.default.createElement("line",{x1:"0",y1:"1",x2:S[0],y2:S[1],stroke:US,strokeWidth:"0.1"}),kl.default.createElement("line",{x1:"1",y1:"0",x2:M[0],y2:M[1],stroke:US,strokeWidth:"0.1"}),kl.default.createElement("circle",{cx:S[0],cy:S[1],r:.1,fill:lU}),kl.default.createElement("circle",{cx:M[0],cy:M[1],r:.1,fill:lU}),kl.default.createElement("circle",{cx:S[0],cy:S[1],r:Lv,fill:US}),kl.default.createElement("circle",{cx:M[0],cy:M[1],r:Lv,fill:US}),kl.default.createElement("path",{d:"M0 1 C".concat(S[0]," ").concat(S[1]," ").concat(M[0],` 
        `).concat(M[1]," 1 0"),stroke:m,strokeWidth:"0.08"}),kl.default.createElement("circle",{cx:0,cy:1,r:Lv,fill:m}),kl.default.createElement("circle",{cx:1,cy:0,r:Lv,fill:m}))}return kl.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},kl.default.createElement("line",{x1:"0",y1:"1",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),kl.default.createElement("line",{x1:"1",y1:"0",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),kl.default.createElement("circle",{cx:0,cy:1,r:Lv,fill:m}),kl.default.createElement("circle",{cx:1,cy:0,r:Lv,fill:m}))},nie=tie}),BS,rie,iie,sie,oie,aie,lie,cie,oEe=A(()=>{qA(),BS=G(et()),Jt(),Qre(),sEe(),eA(),zA(),bf(),sie=ge.div(iie||(iie=X([`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  aspect-ratio: 1;

  transition: background-color 0.15s;
  background-color: `,`;
  border-radius: 2px;
  cursor: pointer;
  outline: none;

  `,`

  &:hover {
    background-color: #31353a;
  }

  &:focus {
    background-color: #383d42;
  }
`])),c9,({isSelected:o})=>o&&id(rie||(rie=X([`
      background-color: #383d42;
    `])))),aie=ge(ou)(oie||(oie=X([`
  padding: 0.5em;
  color: white;
  max-width: 240px;
  pointer-events: none !important;
  --popover-bg: black;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: transparent;
  box-shadow: none;
`]))),lie=BS.default.forwardRef((o,l)=>{let[u,m]=HA({enabled:!0,verticalPlacement:o.tooltipPlacement,verticalGap:0},()=>BS.default.createElement(aie,{showPopoverEdgeTriangle:!1},o.easing.label));return BS.default.createElement(sie,R({ref:JC([m,l])},o),u,BS.default.createElement(nie,{easing:XA(o.easing.value),isSelected:o.isSelected}))}),cie=lie});function aEe(o){var l;let[u,m]=(0,uie.useState)(null),_=M=>{if(u===null){o.items.length>0&&m(0);return}let P=u+M*o.uiColumns,k=P<0,L=P>o.items.length-1;if(k||L){if(o.canVerticleExit&&o.canVerticleExit(k?"top":"bottom")){m(null);return}return}m(P)},S=M=>{u===null?m(dEe(M,o.items.length)):u+M<0?m(null):m(Math.min(u+M,o.items.length-1))};return{focusFirstItem(){m(0)},onParentEltKeyDown:M=>{if(M.key==="ArrowRight")S(1);else if(M.key==="ArrowLeft")S(-1);else if(M.key==="ArrowUp")_(-1);else if(M.key==="ArrowDown")_(1);else return 0;return 1},gridItems:o.items.map((M,P)=>o.renderItem({isSelected:P===u,item:M,select(k){m(P),o.onSelectItem(M)===1&&(k==null||k.preventDefault(),k==null||k.stopPropagation())}})),currentSelection:(l=o.items[u??-1])!=null?l:null}}var uie,lEe=A(()=>{uie=G(et()),Pie()});function die(o,l,u){var m;(m=o.current)==null||m.discard(),o.current=null;let _=XA(u);_===null?o.current=uEe(l):o.current=cEe(l,_)}function hie(o){var l;(l=o.current)==null||l.discard(),o.current=null}function cEe(o,l){return ce().tempTransaction(({stateEditors:u})=>{let{setHandlesForKeyframe:m,setKeyframeType:_}=u.coreByProject.historic.sheetsById.sequence;for(let{projectId:S,sheetId:M,objectKey:P,trackId:k,left:L,right:z}of o)m({projectId:S,sheetId:M,objectKey:P,trackId:k,keyframeId:L.id,start:[l[0],l[1]]}),m({projectId:S,sheetId:M,objectKey:P,trackId:k,keyframeId:z.id,end:[l[2],l[3]]}),_({projectId:S,sheetId:M,objectKey:P,trackId:k,keyframeId:L.id,keyframeType:"bezier"})})}function uEe(o){return ce().tempTransaction(({stateEditors:l})=>{let{setKeyframeType:u}=l.coreByProject.historic.sheetsById.sequence;for(let{projectId:m,sheetId:_,objectKey:S,trackId:M,left:P}of o)u({projectId:m,sheetId:_,objectKey:S,trackId:M,keyframeId:P.id,keyframeType:"hold"})})}function dEe(o,l){return(o%l+l)%l}function hEe(o,l){return()=>setTimeout(o,l)}function fEe({left:o,right:l}){return({left:u,right:m})=>o.handles[2]!==u.handles[2]||o.handles[3]!==u.handles[3]||l.handles[0]!==m.handles[0]||l.handles[1]!==m.handles[1]}var ZA,lo,fie,uU,dU,pie,mie,gie,vie,yie,_ie,xie,bie,Sie,wie,Tie,Eie,Mie,pEe,Cie,Aie,Pie=A(()=>{ZA=an(),lo=G(et()),Jt(),fie=G(eEe()),Ie(),rEe(),oEe(),Qre(),zA(),Ji(),lEe(),uU=3,dU=53,pie=25,gie=ge.div(mie||(mie=X([`
  background: `,`;
  display: grid;
  grid-template-areas:
    'search  tween'
    'presets tween';
  grid-template-rows: 32px 1fr;
  grid-template-columns: `,`px 120px;
  gap: 1px;
  height: 120px;
`])),rU,uU*dU),yie=ge.div(vie||(vie=X([`
  overflow: auto;
  grid-area: presets;

  display: grid;
  grid-template-columns: repeat(`,`, 1fr);
  grid-auto-rows: min-content;
  gap: 1px;

  overflow-y: scroll;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
  &::-webkit-scrollbar {
    /* WebKit */
    width: 0;
    height: 0;
  }
`])),uU),xie=ge.input.attrs({type:"text"})(_ie||(_ie=X([`
  background-color: `,`;
  border: none;
  border-radius: 2px;
  color: rgba(255, 255, 255, 0.8);
  padding: 6px;
  font-size: 12px;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: 100%;
  box-sizing: border-box;

  grid-area: search;

  &:hover {
    background-color: #212121;
  }

  &:focus {
    background-color: rgba(16, 16, 16, 0.26);
    outline: 1px solid rgba(0, 0, 0, 0.35);
  }
`])),c9),Sie=ge.div(bie||(bie=X([`
  grid-area: tween;
  background: `,`;
`])),c9),Tie=ge.div(wie||(wie=X([`
  grid-column: 1 / 4;
  padding: 6px;
  color: #888888;
`]))),Eie=o=>{let l=(0,lo.useMemo)(()=>[o.curveConnection,...o.additionalConnections],[o.curveConnection,...o.additionalConnections]),u=(0,lo.useRef)(null);(0,lo.useEffect)(()=>{let ze=Aie(l);return()=>{var Ft;ze(),(Ft=u.current)==null||Ft.commit()}},[u]);let m=[o.curveConnection.left.handles[2],o.curveConnection.left.handles[3],o.curveConnection.right.handles[0],o.curveConnection.right.handles[1]],_=(0,lo.useRef)(null);(0,lo.useLayoutEffect)(()=>{var ze,Ft;(ze=_.current)==null||ze.select(),(Ft=_.current)==null||Ft.focus()},[_.current]);let[S,M]=(0,lo.useState)($A(m)),P=ze=>{ze!==void 0&&(z(1),M(ze.target.value),XA(ze.target.value)&&H(ze.target.value))},k=ze=>{var Ft,Ke;z(1),(ze.key==="ArrowDown"||ze.key==="ArrowUp")&&ze.preventDefault(),ze.key==="ArrowDown"?(Ze.focusFirstItem(),(Ke=(Ft=Se.current[ae[0].label])==null?void 0:Ft.current)==null||Ke.focus()):ze.key==="Escape"?(hie(u),o.onRequestClose("key Escape")):ze.key==="Enter"&&o.onRequestClose("key Enter")},[L,z]=(0,lo.useState)(0);(0,lo.useEffect)(()=>{L===2?M($A(m)):L===3&&S!==""&&M("")},l);let[$,H]=(0,lo.useState)($A(m)),[j,K]=(0,lo.useState)(null);(0,lo.useEffect)(()=>{var ze;L!==0&&L!==3&&die(u,l,(ze=j??$)!=null?ze:"")},[j,$,L]),l.some(fEe(o.curveConnection))&&L===0&&z(3);let Q=ze=>{var Ft,Ke;z(2);let Yt=$A(ze);M(Yt),H(Yt),(Ft=_.current)==null||Ft.select(),(Ke=_.current)==null||Ke.focus()},re=()=>{},ae=(0,lo.useMemo)(()=>/^[A-Za-z]/.test(S)?fie.default.filter(S,YA,{extract:ze=>ze.label}).map(ze=>ze.original):YA,[S]);(0,lo.useEffect)(()=>{L===1&&ae[0]&&H(ae[0].value)},[ae]);let ue=ze=>{ze.key==="Escape"?(hie(u),o.onRequestClose("key Escape"),ze.stopPropagation()):ze.key==="Enter"&&(o.onRequestClose("key Enter"),ze.stopPropagation())},ye=ze=>{L===0&&z(2),K(ze.value)},Ae=()=>K(null),Ce=ze=>(die(u,l,ze.value),o.onRequestClose("selected easing option"),1),Se=(0,lo.useRef)(YA.reduce((ze,Ft)=>(ze[Ft.label]={current:null},ze),{})),[ft,ke]=bi(null),[be,Ue]=(0,lo.useState)(0);(0,lo.useEffect)(()=>{let ze=()=>{var Ft;Ue((Ft=ke==null?void 0:ke.scrollTop)!=null?Ft:0)};return ke==null||ke.addEventListener("scroll",ze),()=>ke==null?void 0:ke.removeEventListener("scroll",ze)},[ke]);let Ze=aEe({items:ae,uiColumns:3,onSelectItem:Ce,canVerticleExit(ze){var Ft,Ke;return ze==="top"?((Ft=_.current)==null||Ft.select(),(Ke=_.current)==null||Ke.focus(),1):0},renderItem:({item:ze,select:Ft})=>{var Ke,Yt;return lo.default.createElement(cie,{key:ze.label,easing:ze,tabIndex:0,onKeyDown:ue,ref:Se.current[ze.label],onMouseOver:()=>ye(ze),onMouseOut:Ae,onClick:Ft,tooltipPlacement:((Yt=(Ke=Se.current[ze.label].current)==null?void 0:Ke.offsetTop)!=null?Yt:0)-(be??0)<dU+pie?"bottom":"top",isSelected:iEe(m,XA(ze.value))})}});return(0,lo.useLayoutEffect)(()=>{var ze,Ft;if(Ze.currentSelection!==null&&document.activeElement!==_.current){let Ke=(Ft=(ze=Se.current)==null?void 0:ze[Ze.currentSelection.label])==null?void 0:Ft.current;Ke==null||Ke.focus(),H(Ze.currentSelection.value),/^[A-Za-z]/.test(S)||M(Ze.currentSelection.value)}},[Ze.currentSelection]),lo.default.createElement(gie,null,lo.default.createElement(xie,{value:S,placeholder:L===3?"Multiple easings selected":"Search presets...",onPaste:hEe(P),onChange:P,ref:_,onKeyDown:k}),lo.default.createElement(yie,{ref:ft,onKeyDown:ze=>Ze.onParentEltKeyDown(ze)},Ze.gridItems,Ze.gridItems.length===0?lo.default.createElement(Tie,null,"No results found"):void 0),lo.default.createElement(Sie,{onClick:()=>{var ze;return(ze=_.current)==null?void 0:ze.focus()}},lo.default.createElement(Vre,{curveConnection:o.curveConnection,backgroundConnections:o.additionalConnections,onCurveChange:Q,onCancelCurveChange:re})))},Mie=Eie,{isCurveEditorOpenD:pEe,isConnectionEditingInCurvePopover:Cie,getLock:Aie}=(()=>{let o=new ZA.Atom([]);return{getLock(l){return o.set(l),function(){o.set([])}},isCurveEditorOpenD:(0,ZA.prism)(()=>o.prism.getValue().length>0),isConnectionEditingInCurvePopover(l){return ZA.prism.ensurePrism(),o.prism.getValue().some(({left:u,right:m})=>l.left.id===u.id&&l.right.id===m.id)}}})()});function mEe(o,l){for(let{keyframeId:u}of _Ee(l))if(o.left.id===u)return!0;return!1}function gEe(o,l,u){return(0,QA.prism)(()=>{if(u===void 0)return[];let m=[];for(let{objectKey:_,trackId:S}of Nie(u)){let M=(0,QA.val)(ce().atomP.historic.coreByProject[o].sheetsById[l].sequence.tracksByObject[_].trackData[S]);M&&(m=m.concat(yEe(M.keyframes).filter(P=>mEe(P,u)).map(({left:P,right:k})=>({left:P,right:k,trackId:S,objectKey:_,sheetId:l,projectId:o}))))}return m})}function Rie(o,l,u){var m;if(u===void 0)return[];let _=[];for(let{objectKey:M,trackId:P,keyframeIds:k}of Nie(u))_=_.concat((m=Iie({projectId:o,sheetId:l,objectKey:M,trackId:P,keyframeIds:k}))!=null?m:[]);let S=FF(_.map(M=>M.pathToProp));return _.map(({keyframe:M,pathToProp:P})=>({keyframe:M,pathToProp:P.slice(S.length)}))}function Iie({projectId:o,sheetId:l,objectKey:u,trackId:m,keyframeIds:_}){let S=(0,QA.val)(ce().atomP.historic.coreByProject[o].sheetsById[l].sequence.tracksByObject[u]),M=S==null?void 0:S.trackData[m];if(!M)return null;let P=vEe((S==null?void 0:S.trackIdByPropPath)||{})[m];if(!P)return null;let k=[u,...UF(P)];return _.map(L=>({keyframe:M.keyframes.find(z=>z.id===L),pathToProp:k})).filter(({keyframe:L})=>L!==void 0)}function vEe(o){let l={};for(let[u,m]of Object.entries(o))l[m]=u;return l}function yEe(o){return o.map((l,u)=>({left:l,right:o[u+1]})).slice(0,-1)}function _Ee(o){var l,u,m;let _=[];for(let[S,M]of Object.entries((l=o==null?void 0:o.byObjectKey)!=null?l:{}))for(let[P,k]of Object.entries((u=M==null?void 0:M.byTrackId)!=null?u:{}))for(let L of Object.keys((m=k==null?void 0:k.byKeyframeId)!=null?m:{}))_.push({objectKey:S,trackId:P,keyframeId:L});return _}function Nie(o){var l,u,m;let _=[];for(let[S,M]of Object.entries((l=o==null?void 0:o.byObjectKey)!=null?l:{}))for(let[P,k]of Object.entries((u=M==null?void 0:M.byTrackId)!=null?u:{}))_.push({objectKey:S,trackId:P,keyframeIds:Object.keys((m=k==null?void 0:k.byKeyframeId)!=null?m:{})});return _}var QA,JA=A(()=>{QA=an(),Ie(),l9()});function xEe(o,l){return(0,kie.useMemo)(()=>bEe(o,l),[])}function bEe(o,l){let u=null,m=M=>ce().tempTransaction(P=>o(P,M));function _(){u==null||u.discard(),u=null}let S={createAsset:l.sheet.project.assetStorage.createAsset,getAssetUrl:M=>M.id?l.sheet.project.assetStorage.getAssetUrl(M.id):void 0};return R({temporarilySetValue(M){_(),u=m(M)},discardTemporaryValue:_,permanentlySetValue(M){_(),m(M).commit()}},S)}var kie,SEe=A(()=>{Ie(),kie=G(et())});function hU(o){var l;if(o.type==="sheetObject")return j0.default.createElement(j0.default.Fragment,null,j0.default.createElement(eP,{style:{paddingLeft:"".concat(o.indent*tP,"px")}},o.sheetObject.address.objectKey),o.children.map((u,m)=>j0.default.createElement(hU,B(R({key:m},u),{autoFocusInput:o.autoFocusInput&&m===0,indent:o.indent+1}))));if(o.type==="propWithChildren"){let u=(l=o.propConfig.label)!=null?l:Mg(o.pathToProp);return j0.default.createElement(j0.default.Fragment,null,j0.default.createElement(eP,{style:{paddingLeft:"".concat(o.indent*tP,"px")}},u),o.children.map((m,_)=>j0.default.createElement(hU,B(R({key:_},m),{autoFocusInput:o.autoFocusInput&&_===0,indent:o.indent+1}))))}else return j0.default.createElement(wEe,B(R({},o),{autoFocusInput:o.autoFocusInput,indent:o.indent}))}function wEe(o){var l;let u=(l=o.propConfig.label)!=null?l:Mg(o.pathToProp),m=TEe(o);if(o.propConfig.type==="enum")return j0.default.createElement(j0.default.Fragment,null);{let _=TF[o.propConfig.type];return j0.default.createElement(Oie,null,j0.default.createElement(eP,null,j0.default.createElement("span",{style:{paddingLeft:"".concat(o.indent*tP,"px")}},u)),j0.default.createElement(Uie,null,j0.default.createElement(_,{editingTools:m,propConfig:o.propConfig,value:gA(o.keyframe.value,o.propConfig),autoFocus:o.autoFocusInput})))}}function TEe(o){let l=o.sheetObject;return xEe(({stateEditors:u},m)=>{let _=B(R({},o.keyframe),{value:m});u.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},l.address),{trackId:o.trackId,keyframes:[_],snappingFunction:l.sheet.getSequence().closestGridPosition}))},l)}var j0,Die,Oie,Lie,eP,tP,Fie,Uie,EEe=A(()=>{j0=G(et()),Jt(),Ote(),J3(),SEe(),s9(),Oie=ge.div(Die||(Die=X([`
  display: flex;
  align-items: stretch;
  min-width: 200px;

  select {
    min-width: 100px;
  }
`]))),eP=ge.div(Lie||(Lie=X([`
  font-style: normal;
  font-weight: 400;
  font-size: 11px;
  line-height: 13px;
  letter-spacing: 0.01em;
  padding: 6px 6px 6px 0;

  width: 40%;

  color: #919191;

  overflow: hidden;
`]))),tP=10,Uie=ge.div(Fie||(Fie=X([`
  display: flex;
  align-items: center;
  width: 60%;
`])))});function fU(o){return su({debugName:"useKeyframeInlineEditorPopover"},()=>nP.default.createElement(ou,{showPopoverEdgeTriangle:!0},nP.default.createElement("div",{style:{margin:"1px 2px 1px 10px"}},Array.isArray(o)?o.map((l,u)=>nP.default.createElement(hU,B(R({key:u},l),{autoFocusInput:u===0,indent:0}))):void 0)))}var nP,pU=A(()=>{nP=G(et()),xf(),bf(),EEe()});function MEe(o,l,u){return Rl(o,{displayName:"Keyframe",menuItems:()=>{let m=Rie(u.leaf.sheetObject.address.projectId,u.leaf.sheetObject.address.sheetId,u.selection);return[{label:m.length>0?"Copy (selection)":"Copy",callback:()=>{m.length>0?ce().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes(m)}):ce().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:u.keyframe,pathToProp:u.leaf.pathToProp}])})}},{label:u.selection!==void 0?"Delete (selection)":"Delete",callback:()=>{u.selection?u.selection.delete():ce().transaction(({stateEditors:_})=>{_.coreByProject.historic.sheetsById.sequence.deleteKeyframes(B(R({},u.leaf.sheetObject.address),{keyframeIds:[u.keyframe.id],trackId:u.leaf.trackId}))})}}]},onOpen(){l._debug("Show keyframe",u)}})}function CEe(o,l,u){let m=(0,u9.useRef)(l);m.current=l;let{onClickFromDrag:_}=u,S=(0,u9.useMemo)(()=>({debugName:"KeyframeDot/useDragKeyframe",onDragStart(P){let k=m.current,L=(0,rP.val)(ce().atomP.historic.coreByProject[k.leaf.sheetObject.address.projectId].sheetsById[k.leaf.sheetObject.address.sheetId].sequence.tracksByObject),z=YTe(L,function(K,{trackId:Q,objectKey:re}){var ae,ue;return K.id!==k.keyframe.id&&!(k.selection&&(ue=(ae=k.selection.byObjectKey[re])==null?void 0:ae.byTrackId[Q])!=null&&ue.byKeyframeId[K.id])});if(XTe(z),k.selection){let{selection:K,leaf:Q}=k,{sheetObject:re}=Q,ae=K.getDragHandlers(B(R({},re.address),{domNode:o,positionAtStartOfDrag:k.track.data.keyframes[k.index].position})).onDragStart(P);return ae&&B(R({},ae),{onClick:_,onDragEnd:(...ue)=>{var ye;(ye=ae.onDragEnd)==null||ye.call(ae,...ue),m7()}})}let $=k,H=(0,rP.val)($.layoutP.scaledSpace.toUnitSpace),j;return{onDrag(K,Q,re){var ae;let ue=$.track.data.keyframes[$.index],ye=Math.max((ae=Nl.checkIfMouseEventSnapToPos(re,{ignore:o}))!=null?ae:ue.position+H(K),0);j==null||j.discard(),j=void 0,j=ce().tempTransaction(({stateEditors:Ae})=>{Ae.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},$.leaf.sheetObject.address),{trackId:$.leaf.trackId,keyframes:[B(R({},ue),{position:ye})],snappingFunction:(0,rP.val)($.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(K){K?j==null||j.commit():j==null||j.discard(),m7()},onClick(K){_(K)}}}}),[_]),[M]=ao(o,S);return y1(M,l.keyframe.position),iu(M,"draggingPositionInSequenceEditor","ew-resize"),[M]}var u9,rP,zS,mU,VS,gU,Bie,iP,zie,Vie,Gie,jie,Hie,Wie,qie=A(()=>{u9=G(et()),Jt(),Ie(),Il(),oa(),Ji(),rP=an(),$a(),Cl(),Mf(),NA(),Av(),JA(),os(),g7(),pU(),AS(),zS=6,mU=zS+2,VS={normalColor:"#40AAA4",selectedColor:"#F2C95C",inlineEditorOpenColor:"#FCF3DC",selectedAndInlineEditorOpenColor:"#CBEBEA"},gU=({isSelected:o,isInlineEditorPopoverOpen:l})=>o&&l?VS.inlineEditorOpenColor:o?VS.selectedColor:l?VS.selectedAndInlineEditorOpenColor:VS.normalColor,iP=ge.div(Bie||(Bie=X([`
  position: absolute;
  `,`

  background: `,`;
  transform: rotateZ(45deg);

  `,`;

  z-index: 1;
  pointer-events: none;
`])),Cf(zS),o=>gU(o),o=>o.flag===2?"outline: 2px solid white;":""),Vie=ge.div(zie||(zie=X([`
  position: absolute;
  `,`

  background: `,`;

  `,`;

  z-index: 1;
  pointer-events: none;
`])),Cf(zS*1.5),o=>gU(o),o=>o.flag===2?"outline: 2px solid white;":""),jie=ge.div(Gie||(Gie=X([`
  z-index: 1;
  cursor: ew-resize;

  position: absolute;
  `,`;
  `,`;

  & + `,` {
    `,`
  }

  &:hover + `,` {
    `,`
  }
`])),Cf(12),Wi,iP,o=>o.isInlineEditorPopoverOpen?Cf(mU):"",iP,Cf(mU)),Hie=o=>{let l=Zy("SingleKeyframeDot",o.keyframe.id),u=u7(o.itemKey),[m,_]=bi(null),[S]=MEe(_,l,o),{node:M,toggle:P,isOpen:k}=fU([{type:"primitiveProp",keyframe:o.keyframe,pathToProp:o.leaf.pathToProp,propConfig:o.leaf.propConf,sheetObject:o.leaf.sheetObject,trackId:o.leaf.trackId}]);CEe(_,o,{onClickFromDrag(z){P(z,m.current)}});let L=!o.keyframe.type||o.keyframe.type==="bezier";return u9.default.createElement(u9.default.Fragment,null,u9.default.createElement(jie,R({ref:m,isInlineEditorPopoverOpen:k},u.attrs)),L?u9.default.createElement(iP,{isSelected:!!o.selection,isInlineEditorPopoverOpen:k,flag:u.flag}):u9.default.createElement(Vie,{isSelected:!!o.selection,isInlineEditorPopoverOpen:k,flag:u.flag}),M,S)},Wie=Hie}),vU,yU,_U,Fv,$ie,Xie,Yie,AEe=A(()=>{ff(),vU=G(et()),Jt(),qie(),yU=zS/2+1,_U=1e3,Fv={normalColor:"#365b59",selectedColor:"#8A7842",barColor:o=>{let l=o.isSelected?Fv.selectedColor:Fv.normalColor;return o.isPopoverOpen?RC(.2,Fy(.2,l)):l},hoverColor:o=>{let l=o.isSelected?Fv.selectedColor:Fv.normalColor;return o.isPopoverOpen?RC(.2,Fy(.2,l)):RC(.1,Fy(.1,l))}},Xie=ge.div($ie||($ie=X([`
  position: absolute;
  background: `,`;
  height: `,`px;
  width: `,`px;

  left: 0;
  top: -`,`px;
  transform-origin: top left;
  z-index: 0;
  cursor: ew-resize;

  &:after {
    display: block;
    position: absolute;
    content: ' ';
    top: -4px;
    bottom: -4px;
    left: 0;
    right: 0;
  }

  &:hover {
    background: `,`;
  }
`])),Fv.barColor,yU,_U,yU/2,Fv.hoverColor),Yie=vU.default.forwardRef((o,l)=>{let u={isPopoverOpen:o.isPopoverOpen,isSelected:o.isSelected};return vU.default.createElement(Xie,B(R({},u),{ref:l,style:{transform:"scaleX(calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(o.connectorLengthInUnitSpace/_U,"))")},onClick:m=>{var _;(_=o.openPopover)==null||_.call(o,m)}}),o.children)})});function PEe(o,l){let u=(0,xU.useRef)(l);u.current=l;let m=(0,xU.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(_){let S=u.current,M;if(S.selection){let{selection:z,leaf:$}=S,{sheetObject:H}=$;return z.getDragHandlers(B(R({},H.address),{domNode:o,positionAtStartOfDrag:S.track.data.keyframes[S.index].position})).onDragStart(_)}let P=S,k=(0,sP.val)(P.layoutP.sheet).getSequence(),L=(0,sP.val)(P.layoutP.scaledSpace.toUnitSpace);return{onDrag(z,$,H){let j=L(z);M&&(M.discard(),M=void 0),M=ce().tempTransaction(({stateEditors:K})=>{K.coreByProject.historic.sheetsById.sequence.transformKeyframes(B(R({},P.leaf.sheetObject.address),{trackId:P.leaf.trackId,keyframeIds:[P.keyframe.id,P.track.data.keyframes[P.index+1].id],translate:j,scale:1,origin:0,snappingFunction:k.closestGridPosition}))})},onDragEnd(z){z?M&&M.commit():M&&M.discard()}}}}),[]);ao(o,m)}function REe(o,l,u,m){return Rl(l,{displayName:"Tween",menuItems:()=>{let _=Rie(o.leaf.sheetObject.address.projectId,o.leaf.sheetObject.address.sheetId,o.selection);return[{label:_.length>0?"Copy (selection)":"Copy",callback:()=>{_.length>0?ce().transaction(S=>{S.stateEditors.studio.ahistoric.setClipboardKeyframes(_)}):ce().transaction(S=>{S.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:u,pathToProp:o.leaf.pathToProp},{keyframe:m,pathToProp:o.leaf.pathToProp}])})}},{label:o.selection?"Delete (selection)":"Delete",callback:()=>{o.selection?o.selection.delete():ce().transaction(({stateEditors:S})=>{S.coreByProject.historic.sheetsById.sequence.deleteKeyframes(B(R({},o.leaf.sheetObject.address),{keyframeIds:[u.id,m.id],trackId:o.leaf.trackId}))})}}]}})}var sP,d9,xU,bU,Kie,Zie,Qie,Jie,ese,IEe=A(()=>{Ie(),Il(),oa(),Ji(),sP=an(),d9=G(et()),xU=G(et()),xf(),bf(),Pie(),AEe(),zA(),Sr(),JA(),JA(),Jt(),bU=5,Zie=ge(ou)(Kie||(Kie=X([`
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: `,`;
`])),rU),Qie=o=>{let{index:l,track:u}=o,m=u.data.keyframes[l],_=u.data.keyframes[l+1],[S,M]=bi(null),{node:P,toggle:k,close:L}=su(()=>{let j=(0,sP.val)(o.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:j.screenX+bU,maxX:j.screenX+j.width-bU}}},()=>d9.default.createElement(ese,B(R({},o),{closePopover:L}))),[z]=REe(o,M,m,_);PEe(M,o);let $=_.position-m.position,H={isPopoverOpen:ri(()=>Cie(B(R({},o.leaf.sheetObject.address),{trackId:o.leaf.trackId,left:m,right:_})),[o.leaf.sheetObject.address,o.leaf.trackId,m,_]),isSelected:o.selection!==void 0};return d9.default.createElement(d9.default.Fragment,null,d9.default.createElement(Yie,B(R({ref:S,connectorLengthInUnitSpace:$},H),{openPopover:j=>{M&&k(j,M)}}),P),z)},Jie=Qie,ese=d9.default.forwardRef((o,l)=>{let{index:u,track:{data:m},selection:_}=o,S=m.keyframes[u],M=m.keyframes[u+1],P=o.leaf.trackId,k=o.leaf.sheetObject.address;if(!P)return null;let L=ri(()=>gEe(k.projectId,k.sheetId,_).getValue(),[k,_]),z=R({left:S,right:M,trackId:P},k);return d9.default.createElement(Zie,{showPopoverEdgeTriangle:!1,ref:l},d9.default.createElement(Mie,{curveConnection:z,additionalConnections:L,onRequestClose:o.closePopover}))})}),tse,Uv,nse,rse,ise,sse,ose,NEe=A(()=>{tse=an(),Uv=G(et()),Jt(),IEe(),qie(),rse=ge.div(nse||(nse=X([`
  position: absolute;
`]))),ise=Uv.default.createElement(Uv.default.Fragment,null),sse=Uv.default.memo(o=>{let{index:l,track:{data:u}}=o,m=u.keyframes[l],_=u.keyframes[l+1],S=m.connectedRight&&!!_;return Uv.default.createElement(rse,{style:{top:"".concat(o.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,tse.val)(o.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(m.position,"px))")}},Uv.default.createElement(Wie,B(R({},o),{itemKey:o.itemKey})),S?Uv.default.createElement(Jie,R({},o)):ise)}),ose=sse});function kEe(o,l){return Rl(o,{displayName:"Keyframe Track",menuItems:()=>{var u;let m=(u=(0,_7.val)(ce().atomP.ahistoric.clipboard.keyframesWithRelativePaths))!=null?u:[];return[DEe(l,m)]}})}function DEe(o,l){return{label:"Paste Keyframes",enabled:l.length>0,callback:()=>{var u;let m=(0,_7.val)(o.layoutP.sheet).getSequence(),_=(u=l[0])==null?void 0:u.pathToProp,S=l.filter(({keyframe:M,pathToProp:P})=>LTe(_,P)).map(({keyframe:M,pathToProp:P})=>M);ce().transaction(({stateEditors:M})=>{var P;m.position=m.closestGridPosition(m.position);let k=(P=OEe(S))==null?void 0:P.position;for(let L of S)o.leaf.trackId&&M.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(B(R({},o.leaf.sheetObject.address),{trackId:o.leaf.trackId,position:m.position+L.position-k,handles:L.handles,value:L.value,snappingFunction:m.closestGridPosition,type:L.type}))})}}}function OEe(o){let l=null;for(let u of o)(l===null||u.position<l.position)&&(l=u);return l}var _7,Vg,ase,lse,SU,cse,LEe=A(()=>{Sr(),_7=an(),Vg=G(et()),Jt(),NEe(),Il(),Ji(),Ie(),l9(),g7(),yf(),lse=ge.div(ase||(ase=X([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),SU=Vg.default.memo(o=>{var l;let{layoutP:u,trackData:m,leaf:_}=o,[S,M]=bi(null),{selectedKeyframeIds:P,selection:k}=ri(()=>{if(!_.trackId)return{selectedKeyframeIds:void 0,selection:void 0};let ye=(0,_7.val)(u.selectionAtom),Ae=(0,_7.val)(ye.pointer.current);if(!Ae)return{selectedKeyframeIds:void 0,selection:void 0};let Ce=(0,_7.val)(ye.pointer.current.byObjectKey[_.sheetObject.address.objectKey].byTrackId[_.trackId].byKeyframeId);return Ce?{selectedKeyframeIds:Ce,selection:Ae}:{selectedKeyframeIds:void 0,selection:void 0}},[u,_.trackId]),[L,z,$]=kEe(M,o),H=qr(yre),j=H.mode==="snapToSome"&&_.trackId?(l=H.positions[_.sheetObject.address.objectKey])==null?void 0:l[_.trackId]:[],K=H.mode==="snapToAll";if(!_.trackId)return null;let Q=(0,Vg.useMemo)(()=>({data:m,id:_.trackId,sheetObject:o.leaf.sheetObject}),[m,_.trackId]),re=m.keyframes.map((ye,Ae)=>Vg.default.createElement(ose,{key:"keyframe-"+ye.id,itemKey:g0.forTrackKeyframe(_.sheetObject,_.trackId,ye.id),keyframe:ye,index:Ae,track:Q,layoutP:u,leaf:_,selection:(P==null?void 0:P[ye.id])===!0?k:void 0})),ae=j.map(ye=>Vg.default.createElement(eU,{key:"snap-target-"+ye,layoutP:u,leaf:_,position:ye})),ue=K?m.keyframes.map(ye=>Vg.default.createElement(eU,{key:"additionalSnapTarget-".concat(ye.id),layoutP:u,leaf:_,position:ye.position})):null;return Vg.default.createElement(lse,{ref:S,style:{background:$?"#444850 ":"unset"}},re,ae,Vg.default.createElement(Vg.default.Fragment,null,ue),L)}),SU.displayName="BasicKeyframedTrack",cse=SU}),use,Bv,dse,hse,FEe=A(()=>{Ie(),Sr(),use=an(),Bv=G(et()),UA(),LEe(),Av(),dse=({leaf:o,layoutP:l})=>{let u=Zy("PrimitivePropRow",o.pathToProp.join());return ri(()=>{let{sheetObject:m}=o,{trackId:_}=o;if(!_)return Bv.default.createElement(Dv,{leaf:o,isCollapsed:!1,node:Bv.default.createElement("div",null)});let S=(0,use.val)(ce().atomP.historic.coreByProject[m.address.projectId].sheetsById[m.address.sheetId].sequence.tracksByObject[m.address.objectKey].trackData[_]);return(S==null?void 0:S.type)!=="BasicKeyframedTrack"?(u.errorDev("trackData type ".concat(S==null?void 0:S.type," is not yet supported on the sequence editor")),Bv.default.createElement(Dv,{leaf:o,isCollapsed:!1,node:Bv.default.createElement("div",null)})):Bv.default.createElement(Dv,{leaf:o,isCollapsed:!1,node:Bv.default.createElement(cse,{layoutP:l,trackData:S,leaf:o})})},[o,l])},hse=dse});function fse(){let o=Math.random()*360,l=.7+Math.random()*.3,u=.55+Math.random()*.2,m=l*Math.min(u,1-u),_=S=>{let M=(S+o/30)%12,P=u-m*Math.max(Math.min(M-3,9-M,1),-1);return Math.round(255*P).toString(16).padStart(2,"0")};return"#".concat(_(0)).concat(_(8)).concat(_(4))}var pse=A(()=>{});function mse(o,l,u){let m=(0,GS.val)(l.sheet).getSequence();o.type==="sheet"?UEe(o,u,m):BEe(o,u,m)}function UEe(o,l,u){var m,_;let{projectId:S,sheetId:M}=o.sheet.address,P=l.every(({pathToProp:z})=>z.length===0),k=[],L=new Map;for(let z of o.children)z.type==="sheetObject"&&L.set(z.sheetObject.address.objectKey,z.sheetObject);if(P)for(let z of o.children.filter($=>$.type==="sheetObject").map($=>$.sheetObject)){let $=(0,GS.pointerToPrism)(ce().atomP.historic.coreByProject[S].sheetsById[M].sequence.tracksByObject[z.address.objectKey]).getValue(),H=Object.keys((m=$==null?void 0:$.trackData)!=null?m:{});for(let j of H)for(let{keyframe:K}of l)k.push({keyframe:K,trackId:j,address:B(R({},z.address),{pathToProp:[]}),sheetObject:z})}else{let z=(0,GS.pointerToPrism)(ce().atomP.historic.coreByProject[S].sheetsById[M].sequence.tracksByObject).getValue();for(let{keyframe:$,pathToProp:H}of l){if(H.length===0)continue;let j=H[0],K=H.slice(1),Q=L.get(j);if(!Q)continue;let re=z==null?void 0:z[j],ae=Ef(K),ue=(_=re==null?void 0:re.trackIdByPropPath)==null?void 0:_[ae];k.push({keyframe:$,trackId:ue,address:B(R({},Q.address),{pathToProp:K}),sheetObject:Q})}}gse(k,u)}function BEe(o,l,u){var m,_;let{projectId:S,sheetId:M,objectKey:P}=o.sheetObject.address,k=o.sheetObject,L=(0,GS.pointerToPrism)(ce().atomP.historic.coreByProject[S].sheetsById[M].sequence.tracksByObject[P]).getValue(),z=l.every(({pathToProp:H})=>H.length===0),$=[];if(z)if(o.type==="sheetObject"){let H=Object.keys((m=L==null?void 0:L.trackData)!=null?m:{});for(let j of H)for(let{keyframe:K}of l)$.push({keyframe:K,trackId:j,address:B(R({},k.address),{pathToProp:[]}),sheetObject:k})}else{let H=o.pathToProp,j=l7(k.template.staticConfig,H);if(j)for(let{path:K,conf:Q}of c7(j,H)){if(v1(Q))continue;let re=K,ae=Ef(re),ue=(_=L==null?void 0:L.trackIdByPropPath)==null?void 0:_[ae];for(let{keyframe:ye}of l)$.push({keyframe:ye,trackId:ue,address:B(R({},k.address),{pathToProp:re}),sheetObject:k})}}else{let H=(L==null?void 0:L.trackIdByPropPath)||{},j=o.type==="propWithChildren"?o.pathToProp:[];for(let{keyframe:K,pathToProp:Q}of l){let re=[...j,...Q],ae=Ef(re),ue=H[ae];$.push({keyframe:K,trackId:ue,address:B(R({},k.address),{pathToProp:re}),sheetObject:k})}}gse($,u)}function gse(o,l){var u;if(o.length===0)return;l.position=l.closestGridPosition(l.position);let m=(u=zEe(o.map(({keyframe:_})=>_)))==null?void 0:u.position;ce().transaction(({stateEditors:_,drafts:S})=>{var M,P,k;for(let L of o){let{keyframe:z,address:$,sheetObject:H}=L,j=L.trackId;if(!j){let K=l7(H.template.staticConfig,$.pathToProp);if(K&&!v1(K)){_.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced($,K);let Q=(k=(P=(M=S.historic.coreByProject[$.projectId])==null?void 0:M.sheetsById[$.sheetId])==null?void 0:P.sequence)==null?void 0:k.tracksByObject[$.objectKey];if(Q){let re=Ef($.pathToProp);j=Q.trackIdByPropPath[re]}}}j&&_.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(B(R({},$),{trackId:j,position:l.position+z.position-m,handles:z.handles,value:z.value,snappingFunction:l.closestGridPosition,type:z.type}))}})}function zEe(o){let l=null;for(let u of o)(l===null||u.position<l.position)&&(l=u);return l}function vse(o,l){let u=Array.from(l.byPosition.keys());if(u.length===0)return;let m={first:Math.min(...u),last:Math.max(...u)},_=l.tracks.flatMap(k=>{var L;return(L=Iie(B(R({},k.sheetObject.address),{trackId:k.id,keyframeIds:k.data.keyframes.filter(z=>z.position>=m.first&&z.position<=m.last).map(z=>z.id)})))!=null?L:[]}),S=o.type==="sheet"?[]:o.type==="sheetObject"?[o.sheetObject.address.objectKey]:o.type==="propWithChildren"?[o.sheetObject.address.objectKey,...o.pathToProp]:[],M=FF([S,..._.map(k=>k.pathToProp)]),P=_.map(({keyframe:k,pathToProp:L})=>({keyframe:k,pathToProp:L.slice(M.length)}));ce().transaction(k=>{k.stateEditors.studio.ahistoric.setClipboardKeyframes(P)})}var GS,yse=A(()=>{GS=an(),Ie(),JA(),l9(),s9()});function VEe(o){if(!o)return null;let l=o.closest("[data-handle]");return l&&l.getAttribute("data-handle")||null}function _se(o){if(o.type==="sheet")return"theatre-agg-keyframe-color-sheet-".concat(o.sheet.address.sheetId);if(o.type==="sheetObject")return"theatre-agg-keyframe-color-object-".concat(o.sheetObject.address.objectKey);{let l=o.pathToProp.join(".");return"theatre-agg-keyframe-color-prop-".concat(o.sheetObject.address.objectKey,"-").concat(l)}}function GEe(o){let l=_se(o),u=localStorage.getItem(l);if(u)return u;let m=fse();return localStorage.setItem(l,m),m}function xse(o,l){let u=_se(o);localStorage.setItem(u,l)}function jEe(o){let{layoutP:l,aggregatedKeyframes:u,viewModel:m}=o,[_,S]=bi(null),M=H0.default.useRef(null),[P,k]=H0.default.useState(()=>GEe(m)),[L,z]=H0.default.useState(!1),[$,H]=H0.default.useState({top:0,left:0}),j=(0,H0.useMemo)(()=>{let Ce=Array.from(u.byPosition.keys());return Ce.length===0?null:{first:Math.min(...Ce),last:Math.max(...Ce)}},[u]),[K]=Rl(S,{displayName:"Aggregate Keyframe",menuItems:()=>{var Ce;let Se=(Ce=(0,x7.pointerToPrism)(ce().atomP.ahistoric.clipboard.keyframesWithRelativePaths).getValue())!=null?Ce:[];return[{label:"Copy Keyframes",callback:()=>{vse(m,u)}},{label:"Paste Keyframes",enabled:Se.length>0,callback:()=>{mse(m,l,Se)}},{label:"Custom Color",callback:()=>{if(z(!0),S){let ft=S.getBoundingClientRect();H({top:Math.max(10,ft.top),left:Math.max(10,ft.left)})}}},{label:"Delete",callback:()=>{ce().transaction(({stateEditors:ft})=>{for(let ke of u.tracks){let be=ke.data.keyframes.filter(Ue=>Ue.position>=j.first&&Ue.position<=j.last).map(Ue=>Ue.id);be.length>0&&ft.coreByProject.historic.sheetsById.sequence.deleteKeyframes(B(R({},ke.sheetObject.address),{keyframeIds:be,trackId:ke.id}))}})}}]}}),Q=KF(),re=(0,H0.useMemo)(()=>({debugName:"AggregateKeyframeBar/useDrag",onDragStart:Ce=>{if(!j)return!1;let Se=Ce.target,ft=VEe(Se),ke=ft!==null;Q(!0,j.first),m.type==="sheet"?m.sheet.address:m.sheetObject.address;let be=(0,x7.val)(l.scaledSpace.toUnitSpace),Ue;return{onDrag(Ze,ze,Ft){let Ke=be(Ze),Yt=Math.max(0,j.first+Ke);if(ke){let mt=ft==="left",nt=j.first,Ee=j.last,ct=mt?j.first:j.last,Nt=Math.max(0,ct+Ke);if(mt&&Nt>=Ee||!mt&&Nt<=nt)return;let Re=Ee-nt,it=Math.abs(Nt-(mt?Ee:nt));if(Re===0||it===0)return;Ue==null||Ue.discard(),Ue=ce().tempTransaction(({stateEditors:Ht})=>{for(let Kt of u.tracks){let Et=[];for(let we of Kt.data.keyframes)if(we.position>=Math.min(nt,Ee)&&we.position<=Math.max(nt,Ee)){let vt=(we.position-nt)/Re,Mt=mt?Nt+vt*it:nt+vt*it;Et.push(B(R({},we),{position:Mt}))}Et.length>0&&Ht.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},Kt.sheetObject.address),{trackId:Kt.id,keyframes:Et,snappingFunction:(0,x7.val)(l.sheet).getSequence().closestGridPosition}))}})}else Ue==null||Ue.discard(),Ue=ce().tempTransaction(({stateEditors:mt})=>{for(let nt of u.tracks){let Ee=[];for(let ct of nt.data.keyframes)ct.position>=j.first&&ct.position<=j.last&&Ee.push(B(R({},ct),{position:Math.max(0,ct.position+Ke)}));Ee.length>0&&mt.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},nt.sheetObject.address),{trackId:nt.id,keyframes:Ee,snappingFunction:(0,x7.val)(l.sheet).getSequence().closestGridPosition}))}});Q(!0,Yt)},onDragEnd(Ze){Q(!1,-1),Ze?Ue==null||Ue.commit():Ue==null||Ue.discard()}}}}),[j,u,l,m,Q]),[ae]=ao(S,re);if(iu(ae,"draggingPositionInSequenceEditor","ew-resize"),!j)return H0.default.createElement(wU,{ref:_});let ue=(0,x7.val)(l.scaledSpace.leftPadding),ye="calc(".concat(ue,"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(j.first,"px))"),Ae="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(j.last-j.first,"px)");return H0.default.createElement(wU,{ref:_},H0.default.createElement(wse,{$color:P,style:{left:ye,width:Ae}},H0.default.createElement(Mse,{$position:"left","data-handle":"left"}),H0.default.createElement(Ase,{$position:"right",style:{left:"calc(100% - 7px)"},"data-handle":"right"})),L&&H0.default.createElement(Rse,{style:{position:"fixed",top:"".concat($.top,"px"),left:"".concat($.left,"px")}},H0.default.createElement(Nse,{ref:M,type:"color",value:P,onChange:Ce=>{let Se=Ce.currentTarget.value;k(Se),xse(m,Se)},autoFocus:!0}),H0.default.createElement(Dse,{type:"text",placeholder:"#000000",value:P,onChange:Ce=>{let Se=Ce.currentTarget.value;Se.startsWith("#")||(Se="#"+Se),/^#[0-9A-F]{6}$/i.test(Se)&&(k(Se),xse(m,Se))}}),H0.default.createElement("button",{onClick:()=>z(!1),style:{padding:"4px 8px",fontSize:"12px",cursor:"pointer",border:"1px solid #666",borderRadius:"2px",background:"#222",color:"#FFF",height:"28px"}},"Done")),K)}var x7,H0,bse,wU,Sse,wse,Tse,TU,Ese,Mse,Cse,Ase,Pse,Rse,Ise,Nse,kse,Dse,Ose,Lse,HEe=A(()=>{x7=an(),H0=G(et()),Jt(),Ji(),oa(),Cl(),Ie(),$a(),Il(),os(),pse(),yse(),wU=ge.div(bse||(bse=X([`
  position: absolute;
  height: 100%;
  width: 100%;
`]))),wse=ge.div(Sse||(Sse=X([`
  position: absolute;
  height: 20px;
  background: `,`;
  cursor: ew-resize;
  top: 50%;
  transform: translateY(-50%);
  border-radius: 2px;
  z-index: 2;
  `,`

  &:hover {
    opacity: 0.8;
  }
`])),o=>o.$color,Wi),TU=ge.div(Tse||(Tse=X([`
  position: absolute;
  height: 20px;
  width: 7px;
  top: 50%;
  transform: translateY(-50%);
  display: block;
  z-index: 3;
  `,`

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    background: inherit;
    border-radius: `,`;
    width: 7px;
    height: 20px;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    width: 15px;
    height: 28px;
    top: 50%;
    transform: translateY(-50%);
    `,`
  }

  &:hover:before {
    opacity: 0.8;
  }
`])),Wi,o=>o.$position==="left"?"2px 0 0 2px":"0 2px 2px 0",o=>o.$position==="left"?"left: -8px; cursor: w-resize;":"right: -8px; cursor: e-resize;"),Mse=ge(TU)(Ese||(Ese=X([`
  left: calc(-1 * 7px);
`]))),Ase=ge(TU)(Cse||(Cse=X([`
  right: 0px;
`]))),Rse=ge.div(Pse||(Pse=X([`
  position: absolute;
  background: #333;
  border-radius: 4px;
  padding: 4px;
  z-index: 1000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
`]))),Nse=ge.input(Ise||(Ise=X([`
  background: #222;
  width: 50px;
  height: 30px;
  border: 1px solid #666;
  border-radius: 2px;
  cursor: pointer;

  &::-webkit-color-swatch-wrapper {
    padding: 2px;
  }

  &::-webkit-color-swatch {
    border: 1px solid #999;
    border-radius: 2px;
  }
`]))),Dse=ge.input(kse||(kse=X([`
  background: #222;
  border: 1px solid #666;
  color: #fff;
  width: 70px;
  height: 28px;
  padding: 4px;
  border-radius: 2px;
  font-family: monospace;
  font-size: 12px;

  &:focus {
    outline: none;
    border-color: #40aaa4;
  }
`]))),Ose=H0.default.memo(jEe),Lse=Ose});function WEe(o){let{layoutP:l,aggregatedKeyframes:u,viewModel:m}=o,[_,S]=bi(null);return oP.default.createElement(Use,{ref:_},oP.default.createElement(Lse,{viewModel:m,aggregatedKeyframes:u,layoutP:l}))}var oP,Fse,Use,Bse,EU,zse=A(()=>{oP=G(et()),Jt(),Ji(),HEe(),Use=ge.div(Fse||(Fse=X([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),Bse=oP.default.memo(WEe),EU=Bse}),b7,aP,Vse,Gse=A(()=>{Sr(),b7=G(et()),FEe(),UA(),zse(),RA(),Av(),aP=(o,l,u=!0)=>o.type==="propWithChildren"?b7.default.createElement(Vse,{layoutP:l,viewModel:o,key:"prop"+o.pathToProp[o.pathToProp.length-1],renderChildren:u}):b7.default.createElement(hse,{layoutP:l,leaf:o,key:"prop"+o.pathToProp[o.pathToProp.length-1]}),Vse=({viewModel:o,layoutP:l,renderChildren:u=!0})=>{let m=Zy("RightPropWithChildrenRow",o.pathToProp.join());return ri(()=>{let _=PA(o);return b7.default.createElement(gZ,{logger:m},b7.default.createElement(Dv,{leaf:o,node:b7.default.createElement(EU,{layoutP:l,aggregatedKeyframes:_,viewModel:o}),isCollapsed:o.isCollapsed},u&&o.children.map(S=>aP(S,l))))},[o,l])}}),MU,jse,Hse,qEe=A(()=>{Sr(),MU=G(et()),Gse(),UA(),RA(),zse(),jse=({leaf:o,layoutP:l,renderChildren:u=!0})=>ri(()=>{let m=PA(o);return MU.default.createElement(Dv,{leaf:o,node:MU.default.createElement(EU,{layoutP:l,aggregatedKeyframes:m,viewModel:o}),isCollapsed:o.isCollapsed},u&&o.children.map(_=>aP(_,l)))},[o,l]),Hse=jse});function Wse(o){return"theatre-subsequence-color-".concat(o.sheet.address.projectId,"-").concat(o.sheet.address.sheetId,"-").concat(o.subSequence.id)}function $Ee(o){let l=Wse(o),u=localStorage.getItem(l);if(u)return u;let m=fse();return localStorage.setItem(l,m),m}function qse(o,l){let u=Wse(o);localStorage.setItem(u,l)}var od,Si,$se,Xse,Yse,Kse,Zse,CU,Qse,Jse,eoe,toe,noe,roe,ioe,soe,ooe,aoe,loe,coe,uoe,XEe=A(()=>{od=an(),Si=G(et()),Jt(),$a(),Cl(),Ie(),Il(),xf(),bf(),oa(),Ji(),os(),Mf(),Cl(),ere(),pse(),Xse=ge.div($se||($se=X([`
  position: absolute;
  height: 100%;
  width: 100%;
  min-width: 20px;
`]))),Kse=ge.div.attrs(o=>({style:{background:o.$color}}))(Yse||(Yse=X([`
  position: absolute;
  height: 20px;
  line-height: 20px;
  cursor: ew-resize;
  top: 50%;
  transform: translateY(-50%);
  border-radius: 2px;
  text-align: center;
  width: 100%;
  z-index: 2;
  `,`

  &:hover {
    opacity: 0.8;
  }

  span {
    color: white;
    font-weight: bold;
    text-shadow: 0 1px rgba(0, 0, 0, 0.67);
  }
`])),Wi),CU=ge.div(Zse||(Zse=X([`
  background: #555;
  position: absolute;
  height: 20px;
  width: 7px;
  top: 50%;
  transform: translateY(-50%);
  display: block;
  z-index: 3;
  `,`

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    background: inherit;
    border-radius: `,`;
    width: 7px;
    height: 20px;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    width: 15px;
    height: 28px;
    top: 50%;
    transform: translateY(-50%);
    `,`
  }

  &:hover:before {
    background: rgba(170, 64, 64, 0.6);
  }

  // Snap cursor when dragging playhead
  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);

    // Show snap cursor () on hover
    &:hover:after {
      background: url(`,`) no-repeat center center;
      background-size: 34px 34px;
    }
  }
`])),Wi,o=>o.$position==="left"?"2px 0 0 2px":"0 2px 2px 0",o=>o.$position==="left"?"left: -8px; cursor: w-resize;":"right: -8px; cursor: e-resize;",mf,YF),Jse=ge(CU).attrs(o=>({style:{background:o.$color}}))(Qse||(Qse=X([`
  border-right: 1px solid rgba(0, 0, 0, 0.25);
  left: -7px;
`]))),toe=ge(CU).attrs(o=>({style:{background:o.$color}}))(eoe||(eoe=X([`
  border-left: 1px solid rgba(0, 0, 0, 0.25);
  right: -7px;
`]))),ge.div(noe||(noe=X([`
  position: absolute;
  left: 8px;
  top: 50%;
  transform: translateY(-50%);
  color: rgba(255, 255, 255, 0.9);
  font-size: 11px;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  pointer-events: none;
  user-select: none;
`]))),ioe=ge.div(roe||(roe=X([`
  position: absolute;
  background: #333;
  border-radius: 4px;
  padding: 4px;
  z-index: 1000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
`]))),ooe=ge.input(soe||(soe=X([`
  background: #222;
  width: 50px;
  height: 30px;
  border: 1px solid #666;
  border-radius: 2px;
  cursor: pointer;

  &::-webkit-color-swatch-wrapper {
    padding: 2px;
  }

  &::-webkit-color-swatch {
    border: 1px solid #999;
    border-radius: 2px;
  }
`]))),loe=ge.input(aoe||(aoe=X([`
  background: #222;
  border: 1px solid #666;
  color: #fff;
  width: 70px;
  height: 28px;
  padding: 4px;
  border-radius: 2px;
  font-family: monospace;
  font-size: 12px;

  &:focus {
    outline: none;
    border-color: #40aaa4;
  }
`]))),coe=({leaf:o,layoutP:l})=>{var u;let[m,_]=bi(null),[S,M]=bi(null),[P,k]=bi(null),[L,z]=bi(null),$=Si.default.useRef(null),[H,j]=(0,Si.useState)(()=>$Ee(o)),[K,Q]=(0,Si.useState)(!1),[re,ae]=(0,Si.useState)({top:0,left:0}),ue=su({debugName:"SubSequenceBar/editLabel"},()=>{let ct=o.subSequence.label,Nt=ct;return Si.default.createElement(ou,null,Si.default.createElement("div",{style:{padding:"8px"}},Si.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Label"),Si.default.createElement("input",{type:"text",defaultValue:ct,onChange:Re=>{Nt=Re.target.value},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),Si.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},Si.default.createElement("button",{onClick:()=>{ce().transaction(({stateEditors:Re})=>{Re.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Re.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{label:Nt}})}),ue.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Done"))))}),ye=su({debugName:"SubSequenceBar/editDuration"},()=>{let ct=o.subSequence.duration,Nt=ct;return Si.default.createElement(ou,null,Si.default.createElement("div",{style:{padding:"8px"}},Si.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Duration"),Si.default.createElement("input",{type:"number",defaultValue:ct,step:.1,min:.1,onChange:Re=>{Nt=parseFloat(Re.target.value)},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),Si.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},Si.default.createElement("button",{onClick:()=>{Nt>0&&ce().transaction(({stateEditors:Re})=>{Re.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Re.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{duration:Nt}})}),ye.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Done"))))}),Ae=su({debugName:"SubSequenceBar/editTimeScale"},()=>{let ct=o.subSequence.timeScale,Nt=ct;return Si.default.createElement(ou,null,Si.default.createElement("div",{style:{padding:"8px"}},Si.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Time Scale"),Si.default.createElement("input",{type:"number",defaultValue:ct,step:.1,min:.1,onChange:Re=>{Nt=parseFloat(Re.target.value)},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),Si.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},Si.default.createElement("button",{onClick:()=>{Nt>0&&ce().transaction(({stateEditors:Re})=>{Re.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Re.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{timeScale:Nt}})}),Ae.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Done"))))}),Ce=su({debugName:"SubSequenceBar/editStart"},()=>{let ct=o.subSequence.position,Nt=ct;return Si.default.createElement(ou,null,Si.default.createElement("div",{style:{padding:"8px"}},Si.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold"}},"Edit Sub-sequence Start Position"),Si.default.createElement("input",{type:"number",defaultValue:ct,step:.1,min:0,onChange:Re=>{Nt=parseFloat(Re.target.value)},style:{width:"200px",padding:"4px",marginBottom:"8px"},autoFocus:!0}),Si.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"4px"}},Si.default.createElement("button",{onClick:()=>{Nt>=0&&ce().transaction(({stateEditors:Re})=>{Re.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),Re.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{position:Nt}})}),Ce.close("user action")},style:{padding:"4px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"}},"Ok"))))}),[Se]=Rl(_,{menuItems:()=>[{label:"Edit Label",callback:()=>{if(_){let ct=_.getBoundingClientRect();ue.open({clientX:ct.left,clientY:ct.top},_)}}},{label:"Edit Start",callback:()=>{if(_){let ct=_.getBoundingClientRect();Ce.open({clientX:ct.left,clientY:ct.top},_)}}},{label:"Edit Duration",callback:()=>{if(_){let ct=_.getBoundingClientRect();ye.open({clientX:ct.left,clientY:ct.top},_)}}},{label:"Edit Time Scale",callback:()=>{if(_){let ct=_.getBoundingClientRect();Ae.open({clientX:ct.left,clientY:ct.top},_)}}},{label:"Delete Sub-sequence",callback:()=>{ce().transaction(({stateEditors:ct})=>{ct.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),ct.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id})})}},{label:"Custom Color",callback:()=>{if(Q(!0),_){let ct=_.getBoundingClientRect();ae({top:Math.max(10,ct.top),left:Math.max(10,ct.left)})}}}]}),ft=KF(),ke=ct=>{let Nt=ct.composedPath();for(let Re of Nt){if(Re===k)return"left";if(Re===z)return"right";if(Re===M)return"bar";if(Re===_)break}return null},be=(0,Si.useMemo)(()=>{let ct=null,Nt=null,Re=0,it=0,Ht=1,Kt=()=>{var Et;let we=o.subSequence.duration;if(!we||we===0)try{let vt=ce(),Mt=(0,od.val)(vt.projectsP)[o.sheet.address.projectId];we=(Et=(0,od.val)(Mt.pointers.historic.sheetsById[o.subSequence.sheetId].sequence.length))!=null?Et:(0,od.val)(l.sheet).getSequence().length}catch{we=(0,od.val)(l.sheet).getSequence().length}return we??1};return{debugName:"SubSequenceBar/drag",lockCSSCursorTo:"ew-resize",onDragStart(Et){return Nt=ke(Et),Nt?(Re=o.subSequence.position,it=Kt(),Ht=o.subSequence.timeScale,ft(!0,o.subSequence.position),{onDrag(we){ct&&ct.discard(),ct=ce().tempTransaction(({stateEditors:vt})=>{let Mt=(0,od.val)(l.clippedSpace.range),Sn=(0,od.val)(l.clippedSpace.width),ar=(Mt.end-Mt.start)/Sn,yr=we*ar,Pr=(0,od.val)(l.sheet).getSequence().closestGridPosition;if(Nt==="bar"){let vi=Re+yr,Is=Math.max(0,Pr(vi));vt.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),vt.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{position:Is}})}else if(Nt==="left"){let vi=Re+it/Ht,Is=Re+yr,ei=Math.max(0,Pr(Is)),uo=vi-ei,pi=Math.max(.01,it/uo);vt.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),vt.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{position:ei,timeScale:pi}})}else if(Nt==="right"){let vi=Re+it/Ht+yr,Is=Math.max(Re+.01,Pr(vi))-Re,ei=Math.max(.01,it/Is);vt.studio.historic.projects.stateByProjectId.stateBySheetId._ensure({projectId:o.sheet.address.projectId,sheetId:o.sheet.address.sheetId}),vt.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{timeScale:ei}})}})},onDragEnd(we){ft(!1,0),we&&ct?ct.commit():ct&&ct.discard(),ct=null}}):!1}}},[o,l,ft,k,z,M,_]),[Ue]=ao(_,be);iu(Ue,"draggingPositionInSequenceEditor","ew-resize");let Ze=(0,od.val)(l.scaledSpace.leftPadding),ze=o.subSequence.position,Ft=o.subSequence.timeScale,Ke=o.subSequence.duration;if(!Ke||Ke===0)try{let ct=ce(),Nt=(0,od.val)(ct.projectsP)[o.sheet.address.projectId];Ke=(u=(0,od.val)(Nt.pointers.historic.sheetsById[o.subSequence.sheetId].sequence.length))!=null?u:(0,od.val)(l.sheet).getSequence().length}catch{Ke=(0,od.val)(l.sheet).getSequence().length}Ke||(Ke=1);let Yt="calc(".concat(Ze,"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(ze,"px))"),mt="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(Ke/Ft,"px)"),nt=ze,Ee=ze+Ke/Ft;return Si.default.createElement(Xse,{ref:m,style:{left:Yt,width:mt}},ue.node,Ce.node,ye.node,Ae.node,K&&Si.default.createElement(ioe,{style:{position:"fixed",top:"".concat(re.top,"px"),left:"".concat(re.left,"px")}},Si.default.createElement(ooe,{ref:$,type:"color",value:H,onChange:ct=>{let Nt=ct.currentTarget.value;j(Nt),qse(o,Nt)},autoFocus:!0}),Si.default.createElement(loe,{type:"text",placeholder:"#000000",value:H,onChange:ct=>{let Nt=ct.currentTarget.value;Nt.startsWith("#")||(Nt="#"+Nt),/^#[0-9A-F]{6}$/i.test(Nt)&&(j(Nt),qse(o,Nt))}}),Si.default.createElement("button",{onClick:()=>Q(!1),style:{padding:"4px 8px",fontSize:"12px",cursor:"pointer",border:"1px solid #666",borderRadius:"2px",background:"#222",color:"#FFF",height:"28px"}},"Done")),Se,Si.default.createElement(Kse,{ref:S,$color:H},Si.default.createElement("span",null,o.subSequence.timeScale.toFixed(2),"x")),Si.default.createElement(Jse,B(R({ref:P,$position:"left","data-handle":"left",title:isFinite(nt)?"Sub-sequence start: ".concat(nt.toFixed(2)):"Sub-sequence start"},isFinite(nt)?Nl.includePositionSnapAttrs(nt):{}),{$color:H})),Si.default.createElement(toe,B(R({ref:L,$position:"right","data-handle":"right",title:isFinite(Ee)?"Sub-sequence end: ".concat(Ee.toFixed(2)):"Sub-sequence end"},isFinite(Ee)?Nl.includePositionSnapAttrs(Ee):{}),{$color:H})))},uoe=coe}),AU,doe,hoe,foe,poe,YEe=A(()=>{AU=G(et()),Jt(),XEe(),hoe=ge.div(doe||(doe=X([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),foe=({layoutP:o,leaf:l})=>AU.default.createElement(hoe,null,AU.default.createElement(uoe,{layoutP:o,leaf:l})),poe=foe}),PU,moe,goe,KEe=A(()=>{PU=G(et()),UA(),YEe(),moe=({leaf:o,layoutP:l})=>PU.default.createElement(Dv,{leaf:o,node:PU.default.createElement(poe,{layoutP:l,leaf:o})},null),goe=moe}),lP,RU,voe,IU,NU=A(()=>{lP=G(et()),RU=(0,lP.createContext)({searchTerm:"",searchTrigger:0}),voe=({searchTerm:o,searchTrigger:l,children:u})=>lP.default.createElement(RU.Provider,{value:{searchTerm:o,searchTrigger:l}},u),IU=()=>(0,lP.useContext)(RU)});function S7(o,l){ce().transaction(({stateEditors:u})=>{u.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.sequenceEditorCollapsableItems.set(B(R({},l.sheetAddress),{studioSheetItemKey:l.sheetItemKey,isCollapsed:o}))})}var kU=A(()=>{Ie()});function ZEe(o,l){if(!l.trim())return;let u=l.toLowerCase().trim();o.children.filter(m=>m.type==="sheetObject").forEach(m=>{eMe(m,u)&&(S7(!1,{sheetAddress:m.sheetObject.address,sheetItemKey:m.sheetItemKey}),xoe(m.children,u,m.sheetObject.address))})}function QEe(o){o.children.filter(l=>l.type==="sheetObject").forEach(l=>{let u="".concat(l.sheetObject.address.projectId,":").concat(l.sheetObject.address.sheetId,":").concat(l.sheetItemKey);zv.set(u,l.isCollapsed),yoe(l.children,l.sheetObject.address)})}function yoe(o,l){o.forEach(u=>{if(u.type==="propWithChildren"){let m="".concat(l.projectId,":").concat(l.sheetId,":").concat(u.sheetItemKey);zv.set(m,u.isCollapsed),yoe(u.children,l)}})}function JEe(o){o.children.filter(l=>l.type==="sheetObject").forEach(l=>{let u="".concat(l.sheetObject.address.projectId,":").concat(l.sheetObject.address.sheetId,":").concat(l.sheetItemKey),m=zv.get(u);m!==void 0&&m!==l.isCollapsed&&S7(m,{sheetAddress:l.sheetObject.address,sheetItemKey:l.sheetItemKey}),_oe(l.children,l.sheetObject.address)}),zv.clear()}function _oe(o,l){o.forEach(u=>{if(u.type==="propWithChildren"){let m="".concat(l.projectId,":").concat(l.sheetId,":").concat(u.sheetItemKey),_=zv.get(m);_!==void 0&&_!==u.isCollapsed&&S7(_,{sheetAddress:l,sheetItemKey:u.sheetItemKey}),_oe(u.children,l)}})}function eMe(o,l){return o.sheetObject.address.objectKey.toLowerCase().includes(l)?!0:o.children.some(u=>DU(u,l))}function xoe(o,l,u){o.forEach(m=>{var _;if(m.type==="propWithChildren"){let S=(((_=m.pathToProp[m.pathToProp.length-1])==null?void 0:_.toString().toLowerCase())||"").includes(l),M=m.children.some(P=>DU(P,l));(S||M)&&(S7(!1,{sheetAddress:u,sheetItemKey:m.sheetItemKey}),xoe(m.children,l,u))}})}function DU(o,l){var u;return(((u=o.pathToProp[o.pathToProp.length-1])==null?void 0:u.toString().toLowerCase())||"").includes(l)?!0:o.type==="propWithChildren"?o.children.some(m=>DU(m,l)):!1}function boe(o,l){if(!l.trim())return JEe(o),o;zv.size===0&&QEe(o),ZEe(o,l);let u=l.toLowerCase().trim(),m=o.children.map(P=>P.type==="sheetObject"?tMe(P,u):null).filter(P=>P!==null),_=o.top,S=o.n,M=m.map(P=>{let k=nMe(P,_,S);return _=k.top+k.heightIncludingChildren,S=k.n+1,k});return B(R({},o),{children:M,heightIncludingChildren:_-o.top,isCollapsed:!1})}function tMe(o,l){if(o.sheetObject.address.objectKey.toLowerCase().includes(l))return B(R({},o),{children:o.children,isCollapsed:!1});{let u=o.children.map(m=>Soe(m,l)).filter(m=>m!==null);if(u.length>0)return B(R({},o),{children:u,isCollapsed:!1})}return null}function Soe(o,l){var u;let m=(((u=o.pathToProp[o.pathToProp.length-1])==null?void 0:u.toString().toLowerCase())||"").includes(l);if(o.type==="primitiveProp")return m?o:null;if(m)return B(R({},o),{children:o.children,isCollapsed:!1});{let _=o.children.map(S=>Soe(S,l)).filter(S=>S!==null);if(_.length>0)return B(R({},o),{children:_,isCollapsed:!1})}return null}function nMe(o,l,u){let m=l,_=u,S=B(R({},o),{top:m,n:_});m+=o.nodeHeight,_+=1;let M=o.children.map(P=>{let k=woe(P,m,_);return m=k.top+k.nodeHeight,k.type==="propWithChildren"&&(m+=k.heightIncludingChildren-k.nodeHeight),_=k.n+1,k});return B(R({},S),{children:M,heightIncludingChildren:m-S.top})}function woe(o,l,u){let m=B(R({},o),{top:l,n:u});if(o.type==="propWithChildren"){let _=l+o.nodeHeight,S=u+1,M=o.children.map(P=>{let k=woe(P,_,S);return _=k.top+k.nodeHeight,k.type==="propWithChildren"&&(_+=k.heightIncludingChildren-k.nodeHeight),S=k.n+1,k});return B(R({},m),{children:M,heightIncludingChildren:_-m.top})}return m}var zv,Toe=A(()=>{kU(),zv=new Map});function OU(o,l=[]){o.shouldRender&&l.push(o);let u="isCollapsed"in o?o.isCollapsed:!1;if((o.type==="sheet"||!u)&&"children"in o)for(let m of o.children)OU(m,l);return l}var Eoe=A(()=>{}),cP,h9,w7,Moe,Coe,Aoe,Poe,Roe,Ioe,LU=A(()=>{Sr(),cP=an(),h9=G(et()),Jt(),qTe(),nU(),qEe(),KEe(),NU(),Toe(),yf(),Eoe(),IA(),Gse(),w7=1e6,Coe=ge.div(Moe||(Moe=X([`
  position: relative;
`]))),Poe=ge.div(Aoe||(Aoe=X([`
  margin: 0;
  padding: 0;
  position: absolute;
  left: 0;
  width: `,`px;
  z-index: 10;
`])),w7),Roe=({layoutP:o})=>{let{searchTerm:l,searchTrigger:u}=IU(),m=XF(),{scrollTop:_,clientHeight:S}=qr(m);return ri(()=>{let M=(0,cP.val)(o.tree),P=l.trim()?boe(M,l):M,k=(0,cP.val)(o.tree.top)+Math.max(P.heightIncludingChildren,(0,cP.val)(o.dopeSheetDims.height)),L=OU(P),z=[],$=500,H=_-$,j=_+S+$,K=-1;for(let Q=0;Q<L.length;Q++){let re=L[Q];if(re.top+re.nodeHeight>=H){K=Q;break}}if(K!==-1)for(let Q=K;Q<L.length;Q++){let re=L[Q];if(re.top>j)break;z.push(re)}return h9.default.createElement(Coe,null,h9.default.createElement(LA,{layoutP:o,height:k},h9.default.createElement($ne,{layoutP:o,height:k},h9.default.createElement(Poe,{style:{top:"0px"}},z.map(Q=>{let re=null;return Q.type==="subSequence"?re=h9.default.createElement(goe,{layoutP:o,key:g0.forSubSequence(Q.subSequence.id),leaf:Q}):Q.type==="sheetObject"?re=h9.default.createElement(Hse,{layoutP:o,key:"sheetObject-"+Q.sheetObject.address.objectKey,leaf:Q,renderChildren:!1}):(Q.type==="propWithChildren"||Q.type==="primitiveProp")&&(re=aP(Q,o,!1)),re?h9.default.createElement("div",{key:Q.type+"-"+(Q.sheetItemKey||Q.top),style:{position:"absolute",top:Q.top+"px",width:"100%",height:Q.nodeHeight+"px"}},re):null})))))},[o,l,u,_,S])},Ioe=Roe});function FU(o,l,u,m){let _="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(o,"px)"),S="calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(l,") * 1px)");u===0&&(u=1e-4);let M="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(u,")");m===0&&(m=.001);let P="calc(var(--graphEditorVerticalSpace) * ".concat(m*-1,")");return"translate(".concat(_,", ").concat(S,") scale(").concat(M,", ").concat(P,")")}function rMe(o,l){let{index:u,trackData:m}=l,_=m.keyframes[u],S=m.keyframes[u+1];return Rl(o,{menuItems:()=>[{label:"Delete",callback:()=>{ce().transaction(({stateEditors:M})=>{let{deleteKeyframes:P}=M.coreByProject.historic.sheetsById.sequence;P(B(R({},l.sheetObject.address),{trackId:l.trackId,keyframeIds:[_.id,S.id]}))})}}]})}var uP,Noe,koe,Doe,Ooe,Loe,UU=A(()=>{s9(),Ie(),Il(),Ji(),uP=G(et()),Jt(),koe=ge.path(Noe||(Noe=X([`
  stroke-width: 2;
  stroke: var(--main-color);
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),Doe="M 0 0 L 1 0 L 1 1",Ooe=o=>{let{index:l,trackData:u}=o,m=u.keyframes[l],_=u.keyframes[l+1],S=_.position-m.position,[M,P]=bi(null),[k]=rMe(P,o),L=o.isScalar?gA(m.value,o.propConfig):0,z=o.isScalar?gA(_.value,o.propConfig):1,$=o.extremumSpace.fromValueSpace(L),H=o.extremumSpace.fromValueSpace(z)-$,j=FU(m.position,$,S,H),K=m.handles[2],Q=m.handles[3],re=_.handles[0],ae=_.handles[1],ue="M 0 0 C ".concat(K," ").concat(Q," ").concat(re," ").concat(ae," 1 1");return uP.default.createElement(uP.default.Fragment,null,uP.default.createElement(koe,{ref:M,d:!m.type||m.type==="bezier"?ue:Doe,style:{transform:j}}),k)},Loe=Ooe});function iMe(o,l){let u=(0,Vv.useRef)(l);u.current=l;let m=(0,Vv.useMemo)(()=>({debugName:"CurveHandler/useOurDrags",lockCSSCursorTo:"move",onDragStart(){let _,S=u.current,M=(0,jS.val)(S.layoutP.scaledSpace.toUnitSpace),P=(0,jS.val)(S.layoutP.graphEditorVerticalSpace.toExtremumSpace),k=S.extremumSpace.lock();return{onDrag(L,z){_&&(_.discard(),_=void 0);let{index:$,trackData:H}=S,j=H.keyframes[$],K=H.keyframes[$+1],Q=M(L)/(K.position-j.position),re=-z,ae=P(re),ue=S.extremumSpace.deltaToValueSpace(ae),ye=l.isScalar?j.value:0,Ae=l.isScalar?K.value:1,Ce=ue/(Ae-ye);if(S.which==="left"){let Se=Zi(j.handles[2]+Q,0,1),ft=j.handles[3]+Ce;_=ce().tempTransaction(({stateEditors:ke})=>{ke.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},S.sheetObject.address),{snappingFunction:(0,jS.val)(S.layoutP.sheet).getSequence().closestGridPosition,trackId:S.trackId,keyframes:[B(R({},j),{handles:[j.handles[0],j.handles[1],Se,ft]})]}))})}else{let Se=Zi(K.handles[0]+Q,0,1),ft=K.handles[1]+Ce;_=ce().tempTransaction(({stateEditors:ke})=>{ke.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},S.sheetObject.address),{trackId:S.trackId,snappingFunction:(0,jS.val)(S.layoutP.sheet).getSequence().closestGridPosition,keyframes:[B(R({},K),{handles:[Se,ft,K.handles[2],K.handles[3]]})]}))})}},onDragEnd(L){k(),L?_&&_.commit():_&&_.discard()}}}}),[]);ao(o,m)}function sMe(o,l){return Rl(o,{menuItems:()=>[{label:"Delete",callback:()=>{ce().transaction(({stateEditors:u})=>{u.coreByProject.historic.sheetsById.sequence.deleteKeyframes(B(R({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}var jS,Vv,Foe,BU,Uoe,Boe,zoe,Voe,Goe,zU,oMe=A(()=>{Ie(),Il(),oa(),Ji(),jS=an(),V0(),Vv=G(et()),Jt(),UU(),os(),BU=ge.circle(Foe||(Foe=X([`
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;
  fill: var(--main-color);
  r: 2px;
  pointer-events: none;
`]))),Boe=ge.circle(Uoe||(Uoe=X([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  cursor: move;
  `,`;
  &:hover {
  }
  &:hover + `,` {
    r: 6px;
  }
`])),Wi,BU),Voe=ge.path(zoe||(zoe=X([`
  stroke-width: 1;
  stroke: var(--main-color);
  /* stroke: gray; */
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),Goe=o=>{let[l,u]=bi(null),{index:m,trackData:_}=o,S=_.keyframes[m],M=_.keyframes[m+1],[P]=sMe(u,o);iMe(u,o);let k=o.which==="left"?S.handles[2]:M.handles[0],L=S.position+(M.position-S.position)*k,z=o.which==="left"?S.handles[3]:M.handles[1],$=o.isScalar?S.value:0,H=o.isScalar?M.value:1,j=$+(H-$)*z,K=o.extremumSpace.fromValueSpace(j),Q=K-o.extremumSpace.fromValueSpace(o.which==="left"?$:H),re=FU(o.which==="left"?S.position:M.position,o.extremumSpace.fromValueSpace(o.which==="left"?$:H),L-(o.which==="left"?S.position:M.position),Q);return Vv.default.createElement("g",null,Vv.default.createElement(Boe,{ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(L," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(K,") * 1px)")}}),Vv.default.createElement(BU,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(L," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(K,") * 1px)")}}),Vv.default.createElement(Voe,{d:"M 0 0 L 1 1",style:{transform:re}}),P)},zU=Goe});function aMe(o){let[l,u]=(0,f9.useState)(!1);y1(l,o.props.keyframe.position);let m=(0,f9.useRef)(o.props);m.current=o.props;let _=(0,f9.useMemo)(()=>({debugName:"GraphEditorDotScalar/useDragKeyframe",lockCSSCursorTo:"move",onDragStart(S){u(!0);let M=!!S.altKey,P=m.current,k=(0,dP.val)(P.layoutP.scaledSpace.toUnitSpace),L=(0,dP.val)(P.layoutP.graphEditorVerticalSpace.toExtremumSpace),z=P.extremumSpace.lock(),$;return{onDrag(H,j){let K=P.trackData.keyframes[P.index],Q=k(H),re=-j,ae=L(re),ue=P.extremumSpace.deltaToValueSpace(ae),ye=[],Ae=B(R({},K),{position:K.position+Q,value:K.value+ue,handles:[...K.handles]});if(ye.push(Ae),M){let Ce=P.trackData.keyframes[P.index-1];if(Ce&&Math.abs(K.value-Ce.value)>0){let ft=B(R({},Ce),{handles:[...Ce.handles]});ye.push(ft),ft.handles[3]=cMe(Ce.handles[3],Ce.value,Ce.value,K.value,Ae.value)}let Se=P.trackData.keyframes[P.index+1];if(Se&&Math.abs(K.value-Se.value)>0){let ft=B(R({},Se),{handles:[...Se.handles]});ye.push(ft),ft.handles[1]=uMe(ft.handles[1],ft.value,ft.value,K.value,Ae.value)}}$==null||$.discard(),$=ce().tempTransaction(({stateEditors:Ce})=>{Ce.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},P.sheetObject.address),{trackId:P.trackId,keyframes:ye,snappingFunction:(0,dP.val)(P.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(H){u(!1),z(),H?$==null||$.commit():($==null||$.discard(),o.onDetectedClick(S))}}}}),[]);return ao(o.node,_),iu(l,"draggingPositionInSequenceEditor","move"),l}function lMe(o,l){return Rl(o,{menuItems:()=>[{label:"Delete",callback:()=>{ce().transaction(({stateEditors:u})=>{u.coreByProject.historic.sheetsById.sequence.deleteKeyframes(B(R({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}function cMe(o,l,u,m,_){return(m-l)*o/(_-u)}function uMe(o,l,u,m,_){return((l-m)*o+m-l+u-_)/(u-_)}var dP,f9,joe,VU,Hoe,Woe,qoe,$oe,dMe=A(()=>{Ie(),Il(),oa(),Ji(),dP=an(),f9=G(et()),Jt(),$a(),$a(),os(),Cl(),Mf(),pU(),AS(),VU=ge.circle(joe||(joe=X([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),Woe=ge.circle(Hoe||(Hoe=X([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: move;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Wi,VU,mf),qoe=o=>{let[l,u]=bi(null),{index:m,trackData:_}=o,S=_.keyframes[m],[M]=lMe(u,o),P=u7(o.itemKey),k=S.value,L=o.extremumSpace.fromValueSpace(k),z=fU([{type:"primitiveProp",keyframe:o.keyframe,pathToProp:o.pathToProp,propConfig:o.propConfig,sheetObject:o.sheetObject,trackId:o.trackId}]),$=aMe({node:u,props:o,onDetectedClick:H=>z.toggle(H,H.target instanceof Element?H.target:u)});return f9.default.createElement(f9.default.Fragment,null,f9.default.createElement(Woe,B(R(R(R({ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(S.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(L,") * 1px)")}},_1(S.position)),Nl.includePositionSnapAttrs(S.position)),P.attrs),{className:$?"beingDragged":""})),f9.default.createElement(VU,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(S.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(L,") * 1px)"),fill:P.flag===2?"white":void 0}}),z.node,M)},$oe=qoe});function hMe(o){let[l,u]=(0,p9.useState)(!1);y1(l,o.props.keyframe.position);let m=(0,p9.useRef)(o.props);m.current=o.props;let _=(0,p9.useMemo)(()=>({debugName:"GraphEditorDotNonScalar/useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(S){u(!0);let M=m.current,P=(0,GU.val)(M.layoutP.scaledSpace.toUnitSpace),k=M.extremumSpace.lock(),L;return{onDrag(z,$){let H=M.trackData.keyframes[M.index],j=P(z),K=[],Q=B(R({},H),{position:H.position+j,value:H.value,handles:[...H.handles]});K.push(Q),L==null||L.discard(),L=ce().tempTransaction(({stateEditors:re})=>{re.coreByProject.historic.sheetsById.sequence.replaceKeyframes(B(R({},M.sheetObject.address),{trackId:M.trackId,keyframes:K,snappingFunction:(0,GU.val)(M.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(z){u(!1),k(),z?L==null||L.commit():(L==null||L.discard(),o.onDetectedClick(S))}}}}),[]);return ao(o.node,_),iu(l,"draggingPositionInSequenceEditor","ew-resize"),l}function fMe(o,l){return Rl(o,{menuItems:()=>[{label:"Delete",callback:()=>{ce().transaction(({stateEditors:u})=>{u.coreByProject.historic.sheetsById.sequence.deleteKeyframes(B(R({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}var GU,p9,Xoe,jU,Yoe,Koe,Zoe,HU,pMe=A(()=>{Ie(),Il(),oa(),Ji(),GU=an(),p9=G(et()),Jt(),$a(),$a(),os(),Cl(),Mf(),pU(),AS(),jU=ge.circle(Xoe||(Xoe=X([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),Koe=ge.circle(Yoe||(Yoe=X([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: ew-resize;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Wi,jU,mf),Zoe=o=>{let[l,u]=bi(null),{index:m,trackData:_,itemKey:S}=o,M=_.keyframes[m],[P]=fMe(u,o),k=u7(S),L=o.which==="left"?0:1,z=fU([{type:"primitiveProp",keyframe:o.keyframe,pathToProp:o.pathToProp,propConfig:o.propConfig,sheetObject:o.sheetObject,trackId:o.trackId}]),$=hMe({node:u,props:o,onDetectedClick:j=>z.toggle(j,j.target instanceof Element?j.target:u)}),H=o.extremumSpace.fromValueSpace(L);return p9.default.createElement(p9.default.Fragment,null,p9.default.createElement(Koe,B(R(R(R({ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(M.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(H,") * 1px)")}},k.attrs),_1(M.position)),Nl.includePositionSnapAttrs(M.position)),{className:$?"beingDragged":""})),p9.default.createElement(jU,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(M.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(H,") * 1px)"),fill:k.flag===2?"white":void 0}}),z.node,P)},HU=Zoe}),hP,Qoe,Joe,eae,tae,mMe=A(()=>{hP=G(et()),Jt(),UU(),Joe=ge.path(Qoe||(Qoe=X([`
  stroke-width: 2;
  stroke: var(--main-color);
  stroke-dasharray: 3 2;
  fill: none;
  vector-effect: non-scaling-stroke;
  opacity: 0.3;
`]))),eae=o=>{let{index:l,trackData:u}=o,m="M 0 0 L 1 1",_=FU(u.keyframes[l].position,o.extremumSpace.fromValueSpace(0),0,o.extremumSpace.fromValueSpace(1)-o.extremumSpace.fromValueSpace(0));return hP.default.createElement(hP.default.Fragment,null,hP.default.createElement(Joe,{d:m,style:{transform:_}}))},tae=eae}),W0,nae,rae,iae,sae,oae,gMe=A(()=>{W0=G(et()),Jt(),UU(),oMe(),dMe(),pMe(),mMe(),rae=ge.g(nae||(nae=X([`
  /* position: absolute; */
`]))),iae=W0.default.createElement(W0.default.Fragment,null),sae=o=>{let{index:l,trackData:u,isScalar:m}=o,_=u.keyframes[l],S=u.keyframes[l+1],M=_.connectedRight&&!!S&&S.value!==_.value;return W0.default.createElement(rae,null,M?W0.default.createElement(W0.default.Fragment,null,W0.default.createElement(Loe,R({},o)),!_.type||_.type==="bezier"&&W0.default.createElement(W0.default.Fragment,null,W0.default.createElement(zU,B(R({},o),{which:"left"})),W0.default.createElement(zU,B(R({},o),{which:"right"})))):iae,m?W0.default.createElement($oe,R({},o)):W0.default.createElement(W0.default.Fragment,null,W0.default.createElement(HU,B(R({},o),{which:"left"})),W0.default.createElement(HU,B(R({},o),{which:"right"})),W0.default.createElement(tae,R({},o))))},oae=sae});function vMe(o,l){let u=1/0,m=-1/0;function _(S){u=Math.min(S,u),m=Math.max(S,m)}return o.forEach((S,M)=>{let P=gA(S.value,l);if(_(P),!S.connectedRight)return;let k=o[M+1];if(!k)return;let L=(typeof k.value=="number"?k.value:1)-P;_(P+S.handles[3]*L),_(P+k.handles[1]*L)}),[u,m]}function yMe(o){let l=0,u=1;function m(_){l=Math.min(_,l),u=Math.max(_,u)}return o.forEach((_,S)=>{if(!_.connectedRight)return;let M=o[S+1];M&&(m(_.handles[3]),m(M.handles[1]))}),[l,u]}var x1,aae,lae,_Me=A(()=>{yf(),x1=G(et()),pP(),gMe(),s9(),Sr(),aae=x1.default.memo(({layoutP:o,trackData:l,sheetObject:u,trackId:m,color:_,pathToProp:S})=>{let M=l7(qr(u.template.configPointer),S);if(v1(M))return console.error("Composite prop types cannot be keyframed"),x1.default.createElement(x1.default.Fragment,null);let[P,k]=(0,x1.useState)(!1),L=(0,x1.useMemo)(()=>{let j=new Set;return function(){let K=j.size===0;j.add(Q),K&&k(!0);function Q(){let re=j.size>0;j.delete(Q),re&&j.size===0&&k(!1)}return Q}},[]),z=(0,x1.useMemo)(()=>{let j=M.type==="number"?vMe(l.keyframes,M):yMe(l.keyframes),K=ae=>(ae-j[0])/(j[1]-j[0]),Q=ae=>j[0]+re(ae),re=ae=>ae*(j[1]-j[0]);return{fromValueSpace:K,toValueSpace:Q,deltaToValueSpace:re,lock:L}},[l.keyframes]),$=(0,x1.useRef)(void 0);P||($.current=z);let H=l.keyframes.map((j,K)=>x1.default.createElement(oae,{pathToProp:S,propConfig:M,itemKey:g0.forTrackKeyframe(u,m,j.id),keyframe:j,index:K,trackData:l,layoutP:o,sheetObject:u,trackId:m,isScalar:M.type==="number",key:j.id,extremumSpace:$.current,color:_}));return x1.default.createElement("g",{style:{"--main-color":HS[_].iconColor}},H)}),lae=aae}),cae,fP,uae,dae,xMe=A(()=>{Ie(),Sr(),cae=an(),fP=G(et()),_Me(),uae=o=>ri(()=>{let{sheetObject:l,trackId:u}=o,m=(0,cae.val)(ce().atomP.historic.coreByProject[l.address.projectId].sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[u]);return(m==null?void 0:m.type)!=="BasicKeyframedTrack"?(console.error("trackData type ".concat(m==null?void 0:m.type," is not yet supported on the graph editor")),fP.default.createElement(fP.default.Fragment,null)):fP.default.createElement(lae,B(R({},o),{trackData:m}))},[o.trackId,o.layoutP]),dae=uae});function hae({clippedSpaceRange:o,clippedSpaceWidth:l,fps:u,gapWidth:m=120},_){let S=1/u,M=o.end-o.start,P=l/(u*M),k=Math.floor(m/P),L=(k<u?fae(u).find(H=>H>=k):u*Math.floor(k/u))*S,z=Math.floor(o.start/L),$=Math.ceil(o.end/L);for(let H=z;H<=$;H++){let j=H*L,K=j%1===0;_(j,K)}}var fae,pae=A(()=>{V0(),fae=tf(o=>{let l=[];for(let u=1;u<=o;u++)o%u===0&&l.push(u);return l})});function bMe(o){let{clippedSpaceWidth:l,height:u,ctx:m,unitSpaceToClippedSpace:_,snapToGrid:S}=o;m.clearRect(0,0,l,u),hae(o,(M,P)=>{let k=S(M),L=Math.floor(_(k));m.strokeStyle=P?"rgba(225, 225, 225, 0.04)":"rgba(255, 255, 255, 0.01)",m.beginPath(),m.moveTo(L,0),m.lineTo(L,u),m.stroke(),m.closePath()})}var Gv,jv,mae,gae,vae,yae,_ae,xae,bae,Sae,WU,wae=A(()=>{Gv=an(),jv=G(et()),Jt(),pae(),Ie(),gae=ge.div(mae||(mae=X([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),yae=ge.canvas(vae||(vae=X([`
  position: relative;
  left: 0;
`]))),_ae=o=>{let l=o;return l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1},xae=()=>window.devicePixelRatio||1,bae=o=>xae()/_ae(o),Sae=({layoutP:o,width:l,height:u})=>{let m=(0,jv.useRef)(null),[_,S]=(0,jv.useState)(null),{ctx:M,ratio:P}=(0,jv.useMemo)(()=>{if(!_)return{};let k=_.getContext("2d"),L=bae(k);return{ctx:k,ratio:L}},[_]);return(0,jv.useLayoutEffect)(()=>{if(!M)return;_.width=l*P,_.height=u*P;let k=(0,Gv.prism)(()=>{let L=(0,Gv.val)(o.sheet).getSequence();return{ctx:M,clippedSpaceRange:(0,Gv.val)(o.clippedSpace.range),clippedSpaceWidth:(0,Gv.val)(o.clippedSpace.width),unitSpaceToClippedSpace:(0,Gv.val)(o.clippedSpace.fromUnitSpace),height:u,leftPadding:(0,Gv.val)(o.scaledSpace.leftPadding),fps:L.subUnitsPerUnit,snapToGrid:z=>L.closestGridPosition(z)}}).onChange(ce().ticker,L=>{M.save(),M.scale(P,P),bMe(L),M.restore()},!0);return()=>{k()}},[M,l,u,o]),jv.default.createElement(gae,{ref:m,style:{width:l+"px"}},jv.default.createElement(yae,{ref:S,style:{width:l+"px",height:u+"px"}}))},WU=Sae}),b1,Hv,HS,Tae,Eae,Mae,Cae,Aae,Pae,pP=A(()=>{Ie(),l9(),vA(),Sr(),b1=an(),Hv=G(et()),Jt(),LU(),nU(),xMe(),wae(),ff(),HS={1:{iconColor:"#b98b08"},2:{iconColor:"#70a904"},3:{iconColor:"#2e928a"},4:{iconColor:"#a943bb"},5:{iconColor:"#b90808"},6:{iconColor:"#b4bf0e"}},Eae=ge.div(Tae||(Tae=X([`
  position: absolute;
  right: 0;
  bottom: 0;
  padding-bottom: 25px;
  background: `,`;
`])),h1(.03,"#1a1c1e")),Cae=ge.svg(Mae||(Mae=X([`
  position: absolute;
  top: 0;
  left: 0;
  margin: 0;
  pointer-events: none;
`]))),Aae=({layoutP:o})=>ri(()=>{let l=(0,b1.val)(o.sheet),u=(0,b1.val)(ce().atomP.historic.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].sequenceEditor.selectedPropsByObject),m=(0,b1.val)(o.graphEditorDims.height),_=(0,b1.val)(o.scaledSpace.fromUnitSpace)(1),S=[];if(u)for(let[P,k]of Object.entries(u)){let L=l.getObject(P);if(!L)continue;let z=(0,b1.val)(L.template.getMapOfValidSequenceTracks_forStudio());for(let[$,H]of Object.entries(k)){let j=UF($),K=o9(z,j);K&&S.push(Hv.default.createElement(dae,{key:"graph-".concat(P,"-").concat($),sheetObject:L,pathToProp:j,layoutP:o,trackId:K,color:H}))}}let M=(0,b1.val)(o.rightDims.width);return Hv.default.createElement(Eae,{style:{width:M+"px",height:m+"px","--unitSpaceToScaledSpaceMultiplier":_,"--graphEditorVerticalSpace":"".concat((0,b1.val)(o.graphEditorVerticalSpace.space))}},Hv.default.createElement(WU,{layoutP:o,width:M,height:m}),Hv.default.createElement(LA,{layoutP:o,height:m},Hv.default.createElement(Cae,{width:w7,height:m,viewBox:"0 0 ".concat(w7," ").concat(m)},Hv.default.createElement("g",{style:{transform:"translate(".concat((0,b1.val)(o.scaledSpace.leftPadding),"px, ").concat((0,b1.val)(o.graphEditorDims.padding.top),"px)")}},S))))},[o]),Pae=Aae}),Rae,au,Iae,Nae,kae,Dae,qU,Oae,Lae,Fae,Uae,Bae,zae,Vae,Gae,jae,SMe=A(()=>{Ie(),l9(),gS(),Sr(),Rae=an(),au=G(et()),Jt(),kTe(),SA(),pP(),CA(),Dg(),$L(),Il(),Ote(),Iae={label:{color:"#9a9a9a"}},kae=ge(DF)(Nae||(Nae=X([""]))),qU=ge(MA)(Dae||(Dae=X([`
  display: flex;
  color: `,`;
  padding-left: calc(10px + var(--depth) * 10px);
  padding-right: 12px;
  align-items: center;
  justify-content: flex-end;
  box-sizing: border-box;
`])),Iae.label.color),Lae=ge.button(Oae||(Oae=X([`
  background: none;
  border: none;
  outline: none;
  display: flex;
  box-sizing: border-box;
  font-size: 14px;
  align-items: center;
  height: 100%;
  margin-left: 12px;
  color: `,`;

  &:not([disabled]):hover {
    color: white;
  }
`])),o=>o.isSelected?HS[o.graphEditorColor].iconColor:a9.offColor),Fae=()=>au.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"12",viewBox:"0 0 640 512"},au.default.createElement("g",{transform:"translate(0 100)"},au.default.createElement("path",{fill:"currentColor",d:"M368 32h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM208 88h-84.75C113.75 64.56 90.84 48 64 48 28.66 48 0 76.65 0 112s28.66 64 64 64c26.84 0 49.75-16.56 59.25-40h79.73c-55.37 32.52-95.86 87.32-109.54 152h49.4c11.3-41.61 36.77-77.21 71.04-101.56-3.7-8.08-5.88-16.99-5.88-26.44V88zm-48 232H64c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zM576 48c-26.84 0-49.75 16.56-59.25 40H432v72c0 9.45-2.19 18.36-5.88 26.44 34.27 24.35 59.74 59.95 71.04 101.56h49.4c-13.68-64.68-54.17-119.48-109.54-152h79.73c9.5 23.44 32.41 40 59.25 40 35.34 0 64-28.65 64-64s-28.66-64-64-64zm0 272h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32z"}))),Bae=ge.span(Uae||(Uae=X([`
  margin-right: 4px;
  `,`;

  `,`:hover & {
    color: #ccc;
  }
`])),_f,qU),Vae=ge.div(zae||(zae=X([`
  margin-right: auto;
  margin-left: 8px;
  display: flex;
  align-items: center;
  min-width: 0;
  flex: 1;

  /* Override some default input styles to fit in the row */
  input {
    font-size: 11px;
    height: 24px;
    padding: 2px 4px;
  }
`]))),Gae=({leaf:o})=>{var l;let u=r7(o.sheetObject.propsP,o.pathToProp),m=o.sheetObject,_=NTe(u,m,o.propConf),S=ri(()=>{let K=o.sheetObject.address,Q=Ef(o.pathToProp);return(0,Rae.val)(ce().atomP.historic.projects.stateByProjectId[K.projectId].stateBySheetId[K.sheetId].sequenceEditor.selectedPropsByObject[K.objectKey][Q])},[o]),M=(0,au.useRef)(!1),P=typeof S=="string";M.current=P;let k=(0,au.useCallback)(()=>{let K=o.sheetObject.address;ce().transaction(({stateEditors:Q})=>{M.current?Q.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removePropFromGraphEditor(B(R({},K),{pathToProp:o.pathToProp})):o.trackId&&(Q.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.addPropToGraphEditor(B(R({},K),{pathToProp:o.pathToProp})),Q.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!0}))})},[o]),L=(l=o.propConf.label)!=null?l:o.pathToProp[o.pathToProp.length-1],z=!!o.trackId,$=(0,au.useRef)(null);qL($.current,o);let[H]=Rl($.current,{menuItems:_.contextMenuItems}),j=TF[o.propConf.type];return au.default.createElement(kae,{depth:o.depth},H,au.default.createElement(qU,{ref:$,isEven:o.n%2===0,style:{height:o.nodeHeight+"px"},isSelected:P===!0},au.default.createElement(Bae,null,L),au.default.createElement(Vae,null,au.default.createElement(j,{editingTools:_,propConfig:o.propConf,value:_.value})),_.controlIndicators,au.default.createElement(Lae,{onClick:k,isSelected:P===!0,graphEditorColor:S??"1",style:{opacity:z?1:.25},disabled:!z},au.default.createElement(Fae,null))))},jae=Gae}),T7,mP,Hae,Wae=A(()=>{T7=G(et()),CA(),SMe(),kU(),dne(),gS(),mP=(o,l=!0)=>{let u="prop"+o.pathToProp[o.pathToProp.length-1];return o.shouldRender?o.type==="propWithChildren"?T7.default.createElement(Hae,{leaf:o,key:u,renderChildren:l}):T7.default.createElement(jae,{leaf:o,key:u}):T7.default.createElement(T7.default.Fragment,{key:u})},Hae=({leaf:o,renderChildren:l=!0})=>{var u;let m=r7(o.sheetObject.propsP,o.pathToProp),_=une(m,o.sheetObject,o.propConf);return T7.default.createElement(LF,{leaf:o,label:(u=o.propConf.label)!=null?u:o.pathToProp[o.pathToProp.length-1],isCollapsed:o.isCollapsed,contextMenuItems:_.contextMenuItems,toggleCollapsed:()=>S7(!o.isCollapsed,{sheetAddress:o.sheetObject.address,sheetItemKey:o.sheetItemKey})},l&&o.children.map(S=>mP(S)))}}),qae,$ae,Xae,Yae,wMe=A(()=>{qae=G(et()),CA(),Wae(),kU(),Ie(),dne(),Sr(),$ae=an(),RA(),yse(),Xae=({leaf:o,renderChildren:l=!0,layoutP:u})=>{let m=o.sheetObject,_=une(m.propsP,m,m.template.staticConfig),S=ri(()=>{var M;let P=PA(o),k=P.byPosition.size>0,L=(M=(0,$ae.pointerToPrism)(ce().atomP.ahistoric.clipboard.keyframesWithRelativePaths).getValue())!=null?M:[];return[{label:"Copy Keyframes",enabled:k,callback:()=>vse(o,P)},{label:"Paste Keyframes",enabled:L.length>0,callback:()=>mse(o,u,L)}]},[o,u]);return qae.default.createElement(LF,{leaf:o,label:o.sheetObject.address.objectKey,isCollapsed:o.isCollapsed,contextMenuItems:[..._.contextMenuItems,...S],toggleSelect:()=>{ce().transaction(({stateEditors:M})=>{M.studio.historic.panels.outline.selection.set([o.sheetObject])})},toggleCollapsed:()=>S7(!o.isCollapsed,{sheetAddress:o.sheetObject.address,sheetItemKey:o.sheetItemKey})},l&&o.children.map(M=>mP(M)))},Yae=Xae}),WS,$U,Kae,Zae,Qae,XU,Jae,e0e,t0e,n0e,TMe=A(()=>{WS=G(et()),Jt(),CA(),Dg(),$L(),Ie(),Il(),$U=an(),Zae=ge.li(Kae||(Kae=X([`
  --depth: `,`;
  margin: 0;
  padding: 0;
  list-style: none;
`])),o=>o.depth-1),XU=ge(MA)(Qae||(Qae=X([`
  padding-left: calc(var(--depth) * 10px);
  display: flex;
  align-items: stretch;
  color: #999;
  box-sizing: border-box;

  &:hover {
    background: rgba(255, 255, 255, 0.05);
  }
`]))),e0e=ge.span(Jae||(Jae=X([`
  `,`;
  overflow-x: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding-right: 4px;
  padding-left: 20px;
  line-height: 26px;
  flex-wrap: nowrap;
  color: #ccc;

  `,`:hover & {
    color: #fff;
  }
`])),_f,XU),t0e=({leaf:o})=>{let l=(0,WS.useRef)(null);qL(l.current,o);let u=o.subSequence.label===void 0?"":o.subSequence.label,m="".concat(u," (").concat(o.subSequence.sheetId,")"),[_]=Rl(l.current,{menuItems:()=>[{label:"Edit Label",callback:()=>{let S=prompt("Enter new label:",o.subSequence.label);S!==null&&S.trim()!==""&&ce().transaction(({stateEditors:M})=>{M.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{label:S.trim()}})})}},{label:"Edit Duration",callback:()=>{var S,M;let P=(S=o.subSequence.duration)!=null?S:0;if(P===0){let L=ce(),z=(0,$U.val)(L.projectsP)[o.sheet.address.projectId];P=(M=(0,$U.val)(z.pointers.historic.sheetsById[o.subSequence.sheetId].sequence.length))!=null?M:0}let k=prompt("Enter new duration (seconds):",String(P));if(k!==null){let L=parseFloat(k);!isNaN(L)&&L>0&&ce().transaction(({stateEditors:z})=>{z.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{duration:L}})})}}},{label:"Edit Time Scale",callback:()=>{var S;let M=(S=o.subSequence.timeScale)!=null?S:1,P=prompt("Enter new time scale:",String(M));if(P!==null){let k=parseFloat(P);!isNaN(k)&&k>0&&ce().transaction(({stateEditors:L})=>{L.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id,updates:{timeScale:k}})})}}},{label:"Delete Sub-sequence",callback:()=>{confirm('Are you sure you want to delete sub-sequence "'.concat(o.subSequence.label,'"?'))&&ce().transaction(({stateEditors:S})=>{S.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeSubSequence({sheetAddress:o.sheet.address,subSequenceId:o.subSequence.id})})}}]});return o.shouldRender?WS.default.createElement(Zae,{depth:o.depth},_,WS.default.createElement(XU,{ref:l,style:{height:o.nodeHeight+"px"},isEven:o.n%2===0},WS.default.createElement(e0e,null,m))):null},n0e=t0e}),qS,So,r0e,i0e,s0e,o0e,a0e,l0e,EMe=A(()=>{Sr(),qS=an(),So=G(et()),Jt(),wMe(),TMe(),OTe(),yf(),NU(),Toe(),xf(),bf(),Eoe(),IA(),Wae(),i0e=ge.div(r0e||(r0e=X([`
  position: absolute;
  left: 0;
  overflow-x: visible;

  &.drop-target {
    background: rgba(64, 170, 164, 0.1);
    outline: 2px dashed rgba(64, 170, 164, 0.5);
    outline-offset: -2px;
  }
`]))),o0e=ge.div(s0e||(s0e=X([`
  margin: 0 0 50px 0;
  padding: 0;
  position: relative;
`]))),a0e=({layoutP:o})=>{let{searchTerm:l,searchTrigger:u}=IU(),[m,_]=(0,So.useState)(!1),[S,M]=(0,So.useState)(null),P=(0,So.useRef)(null),k=XF();(0,So.useLayoutEffect)(()=>{let K=P.current;if(!K)return;let Q=re=>{re.stopPropagation()};return K.addEventListener("wheel",Q,{passive:!0}),()=>K.removeEventListener("wheel",Q)},[]);let L=su({debugName:"Left/addSubSequence"},()=>{if(!S)return So.default.createElement(So.default.Fragment,null);let K=S.sheetId;return So.default.createElement(ou,null,So.default.createElement("div",{style:{padding:"8px",minWidth:"300px"}},So.default.createElement("div",{style:{marginBottom:"8px",fontWeight:"bold",color:"#CCC"}},"Add Sub-sequence"),So.default.createElement("div",{style:{marginBottom:"4px",fontSize:"11px",color:"#999"}},"Label:"),So.default.createElement("input",{type:"text",defaultValue:S.sheetId,onChange:Q=>{K=Q.target.value},style:{width:"100%",padding:"6px 8px",marginBottom:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"2px",color:"#FFF",fontSize:"11px"},autoFocus:!0,onKeyDown:Q=>{Q.key==="Enter"?((0,qS.val)(o.sheet).getSequence().addSubSequence(S.sheetId,0,{label:K.trim()||S.sheetId}),L.close("user action"),M(null)):Q.key==="Escape"&&(L.close("user action"),M(null))}}),So.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"}},So.default.createElement("button",{onClick:()=>{L.close("user action"),M(null)},style:{padding:"6px 12px",background:"rgba(255, 255, 255, 0.1)",color:"#CCC",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"2px",cursor:"pointer",fontSize:"11px"}},"Cancel"),So.default.createElement("button",{onClick:()=>{(0,qS.val)(o.sheet).getSequence().addSubSequence(S.sheetId,0,{label:K.trim()||S.sheetId}),L.close("user action"),M(null)},style:{padding:"6px 12px",background:"#40AAA4",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"11px"}},"Ok"))))}),z=(0,So.useCallback)(K=>{K.preventDefault(),K.stopPropagation(),_(!0)},[]),$=(0,So.useCallback)(K=>{K.preventDefault(),K.stopPropagation(),_(!1);try{let Q=K.dataTransfer.getData("application/json");if(!Q)return;let re=JSON.parse(Q);if(re.type!=="theatre-sheet")return;M({sheetId:re.sheetId,projectId:re.projectId,sheetInstanceId:re.sheetInstanceId}),P.current&&L.open({clientX:K.clientX,clientY:K.clientY},P.current)}catch(Q){console.error("Error handling drop:",Q)}},[L]),{scrollTop:H,clientHeight:j}=qr(k);return ri(()=>{let K=(0,qS.val)(o.tree),Q=(0,qS.val)(o.leftDims.width),re=l.trim()?boe(K,l):K,ae=OU(re),ue=[],ye=500,Ae=H-ye,Ce=H+j+ye,Se=-1;for(let be=0;be<ae.length;be++){let Ue=ae[be];if(Ue.top+Ue.nodeHeight>=Ae){Se=be;break}}if(Se!==-1)for(let be=Se;be<ae.length;be++){let Ue=ae[be];if(Ue.top>Ce)break;ue.push(Ue)}let ft=ae[ae.length-1],ke=ft?ft.top+ft.nodeHeight:0;return So.default.createElement(So.default.Fragment,null,L.node,So.default.createElement(i0e,{id:"leftContainer",ref:P,style:{width:Q+"px",top:0,pointerEvents:S!==null?"none":"auto"},className:m?"drop-target":"",onDragOver:z,onDrop:$},So.default.createElement(o0e,{style:{height:ke+"px"}},ue.map(be=>{let Ue=null;return be.type==="subSequence"?Ue=So.default.createElement(n0e,{key:g0.forSubSequence(be.subSequence.id),leaf:be}):be.type==="sheetObject"?Ue=So.default.createElement(Yae,{key:"sheetObject-"+DTe(be.sheetObject),leaf:be,renderChildren:!1,layoutP:o}):(be.type==="propWithChildren"||be.type==="primitiveProp")&&(Ue=mP(be,!1)),Ue?So.default.createElement("div",{key:be.type+"-"+(be.sheetItemKey||be.top),style:{position:"absolute",top:be.top+"px",width:"100%"}},Ue):null}))))},[o,l,u,m,S,z,$,L.node,H,j])},l0e=a0e}),gP,vP,c0e,u0e,d0e,h0e,MMe=A(()=>{Ji(),Ie(),oa(),gP=an(),vP=G(et()),Jt(),Sr(),u0e=ge.div(c0e||(c0e=X([`
  position: absolute;
  top: 0;
  bottom: 0;
  width: 11px;
  margin-left: -5px;
  cursor: ew-resize;
  z-index: 1;
  pointer-events: auto;

  &:hover,
  &.isDragging {
    background: linear-gradient(
      to right,
      transparent 5px,
      #478698 5px,
      #478698 6px,
      transparent 6px
    );
  }
`]))),d0e=({layoutP:o})=>{let l=qr(o.leftDims.width),[u,m]=bi(null),_=(0,vP.useRef)(0),S=(0,vP.useMemo)(()=>({debugName:"DopesheetSplitter",lockCursorTo:"ew-resize",onDragStart(){var P;let k;return _.current=(P=(0,gP.val)(ce().atomP.historic.panels.sequenceEditor.dopesheetLeftWidth))!=null?P:(0,gP.val)(o.leftDims.width),{onDrag(L){let z=(0,gP.val)(o.dopeSheetDims.width)-100,$=Math.min(z,Math.max(225,_.current+L));k==null||k.discard(),k=ce().tempTransaction(({stateEditors:H})=>{H.studio.historic.panels.sequenceEditor.setDopesheetLeftWidth($)})},onDragEnd(L){L?k==null||k.commit():k==null||k.discard()}}}}),[]),[M]=ao(m,S);return vP.default.createElement(u0e,{ref:u,className:M?"isDragging":"",style:{left:"".concat(l,"px")}})},h0e=d0e}),YU,f0e,p0e,m0e,g0e,CMe=A(()=>{os(),M1(),Sr(),ff(),YU=G(et()),Jt(),wae(),p0e=ge.div(f0e||(f0e=X([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: hidden;
  background: `,`;
  pointer-events: none;
`])),()=>Rf.rightBackground,h1(.01,VO(1*.03,Hy.panel.bg))),m0e=({layoutP:o})=>{let l=qr(o.rightDims.width),u=qr(o.panelDims.height);return YU.default.createElement(p0e,{style:{width:l+"px"}},YU.default.createElement(WU,{width:l,height:u,layoutP:o}))},g0e=m0e}),Wv,v0e,y0e,_0e,x0e,AMe=A(()=>{Sr(),Wv=G(et()),Jt(),EMe(),MMe(),CMe(),LU(),IA(),y0e=ge.div(v0e||(v0e=X([`
  position: absolute;
  left: 0;
  right: 0;
`]))),_0e=({layoutP:o})=>{let l=qr(o.dopeSheetDims.height);return Wv.default.createElement(y0e,{style:{height:l+"px"}},Wv.default.createElement(g0e,{layoutP:o}),Wv.default.createElement(Jne,null,Wv.default.createElement(l0e,{layoutP:o}),Wv.default.createElement(Ioe,{layoutP:o})),Wv.default.createElement(h0e,{layoutP:o}))},x0e=_0e});function PMe(o,l,u){return KU.prism.memo(o,()=>(0,KU.prism)(l),u).getValue()}var KU,RMe=A(()=>{KU=an()});function Zs(o){return function(l,u){return o(l,u())}}function ad(o){return Object.freeze({audience:qv(o,8)?"internal":qv(o,16)?"dev":"public",category:qv(o,4)?"troubleshooting":qv(o,2)?"todo":"general",level:qv(o,512)?512:qv(o,256)?256:qv(o,128)?128:64})}function qv(o,l){return(o&l)===l}function Qs(o,l){return((l&32)===32?!0:(l&16)===16?o.dev:(l&8)===8?o.internal:!1)&&o.min<=l}function b0e(o=console,l={}){let u=B(R({},S1),{includes:R({},S1.includes)}),m={styled:kMe.bind(u,o),noStyle:OMe.bind(u,o)},_=NMe.bind(u);function S(){return u.loggingConsoleStyle&&u.loggerConsoleStyle?m.styled:m.noStyle}return u.create=S(),{configureLogger(M){var P;M==="console"?(u.loggerConsoleStyle=S1.loggerConsoleStyle,u.create=S()):M.type==="console"?(u.loggerConsoleStyle=(P=M.style)!=null?P:S1.loggerConsoleStyle,u.create=S()):M.type==="keyed"?(u.creatExt=k=>M.keyed(k.names),u.create=_):M.type==="named"&&(u.creatExt=IMe.bind(null,M.named),u.create=_)},configureLogging(M){var P,k,L,z,$;u.includes.dev=(P=M.dev)!=null?P:S1.includes.dev,u.includes.internal=(k=M.internal)!=null?k:S1.includes.internal,u.includes.min=(L=M.min)!=null?L:S1.includes.min,u.include=(z=M.include)!=null?z:S1.include,u.loggingConsoleStyle=($=M.consoleStyle)!=null?$:S1.loggingConsoleStyle,u.create=S()},getLogger(){return u.create({names:[]})}}}function IMe(o,l){let u=[];for(let{name:m,key:_}of l.names)u.push(_==null?m:"".concat(m," (").concat(_,")"));return o(u)}function NMe(o){let l=R(R({},this.includes),this.include(o)),u=this.filtered,m=this.named.bind(this,o),_=this.creatExt(o),S=Qs(l,524),M=Qs(l,522),P=Qs(l,521),k=Qs(l,529),L=Qs(l,545),z=Qs(l,265),$=Qs(l,268),H=Qs(l,273),j=Qs(l,289),K=Qs(l,137),Q=Qs(l,145),re=Qs(l,73),ae=Qs(l,81),ue=S?_.error.bind(_,lu._hmm):u.bind(o,524),ye=M?_.error.bind(_,lu._todo):u.bind(o,522),Ae=P?_.error.bind(_,lu._error):u.bind(o,521),Ce=k?_.error.bind(_,lu.errorDev):u.bind(o,529),Se=L?_.error.bind(_,lu.errorPublic):u.bind(o,545),ft=$?_.warn.bind(_,lu._kapow):u.bind(o,268),ke=z?_.warn.bind(_,lu._warn):u.bind(o,265),be=H?_.warn.bind(_,lu.warnDev):u.bind(o,273),Ue=j?_.warn.bind(_,lu.warnPublic):u.bind(o,273),Ze=K?_.debug.bind(_,lu._debug):u.bind(o,137),ze=Q?_.debug.bind(_,lu.debugDev):u.bind(o,145),Ft=re?_.trace.bind(_,lu._trace):u.bind(o,73),Ke=ae?_.trace.bind(_,lu.traceDev):u.bind(o,81),Yt={_hmm:ue,_todo:ye,_error:Ae,errorDev:Ce,errorPublic:Se,_kapow:ft,_warn:ke,warnDev:be,warnPublic:Ue,_debug:Ze,debugDev:ze,_trace:Ft,traceDev:Ke,lazy:{_hmm:S?Zs(ue):ue,_todo:M?Zs(ye):ye,_error:P?Zs(Ae):Ae,errorDev:k?Zs(Ce):Ce,errorPublic:L?Zs(Se):Se,_kapow:$?Zs(ft):ft,_warn:z?Zs(ke):ke,warnDev:H?Zs(be):be,warnPublic:j?Zs(Ue):Ue,_debug:K?Zs(Ze):Ze,debugDev:Q?Zs(ze):ze,_trace:re?Zs(Ft):Ft,traceDev:ae?Zs(Ke):Ke},named:m,utilFor:{internal(){return{debug:Yt._debug,error:Yt._error,warn:Yt._warn,trace:Yt._trace,named(mt,nt){return Yt.named(mt,nt).utilFor.internal()}}},dev(){return{debug:Yt.debugDev,error:Yt.errorDev,warn:Yt.warnDev,trace:Yt.traceDev,named(mt,nt){return Yt.named(mt,nt).utilFor.dev()}}},public(){return{error:Yt.errorPublic,warn:Yt.warnPublic,debug(mt,nt){Yt._warn('(public "debug" filtered out) '.concat(mt),nt)},trace(mt,nt){Yt._warn('(public "trace" filtered out) '.concat(mt),nt)},named(mt,nt){return Yt.named(mt,nt).utilFor.public()}}}}};return Yt}function kMe(o,l){let u=R(R({},this.includes),this.include(l)),m=[],_="";for(let k=0;k<l.names.length;k++){let{name:L,key:z}=l.names[k];if(_+=" %c".concat(L),m.push(this.style.css(L)),z!=null){let $="%c#".concat(z);_+=$,m.push(this.style.css($))}}let S=this.filtered,M=this.named.bind(this,l),P=[_,...m];return S0e(S,l,u,o,P,DMe(P),M)}function DMe(o){let l=o.slice(0);for(let u=1;u<l.length;u++)l[u]+=";background-color:#e0005a;padding:2px;color:white";return l}function OMe(o,l){let u=R(R({},this.includes),this.include(l)),m="";for(let P=0;P<l.names.length;P++){let{name:k,key:L}=l.names[P];m+=" ".concat(k),L!=null&&(m+="#".concat(L))}let _=this.filtered,S=this.named.bind(this,l),M=[m];return S0e(_,l,u,o,M,M,S)}function S0e(o,l,u,m,_,S,M){let P=Qs(u,524),k=Qs(u,522),L=Qs(u,521),z=Qs(u,529),$=Qs(u,545),H=Qs(u,265),j=Qs(u,268),K=Qs(u,273),Q=Qs(u,289),re=Qs(u,137),ae=Qs(u,145),ue=Qs(u,73),ye=Qs(u,81),Ae=P?m.error.bind(m,..._):o.bind(l,524),Ce=k?m.error.bind(m,..._):o.bind(l,522),Se=L?m.error.bind(m,..._):o.bind(l,521),ft=z?m.error.bind(m,..._):o.bind(l,529),ke=$?m.error.bind(m,..._):o.bind(l,545),be=j?m.warn.bind(m,...S):o.bind(l,268),Ue=H?m.warn.bind(m,..._):o.bind(l,265),Ze=K?m.warn.bind(m,..._):o.bind(l,273),ze=Q?m.warn.bind(m,..._):o.bind(l,273),Ft=re?m.info.bind(m,..._):o.bind(l,137),Ke=ae?m.info.bind(m,..._):o.bind(l,145),Yt=ue?m.debug.bind(m,..._):o.bind(l,73),mt=ye?m.debug.bind(m,..._):o.bind(l,81),nt={_hmm:Ae,_todo:Ce,_error:Se,errorDev:ft,errorPublic:ke,_kapow:be,_warn:Ue,warnDev:Ze,warnPublic:ze,_debug:Ft,debugDev:Ke,_trace:Yt,traceDev:mt,lazy:{_hmm:P?Zs(Ae):Ae,_todo:k?Zs(Ce):Ce,_error:L?Zs(Se):Se,errorDev:z?Zs(ft):ft,errorPublic:$?Zs(ke):ke,_kapow:j?Zs(be):be,_warn:H?Zs(Ue):Ue,warnDev:K?Zs(Ze):Ze,warnPublic:Q?Zs(ze):ze,_debug:re?Zs(Ft):Ft,debugDev:ae?Zs(Ke):Ke,_trace:ue?Zs(Yt):Yt,traceDev:ye?Zs(mt):mt},named:M,utilFor:{internal(){return{debug:nt._debug,error:nt._error,warn:nt._warn,trace:nt._trace,named(Ee,ct){return nt.named(Ee,ct).utilFor.internal()}}},dev(){return{debug:nt.debugDev,error:nt.errorDev,warn:nt.warnDev,trace:nt.traceDev,named(Ee,ct){return nt.named(Ee,ct).utilFor.dev()}}},public(){return{error:nt.errorPublic,warn:nt.warnPublic,debug(Ee,ct){nt._warn('(public "debug" filtered out) '.concat(Ee),ct)},trace(Ee,ct){nt._warn('(public "trace" filtered out) '.concat(Ee),ct)},named(Ee,ct){return nt.named(Ee,ct).utilFor.public()}}}}};return nt}var lu,S1,w0e=A(()=>{lu={_hmm:ad(524),_todo:ad(522),_error:ad(521),errorDev:ad(529),errorPublic:ad(545),_kapow:ad(268),_warn:ad(265),warnDev:ad(273),warnPublic:ad(289),_debug:ad(137),debugDev:ad(145),_trace:ad(73),traceDev:ad(81)},S1={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(o,l,u){return this.create({names:[...o.names,{name:l,key:u}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(o){if(o.length<5)return o;let l=o.replace(this.collapseOnRE,"");return this.cssMemo.has(l)||this.cssMemo.set(l,this.css(o)),l},css(o){var l,u,m,_;let S=this.cssMemo.get(o);if(S)return S;let M="color:".concat((u=(l=this.color)==null?void 0:l.call(this,o))!=null?u:"hsl(".concat((o.charCodeAt(0)+o.charCodeAt(o.length-1))%360,", 100%, 60%)"));return(m=this.bold)!=null&&m.test(o)&&(M+=";font-weight:600"),(_=this.italic)!=null&&_.test(o)&&(M+=";font-style:italic"),this.cssMemo.set(o,M),M}}}}),ZU,yP,_P=A(()=>{w0e(),w0e(),ZU=b0e(console,{}),ZU.configureLogging({dev:!0,min:64}),yP=ZU.getLogger().named("Theatre.js (default logger)").utilFor.dev()}),Gg,m9,T0e,LMe=A(()=>{yf(),Gg=an(),_P(),m9=28,T0e=(o,l)=>{Gg.prism.ensurePrism();let u=!1,m=30,_=0,S=l.atomP.ahistoric.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId].sequence.collapsableItems,M={type:"sheet",isCollapsed:!1,sheet:o,children:[],sheetItemKey:g0.forSheet(),shouldRender:u,top:60,depth:0,n:_,nodeHeight:0,heightIncludingChildren:-1};for(let K of Object.values((0,Gg.val)(o.objectsP)))K&&L(K,M.children,M.depth+1,!0);let P=(0,Gg.val)(l.atomP.historic.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId]),k=(0,Gg.val)(P.sequenceEditor);if(k){let K=k.subSequenceSet;if(K){let Q=Object.values(K.byId||{}).filter(re=>re!==void 0).map(re=>re).sort((re,ae)=>re.position-ae.position);for(let re of Q){let ae={type:"subSequence",subSequence:re,sheet:o,sheetItemKey:g0.forSubSequence(re.id),shouldRender:!0,top:m,depth:M.depth+1,n:_,nodeHeight:m9,heightIncludingChildren:m9};M.children.push(ae),m+=m9,_+=1}}}M.heightIncludingChildren=m-M.top;function L(K,Q,re,ae){var ue;let ye=(0,Gg.val)(K.template.getMapOfValidSequenceTracks_forStudio()),Ae=(0,Gg.val)(K.template.configPointer);if(Object.keys(Ae.props).length===0)return;let Ce=(ue=(0,Gg.val)(S.byId[g0.forSheetObject(K)].isCollapsed))!=null?ue:!0,Se={type:"sheetObject",isCollapsed:Ce,sheetItemKey:g0.forSheetObject(K),shouldRender:ae,top:m,children:[],depth:re,n:_,sheetObject:K,nodeHeight:m9,heightIncludingChildren:-1};Q.push(Se),_+=1,m+=Se.nodeHeight,z(K,Ae.props,ye,[],Ae,Se.children,re+1,!Ce),Se.heightIncludingChildren=m-Se.top}function z(K,Q,re,ae,ue,ye,Ae,Ce){for(let[Se,ft]of Object.entries(Q)){let ke=re[Se];$(K,ke,[...ae,Se],ft,ye,Ae,Ce)}}function $(K,Q,re,ae,ue,ye,Ae){ae.type==="compound"?H(K,Q||{},ae,re,ae,ue,ye,Ae):ae.type==="enum"?yP.warn("Prop type enum is not yet supported in the sequence editor"):j(K,Q,re,ae,ue,ye,Ae)}function H(K,Q,re,ae,ue,ye,Ae,Ce){var Se;let ft=(Se=(0,Gg.val)(S.byId[g0.forSheetObjectProp(K,ae)].isCollapsed))!=null?Se:!1,ke={type:"propWithChildren",isCollapsed:ft,propConf:re,pathToProp:ae,sheetItemKey:g0.forSheetObjectProp(K,ae),sheetObject:K,shouldRender:Ce,top:m,children:[],nodeHeight:Ce?m9:0,heightIncludingChildren:-1,depth:Ae,trackMapping:Q,n:_};ye.push(ke),Ce&&(m+=ke.nodeHeight,_+=1),z(K,ue.props,Q,ae,ue,ke.children,Ae+1,Ce&&!ft),ke.heightIncludingChildren=m-ke.top}function j(K,Q,re,ae,ue,ye,Ae){let Ce={type:"primitiveProp",propConf:ae,depth:ye,sheetItemKey:g0.forSheetObjectProp(K,re),sheetObject:K,pathToProp:re,shouldRender:Ae,top:m,nodeHeight:Ae?m9:0,heightIncludingChildren:Ae?m9:0,trackId:Q,n:_};ue.push(Ce),_+=1,m+=Ce.nodeHeight}return M}});function FMe(o,l){let u=ce(),m=u.atomP.ahistoric.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId],_=u.atomP.historic.projects.stateByProjectId[o.address.projectId].stateBySheetId[o.address.sheetId];return(0,v0.prism)(()=>{var S,M,P;let k=PMe("tree",()=>T0e(o,u),[]),L=(0,v0.val)(l),z=(0,v0.val)(u.atomP.historic.panels.sequenceEditor.graphEditor),$=u.atomP.historic.panels.sequenceEditor.rightPanelOpen,H=(S=(0,v0.val)($))!=null?S:!0,j=(0,v0.val)(_.sequenceEditor.selectedPropsByObject),K=!!j&&Object.keys(j).length>0,Q=(M=(0,v0.val)(u.atomP.historic.panels.sequenceEditor.dopesheetLeftWidth))!=null?M:Math.floor(L.width*E0e),{leftDims:re,rightDims:ae,graphEditorDims:ue,dopeSheetDims:ye,horizontalScrollbarDims:Ae}=v0.prism.memo("leftDims",()=>{var mt,nt;let Ee=(mt=(0,v0.val)($))!=null?mt:!0,ct={width:Q,height:L.height,screenX:L.screenX,screenY:L.screenY},Nt={width:Ee?L.width-ct.width:0,height:L.height,screenX:L.screenX+ct.width,screenY:L.screenY},Re=K&&(z==null?void 0:z.isOpen)===!0,it=Math.floor((Re?Zi((nt=z==null?void 0:z.height)!=null?nt:.5,.1,.7):0)*L.heightWithoutBorder),Ht=L.height,Kt={width:L.width,height:Ht,screenX:L.screenX,screenY:L.screenY},Et={isAvailable:K,isOpen:Re,width:Nt.width,height:it,screenX:L.screenX,screenY:L.screenY+Ht,padding:{top:20,bottom:20}};return{leftDims:ct,rightDims:Nt,graphEditorDims:Et,dopeSheetDims:Kt,horizontalScrollbarDims:{bottom:0}}},[L,z,K,$,Q]),Ce=v0.prism.memo("graphEditorVerticalSpace",()=>{let mt=ue.height-ue.padding.top-ue.padding.bottom;return{space:mt,fromExtremumSpace(nt){return nt*mt},toExtremumSpace(nt){return nt/mt}}},[ue]),[Se,ft]=v0.prism.state("isSeeking",!1),ke={isSeeking:Se,setIsSeeking:ft},be={},Ue=(P=(0,v0.val)(m.sequence.clippedSpaceRange))!=null?P:M0e,Ze=v0.prism.memo("scaledSpace",()=>{let mt=Ue.end-Ue.start,nt=ae.width,Ee=mt/nt,ct=nt/mt;return{fromUnitSpace(Nt){return Nt*ct},toUnitSpace(Nt){return Nt*Ee},leftPadding:10}},[Ue,ae.width]),ze=v0.prism.memo("setClippedSpaceRange",()=>function(mt){u.transaction(({stateEditors:nt})=>{let Ee=R({},mt);if(Ee.end<=Ee.start&&(Ee.end=Ee.start+1),Ee.start<0){let ct=Ee.end-Ee.start;Ee.start=0,Ee.end=ct}nt.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.clippedSpaceRange.set(B(R({},o.address),{range:Ee}))})},[]),Ft=v0.prism.memo("clippedSpace",()=>({range:Ue,width:ae.width,fromUnitSpace(mt){return Ze.fromUnitSpace(mt-Ue.start)+Ze.leftPadding},toUnitSpace(mt){return Ze.toUnitSpace(mt-Ze.leftPadding)+Ue.start},setRange:ze}),[Ue,ae.width,Ze,ze]),Ke=v0.prism.memo("selection.current",()=>new v0.Atom({current:void 0}),[]),Yt=v0.prism.memo("setRightPanelOpen",()=>function(mt){u.transaction(({stateEditors:nt})=>{nt.studio.historic.panels.sequenceEditor.setRightPanelOpen(mt)})},[]);return WL("finalAtom",{sheet:o,tree:k,panelDims:L,leftDims:re,rightDims:ae,dopeSheetDims:ye,horizontalScrollbarDims:Ae,seeker:ke,unitSpace:be,scaledSpace:Ze,clippedSpace:Ft,graphEditorDims:ue,graphEditorVerticalSpace:Ce,selectionAtom:Ke,rightPanelOpen:H,setRightPanelOpen:Yt}).pointer})}var v0,E0e,M0e,QU,UMe=A(()=>{Ie(),RMe(),MQ(),v0=an(),LMe(),V0(),E0e=.3,M0e={start:0,end:10},QU=250});function BMe(o){let{fullSecondStampsContainer:l,sequencePositionFormatter:u,snapToGrid:m,unitSpaceToClippedSpace:_}=o,S="";hae(o,(M,P)=>{let k=m(M),L=_(k);P?S+=C0e(u.formatFullUnitForGrid(k),L,"full-unit"):S+=C0e(u.formatSubUnitForGrid(k),L,"sub-unit")}),l.innerHTML=S}function C0e(o,l,u){return'<span class="'.concat(u,'" style="transform: translate3d(').concat(l.toFixed(1),'px, -50%, 0);">').concat(o,"</span>")}var $v,Xv,A0e,P0e,Yv,R0e,I0e,N0e,k0e,D0e,O0e,L0e=A(()=>{$v=an(),Xv=G(et()),Jt(),pae(),Ie(),P0e=ge.div(A0e||(A0e=X([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),Yv={fullUnitStampColor:"#999999",stampFontSize:"10px",subUnitStampColor:"#666666"},I0e=ge.div(R0e||(R0e=X([`
  position: absolute;
  top: 0;
  height: 100%;
  left: 0;
  overflow: hidden;
  z-index: 2;
  will-change: transform;
  pointer-events: none;
`]))),k0e=ge.div(N0e||(N0e=X([`
  position: absolute;
  top: 0;
  left: 0;

  & > span {
    position: absolute;
    display: block;
    top: 9px;
    left: -10px;
    color: `,`;
    text-align: center;
    font-size: `,`;
    width: 20px;

    &.full-unit {
      color: `,`;
    }

    &.sub-unit {
      color: `,`;
    }
  }

  pointer-events: none;
`])),Yv.fullUnitStampColor,Yv.stampFontSize,Yv.fullUnitStampColor,Yv.subUnitStampColor),D0e=({layoutP:o,width:l})=>{let u=(0,Xv.useRef)(null),[m,_]=(0,Xv.useState)(null);return(0,Xv.useLayoutEffect)(()=>{if(m)return(0,$v.prism)(()=>{let S=(0,$v.val)(o.sheet).getSequence();return{fullSecondStampsContainer:m,clippedSpaceRange:(0,$v.val)(o.clippedSpace.range),clippedSpaceWidth:(0,$v.val)(o.clippedSpace.width),unitSpaceToClippedSpace:(0,$v.val)(o.clippedSpace.fromUnitSpace),leftPadding:(0,$v.val)(o.scaledSpace.leftPadding),fps:S.subUnitsPerUnit,sequencePositionFormatter:S.positionFormatter,snapToGrid:M=>S.closestGridPosition(M)}}).onChange(ce().ticker,BMe,!0)},[m,l,o]),Xv.default.createElement(P0e,{ref:u,style:{width:l+"px"}},Xv.default.createElement(I0e,{style:{width:l+"px"}},Xv.default.createElement(k0e,{ref:_})))},O0e=D0e});function zMe(o){let[l,u]=(0,JU.useState)(!1);return(0,JU.useEffect)(()=>{if(u(!1),!o)return;let m=S=>{S.target===o?u(!0):u(!1)},_=()=>{u(!1)};return o.addEventListener("mouseenter",m),o.addEventListener("mousemove",m),o.addEventListener("mouseleave",_),()=>{u(!1),o.removeEventListener("mouseenter",m),o.removeEventListener("mousemove",m),o.removeEventListener("mouseleave",_)}},[o]),l}var JU,VMe=A(()=>{JU=G(et())});function GMe(o,l){let u=0,[m,_]=o,[S,M]=l;return _-m>M-S?[S,M]:(m<S&&(u=0-m),_>M&&(u=M-_),[m+u,_+u])}var w1,g9,Na,eB,F0e,xP,U0e,B0e,z0e=A(()=>{w1=an(),Sr(),os(),Ie(),Zv(),Il(),oa(),Ji(),g9=G(et()),Jt(),$a(),Na={enabled:{backgroundColor:"#2C2F34",stroke:"#646568"},disabled:{backgroundColor:"#282a2cc5",stroke:"#595a5d"},hover:{backgroundColor:"#34373D",stroke:"#C8CAC0"},dragging:{backgroundColor:"#3F444A",stroke:"#C8CAC0"},thumbWidth:9,hitZoneWidth:26,rangeStripMinWidth:30},eB=1e3,xP=ge.div(F0e||(F0e=X([`
  position: absolute;
  height: `,`px;
  background-color: `,`;
  cursor: grab;
  top: 0;
  left: 0;
  width: `,`px;
  transform-origin: left top;
  &:hover {
    background-color: `,`;
  }
  &.dragging {
    background-color: `,`;
    cursor: grabbing !important;
  }
  `,`;

  /* covers the one pixel space between the focus range strip and the top strip
  of the sequence editor panel, which would have caused that one pixel to act
  like a panel drag zone */
  &:after {
    display: block;
    content: ' ';
    position: absolute;
    bottom: -1px;
    height: 1px;
    left: 0;
    right: 0;
    background: transparent;
    pointer-events: normal;
    z-index: -1;
  }
`])),()=>E1-1,o=>o.enabled?Na.enabled.backgroundColor:Na.disabled.backgroundColor,eB,Na.hover.backgroundColor,Na.dragging.backgroundColor,Wi),U0e=({layoutP:o})=>{let l=(0,g9.useMemo)(()=>(0,w1.prism)(()=>{let{projectId:L,sheetId:z}=(0,w1.val)(o.sheet).address;return(0,w1.val)(ce().atomP.ahistoric.projects.stateByProjectId[L].stateBySheetId[z].sequence.focusRange)}),[o]),[u,m]=bi(null),[_]=Rl(m,{menuItems:()=>{let L=(0,w1.val)(o.sheet),z=l.getValue();return[{label:"Delete focus range",callback:()=>{ce().tempTransaction(({stateEditors:$})=>{$.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.unset(R({},L.address))}).commit()}},{label:z!=null&&z.enabled?"Disable focus range":"Enable focus range",callback:()=>{z!==void 0&&ce().tempTransaction(({stateEditors:$})=>{$.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(B(R({},L.address),{range:z.range,enabled:!z.enabled}))}).commit()}}]}}),S=qr(o.scaledSpace.toUnitSpace),M=qr(o.sheet),P=(0,g9.useMemo)(()=>{let L,z;return{debugName:"FocusRangeStrip",onDragStart($){let H,j=l.getValue();if(!j)return!1;let K=j.range.start,Q=j.range.end,re=!1,ae=(0,w1.val)(o.sheet).getSequence();return{onDrag(ue){if(j=l.getValue(),j){re=!0;let ye=S(ue),Ae=K+ye,Ce=Q+ye;Ce<Ae&&(Ce=Ae),[L,z]=GMe([Ae,Ce],[0,ae.length]).map(Se=>ae.closestGridPosition(Se)),H&&H.discard(),H=ce().tempTransaction(({stateEditors:Se})=>{var ft;Se.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(B(R({},M.address),{range:{start:L,end:z},enabled:(ft=j==null?void 0:j.enabled)!=null?ft:!0}))})}},onDragEnd(){j&&(re&&H!==void 0?H.commit():H&&H.discard())}}},lockCSSCursorTo:"grabbing"}},[M,S]),[k]=ao(m,P);return y1(k,-1),ri(()=>{let L=l.getValue(),z=(L==null?void 0:L.range)||{start:0,end:0},$=(0,w1.val)(o.clippedSpace.fromUnitSpace)(z.start),H=(0,w1.val)(o.clippedSpace.fromUnitSpace)(z.end),j,K;return $<0&&($=0),H>(0,w1.val)(o.clippedSpace.width)&&(H=(0,w1.val)(o.clippedSpace.width)),$>H?(K=0,j=0):(K=$,j=(H-$)/eB),L?g9.default.createElement(g9.default.Fragment,null,_,g9.default.createElement(xP,{id:"range-strip",enabled:L.enabled,className:"".concat(k?"dragging":""," ").concat(L.enabled?"enabled":""),ref:u,style:{transform:"translateX(".concat(K,"px) scale(").concat(j,", 1)")}})):g9.default.createElement(g9.default.Fragment,null)},[o,u,l,_,k])},B0e=U0e}),v9,jg,V0e,G0e,j0e,H0e,W0e,q0e,$0e,tB,jMe=A(()=>{v9=an(),Sr(),Ie(),Zv(),Cl(),oa(),Ji(),jg=G(et()),Jt(),$a(),z0e(),Mf(),G0e=ge.div(V0e||(V0e=X([`
  position: absolute;
  top: 0;
  // the right handle has to be pulled back by its width since its right side indicates its position, not its left side
  left: `,`px;
  transform-origin: left top;
  width: `,`px;
  height: `,`px;
  z-index: 3;

  --bg: `,`;

  stroke: `,`;
  user-select: none;

  cursor: `,`;

  // no pointer events unless pointer-root is in normal mode _and_ the
  // focus range is enabled
  #pointer-root & {
    pointer-events: none;
  }

  #pointer-root.normal & {
    pointer-events: auto;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.dragging {
    pointer-events: none !important;
  }

  // highlight the handle if it's hovered, or the whole strip is hovverd
  `,`:hover ~ &, &:hover {
    --bg: `,`;
    stroke: `,`;
  }

  // highlight the handle when it's being dragged or the whole strip is being dragged.
  // using dragging.dragging to give this selector priority, as it seems to be overridden
  // by the hover selector above
  &.dragging,
  `,`.dragging.dragging ~ & {
    --bg: `,`;
    stroke: `,`;
  }

  #pointer-root.draggingPositionInSequenceEditor &:hover {
    --bg: `,`;
    stroke: #40aaa4;
  }

  background-color: var(--bg);

  // a larger hit zone
  &:before {
    display: block;
    content: ' ';
    position: absolute;
    inset: -8px;
  }
`])),o=>o.type==="start"?0:-Na.thumbWidth,Na.thumbWidth,()=>E1-1,({enabled:o})=>o?Na.enabled.backgroundColor:Na.disabled.backgroundColor,Na.enabled.stroke,o=>o.type==="start"?"w-resize":"e-resize",mf,()=>xP,Na.hover.backgroundColor,Na.hover.stroke,()=>xP,Na.dragging.backgroundColor,Na.dragging.stroke,Na.dragging.backgroundColor),H0e=ge.div(j0e||(j0e=X([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    var(--bg) 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),o=>o.type==="start"?90:-90,o=>o.type==="start"?Na.thumbWidth:-Na.thumbWidth+1),q0e=ge.div(W0e||(W0e=X([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    `,` 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),o=>o.type==="start"?-90:90,()=>$S.backgroundColor,o=>o.type==="start"?-12:Na.thumbWidth),$0e=({layoutP:o,thumbType:l})=>{var u;let[m,_]=bi(null),S=(0,jg.useMemo)(()=>(0,v9.prism)(()=>{let{projectId:L,sheetId:z}=(0,v9.val)(o.sheet).address;return(0,v9.val)(ce().atomP.ahistoric.projects.stateByProjectId[L].stateBySheetId[z].sequence.focusRange)}),[o]),M=(0,jg.useMemo)(()=>({debugName:"FocusRangeThumb",onDragStart(){let L,z,$=(0,v9.val)(o.sheet),H={start:0,end:$.getSequence().length},j=S.getValue()||{range:H,enabled:!1},K=j.enabled,Q=j.range[l],re=(0,v9.val)(o.scaledSpace.toUnitSpace),ae=re(Na.rangeStripMinWidth);return{onDrag(ue,ye,Ae){var Ce;let Se,ft=Nl.checkIfMouseEventSnapToPos(Ae,{ignore:_});if(ft==null){let be=re(ue);Se=Q+be}else Se=ft;z=((Ce=S.getValue())==null?void 0:Ce.range)||H,l==="start"?Se=Math.max(Math.min(Se,z.end-ae),0):Se=Math.min(Math.max(Se,z.start+ae),$.getSequence().length);let ke=$.getSequence().closestGridPosition(Se);L!==void 0&&L.discard(),L=ce().tempTransaction(({stateEditors:be})=>{be.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(B(R({},$.address),{range:B(R({},z),{[l]:ke}),enabled:K}))})},onDragEnd(ue){ue?L==null||L.commit():L==null||L.discard()}}}}),[o]),[P]=ao(_,M);iu(P,"draggingPositionInSequenceEditor",l==="start"?"w-resize":"e-resize");let k=qr(S);return y1(P,(u=k==null?void 0:k.range[l])!=null?u:0),ri(()=>{let L=S.getValue();if(!L)return null;let{enabled:z}=L,$=L.range[l],H=(0,v9.val)(o.clippedSpace.fromUnitSpace)($);return(H<0||(0,v9.val)(o.clippedSpace.width)<H)&&(H=-1e4),jg.default.createElement(G0e,B(R(R({ref:m},Nl.includePositionSnapAttrs($)),_1($)),{className:"".concat(P&&"dragging"," ").concat(z&&"enabled"),enabled:z,type:l,style:{transform:"translate3d(".concat(H,"px, 0, 0)")}}),jg.default.createElement(H0e,{type:l,enabled:z}),jg.default.createElement(q0e,{type:l}),jg.default.createElement("svg",{viewBox:"0 0 9 18",xmlns:"http://www.w3.org/2000/svg"},jg.default.createElement("line",{x1:"4",y1:"6",x2:"4",y2:"12"}),jg.default.createElement("line",{x1:"6",y1:"6",x2:"6",y2:"12"})))},[o,m,S,P])},tB=$0e});function HMe(o,l){let[u,m]=(0,T1.useState)("none");return iu(u!=="none","dragging",u==="creating"?"ew-resize":"move"),(0,T1.useMemo)(()=>{let _=()=>({debugName:"FocusRangeZone/focusRangeCreationGestureHandlers",onDragStart(M){let P,k=(0,Kv.val)(o.clippedSpace.toUnitSpace),L=(0,Kv.val)(o.scaledSpace.toUnitSpace),z=(0,Kv.val)(o.sheet),$=z.getSequence(),H=M.target.getBoundingClientRect(),j=k(M.clientX-H.left),K=L(Na.rangeStripMinWidth);return{onDrag(Q){let re=L(Q),ae=j,ue=j+re;[ae,ue]=[Zi(ae,0,$.length),Zi(ue,0,$.length)].map(ye=>$.closestGridPosition(ye)),ue<ae?[ae,ue]=[Math.max(Math.min(ue,ae-K),0),ae]:Q>0&&(ue=Math.min(Math.max(ue,ae+K),$.length)),P&&P.discard(),P=ce().tempTransaction(({stateEditors:ye})=>{ye.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(B(R({},z.address),{range:{start:ae,end:ue},enabled:!0}))})},onDragEnd(Q){Q&&P!==void 0?P.commit():P&&P.discard()}}},lockCSSCursorTo:"ew-resize"}),S=()=>({debugName:"FocusRangeZone/panelMoveGestureHandlers",onDragStart(){let M,P=l.current,k=l.current.addBoundsHighlightLock();return{onDrag(L,z){let $=B(R({},P.dims),{top:Zi(P.dims.top+z,0,window.innerHeight-f1),left:Zi(P.dims.left+L,-P.dims.width+f1,window.innerWidth-f1)}),H=XC($,{width:window.innerWidth,height:window.innerHeight});M==null||M.discard(),M=ce().tempTransaction(({stateEditors:j})=>{j.studio.historic.panelPositions.setPanelPosition({position:H,panelId:P.panelId})})},onDragEnd(L){k(),L?M==null||M.commit():M==null||M.discard()}}},lockCSSCursorTo:"move"});return{debugName:"FocusRangeZone",onDragStart(M){let[P,k]=M.shiftKey?["creating",_().onDragStart(M)]:["moving-panel",S().onDragStart(M)];return m(P),k===!1?!1:{onDrag(L,z,$,H,j){k.onDrag(L,z,$,H,j)},onDragEnd(L){var z;m("none"),(z=k.onDragEnd)==null||z.call(k,L)}}}}},[o,l])}var Kv,T1,X0e,Y0e,K0e,Z0e,WMe=A(()=>{Kv=an(),Sr(),Ie(),Ky(),Zv(),Cl(),oa(),VMe(),Fne(),Ji(),V0(),T1=G(et()),Jt(),z0e(),jMe(),n9(),Y0e=ge.div(X0e||(X0e=X([`
  position: absolute;
  height: `,`px;
  left: 0;
  right: 0;
  box-sizing: border-box;
  /* Use the "grab" cursor if the shift key is up, which is the one used on the top strip of the sequence editor */
  cursor: `,`;
`])),()=>E1,o=>o.isShiftDown?"ew-resize":"move"),K0e=({layoutP:o})=>{let[l,u]=bi(null),m=Yy(),_=(0,T1.useRef)(m);_.current=m;let S=(0,T1.useMemo)(()=>(0,Kv.prism)(()=>{let{projectId:k,sheetId:L}=(0,Kv.val)(o.sheet).address;return(0,Kv.val)(ce().atomP.ahistoric.projects.stateByProjectId[k].stateBySheetId[L].sequence.focusRange)}),[o]);ao(u,HMe(o,_));let M=One("Shift"),P=zMe(u);return(0,T1.useEffect)(()=>{if(!M&&P)return _.current.addBoundsHighlightLock()},[!M&&P]),ri(()=>T1.default.createElement(Y0e,{ref:l,isShiftDown:M},T1.default.createElement(B0e,{layoutP:o}),T1.default.createElement(tB,{thumbType:"start",layoutP:o}),T1.default.createElement(tB,{thumbType:"end",layoutP:o})),[o,S,M])},Z0e=K0e}),E7,E1,$S,Q0e,J0e,ele,tle,Zv=A(()=>{Sr(),E7=G(et()),Jt(),L0e(),$a(),os(),WMe(),E1=30,$S={backgroundColor:"#1f2120eb",borderColor:"#1c1e21"},J0e=ge.div(Q0e||(Q0e=X([`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: `,`px;
  box-sizing: border-box;
  background: `,`;
  border-bottom: 1px solid `,`;
  z-index: -10;
  `,`;
`])),E1,$S.backgroundColor,$S.borderColor,Wi),ele=({layoutP:o})=>{let l=qr(o.rightDims.width);return E7.default.createElement(E7.default.Fragment,null,E7.default.createElement(J0e,R({},_1("hide")),E7.default.createElement(O0e,{layoutP:o,width:l,height:E1}),E7.default.createElement(Z0e,{layoutP:o})))},tle=ele}),Qv,nle,rle,ile,sle,ole,ale,lle,cle,qMe=A(()=>{Qv=G(et()),Jt(),Sr(),Ie(),xS(),Dg(),nle=o=>isFinite(o)&&o>0,ile=ge.div(rle||(rle=X([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),ole=ge.div(sle||(sle=X([`
  `,`;
  white-space: nowrap;
`])),_f),ale=({deltaX:o})=>o*.25,lle=({layoutP:o})=>{let l=qr(o.sheet),u=(0,Qv.useMemo)(()=>{let _;return{temporarilySetValue(S){_&&(_.discard(),_=void 0),_=ce().tempTransaction(({stateEditors:M})=>{M.coreByProject.historic.sheetsById.sequence.setLength(B(R({},l.address),{length:S}))})},discardTemporaryValue(){_&&(_.discard(),_=void 0)},permanentlySetValue(S){_&&(_.discard(),_=void 0),ce().transaction(({stateEditors:M})=>{M.coreByProject.historic.sheetsById.sequence.setLength(B(R({},l.address),{length:S}))})}}},[o,l]),m=(0,Qv.useRef)(null);return(0,Qv.useLayoutEffect)(()=>{m.current.focus()},[]),ri(()=>{let _=l.getSequence().length;return Qv.default.createElement(ile,null,Qv.default.createElement(ole,null,"Sequence length"),Qv.default.createElement(i7,B(R({value:_},u),{isValid:nle,inputRef:m,nudge:ale})))},[l,u,m])},cle=lle});function $Me(o,l){let u=(0,cu.useRef)(l);u.current=l;let m=(0,cu.useMemo)(()=>({debugName:"LengthIndicator/useDragBulge",lockCSSCursorTo:"ew-resize",onDragStart(S){let M,P=u.current,k=(0,Jv.val)(u.current.layoutP.sheet),L=k.getSequence().length,z=(0,Jv.val)(P.layoutP.scaledSpace.toUnitSpace);return{onDrag($,H,j){let K=z($);M&&(M.discard(),M=void 0),M=ce().tempTransaction(({stateEditors:Q})=>{Q.coreByProject.historic.sheetsById.sequence.setLength(B(R({},k.address),{length:L+K}))})},onDragEnd($){$?M&&M.commit():M&&M.discard()}}}}),[]),[_]=ao(o,m);return y1(_,-1),[_]}var Jv,cu,nB,XS,ule,y9,dle,hle,fle,ple,mle,gle,vle,yle,_le,xle,ble,XMe=A(()=>{Sr(),Jv=an(),cu=G(et()),Jt(),M1(),Zv(),Ji(),oa(),Ie(),xf(),$a(),mS(),qMe(),os(),bf(),nB=1e3,XS={stripNormal:"#0000006c",stripActive:"#000000"},y9=ge.div(ule||(ule=X([`
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  z-index: `,`;
  pointer-events: none;

  &:after {
    display: block;
    content: ' ';
    position: absolute;
    /* top: `,`px; */
    top: 0;
    bottom: 0;
    left: -1px;
    width: 1px;
    background-color: `,`;
  }

  &:hover:after,
  &.dragging:after {
    background-color: `,`;
  }
`])),()=>Rf.lengthIndicatorStrip,E1,XS.stripNormal,XS.stripActive),hle=ge.div(dle||(dle=X([`
  position: absolute;
  top: `,`px;
  width: 100px;
  left: -50px;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 1;
`])),E1-15),ple=ge.div(fle||(fle=X([`
  margin-top: 8px;
  font-size: 10px;
  white-space: nowrap;
  padding: 2px 8px;
  border-radius: 2px;
  `,`;
  cursor: ew-resize;
  color: #464646;
  background-color: #0000004d;
  display: none;

  `,":hover &, ",`.dragging & {
    display: block;
    color: white;
    background-color: `,`;
  }
`])),Wi,y9,y9,XS.stripActive),gle=ge.div(mle||(mle=X([`
  font-size: 10px;
  white-space: nowrap;
  padding: 1px 2px;
  border-radius: 2px;
  `,`;
  justify-content: center;
  align-items: center;
  cursor: ew-resize;
  color: #5d5d5d;
  background-color: #191919;

  `,":hover &, ",`.dragging & {
    color: white;
    background-color: `,`;

    & > svg:first-child {
      margin-right: -1px;
    }
  }

  & > svg:first-child {
    margin-right: -4px;
  }
`])),Wi,y9,y9,XS.stripActive),yle=ge.div(vle||(vle=X([`
  position: absolute;
  top: 0;
  left: 0;
  background-color: rgb(23 23 23 / 43%);
  width: `,`px;
  z-index: `,`;
  transform-origin: left top;

  `,".dragging ~ &, ",`:hover ~ & {
    background-color: rgb(23 23 23 / 60%);
  }
`])),nB,()=>Rf.lengthIndicatorCover,y9,y9),_le=-1e4,xle=({layoutP:o})=>{let[l,u]=bi(null),[m]=$Me(u,{layoutP:o}),{node:_,toggle:S,close:M}=su({debugName:"LengthIndicator"},()=>cu.default.createElement(ou,null,cu.default.createElement(cle,{layoutP:o,onRequestClose:M})));return ri(()=>{let P=(0,Jv.val)(o.sheet),k=(0,Jv.val)(o.rightDims.height),L=P.getSequence(),z=L.length,$=z,H=(0,Jv.val)(o.clippedSpace.fromUnitSpace)($),j=(0,Jv.val)(o.clippedSpace.width),K,Q;return H>j?(Q=0,K=0):(H<0&&(H=0),Q=H,K=(j-H)/nB),cu.default.createElement(cu.default.Fragment,null,_,cu.default.createElement(y9,{style:{height:k+"px",transform:"translateX(".concat(Q===0?_le:Q,"px)")},className:m?"dragging":""},cu.default.createElement(hle,null,cu.default.createElement(gle,R({ref:l,onClick:re=>{S(re,u)}},_1("hide")),cu.default.createElement(fwe,null),cu.default.createElement(pwe,null)),cu.default.createElement(ple,null,"Sequence length:"," ",L.positionFormatter.formatBasic(z)))),cu.default.createElement(yle,{title:"Length",style:{height:k+"px",transform:"translateX(".concat(Q,"px) scale(").concat(K,", 1)")}}))},[o,l,m,_])},ble=xle}),rB,Hg,Sle,wle,Tle,Ele,Mle,Cle,Ale,Ple,YMe=A(()=>{Sr(),rB=an(),Hg=G(et()),Jt(),L0e(),M1(),Zv(),$a(),wle=ge.div(Sle||(Sle=X([`
  position: absolute;
  top: 0;
  left: 0;
  margin-top: 0px;
`]))),Ele=ge.div(Tle||(Tle=X([`
  position: absolute;
  top: 16px;
  font-size: `,`;
  color: `,`;
  text-align: center;
  transform: translateX(-50%);
  background: `,`;
  padding: 1px 8px;
  font-variant-numeric: tabular-nums;
  pointer-events: none;
  z-index: `,`;
`])),Yv.stampFontSize,Yv.fullUnitStampColor,$S.backgroundColor,()=>Rf.currentFrameStamp),Cle=ge.div(Mle||(Mle=X([`
  position: absolute;
  top: 5px;
  left: -0px;
  bottom: 0;
  width: 0.5px;
  background: rgba(100, 100, 100, 0.2);
  pointer-events: none;
`]))),Ale=Hg.default.memo(({layoutP:o})=>{let[l,u]=qr(sre()),m=qr(o.clippedSpace.fromUnitSpace),{sequence:_,formatter:S,clippedSpaceWidth:M}=ri(()=>{let z=(0,rB.val)(o.sheet).getSequence(),$=(0,rB.val)(o.clippedSpace.width);return{sequence:z,formatter:z.positionFormatter,clippedSpaceWidth:$}},[o]);if(l==-1)return Hg.default.createElement(Hg.default.Fragment,null);let P=u===3?_.closestGridPosition(l):l,k=m(P),L=k>=0&&k<=M;return Hg.default.createElement(Hg.default.Fragment,null,Hg.default.createElement(wle,null,Hg.default.createElement(Ele,{style:{opacity:L?1:0,transform:"translate3d(calc(".concat(k,"px - 50%), 0, 0)")}},S.formatForPlayhead(P)),Hg.default.createElement(Cle,{posType:u,style:{opacity:L?1:0,transform:"translate3d(".concat(k,"px, 0, 0)")}}))," ")}),Ple=Ale}),sh,wo,Rle,Ile,Nle,kle,Dle,bP,Ole,iB,Lle,SP,Fle,wP,Ule,sB,Ble,oB,zle,Vle,KMe=A(()=>{Sr(),sh=an(),aC(),ff(),wo=G(et()),Jt(),M1(),$a(),os(),oa(),Ile=ge.div(Rle||(Rle=X([`
  --threadHeight: 20px;
  --bg-inactive: #32353b;
  --bg-active: #5b5c5d;
  position: absolute;
  height: 0;
  width: 100%;
  left: 12px;
  /* bottom: 8px; */
  z-index: `,`;
  `,`
`])),()=>Rf.horizontalScrollbar,Wi),kle=ge.div(Nle||(Nle=X([`
  position: relative;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--threadHeight);
`]))),bP=ge.div(Dle||(Dle=X([`
  position: absolute;
  height: 20px;
  background: var(--bg-inactive);
  cursor: ew-resize;
  z-index: 2;

  &:hover,
  &:active {
    background: var(--bg-active);
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),BO("absolute","-4px")),iB=ge.div(Ole||(Ole=X([`
  position: absolute;
  height: 20px;
  width: 7px;
  left: 0;
  z-index: 2;
  top: 0;
  bottom: 0;
  display: block;

  &:hover:before {
    background: var(--bg-active);
  }

  &:before {
    `,`;
    display: block;
    content: ' ';
    background: var(--bg-inactive);
    border-radius: 0 2px 2px 0;
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),BO("absolute","0"),BO("absolute","-4px")),SP=ge(iB)(Lle||(Lle=X([`
  left: calc(-1 * 7px);
  cursor: w-resize;
  &:before {
    transform: scaleX(-1);
  }
`]))),wP=ge(iB)(Fle||(Fle=X([`
  cursor: e-resize;
  left: 0px;
`]))),sB=ge.div(Ule||(Ule=X([`
  display: `,`;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 4px;
  transform: translateX(-50%);
  background: #131d1f;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;

  `,`:hover &,
  `,`:hover &,
  `,":hover ~ ",` &,
  `,":hover ~ ",` & {
    display: block;
  }
`])),o=>o.active?"block":"none",SP,wP,bP,SP,bP,wP),oB=ge.input(Ble||(Ble=X([`
  background: transparent;
  border: none;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;
  width: 40px;
  outline: none;

  &:focus {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
  }
`]))),zle=({layoutP:o})=>{let l=(0,wo.useCallback)(be=>be.toFixed(2),[]),u=(0,wo.useMemo)(()=>(0,sh.prism)(()=>{let be=(0,sh.val)(o.rightDims.width)-25,Ue=(0,sh.val)(o.clippedSpace.range),Ze=(0,sh.val)(o.sheet).getSequence().length,ze=Math.max(Ue.end,Ze),Ft=Ue.start/ze*be,Ke=Ue.end/ze*be;return{rightWidth:be,clippedSpaceRange:Ue,sequenceLength:Ze,assumedLengthOfSequence:ze,rangeStartX:Ft,rangeEndX:Ke,bottom:(0,sh.val)(o.horizontalScrollbarDims.bottom)}}),[o]),{rangeStartX:m,rangeEndX:_,clippedSpaceRange:S,bottom:M}=qr(u),[P,k]=(0,wo.useState)("nothing"),[L,z]=(0,wo.useState)(!1),[$,H]=(0,wo.useState)(!1),[j,K]=(0,wo.useState)(""),[Q,re]=(0,wo.useState)(""),ae=(0,wo.useMemo)(()=>{let be=(Ue,Ze)=>{let ze=Math.max(0,Math.min(Ue,Ze-.01)),Ft=Math.max(Ue+.01,Ze);(0,sh.val)(o.clippedSpace.setRange)({start:ze,end:Ft})};return{onStartInputClick:Ue=>{Ue.stopPropagation(),z(!0),K(l(S.start))},onEndInputClick:Ue=>{Ue.stopPropagation(),H(!0),re(l(S.end))},onStartInputChange:Ue=>{K(Ue.target.value)},onEndInputChange:Ue=>{re(Ue.target.value)},onStartInputKeyDown:Ue=>{if(Ue.key==="Enter"){let Ze=parseFloat(j);isNaN(Ze)||be(Ze,S.end),z(!1)}else Ue.key==="Escape"&&z(!1)},onEndInputKeyDown:Ue=>{if(Ue.key==="Enter"){let Ze=parseFloat(Q);isNaN(Ze)||be(S.start,Ze),H(!1)}else Ue.key==="Escape"&&H(!1)},onStartInputBlur:()=>{let Ue=parseFloat(j);isNaN(Ue)||be(Ue,S.end),z(!1)},onEndInputBlur:()=>{let Ue=parseFloat(Q);isNaN(Ue)||be(S.start,Ue),H(!1)}}},[o,u,S,j,Q,l]),ue=(0,wo.useMemo)(()=>{let be=(0,sh.val)(u),Ue=()=>{be=(0,sh.val)(u)},Ze=ze=>ze/be.rightWidth*be.assumedLengthOfSequence;return{onRangeDragStart(){return Ue(),{onDrag(ze){k("both");let Ft=Ze(ze),Ke=lf(be.clippedSpaceRange,Yt=>Yt+Ft);(0,sh.val)(o.clippedSpace.setRange)(Ke)},onDragEnd(){k("nothing")}}},onRangeStartDragStart(){return Ue(),{onDrag(ze){k("start");let Ft=Ze(ze),Ke={start:be.clippedSpaceRange.start+Ft,end:be.clippedSpaceRange.end};Ke.start>Ke.end-1&&(Ke.start=Ke.end-1),Ke.start<=0&&(Ke.start=0),(0,sh.val)(o.clippedSpace.setRange)(Ke)},onDragEnd(){k("nothing")}}},onRangeEndDragStart(){return Ue(),{onDrag(ze){k("end");let Ft=Ze(ze),Ke={start:be.clippedSpaceRange.start,end:be.clippedSpaceRange.end+Ft};Ke.end<Ke.start+1&&(Ke.end=Ke.start+1),Ke.end>=be.assumedLengthOfSequence&&(Ke.end=be.assumedLengthOfSequence),(0,sh.val)(o.clippedSpace.setRange)(Ke)},onDragEnd(){k("nothing")}}}}},[o,u]),[ye,Ae]=(0,wo.useState)(null);ao(ye,{debugName:"HorizontalScrollbar/onRangeDrag",onDragStart:ue.onRangeDragStart,lockCSSCursorTo:"ew-resize"});let[Ce,Se]=(0,wo.useState)(null);ao(Ce,{debugName:"HorizontalScrollbar/onRangeStartDrag",onDragStart:ue.onRangeStartDragStart,lockCSSCursorTo:"w-resize"});let[ft,ke]=(0,wo.useState)(null);return ao(ft,{debugName:"HorizontalScrollbar/onRangeEndDrag",onDragStart:ue.onRangeEndDragStart,lockCSSCursorTo:"e-resize"}),wo.default.createElement(Ile,R({style:{bottom:M+23+"px"}},_1("hide")),wo.default.createElement(kle,null,wo.default.createElement(bP,{ref:Ae,style:{width:"".concat(_-m,"px"),transform:"translate3d(".concat(m,"px, 0, 0)")}}),wo.default.createElement(SP,{ref:Se,style:{transform:"translate3d(".concat(m,"px, 0, 0)")}},wo.default.createElement(sB,{active:P==="both"||P==="start"||L},L?wo.default.createElement(oB,{value:j,onChange:ae.onStartInputChange,onKeyDown:ae.onStartInputKeyDown,onBlur:ae.onStartInputBlur,autoFocus:!0}):wo.default.createElement("span",{onClick:ae.onStartInputClick},l(S.start)))),wo.default.createElement(wP,{ref:ke,style:{transform:"translate3d(".concat(_,"px, 0, 0)")}},wo.default.createElement(sB,{active:P==="both"||P==="end"||$},$?wo.default.createElement(oB,{value:Q,onChange:ae.onEndInputChange,onKeyDown:ae.onEndInputKeyDown,onBlur:ae.onEndInputBlur,autoFocus:!0}):wo.default.createElement("span",{onClick:ae.onEndInputClick},l(S.end))))))},Vle=zle}),Gle,jle,Hle,Wle,qle,ZMe=A(()=>{Gle=G(et()),Jt(),Hle=ge.div(jle||(jle=X([`
  position: absolute;
  inset: `,`px;
`])),o=>o.room*-1),Wle=o=>Gle.default.createElement(Hle,{room:o.room}),qle=Wle}),TP,EP,aB,$le,Xle,Yle,Kle,Zle,Qle,Jle,ece,QMe=A(()=>{Jt(),Sr(),xS(),Dg(),TP=G(et()),EP=G(et()),aB=an(),nf(),$le=o=>isFinite(o)&&o>=0,Yle=ge.div(Xle||(Xle=X([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),Zle=ge.div(Kle||(Kle=X([`
  `,`;
  white-space: nowrap;
`])),_f),Qle=({deltaX:o})=>o*.25,Jle=({layoutP:o,onRequestClose:l})=>{let u=(0,aB.val)(o.sheet),m=u.getSequence(),_=(0,TP.useMemo)(()=>{let M,P=m.position;return{temporarilySetValue(k){M&&(M=void 0),M=Zi(k,0,m.length),m.position=M},discardTemporaryValue(){M&&(M=void 0,m.position=P,l("discardTemporaryValue"))},permanentlySetValue(k){M&&(M=void 0),m.position=Zi(k,0,m.length),l("permanentlySetValue")}}},[o,m]),S=(0,TP.useRef)(null);return(0,TP.useLayoutEffect)(()=>{S.current.focus()},[]),ri(()=>{let M=u.getSequence(),P=Number((0,aB.val)(M.pointer.position).toFixed(3));return EP.default.createElement(Yle,null,EP.default.createElement(Zle,null,"Sequence position"),EP.default.createElement(i7,B(R({value:P},_),{isValid:$le,inputRef:S,nudge:Qle})))},[u,_,S])},ece=Jle}),tce,JMe=A(()=>{tce=typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0}),nce,eCe=A(()=>{JMe(),nce=o=>tce?o.metaKey===!0:o.ctrlKey===!0});function tCe(){MP=!1}function nCe(){MP=!0}function rCe(){let o=ce();(0,rce.useEffect)(()=>{let l=u=>{let m=u.composedPath()[0];if(!(m&&(m.tagName==="INPUT"||m.tagName==="TEXTAREA"))){if(u.key==="z"||u.key==="Z"||u.code==="KeyZ")if(nce(u))u.shiftKey===!0?o.redo():o.undo();else return;else if(u.code==="Space"&&!u.shiftKey&&!u.metaKey&&!u.altKey&&!u.ctrlKey){if(!MP)return;let _=NSe();if(_)if(_.playing)_.pause();else{let{projectId:S,sheetId:M}=_.address,P=(0,Af.prism)(()=>{let z=(0,Af.val)(ce().atomP.ahistoric.projects.stateByProjectId[S].stateBySheetId[M].sequence.focusRange);return Af.prism.memo("shouldFollowFocusRange",()=>{let $=_.position;if(z){let H=$>=z.range.start&&$<=z.range.end;return z.enabled?!!H:!0}else return!0},[])&&z&&z.enabled?{range:[z.range.start,z.range.end],isFollowingARange:!0}:{range:[0,(0,Af.val)(_.pointer.length)],isFollowingARange:!1}}),k=_.playDynamicRange((0,Af.prism)(()=>(0,Af.val)(P).range),ce().ticker),L=lB(_);k.finally(()=>{L.set(void 0)}),L.set(P)}else return}else if(u.altKey&&(u.key==="\\"||u.code==="Backslash"||u.code==="IntlBackslash"))o.transaction(({stateEditors:_,drafts:S})=>{_.studio.ahistoric.setVisibilityState(S.ahistoric.visibilityState==="everythingIsHidden"?"everythingIsVisible":"everythingIsHidden")});else return;u.preventDefault(),u.stopPropagation()}};return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}},[])}var rce,Af,MP,lB,ice,cB=A(()=>{rce=G(et()),Ie(),eCe(),qy(),Af=an(),EF(),MP=!0,lB=mA(o=>new Af.Atom(void 0)),ice=mA(o=>(0,Af.prism)(()=>{let l=lB(o).prism.getValue();if(l)return l.getValue().isFollowingARange;{let{projectId:u,sheetId:m}=o.address,_=(0,Af.val)(ce().atomP.ahistoric.projects.stateByProjectId[u].stateBySheetId[m].sequence.focusRange);if(!_||!_.enabled)return!1;let S=(0,Af.val)(o.pointer.position);return S>=_.range.start&&S<=_.range.end}}))});function iCe(o,l){return Rl(o,{menuItems(){return[{label:"Place marker",callback:()=>{ce().transaction(({stateEditors:u})=>{let m=(0,oh.val)(l.layoutP.sheet),_=m.getSequence();u.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:m.address,markers:[{id:TQ(),position:_.position}],snappingFunction:_.closestGridPosition})})}},{label:"Place event",callback:()=>{ce().transaction(({stateEditors:u})=>{let m=(0,oh.val)(l.layoutP.sheet),_=m.getSequence();u.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:m.address,events:[{id:EQ(),name:"event",position:_.position}]})})}},{label:"Attach audio",callback:()=>{let u=new CustomEvent("theatre:attachAudio",{detail:{sheet:(0,oh.val)(l.layoutP.sheet)}});document.dispatchEvent(u)}}]}})}var oh,ah,sce,e8,oce,ace,lce,uB,cce,uce,dce,hce,fce,pce,sCe=A(()=>{ZMe(),oa(),Ji(),Sr(),oh=an(),nf(),ah=G(et()),Jt(),M1(),$a(),os(),xf(),bf(),QMe(),cB(),Cl(),Il(),Ie(),yf(),Mf(),g7(),e8=ge.div(sce||(sce=X([`
  --thumbColor: #00e0ff;
  position: absolute;
  top: 0;
  left: 0;
  width: 5px;
  height: 100%;
  z-index: `,`;
  pointer-events: none;

  display: `,`;
`])),()=>Rf.playhead,o=>o.isVisible?"block":"none"),ace=ge.div(oce||(oce=X([`
  position: absolute;
  top: 30px;
  width: 0;
  height: calc(100% - 30px);
  border-left: 1px solid #27e0fd;
  z-index: 10;
  pointer-events: none;

  #pointer-root.draggingPositionInSequenceEditor &:not(.seeking) {
    /* pointer-events: auto; */
    /* cursor: var(`,`); */

    &:after {
      position: absolute;
      inset: -8px;
      display: block;
      content: ' ';
    }
  }
`])),mf),uB=ge.div(lce||(lce=X([`
  background-color: var(--thumbColor);
  position: absolute;
  width: 5px;
  height: 34px;
  top: -4px;
  left: -2px;
  z-index: 11;
  cursor: ew-resize;
  --sunblock-color: #1f2b2b;

  `,`;

  `,`.seeking > & {
    pointer-events: none !important;
  }

  #pointer-root.draggingPositionInSequenceEditor
    `,`:not(.seeking)
    > & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  `,`.playheadattachedtofocusrange > & {
    top: -8px;
    --sunblock-color: #005662;
    &:before,
    &:after {
      border-bottom-width: 8px;
    }
  }

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-left: 2px solid transparent;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    right: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-right: 2px solid transparent;
  }
`])),Wi,e8,e8,mf,e8),uce=ge.div(cce||(cce=X([`
  position: absolute;
  left: 1px;
  right: 1px;
  top: 35px;
  border-top: 3px solid var(--thumbColor);
  border-right: 1px solid transparent;
  border-left: 1px solid transparent;
  pointer-events: none;

  /* `,`.playheadattachedtofocusrange & {
    top: 10px;
    &:before,
    &:after {
      height: 15px;
    }
  } */

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    left: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 0 100% 0 0;
    border-top: 1px solid var(--thumbColor);
    border-right: 1px solid var(--thumbColor);
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    right: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 100% 0 0 0;
    border-top: 1px solid var(--thumbColor);
    border-left: 1px solid var(--thumbColor);
  }
`])),e8),hce=ge.div(dce||(dce=X([`
  display: none;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 2px;
  transform: translateX(-50%);
  background: #1a1a1a;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;
  `,":hover &, ",`.seeking & {
    display: block;
  }
`])),uB,e8),fce=({layoutP:o})=>{let[l,u]=bi(null),{node:m,toggle:_,close:S}=su({debugName:"Playhead"},()=>ah.default.createElement(ou,null,ah.default.createElement(ece,{layoutP:o,onRequestClose:S}))),M=(0,ah.useMemo)(()=>({debugName:"RightOverlay/Playhead",onDragStart(){let L=(0,oh.val)(o.sheet).getSequence(),z=L.position,$=(0,oh.val)(o.scaledSpace.toUnitSpace),H=(0,oh.val)(o.seeker.setIsSeeking);return H(!0),OA(),{onDrag(j,K,Q){var re;let ae=$(j);L.position=(re=Nl.checkIfMouseEventSnapToPos(Q,{ignore:u}))!=null?re:Zi(z+ae,0,L.length)},onDragEnd(j){H(!1),m7()},onClick(j){_(j,l.current)}}}}),[o,u]),[P]=ao(u,M);iu(P,"draggingPositionInSequenceEditor","ew-resize"),y1(qr(o.seeker.isSeeking)||P,-1);let[k]=iCe(u,{layoutP:o});return ri(()=>{let L=(0,oh.val)(o.seeker.isSeeking),z=(0,oh.val)(o.sheet).getSequence(),$=(0,oh.val)(ice(z)),H=z.positionPrism.getValue(),j=(0,oh.val)(o.clippedSpace.fromUnitSpace)(H),K=j>=0&&j<=(0,oh.val)(o.clippedSpace.width);return ah.default.createElement(ah.default.Fragment,null,k,m,ah.default.createElement(e8,R({isVisible:K,style:{transform:"translate3d(".concat(j,"px, 0, 0)")},className:"".concat(L&&"seeking"," ").concat($&&"playheadattachedtofocusrange")},_1("hide")),ah.default.createElement(uB,R({ref:l},Nl.includePositionSnapAttrs(H)),ah.default.createElement(qle,{room:8}),ah.default.createElement(uce,null),ah.default.createElement(hce,null,z.positionFormatter.formatForPlayhead(z.closestGridPosition(H)))),ah.default.createElement(ace,B(R({},Nl.includePositionSnapAttrs(H)),{className:L?"seeking":""}))))},[o,l,m])},pce=fce}),t8,YS,CP,mce,gce,vce,yce,oCe=A(()=>{t8=an(),Sr(),Ie(),Zv(),YS=G(et()),Jt(),CP=1e3,gce=ge.div(mce||(mce=X([`
  position: absolute;
  top: `,`px;
  left: 0;
  opacity: 0.15;
  width: `,`px;
  transform-origin: top left;
  pointer-events: none;
  background-color: `,`;
`])),E1,CP,o=>o.enabled?"#000000":"transparent"),vce=({layoutP:o})=>{let l=(0,YS.useMemo)(()=>(0,t8.prism)(()=>{let{projectId:u,sheetId:m}=(0,t8.val)(o.sheet).address;return(0,t8.val)(ce().atomP.ahistoric.projects.stateByProjectId[u].stateBySheetId[m].sequence.focusRange)}),[o]);return ri(()=>{let u=l.getValue();if(!u||!u.enabled)return null;let{range:m}=u,_=(0,t8.val)(o.rightDims.height)-E1,S=(0,t8.val)(o.clippedSpace.fromUnitSpace),M=(0,t8.val)(o.clippedSpace.width),P=[];{let k=0,L=S(u.range.start),z,$;k>L?($=0,z=0):(L>M&&(L=M),$=k,z=(L-k)/CP),P.push({translateX:$,scaleX:z})}{let k=S(u.range.end),L=M,z,$;k>L?($=0,z=0):(k<0&&(k=0),$=k,z=(L-k)/CP),P.push({translateX:$,scaleX:z})}return YS.default.createElement(YS.default.Fragment,null,P.map(({translateX:k,scaleX:L},z)=>YS.default.createElement(gce,{key:"curtain-".concat(z),enabled:!0,style:{height:"".concat(_,"px"),transform:"translateX(".concat(k,"px) scaleX(").concat(L,")")}})))},[o,l])},yce=vce}),M7,_ce,xce,bce,Sce,wce,aCe=A(()=>{M7=G(et()),Jt(),Sr(),Ie(),Dg(),s7(),xce=ge.div(_ce||(_ce=X([`
  display: flex;
  gap: 8px;
  /* padding: 4px 8px; */
  height: 28px;
  align-items: center;
`]))),ge.div(bce||(bce=X([`
  `,`;
  white-space: nowrap;
`])),_f),Sce=({layoutP:o,marker:l})=>{var u;let m=qr(o.sheet),_=(0,M7.useMemo)(()=>{let M;return{temporarilySetValue(P){M&&(M.discard(),M=void 0),M=ce().tempTransaction(({stateEditors:k})=>{k.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:l.id,label:P})})},discardTemporaryValue(){M&&(M.discard(),M=void 0)},permanentlySetValue(P){M&&(M.discard(),M=void 0),ce().transaction(({stateEditors:k})=>{k.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:l.id,label:P})})}}},[o,m]),S=(0,M7.useRef)(null);return(0,M7.useLayoutEffect)(()=>{S.current.focus()},[]),M7.default.createElement(xce,null,M7.default.createElement(r9,B(R({value:(u=l.label)!=null?u:""},_),{isValid:()=>!0,inputRef:S})))},wce=Sce});function lCe(o,l){return Rl(o,{menuItems(){return[{label:"Remove marker",callback:()=>{ce().transaction(({stateEditors:u})=>{u.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeMarker({sheetAddress:l.sheetAddress,markerId:l.markerId})})}}]}})}function cCe(o,l){let u=(0,wc.useRef)(l);u.current=l;let m=(0,wc.useMemo)(()=>({debugName:"MarkerDot/useDragMarker (".concat(l.marker.id,")"),onDragStart(S){let M=u.current.marker,P=(0,AP.val)(l.layoutP.scaledSpace.toUnitSpace),k;return OA(),{onDrag(L,z,$){var H;let j=M,K=Math.max((H=Nl.checkIfMouseEventSnapToPos($,{ignore:o}))!=null?H:j.position+P(L),0);k==null||k.discard(),k=ce().tempTransaction(({stateEditors:Q})=>{Q.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:(0,AP.val)(l.layoutP.sheet.address),markers:[B(R({},j),{position:K})],snappingFunction:(0,AP.val)(l.layoutP.sheet).getSequence().closestGridPosition})})},onDragEnd(L){L?k==null||k.commit():k==null||k.discard(),m7()}}}}),[]),[_]=ao(o,m);return y1(_,l.marker.position),iu(_,"draggingPositionInSequenceEditor draggingMarker","ew-resize"),[_]}var AP,wc,dB,hB,Tce,Ece,Mce,Cce,Ace,PP,Pce,Rce,Ice,Nce,kce,Dce,uCe=A(()=>{AP=an(),Sr(),Ie(),Cl(),Il(),Ji(),wc=G(et()),Jt(),$a(),oa(),M1(),Mf(),NA(),QF(),g7(),xf(),bf(),aCe(),dB=12,hB=12,Tce=dB*2,Ece=hB*2,Cce=ge.div(Mce||(Mce=X([`
  position: absolute;
  // below the sequence ruler "top bar"
  top: 30px;
  z-index: `,`;
`])),()=>Rf.marker),PP=ge.div(Ace||(Ace=X([`
  position: absolute;
  `,`
  pointer-events: none;
`])),Cf(dB,hB)),Pce=wc.default.memo(()=>wc.default.createElement(PP,{children:wc.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wc.default.createElement("path",{d:"M12 5H0V7H2.71973L5.96237 10.2426L9.20501 7H12V5Z",fill:"#40AAA4"}))})),Ice=ge.div(Rce||(Rce=X([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  // :not dragging marker to ensure that markers don't snap to other markers
  // this works because only one marker track (so this technique is not used by keyframes...)
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) & {
    `,`
  }

  // "All instances of this component <Mark/> inside #pointer-root when it has the .draggingPositionInSequenceEditor class"
  // ref: https://styled-components.com/docs/basics#pseudoelements-pseudoselectors-and-nesting
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) &,
  #pointer-root.draggingPositionInSequenceEditor
    &.`,` {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &:hover
    + `,`,
    // notice , "or" in CSS
    &.`,`
    + `,` {
    `,`
  }
`])),Sc.CSS,Sc.CSS_WHEN_SOMETHING_DRAGGING,Sc.BEING_DRAGGED_CLASS,mf,PP,Sc.BEING_DRAGGED_CLASS,PP,Cf(Tce,Ece)),Nce=({layoutP:o,markerId:l})=>{let u=qr(o.sheet.address),m=qr(ce().atomP.historic.projects.stateByProjectId[u.projectId].stateBySheetId[u.sheetId].sequenceEditor.markerSet.byId[l]);if(!m)return null;let _=qr(o.clippedSpace.width),S=qr(o.clippedSpace.fromUnitSpace)(m.position),M=S<=0||S>_,P=M?-1e4:S,k=M?0:1;return wc.default.createElement(Cce,{style:{transform:"translateX(".concat(P,"px) scale(").concat(k,")")}},wc.default.createElement(Dce,{marker:m,layoutP:o}))},kce=Nce,Dce=({layoutP:o,marker:l})=>{let u=qr(o.sheet.address),[m,_]=bi(null),[S]=lCe(_,{sheetAddress:u,markerId:l.id}),[M]=cCe(_,{layoutP:o,marker:l}),{node:P,toggle:k,close:L}=su({debugName:"MarkerPopover"},()=>wc.default.createElement(ou,null,wc.default.createElement(wce,{marker:l,layoutP:o,onRequestClose:L})));return wc.default.createElement(wc.default.Fragment,null,S,P,wc.default.createElement(Ice,R({title:l.label?"Marker: ".concat(l.label):"Marker",ref:m,onClick:z=>{k(z,m.current)}},Sc.reactProps({isDragging:M,position:l.position}))),wc.default.createElement(Pce,null))}}),RP,Oce,Lce,dCe=A(()=>{Sr(),Ie(),RP=G(et()),uCe(),Oce=({layoutP:o})=>{let l=qr(o.sheet.address),u=ce().atomP.historic.projects.stateByProjectId[l.projectId].stateBySheetId[l.sheetId].sequenceEditor.markerSet,m=qr(u.allIds);return RP.default.createElement(RP.default.Fragment,null,m&&Object.keys(m).map(_=>RP.default.createElement(kce,{key:_,layoutP:o,markerId:_})))},Lce=Oce}),q0,Fce,Uce,Bce,IP,zce,NP,Vce,Gce,hCe=A(()=>{q0=G(et()),Jt(),Sr(),Ie(),Dg(),s7(),xS(),Uce=ge.div(Fce||(Fce=X([`
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px;
  min-width: 200px;
`]))),IP=ge.div(Bce||(Bce=X([`
  display: flex;
  gap: 8px;
  height: 28px;
  align-items: center;
`]))),NP=ge.div(zce||(zce=X([`
  `,`;
  white-space: nowrap;
  min-width: 60px;
`])),_f),Vce=({layoutP:o,event:l})=>{var u;let m=qr(o.sheet),_=(0,q0.useMemo)(()=>{let L;return{temporarilySetValue(z){L&&(L.discard(),L=void 0),L=ce().tempTransaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:z,value:l.value})})},discardTemporaryValue(){L&&(L.discard(),L=void 0)},permanentlySetValue(z){L&&(L.discard(),L=void 0),ce().transaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:z,value:l.value})})}}},[o,m,l]),S=(0,q0.useMemo)(()=>{let L;return{temporarilySetValue(z){L&&(L.discard(),L=void 0),L=ce().tempTransaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:m.address,events:[B(R({},l),{position:z})]})})},discardTemporaryValue(){L&&(L.discard(),L=void 0)},permanentlySetValue(z){L&&(L.discard(),L=void 0),ce().transaction(({stateEditors:$})=>{$.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:m.address,events:[B(R({},l),{position:z})]})})}}},[o,m,l]),M=(0,q0.useMemo)(()=>{let L;return{temporarilySetValue(z){L&&(L.discard(),L=void 0);let $=z;try{z.trim()!==""&&($=JSON.parse(z))}catch{}L=ce().tempTransaction(({stateEditors:H})=>{H.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:l.name,value:$})})},discardTemporaryValue(){L&&(L.discard(),L=void 0)},permanentlySetValue(z){L&&(L.discard(),L=void 0);let $=z;try{z.trim()!==""&&($=JSON.parse(z))}catch{}ce().transaction(({stateEditors:H})=>{H.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateEvent({sheetAddress:m.address,eventId:l.id,name:l.name,value:$})})}}},[o,m,l]),P=(0,q0.useRef)(null);(0,q0.useLayoutEffect)(()=>{P.current.focus()},[]);let k=(0,q0.useMemo)(()=>l.value===void 0||l.value===null?"":typeof l.value=="string"?l.value:JSON.stringify(l.value),[l.value]);return q0.default.createElement(Uce,null,q0.default.createElement(IP,null,q0.default.createElement(NP,null,"Name"),q0.default.createElement(r9,B(R({value:(u=l.name)!=null?u:""},_),{isValid:()=>!0,inputRef:P}))),q0.default.createElement(IP,null,q0.default.createElement(NP,null,"Time"),q0.default.createElement(i7,B(R({value:l.position},S),{isValid:()=>!0,nudge:({deltaX:L})=>L*.25}))),q0.default.createElement(IP,null,q0.default.createElement(NP,null,"Value"),q0.default.createElement(r9,B(R({value:k},M),{isValid:()=>!0}))))},Gce=Vce});function fCe(o,l){return Rl(o,{menuItems(){return[{label:"Remove event",callback:()=>{ce().transaction(({stateEditors:u})=>{u.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeEvent({sheetAddress:l.sheetAddress,eventId:l.eventId})})}}]}})}function pCe(o,l){let u=(0,Tc.useRef)(l);u.current=l;let m=(0,Tc.useMemo)(()=>({debugName:"EventDot/useDragEvent (".concat(l.event.id,")"),onDragStart(S){let M=u.current.event,P=(0,fB.val)(l.layoutP.scaledSpace.toUnitSpace),k;return OA(),{onDrag(L,z,$){var H;let j=M,K=Math.max((H=Nl.checkIfMouseEventSnapToPos($,{ignore:o}))!=null?H:j.position+P(L),0);k==null||k.discard(),k=ce().tempTransaction(({stateEditors:Q})=>{Q.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:(0,fB.val)(l.layoutP.sheet.address),events:[B(R({},j),{position:K})]})})},onDragEnd(L){L?k==null||k.commit():k==null||k.discard(),m7()}}}}),[]),[_]=ao(o,m);return y1(_,l.event.position),iu(_,"draggingPositionInSequenceEditor draggingEvent","ew-resize"),[_]}var fB,Tc,pB,mB,jce,Hce,Wce,qce,$ce,kP,Xce,Yce,Kce,Zce,Qce,Jce,mCe=A(()=>{fB=an(),Sr(),Ie(),Cl(),Il(),Ji(),Tc=G(et()),Jt(),$a(),oa(),M1(),Mf(),NA(),QF(),g7(),xf(),bf(),hCe(),pB=12,mB=12,jce=pB*2,Hce=mB*2,qce=ge.div(Wce||(Wce=X([`
  position: absolute;
  // below the sequence ruler "top bar"
  top: 15px;
  z-index: `,`;
`])),()=>Rf.marker),kP=ge.div($ce||($ce=X([`
  position: absolute;
  `,`
  pointer-events: none;
`])),Cf(pB,mB)),Xce=Tc.default.memo(()=>Tc.default.createElement(kP,{children:Tc.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Tc.default.createElement("circle",{cx:"6",cy:"6",r:"5",fill:"#2b86ee",stroke:"#FFFFFF",strokeWidth:"1"}))})),Kce=ge.div(Yce||(Yce=X([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  // :not dragging event to ensure that events don't snap to other events
  // this works because only one event track (so this technique is not used by keyframes...)
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingEvent) & {
    `,`
  }

  // "All instances of this component <Event/> inside #pointer-root when it has the .draggingPositionInSequenceEditor class"
  // ref: https://styled-components.com/docs/basics#pseudoelements-pseudoselectors-and-nesting
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingEvent) &,
  #pointer-root.draggingPositionInSequenceEditor
    &.`,` {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &:hover
    + `,`,
    // notice , "or" in CSS
    &.`,`
    + `,` {
    `,`
  }
`])),Sc.CSS,Sc.CSS_WHEN_SOMETHING_DRAGGING,Sc.BEING_DRAGGED_CLASS,mf,kP,Sc.BEING_DRAGGED_CLASS,kP,Cf(jce,Hce)),Zce=({layoutP:o,eventId:l})=>{let u=qr(o.sheet.address),m=qr(ce().atomP.historic.projects.stateByProjectId[u.projectId].stateBySheetId[u.sheetId].sequenceEditor.eventSet.byId[l]);if(!m)return null;let _=qr(o.clippedSpace.width),S=qr(o.clippedSpace.fromUnitSpace)(m.position),M=S<=0||S>_,P=M?-1e4:S,k=M?0:1;return Tc.default.createElement(qce,{style:{transform:"translateX(".concat(P,"px) scale(").concat(k,")")}},Tc.default.createElement(Jce,{event:m,layoutP:o}))},Qce=Zce,Jce=({layoutP:o,event:l})=>{let u=qr(o.sheet.address),[m,_]=bi(null),[S]=fCe(_,{sheetAddress:u,eventId:l.id}),[M]=pCe(_,{layoutP:o,event:l}),{node:P,toggle:k,close:L}=su({debugName:"EventPopover"},()=>Tc.default.createElement(ou,null,Tc.default.createElement(Gce,{event:l,layoutP:o,onRequestClose:L})));return Tc.default.createElement(Tc.default.Fragment,null,S,P,Tc.default.createElement(Kce,R({title:l.name?"Event: ".concat(l.name):"Event",ref:m,onClick:z=>{k(z,m.current)}},Sc.reactProps({isDragging:M,position:l.position}))),Tc.default.createElement(Xce,null))}}),DP,eue,tue,gCe=A(()=>{Sr(),Ie(),DP=G(et()),mCe(),eue=({layoutP:o})=>{let l=qr(o.sheet.address),u=ce().atomP.historic.projects.stateByProjectId[l.projectId].stateBySheetId[l.sheetId].sequenceEditor.eventSet,m=qr(u.allIds);return DP.default.createElement(DP.default.Fragment,null,m&&Object.keys(m).map(_=>DP.default.createElement(Qce,{key:_,layoutP:o,eventId:_})))},tue=eue}),nue,Pf,rue,iue,sue,oue,aue,lue,vCe=A(()=>{M1(),Sr(),nue=an(),Pf=G(et()),Jt(),XMe(),YMe(),KMe(),sCe(),Zv(),oCe(),dCe(),gCe(),iue=ge.div(rue||(rue=X([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: visible;
  pointer-events: none;
`])),()=>Rf.rightOverlay),oue=ge.div(sue||(sue=X([`
  background: #222;
  position: absolute;
  top: 30px;
  width: 100%;
  height: 30px;
`]))),aue=({layoutP:o})=>ri(()=>{let l=(0,nue.val)(o.rightDims.width);return Pf.default.createElement(iue,{style:{width:l+"px"}},Pf.default.createElement(pce,{layoutP:o}),Pf.default.createElement(Vle,{layoutP:o}),Pf.default.createElement(Ple,{layoutP:o}),Pf.default.createElement(tle,{layoutP:o}),Pf.default.createElement(oue,null,Pf.default.createElement(Lce,{layoutP:o}),Pf.default.createElement(tue,{layoutP:o})),Pf.default.createElement(ble,{layoutP:o}),Pf.default.createElement(yce,{layoutP:o}))},[o]),lue=aue}),cue,OP,uue,due,hue,fue,yCe=A(()=>{cue=an(),Sr(),Ie(),OP=G(et()),Jt(),mS(),$a(),due=ge.button(uue||(uue=X([`
  outline: none;
  background-color: #1c1d21;
  border: 1px solid #191919;
  border-radius: 2px;
  display: flex;
  bottom: 25px;
  right: 15px;
  z-index: 1;
  position: absolute;

  padding: 4px 8px;
  display: flex;
  color: #656d77;
  line-height: 20px;
  font-size: 10px;

  &:hover {
    color: white;
  }

  & > svg {
    transition: transform 0.3s;
    transform: rotateZ(0deg);
  }

  &:hover > svg {
    transform: rotateZ(-20deg);
  }

  &.open > svg {
    transform: rotateZ(-180deg);
  }

  &.open:hover > svg {
    transform: rotateZ(-160deg);
  }
`]))),hue=({layoutP:o})=>{let l=qr(o.graphEditorDims.isOpen),u=(0,OP.useCallback)(()=>{let m=(0,cue.val)(o.graphEditorDims.isOpen);ce().transaction(({stateEditors:_})=>{_.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!m})})},[o]);return OP.default.createElement(due,R({onClick:u,title:"Toggle graph editor",className:l?"open":""},_1("hide")),OP.default.createElement(Nwe,null))},fue=hue}),uu,KS,pue,mue,gue,vue,gB,yue,_Ce=A(()=>{uu=G(et()),Jt(),Sr(),KS=an(),LU(),nU(),mue=ge.div(pue||(pue=X([`
  position: absolute;
  right: 0;
  bottom: 0;
  padding-bottom: 10px;
  pointer-events: none;
  z-index: 1;
  display: `,`;
`])),o=>o.isVisible?"block":"none"),vue=ge.svg(gue||(gue=X([`
  position: absolute;
  top: 0;
  left: 0;
  margin: 0;
  pointer-events: none;
`]))),gB=(0,uu.forwardRef)(({layoutP:o,sheetAddress:l,renderMode:u="both",color:m="#4a9eff",strokeWidth:_=2,circleRadius:S=3,height:M},P)=>{let k=re=>re?"svgViewer_".concat(re.projectId,"_").concat(re.sheetId):"svgViewer_default",L=re=>{try{let ae=k(re),ue=localStorage.getItem(ae);if(ue){let ye=JSON.parse(ue);if(Array.isArray(ye))return ye.length>0&&typeof ye[0]=="object"&&"time"in ye[0]?[{id:"legacy",data:ye,color:"#4a9eff",name:"Legacy Data"}]:ye.filter(Ae=>Ae&&typeof Ae=="object"&&Array.isArray(Ae.data)&&typeof Ae.color=="string")}}catch(ae){console.warn(" SVGViewer: Failed to load data from localStorage:",ae)}return[]},z=(re,ae)=>{try{let ue=k(ae);localStorage.setItem(ue,JSON.stringify(re))}catch(ue){console.warn(" SVGViewer: Failed to save data to localStorage:",ue)}},[$,H]=(0,uu.useState)(()=>L(l)),[j,K]=(0,uu.useState)(!0);(0,uu.useEffect)(()=>{let re=L(l);H(re)},[l==null?void 0:l.projectId,l==null?void 0:l.sheetId]);let Q=re=>{try{let ae=JSON.parse(re);if(Array.isArray(ae))return ae.filter(ue=>typeof ue=="object"&&typeof ue.time=="number"&&typeof ue.value=="number")}catch{let ue=re.trim().split(`
`),ye=[];for(let Ae of ue){if(!Ae.trim()||Ae.toLowerCase().includes("time")||Ae.toLowerCase().includes("value"))continue;let Ce=Ae.split(",").map(Se=>Se.trim());if(Ce.length>=2){let Se=parseFloat(Ce[0]),ft=parseFloat(Ce[1]);!isNaN(Se)&&!isNaN(ft)&&ye.push({time:Se,value:ft})}else{let Se=Ae.split(/\s+/).filter(ft=>ft.length>0);if(Se.length>=2){let ft=parseFloat(Se[0]),ke=parseFloat(Se[1]);!isNaN(ft)&&!isNaN(ke)&&ye.push({time:ft,value:ke})}}}return ye}return[]};return(0,uu.useImperativeHandle)(P,()=>({clearData:()=>{let re=[];H(re),z(re,l)},addData:(re,ae)=>{console.log(" SVGViewer: Adding dataset with",re.length,"points",ae?"and color ".concat(ae):"");let ue={id:"dataset-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),data:re,color:ae||m,name:"Dataset ".concat($.length+1)},ye=[...$,ue];H(ye),z(ye,l)},loadData:(re,ae)=>{console.log(" SVGViewer: loadData called, redirecting to addData");let ue={id:"dataset-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),data:re,color:ae||m,name:"Dataset ".concat($.length+1)},ye=[...$,ue];H(ye),z(ye,l)},loadFromClipboard:()=>De(void 0,null,function*(){try{let re=yield navigator.clipboard.readText(),ae=Q(re);if(ae.length>0){console.log(" SVGViewer: Successfully parsed",ae.length,"data points from clipboard");let ue={id:"clipboard-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),data:ae,color:m,name:"Clipboard Data ".concat($.length+1)},ye=[...$,ue];H(ye),z(ye,l)}else console.warn(" SVGViewer: No valid data found in clipboard")}catch(re){throw console.error(" SVGViewer: Failed to read from clipboard:",re),re}}),show:()=>{console.log(" SVGViewer: Showing component"),K(!0)},hide:()=>{console.log(" SVGViewer: Hiding component"),K(!1)}}),[l,$,m]),ri(()=>{let re=(0,KS.val)(o.rightDims.width),ae=M||(0,KS.val)(o.dopeSheetDims.height)-30,ue=(0,KS.val)(o.scaledSpace.fromUnitSpace)(1),ye=(0,KS.val)(o.scaledSpace.leftPadding),Ae=0,Ce=1;return uu.default.createElement(mue,{isVisible:j,style:{width:re+"px",height:ae+"px","--unitSpaceToScaledSpaceMultiplier":ue}},uu.default.createElement(LA,{layoutP:o,height:ae},uu.default.createElement(vue,{width:w7,height:ae,viewBox:"0 0 ".concat(w7," ").concat(ae)},uu.default.createElement("g",{style:{transform:"translate(".concat(ye,"px, 0px)")}},$.map(Se=>{let ft=Se.data.map((be,Ue)=>{let Ze=be.time*ue,ze=(be.value-Ae)/Ce,Ft=ae-ze*(ae-40)-20;return{x:Ze,y:Ft,originalValue:be.value,time:be.time,index:Ue}}),ke=ft.length>0?"M ".concat(ft[0].x," ").concat(ft[0].y," ")+ft.slice(1).map(be=>"L ".concat(be.x," ").concat(be.y)).join(" "):"";return uu.default.createElement("g",{key:Se.id},(u==="lines"||u==="both")&&ft.length>1&&uu.default.createElement("path",{d:ke,fill:"none",stroke:Se.color,strokeWidth:_,opacity:.8}),(u==="circles"||u==="both")&&ft.map(be=>uu.default.createElement("circle",{key:"".concat(Se.id,"-point-").concat(be.index,"-").concat(be.time,"-").concat(be.originalValue),cx:be.x,cy:be.y,r:S,fill:Se.color,opacity:.9},uu.default.createElement("title",null,"".concat(Se.name||"Dataset"," - Time: ").concat(be.time.toFixed(2),", Value: ").concat(be.originalValue.toFixed(3))))))})))))},[o,$,u,_,S,M,j])}),gB.displayName="SVGViewer",yue=gB});function xCe(o){return De(this,arguments,function*(l,u={}){let{sampleRate:m=100,normalize:_=!0}=u;try{let S=new(window.AudioContext||window.webkitAudioContext),M=yield l.arrayBuffer(),P=yield S.decodeAudioData(M),k=P.getChannelData(0),L=P.duration,z=P.sampleRate,$=Math.floor(z/m),H=Math.floor(k.length/$),j=[],K=0;for(let Q=0;Q<H;Q++){let re=Q*$,ae=Math.min(re+$,k.length),ue=0;for(let Ce=re;Ce<ae;Ce++)ue+=k[Ce]*k[Ce];let ye=Math.sqrt(ue/(ae-re)),Ae=Q*$/z;j.push({time:Ae,amplitude:ye}),ye>K&&(K=ye)}if(_&&K>0)for(let Q of j)Q.amplitude=Q.amplitude/K;return yield S.close(),console.log(" Audio analysis complete: ".concat(j.length," data points over ").concat(L.toFixed(2),"s")),j}catch(S){throw console.error(" Audio analysis failed:",S),new Error("Failed to analyze audio file: ".concat(S instanceof Error?S.message:"Unknown error"))}})}function _ue(o){return["audio/mpeg","audio/wav","audio/ogg","audio/mp4","audio/aac"].includes(o.type)||o.name.toLowerCase().match(/\.(mp3|wav|ogg|m4a|aac)$/)!==null}function xue(o){if(o===0)return"0 Bytes";let l=1024,u=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(o)/Math.log(l));return parseFloat((o/Math.pow(l,m)).toFixed(2))+" "+u[m]}var bue=A(()=>{}),fi,Sue,wue,Tue,Eue,Mue,Cue,Aue,vB,Pue,LP,Rue,Iue,Nue,kue,Due,Oue,Lue,Fue,Uue,Bue,zue,Vue,Gue,yB,jue,Hue,Wue,que,$ue,Xue,Yue,_B,Kue,Zue,Que,Jue,ede,tde,nde,rde,ide,sde,ode,ade,lde,cde,ude,bCe=A(()=>{fi=G(et()),Jt(),s7(),Dg(),bue(),wue=ge.div(Sue||(Sue=X([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`]))),Eue=ge.div(Tue||(Tue=X([`
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 16px;
  min-width: 400px;
  max-width: 500px;
  background: #2a2a2a;
  border: 1px solid #3a3a3a;
  border-radius: 6px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
`]))),Cue=ge.h3(Mue||(Mue=X([`
  margin: 0;
  font-size: 14px;
  font-weight: 500;
  color: #ccc;
`]))),vB=ge.div(Aue||(Aue=X([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),LP=ge.div(Pue||(Pue=X([`
  `,`;
  font-size: 12px;
  color: #999;
`])),_f),Iue=ge.div(Rue||(Rue=X([`
  font-size: 11px;
  color: #666;
  font-style: italic;
  margin-top: 4px;
`]))),kue=ge.div(Nue||(Nue=X([`
  display: flex;
  gap: 8px;
  align-items: center;
`]))),Oue=ge.input(Due||(Due=X([`
  width: 40px;
  height: 28px;
  border: 1px solid #3a3a3a;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;

  &::-webkit-color-swatch-wrapper {
    padding: 2px;
  }

  &::-webkit-color-swatch {
    border: none;
    border-radius: 2px;
  }
`]))),Fue=ge(r9)(Lue||(Lue=X([`
  flex: 1;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
`]))),Bue=ge.textarea(Uue||(Uue=X([`
  width: 100%;
  min-height: 120px;
  padding: 8px;
  border: 1px solid #3a3a3a;
  border-radius: 4px;
  background: #2a2a2a;
  color: #ccc;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  font-size: 12px;
  resize: vertical;

  &::placeholder {
    color: #666;
  }

  &:focus {
    outline: none;
    border-color: #4a9eff;
  }
`]))),Vue=ge.div(zue||(zue=X([`
  display: flex;
  gap: 8px;
  justify-content: flex-end;
`]))),yB=ge.button(Gue||(Gue=X([`
  padding: 8px 16px;
  border: 1px solid
    `,`;
  border-radius: 4px;
  background: `,`;
  color: `,`;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#4a9eff":"#3a3a3a",o=>o.variant==="primary"?"#4a9eff":"transparent",o=>o.variant==="primary"?"#fff":"#ccc",o=>o.variant==="primary"?"#3a8eef":"#3a3a3a"),Hue=ge.div(jue||(jue=X([`
  border-top: 1px solid #3a3a3a;
  padding-top: 16px;
  margin-top: 8px;
`]))),que=ge.div(Wue||(Wue=X([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),Xue=ge.div($ue||($ue=X([`
  border: 2px dashed `,`;
  border-radius: 4px;
  padding: 16px;
  text-align: center;
  background: `,`;
  cursor: pointer;
  transition: all 0.2s;

  `,`

  &:hover {
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  }
`])),o=>o.isDragOver?"#4a9eff":"#3a3a3a",o=>o.isDragOver?"rgba(74, 158, 255, 0.1)":"transparent",o=>o.hasFile&&`
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  `),_B=ge.div(Yue||(Yue=X([`
  color: #999;
  font-size: 12px;
  margin-bottom: 4px;
`]))),Zue=ge.div(Kue||(Kue=X([`
  color: #ccc;
  font-size: 11px;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
`]))),Jue=ge.div(Que||(Que=X([`
  display: flex;
  gap: 16px;
  align-items: center;
  margin-top: 8px;
`]))),tde=ge.div(ede||(ede=X([`
  display: flex;
  flex-direction: column;
  gap: 4px;
`]))),rde=ge.label(nde||(nde=X([`
  `,`;
  font-size: 11px;
  color: #999;
`])),_f),sde=ge.input(ide||(ide=X([`
  width: 80px;
  padding: 4px 8px;
  border: 1px solid #3a3a3a;
  border-radius: 4px;
  background: #2a2a2a;
  color: #ccc;
  font-size: 12px;

  &:focus {
    outline: none;
    border-color: #4a9eff;
  }
`]))),ade=ge.div(ode||(ode=X([`
  font-size: 11px;
  margin-top: 8px;
  color: `,`;
`])),o=>{switch(o.status){case"analyzing":return"#4a9eff";case"complete":return"#4a9eff";case"error":return"#ff6b6b";default:return"#666"}}),lde=`[
  {"time": 0, "value": 0},
  {"time": 1, "value": 0.5},
  {"time": 2, "value": 0.2},
  {"time": 3, "value": 1}
]

Or CSV format:
time,value
0,0
1,0.5
2,0.2
3,1

Or space-separated:
0 0
1 0.5
2 0.2
3 1`,cde=({onLoad:o,onCancel:l})=>{let[u,m]=(0,fi.useState)("#4a9eff"),[_,S]=(0,fi.useState)("#4a9eff"),[M,P]=(0,fi.useState)(""),[k,L]=(0,fi.useState)(null),[z,$]=(0,fi.useState)(!1),[H,j]=(0,fi.useState)(100),[K,Q]=(0,fi.useState)("idle"),[re,ae]=(0,fi.useState)(""),ue=(0,fi.useRef)(null),ye=(0,fi.useRef)(null);(0,fi.useEffect)(()=>{ue.current&&ue.current.focus()},[]);let Ae=Ee=>{try{let ct=JSON.parse(Ee);if(Array.isArray(ct))return ct.filter(Nt=>typeof Nt=="object"&&typeof Nt.time=="number"&&typeof Nt.value=="number")}catch{let Nt=Ee.trim().split(`
`),Re=[];for(let it of Nt){if(!it.trim()||it.toLowerCase().includes("time")||it.toLowerCase().includes("value"))continue;let Ht=it.split(",").map(Kt=>Kt.trim());if(Ht.length>=2){let Kt=parseFloat(Ht[0]),Et=parseFloat(Ht[1]);!isNaN(Kt)&&!isNaN(Et)&&Re.push({time:Kt,value:Et})}else{let Kt=it.split(/\s+/).filter(Et=>Et.length>0);if(Kt.length>=2){let Et=parseFloat(Kt[0]),we=parseFloat(Kt[1]);!isNaN(Et)&&!isNaN(we)&&Re.push({time:Et,value:we})}}}return Re}return[]},Ce=Ae(M).length,Se=Ce>0||k!==null,ft=Ee=>De(void 0,null,function*(){Q("analyzing"),ae("");try{let ct=(yield xCe(Ee,{sampleRate:H,normalize:!0})).map(Nt=>({time:Nt.time,value:Nt.amplitude}));P(JSON.stringify(ct,null,2)),Q("complete")}catch(ct){console.error("Audio analysis failed:",ct),ae(ct instanceof Error?ct.message:"Analysis failed"),Q("error")}}),ke=Ee=>{if(!_ue(Ee)){ae("Please select a supported audio file (MP3, WAV, OGG, M4A, AAC)"),Q("error");return}L(Ee),Q("idle"),ae(""),ft(Ee)},be=Ee=>{Ee.preventDefault(),$(!0)},Ue=Ee=>{Ee.preventDefault(),$(!1)},Ze=Ee=>{Ee.preventDefault(),$(!1);let ct=Array.from(Ee.dataTransfer.files);ct.length>0&&ke(ct[0])},ze=Ee=>{let ct=Ee.target.files;ct&&ct.length>0&&ke(ct[0])},Ft=()=>{var Ee;(Ee=ye.current)==null||Ee.click()},Ke=()=>{let Ee=Ae(M);Ee.length>0?o(Ee,u):console.warn("No valid data found in input")};(0,fi.useEffect)(()=>{let Ee=ct=>{ct.key==="Escape"?nt():ct.key==="Enter"&&(ct.ctrlKey||ct.metaKey)&&Se&&Ke()};return document.addEventListener("keydown",Ee),()=>document.removeEventListener("keydown",Ee)},[Se]);let Yt=Ee=>{m(Ee),S(Ee)},mt=Ee=>{S(Ee),/^#[0-9A-F]{6}$/i.test(Ee)&&m(Ee)},nt=()=>{P(""),m("#4a9eff"),S("#4a9eff"),L(null),Q("idle"),ae(""),l()};return fi.default.createElement(wue,{onClick:nt},fi.default.createElement(Eue,{onClick:Ee=>Ee.stopPropagation()},fi.default.createElement(Cue,null,"Load SVG Data"),fi.default.createElement(vB,null,fi.default.createElement(LP,null,"Color"),fi.default.createElement(kue,null,fi.default.createElement(Oue,{type:"color",value:u,onChange:Ee=>Yt(Ee.target.value)}),fi.default.createElement(Fue,{value:_,temporarilySetValue:mt,discardTemporaryValue:()=>S(u),permanentlySetValue:mt,isValid:Ee=>/^#[0-9A-F]{6}$/i.test(Ee)}))),fi.default.createElement(vB,null,fi.default.createElement(LP,null,"SVG Data"),fi.default.createElement(Bue,{ref:ue,value:M,onChange:Ee=>P(Ee.target.value),placeholder:lde}),M&&fi.default.createElement(Iue,null,Ce>0?"".concat(Ce," data points will be loaded"):"No valid data points found")),fi.default.createElement(Hue,null,fi.default.createElement(LP,null,"Or Analyze Audio File"),fi.default.createElement(que,null,fi.default.createElement(Xue,{isDragOver:z,hasFile:k!==null,onClick:Ft,onDragOver:be,onDragLeave:Ue,onDrop:Ze},fi.default.createElement(_B,null,k?"Click to select a different audio file":"Click to select or drag & drop an audio file"),fi.default.createElement(_B,{style:{fontSize:"11px",color:"#666"}},"Supported formats: MP3, WAV, OGG, M4A, AAC"),k&&fi.default.createElement(Zue,null," ",k.name," (",xue(k.size),")")),fi.default.createElement("input",{ref:ye,type:"file",accept:"audio/*,.mp3,.wav,.ogg,.m4a,.aac",onChange:ze,style:{display:"none"}}),fi.default.createElement(Jue,null,fi.default.createElement(tde,null,fi.default.createElement(rde,null,"Sample Rate (Hz)"),fi.default.createElement(sde,{type:"number",min:"10",max:"1000",value:H,onChange:Ee=>j(parseInt(Ee.target.value)||100)}))),K!=="idle"&&fi.default.createElement(ade,{status:K},K==="analyzing"&&" Analyzing audio...",K==="complete"&&" Audio analysis complete! Data loaded above.",K==="error"&&" ".concat(re)))),fi.default.createElement(Vue,null,fi.default.createElement(yB,{onClick:nt},"Cancel"),fi.default.createElement(yB,{variant:"primary",onClick:Ke,disabled:!Se},"Create"))))},ude=cde}),Gi,dde,hde,fde,pde,mde,gde,vde,xB,yde,bB,_de,FP,xde,bde,Sde,SB,wde,Tde,Ede,Mde,Cde,wB,Ade,Pde,Rde,Ide,Nde,kde,Dde,Ode,Lde,Fde,Ude,TB,Bde,zde,SCe=A(()=>{Gi=G(et()),Jt(),s7(),Dg(),bue(),hde=ge.div(dde||(dde=X([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`]))),pde=ge.div(fde||(fde=X([`
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 16px;
  min-width: 400px;
  max-width: 500px;
  background: #2a2a2a;
  border: 1px solid #3a3a3a;
  border-radius: 6px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
`]))),gde=ge.h3(mde||(mde=X([`
  margin: 0;
  font-size: 14px;
  font-weight: 500;
  color: #ccc;
`]))),xB=ge.div(vde||(vde=X([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),bB=ge.div(yde||(yde=X([`
  `,`;
  font-size: 12px;
  color: #999;
`])),_f),FP=ge.div(_de||(_de=X([`
  font-size: 11px;
  color: #666;
  font-style: italic;
  margin-bottom: 8px;
`]))),bde=ge.div(xde||(xde=X([`
  display: flex;
  gap: 8px;
  justify-content: flex-end;
`]))),SB=ge.button(Sde||(Sde=X([`
  padding: 8px 16px;
  border: 1px solid
    `,`;
  border-radius: 4px;
  background: `,`;
  color: `,`;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#4a9eff":"#3a3a3a",o=>o.variant==="primary"?"#4a9eff":"transparent",o=>o.variant==="primary"?"#fff":"#ccc",o=>o.variant==="primary"?"#3a8eef":"#3a3a3a"),Tde=ge.div(wde||(wde=X([`
  display: flex;
  flex-direction: column;
  gap: 8px;
`]))),Mde=ge.div(Ede||(Ede=X([`
  border: 2px dashed `,`;
  border-radius: 4px;
  padding: 16px;
  text-align: center;
  background: `,`;
  cursor: pointer;
  transition: all 0.2s;

  `,`

  &:hover {
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  }
`])),o=>o.isDragOver?"#4a9eff":"#3a3a3a",o=>o.isDragOver?"rgba(74, 158, 255, 0.1)":"transparent",o=>o.hasFile&&`
    border-color: #4a9eff;
    background: rgba(74, 158, 255, 0.05);
  `),wB=ge.div(Cde||(Cde=X([`
  color: #999;
  font-size: 12px;
  margin-bottom: 4px;
`]))),Pde=ge.div(Ade||(Ade=X([`
  color: #ccc;
  font-size: 11px;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
`]))),Ide=ge(r9)(Rde||(Rde=X([`
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  font-size: 12px;

  &::placeholder {
    color: #666;
  }
`]))),kde=ge.div(Nde||(Nde=X([`
  color: #ff6b6b;
  font-size: 11px;
  margin-top: 4px;
`]))),Ode=ge.div(Dde||(Dde=X([`
  color: #4a9eff;
  font-size: 11px;
  margin-top: 4px;
`]))),Fde=ge.div(Lde||(Lde=X([`
  display: flex;
  border-bottom: 1px solid #3a3a3a;
  margin-bottom: 16px;
`]))),TB=ge.button(Ude||(Ude=X([`
  padding: 8px 16px;
  border: none;
  background: `,`;
  color: `,`;
  font-size: 12px;
  cursor: pointer;
  border-bottom: 2px solid
    `,`;
  transition: all 0.2s;

  &:hover {
    background: #3a3a3a;
    color: #ccc;
  }
`])),o=>o.active?"#3a3a3a":"transparent",o=>o.active?"#ccc":"#999",o=>o.active?"#4a9eff":"transparent"),Bde=({onAttach:o,onCancel:l})=>{let[u,m]=(0,Gi.useState)("file"),[_,S]=(0,Gi.useState)(null),[M,P]=(0,Gi.useState)(""),[k,L]=(0,Gi.useState)(!1),[z,$]=(0,Gi.useState)(!1),[H,j]=(0,Gi.useState)(""),[K,Q]=(0,Gi.useState)(""),re=(0,Gi.useRef)(null);(0,Gi.useEffect)(()=>{j(""),Q("")},[u]);let ae=Ze=>{if(!_ue(Ze)){j("Please select a supported audio file (MP3, WAV, OGG, M4A, AAC)");return}S(Ze),j(""),Q("")},ue=Ze=>{Ze.preventDefault(),L(!0)},ye=Ze=>{Ze.preventDefault(),L(!1)},Ae=Ze=>{Ze.preventDefault(),L(!1);let ze=Array.from(Ze.dataTransfer.files);ze.length>0&&ae(ze[0])},Ce=Ze=>{let ze=Ze.target.files;ze&&ze.length>0&&ae(ze[0])},Se=()=>{var Ze;(Ze=re.current)==null||Ze.click()},ft=Ze=>{try{return new URL(Ze),!0}catch{return!1}},ke=()=>u==="file"?_!==null:M.trim()!==""&&ft(M.trim()),be=()=>De(void 0,null,function*(){if(ke()){$(!0),j(""),Q("");try{let Ze=u==="file"?_:M.trim();yield o(Ze),Q("Audio attached successfully!"),setTimeout(()=>{l()},1e3)}catch(Ze){console.error("Failed to attach audio:",Ze),j(Ze instanceof Error?Ze.message:"Failed to attach audio")}finally{$(!1)}}});(0,Gi.useEffect)(()=>{let Ze=ze=>{ze.key==="Escape"?Ue():ze.key==="Enter"&&(ze.ctrlKey||ze.metaKey)&&ke()&&be()};return document.addEventListener("keydown",Ze),()=>document.removeEventListener("keydown",Ze)},[u,_,M]);let Ue=()=>{S(null),P(""),j(""),Q(""),l()};return Gi.default.createElement(hde,{onClick:Ue},Gi.default.createElement(pde,{onClick:Ze=>Ze.stopPropagation()},Gi.default.createElement(gde,null,"Attach Audio to Sequence"),Gi.default.createElement(FP,null,"Attach an audio file to sync with your sequence playback. The audio will play automatically when the sequence plays."),Gi.default.createElement(Fde,null,Gi.default.createElement(TB,{active:u==="file",onClick:()=>m("file")},"Upload File"),Gi.default.createElement(TB,{active:u==="url",onClick:()=>m("url")},"From URL")),u==="file"?Gi.default.createElement(xB,null,Gi.default.createElement(bB,null,"Audio File"),Gi.default.createElement(Tde,null,Gi.default.createElement(Mde,{isDragOver:k,hasFile:_!==null,onClick:Se,onDragOver:ue,onDragLeave:ye,onDrop:Ae},Gi.default.createElement(wB,null,_?"Click to select a different audio file":"Click to select or drag & drop an audio file"),Gi.default.createElement(wB,{style:{fontSize:"11px",color:"#666"}},"Supported formats: MP3, WAV, OGG, M4A, AAC"),_&&Gi.default.createElement(Pde,null," ",_.name," (",xue(_.size),")")),Gi.default.createElement("input",{ref:re,type:"file",accept:"audio/*,.mp3,.wav,.ogg,.m4a,.aac",onChange:Ce,style:{display:"none"}}))):Gi.default.createElement(xB,null,Gi.default.createElement(bB,null,"Audio URL"),Gi.default.createElement(Ide,{value:M,temporarilySetValue:P,discardTemporaryValue:()=>P(""),permanentlySetValue:P,isValid:Ze=>Ze.trim()===""||ft(Ze.trim())}),M.trim()===""&&Gi.default.createElement(FP,{style:{marginTop:"4px",fontSize:"11px",color:"#666"}},"Example: https://example.com/audio.mp3"),Gi.default.createElement(FP,null,"Enter a URL to an audio file. Make sure the server supports CORS if loading from a different domain.")),H&&Gi.default.createElement(kde,null," ",H),K&&Gi.default.createElement(Ode,null," ",K),Gi.default.createElement(bde,null,Gi.default.createElement(SB,{onClick:Ue,disabled:z},"Cancel"),Gi.default.createElement(SB,{variant:"primary",onClick:be,disabled:!ke()||z},z?"Attaching...":"Attach Audio"))))},zde=Bde});function wCe(){return co.default.createElement("svg",{fill:"#FFFFFF",width:"800px",height:"800px",viewBox:"0 0 1920 1920",xmlns:"http://www.w3.org/2000/svg",style:{width:"15px",height:"15px"}},co.default.createElement("path",{d:"M1637.718 0c93.4 0 169.406 76.007 169.406 169.407v1581.13c0 93.512-76.007 169.407-169.406 169.407H451.87V0h1185.848zM1158.7 581l-79.861 79.861 242.422 242.423H667v112.94h654.262l-242.422 242.423 79.861 79.862 378.755-378.755L1158.7 581zM225.938 1920h112.938V.056H225.938z"}))}var co,Vde,Gde,jde,Hde,Wde,qde,$de,Xde,Yde,Kde,Zde,Qde,Jde,ehe,the,nhe,EB,rhe,ihe,she,ohe,TCe=A(()=>{co=G(et()),Jt(),Vde=an(),Sr(),jde=ge.div(Gde||(Gde=X([`
  position: absolute;
  bottom: 10px;
  left: 10px;
  z-index: 100;
  display: flex;
  align-items: center;
  gap: 8px;
  width: `,`px; /* Subtract left/right margins */
  box-sizing: border-box;
`])),o=>o.width-20),Wde=ge.input(Hde||(Hde=X([`
  background: `,`;
  color: #cccccc;
  border: 1px solid `,`;
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  font-family: inherit;
  flex: 1; /* Expand to fill available space */
  min-width: 80px; /* Minimum width to ensure usability */
  transition: all 0.15s ease-out;

  &:focus {
    outline: none;
    border-color: #0078d4;
    background: #1e1e1e;
  }

  &::placeholder {
    color: #6a6a6a;
  }
`])),o=>o.hasValue?"#1e1e1e":"#2d2d30",o=>o.hasValue?"#0078d4":"#3e3e42"),$de=ge.button(qde||(qde=X([`
  background: #2d2d30;
  color: white;
  border: 1px solid #3e3e42;
  padding: 8px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 4px;

  &:hover {
    background: #3e3e42;
  }

  &:active {
    background: #1e1e1e;
  }
`]))),Yde=ge.button(Xde||(Xde=X([`
  background: `,`;
  color: white;
  border: 1px solid #3e3e42;
  padding: 8px 10px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 6px;

  &:hover {
    background: `,`;
  }

  &:active {
    background: #005a9e;
  }
`])),o=>o.isOpen?"#0078d4":"#2d2d30",o=>o.isOpen?"#106ebe":"#3e3e42"),Zde=ge.div(Kde||(Kde=X([`
  position: absolute;
  bottom: 100%;
  left: 0;
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  min-width: 200px;
  opacity: `,`;
  visibility: `,`;
  transform: `,`;
  transition: all 0.15s ease-out;
  z-index: 1000;
`])),o=>o.isOpen?1:0,o=>o.isOpen?"visible":"hidden",o=>o.isOpen?"translateY(0)":"translateY(10px)"),Jde=ge.div(Qde||(Qde=X([`
  padding: 4px 0;

  &:not(:last-child) {
    border-bottom: 1px solid #3e3e42;
  }
`]))),the=ge.div(ehe||(ehe=X([`
  position: relative;

  &:hover > div:last-child {
    opacity: `,`;
    visibility: `,`;
  }
`])),o=>o.hasSubmenu?1:0,o=>o.hasSubmenu?"visible":"hidden"),EB=ge.button(nhe||(nhe=X([`
  width: 100%;
  background: transparent;
  color: #cccccc;
  border: none;
  padding: 8px 16px;
  text-align: left;
  cursor: pointer;
  font-size: 12px;
  font-family: inherit;
  display: flex;
  align-items: center;
  justify-content: space-between;

  &:hover {
    background: #3e3e42;
    color: white;
  }

  &:active {
    background: #0078d4;
  }
`]))),ihe=ge.div(rhe||(rhe=X([`
  position: absolute;
  left: 100%;
  top: 0;
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  min-width: 150px;
  opacity: 0;
  visibility: hidden;
  transition: all 0.15s ease-out;
  z-index: 1001;
`]))),she=({layoutP:o,onSVGViewerClear:l,onSVGViewerLoad:u,onSVGViewerShow:m,onSVGViewerHide:_,onFileSave:S,onMarkersAdd:M,onMarkersClear:P,onMarkersLog:k,onEventsAdd:L,onEventsClear:z,onEventsLog:$,onSheetCreate:H,onSheetDuplicate:j,onSheetObjectCreate:K,onSearchChange:Q,onSearchTrigger:re})=>{let[ae,ue]=(0,co.useState)(!1),[ye,Ae]=(0,co.useState)(""),[Ce,Se]=(0,co.useState)(0),ft=(0,co.useCallback)(()=>{ue(Ke=>!Ke)},[]),ke=(0,co.useCallback)(()=>{ue(!1)},[]),be=(0,co.useCallback)(Ke=>{let Yt=Ke.target.value;Ae(Yt),Q&&Q(Yt)},[Q]),Ue=(0,co.useCallback)(Ke=>{if(Ke.key==="Enter"){let Yt=Ce+1;Se(Yt),re&&re(Yt),Q&&Q(ye)}},[Q,re,ye,Ce]),Ze=(0,co.useCallback)(Ke=>{Ke&&Ke(),ke()},[ke]),ze=[{label:"File",submenu:[{label:"Save",action:S}]},{label:"Sheets",submenu:[{label:"Create Sheet",action:H},{label:"Duplicate Sheet",action:j},{label:"Create Sheet Object",action:K}]},{label:"Markers",submenu:[{label:"Add",action:M},{label:"Log",action:k},{label:"Clear",action:P}]},{label:"Events",submenu:[{label:"Add",action:L},{label:"Log",action:$},{label:"Clear",action:z}]},{label:"Data Viewer",submenu:[{label:"Show",action:m},{label:"Hide",action:_},{label:"Load",action:u},{label:"Clear",action:l}]}],Ft=(Ke,Yt)=>co.default.createElement(the,{key:Yt,hasSubmenu:!!Ke.submenu},co.default.createElement(EB,{hasSubmenu:!!Ke.submenu,onClick:()=>!Ke.submenu&&Ze(Ke.action)},Ke.label,Ke.submenu&&co.default.createElement("span",null,"")),Ke.submenu&&co.default.createElement(ihe,null,Ke.submenu.map((mt,nt)=>co.default.createElement(EB,{key:nt,onClick:()=>Ze(mt.action)},mt.label))));return ri(()=>{let Ke=(0,Vde.val)(o),Yt=Ke.rightPanelOpen,mt=Ke.leftDims.width;return co.default.createElement(jde,{width:mt},co.default.createElement(Yde,{isOpen:ae,onClick:ft},co.default.createElement("span",null,"")),co.default.createElement(Zde,{isOpen:ae},co.default.createElement(Jde,null,ze.map(Ft))),co.default.createElement(Wde,{type:"text",placeholder:"Search...",value:ye,onChange:be,onKeyDown:Ue,hasValue:ye.length>0}),co.default.createElement($de,{isActive:Yt,onClick:()=>{Ke.setRightPanelOpen(!Yt)},title:Yt?"Hide timeline editor":"Show timeline editor",style:{transform:"scale(".concat(Yt?-1:1,", 1)")}},co.default.createElement(wCe,null)),ae&&co.default.createElement("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:99},onClick:ke}))},[o,ae,ze])},ohe=she}),$0,ahe,lhe,che,uhe,dhe,hhe,fhe,phe,mhe,ghe,vhe,MB,yhe,_he,ECe=A(()=>{$0=G(et()),Jt(),lhe=ge.div(ahe||(ahe=X([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: `,`;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`])),o=>o.isOpen?"flex":"none"),uhe=ge.div(che||(che=X([`
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  padding: 24px;
  min-width: 400px;
  max-width: 500px;
`]))),hhe=ge.h3(dhe||(dhe=X([`
  color: #ffffff;
  font-size: 16px;
  font-family: inherit;
  margin: 0 0 16px 0;
  font-weight: 500;
`]))),phe=ge.input(fhe||(fhe=X([`
  width: 100%;
  background: #1e1e1e;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  padding: 8px 12px;
  color: #ffffff;
  font-size: 14px;
  font-family: inherit;
  margin-bottom: 20px;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #0078d4;
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.3);
  }

  &::placeholder {
    color: #888888;
  }
`]))),ghe=ge.div(mhe||(mhe=X([`
  display: flex;
  gap: 12px;
  justify-content: flex-end;
`]))),MB=ge.button(vhe||(vhe=X([`
  background: `,`;
  color: `,`;
  border: 1px solid
    `,`;
  border-radius: 4px;
  padding: 8px 16px;
  font-size: 14px;
  font-family: inherit;
  cursor: pointer;
  min-width: 80px;

  &:hover {
    background: `,`;
  }

  &:active {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#0078d4":"transparent",o=>o.variant==="primary"?"#ffffff":"#cccccc",o=>o.variant==="primary"?"#0078d4":"#3e3e42",o=>o.variant==="primary"?"#106ebe":"#3e3e42",o=>o.variant==="primary"?"#005a9e":"#4a4a4a"),yhe=(0,$0.forwardRef)(({onConfirm:o,onCancel:l},u)=>{let[m,_]=(0,$0.useState)(!1),[S,M]=(0,$0.useState)("create"),[P,k]=(0,$0.useState)(""),L=S==="create"?"Create New Sheet":"Duplicate Sheet",z="Enter sheet name";(0,$0.useImperativeHandle)(u,()=>({open:(Q,re)=>{M(Q),_(!0),k(Q==="duplicate"&&re?"".concat(re," Copy"):"")},close:()=>{_(!1),k("")}}));let $=(0,$0.useCallback)(()=>{let Q=P.trim();Q&&(o(Q,S),_(!1),k(""))},[P,S,o]),H=(0,$0.useCallback)(()=>{l(),_(!1),k("")},[l]),j=(0,$0.useCallback)(Q=>{Q.key==="Enter"?$():Q.key==="Escape"&&H()},[$,H]),K=(0,$0.useCallback)(Q=>{Q.target===Q.currentTarget&&H()},[H]);return $0.default.createElement(lhe,{isOpen:m,onClick:K},$0.default.createElement(uhe,null,$0.default.createElement(hhe,null,L),$0.default.createElement(phe,{type:"text",value:P,onChange:Q=>k(Q.target.value),onKeyDown:j,placeholder:z,autoFocus:!0}),$0.default.createElement(ghe,null,$0.default.createElement(MB,{variant:"secondary",onClick:H},"Cancel"),$0.default.createElement(MB,{variant:"primary",onClick:$,disabled:!P.trim()},"Create"))))}),_he=yhe}),_r,xhe,bhe,She,whe,The,Ehe,Mhe,C7,Che,Wg,Ahe,_9,Phe,Rhe,Ihe,Nhe,khe,Dhe,Ohe,Lhe,Fhe,Uhe,Bhe,zhe,Vhe,Ghe,jhe,Hhe,Whe,qhe,$he,Xhe,Yhe,Khe,Zhe,CB,AB,Qhe,MCe=A(()=>{_r=G(et()),Jt(),bhe=ge.div(xhe||(xhe=X([`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: `,`;
  align-items: center;
  justify-content: center;
  z-index: 10000;
`])),o=>o.isOpen?"flex":"none"),whe=ge.div(She||(She=X([`
  background: #2d2d30;
  border: 1px solid #3e3e42;
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  padding: 24px;
  min-width: 500px;
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
`]))),Ehe=ge.h3(The||(The=X([`
  color: #ffffff;
  font-size: 16px;
  font-family: inherit;
  margin: 0 0 20px 0;
  font-weight: 500;
`]))),C7=ge.div(Mhe||(Mhe=X([`
  margin-bottom: 16px;
`]))),Wg=ge.label(Che||(Che=X([`
  display: block;
  color: #cccccc;
  font-size: 12px;
  font-family: inherit;
  margin-bottom: 6px;
  font-weight: 500;
`]))),_9=ge.input(Ahe||(Ahe=X([`
  width: 100%;
  background: #1e1e1e;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  padding: 8px 12px;
  color: #ffffff;
  font-size: 14px;
  font-family: inherit;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #0078d4;
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.3);
  }

  &::placeholder {
    color: #888888;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`]))),Rhe=ge.select(Phe||(Phe=X([`
  width: 100%;
  background: #1e1e1e;
  border: 1px solid #3e3e42;
  border-radius: 4px;
  padding: 8px 12px;
  color: #ffffff;
  font-size: 14px;
  font-family: inherit;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #0078d4;
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.3);
  }

  option {
    background: #1e1e1e;
    color: #ffffff;
  }
`]))),Nhe=ge.div(Ihe||(Ihe=X([`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 12px;
`]))),Dhe=ge.div(khe||(khe=X([`
  display: flex;
  gap: 12px;
  align-items: flex-end;
`]))),Lhe=ge.div(Ohe||(Ohe=X([`
  width: 40px;
  height: 32px;
  border-radius: 4px;
  border: 1px solid #3e3e42;
  background: `,`;
  cursor: pointer;
  position: relative;

  &:hover {
    border-color: #0078d4;
  }
`])),o=>o.color),Uhe=ge.input(Fhe||(Fhe=X([`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
`]))),zhe=ge(_9)(Bhe||(Bhe=X([`
  flex: 1;
  font-family: 'Courier New', monospace;
  text-transform: uppercase;
`]))),Ghe=ge.div(Vhe||(Vhe=X([`
  display: flex;
  align-items: center;
  gap: 12px;
`]))),Hhe=ge.div(jhe||(jhe=X([`
  width: 48px;
  height: 24px;
  border-radius: 12px;
  background: `,`;
  border: 1px solid `,`;
  position: relative;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background: `,`;
  }
`])),o=>o.isOn?"#0078d4":"#3e3e42",o=>o.isOn?"#0078d4":"#5a5a5a",o=>o.isOn?"#106ebe":"#4a4a4a"),qhe=ge.div(Whe||(Whe=X([`
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #ffffff;
  position: absolute;
  top: 2px;
  left: `,`;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
`])),o=>o.isOn?"26px":"2px"),Xhe=ge.span($he||($he=X([`
  color: `,`;
  font-size: 14px;
  font-family: inherit;
  font-weight: `,`;
`])),o=>o.isOn?"#ffffff":"#cccccc",o=>o.isOn?"500":"normal"),Khe=ge.div(Yhe||(Yhe=X([`
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 24px;
`]))),CB=ge.button(Zhe||(Zhe=X([`
  background: `,`;
  color: `,`;
  border: 1px solid
    `,`;
  border-radius: 4px;
  padding: 8px 16px;
  font-size: 14px;
  font-family: inherit;
  cursor: pointer;
  min-width: 80px;

  &:hover {
    background: `,`;
  }

  &:active {
    background: `,`;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`])),o=>o.variant==="primary"?"#0078d4":"transparent",o=>o.variant==="primary"?"#ffffff":"#cccccc",o=>o.variant==="primary"?"#0078d4":"#3e3e42",o=>o.variant==="primary"?"#106ebe":"#3e3e42",o=>o.variant==="primary"?"#005a9e":"#4a4a4a"),AB=(0,_r.forwardRef)(({onConfirm:o,onCancel:l},u)=>{let[m,_]=(0,_r.useState)(!1),[S,M]=(0,_r.useState)(""),[P,k]=(0,_r.useState)(""),[L,z]=(0,_r.useState)("number"),[$,H]=(0,_r.useState)(""),[j,K]=(0,_r.useState)(""),[Q,re]=(0,_r.useState)(""),[ae,ue]=(0,_r.useState)(""),[ye,Ae]=(0,_r.useState)("#FFFFFF"),[Ce,Se]=(0,_r.useState)(!1),ft=Et=>{let we=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Et);return we?{r:parseInt(we[1],16)/255,g:parseInt(we[2],16)/255,b:parseInt(we[3],16)/255,a:1}:{r:1,g:1,b:1,a:1}},ke=Et=>{let we=vt=>{let Mt=Math.round(vt*255).toString(16);return Mt.length===1?"0"+Mt:Mt};return"#".concat(we(Et.r)).concat(we(Et.g)).concat(we(Et.b)).toUpperCase()},be=Et=>{try{let we=JSON.parse(Et);if(we&&typeof we=="object"&&"r"in we&&"g"in we&&"b"in we)return{r:we.r,g:we.g,b:we.b,a:1}}catch{}return{r:1,g:1,b:1,a:1}};(0,_r.useImperativeHandle)(u,()=>({open:Et=>{_(!0),M(Et||""),k(""),z("number"),H(""),K(""),re(""),ue(""),Ae("#FFFFFF"),Se(!1)},close:()=>{_(!1)}}));let Ue=Et=>{switch(Et){case"number":return"0";case"string":return"Hello World";case"boolean":return"false";case"rgba":return'{"r": 1, "g": 1, "b": 1, "a": 1}';case"compound":return'{"x": 0, "y": 0, "z": 0}';default:return""}},Ze=Et=>{switch(Et){case"number":return"e.g. 0, 3.14, -10";case"string":return'e.g. "Hello World"';case"boolean":return"Use toggle below";case"rgba":return"Use color picker or enter hex";case"compound":return'{"x": 0, "y": 0, "z": 0}';default:return""}},ze=Et=>{z(Et);let we=Ue(Et);if(H(we),Et==="rgba"){let vt=be(we);Ae(ke(vt))}else Et==="boolean"&&(Se(!1),H("false"));Et!=="number"&&(K(""),re(""),ue(""))},Ft=()=>{let Et=!Ce;Se(Et),H(Et.toString())},Ke=Et=>{Ae(Et);let we=ft(Et);H(JSON.stringify(we))},Yt=Et=>{/^#[0-9A-Fa-f]{6}$/.test(Et)?Ke(Et):Ae(Et)},mt=(Et,we)=>{switch(we){case"number":let vt=parseFloat(Et);return isNaN(vt)?0:vt;case"string":return Et;case"boolean":return Et.toLowerCase()==="true";case"rgba":try{return JSON.parse(Et)}catch{return{r:1,g:1,b:1,a:1}}case"compound":try{return JSON.parse(Et)}catch{return{}}default:return Et}},nt=(0,_r.useCallback)(()=>{let Et=S.trim(),we=P.trim();if(!Et||!we)return;let vt=mt($,L),Mt={name:Et,key:we,type:L,value:vt};L==="number"&&(j!==""&&(Mt.min=parseFloat(j)),Q!==""&&(Mt.max=parseFloat(Q)),ae!==""&&(Mt.step=parseFloat(ae))),o(Mt),_(!1)},[S,P,L,$,j,Q,ae,o]),Ee=(0,_r.useCallback)(()=>{l(),_(!1)},[l]),ct=(0,_r.useCallback)(Et=>{Et.key==="Enter"&&Et.ctrlKey?nt():Et.key==="Escape"&&Ee()},[nt,Ee]),Nt=(0,_r.useCallback)(Et=>{Et.target===Et.currentTarget&&Ee()},[Ee]),Re=L==="number",it=L==="rgba",Ht=L==="boolean",Kt=S.trim()!==""&&P.trim()!=="";return _r.default.createElement(bhe,{isOpen:m,onClick:Nt},_r.default.createElement(whe,null,_r.default.createElement(Ehe,null,"Create Sheet Object"),_r.default.createElement(C7,null,_r.default.createElement(Wg,null,"Object Name"),_r.default.createElement(_9,{type:"text",value:S,onChange:Et=>M(Et.target.value),onKeyDown:ct,placeholder:"Enter object name (e.g. 'myBox', 'character')",autoFocus:!0})),_r.default.createElement(C7,null,_r.default.createElement(Wg,null,"Property Key"),_r.default.createElement(_9,{type:"text",value:P,onChange:Et=>k(Et.target.value),onKeyDown:ct,placeholder:"Enter property key (e.g. 'position', 'color', 'scale')"})),_r.default.createElement(C7,null,_r.default.createElement(Wg,null,"Type"),_r.default.createElement(Rhe,{value:L,onChange:Et=>ze(Et.target.value)},_r.default.createElement("option",{value:"number"},"Number"),_r.default.createElement("option",{value:"string"},"String"),_r.default.createElement("option",{value:"boolean"},"Boolean"),_r.default.createElement("option",{value:"rgba"},"Color"),_r.default.createElement("option",{value:"compound"},"Object"))),_r.default.createElement(C7,null,_r.default.createElement(Wg,null,"Default Value"),it?_r.default.createElement(Dhe,null,_r.default.createElement(Lhe,{color:ye},_r.default.createElement(Uhe,{type:"color",value:ye,onChange:Et=>Ke(Et.target.value)})),_r.default.createElement(zhe,{type:"text",value:ye,onChange:Et=>Yt(Et.target.value),onKeyDown:ct,placeholder:"#FFFFFF"})):Ht?_r.default.createElement(Ghe,null,_r.default.createElement(Hhe,{isOn:Ce,onClick:Ft},_r.default.createElement(qhe,{isOn:Ce})),_r.default.createElement(Xhe,{isOn:Ce},Ce?"True":"False")):_r.default.createElement(_9,{type:"text",value:$,onChange:Et=>H(Et.target.value),onKeyDown:ct,placeholder:Ze(L)})),Re&&_r.default.createElement(C7,null,_r.default.createElement(Wg,null,"Range (Optional)"),_r.default.createElement(Nhe,null,_r.default.createElement("div",null,_r.default.createElement(Wg,{style:{fontSize:"11px",marginBottom:"4px"}},"Min"),_r.default.createElement(_9,{type:"number",value:j,onChange:Et=>K(Et.target.value),onKeyDown:ct,placeholder:"Min"})),_r.default.createElement("div",null,_r.default.createElement(Wg,{style:{fontSize:"11px",marginBottom:"4px"}},"Max"),_r.default.createElement(_9,{type:"number",value:Q,onChange:Et=>re(Et.target.value),onKeyDown:ct,placeholder:"Max"})),_r.default.createElement("div",null,_r.default.createElement(Wg,{style:{fontSize:"11px",marginBottom:"4px"}},"Step"),_r.default.createElement(_9,{type:"number",value:ae,onChange:Et=>ue(Et.target.value),onKeyDown:ct,placeholder:"Step"})))),_r.default.createElement(Khe,null,_r.default.createElement(CB,{variant:"secondary",onClick:Ee},"Cancel"),_r.default.createElement(CB,{variant:"primary",onClick:nt,disabled:!Kt},"Create"))))}),AB.displayName="SheetObjectModal",Qhe=AB});function CCe(o,l){let u=new File([o],l),m=URL.createObjectURL(u),_=Object.assign(document.createElement("a"),{href:m,target:"_blank",rel:"noopener"});_.setAttribute("download",l),_.click(),setTimeout(()=>{URL.revokeObjectURL(m)},4e4)}var Bs,zn,A7,Jhe,efe,tfe,nfe,Rf,rfe,ife,sfe,ofe,afe,lfe,cfe,ufe,dfe,hfe,ffe,pfe,mfe,ZS,gfe,vfe,yfe,_fe,xfe,bfe,Sfe,wfe,Tfe,Efe,M1=A(()=>{Ie(),qy(),yf(),Sr(),MQ(),Bs=an(),zn=G(et()),Jt(),A7=Pve(),AMe(),pP(),UMe(),vCe(),Ky(),xS(),nf(),wZ(),QZ(),$a(),$t(),V0(),yCe(),n9(),AS(),_Ce(),bCe(),SCe(),TCe(),ECe(),MCe(),NU(),efe=ge(BL)(Jhe||(Jhe=X([`
  z-index: `,`;
  box-shadow: 2px 2px 0 rgb(0 0 0 / 11%);
  `,`
`])),Cv.sequenceEditorPanel,o=>o.collapsedWidth?"width: ".concat(o.collapsedWidth,"px !important; max-width: ").concat(o.collapsedWidth,"px !important;"):""),nfe=ge.div(tfe||(tfe=X([`
  background-color: rgba(40, 43, 47, 0.99);
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  z-index: -1;
  pointer-events: none;
`]))),Rf=(()=>{let o={svgViewer:0,rightBackground:0,scrollableArea:0,rightOverlay:0,lengthIndicatorCover:0,lengthIndicatorStrip:0,playhead:0,currentFrameStamp:0,marker:0,horizontalScrollbar:0},l=-1;for(let u of Object.keys(o))o[u]=l,l++;return o})(),ife=ge(NL)(rfe||(rfe=X([`
  position: absolute;
  left: 0;
  top: 0;
  z-index: 2;

  `,` {
    height: 60px;
    display: flex;
    flex-direction: column;
    align-items: normal;
    padding: 0;
  }
`])),BC),sfe={edges:{left:{from:"screenLeft",distance:.1},right:{from:"screenRight",distance:.2},top:{from:"screenBottom",distance:.4},bottom:{from:"screenBottom",distance:.01}}},ofe=()=>ri(()=>{var o;let l=ce(),u={width:(o=(0,Bs.val)(l.atomP.historic.panels.sequenceEditor.rightPanelOpen))==null||o?QU*2:QU,height:200};return zn.default.createElement(EL,{panelId:"sequenceEditor",defaultPosition:sfe,minDims:u},zn.default.createElement(afe,null))},[]),afe=()=>{let{dims:o}=Yy(),[l,u]=(0,zn.useState)(null),[m,_]=(0,zn.useState)(""),[S,M]=(0,zn.useState)(0),P=(0,zn.useRef)(null),[k,L]=(0,zn.useState)(!1),[z,$]=(0,zn.useState)(!1),[H,j]=(0,zn.useState)(null),K=(0,zn.useRef)(null),Q=(0,zn.useRef)(null),re=(0,zn.useRef)(new Map),ae=(0,zn.useRef)(null),ue=(0,zn.useCallback)(()=>{var we;(we=P.current)==null||we.clearData()},[]),ye=(0,zn.useCallback)(()=>{L(!0)},[]),Ae=(0,zn.useCallback)(()=>{var we;(we=P.current)==null||we.show()},[]),Ce=(0,zn.useCallback)(()=>{var we;(we=P.current)==null||we.hide()},[]),Se=(0,zn.useCallback)((we,vt)=>{var Mt;(Mt=P.current)==null||Mt.addData(we,vt),L(!1)},[]),ft=(0,zn.useCallback)(()=>{L(!1)},[]),ke=(0,zn.useCallback)(we=>De(void 0,null,function*(){if(!H)throw new Error("No sheet selected");try{let vt=H.project.publicApi.sheet(H.address.sheetId).sequence,Mt;we instanceof File?Mt=URL.createObjectURL(we):Mt=we,yield vt.attachAudio({source:Mt}),console.log(" Audio attached successfully"),we instanceof File&&setTimeout(()=>{URL.revokeObjectURL(Mt)},5e3)}catch(vt){throw console.error(" Failed to attach audio:",vt),vt}}),[H]),be=(0,zn.useCallback)(()=>{$(!1),j(null)},[]),Ue=(0,zn.useCallback)(()=>{var we;(we=K.current)==null||we.open("create")},[]),Ze=(0,zn.useCallback)(()=>{var we,vt;let Mt=ae.current,Sn=((we=Mt==null?void 0:Mt.address)==null?void 0:we.sheetId)||"Sheet";(vt=K.current)==null||vt.open("duplicate",Sn)},[]),ze=(0,zn.useCallback)((we,vt)=>{var Mt;try{let Sn=ae.current;if((Mt=Sn==null?void 0:Sn.project)!=null&&Mt.publicApi){let ar=Sn.project.publicApi.sheet(we);console.log(" Successfully ".concat(vt==="create"?"created":"duplicated"," sheet: ").concat(we))}else console.error(" No current sheet or project available")}catch(Sn){console.error(" Failed to ".concat(vt," sheet:"),Sn)}},[]),Ft=(0,zn.useCallback)(()=>{console.log(" Sheet modal cancelled")},[]),Ke=(0,zn.useCallback)(()=>{var we;(we=Q.current)==null||we.open()},[]),Yt=(0,zn.useCallback)(we=>{_(we)},[]),mt=(0,zn.useCallback)(we=>{M(we)},[]);zn.default.useEffect(()=>{let we=vt=>{let{sheet:Mt}=vt.detail;j(Mt),$(!0)};return document.addEventListener("theatre:attachAudio",we),()=>{document.removeEventListener("theatre:attachAudio",we)}},[]);let nt=(0,zn.useCallback)(we=>{try{let vt=ae.current;if(vt){let Mt;switch(we.type){case"number":if(we.min!==void 0||we.max!==void 0||we.step!==void 0){let vi={};we.min!==void 0&&we.max!==void 0&&(vi.range=[we.min,we.max]),we.step!==void 0&&(vi.nudgeMultiplier=we.step),Mt=A7.types.number(we.value,vi)}else Mt=A7.types.number(we.value);break;case"string":Mt=A7.types.string(we.value);break;case"boolean":Mt=A7.types.boolean(we.value);break;case"rgba":Mt=A7.types.rgba(we.value);break;case"compound":Mt=we.value;break;default:Mt=we.value}let Sn=vt.project.publicApi.sheet(vt.address.sheetId),ar="".concat(vt.address.sheetId,":").concat(we.name),yr=re.current.get(ar)||{};yr[we.key]=Mt,re.current.set(ar,yr);let Pr;try{let vi,Is={};try{vi=Sn.object(we.name,{}),Is=vi.value||{}}catch{}let ei=R({},yr);Pr=Sn.object(we.name,ei,{reconfigure:!0});let uo=Object.keys(yr),pi=Object.keys(Pr.value||{}),wi=uo.filter(_0=>!pi.includes(_0));wi.length!==0&&(console.log(" Still missing props:",wi),console.log("This indicates a fundamental Theatre.js limitation with reconfigure"))}catch(vi){throw console.error(" Object creation failed:",vi),vi}}else console.error(" No current sheet available")}catch(vt){console.error(" Failed to create sheet object:",vt)}},[]),Ee=(0,zn.useCallback)(()=>{console.log(" Sheet object modal cancelled")},[]),ct=(0,zn.useCallback)(()=>{console.log(" Start Menu: Saving project files");try{let we=(0,Bs.val)(ce().projectsP);Object.values(we).forEach(vt=>{if(vt){let Mt=vt.address.projectId,Sn=Mt.replace(/[^\w\d'_\-]+/g," ").trim(),ar="".concat(Sn,".json"),yr=JSON.stringify(ce().createContentOfSaveFile(Mt),null,2);CCe(yr,ar),console.log(" Saved project: ".concat(ar))}})}catch(we){console.error(" Failed to save project files:",we)}},[]),Nt=(0,zn.useCallback)(()=>{try{let we=Ks(nh().filter(vt=>Ne(vt)||Ot(vt)).map(vt=>Ot(vt)?vt.sheet:vt));if(we.length>0){let vt=we[0],Mt=vt.getSequence();ce().transaction(({stateEditors:Sn})=>{Sn.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:vt.address,markers:[{id:TQ(),position:Mt.position,label:"Marker ".concat(Math.floor(Mt.position*100)/100,"s")}],snappingFunction:Mt.closestGridPosition})})}else console.warn(" No sheet selected for adding marker")}catch(we){console.error(" Failed to add marker:",we)}},[]),Re=(0,zn.useCallback)(()=>{try{let we=Ks(nh().filter(vt=>Ne(vt)||Ot(vt)).map(vt=>Ot(vt)?vt.sheet:vt));if(we.length>0){let vt=we[0],Mt=vt.getSequence();ce().transaction(({stateEditors:Sn})=>{Sn.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceEvents({sheetAddress:vt.address,events:[{id:EQ(),name:"event",position:Mt.position}]})})}else console.warn(" No sheet selected for adding event")}catch(we){console.error(" Failed to add event:",we)}},[]),it=(0,zn.useCallback)(()=>{try{let we=Ks(nh().filter(vt=>Ne(vt)||Ot(vt)).map(vt=>Ot(vt)?vt.sheet:vt));if(we.length>0){let vt=we[0],Mt=ce().atomP.historic.projects.stateByProjectId[vt.address.projectId].stateBySheetId[vt.address.sheetId].sequenceEditor.markerSet,Sn=(0,Bs.val)(Mt.allIds);Sn&&Object.keys(Sn).length>0?Object.keys(Sn).forEach(ar=>{ce().transaction(({stateEditors:yr})=>{yr.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeMarker({sheetAddress:vt.address,markerId:ar})})}):console.log(" No markers to clear")}else console.warn(" No sheet selected for clearing markers")}catch(we){console.error(" Failed to clear markers:",we)}},[]),Ht=(0,zn.useCallback)(()=>{try{let we=Ks(nh().filter(vt=>Ne(vt)||Ot(vt)).map(vt=>Ot(vt)?vt.sheet:vt));if(we.length>0){let vt=we[0],Mt=(0,Bs.val)(ce().atomP.historic.projects.stateByProjectId[vt.address.projectId].stateBySheetId[vt.address.sheetId]),Sn=(0,Bs.val)(ce().atomP.historic.coreByProject[vt.address.projectId].sheetsById[vt.address.sheetId].sequence.markers)||[];console.group(" Markers for sheet:",vt.address.sheetId),console.log("Total markers:",Sn.length),Sn.forEach((ar,yr)=>{console.log("".concat(yr+1,'. "').concat(ar.label||"Unnamed",'" at ').concat(ar.position,"s (ID: ").concat(ar.id,")"))}),console.groupEnd()}else console.warn(" No sheet selected for logging markers")}catch(we){console.error(" Failed to log markers:",we)}},[]),Kt=(0,zn.useCallback)(()=>{try{let we=Ks(nh().filter(vt=>Ne(vt)||Ot(vt)).map(vt=>Ot(vt)?vt.sheet:vt));if(we.length>0){let vt=we[0],Mt=ce().atomP.historic.projects.stateByProjectId[vt.address.projectId].stateBySheetId[vt.address.sheetId].sequenceEditor.eventSet,Sn=(0,Bs.val)(Mt==null?void 0:Mt.allIds);Sn&&Object.keys(Sn).length>0?Object.keys(Sn).forEach(ar=>{ce().transaction(({stateEditors:yr})=>{yr.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeEvent({sheetAddress:vt.address,eventId:ar})})}):console.log(" No events to clear")}else console.warn(" No sheet selected for clearing events")}catch(we){console.error(" Failed to clear events:",we)}},[]),Et=(0,zn.useCallback)(()=>{try{let we=Ks(nh().filter(vt=>Ne(vt)||Ot(vt)).map(vt=>Ot(vt)?vt.sheet:vt));if(we.length>0){let vt=we[0],Mt=(0,Bs.val)(ce().atomP.historic.coreByProject[vt.address.projectId].sheetsById[vt.address.sheetId].sequence.events)||[];console.group(" Events for sheet:",vt.address.sheetId),console.log("Total events:",Mt.length),Mt.forEach((Sn,ar)=>{console.log("".concat(ar+1,'. "').concat(Sn.name,'" at ').concat(Sn.position,"s").concat(Sn.value!==void 0?" (value: ".concat(JSON.stringify(Sn.value),")"):""," (ID: ").concat(Sn.id,")"))}),console.groupEnd()}else console.warn(" No sheet selected for logging events")}catch(we){console.error(" Failed to log events:",we)}},[]);return CTe(l),ri(()=>{var we;let vt=ce(),Mt=(we=(0,Bs.val)(vt.atomP.historic.panels.sequenceEditor.rightPanelOpen))!=null?we:!0,Sn=Bs.prism.memo("panelSize",()=>{let ci=o.width,Xg=o.height;return{width:ci,height:Xg,widthWithoutBorder:ci-2,heightWithoutBorder:Xg-4,screenX:o.left,screenY:o.top}},[o,Mt]),ar=Ks(nh().filter(ci=>Ne(ci)||Ot(ci)).map(ci=>Ot(ci)?ci.sheet:ci));if(Ks(ar.map(ci=>ci.template)).length!==1)return zn.default.createElement(zn.default.Fragment,null);let yr=ar[0];if(!yr)return zn.default.createElement(zn.default.Fragment,null);ae.current=yr;let Pr=yr.getSequence().length,vi=(0,Bs.val)(ce().atomP.ahistoric.projects.stateByProjectId[yr.address.projectId].stateBySheetId[yr.address.sheetId].sequence.clippedSpaceRange)||{start:0,end:10},Is=vi.start===0&&vi.end===10,ei=Pr*1.05;Pr>0&&Pr!==10&&vi.end!==ei&&Is&&setTimeout(()=>{ce().transaction(({stateEditors:ci})=>{ci.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.clippedSpaceRange.set(B(R({},yr.address),{range:{start:0,end:ei}}))})},0);let uo=WL("panelSizeP",Sn).pointer,pi=Bs.prism.memo("key",()=>JSON.stringify(yr.address),[yr]),wi=FMe(yr,uo).getValue();(0,Bs.val)(wi.tree.children).length>0;let _0=(0,Bs.val)(yr.project.pointers.historic.sheetsById[yr.address.sheetId].sequence);_0!=null&&_0.length&&_0.length>0||_0!=null&&_0.markers&&_0.markers.length>0;let Go=Bs.prism.memo("containerRef",Efe,[]),lh=(0,Bs.val)(wi.graphEditorDims.isAvailable),hu=(0,Bs.val)(wi.graphEditorDims.isOpen),x0=(0,Bs.val)(wi.rightPanelOpen),Hr=x0?void 0:(0,Bs.val)(wi.leftDims.width);return zn.default.createElement(efe,{collapsedWidth:Hr,ref:ci=>{Go(ci),ci!==l&&u(ci)}},zn.default.createElement(nfe,{style:{width:"".concat((0,Bs.val)(wi.leftDims.width),"px")}}),zn.default.createElement(ohe,{layoutP:wi,onSVGViewerClear:ue,onSVGViewerLoad:ye,onSVGViewerShow:Ae,onSVGViewerHide:Ce,onFileSave:ct,onMarkersAdd:Nt,onMarkersClear:it,onMarkersLog:Ht,onEventsAdd:Re,onEventsClear:Kt,onEventsLog:Et,onSheetCreate:Ue,onSheetDuplicate:Ze,onSheetObjectCreate:Ke,onSearchChange:Yt,onSearchTrigger:mt}),zn.default.createElement(are,{layoutP:wi},zn.default.createElement(lfe,{layoutP:wi}),zn.default.createElement(yue,{ref:P,key:pi+"-svgViewer",layoutP:wi,sheetAddress:yr.address,renderMode:"both",color:"#4575e3"}),zn.default.createElement(voe,{searchTerm:m,searchTrigger:S},zn.default.createElement(x0e,{key:pi+"-dopeSheet-"+m+"-"+S,layoutP:wi})),hu&&zn.default.createElement(Pae,{key:pi+"-graphEditor",layoutP:wi}),lh&&zn.default.createElement(fue,{layoutP:wi}),x0&&zn.default.createElement(lue,{layoutP:wi})),zn.default.createElement(_he,{ref:K,onConfirm:ze,onCancel:Ft}),zn.default.createElement(Qhe,{ref:Q,onConfirm:nt,onCancel:Ee}),k&&zn.default.createElement(ude,{onLoad:Se,onCancel:ft}),z&&zn.default.createElement(zde,{onAttach:ke,onCancel:be}))},[o,l,m,S,k,z])},lfe=({layoutP:o})=>ri(()=>{let l=(0,Bs.val)(o.sheet);return l.getSequence(),zn.default.createElement(ife,{style:{width:(0,Bs.val)(o.leftDims.width)}},zn.default.createElement(BC,{style:{borderRight:"1px solid #222"}},zn.default.createElement(hfe,{style:{borderBottom:"1px solid #222"}},zn.default.createElement(cL,{style:{color:"white",fontSize:"14px",fontWeight:"bold"}},l.address.sheetId)),zn.default.createElement(pfe,null,zn.default.createElement(ufe,null,zn.default.createElement(xfe,{layoutP:o}),zn.default.createElement(UC,null,"/"),zn.default.createElement(bfe,{layoutP:o}),zn.default.createElement(UC,null,"-"),zn.default.createElement(wfe,{layoutP:o}),zn.default.createElement(UC,null,":"),zn.default.createElement(Sfe,{layoutP:o}),zn.default.createElement(cL,{style:{fontSize:"9px",opacity:.7}},"fps")))))},[o]),ufe=ge.div(cfe||(cfe=X([`
  display: flex;
  align-items: center;
  gap: 4px;
  height: 30px;
`]))),hfe=ge.div(dfe||(dfe=X([`
  display: flex;
  align-items: center;
  height: 30px;
  padding: 0 8px;
`]))),pfe=ge.div(ffe||(ffe=X([`
  display: flex;
  align-items: center;
  height: 30px;
  padding: 0 8px;
`]))),ZS=ge(i7)(mfe||(mfe=X([`
  flex: 1;
  min-width: 0;
  height: 20px;
  font-size: 12px;
  padding: 0;
  background: rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: #adadadb3;
  border-radius: 2px;

  &:hover {
    background: rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.15);
  }

  &:focus {
    background: rgba(0, 0, 0, 0.4);
    border-color: rgba(255, 255, 255, 0.2);
    color: white;
  }
`]))),vfe=ge(ZS)(gfe||(gfe=X([`
  width: 40px;
`]))),_fe=ge(ZS)(yfe||(yfe=X([`
  width: 40px;
`]))),xfe=({layoutP:o})=>ri(()=>{let l=(0,Bs.val)(o.sheet).getSequence(),u=Number((0,Bs.val)(l.pointer.position).toFixed(3)),m,_=l.position;return zn.default.createElement(ZS,B(R({value:u},{temporarilySetValue(S){m!==void 0&&(m=void 0),m=Zi(S,0,l.length),l.position=m},discardTemporaryValue(){m!==void 0&&(m=void 0,l.position=_)},permanentlySetValue(S){m!==void 0&&(m=void 0),l.position=Zi(S,0,l.length)}}),{isValid:S=>isFinite(S)&&S>=0,nudge:({deltaX:S})=>S*.01}))},[o]),bfe=({layoutP:o})=>ri(()=>{let l=(0,Bs.val)(o.sheet),u=l.getSequence().length,m;return zn.default.createElement(ZS,B(R({value:u},{temporarilySetValue(_){m&&(m.discard(),m=void 0),m=ce().tempTransaction(({stateEditors:S})=>{S.coreByProject.historic.sheetsById.sequence.setLength(B(R({},l.address),{length:_}))})},discardTemporaryValue(){m&&(m.discard(),m=void 0)},permanentlySetValue(_){m&&(m.discard(),m=void 0),ce().transaction(({stateEditors:S})=>{S.coreByProject.historic.sheetsById.sequence.setLength(B(R({},l.address),{length:_}))})}}),{isValid:_=>isFinite(_)&&_>0,nudge:({deltaX:_})=>_*.1}))},[o]),Sfe=({layoutP:o})=>ri(()=>{let l=(0,Bs.val)(o.sheet),u=l.getSequence().subUnitsPerUnit,m;return zn.default.createElement(_fe,B(R({value:u},{temporarilySetValue(_){m&&(m.discard(),m=void 0),m=ce().tempTransaction(({stateEditors:S})=>{S.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit(B(R({},l.address),{subUnitsPerUnit:_}))})},discardTemporaryValue(){m&&(m.discard(),m=void 0)},permanentlySetValue(_){m&&(m.discard(),m=void 0),ce().transaction(({stateEditors:S})=>{S.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit(B(R({},l.address),{subUnitsPerUnit:_}))})}}),{isValid:_=>isFinite(_)&&_>=1&&_<=F(2,12),nudge:({deltaX:_})=>_*1}))},[o]),wfe=({layoutP:o})=>ri(()=>{let l=(0,Bs.val)(o.sheet).getSequence(),u=l.subUnitsPerUnit,m=(0,Bs.val)(l.pointer.position),_=Math.round(m*u),S,M=l.position;return zn.default.createElement(vfe,B(R({value:_},{temporarilySetValue(P){S!==void 0&&(S=void 0),S=P;let k=Zi(P/u,0,l.length);l.position=k},discardTemporaryValue(){S!==void 0&&(S=void 0,l.position=M)},permanentlySetValue(P){S!==void 0&&(S=void 0);let k=Zi(P/u,0,l.length);l.position=k}}),{isValid:P=>isFinite(P)&&P>=0,nudge:({deltaX:P})=>P*1}))},[o]),Tfe=ofe,Efe=()=>{let o=null,l={passive:!1,capture:!1},u=m=>{Math.abs(m.deltaY)<Math.abs(m.deltaX)&&(m.preventDefault(),m.stopPropagation())};return m=>{o!==m&&o&&o.removeEventListener("wheel",u,l),o=m,m&&m.addEventListener("wheel",u,l)}}}),P7,Mfe,Cfe,ACe=A(()=>{GSe(),P7=G(et()),Ie(),Sr(),Dwe(),M1(),Mfe=()=>{let o=qr(ce().paneManager.allPanesD),l=Object.entries(o).map(([u,m])=>P7.default.createElement(xQ,{key:"pane-".concat(u),paneInstance:m}));return P7.default.createElement(P7.default.Fragment,null,l,P7.default.createElement(KK,null),P7.default.createElement(Tfe,null))},Cfe=Mfe}),Afe,Pfe,UP,PB=A(()=>{Jt(),bf(),Pfe=ge(ou)(Afe||(Afe=X([`
  padding: 1em;
  max-width: 240px;
  pointer-events: none !important;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: #45464d;
`]))),UP=Pfe}),Rfe,Ife,Nfe,PCe=A(()=>{Jt(),PB(),Ife=ge(UP)(Rfe||(Rfe=X([`
  --popover-outer-stroke: #e11c1c;
  --popover-inner-stroke: #2c1c1c;
  --popover-bg: #2c1c1c;
  pointer-events: none !important;
`]))),Nfe=Ife}),RCe=ne((o,l)=>{var u,m;u=[],m=[];function _(S,M,P){var k,L,z,$,H,j,K,Q;if(S===M)return 0;if(k=S.length,L=M.length,k===0)return L;if(L===0)return k;for(P&&(S=S.toLowerCase(),M=M.toLowerCase()),K=0;K<k;)m[K]=S.charCodeAt(K),u[K]=++K;for(Q=0;Q<L;)for(z=M.charCodeAt(Q),$=H=Q++,K=-1;++K<k;)j=z===m[K]?H:H+1,H=u[K],u[K]=$=H>$?j>$?$+1:j:j>H?H+1:j;return $}l.exports=_}),ICe=ne((o,l)=>{var u=RCe();function m(){var _,S,M,P,k,L=0,z=arguments[0],$=arguments[1],H=$.length,j=arguments[2];j&&(P=j.threshold,k=j.ignoreCase),P===void 0&&(P=0);for(var K=0;K<H;++K)k?S=u(z,$[K],!0):S=u(z,$[K]),S>z.length?_=1-S/$[K].length:_=1-S/z.length,_>L&&(L=_,M=$[K]);return L>=P?M:null}l.exports=m});function NCe(o,l,u="Did you mean ",m="?"){let _=(0,kfe.default)(o,l,{threshold:.7});return _?u+JSON.stringify(_)+m:""}var kfe,kCe=A(()=>{kfe=G(ICe())});function Dfe(o,l){return o.length<=l?o:o.substr(0,l-3)+"..."}var DCe=A(()=>{}),Ofe,RB,Lfe=A(()=>{DCe(),Ofe=o=>typeof o=="string"?'string("'.concat(Dfe(o,10),'")'):typeof o=="number"?"number(".concat(Dfe(String(o),10),")"):o===null?"null":o===void 0?"undefined":typeof o=="boolean"?String(o):Array.isArray(o)?"array":typeof o=="object"?"object":"unknown",RB=Ofe}),Ffe,Ufe,IB,Bfe=A(()=>{Jt(),PB(),Ufe=ge(UP)(Ffe||(Ffe=X([`
  padding: 6px;
`]))),IB=Ufe}),zfe,Vfe,NB,Gfe=A(()=>{Jt(),Mv(),Vfe=ge($Y)(zfe||(zfe=X([`
  display: flex;
  height: fit-content;
  backdrop-filter: blur(14px);
  border-radius: 2px;
`]))),NB=Vfe}),R7,jfe,Hfe,Wfe,QS,BP=A(()=>{Jt(),os(),R7=G(et()),qA(),eA(),Bfe(),Gfe(),Hfe=ge.button(jfe||(jfe=X([`
  `,`;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  width: 32px;
  height: 32px;
  outline: none;

  color: #a8a8a9;

  background: rgba(40, 43, 47, 0.8);
  backdrop-filter: blur(14px);
  border: none;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 2px;

  svg {
    display: block;
  }

  &:hover {
    background: rgba(59, 63, 69, 0.8);
  }

  &:active {
    background: rgba(82, 88, 96, 0.8);
  }

  &.selected {
    color: rgba(255, 255, 255, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.7);
  }

  // Don't blur if in a button group, because it already blurs. We need to blur
  // on the group-level, otherwise we get seams.
  `,` > & {
    backdrop-filter: none;
    filter: none;
    border-radius: 0;

    &:first-child {
      border-top-left-radius: 2px;
      border-bottom-left-radius: 2px;
    }

    &:last-child {
      border-bottom-right-radius: 2px;
      border-top-right-radius: 2px;
    }
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Wi,NB),Wfe=R7.default.forwardRef((o,l)=>{var u=o,{title:m}=u,_=Y(u,["title"]);let[S,M]=HA({enabled:typeof m=="string"},()=>R7.default.createElement(IB,null,m));return R7.default.createElement(R7.default.Fragment,null,S,R7.default.createElement(Hfe,R({ref:JC([M,l])},_))," ")}),QS=Wfe}),qfe,$fe,Xfe,Yfe,Kfe,OCe=A(()=>{qfe=G(et()),BP(),Jt(),os(),Xfe=ge(QS)($fe||($fe=X([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Wi),Yfe=({config:o,testId:l})=>{var u;return qfe.default.createElement(Xfe,{onClick:o.onClick,"data-testid":l,title:o.title,dangerouslySetInnerHTML:{__html:(u=o.svgSource)!=null?u:""}})},Kfe=Yfe});function LCe({value:o,label:l,icon:u,onClick:m,isSelected:_}){return I7.default.createElement(I7.default.Fragment,null,I7.default.createElement(QS,{forwardedAs:HY,className:_?"selected":void 0,"aria-label":l,onClick:m,title:l},u))}var I7,Zfe,Qfe,FCe=A(()=>{I7=G(et()),Mv(),BP(),Gfe(),Zfe=({value:o,onChange:l,options:u})=>I7.default.createElement(NB,null,u.map(({label:m,icon:_,value:S})=>I7.default.createElement(LCe,{key:S,value:S,isSelected:o===S,label:m,icon:_,onClick:()=>l(S)}))),Qfe=Zfe}),kB,Jfe,epe,tpe,npe,UCe=A(()=>{kB=G(et()),Jt(),os(),FCe(),epe=ge.div(Jfe||(Jfe=X([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Wi),tpe=({config:o})=>kB.default.createElement(Qfe,{onChange:o.onChange,options:o.options.map(({label:l,value:u,svgSource:m})=>({label:l,value:u,icon:kB.default.createElement(epe,{dangerouslySetInnerHTML:{__html:m}})})),value:o.value}),npe=tpe}),JS,rpe,ipe,spe,ope,BCe=A(()=>{JS=G(et()),Jt(),os(),BP(),YQ(),xf(),ipe=ge.div(rpe||(rpe=X([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Wi),spe=({config:o})=>{let l=(0,JS.useRef)(null),u=su(()=>{let m=l.current.getBoundingClientRect();return{debugName:"ExtensionFlyoutMenu:"+o.label,constraints:{maxX:m.right,maxY:8,minX:m.left,minY:8},verticalGap:2}},()=>JS.default.createElement(ZL,{items:o.items.map((m,_)=>({label:m.label,callback:()=>{var S;try{(S=m.onClick)==null||S.call(m)}catch(M){console.error(M)}}})),onRequestClose:()=>{u.close("clicked")}}));return JS.default.createElement(ipe,null,u.node,JS.default.createElement(QS,{ref:l,onClick:m=>{u.open(m,l.current)}},o.label))},ope=spe});function zCe(o){return DB[o]}var ew,ape,DB,lpe,cpe,VCe=A(()=>{kCe(),Lfe(),ew=G(et()),OCe(),UCe(),BCe(),ape=o=>ew.default.createElement(ew.default.Fragment,null,o.config.map((l,u)=>ew.default.createElement(lpe,{config:l,key:u}))),DB={Icon:Kfe,Switch:npe,Flyout:ope},lpe=({config:o})=>{let l=zCe(o.type);if(!l)throw new Error("No tool with tool.type ".concat(RB(o.type)," exists. Did you mean ").concat(NCe(o.type,Object.keys(DB))));return ew.default.createElement(l,{config:o})},cpe=ape}),upe,C1,dpe,hpe,fpe,OB,ppe,mpe,LB,gpe=A(()=>{upe=an(),Sr(),Ie(),C1=G(et()),Jt(),VCe(),hpe=ge.div(dpe||(dpe=X([`
  height: 36px;
  /* pointer-events: none; */

  display: flex;
  gap: 0.5rem;
  justify-content: center;
`]))),OB=ge.div(fpe||(fpe=X([`
  position: abolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),ppe=({extension:o,toolbarId:l})=>{var u;let m=(0,C1.useMemo)(()=>new upe.Atom([]),[]),_=(u=o.toolbars)==null?void 0:u[l];(0,C1.useLayoutEffect)(()=>{let M=_==null?void 0:_(m.set.bind(m),ce().publicApi);if(typeof M=="function")return M},[o,l,_]);let S=qr(m.prism);return C1.default.createElement(cpe,{config:S})},mpe=({toolbarId:o,showLeftDivider:l})=>{var u;let m=[],_=qr(ce().atomP.ephemeral.extensions.byId),S=!1;for(let[,M]of Object.entries(_))!M||!((u=M.toolbars)!=null&&u[o])||(m.push(C1.default.createElement(C1.default.Fragment,{key:"extensionToolbar-"+M.id},S?C1.default.createElement(OB,null):void 0,C1.default.createElement(ppe,{extension:M,toolbarId:o}))),S=!0);return m.length===0?null:C1.default.createElement(hpe,{"data-testid":"theatre-extensionToolbar-".concat(o)},l?C1.default.createElement(OB,null):void 0,m)},LB=mpe}),tw,vpe,ype,_pe,xpe,GCe=A(()=>{Jt(),tw=G(et()),BP(),ype=ge(QS)(vpe||(vpe=X([`
  color: `,`;

  border-bottom: 1px solid
    `,`;
`])),({pinned:o})=>o?"rgba(255, 255, 255, 0.8)":"#A8A8A9",({pinned:o})=>o?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.08)"),_pe=(0,tw.forwardRef)((o,l)=>{var u=o,{children:m,hint:_,pinned:S,icon:M,pinHintIcon:P,unpinHintIcon:k}=u,L=Y(u,["children","hint","pinned","icon","pinHintIcon","unpinHintIcon"]);let[z,$]=(0,tw.useState)(!1),H=z||_;return tw.default.createElement(ype,B(R({},L),{pinned:S,ref:l,onMouseOver:()=>$(!0),onMouseOut:()=>$(!1)}),tw.default.createElement("div",{style:{pointerEvents:"none",width:"fit-content",height:"fit-content",inset:0}},H&&!S?P:H&&S?k:M),m)}),xpe=_pe});function jCe(o){return FB.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),FB.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.732 4.048l-.792-.792L7.2 8l4.74 4.744.792-.792L8.781 8l3.951-3.952zm-3.932 0l-.792-.792L3.268 8l4.74 4.744.792-.792L4.848 8 8.8 4.048z",fill:"currentColor"}))}var FB,bpe,HCe=A(()=>{FB=G(et()),bpe=jCe});function WCe(o){return UB.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),UB.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.694 3.765l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.951-3.951-3.951-3.952zm3.932 0l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.952-3.951-3.952-3.952z",fill:"currentColor"}))}var UB,Spe,qCe=A(()=>{UB=G(et()),Spe=WCe}),ka,wpe,Tpe,Epe,BB,Mpe,x9,Cpe,Ape,Ppe,Rpe,Ipe,Npe,kpe,Dpe,Ope,zP,Lpe,Fpe,zB,VB,Upe,Bpe,$Ce=A(()=>{Sr(),Ie(),ka=G(et()),Jt(),Tpe=ge.div(wpe||(wpe=X([`
  width: 138px;
  border-radius: 2px;
  background-color: rgba(42, 45, 50, 0.9);
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.25), 0px 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  pointer-events: auto;
  // makes the edges of the item highlights match the rounded corners
  overflow: hidden;

  @supports not (backdrop-filter: blur()) {
    background-color: rgba(42, 45, 50, 0.98);
  }

  color: rgba(255, 255, 255, 0.9);

  & a {
    // Fix colors of links to not be default
    color: inherit;
  }
`]))),BB=ge.div(Epe||(Epe=X([`
  position: relative;
  padding: 0px 12px;
  font-weight: 400;
  font-size: 11px;
  height: 32px;
  text-decoration: none;
  user-select: none;
  display: flex;
  flex-direction: row;
  align-items: center;
  cursor: default;
`]))),x9=ge(BB)(Mpe||(Mpe=X([`
  &:before {
    position: absolute;
    display: block;
    content: ' ';
    inset: 3px;
    border-radius: 3px;
    background: rgba(255, 255, 255, 0.1);
    opacity: 0;
  }

  &.secondary {
    color: rgba(255, 255, 255, 0.5);
  }

  &:hover {
    /* background-color: #398995; */
    color: white !important;
    &:before {
      opacity: 1;
    }
  }
`]))),Ape=ge(BB)(Cpe||(Cpe=X([`
  height: auto;
  min-height: 32px;
  padding-top: 12px;
  padding-bottom: 10px;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  gap: 8px;
  color: rgba(255, 255, 255, 0.5);
`]))),Rpe=ge.div(Ppe||(Ppe=X([`
  font-weight: 600;
`]))),Npe=ge.div(Ipe||(Ipe=X([`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`]))),Dpe=ge.div(kpe||(kpe=X([`
  margin-left: 2px;
`]))),zP=ge.div(Ope||(Ope=X([`
  height: 1px;
  margin: 0 2px;
  background: rgba(255, 255, 255, 0.02);
`]))),Fpe=ge.div(Lpe||(Lpe=X([`
  position: absolute;
  width: 8px;
  height: 8px;
  background: #40aaa4;
  right: 14px;
  top: 12px;
  border-radius: 50%;
`]))),zB="1.0.19",VB=zB.match(/^[^\-]+/)[0],Upe=ka.default.forwardRef((o,l)=>{let u=qr(ce().atomP.ahistoric.updateChecker.result.hasUpdates);return ka.default.createElement(Tpe,{ref:l},ka.default.createElement(x9,{as:"a",href:"https://www.theatrejs.com/docs/latest",className:"",target:"_blank"},"Docs"),ka.default.createElement(x9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases",className:"",target:"_blank"},"Changelog"),ka.default.createElement(zP,null),ka.default.createElement(x9,{as:"a",href:"https://github.com/theatre-js/theatre",className:"",target:"_blank"},"Github"),ka.default.createElement(x9,{as:"a",href:"https://twitter.com/theatre_js",className:"",target:"_blank"},"Twitter"),ka.default.createElement(x9,{className:"",as:"a",href:"https://discord.gg/bm9f8F9Y9N",target:"_blank"},"Discord"),ka.default.createElement(zP,null),ka.default.createElement(Ape,null,ka.default.createElement(Rpe,null,"Version"),ka.default.createElement(Npe,null,ka.default.createElement(Dpe,null,zB," ",u===!0?"(outdated)":u===!1?"(latest)":""))),u===!0&&ka.default.createElement(ka.default.Fragment,null,ka.default.createElement(zP,null),ka.default.createElement(x9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases".concat(encodeURIComponent(VB)),className:"",target:"_blank"},"Update",ka.default.createElement(Fpe,null)),ka.default.createElement(x9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases#".concat(encodeURIComponent(VB)),className:"",target:"_blank"},"What's new?")))}),Bpe=Upe}),GB,VP,zpe,jB,Vpe,Gpe,nw,jpe,HB,Hpe,GP,rw,iw,b9,Wpe,qpe,$pe,N7,du,Xpe,Ype,Kpe,WB,XCe=A(()=>{GB=G(et(),1),VP=G(et(),1),zpe=o=>typeof o=="function",jB=(o,l)=>zpe(o)?o(l):o,Vpe=(()=>{let o=0;return()=>(++o).toString()})(),Gpe=20,nw=new Map,jpe=1e3,HB=o=>{if(nw.has(o))return;let l=setTimeout(()=>{nw.delete(o),b9({type:4,toastId:o})},jpe);nw.set(o,l)},Hpe=o=>{let l=nw.get(o);l&&clearTimeout(l)},GP=(o,l)=>{switch(l.type){case 0:return B(R({},o),{toasts:[l.toast,...o.toasts].slice(0,Gpe)});case 1:return l.toast.id&&Hpe(l.toast.id),B(R({},o),{toasts:o.toasts.map(S=>S.id===l.toast.id?R(R({},S),l.toast):S)});case 2:let{toast:u}=l;return o.toasts.find(S=>S.id===u.id)?GP(o,{type:1,toast:u}):GP(o,{type:0,toast:u});case 3:let{toastId:m}=l;return m?HB(m):o.toasts.forEach(S=>{HB(S.id)}),B(R({},o),{toasts:o.toasts.map(S=>S.id===m||m===void 0?B(R({},S),{visible:!1}):S)});case 4:return l.toastId===void 0?B(R({},o),{toasts:[]}):B(R({},o),{toasts:o.toasts.filter(S=>S.id!==l.toastId)});case 5:return B(R({},o),{pausedAt:l.time});case 6:let _=l.time-(o.pausedAt||0);return B(R({},o),{pausedAt:void 0,toasts:o.toasts.map(S=>B(R({},S),{pauseDuration:S.pauseDuration+_}))})}},rw=[],iw={toasts:[],pausedAt:void 0},b9=o=>{iw=GP(iw,o),rw.forEach(l=>{l(iw)})},Wpe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},qpe=(o={})=>{let[l,u]=(0,GB.useState)(iw);(0,GB.useEffect)(()=>(rw.push(u),()=>{let _=rw.indexOf(u);_>-1&&rw.splice(_,1)}),[l]);let m=l.toasts.map(_=>{var S,M;return B(R(R(R({},o),o[_.type]),_),{duration:_.duration||((S=o[_.type])==null?void 0:S.duration)||(o==null?void 0:o.duration)||Wpe[_.type],style:R(R(R({},o.style),(M=o[_.type])==null?void 0:M.style),_.style)})});return B(R({},l),{toasts:m})},$pe=(o,l="blank",u)=>B(R({createdAt:Date.now(),visible:!0,type:l,ariaProps:{role:"status","aria-live":"polite"},message:o,pauseDuration:0},u),{id:(u==null?void 0:u.id)||Vpe()}),N7=o=>(l,u)=>{let m=$pe(l,o,u);return b9({type:2,toast:m}),m.id},du=(o,l)=>N7("blank")(o,l),du.error=N7("error"),du.success=N7("success"),du.loading=N7("loading"),du.custom=N7("custom"),du.dismiss=o=>{b9({type:3,toastId:o})},du.remove=o=>b9({type:4,toastId:o}),du.promise=(o,l,u)=>{let m=du.loading(l.loading,R(R({},u),u==null?void 0:u.loading));return o.then(_=>(du.success(jB(l.success,_),R(R({id:m},u),u==null?void 0:u.success)),_)).catch(_=>{du.error(jB(l.error,_),R(R({id:m},u),u==null?void 0:u.error))}),o},Xpe=(o,l)=>{b9({type:1,toast:{id:o,height:l}})},Ype=()=>{b9({type:5,time:Date.now()})},Kpe=o=>{let{toasts:l,pausedAt:u}=qpe(o);(0,VP.useEffect)(()=>{if(u)return;let S=Date.now(),M=l.map(P=>{if(P.duration===1/0)return;let k=(P.duration||0)+P.pauseDuration-(S-P.createdAt);if(k<0){P.visible&&du.dismiss(P.id);return}return setTimeout(()=>du.dismiss(P.id),k)});return()=>{M.forEach(P=>P&&clearTimeout(P))}},[l,u]);let m=(0,VP.useCallback)(()=>{u&&b9({type:6,time:Date.now()})},[u]),_=(0,VP.useCallback)((S,M)=>{let{reverseOrder:P=!1,gutter:k=8,defaultPosition:L}=M||{},z=l.filter(j=>(j.position||L)===(S.position||L)&&j.height),$=z.findIndex(j=>j.id===S.id),H=z.filter((j,K)=>K<$&&j.visible).length;return z.filter(j=>j.visible).slice(...P?[H+1]:[0,H]).reduce((j,K)=>j+(K.height||0)+k,0)},[l]);return{toasts:l,handlers:{updateHeight:Xpe,startPause:Ype,endPause:m,calculateOffset:_}}},WB=du});function Zpe(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function YCe(o){n8=o}function y0(o,l){if(l){if(s1e.test(o))return o.replace(o1e,qB)}else if(a1e.test(o))return o.replace(l1e,qB);return o}function Qpe(o){return o.replace(u1e,(l,u)=>(u=u.toLowerCase(),u==="colon"?":":u.charAt(0)==="#"?u.charAt(1)==="x"?String.fromCharCode(parseInt(u.substring(2),16)):String.fromCharCode(+u.substring(1)):""))}function Hs(o,l){o=typeof o=="string"?o:o.source,l=l||"";let u={replace:(m,_)=>(_=_.source||_,_=_.replace(d1e,"$1"),o=o.replace(m,_),u),getRegex:()=>new RegExp(o,l)};return u}function Jpe(o,l,u){if(o){let m;try{m=decodeURIComponent(Qpe(u)).replace(h1e,"").toLowerCase()}catch{return null}if(m.indexOf("javascript:")===0||m.indexOf("vbscript:")===0||m.indexOf("data:")===0)return null}l&&!f1e.test(u)&&(u=KCe(l,u));try{u=encodeURI(u).replace(/%25/g,"%")}catch{return null}return u}function KCe(o,l){sw[" "+o]||(p1e.test(o)?sw[" "+o]=o+"/":sw[" "+o]=jP(o,"/",!0)),o=sw[" "+o];let u=o.indexOf(":")===-1;return l.substring(0,2)==="//"?u?l:o.replace(m1e,"$1")+l:l.charAt(0)==="/"?u?l:o.replace(g1e,"$1")+l:o+l}function If(o){let l=1,u,m;for(;l<arguments.length;l++){u=arguments[l];for(m in u)Object.prototype.hasOwnProperty.call(u,m)&&(o[m]=u[m])}return o}function e1e(o,l){let u=o.replace(/\|/g,(S,M,P)=>{let k=!1,L=M;for(;--L>=0&&P[L]==="\\";)k=!k;return k?"|":" |"}),m=u.split(/ \|/),_=0;if(m[0].trim()||m.shift(),m.length>0&&!m[m.length-1].trim()&&m.pop(),m.length>l)m.splice(l);else for(;m.length<l;)m.push("");for(;_<m.length;_++)m[_]=m[_].trim().replace(/\\\|/g,"|");return m}function jP(o,l,u){let m=o.length;if(m===0)return"";let _=0;for(;_<m;){let S=o.charAt(m-_-1);if(S===l&&!u)_++;else if(S!==l&&u)_++;else break}return o.slice(0,m-_)}function ZCe(o,l){if(o.indexOf(l[1])===-1)return-1;let u=o.length,m=0,_=0;for(;_<u;_++)if(o[_]==="\\")_++;else if(o[_]===l[0])m++;else if(o[_]===l[1]&&(m--,m<0))return _;return-1}function t1e(o){o&&o.sanitize&&!o.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function n1e(o,l){if(l<1)return"";let u="";for(;l>1;)l&1&&(u+=o),l>>=1,o+=o;return u+o}function r1e(o,l,u,m){let _=l.href,S=l.title?y0(l.title):null,M=o[1].replace(/\\([\[\]])/g,"$1");if(o[0].charAt(0)!=="!"){m.state.inLink=!0;let P={type:"link",raw:u,href:_,title:S,text:M,tokens:m.inlineTokens(M)};return m.state.inLink=!1,P}return{type:"image",raw:u,href:_,title:S,text:y0(M)}}function QCe(o,l){let u=o.match(/^(\s+)(?:```)/);if(u===null)return l;let m=u[1];return l.split(`
`).map(_=>{let S=_.match(/^\s+/);if(S===null)return _;let[M]=S;return M.length>=m.length?_.slice(m.length):_}).join(`
`)}function JCe(o){return o.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function i1e(o){let l="",u,m,_=o.length;for(u=0;u<_;u++)m=o.charCodeAt(u),Math.random()>.5&&(m="x"+m.toString(16)),l+="&#"+m+";";return l}function $r(o,l,u){if(typeof o>"u"||o===null)throw new Error("marked(): input parameter is undefined or null");if(typeof o!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(o)+", string expected");if(typeof l=="function"&&(u=l,l=null),l=If({},$r.defaults,l||{}),t1e(l),u){let _=l.highlight,S;try{S=r8.lex(o,l)}catch(k){return u(k)}let M=function(k){let L;if(!k)try{l.walkTokens&&$r.walkTokens(S,l.walkTokens),L=S9.parse(S,l)}catch(z){k=z}return l.highlight=_,k?u(k):u(null,L)};if(!_||_.length<3||(delete l.highlight,!S.length))return M();let P=0;$r.walkTokens(S,function(k){k.type==="code"&&(P++,setTimeout(()=>{_(k.text,k.lang,function(L,z){if(L)return M(L);z!=null&&z!==k.text&&(k.text=z,k.escaped=!0),P--,P===0&&M()})},0))}),P===0&&M();return}function m(_){if(_.message+=`
Please report this to https://github.com/markedjs/marked.`,l.silent)return"<p>An error occurred:</p><pre>"+y0(_.message+"",!0)+"</pre>";throw _}try{let _=r8.lex(o,l);if(l.walkTokens){if(l.async)return Promise.all($r.walkTokens(_,l.walkTokens)).then(()=>S9.parse(_,l)).catch(m);$r.walkTokens(_,l.walkTokens)}return S9.parse(_,l)}catch(_){m(_)}}var n8,s1e,o1e,a1e,l1e,c1e,qB,u1e,d1e,h1e,f1e,sw,p1e,m1e,g1e,ow,HP,kr,or,r8,WP,$B,XB,S9,eAe=A(()=>{n8=Zpe(),s1e=/[&<>"']/,o1e=/[&<>"']/g,a1e=/[<>"']|&(?!#?\w+;)/,l1e=/[<>"']|&(?!#?\w+;)/g,c1e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qB=o=>c1e[o],u1e=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,d1e=/(^|[^\[])\^/g,h1e=/[^\w:]/g,f1e=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,sw={},p1e=/^[^:]+:\/*[^/]*$/,m1e=/^([^:]+:)[\s\S]*$/,g1e=/^([^:]+:\/*[^/]*)[\s\S]*$/,ow={exec:function(){}},HP=class{constructor(o){this.options=o||n8}space(o){let l=this.rules.block.newline.exec(o);if(l&&l[0].length>0)return{type:"space",raw:l[0]}}code(o){let l=this.rules.block.code.exec(o);if(l){let u=l[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:l[0],codeBlockStyle:"indented",text:this.options.pedantic?u:jP(u,`
`)}}}fences(o){let l=this.rules.block.fences.exec(o);if(l){let u=l[0],m=QCe(u,l[3]||"");return{type:"code",raw:u,lang:l[2]?l[2].trim():l[2],text:m}}}heading(o){let l=this.rules.block.heading.exec(o);if(l){let u=l[2].trim();if(/#$/.test(u)){let m=jP(u,"#");(this.options.pedantic||!m||/ $/.test(m))&&(u=m.trim())}return{type:"heading",raw:l[0],depth:l[1].length,text:u,tokens:this.lexer.inline(u)}}}hr(o){let l=this.rules.block.hr.exec(o);if(l)return{type:"hr",raw:l[0]}}blockquote(o){let l=this.rules.block.blockquote.exec(o);if(l){let u=l[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:l[0],tokens:this.lexer.blockTokens(u,[]),text:u}}}list(o){let l=this.rules.block.list.exec(o);if(l){let u,m,_,S,M,P,k,L,z,$,H,j,K=l[1].trim(),Q=K.length>1,re={type:"list",raw:"",ordered:Q,start:Q?+K.slice(0,-1):"",loose:!1,items:[]};K=Q?"\\d{1,9}\\".concat(K.slice(-1)):"\\".concat(K),this.options.pedantic&&(K=Q?K:"[*+-]");let ae=new RegExp("^( {0,3}".concat(K,")((?:[	 ][^\\n]*)?(?:\\n|$))"));for(;o&&(j=!1,!(!(l=ae.exec(o))||this.rules.block.hr.test(o)));){if(u=l[0],o=o.substring(u.length),L=l[2].split(`
`,1)[0],z=o.split(`
`,1)[0],this.options.pedantic?(S=2,H=L.trimLeft()):(S=l[2].search(/[^ ]/),S=S>4?1:S,H=L.slice(S),S+=l[1].length),P=!1,!L&&/^ *$/.test(z)&&(u+=z+`
`,o=o.substring(z.length+1),j=!0),!j){let ye=new RegExp("^ {0,".concat(Math.min(3,S-1),"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))")),Ae=new RegExp("^ {0,".concat(Math.min(3,S-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),Ce=new RegExp("^ {0,".concat(Math.min(3,S-1),"}(?:```|~~~)")),Se=new RegExp("^ {0,".concat(Math.min(3,S-1),"}#"));for(;o&&($=o.split(`
`,1)[0],L=$,this.options.pedantic&&(L=L.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(Ce.test(L)||Se.test(L)||ye.test(L)||Ae.test(o)));){if(L.search(/[^ ]/)>=S||!L.trim())H+=`
`+L.slice(S);else if(!P)H+=`
`+L;else break;!P&&!L.trim()&&(P=!0),u+=$+`
`,o=o.substring($.length+1)}}re.loose||(k?re.loose=!0:/\n *\n *$/.test(u)&&(k=!0)),this.options.gfm&&(m=/^\[[ xX]\] /.exec(H),m&&(_=m[0]!=="[ ] ",H=H.replace(/^\[[ xX]\] +/,""))),re.items.push({type:"list_item",raw:u,task:!!m,checked:_,loose:!1,text:H}),re.raw+=u}re.items[re.items.length-1].raw=u.trimRight(),re.items[re.items.length-1].text=H.trimRight(),re.raw=re.raw.trimRight();let ue=re.items.length;for(M=0;M<ue;M++){this.lexer.state.top=!1,re.items[M].tokens=this.lexer.blockTokens(re.items[M].text,[]);let ye=re.items[M].tokens.filter(Ce=>Ce.type==="space"),Ae=ye.every(Ce=>{let Se=Ce.raw.split(""),ft=0;for(let ke of Se)if(ke===`
`&&(ft+=1),ft>1)return!0;return!1});!re.loose&&ye.length&&Ae&&(re.loose=!0,re.items[M].loose=!0)}return re}}html(o){let l=this.rules.block.html.exec(o);if(l){let u={type:"html",raw:l[0],pre:!this.options.sanitizer&&(l[1]==="pre"||l[1]==="script"||l[1]==="style"),text:l[0]};if(this.options.sanitize){let m=this.options.sanitizer?this.options.sanitizer(l[0]):y0(l[0]);u.type="paragraph",u.text=m,u.tokens=this.lexer.inline(m)}return u}}def(o){let l=this.rules.block.def.exec(o);if(l)return l[3]&&(l[3]=l[3].substring(1,l[3].length-1)),{type:"def",tag:l[1].toLowerCase().replace(/\s+/g," "),raw:l[0],href:l[2],title:l[3]}}table(o){let l=this.rules.block.table.exec(o);if(l){let u={type:"table",header:e1e(l[1]).map(m=>({text:m})),align:l[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:l[3]&&l[3].trim()?l[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(u.header.length===u.align.length){u.raw=l[0];let m=u.align.length,_,S,M,P;for(_=0;_<m;_++)/^ *-+: *$/.test(u.align[_])?u.align[_]="right":/^ *:-+: *$/.test(u.align[_])?u.align[_]="center":/^ *:-+ *$/.test(u.align[_])?u.align[_]="left":u.align[_]=null;for(m=u.rows.length,_=0;_<m;_++)u.rows[_]=e1e(u.rows[_],u.header.length).map(k=>({text:k}));for(m=u.header.length,S=0;S<m;S++)u.header[S].tokens=this.lexer.inline(u.header[S].text);for(m=u.rows.length,S=0;S<m;S++)for(P=u.rows[S],M=0;M<P.length;M++)P[M].tokens=this.lexer.inline(P[M].text);return u}}}lheading(o){let l=this.rules.block.lheading.exec(o);if(l)return{type:"heading",raw:l[0],depth:l[2].charAt(0)==="="?1:2,text:l[1],tokens:this.lexer.inline(l[1])}}paragraph(o){let l=this.rules.block.paragraph.exec(o);if(l){let u=l[1].charAt(l[1].length-1)===`
`?l[1].slice(0,-1):l[1];return{type:"paragraph",raw:l[0],text:u,tokens:this.lexer.inline(u)}}}text(o){let l=this.rules.block.text.exec(o);if(l)return{type:"text",raw:l[0],text:l[0],tokens:this.lexer.inline(l[0])}}escape(o){let l=this.rules.inline.escape.exec(o);if(l)return{type:"escape",raw:l[0],text:y0(l[1])}}tag(o){let l=this.rules.inline.tag.exec(o);if(l)return!this.lexer.state.inLink&&/^<a /i.test(l[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(l[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(l[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(l[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:l[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(l[0]):y0(l[0]):l[0]}}link(o){let l=this.rules.inline.link.exec(o);if(l){let u=l[2].trim();if(!this.options.pedantic&&/^</.test(u)){if(!/>$/.test(u))return;let S=jP(u.slice(0,-1),"\\");if((u.length-S.length)%2===0)return}else{let S=ZCe(l[2],"()");if(S>-1){let M=(l[0].indexOf("!")===0?5:4)+l[1].length+S;l[2]=l[2].substring(0,S),l[0]=l[0].substring(0,M).trim(),l[3]=""}}let m=l[2],_="";if(this.options.pedantic){let S=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(m);S&&(m=S[1],_=S[3])}else _=l[3]?l[3].slice(1,-1):"";return m=m.trim(),/^</.test(m)&&(this.options.pedantic&&!/>$/.test(u)?m=m.slice(1):m=m.slice(1,-1)),r1e(l,{href:m&&m.replace(this.rules.inline._escapes,"$1"),title:_&&_.replace(this.rules.inline._escapes,"$1")},l[0],this.lexer)}}reflink(o,l){let u;if((u=this.rules.inline.reflink.exec(o))||(u=this.rules.inline.nolink.exec(o))){let m=(u[2]||u[1]).replace(/\s+/g," ");if(m=l[m.toLowerCase()],!m||!m.href){let _=u[0].charAt(0);return{type:"text",raw:_,text:_}}return r1e(u,m,u[0],this.lexer)}}emStrong(o,l,u=""){let m=this.rules.inline.emStrong.lDelim.exec(o);if(!m||m[3]&&u.match(/[\p{L}\p{N}]/u))return;let _=m[1]||m[2]||"";if(!_||_&&(u===""||this.rules.inline.punctuation.exec(u))){let S=m[0].length-1,M,P,k=S,L=0,z=m[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(z.lastIndex=0,l=l.slice(-1*o.length+S);(m=z.exec(l))!=null;){if(M=m[1]||m[2]||m[3]||m[4]||m[5]||m[6],!M)continue;if(P=M.length,m[3]||m[4]){k+=P;continue}else if((m[5]||m[6])&&S%3&&!((S+P)%3)){L+=P;continue}if(k-=P,k>0)continue;if(P=Math.min(P,P+k+L),Math.min(S,P)%2){let H=o.slice(1,S+m.index+P);return{type:"em",raw:o.slice(0,S+m.index+P+1),text:H,tokens:this.lexer.inlineTokens(H)}}let $=o.slice(2,S+m.index+P-1);return{type:"strong",raw:o.slice(0,S+m.index+P+1),text:$,tokens:this.lexer.inlineTokens($)}}}}codespan(o){let l=this.rules.inline.code.exec(o);if(l){let u=l[2].replace(/\n/g," "),m=/[^ ]/.test(u),_=/^ /.test(u)&&/ $/.test(u);return m&&_&&(u=u.substring(1,u.length-1)),u=y0(u,!0),{type:"codespan",raw:l[0],text:u}}}br(o){let l=this.rules.inline.br.exec(o);if(l)return{type:"br",raw:l[0]}}del(o){let l=this.rules.inline.del.exec(o);if(l)return{type:"del",raw:l[0],text:l[2],tokens:this.lexer.inlineTokens(l[2])}}autolink(o,l){let u=this.rules.inline.autolink.exec(o);if(u){let m,_;return u[2]==="@"?(m=y0(this.options.mangle?l(u[1]):u[1]),_="mailto:"+m):(m=y0(u[1]),_=m),{type:"link",raw:u[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}url(o,l){let u;if(u=this.rules.inline.url.exec(o)){let m,_;if(u[2]==="@")m=y0(this.options.mangle?l(u[0]):u[0]),_="mailto:"+m;else{let S;do S=u[0],u[0]=this.rules.inline._backpedal.exec(u[0])[0];while(S!==u[0]);m=y0(u[0]),u[1]==="www."?_="http://"+m:_=m}return{type:"link",raw:u[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}inlineText(o,l){let u=this.rules.inline.text.exec(o);if(u){let m;return this.lexer.state.inRawBlock?m=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(u[0]):y0(u[0]):u[0]:m=y0(this.options.smartypants?l(u[0]):u[0]),{type:"text",raw:u[0],text:m}}}},kr={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:ow,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/},kr._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,kr._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,kr.def=Hs(kr.def).replace("label",kr._label).replace("title",kr._title).getRegex(),kr.bullet=/(?:[*+-]|\d{1,9}[.)])/,kr.listItemStart=Hs(/^( *)(bull) */).replace("bull",kr.bullet).getRegex(),kr.list=Hs(kr.list).replace(/bull/g,kr.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+kr.def.source+")").getRegex(),kr._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",kr._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,kr.html=Hs(kr.html,"i").replace("comment",kr._comment).replace("tag",kr._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),kr.paragraph=Hs(kr._paragraph).replace("hr",kr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kr._tag).getRegex(),kr.blockquote=Hs(kr.blockquote).replace("paragraph",kr.paragraph).getRegex(),kr.normal=If({},kr),kr.gfm=If({},kr.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),kr.gfm.table=Hs(kr.gfm.table).replace("hr",kr.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kr._tag).getRegex(),kr.gfm.paragraph=Hs(kr._paragraph).replace("hr",kr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",kr.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kr._tag).getRegex(),kr.pedantic=If({},kr.normal,{html:Hs(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",kr._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ow,paragraph:Hs(kr.normal._paragraph).replace("hr",kr.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",kr.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),or={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:ow,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:ow,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/},or._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",or.punctuation=Hs(or.punctuation).replace(/punctuation/g,or._punctuation).getRegex(),or.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,or.escapedEmSt=/\\\*|\\_/g,or._comment=Hs(kr._comment).replace("(?:-->|$)","-->").getRegex(),or.emStrong.lDelim=Hs(or.emStrong.lDelim).replace(/punct/g,or._punctuation).getRegex(),or.emStrong.rDelimAst=Hs(or.emStrong.rDelimAst,"g").replace(/punct/g,or._punctuation).getRegex(),or.emStrong.rDelimUnd=Hs(or.emStrong.rDelimUnd,"g").replace(/punct/g,or._punctuation).getRegex(),or._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,or._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,or._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,or.autolink=Hs(or.autolink).replace("scheme",or._scheme).replace("email",or._email).getRegex(),or._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,or.tag=Hs(or.tag).replace("comment",or._comment).replace("attribute",or._attribute).getRegex(),or._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,or._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,or._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,or.link=Hs(or.link).replace("label",or._label).replace("href",or._href).replace("title",or._title).getRegex(),or.reflink=Hs(or.reflink).replace("label",or._label).replace("ref",kr._label).getRegex(),or.nolink=Hs(or.nolink).replace("ref",kr._label).getRegex(),or.reflinkSearch=Hs(or.reflinkSearch,"g").replace("reflink",or.reflink).replace("nolink",or.nolink).getRegex(),or.normal=If({},or),or.pedantic=If({},or.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Hs(/^!?\[(label)\]\((.*?)\)/).replace("label",or._label).getRegex(),reflink:Hs(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",or._label).getRegex()}),or.gfm=If({},or.normal,{escape:Hs(or.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),or.gfm.url=Hs(or.gfm.url,"i").replace("email",or.gfm._extended_email).getRegex(),or.breaks=If({},or.gfm,{br:Hs(or.br).replace("{2,}","*").getRegex(),text:Hs(or.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),r8=class SH{constructor(l){this.tokens=[],this.tokens.links=Object.create(null),this.options=l||n8,this.options.tokenizer=this.options.tokenizer||new HP,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let u={block:kr.normal,inline:or.normal};this.options.pedantic?(u.block=kr.pedantic,u.inline=or.pedantic):this.options.gfm&&(u.block=kr.gfm,this.options.breaks?u.inline=or.breaks:u.inline=or.gfm),this.tokenizer.rules=u}static get rules(){return{block:kr,inline:or}}static lex(l,u){return new SH(u).lex(l)}static lexInline(l,u){return new SH(u).inlineTokens(l)}lex(l){l=l.replace(/\r\n|\r/g,`
`),this.blockTokens(l,this.tokens);let u;for(;u=this.inlineQueue.shift();)this.inlineTokens(u.src,u.tokens);return this.tokens}blockTokens(l,u=[]){this.options.pedantic?l=l.replace(/\t/g,"    ").replace(/^ +$/gm,""):l=l.replace(/^( *)(\t+)/gm,(P,k,L)=>k+"    ".repeat(L.length));let m,_,S,M;for(;l;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(P=>(m=P.call({lexer:this},l,u))?(l=l.substring(m.raw.length),u.push(m),!0):!1))){if(m=this.tokenizer.space(l)){l=l.substring(m.raw.length),m.raw.length===1&&u.length>0?u[u.length-1].raw+=`
`:u.push(m);continue}if(m=this.tokenizer.code(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue[this.inlineQueue.length-1].src=_.text):u.push(m);continue}if(m=this.tokenizer.fences(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.heading(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.hr(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.blockquote(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.list(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.html(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.def(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.raw,this.inlineQueue[this.inlineQueue.length-1].src=_.text):this.tokens.links[m.tag]||(this.tokens.links[m.tag]={href:m.href,title:m.title});continue}if(m=this.tokenizer.table(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.lheading(l)){l=l.substring(m.raw.length),u.push(m);continue}if(S=l,this.options.extensions&&this.options.extensions.startBlock){let P=1/0,k=l.slice(1),L;this.options.extensions.startBlock.forEach(function(z){L=z.call({lexer:this},k),typeof L=="number"&&L>=0&&(P=Math.min(P,L))}),P<1/0&&P>=0&&(S=l.substring(0,P+1))}if(this.state.top&&(m=this.tokenizer.paragraph(S))){_=u[u.length-1],M&&_.type==="paragraph"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):u.push(m),M=S.length!==l.length,l=l.substring(m.raw.length);continue}if(m=this.tokenizer.text(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&_.type==="text"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):u.push(m);continue}if(l){let P="Infinite loop on byte: "+l.charCodeAt(0);if(this.options.silent){console.error(P);break}else throw new Error(P)}}return this.state.top=!0,u}inline(l,u=[]){return this.inlineQueue.push({src:l,tokens:u}),u}inlineTokens(l,u=[]){let m,_,S,M=l,P,k,L;if(this.tokens.links){let z=Object.keys(this.tokens.links);if(z.length>0)for(;(P=this.tokenizer.rules.inline.reflinkSearch.exec(M))!=null;)z.includes(P[0].slice(P[0].lastIndexOf("[")+1,-1))&&(M=M.slice(0,P.index)+"["+n1e("a",P[0].length-2)+"]"+M.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(P=this.tokenizer.rules.inline.blockSkip.exec(M))!=null;)M=M.slice(0,P.index)+"["+n1e("a",P[0].length-2)+"]"+M.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(P=this.tokenizer.rules.inline.escapedEmSt.exec(M))!=null;)M=M.slice(0,P.index)+"++"+M.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;l;)if(k||(L=""),k=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(z=>(m=z.call({lexer:this},l,u))?(l=l.substring(m.raw.length),u.push(m),!0):!1))){if(m=this.tokenizer.escape(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.tag(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):u.push(m);continue}if(m=this.tokenizer.link(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.reflink(l,this.tokens.links)){l=l.substring(m.raw.length),_=u[u.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):u.push(m);continue}if(m=this.tokenizer.emStrong(l,M,L)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.codespan(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.br(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.del(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.autolink(l,i1e)){l=l.substring(m.raw.length),u.push(m);continue}if(!this.state.inLink&&(m=this.tokenizer.url(l,i1e))){l=l.substring(m.raw.length),u.push(m);continue}if(S=l,this.options.extensions&&this.options.extensions.startInline){let z=1/0,$=l.slice(1),H;this.options.extensions.startInline.forEach(function(j){H=j.call({lexer:this},$),typeof H=="number"&&H>=0&&(z=Math.min(z,H))}),z<1/0&&z>=0&&(S=l.substring(0,z+1))}if(m=this.tokenizer.inlineText(S,JCe)){l=l.substring(m.raw.length),m.raw.slice(-1)!=="_"&&(L=m.raw.slice(-1)),k=!0,_=u[u.length-1],_&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):u.push(m);continue}if(l){let z="Infinite loop on byte: "+l.charCodeAt(0);if(this.options.silent){console.error(z);break}else throw new Error(z)}}return u}},WP=class{constructor(o){this.options=o||n8}code(o,l,u){let m=(l||"").match(/\S*/)[0];if(this.options.highlight){let _=this.options.highlight(o,m);_!=null&&_!==o&&(u=!0,o=_)}return o=o.replace(/\n$/,"")+`
`,m?'<pre><code class="'+this.options.langPrefix+y0(m,!0)+'">'+(u?o:y0(o,!0))+`</code></pre>
`:"<pre><code>"+(u?o:y0(o,!0))+`</code></pre>
`}blockquote(o){return`<blockquote>
`.concat(o,`</blockquote>
`)}html(o){return o}heading(o,l,u,m){if(this.options.headerIds){let _=this.options.headerPrefix+m.slug(u);return"<h".concat(l,' id="').concat(_,'">').concat(o,"</h").concat(l,`>
`)}return"<h".concat(l,">").concat(o,"</h").concat(l,`>
`)}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(o,l,u){let m=l?"ol":"ul",_=l&&u!==1?' start="'+u+'"':"";return"<"+m+_+`>
`+o+"</"+m+`>
`}listitem(o){return"<li>".concat(o,`</li>
`)}checkbox(o){return"<input "+(o?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(o){return"<p>".concat(o,`</p>
`)}table(o,l){return l&&(l="<tbody>".concat(l,"</tbody>")),`<table>
<thead>
`+o+`</thead>
`+l+`</table>
`}tablerow(o){return`<tr>
`.concat(o,`</tr>
`)}tablecell(o,l){let u=l.header?"th":"td";return(l.align?"<".concat(u,' align="').concat(l.align,'">'):"<".concat(u,">"))+o+"</".concat(u,`>
`)}strong(o){return"<strong>".concat(o,"</strong>")}em(o){return"<em>".concat(o,"</em>")}codespan(o){return"<code>".concat(o,"</code>")}br(){return this.options.xhtml?"<br/>":"<br>"}del(o){return"<del>".concat(o,"</del>")}link(o,l,u){if(o=Jpe(this.options.sanitize,this.options.baseUrl,o),o===null)return u;let m='<a href="'+y0(o)+'"';return l&&(m+=' title="'+l+'"'),m+=">"+u+"</a>",m}image(o,l,u){if(o=Jpe(this.options.sanitize,this.options.baseUrl,o),o===null)return u;let m='<img src="'.concat(o,'" alt="').concat(u,'"');return l&&(m+=' title="'.concat(l,'"')),m+=this.options.xhtml?"/>":">",m}text(o){return o}},$B=class{strong(o){return o}em(o){return o}codespan(o){return o}del(o){return o}html(o){return o}text(o){return o}link(o,l,u){return""+u}image(o,l,u){return""+u}br(){return""}},XB=class{constructor(){this.seen={}}serialize(o){return o.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(o,l){let u=o,m=0;if(this.seen.hasOwnProperty(u)){m=this.seen[o];do m++,u=o+"-"+m;while(this.seen.hasOwnProperty(u))}return l||(this.seen[o]=m,this.seen[u]=0),u}slug(o,l={}){let u=this.serialize(o);return this.getNextSafeSlug(u,l.dryrun)}},S9=class wH{constructor(l){this.options=l||n8,this.options.renderer=this.options.renderer||new WP,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new $B,this.slugger=new XB}static parse(l,u){return new wH(u).parse(l)}static parseInline(l,u){return new wH(u).parseInline(l)}parse(l,u=!0){let m="",_,S,M,P,k,L,z,$,H,j,K,Q,re,ae,ue,ye,Ae,Ce,Se,ft=l.length;for(_=0;_<ft;_++){if(j=l[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[j.type]&&(Se=this.options.extensions.renderers[j.type].call({parser:this},j),Se!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(j.type))){m+=Se||"";continue}switch(j.type){case"space":continue;case"hr":{m+=this.renderer.hr();continue}case"heading":{m+=this.renderer.heading(this.parseInline(j.tokens),j.depth,Qpe(this.parseInline(j.tokens,this.textRenderer)),this.slugger);continue}case"code":{m+=this.renderer.code(j.text,j.lang,j.escaped);continue}case"table":{for($="",z="",P=j.header.length,S=0;S<P;S++)z+=this.renderer.tablecell(this.parseInline(j.header[S].tokens),{header:!0,align:j.align[S]});for($+=this.renderer.tablerow(z),H="",P=j.rows.length,S=0;S<P;S++){for(L=j.rows[S],z="",k=L.length,M=0;M<k;M++)z+=this.renderer.tablecell(this.parseInline(L[M].tokens),{header:!1,align:j.align[M]});H+=this.renderer.tablerow(z)}m+=this.renderer.table($,H);continue}case"blockquote":{H=this.parse(j.tokens),m+=this.renderer.blockquote(H);continue}case"list":{for(K=j.ordered,Q=j.start,re=j.loose,P=j.items.length,H="",S=0;S<P;S++)ue=j.items[S],ye=ue.checked,Ae=ue.task,ae="",ue.task&&(Ce=this.renderer.checkbox(ye),re?ue.tokens.length>0&&ue.tokens[0].type==="paragraph"?(ue.tokens[0].text=Ce+" "+ue.tokens[0].text,ue.tokens[0].tokens&&ue.tokens[0].tokens.length>0&&ue.tokens[0].tokens[0].type==="text"&&(ue.tokens[0].tokens[0].text=Ce+" "+ue.tokens[0].tokens[0].text)):ue.tokens.unshift({type:"text",text:Ce}):ae+=Ce),ae+=this.parse(ue.tokens,re),H+=this.renderer.listitem(ae,Ae,ye);m+=this.renderer.list(H,K,Q);continue}case"html":{m+=this.renderer.html(j.text);continue}case"paragraph":{m+=this.renderer.paragraph(this.parseInline(j.tokens));continue}case"text":{for(H=j.tokens?this.parseInline(j.tokens):j.text;_+1<ft&&l[_+1].type==="text";)j=l[++_],H+=`
`+(j.tokens?this.parseInline(j.tokens):j.text);m+=u?this.renderer.paragraph(H):H;continue}default:{let ke='Token with "'+j.type+'" type was not found.';if(this.options.silent){console.error(ke);return}else throw new Error(ke)}}}return m}parseInline(l,u){u=u||this.renderer;let m="",_,S,M,P=l.length;for(_=0;_<P;_++){if(S=l[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[S.type]&&(M=this.options.extensions.renderers[S.type].call({parser:this},S),M!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(S.type))){m+=M||"";continue}switch(S.type){case"escape":{m+=u.text(S.text);break}case"html":{m+=u.html(S.text);break}case"link":{m+=u.link(S.href,S.title,this.parseInline(S.tokens,u));break}case"image":{m+=u.image(S.href,S.title,S.text);break}case"strong":{m+=u.strong(this.parseInline(S.tokens,u));break}case"em":{m+=u.em(this.parseInline(S.tokens,u));break}case"codespan":{m+=u.codespan(S.text);break}case"br":{m+=u.br();break}case"del":{m+=u.del(this.parseInline(S.tokens,u));break}case"text":{m+=u.text(S.text);break}default:{let k='Token with "'+S.type+'" type was not found.';if(this.options.silent){console.error(k);return}else throw new Error(k)}}}return m}},$r.options=$r.setOptions=function(o){return If($r.defaults,o),YCe($r.defaults),$r},$r.getDefaults=Zpe,$r.defaults=n8,$r.use=function(...o){let l=If({},...o),u=$r.defaults.extensions||{renderers:{},childTokens:{}},m;o.forEach(_=>{if(_.extensions&&(m=!0,_.extensions.forEach(S=>{if(!S.name)throw new Error("extension name required");if(S.renderer){let M=u.renderers?u.renderers[S.name]:null;M?u.renderers[S.name]=function(...P){let k=S.renderer.apply(this,P);return k===!1&&(k=M.apply(this,P)),k}:u.renderers[S.name]=S.renderer}if(S.tokenizer){if(!S.level||S.level!=="block"&&S.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");u[S.level]?u[S.level].unshift(S.tokenizer):u[S.level]=[S.tokenizer],S.start&&(S.level==="block"?u.startBlock?u.startBlock.push(S.start):u.startBlock=[S.start]:S.level==="inline"&&(u.startInline?u.startInline.push(S.start):u.startInline=[S.start]))}S.childTokens&&(u.childTokens[S.name]=S.childTokens)})),_.renderer){let S=$r.defaults.renderer||new WP;for(let M in _.renderer){let P=S[M];S[M]=(...k)=>{let L=_.renderer[M].apply(S,k);return L===!1&&(L=P.apply(S,k)),L}}l.renderer=S}if(_.tokenizer){let S=$r.defaults.tokenizer||new HP;for(let M in _.tokenizer){let P=S[M];S[M]=(...k)=>{let L=_.tokenizer[M].apply(S,k);return L===!1&&(L=P.apply(S,k)),L}}l.tokenizer=S}if(_.walkTokens){let S=$r.defaults.walkTokens;l.walkTokens=function(M){let P=[];return P.push(_.walkTokens.call(this,M)),S&&(P=P.concat(S.call(this,M))),P}}m&&(l.extensions=u),$r.setOptions(l)})},$r.walkTokens=function(o,l){let u=[];for(let m of o)switch(u=u.concat(l.call($r,m)),m.type){case"table":{for(let _ of m.header)u=u.concat($r.walkTokens(_.tokens,l));for(let _ of m.rows)for(let S of _)u=u.concat($r.walkTokens(S.tokens,l));break}case"list":{u=u.concat($r.walkTokens(m.items,l));break}default:$r.defaults.extensions&&$r.defaults.extensions.childTokens&&$r.defaults.extensions.childTokens[m.type]?$r.defaults.extensions.childTokens[m.type].forEach(function(_){u=u.concat($r.walkTokens(m[_],l))}):m.tokens&&(u=u.concat($r.walkTokens(m.tokens,l)))}return u},$r.parseInline=function(o,l){if(typeof o>"u"||o===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof o!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(o)+", string expected");l=If({},$r.defaults,l||{}),t1e(l);try{let u=r8.lexInline(o,l);return l.walkTokens&&$r.walkTokens(u,l.walkTokens),S9.parseInline(u,l)}catch(u){if(u.message+=`
Please report this to https://github.com/markedjs/marked.`,l.silent)return"<p>An error occurred:</p><pre>"+y0(u.message+"",!0)+"</pre>";throw u}},$r.Parser=S9,$r.parser=S9.parse,$r.Renderer=WP,$r.TextRenderer=$B,$r.Lexer=r8,$r.lexer=r8.lex,$r.Tokenizer=HP,$r.Slugger=XB,$r.parse=$r,$r.options,$r.setOptions,$r.use,$r.walkTokens,$r.parseInline,S9.parse,r8.lex}),Ec,qP,$P,YB,v1e,y1e,_1e,KB,x1e,b1e,S1e,ZB,w1e,T1e,E1e,M1e,C1e,aw,XP,A1e,P1e,R1e,I1e,N1e,k1e,D1e,QB,JB=A(()=>{Ec=G(et()),XCe(),Jt(),os(),Sr(),eAe(),qA(),Bfe(),qP=({title:o,message:l})=>"".concat(o," ").concat(l),$P=(()=>{let o=new Map;return{add:l=>{let u=qP(l);o.has(u)?o.set(u,o.get(u)+1):o.set(u,1)},delete:l=>{let u=qP(l);o.has(u)&&o.get(u)>1?o.set(u,o.get(u)-1):o.delete(u)},clear:()=>{o.clear()},check:l=>o.has(qP(l))}})(),YB=(()=>{let o=new Map;return{add:l=>{o.has(l)?o.set(l,o.get(l)+1):o.set(l,1)},delete:l=>{o.has(l)&&o.get(l)>1?o.set(l,o.get(l)-1):o.delete(l)},clear:()=>{o.clear()},check:l=>o.has(l),get types(){return Array.of(...o.keys())}}})(),y1e=ge.div(v1e||(v1e=X([`
  width: 100%;
  border-radius: 4px;
  display: flex;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Wi),KB=ge.div(_1e||(_1e=X([`
  font-size: 14px;
  font-weight: bold;
  color: #fff;
`]))),b1e=ge.div(x1e||(x1e=X([`
  flex: 1;
  flex-direction: column;
  width: 0;
  display: flex;
  padding: 16px 0;
  gap: 12px;
`]))),ZB=ge.div(S1e||(S1e=X([`
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;

  a {
    color: rgba(255, 255, 255, 0.9);
  }

  em {
    font-style: italic;
  }

  strong {
    font-weight: bold;
    color: #d5d5d5;
  }

  p {
    margin-bottom: 8px;
  }

  code {
    font-family: monospace;
    background: rgba(0, 0, 0, 0.3);
    padding: 1px 1px 2px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    white-space: pre-wrap;
  }

  pre > code {
    white-space: pre;
    display: block;
    overflow: auto;
    padding: 4px;
  }

  pre {
    white-space: pre-wrap;
    margin-bottom: 8px;
  }
`]))),T1e=ge.button(w1e||(w1e=X([`
  color: rgba(255, 255, 255, 0.9);
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  padding-left: 12px;
  padding-right: 12px;
  border-left: 1px solid rgba(255, 255, 255, 0.05);

  &:hover {
    background: rgba(255, 255, 255, 0.05);
  }
`]))),E1e={info:"#3b82f6",success:"#10b981",warning:"#f59e0b",error:"#ef4444"},C1e=ge.div(M1e||(M1e=X([`
  display: flex;
  justify-content: center;
  margin-left: 12px;
  padding-top: 21px;

  ::before {
    content: '';
    width: 8px;
    height: 8px;
    border-radius: 999999px;
    background-color: `,`;
  }
`])),({type:o})=>E1e[o]),aw=o=>(l,u,m=[],_=!1)=>{(_||!$P.check({title:l,message:u}))&&($P.add({title:l,message:u}),YB.add(o),WB.custom(S=>Ec.default.createElement(y1e,null,Ec.default.createElement(C1e,{type:o}),Ec.default.createElement(b1e,null,Ec.default.createElement(KB,null,l),Ec.default.createElement(ZB,{dangerouslySetInnerHTML:{__html:$r.parse(u)}}),m.length>0&&Ec.default.createElement(ZB,null,Ec.default.createElement("span",null,"Docs:"," ",m.map((M,P)=>Ec.default.createElement(Ec.Fragment,{key:P},P>0&&", ",Ec.default.createElement("a",{target:"_blank",href:M.url},M.title)))))),Ec.default.createElement(T1e,{onClick:()=>{WB.remove(S.id),$P.delete({title:l,message:u}),YB.delete(o)}},"Close")),{duration:1/0}))},XP={warning:aw("warning"),success:aw("success"),info:aw("info"),error:aw("error")},ge.div(A1e||(A1e=X([`
  display: flex;
  justify-content: `,`;
  gap: 12px;
`])),({align:o})=>o==="center"?"center":"flex-end"),ge.button(P1e||(P1e=X([`
  position: relative;
  border-radius: 4px;
  display: flex;
  align-items: center;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border: none;
  padding: 12px;
  color: #fff;
  overflow: hidden;

  ::before {
    content: '';
    position: absolute;
    inset: 0;
  }

  :hover::before {
    background: `,`;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Wi,({danger:o})=>o?"rgba(255, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"),ge.div(R1e||(R1e=X([`
  z-index: 10;
  display: flex;
  flex-direction: column;
  gap: 8px;
  position: fixed;
  right: 92px;
  top: 50px;
  width: 500px;
  height: 85vh;
  min-height: 400px;
`]))),ge.div(I1e||(I1e=X([`
  overflow: hidden;
  pointer-events: auto;
  border-radius: 4px;

  & > div {
    display: flex;
    flex-direction: column-reverse;
    gap: 8px;
    overflow: scroll;
    height: 100%;
  }
`]))),k1e=ge.div(N1e||(N1e=X([`
  width: fit-content;
  padding: 8px;
  border-radius: 4px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;
`]))),D1e=()=>{let{hasNotifications:o}=QB();return HA({enabled:!o},()=>Ec.default.createElement(IB,null,Ec.default.createElement(k1e,null,Ec.default.createElement(KB,null,"No notifications"),"Notifications will appear here when you get them.")))},QB=()=>{let{toasts:o}=Kpe();return{hasNotifications:o.length>0}}}),Dl,O1e,L1e,F1e,U1e,B1e,z1e,V1e,G1e,j1e,ez,H1e,W1e,tAe=A(()=>{Sr(),Ie(),Dl=G(et()),Jt(),qA(),PCe(),PB(),O1e=an(),gpe(),GCe(),zC(),HCe(),qCe(),xf(),$Ce(),JB(),F1e=ge.div(L1e||(L1e=X([`
  height: 36px;
  pointer-events: none;

  display: flex;
  justify-content: space-between;
  padding: 12px;
`]))),B1e=ge.div(U1e||(U1e=X([`
  color: white;
  width: 14px;
  height: 14px;
  background: #d00;
  border-radius: 4px;
  text-align: center;
  line-height: 14px;
  font-weight: 600;
  font-size: 8px;
  position: relative;
  left: -6px;
  top: -11px;
  margin-right: -14px;
  box-shadow: 0 4px 6px -4px #00000059;
`]))),V1e=ge.div(z1e||(z1e=X([`
  display: flex;
  gap: 8px;
`]))),ge.div(G1e||(G1e=X([`
  position: absolute;
  background: `,`;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  right: -2px;
  top: -2px;
`])),({type:o})=>o==="info"?"#40aaa4":"#f59e0b"),ge.div(j1e||(j1e=X([`
  position: absolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),ez=!1,H1e=()=>{var o;let l=ri(()=>{let z=(0,O1e.val)(ce().atomP.ephemeral.coreByProject);return Object.entries(z).map(([$,H])=>({projectId:$,state:H})).filter(({state:$})=>$.loadingState.type==="browserStateIsNotBasedOnDiskState")},[]),[u,m]=HA({enabled:l.length>0,enterDelay:l.length>0?0:200},()=>l.length>0?Dl.default.createElement(Nfe,null,l.length===1?'There is a state conflict in project "'.concat(l[0].projectId,'". Select the project in the outline below in order to fix it.'):"There are ".concat(l.length," projects that have state conflicts. They are highlighted in the outline below. ")):Dl.default.createElement(UP,null,Dl.default.createElement(Dl.default.Fragment,null,"Outline"))),_=(o=qr(ce().atomP.ahistoric.pinOutline))!=null?o:!0,S=qr(ce().atomP.ahistoric.updateChecker.result.hasUpdates)===!0;su(()=>{let z=M.current.getBoundingClientRect();return{debugName:"More Menu",constraints:{maxX:z.right,maxY:8,minX:z.left-140,minY:8},verticalGap:2}},()=>Dl.default.createElement(Bpe,null));let M=(0,Dl.useRef)(null);(0,Dl.useMemo)(()=>(window.__IS_VISUAL_REGRESSION_TESTING&&(ez||(ez=!0,console.warn("Visual regression testing enabled, so we're showing the updates badge unconditionally"))),S||window.__IS_VISUAL_REGRESSION_TESTING?!0:S),[S]);let{hasNotifications:P}=QB(),[k,L]=D1e();return Dl.default.createElement(F1e,null,Dl.default.createElement(V1e,null,u,Dl.default.createElement(xpe,{ref:m,"data-testid":"OutlinePanel-TriggerButton",onClick:()=>{ce().transaction(({stateEditors:z,drafts:$})=>{var H;z.studio.ahistoric.setPinOutline(!((H=$.ahistoric.pinOutline)==null||H))})},icon:Dl.default.createElement(cK,null),pinHintIcon:Dl.default.createElement(Spe,null),unpinHintIcon:Dl.default.createElement(bpe,null),pinned:_}),l.length>0?Dl.default.createElement(B1e,null,l.length):null,Dl.default.createElement(LB,{showLeftDivider:!0,toolbarId:"global"})))},W1e=H1e}),q1e,lw,$1e,cw,X1e,Y1e,K1e,Z1e,Q1e=A(()=>{q1e=an(),Sr(),lw=G(et()),$1e=G(Cg()),cw=new q1e.Atom({set:{},byId:{}}),X1e=1,Y1e=()=>{let o=X1e++;function l(m,_,S){cw.reduce(M=>({byId:B(R({},M.byId),{[o]:{comp:m,props:_,portalNode:S}}),set:B(R({},M.set),{[o]:!0})}))}function u(){cw.reduce(m=>{let _=R({},m.set),S=R({},m.byId);return delete _[o],{byId:S,set:_}})}return{mountOrRender:l,unmount:u}},K1e=()=>{let o=Object.keys(qr(cw.pointer.set));return lw.default.createElement(lw.default.Fragment,null,o.map(l=>lw.default.createElement(Z1e,{key:"id-"+l,id:l})))},Z1e=({id:o})=>{let{comp:l,portalNode:u,props:m}=qr(cw.pointer.byId[o]);return(0,$1e.createPortal)(lw.default.createElement(l,R({},m)),u)}});function nAe(o){let l=ce(),[u,m]=bi(void 0),_=b0e();_.configureLogging({min:128,dev:nz,internal:nz});let S=_.getLogger().named("Theatre.js UIRoot");rCe();let M=qr(l.atomP.ahistoric.visibilityState);return(0,Ol.useEffect)(()=>(M==="everythingIsHidden"&&console.warn("Theatre.js Studio is hidden. Use the keyboard shortcut 'alt + \\' to restore the studio, or call studio.ui.restore()."),()=>{}),[M]),ri(()=>{let P=(0,tz.val)(l.atomP.ahistoric.visibilityState);return(0,tz.val)(l.atomP.ephemeral.initialised)?Ol.default.createElement(gZ,{logger:S},Ol.default.createElement(qre,null,Ol.default.createElement(QSe,null,Ol.default.createElement(ime,null),Ol.default.createElement(jy.Provider,{value:m},Ol.default.createElement(lL,{target:window.__IS_VISUAL_REGRESSION_TESTING===!0?void 0:o.containerShadow},Ol.default.createElement(Ol.default.Fragment,null,Ol.default.createElement(eme,null),Ol.default.createElement(nme,{className:P==="everythingIsHidden"?"invisible":""},Ol.default.createElement(aL,{ref:u}),Ol.default.createElement(W1e,null),Ol.default.createElement(Cfe,null)))))))):null},[l,u,m])}var tz,Ol,J1e,eme,tme,nme,rme,nz,ime,rAe=A(()=>{Ie(),Sr(),tz=an(),Ol=G(et()),Jt(),ACe(),tAe(),Ji(),Mv(),cB(),Cl(),$re(),PL(),Q1e(),os(),_P(),Av(),eme=typeof window<"u"?dX(J1e||(J1e=X([`
  :host {
    contain: strict;
  }
`]))):{},nme=ge(mZ)(tme||(tme=X([`
  z-index: 50;
  position: fixed;
  inset: 0;

  &.invisible {
    pointer-events: none !important;
    opacity: 0;
    transform: translateX(1000000px);
  }
`]))),nz=/Playground.+Theatre\.js/.test((rme=typeof document<"u"?document==null?void 0:document.title:null)!=null?rme:""),ime=()=>Ol.default.createElement(K1e,null)}),iAe=ne(o=>{var l=Cg();o.createRoot=l.createRoot,o.hydrateRoot=l.hydrateRoot}),sme={};se(sme,{default:()=>lme});var ome,ame,lme,sAe=A(()=>{rAe(),ome=G(et()),ame=G(iAe()),Q1e(),os(),gpe(),lme=class{constructor(){Me(this,"containerEl",document.createElement("div")),Me(this,"_renderTimeout"),Me(this,"_documentBodyUIIsRenderedIn"),Me(this,"containerShadow"),this.containerEl.id="theatrejs-studio-root",this.containerEl.style.cssText=`
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      z-index: 100;
    `;let o=()=>{if(window.__IS_VISUAL_REGRESSION_TESTING===!0){let l=document.createElement("div");return l.id="theatrejs-faux-shadow-root",document.body.appendChild(l),l}else return this.containerEl.attachShadow({mode:"open"})};this.containerShadow=o()}render(){let o=()=>{if(!document.body){this._renderTimeout=setTimeout(o,5);return}this._renderTimeout=void 0,this._documentBodyUIIsRenderedIn=document.body,this._documentBodyUIIsRenderedIn.appendChild(this.containerEl),ame.default.createRoot(this.containerShadow).render(ome.default.createElement(nAe,{containerShadow:this.containerShadow}))};this._renderTimeout=setTimeout(o,10)}renderToolset(o,l){let u=Y1e();return u.mountOrRender(bSe(LB),{toolbarId:o},l),u.unmount}}}),oAe=ne(o=>{o.compare=_,o.reduce=S;var l,u,m;o.REMOVE=l=-1,o.ADD=u=1,o.EQUAL=m=0;function _(z,$){var H=z.length,j=$.length,K=M(z,$),Q=K<H&&K<j?P(z,$):0,re=Q+K-1;H-=re,j-=re;for(var ae=L(H,j),ue=H-1;ue>=0;--ue)for(var ye=j-1;ye>=0;--ye)ae[ye][ue]=k(ae,z,$,K,ue,ye);return{prefix:K,matrix:ae,suffix:Q}}function S(z,$,H){var j,K,Q,re,ae=H.matrix,ue=H.prefix;for(j=0;j<ue;++j)$=z($,m,j,j);for(Q=j,ue=ae.length,j=0,K=0;j<ue;)switch(re=ae[j][K].type,$=z($,re,j+Q,K+Q),re){case m:++j,++K;break;case l:++K;break;case u:++j;break}for(j+=Q,K+=Q,ue=H.suffix,Q=0;Q<ue;++Q)$=z($,m,j+Q,K+Q);return $}function M(z,$){for(var H=0,j=Math.min(z.length,$.length);H<j&&z[H]===$[H];)++H;return H}function P(z,$){for(var H=z.length-1,j=$.length-1,K=Math.min(H,j),Q=0;Q<K&&z[H-Q]===$[j-Q];)++Q;return Q}function k(z,$,H,j,K,Q){return $[K+j]===H[Q+j]?{value:z[Q+1][K+1].value,type:m}:z[Q][K+1].value<z[Q+1][K].value?{value:z[Q][K+1].value+1,type:l}:{value:z[Q+1][K].value+1,type:u}}function L(z,$){var H=[],j,K,Q;for(Q=H[$]=[],K=0;K<z;++K)Q[K]={value:z-K,type:l};for(j=0;j<$;++j)H[j]=[],H[j][z]={value:$-j,type:u};return H[$][z]={value:0,type:m},H}}),cme=ne(o=>{o.cons=l,o.tail=u,o.map=m;function l(_,S){var M=S.length,P=new Array(M+1);P[0]=_;for(var k=0;k<M;++k)P[k+1]=S[k];return P}function u(_){for(var S=_.length-1,M=new Array(S),P=0;P<S;++P)M[P]=_[P+1];return M}function m(_,S){for(var M=new Array(S.length),P=0;P<S.length;++P)M[P]=_(S[P]);return M}}),aAe=ne((o,l)=>{l.exports=M;var u=/\/|~1|~0/g,m="/",_="~",S="~1";function M(P,k){var L,z,$,H;for(L=P.charAt(0)===m?1:0,z="",u.lastIndex=L;$=u.exec(P);)if(H=$[0],z+=P.slice(L,u.lastIndex-H.length),L=u.lastIndex,H===m){if(k(z)===!1)return P;z=""}else z+=H===S?m:_;return z+=P.slice(L),k(z),P}}),rz=ne(o=>{var l=aAe();o.find=z,o.join=H,o.absolute=$,o.parse=j,o.contains=K,o.encodeSegment=re,o.decodeSegment=Q,o.parseArrayIndex=ye,o.isValidArrayIndex=ue;var u="/",m=/\//g,_="~1",S=/~1/g,M="~",P=/~/g,k="~0",L=/~0/g;function z(Ce,Se,ft,ke){if(typeof Se=="string"){if(Se==="")return{target:Ce,key:void 0};if(Se===u)return{target:Ce,key:""};var be=Ce,Ue,Ze=ke!==void 0;return l(Se,function(ze){if(Ce==null)return be=null,!1;Array.isArray(Ce)?Ue=Ze?Ae(ft,ye(ze),Ce,ke):ze==="-"?ze:ye(ze):Ue=ze,be=Ce,Ce=Ce[Ue]}),be===null?void 0:{target:be,key:Ue}}}function $(Ce){return Ce[0]===u?Ce:u+Ce}function H(Ce){return Ce.join(u)}function j(Ce){var Se=[];return l(Ce,Se.push.bind(Se)),Se}function K(Ce,Se){return Se.indexOf(Ce)===0&&Se[Ce.length]===u}function Q(Ce){return Ce.replace(S,u).replace(L,M)}function re(Ce){return Ce.replace(P,k).replace(m,_)}var ae=/^(0|[1-9]\d*)$/;function ue(Ce){return ae.test(Ce)}function ye(Ce){if(ue(Ce))return+Ce;throw new SyntaxError("invalid array index "+Ce)}function Ae(Ce,Se,ft,ke){var be=Se;if(be<0)throw new Error("array index out of bounds "+be);if(ke!==void 0&&typeof Ce=="function"&&(be=Ce(Se,ft,ke),be<0))throw new Error("could not find patch context "+ke);return be}}),ume=ne((o,l)=>{l.exports=u;function u(S){return S==null||typeof S!="object"?S:Array.isArray(S)?m(S):_(S)}function m(S){for(var M=S.length,P=new Array(M),k=0;k<M;++k)P[k]=u(S[k]);return P}function _(S){for(var M=Object.keys(S),P={},k,L=0,z=M.length;L<z;++L)k=M[L],P[k]=u(S[k]);return P}}),lAe=ne((o,l)=>{l.exports=u;function u(S,M){return S===M?!0:Array.isArray(S)&&Array.isArray(M)?m(S,M):typeof S=="object"&&typeof M=="object"?_(S,M):!1}function m(S,M){if(S.length!==M.length)return!1;for(var P=0;P<S.length;++P)if(!u(S[P],M[P]))return!1;return!0}function _(S,M){if(S===null&&M!==null||S!==null&&M===null)return!1;var P=Object.keys(S),k=Object.keys(M);if(P.length!==k.length)return!1;for(var L=0,z;L<P.length;++L)if(z=P[L],!(z in M&&u(S[z],M[z])))return!1;return!0}}),cAe=ne((o,l)=>{var u=rz();l.exports=function(z,$){var H=u.parse(z.path),j=u.parse($.path),K=k(H,j),Q=S(H,j,K.length),re=L(z),ae=L($);return K.length===0&&!Q?[ae,re]:Q?_(re,H,ae,j):m(re,H,ae)};function m(z,$,H,j){if(z.path===H.path)throw new TypeError("cannot commute "+z.op+","+H.op+" with identical object paths");return[H,z]}function _(z,$,H,j){return $.length===j.length?M(z,$,H,j):($.length>j.length?($=P(H,j,z,$,-1),z.path=u.absolute(u.join($))):(j=P(z,$,H,j,1),H.path=u.absolute(u.join(j))),[H,z])}function S(z,$,H){return u.isValidArrayIndex(z[H])&&u.isValidArrayIndex($[H])}function M(z,$,H,j){var K=$.length-1,Q=+$[K],re=+j[K],ae;return Q<re?z.op==="add"||z.op==="copy"?(ae=j.slice(),ae[K]=Math.max(0,re-1),H.path=u.absolute(u.join(ae))):z.op==="remove"&&(ae=j.slice(),ae[K]=re+1,H.path=u.absolute(u.join(ae))):H.op==="add"||H.op==="copy"?(ae=$.slice(),ae[K]=Q+1,z.path=u.absolute(u.join(ae))):Q>re&&H.op==="remove"&&(ae=$.slice(),ae[K]=Math.max(0,Q-1),z.path=u.absolute(u.join(ae))),[H,z]}function P(z,$,H,j,K){var Q=$.length-1,re=+$[Q],ae=+j[Q],ue=j.slice();return re>ae||(z.op==="add"||z.op==="copy"?ue[Q]=Math.max(0,ae-K):z.op==="remove"&&(ue[Q]=Math.max(0,ae+K))),ue}function k(z,$){var H=z.length,j=$.length;if(H===0||j===0||H<2&&j<2)return[];for(var K=H===j?H-1:Math.min(H,j),Q=0;Q<K&&z[Q]===$[Q];)++Q;return z.slice(0,Q)}function L(z){return z.op==="remove"?{op:z.op,path:z.path}:z.op==="copy"||z.op==="move"?{op:z.op,path:z.path,from:z.from}:{op:z.op,path:z.path,value:z.value}}}),dme=ne((o,l)=>{l.exports=u;function u(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}u.prototype=Object.create(Error.prototype),u.prototype.constructor=u}),iz=ne((o,l)=>{l.exports=u;function u(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}u.prototype=Object.create(Error.prototype),u.prototype.constructor=u}),hme=ne((o,l)=>{l.exports=u;function u(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}u.prototype=Object.create(Error.prototype),u.prototype.constructor=u}),fme=ne(o=>{var l=rz(),u=ume(),m=lAe(),_=cAe(),S=cme(),M=dme(),P=iz(),k=hme(),L=l.find,z=l.parseArrayIndex;o.test={apply:$,inverse:H,commute:j},o.add={apply:K,inverse:re,commute:ae},o.remove={apply:Ce,inverse:ft,commute:ke},o.replace={apply:ue,inverse:ye,commute:Ae},o.move={apply:be,inverse:Ue,commute:Ze},o.copy={apply:ze,inverse:Ft,commute:ae};function $(nt,Ee,ct){var Nt=L(nt,Ee.path,ct.findContext,Ee.context),Re=Nt.target,it,Ht;if(Array.isArray(Re)?(it=z(Nt.key),Ht=Re[it]):Ht=Nt.key===void 0?Nt.target:Nt.target[Nt.key],!m(Ht,Ee.value))throw new M("test failed "+JSON.stringify(Ee));return nt}function H(nt,Ee){return nt.push(Ee),1}function j(nt,Ee){if(nt.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute test,remove -> remove,test for same path");return Ee.op==="test"||Ee.op==="replace"?[Ee,nt]:_(nt,Ee)}function K(nt,Ee,ct){var Nt=L(nt,Ee.path,ct.findContext,Ee.context);if(Ke(Nt))throw new P("path does not exist "+Ee.path);if(Ee.value===void 0)throw new P("missing value");var Re=u(Ee.value);return Nt.key===void 0?Re:(Q(Nt,Re),nt)}function Q(nt,Ee){var ct=nt.target;if(Array.isArray(ct))if(nt.key==="-")ct.push(Ee);else{if(nt.key>ct.length)throw new P("target of add outside of array bounds");ct.splice(nt.key,0,Ee)}else if(mt(ct))ct[nt.key]=Ee;else throw new P("target of add must be an object or array "+nt.key)}function re(nt,Ee){var ct=Ee.context;return ct!==void 0&&(ct={before:ct.before,after:S.cons(Ee.value,ct.after)}),nt.push({op:"test",path:Ee.path,value:Ee.value,context:ct}),nt.push({op:"remove",path:Ee.path,context:ct}),1}function ae(nt,Ee){if(nt.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute add,remove -> remove,add for same path");return _(nt,Ee)}function ue(nt,Ee,ct){var Nt=L(nt,Ee.path,ct.findContext,Ee.context);if(Ke(Nt)||Yt(Nt))throw new P("path does not exist "+Ee.path);if(Ee.value===void 0)throw new P("missing value");var Re=u(Ee.value);if(Nt.key===void 0)return Re;var it=Nt.target;return Array.isArray(it)?it[z(Nt.key)]=Re:it[Nt.key]=Re,nt}function ye(nt,Ee,ct,Nt){var Re=Nt[ct-1];if(Re===void 0||Re.op!=="test"||Re.path!==Ee.path)throw new k("cannot invert replace w/o test");var it=Re.context;return it!==void 0&&(it={before:it.before,after:S.cons(Re.value,S.tail(it.after))}),nt.push({op:"test",path:Re.path,value:Ee.value}),nt.push({op:"replace",path:Re.path,value:Re.value}),2}function Ae(nt,Ee){if(nt.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute replace,remove -> remove,replace for same path");return Ee.op==="test"||Ee.op==="replace"?[Ee,nt]:_(nt,Ee)}function Ce(nt,Ee,ct){var Nt=L(nt,Ee.path,ct.findContext,Ee.context);if(Ke(Nt)||Nt.target[Nt.key]===void 0)throw new P("path does not exist "+Ee.path);return Se(Nt),nt}function Se(nt){var Ee=nt.target,ct;if(Array.isArray(Ee))return ct=Ee.splice(z(nt.key),1),ct[0];if(mt(Ee))return ct=Ee[nt.key],delete Ee[nt.key],ct;throw new P("target of remove must be an object or array")}function ft(nt,Ee,ct,Nt){var Re=Nt[ct-1];if(Re===void 0||Re.op!=="test"||Re.path!==Ee.path)throw new k("cannot invert remove w/o test");var it=Re.context;return it!==void 0&&(it={before:it.before,after:S.tail(it.after)}),nt.push({op:"add",path:Re.path,value:Re.value,context:it}),2}function ke(nt,Ee){return nt.path===Ee.path&&Ee.op==="remove"?[Ee,nt]:_(nt,Ee)}function be(nt,Ee,ct){if(l.contains(Ee.path,Ee.from))throw new P("move.from cannot be ancestor of move.path");var Nt=L(nt,Ee.path,ct.findContext,Ee.context),Re=L(nt,Ee.from,ct.findContext,Ee.fromContext);return Q(Nt,Se(Re)),nt}function Ue(nt,Ee){return nt.push({op:"move",path:Ee.from,context:Ee.fromContext,from:Ee.path,fromContext:Ee.context}),1}function Ze(nt,Ee){if(nt.path===Ee.path&&Ee.op==="remove")throw new TypeError("Can't commute move,remove -> move,replace for same path");return _(nt,Ee)}function ze(nt,Ee,ct){var Nt=L(nt,Ee.path,ct.findContext,Ee.context),Re=L(nt,Ee.from,ct.findContext,Ee.fromContext);if(Ke(Re)||Yt(Re))throw new P("copy.from must exist");var it=Re.target,Ht;return Array.isArray(it)?Ht=it[z(Re.key)]:Ht=it[Re.key],Q(Nt,u(Ht)),nt}function Ft(nt,Ee){throw new k("cannot invert "+Ee.op)}function Ke(nt){return nt===void 0||nt.target==null&&nt.key!==void 0}function Yt(nt){return nt.key!==void 0&&nt.target[nt.key]===void 0}function mt(nt){return nt!==null&&typeof nt=="object"}}),uAe=ne(o=>{var l=fme(),u=ume(),m=iz();o.apply=S,o.applyInPlace=M,o.clone=u,o.isValidObject=k,o.defaultHash=P;var _={};function S(z,$,H){return M(z,u($),H)}function M(z,$,H){if(H||(H=_),!Array.isArray(z))return $;for(var j,K,Q=0;Q<z.length;++Q){if(K=z[Q],j=l[K.op],j===void 0)throw new m("invalid op "+JSON.stringify(K));$=j.apply($,K,H)}return $}function P(z){return k(z)||L(z)?JSON.stringify(z):z}function k(z){return z!==null&&Object.prototype.toString.call(z)==="[object Object]"}function L(z){return Object.prototype.toString.call(z)==="[object Array]"}}),dAe=ne((o,l)=>{var u=fme();l.exports=function(_){var S=[],M,P;for(M=_.length-1;M>=0;M-=P)P=m(S,_[M],M,_);return S};function m(_,S,M,P){var k=u[S.op];return k!==void 0&&typeof k.inverse=="function"?k.inverse(_,S,M,P):1}}),hAe=ne(o=>{var l=oAe(),u=cme(),m=uAe(),_=dAe(),S=rz(),M=S.encodeSegment;o.diff=L,o.patch=m.apply,o.patchInPlace=m.applyInPlace,o.inverse=_,o.clone=m.clone,o.InvalidPatchOperationError=iz(),o.TestFailedError=dme(),o.PatchNotInvertibleError=hme();var P=m.isValidObject,k=m.defaultHash;function L(ye,Ae,Ce){return $(ye,Ae,"",z(Ce,[])).patch}function z(ye,Ae){return typeof ye=="object"?{patch:Ae,hash:re(ue,ye.hash,k),makeContext:re(ue,ye.makeContext,ae),invertible:ye.invertible!==!1}:{patch:Ae,hash:re(ue,ye,k),makeContext:ae,invertible:!0}}function $(ye,Ae,Ce,Se){return Array.isArray(ye)&&Array.isArray(Ae)?j(ye,Ae,Ce,Se):P(ye)&&P(Ae)?H(ye,Ae,Ce,Se):Q(ye,Ae,Ce,Se)}function H(ye,Ae,Ce,Se){var ft=Object.keys(Ae),ke=Se.patch,be,Ue;for(be=ft.length-1;be>=0;--be){Ue=ft[be];var Ze=Ce+"/"+M(Ue);ye[Ue]!==void 0?$(ye[Ue],Ae[Ue],Ze,Se):ke.push({op:"add",path:Ze,value:Ae[Ue]})}for(ft=Object.keys(ye),be=ft.length-1;be>=0;--be)if(Ue=ft[be],Ae[Ue]===void 0){var ze=Ce+"/"+M(Ue);Se.invertible&&ke.push({op:"test",path:ze,value:ye[Ue]}),ke.push({op:"remove",path:ze})}return Se}function j(ye,Ae,Ce,Se){var ft=u.map(Se.hash,ye),ke=u.map(Se.hash,Ae),be=l.compare(ft,ke);return K(ye,Ae,Ce,Se,be)}function K(ye,Ae,Ce,Se,ft){var ke=0;return l.reduce(function(be,Ue,Ze,ze){var Ft,Ke,Yt=be.patch,mt=Ce+"/"+(ze+ke);return Ue===l.REMOVE?(Ft=Yt[Yt.length-1],Ke=be.makeContext(ze,ye),be.invertible&&Yt.push({op:"test",path:mt,value:ye[ze],context:Ke}),Ft!==void 0&&Ft.op==="add"&&Ft.path===mt?(Ft.op="replace",Ft.context=Ke):Yt.push({op:"remove",path:mt,context:Ke}),ke-=1):Ue===l.ADD?(Yt.push({op:"add",path:mt,value:Ae[Ze],context:be.makeContext(ze,ye)}),ke+=1):$(ye[ze],Ae[Ze],mt,be),be},Se,ft)}function Q(ye,Ae,Ce,Se){return ye!==Ae&&(Se.invertible&&Se.patch.push({op:"test",path:Ce,value:ye}),Se.patch.push({op:"replace",path:Ce,value:Ae})),Se}function re(ye,Ae,Ce){return ye(Ae)?Ae:Ce}function ae(){}function ue(ye){return typeof ye=="function"}}),i8=ne((o,l)=>{function u(m,_){for(var S=0,M=_.length-1;S<M;S++){if(!m[_[S]])return null;m=m[_[S]]}return m}l.exports=u}),w9=ne((o,l)=>{function u(_){return _==="~0"?"~":"/"}function m(_){var S=_.split("/");if(_.indexOf("~")===-1)return S;for(var M=0,P=S.length;M<P;M++)S[M].indexOf("~")!==-1&&(S[M]=S[M].replace(/~[01]/g,u));return S}l.exports=m}),fAe=ne((o,l)=>{var u=i8(),m=w9();function _(S,M){var P=m(M),k=P[P.length-1],L=u(S,P);return L?L[k]:void 0}l.exports=_}),YP=ne((o,l)=>{function u(m,_){if(m===_)return!0;if(!(m&&_)||typeof m!="object"||typeof _!="object"||m.length!==_.length)return!1;if(Array.isArray(m)){if(!Array.isArray(_))return!1;for(var S=0,M=m.length;S<M;S++)if(!u(m[S],_[S]))return!1;return!0}var P=Object.keys(m);if(P.length!==Object.keys(_).length)return!1;for(var k=0,L=P.length;k<L;k++){var z=P[k];if(!u(m[z],_[z]))return!1}return!0}l.exports=u}),KP=ne((o,l)=>{function u(m,_){if(_==="-")return m.length;for(var S=0,M=_.length;S<M;S++){var P=_.charCodeAt(S);if(57<P||P<48)return 1/0}return+_}l.exports=u}),ZP=ne((o,l)=>{var u=YP(),m=i8(),_=KP(),S=w9();function M(P,k,L,z){if(typeof L>"u")return"[op:add] require value, but got undefined";var $=S(k),H=$[$.length-1],j=m(P,$);if(j===null)return"[op:add] path not found: "+k;if(Array.isArray(j)){var K=_(j,H);if(j.length<K)return"[op:add] invalid array index: "+k;z(P,$).splice(K,0,L)}else u(j[H],L)||(z(P,$)[H]=L)}l.exports=M}),pme=ne((o,l)=>{var u=i8(),m=KP(),_=w9();function S(M,P,k){var L=_(P),z=L[L.length-1],$=u(M,L);if($===null)return"[op:remove] path not found: "+P;if(Array.isArray($)){var H=m($,z);if($.length<=H)return"[op:remove] invalid array index: "+P;k(M,L).splice(H,1)}else delete k(M,L)[z]}l.exports=S}),mme=ne((o,l)=>{var u=YP(),m=i8(),_=KP(),S=w9();function M(P,k,L,z){if(typeof L>"u")return"[op:replace] require value, but got undefined";var $=S(k),H=$[$.length-1],j=m(P,$);if(j===null)return"[op:replace] path not found: "+k;if(Array.isArray(j)){var K=_(j,H);if(j.length<=K)return"[op:replace] invalid array index: "+k;u(j[K],L)||z(P,$).splice(K,1,L)}else u(j[H],L)||(z(P,$)[H]=L)}l.exports=M}),gme=ne((o,l)=>{var u=ZP(),m=i8(),_=KP(),S=w9();function M(P,k,L,z){if(L!==k){var $=S(k),H=$[$.length-1],j=m(P,$);if(j===null)return"[op:move] path not found: "+k;var K=void 0;if(Array.isArray(j)){var Q=_(j,H);if(j.length<=Q)return"[op:move] invalid array index: "+L;K=j[Q],z(P,$).splice(Q,1)}else K=j[H],delete z(P,$)[H];return u(P,L,K,z)}}l.exports=M}),vme=ne((o,l)=>{var u=i8(),m=w9(),_=ZP();function S(M,P,k,L){var z=m(P),$=z[z.length-1],H=u(M,z);return H===null?"[op:copy] path not found: "+P:_(M,k,H[$],L)}l.exports=S}),yme=ne((o,l)=>{var u=YP(),m=i8(),_=w9();function S(M,P,k){var L=_(P),z=L[L.length-1],$=m(M,L);if($===null)return"[op:test] path not found: "+P;if(!u($[z],k)){var H=JSON.stringify($[z]),j=JSON.stringify(k);return"[op:test] not matched: "+H+" "+j}}l.exports=S}),sz=ne((o,l)=>{function u(m){if(!m||typeof m!="object")return m;if(Array.isArray(m)){for(var _=m.length,S=new Array(_),M=0;M<_;M++)S[M]=m[M];return S}for(var P=Object.keys(m),k={},L=0,z=P.length;L<z;L++){var $=P[L];k[$]=m[$]}return k}l.exports=u}),pAe=ne((o,l)=>{var u=fAe(),m=ZP(),_=pme(),S=mme(),M=gme(),P=vme(),k=yme(),L=YP(),z=sz(),$=w9();function H(j,K){return{get:function(Q){return u(j,Q)},add:function(Q,re){return m(j,Q,re,K)},remove:function(Q){return _(j,Q,K)},replace:function(Q,re){return S(j,Q,re,K)},move:function(Q,re){return M(j,Q,re,K)},copy:function(Q,re){return P(j,Q,re,K)},test:function(Q,re){return k(j,Q,re)},deepEqual:L,shallowCopy:z,toKeys:$}}l.exports=H}),mAe=ne((o,l)=>{function u(m,_,S,M){return M.error=S,M.partial?_[""]:m}l.exports=u}),gAe=ne((o,l)=>{function u(m){return!!m}l.exports=u}),vAe=ne((o,l)=>{function u(m){if(m)throw new TypeError(m)}l.exports=u}),yAe=ne((o,l)=>{var u=sz();function m(_,S){for(var M=0,P=S.length-1;M<P;M++)_=_[S[M]]=u(_[S[M]]);return _}l.exports=m}),_Ae=ne((o,l)=>{var u=sz();function m(S,M,P){var k=S[M];return P.has(k)||(k=u(k),P.add(k)),k}function _(S,M,P){for(var k=0,L=M.length-1;k<L;k++)S=S[M[k]]=m(S,M[k],P);return S}l.exports=_}),xAe=ne((o,l)=>{var u=pAe(),m=mAe(),_=gAe(),S=vAe(),M=yAe(),P=_Ae(),k=ZP(),L=pme(),z=mme(),$=gme(),H=vme(),j=yme(),K=Set||function(){var re=[];return re.has=function(ae){return this.indexOf(ae)!==-1},re.add=function(ae){this.push(ae)},re};function Q(re,ae,ue){if(ae.length===0)return re;ue=ue||{};for(var ye=ue.strict?S:_,Ae=ae.length===1?M:function(Ue){return function(Ze,ze){return P(Ze,ze,Ue)}}(new K),Ce={"":re},Se,ft=0,ke=ae.length;ft<ke;ft++){var be=ae[ft];switch(be.op){case"add":if(ye(k(Ce,""+be.path,be.value,Ae)))return m(re,Ce,be,ue);break;case"remove":if(ye(L(Ce,""+be.path,Ae)))return m(re,Ce,be,ue);break;case"replace":if(ye(z(Ce,""+be.path,be.value,Ae)))return m(re,Ce,be,ue);break;case"move":if(ye($(Ce,""+be.from,""+be.path,Ae)))return m(re,Ce,be,ue);break;case"copy":if(ye(H(Ce,""+be.from,""+be.path,Ae)))return m(re,Ce,be,ue);break;case"test":if(ye(j(Ce,""+be.path,be.value)))return m(re,Ce,be,ue);break;default:if(ue.custom&&ue.custom[be.op]){if(Se=Se||u(Ce,Ae),ye(ue.custom[be.op](Se,be,ft,ae)))return m(re,Ce,be,ue)}else return ye("[op:"+be.op+"] unknown"),m(re,Ce,be,ue);break}}return Ce[""]}l.exports=Q}),bAe=ne((o,l)=>{l.exports=xAe()}),SAe=ne((o,l)=>{(function(u,m){typeof o=="object"&&typeof l=="object"?l.exports=m():typeof o=="object"?o.blobCompare=m():u.blobCompare=m()})(window,function(){return function(u){var m={};function _(S){if(m[S])return m[S].exports;var M=m[S]={i:S,l:!1,exports:{}};return u[S].call(M.exports,M,M.exports,_),M.l=!0,M.exports}return _.m=u,_.c=m,_.d=function(S,M,P){_.o(S,M)||Object.defineProperty(S,M,{enumerable:!0,get:P})},_.r=function(S){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(S,"__esModule",{value:!0})},_.t=function(S,M){if(1&M&&(S=_(S)),8&M||4&M&&typeof S=="object"&&S&&S.__esModule)return S;var P=Object.create(null);if(_.r(P),Object.defineProperty(P,"default",{enumerable:!0,value:S}),2&M&&typeof S!="string")for(var k in S)_.d(P,k,(function(L){return S[L]}).bind(null,k));return P},_.n=function(S){var M=S&&S.__esModule?function(){return S.default}:function(){return S};return _.d(M,"a",M),M},_.o=function(S,M){return Object.prototype.hasOwnProperty.call(S,M)},_.p="",_(_.s=4)}([function(u,m,_){var S=function(z,$){if(Array.isArray(z))return z;if(Symbol.iterator in Object(z))return function(H,j){var K=[],Q=!0,re=!1,ae=void 0;try{for(var ue,ye=H[Symbol.iterator]();!(Q=(ue=ye.next()).done)&&(K.push(ue.value),!j||K.length!==j);Q=!0);}catch(Ae){re=!0,ae=Ae}finally{try{!Q&&ye.return&&ye.return()}finally{if(re)throw ae}}return K}(z,$);throw new TypeError("Invalid attempt to destructure non-iterable instance")},M=function(){function z($,H){for(var j=0;j<H.length;j++){var K=H[j];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty($,K.key,K)}}return function($,H,j){return H&&z($.prototype,H),j&&z($,j),$}}();function P(z){if(Array.isArray(z)){for(var $=0,H=Array(z.length);$<z.length;$++)H[$]=z[$];return H}return Array.from(z)}var k=_(2),L=function(z){function $(H){(function(K,Q){if(!(K instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,$);var j=function(K,Q){if(!K)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!Q||typeof Q!="object"&&typeof Q!="function"?K:Q}(this,($.__proto__||Object.getPrototypeOf($)).call(this));return j._messageId=1,j._messages=new Map,j._worker=H,j._worker.onmessage=j._onMessage.bind(j),j._id=Math.ceil(1e7*Math.random()),j}return function(H,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);H.prototype=Object.create(j&&j.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(H,j):H.__proto__=j)}($,z),M($,[{key:"terminate",value:function(){this._worker.terminate()}},{key:"isFree",value:function(){return this._messages.size===0}},{key:"jobsLength",value:function(){return this._messages.size}},{key:"exec",value:function(H){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,K=this,Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],re=arguments[3];return new Promise(function(ae,ue){var ye=K._messageId++;K._messages.set(ye,[ae,ue,re]),K._worker.postMessage([ye,j,H],Q||[])})}},{key:"postMessage",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,j=this,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Q=arguments[2];return new Promise(function(re,ae){var ue=j._messageId++;j._messages.set(ue,[re,ae,Q]),j._worker.postMessage([ue,H],K||[])})}},{key:"emit",value:function(H){for(var j=arguments.length,K=Array(j>1?j-1:0),Q=1;Q<j;Q++)K[Q-1]=arguments[Q];this._worker.postMessage({eventName:H,args:K})}},{key:"_onMessage",value:function(H){var j;if(!Array.isArray(H.data)&&H.data.eventName)return(j=function ue(ye,Ae,Ce){ye===null&&(ye=Function.prototype);var Se=Object.getOwnPropertyDescriptor(ye,Ae);if(Se===void 0){var ft=Object.getPrototypeOf(ye);return ft===null?void 0:ue(ft,Ae,Ce)}if("value"in Se)return Se.value;var ke=Se.get;return ke!==void 0?ke.call(Ce):void 0}($.prototype.__proto__||Object.getPrototypeOf($.prototype),"emit",this)).call.apply(j,[this,H.data.eventName].concat(P(H.data.args)));var K,Q=(K=H.data,Array.isArray(K)?K:Array.from(K)),re=Q[0],ae=Q.slice(1);if(re===1)this._onEvent.apply(this,P(ae));else{if(re!==0)throw new Error("Wrong message type '"+re+"'");this._onResult.apply(this,P(ae))}}},{key:"_onResult",value:function(H,j,K){var Q=this._messages.get(H),re=S(Q,2),ae=re[0],ue=re[1];return this._messages.delete(H),j===1?ae(K):ue(K)}},{key:"_onEvent",value:function(H,j,K){var Q=this._messages.get(H),re=S(Q,3)[2];re&&re(j,K)}}]),$}(k);u.exports=L},function(u,m,_){u.exports=function(){return _(3)(`!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=r(1),c=0,l=1,s=0,y=1,p="main",b=function(e){return"object"===(void 0===e?"undefined":i(e))&&"function"==typeof e.then&&"function"==typeof e.catch};var v=function e(t,r){u(this,e),this.payload=t,this.transferable=r};e.exports=function(e){var t,r,i,h=(i=e,(r=p)in(t={})?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t),d=self.postMessage.bind(self),m=new(function(e){function t(){return u(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return d({eventName:e,args:r}),this}},{key:"emitLocally",value:function(e){for(var r,n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];(r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"emit",this)).call.apply(r,[this,e].concat(i))}},{key:"operation",value:function(e,t){return h[e]=t,this}}]),t}(f)),g=function(e,t,r){var n=function(t){t&&t instanceof v?w(e,y,t.payload,t.transferable):w(e,y,t)},o=function(t){w(e,s,{message:t.message,stack:t.stack})};try{var i=_(e,t,r);b(i)?i.then(n).catch(o):n(i)}catch(e){o(e)}},_=function(e,t,r){var n=h[r||p];if(!n)throw new Error("Not found handler for this request");return n(t,O.bind(null,e))},w=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];d([c,e,t,r],n)},O=function(e,t,r){if(!t)throw new Error("eventName is required");if("string"!=typeof t)throw new Error("eventName should be string");d([l,e,t,r])};return self.addEventListener("message",(function(e){var t=e.data;Array.isArray(t)?g.apply(void 0,a(t)):t&&t.eventName&&m.emitLocally.apply(m,[t.eventName].concat(a(t.args)))})),m},e.exports.TransferableResponse=v},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return n(e,[{key:"emit",value:function(e){if(!this.__listeners[e])return this;for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=!0,i=!1,a=void 0;try{for(var u,f=this.__listeners[e][Symbol.iterator]();!(o=(u=f.next()).done);o=!0){var c=u.value;c.apply(void 0,r)}}catch(e){i=!0,a=e}finally{try{!o&&f.return&&f.return()}finally{if(i)throw a}}return this}},{key:"once",value:function(e,t){var r=this,n=function n(){r.off(e,n),t.apply(void 0,arguments)};return this.on(e,n)}},{key:"on",value:function(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}},{key:"off",value:function(e,t){return this.__listeners[e]=t?this.__listeners[e].filter((function(e){return e!==t})):[],this}}]),e}();e.exports=o},function(e,t,r){"use strict";r.r(t);var n=r(0);r.n(n)()().operation("binary",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsBinaryString(a)})}(e,t)).operation("buffer",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsArrayBuffer(a)})}(e,t)).operation("compare",({buf1:e,buf2:t})=>(function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e),n=new DataView(t);for(var o=e.byteLength;o--;)if(r.getUint8(o)!==n.getUint8(o))return!1;return!0})(e,t))}]);`,null)}},function(u,m,_){var S=function(){function P(k,L){for(var z=0;z<L.length;z++){var $=L[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(k,$.key,$)}}return function(k,L,z){return L&&P(k.prototype,L),z&&P(k,z),k}}(),M=function(){function P(){(function(k,L){if(!(k instanceof L))throw new TypeError("Cannot call a class as a function")})(this,P),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return S(P,[{key:"emit",value:function(k){if(!this.__listeners[k])return this;for(var L=arguments.length,z=Array(L>1?L-1:0),$=1;$<L;$++)z[$-1]=arguments[$];var H=!0,j=!1,K=void 0;try{for(var Q,re=this.__listeners[k][Symbol.iterator]();!(H=(Q=re.next()).done);H=!0){var ae=Q.value;ae.apply(void 0,z)}}catch(ue){j=!0,K=ue}finally{try{!H&&re.return&&re.return()}finally{if(j)throw K}}return this}},{key:"once",value:function(k,L){var z=this,$=function H(){z.off(k,H),L.apply(void 0,arguments)};return this.on(k,$)}},{key:"on",value:function(k,L){return this.__listeners[k]||(this.__listeners[k]=[]),this.__listeners[k].push(L),this}},{key:"off",value:function(k,L){return this.__listeners[k]=L?this.__listeners[k].filter(function(z){return z!==L}):[],this}}]),P}();u.exports=M},function(u,m,_){var S=window.URL||window.webkitURL;u.exports=function(M,P){try{try{var k;try{(k=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(M),k=k.getBlob()}catch{k=new Blob([M])}return new Worker(S.createObjectURL(k))}catch{return new Worker("data:application/javascript,"+encodeURIComponent(M))}}catch{if(!P)throw Error("Inline worker is not supported");return new Worker(P)}}},function(u,m,_){_.r(m);var S=_(0),M=_.n(S),P=_(1),k=_.n(P);_.d(m,"workersEnabled",function(){return L}),_.d(m,"default",function(){return z});let L=!!window.Worker;class z{static toBinaryStringWithWorker(H,j){return De(this,null,function*(){let K=new M.a(new k.a),Q=yield K.exec("binary",{blob:H,chunk:j});return K.terminate(),Q})}static toBinaryStringWithoutWorker(H,j){return function(K,Q){return new Promise((re,ae)=>{let ue=new FileReader,ye=Q?Math.min(Q,K.size):K.size,Ae=K.slice(0,ye);ue.onload=()=>re(ue.result),ue.onerror=ae,ue.readAsBinaryString(Ae)})}(H,j)}static toBinaryString(H,j,K=!0){return K&&L?this.toBinaryStringWithWorker(H,j):this.toBinaryStringWithoutWorker(H,j)}static toArrayBufferWithWorker(H,j){return De(this,null,function*(){let K=new M.a(new k.a),Q=yield K.exec("buffer",{blob:H,chunk:j});return K.terminate(),Q})}static toArrayBufferWithoutWorker(H,j){return function(K,Q){return new Promise((re,ae)=>{let ue=new FileReader,ye=Q?Math.min(Q,K.size):K.size,Ae=K.slice(0,ye);ue.onload=()=>re(ue.result),ue.onerror=ae,ue.readAsArrayBuffer(Ae)})}(H,j)}static toArrayBuffer(H,j,K=!0){return K&&L?this.toArrayBufferWithWorker(H,j):this.toArrayBufferWithoutWorker(H,j)}static compareBuffersWithWorker(H,j){return De(this,null,function*(){if(H===j)return!0;let K=new M.a(new k.a),Q=yield K.exec("compare",{buf1:H,buf2:j},[H,j]);return K.terminate(),Q})}static compareBuffersWithoutWorker(H,j){return function(K,Q){if(K===Q)return!0;if(K.byteLength!==Q.byteLength)return!1;let re=new DataView(K),ae=new DataView(Q);for(var ue=K.byteLength;ue--;)if(re.getUint8(ue)!==ae.getUint8(ue))return!1;return!0}(H,j)}static compareBuffers(H,j,K=!0){return K&&L?this.compareBuffersWithWorker(H,j):this.compareBuffersWithoutWorker(H,j)}static sizeEqual(H,j){return H.size===j.size}static typeEqual(H,j){return H.type===j.type}static magicNumbersEqual(H,j,K=!0){return De(this,null,function*(){if(H===j)return!0;let Q=[24,16,14,12,8,6,4],[re,ae]=yield Promise.all([this.toBinaryString(H,24,K),this.toBinaryString(j,24,K)]);for(let ue of Q)if(re.substring(0,ue)===ae.substring(0,ue))return!0;return!1})}static bytesEqualWithBinaryString(H,j,K,Q=!0){return De(this,null,function*(){if(H===j)return!0;let[re,ae]=yield Promise.all([this.toBinaryString(H,K,Q),this.toBinaryString(j,K,Q)]);return re===ae})}static bytesEqualWithArrayBuffer(H,j,K,Q=!0){return De(this,null,function*(){if(H===j)return!0;let[re,ae]=yield Promise.all([this.toArrayBuffer(H,K,Q),this.toArrayBuffer(j,K,Q)]);return this.compareBuffers(re,ae,Q)})}static isEqual(H,j){return De(this,arguments,function*(K,Q,{methods:re=["size","type","magic","byte"],byte:ae="buffer",partial:ue=!1,chunks:ye=null,worker:Ae=!0}={}){let Ce=null;for(let Se of re){if(Ce===!1||ue&&Ce===!0)break;switch(Se){case"byte":case"bytes":case"content":ye=ye instanceof Array?ye:[K.size],Ce=!0;for(let ft of ye){let ke=!1;ke=ae==="buffer"?yield this.bytesEqualWithArrayBuffer(K,Q,ft,Ae):yield this.bytesEqualWithBinaryString(K,Q,ft,Ae),ke||(Ce=!1)}break;case"magic":case"headers":case"numbers":case"mime":Ce=yield this.magicNumbersEqual(K,Q,Ae);break;case"size":case"sizes":Ce=this.sizeEqual(K,Q);break;case"type":case"types":Ce=this.typeEqual(K,Q);break;default:throw new Error("Blob-compare : Unknown comparison method")}}return Ce})}}}])})}),_me={};se(_me,{ToolbarDropdownSelect:()=>WPe,default:()=>$Pe}),i.exports=ie(_me),Ie();function QP(o,l,u=[]){if(typeof o=="object"&&o){if(wAe(o)||TAe(o)){l(o,u);return}for(let[m,_]of Object.entries(o))QP(_,l,[...u,m])}else{if(o==null)return;l(o,u)}}var wAe=o=>typeof o=="object"&&o!==null&&Object.hasOwnProperty.call(o,"type")&&o.type==="image"&&Object.hasOwnProperty.call(o,"id")&&typeof o.id=="string"&&o.id!=="",TAe=o=>typeof o=="object"&&o!==null&&Object.hasOwnProperty.call(o,"r")&&Object.hasOwnProperty.call(o,"g")&&Object.hasOwnProperty.call(o,"b")&&Object.hasOwnProperty.call(o,"a")&&typeof o.r=="number"&&typeof o.g=="number"&&typeof o.b=="number"&&typeof o.a=="number",xme=an();$t();var EAe=0,MAe=class{constructor(o){this._studio=o,Me(this,"_id"),Me(this,"_state",{type:"Ready"}),this._id=String(EAe++)}get status(){return this._state.type}reset(){let{_state:o}=this;if(o.type!=="Ready")if(o.type==="Captured")this._state={type:"Ready"},o.transaction.discard(),o.flagsTransaction.discard();else throw o.type==="Committed"?new Error("This scrub is already committed and can't be reset."):new Error("This scrub is already discarded and can't be reset.")}commit(){let{_state:o}=this;if(o.type==="Captured")o.transaction.commit(),o.flagsTransaction.discard(),this._state={type:"Committed"};else if(o.type==="Ready"){console.warn("Scrub is empty. Nothing to commit.");return}else throw o.type==="Committed"?new Error("This scrub is already committed."):new Error("This scrub is already discarded and can't be comitted.")}capture(o){if(this._state.type==="Captured"&&this.reset(),this._state.type==="Ready"){let l=!0;try{this._state=R({type:"Captured"},this._capture(o)),l=!1}finally{l&&(console.error("This scrub's callback threw an error. We're undo-ing all of the changes made by this scrub, and marking it as discarded."),this._state={type:"Discarded"})}}else throw this._state.type==="Committed"?new Error("This scrub is already committed and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.commit()"):new Error("This scrub is already discarded and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.discard()")}_capture(o){let l=[],u=this._studio.tempTransaction(_=>{let S=!0,M={set:(P,k)=>{if(!S)throw new Error("You seem to have called the scrub api after scrub.capture()");let{root:L,path:z}=(0,xme.getPointerParts)(P);if(!Ot(L))throw new Error("We can only scrub props of Sheet Objects for now");_.set(P,k),l.push(P)}};try{o(M)}finally{S=!1}}),m=this._studio.tempTransaction(({stateEditors:_})=>{l.forEach(S=>{let{root:M,path:P}=(0,xme.getPointerParts)(S);if(!Ot(M))return;let k=M.template.getDefaultsAtPointer(S);QP(k,(L,z)=>{_.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey.propsBeingScrubbed.flag(B(R({},M.address),{pathToProp:z}))},P)})});return{transaction:u,flagsTransaction:m}}discard(){let{_state:o}=this;if(o.type==="Captured"||o.type==="Ready")o.type==="Captured"&&(o.transaction.discard(),o.flagsTransaction.discard()),this._state={type:"Discarded"};else throw o.type==="Committed"?new Error("This scrub is already committed and can't be discarded."):new Error("This scrub is already discarded")}},CAe=an(),bme=typeof window<"u"?Promise.resolve().then(()=>(sAe(),sme)).then(o=>o.default):null,AAe=class{constructor(o){this.studio=o,Me(this,"_rendered",!1),Me(this,"_nonSSRBits",bme?bme.then(l=>new l):Promise.reject()),Me(this,"ready",this._nonSSRBits.then(()=>{},()=>{}))}render(){this._rendered||(this._rendered=!0,this._nonSSRBits.then(o=>{o.render()}).catch(o=>{throw console.error(o),o}))}hide(){this.studio.transaction(({drafts:o})=>{o.ahistoric.visibilityState="everythingIsHidden"})}restore(){this.render(),this.studio.transaction(({drafts:o})=>{o.ahistoric.visibilityState="everythingIsVisible"})}get isHidden(){return(0,CAe.val)(this.studio.atomP.ahistoric.visibilityState)==="everythingIsHidden"}renderToolset(o,l){let u=!1,m=null;return this._nonSSRBits.then(_=>{u||(m=_.renderToolset(o,l))}).catch(_=>{console.error(_)}),()=>{if(m){m();return}u||(u=!0)}}},JP=an();function PAe(o){return o}var RAe=(o,l=PAe)=>{let u=m=>({type:o,payload:l(m)});return u.type=o,u.is=m=>m&&m.type&&m.type===o,u},A1=RAe,Sme=G(hAe()),wme=G(bAe());J3();var eR,IAe=new Uint8Array(16);function NAe(){if(!eR&&(eR=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!eR))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return eR(IAe)}var kAe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function DAe(o){return typeof o=="string"&&kAe.test(o)}var OAe=DAe,X0=[];for(tR=0;tR<256;++tR)X0.push((tR+256).toString(16).substr(1));var tR;function LAe(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=(X0[o[l+0]]+X0[o[l+1]]+X0[o[l+2]]+X0[o[l+3]]+"-"+X0[o[l+4]]+X0[o[l+5]]+"-"+X0[o[l+6]]+X0[o[l+7]]+"-"+X0[o[l+8]]+X0[o[l+9]]+"-"+X0[o[l+10]]+X0[o[l+11]]+X0[o[l+12]]+X0[o[l+13]]+X0[o[l+14]]+X0[o[l+15]]).toLowerCase();if(!OAe(u))throw TypeError("Stringified UUID is invalid");return u}var FAe=LAe;function UAe(o,l,u){o=o||{};var m=o.random||(o.rng||NAe)();if(m[6]=m[6]&15|64,m[8]=m[8]&63|128,l){u=u||0;for(var _=0;_<16;++_)l[u+_]=m[_];return l}return FAe(m)}var BAe=UAe,uw={replaceHistory:A1("@history/replaceHistory"),startHistoryFromScratch:A1("@history/startHistoryFromScratch"),undo:A1("@history/undo"),redo:A1("@history/redo")},zAe={type:"@history/unknownAction",payload:""},VAe={maxNumberOfCommits:100},GAe=(o,l=VAe)=>{let u=oz(o(void 0,zAe));return function(m,_){return uw.startHistoryFromScratch.is(_)?oz(o(void 0,_.payload)):uw.replaceHistory.is(_)?_.payload:uw.undo.is(_)?m?WAe(m):u:uw.redo.is(_)?m?qAe(m):u:m?jAe(m,o(m.innerState,_),l):oz(o(void 0,_))}};function oz(o){return{currentCommitHash:void 0,commitsByHash:{},listOfCommitHashes:[],innerState:o}}function jAe(o,l,u){if(l===o.innerState)return o;let m=HAe(o.innerState,l);if(m.forwardDiff.length===0)return o;let _=Mg(o.listOfCommitHashes),S={currentCommitHash:m.hash,commitsByHash:R({},o.commitsByHash),listOfCommitHashes:[...o.listOfCommitHashes],innerState:l};if(o.currentCommitHash!==_){let M=o.listOfCommitHashes.findIndex(P=>P===o.currentCommitHash);o.listOfCommitHashes.slice(M+1).forEach(P=>{delete S.commitsByHash[P]}),S.listOfCommitHashes.splice(M+1,S.listOfCommitHashes.length)}if(S.listOfCommitHashes.push(m.hash),S.commitsByHash[m.hash]=m,S.listOfCommitHashes.length>u.maxNumberOfCommits){let M=S.listOfCommitHashes.length-u.maxNumberOfCommits;S.listOfCommitHashes.slice(0,M).forEach(P=>{delete S.commitsByHash[P]}),S.listOfCommitHashes.splice(0,M)}return S}function HAe(o,l){let u=Sme.default.diff(o,l,{invertible:!1}),m=Sme.default.diff(l,o,{invertible:!1}),_=Date.now(),S=BAe();return{forwardDiff:u,backwardDiff:m,timestamp:_,hash:S}}function WAe(o){if(o.currentCommitHash===void 0)return o;let l=o.listOfCommitHashes.findIndex(M=>M===o.currentCommitHash);if(l===-1)throw new Error("This should never happen");let u=o.commitsByHash[o.currentCommitHash],m=(0,wme.default)(o.innerState,u.backwardDiff),_=l-1,S=_===-1?void 0:o.listOfCommitHashes[_];return B(R({},o),{currentCommitHash:S,innerState:m})}function qAe(o){if(o.listOfCommitHashes.length===0)return o;let l=o.listOfCommitHashes.findIndex(M=>M===o.currentCommitHash);if(l===o.listOfCommitHashes.length-1)return o;let u=l+1,m=o.listOfCommitHashes[u],_=o.commitsByHash[m],S=(0,wme.default)(o.innerState,_.forwardDiff);return B(R({},o),{currentCommitHash:m,innerState:S})}_P();var nR={ahistoric:{visibilityState:"everythingIsVisible",theTrigger:{position:{closestCorner:"bottomLeft",distanceFromHorizontalEdge:.02,distanceFromVerticalEdge:.02}},coreByProject:{},projects:{stateByProjectId:{}}},historic:{projects:{stateByProjectId:{}},autoKey:!0,coreByProject:{},panels:{sequenceEditor:{rightPanelOpen:!0}},panelInstanceDesceriptors:{}},ephemeral:{initialised:!1,coreByProject:{},projects:{stateByProjectId:{}},extensions:{byId:{},paneClasses:{}},showOutline:!1}},Tme=A1("@storeBundle/replacePersistentState",o=>o),Eme=A1("@storeBundle/reduceParts",o=>o),k7={historic:uw,replacePersistentState:Tme,reduceParts:Eme},Mme=A1("@storeBundle/setInnerHistoricState",o=>o),$Ae=(o=nR.historic,l)=>Mme.is(l)?l.payload:o,az=GAe($Ae),Cme=(o,l)=>{if(Tme.is(l)){let{historic:u,ahistoric:m}=l.payload,_=(o==null?void 0:o.ephemeral)||nR.ephemeral;return{$persistent:{historic:u,ahistoric:m},ephemeral:_}}else if(o){let{historic:u,ahistoric:m}=o.$persistent,{ephemeral:_}=o;if(Eme.is(l)){let S={historic:o.$persistent.historic.innerState,ahistoric:o.$persistent.ahistoric,ephemeral:o.ephemeral},M=l.payload(S);if(M===S)return o;u.innerState!==M.historic&&(u=az(u,Mme(M.historic))),m=M.ahistoric,_=M.ephemeral}else{let S=az(u,l);if(S===u)return o;u=S}return{$persistent:u===o.$persistent.historic&&m===o.$persistent.ahistoric?o.$persistent:{historic:u,ahistoric:m},ephemeral:_}}else{let u=az(void 0,{}),m=nR.ahistoric,_=nR.ephemeral;return{$persistent:{historic:u,ahistoric:m},ephemeral:_}}},Ame=A1("@history/pushTempAction",o=>o),Pme=A1("@history/discardTempAction",o=>o),Rme=A1("@history/commitTempAction",o=>o),XAe=0,YAe=()=>{let o=XAe++;return{push:l=>Ame({id:o,originalAction:l}),discard:()=>Pme(o),commit:()=>Rme(o)}},KAe=(o,l)=>{if(o){let{tempActions:u,permanent:m}=o.$temps,_;if(Ame.is(l))u=[...u,l];else if(Rme.is(l)){let M=u.find(P=>P.payload.id===l.payload);M?(_=M.payload.originalAction,u=u.filter(P=>P.payload.id!==l.payload)):yP.error("Comitting temp action group ".concat(l.payload," isn't possible as this group doesn't exist"))}else Pme.is(l)?u=u.filter(M=>M.payload.id!==l.payload):_=l;_&&(m=Cme(o.$temps.permanent,_));let S={historic:m.$persistent.historic.innerState,ahistoric:m.$persistent.ahistoric,ephemeral:m.ephemeral};for(let M of u)S=M.payload.originalAction.payload(S);return R({$temps:{tempActions:u,permanent:m},$persistent:m.$persistent},S)}else{let u=Cme(void 0,l);return{$temps:{permanent:u,tempActions:[]},$persistent:u.$persistent,historic:u.$persistent.historic.innerState,ahistoric:u.$persistent.ahistoric,ephemeral:u.ephemeral}}};l9(),l9(),yf();function Ime(o,l){if(typeof o!="object"||o===null)return;if(l.length===0){for(let M of Object.keys(o))delete o[M];return}let u=l.slice(0,l.length-1),m=o,_=new WeakMap;for(let M of u){let P=m,k=P[M];if(typeof k!="object"||k===null)return;_.set(k,P),m=k}let S=l.slice().reverse();for(let M of S){if(delete m[M],Object.keys(m).length>0)return;m=_.get(m)}}function ZAe(o,{scale:l,origin:u,translate:m}){let _=u+(o-u)*l;return m+_}function Nf(o){for(var l=arguments.length,u=Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];throw Error("[Immer] minified error nr: "+o+(u.length?" "+u.map(function(_){return"'"+_+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function D7(o){return!!o&&!!o[ld]}function s8(o){return!!o&&(function(l){if(!l||typeof l!="object")return!1;var u=Object.getPrototypeOf(l);if(u===null)return!0;var m=Object.hasOwnProperty.call(u,"constructor")&&u.constructor;return m===Object||typeof m=="function"&&Function.toString.call(m)===iPe}(o)||Array.isArray(o)||!!o[Vme]||!!o.constructor[Vme]||cz(o)||uz(o))}function dw(o,l,u){u===void 0&&(u=!1),O7(o)===0?(u?Object.keys:Sz)(o).forEach(function(m){u&&typeof m=="symbol"||l(m,o[m],o)}):o.forEach(function(m,_){return l(_,m,o)})}function O7(o){var l=o[ld];return l?l.i>3?l.i-4:l.i:Array.isArray(o)?1:cz(o)?2:uz(o)?3:0}function lz(o,l){return O7(o)===2?o.has(l):Object.prototype.hasOwnProperty.call(o,l)}function QAe(o,l){return O7(o)===2?o.get(l):o[l]}function Nme(o,l,u){var m=O7(o);m===2?o.set(l,u):m===3?(o.delete(l),o.add(u)):o[l]=u}function JAe(o,l){return o===l?o!==0||1/o==1/l:o!=o&&l!=l}function cz(o){return nPe&&o instanceof Map}function uz(o){return rPe&&o instanceof Set}function o8(o){return o.o||o.t}function dz(o){if(Array.isArray(o))return Array.prototype.slice.call(o);var l=sPe(o);delete l[ld];for(var u=Sz(l),m=0;m<u.length;m++){var _=u[m],S=l[_];S.writable===!1&&(S.writable=!0,S.configurable=!0),(S.get||S.set)&&(l[_]={configurable:!0,writable:!0,enumerable:S.enumerable,value:o[_]})}return Object.create(Object.getPrototypeOf(o),l)}function hz(o,l){return l===void 0&&(l=!1),fz(o)||D7(o)||!s8(o)||(O7(o)>1&&(o.set=o.add=o.clear=o.delete=ePe),Object.freeze(o),l&&dw(o,function(u,m){return hz(m,!0)},!0)),o}function ePe(){Nf(2)}function fz(o){return o==null||typeof o!="object"||Object.isFrozen(o)}function qg(o){var l=oPe[o];return l||Nf(18,o),l}function kme(){return hw}function pz(o,l){l&&(qg("Patches"),o.u=[],o.s=[],o.v=l)}function rR(o){mz(o),o.p.forEach(tPe),o.p=null}function mz(o){o===hw&&(hw=o.l)}function Dme(o){return hw={p:[],l:hw,h:o,m:!0,_:0}}function tPe(o){var l=o[ld];l.i===0||l.i===1?l.j():l.O=!0}function gz(o,l){l._=l.p.length;var u=l.p[0],m=o!==void 0&&o!==u;return l.h.g||qg("ES5").S(l,o,m),m?(u[ld].P&&(rR(l),Nf(4)),s8(o)&&(o=iR(l,o),l.l||sR(l,o)),l.u&&qg("Patches").M(u[ld],o,l.u,l.s)):o=iR(l,u,[]),rR(l),l.u&&l.v(l.u,l.s),o!==zme?o:void 0}function iR(o,l,u){if(fz(l))return l;var m=l[ld];if(!m)return dw(l,function(S,M){return Ome(o,m,l,S,M,u)},!0),l;if(m.A!==o)return l;if(!m.P)return sR(o,m.t,!0),m.t;if(!m.I){m.I=!0,m.A._--;var _=m.i===4||m.i===5?m.o=dz(m.k):m.o;dw(m.i===3?new Set(_):_,function(S,M){return Ome(o,m,_,S,M,u)}),sR(o,_,!1),u&&o.u&&qg("Patches").R(m,u,o.u,o.s)}return m.o}function Ome(o,l,u,m,_,S){if(D7(_)){var M=iR(o,_,S&&l&&l.i!==3&&!lz(l.D,m)?S.concat(m):void 0);if(Nme(u,m,M),!D7(M))return;o.m=!1}if(s8(_)&&!fz(_)){if(!o.h.F&&o._<1)return;iR(o,_),l&&l.A.l||sR(o,_)}}function sR(o,l,u){u===void 0&&(u=!1),o.h.F&&o.m&&hz(l,u)}function vz(o,l){var u=o[ld];return(u?o8(u):o)[l]}function Lme(o,l){if(l in o)for(var u=Object.getPrototypeOf(o);u;){var m=Object.getOwnPropertyDescriptor(u,l);if(m)return m;u=Object.getPrototypeOf(u)}}function yz(o){o.P||(o.P=!0,o.l&&yz(o.l))}function _z(o){o.o||(o.o=dz(o.t))}function xz(o,l,u){var m=cz(l)?qg("MapSet").N(l,u):uz(l)?qg("MapSet").T(l,u):o.g?function(_,S){var M=Array.isArray(_),P={i:M?1:0,A:S?S.A:kme(),P:!1,I:!1,D:{},l:S,t:_,k:null,o:null,j:null,C:!1},k=P,L=aR;M&&(k=[P],L=lR);var z=Proxy.revocable(k,L),$=z.revoke,H=z.proxy;return P.k=H,P.j=$,H}(l,u):qg("ES5").J(l,u);return(u?u.A:kme()).p.push(m),m}function oR(o){return D7(o)||Nf(22,o),function l(u){if(!s8(u))return u;var m,_=u[ld],S=O7(u);if(_){if(!_.P&&(_.i<4||!qg("ES5").K(_)))return _.t;_.I=!0,m=Fme(u,S),_.I=!1}else m=Fme(u,S);return dw(m,function(M,P){_&&QAe(_.t,M)===P||Nme(m,M,l(P))}),S===3?new Set(m):m}(o)}function Fme(o,l){switch(l){case 2:return new Map(o);case 3:return Array.from(o)}return dz(o)}var Ume,hw,bz=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",nPe=typeof Map<"u",rPe=typeof Set<"u",Bme=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",zme=bz?Symbol.for("immer-nothing"):((Ume={})["immer-nothing"]=!0,Ume),Vme=bz?Symbol.for("immer-draftable"):"__$immer_draftable",ld=bz?Symbol.for("immer-state"):"__$immer_state",iPe=""+Object.prototype.constructor,Sz=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:Object.getOwnPropertyNames,sPe=Object.getOwnPropertyDescriptors||function(o){var l={};return Sz(o).forEach(function(u){l[u]=Object.getOwnPropertyDescriptor(o,u)}),l},oPe={},aR={get:function(o,l){if(l===ld)return o;var u=o8(o);if(!lz(u,l))return function(_,S,M){var P,k=Lme(S,M);return k?"value"in k?k.value:(P=k.get)===null||P===void 0?void 0:P.call(_.k):void 0}(o,u,l);var m=u[l];return o.I||!s8(m)?m:m===vz(o.t,l)?(_z(o),o.o[l]=xz(o.A.h,m,o)):m},has:function(o,l){return l in o8(o)},ownKeys:function(o){return Reflect.ownKeys(o8(o))},set:function(o,l,u){var m=Lme(o8(o),l);if(m!=null&&m.set)return m.set.call(o.k,u),!0;if(!o.P){var _=vz(o8(o),l),S=_==null?void 0:_[ld];if(S&&S.t===u)return o.o[l]=u,o.D[l]=!1,!0;if(JAe(u,_)&&(u!==void 0||lz(o.t,l)))return!0;_z(o),yz(o)}return o.o[l]===u&&typeof u!="number"&&(u!==void 0||l in o.o)||(o.o[l]=u,o.D[l]=!0,!0)},deleteProperty:function(o,l){return vz(o.t,l)!==void 0||l in o.t?(o.D[l]=!1,_z(o),yz(o)):delete o.D[l],o.o&&delete o.o[l],!0},getOwnPropertyDescriptor:function(o,l){var u=o8(o),m=Reflect.getOwnPropertyDescriptor(u,l);return m&&{writable:!0,configurable:o.i!==1||l!=="length",enumerable:m.enumerable,value:u[l]}},defineProperty:function(){Nf(11)},getPrototypeOf:function(o){return Object.getPrototypeOf(o.t)},setPrototypeOf:function(){Nf(12)}},lR={};dw(aR,function(o,l){lR[o]=function(){return arguments[0]=arguments[0][0],l.apply(this,arguments)}}),lR.deleteProperty=function(o,l){return aR.deleteProperty.call(this,o[0],l)},lR.set=function(o,l,u){return aR.set.call(this,o[0],l,u,o[0])};var aPe=function(){function o(u){var m=this;this.g=Bme,this.F=!0,this.produce=function(_,S,M){if(typeof _=="function"&&typeof S!="function"){var P=S;S=_;var k=m;return function(j){var K=this;j===void 0&&(j=P);for(var Q=arguments.length,re=Array(Q>1?Q-1:0),ae=1;ae<Q;ae++)re[ae-1]=arguments[ae];return k.produce(j,function(ue){var ye;return(ye=S).call.apply(ye,[K,ue].concat(re))})}}var L;if(typeof S!="function"&&Nf(6),M!==void 0&&typeof M!="function"&&Nf(7),s8(_)){var z=Dme(m),$=xz(m,_,void 0),H=!0;try{L=S($),H=!1}finally{H?rR(z):mz(z)}return typeof Promise<"u"&&L instanceof Promise?L.then(function(j){return pz(z,M),gz(j,z)},function(j){throw rR(z),j}):(pz(z,M),gz(L,z))}if(!_||typeof _!="object")return(L=S(_))===zme?void 0:(L===void 0&&(L=_),m.F&&hz(L,!0),L);Nf(21,_)},this.produceWithPatches=function(_,S){return typeof _=="function"?function(k){for(var L=arguments.length,z=Array(L>1?L-1:0),$=1;$<L;$++)z[$-1]=arguments[$];return m.produceWithPatches(k,function(H){return _.apply(void 0,[H].concat(z))})}:[m.produce(_,S,function(k,L){M=k,P=L}),M,P];var M,P},typeof(u==null?void 0:u.useProxies)=="boolean"&&this.setUseProxies(u.useProxies),typeof(u==null?void 0:u.autoFreeze)=="boolean"&&this.setAutoFreeze(u.autoFreeze)}var l=o.prototype;return l.createDraft=function(u){s8(u)||Nf(8),D7(u)&&(u=oR(u));var m=Dme(this),_=xz(this,u,void 0);return _[ld].C=!0,mz(m),_},l.finishDraft=function(u,m){var _=u&&u[ld],S=_.A;return pz(S,m),gz(void 0,S)},l.setAutoFreeze=function(u){this.F=u},l.setUseProxies=function(u){u&&!Bme&&Nf(20),this.g=u},l.applyPatches=function(u,m){var _;for(_=m.length-1;_>=0;_--){var S=m[_];if(S.path.length===0&&S.op==="replace"){u=S.value;break}}var M=qg("Patches").$;return D7(u)?M(u,m):this.produce(u,function(P){return M(P,m.slice(_+1))})},o}(),cd=new aPe;cd.produce,cd.produceWithPatches.bind(cd),cd.setAutoFreeze.bind(cd),cd.setUseProxies.bind(cd),cd.applyPatches.bind(cd);var wz=cd.createDraft.bind(cd),Tz=cd.finishDraft.bind(cd);rC(),xc(),Zr(),Bo(),p0(),pP(),V0(),$t();var Vo={create(o){let l={byId:{},allIds:{}};if(o)for(let[u,m]of o)l.byId[u]=m,l.allIds[u]=!0;return l},shallowCopy(o){return{byId:R({},o==null?void 0:o.byId),allIds:R({},o==null?void 0:o.allIds)}},add(o,l,u){return{byId:B(R({},o==null?void 0:o.byId),{[l]:u}),allIds:B(R({},o==null?void 0:o.allIds),{[l]:!0})}},merge(o){let l=Vo.create();for(let u=0;u<o.length;u++)l.byId=R(R({},l.byId),o[u].byId),l.allIds=R(R({},l.allIds),o[u].allIds);return l},remove(o,l){let u=Vo.shallowCopy(o);return delete u.allIds[l],delete u.byId[l],u},filter(o,l){let u=Vo.shallowCopy(o);for(let[m,_]of Object.entries(u.byId))l(_)||(delete u.allIds[m],delete u.byId[m]);return u}},Gme=o=>(Ez=o,Mz),Ez,Y0=()=>{if(Ez===void 0)throw new Error("Calling stateEditors outside of a transaction is not allowed.");return Ez},Mz;(o=>{(l=>{(u=>{(m=>{function _(S){let M=Y0().historic;M.panelPositions!=null||(M.panelPositions={}),M.panelPositions[S.panelId]=S.position}m.setPanelPosition=_})(u.panelPositions||(u.panelPositions={})),(m=>{function _(){var S;return(S=Y0().historic).panels!=null||(S.panels={}),Y0().historic.panels}m._ensure=_,(S=>{function M(){let P=o.studio.historic.panels._ensure();return P.outlinePanel!=null||(P.outlinePanel={}),P.outlinePanel}S._ensure=M,(P=>{function k(z){let $=[];for(let H of Ks(z))bt(H)?$.push(R({type:"Project"},H.address)):Ne(H)?($.push(R({type:"Sheet"},H.template.address)),o.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(H.address)):ht(H)?$.push(R({type:"Sheet"},H.address)):Ot(H)?($.push(R({type:"SheetObject"},H.template.address)),o.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(H.sheet.address)):bn(H)&&$.push(R({type:"SheetObject"},H.address));S._ensure().selection=$}P.set=k;function L(){S._ensure().selection=[]}P.unset=L})(S.selection||(S.selection={}))})(m.outline||(m.outline={})),(S=>{function M(){let z=o.studio.historic.panels._ensure();return z.sequenceEditor!=null||(z.sequenceEditor={}),z.sequenceEditor}S._ensure=M,(z=>{function $(){let j=S._ensure();return j.graphEditor!=null||(j.graphEditor={height:.5,isOpen:!1}),j.graphEditor}function H(j){$().isOpen=j.isOpen}z.setIsOpen=H})(S.graphEditor||(S.graphEditor={}));function P(z){let $=S._ensure();$.rightPanelOpen=z}S.setRightPanelOpen=P;function k(z){let $=S._ensure();$.dopesheetLeftWidth=z}S.setDopesheetLeftWidth=k;function L(){let z=S._ensure();return z.rightPanelOpen===void 0&&(z.rightPanelOpen=!0),z.rightPanelOpen}S._ensureRightPanelOpen=L})(m.sequenceEditor||(m.sequenceEditor={}))})(u.panels||(u.panels={})),(m=>{(_=>{function S(M){let P=Y0().historic;return P.projects.stateByProjectId[M.projectId]||(P.projects.stateByProjectId[M.projectId]={stateBySheetId:{}}),P.projects.stateByProjectId[M.projectId]}_._ensure=S,(M=>{function P(L){let z=o.studio.historic.projects.stateByProjectId._ensure(L);return z.stateBySheetId[L.sheetId]||(z.stateBySheetId[L.sheetId]={selectedInstanceId:void 0,sequenceEditor:{selectedPropsByObject:{}}}),z.stateBySheetId[L.sheetId]}M._ensure=P;function k(L){o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(L).selectedInstanceId=L.sheetInstanceId}M.setSelectedInstanceId=k,(L=>{function z(ke){let{selectedPropsByObject:be}=M._ensure(ke).sequenceEditor;be[ke.objectKey]||(be[ke.objectKey]={});let Ue=be[ke.objectKey],Ze=Ef(ke.pathToProp),ze=new Set(Object.keys(HS));for(let[Ke,Yt]of Object.entries(oR(be)))for(let[mt,nt]of Object.entries(Yt))ze.delete(nt);let Ft=ze.size>0?ze.values().next().value:Object.keys(HS)[0];Ue[Ze]=Ft}L.addPropToGraphEditor=z;function $(ke){let{selectedPropsByObject:be}=M._ensure(ke).sequenceEditor;if(!be[ke.objectKey])return;let Ue=be[ke.objectKey],Ze=Ef(ke.pathToProp);Ue[Ze]&&Ime(be,[ke.objectKey,Ze])}L.removePropFromGraphEditor=$;function H(ke){let be=o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(ke).sequenceEditor;return be.markerSet||(be.markerSet=Vo.create()),be.markerSet}function j(ke){let be=H(ke.sheetAddress),Ue=ke.markers.filter(mt=>!!isFinite(mt.position)).map(mt=>B(R({},mt),{position:ke.snappingFunction(mt.position)})),Ze=d1(Ue,"id"),ze=Vo.filter(be,mt=>mt&&!Ze[mt.id]),Ft=d1(Object.values(ze.byId),"position");Ue.forEach(({position:mt})=>{let nt=Ft[mt];nt&&(ze=Vo.remove(ze,nt.id))}),Object.assign(be,Vo.merge([ze,Vo.create(Ue.map(mt=>[mt.id,mt]))]));let Ke=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);Ke.sequence||(Ke.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let Yt=[...Object.values(ze.byId).filter(mt=>mt!==void 0),...Ue].sort((mt,nt)=>mt.position-nt.position);Ke.sequence.markers=Yt.map(mt=>({id:mt.id,label:mt.label,position:mt.position}))}L.replaceMarkers=j;function K(ke){var be;let Ue=H(ke.sheetAddress);Object.assign(Ue,Vo.remove(Ue,ke.markerId));let Ze=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);(be=Ze.sequence)!=null&&be.markers&&(Ze.sequence.markers=Ze.sequence.markers.filter(ze=>ze.id!==ke.markerId))}L.removeMarker=K;function Q(ke){var be;let Ue=H(ke.sheetAddress).byId[ke.markerId];if(Ue!==void 0){Ue.label=ke.label;let Ze=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);if((be=Ze.sequence)!=null&&be.markers){let ze=Ze.sequence.markers.find(Ft=>Ft.id===ke.markerId);ze&&(ze.label=ke.label)}}}L.updateMarker=Q;function re(ke){let be=o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(ke).sequenceEditor;return be.eventSet||(be.eventSet=Vo.create()),be.eventSet}function ae(ke){let be=re(ke.sheetAddress),Ue=ke.events.filter(mt=>isFinite(mt.position)?!mt.name||typeof mt.name!="string"?(console.warn("Event filtered out: invalid name",mt),!1):!0:(console.warn("Event filtered out: invalid position",mt),!1)).map(mt=>B(R({},mt),{position:ke.snappingFunction?ke.snappingFunction(mt.position):mt.position})),Ze=d1(Ue,"id"),ze=Vo.filter(be,mt=>mt&&!Ze[mt.id]),Ft=d1(Object.values(ze.byId),"position");Ue.forEach(({position:mt})=>{let nt=Ft[mt];nt&&(ze=Vo.remove(ze,nt.id))}),Object.assign(be,Vo.merge([ze,Vo.create(Ue.map(mt=>[mt.id,mt]))]));let Ke=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);Ke.sequence||(Ke.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let Yt=[...Object.values(ze.byId).filter(mt=>mt!==void 0),...Ue].sort((mt,nt)=>mt.position-nt.position);Ke.sequence.events=Yt.map(mt=>({id:mt.id,name:mt.name,position:mt.position,value:mt.value}))}L.replaceEvents=ae;function ue(ke){var be;let Ue=re(ke.sheetAddress);Object.assign(Ue,Vo.remove(Ue,ke.eventId));let Ze=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);(be=Ze.sequence)!=null&&be.events&&(Ze.sequence.events=Ze.sequence.events.filter(ze=>ze.id!==ke.eventId))}L.removeEvent=ue;function ye(ke){var be;let Ue=re(ke.sheetAddress).byId[ke.eventId];if(Ue!==void 0){Ue.name=ke.name,Ue.value=ke.value;let Ze=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);if((be=Ze.sequence)!=null&&be.events){let ze=Ze.sequence.events.find(Ft=>Ft.id===ke.eventId);ze&&(ze.name=ke.name,ze.value=ke.value)}}}L.updateEvent=ye;function Ae(ke){let be=o.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(ke).sequenceEditor;return be.subSequenceSet||(be.subSequenceSet=Vo.create()),be.subSequenceSet}function Ce(ke){let be=Ae(ke.sheetAddress),Ue=ke.subSequences.filter(mt=>isFinite(mt.position)?!mt.sheetId||typeof mt.sheetId!="string"?(console.warn("SubSequence filtered out: invalid sheetId",mt),!1):mt.duration!==void 0&&!isFinite(mt.duration)?(console.warn("SubSequence filtered out: invalid duration",mt),!1):mt.timeScale!==void 0&&(!isFinite(mt.timeScale)||mt.timeScale<=0)?(console.warn("SubSequence filtered out: invalid timeScale",mt),!1):!0:(console.warn("SubSequence filtered out: invalid position",mt),!1)).map(mt=>{var nt;return B(R({},mt),{position:ke.snappingFunction(mt.position),timeScale:(nt=mt.timeScale)!=null?nt:1})}),Ze=d1(Ue,"id"),ze=Vo.filter(be,mt=>mt&&!Ze[mt.id]),Ft=Object.values(ze.byId).filter(mt=>mt!==void 0);Ue.forEach(mt=>{var nt;let Ee=mt.position,ct=mt.position+((nt=mt.duration)!=null?nt:0);Ft.forEach(Nt=>{var Re;let it=Nt.position,Ht=Nt.position+((Re=Nt.duration)!=null?Re:0);Ee<Ht&&ct>it&&(ze=Vo.remove(ze,Nt.id))})}),Object.assign(be,Vo.merge([ze,Vo.create(Ue.map(mt=>[mt.id,mt]))]));let Ke=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);Ke.sequence||(Ke.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let Yt=[...Object.values(ze.byId).filter(mt=>mt!==void 0),...Ue].sort((mt,nt)=>mt.position-nt.position);Ke.sequence.subSequences=Yt.map(mt=>({id:mt.id,sheetId:mt.sheetId,position:mt.position,duration:mt.duration,timeScale:mt.timeScale,label:mt.label}))}L.replaceSubSequences=Ce;function Se(ke){var be;let Ue=Ae(ke.sheetAddress);Object.assign(Ue,Vo.remove(Ue,ke.subSequenceId));let Ze=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);(be=Ze.sequence)!=null&&be.subSequences&&(Ze.sequence.subSequences=Ze.sequence.subSequences.filter(ze=>ze.id!==ke.subSequenceId))}L.removeSubSequence=Se;function ft(ke){var be;let Ue=Ae(ke.sheetAddress).byId[ke.subSequenceId];if(Ue!==void 0){ke.updates.position!==void 0&&(Ue.position=ke.updates.position),ke.updates.duration!==void 0&&(Ue.duration=ke.updates.duration),ke.updates.timeScale!==void 0&&(Ue.timeScale=ke.updates.timeScale),ke.updates.label!==void 0&&(Ue.label=ke.updates.label);let Ze=o.coreByProject.historic.sheetsById._ensure(ke.sheetAddress);if((be=Ze.sequence)!=null&&be.subSequences){let ze=Ze.sequence.subSequences.find(Ft=>Ft.id===ke.subSequenceId);ze&&(ke.updates.position!==void 0&&(ze.position=ke.updates.position),ke.updates.duration!==void 0&&(ze.duration=ke.updates.duration),ke.updates.timeScale!==void 0&&(ze.timeScale=ke.updates.timeScale),ke.updates.label!==void 0&&(ze.label=ke.updates.label))}}}L.updateSubSequence=ft})(M.sequenceEditor||(M.sequenceEditor={}))})(_.stateBySheetId||(_.stateBySheetId={}))})(m.stateByProjectId||(m.stateByProjectId={}))})(u.projects||(u.projects={}))})(l.historic||(l.historic={})),(u=>{function m(_){Y0().ephemeral.showOutline=_}u.setShowOutline=m,(_=>{(S=>{function M(P){let k=Y0().ephemeral;return k.projects.stateByProjectId[P.projectId]||(k.projects.stateByProjectId[P.projectId]={stateBySheetId:{}}),k.projects.stateByProjectId[P.projectId]}S._ensure=M,(P=>{function k(L){let z=o.studio.ephemeral.projects.stateByProjectId._ensure(L);return z.stateBySheetId[L.sheetId]||(z.stateBySheetId[L.sheetId]={stateByObjectKey:{}}),z.stateBySheetId[L.sheetId]}P._ensure=k,(L=>{function z($){var H;let j=o.studio.ephemeral.projects.stateByProjectId.stateBySheetId._ensure($).stateByObjectKey;return j[H=$.objectKey]!=null||(j[H]={}),j[$.objectKey]}L._ensure=z,($=>{function H(K){let Q=o.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey._ensure(K);return Q.valuesBeingScrubbed!=null||(Q.valuesBeingScrubbed={}),Q.valuesBeingScrubbed}$._ensure=H;function j(K){bo(H(K),K.pathToProp,!0)}$.flag=j})(L.propsBeingScrubbed||(L.propsBeingScrubbed={}))})(P.stateByObjectKey||(P.stateByObjectKey={}))})(S.stateBySheetId||(S.stateBySheetId={}))})(_.stateByProjectId||(_.stateByProjectId={}))})(u.projects||(u.projects={}))})(l.ephemeral||(l.ephemeral={})),(u=>{function m(k){Y0().ahistoric.pinOutline=k}u.setPinOutline=m;function _(k){Y0().ahistoric.pinDetails=k}u.setPinDetails=_;function S(k){Y0().ahistoric.pinNotifications=k}u.setPinNotifications=S;function M(k){Y0().ahistoric.visibilityState=k}u.setVisibilityState=M;function P(k){let L=FF(k.map(H=>H.pathToProp)),z=k.map(({keyframe:H,pathToProp:j})=>({keyframe:H,pathToProp:j.slice(L.length)})),$=Y0();$.ahistoric.clipboard?$.ahistoric.clipboard.keyframesWithRelativePaths=z:$.ahistoric.clipboard={keyframesWithRelativePaths:z}}u.setClipboardKeyframes=P,(k=>{(L=>{function z($){let H=Y0().ahistoric;return H.projects.stateByProjectId[$.projectId]||(H.projects.stateByProjectId[$.projectId]={stateBySheetId:{}}),H.projects.stateByProjectId[$.projectId]}L._ensure=z,($=>{function H(K){let Q=o.studio.ahistoric.projects.stateByProjectId._ensure(K);return Q.collapsedItemsInOutline||(Q.collapsedItemsInOutline={}),Q.collapsedItemsInOutline}$._ensure=H;function j(K){let Q=o.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline._ensure(K);K.isCollapsed?Q[K.itemKey]=!0:delete Q[K.itemKey]}$.set=j})(L.collapsedItemsInOutline||(L.collapsedItemsInOutline={})),($=>{function H(j){let K=o.studio.ahistoric.projects.stateByProjectId._ensure(j);return K.stateBySheetId[j.sheetId]||(K.stateBySheetId[j.sheetId]={}),K.stateBySheetId[j.sheetId]}$._ensure=H,(j=>{function K(Q){let re=o.studio.ahistoric.projects.stateByProjectId.stateBySheetId._ensure(Q);return re.sequence||(re.sequence={}),re.sequence}j._ensure=K,(Q=>{function re(ue){o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ue).focusRange={range:ue.range,enabled:ue.enabled}}Q.set=re;function ae(ue){o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ue).focusRange=void 0}Q.unset=ae})(j.focusRange||(j.focusRange={})),(Q=>{function re(ae){o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ae).clippedSpaceRange=R({},ae.range)}Q.set=re})(j.clippedSpaceRange||(j.clippedSpaceRange={})),(Q=>{function re(ue){let ye=o.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(ue),Ae=ye.collapsableItems;return Ae||(Ae=ye.collapsableItems=Vo.create()),Ae}function ae(ue){let ye=re(ue);Object.assign(ye,Vo.add(ye,ue.studioSheetItemKey,{isCollapsed:ue.isCollapsed}))}Q.set=ae})(j.sequenceEditorCollapsableItems||(j.sequenceEditorCollapsableItems={}))})($.sequence||($.sequence={}))})(L.stateBySheetId||(L.stateBySheetId={}))})(k.stateByProjectId||(k.stateByProjectId={}))})(u.projects||(u.projects={}))})(l.ahistoric||(l.ahistoric={}))})(o.studio||(o.studio={})),(l=>{(u=>{(m=>{function _(S){let M=Y0().historic.coreByProject[S.projectId].revisionHistory,P=50;M.unshift(S.revision),M.length>P&&(M.length=P)}m.add=_})(u.revisionHistory||(u.revisionHistory={})),(m=>{function _(P){let k=Y0().historic.coreByProject[P.projectId].sheetsById;return k[P.sheetId]||(k[P.sheetId]={staticOverrides:{byObject:{}}}),k[P.sheetId]}m._ensure=_;function S(P){let k=Y0().historic.coreByProject[P.projectId].sheetsById[P.sheetId];if(!k)return;delete k.staticOverrides.byObject[P.objectKey];let L=k.sequence;L&&delete L.tracksByObject[P.objectKey]}m.forgetObject=S;function M(P){Y0().historic.coreByProject[P.projectId].sheetsById[P.sheetId]&&delete Y0().historic.coreByProject[P.projectId].sheetsById[P.sheetId]}m.forgetSheet=M,(P=>{function k(be){let Ue=o.coreByProject.historic.sheetsById._ensure(be);return Ue.sequence!=null||(Ue.sequence={subUnitsPerUnit:30,length:10,type:"PositionalSequence",tracksByObject:{}}),Ue.sequence}P._ensure=k;function L(be){k(be).length=Zi(parseFloat(be.length.toFixed(2)),.01,1/0)}P.setLength=L;function z(be){k(be).subUnitsPerUnit=Zi(be.subUnitsPerUnit,1,F(2,12))}P.setSubUnitsPerUnit=z;function $(be){var Ue;let Ze=o.coreByProject.historic.sheetsById.sequence._ensure(be).tracksByObject;return Ze[Ue=be.objectKey]!=null||(Ze[Ue]={trackData:{},trackIdByPropPath:{}}),Ze[be.objectKey]}function H(be,Ue){let Ze=$(be),ze=Ef(be.pathToProp);if(typeof Ze.trackIdByPropPath[ze]=="string")return;let Ft=Lwe(),Ke={type:"BasicKeyframedTrack",__debugName:"".concat(be.objectKey,":").concat(ze),keyframes:[]};Ze.trackData[Ft]=Ke,Ze.trackIdByPropPath[ze]=Ft}P.setPrimitivePropAsSequenced=H;function j(be){let Ue=$(be),Ze=Ef(be.pathToProp),ze=Ue.trackIdByPropPath[Ze];typeof ze=="string"&&(delete Ue.trackIdByPropPath[Ze],delete Ue.trackData[ze],o.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(be))}P.setPrimitivePropAsStatic=j;function K(be){let Ue=$(be);for(let Ze of Object.keys(Ue.trackIdByPropPath)){let ze=JSON.parse(Ze);if(be.pathToProp.every((Ft,Ke)=>ze[Ke]===Ft)){let Ft=Ue.trackIdByPropPath[Ze];if(typeof Ft!="string")continue;delete Ue.trackIdByPropPath[Ze],delete Ue.trackData[Ft]}}o.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfCompoundProp(be)}P.setCompoundPropAsStatic=K;function Q(be){return $(be).trackData[be.trackId]}function re(be){let Ue=Q(be);if(Ue)return Ue.keyframes.find(Ze=>Ze.id===be.keyframeId)}function ae(be){let Ue=be.snappingFunction(be.position),Ze=Q(be);if(!Ze)return;let{keyframes:ze}=Ze,Ft=ze.findIndex(mt=>mt.position===Ue);if(Ft!==-1){let mt=ze[Ft];mt.value=be.value;return}let Ke=nC(ze,mt=>mt.position<Ue);if(Ke===-1){ze.unshift({id:wQ(),position:Ue,connectedRight:!0,handles:be.handles||[.5,1,.5,0],type:be.type||"bezier",value:be.value});return}let Yt=ze[Ke];ze.splice(Ke+1,0,{id:wQ(),position:Ue,connectedRight:Yt.connectedRight,handles:be.handles||[.5,1,.5,0],type:be.type||"bezier",value:be.value})}P.setKeyframeAtPosition=ae;function ue(be){let Ue=Q(be);if(!Ue)return;let{keyframes:Ze}=Ue,ze=Ze.findIndex(Ft=>Ft.position===be.position);ze!==-1&&Ze.splice(ze,1)}P.unsetKeyframeAtPosition=ue;function ye(be){let Ue=Q(be);if(!Ue)return;let Ze=oR(Ue.keyframes).filter(ze=>be.keyframeIds.includes(ze.id)).map(ze=>{let Ft=ze.position,Ke=be.snappingFunction(ZAe(Ft,be));return B(R({},ze),{position:Ke})});ke(B(R({},be),{keyframes:Ze}))}P.transformKeyframes=ye;function Ae(be){let Ue=Q(be);Ue&&(Ue.keyframes=Ue.keyframes.map((Ze,ze)=>{let Ft=Ue.keyframes[ze-1],Ke=be.keyframeIds.includes(Ze.id),Yt=be.keyframeIds.includes(Ft==null?void 0:Ft.id);return Ke&&!Yt?B(R({},Ze),{handles:[Ze.handles[0],Ze.handles[1],be.handles[0],be.handles[1]]}):Ke&&Yt?B(R({},Ze),{handles:[be.handles[2],be.handles[3],be.handles[0],be.handles[1]]}):Yt?B(R({},Ze),{handles:[be.handles[2],be.handles[3],Ze.handles[2],Ze.handles[3]]}):Ze}))}P.setTweenBetweenKeyframes=Ae;function Ce(be){var Ue,Ze,ze,Ft,Ke,Yt,mt,nt;let Ee=re(be);Ee&&(Ee.handles=[(Ze=(Ue=be.end)==null?void 0:Ue[0])!=null?Ze:Ee.handles[0],(Ft=(ze=be.end)==null?void 0:ze[1])!=null?Ft:Ee.handles[1],(Yt=(Ke=be.start)==null?void 0:Ke[0])!=null?Yt:Ee.handles[2],(nt=(mt=be.start)==null?void 0:mt[1])!=null?nt:Ee.handles[3]])}P.setHandlesForKeyframe=Ce;function Se(be){let Ue=Q(be);Ue&&(Ue.keyframes=Ue.keyframes.filter(Ze=>be.keyframeIds.indexOf(Ze.id)===-1))}P.deleteKeyframes=Se;function ft(be){let Ue=re(be);Ue&&(Ue.type=be.keyframeType)}P.setKeyframeType=ft;function ke(be){let Ue=Q(be);if(!Ue)return;let Ze=oR(Ue.keyframes),ze=be.keyframes.filter(nt=>!(typeof nt.value=="number"&&!isFinite(nt.value)||!nt.handles.every(Ee=>isFinite(Ee)))).map(nt=>B(R({},nt),{position:be.snappingFunction(nt.position)})),Ft=d1(ze,"id"),Ke=Ze.filter(nt=>!Ft[nt.id]),Yt=d1(Ke,"position");ze.forEach(({position:nt})=>{let Ee=Yt[nt];Ee&&er(Ke,Ee)});let mt=ia([...Ke,...ze],"position");Ue.keyframes=mt}P.replaceKeyframes=ke})(m.sequence||(m.sequence={})),(P=>{(k=>{function L(j){var K;let Q=o.coreByProject.historic.sheetsById._ensure(j).staticOverrides.byObject;return Q[K=j.objectKey]!=null||(Q[K]={}),Q[j.objectKey]}function z(j){let K=L(j);bo(K,j.pathToProp,j.value)}k.setValueOfCompoundProp=z;function $(j){let K=L(j);bo(K,j.pathToProp,j.value)}k.setValueOfPrimitiveProp=$;function H(j){let K=o.coreByProject.historic.sheetsById._ensure(j).staticOverrides.byObject[j.objectKey];K&&Ime(K,j.pathToProp)}k.unsetValueOfPrimitiveProp=H})(P.byObject||(P.byObject={}))})(m.staticOverrides||(m.staticOverrides={}))})(u.sheetsById||(u.sheetsById={}))})(l.historic||(l.historic={}))})(o.coreByProject||(o.coreByProject={}))})(Mz||(Mz={}));function Cz(){let o,l,u=new Promise((_,S)=>{o=M=>{_(M),m.status="resolved"},l=M=>{S(M),m.status="rejected"}}),m={resolve:o,reject:l,promise:u,status:"pending"};return m}var lPe=an();function cPe(o){let l=o.getState(),u=new lPe.Atom(l);return o.subscribe(()=>{let m=o.getState();u.set(m),l=m}),u}R5();function uPe(o){var l,u=o.Symbol;return typeof u=="function"?u.observable?l=u.observable:(l=u("observable"),u.observable=l):l="@@observable",l}var fw;typeof self<"u"?fw=self:typeof window<"u"?fw=window:typeof tl<"u"?fw=tl:fw=i;var dPe=uPe(fw),jme=dPe,Hme={INIT:"@@redux/INIT"};function Wme(o,l,u){var m;if(typeof l=="function"&&typeof u>"u"&&(u=l,l=void 0),typeof u<"u"){if(typeof u!="function")throw new Error("Expected the enhancer to be a function.");return u(Wme)(o,l)}if(typeof o!="function")throw new Error("Expected the reducer to be a function.");var _=o,S=l,M=[],P=M,k=!1;function L(){P===M&&(P=M.slice())}function z(){return S}function $(Q){if(typeof Q!="function")throw new Error("Expected listener to be a function.");var re=!0;return L(),P.push(Q),function(){if(re){re=!1,L();var ae=P.indexOf(Q);P.splice(ae,1)}}}function H(Q){if(!Jp(Q))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(typeof Q.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(k)throw new Error("Reducers may not dispatch actions.");try{k=!0,S=_(S,Q)}finally{k=!1}for(var re=M=P,ae=0;ae<re.length;ae++){var ue=re[ae];ue()}return Q}function j(Q){if(typeof Q!="function")throw new Error("Expected the nextReducer to be a function.");_=Q,H({type:Hme.INIT})}function K(){var Q,re=$;return Q={subscribe:function(ae){if(typeof ae!="object")throw new TypeError("Expected the observer to be an object.");function ue(){ae.next&&ae.next(z())}ue();var ye=re(ue);return{unsubscribe:ye}}},Q[jme]=function(){return this},Q}return H({type:Hme.INIT}),m={dispatch:H,subscribe:$,getState:z,replaceReducer:j},m[jme]=K,m}function hPe(){for(var o=arguments.length,l=Array(o),u=0;u<o;u++)l[u]=arguments[u];return l.length===0?function(m){return m}:l.length===1?l[0]:l.reduce(function(m,_){return function(){return m(_.apply(void 0,arguments))}})}function fPe(o){let l=hPe();return Wme(o.rootReducer,void 0,l)}_P(),Py();var Az=new WeakMap,pPe=(o,l,u)=>{let m=k=>{o.dispatch(k7.replacePersistentState(k))},_=qme(u),S=()=>o.getState().$persistent;P();let M=()=>{let k=S(),L=Az.get(o);k!==L&&(Az.set(o,k),localStorage.setItem(_,JSON.stringify(k)))};o.subscribe(Ay(M,1e3)),window&&window.addEventListener("beforeunload",M);function P(){let k=localStorage.getItem(_);if(k){let L,z=!0;try{L=JSON.parse(k),z=!1}catch{yP.warn("Could not parse Theatre's persisted state. This must be a bug. Please report it.")}finally{z||m(L),l()}}else l()}},mPe=(o,l)=>{let u=qme(l),m=o.getState().$persistent;localStorage.removeItem(u),Az.set(o,m)};function qme(o){return o+".persistent"}var gPe=(o=21)=>{let l="",u=crypto.getRandomValues(new Uint8Array(o));for(;o--;){let m=u[o]&63;m<36?l+=m.toString(36):m<62?l+=(m-26).toString(36).toUpperCase():m<63?l+="_":l+="-"}return l};function vPe(){return gPe(16)}hM(),$t(),bl(),yv(),vA();var cR=an();s9(),V0(),Lfe();function Pz(o){if(typeof o=="boolean"||typeof o=="string"||typeof o=="number")return o;if(Jp(o)){let l={},u=!1;for(let[m,_]of Object.entries(o))Pz(_)!==void 0&&(l[m]=_,u=!0);if(u)return l}else return}function $me(o,l,u){for(let[m,_]of Object.entries(o.props))if(_.type==="compound")$me(_,[...l,m],u);else{if(_.type==="enum")throw new Error("Not yet implemented");u(_,[...l,m])}}function yPe(o,l,u){return{set:(m,_)=>{o();let S=Pz(_);if(typeof S>"u")return;let{root:M,path:P}=(0,cR.getPointerParts)(m);if(Ot(M)){let k=M.template.getMapOfValidSequenceTracks_forStudio().getValue(),L=l7(M.template.staticConfig,P);if(!L)throw new Error("Object ".concat(M.address.objectKey," does not have a prop at ").concat(JSON.stringify(P)));let z=($,H,j)=>{if($==null)return;if(Pz(H.deserializeAndSanitize($))===void 0)throw new Error("Invalid value ".concat(RB($)," for object.props").concat(j.map(re=>"[".concat(JSON.stringify(re),"]")).join("")," is invalid"));let K=B(R({},M.address),{pathToProp:j}),Q=Zc(k,j);if(typeof Q=="string"){let re=M.sheet.getSequence();re.position=re.closestGridPosition(re.position),l.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(B(R({},K),{trackId:Q,position:re.position,value:$,snappingFunction:re.closestGridPosition,type:"bezier"}))}else l.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(B(R({},K),{value:$}))};if(L.type==="compound"){let $=(0,cR.getPointerParts)(m).path,H=$.length;$me(L,$,(j,K)=>{let Q=K.slice(H),re=o9(S,Q);if(typeof re<"u")z(re,j,K);else throw new Error("Property object.props".concat(K.map(ae=>"[".concat(JSON.stringify(ae),"]")).join("")," is required but not provided"))})}else{if(L.type==="enum")throw new Error("Enums aren't implemented yet");z(S,L,P)}}else if(wn(M)){let[k]=P;if(k==="subUnitsPerUnit"){if(typeof S!="number"||!jb(S)||S<1)throw new Error("Value ".concat(S," is not an integer, which is required for setting sequence prop ").concat(k));l.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit(B(R({},M.address),{subUnitsPerUnit:S}))}else if(k==="length"){if(typeof S!="number"||S<=.001)throw new Error("Value ".concat(S," is not a positive number, which is required for setting sequence prop ").concat(k));l.coreByProject.historic.sheetsById.sequence.setLength(B(R({},M.address),{length:S}))}else throw new Error("Setting sequence prop ".concat(k," is not supported"))}else throw new Error("Only setting props of SheetObject-s and sequences is supported in a transaction so far")},unset:m=>{o();let{root:_,path:S}=(0,cR.getPointerParts)(m);if(Ot(_)){let M=_.template.getMapOfValidSequenceTracks_forStudio().getValue(),P=o9(_.template.getDefaultValues().getValue(),S),k=l7(_.template.staticConfig,S),L=(z,$)=>{let H=B(R({},_.address),{pathToProp:$}),j=Zc(M,$);typeof j=="string"?l.coreByProject.historic.sheetsById.sequence.unsetKeyframeAtPosition(B(R({},H),{trackId:j,position:_.sheet.getSequence().positionSnappedToGrid})):k!==void 0&&l.coreByProject.historic.sheetsById.staticOverrides.byObject.unsetValueOfPrimitiveProp(H)};k.type==="compound"?QP(P,(z,$)=>{L(z,$)},(0,cR.getPointerParts)(m).path):L(P,S)}else throw new Error("Only setting props of SheetObject-s is supported in a transaction so far")},get drafts(){return o(),u},get stateEditors(){return l}}}var _Pe=class{constructor(){Me(this,"_reduxStore"),Me(this,"_atom"),Me(this,"atomP"),this._reduxStore=fPe({rootReducer:KAe}),this._atom=cPe(this._reduxStore),this.atomP=this._atom.pointer}initialize(o){let l=Cz();return o.usePersistentStorage===!0?pPe(this._reduxStore,()=>{this.tempTransaction(({drafts:u})=>{u.ephemeral.initialised=!0}).commit(),l.resolve()},o.persistenceKey):(this.tempTransaction(({drafts:u})=>{u.ephemeral.initialised=!0}).commit(),l.resolve()),l.promise}getState(){return this._reduxStore.getState()}__experimental_clearPersistentStorage(o){return mPe(this._reduxStore,o),this.getState()}__dev_startHistoryFromScratch(o){this._reduxStore.dispatch(k7.historic.startHistoryFromScratch(k7.reduceParts(l=>B(R({},l),{historic:o}))))}tempTransaction(o){let l=YAe(),u,m=l.push(k7.reduceParts(_=>{let S={historic:wz(_.historic),ahistoric:wz(_.ahistoric),ephemeral:wz(_.ephemeral)},M=!0,P=()=>{if(!M)throw new Error("You seem to have called the transaction api after studio.transaction() has finished running")},k=Gme(S),L=yPe(P,k,S);try{return o(L),M=!1,{historic:Tz(S.historic),ahistoric:Tz(S.ahistoric),ephemeral:Tz(S.ephemeral)}}catch(z){return u=z,_}finally{Gme(void 0)}}));if(this._reduxStore.dispatch(m),u)throw this._reduxStore.dispatch(l.discard()),u;return{commit:()=>{this._reduxStore.dispatch(l.commit())},discard:()=>{this._reduxStore.dispatch(l.discard())}}}undo(){this._reduxStore.dispatch(k7.historic.undo())}redo(){this._reduxStore.dispatch(k7.historic.redo())}createContentOfSaveFile(o){var l,u,m,_;if(!this._reduxStore.getState().$persistent.historic.innerState.coreByProject[o])throw new Error("Project ".concat(o," has not been initialized."));let S=vPe();this.tempTransaction(({stateEditors:L})=>{L.coreByProject.historic.revisionHistory.add({projectId:o,revision:S})}).commit();let M=this._reduxStore.getState().$persistent.historic.innerState.coreByProject[o],P=(l=this._reduxStore.getState().$persistent.historic.innerState.projects)==null?void 0:l.stateByProjectId[o],k=dM(M);if(P!=null&&P.stateBySheetId)for(let[L,z]of Object.entries(P.stateBySheetId)){if((u=z==null?void 0:z.sequenceEditor)!=null&&u.markerSet){let $=z.sequenceEditor.markerSet;if($.allIds&&Object.keys($.allIds).length>0){k.sheetsById[L]||(k.sheetsById[L]={staticOverrides:{byObject:{}}});let H=k.sheetsById[L];H&&!H.sequence&&(H.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let j=Object.entries($.byId).map(([K,Q])=>Q).filter(K=>K!==void 0).sort((K,Q)=>K.position-Q.position);H!=null&&H.sequence&&(H.sequence.markers=j)}}if((m=z==null?void 0:z.sequenceEditor)!=null&&m.eventSet){let $=z.sequenceEditor.eventSet;if($.allIds&&Object.keys($.allIds).length>0){k.sheetsById[L]||(k.sheetsById[L]={staticOverrides:{byObject:{}}});let H=k.sheetsById[L];H&&!H.sequence&&(H.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let j=Object.entries($.byId).map(([K,Q])=>Q).filter(K=>K!==void 0).sort((K,Q)=>K.position-Q.position);H!=null&&H.sequence&&(H.sequence.events=j)}}if((_=z==null?void 0:z.sequenceEditor)!=null&&_.subSequenceSet){let $=z.sequenceEditor.subSequenceSet;if($.allIds&&Object.keys($.allIds).length>0){k.sheetsById[L]||(k.sheetsById[L]={staticOverrides:{byObject:{}}});let H=k.sheetsById[L];H&&!H.sequence&&(H.sequence={type:"PositionalSequence",length:10,subUnitsPerUnit:30,tracksByObject:{}});let j=Object.entries($.byId).map(([K,Q])=>Q).filter(K=>K!==void 0).sort((K,Q)=>K.position-Q.position);H!=null&&H.sequence&&(H.sequence.subSequences=j)}}}return k}},xPe=an(),Rz=class{constructor(){Me(this,"_values",{})}get(o,l){if(this.has(o))return this._values[o];{let u=l();return this._values[o]=u,u}}has(o){return this._values.hasOwnProperty(o)}};$t(),qy(),Ie(),V0(),cB();var bPe=class{constructor(o){Me(this,"ui",{hide(){ce().ui.hide()},get isHidden(){return ce().ui.isHidden},restore(){ce().ui.restore()},renderToolset(l,u){return ce().ui.renderToolset(l,u)}}),Me(this,"_cache",new Rz),Me(this,"__experimental",{__experimental_disblePlayPauseKeyboardShortcut(){tCe()},__experimental_enablePlayPauseKeyboardShortcut(){nCe()},__experimental_clearPersistentStorage(l){return ce().clearPersistentStorage(l)},__experimental_createContentOfSaveFileTyped(l){return ce().createContentOfSaveFile(l)}})}initialize(o){return ce().initialize(o)}extend(o,l){ce().extend(o,l)}transaction(o){return ce().transaction(({set:l,unset:u,stateEditors:m})=>o({set:l,unset:u,__experimental_forgetObject:_=>{if(!Gt(_))throw new Error("object in transactionApi.__experimental_forgetObject(object) must be the return type of sheet.object(...)");m.coreByProject.historic.sheetsById.forgetObject(_.address)},__experimental_forgetSheet:_=>{if(!Tt(_))throw new Error("sheet in transactionApi.__experimental_forgetSheet(sheet) must be the return type of project.sheet()");m.coreByProject.historic.sheetsById.forgetSheet(_.address)}}))}_getSelectionPrism(){return this._cache.get("_getSelectionPrism()",()=>(0,xPe.prism)(()=>nh().filter(o=>o.type==="Theatre_SheetObject"||o.type==="Theatre_Sheet").map(o=>o.publicApi)))}_getSelection(){return this._getSelectionPrism().getValue()}setSelection(o){let l=[...o].filter(u=>Gt(u)||Tt(u)).map(u=>ce().corePrivateAPI(u));ce().transaction(({stateEditors:u})=>{u.studio.historic.panels.outline.selection.set(l)})}onSelectionChange(o){let l=ce();return this._getSelectionPrism().onChange(l.ticker,o,!0)}get selection(){return this._getSelection()}scrub(){return ce().scrub()}getStudioProject(){let o=ce().core;if(!o)throw new Error("You're calling studio.getStudioProject() before `@tomorrowevening/theatre-core` is loaded. To fix this:\n1. Check if `@tomorrowevening/theatre-core` is import/required in your bundle.\n2. Check the stack trace of this error and make sure the funciton that calls getStudioProject() is run after `@tomorrowevening/theatre-core` is loaded.");return ce().getStudioProject(o)}debouncedScrub(o=1e3){let l,u=Ay(()=>{let m=l;m&&(l=void 0,m.commit())},o);return{capture:m=>{l||(l=this.scrub());let _=!0;try{l.capture(m),_=!1}finally{if(_){let S=l;l=void 0,S.discard()}else u()}}}}createPane(o){return ce().paneManager.createPane(o)}destroyPane(o){return ce().paneManager.destroyPane(o)}createContentOfSaveFile(o){return ce().createContentOfSaveFile(o)}};SQ();var a8=an(),SPe=class{constructor(o){this._studio=o,Me(this,"_cache",new Rz),this._instantiatePanesAsTheyComeIn()}_instantiatePanesAsTheyComeIn(){let o=this._getAllPanes();o.onStale(()=>{o.getValue()})}_getAllPanes(){return this._cache.get("_getAllPanels()",()=>(0,a8.prism)(()=>{if(!(0,a8.val)(this._studio.coreP))return{};let o=(0,a8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),l=(0,a8.val)(this._studio.atomP.ephemeral.extensions.paneClasses),u={};for(let m of Object.values(o)){if(!m)continue;let _=l[m.paneClass];if(!_)continue;let{instanceId:S}=m,{extensionId:M,classDefinition:P}=_,k=a8.prism.memo("instance-".concat(m.instanceId),()=>({extensionId:M,instanceId:S,definition:P}),[P]);u[S]=k}return u}))}get allPanesD(){return this._getAllPanes()}createPane(o){if(!this._studio.core)throw new Error("Can't create a pane because @tomorrowevening/theatre-core is not yet loaded");let l=(0,a8.val)(this._studio.atomP.ephemeral.extensions.paneClasses[o].extensionId),u=(0,a8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),m;for(let _=1;_<1e3&&(m="".concat(o," #").concat(_),!!u[m]);_++);if(!l)throw new Error('Pane class "'.concat(o,'" is not registered.'));return this._studio.transaction(({drafts:_})=>{_.historic.panelInstanceDesceriptors[m]={instanceId:m,paneClass:o},_.historic.paneFocusOrder||(_.historic.paneFocusOrder=[]);let S=_.historic.paneFocusOrder,M=S.indexOf(m);M!==-1&&S.splice(M,1),S.push(m)}),this._getAllPanes().getValue()[m]}destroyPane(o){if(!this._studio.core)throw new Error("Can't do this yet because @tomorrowevening/theatre-core is not yet loaded");this._studio.transaction(({drafts:l})=>{if(delete l.historic.panelInstanceDesceriptors[o],l.historic.paneFocusOrder){let u=l.historic.paneFocusOrder.indexOf(o);u!==-1&&l.historic.paneFocusOrder.splice(u,1)}})}bringPaneToFront(o){this._studio.transaction(({drafts:l})=>{l.historic.paneFocusOrder||(l.historic.paneFocusOrder=[]);let u=l.historic.paneFocusOrder,m=u.indexOf(o);m!==-1&&u.splice(m,1),u.push(o)})}},uR=an();Ie();var Xme=30*60*1e3,wPe=1e3*60*60;function TPe(){return De(this,null,function*(){let o=ce().atomP.ahistoric.visibilityState;if((0,uR.val)(o)==="everythingIsVisible")return;let l=Cz(),u=(0,uR.pointerToPrism)(o).onStale(()=>{(0,uR.val)(o)==="everythingIsVisible"&&(u(),l.resolve(void 0))});return l.promise})}function EPe(){return De(this,null,function*(){if(!"1.0.19".match(/COMPAT/))for(yield dR(500),yield TPe();;){let o=(0,uR.val)(ce().atomP.ahistoric.updateChecker);if(o&&o.result!=="error"){let l=o.lastChecked,u=Date.now(),m=Math.abs(u-l);m<Xme&&(yield dR(Xme-m))}try{let l=yield fetch(new Request("https://updates.theatrejs.com/updates/1.0.19"));if(l.ok){let u=yield l.json();if(!MPe(u))throw new Error("Bad response");ce().transaction(({drafts:m})=>{m.ahistoric.updateChecker={lastChecked:Date.now(),result:R({},u)}}),yield dR(1e3)}else throw new Error("HTTP Error ".concat(l.statusText))}catch{yield dR(wPe)}}})}var dR=o=>new Promise(l=>setTimeout(l,o));function MPe(o){if(typeof o!="object")return!1;let l=o;return typeof l.hasUpdates!="boolean"?!1:l.hasUpdates===!0&&typeof l.newVersion=="string"&&typeof l.releasePage=="string"||l.hasUpdates===!1}var CPe=G(K$());function $g(o){return new Promise((l,u)=>{o.oncomplete=o.onsuccess=()=>l(o.result),o.onabort=o.onerror=()=>u(o.error)})}function Yme(o,l){let u=indexedDB.open(o);u.onupgradeneeded=()=>u.result.createObjectStore(l);let m=$g(u);return(_,S)=>m.then(M=>S(M.transaction(l,_).objectStore(l)))}var Iz;function L7(){return Iz||(Iz=Yme("keyval-store","keyval")),Iz}function APe(o,l=L7()){return l("readonly",u=>$g(u.get(o)))}function PPe(o,l,u=L7()){return u("readwrite",m=>(m.put(l,o),$g(m.transaction)))}function RPe(o,l=L7()){return l("readwrite",u=>(u.delete(o),$g(u.transaction)))}function Nz(o,l){return o.openCursor().onsuccess=function(){this.result&&(l(this.result),this.result.continue())},$g(o.transaction)}function IPe(o=L7()){return o("readonly",l=>{if(l.getAllKeys)return $g(l.getAllKeys());let u=[];return Nz(l,m=>u.push(m.key)).then(()=>u)})}function NPe(o=L7()){return o("readonly",l=>{if(l.getAll)return $g(l.getAll());let u=[];return Nz(l,m=>u.push(m.value)).then(()=>u)})}function kPe(o=L7()){return o("readonly",l=>{if(l.getAll&&l.getAllKeys)return Promise.all([$g(l.getAllKeys()),$g(l.getAll())]).then(([m,_])=>m.map((S,M)=>[S,_[M]]));let u=[];return o("readonly",m=>Nz(m,_=>u.push([_.key,_.value])).then(()=>u))})}var DPe=o=>{let l=Yme("theatrejs-".concat(o),"default-store");return{set:(u,m)=>PPe(u,m,l),get:u=>APe(u,l),del:u=>RPe(u,l),keys:()=>IPe(l),entries:()=>kPe(l),values:()=>NPe(l)}},OPe=an();function Kme(o,l){var u;let m=Object.values((u=(0,OPe.val)(o.pointers.historic.sheetsById))!=null?u:{}),_=m.flatMap(M=>{var P;return Object.values((P=M==null?void 0:M.staticOverrides.byObject)!=null?P:{})}).flatMap(M=>Object.values(M??{})),S=[...m.flatMap(M=>{var P,k;return Object.values((k=(P=M==null?void 0:M.sequence)==null?void 0:P.tracksByObject)!=null?k:{})}).flatMap(M=>{var P;return Object.values((P=M==null?void 0:M.trackData)!=null?P:{})}).flatMap(M=>M==null?void 0:M.keyframes).map(M=>M==null?void 0:M.value)];return _.forEach(M=>{QP(M,P=>{S.push(P)},[])}),S.filter(M=>(M==null?void 0:M.type)&&typeof(M==null?void 0:M.type)=="string").map(M=>M.id).filter((M,P,k)=>M!==null&&M!==""&&k.indexOf(M)===P)}JB();var Zme="theatre-0.4",LPe=`You seem to have imported '@tomorrowevening/theatre-studio' but haven't initialized it. You can initialize the studio by:
\`\`\`
import studio from '@tomorrowevening/theatre-studio'
studio.initialize()
\`\`\`

* If you didn't mean to import '@tomorrowevening/theatre-studio', this means that your bundler is not tree-shaking it. This is most likely a bundler misconfiguration.

* If you meant to import '@tomorrowevening/theatre-studio' without showing its UI, you can do that by running:

\`\`\`
import studio from '@tomorrowevening/theatre-studio'
studio.initialize()
studio.ui.hide()
\`\`\`
`,FPe="You seem to have imported '@tomorrowevening/theatre-studio' but called `studio.initialize()` after some delay.\nTheatre.js projects remain in pending mode (won't play their sequences) until the studio is initialized, so you should place the `studio.initialize()` line right after the import line:\n\n```\nimport studio from '@tomorrowevening/theatre-studio'\n// ... and other imports\n\nstudio.initialize()\n```\n",UPe=class{constructor(){Me(this,"ui"),Me(this,"publicApi"),Me(this,"address"),Me(this,"_projectsProxy",new JP.PointerProxy(new JP.Atom({}).pointer)),Me(this,"projectsP",this._projectsProxy.pointer),Me(this,"_store",new _Pe),Me(this,"_corePrivateApi"),Me(this,"_cache",new Rz),Me(this,"paneManager"),Me(this,"_coreAtom",new JP.Atom({})),Me(this,"_initializedDeferred",Cz()),Me(this,"_initializeFnCalled",!1),Me(this,"_didWarnAboutNotInitializing",!1),Me(this,"_coreBits"),Me(this,"_rafDriver"),this.address={studioId:n7(10)},this.publicApi=new bPe(this),this.ui=new AAe(this),this._attachToIncomingProjects(),this.paneManager=new SPe(this),typeof window<"u"&&setTimeout(()=>{this._initializeFnCalled||(console.error(LPe),this._didWarnAboutNotInitializing=!0)},100)}get ticker(){if(!this._rafDriver)throw new Error("`studio.ticker` was read before studio.initialize() was called.");return this._rafDriver.ticker}get atomP(){return this._store.atomP}initialize(o){return De(this,null,function*(){if(!this._coreBits)throw new Error("You seem to have imported `@tomorrowevening/theatre-studio` without importing `@tomorrowevening/theatre-core`. Make sure to include an import of `@tomorrowevening/theatre-core` before calling `studio.initializer()`.");if(this._initializeFnCalled)return this._initializedDeferred.promise;this._initializeFnCalled=!0,this._didWarnAboutNotInitializing&&console.warn(FPe);let l={persistenceKey:Zme,usePersistentStorage:!0};if(typeof(o==null?void 0:o.persistenceKey)=="string"&&(l.persistenceKey=o.persistenceKey),((o==null?void 0:o.usePersistentStorage)===!1||typeof window>"u")&&(l.usePersistentStorage=!1),o!=null&&o.__experimental_rafDriver){if(o.__experimental_rafDriver.type!=="Theatre_RafDriver_PublicAPI")throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` must be either be undefined, or the return type of core.createRafDriver()");let u=this._coreBits.privateAPI(o.__experimental_rafDriver);if(!u)throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` seems to come from a different version of `@tomorrowevening/theatre-core` than the version that is attached to `@tomorrowevening/theatre-studio`");this._rafDriver=u}else this._rafDriver=this._coreBits.getCoreRafDriver();try{yield this._store.initialize(l)}catch(u){this._initializedDeferred.reject(u);return}typeof window<"u"&&(yield this.ui.ready),this._initializedDeferred.resolve(),this.ui.render(),EPe().catch(u=>{console.error(u)})})}get initialized(){return this._initializedDeferred.promise}_attachToIncomingProjects(){let o=(0,JP.pointerToPrism)(this.projectsP),l=u=>{for(let m of Object.values(u))m.isAttachedToStudio||m.attachToStudio(this)};o.onStale(()=>{l(o.getValue())}),l(o.getValue())}setCoreBits(o){this._coreBits=o,this._corePrivateApi=o.privateAPI,this._coreAtom.setByPointer(l=>l.core,o.coreExports),this._setProjectsP(o.projectsP)}_setProjectsP(o){this._projectsProxy.setPointer(o)}scrub(){return new MAe(this)}tempTransaction(o){return this._store.tempTransaction(o)}transaction(o){return this.tempTransaction(o).commit()}__dev_startHistoryFromScratch(o){return this._store.__dev_startHistoryFromScratch(o)}get corePrivateAPI(){return this._corePrivateApi}get core(){return this._coreAtom.get().core}get coreP(){return this._coreAtom.pointer.core}extend(o,l){if(!o||typeof o!="object")throw new Error("Extensions must be JS objects");if(typeof o.id!="string")throw new Error("extension.id must be a string");let u=(l==null?void 0:l.__experimental_reconfigure)===!0,m=o.id,_=this._store.getState().ephemeral.extensions.byId[m];if(_&&!u){if(o===_||(0,CPe.default)(o,_))return;throw new Error('Extension id "'.concat(o.id,'" is already defined. If you mean to re-configure the extension, do it like this: studio.extend(extension, {__experimental_reconfigure: true})})'))}this.transaction(({drafts:S})=>{var M,P;S.ephemeral.extensions.byId[o.id]=o;let k=S.ephemeral.extensions.paneClasses;u&&_&&((M=_.panes)==null||M.forEach(L=>{delete k[L.class]})),(P=o.panes)==null||P.forEach(L=>{if(typeof L.class!="string")throw new Error("pane.class must be a string");if(L.class.length<3)throw new Error("pane.class should be a string with 3 or more characters");let z=k[L.class];if(z)if(u&&z.extensionId===o.id)console.warn('Pane class "'.concat(L.class,'" already exists. This is a bug in Theatre.js. Please report it at https://github.com/theatre-js/theatre/issues/new'));else throw new Error('Pane class "'.concat(L.class,'" already exists and is supplied by extension ').concat(z));k[L.class]={extensionId:o.id,classDefinition:L}})})}getStudioProject(o){return this._cache.get("getStudioProject",()=>o.getProject("Studio"))}getExtensionSheet(o,l){return this._cache.get("extensionSheet-"+o,()=>this.getStudioProject(l).sheet("Extension "+o))}undo(){this._store.undo()}redo(){this._store.redo()}createContentOfSaveFile(o){return this._store.createContentOfSaveFile(o)}createAssetStorage(o,l){return De(this,null,function*(){if(typeof window>"u")return{getAssetUrl:()=>"",createAsset:()=>Promise.resolve(null)};if(!("indexedDB"in window))return console.log("This browser doesn't support IndexedDB."),{getAssetUrl:L=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")},createAsset:L=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")}};let u=DPe("".concat(o.address.projectId,"-assets")),m=Kme(o),_=yield u.keys();yield Promise.all(_.map(L=>De(this,null,function*(){m.includes(L)||(yield u.del(L))}))),yield Promise.all(_.map(L=>De(this,null,function*(){var z,$;let H="".concat(l,"/").concat(L);try{(yield fetch(H,{method:"HEAD"})).ok&&(yield u.del(L))}catch{XP.error("Failed to access assets","Failed to access assets at ".concat(($=(z=o.config.assets)==null?void 0:z.baseUrl)!=null?$:"/",". This is likely due to a CORS issue."))}})));let S=new Map(yield u.entries()),M=new Map,P=L=>{if(M.has(L))return M.get(L);{let z=URL.createObjectURL(L);return M.set(L,z),z}},k=L=>{let z=S.get(L);if(!z)throw new Error("Asset with id ".concat(L," not found"));return P(z)};return{getAssetUrl:L=>S.has(L)?k(L):"".concat(l,"/").concat(L),createAsset:L=>De(this,null,function*(){var z,$,H;let j=Kme(o),K=!1;if(j.includes(L.name)){let Q;try{Q=(z=S.get(L.name))!=null?z:yield fetch("".concat(l,"/").concat(L.name)).then(re=>re.ok?re.blob():void 0)}catch{return XP.error("Failed to access assets","Failed to access assets at ".concat((H=($=o.config.assets)==null?void 0:$.baseUrl)!=null?H:"/",". This is likely due to a CORS issue.")),Promise.resolve(null)}if(Q){if(K=yield(yield Promise.resolve().then(()=>G(SAe()))).default.isEqual(L,Q),K)return L.name;{let re=ae=>{let ue=prompt(ae,L.name);return ue===null?!1:ue===""?re("Asset name cannot be empty. Please choose a different file name for this asset."):j.includes(ue)?(console.log(j),re("An asset with this name already exists. Please choose a different file name for this asset.")):(L=new File([L],ue,{type:L.type}),!0)};if(!re("An asset with this name already exists. Please choose a different file name for this asset."))return null}}}return S.set(L.name,L),yield u.set(L.name,L),L.name})}})}clearPersistentStorage(o=Zme){this._store.__experimental_clearPersistentStorage(o)}},kz="__TheatreJS_StudioBundle",BPe="__TheatreJS_CoreBundle",zPe="__TheatreJS_Notifications",VPe=class{constructor(o){this._studio=o,Me(this,"_coreBundle")}get type(){return"Theatre_StudioBundle"}registerCoreBundle(o){if(this._coreBundle)throw new Error("StudioBundle.coreBundle is already registered. This is a bug.");this._coreBundle=o;let l;o.getBitsForStudio(this._studio,u=>{l=u}),this._studio.setCoreBits(l)}},GPe=G(et());Jt();var Qme,jPe=ge.div(Qme||(Qme=X([""]))),HPe=o=>GPe.default.createElement(jPe,null),WPe=HPe;JB();var Dz=new UPe;He(Dz);var qPe=Dz.publicApi,$Pe=qPe;XPe();function XPe(){if(typeof window>"u")return;let o=window[kz];if(typeof o<"u")throw typeof o=="object"&&o&&typeof o.version=="string"?new Error(`It seems that the module '@tomorrowevening/theatre-studio' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@tomorrowevening/theatre-studio' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(kz," seems to be already set by a module other than @tomorrowevening/theatre-core."));let l=new VPe(Dz);window[kz]=l;let u=window[BPe];u&&u!==null&&u.type==="Theatre_CoreBundle"&&l.registerCoreBundle(u)}typeof window<"u"&&(window[zPe]={notify:XP});/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)

		queue-microtask/index.js:
		  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

		react/cjs/react.production.min.js:
		  (**
		   * @license React
		   * react.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		scheduler/cjs/scheduler.production.min.js:
		  (**
		   * @license React
		   * scheduler.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-dom/cjs/react-dom.production.min.js:
		  (**
		   * @license React
		   * react-dom.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v17.0.2
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v16.13.1
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		jiff/lib/lcs.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/array.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointerParse.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointer.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/clone.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPatch.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/jiff.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)
		*/}(PT,PT.exports)),PT.exports}var nNe=tNe();const Rve=Ave(nNe);/**
 * @license
 * Copyright 2010-2026 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const N4="183",X_={ROTATE:0,DOLLY:1,PAN:2},j_={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Ive=0,TH=1,Nve=2,rNe=0,Y_=1,kve=2,em=3,ol=0,Ui=1,no=2,vo=0,rl=1,p2=2,m2=3,g2=4,m4=5,SW=6,A0=100,Pk=101,Rk=102,wW=103,TW=104,Xf=200,CE=201,AE=202,PE=203,E4=204,M4=205,RE=206,IE=207,NE=208,kE=209,Ik=210,EW=211,MW=212,CW=213,AW=214,JT=0,eE=1,tE=2,C4=3,nE=4,rE=5,iE=6,sE=7,DE=0,Dve=1,Ove=2,Qa=0,Nk=1,kk=2,Dk=3,Ok=4,PW=5,Lk=6,Fk=7,e9e="attached",iNe="detached",j8=300,np=301,hm=302,K8=303,K_=304,i6=306,bd=1e3,Co=1001,s6=1002,Hi=1003,RW=1004,v2=1005,Bi=1006,Z_=1007,Tu=1008,sNe=1008,Yi=1009,Z8=1010,Q8=1011,Jf=1012,C0=1013,ys=1014,mo=1015,Gs=1016,Uk=1017,Bk=1018,Cu=1020,zk=35902,Vk=35899,IW=1021,OE=1022,$s=1023,al=1026,Wl=1027,LE=1028,zx=1029,Oc=1030,Vx=1031,oNe=1032,Gx=1033,g4=33776,v4=33777,y4=33778,_4=33779,oE=35840,aE=35841,lE=35842,cE=35843,ix=36196,sx=37492,ox=37496,ax=37488,lx=37489,o6=37490,cx=37491,ux=37808,dx=37809,hx=37810,fx=37811,px=37812,mx=37813,gx=37814,vx=37815,yx=37816,_x=37817,xx=37818,bx=37819,Sx=37820,wx=37821,Tx=36492,EH=36494,MH=36495,Ex=36283,Mx=36284,a6=36285,Cx=36286,aNe=2200,lNe=2201,cNe=2202,nk=2300,CH=2301,MG=2302,t9e=2303,H_=2400,W_=2401,rk=2402,NW=2500,uNe=2501,FE=3200,im=0,Lve=1,il="",ti="srgb",Fc="srgb-linear",Ax="linear",Wn="srgb",CG="",Fve="rg",dNe="ga",hNe=0,L8=7680,fNe=7681,pNe=7682,mNe=7683,gNe=34055,vNe=34056,yNe=5386,_Ne=512,xNe=513,bNe=514,SNe=515,wNe=516,TNe=517,ENe=518,AH=519,kW=512,Gk=513,DW=514,f6=515,OW=516,LW=517,p6=518,FW=519,Px=35044,uE=35048,PH="300 es",ql=2e3,Sd=2001,tm={COMPUTE:"compute",RENDER:"render"},x4={TEXTURE_COMPARE:"depthTextureCompare"};function MNe(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function dE(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function hE(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function Uve(){const i=hE("canvas");return i.style.display="block",i}const n9e={};function fE(...i){const e="THREE."+i.shift();console.log(e,...i)}function Bve(i){const e=i[0];if(typeof e=="string"&&e.startsWith("TSL:")){const t=i[1];t&&t.isStackTrace?i[0]+=" "+t.getLocation():i[1]='Stack trace not available. Enable "THREE.Node.captureStackTrace" to capture stack traces.'}return i}function Wt(...i){i=Bve(i);const e="THREE."+i.shift();{const t=i[0];t&&t.isStackTrace?console.warn(t.getError(e)):console.warn(e,...i)}}function jt(...i){i=Bve(i);const e="THREE."+i.shift();{const t=i[0];t&&t.isStackTrace?console.error(t.getError(e)):console.error(e,...i)}}function ns(...i){const e=i.join(" ");e in n9e||(n9e[e]=!0,Wt(...i))}function CNe(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}const UW={[JT]:eE,[tE]:iE,[nE]:sE,[C4]:rE,[eE]:JT,[iE]:tE,[sE]:nE,[rE]:C4};let Yl=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}};const zl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let r9e=1234567;const VT=Math.PI/180,l6=180/Math.PI;function ep(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(zl[i&255]+zl[i>>8&255]+zl[i>>16&255]+zl[i>>24&255]+"-"+zl[e&255]+zl[e>>8&255]+"-"+zl[e>>16&15|64]+zl[e>>24&255]+"-"+zl[t&63|128]+zl[t>>8&255]+"-"+zl[t>>16&255]+zl[t>>24&255]+zl[n&255]+zl[n>>8&255]+zl[n>>16&255]+zl[n>>24&255]).toLowerCase()}function di(i,e,t){return Math.max(e,Math.min(t,i))}function BW(i,e){return(i%e+e)%e}function ANe(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function PNe(i,e,t){return i!==e?(t-i)/(e-i):0}function GT(i,e,t){return(1-t)*i+t*e}function RNe(i,e,t,n){return GT(i,e,1-Math.exp(-t*n))}function INe(i,e=1){return e-Math.abs(BW(i,e*2)-e)}function NNe(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function kNe(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function DNe(i,e){return i+Math.floor(Math.random()*(e-i+1))}function ONe(i,e){return i+Math.random()*(e-i)}function LNe(i){return i*(.5-Math.random())}function FNe(i){i!==void 0&&(r9e=i);let e=r9e+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function UNe(i){return i*VT}function BNe(i){return i*l6}function zNe(i){return(i&i-1)===0&&i!==0}function VNe(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function GNe(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function jNe(i,e,t,n,r){const s=Math.cos,a=Math.sin,c=s(t/2),d=a(t/2),p=s((e+n)/2),y=a((e+n)/2),x=s((e-n)/2),w=a((e-n)/2),C=s((n-e)/2),N=a((n-e)/2);switch(r){case"XYX":i.set(c*y,d*x,d*w,c*p);break;case"YZY":i.set(d*w,c*y,d*x,c*p);break;case"ZXZ":i.set(d*x,d*w,c*y,c*p);break;case"XZX":i.set(c*y,d*N,d*C,c*p);break;case"YXY":i.set(d*C,c*y,d*N,c*p);break;case"ZYZ":i.set(d*N,d*C,c*y,c*p);break;default:Wt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function kc(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function ui(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const E0={DEG2RAD:VT,RAD2DEG:l6,generateUUID:ep,clamp:di,euclideanModulo:BW,mapLinear:ANe,inverseLerp:PNe,lerp:GT,damp:RNe,pingpong:INe,smoothstep:NNe,smootherstep:kNe,randInt:DNe,randFloat:ONe,randFloatSpread:LNe,seededRandom:FNe,degToRad:UNe,radToDeg:BNe,isPowerOfTwo:zNe,ceilPowerOfTwo:VNe,floorPowerOfTwo:GNe,setQuaternionFromProperEuler:jNe,normalize:ui,denormalize:kc};class vn{constructor(e=0,t=0){vn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=di(this.x,e.x,t.x),this.y=di(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=di(this.x,e,t),this.y=di(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(di(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(di(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*r+e.x,this.y=s*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class us{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,a,c){let d=n[r+0],p=n[r+1],y=n[r+2],x=n[r+3],w=s[a+0],C=s[a+1],N=s[a+2],F=s[a+3];if(x!==F||d!==w||p!==C||y!==N){let U=d*w+p*C+y*N+x*F;U<0&&(w=-w,C=-C,N=-N,F=-F,U=-U);let R=1-c;if(U<.9995){const B=Math.acos(U),Y=Math.sin(B);R=Math.sin(R*B)/Y,c=Math.sin(c*B)/Y,d=d*R+w*c,p=p*R+C*c,y=y*R+N*c,x=x*R+F*c}else{d=d*R+w*c,p=p*R+C*c,y=y*R+N*c,x=x*R+F*c;const B=1/Math.sqrt(d*d+p*p+y*y+x*x);d*=B,p*=B,y*=B,x*=B}}e[t]=d,e[t+1]=p,e[t+2]=y,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,s,a){const c=n[r],d=n[r+1],p=n[r+2],y=n[r+3],x=s[a],w=s[a+1],C=s[a+2],N=s[a+3];return e[t]=c*N+y*x+d*C-p*w,e[t+1]=d*N+y*w+p*x-c*C,e[t+2]=p*N+y*C+c*w-d*x,e[t+3]=y*N-c*x-d*w-p*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,a=e._order,c=Math.cos,d=Math.sin,p=c(n/2),y=c(r/2),x=c(s/2),w=d(n/2),C=d(r/2),N=d(s/2);switch(a){case"XYZ":this._x=w*y*x+p*C*N,this._y=p*C*x-w*y*N,this._z=p*y*N+w*C*x,this._w=p*y*x-w*C*N;break;case"YXZ":this._x=w*y*x+p*C*N,this._y=p*C*x-w*y*N,this._z=p*y*N-w*C*x,this._w=p*y*x+w*C*N;break;case"ZXY":this._x=w*y*x-p*C*N,this._y=p*C*x+w*y*N,this._z=p*y*N+w*C*x,this._w=p*y*x-w*C*N;break;case"ZYX":this._x=w*y*x-p*C*N,this._y=p*C*x+w*y*N,this._z=p*y*N-w*C*x,this._w=p*y*x+w*C*N;break;case"YZX":this._x=w*y*x+p*C*N,this._y=p*C*x+w*y*N,this._z=p*y*N-w*C*x,this._w=p*y*x-w*C*N;break;case"XZY":this._x=w*y*x-p*C*N,this._y=p*C*x-w*y*N,this._z=p*y*N+w*C*x,this._w=p*y*x+w*C*N;break;default:Wt("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],c=t[5],d=t[9],p=t[2],y=t[6],x=t[10],w=n+c+x;if(w>0){const C=.5/Math.sqrt(w+1);this._w=.25/C,this._x=(y-d)*C,this._y=(s-p)*C,this._z=(a-r)*C}else if(n>c&&n>x){const C=2*Math.sqrt(1+n-c-x);this._w=(y-d)/C,this._x=.25*C,this._y=(r+a)/C,this._z=(s+p)/C}else if(c>x){const C=2*Math.sqrt(1+c-n-x);this._w=(s-p)/C,this._x=(r+a)/C,this._y=.25*C,this._z=(d+y)/C}else{const C=2*Math.sqrt(1+x-n-c);this._w=(a-r)/C,this._x=(s+p)/C,this._y=(d+y)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(di(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w,c=t._x,d=t._y,p=t._z,y=t._w;return this._x=n*y+a*c+r*p-s*d,this._y=r*y+a*d+s*c-n*p,this._z=s*y+a*p+n*d-r*c,this._w=a*y-n*c-r*d-s*p,this._onChangeCallback(),this}slerp(e,t){let n=e._x,r=e._y,s=e._z,a=e._w,c=this.dot(e);c<0&&(n=-n,r=-r,s=-s,a=-a,c=-c);let d=1-t;if(c<.9995){const p=Math.acos(c),y=Math.sin(p);d=Math.sin(d*p)/y,t=Math.sin(t*p)/y,this._x=this._x*d+n*t,this._y=this._y*d+r*t,this._z=this._z*d+s*t,this._w=this._w*d+a*t,this._onChangeCallback()}else this._x=this._x*d+n*t,this._y=this._y*d+r*t,this._z=this._z*d+s*t,this._w=this._w*d+a*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class _e{constructor(e=0,t=0,n=0){_e.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(i9e.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(i9e.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,a=e.y,c=e.z,d=e.w,p=2*(a*r-c*n),y=2*(c*t-s*r),x=2*(s*n-a*t);return this.x=t+d*p+a*x-c*y,this.y=n+d*y+c*p-s*x,this.z=r+d*x+s*y-a*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=di(this.x,e.x,t.x),this.y=di(this.y,e.y,t.y),this.z=di(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=di(this.x,e,t),this.y=di(this.y,e,t),this.z=di(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(di(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,a=t.x,c=t.y,d=t.z;return this.x=r*d-s*c,this.y=s*a-n*d,this.z=n*c-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return AG.copy(this).projectOnVector(e),this.sub(AG)}reflect(e){return this.sub(AG.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(di(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const AG=new _e,i9e=new us;class Xr{constructor(e,t,n,r,s,a,c,d,p){Xr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,c,d,p)}set(e,t,n,r,s,a,c,d,p){const y=this.elements;return y[0]=e,y[1]=r,y[2]=c,y[3]=t,y[4]=s,y[5]=d,y[6]=n,y[7]=a,y[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],c=n[3],d=n[6],p=n[1],y=n[4],x=n[7],w=n[2],C=n[5],N=n[8],F=r[0],U=r[3],R=r[6],B=r[1],Y=r[4],A=r[7],ne=r[2],se=r[5],oe=r[8];return s[0]=a*F+c*B+d*ne,s[3]=a*U+c*Y+d*se,s[6]=a*R+c*A+d*oe,s[1]=p*F+y*B+x*ne,s[4]=p*U+y*Y+x*se,s[7]=p*R+y*A+x*oe,s[2]=w*F+C*B+N*ne,s[5]=w*U+C*Y+N*se,s[8]=w*R+C*A+N*oe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],p=e[7],y=e[8];return t*a*y-t*c*p-n*s*y+n*c*d+r*s*p-r*a*d}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],p=e[7],y=e[8],x=y*a-c*p,w=c*d-y*s,C=p*s-a*d,N=t*x+n*w+r*C;if(N===0)return this.set(0,0,0,0,0,0,0,0,0);const F=1/N;return e[0]=x*F,e[1]=(r*p-y*n)*F,e[2]=(c*n-r*a)*F,e[3]=w*F,e[4]=(y*t-r*d)*F,e[5]=(r*s-c*t)*F,e[6]=C*F,e[7]=(n*d-p*t)*F,e[8]=(a*t-n*s)*F,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,a,c){const d=Math.cos(s),p=Math.sin(s);return this.set(n*d,n*p,-n*(d*a+p*c)+a+e,-r*p,r*d,-r*(-p*a+d*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(PG.makeScale(e,t)),this}rotate(e){return this.premultiply(PG.makeRotation(-e)),this}translate(e,t){return this.premultiply(PG.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const PG=new Xr,s9e=new Xr().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),o9e=new Xr().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function HNe(){const i={enabled:!0,workingColorSpace:Fc,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Wn&&(r.r=x2(r.r),r.g=x2(r.g),r.b=x2(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Wn&&(r.r=Q_(r.r),r.g=Q_(r.g),r.b=Q_(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===il?Ax:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return ns("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return ns("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Fc]:{primaries:e,whitePoint:n,transfer:Ax,toXYZ:s9e,fromXYZ:o9e,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:ti},outputColorSpaceConfig:{drawingBufferColorSpace:ti}},[ti]:{primaries:e,whitePoint:n,transfer:Wn,toXYZ:s9e,fromXYZ:o9e,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:ti}}}),i}const Xn=HNe();function x2(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Q_(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let c_;class WNe{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{c_===void 0&&(c_=hE("canvas")),c_.width=e.width,c_.height=e.height;const r=c_.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=c_}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=hE("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=x2(s[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(x2(t[n]/255)*255):t[n]=x2(t[n]);return{data:t,width:e.width,height:e.height}}else return Wt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let qNe=0;class zW{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:qNe++}),this.uuid=ep(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,c=r.length;a<c;a++)r[a].isDataTexture?s.push(RG(r[a].image)):s.push(RG(r[a]))}else s=RG(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function RG(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?WNe.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Wt("Texture: Unable to serialize Texture."),{})}let $Ne=0;const IG=new _e;class ro extends Yl{constructor(e=ro.DEFAULT_IMAGE,t=ro.DEFAULT_MAPPING,n=Co,r=Co,s=Bi,a=Tu,c=$s,d=Yi,p=ro.DEFAULT_ANISOTROPY,y=il){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:$Ne++}),this.uuid=ep(),this.name="",this.source=new zW(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=d,this.offset=new vn(0,0),this.repeat=new vn(1,1),this.center=new vn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(IG).x}get height(){return this.source.getSize(IG).y}get depth(){return this.source.getSize(IG).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Wt(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Wt(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==j8)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case bd:e.x=e.x-Math.floor(e.x);break;case Co:e.x=e.x<0?0:1;break;case s6:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case bd:e.y=e.y-Math.floor(e.y);break;case Co:e.y=e.y<0?0:1;break;case s6:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ro.DEFAULT_IMAGE=null;ro.DEFAULT_MAPPING=j8;ro.DEFAULT_ANISOTROPY=1;class wr{constructor(e=0,t=0,n=0,r=1){wr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const d=e.elements,p=d[0],y=d[4],x=d[8],w=d[1],C=d[5],N=d[9],F=d[2],U=d[6],R=d[10];if(Math.abs(y-w)<.01&&Math.abs(x-F)<.01&&Math.abs(N-U)<.01){if(Math.abs(y+w)<.1&&Math.abs(x+F)<.1&&Math.abs(N+U)<.1&&Math.abs(p+C+R-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Y=(p+1)/2,A=(C+1)/2,ne=(R+1)/2,se=(y+w)/4,oe=(x+F)/4,G=(N+U)/4;return Y>A&&Y>ne?Y<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(Y),r=se/n,s=oe/n):A>ne?A<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(A),n=se/r,s=G/r):ne<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(ne),n=oe/s,r=G/s),this.set(n,r,s,t),this}let B=Math.sqrt((U-N)*(U-N)+(x-F)*(x-F)+(w-y)*(w-y));return Math.abs(B)<.001&&(B=1),this.x=(U-N)/B,this.y=(x-F)/B,this.z=(w-y)/B,this.w=Math.acos((p+C+R-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=di(this.x,e.x,t.x),this.y=di(this.y,e.y,t.y),this.z=di(this.z,e.z,t.z),this.w=di(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=di(this.x,e,t),this.y=di(this.y,e,t),this.z=di(this.z,e,t),this.w=di(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(di(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class lp extends Yl{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new wr(0,0,e,t),this.scissorTest=!1,this.viewport=new wr(0,0,e,t),this.textures=[];const r={width:e,height:t,depth:n.depth},s=new ro(r),a=n.count;for(let c=0;c<a;c++)this.textures[c]=s.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Bi,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new zW(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ja extends lp{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class VW extends ro{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Hi,this.minFilter=Hi,this.wrapR=Co,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class XNe extends ro{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Hi,this.minFilter=Hi,this.wrapR=Co,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class An{constructor(e,t,n,r,s,a,c,d,p,y,x,w,C,N,F,U){An.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,c,d,p,y,x,w,C,N,F,U)}set(e,t,n,r,s,a,c,d,p,y,x,w,C,N,F,U){const R=this.elements;return R[0]=e,R[4]=t,R[8]=n,R[12]=r,R[1]=s,R[5]=a,R[9]=c,R[13]=d,R[2]=p,R[6]=y,R[10]=x,R[14]=w,R[3]=C,R[7]=N,R[11]=F,R[15]=U,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new An().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,r=1/u_.setFromMatrixColumn(e,0).length(),s=1/u_.setFromMatrixColumn(e,1).length(),a=1/u_.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,a=Math.cos(n),c=Math.sin(n),d=Math.cos(r),p=Math.sin(r),y=Math.cos(s),x=Math.sin(s);if(e.order==="XYZ"){const w=a*y,C=a*x,N=c*y,F=c*x;t[0]=d*y,t[4]=-d*x,t[8]=p,t[1]=C+N*p,t[5]=w-F*p,t[9]=-c*d,t[2]=F-w*p,t[6]=N+C*p,t[10]=a*d}else if(e.order==="YXZ"){const w=d*y,C=d*x,N=p*y,F=p*x;t[0]=w+F*c,t[4]=N*c-C,t[8]=a*p,t[1]=a*x,t[5]=a*y,t[9]=-c,t[2]=C*c-N,t[6]=F+w*c,t[10]=a*d}else if(e.order==="ZXY"){const w=d*y,C=d*x,N=p*y,F=p*x;t[0]=w-F*c,t[4]=-a*x,t[8]=N+C*c,t[1]=C+N*c,t[5]=a*y,t[9]=F-w*c,t[2]=-a*p,t[6]=c,t[10]=a*d}else if(e.order==="ZYX"){const w=a*y,C=a*x,N=c*y,F=c*x;t[0]=d*y,t[4]=N*p-C,t[8]=w*p+F,t[1]=d*x,t[5]=F*p+w,t[9]=C*p-N,t[2]=-p,t[6]=c*d,t[10]=a*d}else if(e.order==="YZX"){const w=a*d,C=a*p,N=c*d,F=c*p;t[0]=d*y,t[4]=F-w*x,t[8]=N*x+C,t[1]=x,t[5]=a*y,t[9]=-c*y,t[2]=-p*y,t[6]=C*x+N,t[10]=w-F*x}else if(e.order==="XZY"){const w=a*d,C=a*p,N=c*d,F=c*p;t[0]=d*y,t[4]=-x,t[8]=p*y,t[1]=w*x+F,t[5]=a*y,t[9]=C*x-N,t[2]=N*x-C,t[6]=c*y,t[10]=F*x+w}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(YNe,e,KNe)}lookAt(e,t,n){const r=this.elements;return pd.subVectors(e,t),pd.lengthSq()===0&&(pd.z=1),pd.normalize(),j9.crossVectors(n,pd),j9.lengthSq()===0&&(Math.abs(n.z)===1?pd.x+=1e-4:pd.z+=1e-4,pd.normalize(),j9.crossVectors(n,pd)),j9.normalize(),wI.crossVectors(pd,j9),r[0]=j9.x,r[4]=wI.x,r[8]=pd.x,r[1]=j9.y,r[5]=wI.y,r[9]=pd.y,r[2]=j9.z,r[6]=wI.z,r[10]=pd.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],c=n[4],d=n[8],p=n[12],y=n[1],x=n[5],w=n[9],C=n[13],N=n[2],F=n[6],U=n[10],R=n[14],B=n[3],Y=n[7],A=n[11],ne=n[15],se=r[0],oe=r[4],G=r[8],ie=r[12],Me=r[1],X=r[5],De=r[9],$e=r[13],ot=r[2],He=r[6],ce=r[10],Ge=r[14],Ie=r[3],st=r[7],bt=r[11],Ne=r[15];return s[0]=a*se+c*Me+d*ot+p*Ie,s[4]=a*oe+c*X+d*He+p*st,s[8]=a*G+c*De+d*ce+p*bt,s[12]=a*ie+c*$e+d*Ge+p*Ne,s[1]=y*se+x*Me+w*ot+C*Ie,s[5]=y*oe+x*X+w*He+C*st,s[9]=y*G+x*De+w*ce+C*bt,s[13]=y*ie+x*$e+w*Ge+C*Ne,s[2]=N*se+F*Me+U*ot+R*Ie,s[6]=N*oe+F*X+U*He+R*st,s[10]=N*G+F*De+U*ce+R*bt,s[14]=N*ie+F*$e+U*Ge+R*Ne,s[3]=B*se+Y*Me+A*ot+ne*Ie,s[7]=B*oe+Y*X+A*He+ne*st,s[11]=B*G+Y*De+A*ce+ne*bt,s[15]=B*ie+Y*$e+A*Ge+ne*Ne,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],a=e[1],c=e[5],d=e[9],p=e[13],y=e[2],x=e[6],w=e[10],C=e[14],N=e[3],F=e[7],U=e[11],R=e[15],B=d*C-p*w,Y=c*C-p*x,A=c*w-d*x,ne=a*C-p*y,se=a*w-d*y,oe=a*x-c*y;return t*(F*B-U*Y+R*A)-n*(N*B-U*ne+R*se)+r*(N*Y-F*ne+R*oe)-s*(N*A-F*se+U*oe)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],p=e[7],y=e[8],x=e[9],w=e[10],C=e[11],N=e[12],F=e[13],U=e[14],R=e[15],B=t*c-n*a,Y=t*d-r*a,A=t*p-s*a,ne=n*d-r*c,se=n*p-s*c,oe=r*p-s*d,G=y*F-x*N,ie=y*U-w*N,Me=y*R-C*N,X=x*U-w*F,De=x*R-C*F,$e=w*R-C*U,ot=B*$e-Y*De+A*X+ne*Me-se*ie+oe*G;if(ot===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const He=1/ot;return e[0]=(c*$e-d*De+p*X)*He,e[1]=(r*De-n*$e-s*X)*He,e[2]=(F*oe-U*se+R*ne)*He,e[3]=(w*se-x*oe-C*ne)*He,e[4]=(d*Me-a*$e-p*ie)*He,e[5]=(t*$e-r*Me+s*ie)*He,e[6]=(U*A-N*oe-R*Y)*He,e[7]=(y*oe-w*A+C*Y)*He,e[8]=(a*De-c*Me+p*G)*He,e[9]=(n*Me-t*De-s*G)*He,e[10]=(N*se-F*A+R*B)*He,e[11]=(x*A-y*se-C*B)*He,e[12]=(c*ie-a*X-d*G)*He,e[13]=(t*X-n*ie+r*G)*He,e[14]=(F*Y-N*ne-U*B)*He,e[15]=(y*ne-x*Y+w*B)*He,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,a=e.x,c=e.y,d=e.z,p=s*a,y=s*c;return this.set(p*a+n,p*c-r*d,p*d+r*c,0,p*c+r*d,y*c+n,y*d-r*a,0,p*d-r*c,y*d+r*a,s*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,a){return this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,a=t._y,c=t._z,d=t._w,p=s+s,y=a+a,x=c+c,w=s*p,C=s*y,N=s*x,F=a*y,U=a*x,R=c*x,B=d*p,Y=d*y,A=d*x,ne=n.x,se=n.y,oe=n.z;return r[0]=(1-(F+R))*ne,r[1]=(C+A)*ne,r[2]=(N-Y)*ne,r[3]=0,r[4]=(C-A)*se,r[5]=(1-(w+R))*se,r[6]=(U+B)*se,r[7]=0,r[8]=(N+Y)*oe,r[9]=(U-B)*oe,r[10]=(1-(w+F))*oe,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;e.x=r[12],e.y=r[13],e.z=r[14];const s=this.determinant();if(s===0)return n.set(1,1,1),t.identity(),this;let a=u_.set(r[0],r[1],r[2]).length();const c=u_.set(r[4],r[5],r[6]).length(),d=u_.set(r[8],r[9],r[10]).length();s<0&&(a=-a),zf.copy(this);const p=1/a,y=1/c,x=1/d;return zf.elements[0]*=p,zf.elements[1]*=p,zf.elements[2]*=p,zf.elements[4]*=y,zf.elements[5]*=y,zf.elements[6]*=y,zf.elements[8]*=x,zf.elements[9]*=x,zf.elements[10]*=x,t.setFromRotationMatrix(zf),n.x=a,n.y=c,n.z=d,this}makePerspective(e,t,n,r,s,a,c=ql,d=!1){const p=this.elements,y=2*s/(t-e),x=2*s/(n-r),w=(t+e)/(t-e),C=(n+r)/(n-r);let N,F;if(d)N=s/(a-s),F=a*s/(a-s);else if(c===ql)N=-(a+s)/(a-s),F=-2*a*s/(a-s);else if(c===Sd)N=-a/(a-s),F=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return p[0]=y,p[4]=0,p[8]=w,p[12]=0,p[1]=0,p[5]=x,p[9]=C,p[13]=0,p[2]=0,p[6]=0,p[10]=N,p[14]=F,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,r,s,a,c=ql,d=!1){const p=this.elements,y=2/(t-e),x=2/(n-r),w=-(t+e)/(t-e),C=-(n+r)/(n-r);let N,F;if(d)N=1/(a-s),F=a/(a-s);else if(c===ql)N=-2/(a-s),F=-(a+s)/(a-s);else if(c===Sd)N=-1/(a-s),F=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return p[0]=y,p[4]=0,p[8]=0,p[12]=w,p[1]=0,p[5]=x,p[9]=0,p[13]=C,p[2]=0,p[6]=0,p[10]=N,p[14]=F,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const u_=new _e,zf=new An,YNe=new _e(0,0,0),KNe=new _e(1,1,1),j9=new _e,wI=new _e,pd=new _e,a9e=new An,l9e=new us;class Ao{constructor(e=0,t=0,n=0,r=Ao.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],a=r[4],c=r[8],d=r[1],p=r[5],y=r[9],x=r[2],w=r[6],C=r[10];switch(t){case"XYZ":this._y=Math.asin(di(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-y,C),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(w,p),this._z=0);break;case"YXZ":this._x=Math.asin(-di(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(c,C),this._z=Math.atan2(d,p)):(this._y=Math.atan2(-x,s),this._z=0);break;case"ZXY":this._x=Math.asin(di(w,-1,1)),Math.abs(w)<.9999999?(this._y=Math.atan2(-x,C),this._z=Math.atan2(-a,p)):(this._y=0,this._z=Math.atan2(d,s));break;case"ZYX":this._y=Math.asin(-di(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(w,C),this._z=Math.atan2(d,s)):(this._x=0,this._z=Math.atan2(-a,p));break;case"YZX":this._z=Math.asin(di(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-y,p),this._y=Math.atan2(-x,s)):(this._x=0,this._y=Math.atan2(c,C));break;case"XZY":this._z=Math.asin(-di(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(w,p),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-y,C),this._y=0);break;default:Wt("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return a9e.makeRotationFromQuaternion(e),this.setFromRotationMatrix(a9e,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return l9e.setFromEuler(this),this.setFromQuaternion(l9e,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ao.DEFAULT_ORDER="XYZ";class GW{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ZNe=0;const c9e=new _e,d_=new us,r2=new An,TI=new _e,Jw=new _e,QNe=new _e,JNe=new us,u9e=new _e(1,0,0),d9e=new _e(0,1,0),h9e=new _e(0,0,1),f9e={type:"added"},eke={type:"removed"},h_={type:"childadded",child:null},NG={type:"childremoved",child:null};class hi extends Yl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ZNe++}),this.uuid=ep(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=hi.DEFAULT_UP.clone();const e=new _e,t=new Ao,n=new us,r=new _e(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new An},normalMatrix:{value:new Xr}}),this.matrix=new An,this.matrixWorld=new An,this.matrixAutoUpdate=hi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new GW,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.static=!1,this.userData={},this.pivot=null}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return d_.setFromAxisAngle(e,t),this.quaternion.multiply(d_),this}rotateOnWorldAxis(e,t){return d_.setFromAxisAngle(e,t),this.quaternion.premultiply(d_),this}rotateX(e){return this.rotateOnAxis(u9e,e)}rotateY(e){return this.rotateOnAxis(d9e,e)}rotateZ(e){return this.rotateOnAxis(h9e,e)}translateOnAxis(e,t){return c9e.copy(e).applyQuaternion(this.quaternion),this.position.add(c9e.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(u9e,e)}translateY(e){return this.translateOnAxis(d9e,e)}translateZ(e){return this.translateOnAxis(h9e,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(r2.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?TI.copy(e):TI.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Jw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?r2.lookAt(Jw,TI,this.up):r2.lookAt(TI,Jw,this.up),this.quaternion.setFromRotationMatrix(r2),r&&(r2.extractRotation(r.matrixWorld),d_.setFromRotationMatrix(r2),this.quaternion.premultiply(d_.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(jt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(f9e),h_.child=e,this.dispatchEvent(h_),h_.child=null):jt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(eke),NG.child=e,this.dispatchEvent(NG),NG.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),r2.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),r2.multiply(e.parent.matrixWorld)),e.applyMatrix4(r2),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(f9e),h_.child=e,this.dispatchEvent(h_),h_.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jw,e,QNe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jw,JNe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);const e=this.pivot;if(e!==null){const t=e.x,n=e.y,r=e.z,s=this.matrix.elements;s[12]+=t-s[0]*t-s[4]*n-s[8]*r,s[13]+=n-s[1]*t-s[5]*n-s[9]*r,s[14]+=r-s[2]*t-s[6]*n-s[10]*r}this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),this.static!==!1&&(r.static=this.static),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.pivot!==null&&(r.pivot=this.pivot.toArray()),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.morphTargetDictionary!==void 0&&(r.morphTargetDictionary=Object.assign({},this.morphTargetDictionary)),this.morphTargetInfluences!==void 0&&(r.morphTargetInfluences=this.morphTargetInfluences.slice()),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(c=>({...c})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(c,d){return c[d.uuid]===void 0&&(c[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const d=c.shapes;if(Array.isArray(d))for(let p=0,y=d.length;p<y;p++){const x=d[p];s(e.shapes,x)}else s(e.shapes,d)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let d=0,p=this.material.length;d<p;d++)c.push(s(e.materials,this.material[d]));r.material=c}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){const d=this.animations[c];r.animations.push(s(e.animations,d))}}if(t){const c=a(e.geometries),d=a(e.materials),p=a(e.textures),y=a(e.images),x=a(e.shapes),w=a(e.skeletons),C=a(e.animations),N=a(e.nodes);c.length>0&&(n.geometries=c),d.length>0&&(n.materials=d),p.length>0&&(n.textures=p),y.length>0&&(n.images=y),x.length>0&&(n.shapes=x),w.length>0&&(n.skeletons=w),C.length>0&&(n.animations=C),N.length>0&&(n.nodes=N)}return n.object=r,n;function a(c){const d=[];for(const p in c){const y=c[p];delete y.metadata,d.push(y)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),e.pivot!==null&&(this.pivot=e.pivot.clone()),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.static=e.static,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}hi.DEFAULT_UP=new _e(0,1,0);hi.DEFAULT_MATRIX_AUTO_UPDATE=!0;hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;class H8 extends hi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const tke={type:"move"};class HN{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new H8,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new H8,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new _e,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new _e),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new H8,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new _e,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new _e),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,a=null;const c=this._targetRay,d=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){a=!0;for(const F of e.hand.values()){const U=t.getJointPose(F,n),R=this._getHandJoint(p,F);U!==null&&(R.matrix.fromArray(U.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.matrixWorldNeedsUpdate=!0,R.jointRadius=U.radius),R.visible=U!==null}const y=p.joints["index-finger-tip"],x=p.joints["thumb-tip"],w=y.position.distanceTo(x.position),C=.02,N=.005;p.inputState.pinching&&w>C+N?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&w<=C-N&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1));c!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(tke)))}return c!==null&&(c.visible=r!==null),d!==null&&(d.visible=s!==null),p!==null&&(p.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new H8;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const zve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},H9={h:0,s:0,l:0},EI={h:0,s:0,l:0};function kG(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class xn{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ti){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Xn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Xn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Xn.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Xn.workingColorSpace){if(e=BW(e,1),t=di(t,0,1),n=di(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=kG(a,s,e+1/3),this.g=kG(a,s,e),this.b=kG(a,s,e-1/3)}return Xn.colorSpaceToWorking(this,r),this}setStyle(e,t=ti){function n(s){s!==void 0&&parseFloat(s)<1&&Wt("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],c=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Wt("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);Wt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ti){const n=zve[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Wt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=x2(e.r),this.g=x2(e.g),this.b=x2(e.b),this}copyLinearToSRGB(e){return this.r=Q_(e.r),this.g=Q_(e.g),this.b=Q_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ti){return Xn.workingToColorSpace(Vl.copy(this),e),Math.round(di(Vl.r*255,0,255))*65536+Math.round(di(Vl.g*255,0,255))*256+Math.round(di(Vl.b*255,0,255))}getHexString(e=ti){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Xn.workingColorSpace){Xn.workingToColorSpace(Vl.copy(this),t);const n=Vl.r,r=Vl.g,s=Vl.b,a=Math.max(n,r,s),c=Math.min(n,r,s);let d,p;const y=(c+a)/2;if(c===a)d=0,p=0;else{const x=a-c;switch(p=y<=.5?x/(a+c):x/(2-a-c),a){case n:d=(r-s)/x+(r<s?6:0);break;case r:d=(s-n)/x+2;break;case s:d=(n-r)/x+4;break}d/=6}return e.h=d,e.s=p,e.l=y,e}getRGB(e,t=Xn.workingColorSpace){return Xn.workingToColorSpace(Vl.copy(this),t),e.r=Vl.r,e.g=Vl.g,e.b=Vl.b,e}getStyle(e=ti){Xn.workingToColorSpace(Vl.copy(this),e);const t=Vl.r,n=Vl.g,r=Vl.b;return e!==ti?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(H9),this.setHSL(H9.h+e,H9.s+t,H9.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(H9),e.getHSL(EI);const n=GT(H9.h,EI.h,t),r=GT(H9.s,EI.s,t),s=GT(H9.l,EI.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Vl=new xn;xn.NAMES=zve;class c6 extends hi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ao,this.environmentIntensity=1,this.environmentRotation=new Ao,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}const Vf=new _e,i2=new _e,DG=new _e,s2=new _e,f_=new _e,p_=new _e,p9e=new _e,OG=new _e,LG=new _e,FG=new _e,UG=new wr,BG=new wr,zG=new wr;class Zf{constructor(e=new _e,t=new _e,n=new _e){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Vf.subVectors(e,t),r.cross(Vf);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Vf.subVectors(r,t),i2.subVectors(n,t),DG.subVectors(e,t);const a=Vf.dot(Vf),c=Vf.dot(i2),d=Vf.dot(DG),p=i2.dot(i2),y=i2.dot(DG),x=a*p-c*c;if(x===0)return s.set(0,0,0),null;const w=1/x,C=(p*d-c*y)*w,N=(a*y-c*d)*w;return s.set(1-C-N,N,C)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,s2)===null?!1:s2.x>=0&&s2.y>=0&&s2.x+s2.y<=1}static getInterpolation(e,t,n,r,s,a,c,d){return this.getBarycoord(e,t,n,r,s2)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(s,s2.x),d.addScaledVector(a,s2.y),d.addScaledVector(c,s2.z),d)}static getInterpolatedAttribute(e,t,n,r,s,a){return UG.setScalar(0),BG.setScalar(0),zG.setScalar(0),UG.fromBufferAttribute(e,t),BG.fromBufferAttribute(e,n),zG.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(UG,s.x),a.addScaledVector(BG,s.y),a.addScaledVector(zG,s.z),a}static isFrontFacing(e,t,n,r){return Vf.subVectors(n,t),i2.subVectors(e,t),Vf.cross(i2).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Vf.subVectors(this.c,this.b),i2.subVectors(this.a,this.b),Vf.cross(i2).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Zf.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Zf.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return Zf.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Zf.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Zf.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,c;f_.subVectors(r,n),p_.subVectors(s,n),OG.subVectors(e,n);const d=f_.dot(OG),p=p_.dot(OG);if(d<=0&&p<=0)return t.copy(n);LG.subVectors(e,r);const y=f_.dot(LG),x=p_.dot(LG);if(y>=0&&x<=y)return t.copy(r);const w=d*x-y*p;if(w<=0&&d>=0&&y<=0)return a=d/(d-y),t.copy(n).addScaledVector(f_,a);FG.subVectors(e,s);const C=f_.dot(FG),N=p_.dot(FG);if(N>=0&&C<=N)return t.copy(s);const F=C*p-d*N;if(F<=0&&p>=0&&N<=0)return c=p/(p-N),t.copy(n).addScaledVector(p_,c);const U=y*N-C*x;if(U<=0&&x-y>=0&&C-N>=0)return p9e.subVectors(s,r),c=(x-y)/(x-y+(C-N)),t.copy(r).addScaledVector(p9e,c);const R=1/(U+F+w);return a=F*R,c=w*R,t.copy(n).addScaledVector(f_,a).addScaledVector(p_,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}class m6{constructor(e=new _e(1/0,1/0,1/0),t=new _e(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Gf.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Gf.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Gf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,c=s.count;a<c;a++)e.isMesh===!0?e.getVertexPosition(a,Gf):Gf.fromBufferAttribute(s,a),Gf.applyMatrix4(e.matrixWorld),this.expandByPoint(Gf);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),MI.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),MI.copy(n.boundingBox)),MI.applyMatrix4(e.matrixWorld),this.union(MI)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Gf),Gf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(eT),CI.subVectors(this.max,eT),m_.subVectors(e.a,eT),g_.subVectors(e.b,eT),v_.subVectors(e.c,eT),W9.subVectors(g_,m_),q9.subVectors(v_,g_),b8.subVectors(m_,v_);let t=[0,-W9.z,W9.y,0,-q9.z,q9.y,0,-b8.z,b8.y,W9.z,0,-W9.x,q9.z,0,-q9.x,b8.z,0,-b8.x,-W9.y,W9.x,0,-q9.y,q9.x,0,-b8.y,b8.x,0];return!VG(t,m_,g_,v_,CI)||(t=[1,0,0,0,1,0,0,0,1],!VG(t,m_,g_,v_,CI))?!1:(AI.crossVectors(W9,q9),t=[AI.x,AI.y,AI.z],VG(t,m_,g_,v_,CI))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Gf).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Gf).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(o2[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),o2[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),o2[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),o2[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),o2[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),o2[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),o2[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),o2[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(o2),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const o2=[new _e,new _e,new _e,new _e,new _e,new _e,new _e,new _e],Gf=new _e,MI=new m6,m_=new _e,g_=new _e,v_=new _e,W9=new _e,q9=new _e,b8=new _e,eT=new _e,CI=new _e,AI=new _e,S8=new _e;function VG(i,e,t,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){S8.fromArray(i,s);const c=r.x*Math.abs(S8.x)+r.y*Math.abs(S8.y)+r.z*Math.abs(S8.z),d=e.dot(S8),p=t.dot(S8),y=n.dot(S8);if(Math.max(-Math.max(d,p,y),Math.min(d,p,y))>c)return!1}return!0}const h2=nke();function nke(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let d=0;d<256;++d){const p=d-127;p<-27?(n[d]=0,n[d|256]=32768,r[d]=24,r[d|256]=24):p<-14?(n[d]=1024>>-p-14,n[d|256]=1024>>-p-14|32768,r[d]=-p-1,r[d|256]=-p-1):p<=15?(n[d]=p+15<<10,n[d|256]=p+15<<10|32768,r[d]=13,r[d|256]=13):p<128?(n[d]=31744,n[d|256]=64512,r[d]=24,r[d|256]=24):(n[d]=31744,n[d|256]=64512,r[d]=13,r[d|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),c=new Uint32Array(64);for(let d=1;d<1024;++d){let p=d<<13,y=0;for(;(p&8388608)===0;)p<<=1,y-=8388608;p&=-8388609,y+=947912704,s[d]=p|y}for(let d=1024;d<2048;++d)s[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)a[d]=d<<23;a[31]=1199570944,a[32]=2147483648;for(let d=33;d<63;++d)a[d]=2147483648+(d-32<<23);a[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(c[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:c}}function Su(i){Math.abs(i)>65504&&Wt("DataUtils.toHalfFloat(): Value out of range."),i=di(i,-65504,65504),h2.floatView[0]=i;const e=h2.uint32View[0],t=e>>23&511;return h2.baseTable[t]+((e&8388607)>>h2.shiftTable[t])}function IT(i){const e=i>>10;return h2.uint32View[0]=h2.mantissaTable[h2.offsetTable[e]+(i&1023)]+h2.exponentTable[e],h2.floatView[0]}class m9e{static toHalfFloat(e){return Su(e)}static fromHalfFloat(e){return IT(e)}}const Oa=new _e,PI=new vn;let rke=0;class Ba{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:rke++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Px,this.updateRanges=[],this.gpuType=mo,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)PI.fromBufferAttribute(this,t),PI.applyMatrix3(e),this.setXY(t,PI.x,PI.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Oa.fromBufferAttribute(this,t),Oa.applyMatrix3(e),this.setXYZ(t,Oa.x,Oa.y,Oa.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Oa.fromBufferAttribute(this,t),Oa.applyMatrix4(e),this.setXYZ(t,Oa.x,Oa.y,Oa.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Oa.fromBufferAttribute(this,t),Oa.applyNormalMatrix(e),this.setXYZ(t,Oa.x,Oa.y,Oa.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Oa.fromBufferAttribute(this,t),Oa.transformDirection(e),this.setXYZ(t,Oa.x,Oa.y,Oa.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=kc(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ui(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=kc(t,this.array)),t}setX(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=kc(t,this.array)),t}setY(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=kc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=kc(t,this.array)),t}setW(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),r=ui(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),r=ui(r,this.array),s=ui(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Px&&(e.usage=this.usage),e}}class jk extends Ba{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class jW extends Ba{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Vve extends Ba{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=IT(this.array[e*this.itemSize]);return this.normalized&&(t=kc(t,this.array)),t}setX(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize]=Su(t),this}getY(e){let t=IT(this.array[e*this.itemSize+1]);return this.normalized&&(t=kc(t,this.array)),t}setY(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+1]=Su(t),this}getZ(e){let t=IT(this.array[e*this.itemSize+2]);return this.normalized&&(t=kc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+2]=Su(t),this}getW(e){let t=IT(this.array[e*this.itemSize+3]);return this.normalized&&(t=kc(t,this.array)),t}setW(e,t){return this.normalized&&(t=ui(t,this.array)),this.array[e*this.itemSize+3]=Su(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array)),this.array[e+0]=Su(t),this.array[e+1]=Su(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),r=ui(r,this.array)),this.array[e+0]=Su(t),this.array[e+1]=Su(n),this.array[e+2]=Su(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),r=ui(r,this.array),s=ui(s,this.array)),this.array[e+0]=Su(t),this.array[e+1]=Su(n),this.array[e+2]=Su(r),this.array[e+3]=Su(s),this}}class Rr extends Ba{constructor(e,t,n){super(new Float32Array(e),t,n)}}const ike=new m6,tT=new _e,GG=new _e;class M2{constructor(e=new _e,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):ike.setFromPoints(e).getCenter(n);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;tT.subVectors(e,this.center);const t=tT.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(tT,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(GG.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(tT.copy(e.center).add(GG)),this.expandByPoint(tT.copy(e.center).sub(GG))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}let ske=0;const gh=new An,jG=new hi,y_=new _e,md=new m6,nT=new m6,T0=new _e;class Ii extends Yl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ske++}),this.uuid=ep(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(MNe(e)?jW:jk)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Xr().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return gh.makeRotationFromQuaternion(e),this.applyMatrix4(gh),this}rotateX(e){return gh.makeRotationX(e),this.applyMatrix4(gh),this}rotateY(e){return gh.makeRotationY(e),this.applyMatrix4(gh),this}rotateZ(e){return gh.makeRotationZ(e),this.applyMatrix4(gh),this}translate(e,t,n){return gh.makeTranslation(e,t,n),this.applyMatrix4(gh),this}scale(e,t,n){return gh.makeScale(e,t,n),this.applyMatrix4(gh),this}lookAt(e){return jG.lookAt(e),jG.updateMatrix(),this.applyMatrix4(jG.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(y_).negate(),this.translate(y_.x,y_.y,y_.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Rr(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&Wt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new m6);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){jt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new _e(-1/0,-1/0,-1/0),new _e(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];md.setFromBufferAttribute(s),this.morphTargetsRelative?(T0.addVectors(this.boundingBox.min,md.min),this.boundingBox.expandByPoint(T0),T0.addVectors(this.boundingBox.max,md.max),this.boundingBox.expandByPoint(T0)):(this.boundingBox.expandByPoint(md.min),this.boundingBox.expandByPoint(md.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&jt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new M2);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){jt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new _e,1/0);return}if(e){const n=this.boundingSphere.center;if(md.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const c=t[s];nT.setFromBufferAttribute(c),this.morphTargetsRelative?(T0.addVectors(md.min,nT.min),md.expandByPoint(T0),T0.addVectors(md.max,nT.max),md.expandByPoint(T0)):(md.expandByPoint(nT.min),md.expandByPoint(nT.max))}md.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)T0.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(T0));if(t)for(let s=0,a=t.length;s<a;s++){const c=t[s],d=this.morphTargetsRelative;for(let p=0,y=c.count;p<y;p++)T0.fromBufferAttribute(c,p),d&&(y_.fromBufferAttribute(e,p),T0.add(y_)),r=Math.max(r,n.distanceToSquared(T0))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&jt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){jt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ba(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),c=[],d=[];for(let G=0;G<n.count;G++)c[G]=new _e,d[G]=new _e;const p=new _e,y=new _e,x=new _e,w=new vn,C=new vn,N=new vn,F=new _e,U=new _e;function R(G,ie,Me){p.fromBufferAttribute(n,G),y.fromBufferAttribute(n,ie),x.fromBufferAttribute(n,Me),w.fromBufferAttribute(s,G),C.fromBufferAttribute(s,ie),N.fromBufferAttribute(s,Me),y.sub(p),x.sub(p),C.sub(w),N.sub(w);const X=1/(C.x*N.y-N.x*C.y);isFinite(X)&&(F.copy(y).multiplyScalar(N.y).addScaledVector(x,-C.y).multiplyScalar(X),U.copy(x).multiplyScalar(C.x).addScaledVector(y,-N.x).multiplyScalar(X),c[G].add(F),c[ie].add(F),c[Me].add(F),d[G].add(U),d[ie].add(U),d[Me].add(U))}let B=this.groups;B.length===0&&(B=[{start:0,count:e.count}]);for(let G=0,ie=B.length;G<ie;++G){const Me=B[G],X=Me.start,De=Me.count;for(let $e=X,ot=X+De;$e<ot;$e+=3)R(e.getX($e+0),e.getX($e+1),e.getX($e+2))}const Y=new _e,A=new _e,ne=new _e,se=new _e;function oe(G){ne.fromBufferAttribute(r,G),se.copy(ne);const ie=c[G];Y.copy(ie),Y.sub(ne.multiplyScalar(ne.dot(ie))).normalize(),A.crossVectors(se,ie);const X=A.dot(d[G])<0?-1:1;a.setXYZW(G,Y.x,Y.y,Y.z,X)}for(let G=0,ie=B.length;G<ie;++G){const Me=B[G],X=Me.start,De=Me.count;for(let $e=X,ot=X+De;$e<ot;$e+=3)oe(e.getX($e+0)),oe(e.getX($e+1)),oe(e.getX($e+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ba(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let w=0,C=n.count;w<C;w++)n.setXYZ(w,0,0,0);const r=new _e,s=new _e,a=new _e,c=new _e,d=new _e,p=new _e,y=new _e,x=new _e;if(e)for(let w=0,C=e.count;w<C;w+=3){const N=e.getX(w+0),F=e.getX(w+1),U=e.getX(w+2);r.fromBufferAttribute(t,N),s.fromBufferAttribute(t,F),a.fromBufferAttribute(t,U),y.subVectors(a,s),x.subVectors(r,s),y.cross(x),c.fromBufferAttribute(n,N),d.fromBufferAttribute(n,F),p.fromBufferAttribute(n,U),c.add(y),d.add(y),p.add(y),n.setXYZ(N,c.x,c.y,c.z),n.setXYZ(F,d.x,d.y,d.z),n.setXYZ(U,p.x,p.y,p.z)}else for(let w=0,C=t.count;w<C;w+=3)r.fromBufferAttribute(t,w+0),s.fromBufferAttribute(t,w+1),a.fromBufferAttribute(t,w+2),y.subVectors(a,s),x.subVectors(r,s),y.cross(x),n.setXYZ(w+0,y.x,y.y,y.z),n.setXYZ(w+1,y.x,y.y,y.z),n.setXYZ(w+2,y.x,y.y,y.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)T0.fromBufferAttribute(e,t),T0.normalize(),e.setXYZ(t,T0.x,T0.y,T0.z)}toNonIndexed(){function e(c,d){const p=c.array,y=c.itemSize,x=c.normalized,w=new p.constructor(d.length*y);let C=0,N=0;for(let F=0,U=d.length;F<U;F++){c.isInterleavedBufferAttribute?C=d[F]*c.data.stride+c.offset:C=d[F]*y;for(let R=0;R<y;R++)w[N++]=p[C++]}return new Ba(w,y,x)}if(this.index===null)return Wt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ii,n=this.index.array,r=this.attributes;for(const c in r){const d=r[c],p=e(d,n);t.setAttribute(c,p)}const s=this.morphAttributes;for(const c in s){const d=[],p=s[c];for(let y=0,x=p.length;y<x;y++){const w=p[y],C=e(w,n);d.push(C)}t.morphAttributes[c]=d}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,d=a.length;c<d;c++){const p=a[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const p in d)d[p]!==void 0&&(e[p]=d[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const p=n[d];e.data.attributes[d]=p.toJSON(e.data)}const r={};let s=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],y=[];for(let x=0,w=p.length;x<w;x++){const C=p[x];y.push(C.toJSON(e.data))}y.length>0&&(r[d]=y,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const y=r[p];this.setAttribute(p,y.clone(t))}const s=e.morphAttributes;for(const p in s){const y=[],x=s[p];for(let w=0,C=x.length;w<C;w++)y.push(x[w].clone(t));this.morphAttributes[p]=y}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let p=0,y=a.length;p<y;p++){const x=a[p];this.addGroup(x.start,x.count,x.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Gve{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Px,this.updateRanges=[],this.version=0,this.uuid=ep()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ep()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ep()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ac=new _e;class HW{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ac.fromBufferAttribute(this,t),Ac.applyMatrix4(e),this.setXYZ(t,Ac.x,Ac.y,Ac.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ac.fromBufferAttribute(this,t),Ac.applyNormalMatrix(e),this.setXYZ(t,Ac.x,Ac.y,Ac.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ac.fromBufferAttribute(this,t),Ac.transformDirection(e),this.setXYZ(t,Ac.x,Ac.y,Ac.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=kc(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ui(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=kc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=kc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=kc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=kc(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),r=ui(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ui(t,this.array),n=ui(n,this.array),r=ui(r,this.array),s=ui(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){fE("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Ba(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new HW(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){fE("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}let oke=0;class R0 extends Yl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:oke++}),this.uuid=ep(),this.name="",this.type="Material",this.blending=rl,this.side=ol,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=E4,this.blendDst=M4,this.blendEquation=A0,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xn(0,0,0),this.blendAlpha=0,this.depthFunc=C4,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AH,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=L8,this.stencilZFail=L8,this.stencilZPass=L8,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Wt(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Wt(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==rl&&(n.blending=this.blending),this.side!==ol&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==E4&&(n.blendSrc=this.blendSrc),this.blendDst!==M4&&(n.blendDst=this.blendDst),this.blendEquation!==A0&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==C4&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AH&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==L8&&(n.stencilFail=this.stencilFail),this.stencilZFail!==L8&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==L8&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const a=[];for(const c in s){const d=s[c];delete d.metadata,a.push(d)}return a}if(t){const s=r(e.textures),a=r(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class ake extends R0{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new xn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const a2=new _e,HG=new _e,RI=new _e,$9=new _e,WG=new _e,II=new _e,qG=new _e;class jx{constructor(e=new _e,t=new _e(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,a2)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=a2.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(a2.copy(this.origin).addScaledVector(this.direction,t),a2.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){HG.copy(e).add(t).multiplyScalar(.5),RI.copy(t).sub(e).normalize(),$9.copy(this.origin).sub(HG);const s=e.distanceTo(t)*.5,a=-this.direction.dot(RI),c=$9.dot(this.direction),d=-$9.dot(RI),p=$9.lengthSq(),y=Math.abs(1-a*a);let x,w,C,N;if(y>0)if(x=a*d-c,w=a*c-d,N=s*y,x>=0)if(w>=-N)if(w<=N){const F=1/y;x*=F,w*=F,C=x*(x+a*w+2*c)+w*(a*x+w+2*d)+p}else w=s,x=Math.max(0,-(a*w+c)),C=-x*x+w*(w+2*d)+p;else w=-s,x=Math.max(0,-(a*w+c)),C=-x*x+w*(w+2*d)+p;else w<=-N?(x=Math.max(0,-(-a*s+c)),w=x>0?-s:Math.min(Math.max(-s,-d),s),C=-x*x+w*(w+2*d)+p):w<=N?(x=0,w=Math.min(Math.max(-s,-d),s),C=w*(w+2*d)+p):(x=Math.max(0,-(a*s+c)),w=x>0?s:Math.min(Math.max(-s,-d),s),C=-x*x+w*(w+2*d)+p);else w=a>0?-s:s,x=Math.max(0,-(a*w+c)),C=-x*x+w*(w+2*d)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(HG).addScaledVector(RI,w),C}intersectSphere(e,t){a2.subVectors(e.center,this.origin);const n=a2.dot(this.direction),r=a2.dot(a2)-n*n,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),c=n-a,d=n+a;return d<0?null:c<0?this.at(d,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,a,c,d;const p=1/this.direction.x,y=1/this.direction.y,x=1/this.direction.z,w=this.origin;return p>=0?(n=(e.min.x-w.x)*p,r=(e.max.x-w.x)*p):(n=(e.max.x-w.x)*p,r=(e.min.x-w.x)*p),y>=0?(s=(e.min.y-w.y)*y,a=(e.max.y-w.y)*y):(s=(e.max.y-w.y)*y,a=(e.min.y-w.y)*y),n>a||s>r||((s>n||isNaN(n))&&(n=s),(a<r||isNaN(r))&&(r=a),x>=0?(c=(e.min.z-w.z)*x,d=(e.max.z-w.z)*x):(c=(e.max.z-w.z)*x,d=(e.min.z-w.z)*x),n>d||c>r)||((c>n||n!==n)&&(n=c),(d<r||r!==r)&&(r=d),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,a2)!==null}intersectTriangle(e,t,n,r,s){WG.subVectors(t,e),II.subVectors(n,e),qG.crossVectors(WG,II);let a=this.direction.dot(qG),c;if(a>0){if(r)return null;c=1}else if(a<0)c=-1,a=-a;else return null;$9.subVectors(this.origin,e);const d=c*this.direction.dot(II.crossVectors($9,II));if(d<0)return null;const p=c*this.direction.dot(WG.cross($9));if(p<0||d+p>a)return null;const y=-c*$9.dot(qG);return y<0?null:this.at(y/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ua extends R0{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ao,this.combine=DE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const g9e=new An,w8=new jx,NI=new M2,v9e=new _e,kI=new _e,DI=new _e,OI=new _e,$G=new _e,LI=new _e,y9e=new _e,FI=new _e;class fn extends hi{constructor(e=new Ii,t=new Ua){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const c=this.morphTargetInfluences;if(s&&c){LI.set(0,0,0);for(let d=0,p=s.length;d<p;d++){const y=c[d],x=s[d];y!==0&&($G.fromBufferAttribute(x,e),a?LI.addScaledVector($G,y):LI.addScaledVector($G.sub(t),y))}t.add(LI)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),NI.copy(n.boundingSphere),NI.applyMatrix4(s),w8.copy(e.ray).recast(e.near),!(NI.containsPoint(w8.origin)===!1&&(w8.intersectSphere(NI,v9e)===null||w8.origin.distanceToSquared(v9e)>(e.far-e.near)**2))&&(g9e.copy(s).invert(),w8.copy(e.ray).applyMatrix4(g9e),!(n.boundingBox!==null&&w8.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,w8)))}_computeIntersections(e,t,n){let r;const s=this.geometry,a=this.material,c=s.index,d=s.attributes.position,p=s.attributes.uv,y=s.attributes.uv1,x=s.attributes.normal,w=s.groups,C=s.drawRange;if(c!==null)if(Array.isArray(a))for(let N=0,F=w.length;N<F;N++){const U=w[N],R=a[U.materialIndex],B=Math.max(U.start,C.start),Y=Math.min(c.count,Math.min(U.start+U.count,C.start+C.count));for(let A=B,ne=Y;A<ne;A+=3){const se=c.getX(A),oe=c.getX(A+1),G=c.getX(A+2);r=UI(this,R,e,n,p,y,x,se,oe,G),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const N=Math.max(0,C.start),F=Math.min(c.count,C.start+C.count);for(let U=N,R=F;U<R;U+=3){const B=c.getX(U),Y=c.getX(U+1),A=c.getX(U+2);r=UI(this,a,e,n,p,y,x,B,Y,A),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}else if(d!==void 0)if(Array.isArray(a))for(let N=0,F=w.length;N<F;N++){const U=w[N],R=a[U.materialIndex],B=Math.max(U.start,C.start),Y=Math.min(d.count,Math.min(U.start+U.count,C.start+C.count));for(let A=B,ne=Y;A<ne;A+=3){const se=A,oe=A+1,G=A+2;r=UI(this,R,e,n,p,y,x,se,oe,G),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const N=Math.max(0,C.start),F=Math.min(d.count,C.start+C.count);for(let U=N,R=F;U<R;U+=3){const B=U,Y=U+1,A=U+2;r=UI(this,a,e,n,p,y,x,B,Y,A),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}}}function lke(i,e,t,n,r,s,a,c){let d;if(e.side===Ui?d=n.intersectTriangle(a,s,r,!0,c):d=n.intersectTriangle(r,s,a,e.side===ol,c),d===null)return null;FI.copy(c),FI.applyMatrix4(i.matrixWorld);const p=t.ray.origin.distanceTo(FI);return p<t.near||p>t.far?null:{distance:p,point:FI.clone(),object:i}}function UI(i,e,t,n,r,s,a,c,d,p){i.getVertexPosition(c,kI),i.getVertexPosition(d,DI),i.getVertexPosition(p,OI);const y=lke(i,e,t,n,kI,DI,OI,y9e);if(y){const x=new _e;Zf.getBarycoord(y9e,kI,DI,OI,x),r&&(y.uv=Zf.getInterpolatedAttribute(r,c,d,p,x,new vn)),s&&(y.uv1=Zf.getInterpolatedAttribute(s,c,d,p,x,new vn)),a&&(y.normal=Zf.getInterpolatedAttribute(a,c,d,p,x,new _e),y.normal.dot(n.direction)>0&&y.normal.multiplyScalar(-1));const w={a:c,b:d,c:p,normal:new _e,materialIndex:0};Zf.getNormal(kI,DI,OI,w.normal),y.face=w,y.barycoord=x}return y}const _9e=new _e,x9e=new wr,b9e=new wr,cke=new _e,S9e=new An,BI=new _e,XG=new M2,w9e=new An,YG=new jx;class WW extends fn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=e9e,this.bindMatrix=new An,this.bindMatrixInverse=new An,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new m6),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,BI),this.boundingBox.expandByPoint(BI)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new M2),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,BI),this.boundingSphere.expandByPoint(BI)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),XG.copy(this.boundingSphere),XG.applyMatrix4(r),e.ray.intersectsSphere(XG)!==!1&&(w9e.copy(r).invert(),YG.copy(e.ray).applyMatrix4(w9e),!(this.boundingBox!==null&&YG.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,YG)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new wr,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===e9e?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===iNe?this.bindMatrixInverse.copy(this.bindMatrix).invert():Wt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;x9e.fromBufferAttribute(r.attributes.skinIndex,e),b9e.fromBufferAttribute(r.attributes.skinWeight,e),_9e.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=b9e.getComponent(s);if(a!==0){const c=x9e.getComponent(s);S9e.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(cke.copy(_9e).applyMatrix4(S9e),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class RH extends hi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class d4 extends ro{constructor(e=null,t=1,n=1,r,s,a,c,d,p=Hi,y=Hi,x,w){super(null,a,c,d,p,y,r,s,x,w),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const T9e=new An,uke=new An;class qW{constructor(e=[],t=[]){this.uuid=ep(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Wt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new An)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new An;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const c=e[s]?e[s].matrixWorld:uke;T9e.multiplyMatrices(c,t[s]),T9e.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new qW(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new d4(t,e,e,$s,mo);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let a=t[s];a===void 0&&(Wt("Skeleton: No bone found with UUID:",s),a=new RH),this.bones.push(a),this.boneInverses.push(new An().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const a=t[r];e.bones.push(a.uuid);const c=n[r];e.boneInverses.push(c.toArray())}return e}}class J_ extends Ba{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const KG=new _e,dke=new _e,hke=new Xr;class Z1{constructor(e=new _e(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=KG.subVectors(n,t).cross(dke.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(KG),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||hke.getNormalMatrix(e),r=this.coplanarPoint(KG).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const T8=new M2,fke=new vn(.5,.5),zI=new _e;class UE{constructor(e=new Z1,t=new Z1,n=new Z1,r=new Z1,s=new Z1,a=new Z1){this.planes=[e,t,n,r,s,a]}set(e,t,n,r,s,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(s),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=ql,n=!1){const r=this.planes,s=e.elements,a=s[0],c=s[1],d=s[2],p=s[3],y=s[4],x=s[5],w=s[6],C=s[7],N=s[8],F=s[9],U=s[10],R=s[11],B=s[12],Y=s[13],A=s[14],ne=s[15];if(r[0].setComponents(p-a,C-y,R-N,ne-B).normalize(),r[1].setComponents(p+a,C+y,R+N,ne+B).normalize(),r[2].setComponents(p+c,C+x,R+F,ne+Y).normalize(),r[3].setComponents(p-c,C-x,R-F,ne-Y).normalize(),n)r[4].setComponents(d,w,U,A).normalize(),r[5].setComponents(p-d,C-w,R-U,ne-A).normalize();else if(r[4].setComponents(p-d,C-w,R-U,ne-A).normalize(),t===ql)r[5].setComponents(p+d,C+w,R+U,ne+A).normalize();else if(t===Sd)r[5].setComponents(d,w,U,A).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),T8.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),T8.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(T8)}intersectsSprite(e){T8.center.set(0,0,0);const t=fke.distanceTo(e.center);return T8.radius=.7071067811865476+t,T8.applyMatrix4(e.matrixWorld),this.intersectsSphere(T8)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(zI.x=r.normal.x>0?e.max.x:e.min.x,zI.y=r.normal.y>0?e.max.y:e.min.y,zI.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(zI)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const D1=new An,O1=new UE;class $W{constructor(){this.coordinateSystem=ql}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(D1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),O1.setFromProjectionMatrix(D1,r.coordinateSystem,r.reversedDepth),O1.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(D1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),O1.setFromProjectionMatrix(D1,r.coordinateSystem,r.reversedDepth),O1.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(D1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),O1.setFromProjectionMatrix(D1,r.coordinateSystem,r.reversedDepth),O1.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(D1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),O1.setFromProjectionMatrix(D1,r.coordinateSystem,r.reversedDepth),O1.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(D1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),O1.setFromProjectionMatrix(D1,r.coordinateSystem,r.reversedDepth),O1.containsPoint(e))return!0}return!1}clone(){return new $W}}class Td extends R0{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new xn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ik=new _e,sk=new _e,E9e=new An,rT=new jx,VI=new M2,ZG=new _e,M9e=new _e;class wu extends hi{constructor(e=new Ii,t=new Td){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)ik.fromBufferAttribute(t,r-1),sk.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=ik.distanceTo(sk);e.setAttribute("lineDistance",new Rr(n,1))}else Wt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),VI.copy(n.boundingSphere),VI.applyMatrix4(r),VI.radius+=s,e.ray.intersectsSphere(VI)===!1)return;E9e.copy(r).invert(),rT.copy(e.ray).applyMatrix4(E9e);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,p=this.isLineSegments?2:1,y=n.index,w=n.attributes.position;if(y!==null){const C=Math.max(0,a.start),N=Math.min(y.count,a.start+a.count);for(let F=C,U=N-1;F<U;F+=p){const R=y.getX(F),B=y.getX(F+1),Y=GI(this,e,rT,d,R,B,F);Y&&t.push(Y)}if(this.isLineLoop){const F=y.getX(N-1),U=y.getX(C),R=GI(this,e,rT,d,F,U,N-1);R&&t.push(R)}}else{const C=Math.max(0,a.start),N=Math.min(w.count,a.start+a.count);for(let F=C,U=N-1;F<U;F+=p){const R=GI(this,e,rT,d,F,F+1,F);R&&t.push(R)}if(this.isLineLoop){const F=GI(this,e,rT,d,N-1,C,N-1);F&&t.push(F)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}function GI(i,e,t,n,r,s,a){const c=i.geometry.attributes.position;if(ik.fromBufferAttribute(c,r),sk.fromBufferAttribute(c,s),t.distanceSqToSegment(ik,sk,ZG,M9e)>n)return;ZG.applyMatrix4(i.matrixWorld);const p=e.ray.origin.distanceTo(ZG);if(!(p<e.near||p>e.far))return{distance:p,point:M9e.clone().applyMatrix4(i.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:i}}const C9e=new _e,A9e=new _e;class BE extends wu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)C9e.fromBufferAttribute(t,r),A9e.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+C9e.distanceTo(A9e);e.setAttribute("lineDistance",new Rr(n,1))}else Wt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class XW extends R0{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new xn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const P9e=new An,IH=new jx,jI=new M2,HI=new _e;class pke extends hi{constructor(e=new Ii,t=new XW){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),jI.copy(n.boundingSphere),jI.applyMatrix4(r),jI.radius+=s,e.ray.intersectsSphere(jI)===!1)return;P9e.copy(r).invert(),IH.copy(e.ray).applyMatrix4(P9e);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,p=n.index,x=n.attributes.position;if(p!==null){const w=Math.max(0,a.start),C=Math.min(p.count,a.start+a.count);for(let N=w,F=C;N<F;N++){const U=p.getX(N);HI.fromBufferAttribute(x,U),R9e(HI,U,d,r,e,t,this)}}else{const w=Math.max(0,a.start),C=Math.min(x.count,a.start+a.count);for(let N=w,F=C;N<F;N++)HI.fromBufferAttribute(x,N),R9e(HI,N,d,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}function R9e(i,e,t,n,r,s,a){const c=IH.distanceSqToPoint(i);if(c<t){const d=new _e;IH.closestPointToPoint(i,d),d.applyMatrix4(n);const p=r.ray.origin.distanceTo(d);if(p<r.near||p>r.far)return;s.push({distance:p,distanceToRay:Math.sqrt(c),point:d,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class YW extends ro{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Hi,this.minFilter=Hi,this.generateMipmaps=!1,this.needsUpdate=!0}}class g6 extends ro{constructor(e=[],t=np,n,r,s,a,c,d,p,y){super(e,t,n,r,s,a,c,d,p,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class ll extends ro{constructor(e,t,n=ys,r,s,a,c=Hi,d=Hi,p,y=al,x=1){if(y!==al&&y!==Wl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const w={width:e,height:t,depth:x};super(w,r,s,a,c,d,y,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new zW(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class jve extends ll{constructor(e,t=ys,n=np,r,s,a=Hi,c=Hi,d,p=al){const y={width:e,height:e,depth:1},x=[y,y,y,y,y,y];super(e,e,t,n,r,s,a,c,d,p),this.image=x,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class Hve extends ro{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class qo extends Ii{constructor(e=1,t=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const c=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const d=[],p=[],y=[],x=[];let w=0,C=0;N("z","y","x",-1,-1,n,t,e,a,s,0),N("z","y","x",1,-1,n,t,-e,a,s,1),N("x","z","y",1,1,e,n,t,r,a,2),N("x","z","y",1,-1,e,n,-t,r,a,3),N("x","y","z",1,-1,e,t,n,r,s,4),N("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(d),this.setAttribute("position",new Rr(p,3)),this.setAttribute("normal",new Rr(y,3)),this.setAttribute("uv",new Rr(x,2));function N(F,U,R,B,Y,A,ne,se,oe,G,ie){const Me=A/oe,X=ne/G,De=A/2,$e=ne/2,ot=se/2,He=oe+1,ce=G+1;let Ge=0,Ie=0;const st=new _e;for(let bt=0;bt<ce;bt++){const Ne=bt*X-$e;for(let ht=0;ht<He;ht++){const Ot=ht*Me-De;st[F]=Ot*B,st[U]=Ne*Y,st[R]=ot,p.push(st.x,st.y,st.z),st[F]=0,st[U]=0,st[R]=se>0?1:-1,y.push(st.x,st.y,st.z),x.push(ht/oe),x.push(1-bt/G),Ge+=1}}for(let bt=0;bt<G;bt++)for(let Ne=0;Ne<oe;Ne++){const ht=w+Ne+He*bt,Ot=w+Ne+He*(bt+1),wn=w+(Ne+1)+He*(bt+1),bn=w+(Ne+1)+He*bt;d.push(ht,Ot,bn),d.push(Ot,wn,bn),Ie+=6}c.addGroup(C,Ie,ie),C+=Ie,w+=Ge}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}class Hk extends Ii{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],a=[],c=[],d=[],p=new _e,y=new vn;a.push(0,0,0),c.push(0,0,1),d.push(.5,.5);for(let x=0,w=3;x<=t;x++,w+=3){const C=n+x/t*r;p.x=e*Math.cos(C),p.y=e*Math.sin(C),a.push(p.x,p.y,p.z),c.push(0,0,1),y.x=(a[w]/e+1)/2,y.y=(a[w+1]/e+1)/2,d.push(y.x,y.y)}for(let x=1;x<=t;x++)s.push(x,x+1,0);this.setIndex(s),this.setAttribute("position",new Rr(a,3)),this.setAttribute("normal",new Rr(c,3)),this.setAttribute("uv",new Rr(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hk(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class J0 extends Ii{constructor(e=1,t=1,n=1,r=32,s=1,a=!1,c=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:c,thetaLength:d};const p=this;r=Math.floor(r),s=Math.floor(s);const y=[],x=[],w=[],C=[];let N=0;const F=[],U=n/2;let R=0;B(),a===!1&&(e>0&&Y(!0),t>0&&Y(!1)),this.setIndex(y),this.setAttribute("position",new Rr(x,3)),this.setAttribute("normal",new Rr(w,3)),this.setAttribute("uv",new Rr(C,2));function B(){const A=new _e,ne=new _e;let se=0;const oe=(t-e)/n;for(let G=0;G<=s;G++){const ie=[],Me=G/s,X=Me*(t-e)+e;for(let De=0;De<=r;De++){const $e=De/r,ot=$e*d+c,He=Math.sin(ot),ce=Math.cos(ot);ne.x=X*He,ne.y=-Me*n+U,ne.z=X*ce,x.push(ne.x,ne.y,ne.z),A.set(He,oe,ce).normalize(),w.push(A.x,A.y,A.z),C.push($e,1-Me),ie.push(N++)}F.push(ie)}for(let G=0;G<r;G++)for(let ie=0;ie<s;ie++){const Me=F[ie][G],X=F[ie+1][G],De=F[ie+1][G+1],$e=F[ie][G+1];(e>0||ie!==0)&&(y.push(Me,X,$e),se+=3),(t>0||ie!==s-1)&&(y.push(X,De,$e),se+=3)}p.addGroup(R,se,0),R+=se}function Y(A){const ne=N,se=new vn,oe=new _e;let G=0;const ie=A===!0?e:t,Me=A===!0?1:-1;for(let De=1;De<=r;De++)x.push(0,U*Me,0),w.push(0,Me,0),C.push(.5,.5),N++;const X=N;for(let De=0;De<=r;De++){const ot=De/r*d+c,He=Math.cos(ot),ce=Math.sin(ot);oe.x=ie*ce,oe.y=U*Me,oe.z=ie*He,x.push(oe.x,oe.y,oe.z),w.push(0,Me,0),se.x=He*.5+.5,se.y=ce*.5*Me+.5,C.push(se.x,se.y),N++}for(let De=0;De<r;De++){const $e=ne+De,ot=X+De;A===!0?y.push(ot,ot+1,$e):y.push(ot+1,ot,$e),G+=3}p.addGroup(R,G,A===!0?1:2),R+=G}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new J0(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class KW extends Ii{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],a=[];c(r),p(n),y(),this.setAttribute("position",new Rr(s,3)),this.setAttribute("normal",new Rr(s.slice(),3)),this.setAttribute("uv",new Rr(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function c(B){const Y=new _e,A=new _e,ne=new _e;for(let se=0;se<t.length;se+=3)C(t[se+0],Y),C(t[se+1],A),C(t[se+2],ne),d(Y,A,ne,B)}function d(B,Y,A,ne){const se=ne+1,oe=[];for(let G=0;G<=se;G++){oe[G]=[];const ie=B.clone().lerp(A,G/se),Me=Y.clone().lerp(A,G/se),X=se-G;for(let De=0;De<=X;De++)De===0&&G===se?oe[G][De]=ie:oe[G][De]=ie.clone().lerp(Me,De/X)}for(let G=0;G<se;G++)for(let ie=0;ie<2*(se-G)-1;ie++){const Me=Math.floor(ie/2);ie%2===0?(w(oe[G][Me+1]),w(oe[G+1][Me]),w(oe[G][Me])):(w(oe[G][Me+1]),w(oe[G+1][Me+1]),w(oe[G+1][Me]))}}function p(B){const Y=new _e;for(let A=0;A<s.length;A+=3)Y.x=s[A+0],Y.y=s[A+1],Y.z=s[A+2],Y.normalize().multiplyScalar(B),s[A+0]=Y.x,s[A+1]=Y.y,s[A+2]=Y.z}function y(){const B=new _e;for(let Y=0;Y<s.length;Y+=3){B.x=s[Y+0],B.y=s[Y+1],B.z=s[Y+2];const A=U(B)/2/Math.PI+.5,ne=R(B)/Math.PI+.5;a.push(A,1-ne)}N(),x()}function x(){for(let B=0;B<a.length;B+=6){const Y=a[B+0],A=a[B+2],ne=a[B+4],se=Math.max(Y,A,ne),oe=Math.min(Y,A,ne);se>.9&&oe<.1&&(Y<.2&&(a[B+0]+=1),A<.2&&(a[B+2]+=1),ne<.2&&(a[B+4]+=1))}}function w(B){s.push(B.x,B.y,B.z)}function C(B,Y){const A=B*3;Y.x=e[A+0],Y.y=e[A+1],Y.z=e[A+2]}function N(){const B=new _e,Y=new _e,A=new _e,ne=new _e,se=new vn,oe=new vn,G=new vn;for(let ie=0,Me=0;ie<s.length;ie+=9,Me+=6){B.set(s[ie+0],s[ie+1],s[ie+2]),Y.set(s[ie+3],s[ie+4],s[ie+5]),A.set(s[ie+6],s[ie+7],s[ie+8]),se.set(a[Me+0],a[Me+1]),oe.set(a[Me+2],a[Me+3]),G.set(a[Me+4],a[Me+5]),ne.copy(B).add(Y).add(A).divideScalar(3);const X=U(ne);F(se,Me+0,B,X),F(oe,Me+2,Y,X),F(G,Me+4,A,X)}}function F(B,Y,A,ne){ne<0&&B.x===1&&(a[Y]=B.x-1),A.x===0&&A.z===0&&(a[Y]=ne/2/Math.PI+.5)}function U(B){return Math.atan2(B.z,-B.x)}function R(B){return Math.atan2(-B.y,Math.sqrt(B.x*B.x+B.z*B.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new KW(e.vertices,e.indices,e.radius,e.detail)}}class Wve{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Wt("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const s=n.length;let a;t?a=t:a=e*n[s-1];let c=0,d=s-1,p;for(;c<=d;)if(r=Math.floor(c+(d-c)/2),p=n[r]-a,p<0)c=r+1;else if(p>0)d=r-1;else{d=r;break}if(r=d,n[r]===a)return r/(s-1);const y=n[r],w=n[r+1]-y,C=(a-y)/w;return(r+C)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),c=this.getPoint(s),d=t||(a.isVector2?new vn:new _e);return d.copy(c).sub(a).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new _e,r=[],s=[],a=[],c=new _e,d=new An;for(let C=0;C<=e;C++){const N=C/e;r[C]=this.getTangentAt(N,new _e)}s[0]=new _e,a[0]=new _e;let p=Number.MAX_VALUE;const y=Math.abs(r[0].x),x=Math.abs(r[0].y),w=Math.abs(r[0].z);y<=p&&(p=y,n.set(1,0,0)),x<=p&&(p=x,n.set(0,1,0)),w<=p&&n.set(0,0,1),c.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],c),a[0].crossVectors(r[0],s[0]);for(let C=1;C<=e;C++){if(s[C]=s[C-1].clone(),a[C]=a[C-1].clone(),c.crossVectors(r[C-1],r[C]),c.length()>Number.EPSILON){c.normalize();const N=Math.acos(di(r[C-1].dot(r[C]),-1,1));s[C].applyMatrix4(d.makeRotationAxis(c,N))}a[C].crossVectors(r[C],s[C])}if(t===!0){let C=Math.acos(di(s[0].dot(s[e]),-1,1));C/=e,r[0].dot(c.crossVectors(s[0],s[e]))>0&&(C=-C);for(let N=1;N<=e;N++)s[N].applyMatrix4(d.makeRotationAxis(r[N],C*N)),a[N].crossVectors(r[N],s[N])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function ZW(){let i=0,e=0,t=0,n=0;function r(s,a,c,d){i=s,e=c,t=-3*s+3*a-2*c-d,n=2*s-2*a+c+d}return{initCatmullRom:function(s,a,c,d,p){r(a,c,p*(c-s),p*(d-a))},initNonuniformCatmullRom:function(s,a,c,d,p,y,x){let w=(a-s)/p-(c-s)/(p+y)+(c-a)/y,C=(c-a)/y-(d-a)/(y+x)+(d-c)/x;w*=y,C*=y,r(a,c,w,C)},calc:function(s){const a=s*s,c=a*s;return i+e*s+t*a+n*c}}}const WI=new _e,QG=new ZW,JG=new ZW,ej=new ZW;class I9e extends Wve{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new _e){const n=t,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let c=Math.floor(a),d=a-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/s)+1)*s:d===0&&c===s-1&&(c=s-2,d=1);let p,y;this.closed||c>0?p=r[(c-1)%s]:(WI.subVectors(r[0],r[1]).add(r[0]),p=WI);const x=r[c%s],w=r[(c+1)%s];if(this.closed||c+2<s?y=r[(c+2)%s]:(WI.subVectors(r[s-1],r[s-2]).add(r[s-1]),y=WI),this.curveType==="centripetal"||this.curveType==="chordal"){const C=this.curveType==="chordal"?.5:.25;let N=Math.pow(p.distanceToSquared(x),C),F=Math.pow(x.distanceToSquared(w),C),U=Math.pow(w.distanceToSquared(y),C);F<1e-4&&(F=1),N<1e-4&&(N=F),U<1e-4&&(U=F),QG.initNonuniformCatmullRom(p.x,x.x,w.x,y.x,N,F,U),JG.initNonuniformCatmullRom(p.y,x.y,w.y,y.y,N,F,U),ej.initNonuniformCatmullRom(p.z,x.z,w.z,y.z,N,F,U)}else this.curveType==="catmullrom"&&(QG.initCatmullRom(p.x,x.x,w.x,y.x,this.tension),JG.initCatmullRom(p.y,x.y,w.y,y.y,this.tension),ej.initCatmullRom(p.z,x.z,w.z,y.z,this.tension));return n.set(QG.calc(d),JG.calc(d),ej.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new _e().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function mke(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=qve(i,0,r,t,!0);const a=[];if(!s||s.next===s.prev)return a;let c,d,p;if(n&&(s=xke(i,e,s,t)),i.length>80*t){c=i[0],d=i[1];let y=c,x=d;for(let w=t;w<r;w+=t){const C=i[w],N=i[w+1];C<c&&(c=C),N<d&&(d=N),C>y&&(y=C),N>x&&(x=N)}p=Math.max(y-c,x-d),p=p!==0?32767/p:0}return pE(s,a,t,c,d,p,0),a}function qve(i,e,t,n,r){let s;if(r===Ike(i,e,t,n)>0)for(let a=e;a<t;a+=n)s=N9e(a/n|0,i[a],i[a+1],s);else for(let a=t-n;a>=e;a-=n)s=N9e(a/n|0,i[a],i[a+1],s);return s&&Rx(s,s.next)&&(gE(s),s=s.next),s}function u6(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Rx(t,t.next)||Xo(t.prev,t,t.next)===0)){if(gE(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function pE(i,e,t,n,r,s,a){if(!i)return;!a&&s&&Eke(i,n,r,s);let c=i;for(;i.prev!==i.next;){const d=i.prev,p=i.next;if(s?vke(i,n,r,s):gke(i)){e.push(d.i,i.i,p.i),gE(i),i=p.next,c=p.next;continue}if(i=p,i===c){a?a===1?(i=yke(u6(i),e),pE(i,e,t,n,r,s,2)):a===2&&_ke(i,e,t,n,r,s):pE(u6(i),e,t,n,r,s,1);break}}}function gke(i){const e=i.prev,t=i,n=i.next;if(Xo(e,t,n)>=0)return!1;const r=e.x,s=t.x,a=n.x,c=e.y,d=t.y,p=n.y,y=Math.min(r,s,a),x=Math.min(c,d,p),w=Math.max(r,s,a),C=Math.max(c,d,p);let N=n.next;for(;N!==e;){if(N.x>=y&&N.x<=w&&N.y>=x&&N.y<=C&&NT(r,c,s,d,a,p,N.x,N.y)&&Xo(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function vke(i,e,t,n){const r=i.prev,s=i,a=i.next;if(Xo(r,s,a)>=0)return!1;const c=r.x,d=s.x,p=a.x,y=r.y,x=s.y,w=a.y,C=Math.min(c,d,p),N=Math.min(y,x,w),F=Math.max(c,d,p),U=Math.max(y,x,w),R=NH(C,N,e,t,n),B=NH(F,U,e,t,n);let Y=i.prevZ,A=i.nextZ;for(;Y&&Y.z>=R&&A&&A.z<=B;){if(Y.x>=C&&Y.x<=F&&Y.y>=N&&Y.y<=U&&Y!==r&&Y!==a&&NT(c,y,d,x,p,w,Y.x,Y.y)&&Xo(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,A.x>=C&&A.x<=F&&A.y>=N&&A.y<=U&&A!==r&&A!==a&&NT(c,y,d,x,p,w,A.x,A.y)&&Xo(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;Y&&Y.z>=R;){if(Y.x>=C&&Y.x<=F&&Y.y>=N&&Y.y<=U&&Y!==r&&Y!==a&&NT(c,y,d,x,p,w,Y.x,Y.y)&&Xo(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;A&&A.z<=B;){if(A.x>=C&&A.x<=F&&A.y>=N&&A.y<=U&&A!==r&&A!==a&&NT(c,y,d,x,p,w,A.x,A.y)&&Xo(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function yke(i,e){let t=i;do{const n=t.prev,r=t.next.next;!Rx(n,r)&&Xve(n,t,t.next,r)&&mE(n,r)&&mE(r,n)&&(e.push(n.i,t.i,r.i),gE(t),gE(t.next),t=i=r),t=t.next}while(t!==i);return u6(t)}function _ke(i,e,t,n,r,s){let a=i;do{let c=a.next.next;for(;c!==a.prev;){if(a.i!==c.i&&Ake(a,c)){let d=Yve(a,c);a=u6(a,a.next),d=u6(d,d.next),pE(a,e,t,n,r,s,0),pE(d,e,t,n,r,s,0);return}c=c.next}a=a.next}while(a!==i)}function xke(i,e,t,n){const r=[];for(let s=0,a=e.length;s<a;s++){const c=e[s]*n,d=s<a-1?e[s+1]*n:i.length,p=qve(i,c,d,n,!1);p===p.next&&(p.steiner=!0),r.push(Cke(p))}r.sort(bke);for(let s=0;s<r.length;s++)t=Ske(r[s],t);return t}function bke(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function Ske(i,e){const t=wke(i,e);if(!t)return e;const n=Yve(t,i);return u6(n,n.next),u6(t,t.next)}function wke(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,a;if(Rx(i,t))return t;do{if(Rx(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const x=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>s&&(s=x,a=t.x<t.next.x?t:t.next,x===n))return a}t=t.next}while(t!==e);if(!a)return null;const c=a,d=a.x,p=a.y;let y=1/0;t=a;do{if(n>=t.x&&t.x>=d&&n!==t.x&&$ve(r<p?n:s,r,d,p,r<p?s:n,r,t.x,t.y)){const x=Math.abs(r-t.y)/(n-t.x);mE(t,i)&&(x<y||x===y&&(t.x>a.x||t.x===a.x&&Tke(a,t)))&&(a=t,y=x)}t=t.next}while(t!==c);return a}function Tke(i,e){return Xo(i.prev,i,e.prev)<0&&Xo(e.next,i,i.next)<0}function Eke(i,e,t,n){let r=i;do r.z===0&&(r.z=NH(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,Mke(r)}function Mke(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let a=n,c=0;for(let p=0;p<t&&(c++,a=a.nextZ,!!a);p++);let d=t;for(;c>0||d>0&&a;)c!==0&&(d===0||!a||n.z<=a.z)?(r=n,n=n.nextZ,c--):(r=a,a=a.nextZ,d--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=a}s.nextZ=null,t*=2}while(e>1);return i}function NH(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Cke(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function $ve(i,e,t,n,r,s,a,c){return(r-a)*(e-c)>=(i-a)*(s-c)&&(i-a)*(n-c)>=(t-a)*(e-c)&&(t-a)*(s-c)>=(r-a)*(n-c)}function NT(i,e,t,n,r,s,a,c){return!(i===a&&e===c)&&$ve(i,e,t,n,r,s,a,c)}function Ake(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Pke(i,e)&&(mE(i,e)&&mE(e,i)&&Rke(i,e)&&(Xo(i.prev,i,e.prev)||Xo(i,e.prev,e))||Rx(i,e)&&Xo(i.prev,i,i.next)>0&&Xo(e.prev,e,e.next)>0)}function Xo(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Rx(i,e){return i.x===e.x&&i.y===e.y}function Xve(i,e,t,n){const r=$I(Xo(i,e,t)),s=$I(Xo(i,e,n)),a=$I(Xo(t,n,i)),c=$I(Xo(t,n,e));return!!(r!==s&&a!==c||r===0&&qI(i,t,e)||s===0&&qI(i,n,e)||a===0&&qI(t,i,n)||c===0&&qI(t,e,n))}function qI(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function $I(i){return i>0?1:i<0?-1:0}function Pke(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&Xve(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function mE(i,e){return Xo(i.prev,i,i.next)<0?Xo(i,e,i.next)>=0&&Xo(i,i.prev,e)>=0:Xo(i,e,i.prev)<0||Xo(i,i.next,e)<0}function Rke(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function Yve(i,e){const t=kH(i.i,i.x,i.y),n=kH(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function N9e(i,e,t,n){const r=kH(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function gE(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function kH(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ike(i,e,t,n){let r=0;for(let s=e,a=t-n;s<t;s+=n)r+=(i[a]-i[s])*(i[s+1]+i[a+1]),a=s;return r}class Nke{static triangulate(e,t,n=2){return mke(e,t,n)}}class QW{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return QW.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];k9e(e),D9e(n,e);let a=e.length;t.forEach(k9e);for(let d=0;d<t.length;d++)r.push(a),a+=t[d].length,D9e(n,t[d]);const c=Nke.triangulate(n,r);for(let d=0;d<c.length;d+=3)s.push(c.slice(d,d+3));return s}}function k9e(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function D9e(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class W8 extends KW{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new W8(e.radius,e.detail)}}class rp extends Ii{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,a=t/2,c=Math.floor(n),d=Math.floor(r),p=c+1,y=d+1,x=e/c,w=t/d,C=[],N=[],F=[],U=[];for(let R=0;R<y;R++){const B=R*w-a;for(let Y=0;Y<p;Y++){const A=Y*x-s;N.push(A,-B,0),F.push(0,0,1),U.push(Y/c),U.push(1-R/d)}}for(let R=0;R<d;R++)for(let B=0;B<c;B++){const Y=B+p*R,A=B+p*(R+1),ne=B+1+p*(R+1),se=B+1+p*R;C.push(Y,A,se),C.push(A,ne,se)}this.setIndex(C),this.setAttribute("position",new Rr(N,3)),this.setAttribute("normal",new Rr(F,3)),this.setAttribute("uv",new Rr(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rp(e.width,e.height,e.widthSegments,e.heightSegments)}}class ip extends Ii{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(a+c,Math.PI);let p=0;const y=[],x=new _e,w=new _e,C=[],N=[],F=[],U=[];for(let R=0;R<=n;R++){const B=[],Y=R/n;let A=0;R===0&&a===0?A=.5/t:R===n&&d===Math.PI&&(A=-.5/t);for(let ne=0;ne<=t;ne++){const se=ne/t;x.x=-e*Math.cos(r+se*s)*Math.sin(a+Y*c),x.y=e*Math.cos(a+Y*c),x.z=e*Math.sin(r+se*s)*Math.sin(a+Y*c),N.push(x.x,x.y,x.z),w.copy(x).normalize(),F.push(w.x,w.y,w.z),U.push(se+A,1-Y),B.push(p++)}y.push(B)}for(let R=0;R<n;R++)for(let B=0;B<t;B++){const Y=y[R][B+1],A=y[R][B],ne=y[R+1][B],se=y[R+1][B+1];(R!==0||a>0)&&C.push(Y,A,se),(R!==n-1||d<Math.PI)&&C.push(A,ne,se)}this.setIndex(C),this.setAttribute("position",new Rr(N,3)),this.setAttribute("normal",new Rr(F,3)),this.setAttribute("uv",new Rr(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ip(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class B8 extends Ii{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2,a=0,c=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s,thetaStart:a,thetaLength:c},n=Math.floor(n),r=Math.floor(r);const d=[],p=[],y=[],x=[],w=new _e,C=new _e,N=new _e;for(let F=0;F<=n;F++){const U=a+F/n*c;for(let R=0;R<=r;R++){const B=R/r*s;C.x=(e+t*Math.cos(U))*Math.cos(B),C.y=(e+t*Math.cos(U))*Math.sin(B),C.z=t*Math.sin(U),p.push(C.x,C.y,C.z),w.x=e*Math.cos(B),w.y=e*Math.sin(B),N.subVectors(C,w).normalize(),y.push(N.x,N.y,N.z),x.push(R/r),x.push(F/n)}}for(let F=1;F<=n;F++)for(let U=1;U<=r;U++){const R=(r+1)*F+U-1,B=(r+1)*(F-1)+U-1,Y=(r+1)*(F-1)+U,A=(r+1)*F+U;d.push(R,B,A),d.push(B,Y,A)}this.setIndex(d),this.setAttribute("position",new Rr(p,3)),this.setAttribute("normal",new Rr(y,3)),this.setAttribute("uv",new Rr(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new B8(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class JW extends Ii{constructor(e=1,t=.4,n=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:a},n=Math.floor(n),r=Math.floor(r);const c=[],d=[],p=[],y=[],x=new _e,w=new _e,C=new _e,N=new _e,F=new _e,U=new _e,R=new _e;for(let Y=0;Y<=n;++Y){const A=Y/n*s*Math.PI*2;B(A,s,a,e,C),B(A+.01,s,a,e,N),U.subVectors(N,C),R.addVectors(N,C),F.crossVectors(U,R),R.crossVectors(F,U),F.normalize(),R.normalize();for(let ne=0;ne<=r;++ne){const se=ne/r*Math.PI*2,oe=-t*Math.cos(se),G=t*Math.sin(se);x.x=C.x+(oe*R.x+G*F.x),x.y=C.y+(oe*R.y+G*F.y),x.z=C.z+(oe*R.z+G*F.z),d.push(x.x,x.y,x.z),w.subVectors(x,C).normalize(),p.push(w.x,w.y,w.z),y.push(Y/n),y.push(ne/r)}}for(let Y=1;Y<=n;Y++)for(let A=1;A<=r;A++){const ne=(r+1)*(Y-1)+(A-1),se=(r+1)*Y+(A-1),oe=(r+1)*Y+A,G=(r+1)*(Y-1)+A;c.push(ne,se,G),c.push(se,oe,G)}this.setIndex(c),this.setAttribute("position",new Rr(d,3)),this.setAttribute("normal",new Rr(p,3)),this.setAttribute("uv",new Rr(y,2));function B(Y,A,ne,se,oe){const G=Math.cos(Y),ie=Math.sin(Y),Me=ne/A*Y,X=Math.cos(Me);oe.x=se*(2+X)*.5*G,oe.y=se*(2+X)*ie*.5,oe.z=se*Math.sin(Me)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new JW(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class kke extends R0{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new xn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}function Ix(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Wt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Pc(i){const e={};for(let t=0;t<i.length;t++){const n=Ix(i[t]);for(const r in n)e[r]=n[r]}return e}function Dke(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function Kve(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Xn.workingColorSpace}const Oke={clone:Ix,merge:Pc};var Lke=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Fke=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class za extends R0{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Lke,this.fragmentShader=Fke,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ix(e.uniforms),this.uniformsGroups=Dke(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Uke extends za{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Zve extends R0{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new xn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=im,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ao,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class vE extends Zve{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new vn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return di(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new xn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new xn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new xn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class q8 extends R0{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new xn(16777215),this.specular=new xn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=im,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ao,this.combine=DE,this.reflectivity=1,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bke extends R0{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new xn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=im,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class eq extends R0{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=im,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Qve extends R0{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new xn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=im,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ao,this.combine=DE,this.reflectivity=1,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Jve extends R0{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=FE,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class zke extends R0{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class tq extends R0{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new xn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=im,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Vke extends Td{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function XI(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function Gke(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function O9e(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,a=0;a!==n;++s){const c=t[s]*e;for(let d=0;d!==e;++d)r[a++]=i[c+d]}return r}function e8e(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(e.push(s.time),t.push(...a)),s=i[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do a=s[n],a!==void 0&&(e.push(s.time),t.push(a)),s=i[r++];while(s!==void 0)}class zE{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let c=n+2;;){if(r===void 0){if(e<s)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(s=r,r=t[++n],e<r)break t}a=t.length;break n}if(!(e>=s)){const c=t[1];e<c&&(n=2,s=c);for(let d=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(r=s,s=t[--n-1],e>=s)break t}a=n,n=0;break n}break e}for(;n<a;){const c=n+a>>>1;e<t[c]?a=c:n=c+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class jke extends zE{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:H_,endingEnd:H_}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,a=e+1,c=r[s],d=r[a];if(c===void 0)switch(this.getSettings_().endingStart){case W_:s=e,c=2*t-n;break;case rk:s=r.length-2,c=t+r[s]-r[s+1];break;default:s=e,c=n}if(d===void 0)switch(this.getSettings_().endingEnd){case W_:a=e,d=2*n-t;break;case rk:a=1,d=n+r[1]-r[0];break;default:a=e-1,d=t}const p=(n-t)*.5,y=this.valueSize;this._weightPrev=p/(t-c),this._weightNext=p/(d-n),this._offsetPrev=s*y,this._offsetNext=a*y}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c,p=d-c,y=this._offsetPrev,x=this._offsetNext,w=this._weightPrev,C=this._weightNext,N=(n-t)/(r-t),F=N*N,U=F*N,R=-w*U+2*w*F-w*N,B=(1+w)*U+(-1.5-2*w)*F+(-.5+w)*N+1,Y=(-1-C)*U+(1.5+C)*F+.5*N,A=C*U-C*F;for(let ne=0;ne!==c;++ne)s[ne]=R*a[y+ne]+B*a[p+ne]+Y*a[d+ne]+A*a[x+ne];return s}}class t8e extends zE{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c,p=d-c,y=(n-t)/(r-t),x=1-y;for(let w=0;w!==c;++w)s[w]=a[p+w]*x+a[d+w]*y;return s}}class Hke extends zE{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Wke extends zE{interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c,p=d-c,y=this.settings||this.DefaultSettings_,x=y.inTangents,w=y.outTangents;if(!x||!w){const F=(n-t)/(r-t),U=1-F;for(let R=0;R!==c;++R)s[R]=a[p+R]*U+a[d+R]*F;return s}const C=c*2,N=e-1;for(let F=0;F!==c;++F){const U=a[p+F],R=a[d+F],B=N*C+F*2,Y=w[B],A=w[B+1],ne=e*C+F*2,se=x[ne],oe=x[ne+1];let G=(n-t)/(r-t),ie,Me,X,De,$e;for(let ot=0;ot<8;ot++){ie=G*G,Me=ie*G,X=1-G,De=X*X,$e=De*X;const ce=$e*t+3*De*G*Y+3*X*ie*se+Me*r-n;if(Math.abs(ce)<1e-10)break;const Ge=3*De*(Y-t)+6*X*G*(se-Y)+3*ie*(r-se);if(Math.abs(Ge)<1e-10)break;G=G-ce/Ge,G=Math.max(0,Math.min(1,G))}s[F]=$e*U+3*De*G*A+3*X*ie*oe+Me*R}return s}}class cp{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=XI(t,this.TimeBufferType),this.values=XI(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:XI(e.times,Array),values:XI(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Hke(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new t8e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new jke(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodBezier(e){const t=new Wke(this.times,this.values,this.getValueSize(),e);return this.settings&&(t.settings=this.settings),t}setInterpolation(e){let t;switch(e){case nk:t=this.InterpolantFactoryMethodDiscrete;break;case CH:t=this.InterpolantFactoryMethodLinear;break;case MG:t=this.InterpolantFactoryMethodSmooth;break;case t9e:t=this.InterpolantFactoryMethodBezier;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Wt("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nk;case this.InterpolantFactoryMethodLinear:return CH;case this.InterpolantFactoryMethodSmooth:return MG;case this.InterpolantFactoryMethodBezier:return t9e}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,a=r-1;for(;s!==r&&n[s]<e;)++s;for(;a!==-1&&n[a]>t;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const c=this.getValueSize();this.times=n.slice(s,a),this.values=this.values.slice(s*c,a*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(jt("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(jt("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let c=0;c!==s;c++){const d=n[c];if(typeof d=="number"&&isNaN(d)){jt("KeyframeTrack: Time is not a valid number.",this,c,d),e=!1;break}if(a!==null&&a>d){jt("KeyframeTrack: Out of order keys.",this,c,d,a),e=!1;break}a=d}if(r!==void 0&&dE(r))for(let c=0,d=r.length;c!==d;++c){const p=r[c];if(isNaN(p)){jt("KeyframeTrack: Value is not a valid number.",this,c,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===MG,s=e.length-1;let a=1;for(let c=1;c<s;++c){let d=!1;const p=e[c],y=e[c+1];if(p!==y&&(c!==1||p!==e[0]))if(r)d=!0;else{const x=c*n,w=x-n,C=x+n;for(let N=0;N!==n;++N){const F=t[x+N];if(F!==t[w+N]||F!==t[C+N]){d=!0;break}}}if(d){if(c!==a){e[a]=e[c];const x=c*n,w=a*n;for(let C=0;C!==n;++C)t[w+C]=t[x+C]}++a}}if(s>0){e[a]=e[s];for(let c=s*n,d=a*n,p=0;p!==n;++p)t[d+p]=t[c+p];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}cp.prototype.ValueTypeName="";cp.prototype.TimeBufferType=Float32Array;cp.prototype.ValueBufferType=Float32Array;cp.prototype.DefaultInterpolation=CH;class Hx extends cp{constructor(e,t,n){super(e,t,n)}}Hx.prototype.ValueTypeName="bool";Hx.prototype.ValueBufferType=Array;Hx.prototype.DefaultInterpolation=nk;Hx.prototype.InterpolantFactoryMethodLinear=void 0;Hx.prototype.InterpolantFactoryMethodSmooth=void 0;class n8e extends cp{constructor(e,t,n,r){super(e,t,n,r)}}n8e.prototype.ValueTypeName="color";class yE extends cp{constructor(e,t,n,r){super(e,t,n,r)}}yE.prototype.ValueTypeName="number";class qke extends zE{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=(n-t)/(r-t);let p=e*c;for(let y=p+c;p!==y;p+=4)us.slerpFlat(s,0,a,p-c,a,p,d);return s}}class Nx extends cp{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new qke(this.times,this.values,this.getValueSize(),e)}}Nx.prototype.ValueTypeName="quaternion";Nx.prototype.InterpolantFactoryMethodSmooth=void 0;class Wx extends cp{constructor(e,t,n){super(e,t,n)}}Wx.prototype.ValueTypeName="string";Wx.prototype.ValueBufferType=Array;Wx.prototype.DefaultInterpolation=nk;Wx.prototype.InterpolantFactoryMethodLinear=void 0;Wx.prototype.InterpolantFactoryMethodSmooth=void 0;class _E extends cp{constructor(e,t,n,r){super(e,t,n,r)}}_E.prototype.ValueTypeName="vector";class DH{constructor(e="",t=-1,n=[],r=NW){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=ep(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,c=n.length;a!==c;++a)t.push(Xke(n[a]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,a=n.length;s!==a;++s)t.push(cp.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,a=[];for(let c=0;c<s;c++){let d=[],p=[];d.push((c+s-1)%s,c,(c+1)%s),p.push(0,1,0);const y=Gke(d);d=O9e(d,1,y),p=O9e(p,1,y),!r&&d[0]===0&&(d.push(s),p.push(p[0])),a.push(new yE(".morphTargetInfluences["+t[c].name+"]",d,p).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let c=0,d=e.length;c<d;c++){const p=e[c],y=p.name.match(s);if(y&&y.length>1){const x=y[1];let w=r[x];w||(r[x]=w=[]),w.push(p)}}const a=[];for(const c in r)a.push(this.CreateFromMorphTargetSequence(c,r[c],t,n));return a}static parseAnimation(e,t){if(Wt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return jt("AnimationClip: No animation in JSONLoader data."),null;const n=function(x,w,C,N,F){if(C.length!==0){const U=[],R=[];e8e(C,U,R,N),U.length!==0&&F.push(new x(w,U,R))}},r=[],s=e.name||"default",a=e.fps||30,c=e.blendMode;let d=e.length||-1;const p=e.hierarchy||[];for(let x=0;x<p.length;x++){const w=p[x].keys;if(!(!w||w.length===0))if(w[0].morphTargets){const C={};let N;for(N=0;N<w.length;N++)if(w[N].morphTargets)for(let F=0;F<w[N].morphTargets.length;F++)C[w[N].morphTargets[F]]=-1;for(const F in C){const U=[],R=[];for(let B=0;B!==w[N].morphTargets.length;++B){const Y=w[N];U.push(Y.time),R.push(Y.morphTarget===F?1:0)}r.push(new yE(".morphTargetInfluence["+F+"]",U,R))}d=C.length*a}else{const C=".bones["+t[x].name+"]";n(_E,C+".position",w,"pos",r),n(Nx,C+".quaternion",w,"rot",r),n(_E,C+".scale",w,"scl",r)}}return r.length===0?null:new this(s,d,r,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function $ke(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return yE;case"vector":case"vector2":case"vector3":case"vector4":return _E;case"color":return n8e;case"quaternion":return Nx;case"bool":case"boolean":return Hx;case"string":return Wx}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function Xke(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=$ke(i.type);if(i.times===void 0){const t=[],n=[];e8e(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const jT={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(L9e(i)||(this.files[i]=e))},get:function(i){if(this.enabled!==!1&&!L9e(i))return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};function L9e(i){try{const e=i.slice(i.indexOf(":")+1);return new URL(e).protocol==="blob:"}catch{return!1}}class Yke{constructor(e,t,n){const r=this;let s=!1,a=0,c=0,d;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(y){c++,s===!1&&r.onStart!==void 0&&r.onStart(y,a,c),s=!0},this.itemEnd=function(y){a++,r.onProgress!==void 0&&r.onProgress(y,a,c),a===c&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(y){r.onError!==void 0&&r.onError(y)},this.resolveURL=function(y){return d?d(y):y},this.setURLModifier=function(y){return d=y,this},this.addHandler=function(y,x){return p.push(y,x),this},this.removeHandler=function(y){const x=p.indexOf(y);return x!==-1&&p.splice(x,2),this},this.getHandler=function(y){for(let x=0,w=p.length;x<w;x+=2){const C=p[x],N=p[x+1];if(C.global&&(C.lastIndex=0),C.test(y))return N}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const Kke=new Yke;class A4{constructor(e){this.manager=e!==void 0?e:Kke,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}A4.DEFAULT_MATERIAL_NAME="__DEFAULT";const l2={};class Zke extends Error{constructor(e,t){super(e),this.response=t}}class Qke extends A4{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=jT.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(l2[e]!==void 0){l2[e].push({onLoad:t,onProgress:n,onError:r});return}l2[e]=[],l2[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),c=this.mimeType,d=this.responseType;fetch(a).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&Wt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const y=l2[e],x=p.body.getReader(),w=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),C=w?parseInt(w):0,N=C!==0;let F=0;const U=new ReadableStream({start(R){B();function B(){x.read().then(({done:Y,value:A})=>{if(Y)R.close();else{F+=A.byteLength;const ne=new ProgressEvent("progress",{lengthComputable:N,loaded:F,total:C});for(let se=0,oe=y.length;se<oe;se++){const G=y[se];G.onProgress&&G.onProgress(ne)}R.enqueue(A),B()}},Y=>{R.error(Y)})}}});return new Response(U)}else throw new Zke(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(y=>new DOMParser().parseFromString(y,c));case"json":return p.json();default:if(c==="")return p.text();{const x=/charset="?([^;"\s]*)"?/i.exec(c),w=x&&x[1]?x[1].toLowerCase():void 0,C=new TextDecoder(w);return p.arrayBuffer().then(N=>C.decode(N))}}}).then(p=>{jT.add(`file:${e}`,p);const y=l2[e];delete l2[e];for(let x=0,w=y.length;x<w;x++){const C=y[x];C.onLoad&&C.onLoad(p)}}).catch(p=>{const y=l2[e];if(y===void 0)throw this.manager.itemError(e),p;delete l2[e];for(let x=0,w=y.length;x<w;x++){const C=y[x];C.onError&&C.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const __=new WeakMap;class r8e extends A4{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=jT.get(`image:${e}`);if(a!==void 0){if(a.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0);else{let x=__.get(a);x===void 0&&(x=[],__.set(a,x)),x.push({onLoad:t,onError:r})}return a}const c=hE("img");function d(){y(),t&&t(this);const x=__.get(this)||[];for(let w=0;w<x.length;w++){const C=x[w];C.onLoad&&C.onLoad(this)}__.delete(this),s.manager.itemEnd(e)}function p(x){y(),r&&r(x),jT.remove(`image:${e}`);const w=__.get(this)||[];for(let C=0;C<w.length;C++){const N=w[C];N.onError&&N.onError(x)}__.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function y(){c.removeEventListener("load",d,!1),c.removeEventListener("error",p,!1)}return c.addEventListener("load",d,!1),c.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),jT.add(`image:${e}`,c),s.manager.itemStart(e),c.src=e,c}}class Jke extends A4{constructor(e){super(e)}load(e,t,n,r){const s=new g6;s.colorSpace=ti;const a=new r8e(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let c=0;function d(p){a.load(e[p],function(y){s.images[p]=y,c++,c===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let p=0;p<e.length;++p)d(p);return s}}class i8e extends A4{constructor(e){super(e)}load(e,t,n,r){const s=new ro,a=new r8e(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(c){s.image=c,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class v6 extends hi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new xn(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class s8e extends v6{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(hi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new xn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const tj=new An,F9e=new _e,U9e=new _e;class nq{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.biasNode=null,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new vn(512,512),this.mapType=Yi,this.map=null,this.mapPass=null,this.matrix=new An,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new UE,this._frameExtents=new vn(1,1),this._viewportCount=1,this._viewports=[new wr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;F9e.setFromMatrixPosition(e.matrixWorld),t.position.copy(F9e),U9e.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(U9e),t.updateMatrixWorld(),tj.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tj,t.coordinateSystem,t.reversedDepth),t.coordinateSystem===Sd||t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(tj)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this.biasNode=e.biasNode,this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const YI=new _e,KI=new us,L1=new _e;class Wk extends hi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new An,this.projectionMatrix=new An,this.projectionMatrixInverse=new An,this.coordinateSystem=ql,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorld.decompose(YI,KI,L1),L1.x===1&&L1.y===1&&L1.z===1?this.matrixWorldInverse.copy(this.matrixWorld).invert():this.matrixWorldInverse.compose(YI,KI,L1.set(1,1,1)).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorld.decompose(YI,KI,L1),L1.x===1&&L1.y===1&&L1.z===1?this.matrixWorldInverse.copy(this.matrixWorld).invert():this.matrixWorldInverse.compose(YI,KI,L1.set(1,1,1)).invert()}clone(){return new this.constructor().copy(this)}}const X9=new _e,B9e=new vn,z9e=new vn;class ca extends Wk{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=l6*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(VT*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return l6*2*Math.atan(Math.tan(VT*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){X9.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(X9.x,X9.y).multiplyScalar(-e/X9.z),X9.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(X9.x,X9.y).multiplyScalar(-e/X9.z)}getViewSize(e,t){return this.getViewBounds(e,B9e,z9e),t.subVectors(z9e,B9e)}setViewOffset(e,t,n,r,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(VT*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const d=a.fullWidth,p=a.fullHeight;s+=a.offsetX*r/d,t-=a.offsetY*n/p,r*=a.width/d,n*=a.height/p}const c=this.filmOffset;c!==0&&(s+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class eDe extends nq{constructor(){super(new ca(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=l6*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class qx extends v6{constructor(e,t,n=0,r=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(hi.DEFAULT_UP),this.updateMatrix(),this.target=new hi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new eDe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class tDe extends nq{constructor(){super(new ca(90,1,.5,500)),this.isPointLightShadow=!0}}class OH extends v6{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new tDe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class w2 extends Wk{constructor(e=-1,t=1,n=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,a=n+e,c=r+t,d=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=p*this.view.offsetX,a=s+p*this.view.width,c-=y*this.view.offsetY,d=c-y*this.view.height}this.projectionMatrix.makeOrthographic(s,a,c,d,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class nDe extends nq{constructor(){super(new w2(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class qk extends v6{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(hi.DEFAULT_UP),this.updateMatrix(),this.target=new hi,this.shadow=new nDe}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class o8e extends v6{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class a8e extends v6{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class rDe{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new _e)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*r)),t.addScaledVector(a[5],1.092548*(r*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(n*s)),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*r),t.addScaledVector(a[5],2*.429043*r*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*n*s),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class iDe extends v6{constructor(e=new rDe,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class sDe{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}const x_=-90,b_=1;class l8e extends hi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ca(x_,b_,e,t);r.layers=this.layers,this.add(r);const s=new ca(x_,b_,e,t);s.layers=this.layers,this.add(s);const a=new ca(x_,b_,e,t);a.layers=this.layers,this.add(a);const c=new ca(x_,b_,e,t);c.layers=this.layers,this.add(c);const d=new ca(x_,b_,e,t);d.layers=this.layers,this.add(d);const p=new ca(x_,b_,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,a,c,d]=t;for(const p of t)this.remove(p);if(e===ql)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===Sd)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,c,d,p,y]=this.children,x=e.getRenderTarget(),w=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),N=e.xr.enabled;e.xr.enabled=!1;const F=n.texture.generateMipmaps;n.texture.generateMipmaps=!1;let U=!1;e.isWebGLRenderer===!0?U=e.state.buffers.depth.getReversed():U=e.reversedDepthBuffer,e.setRenderTarget(n,0,r),U&&e.autoClear===!1&&e.clearDepth(),e.render(t,s),e.setRenderTarget(n,1,r),U&&e.autoClear===!1&&e.clearDepth(),e.render(t,a),e.setRenderTarget(n,2,r),U&&e.autoClear===!1&&e.clearDepth(),e.render(t,c),e.setRenderTarget(n,3,r),U&&e.autoClear===!1&&e.clearDepth(),e.render(t,d),e.setRenderTarget(n,4,r),U&&e.autoClear===!1&&e.clearDepth(),e.render(t,p),n.texture.generateMipmaps=F,e.setRenderTarget(n,5,r),U&&e.autoClear===!1&&e.clearDepth(),e.render(t,y),e.setRenderTarget(x,w,C),e.xr.enabled=N,n.texture.needsPMREMUpdate=!0}}class c8e extends ca{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let oDe=class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=aDe.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}};function aDe(){this._document.hidden===!1&&this.reset()}class lDe{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,a;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let c=0;c!==r;++c)n[s+c]=n[c];a=t}else{a+=t;const c=t/a;this._mixBufferRegion(n,s,0,c,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const d=t*this._origIndex;this._mixBufferRegion(n,r,d,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let d=t,p=t+t;d!==p;++d)if(n[d]!==n[d+t]){c.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,a=r;s!==a;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){us.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const a=this._workIndex*s;us.multiplyQuaternionsFlat(e,a,e,t,e,n),us.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,s){const a=1-r;for(let c=0;c!==s;++c){const d=t+c;e[d]=e[d]*a+e[n+c]*r}}_lerpAdditive(e,t,n,r,s){for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]+e[n+a]*r}}}const rq="\\[\\]\\.:\\/",cDe=new RegExp("["+rq+"]","g"),iq="[^"+rq+"]",uDe="[^"+rq.replace("\\.","")+"]",dDe=/((?:WC+[\/:])*)/.source.replace("WC",iq),hDe=/(WCOD+)?/.source.replace("WCOD",uDe),fDe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",iq),pDe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",iq),mDe=new RegExp("^"+dDe+hDe+fDe+pDe+"$"),gDe=["material","materials","bones","map"];class vDe{constructor(e,t,n){const r=n||ts.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class ts{constructor(e,t,n){this.path=t,this.parsedPath=n||ts.parseTrackName(t),this.node=ts.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new ts.Composite(e,t,n):new ts(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(cDe,"")}static parseTrackName(e){const t=mDe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);gDe.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let a=0;a<s.length;a++){const c=s[a];if(c.name===t||c.uuid===t)return c;const d=n(c.children);if(d)return d}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=ts.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Wt("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){jt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){jt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){jt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let y=0;y<e.length;y++)if(e[y].name===p){p=y;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){jt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){jt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){jt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){jt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const a=e[r];if(a===void 0){const p=t.nodeName;jt("PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){jt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){jt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}d=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(d=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ts.Composite=vDe;ts.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ts.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ts.prototype.GetterByBindingType=[ts.prototype._getValue_direct,ts.prototype._getValue_array,ts.prototype._getValue_arrayElement,ts.prototype._getValue_toArray];ts.prototype.SetterByBindingTypeAndVersioning=[[ts.prototype._setValue_direct,ts.prototype._setValue_direct_setNeedsUpdate,ts.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ts.prototype._setValue_array,ts.prototype._setValue_array_setNeedsUpdate,ts.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ts.prototype._setValue_arrayElement,ts.prototype._setValue_arrayElement_setNeedsUpdate,ts.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ts.prototype._setValue_fromArray,ts.prototype._setValue_fromArray_setNeedsUpdate,ts.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class yDe{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,a=s.length,c=new Array(a),d={endingStart:H_,endingEnd:H_};for(let p=0;p!==a;++p){const y=s[p].createInterpolant(null);c[p]=y,y.settings=d}this._interpolantSettings=d,this._interpolants=c,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=lNe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,c=r/s;e.warp(1,a,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,a=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);const d=c.parameterPositions,p=c.sampleValues;return d[0]=s,d[1]=s+n,p[0]=e/a,p[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const d=(e-s)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const a=this._updateTime(t),c=this._updateWeight(e);if(c>0){const d=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case uNe:for(let y=0,x=d.length;y!==x;++y)d[y].evaluate(a),p[y].accumulateAdditive(c);break;case NW:default:for(let y=0,x=d.length;y!==x;++y)d[y].evaluate(a),p[y].accumulate(r,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const a=n===cNe;if(e===0)return s===-1?r:a&&(s&1)===1?t-r:r;if(n===aNe){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){const c=Math.floor(r/t);r-=t*c,s+=Math.abs(c);const d=this.repetitions-s;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const p=e<0;this._setEndings(p,!p,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=r;if(a&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=W_,r.endingEnd=W_):(e?r.endingStart=this.zeroSlopeAtStart?W_:H_:r.endingStart=rk,t?r.endingEnd=this.zeroSlopeAtEnd?W_:H_:r.endingEnd=rk)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const c=a.parameterPositions,d=a.sampleValues;return c[0]=s,d[0]=t,c[1]=s+e,d[1]=n,this}}const _De=new Float32Array(1);class xDe extends Yl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,c=e._interpolants,d=n.uuid,p=this._bindingsByRootAndName;let y=p[d];y===void 0&&(y={},p[d]=y);for(let x=0;x!==s;++x){const w=r[x],C=w.name;let N=y[C];if(N!==void 0)++N.referenceCount,a[x]=N;else{if(N=a[x],N!==void 0){N._cacheIndex===null&&(++N.referenceCount,this._addInactiveBinding(N,d,C));continue}const F=t&&t._propertyBindings[x].binding.parsedPath;N=new lDe(ts.create(n,C,F),w.ValueTypeName,w.getValueSize()),++N.referenceCount,this._addInactiveBinding(N,d,C),a[x]=N}c[x].resultBuffer=N.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const c=a.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,c=a[s],d=c.knownActions,p=d[d.length-1],y=e._byClipCacheIndex;p._byClipCacheIndex=y,d[y]=p,d.pop(),e._byClipCacheIndex=null;const x=c.actionByRoot,w=(e._localRoot||this._root).uuid;delete x[w],d.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[t];a===void 0&&(a={},r[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,c=a[r],d=t[t.length-1],p=e._cacheIndex;d._cacheIndex=p,t[p]=d,t.pop(),delete c[s],Object.keys(c).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new t8e(new Float32Array(2),new Float32Array(2),1,_De),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let a=typeof e=="string"?DH.findByName(r,e):e;const c=a!==null?a.uuid:e,d=this._actionsByClip[c];let p=null;if(n===void 0&&(a!==null?n=a.blendMode:n=NW),d!==void 0){const x=d.actionByRoot[s];if(x!==void 0&&x.blendMode===n)return x;p=d.knownActions[0],a===null&&(a=p._clip)}if(a===null)return null;const y=new yDe(this,a,t,n);return this._bindAction(y,p),this._addInactiveAction(y,c,s),y}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?DH.findByName(n,e):e,a=s?s.uuid:e,c=this._actionsByClip[a];return c!==void 0&&c.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(r,e,s,a);const c=this._bindings,d=this._nActiveBindings;for(let p=0;p!==d;++p)c[p].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const a=s.knownActions;for(let c=0,d=a.length;c!==d;++c){const p=a[c];this._deactivateAction(p);const y=p._cacheIndex,x=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,x._cacheIndex=y,t[y]=x,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const c=n[a].actionByRoot,d=c[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const a in s){const c=s[a];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}let Ds=class u8e{constructor(e){this.value=e}clone(){return new u8e(this.value.clone===void 0?this.value:this.value.clone())}};class bDe extends Gve{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const V9e=new An;class xE{constructor(e,t,n=0,r=1/0){this.ray=new jx(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new GW,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):jt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return V9e.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(V9e),this}intersectObject(e,t=!0,n=[]){return LH(e,this,n,t),n.sort(G9e),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)LH(e[r],this,n,t);return n.sort(G9e),n}}function G9e(i,e){return i.distance-e.distance}function LH(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let a=0,c=s.length;a<c;a++)LH(s[a],e,t,!0)}}class SDe{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1,Wt("THREE.Clock: This module has been deprecated. Please use THREE.Timer instead.")}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}class FH{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=di(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(di(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class $k{constructor(e,t,n,r){$k.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const j9e=new _e;class wDe extends hi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Ii,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,c=1,d=32;a<d;a++,c++){const p=a/d*Math.PI*2,y=c/d*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(y),Math.sin(y),1)}n.setAttribute("position",new Rr(r,3));const s=new Td({fog:!1,toneMapped:!1});this.cone=new BE(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),j9e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(j9e),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Y9=new _e,ZI=new An,nj=new An;class TDe extends BE{constructor(e){const t=d8e(e),n=new Ii,r=[],s=[];for(let p=0;p<t.length;p++){const y=t[p];y.parent&&y.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}n.setAttribute("position",new Rr(r,3)),n.setAttribute("color",new Rr(s,3));const a=new Td({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const c=new xn(255),d=new xn(65280);this.setColors(c,d)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");nj.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const c=t[s];c.parent&&c.parent.isBone&&(ZI.multiplyMatrices(nj,c.matrixWorld),Y9.setFromMatrixPosition(ZI),r.setXYZ(a,Y9.x,Y9.y,Y9.z),ZI.multiplyMatrices(nj,c.parent.matrixWorld),Y9.setFromMatrixPosition(ZI),r.setXYZ(a+1,Y9.x,Y9.y,Y9.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function d8e(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...d8e(i.children[t]));return e}class EDe extends fn{constructor(e,t,n){const r=new ip(t,4,2),s=new Ua({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const MDe=new _e,H9e=new xn,W9e=new xn;class CDe extends hi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new W8(t);r.rotateY(Math.PI*.5),this.material=new Ua({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new Ba(a,3)),this.add(new fn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");H9e.copy(this.light.color),W9e.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?H9e:W9e;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(MDe.setFromMatrixPosition(this.light.matrixWorld).negate())}}const q9e=new _e,QI=new _e,$9e=new _e;class ADe extends hi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Ii;r.setAttribute("position",new Rr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Td({fog:!1,toneMapped:!1});this.lightPlane=new wu(r,s),this.add(this.lightPlane),r=new Ii,r.setAttribute("position",new Rr([0,0,0,0,0,1],3)),this.targetLine=new wu(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),q9e.setFromMatrixPosition(this.light.matrixWorld),QI.setFromMatrixPosition(this.light.target.matrixWorld),$9e.subVectors(QI,q9e),this.lightPlane.lookAt(QI),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(QI),this.targetLine.scale.z=$9e.length()}}const JI=new _e,la=new Wk;class PDe extends BE{constructor(e){const t=new Ii,n=new Td({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(N,F){d(N),d(F)}function d(N){r.push(0,0,0),s.push(0,0,0),a[N]===void 0&&(a[N]=[]),a[N].push(r.length/3-1)}t.setAttribute("position",new Rr(r,3)),t.setAttribute("color",new Rr(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const p=new xn(16755200),y=new xn(16711680),x=new xn(43775),w=new xn(16777215),C=new xn(3355443);this.setColors(p,y,x,w,C)}setColors(e,t,n,r,s){const c=this.geometry.getAttribute("color");return c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,r.r,r.g,r.b),c.setXYZ(39,r.r,r.g,r.b),c.setXYZ(40,s.r,s.g,s.b),c.setXYZ(41,s.r,s.g,s.b),c.setXYZ(42,s.r,s.g,s.b),c.setXYZ(43,s.r,s.g,s.b),c.setXYZ(44,s.r,s.g,s.b),c.setXYZ(45,s.r,s.g,s.b),c.setXYZ(46,s.r,s.g,s.b),c.setXYZ(47,s.r,s.g,s.b),c.setXYZ(48,s.r,s.g,s.b),c.setXYZ(49,s.r,s.g,s.b),c.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;let s,a;if(la.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,a=0;else if(this.camera.coordinateSystem===ql)s=-1,a=1;else if(this.camera.coordinateSystem===Sd)s=0,a=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);wa("c",t,e,la,0,0,s),wa("t",t,e,la,0,0,a),wa("n1",t,e,la,-n,-r,s),wa("n2",t,e,la,n,-r,s),wa("n3",t,e,la,-n,r,s),wa("n4",t,e,la,n,r,s),wa("f1",t,e,la,-n,-r,a),wa("f2",t,e,la,n,-r,a),wa("f3",t,e,la,-n,r,a),wa("f4",t,e,la,n,r,a),wa("u1",t,e,la,n*.7,r*1.1,s),wa("u2",t,e,la,-n*.7,r*1.1,s),wa("u3",t,e,la,0,r*2,s),wa("cf1",t,e,la,-n,0,a),wa("cf2",t,e,la,n,0,a),wa("cf3",t,e,la,0,-r,a),wa("cf4",t,e,la,0,r,a),wa("cn1",t,e,la,-n,0,s),wa("cn2",t,e,la,n,0,s),wa("cn3",t,e,la,0,-r,s),wa("cn4",t,e,la,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function wa(i,e,t,n,r,s,a){JI.set(r,s,a).unproject(n);const c=e[i];if(c!==void 0){const d=t.getAttribute("position");for(let p=0,y=c.length;p<y;p++)d.setXYZ(c[p],JI.x,JI.y,JI.z)}}class RDe extends BE{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ii;r.setAttribute("position",new Rr(t,3)),r.setAttribute("color",new Rr(n,3));const s=new Td({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new xn,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class h8e extends Yl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Wt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function UH(i,e,t,n){const r=IDe(n);switch(t){case IW:return i*e;case LE:return i*e/r.components*r.byteLength;case zx:return i*e/r.components*r.byteLength;case Oc:return i*e*2/r.components*r.byteLength;case Vx:return i*e*2/r.components*r.byteLength;case OE:return i*e*3/r.components*r.byteLength;case $s:return i*e*4/r.components*r.byteLength;case Gx:return i*e*4/r.components*r.byteLength;case g4:case v4:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case y4:case _4:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case aE:case cE:return Math.max(i,16)*Math.max(e,8)/4;case oE:case lE:return Math.max(i,8)*Math.max(e,8)/2;case ix:case sx:case ax:case lx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case ox:case o6:case cx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case ux:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case dx:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case hx:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case fx:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case px:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case mx:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case gx:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case vx:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case yx:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case _x:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case xx:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case bx:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Sx:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case wx:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Tx:case EH:case MH:return Math.ceil(i/4)*Math.ceil(e/4)*16;case Ex:case Mx:return Math.ceil(i/4)*Math.ceil(e/4)*8;case a6:case Cx:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function IDe(i){switch(i){case Yi:case Z8:return{byteLength:1,components:1};case Jf:case Q8:case Gs:return{byteLength:2,components:1};case Uk:case Bk:return{byteLength:2,components:4};case ys:case C0:case mo:return{byteLength:4,components:1};case zk:case Vk:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:N4}}));typeof window<"u"&&(window.__THREE__?Wt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=N4);/**
 * @license
 * Copyright 2010-2026 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function f8e(){let i=null,e=!1,t=null,n=null;function r(s,a){t(s,a),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function NDe(i){const e=new WeakMap;function t(c,d){const p=c.array,y=c.usage,x=p.byteLength,w=i.createBuffer();i.bindBuffer(d,w),i.bufferData(d,p,y),c.onUploadCallback();let C;if(p instanceof Float32Array)C=i.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)C=i.HALF_FLOAT;else if(p instanceof Uint16Array)c.isFloat16BufferAttribute?C=i.HALF_FLOAT:C=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)C=i.SHORT;else if(p instanceof Uint32Array)C=i.UNSIGNED_INT;else if(p instanceof Int32Array)C=i.INT;else if(p instanceof Int8Array)C=i.BYTE;else if(p instanceof Uint8Array)C=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)C=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:w,type:C,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version,size:x}}function n(c,d,p){const y=d.array,x=d.updateRanges;if(i.bindBuffer(p,c),x.length===0)i.bufferSubData(p,0,y);else{x.sort((C,N)=>C.start-N.start);let w=0;for(let C=1;C<x.length;C++){const N=x[w],F=x[C];F.start<=N.start+N.count+1?N.count=Math.max(N.count,F.start+F.count-N.start):(++w,x[w]=F)}x.length=w+1;for(let C=0,N=x.length;C<N;C++){const F=x[C];i.bufferSubData(p,F.start*y.BYTES_PER_ELEMENT,y,F.start,F.count)}d.clearUpdateRanges()}d.onUploadCallback()}function r(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function s(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=e.get(c);d&&(i.deleteBuffer(d.buffer),e.delete(c))}function a(c,d){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const y=e.get(c);(!y||y.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const p=e.get(c);if(p===void 0)e.set(c,t(c,d));else if(p.version<c.version){if(p.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,c,d),p.version=c.version}}return{get:r,remove:s,update:a}}var kDe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,DDe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,ODe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,LDe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,FDe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,UDe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,BDe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,zDe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,VDe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec4 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 );
	}
#endif`,GDe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,jDe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,HDe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,WDe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,qDe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,$De=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,XDe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,YDe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,KDe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ZDe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,QDe=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#endif`,JDe=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#endif`,eOe=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec4 vColor;
#endif`,tOe=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec4( 1.0 );
#endif
#ifdef USE_COLOR_ALPHA
	vColor *= color;
#elif defined( USE_COLOR )
	vColor.rgb *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.rgb *= instanceColor.rgb;
#endif
#ifdef USE_BATCHING_COLOR
	vColor *= getBatchingColor( getIndirectIndex( gl_DrawID ) );
#endif`,nOe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,rOe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,iOe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,sOe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,oOe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,aOe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,lOe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,cOe="gl_FragColor = linearToOutputTexel( gl_FragColor );",uOe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,dOe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		#ifdef ENVMAP_BLENDING_MULTIPLY
			outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
		#elif defined( ENVMAP_BLENDING_MIX )
			outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
		#elif defined( ENVMAP_BLENDING_ADD )
			outgoingLight += envColor.xyz * specularStrength * reflectivity;
		#endif
	#endif
#endif`,hOe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,fOe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,pOe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,mOe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,gOe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,vOe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,yOe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_Oe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,xOe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,bOe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,SOe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,wOe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,TOe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,EOe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,MOe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,COe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,AOe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,POe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,ROe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,IOe=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( material.specularF90 - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
		#ifdef USE_CLEARCOAT
			vec3 Ncc = geometryClearcoatNormal;
			vec2 uvClearcoat = LTC_Uv( Ncc, viewDir, material.clearcoatRoughness );
			vec4 t1Clearcoat = texture2D( ltc_1, uvClearcoat );
			vec4 t2Clearcoat = texture2D( ltc_2, uvClearcoat );
			mat3 mInvClearcoat = mat3(
				vec3( t1Clearcoat.x, 0, t1Clearcoat.y ),
				vec3(             0, 1,             0 ),
				vec3( t1Clearcoat.z, 0, t1Clearcoat.w )
			);
			vec3 fresnelClearcoat = material.clearcoatF0 * t2Clearcoat.x + ( material.clearcoatF90 - material.clearcoatF0 ) * t2Clearcoat.y;
			clearcoatSpecularDirect += lightColor * fresnelClearcoat * LTC_Evaluate( Ncc, viewDir, position, mInvClearcoat, rectCoords );
		#endif
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,NOe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,kOe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( ENVMAP_TYPE_CUBE_UV )
		#if defined( STANDARD ) || defined( LAMBERT ) || defined( PHONG )
			iblIrradiance += getIBLIrradiance( geometryNormal );
		#endif
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,DOe=`#if defined( RE_IndirectDiffuse )
	#if defined( LAMBERT ) || defined( PHONG )
		irradiance += iblIrradiance;
	#endif
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,OOe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,LOe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,FOe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,UOe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,BOe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,zOe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,VOe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,GOe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,jOe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,HOe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,WOe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,qOe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,$Oe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,XOe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,YOe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,KOe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,ZOe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,QOe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,JOe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,eLe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,tLe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,nLe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,rLe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,iLe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,sLe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,oLe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,aLe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	#ifdef USE_REVERSED_DEPTH_BUFFER
	
		return depth * ( far - near ) - far;
	#else
		return depth * ( near - far ) - near;
	#endif
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	
	#ifdef USE_REVERSED_DEPTH_BUFFER
		return ( near * far ) / ( ( near - far ) * depth - near );
	#else
		return ( near * far ) / ( ( far - near ) * depth - far );
	#endif
}`,lLe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,cLe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,uLe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dLe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,hLe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,fLe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,pLe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * PI2;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadowCoord.z -= shadowBias;
			#else
				shadowCoord.z += shadowBias;
			#endif
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadowCoord.z -= shadowBias;
			#else
				shadowCoord.z += shadowBias;
			#endif
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			#ifdef USE_REVERSED_DEPTH_BUFFER
				float dp = ( shadowCameraNear * ( shadowCameraFar - viewSpaceZ ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
				dp -= shadowBias;
			#else
				float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
				dp += shadowBias;
			#endif
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * PI2;
			vec2 sample0 = vogelDiskSample( 0, 5, phi );
			vec2 sample1 = vogelDiskSample( 1, 5, phi );
			vec2 sample2 = vogelDiskSample( 2, 5, phi );
			vec2 sample3 = vogelDiskSample( 3, 5, phi );
			vec2 sample4 = vogelDiskSample( 4, 5, phi );
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * sample0.x + bitangent * sample0.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample1.x + bitangent * sample1.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample2.x + bitangent * sample2.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample3.x + bitangent * sample3.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample4.x + bitangent * sample4.y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				depth = 1.0 - depth;
			#endif
			shadow = step( dp, depth );
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,mLe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,gLe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,vLe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,yLe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_Le=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,xLe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,bLe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,SLe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wLe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,TLe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,ELe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,MLe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,CLe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,ALe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,PLe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,RLe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,ILe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const NLe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,kLe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,DLe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,OLe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,LLe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,FLe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ULe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,BLe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,zLe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,VLe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,GLe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,jLe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,HLe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,WLe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,qLe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,$Le=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XLe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YLe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,KLe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ZLe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QLe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,JLe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,eFe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,tFe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nFe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rFe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iFe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sFe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oFe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,aFe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,lFe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cFe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,uFe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dFe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,yi={alphahash_fragment:kDe,alphahash_pars_fragment:DDe,alphamap_fragment:ODe,alphamap_pars_fragment:LDe,alphatest_fragment:FDe,alphatest_pars_fragment:UDe,aomap_fragment:BDe,aomap_pars_fragment:zDe,batching_pars_vertex:VDe,batching_vertex:GDe,begin_vertex:jDe,beginnormal_vertex:HDe,bsdfs:WDe,iridescence_fragment:qDe,bumpmap_pars_fragment:$De,clipping_planes_fragment:XDe,clipping_planes_pars_fragment:YDe,clipping_planes_pars_vertex:KDe,clipping_planes_vertex:ZDe,color_fragment:QDe,color_pars_fragment:JDe,color_pars_vertex:eOe,color_vertex:tOe,common:nOe,cube_uv_reflection_fragment:rOe,defaultnormal_vertex:iOe,displacementmap_pars_vertex:sOe,displacementmap_vertex:oOe,emissivemap_fragment:aOe,emissivemap_pars_fragment:lOe,colorspace_fragment:cOe,colorspace_pars_fragment:uOe,envmap_fragment:dOe,envmap_common_pars_fragment:hOe,envmap_pars_fragment:fOe,envmap_pars_vertex:pOe,envmap_physical_pars_fragment:EOe,envmap_vertex:mOe,fog_vertex:gOe,fog_pars_vertex:vOe,fog_fragment:yOe,fog_pars_fragment:_Oe,gradientmap_pars_fragment:xOe,lightmap_pars_fragment:bOe,lights_lambert_fragment:SOe,lights_lambert_pars_fragment:wOe,lights_pars_begin:TOe,lights_toon_fragment:MOe,lights_toon_pars_fragment:COe,lights_phong_fragment:AOe,lights_phong_pars_fragment:POe,lights_physical_fragment:ROe,lights_physical_pars_fragment:IOe,lights_fragment_begin:NOe,lights_fragment_maps:kOe,lights_fragment_end:DOe,logdepthbuf_fragment:OOe,logdepthbuf_pars_fragment:LOe,logdepthbuf_pars_vertex:FOe,logdepthbuf_vertex:UOe,map_fragment:BOe,map_pars_fragment:zOe,map_particle_fragment:VOe,map_particle_pars_fragment:GOe,metalnessmap_fragment:jOe,metalnessmap_pars_fragment:HOe,morphinstance_vertex:WOe,morphcolor_vertex:qOe,morphnormal_vertex:$Oe,morphtarget_pars_vertex:XOe,morphtarget_vertex:YOe,normal_fragment_begin:KOe,normal_fragment_maps:ZOe,normal_pars_fragment:QOe,normal_pars_vertex:JOe,normal_vertex:eLe,normalmap_pars_fragment:tLe,clearcoat_normal_fragment_begin:nLe,clearcoat_normal_fragment_maps:rLe,clearcoat_pars_fragment:iLe,iridescence_pars_fragment:sLe,opaque_fragment:oLe,packing:aLe,premultiplied_alpha_fragment:lLe,project_vertex:cLe,dithering_fragment:uLe,dithering_pars_fragment:dLe,roughnessmap_fragment:hLe,roughnessmap_pars_fragment:fLe,shadowmap_pars_fragment:pLe,shadowmap_pars_vertex:mLe,shadowmap_vertex:gLe,shadowmask_pars_fragment:vLe,skinbase_vertex:yLe,skinning_pars_vertex:_Le,skinning_vertex:xLe,skinnormal_vertex:bLe,specularmap_fragment:SLe,specularmap_pars_fragment:wLe,tonemapping_fragment:TLe,tonemapping_pars_fragment:ELe,transmission_fragment:MLe,transmission_pars_fragment:CLe,uv_pars_fragment:ALe,uv_pars_vertex:PLe,uv_vertex:RLe,worldpos_vertex:ILe,background_vert:NLe,background_frag:kLe,backgroundCube_vert:DLe,backgroundCube_frag:OLe,cube_vert:LLe,cube_frag:FLe,depth_vert:ULe,depth_frag:BLe,distance_vert:zLe,distance_frag:VLe,equirect_vert:GLe,equirect_frag:jLe,linedashed_vert:HLe,linedashed_frag:WLe,meshbasic_vert:qLe,meshbasic_frag:$Le,meshlambert_vert:XLe,meshlambert_frag:YLe,meshmatcap_vert:KLe,meshmatcap_frag:ZLe,meshnormal_vert:QLe,meshnormal_frag:JLe,meshphong_vert:eFe,meshphong_frag:tFe,meshphysical_vert:nFe,meshphysical_frag:rFe,meshtoon_vert:iFe,meshtoon_frag:sFe,points_vert:oFe,points_frag:aFe,shadow_vert:lFe,shadow_frag:cFe,sprite_vert:uFe,sprite_frag:dFe},kn={common:{diffuse:{value:new xn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Xr},alphaMap:{value:null},alphaMapTransform:{value:new Xr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Xr}},envmap:{envMap:{value:null},envMapRotation:{value:new Xr},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Xr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Xr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Xr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Xr},normalScale:{value:new vn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Xr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Xr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Xr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Xr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Xr},alphaTest:{value:0},uvTransform:{value:new Xr}},sprite:{diffuse:{value:new xn(16777215)},opacity:{value:1},center:{value:new vn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Xr},alphaMap:{value:null},alphaMapTransform:{value:new Xr},alphaTest:{value:0}}},Q1={basic:{uniforms:Pc([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.fog]),vertexShader:yi.meshbasic_vert,fragmentShader:yi.meshbasic_frag},lambert:{uniforms:Pc([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,kn.lights,{emissive:{value:new xn(0)},envMapIntensity:{value:1}}]),vertexShader:yi.meshlambert_vert,fragmentShader:yi.meshlambert_frag},phong:{uniforms:Pc([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,kn.lights,{emissive:{value:new xn(0)},specular:{value:new xn(1118481)},shininess:{value:30},envMapIntensity:{value:1}}]),vertexShader:yi.meshphong_vert,fragmentShader:yi.meshphong_frag},standard:{uniforms:Pc([kn.common,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.roughnessmap,kn.metalnessmap,kn.fog,kn.lights,{emissive:{value:new xn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:yi.meshphysical_vert,fragmentShader:yi.meshphysical_frag},toon:{uniforms:Pc([kn.common,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.gradientmap,kn.fog,kn.lights,{emissive:{value:new xn(0)}}]),vertexShader:yi.meshtoon_vert,fragmentShader:yi.meshtoon_frag},matcap:{uniforms:Pc([kn.common,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,{matcap:{value:null}}]),vertexShader:yi.meshmatcap_vert,fragmentShader:yi.meshmatcap_frag},points:{uniforms:Pc([kn.points,kn.fog]),vertexShader:yi.points_vert,fragmentShader:yi.points_frag},dashed:{uniforms:Pc([kn.common,kn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:yi.linedashed_vert,fragmentShader:yi.linedashed_frag},depth:{uniforms:Pc([kn.common,kn.displacementmap]),vertexShader:yi.depth_vert,fragmentShader:yi.depth_frag},normal:{uniforms:Pc([kn.common,kn.bumpmap,kn.normalmap,kn.displacementmap,{opacity:{value:1}}]),vertexShader:yi.meshnormal_vert,fragmentShader:yi.meshnormal_frag},sprite:{uniforms:Pc([kn.sprite,kn.fog]),vertexShader:yi.sprite_vert,fragmentShader:yi.sprite_frag},background:{uniforms:{uvTransform:{value:new Xr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:yi.background_vert,fragmentShader:yi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Xr}},vertexShader:yi.backgroundCube_vert,fragmentShader:yi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:yi.cube_vert,fragmentShader:yi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:yi.equirect_vert,fragmentShader:yi.equirect_frag},distance:{uniforms:Pc([kn.common,kn.displacementmap,{referencePosition:{value:new _e},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:yi.distance_vert,fragmentShader:yi.distance_frag},shadow:{uniforms:Pc([kn.lights,kn.fog,{color:{value:new xn(0)},opacity:{value:1}}]),vertexShader:yi.shadow_vert,fragmentShader:yi.shadow_frag}};Q1.physical={uniforms:Pc([Q1.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Xr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Xr},clearcoatNormalScale:{value:new vn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Xr},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Xr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Xr},sheen:{value:0},sheenColor:{value:new xn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Xr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Xr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Xr},transmissionSamplerSize:{value:new vn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Xr},attenuationDistance:{value:0},attenuationColor:{value:new xn(0)},specularColor:{value:new xn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Xr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Xr},anisotropyVector:{value:new vn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Xr}}]),vertexShader:yi.meshphysical_vert,fragmentShader:yi.meshphysical_frag};const eN={r:0,b:0,g:0},E8=new Ao,hFe=new An;function fFe(i,e,t,n,r,s){const a=new xn(0);let c=r===!0?0:1,d,p,y=null,x=0,w=null;function C(B){let Y=B.isScene===!0?B.background:null;if(Y&&Y.isTexture){const A=B.backgroundBlurriness>0;Y=e.get(Y,A)}return Y}function N(B){let Y=!1;const A=C(B);A===null?U(a,c):A&&A.isColor&&(U(A,1),Y=!0);const ne=i.xr.getEnvironmentBlendMode();ne==="additive"?t.buffers.color.setClear(0,0,0,1,s):ne==="alpha-blend"&&t.buffers.color.setClear(0,0,0,0,s),(i.autoClear||Y)&&(t.buffers.depth.setTest(!0),t.buffers.depth.setMask(!0),t.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function F(B,Y){const A=C(Y);A&&(A.isCubeTexture||A.mapping===i6)?(p===void 0&&(p=new fn(new qo(1,1,1),new za({name:"BackgroundCubeMaterial",uniforms:Ix(Q1.backgroundCube.uniforms),vertexShader:Q1.backgroundCube.vertexShader,fragmentShader:Q1.backgroundCube.fragmentShader,side:Ui,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(ne,se,oe){this.matrixWorld.copyPosition(oe.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(p)),E8.copy(Y.backgroundRotation),E8.x*=-1,E8.y*=-1,E8.z*=-1,A.isCubeTexture&&A.isRenderTargetTexture===!1&&(E8.y*=-1,E8.z*=-1),p.material.uniforms.envMap.value=A,p.material.uniforms.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=Y.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=Y.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(hFe.makeRotationFromEuler(E8)),p.material.toneMapped=Xn.getTransfer(A.colorSpace)!==Wn,(y!==A||x!==A.version||w!==i.toneMapping)&&(p.material.needsUpdate=!0,y=A,x=A.version,w=i.toneMapping),p.layers.enableAll(),B.unshift(p,p.geometry,p.material,0,0,null)):A&&A.isTexture&&(d===void 0&&(d=new fn(new rp(2,2),new za({name:"BackgroundMaterial",uniforms:Ix(Q1.background.uniforms),vertexShader:Q1.background.vertexShader,fragmentShader:Q1.background.fragmentShader,side:ol,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(d)),d.material.uniforms.t2D.value=A,d.material.uniforms.backgroundIntensity.value=Y.backgroundIntensity,d.material.toneMapped=Xn.getTransfer(A.colorSpace)!==Wn,A.matrixAutoUpdate===!0&&A.updateMatrix(),d.material.uniforms.uvTransform.value.copy(A.matrix),(y!==A||x!==A.version||w!==i.toneMapping)&&(d.material.needsUpdate=!0,y=A,x=A.version,w=i.toneMapping),d.layers.enableAll(),B.unshift(d,d.geometry,d.material,0,0,null))}function U(B,Y){B.getRGB(eN,Kve(i)),t.buffers.color.setClear(eN.r,eN.g,eN.b,Y,s)}function R(){p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0),d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0)}return{getClearColor:function(){return a},setClearColor:function(B,Y=1){a.set(B),c=Y,U(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(B){c=B,U(a,c)},render:N,addToRenderList:F,dispose:R}}function pFe(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=w(null);let s=r,a=!1;function c(X,De,$e,ot,He){let ce=!1;const Ge=x(X,ot,$e,De);s!==Ge&&(s=Ge,p(s.object)),ce=C(X,ot,$e,He),ce&&N(X,ot,$e,He),He!==null&&e.update(He,i.ELEMENT_ARRAY_BUFFER),(ce||a)&&(a=!1,A(X,De,$e,ot),He!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(He).buffer))}function d(){return i.createVertexArray()}function p(X){return i.bindVertexArray(X)}function y(X){return i.deleteVertexArray(X)}function x(X,De,$e,ot){const He=ot.wireframe===!0;let ce=n[De.id];ce===void 0&&(ce={},n[De.id]=ce);const Ge=X.isInstancedMesh===!0?X.id:0;let Ie=ce[Ge];Ie===void 0&&(Ie={},ce[Ge]=Ie);let st=Ie[$e.id];st===void 0&&(st={},Ie[$e.id]=st);let bt=st[He];return bt===void 0&&(bt=w(d()),st[He]=bt),bt}function w(X){const De=[],$e=[],ot=[];for(let He=0;He<t;He++)De[He]=0,$e[He]=0,ot[He]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:De,enabledAttributes:$e,attributeDivisors:ot,object:X,attributes:{},index:null}}function C(X,De,$e,ot){const He=s.attributes,ce=De.attributes;let Ge=0;const Ie=$e.getAttributes();for(const st in Ie)if(Ie[st].location>=0){const Ne=He[st];let ht=ce[st];if(ht===void 0&&(st==="instanceMatrix"&&X.instanceMatrix&&(ht=X.instanceMatrix),st==="instanceColor"&&X.instanceColor&&(ht=X.instanceColor)),Ne===void 0||Ne.attribute!==ht||ht&&Ne.data!==ht.data)return!0;Ge++}return s.attributesNum!==Ge||s.index!==ot}function N(X,De,$e,ot){const He={},ce=De.attributes;let Ge=0;const Ie=$e.getAttributes();for(const st in Ie)if(Ie[st].location>=0){let Ne=ce[st];Ne===void 0&&(st==="instanceMatrix"&&X.instanceMatrix&&(Ne=X.instanceMatrix),st==="instanceColor"&&X.instanceColor&&(Ne=X.instanceColor));const ht={};ht.attribute=Ne,Ne&&Ne.data&&(ht.data=Ne.data),He[st]=ht,Ge++}s.attributes=He,s.attributesNum=Ge,s.index=ot}function F(){const X=s.newAttributes;for(let De=0,$e=X.length;De<$e;De++)X[De]=0}function U(X){R(X,0)}function R(X,De){const $e=s.newAttributes,ot=s.enabledAttributes,He=s.attributeDivisors;$e[X]=1,ot[X]===0&&(i.enableVertexAttribArray(X),ot[X]=1),He[X]!==De&&(i.vertexAttribDivisor(X,De),He[X]=De)}function B(){const X=s.newAttributes,De=s.enabledAttributes;for(let $e=0,ot=De.length;$e<ot;$e++)De[$e]!==X[$e]&&(i.disableVertexAttribArray($e),De[$e]=0)}function Y(X,De,$e,ot,He,ce,Ge){Ge===!0?i.vertexAttribIPointer(X,De,$e,He,ce):i.vertexAttribPointer(X,De,$e,ot,He,ce)}function A(X,De,$e,ot){F();const He=ot.attributes,ce=$e.getAttributes(),Ge=De.defaultAttributeValues;for(const Ie in ce){const st=ce[Ie];if(st.location>=0){let bt=He[Ie];if(bt===void 0&&(Ie==="instanceMatrix"&&X.instanceMatrix&&(bt=X.instanceMatrix),Ie==="instanceColor"&&X.instanceColor&&(bt=X.instanceColor)),bt!==void 0){const Ne=bt.normalized,ht=bt.itemSize,Ot=e.get(bt);if(Ot===void 0)continue;const wn=Ot.buffer,bn=Ot.type,Tt=Ot.bytesPerElement,Gt=bn===i.INT||bn===i.UNSIGNED_INT||bt.gpuType===C0;if(bt.isInterleavedBufferAttribute){const $t=bt.data,Ln=$t.stride,jn=bt.offset;if($t.isInstancedInterleavedBuffer){for(let fr=0;fr<st.locationSize;fr++)R(st.location+fr,$t.meshPerAttribute);X.isInstancedMesh!==!0&&ot._maxInstanceCount===void 0&&(ot._maxInstanceCount=$t.meshPerAttribute*$t.count)}else for(let fr=0;fr<st.locationSize;fr++)U(st.location+fr);i.bindBuffer(i.ARRAY_BUFFER,wn);for(let fr=0;fr<st.locationSize;fr++)Y(st.location+fr,ht/st.locationSize,bn,Ne,Ln*Tt,(jn+ht/st.locationSize*fr)*Tt,Gt)}else{if(bt.isInstancedBufferAttribute){for(let $t=0;$t<st.locationSize;$t++)R(st.location+$t,bt.meshPerAttribute);X.isInstancedMesh!==!0&&ot._maxInstanceCount===void 0&&(ot._maxInstanceCount=bt.meshPerAttribute*bt.count)}else for(let $t=0;$t<st.locationSize;$t++)U(st.location+$t);i.bindBuffer(i.ARRAY_BUFFER,wn);for(let $t=0;$t<st.locationSize;$t++)Y(st.location+$t,ht/st.locationSize,bn,Ne,ht*Tt,ht/st.locationSize*$t*Tt,Gt)}}else if(Ge!==void 0){const Ne=Ge[Ie];if(Ne!==void 0)switch(Ne.length){case 2:i.vertexAttrib2fv(st.location,Ne);break;case 3:i.vertexAttrib3fv(st.location,Ne);break;case 4:i.vertexAttrib4fv(st.location,Ne);break;default:i.vertexAttrib1fv(st.location,Ne)}}}}B()}function ne(){ie();for(const X in n){const De=n[X];for(const $e in De){const ot=De[$e];for(const He in ot){const ce=ot[He];for(const Ge in ce)y(ce[Ge].object),delete ce[Ge];delete ot[He]}}delete n[X]}}function se(X){if(n[X.id]===void 0)return;const De=n[X.id];for(const $e in De){const ot=De[$e];for(const He in ot){const ce=ot[He];for(const Ge in ce)y(ce[Ge].object),delete ce[Ge];delete ot[He]}}delete n[X.id]}function oe(X){for(const De in n){const $e=n[De];for(const ot in $e){const He=$e[ot];if(He[X.id]===void 0)continue;const ce=He[X.id];for(const Ge in ce)y(ce[Ge].object),delete ce[Ge];delete He[X.id]}}}function G(X){for(const De in n){const $e=n[De],ot=X.isInstancedMesh===!0?X.id:0,He=$e[ot];if(He!==void 0){for(const ce in He){const Ge=He[ce];for(const Ie in Ge)y(Ge[Ie].object),delete Ge[Ie];delete He[ce]}delete $e[ot],Object.keys($e).length===0&&delete n[De]}}}function ie(){Me(),a=!0,s!==r&&(s=r,p(s.object))}function Me(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:c,reset:ie,resetDefaultState:Me,dispose:ne,releaseStatesOfGeometry:se,releaseStatesOfObject:G,releaseStatesOfProgram:oe,initAttributes:F,enableAttribute:U,disableUnusedAttributes:B}}function mFe(i,e,t){let n;function r(p){n=p}function s(p,y){i.drawArrays(n,p,y),t.update(y,n,1)}function a(p,y,x){x!==0&&(i.drawArraysInstanced(n,p,y,x),t.update(y,n,x))}function c(p,y,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,y,0,x);let C=0;for(let N=0;N<x;N++)C+=y[N];t.update(C,n,1)}function d(p,y,x,w){if(x===0)return;const C=e.get("WEBGL_multi_draw");if(C===null)for(let N=0;N<p.length;N++)a(p[N],y[N],w[N]);else{C.multiDrawArraysInstancedWEBGL(n,p,0,y,0,w,0,x);let N=0;for(let F=0;F<x;F++)N+=y[F]*w[F];t.update(N,n,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=c,this.renderMultiDrawInstances=d}function gFe(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const oe=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(oe.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(oe){return!(oe!==$s&&n.convert(oe)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(oe){const G=oe===Gs&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(oe!==Yi&&n.convert(oe)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&oe!==mo&&!G)}function d(oe){if(oe==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";oe="mediump"}return oe==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const y=d(p);y!==p&&(Wt("WebGLRenderer:",p,"not supported, using",y,"instead."),p=y);const x=t.logarithmicDepthBuffer===!0,w=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),C=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),N=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),F=i.getParameter(i.MAX_TEXTURE_SIZE),U=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),R=i.getParameter(i.MAX_VERTEX_ATTRIBS),B=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),Y=i.getParameter(i.MAX_VARYING_VECTORS),A=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),ne=i.getParameter(i.MAX_SAMPLES),se=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:d,textureFormatReadable:a,textureTypeReadable:c,precision:p,logarithmicDepthBuffer:x,reversedDepthBuffer:w,maxTextures:C,maxVertexTextures:N,maxTextureSize:F,maxCubemapSize:U,maxAttributes:R,maxVertexUniforms:B,maxVaryings:Y,maxFragmentUniforms:A,maxSamples:ne,samples:se}}function vFe(i){const e=this;let t=null,n=0,r=!1,s=!1;const a=new Z1,c=new Xr,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(x,w){const C=x.length!==0||w||n!==0||r;return r=w,n=x.length,C},this.beginShadows=function(){s=!0,y(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(x,w){t=y(x,w,0)},this.setState=function(x,w,C){const N=x.clippingPlanes,F=x.clipIntersection,U=x.clipShadows,R=i.get(x);if(!r||N===null||N.length===0||s&&!U)s?y(null):p();else{const B=s?0:n,Y=B*4;let A=R.clippingState||null;d.value=A,A=y(N,w,Y,C);for(let ne=0;ne!==Y;++ne)A[ne]=t[ne];R.clippingState=A,this.numIntersection=F?this.numPlanes:0,this.numPlanes+=B}};function p(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function y(x,w,C,N){const F=x!==null?x.length:0;let U=null;if(F!==0){if(U=d.value,N!==!0||U===null){const R=C+F*4,B=w.matrixWorldInverse;c.getNormalMatrix(B),(U===null||U.length<R)&&(U=new Float32Array(R));for(let Y=0,A=C;Y!==F;++Y,A+=4)a.copy(x[Y]).applyMatrix4(B,c),a.normal.toArray(U,A),U[A+3]=a.constant}d.value=U,d.needsUpdate=!0}return e.numPlanes=F,e.numIntersection=0,U}}const h4=4,X9e=[.125,.215,.35,.446,.526,.582],z8=20,yFe=256,iT=new w2,Y9e=new xn;let rj=null,ij=0,sj=0,oj=!1;const _Fe=new _e;let K9e=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,s={}){const{size:a=256,position:c=_Fe}=s;rj=this._renderer.getRenderTarget(),ij=this._renderer.getActiveCubeFace(),sj=this._renderer.getActiveMipmapLevel(),oj=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,n,r,d,c),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=J9e(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Q9e(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(rj,ij,sj),this._renderer.xr.enabled=oj,e.scissorTest=!1,S_(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===np||e.mapping===hm?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),rj=this._renderer.getRenderTarget(),ij=this._renderer.getActiveCubeFace(),sj=this._renderer.getActiveMipmapLevel(),oj=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Bi,minFilter:Bi,generateMipmaps:!1,type:Gs,format:$s,colorSpace:Fc,depthBuffer:!1},r=Z9e(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Z9e(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=xFe(s)),this._blurMaterial=SFe(s,e,t),this._ggxMaterial=bFe(s,e,t)}return r}_compileMaterial(e){const t=new fn(new Ii,e);this._renderer.compile(t,iT)}_sceneToCubeUV(e,t,n,r,s){const d=new ca(90,1,t,n),p=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],x=this._renderer,w=x.autoClear,C=x.toneMapping;x.getClearColor(Y9e),x.toneMapping=Qa,x.autoClear=!1,x.state.buffers.depth.getReversed()&&(x.setRenderTarget(r),x.clearDepth(),x.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new fn(new qo,new Ua({name:"PMREM.Background",side:Ui,depthWrite:!1,depthTest:!1})));const F=this._backgroundBox,U=F.material;let R=!1;const B=e.background;B?B.isColor&&(U.color.copy(B),e.background=null,R=!0):(U.color.copy(Y9e),R=!0);for(let Y=0;Y<6;Y++){const A=Y%3;A===0?(d.up.set(0,p[Y],0),d.position.set(s.x,s.y,s.z),d.lookAt(s.x+y[Y],s.y,s.z)):A===1?(d.up.set(0,0,p[Y]),d.position.set(s.x,s.y,s.z),d.lookAt(s.x,s.y+y[Y],s.z)):(d.up.set(0,p[Y],0),d.position.set(s.x,s.y,s.z),d.lookAt(s.x,s.y,s.z+y[Y]));const ne=this._cubeSize;S_(r,A*ne,Y>2?ne:0,ne,ne),x.setRenderTarget(r),R&&x.render(F,d),x.render(e,d)}x.toneMapping=C,x.autoClear=w,e.background=B}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===np||e.mapping===hm;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=J9e()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Q9e());const s=r?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const c=s.uniforms;c.envMap.value=e;const d=this._cubeSize;S_(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(a,iT)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,c=this._lodMeshes[n];c.material=a;const d=a.uniforms,p=n/(this._lodMeshes.length-1),y=t/(this._lodMeshes.length-1),x=Math.sqrt(p*p-y*y),w=0+p*1.25,C=x*w,{_lodMax:N}=this,F=this._sizeLods[n],U=3*F*(n>N-h4?n-N+h4:0),R=4*(this._cubeSize-F);d.envMap.value=e.texture,d.roughness.value=C,d.mipInt.value=N-t,S_(s,U,R,3*F,2*F),r.setRenderTarget(s),r.render(c,iT),d.envMap.value=s.texture,d.roughness.value=0,d.mipInt.value=N-n,S_(e,U,R,3*F,2*F),r.setRenderTarget(e),r.render(c,iT)}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,c){const d=this._renderer,p=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&jt("blur direction must be either latitudinal or longitudinal!");const y=3,x=this._lodMeshes[r];x.material=p;const w=p.uniforms,C=this._sizeLods[n]-1,N=isFinite(s)?Math.PI/(2*C):2*Math.PI/(2*z8-1),F=s/N,U=isFinite(s)?1+Math.floor(y*F):z8;U>z8&&Wt(`sigmaRadians, ${s}, is too large and will clip, as it requested ${U} samples when the maximum is set to ${z8}`);const R=[];let B=0;for(let oe=0;oe<z8;++oe){const G=oe/F,ie=Math.exp(-G*G/2);R.push(ie),oe===0?B+=ie:oe<U&&(B+=2*ie)}for(let oe=0;oe<R.length;oe++)R[oe]=R[oe]/B;w.envMap.value=e.texture,w.samples.value=U,w.weights.value=R,w.latitudinal.value=a==="latitudinal",c&&(w.poleAxis.value=c);const{_lodMax:Y}=this;w.dTheta.value=N,w.mipInt.value=Y-n;const A=this._sizeLods[r],ne=3*A*(r>Y-h4?r-Y+h4:0),se=4*(this._cubeSize-A);S_(t,ne,se,3*A,2*A),d.setRenderTarget(t),d.render(x,iT)}};function xFe(i){const e=[],t=[],n=[];let r=i;const s=i-h4+1+X9e.length;for(let a=0;a<s;a++){const c=Math.pow(2,r);e.push(c);let d=1/c;a>i-h4?d=X9e[a-i+h4-1]:a===0&&(d=0),t.push(d);const p=1/(c-2),y=-p,x=1+p,w=[y,y,x,y,x,x,y,y,x,x,y,x],C=6,N=6,F=3,U=2,R=1,B=new Float32Array(F*N*C),Y=new Float32Array(U*N*C),A=new Float32Array(R*N*C);for(let se=0;se<C;se++){const oe=se%3*2/3-1,G=se>2?0:-1,ie=[oe,G,0,oe+2/3,G,0,oe+2/3,G+1,0,oe,G,0,oe+2/3,G+1,0,oe,G+1,0];B.set(ie,F*N*se),Y.set(w,U*N*se);const Me=[se,se,se,se,se,se];A.set(Me,R*N*se)}const ne=new Ii;ne.setAttribute("position",new Ba(B,F)),ne.setAttribute("uv",new Ba(Y,U)),ne.setAttribute("faceIndex",new Ba(A,R)),n.push(new fn(ne,null)),r>h4&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function Z9e(i,e,t){const n=new Ja(i,e,t);return n.texture.mapping=i6,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function S_(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function bFe(i,e,t){return new za({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:yFe,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:Xk(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 4.1: Orthonormal basis
				vec3 T1 = vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(V, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + V.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * V;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:vo,depthTest:!1,depthWrite:!1})}function SFe(i,e,t){const n=new Float32Array(z8),r=new _e(0,1,0);return new za({name:"SphericalGaussianBlur",defines:{n:z8,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Xk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:vo,depthTest:!1,depthWrite:!1})}function Q9e(){return new za({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Xk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:vo,depthTest:!1,depthWrite:!1})}function J9e(){return new za({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Xk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:vo,depthTest:!1,depthWrite:!1})}function Xk(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}class p8e extends Ja{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new g6(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new qo(5,5,5),s=new za({name:"CubemapFromEquirect",uniforms:Ix(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ui,blending:vo});s.uniforms.tEquirect.value=t;const a=new fn(r,s),c=t.minFilter;return t.minFilter===Tu&&(t.minFilter=Bi),new l8e(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(s)}}function wFe(i){let e=new WeakMap,t=new WeakMap,n=null;function r(w,C=!1){return w==null?null:C?a(w):s(w)}function s(w){if(w&&w.isTexture){const C=w.mapping;if(C===K8||C===K_)if(e.has(w)){const N=e.get(w).texture;return c(N,w.mapping)}else{const N=w.image;if(N&&N.height>0){const F=new p8e(N.height);return F.fromEquirectangularTexture(i,w),e.set(w,F),w.addEventListener("dispose",p),c(F.texture,w.mapping)}else return null}}return w}function a(w){if(w&&w.isTexture){const C=w.mapping,N=C===K8||C===K_,F=C===np||C===hm;if(N||F){let U=t.get(w);const R=U!==void 0?U.texture.pmremVersion:0;if(w.isRenderTargetTexture&&w.pmremVersion!==R)return n===null&&(n=new K9e(i)),U=N?n.fromEquirectangular(w,U):n.fromCubemap(w,U),U.texture.pmremVersion=w.pmremVersion,t.set(w,U),U.texture;if(U!==void 0)return U.texture;{const B=w.image;return N&&B&&B.height>0||F&&B&&d(B)?(n===null&&(n=new K9e(i)),U=N?n.fromEquirectangular(w):n.fromCubemap(w),U.texture.pmremVersion=w.pmremVersion,t.set(w,U),w.addEventListener("dispose",y),U.texture):null}}}return w}function c(w,C){return C===K8?w.mapping=np:C===K_&&(w.mapping=hm),w}function d(w){let C=0;const N=6;for(let F=0;F<N;F++)w[F]!==void 0&&C++;return C===N}function p(w){const C=w.target;C.removeEventListener("dispose",p);const N=e.get(C);N!==void 0&&(e.delete(C),N.dispose())}function y(w){const C=w.target;C.removeEventListener("dispose",y);const N=t.get(C);N!==void 0&&(t.delete(C),N.dispose())}function x(){e=new WeakMap,t=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:x}}function TFe(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&ns("WebGLRenderer: "+n+" extension not supported."),r}}}function EFe(i,e,t,n){const r={},s=new WeakMap;function a(x){const w=x.target;w.index!==null&&e.remove(w.index);for(const N in w.attributes)e.remove(w.attributes[N]);w.removeEventListener("dispose",a),delete r[w.id];const C=s.get(w);C&&(e.remove(C),s.delete(w)),n.releaseStatesOfGeometry(w),w.isInstancedBufferGeometry===!0&&delete w._maxInstanceCount,t.memory.geometries--}function c(x,w){return r[w.id]===!0||(w.addEventListener("dispose",a),r[w.id]=!0,t.memory.geometries++),w}function d(x){const w=x.attributes;for(const C in w)e.update(w[C],i.ARRAY_BUFFER)}function p(x){const w=[],C=x.index,N=x.attributes.position;let F=0;if(N===void 0)return;if(C!==null){const B=C.array;F=C.version;for(let Y=0,A=B.length;Y<A;Y+=3){const ne=B[Y+0],se=B[Y+1],oe=B[Y+2];w.push(ne,se,se,oe,oe,ne)}}else{const B=N.array;F=N.version;for(let Y=0,A=B.length/3-1;Y<A;Y+=3){const ne=Y+0,se=Y+1,oe=Y+2;w.push(ne,se,se,oe,oe,ne)}}const U=new(N.count>=65535?jW:jk)(w,1);U.version=F;const R=s.get(x);R&&e.remove(R),s.set(x,U)}function y(x){const w=s.get(x);if(w){const C=x.index;C!==null&&w.version<C.version&&p(x)}else p(x);return s.get(x)}return{get:c,update:d,getWireframeAttribute:y}}function MFe(i,e,t){let n;function r(w){n=w}let s,a;function c(w){s=w.type,a=w.bytesPerElement}function d(w,C){i.drawElements(n,C,s,w*a),t.update(C,n,1)}function p(w,C,N){N!==0&&(i.drawElementsInstanced(n,C,s,w*a,N),t.update(C,n,N))}function y(w,C,N){if(N===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,C,0,s,w,0,N);let U=0;for(let R=0;R<N;R++)U+=C[R];t.update(U,n,1)}function x(w,C,N,F){if(N===0)return;const U=e.get("WEBGL_multi_draw");if(U===null)for(let R=0;R<w.length;R++)p(w[R]/a,C[R],F[R]);else{U.multiDrawElementsInstancedWEBGL(n,C,0,s,w,0,F,0,N);let R=0;for(let B=0;B<N;B++)R+=C[B]*F[B];t.update(R,n,1)}}this.setMode=r,this.setIndex=c,this.render=d,this.renderInstances=p,this.renderMultiDraw=y,this.renderMultiDrawInstances=x}function CFe(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,c){switch(t.calls++,a){case i.TRIANGLES:t.triangles+=c*(s/3);break;case i.LINES:t.lines+=c*(s/2);break;case i.LINE_STRIP:t.lines+=c*(s-1);break;case i.LINE_LOOP:t.lines+=c*s;break;case i.POINTS:t.points+=c*s;break;default:jt("WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function AFe(i,e,t){const n=new WeakMap,r=new wr;function s(a,c,d){const p=a.morphTargetInfluences,y=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,x=y!==void 0?y.length:0;let w=n.get(c);if(w===void 0||w.count!==x){let Me=function(){G.dispose(),n.delete(c),c.removeEventListener("dispose",Me)};var C=Me;w!==void 0&&w.texture.dispose();const N=c.morphAttributes.position!==void 0,F=c.morphAttributes.normal!==void 0,U=c.morphAttributes.color!==void 0,R=c.morphAttributes.position||[],B=c.morphAttributes.normal||[],Y=c.morphAttributes.color||[];let A=0;N===!0&&(A=1),F===!0&&(A=2),U===!0&&(A=3);let ne=c.attributes.position.count*A,se=1;ne>e.maxTextureSize&&(se=Math.ceil(ne/e.maxTextureSize),ne=e.maxTextureSize);const oe=new Float32Array(ne*se*4*x),G=new VW(oe,ne,se,x);G.type=mo,G.needsUpdate=!0;const ie=A*4;for(let X=0;X<x;X++){const De=R[X],$e=B[X],ot=Y[X],He=ne*se*4*X;for(let ce=0;ce<De.count;ce++){const Ge=ce*ie;N===!0&&(r.fromBufferAttribute(De,ce),oe[He+Ge+0]=r.x,oe[He+Ge+1]=r.y,oe[He+Ge+2]=r.z,oe[He+Ge+3]=0),F===!0&&(r.fromBufferAttribute($e,ce),oe[He+Ge+4]=r.x,oe[He+Ge+5]=r.y,oe[He+Ge+6]=r.z,oe[He+Ge+7]=0),U===!0&&(r.fromBufferAttribute(ot,ce),oe[He+Ge+8]=r.x,oe[He+Ge+9]=r.y,oe[He+Ge+10]=r.z,oe[He+Ge+11]=ot.itemSize===4?r.w:1)}}w={count:x,texture:G,size:new vn(ne,se)},n.set(c,w),c.addEventListener("dispose",Me)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)d.getUniforms().setValue(i,"morphTexture",a.morphTexture,t);else{let N=0;for(let U=0;U<p.length;U++)N+=p[U];const F=c.morphTargetsRelative?1:1-N;d.getUniforms().setValue(i,"morphTargetBaseInfluence",F),d.getUniforms().setValue(i,"morphTargetInfluences",p)}d.getUniforms().setValue(i,"morphTargetsTexture",w.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",w.size)}return{update:s}}function PFe(i,e,t,n,r){let s=new WeakMap;function a(p){const y=r.render.frame,x=p.geometry,w=e.get(p,x);if(s.get(w)!==y&&(e.update(w),s.set(w,y)),p.isInstancedMesh&&(p.hasEventListener("dispose",d)===!1&&p.addEventListener("dispose",d),s.get(p)!==y&&(t.update(p.instanceMatrix,i.ARRAY_BUFFER),p.instanceColor!==null&&t.update(p.instanceColor,i.ARRAY_BUFFER),s.set(p,y))),p.isSkinnedMesh){const C=p.skeleton;s.get(C)!==y&&(C.update(),s.set(C,y))}return w}function c(){s=new WeakMap}function d(p){const y=p.target;y.removeEventListener("dispose",d),n.releaseStatesOfObject(y),t.remove(y.instanceMatrix),y.instanceColor!==null&&t.remove(y.instanceColor)}return{update:a,dispose:c}}const RFe={[Nk]:"LINEAR_TONE_MAPPING",[kk]:"REINHARD_TONE_MAPPING",[Dk]:"CINEON_TONE_MAPPING",[Ok]:"ACES_FILMIC_TONE_MAPPING",[Lk]:"AGX_TONE_MAPPING",[Fk]:"NEUTRAL_TONE_MAPPING",[PW]:"CUSTOM_TONE_MAPPING"};function IFe(i,e,t,n,r){const s=new Ja(e,t,{type:i,depthBuffer:n,stencilBuffer:r}),a=new Ja(e,t,{type:Gs,depthBuffer:!1,stencilBuffer:!1}),c=new Ii;c.setAttribute("position",new Rr([-1,3,0,-1,-1,0,3,-1,0],3)),c.setAttribute("uv",new Rr([0,2,0,0,2,0],2));const d=new Uke({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),p=new fn(c,d),y=new w2(-1,1,1,-1,0,1);let x=null,w=null,C=!1,N,F=null,U=[],R=!1;this.setSize=function(B,Y){s.setSize(B,Y),a.setSize(B,Y);for(let A=0;A<U.length;A++){const ne=U[A];ne.setSize&&ne.setSize(B,Y)}},this.setEffects=function(B){U=B,R=U.length>0&&U[0].isRenderPass===!0;const Y=s.width,A=s.height;for(let ne=0;ne<U.length;ne++){const se=U[ne];se.setSize&&se.setSize(Y,A)}},this.begin=function(B,Y){if(C||B.toneMapping===Qa&&U.length===0)return!1;if(F=Y,Y!==null){const A=Y.width,ne=Y.height;(s.width!==A||s.height!==ne)&&this.setSize(A,ne)}return R===!1&&B.setRenderTarget(s),N=B.toneMapping,B.toneMapping=Qa,!0},this.hasRenderPass=function(){return R},this.end=function(B,Y){B.toneMapping=N,C=!0;let A=s,ne=a;for(let se=0;se<U.length;se++){const oe=U[se];if(oe.enabled!==!1&&(oe.render(B,ne,A,Y),oe.needsSwap!==!1)){const G=A;A=ne,ne=G}}if(x!==B.outputColorSpace||w!==B.toneMapping){x=B.outputColorSpace,w=B.toneMapping,d.defines={},Xn.getTransfer(x)===Wn&&(d.defines.SRGB_TRANSFER="");const se=RFe[w];se&&(d.defines[se]=""),d.needsUpdate=!0}d.uniforms.tDiffuse.value=A.texture,B.setRenderTarget(F),B.render(p,y),F=null,C=!1},this.isCompositing=function(){return C},this.dispose=function(){s.dispose(),a.dispose(),c.dispose(),d.dispose()}}const m8e=new ro,BH=new ll(1,1),g8e=new VW,v8e=new XNe,y8e=new g6,e4e=[],t4e=[],n4e=new Float32Array(16),r4e=new Float32Array(9),i4e=new Float32Array(4);function $x(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=e4e[r];if(s===void 0&&(s=new Float32Array(r),e4e[r]=s),e!==0){n.toArray(s,0);for(let a=1,c=0;a!==e;++a)c+=t,i[a].toArray(s,c)}return s}function e0(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function t0(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function Yk(i,e){let t=t4e[e];t===void 0&&(t=new Int32Array(e),t4e[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function NFe(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function kFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(e0(t,e))return;i.uniform2fv(this.addr,e),t0(t,e)}}function DFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(e0(t,e))return;i.uniform3fv(this.addr,e),t0(t,e)}}function OFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(e0(t,e))return;i.uniform4fv(this.addr,e),t0(t,e)}}function LFe(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(e0(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),t0(t,e)}else{if(e0(t,n))return;i4e.set(n),i.uniformMatrix2fv(this.addr,!1,i4e),t0(t,n)}}function FFe(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(e0(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),t0(t,e)}else{if(e0(t,n))return;r4e.set(n),i.uniformMatrix3fv(this.addr,!1,r4e),t0(t,n)}}function UFe(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(e0(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),t0(t,e)}else{if(e0(t,n))return;n4e.set(n),i.uniformMatrix4fv(this.addr,!1,n4e),t0(t,n)}}function BFe(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function zFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(e0(t,e))return;i.uniform2iv(this.addr,e),t0(t,e)}}function VFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(e0(t,e))return;i.uniform3iv(this.addr,e),t0(t,e)}}function GFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(e0(t,e))return;i.uniform4iv(this.addr,e),t0(t,e)}}function jFe(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function HFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(e0(t,e))return;i.uniform2uiv(this.addr,e),t0(t,e)}}function WFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(e0(t,e))return;i.uniform3uiv(this.addr,e),t0(t,e)}}function qFe(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(e0(t,e))return;i.uniform4uiv(this.addr,e),t0(t,e)}}function $Fe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(BH.compareFunction=t.isReversedDepthBuffer()?p6:f6,s=BH):s=m8e,t.setTexture2D(e||s,r)}function XFe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||v8e,r)}function YFe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||y8e,r)}function KFe(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||g8e,r)}function ZFe(i){switch(i){case 5126:return NFe;case 35664:return kFe;case 35665:return DFe;case 35666:return OFe;case 35674:return LFe;case 35675:return FFe;case 35676:return UFe;case 5124:case 35670:return BFe;case 35667:case 35671:return zFe;case 35668:case 35672:return VFe;case 35669:case 35673:return GFe;case 5125:return jFe;case 36294:return HFe;case 36295:return WFe;case 36296:return qFe;case 35678:case 36198:case 36298:case 36306:case 35682:return $Fe;case 35679:case 36299:case 36307:return XFe;case 35680:case 36300:case 36308:case 36293:return YFe;case 36289:case 36303:case 36311:case 36292:return KFe}}function QFe(i,e){i.uniform1fv(this.addr,e)}function JFe(i,e){const t=$x(e,this.size,2);i.uniform2fv(this.addr,t)}function eUe(i,e){const t=$x(e,this.size,3);i.uniform3fv(this.addr,t)}function tUe(i,e){const t=$x(e,this.size,4);i.uniform4fv(this.addr,t)}function nUe(i,e){const t=$x(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function rUe(i,e){const t=$x(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function iUe(i,e){const t=$x(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function sUe(i,e){i.uniform1iv(this.addr,e)}function oUe(i,e){i.uniform2iv(this.addr,e)}function aUe(i,e){i.uniform3iv(this.addr,e)}function lUe(i,e){i.uniform4iv(this.addr,e)}function cUe(i,e){i.uniform1uiv(this.addr,e)}function uUe(i,e){i.uniform2uiv(this.addr,e)}function dUe(i,e){i.uniform3uiv(this.addr,e)}function hUe(i,e){i.uniform4uiv(this.addr,e)}function fUe(i,e,t){const n=this.cache,r=e.length,s=Yk(t,r);e0(n,s)||(i.uniform1iv(this.addr,s),t0(n,s));let a;this.type===i.SAMPLER_2D_SHADOW?a=BH:a=m8e;for(let c=0;c!==r;++c)t.setTexture2D(e[c]||a,s[c])}function pUe(i,e,t){const n=this.cache,r=e.length,s=Yk(t,r);e0(n,s)||(i.uniform1iv(this.addr,s),t0(n,s));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||v8e,s[a])}function mUe(i,e,t){const n=this.cache,r=e.length,s=Yk(t,r);e0(n,s)||(i.uniform1iv(this.addr,s),t0(n,s));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||y8e,s[a])}function gUe(i,e,t){const n=this.cache,r=e.length,s=Yk(t,r);e0(n,s)||(i.uniform1iv(this.addr,s),t0(n,s));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||g8e,s[a])}function vUe(i){switch(i){case 5126:return QFe;case 35664:return JFe;case 35665:return eUe;case 35666:return tUe;case 35674:return nUe;case 35675:return rUe;case 35676:return iUe;case 5124:case 35670:return sUe;case 35667:case 35671:return oUe;case 35668:case 35672:return aUe;case 35669:case 35673:return lUe;case 5125:return cUe;case 36294:return uUe;case 36295:return dUe;case 36296:return hUe;case 35678:case 36198:case 36298:case 36306:case 35682:return fUe;case 35679:case 36299:case 36307:return pUe;case 35680:case 36300:case 36308:case 36293:return mUe;case 36289:case 36303:case 36311:case 36292:return gUe}}class yUe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=ZFe(t.type)}}class _Ue{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=vUe(t.type)}}class xUe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const c=r[s];c.setValue(e,t[c.id],n)}}}const aj=/(\w+)(\])?(\[|\.)?/g;function s4e(i,e){i.seq.push(e),i.map[e.id]=e}function bUe(i,e,t){const n=i.name,r=n.length;for(aj.lastIndex=0;;){const s=aj.exec(n),a=aj.lastIndex;let c=s[1];const d=s[2]==="]",p=s[3];if(d&&(c=c|0),p===void 0||p==="["&&a+2===r){s4e(t,p===void 0?new yUe(c,i,e):new _Ue(c,i,e));break}else{let x=t.map[c];x===void 0&&(x=new xUe(c),s4e(t,x)),t=x}}}class WN{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<n;++a){const c=e.getActiveUniform(t,a),d=e.getUniformLocation(t,c.name);bUe(c,d,this)}const r=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(a):s.push(a);r.length>0&&(this.seq=r.concat(s))}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,a=t.length;s!==a;++s){const c=t[s],d=n[c.id];d.needsUpdate!==!1&&c.setValue(e,d.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function o4e(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const SUe=37297;let wUe=0;function TUe(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const c=a+1;n.push(`${c===e?">":" "} ${c}: ${t[a]}`)}return n.join(`
`)}const a4e=new Xr;function EUe(i){Xn._getMatrix(a4e,Xn.workingColorSpace,i);const e=`mat3( ${a4e.elements.map(t=>t.toFixed(4))} )`;switch(Xn.getTransfer(i)){case Ax:return[e,"LinearTransferOETF"];case Wn:return[e,"sRGBTransferOETF"];default:return Wt("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function l4e(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=(i.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const c=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+TUe(i.getShaderSource(e),c)}else return s}function MUe(i,e){const t=EUe(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const CUe={[Nk]:"Linear",[kk]:"Reinhard",[Dk]:"Cineon",[Ok]:"ACESFilmic",[Lk]:"AgX",[Fk]:"Neutral",[PW]:"Custom"};function AUe(i,e){const t=CUe[e];return t===void 0?(Wt("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const tN=new _e;function PUe(){Xn.getLuminanceCoefficients(tN);const i=tN.x.toFixed(4),e=tN.y.toFixed(4),t=tN.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function RUe(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(kT).join(`
`)}function IUe(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function NUe(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),a=s.name;let c=1;s.type===i.FLOAT_MAT2&&(c=2),s.type===i.FLOAT_MAT3&&(c=3),s.type===i.FLOAT_MAT4&&(c=4),t[a]={type:s.type,location:i.getAttribLocation(e,a),locationSize:c}}return t}function kT(i){return i!==""}function c4e(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function u4e(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const kUe=/^[ \t]*#include +<([\w\d./]+)>/gm;function zH(i){return i.replace(kUe,OUe)}const DUe=new Map;function OUe(i,e){let t=yi[e];if(t===void 0){const n=DUe.get(e);if(n!==void 0)t=yi[n],Wt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return zH(t)}const LUe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function d4e(i){return i.replace(LUe,FUe)}function FUe(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function h4e(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const UUe={[Y_]:"SHADOWMAP_TYPE_PCF",[em]:"SHADOWMAP_TYPE_VSM"};function BUe(i){return UUe[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const zUe={[np]:"ENVMAP_TYPE_CUBE",[hm]:"ENVMAP_TYPE_CUBE",[i6]:"ENVMAP_TYPE_CUBE_UV"};function VUe(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":zUe[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const GUe={[hm]:"ENVMAP_MODE_REFRACTION"};function jUe(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":GUe[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const HUe={[DE]:"ENVMAP_BLENDING_MULTIPLY",[Dve]:"ENVMAP_BLENDING_MIX",[Ove]:"ENVMAP_BLENDING_ADD"};function WUe(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":HUe[i.combine]||"ENVMAP_BLENDING_NONE"}function qUe(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function $Ue(i,e,t,n){const r=i.getContext(),s=t.defines;let a=t.vertexShader,c=t.fragmentShader;const d=BUe(t),p=VUe(t),y=jUe(t),x=WUe(t),w=qUe(t),C=RUe(t),N=IUe(s),F=r.createProgram();let U,R,B=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(U=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N].filter(kT).join(`
`),U.length>0&&(U+=`
`),R=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N].filter(kT).join(`
`),R.length>0&&(R+=`
`)):(U=[h4e(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(kT).join(`
`),R=[h4e(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+y:"",t.envMap?"#define "+x:"",w?"#define CUBEUV_TEXEL_WIDTH "+w.texelWidth:"",w?"#define CUBEUV_TEXEL_HEIGHT "+w.texelHeight:"",w?"#define CUBEUV_MAX_MIP "+w.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas||t.batchingColor?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Qa?"#define TONE_MAPPING":"",t.toneMapping!==Qa?yi.tonemapping_pars_fragment:"",t.toneMapping!==Qa?AUe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",yi.colorspace_pars_fragment,MUe("linearToOutputTexel",t.outputColorSpace),PUe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(kT).join(`
`)),a=zH(a),a=c4e(a,t),a=u4e(a,t),c=zH(c),c=c4e(c,t),c=u4e(c,t),a=d4e(a),c=d4e(c),t.isRawShaderMaterial!==!0&&(B=`#version 300 es
`,U=[C,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+U,R=["#define varying in",t.glslVersion===PH?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===PH?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+R);const Y=B+U+a,A=B+R+c,ne=o4e(r,r.VERTEX_SHADER,Y),se=o4e(r,r.FRAGMENT_SHADER,A);r.attachShader(F,ne),r.attachShader(F,se),t.index0AttributeName!==void 0?r.bindAttribLocation(F,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(F,0,"position"),r.linkProgram(F);function oe(X){if(i.debug.checkShaderErrors){const De=r.getProgramInfoLog(F)||"",$e=r.getShaderInfoLog(ne)||"",ot=r.getShaderInfoLog(se)||"",He=De.trim(),ce=$e.trim(),Ge=ot.trim();let Ie=!0,st=!0;if(r.getProgramParameter(F,r.LINK_STATUS)===!1)if(Ie=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,F,ne,se);else{const bt=l4e(r,ne,"vertex"),Ne=l4e(r,se,"fragment");jt("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(F,r.VALIDATE_STATUS)+`

Material Name: `+X.name+`
Material Type: `+X.type+`

Program Info Log: `+He+`
`+bt+`
`+Ne)}else He!==""?Wt("WebGLProgram: Program Info Log:",He):(ce===""||Ge==="")&&(st=!1);st&&(X.diagnostics={runnable:Ie,programLog:He,vertexShader:{log:ce,prefix:U},fragmentShader:{log:Ge,prefix:R}})}r.deleteShader(ne),r.deleteShader(se),G=new WN(r,F),ie=NUe(r,F)}let G;this.getUniforms=function(){return G===void 0&&oe(this),G};let ie;this.getAttributes=function(){return ie===void 0&&oe(this),ie};let Me=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Me===!1&&(Me=r.getProgramParameter(F,SUe)),Me},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(F),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=wUe++,this.cacheKey=e,this.usedTimes=1,this.program=F,this.vertexShader=ne,this.fragmentShader=se,this}let XUe=0;class YUe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new KUe(e),t.set(e,n)),n}}class KUe{constructor(e){this.id=XUe++,this.code=e,this.usedTimes=0}}function ZUe(i,e,t,n,r,s){const a=new GW,c=new YUe,d=new Set,p=[],y=new Map,x=n.logarithmicDepthBuffer;let w=n.precision;const C={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function N(G){return d.add(G),G===0?"uv":`uv${G}`}function F(G,ie,Me,X,De){const $e=X.fog,ot=De.geometry,He=G.isMeshStandardMaterial||G.isMeshLambertMaterial||G.isMeshPhongMaterial?X.environment:null,ce=G.isMeshStandardMaterial||G.isMeshLambertMaterial&&!G.envMap||G.isMeshPhongMaterial&&!G.envMap,Ge=e.get(G.envMap||He,ce),Ie=Ge&&Ge.mapping===i6?Ge.image.height:null,st=C[G.type];G.precision!==null&&(w=n.getMaxPrecision(G.precision),w!==G.precision&&Wt("WebGLProgram.getParameters:",G.precision,"not supported, using",w,"instead."));const bt=ot.morphAttributes.position||ot.morphAttributes.normal||ot.morphAttributes.color,Ne=bt!==void 0?bt.length:0;let ht=0;ot.morphAttributes.position!==void 0&&(ht=1),ot.morphAttributes.normal!==void 0&&(ht=2),ot.morphAttributes.color!==void 0&&(ht=3);let Ot,wn,bn,Tt;if(st){const Tr=Q1[st];Ot=Tr.vertexShader,wn=Tr.fragmentShader}else Ot=G.vertexShader,wn=G.fragmentShader,c.update(G),bn=c.getVertexShaderID(G),Tt=c.getFragmentShaderID(G);const Gt=i.getRenderTarget(),$t=i.state.buffers.depth.getReversed(),Ln=De.isInstancedMesh===!0,jn=De.isBatchedMesh===!0,fr=!!G.map,ds=!!G.matcap,Wr=!!Ge,Br=!!G.aoMap,Kr=!!G.lightMap,Vr=!!G.bumpMap,ai=!!G.normalMap,qe=!!G.displacementMap,hs=!!G.emissiveMap,ni=!!G.metalnessMap,gi=!!G.roughnessMap,Fn=G.anisotropy>0,Pe=G.clearcoat>0,de=G.dispersion>0,dt=G.iridescence>0,qt=G.sheen>0,Xt=G.transmission>0,Bt=Fn&&!!G.anisotropyMap,$n=Pe&&!!G.clearcoatMap,_n=Pe&&!!G.clearcoatNormalMap,tr=Pe&&!!G.clearcoatRoughnessMap,Mr=dt&&!!G.iridescenceMap,Qt=dt&&!!G.iridescenceThicknessMap,pn=qt&&!!G.sheenColorMap,Un=qt&&!!G.sheenRoughnessMap,Vn=!!G.specularMap,Dn=!!G.specularColorMap,br=!!G.specularIntensityMap,Qe=Xt&&!!G.transmissionMap,gn=Xt&&!!G.thicknessMap,un=!!G.gradientMap,Cn=!!G.alphaMap,on=G.alphaTest>0,zt=!!G.alphaHash,Gn=!!G.extensions;let Ir=Qa;G.toneMapped&&(Gt===null||Gt.isXRRenderTarget===!0)&&(Ir=i.toneMapping);const zi={shaderID:st,shaderType:G.type,shaderName:G.name,vertexShader:Ot,fragmentShader:wn,defines:G.defines,customVertexShaderID:bn,customFragmentShaderID:Tt,isRawShaderMaterial:G.isRawShaderMaterial===!0,glslVersion:G.glslVersion,precision:w,batching:jn,batchingColor:jn&&De._colorsTexture!==null,instancing:Ln,instancingColor:Ln&&De.instanceColor!==null,instancingMorph:Ln&&De.morphTexture!==null,outputColorSpace:Gt===null?i.outputColorSpace:Gt.isXRRenderTarget===!0?Gt.texture.colorSpace:Fc,alphaToCoverage:!!G.alphaToCoverage,map:fr,matcap:ds,envMap:Wr,envMapMode:Wr&&Ge.mapping,envMapCubeUVHeight:Ie,aoMap:Br,lightMap:Kr,bumpMap:Vr,normalMap:ai,displacementMap:qe,emissiveMap:hs,normalMapObjectSpace:ai&&G.normalMapType===Lve,normalMapTangentSpace:ai&&G.normalMapType===im,metalnessMap:ni,roughnessMap:gi,anisotropy:Fn,anisotropyMap:Bt,clearcoat:Pe,clearcoatMap:$n,clearcoatNormalMap:_n,clearcoatRoughnessMap:tr,dispersion:de,iridescence:dt,iridescenceMap:Mr,iridescenceThicknessMap:Qt,sheen:qt,sheenColorMap:pn,sheenRoughnessMap:Un,specularMap:Vn,specularColorMap:Dn,specularIntensityMap:br,transmission:Xt,transmissionMap:Qe,thicknessMap:gn,gradientMap:un,opaque:G.transparent===!1&&G.blending===rl&&G.alphaToCoverage===!1,alphaMap:Cn,alphaTest:on,alphaHash:zt,combine:G.combine,mapUv:fr&&N(G.map.channel),aoMapUv:Br&&N(G.aoMap.channel),lightMapUv:Kr&&N(G.lightMap.channel),bumpMapUv:Vr&&N(G.bumpMap.channel),normalMapUv:ai&&N(G.normalMap.channel),displacementMapUv:qe&&N(G.displacementMap.channel),emissiveMapUv:hs&&N(G.emissiveMap.channel),metalnessMapUv:ni&&N(G.metalnessMap.channel),roughnessMapUv:gi&&N(G.roughnessMap.channel),anisotropyMapUv:Bt&&N(G.anisotropyMap.channel),clearcoatMapUv:$n&&N(G.clearcoatMap.channel),clearcoatNormalMapUv:_n&&N(G.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:tr&&N(G.clearcoatRoughnessMap.channel),iridescenceMapUv:Mr&&N(G.iridescenceMap.channel),iridescenceThicknessMapUv:Qt&&N(G.iridescenceThicknessMap.channel),sheenColorMapUv:pn&&N(G.sheenColorMap.channel),sheenRoughnessMapUv:Un&&N(G.sheenRoughnessMap.channel),specularMapUv:Vn&&N(G.specularMap.channel),specularColorMapUv:Dn&&N(G.specularColorMap.channel),specularIntensityMapUv:br&&N(G.specularIntensityMap.channel),transmissionMapUv:Qe&&N(G.transmissionMap.channel),thicknessMapUv:gn&&N(G.thicknessMap.channel),alphaMapUv:Cn&&N(G.alphaMap.channel),vertexTangents:!!ot.attributes.tangent&&(ai||Fn),vertexColors:G.vertexColors,vertexAlphas:G.vertexColors===!0&&!!ot.attributes.color&&ot.attributes.color.itemSize===4,pointsUvs:De.isPoints===!0&&!!ot.attributes.uv&&(fr||Cn),fog:!!$e,useFog:G.fog===!0,fogExp2:!!$e&&$e.isFogExp2,flatShading:G.wireframe===!1&&(G.flatShading===!0||ot.attributes.normal===void 0&&ai===!1&&(G.isMeshLambertMaterial||G.isMeshPhongMaterial||G.isMeshStandardMaterial||G.isMeshPhysicalMaterial)),sizeAttenuation:G.sizeAttenuation===!0,logarithmicDepthBuffer:x,reversedDepthBuffer:$t,skinning:De.isSkinnedMesh===!0,morphTargets:ot.morphAttributes.position!==void 0,morphNormals:ot.morphAttributes.normal!==void 0,morphColors:ot.morphAttributes.color!==void 0,morphTargetsCount:Ne,morphTextureStride:ht,numDirLights:ie.directional.length,numPointLights:ie.point.length,numSpotLights:ie.spot.length,numSpotLightMaps:ie.spotLightMap.length,numRectAreaLights:ie.rectArea.length,numHemiLights:ie.hemi.length,numDirLightShadows:ie.directionalShadowMap.length,numPointLightShadows:ie.pointShadowMap.length,numSpotLightShadows:ie.spotShadowMap.length,numSpotLightShadowsWithMaps:ie.numSpotLightShadowsWithMaps,numLightProbes:ie.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:G.dithering,shadowMapEnabled:i.shadowMap.enabled&&Me.length>0,shadowMapType:i.shadowMap.type,toneMapping:Ir,decodeVideoTexture:fr&&G.map.isVideoTexture===!0&&Xn.getTransfer(G.map.colorSpace)===Wn,decodeVideoTextureEmissive:hs&&G.emissiveMap.isVideoTexture===!0&&Xn.getTransfer(G.emissiveMap.colorSpace)===Wn,premultipliedAlpha:G.premultipliedAlpha,doubleSided:G.side===no,flipSided:G.side===Ui,useDepthPacking:G.depthPacking>=0,depthPacking:G.depthPacking||0,index0AttributeName:G.index0AttributeName,extensionClipCullDistance:Gn&&G.extensions.clipCullDistance===!0&&t.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Gn&&G.extensions.multiDraw===!0||jn)&&t.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:t.has("KHR_parallel_shader_compile"),customProgramCacheKey:G.customProgramCacheKey()};return zi.vertexUv1s=d.has(1),zi.vertexUv2s=d.has(2),zi.vertexUv3s=d.has(3),d.clear(),zi}function U(G){const ie=[];if(G.shaderID?ie.push(G.shaderID):(ie.push(G.customVertexShaderID),ie.push(G.customFragmentShaderID)),G.defines!==void 0)for(const Me in G.defines)ie.push(Me),ie.push(G.defines[Me]);return G.isRawShaderMaterial===!1&&(R(ie,G),B(ie,G),ie.push(i.outputColorSpace)),ie.push(G.customProgramCacheKey),ie.join()}function R(G,ie){G.push(ie.precision),G.push(ie.outputColorSpace),G.push(ie.envMapMode),G.push(ie.envMapCubeUVHeight),G.push(ie.mapUv),G.push(ie.alphaMapUv),G.push(ie.lightMapUv),G.push(ie.aoMapUv),G.push(ie.bumpMapUv),G.push(ie.normalMapUv),G.push(ie.displacementMapUv),G.push(ie.emissiveMapUv),G.push(ie.metalnessMapUv),G.push(ie.roughnessMapUv),G.push(ie.anisotropyMapUv),G.push(ie.clearcoatMapUv),G.push(ie.clearcoatNormalMapUv),G.push(ie.clearcoatRoughnessMapUv),G.push(ie.iridescenceMapUv),G.push(ie.iridescenceThicknessMapUv),G.push(ie.sheenColorMapUv),G.push(ie.sheenRoughnessMapUv),G.push(ie.specularMapUv),G.push(ie.specularColorMapUv),G.push(ie.specularIntensityMapUv),G.push(ie.transmissionMapUv),G.push(ie.thicknessMapUv),G.push(ie.combine),G.push(ie.fogExp2),G.push(ie.sizeAttenuation),G.push(ie.morphTargetsCount),G.push(ie.morphAttributeCount),G.push(ie.numDirLights),G.push(ie.numPointLights),G.push(ie.numSpotLights),G.push(ie.numSpotLightMaps),G.push(ie.numHemiLights),G.push(ie.numRectAreaLights),G.push(ie.numDirLightShadows),G.push(ie.numPointLightShadows),G.push(ie.numSpotLightShadows),G.push(ie.numSpotLightShadowsWithMaps),G.push(ie.numLightProbes),G.push(ie.shadowMapType),G.push(ie.toneMapping),G.push(ie.numClippingPlanes),G.push(ie.numClipIntersection),G.push(ie.depthPacking)}function B(G,ie){a.disableAll(),ie.instancing&&a.enable(0),ie.instancingColor&&a.enable(1),ie.instancingMorph&&a.enable(2),ie.matcap&&a.enable(3),ie.envMap&&a.enable(4),ie.normalMapObjectSpace&&a.enable(5),ie.normalMapTangentSpace&&a.enable(6),ie.clearcoat&&a.enable(7),ie.iridescence&&a.enable(8),ie.alphaTest&&a.enable(9),ie.vertexColors&&a.enable(10),ie.vertexAlphas&&a.enable(11),ie.vertexUv1s&&a.enable(12),ie.vertexUv2s&&a.enable(13),ie.vertexUv3s&&a.enable(14),ie.vertexTangents&&a.enable(15),ie.anisotropy&&a.enable(16),ie.alphaHash&&a.enable(17),ie.batching&&a.enable(18),ie.dispersion&&a.enable(19),ie.batchingColor&&a.enable(20),ie.gradientMap&&a.enable(21),G.push(a.mask),a.disableAll(),ie.fog&&a.enable(0),ie.useFog&&a.enable(1),ie.flatShading&&a.enable(2),ie.logarithmicDepthBuffer&&a.enable(3),ie.reversedDepthBuffer&&a.enable(4),ie.skinning&&a.enable(5),ie.morphTargets&&a.enable(6),ie.morphNormals&&a.enable(7),ie.morphColors&&a.enable(8),ie.premultipliedAlpha&&a.enable(9),ie.shadowMapEnabled&&a.enable(10),ie.doubleSided&&a.enable(11),ie.flipSided&&a.enable(12),ie.useDepthPacking&&a.enable(13),ie.dithering&&a.enable(14),ie.transmission&&a.enable(15),ie.sheen&&a.enable(16),ie.opaque&&a.enable(17),ie.pointsUvs&&a.enable(18),ie.decodeVideoTexture&&a.enable(19),ie.decodeVideoTextureEmissive&&a.enable(20),ie.alphaToCoverage&&a.enable(21),G.push(a.mask)}function Y(G){const ie=C[G.type];let Me;if(ie){const X=Q1[ie];Me=Oke.clone(X.uniforms)}else Me=G.uniforms;return Me}function A(G,ie){let Me=y.get(ie);return Me!==void 0?++Me.usedTimes:(Me=new $Ue(i,ie,G,r),p.push(Me),y.set(ie,Me)),Me}function ne(G){if(--G.usedTimes===0){const ie=p.indexOf(G);p[ie]=p[p.length-1],p.pop(),y.delete(G.cacheKey),G.destroy()}}function se(G){c.remove(G)}function oe(){c.dispose()}return{getParameters:F,getProgramCacheKey:U,getUniforms:Y,acquireProgram:A,releaseProgram:ne,releaseShaderCache:se,programs:p,dispose:oe}}function QUe(){let i=new WeakMap;function e(a){return i.has(a)}function t(a){let c=i.get(a);return c===void 0&&(c={},i.set(a,c)),c}function n(a){i.delete(a)}function r(a,c,d){i.get(a)[c]=d}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function JUe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.materialVariant!==e.materialVariant?i.materialVariant-e.materialVariant:i.z!==e.z?i.z-e.z:i.id-e.id}function f4e(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function p4e(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function a(w){let C=0;return w.isInstancedMesh&&(C+=2),w.isSkinnedMesh&&(C+=1),C}function c(w,C,N,F,U,R){let B=i[e];return B===void 0?(B={id:w.id,object:w,geometry:C,material:N,materialVariant:a(w),groupOrder:F,renderOrder:w.renderOrder,z:U,group:R},i[e]=B):(B.id=w.id,B.object=w,B.geometry=C,B.material=N,B.materialVariant=a(w),B.groupOrder=F,B.renderOrder=w.renderOrder,B.z=U,B.group=R),e++,B}function d(w,C,N,F,U,R){const B=c(w,C,N,F,U,R);N.transmission>0?n.push(B):N.transparent===!0?r.push(B):t.push(B)}function p(w,C,N,F,U,R){const B=c(w,C,N,F,U,R);N.transmission>0?n.unshift(B):N.transparent===!0?r.unshift(B):t.unshift(B)}function y(w,C){t.length>1&&t.sort(w||JUe),n.length>1&&n.sort(C||f4e),r.length>1&&r.sort(C||f4e)}function x(){for(let w=e,C=i.length;w<C;w++){const N=i[w];if(N.id===null)break;N.id=null,N.object=null,N.geometry=null,N.material=null,N.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:d,unshift:p,finish:x,sort:y}}function eBe(){let i=new WeakMap;function e(n,r){const s=i.get(n);let a;return s===void 0?(a=new p4e,i.set(n,[a])):r>=s.length?(a=new p4e,s.push(a)):a=s[r],a}function t(){i=new WeakMap}return{get:e,dispose:t}}function tBe(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new _e,color:new xn};break;case"SpotLight":t={position:new _e,direction:new _e,color:new xn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new _e,color:new xn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new _e,skyColor:new xn,groundColor:new xn};break;case"RectAreaLight":t={color:new xn,position:new _e,halfWidth:new _e,halfHeight:new _e};break}return i[e.id]=t,t}}}function nBe(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let rBe=0;function iBe(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function sBe(i){const e=new tBe,t=nBe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new _e);const r=new _e,s=new An,a=new An;function c(p){let y=0,x=0,w=0;for(let ie=0;ie<9;ie++)n.probe[ie].set(0,0,0);let C=0,N=0,F=0,U=0,R=0,B=0,Y=0,A=0,ne=0,se=0,oe=0;p.sort(iBe);for(let ie=0,Me=p.length;ie<Me;ie++){const X=p[ie],De=X.color,$e=X.intensity,ot=X.distance;let He=null;if(X.shadow&&X.shadow.map&&(X.shadow.map.texture.format===Oc?He=X.shadow.map.texture:He=X.shadow.map.depthTexture||X.shadow.map.texture),X.isAmbientLight)y+=De.r*$e,x+=De.g*$e,w+=De.b*$e;else if(X.isLightProbe){for(let ce=0;ce<9;ce++)n.probe[ce].addScaledVector(X.sh.coefficients[ce],$e);oe++}else if(X.isDirectionalLight){const ce=e.get(X);if(ce.color.copy(X.color).multiplyScalar(X.intensity),X.castShadow){const Ge=X.shadow,Ie=t.get(X);Ie.shadowIntensity=Ge.intensity,Ie.shadowBias=Ge.bias,Ie.shadowNormalBias=Ge.normalBias,Ie.shadowRadius=Ge.radius,Ie.shadowMapSize=Ge.mapSize,n.directionalShadow[C]=Ie,n.directionalShadowMap[C]=He,n.directionalShadowMatrix[C]=X.shadow.matrix,B++}n.directional[C]=ce,C++}else if(X.isSpotLight){const ce=e.get(X);ce.position.setFromMatrixPosition(X.matrixWorld),ce.color.copy(De).multiplyScalar($e),ce.distance=ot,ce.coneCos=Math.cos(X.angle),ce.penumbraCos=Math.cos(X.angle*(1-X.penumbra)),ce.decay=X.decay,n.spot[F]=ce;const Ge=X.shadow;if(X.map&&(n.spotLightMap[ne]=X.map,ne++,Ge.updateMatrices(X),X.castShadow&&se++),n.spotLightMatrix[F]=Ge.matrix,X.castShadow){const Ie=t.get(X);Ie.shadowIntensity=Ge.intensity,Ie.shadowBias=Ge.bias,Ie.shadowNormalBias=Ge.normalBias,Ie.shadowRadius=Ge.radius,Ie.shadowMapSize=Ge.mapSize,n.spotShadow[F]=Ie,n.spotShadowMap[F]=He,A++}F++}else if(X.isRectAreaLight){const ce=e.get(X);ce.color.copy(De).multiplyScalar($e),ce.halfWidth.set(X.width*.5,0,0),ce.halfHeight.set(0,X.height*.5,0),n.rectArea[U]=ce,U++}else if(X.isPointLight){const ce=e.get(X);if(ce.color.copy(X.color).multiplyScalar(X.intensity),ce.distance=X.distance,ce.decay=X.decay,X.castShadow){const Ge=X.shadow,Ie=t.get(X);Ie.shadowIntensity=Ge.intensity,Ie.shadowBias=Ge.bias,Ie.shadowNormalBias=Ge.normalBias,Ie.shadowRadius=Ge.radius,Ie.shadowMapSize=Ge.mapSize,Ie.shadowCameraNear=Ge.camera.near,Ie.shadowCameraFar=Ge.camera.far,n.pointShadow[N]=Ie,n.pointShadowMap[N]=He,n.pointShadowMatrix[N]=X.shadow.matrix,Y++}n.point[N]=ce,N++}else if(X.isHemisphereLight){const ce=e.get(X);ce.skyColor.copy(X.color).multiplyScalar($e),ce.groundColor.copy(X.groundColor).multiplyScalar($e),n.hemi[R]=ce,R++}}U>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=kn.LTC_FLOAT_1,n.rectAreaLTC2=kn.LTC_FLOAT_2):(n.rectAreaLTC1=kn.LTC_HALF_1,n.rectAreaLTC2=kn.LTC_HALF_2)),n.ambient[0]=y,n.ambient[1]=x,n.ambient[2]=w;const G=n.hash;(G.directionalLength!==C||G.pointLength!==N||G.spotLength!==F||G.rectAreaLength!==U||G.hemiLength!==R||G.numDirectionalShadows!==B||G.numPointShadows!==Y||G.numSpotShadows!==A||G.numSpotMaps!==ne||G.numLightProbes!==oe)&&(n.directional.length=C,n.spot.length=F,n.rectArea.length=U,n.point.length=N,n.hemi.length=R,n.directionalShadow.length=B,n.directionalShadowMap.length=B,n.pointShadow.length=Y,n.pointShadowMap.length=Y,n.spotShadow.length=A,n.spotShadowMap.length=A,n.directionalShadowMatrix.length=B,n.pointShadowMatrix.length=Y,n.spotLightMatrix.length=A+ne-se,n.spotLightMap.length=ne,n.numSpotLightShadowsWithMaps=se,n.numLightProbes=oe,G.directionalLength=C,G.pointLength=N,G.spotLength=F,G.rectAreaLength=U,G.hemiLength=R,G.numDirectionalShadows=B,G.numPointShadows=Y,G.numSpotShadows=A,G.numSpotMaps=ne,G.numLightProbes=oe,n.version=rBe++)}function d(p,y){let x=0,w=0,C=0,N=0,F=0;const U=y.matrixWorldInverse;for(let R=0,B=p.length;R<B;R++){const Y=p[R];if(Y.isDirectionalLight){const A=n.directional[x];A.direction.setFromMatrixPosition(Y.matrixWorld),r.setFromMatrixPosition(Y.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(U),x++}else if(Y.isSpotLight){const A=n.spot[C];A.position.setFromMatrixPosition(Y.matrixWorld),A.position.applyMatrix4(U),A.direction.setFromMatrixPosition(Y.matrixWorld),r.setFromMatrixPosition(Y.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(U),C++}else if(Y.isRectAreaLight){const A=n.rectArea[N];A.position.setFromMatrixPosition(Y.matrixWorld),A.position.applyMatrix4(U),a.identity(),s.copy(Y.matrixWorld),s.premultiply(U),a.extractRotation(s),A.halfWidth.set(Y.width*.5,0,0),A.halfHeight.set(0,Y.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),N++}else if(Y.isPointLight){const A=n.point[w];A.position.setFromMatrixPosition(Y.matrixWorld),A.position.applyMatrix4(U),w++}else if(Y.isHemisphereLight){const A=n.hemi[F];A.direction.setFromMatrixPosition(Y.matrixWorld),A.direction.transformDirection(U),F++}}}return{setup:c,setupView:d,state:n}}function m4e(i){const e=new sBe(i),t=[],n=[];function r(y){p.camera=y,t.length=0,n.length=0}function s(y){t.push(y)}function a(y){n.push(y)}function c(){e.setup(t)}function d(y){e.setupView(t,y)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:c,setupLightsView:d,pushLight:s,pushShadow:a}}function oBe(i){let e=new WeakMap;function t(r,s=0){const a=e.get(r);let c;return a===void 0?(c=new m4e(i),e.set(r,[c])):s>=a.length?(c=new m4e(i),a.push(c)):c=a[s],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const aBe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,lBe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,cBe=[new _e(1,0,0),new _e(-1,0,0),new _e(0,1,0),new _e(0,-1,0),new _e(0,0,1),new _e(0,0,-1)],uBe=[new _e(0,-1,0),new _e(0,-1,0),new _e(0,0,1),new _e(0,0,-1),new _e(0,-1,0),new _e(0,-1,0)],g4e=new An,sT=new _e,lj=new _e;function dBe(i,e,t){let n=new UE;const r=new vn,s=new vn,a=new wr,c=new Jve,d=new zke,p={},y=t.maxTextureSize,x={[ol]:Ui,[Ui]:ol,[no]:no},w=new za({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new vn},radius:{value:4}},vertexShader:aBe,fragmentShader:lBe}),C=w.clone();C.defines.HORIZONTAL_PASS=1;const N=new Ii;N.setAttribute("position",new Ba(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const F=new fn(N,w),U=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Y_;let R=this.type;this.render=function(se,oe,G){if(U.enabled===!1||U.autoUpdate===!1&&U.needsUpdate===!1||se.length===0)return;this.type===kve&&(Wt("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),this.type=Y_);const ie=i.getRenderTarget(),Me=i.getActiveCubeFace(),X=i.getActiveMipmapLevel(),De=i.state;De.setBlending(vo),De.buffers.depth.getReversed()===!0?De.buffers.color.setClear(0,0,0,0):De.buffers.color.setClear(1,1,1,1),De.buffers.depth.setTest(!0),De.setScissorTest(!1);const $e=R!==this.type;$e&&oe.traverse(function(ot){ot.material&&(Array.isArray(ot.material)?ot.material.forEach(He=>He.needsUpdate=!0):ot.material.needsUpdate=!0)});for(let ot=0,He=se.length;ot<He;ot++){const ce=se[ot],Ge=ce.shadow;if(Ge===void 0){Wt("WebGLShadowMap:",ce,"has no shadow.");continue}if(Ge.autoUpdate===!1&&Ge.needsUpdate===!1)continue;r.copy(Ge.mapSize);const Ie=Ge.getFrameExtents();r.multiply(Ie),s.copy(Ge.mapSize),(r.x>y||r.y>y)&&(r.x>y&&(s.x=Math.floor(y/Ie.x),r.x=s.x*Ie.x,Ge.mapSize.x=s.x),r.y>y&&(s.y=Math.floor(y/Ie.y),r.y=s.y*Ie.y,Ge.mapSize.y=s.y));const st=i.state.buffers.depth.getReversed();if(Ge.camera._reversedDepth=st,Ge.map===null||$e===!0){if(Ge.map!==null&&(Ge.map.depthTexture!==null&&(Ge.map.depthTexture.dispose(),Ge.map.depthTexture=null),Ge.map.dispose()),this.type===em){if(ce.isPointLight){Wt("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}Ge.map=new Ja(r.x,r.y,{format:Oc,type:Gs,minFilter:Bi,magFilter:Bi,generateMipmaps:!1}),Ge.map.texture.name=ce.name+".shadowMap",Ge.map.depthTexture=new ll(r.x,r.y,mo),Ge.map.depthTexture.name=ce.name+".shadowMapDepth",Ge.map.depthTexture.format=al,Ge.map.depthTexture.compareFunction=null,Ge.map.depthTexture.minFilter=Hi,Ge.map.depthTexture.magFilter=Hi}else ce.isPointLight?(Ge.map=new p8e(r.x),Ge.map.depthTexture=new jve(r.x,ys)):(Ge.map=new Ja(r.x,r.y),Ge.map.depthTexture=new ll(r.x,r.y,ys)),Ge.map.depthTexture.name=ce.name+".shadowMap",Ge.map.depthTexture.format=al,this.type===Y_?(Ge.map.depthTexture.compareFunction=st?p6:f6,Ge.map.depthTexture.minFilter=Bi,Ge.map.depthTexture.magFilter=Bi):(Ge.map.depthTexture.compareFunction=null,Ge.map.depthTexture.minFilter=Hi,Ge.map.depthTexture.magFilter=Hi);Ge.camera.updateProjectionMatrix()}const bt=Ge.map.isWebGLCubeRenderTarget?6:1;for(let Ne=0;Ne<bt;Ne++){if(Ge.map.isWebGLCubeRenderTarget)i.setRenderTarget(Ge.map,Ne),i.clear();else{Ne===0&&(i.setRenderTarget(Ge.map),i.clear());const ht=Ge.getViewport(Ne);a.set(s.x*ht.x,s.y*ht.y,s.x*ht.z,s.y*ht.w),De.viewport(a)}if(ce.isPointLight){const ht=Ge.camera,Ot=Ge.matrix,wn=ce.distance||ht.far;wn!==ht.far&&(ht.far=wn,ht.updateProjectionMatrix()),sT.setFromMatrixPosition(ce.matrixWorld),ht.position.copy(sT),lj.copy(ht.position),lj.add(cBe[Ne]),ht.up.copy(uBe[Ne]),ht.lookAt(lj),ht.updateMatrixWorld(),Ot.makeTranslation(-sT.x,-sT.y,-sT.z),g4e.multiplyMatrices(ht.projectionMatrix,ht.matrixWorldInverse),Ge._frustum.setFromProjectionMatrix(g4e,ht.coordinateSystem,ht.reversedDepth)}else Ge.updateMatrices(ce);n=Ge.getFrustum(),A(oe,G,Ge.camera,ce,this.type)}Ge.isPointLightShadow!==!0&&this.type===em&&B(Ge,G),Ge.needsUpdate=!1}R=this.type,U.needsUpdate=!1,i.setRenderTarget(ie,Me,X)};function B(se,oe){const G=e.update(F);w.defines.VSM_SAMPLES!==se.blurSamples&&(w.defines.VSM_SAMPLES=se.blurSamples,C.defines.VSM_SAMPLES=se.blurSamples,w.needsUpdate=!0,C.needsUpdate=!0),se.mapPass===null&&(se.mapPass=new Ja(r.x,r.y,{format:Oc,type:Gs})),w.uniforms.shadow_pass.value=se.map.depthTexture,w.uniforms.resolution.value=se.mapSize,w.uniforms.radius.value=se.radius,i.setRenderTarget(se.mapPass),i.clear(),i.renderBufferDirect(oe,null,G,w,F,null),C.uniforms.shadow_pass.value=se.mapPass.texture,C.uniforms.resolution.value=se.mapSize,C.uniforms.radius.value=se.radius,i.setRenderTarget(se.map),i.clear(),i.renderBufferDirect(oe,null,G,C,F,null)}function Y(se,oe,G,ie){let Me=null;const X=G.isPointLight===!0?se.customDistanceMaterial:se.customDepthMaterial;if(X!==void 0)Me=X;else if(Me=G.isPointLight===!0?d:c,i.localClippingEnabled&&oe.clipShadows===!0&&Array.isArray(oe.clippingPlanes)&&oe.clippingPlanes.length!==0||oe.displacementMap&&oe.displacementScale!==0||oe.alphaMap&&oe.alphaTest>0||oe.map&&oe.alphaTest>0||oe.alphaToCoverage===!0){const De=Me.uuid,$e=oe.uuid;let ot=p[De];ot===void 0&&(ot={},p[De]=ot);let He=ot[$e];He===void 0&&(He=Me.clone(),ot[$e]=He,oe.addEventListener("dispose",ne)),Me=He}if(Me.visible=oe.visible,Me.wireframe=oe.wireframe,ie===em?Me.side=oe.shadowSide!==null?oe.shadowSide:oe.side:Me.side=oe.shadowSide!==null?oe.shadowSide:x[oe.side],Me.alphaMap=oe.alphaMap,Me.alphaTest=oe.alphaToCoverage===!0?.5:oe.alphaTest,Me.map=oe.map,Me.clipShadows=oe.clipShadows,Me.clippingPlanes=oe.clippingPlanes,Me.clipIntersection=oe.clipIntersection,Me.displacementMap=oe.displacementMap,Me.displacementScale=oe.displacementScale,Me.displacementBias=oe.displacementBias,Me.wireframeLinewidth=oe.wireframeLinewidth,Me.linewidth=oe.linewidth,G.isPointLight===!0&&Me.isMeshDistanceMaterial===!0){const De=i.properties.get(Me);De.light=G}return Me}function A(se,oe,G,ie,Me){if(se.visible===!1)return;if(se.layers.test(oe.layers)&&(se.isMesh||se.isLine||se.isPoints)&&(se.castShadow||se.receiveShadow&&Me===em)&&(!se.frustumCulled||n.intersectsObject(se))){se.modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,se.matrixWorld);const $e=e.update(se),ot=se.material;if(Array.isArray(ot)){const He=$e.groups;for(let ce=0,Ge=He.length;ce<Ge;ce++){const Ie=He[ce],st=ot[Ie.materialIndex];if(st&&st.visible){const bt=Y(se,st,ie,Me);se.onBeforeShadow(i,se,oe,G,$e,bt,Ie),i.renderBufferDirect(G,null,$e,bt,se,Ie),se.onAfterShadow(i,se,oe,G,$e,bt,Ie)}}}else if(ot.visible){const He=Y(se,ot,ie,Me);se.onBeforeShadow(i,se,oe,G,$e,He,null),i.renderBufferDirect(G,null,$e,He,se,null),se.onAfterShadow(i,se,oe,G,$e,He,null)}}const De=se.children;for(let $e=0,ot=De.length;$e<ot;$e++)A(De[$e],oe,G,ie,Me)}function ne(se){se.target.removeEventListener("dispose",ne);for(const G in p){const ie=p[G],Me=se.target.uuid;Me in ie&&(ie[Me].dispose(),delete ie[Me])}}}function hBe(i,e){function t(){let Qe=!1;const gn=new wr;let un=null;const Cn=new wr(0,0,0,0);return{setMask:function(on){un!==on&&!Qe&&(i.colorMask(on,on,on,on),un=on)},setLocked:function(on){Qe=on},setClear:function(on,zt,Gn,Ir,zi){zi===!0&&(on*=Ir,zt*=Ir,Gn*=Ir),gn.set(on,zt,Gn,Ir),Cn.equals(gn)===!1&&(i.clearColor(on,zt,Gn,Ir),Cn.copy(gn))},reset:function(){Qe=!1,un=null,Cn.set(-1,0,0,0)}}}function n(){let Qe=!1,gn=!1,un=null,Cn=null,on=null;return{setReversed:function(zt){if(gn!==zt){const Gn=e.get("EXT_clip_control");zt?Gn.clipControlEXT(Gn.LOWER_LEFT_EXT,Gn.ZERO_TO_ONE_EXT):Gn.clipControlEXT(Gn.LOWER_LEFT_EXT,Gn.NEGATIVE_ONE_TO_ONE_EXT),gn=zt;const Ir=on;on=null,this.setClear(Ir)}},getReversed:function(){return gn},setTest:function(zt){zt?Gt(i.DEPTH_TEST):$t(i.DEPTH_TEST)},setMask:function(zt){un!==zt&&!Qe&&(i.depthMask(zt),un=zt)},setFunc:function(zt){if(gn&&(zt=UW[zt]),Cn!==zt){switch(zt){case JT:i.depthFunc(i.NEVER);break;case eE:i.depthFunc(i.ALWAYS);break;case tE:i.depthFunc(i.LESS);break;case C4:i.depthFunc(i.LEQUAL);break;case nE:i.depthFunc(i.EQUAL);break;case rE:i.depthFunc(i.GEQUAL);break;case iE:i.depthFunc(i.GREATER);break;case sE:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Cn=zt}},setLocked:function(zt){Qe=zt},setClear:function(zt){on!==zt&&(on=zt,gn&&(zt=1-zt),i.clearDepth(zt))},reset:function(){Qe=!1,un=null,Cn=null,on=null,gn=!1}}}function r(){let Qe=!1,gn=null,un=null,Cn=null,on=null,zt=null,Gn=null,Ir=null,zi=null;return{setTest:function(Tr){Qe||(Tr?Gt(i.STENCIL_TEST):$t(i.STENCIL_TEST))},setMask:function(Tr){gn!==Tr&&!Qe&&(i.stencilMask(Tr),gn=Tr)},setFunc:function(Tr,Ms,Ko){(un!==Tr||Cn!==Ms||on!==Ko)&&(i.stencilFunc(Tr,Ms,Ko),un=Tr,Cn=Ms,on=Ko)},setOp:function(Tr,Ms,Ko){(zt!==Tr||Gn!==Ms||Ir!==Ko)&&(i.stencilOp(Tr,Ms,Ko),zt=Tr,Gn=Ms,Ir=Ko)},setLocked:function(Tr){Qe=Tr},setClear:function(Tr){zi!==Tr&&(i.clearStencil(Tr),zi=Tr)},reset:function(){Qe=!1,gn=null,un=null,Cn=null,on=null,zt=null,Gn=null,Ir=null,zi=null}}}const s=new t,a=new n,c=new r,d=new WeakMap,p=new WeakMap;let y={},x={},w=new WeakMap,C=[],N=null,F=!1,U=null,R=null,B=null,Y=null,A=null,ne=null,se=null,oe=new xn(0,0,0),G=0,ie=!1,Me=null,X=null,De=null,$e=null,ot=null;const He=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ce=!1,Ge=0;const Ie=i.getParameter(i.VERSION);Ie.indexOf("WebGL")!==-1?(Ge=parseFloat(/^WebGL (\d)/.exec(Ie)[1]),ce=Ge>=1):Ie.indexOf("OpenGL ES")!==-1&&(Ge=parseFloat(/^OpenGL ES (\d)/.exec(Ie)[1]),ce=Ge>=2);let st=null,bt={};const Ne=i.getParameter(i.SCISSOR_BOX),ht=i.getParameter(i.VIEWPORT),Ot=new wr().fromArray(Ne),wn=new wr().fromArray(ht);function bn(Qe,gn,un,Cn){const on=new Uint8Array(4),zt=i.createTexture();i.bindTexture(Qe,zt),i.texParameteri(Qe,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(Qe,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Gn=0;Gn<un;Gn++)Qe===i.TEXTURE_3D||Qe===i.TEXTURE_2D_ARRAY?i.texImage3D(gn,0,i.RGBA,1,1,Cn,0,i.RGBA,i.UNSIGNED_BYTE,on):i.texImage2D(gn+Gn,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,on);return zt}const Tt={};Tt[i.TEXTURE_2D]=bn(i.TEXTURE_2D,i.TEXTURE_2D,1),Tt[i.TEXTURE_CUBE_MAP]=bn(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Tt[i.TEXTURE_2D_ARRAY]=bn(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Tt[i.TEXTURE_3D]=bn(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),c.setClear(0),Gt(i.DEPTH_TEST),a.setFunc(C4),Vr(!1),ai(TH),Gt(i.CULL_FACE),Br(vo);function Gt(Qe){y[Qe]!==!0&&(i.enable(Qe),y[Qe]=!0)}function $t(Qe){y[Qe]!==!1&&(i.disable(Qe),y[Qe]=!1)}function Ln(Qe,gn){return x[Qe]!==gn?(i.bindFramebuffer(Qe,gn),x[Qe]=gn,Qe===i.DRAW_FRAMEBUFFER&&(x[i.FRAMEBUFFER]=gn),Qe===i.FRAMEBUFFER&&(x[i.DRAW_FRAMEBUFFER]=gn),!0):!1}function jn(Qe,gn){let un=C,Cn=!1;if(Qe){un=w.get(gn),un===void 0&&(un=[],w.set(gn,un));const on=Qe.textures;if(un.length!==on.length||un[0]!==i.COLOR_ATTACHMENT0){for(let zt=0,Gn=on.length;zt<Gn;zt++)un[zt]=i.COLOR_ATTACHMENT0+zt;un.length=on.length,Cn=!0}}else un[0]!==i.BACK&&(un[0]=i.BACK,Cn=!0);Cn&&i.drawBuffers(un)}function fr(Qe){return N!==Qe?(i.useProgram(Qe),N=Qe,!0):!1}const ds={[A0]:i.FUNC_ADD,[Pk]:i.FUNC_SUBTRACT,[Rk]:i.FUNC_REVERSE_SUBTRACT};ds[wW]=i.MIN,ds[TW]=i.MAX;const Wr={[Xf]:i.ZERO,[CE]:i.ONE,[AE]:i.SRC_COLOR,[E4]:i.SRC_ALPHA,[Ik]:i.SRC_ALPHA_SATURATE,[NE]:i.DST_COLOR,[RE]:i.DST_ALPHA,[PE]:i.ONE_MINUS_SRC_COLOR,[M4]:i.ONE_MINUS_SRC_ALPHA,[kE]:i.ONE_MINUS_DST_COLOR,[IE]:i.ONE_MINUS_DST_ALPHA,[EW]:i.CONSTANT_COLOR,[MW]:i.ONE_MINUS_CONSTANT_COLOR,[CW]:i.CONSTANT_ALPHA,[AW]:i.ONE_MINUS_CONSTANT_ALPHA};function Br(Qe,gn,un,Cn,on,zt,Gn,Ir,zi,Tr){if(Qe===vo){F===!0&&($t(i.BLEND),F=!1);return}if(F===!1&&(Gt(i.BLEND),F=!0),Qe!==m4){if(Qe!==U||Tr!==ie){if((R!==A0||A!==A0)&&(i.blendEquation(i.FUNC_ADD),R=A0,A=A0),Tr)switch(Qe){case rl:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case p2:i.blendFunc(i.ONE,i.ONE);break;case m2:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case g2:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:jt("WebGLState: Invalid blending: ",Qe);break}else switch(Qe){case rl:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case p2:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case m2:jt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case g2:jt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:jt("WebGLState: Invalid blending: ",Qe);break}B=null,Y=null,ne=null,se=null,oe.set(0,0,0),G=0,U=Qe,ie=Tr}return}on=on||gn,zt=zt||un,Gn=Gn||Cn,(gn!==R||on!==A)&&(i.blendEquationSeparate(ds[gn],ds[on]),R=gn,A=on),(un!==B||Cn!==Y||zt!==ne||Gn!==se)&&(i.blendFuncSeparate(Wr[un],Wr[Cn],Wr[zt],Wr[Gn]),B=un,Y=Cn,ne=zt,se=Gn),(Ir.equals(oe)===!1||zi!==G)&&(i.blendColor(Ir.r,Ir.g,Ir.b,zi),oe.copy(Ir),G=zi),U=Qe,ie=!1}function Kr(Qe,gn){Qe.side===no?$t(i.CULL_FACE):Gt(i.CULL_FACE);let un=Qe.side===Ui;gn&&(un=!un),Vr(un),Qe.blending===rl&&Qe.transparent===!1?Br(vo):Br(Qe.blending,Qe.blendEquation,Qe.blendSrc,Qe.blendDst,Qe.blendEquationAlpha,Qe.blendSrcAlpha,Qe.blendDstAlpha,Qe.blendColor,Qe.blendAlpha,Qe.premultipliedAlpha),a.setFunc(Qe.depthFunc),a.setTest(Qe.depthTest),a.setMask(Qe.depthWrite),s.setMask(Qe.colorWrite);const Cn=Qe.stencilWrite;c.setTest(Cn),Cn&&(c.setMask(Qe.stencilWriteMask),c.setFunc(Qe.stencilFunc,Qe.stencilRef,Qe.stencilFuncMask),c.setOp(Qe.stencilFail,Qe.stencilZFail,Qe.stencilZPass)),hs(Qe.polygonOffset,Qe.polygonOffsetFactor,Qe.polygonOffsetUnits),Qe.alphaToCoverage===!0?Gt(i.SAMPLE_ALPHA_TO_COVERAGE):$t(i.SAMPLE_ALPHA_TO_COVERAGE)}function Vr(Qe){Me!==Qe&&(Qe?i.frontFace(i.CW):i.frontFace(i.CCW),Me=Qe)}function ai(Qe){Qe!==Ive?(Gt(i.CULL_FACE),Qe!==X&&(Qe===TH?i.cullFace(i.BACK):Qe===Nve?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):$t(i.CULL_FACE),X=Qe}function qe(Qe){Qe!==De&&(ce&&i.lineWidth(Qe),De=Qe)}function hs(Qe,gn,un){Qe?(Gt(i.POLYGON_OFFSET_FILL),($e!==gn||ot!==un)&&($e=gn,ot=un,a.getReversed()&&(gn=-gn),i.polygonOffset(gn,un))):$t(i.POLYGON_OFFSET_FILL)}function ni(Qe){Qe?Gt(i.SCISSOR_TEST):$t(i.SCISSOR_TEST)}function gi(Qe){Qe===void 0&&(Qe=i.TEXTURE0+He-1),st!==Qe&&(i.activeTexture(Qe),st=Qe)}function Fn(Qe,gn,un){un===void 0&&(st===null?un=i.TEXTURE0+He-1:un=st);let Cn=bt[un];Cn===void 0&&(Cn={type:void 0,texture:void 0},bt[un]=Cn),(Cn.type!==Qe||Cn.texture!==gn)&&(st!==un&&(i.activeTexture(un),st=un),i.bindTexture(Qe,gn||Tt[Qe]),Cn.type=Qe,Cn.texture=gn)}function Pe(){const Qe=bt[st];Qe!==void 0&&Qe.type!==void 0&&(i.bindTexture(Qe.type,null),Qe.type=void 0,Qe.texture=void 0)}function de(){try{i.compressedTexImage2D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function dt(){try{i.compressedTexImage3D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function qt(){try{i.texSubImage2D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function Xt(){try{i.texSubImage3D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function Bt(){try{i.compressedTexSubImage2D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function $n(){try{i.compressedTexSubImage3D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function _n(){try{i.texStorage2D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function tr(){try{i.texStorage3D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function Mr(){try{i.texImage2D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function Qt(){try{i.texImage3D(...arguments)}catch(Qe){jt("WebGLState:",Qe)}}function pn(Qe){Ot.equals(Qe)===!1&&(i.scissor(Qe.x,Qe.y,Qe.z,Qe.w),Ot.copy(Qe))}function Un(Qe){wn.equals(Qe)===!1&&(i.viewport(Qe.x,Qe.y,Qe.z,Qe.w),wn.copy(Qe))}function Vn(Qe,gn){let un=p.get(gn);un===void 0&&(un=new WeakMap,p.set(gn,un));let Cn=un.get(Qe);Cn===void 0&&(Cn=i.getUniformBlockIndex(gn,Qe.name),un.set(Qe,Cn))}function Dn(Qe,gn){const Cn=p.get(gn).get(Qe);d.get(gn)!==Cn&&(i.uniformBlockBinding(gn,Cn,Qe.__bindingPointIndex),d.set(gn,Cn))}function br(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),a.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),y={},st=null,bt={},x={},w=new WeakMap,C=[],N=null,F=!1,U=null,R=null,B=null,Y=null,A=null,ne=null,se=null,oe=new xn(0,0,0),G=0,ie=!1,Me=null,X=null,De=null,$e=null,ot=null,Ot.set(0,0,i.canvas.width,i.canvas.height),wn.set(0,0,i.canvas.width,i.canvas.height),s.reset(),a.reset(),c.reset()}return{buffers:{color:s,depth:a,stencil:c},enable:Gt,disable:$t,bindFramebuffer:Ln,drawBuffers:jn,useProgram:fr,setBlending:Br,setMaterial:Kr,setFlipSided:Vr,setCullFace:ai,setLineWidth:qe,setPolygonOffset:hs,setScissorTest:ni,activeTexture:gi,bindTexture:Fn,unbindTexture:Pe,compressedTexImage2D:de,compressedTexImage3D:dt,texImage2D:Mr,texImage3D:Qt,updateUBOMapping:Vn,uniformBlockBinding:Dn,texStorage2D:_n,texStorage3D:tr,texSubImage2D:qt,texSubImage3D:Xt,compressedTexSubImage2D:Bt,compressedTexSubImage3D:$n,scissor:pn,viewport:Un,reset:br}}function fBe(i,e,t,n,r,s,a){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new vn,y=new WeakMap;let x;const w=new WeakMap;let C=!1;try{C=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function N(Pe,de){return C?new OffscreenCanvas(Pe,de):hE("canvas")}function F(Pe,de,dt){let qt=1;const Xt=Fn(Pe);if((Xt.width>dt||Xt.height>dt)&&(qt=dt/Math.max(Xt.width,Xt.height)),qt<1)if(typeof HTMLImageElement<"u"&&Pe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Pe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Pe instanceof ImageBitmap||typeof VideoFrame<"u"&&Pe instanceof VideoFrame){const Bt=Math.floor(qt*Xt.width),$n=Math.floor(qt*Xt.height);x===void 0&&(x=N(Bt,$n));const _n=de?N(Bt,$n):x;return _n.width=Bt,_n.height=$n,_n.getContext("2d").drawImage(Pe,0,0,Bt,$n),Wt("WebGLRenderer: Texture has been resized from ("+Xt.width+"x"+Xt.height+") to ("+Bt+"x"+$n+")."),_n}else return"data"in Pe&&Wt("WebGLRenderer: Image in DataTexture is too big ("+Xt.width+"x"+Xt.height+")."),Pe;return Pe}function U(Pe){return Pe.generateMipmaps}function R(Pe){i.generateMipmap(Pe)}function B(Pe){return Pe.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:Pe.isWebGL3DRenderTarget?i.TEXTURE_3D:Pe.isWebGLArrayRenderTarget||Pe.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function Y(Pe,de,dt,qt,Xt=!1){if(Pe!==null){if(i[Pe]!==void 0)return i[Pe];Wt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Pe+"'")}let Bt=de;if(de===i.RED&&(dt===i.FLOAT&&(Bt=i.R32F),dt===i.HALF_FLOAT&&(Bt=i.R16F),dt===i.UNSIGNED_BYTE&&(Bt=i.R8)),de===i.RED_INTEGER&&(dt===i.UNSIGNED_BYTE&&(Bt=i.R8UI),dt===i.UNSIGNED_SHORT&&(Bt=i.R16UI),dt===i.UNSIGNED_INT&&(Bt=i.R32UI),dt===i.BYTE&&(Bt=i.R8I),dt===i.SHORT&&(Bt=i.R16I),dt===i.INT&&(Bt=i.R32I)),de===i.RG&&(dt===i.FLOAT&&(Bt=i.RG32F),dt===i.HALF_FLOAT&&(Bt=i.RG16F),dt===i.UNSIGNED_BYTE&&(Bt=i.RG8)),de===i.RG_INTEGER&&(dt===i.UNSIGNED_BYTE&&(Bt=i.RG8UI),dt===i.UNSIGNED_SHORT&&(Bt=i.RG16UI),dt===i.UNSIGNED_INT&&(Bt=i.RG32UI),dt===i.BYTE&&(Bt=i.RG8I),dt===i.SHORT&&(Bt=i.RG16I),dt===i.INT&&(Bt=i.RG32I)),de===i.RGB_INTEGER&&(dt===i.UNSIGNED_BYTE&&(Bt=i.RGB8UI),dt===i.UNSIGNED_SHORT&&(Bt=i.RGB16UI),dt===i.UNSIGNED_INT&&(Bt=i.RGB32UI),dt===i.BYTE&&(Bt=i.RGB8I),dt===i.SHORT&&(Bt=i.RGB16I),dt===i.INT&&(Bt=i.RGB32I)),de===i.RGBA_INTEGER&&(dt===i.UNSIGNED_BYTE&&(Bt=i.RGBA8UI),dt===i.UNSIGNED_SHORT&&(Bt=i.RGBA16UI),dt===i.UNSIGNED_INT&&(Bt=i.RGBA32UI),dt===i.BYTE&&(Bt=i.RGBA8I),dt===i.SHORT&&(Bt=i.RGBA16I),dt===i.INT&&(Bt=i.RGBA32I)),de===i.RGB&&(dt===i.UNSIGNED_INT_5_9_9_9_REV&&(Bt=i.RGB9_E5),dt===i.UNSIGNED_INT_10F_11F_11F_REV&&(Bt=i.R11F_G11F_B10F)),de===i.RGBA){const $n=Xt?Ax:Xn.getTransfer(qt);dt===i.FLOAT&&(Bt=i.RGBA32F),dt===i.HALF_FLOAT&&(Bt=i.RGBA16F),dt===i.UNSIGNED_BYTE&&(Bt=$n===Wn?i.SRGB8_ALPHA8:i.RGBA8),dt===i.UNSIGNED_SHORT_4_4_4_4&&(Bt=i.RGBA4),dt===i.UNSIGNED_SHORT_5_5_5_1&&(Bt=i.RGB5_A1)}return(Bt===i.R16F||Bt===i.R32F||Bt===i.RG16F||Bt===i.RG32F||Bt===i.RGBA16F||Bt===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Bt}function A(Pe,de){let dt;return Pe?de===null||de===ys||de===Cu?dt=i.DEPTH24_STENCIL8:de===mo?dt=i.DEPTH32F_STENCIL8:de===Jf&&(dt=i.DEPTH24_STENCIL8,Wt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):de===null||de===ys||de===Cu?dt=i.DEPTH_COMPONENT24:de===mo?dt=i.DEPTH_COMPONENT32F:de===Jf&&(dt=i.DEPTH_COMPONENT16),dt}function ne(Pe,de){return U(Pe)===!0||Pe.isFramebufferTexture&&Pe.minFilter!==Hi&&Pe.minFilter!==Bi?Math.log2(Math.max(de.width,de.height))+1:Pe.mipmaps!==void 0&&Pe.mipmaps.length>0?Pe.mipmaps.length:Pe.isCompressedTexture&&Array.isArray(Pe.image)?de.mipmaps.length:1}function se(Pe){const de=Pe.target;de.removeEventListener("dispose",se),G(de),de.isVideoTexture&&y.delete(de)}function oe(Pe){const de=Pe.target;de.removeEventListener("dispose",oe),Me(de)}function G(Pe){const de=n.get(Pe);if(de.__webglInit===void 0)return;const dt=Pe.source,qt=w.get(dt);if(qt){const Xt=qt[de.__cacheKey];Xt.usedTimes--,Xt.usedTimes===0&&ie(Pe),Object.keys(qt).length===0&&w.delete(dt)}n.remove(Pe)}function ie(Pe){const de=n.get(Pe);i.deleteTexture(de.__webglTexture);const dt=Pe.source,qt=w.get(dt);delete qt[de.__cacheKey],a.memory.textures--}function Me(Pe){const de=n.get(Pe);if(Pe.depthTexture&&(Pe.depthTexture.dispose(),n.remove(Pe.depthTexture)),Pe.isWebGLCubeRenderTarget)for(let qt=0;qt<6;qt++){if(Array.isArray(de.__webglFramebuffer[qt]))for(let Xt=0;Xt<de.__webglFramebuffer[qt].length;Xt++)i.deleteFramebuffer(de.__webglFramebuffer[qt][Xt]);else i.deleteFramebuffer(de.__webglFramebuffer[qt]);de.__webglDepthbuffer&&i.deleteRenderbuffer(de.__webglDepthbuffer[qt])}else{if(Array.isArray(de.__webglFramebuffer))for(let qt=0;qt<de.__webglFramebuffer.length;qt++)i.deleteFramebuffer(de.__webglFramebuffer[qt]);else i.deleteFramebuffer(de.__webglFramebuffer);if(de.__webglDepthbuffer&&i.deleteRenderbuffer(de.__webglDepthbuffer),de.__webglMultisampledFramebuffer&&i.deleteFramebuffer(de.__webglMultisampledFramebuffer),de.__webglColorRenderbuffer)for(let qt=0;qt<de.__webglColorRenderbuffer.length;qt++)de.__webglColorRenderbuffer[qt]&&i.deleteRenderbuffer(de.__webglColorRenderbuffer[qt]);de.__webglDepthRenderbuffer&&i.deleteRenderbuffer(de.__webglDepthRenderbuffer)}const dt=Pe.textures;for(let qt=0,Xt=dt.length;qt<Xt;qt++){const Bt=n.get(dt[qt]);Bt.__webglTexture&&(i.deleteTexture(Bt.__webglTexture),a.memory.textures--),n.remove(dt[qt])}n.remove(Pe)}let X=0;function De(){X=0}function $e(){const Pe=X;return Pe>=r.maxTextures&&Wt("WebGLTextures: Trying to use "+Pe+" texture units while this GPU supports only "+r.maxTextures),X+=1,Pe}function ot(Pe){const de=[];return de.push(Pe.wrapS),de.push(Pe.wrapT),de.push(Pe.wrapR||0),de.push(Pe.magFilter),de.push(Pe.minFilter),de.push(Pe.anisotropy),de.push(Pe.internalFormat),de.push(Pe.format),de.push(Pe.type),de.push(Pe.generateMipmaps),de.push(Pe.premultiplyAlpha),de.push(Pe.flipY),de.push(Pe.unpackAlignment),de.push(Pe.colorSpace),de.join()}function He(Pe,de){const dt=n.get(Pe);if(Pe.isVideoTexture&&ni(Pe),Pe.isRenderTargetTexture===!1&&Pe.isExternalTexture!==!0&&Pe.version>0&&dt.__version!==Pe.version){const qt=Pe.image;if(qt===null)Wt("WebGLRenderer: Texture marked for update but no image data found.");else if(qt.complete===!1)Wt("WebGLRenderer: Texture marked for update but image is incomplete");else{Tt(dt,Pe,de);return}}else Pe.isExternalTexture&&(dt.__webglTexture=Pe.sourceTexture?Pe.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,dt.__webglTexture,i.TEXTURE0+de)}function ce(Pe,de){const dt=n.get(Pe);if(Pe.isRenderTargetTexture===!1&&Pe.version>0&&dt.__version!==Pe.version){Tt(dt,Pe,de);return}else Pe.isExternalTexture&&(dt.__webglTexture=Pe.sourceTexture?Pe.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,dt.__webglTexture,i.TEXTURE0+de)}function Ge(Pe,de){const dt=n.get(Pe);if(Pe.isRenderTargetTexture===!1&&Pe.version>0&&dt.__version!==Pe.version){Tt(dt,Pe,de);return}t.bindTexture(i.TEXTURE_3D,dt.__webglTexture,i.TEXTURE0+de)}function Ie(Pe,de){const dt=n.get(Pe);if(Pe.isCubeDepthTexture!==!0&&Pe.version>0&&dt.__version!==Pe.version){Gt(dt,Pe,de);return}t.bindTexture(i.TEXTURE_CUBE_MAP,dt.__webglTexture,i.TEXTURE0+de)}const st={[bd]:i.REPEAT,[Co]:i.CLAMP_TO_EDGE,[s6]:i.MIRRORED_REPEAT},bt={[Hi]:i.NEAREST,[RW]:i.NEAREST_MIPMAP_NEAREST,[v2]:i.NEAREST_MIPMAP_LINEAR,[Bi]:i.LINEAR,[Z_]:i.LINEAR_MIPMAP_NEAREST,[Tu]:i.LINEAR_MIPMAP_LINEAR},Ne={[kW]:i.NEVER,[FW]:i.ALWAYS,[Gk]:i.LESS,[f6]:i.LEQUAL,[DW]:i.EQUAL,[p6]:i.GEQUAL,[OW]:i.GREATER,[LW]:i.NOTEQUAL};function ht(Pe,de){if(de.type===mo&&e.has("OES_texture_float_linear")===!1&&(de.magFilter===Bi||de.magFilter===Z_||de.magFilter===v2||de.magFilter===Tu||de.minFilter===Bi||de.minFilter===Z_||de.minFilter===v2||de.minFilter===Tu)&&Wt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(Pe,i.TEXTURE_WRAP_S,st[de.wrapS]),i.texParameteri(Pe,i.TEXTURE_WRAP_T,st[de.wrapT]),(Pe===i.TEXTURE_3D||Pe===i.TEXTURE_2D_ARRAY)&&i.texParameteri(Pe,i.TEXTURE_WRAP_R,st[de.wrapR]),i.texParameteri(Pe,i.TEXTURE_MAG_FILTER,bt[de.magFilter]),i.texParameteri(Pe,i.TEXTURE_MIN_FILTER,bt[de.minFilter]),de.compareFunction&&(i.texParameteri(Pe,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(Pe,i.TEXTURE_COMPARE_FUNC,Ne[de.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(de.magFilter===Hi||de.minFilter!==v2&&de.minFilter!==Tu||de.type===mo&&e.has("OES_texture_float_linear")===!1)return;if(de.anisotropy>1||n.get(de).__currentAnisotropy){const dt=e.get("EXT_texture_filter_anisotropic");i.texParameterf(Pe,dt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(de.anisotropy,r.getMaxAnisotropy())),n.get(de).__currentAnisotropy=de.anisotropy}}}function Ot(Pe,de){let dt=!1;Pe.__webglInit===void 0&&(Pe.__webglInit=!0,de.addEventListener("dispose",se));const qt=de.source;let Xt=w.get(qt);Xt===void 0&&(Xt={},w.set(qt,Xt));const Bt=ot(de);if(Bt!==Pe.__cacheKey){Xt[Bt]===void 0&&(Xt[Bt]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,dt=!0),Xt[Bt].usedTimes++;const $n=Xt[Pe.__cacheKey];$n!==void 0&&(Xt[Pe.__cacheKey].usedTimes--,$n.usedTimes===0&&ie(de)),Pe.__cacheKey=Bt,Pe.__webglTexture=Xt[Bt].texture}return dt}function wn(Pe,de,dt){return Math.floor(Math.floor(Pe/dt)/de)}function bn(Pe,de,dt,qt){const Bt=Pe.updateRanges;if(Bt.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,de.width,de.height,dt,qt,de.data);else{Bt.sort((Qt,pn)=>Qt.start-pn.start);let $n=0;for(let Qt=1;Qt<Bt.length;Qt++){const pn=Bt[$n],Un=Bt[Qt],Vn=pn.start+pn.count,Dn=wn(Un.start,de.width,4),br=wn(pn.start,de.width,4);Un.start<=Vn+1&&Dn===br&&wn(Un.start+Un.count-1,de.width,4)===Dn?pn.count=Math.max(pn.count,Un.start+Un.count-pn.start):(++$n,Bt[$n]=Un)}Bt.length=$n+1;const _n=i.getParameter(i.UNPACK_ROW_LENGTH),tr=i.getParameter(i.UNPACK_SKIP_PIXELS),Mr=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,de.width);for(let Qt=0,pn=Bt.length;Qt<pn;Qt++){const Un=Bt[Qt],Vn=Math.floor(Un.start/4),Dn=Math.ceil(Un.count/4),br=Vn%de.width,Qe=Math.floor(Vn/de.width),gn=Dn,un=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,br),i.pixelStorei(i.UNPACK_SKIP_ROWS,Qe),t.texSubImage2D(i.TEXTURE_2D,0,br,Qe,gn,un,dt,qt,de.data)}Pe.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,_n),i.pixelStorei(i.UNPACK_SKIP_PIXELS,tr),i.pixelStorei(i.UNPACK_SKIP_ROWS,Mr)}}function Tt(Pe,de,dt){let qt=i.TEXTURE_2D;(de.isDataArrayTexture||de.isCompressedArrayTexture)&&(qt=i.TEXTURE_2D_ARRAY),de.isData3DTexture&&(qt=i.TEXTURE_3D);const Xt=Ot(Pe,de),Bt=de.source;t.bindTexture(qt,Pe.__webglTexture,i.TEXTURE0+dt);const $n=n.get(Bt);if(Bt.version!==$n.__version||Xt===!0){t.activeTexture(i.TEXTURE0+dt);const _n=Xn.getPrimaries(Xn.workingColorSpace),tr=de.colorSpace===il?null:Xn.getPrimaries(de.colorSpace),Mr=de.colorSpace===il||_n===tr?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,de.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,de.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Mr);let Qt=F(de.image,!1,r.maxTextureSize);Qt=gi(de,Qt);const pn=s.convert(de.format,de.colorSpace),Un=s.convert(de.type);let Vn=Y(de.internalFormat,pn,Un,de.colorSpace,de.isVideoTexture);ht(qt,de);let Dn;const br=de.mipmaps,Qe=de.isVideoTexture!==!0,gn=$n.__version===void 0||Xt===!0,un=Bt.dataReady,Cn=ne(de,Qt);if(de.isDepthTexture)Vn=A(de.format===Wl,de.type),gn&&(Qe?t.texStorage2D(i.TEXTURE_2D,1,Vn,Qt.width,Qt.height):t.texImage2D(i.TEXTURE_2D,0,Vn,Qt.width,Qt.height,0,pn,Un,null));else if(de.isDataTexture)if(br.length>0){Qe&&gn&&t.texStorage2D(i.TEXTURE_2D,Cn,Vn,br[0].width,br[0].height);for(let on=0,zt=br.length;on<zt;on++)Dn=br[on],Qe?un&&t.texSubImage2D(i.TEXTURE_2D,on,0,0,Dn.width,Dn.height,pn,Un,Dn.data):t.texImage2D(i.TEXTURE_2D,on,Vn,Dn.width,Dn.height,0,pn,Un,Dn.data);de.generateMipmaps=!1}else Qe?(gn&&t.texStorage2D(i.TEXTURE_2D,Cn,Vn,Qt.width,Qt.height),un&&bn(de,Qt,pn,Un)):t.texImage2D(i.TEXTURE_2D,0,Vn,Qt.width,Qt.height,0,pn,Un,Qt.data);else if(de.isCompressedTexture)if(de.isCompressedArrayTexture){Qe&&gn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Cn,Vn,br[0].width,br[0].height,Qt.depth);for(let on=0,zt=br.length;on<zt;on++)if(Dn=br[on],de.format!==$s)if(pn!==null)if(Qe){if(un)if(de.layerUpdates.size>0){const Gn=UH(Dn.width,Dn.height,de.format,de.type);for(const Ir of de.layerUpdates){const zi=Dn.data.subarray(Ir*Gn/Dn.data.BYTES_PER_ELEMENT,(Ir+1)*Gn/Dn.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,on,0,0,Ir,Dn.width,Dn.height,1,pn,zi)}de.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,on,0,0,0,Dn.width,Dn.height,Qt.depth,pn,Dn.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,on,Vn,Dn.width,Dn.height,Qt.depth,0,Dn.data,0,0);else Wt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Qe?un&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,on,0,0,0,Dn.width,Dn.height,Qt.depth,pn,Un,Dn.data):t.texImage3D(i.TEXTURE_2D_ARRAY,on,Vn,Dn.width,Dn.height,Qt.depth,0,pn,Un,Dn.data)}else{Qe&&gn&&t.texStorage2D(i.TEXTURE_2D,Cn,Vn,br[0].width,br[0].height);for(let on=0,zt=br.length;on<zt;on++)Dn=br[on],de.format!==$s?pn!==null?Qe?un&&t.compressedTexSubImage2D(i.TEXTURE_2D,on,0,0,Dn.width,Dn.height,pn,Dn.data):t.compressedTexImage2D(i.TEXTURE_2D,on,Vn,Dn.width,Dn.height,0,Dn.data):Wt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qe?un&&t.texSubImage2D(i.TEXTURE_2D,on,0,0,Dn.width,Dn.height,pn,Un,Dn.data):t.texImage2D(i.TEXTURE_2D,on,Vn,Dn.width,Dn.height,0,pn,Un,Dn.data)}else if(de.isDataArrayTexture)if(Qe){if(gn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Cn,Vn,Qt.width,Qt.height,Qt.depth),un)if(de.layerUpdates.size>0){const on=UH(Qt.width,Qt.height,de.format,de.type);for(const zt of de.layerUpdates){const Gn=Qt.data.subarray(zt*on/Qt.data.BYTES_PER_ELEMENT,(zt+1)*on/Qt.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,zt,Qt.width,Qt.height,1,pn,Un,Gn)}de.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Qt.width,Qt.height,Qt.depth,pn,Un,Qt.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,Vn,Qt.width,Qt.height,Qt.depth,0,pn,Un,Qt.data);else if(de.isData3DTexture)Qe?(gn&&t.texStorage3D(i.TEXTURE_3D,Cn,Vn,Qt.width,Qt.height,Qt.depth),un&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Qt.width,Qt.height,Qt.depth,pn,Un,Qt.data)):t.texImage3D(i.TEXTURE_3D,0,Vn,Qt.width,Qt.height,Qt.depth,0,pn,Un,Qt.data);else if(de.isFramebufferTexture){if(gn)if(Qe)t.texStorage2D(i.TEXTURE_2D,Cn,Vn,Qt.width,Qt.height);else{let on=Qt.width,zt=Qt.height;for(let Gn=0;Gn<Cn;Gn++)t.texImage2D(i.TEXTURE_2D,Gn,Vn,on,zt,0,pn,Un,null),on>>=1,zt>>=1}}else if(br.length>0){if(Qe&&gn){const on=Fn(br[0]);t.texStorage2D(i.TEXTURE_2D,Cn,Vn,on.width,on.height)}for(let on=0,zt=br.length;on<zt;on++)Dn=br[on],Qe?un&&t.texSubImage2D(i.TEXTURE_2D,on,0,0,pn,Un,Dn):t.texImage2D(i.TEXTURE_2D,on,Vn,pn,Un,Dn);de.generateMipmaps=!1}else if(Qe){if(gn){const on=Fn(Qt);t.texStorage2D(i.TEXTURE_2D,Cn,Vn,on.width,on.height)}un&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,pn,Un,Qt)}else t.texImage2D(i.TEXTURE_2D,0,Vn,pn,Un,Qt);U(de)&&R(qt),$n.__version=Bt.version,de.onUpdate&&de.onUpdate(de)}Pe.__version=de.version}function Gt(Pe,de,dt){if(de.image.length!==6)return;const qt=Ot(Pe,de),Xt=de.source;t.bindTexture(i.TEXTURE_CUBE_MAP,Pe.__webglTexture,i.TEXTURE0+dt);const Bt=n.get(Xt);if(Xt.version!==Bt.__version||qt===!0){t.activeTexture(i.TEXTURE0+dt);const $n=Xn.getPrimaries(Xn.workingColorSpace),_n=de.colorSpace===il?null:Xn.getPrimaries(de.colorSpace),tr=de.colorSpace===il||$n===_n?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,de.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,de.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,tr);const Mr=de.isCompressedTexture||de.image[0].isCompressedTexture,Qt=de.image[0]&&de.image[0].isDataTexture,pn=[];for(let zt=0;zt<6;zt++)!Mr&&!Qt?pn[zt]=F(de.image[zt],!0,r.maxCubemapSize):pn[zt]=Qt?de.image[zt].image:de.image[zt],pn[zt]=gi(de,pn[zt]);const Un=pn[0],Vn=s.convert(de.format,de.colorSpace),Dn=s.convert(de.type),br=Y(de.internalFormat,Vn,Dn,de.colorSpace),Qe=de.isVideoTexture!==!0,gn=Bt.__version===void 0||qt===!0,un=Xt.dataReady;let Cn=ne(de,Un);ht(i.TEXTURE_CUBE_MAP,de);let on;if(Mr){Qe&&gn&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Cn,br,Un.width,Un.height);for(let zt=0;zt<6;zt++){on=pn[zt].mipmaps;for(let Gn=0;Gn<on.length;Gn++){const Ir=on[Gn];de.format!==$s?Vn!==null?Qe?un&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn,0,0,Ir.width,Ir.height,Vn,Ir.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn,br,Ir.width,Ir.height,0,Ir.data):Wt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Qe?un&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn,0,0,Ir.width,Ir.height,Vn,Dn,Ir.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn,br,Ir.width,Ir.height,0,Vn,Dn,Ir.data)}}}else{if(on=de.mipmaps,Qe&&gn){on.length>0&&Cn++;const zt=Fn(pn[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Cn,br,zt.width,zt.height)}for(let zt=0;zt<6;zt++)if(Qt){Qe?un&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,0,0,0,pn[zt].width,pn[zt].height,Vn,Dn,pn[zt].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,0,br,pn[zt].width,pn[zt].height,0,Vn,Dn,pn[zt].data);for(let Gn=0;Gn<on.length;Gn++){const zi=on[Gn].image[zt].image;Qe?un&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn+1,0,0,zi.width,zi.height,Vn,Dn,zi.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn+1,br,zi.width,zi.height,0,Vn,Dn,zi.data)}}else{Qe?un&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,0,0,0,Vn,Dn,pn[zt]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,0,br,Vn,Dn,pn[zt]);for(let Gn=0;Gn<on.length;Gn++){const Ir=on[Gn];Qe?un&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn+1,0,0,Vn,Dn,Ir.image[zt]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+zt,Gn+1,br,Vn,Dn,Ir.image[zt])}}}U(de)&&R(i.TEXTURE_CUBE_MAP),Bt.__version=Xt.version,de.onUpdate&&de.onUpdate(de)}Pe.__version=de.version}function $t(Pe,de,dt,qt,Xt,Bt){const $n=s.convert(dt.format,dt.colorSpace),_n=s.convert(dt.type),tr=Y(dt.internalFormat,$n,_n,dt.colorSpace),Mr=n.get(de),Qt=n.get(dt);if(Qt.__renderTarget=de,!Mr.__hasExternalTextures){const pn=Math.max(1,de.width>>Bt),Un=Math.max(1,de.height>>Bt);Xt===i.TEXTURE_3D||Xt===i.TEXTURE_2D_ARRAY?t.texImage3D(Xt,Bt,tr,pn,Un,de.depth,0,$n,_n,null):t.texImage2D(Xt,Bt,tr,pn,Un,0,$n,_n,null)}t.bindFramebuffer(i.FRAMEBUFFER,Pe),hs(de)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,qt,Xt,Qt.__webglTexture,0,qe(de)):(Xt===i.TEXTURE_2D||Xt>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Xt<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,qt,Xt,Qt.__webglTexture,Bt),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Ln(Pe,de,dt){if(i.bindRenderbuffer(i.RENDERBUFFER,Pe),de.depthBuffer){const qt=de.depthTexture,Xt=qt&&qt.isDepthTexture?qt.type:null,Bt=A(de.stencilBuffer,Xt),$n=de.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;hs(de)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,qe(de),Bt,de.width,de.height):dt?i.renderbufferStorageMultisample(i.RENDERBUFFER,qe(de),Bt,de.width,de.height):i.renderbufferStorage(i.RENDERBUFFER,Bt,de.width,de.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,$n,i.RENDERBUFFER,Pe)}else{const qt=de.textures;for(let Xt=0;Xt<qt.length;Xt++){const Bt=qt[Xt],$n=s.convert(Bt.format,Bt.colorSpace),_n=s.convert(Bt.type),tr=Y(Bt.internalFormat,$n,_n,Bt.colorSpace);hs(de)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,qe(de),tr,de.width,de.height):dt?i.renderbufferStorageMultisample(i.RENDERBUFFER,qe(de),tr,de.width,de.height):i.renderbufferStorage(i.RENDERBUFFER,tr,de.width,de.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function jn(Pe,de,dt){const qt=de.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,Pe),!(de.depthTexture&&de.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Xt=n.get(de.depthTexture);if(Xt.__renderTarget=de,(!Xt.__webglTexture||de.depthTexture.image.width!==de.width||de.depthTexture.image.height!==de.height)&&(de.depthTexture.image.width=de.width,de.depthTexture.image.height=de.height,de.depthTexture.needsUpdate=!0),qt){if(Xt.__webglInit===void 0&&(Xt.__webglInit=!0,de.depthTexture.addEventListener("dispose",se)),Xt.__webglTexture===void 0){Xt.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,Xt.__webglTexture),ht(i.TEXTURE_CUBE_MAP,de.depthTexture);const Mr=s.convert(de.depthTexture.format),Qt=s.convert(de.depthTexture.type);let pn;de.depthTexture.format===al?pn=i.DEPTH_COMPONENT24:de.depthTexture.format===Wl&&(pn=i.DEPTH24_STENCIL8);for(let Un=0;Un<6;Un++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Un,0,pn,de.width,de.height,0,Mr,Qt,null)}}else He(de.depthTexture,0);const Bt=Xt.__webglTexture,$n=qe(de),_n=qt?i.TEXTURE_CUBE_MAP_POSITIVE_X+dt:i.TEXTURE_2D,tr=de.depthTexture.format===Wl?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(de.depthTexture.format===al)hs(de)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,tr,_n,Bt,0,$n):i.framebufferTexture2D(i.FRAMEBUFFER,tr,_n,Bt,0);else if(de.depthTexture.format===Wl)hs(de)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,tr,_n,Bt,0,$n):i.framebufferTexture2D(i.FRAMEBUFFER,tr,_n,Bt,0);else throw new Error("Unknown depthTexture format")}function fr(Pe){const de=n.get(Pe),dt=Pe.isWebGLCubeRenderTarget===!0;if(de.__boundDepthTexture!==Pe.depthTexture){const qt=Pe.depthTexture;if(de.__depthDisposeCallback&&de.__depthDisposeCallback(),qt){const Xt=()=>{delete de.__boundDepthTexture,delete de.__depthDisposeCallback,qt.removeEventListener("dispose",Xt)};qt.addEventListener("dispose",Xt),de.__depthDisposeCallback=Xt}de.__boundDepthTexture=qt}if(Pe.depthTexture&&!de.__autoAllocateDepthBuffer)if(dt)for(let qt=0;qt<6;qt++)jn(de.__webglFramebuffer[qt],Pe,qt);else{const qt=Pe.texture.mipmaps;qt&&qt.length>0?jn(de.__webglFramebuffer[0],Pe,0):jn(de.__webglFramebuffer,Pe,0)}else if(dt){de.__webglDepthbuffer=[];for(let qt=0;qt<6;qt++)if(t.bindFramebuffer(i.FRAMEBUFFER,de.__webglFramebuffer[qt]),de.__webglDepthbuffer[qt]===void 0)de.__webglDepthbuffer[qt]=i.createRenderbuffer(),Ln(de.__webglDepthbuffer[qt],Pe,!1);else{const Xt=Pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Bt=de.__webglDepthbuffer[qt];i.bindRenderbuffer(i.RENDERBUFFER,Bt),i.framebufferRenderbuffer(i.FRAMEBUFFER,Xt,i.RENDERBUFFER,Bt)}}else{const qt=Pe.texture.mipmaps;if(qt&&qt.length>0?t.bindFramebuffer(i.FRAMEBUFFER,de.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,de.__webglFramebuffer),de.__webglDepthbuffer===void 0)de.__webglDepthbuffer=i.createRenderbuffer(),Ln(de.__webglDepthbuffer,Pe,!1);else{const Xt=Pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Bt=de.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Bt),i.framebufferRenderbuffer(i.FRAMEBUFFER,Xt,i.RENDERBUFFER,Bt)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function ds(Pe,de,dt){const qt=n.get(Pe);de!==void 0&&$t(qt.__webglFramebuffer,Pe,Pe.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),dt!==void 0&&fr(Pe)}function Wr(Pe){const de=Pe.texture,dt=n.get(Pe),qt=n.get(de);Pe.addEventListener("dispose",oe);const Xt=Pe.textures,Bt=Pe.isWebGLCubeRenderTarget===!0,$n=Xt.length>1;if($n||(qt.__webglTexture===void 0&&(qt.__webglTexture=i.createTexture()),qt.__version=de.version,a.memory.textures++),Bt){dt.__webglFramebuffer=[];for(let _n=0;_n<6;_n++)if(de.mipmaps&&de.mipmaps.length>0){dt.__webglFramebuffer[_n]=[];for(let tr=0;tr<de.mipmaps.length;tr++)dt.__webglFramebuffer[_n][tr]=i.createFramebuffer()}else dt.__webglFramebuffer[_n]=i.createFramebuffer()}else{if(de.mipmaps&&de.mipmaps.length>0){dt.__webglFramebuffer=[];for(let _n=0;_n<de.mipmaps.length;_n++)dt.__webglFramebuffer[_n]=i.createFramebuffer()}else dt.__webglFramebuffer=i.createFramebuffer();if($n)for(let _n=0,tr=Xt.length;_n<tr;_n++){const Mr=n.get(Xt[_n]);Mr.__webglTexture===void 0&&(Mr.__webglTexture=i.createTexture(),a.memory.textures++)}if(Pe.samples>0&&hs(Pe)===!1){dt.__webglMultisampledFramebuffer=i.createFramebuffer(),dt.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,dt.__webglMultisampledFramebuffer);for(let _n=0;_n<Xt.length;_n++){const tr=Xt[_n];dt.__webglColorRenderbuffer[_n]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,dt.__webglColorRenderbuffer[_n]);const Mr=s.convert(tr.format,tr.colorSpace),Qt=s.convert(tr.type),pn=Y(tr.internalFormat,Mr,Qt,tr.colorSpace,Pe.isXRRenderTarget===!0),Un=qe(Pe);i.renderbufferStorageMultisample(i.RENDERBUFFER,Un,pn,Pe.width,Pe.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+_n,i.RENDERBUFFER,dt.__webglColorRenderbuffer[_n])}i.bindRenderbuffer(i.RENDERBUFFER,null),Pe.depthBuffer&&(dt.__webglDepthRenderbuffer=i.createRenderbuffer(),Ln(dt.__webglDepthRenderbuffer,Pe,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Bt){t.bindTexture(i.TEXTURE_CUBE_MAP,qt.__webglTexture),ht(i.TEXTURE_CUBE_MAP,de);for(let _n=0;_n<6;_n++)if(de.mipmaps&&de.mipmaps.length>0)for(let tr=0;tr<de.mipmaps.length;tr++)$t(dt.__webglFramebuffer[_n][tr],Pe,de,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+_n,tr);else $t(dt.__webglFramebuffer[_n],Pe,de,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+_n,0);U(de)&&R(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if($n){for(let _n=0,tr=Xt.length;_n<tr;_n++){const Mr=Xt[_n],Qt=n.get(Mr);let pn=i.TEXTURE_2D;(Pe.isWebGL3DRenderTarget||Pe.isWebGLArrayRenderTarget)&&(pn=Pe.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(pn,Qt.__webglTexture),ht(pn,Mr),$t(dt.__webglFramebuffer,Pe,Mr,i.COLOR_ATTACHMENT0+_n,pn,0),U(Mr)&&R(pn)}t.unbindTexture()}else{let _n=i.TEXTURE_2D;if((Pe.isWebGL3DRenderTarget||Pe.isWebGLArrayRenderTarget)&&(_n=Pe.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(_n,qt.__webglTexture),ht(_n,de),de.mipmaps&&de.mipmaps.length>0)for(let tr=0;tr<de.mipmaps.length;tr++)$t(dt.__webglFramebuffer[tr],Pe,de,i.COLOR_ATTACHMENT0,_n,tr);else $t(dt.__webglFramebuffer,Pe,de,i.COLOR_ATTACHMENT0,_n,0);U(de)&&R(_n),t.unbindTexture()}Pe.depthBuffer&&fr(Pe)}function Br(Pe){const de=Pe.textures;for(let dt=0,qt=de.length;dt<qt;dt++){const Xt=de[dt];if(U(Xt)){const Bt=B(Pe),$n=n.get(Xt).__webglTexture;t.bindTexture(Bt,$n),R(Bt),t.unbindTexture()}}}const Kr=[],Vr=[];function ai(Pe){if(Pe.samples>0){if(hs(Pe)===!1){const de=Pe.textures,dt=Pe.width,qt=Pe.height;let Xt=i.COLOR_BUFFER_BIT;const Bt=Pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,$n=n.get(Pe),_n=de.length>1;if(_n)for(let Mr=0;Mr<de.length;Mr++)t.bindFramebuffer(i.FRAMEBUFFER,$n.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mr,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,$n.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mr,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,$n.__webglMultisampledFramebuffer);const tr=Pe.texture.mipmaps;tr&&tr.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,$n.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,$n.__webglFramebuffer);for(let Mr=0;Mr<de.length;Mr++){if(Pe.resolveDepthBuffer&&(Pe.depthBuffer&&(Xt|=i.DEPTH_BUFFER_BIT),Pe.stencilBuffer&&Pe.resolveStencilBuffer&&(Xt|=i.STENCIL_BUFFER_BIT)),_n){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,$n.__webglColorRenderbuffer[Mr]);const Qt=n.get(de[Mr]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Qt,0)}i.blitFramebuffer(0,0,dt,qt,0,0,dt,qt,Xt,i.NEAREST),d===!0&&(Kr.length=0,Vr.length=0,Kr.push(i.COLOR_ATTACHMENT0+Mr),Pe.depthBuffer&&Pe.resolveDepthBuffer===!1&&(Kr.push(Bt),Vr.push(Bt),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Vr)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Kr))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),_n)for(let Mr=0;Mr<de.length;Mr++){t.bindFramebuffer(i.FRAMEBUFFER,$n.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mr,i.RENDERBUFFER,$n.__webglColorRenderbuffer[Mr]);const Qt=n.get(de[Mr]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,$n.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Mr,i.TEXTURE_2D,Qt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,$n.__webglMultisampledFramebuffer)}else if(Pe.depthBuffer&&Pe.resolveDepthBuffer===!1&&d){const de=Pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[de])}}}function qe(Pe){return Math.min(r.maxSamples,Pe.samples)}function hs(Pe){const de=n.get(Pe);return Pe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&de.__useRenderToTexture!==!1}function ni(Pe){const de=a.render.frame;y.get(Pe)!==de&&(y.set(Pe,de),Pe.update())}function gi(Pe,de){const dt=Pe.colorSpace,qt=Pe.format,Xt=Pe.type;return Pe.isCompressedTexture===!0||Pe.isVideoTexture===!0||dt!==Fc&&dt!==il&&(Xn.getTransfer(dt)===Wn?(qt!==$s||Xt!==Yi)&&Wt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):jt("WebGLTextures: Unsupported texture color space:",dt)),de}function Fn(Pe){return typeof HTMLImageElement<"u"&&Pe instanceof HTMLImageElement?(p.width=Pe.naturalWidth||Pe.width,p.height=Pe.naturalHeight||Pe.height):typeof VideoFrame<"u"&&Pe instanceof VideoFrame?(p.width=Pe.displayWidth,p.height=Pe.displayHeight):(p.width=Pe.width,p.height=Pe.height),p}this.allocateTextureUnit=$e,this.resetTextureUnits=De,this.setTexture2D=He,this.setTexture2DArray=ce,this.setTexture3D=Ge,this.setTextureCube=Ie,this.rebindTextures=ds,this.setupRenderTarget=Wr,this.updateRenderTargetMipmap=Br,this.updateMultisampleRenderTarget=ai,this.setupDepthRenderbuffer=fr,this.setupFrameBufferTexture=$t,this.useMultisampledRTT=hs,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function pBe(i,e){function t(n,r=il){let s;const a=Xn.getTransfer(r);if(n===Yi)return i.UNSIGNED_BYTE;if(n===Uk)return i.UNSIGNED_SHORT_4_4_4_4;if(n===Bk)return i.UNSIGNED_SHORT_5_5_5_1;if(n===zk)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===Vk)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===Z8)return i.BYTE;if(n===Q8)return i.SHORT;if(n===Jf)return i.UNSIGNED_SHORT;if(n===C0)return i.INT;if(n===ys)return i.UNSIGNED_INT;if(n===mo)return i.FLOAT;if(n===Gs)return i.HALF_FLOAT;if(n===IW)return i.ALPHA;if(n===OE)return i.RGB;if(n===$s)return i.RGBA;if(n===al)return i.DEPTH_COMPONENT;if(n===Wl)return i.DEPTH_STENCIL;if(n===LE)return i.RED;if(n===zx)return i.RED_INTEGER;if(n===Oc)return i.RG;if(n===Vx)return i.RG_INTEGER;if(n===Gx)return i.RGBA_INTEGER;if(n===g4||n===v4||n===y4||n===_4)if(a===Wn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===g4)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===v4)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===y4)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===_4)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===g4)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===v4)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===y4)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===_4)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===oE||n===aE||n===lE||n===cE)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===oE)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===aE)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===lE)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===cE)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===ix||n===sx||n===ox||n===ax||n===lx||n===o6||n===cx)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===ix||n===sx)return a===Wn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===ox)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(n===ax)return s.COMPRESSED_R11_EAC;if(n===lx)return s.COMPRESSED_SIGNED_R11_EAC;if(n===o6)return s.COMPRESSED_RG11_EAC;if(n===cx)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===ux||n===dx||n===hx||n===fx||n===px||n===mx||n===gx||n===vx||n===yx||n===_x||n===xx||n===bx||n===Sx||n===wx)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===ux)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===dx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===hx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===fx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===px)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===mx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===gx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===vx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===yx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===_x)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===xx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===bx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Sx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===wx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Tx||n===EH||n===MH)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===Tx)return a===Wn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===EH)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===MH)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Ex||n===Mx||n===a6||n===Cx)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===Ex)return s.COMPRESSED_RED_RGTC1_EXT;if(n===Mx)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===a6)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Cx)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Cu?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const mBe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,gBe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class vBe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new Hve(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new za({vertexShader:mBe,fragmentShader:gBe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new fn(new rp(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class yBe extends Yl{constructor(e,t){super();const n=this;let r=null,s=1,a=null,c="local-floor",d=1,p=null,y=null,x=null,w=null,C=null,N=null;const F=typeof XRWebGLBinding<"u",U=new vBe,R={},B=t.getContextAttributes();let Y=null,A=null;const ne=[],se=[],oe=new vn;let G=null;const ie=new ca;ie.viewport=new wr;const Me=new ca;Me.viewport=new wr;const X=[ie,Me],De=new c8e;let $e=null,ot=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Tt){let Gt=ne[Tt];return Gt===void 0&&(Gt=new HN,ne[Tt]=Gt),Gt.getTargetRaySpace()},this.getControllerGrip=function(Tt){let Gt=ne[Tt];return Gt===void 0&&(Gt=new HN,ne[Tt]=Gt),Gt.getGripSpace()},this.getHand=function(Tt){let Gt=ne[Tt];return Gt===void 0&&(Gt=new HN,ne[Tt]=Gt),Gt.getHandSpace()};function He(Tt){const Gt=se.indexOf(Tt.inputSource);if(Gt===-1)return;const $t=ne[Gt];$t!==void 0&&($t.update(Tt.inputSource,Tt.frame,p||a),$t.dispatchEvent({type:Tt.type,data:Tt.inputSource}))}function ce(){r.removeEventListener("select",He),r.removeEventListener("selectstart",He),r.removeEventListener("selectend",He),r.removeEventListener("squeeze",He),r.removeEventListener("squeezestart",He),r.removeEventListener("squeezeend",He),r.removeEventListener("end",ce),r.removeEventListener("inputsourceschange",Ge);for(let Tt=0;Tt<ne.length;Tt++){const Gt=se[Tt];Gt!==null&&(se[Tt]=null,ne[Tt].disconnect(Gt))}$e=null,ot=null,U.reset();for(const Tt in R)delete R[Tt];e.setRenderTarget(Y),C=null,w=null,x=null,r=null,A=null,bn.stop(),n.isPresenting=!1,e.setPixelRatio(G),e.setSize(oe.width,oe.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Tt){s=Tt,n.isPresenting===!0&&Wt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Tt){c=Tt,n.isPresenting===!0&&Wt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||a},this.setReferenceSpace=function(Tt){p=Tt},this.getBaseLayer=function(){return w!==null?w:C},this.getBinding=function(){return x===null&&F&&(x=new XRWebGLBinding(r,t)),x},this.getFrame=function(){return N},this.getSession=function(){return r},this.setSession=async function(Tt){if(r=Tt,r!==null){if(Y=e.getRenderTarget(),r.addEventListener("select",He),r.addEventListener("selectstart",He),r.addEventListener("selectend",He),r.addEventListener("squeeze",He),r.addEventListener("squeezestart",He),r.addEventListener("squeezeend",He),r.addEventListener("end",ce),r.addEventListener("inputsourceschange",Ge),B.xrCompatible!==!0&&await t.makeXRCompatible(),G=e.getPixelRatio(),e.getSize(oe),F&&"createProjectionLayer"in XRWebGLBinding.prototype){let $t=null,Ln=null,jn=null;B.depth&&(jn=B.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,$t=B.stencil?Wl:al,Ln=B.stencil?Cu:ys);const fr={colorFormat:t.RGBA8,depthFormat:jn,scaleFactor:s};x=this.getBinding(),w=x.createProjectionLayer(fr),r.updateRenderState({layers:[w]}),e.setPixelRatio(1),e.setSize(w.textureWidth,w.textureHeight,!1),A=new Ja(w.textureWidth,w.textureHeight,{format:$s,type:Yi,depthTexture:new ll(w.textureWidth,w.textureHeight,Ln,void 0,void 0,void 0,void 0,void 0,void 0,$t),stencilBuffer:B.stencil,colorSpace:e.outputColorSpace,samples:B.antialias?4:0,resolveDepthBuffer:w.ignoreDepthValues===!1,resolveStencilBuffer:w.ignoreDepthValues===!1})}else{const $t={antialias:B.antialias,alpha:!0,depth:B.depth,stencil:B.stencil,framebufferScaleFactor:s};C=new XRWebGLLayer(r,t,$t),r.updateRenderState({baseLayer:C}),e.setPixelRatio(1),e.setSize(C.framebufferWidth,C.framebufferHeight,!1),A=new Ja(C.framebufferWidth,C.framebufferHeight,{format:$s,type:Yi,colorSpace:e.outputColorSpace,stencilBuffer:B.stencil,resolveDepthBuffer:C.ignoreDepthValues===!1,resolveStencilBuffer:C.ignoreDepthValues===!1})}A.isXRRenderTarget=!0,this.setFoveation(d),p=null,a=await r.requestReferenceSpace(c),bn.setContext(r),bn.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return U.getDepthTexture()};function Ge(Tt){for(let Gt=0;Gt<Tt.removed.length;Gt++){const $t=Tt.removed[Gt],Ln=se.indexOf($t);Ln>=0&&(se[Ln]=null,ne[Ln].disconnect($t))}for(let Gt=0;Gt<Tt.added.length;Gt++){const $t=Tt.added[Gt];let Ln=se.indexOf($t);if(Ln===-1){for(let fr=0;fr<ne.length;fr++)if(fr>=se.length){se.push($t),Ln=fr;break}else if(se[fr]===null){se[fr]=$t,Ln=fr;break}if(Ln===-1)break}const jn=ne[Ln];jn&&jn.connect($t)}}const Ie=new _e,st=new _e;function bt(Tt,Gt,$t){Ie.setFromMatrixPosition(Gt.matrixWorld),st.setFromMatrixPosition($t.matrixWorld);const Ln=Ie.distanceTo(st),jn=Gt.projectionMatrix.elements,fr=$t.projectionMatrix.elements,ds=jn[14]/(jn[10]-1),Wr=jn[14]/(jn[10]+1),Br=(jn[9]+1)/jn[5],Kr=(jn[9]-1)/jn[5],Vr=(jn[8]-1)/jn[0],ai=(fr[8]+1)/fr[0],qe=ds*Vr,hs=ds*ai,ni=Ln/(-Vr+ai),gi=ni*-Vr;if(Gt.matrixWorld.decompose(Tt.position,Tt.quaternion,Tt.scale),Tt.translateX(gi),Tt.translateZ(ni),Tt.matrixWorld.compose(Tt.position,Tt.quaternion,Tt.scale),Tt.matrixWorldInverse.copy(Tt.matrixWorld).invert(),jn[10]===-1)Tt.projectionMatrix.copy(Gt.projectionMatrix),Tt.projectionMatrixInverse.copy(Gt.projectionMatrixInverse);else{const Fn=ds+ni,Pe=Wr+ni,de=qe-gi,dt=hs+(Ln-gi),qt=Br*Wr/Pe*Fn,Xt=Kr*Wr/Pe*Fn;Tt.projectionMatrix.makePerspective(de,dt,qt,Xt,Fn,Pe),Tt.projectionMatrixInverse.copy(Tt.projectionMatrix).invert()}}function Ne(Tt,Gt){Gt===null?Tt.matrixWorld.copy(Tt.matrix):Tt.matrixWorld.multiplyMatrices(Gt.matrixWorld,Tt.matrix),Tt.matrixWorldInverse.copy(Tt.matrixWorld).invert()}this.updateCamera=function(Tt){if(r===null)return;let Gt=Tt.near,$t=Tt.far;U.texture!==null&&(U.depthNear>0&&(Gt=U.depthNear),U.depthFar>0&&($t=U.depthFar)),De.near=Me.near=ie.near=Gt,De.far=Me.far=ie.far=$t,($e!==De.near||ot!==De.far)&&(r.updateRenderState({depthNear:De.near,depthFar:De.far}),$e=De.near,ot=De.far),De.layers.mask=Tt.layers.mask|6,ie.layers.mask=De.layers.mask&-5,Me.layers.mask=De.layers.mask&-3;const Ln=Tt.parent,jn=De.cameras;Ne(De,Ln);for(let fr=0;fr<jn.length;fr++)Ne(jn[fr],Ln);jn.length===2?bt(De,ie,Me):De.projectionMatrix.copy(ie.projectionMatrix),ht(Tt,De,Ln)};function ht(Tt,Gt,$t){$t===null?Tt.matrix.copy(Gt.matrixWorld):(Tt.matrix.copy($t.matrixWorld),Tt.matrix.invert(),Tt.matrix.multiply(Gt.matrixWorld)),Tt.matrix.decompose(Tt.position,Tt.quaternion,Tt.scale),Tt.updateMatrixWorld(!0),Tt.projectionMatrix.copy(Gt.projectionMatrix),Tt.projectionMatrixInverse.copy(Gt.projectionMatrixInverse),Tt.isPerspectiveCamera&&(Tt.fov=l6*2*Math.atan(1/Tt.projectionMatrix.elements[5]),Tt.zoom=1)}this.getCamera=function(){return De},this.getFoveation=function(){if(!(w===null&&C===null))return d},this.setFoveation=function(Tt){d=Tt,w!==null&&(w.fixedFoveation=Tt),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=Tt)},this.hasDepthSensing=function(){return U.texture!==null},this.getDepthSensingMesh=function(){return U.getMesh(De)},this.getCameraTexture=function(Tt){return R[Tt]};let Ot=null;function wn(Tt,Gt){if(y=Gt.getViewerPose(p||a),N=Gt,y!==null){const $t=y.views;C!==null&&(e.setRenderTargetFramebuffer(A,C.framebuffer),e.setRenderTarget(A));let Ln=!1;$t.length!==De.cameras.length&&(De.cameras.length=0,Ln=!0);for(let Wr=0;Wr<$t.length;Wr++){const Br=$t[Wr];let Kr=null;if(C!==null)Kr=C.getViewport(Br);else{const ai=x.getViewSubImage(w,Br);Kr=ai.viewport,Wr===0&&(e.setRenderTargetTextures(A,ai.colorTexture,ai.depthStencilTexture),e.setRenderTarget(A))}let Vr=X[Wr];Vr===void 0&&(Vr=new ca,Vr.layers.enable(Wr),Vr.viewport=new wr,X[Wr]=Vr),Vr.matrix.fromArray(Br.transform.matrix),Vr.matrix.decompose(Vr.position,Vr.quaternion,Vr.scale),Vr.projectionMatrix.fromArray(Br.projectionMatrix),Vr.projectionMatrixInverse.copy(Vr.projectionMatrix).invert(),Vr.viewport.set(Kr.x,Kr.y,Kr.width,Kr.height),Wr===0&&(De.matrix.copy(Vr.matrix),De.matrix.decompose(De.position,De.quaternion,De.scale)),Ln===!0&&De.cameras.push(Vr)}const jn=r.enabledFeatures;if(jn&&jn.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&F){x=n.getBinding();const Wr=x.getDepthInformation($t[0]);Wr&&Wr.isValid&&Wr.texture&&U.init(Wr,r.renderState)}if(jn&&jn.includes("camera-access")&&F){e.state.unbindTexture(),x=n.getBinding();for(let Wr=0;Wr<$t.length;Wr++){const Br=$t[Wr].camera;if(Br){let Kr=R[Br];Kr||(Kr=new Hve,R[Br]=Kr);const Vr=x.getCameraImage(Br);Kr.sourceTexture=Vr}}}}for(let $t=0;$t<ne.length;$t++){const Ln=se[$t],jn=ne[$t];Ln!==null&&jn!==void 0&&jn.update(Ln,Gt,p||a)}Ot&&Ot(Tt,Gt),Gt.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Gt}),N=null}const bn=new f8e;bn.setAnimationLoop(wn),this.setAnimationLoop=function(Tt){Ot=Tt},this.dispose=function(){}}}const M8=new Ao,_Be=new An;function xBe(i,e){function t(U,R){U.matrixAutoUpdate===!0&&U.updateMatrix(),R.value.copy(U.matrix)}function n(U,R){R.color.getRGB(U.fogColor.value,Kve(i)),R.isFog?(U.fogNear.value=R.near,U.fogFar.value=R.far):R.isFogExp2&&(U.fogDensity.value=R.density)}function r(U,R,B,Y,A){R.isMeshBasicMaterial?s(U,R):R.isMeshLambertMaterial?(s(U,R),R.envMap&&(U.envMapIntensity.value=R.envMapIntensity)):R.isMeshToonMaterial?(s(U,R),x(U,R)):R.isMeshPhongMaterial?(s(U,R),y(U,R),R.envMap&&(U.envMapIntensity.value=R.envMapIntensity)):R.isMeshStandardMaterial?(s(U,R),w(U,R),R.isMeshPhysicalMaterial&&C(U,R,A)):R.isMeshMatcapMaterial?(s(U,R),N(U,R)):R.isMeshDepthMaterial?s(U,R):R.isMeshDistanceMaterial?(s(U,R),F(U,R)):R.isMeshNormalMaterial?s(U,R):R.isLineBasicMaterial?(a(U,R),R.isLineDashedMaterial&&c(U,R)):R.isPointsMaterial?d(U,R,B,Y):R.isSpriteMaterial?p(U,R):R.isShadowMaterial?(U.color.value.copy(R.color),U.opacity.value=R.opacity):R.isShaderMaterial&&(R.uniformsNeedUpdate=!1)}function s(U,R){U.opacity.value=R.opacity,R.color&&U.diffuse.value.copy(R.color),R.emissive&&U.emissive.value.copy(R.emissive).multiplyScalar(R.emissiveIntensity),R.map&&(U.map.value=R.map,t(R.map,U.mapTransform)),R.alphaMap&&(U.alphaMap.value=R.alphaMap,t(R.alphaMap,U.alphaMapTransform)),R.bumpMap&&(U.bumpMap.value=R.bumpMap,t(R.bumpMap,U.bumpMapTransform),U.bumpScale.value=R.bumpScale,R.side===Ui&&(U.bumpScale.value*=-1)),R.normalMap&&(U.normalMap.value=R.normalMap,t(R.normalMap,U.normalMapTransform),U.normalScale.value.copy(R.normalScale),R.side===Ui&&U.normalScale.value.negate()),R.displacementMap&&(U.displacementMap.value=R.displacementMap,t(R.displacementMap,U.displacementMapTransform),U.displacementScale.value=R.displacementScale,U.displacementBias.value=R.displacementBias),R.emissiveMap&&(U.emissiveMap.value=R.emissiveMap,t(R.emissiveMap,U.emissiveMapTransform)),R.specularMap&&(U.specularMap.value=R.specularMap,t(R.specularMap,U.specularMapTransform)),R.alphaTest>0&&(U.alphaTest.value=R.alphaTest);const B=e.get(R),Y=B.envMap,A=B.envMapRotation;Y&&(U.envMap.value=Y,M8.copy(A),M8.x*=-1,M8.y*=-1,M8.z*=-1,Y.isCubeTexture&&Y.isRenderTargetTexture===!1&&(M8.y*=-1,M8.z*=-1),U.envMapRotation.value.setFromMatrix4(_Be.makeRotationFromEuler(M8)),U.flipEnvMap.value=Y.isCubeTexture&&Y.isRenderTargetTexture===!1?-1:1,U.reflectivity.value=R.reflectivity,U.ior.value=R.ior,U.refractionRatio.value=R.refractionRatio),R.lightMap&&(U.lightMap.value=R.lightMap,U.lightMapIntensity.value=R.lightMapIntensity,t(R.lightMap,U.lightMapTransform)),R.aoMap&&(U.aoMap.value=R.aoMap,U.aoMapIntensity.value=R.aoMapIntensity,t(R.aoMap,U.aoMapTransform))}function a(U,R){U.diffuse.value.copy(R.color),U.opacity.value=R.opacity,R.map&&(U.map.value=R.map,t(R.map,U.mapTransform))}function c(U,R){U.dashSize.value=R.dashSize,U.totalSize.value=R.dashSize+R.gapSize,U.scale.value=R.scale}function d(U,R,B,Y){U.diffuse.value.copy(R.color),U.opacity.value=R.opacity,U.size.value=R.size*B,U.scale.value=Y*.5,R.map&&(U.map.value=R.map,t(R.map,U.uvTransform)),R.alphaMap&&(U.alphaMap.value=R.alphaMap,t(R.alphaMap,U.alphaMapTransform)),R.alphaTest>0&&(U.alphaTest.value=R.alphaTest)}function p(U,R){U.diffuse.value.copy(R.color),U.opacity.value=R.opacity,U.rotation.value=R.rotation,R.map&&(U.map.value=R.map,t(R.map,U.mapTransform)),R.alphaMap&&(U.alphaMap.value=R.alphaMap,t(R.alphaMap,U.alphaMapTransform)),R.alphaTest>0&&(U.alphaTest.value=R.alphaTest)}function y(U,R){U.specular.value.copy(R.specular),U.shininess.value=Math.max(R.shininess,1e-4)}function x(U,R){R.gradientMap&&(U.gradientMap.value=R.gradientMap)}function w(U,R){U.metalness.value=R.metalness,R.metalnessMap&&(U.metalnessMap.value=R.metalnessMap,t(R.metalnessMap,U.metalnessMapTransform)),U.roughness.value=R.roughness,R.roughnessMap&&(U.roughnessMap.value=R.roughnessMap,t(R.roughnessMap,U.roughnessMapTransform)),R.envMap&&(U.envMapIntensity.value=R.envMapIntensity)}function C(U,R,B){U.ior.value=R.ior,R.sheen>0&&(U.sheenColor.value.copy(R.sheenColor).multiplyScalar(R.sheen),U.sheenRoughness.value=R.sheenRoughness,R.sheenColorMap&&(U.sheenColorMap.value=R.sheenColorMap,t(R.sheenColorMap,U.sheenColorMapTransform)),R.sheenRoughnessMap&&(U.sheenRoughnessMap.value=R.sheenRoughnessMap,t(R.sheenRoughnessMap,U.sheenRoughnessMapTransform))),R.clearcoat>0&&(U.clearcoat.value=R.clearcoat,U.clearcoatRoughness.value=R.clearcoatRoughness,R.clearcoatMap&&(U.clearcoatMap.value=R.clearcoatMap,t(R.clearcoatMap,U.clearcoatMapTransform)),R.clearcoatRoughnessMap&&(U.clearcoatRoughnessMap.value=R.clearcoatRoughnessMap,t(R.clearcoatRoughnessMap,U.clearcoatRoughnessMapTransform)),R.clearcoatNormalMap&&(U.clearcoatNormalMap.value=R.clearcoatNormalMap,t(R.clearcoatNormalMap,U.clearcoatNormalMapTransform),U.clearcoatNormalScale.value.copy(R.clearcoatNormalScale),R.side===Ui&&U.clearcoatNormalScale.value.negate())),R.dispersion>0&&(U.dispersion.value=R.dispersion),R.iridescence>0&&(U.iridescence.value=R.iridescence,U.iridescenceIOR.value=R.iridescenceIOR,U.iridescenceThicknessMinimum.value=R.iridescenceThicknessRange[0],U.iridescenceThicknessMaximum.value=R.iridescenceThicknessRange[1],R.iridescenceMap&&(U.iridescenceMap.value=R.iridescenceMap,t(R.iridescenceMap,U.iridescenceMapTransform)),R.iridescenceThicknessMap&&(U.iridescenceThicknessMap.value=R.iridescenceThicknessMap,t(R.iridescenceThicknessMap,U.iridescenceThicknessMapTransform))),R.transmission>0&&(U.transmission.value=R.transmission,U.transmissionSamplerMap.value=B.texture,U.transmissionSamplerSize.value.set(B.width,B.height),R.transmissionMap&&(U.transmissionMap.value=R.transmissionMap,t(R.transmissionMap,U.transmissionMapTransform)),U.thickness.value=R.thickness,R.thicknessMap&&(U.thicknessMap.value=R.thicknessMap,t(R.thicknessMap,U.thicknessMapTransform)),U.attenuationDistance.value=R.attenuationDistance,U.attenuationColor.value.copy(R.attenuationColor)),R.anisotropy>0&&(U.anisotropyVector.value.set(R.anisotropy*Math.cos(R.anisotropyRotation),R.anisotropy*Math.sin(R.anisotropyRotation)),R.anisotropyMap&&(U.anisotropyMap.value=R.anisotropyMap,t(R.anisotropyMap,U.anisotropyMapTransform))),U.specularIntensity.value=R.specularIntensity,U.specularColor.value.copy(R.specularColor),R.specularColorMap&&(U.specularColorMap.value=R.specularColorMap,t(R.specularColorMap,U.specularColorMapTransform)),R.specularIntensityMap&&(U.specularIntensityMap.value=R.specularIntensityMap,t(R.specularIntensityMap,U.specularIntensityMapTransform))}function N(U,R){R.matcap&&(U.matcap.value=R.matcap)}function F(U,R){const B=e.get(R).light;U.referencePosition.value.setFromMatrixPosition(B.matrixWorld),U.nearDistance.value=B.shadow.camera.near,U.farDistance.value=B.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function bBe(i,e,t,n){let r={},s={},a=[];const c=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function d(B,Y){const A=Y.program;n.uniformBlockBinding(B,A)}function p(B,Y){let A=r[B.id];A===void 0&&(N(B),A=y(B),r[B.id]=A,B.addEventListener("dispose",U));const ne=Y.program;n.updateUBOMapping(B,ne);const se=e.render.frame;s[B.id]!==se&&(w(B),s[B.id]=se)}function y(B){const Y=x();B.__bindingPointIndex=Y;const A=i.createBuffer(),ne=B.__size,se=B.usage;return i.bindBuffer(i.UNIFORM_BUFFER,A),i.bufferData(i.UNIFORM_BUFFER,ne,se),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,Y,A),A}function x(){for(let B=0;B<c;B++)if(a.indexOf(B)===-1)return a.push(B),B;return jt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function w(B){const Y=r[B.id],A=B.uniforms,ne=B.__cache;i.bindBuffer(i.UNIFORM_BUFFER,Y);for(let se=0,oe=A.length;se<oe;se++){const G=Array.isArray(A[se])?A[se]:[A[se]];for(let ie=0,Me=G.length;ie<Me;ie++){const X=G[ie];if(C(X,se,ie,ne)===!0){const De=X.__offset,$e=Array.isArray(X.value)?X.value:[X.value];let ot=0;for(let He=0;He<$e.length;He++){const ce=$e[He],Ge=F(ce);typeof ce=="number"||typeof ce=="boolean"?(X.__data[0]=ce,i.bufferSubData(i.UNIFORM_BUFFER,De+ot,X.__data)):ce.isMatrix3?(X.__data[0]=ce.elements[0],X.__data[1]=ce.elements[1],X.__data[2]=ce.elements[2],X.__data[3]=0,X.__data[4]=ce.elements[3],X.__data[5]=ce.elements[4],X.__data[6]=ce.elements[5],X.__data[7]=0,X.__data[8]=ce.elements[6],X.__data[9]=ce.elements[7],X.__data[10]=ce.elements[8],X.__data[11]=0):(ce.toArray(X.__data,ot),ot+=Ge.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,De,X.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function C(B,Y,A,ne){const se=B.value,oe=Y+"_"+A;if(ne[oe]===void 0)return typeof se=="number"||typeof se=="boolean"?ne[oe]=se:ne[oe]=se.clone(),!0;{const G=ne[oe];if(typeof se=="number"||typeof se=="boolean"){if(G!==se)return ne[oe]=se,!0}else if(G.equals(se)===!1)return G.copy(se),!0}return!1}function N(B){const Y=B.uniforms;let A=0;const ne=16;for(let oe=0,G=Y.length;oe<G;oe++){const ie=Array.isArray(Y[oe])?Y[oe]:[Y[oe]];for(let Me=0,X=ie.length;Me<X;Me++){const De=ie[Me],$e=Array.isArray(De.value)?De.value:[De.value];for(let ot=0,He=$e.length;ot<He;ot++){const ce=$e[ot],Ge=F(ce),Ie=A%ne,st=Ie%Ge.boundary,bt=Ie+st;A+=st,bt!==0&&ne-bt<Ge.storage&&(A+=ne-bt),De.__data=new Float32Array(Ge.storage/Float32Array.BYTES_PER_ELEMENT),De.__offset=A,A+=Ge.storage}}}const se=A%ne;return se>0&&(A+=ne-se),B.__size=A,B.__cache={},this}function F(B){const Y={boundary:0,storage:0};return typeof B=="number"||typeof B=="boolean"?(Y.boundary=4,Y.storage=4):B.isVector2?(Y.boundary=8,Y.storage=8):B.isVector3||B.isColor?(Y.boundary=16,Y.storage=12):B.isVector4?(Y.boundary=16,Y.storage=16):B.isMatrix3?(Y.boundary=48,Y.storage=48):B.isMatrix4?(Y.boundary=64,Y.storage=64):B.isTexture?Wt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Wt("WebGLRenderer: Unsupported uniform value type.",B),Y}function U(B){const Y=B.target;Y.removeEventListener("dispose",U);const A=a.indexOf(Y.__bindingPointIndex);a.splice(A,1),i.deleteBuffer(r[Y.id]),delete r[Y.id],delete s[Y.id]}function R(){for(const B in r)i.deleteBuffer(r[B]);a=[],r={},s={}}return{bind:d,update:p,dispose:R}}const SBe=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let F1=null;function wBe(){return F1===null&&(F1=new d4(SBe,16,16,Oc,Gs),F1.name="DFG_LUT",F1.minFilter=Bi,F1.magFilter=Bi,F1.wrapS=Co,F1.wrapT=Co,F1.generateMipmaps=!1,F1.needsUpdate=!0),F1}class qN{constructor(e={}){const{canvas:t=Uve(),context:n=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:c=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:p=!1,powerPreference:y="default",failIfMajorPerformanceCaveat:x=!1,reversedDepthBuffer:w=!1,outputBufferType:C=Yi}=e;this.isWebGLRenderer=!0;let N;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");N=n.getContextAttributes().alpha}else N=a;const F=C,U=new Set([Gx,Vx,zx]),R=new Set([Yi,ys,Jf,Cu,Uk,Bk]),B=new Uint32Array(4),Y=new Int32Array(4);let A=null,ne=null;const se=[],oe=[];let G=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Qa,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const ie=this;let Me=!1;this._outputColorSpace=ti;let X=0,De=0,$e=null,ot=-1,He=null;const ce=new wr,Ge=new wr;let Ie=null;const st=new xn(0);let bt=0,Ne=t.width,ht=t.height,Ot=1,wn=null,bn=null;const Tt=new wr(0,0,Ne,ht),Gt=new wr(0,0,Ne,ht);let $t=!1;const Ln=new UE;let jn=!1,fr=!1;const ds=new An,Wr=new _e,Br=new wr,Kr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Vr=!1;function ai(){return $e===null?Ot:1}let qe=n;function hs(me,pt){return t.getContext(me,pt)}try{const me={alpha:!0,depth:r,stencil:s,antialias:c,premultipliedAlpha:d,preserveDrawingBuffer:p,powerPreference:y,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${N4}`),t.addEventListener("webglcontextlost",Gn,!1),t.addEventListener("webglcontextrestored",Ir,!1),t.addEventListener("webglcontextcreationerror",zi,!1),qe===null){const pt="webgl2";if(qe=hs(pt,me),qe===null)throw hs(pt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(me){throw jt("WebGLRenderer: "+me.message),me}let ni,gi,Fn,Pe,de,dt,qt,Xt,Bt,$n,_n,tr,Mr,Qt,pn,Un,Vn,Dn,br,Qe,gn,un,Cn;function on(){ni=new TFe(qe),ni.init(),gn=new pBe(qe,ni),gi=new gFe(qe,ni,e,gn),Fn=new hBe(qe,ni),gi.reversedDepthBuffer&&w&&Fn.buffers.depth.setReversed(!0),Pe=new CFe(qe),de=new QUe,dt=new fBe(qe,ni,Fn,de,gi,gn,Pe),qt=new wFe(ie),Xt=new NDe(qe),un=new pFe(qe,Xt),Bt=new EFe(qe,Xt,Pe,un),$n=new PFe(qe,Bt,Xt,un,Pe),Dn=new AFe(qe,gi,dt),pn=new vFe(de),_n=new ZUe(ie,qt,ni,gi,un,pn),tr=new xBe(ie,de),Mr=new eBe,Qt=new oBe(ni),Vn=new fFe(ie,qt,Fn,$n,N,d),Un=new dBe(ie,$n,gi),Cn=new bBe(qe,Pe,gi,Fn),br=new mFe(qe,ni,Pe),Qe=new MFe(qe,ni,Pe),Pe.programs=_n.programs,ie.capabilities=gi,ie.extensions=ni,ie.properties=de,ie.renderLists=Mr,ie.shadowMap=Un,ie.state=Fn,ie.info=Pe}on(),F!==Yi&&(G=new IFe(F,t.width,t.height,r,s));const zt=new yBe(ie,qe);this.xr=zt,this.getContext=function(){return qe},this.getContextAttributes=function(){return qe.getContextAttributes()},this.forceContextLoss=function(){const me=ni.get("WEBGL_lose_context");me&&me.loseContext()},this.forceContextRestore=function(){const me=ni.get("WEBGL_lose_context");me&&me.restoreContext()},this.getPixelRatio=function(){return Ot},this.setPixelRatio=function(me){me!==void 0&&(Ot=me,this.setSize(Ne,ht,!1))},this.getSize=function(me){return me.set(Ne,ht)},this.setSize=function(me,pt,At=!0){if(zt.isPresenting){Wt("WebGLRenderer: Can't change size while VR device is presenting.");return}Ne=me,ht=pt,t.width=Math.floor(me*Ot),t.height=Math.floor(pt*Ot),At===!0&&(t.style.width=me+"px",t.style.height=pt+"px"),G!==null&&G.setSize(t.width,t.height),this.setViewport(0,0,me,pt)},this.getDrawingBufferSize=function(me){return me.set(Ne*Ot,ht*Ot).floor()},this.setDrawingBufferSize=function(me,pt,At){Ne=me,ht=pt,Ot=At,t.width=Math.floor(me*At),t.height=Math.floor(pt*At),this.setViewport(0,0,me,pt)},this.setEffects=function(me){if(F===Yi){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(me){for(let pt=0;pt<me.length;pt++)if(me[pt].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}G.setEffects(me||[])},this.getCurrentViewport=function(me){return me.copy(ce)},this.getViewport=function(me){return me.copy(Tt)},this.setViewport=function(me,pt,At,St){me.isVector4?Tt.set(me.x,me.y,me.z,me.w):Tt.set(me,pt,At,St),Fn.viewport(ce.copy(Tt).multiplyScalar(Ot).round())},this.getScissor=function(me){return me.copy(Gt)},this.setScissor=function(me,pt,At,St){me.isVector4?Gt.set(me.x,me.y,me.z,me.w):Gt.set(me,pt,At,St),Fn.scissor(Ge.copy(Gt).multiplyScalar(Ot).round())},this.getScissorTest=function(){return $t},this.setScissorTest=function(me){Fn.setScissorTest($t=me)},this.setOpaqueSort=function(me){wn=me},this.setTransparentSort=function(me){bn=me},this.getClearColor=function(me){return me.copy(Vn.getClearColor())},this.setClearColor=function(){Vn.setClearColor(...arguments)},this.getClearAlpha=function(){return Vn.getClearAlpha()},this.setClearAlpha=function(){Vn.setClearAlpha(...arguments)},this.clear=function(me=!0,pt=!0,At=!0){let St=0;if(me){let _t=!1;if($e!==null){const Rn=$e.texture.format;_t=U.has(Rn)}if(_t){const Rn=$e.texture.type,Bn=R.has(Rn),Mn=Vn.getClearColor(),On=Vn.getClearAlpha(),Kn=Mn.r,ur=Mn.g,zr=Mn.b;Bn?(B[0]=Kn,B[1]=ur,B[2]=zr,B[3]=On,qe.clearBufferuiv(qe.COLOR,0,B)):(Y[0]=Kn,Y[1]=ur,Y[2]=zr,Y[3]=On,qe.clearBufferiv(qe.COLOR,0,Y))}else St|=qe.COLOR_BUFFER_BIT}pt&&(St|=qe.DEPTH_BUFFER_BIT),At&&(St|=qe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),St!==0&&qe.clear(St)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Gn,!1),t.removeEventListener("webglcontextrestored",Ir,!1),t.removeEventListener("webglcontextcreationerror",zi,!1),Vn.dispose(),Mr.dispose(),Qt.dispose(),de.dispose(),qt.dispose(),$n.dispose(),un.dispose(),Cn.dispose(),_n.dispose(),zt.dispose(),zt.removeEventListener("sessionstart",Kl),zt.removeEventListener("sessionend",Nu),r0.stop()};function Gn(me){me.preventDefault(),fE("WebGLRenderer: Context Lost."),Me=!0}function Ir(){fE("WebGLRenderer: Context Restored."),Me=!1;const me=Pe.autoReset,pt=Un.enabled,At=Un.autoUpdate,St=Un.needsUpdate,_t=Un.type;on(),Pe.autoReset=me,Un.enabled=pt,Un.autoUpdate=At,Un.needsUpdate=St,Un.type=_t}function zi(me){jt("WebGLRenderer: A WebGL context could not be created. Reason: ",me.statusMessage)}function Tr(me){const pt=me.target;pt.removeEventListener("dispose",Tr),Ms(pt)}function Ms(me){Ko(me),de.remove(me)}function Ko(me){const pt=de.get(me).programs;pt!==void 0&&(pt.forEach(function(At){_n.releaseProgram(At)}),me.isShaderMaterial&&_n.releaseShaderCache(me))}this.renderBufferDirect=function(me,pt,At,St,_t,Rn){pt===null&&(pt=Kr);const Bn=_t.isMesh&&_t.matrixWorld.determinant()<0,Mn=Zo(me,pt,At,St,_t);Fn.setMaterial(St,Bn);let On=At.index,Kn=1;if(St.wireframe===!0){if(On=Bt.getWireframeAttribute(At),On===void 0)return;Kn=2}const ur=At.drawRange,zr=At.attributes.position;let pr=ur.start*Kn,li=(ur.start+ur.count)*Kn;Rn!==null&&(pr=Math.max(pr,Rn.start*Kn),li=Math.min(li,(Rn.start+Rn.count)*Kn)),On!==null?(pr=Math.max(pr,0),li=Math.min(li,On.count)):zr!=null&&(pr=Math.max(pr,0),li=Math.min(li,zr.count));const Ni=li-pr;if(Ni<0||Ni===1/0)return;un.setup(_t,St,Mn,At,On);let Ki,ii=br;if(On!==null&&(Ki=Xt.get(On),ii=Qe,ii.setIndex(Ki)),_t.isMesh)St.wireframe===!0?(Fn.setLineWidth(St.wireframeLinewidth*ai()),ii.setMode(qe.LINES)):ii.setMode(qe.TRIANGLES);else if(_t.isLine){let Os=St.linewidth;Os===void 0&&(Os=1),Fn.setLineWidth(Os*ai()),_t.isLineSegments?ii.setMode(qe.LINES):_t.isLineLoop?ii.setMode(qe.LINE_LOOP):ii.setMode(qe.LINE_STRIP)}else _t.isPoints?ii.setMode(qe.POINTS):_t.isSprite&&ii.setMode(qe.TRIANGLES);if(_t.isBatchedMesh)if(_t._multiDrawInstances!==null)ns("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),ii.renderMultiDrawInstances(_t._multiDrawStarts,_t._multiDrawCounts,_t._multiDrawCount,_t._multiDrawInstances);else if(ni.get("WEBGL_multi_draw"))ii.renderMultiDraw(_t._multiDrawStarts,_t._multiDrawCounts,_t._multiDrawCount);else{const Os=_t._multiDrawStarts,nr=_t._multiDrawCounts,Qo=_t._multiDrawCount,si=On?Xt.get(On).bytesPerElement:1,ha=de.get(St).currentProgram.getUniforms();for(let Xs=0;Xs<Qo;Xs++)ha.setValue(qe,"_gl_DrawID",Xs),ii.render(Os[Xs]/si,nr[Xs])}else if(_t.isInstancedMesh)ii.renderInstances(pr,Ni,_t.count);else if(At.isInstancedBufferGeometry){const Os=At._maxInstanceCount!==void 0?At._maxInstanceCount:1/0,nr=Math.min(At.instanceCount,Os);ii.renderInstances(pr,Ni,nr)}else ii.render(pr,Ni)};function Iu(me,pt,At){me.transparent===!0&&me.side===no&&me.forceSinglePass===!1?(me.side=Ui,me.needsUpdate=!0,Uc(me,pt,At),me.side=ol,me.needsUpdate=!0,Uc(me,pt,At),me.side=no):Uc(me,pt,At)}this.compile=function(me,pt,At=null){At===null&&(At=me),ne=Qt.get(At),ne.init(pt),oe.push(ne),At.traverseVisible(function(_t){_t.isLight&&_t.layers.test(pt.layers)&&(ne.pushLight(_t),_t.castShadow&&ne.pushShadow(_t))}),me!==At&&me.traverseVisible(function(_t){_t.isLight&&_t.layers.test(pt.layers)&&(ne.pushLight(_t),_t.castShadow&&ne.pushShadow(_t))}),ne.setupLights();const St=new Set;return me.traverse(function(_t){if(!(_t.isMesh||_t.isPoints||_t.isLine||_t.isSprite))return;const Rn=_t.material;if(Rn)if(Array.isArray(Rn))for(let Bn=0;Bn<Rn.length;Bn++){const Mn=Rn[Bn];Iu(Mn,At,_t),St.add(Mn)}else Iu(Rn,At,_t),St.add(Rn)}),ne=oe.pop(),St},this.compileAsync=function(me,pt,At=null){const St=this.compile(me,pt,At);return new Promise(_t=>{function Rn(){if(St.forEach(function(Bn){de.get(Bn).currentProgram.isReady()&&St.delete(Bn)}),St.size===0){_t(me);return}setTimeout(Rn,10)}ni.get("KHR_parallel_shader_compile")!==null?Rn():setTimeout(Rn,10)})};let I0=null;function Dh(me){I0&&I0(me)}function Kl(){r0.stop()}function Nu(){r0.start()}const r0=new f8e;r0.setAnimationLoop(Dh),typeof self<"u"&&r0.setContext(self),this.setAnimationLoop=function(me){I0=me,zt.setAnimationLoop(me),me===null?r0.stop():r0.start()},zt.addEventListener("sessionstart",Kl),zt.addEventListener("sessionend",Nu),this.render=function(me,pt){if(pt!==void 0&&pt.isCamera!==!0){jt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Me===!0)return;const At=zt.enabled===!0&&zt.isPresenting===!0,St=G!==null&&($e===null||At)&&G.begin(ie,$e);if(me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),pt.parent===null&&pt.matrixWorldAutoUpdate===!0&&pt.updateMatrixWorld(),zt.enabled===!0&&zt.isPresenting===!0&&(G===null||G.isCompositing()===!1)&&(zt.cameraAutoUpdate===!0&&zt.updateCamera(pt),pt=zt.getCamera()),me.isScene===!0&&me.onBeforeRender(ie,me,pt,$e),ne=Qt.get(me,oe.length),ne.init(pt),oe.push(ne),ds.multiplyMatrices(pt.projectionMatrix,pt.matrixWorldInverse),Ln.setFromProjectionMatrix(ds,ql,pt.reversedDepth),fr=this.localClippingEnabled,jn=pn.init(this.clippingPlanes,fr),A=Mr.get(me,se.length),A.init(),se.push(A),zt.enabled===!0&&zt.isPresenting===!0){const Bn=ie.xr.getDepthSensingMesh();Bn!==null&&Ga(Bn,pt,-1/0,ie.sortObjects)}Ga(me,pt,0,ie.sortObjects),A.finish(),ie.sortObjects===!0&&A.sort(wn,bn),Vr=zt.enabled===!1||zt.isPresenting===!1||zt.hasDepthSensing()===!1,Vr&&Vn.addToRenderList(A,me),this.info.render.frame++,jn===!0&&pn.beginShadows();const _t=ne.state.shadowsArray;if(Un.render(_t,me,pt),jn===!0&&pn.endShadows(),this.info.autoReset===!0&&this.info.reset(),(St&&G.hasRenderPass())===!1){const Bn=A.opaque,Mn=A.transmissive;if(ne.setupLights(),pt.isArrayCamera){const On=pt.cameras;if(Mn.length>0)for(let Kn=0,ur=On.length;Kn<ur;Kn++){const zr=On[Kn];up(Bn,Mn,me,zr)}Vr&&Vn.render(me);for(let Kn=0,ur=On.length;Kn<ur;Kn++){const zr=On[Kn];Ed(A,me,zr,zr.viewport)}}else Mn.length>0&&up(Bn,Mn,me,pt),Vr&&Vn.render(me),Ed(A,me,pt)}$e!==null&&De===0&&(dt.updateMultisampleRenderTarget($e),dt.updateRenderTargetMipmap($e)),St&&G.end(ie),me.isScene===!0&&me.onAfterRender(ie,me,pt),un.resetDefaultState(),ot=-1,He=null,oe.pop(),oe.length>0?(ne=oe[oe.length-1],jn===!0&&pn.setGlobalState(ie.clippingPlanes,ne.state.camera)):ne=null,se.pop(),se.length>0?A=se[se.length-1]:A=null};function Ga(me,pt,At,St){if(me.visible===!1)return;if(me.layers.test(pt.layers)){if(me.isGroup)At=me.renderOrder;else if(me.isLOD)me.autoUpdate===!0&&me.update(pt);else if(me.isLight)ne.pushLight(me),me.castShadow&&ne.pushShadow(me);else if(me.isSprite){if(!me.frustumCulled||Ln.intersectsSprite(me)){St&&Br.setFromMatrixPosition(me.matrixWorld).applyMatrix4(ds);const Bn=$n.update(me),Mn=me.material;Mn.visible&&A.push(me,Bn,Mn,At,Br.z,null)}}else if((me.isMesh||me.isLine||me.isPoints)&&(!me.frustumCulled||Ln.intersectsObject(me))){const Bn=$n.update(me),Mn=me.material;if(St&&(me.boundingSphere!==void 0?(me.boundingSphere===null&&me.computeBoundingSphere(),Br.copy(me.boundingSphere.center)):(Bn.boundingSphere===null&&Bn.computeBoundingSphere(),Br.copy(Bn.boundingSphere.center)),Br.applyMatrix4(me.matrixWorld).applyMatrix4(ds)),Array.isArray(Mn)){const On=Bn.groups;for(let Kn=0,ur=On.length;Kn<ur;Kn++){const zr=On[Kn],pr=Mn[zr.materialIndex];pr&&pr.visible&&A.push(me,Bn,pr,At,Br.z,zr)}}else Mn.visible&&A.push(me,Bn,Mn,At,Br.z,null)}}const Rn=me.children;for(let Bn=0,Mn=Rn.length;Bn<Mn;Bn++)Ga(Rn[Bn],pt,At,St)}function Ed(me,pt,At,St){const{opaque:_t,transmissive:Rn,transparent:Bn}=me;ne.setupLightsView(At),jn===!0&&pn.setGlobalState(ie.clippingPlanes,At),St&&Fn.viewport(ce.copy(St)),_t.length>0&&Md(_t,pt,At),Rn.length>0&&Md(Rn,pt,At),Bn.length>0&&Md(Bn,pt,At),Fn.buffers.depth.setTest(!0),Fn.buffers.depth.setMask(!0),Fn.buffers.color.setMask(!0),Fn.setPolygonOffset(!1)}function up(me,pt,At,St){if((At.isScene===!0?At.overrideMaterial:null)!==null)return;if(ne.state.transmissionRenderTarget[St.id]===void 0){const pr=ni.has("EXT_color_buffer_half_float")||ni.has("EXT_color_buffer_float");ne.state.transmissionRenderTarget[St.id]=new Ja(1,1,{generateMipmaps:!0,type:pr?Gs:Yi,minFilter:Tu,samples:gi.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Xn.workingColorSpace})}const Rn=ne.state.transmissionRenderTarget[St.id],Bn=St.viewport||ce;Rn.setSize(Bn.z*ie.transmissionResolutionScale,Bn.w*ie.transmissionResolutionScale);const Mn=ie.getRenderTarget(),On=ie.getActiveCubeFace(),Kn=ie.getActiveMipmapLevel();ie.setRenderTarget(Rn),ie.getClearColor(st),bt=ie.getClearAlpha(),bt<1&&ie.setClearColor(16777215,.5),ie.clear(),Vr&&Vn.render(At);const ur=ie.toneMapping;ie.toneMapping=Qa;const zr=St.viewport;if(St.viewport!==void 0&&(St.viewport=void 0),ne.setupLightsView(St),jn===!0&&pn.setGlobalState(ie.clippingPlanes,St),Md(me,At,St),dt.updateMultisampleRenderTarget(Rn),dt.updateRenderTargetMipmap(Rn),ni.has("WEBGL_multisampled_render_to_texture")===!1){let pr=!1;for(let li=0,Ni=pt.length;li<Ni;li++){const Ki=pt[li],{object:ii,geometry:Os,material:nr,group:Qo}=Ki;if(nr.side===no&&ii.layers.test(St.layers)){const si=nr.side;nr.side=Ui,nr.needsUpdate=!0,ko(ii,At,St,Os,nr,Qo),nr.side=si,nr.needsUpdate=!0,pr=!0}}pr===!0&&(dt.updateMultisampleRenderTarget(Rn),dt.updateRenderTargetMipmap(Rn))}ie.setRenderTarget(Mn,On,Kn),ie.setClearColor(st,bt),zr!==void 0&&(St.viewport=zr),ie.toneMapping=ur}function Md(me,pt,At){const St=pt.isScene===!0?pt.overrideMaterial:null;for(let _t=0,Rn=me.length;_t<Rn;_t++){const Bn=me[_t],{object:Mn,geometry:On,group:Kn}=Bn;let ur=Bn.material;ur.allowOverride===!0&&St!==null&&(ur=St),Mn.layers.test(At.layers)&&ko(Mn,pt,At,On,ur,Kn)}}function ko(me,pt,At,St,_t,Rn){me.onBeforeRender(ie,pt,At,St,_t,Rn),me.modelViewMatrix.multiplyMatrices(At.matrixWorldInverse,me.matrixWorld),me.normalMatrix.getNormalMatrix(me.modelViewMatrix),_t.onBeforeRender(ie,pt,At,St,me,Rn),_t.transparent===!0&&_t.side===no&&_t.forceSinglePass===!1?(_t.side=Ui,_t.needsUpdate=!0,ie.renderBufferDirect(At,pt,St,_t,me,Rn),_t.side=ol,_t.needsUpdate=!0,ie.renderBufferDirect(At,pt,St,_t,me,Rn),_t.side=no):ie.renderBufferDirect(At,pt,St,_t,me,Rn),me.onAfterRender(ie,pt,At,St,_t,Rn)}function Uc(me,pt,At){pt.isScene!==!0&&(pt=Kr);const St=de.get(me),_t=ne.state.lights,Rn=ne.state.shadowsArray,Bn=_t.state.version,Mn=_n.getParameters(me,_t.state,Rn,pt,At),On=_n.getProgramCacheKey(Mn);let Kn=St.programs;St.environment=me.isMeshStandardMaterial||me.isMeshLambertMaterial||me.isMeshPhongMaterial?pt.environment:null,St.fog=pt.fog;const ur=me.isMeshStandardMaterial||me.isMeshLambertMaterial&&!me.envMap||me.isMeshPhongMaterial&&!me.envMap;St.envMap=qt.get(me.envMap||St.environment,ur),St.envMapRotation=St.environment!==null&&me.envMap===null?pt.environmentRotation:me.envMapRotation,Kn===void 0&&(me.addEventListener("dispose",Tr),Kn=new Map,St.programs=Kn);let zr=Kn.get(On);if(zr!==void 0){if(St.currentProgram===zr&&St.lightsStateVersion===Bn)return ku(me,Mn),zr}else Mn.uniforms=_n.getUniforms(me),me.onBeforeCompile(Mn,ie),zr=_n.acquireProgram(Mn,On),Kn.set(On,zr),St.uniforms=Mn.uniforms;const pr=St.uniforms;return(!me.isShaderMaterial&&!me.isRawShaderMaterial||me.clipping===!0)&&(pr.clippingPlanes=pn.uniform),ku(me,Mn),St.needsLights=dp(me),St.lightsStateVersion=Bn,St.needsLights&&(pr.ambientLightColor.value=_t.state.ambient,pr.lightProbe.value=_t.state.probe,pr.directionalLights.value=_t.state.directional,pr.directionalLightShadows.value=_t.state.directionalShadow,pr.spotLights.value=_t.state.spot,pr.spotLightShadows.value=_t.state.spotShadow,pr.rectAreaLights.value=_t.state.rectArea,pr.ltc_1.value=_t.state.rectAreaLTC1,pr.ltc_2.value=_t.state.rectAreaLTC2,pr.pointLights.value=_t.state.point,pr.pointLightShadows.value=_t.state.pointShadow,pr.hemisphereLights.value=_t.state.hemi,pr.directionalShadowMatrix.value=_t.state.directionalShadowMatrix,pr.spotLightMatrix.value=_t.state.spotLightMatrix,pr.spotLightMap.value=_t.state.spotLightMap,pr.pointShadowMatrix.value=_t.state.pointShadowMatrix),St.currentProgram=zr,St.uniformsList=null,zr}function Zl(me){if(me.uniformsList===null){const pt=me.currentProgram.getUniforms();me.uniformsList=WN.seqWithValue(pt.seq,me.uniforms)}return me.uniformsList}function ku(me,pt){const At=de.get(me);At.outputColorSpace=pt.outputColorSpace,At.batching=pt.batching,At.batchingColor=pt.batchingColor,At.instancing=pt.instancing,At.instancingColor=pt.instancingColor,At.instancingMorph=pt.instancingMorph,At.skinning=pt.skinning,At.morphTargets=pt.morphTargets,At.morphNormals=pt.morphNormals,At.morphColors=pt.morphColors,At.morphTargetsCount=pt.morphTargetsCount,At.numClippingPlanes=pt.numClippingPlanes,At.numIntersection=pt.numClipIntersection,At.vertexAlphas=pt.vertexAlphas,At.vertexTangents=pt.vertexTangents,At.toneMapping=pt.toneMapping}function Zo(me,pt,At,St,_t){pt.isScene!==!0&&(pt=Kr),dt.resetTextureUnits();const Rn=pt.fog,Bn=St.isMeshStandardMaterial||St.isMeshLambertMaterial||St.isMeshPhongMaterial?pt.environment:null,Mn=$e===null?ie.outputColorSpace:$e.isXRRenderTarget===!0?$e.texture.colorSpace:Fc,On=St.isMeshStandardMaterial||St.isMeshLambertMaterial&&!St.envMap||St.isMeshPhongMaterial&&!St.envMap,Kn=qt.get(St.envMap||Bn,On),ur=St.vertexColors===!0&&!!At.attributes.color&&At.attributes.color.itemSize===4,zr=!!At.attributes.tangent&&(!!St.normalMap||St.anisotropy>0),pr=!!At.morphAttributes.position,li=!!At.morphAttributes.normal,Ni=!!At.morphAttributes.color;let Ki=Qa;St.toneMapped&&($e===null||$e.isXRRenderTarget===!0)&&(Ki=ie.toneMapping);const ii=At.morphAttributes.position||At.morphAttributes.normal||At.morphAttributes.color,Os=ii!==void 0?ii.length:0,nr=de.get(St),Qo=ne.state.lights;if(jn===!0&&(fr===!0||me!==He)){const xs=me===He&&St.id===ot;pn.setState(St,me,xs)}let si=!1;St.version===nr.__version?(nr.needsLights&&nr.lightsStateVersion!==Qo.state.version||nr.outputColorSpace!==Mn||_t.isBatchedMesh&&nr.batching===!1||!_t.isBatchedMesh&&nr.batching===!0||_t.isBatchedMesh&&nr.batchingColor===!0&&_t.colorTexture===null||_t.isBatchedMesh&&nr.batchingColor===!1&&_t.colorTexture!==null||_t.isInstancedMesh&&nr.instancing===!1||!_t.isInstancedMesh&&nr.instancing===!0||_t.isSkinnedMesh&&nr.skinning===!1||!_t.isSkinnedMesh&&nr.skinning===!0||_t.isInstancedMesh&&nr.instancingColor===!0&&_t.instanceColor===null||_t.isInstancedMesh&&nr.instancingColor===!1&&_t.instanceColor!==null||_t.isInstancedMesh&&nr.instancingMorph===!0&&_t.morphTexture===null||_t.isInstancedMesh&&nr.instancingMorph===!1&&_t.morphTexture!==null||nr.envMap!==Kn||St.fog===!0&&nr.fog!==Rn||nr.numClippingPlanes!==void 0&&(nr.numClippingPlanes!==pn.numPlanes||nr.numIntersection!==pn.numIntersection)||nr.vertexAlphas!==ur||nr.vertexTangents!==zr||nr.morphTargets!==pr||nr.morphNormals!==li||nr.morphColors!==Ni||nr.toneMapping!==Ki||nr.morphTargetsCount!==Os)&&(si=!0):(si=!0,nr.__version=St.version);let ha=nr.currentProgram;si===!0&&(ha=Uc(St,pt,_t));let Xs=!1,Do=!1,Bc=!1;const xi=ha.getUniforms(),Nr=nr.uniforms;if(Fn.useProgram(ha.program)&&(Xs=!0,Do=!0,Bc=!0),St.id!==ot&&(ot=St.id,Do=!0),Xs||He!==me){Fn.buffers.depth.getReversed()&&me.reversedDepth!==!0&&(me._reversedDepth=!0,me.updateProjectionMatrix()),xi.setValue(qe,"projectionMatrix",me.projectionMatrix),xi.setValue(qe,"viewMatrix",me.matrixWorldInverse);const i0=xi.map.cameraPosition;i0!==void 0&&i0.setValue(qe,Wr.setFromMatrixPosition(me.matrixWorld)),gi.logarithmicDepthBuffer&&xi.setValue(qe,"logDepthBufFC",2/(Math.log(me.far+1)/Math.LN2)),(St.isMeshPhongMaterial||St.isMeshToonMaterial||St.isMeshLambertMaterial||St.isMeshBasicMaterial||St.isMeshStandardMaterial||St.isShaderMaterial)&&xi.setValue(qe,"isOrthographic",me.isOrthographicCamera===!0),He!==me&&(He=me,Do=!0,Bc=!0)}if(nr.needsLights&&(Qo.state.directionalShadowMap.length>0&&xi.setValue(qe,"directionalShadowMap",Qo.state.directionalShadowMap,dt),Qo.state.spotShadowMap.length>0&&xi.setValue(qe,"spotShadowMap",Qo.state.spotShadowMap,dt),Qo.state.pointShadowMap.length>0&&xi.setValue(qe,"pointShadowMap",Qo.state.pointShadowMap,dt)),_t.isSkinnedMesh){xi.setOptional(qe,_t,"bindMatrix"),xi.setOptional(qe,_t,"bindMatrixInverse");const xs=_t.skeleton;xs&&(xs.boneTexture===null&&xs.computeBoneTexture(),xi.setValue(qe,"boneTexture",xs.boneTexture,dt))}_t.isBatchedMesh&&(xi.setOptional(qe,_t,"batchingTexture"),xi.setValue(qe,"batchingTexture",_t._matricesTexture,dt),xi.setOptional(qe,_t,"batchingIdTexture"),xi.setValue(qe,"batchingIdTexture",_t._indirectTexture,dt),xi.setOptional(qe,_t,"batchingColorTexture"),_t._colorsTexture!==null&&xi.setValue(qe,"batchingColorTexture",_t._colorsTexture,dt));const Oo=At.morphAttributes;if((Oo.position!==void 0||Oo.normal!==void 0||Oo.color!==void 0)&&Dn.update(_t,At,ha),(Do||nr.receiveShadow!==_t.receiveShadow)&&(nr.receiveShadow=_t.receiveShadow,xi.setValue(qe,"receiveShadow",_t.receiveShadow)),(St.isMeshStandardMaterial||St.isMeshLambertMaterial||St.isMeshPhongMaterial)&&St.envMap===null&&pt.environment!==null&&(Nr.envMapIntensity.value=pt.environmentIntensity),Nr.dfgLUT!==void 0&&(Nr.dfgLUT.value=wBe()),Do&&(xi.setValue(qe,"toneMappingExposure",ie.toneMappingExposure),nr.needsLights&&ja(Nr,Bc),Rn&&St.fog===!0&&tr.refreshFogUniforms(Nr,Rn),tr.refreshMaterialUniforms(Nr,St,Ot,ht,ne.state.transmissionRenderTarget[me.id]),WN.upload(qe,Zl(nr),Nr,dt)),St.isShaderMaterial&&St.uniformsNeedUpdate===!0&&(WN.upload(qe,Zl(nr),Nr,dt),St.uniformsNeedUpdate=!1),St.isSpriteMaterial&&xi.setValue(qe,"center",_t.center),xi.setValue(qe,"modelViewMatrix",_t.modelViewMatrix),xi.setValue(qe,"normalMatrix",_t.normalMatrix),xi.setValue(qe,"modelMatrix",_t.matrixWorld),St.isShaderMaterial||St.isRawShaderMaterial){const xs=St.uniformsGroups;for(let i0=0,Aa=xs.length;i0<Aa;i0++){const Ad=xs[i0];Cn.update(Ad,ha),Cn.bind(Ad,ha)}}return ha}function ja(me,pt){me.ambientLightColor.needsUpdate=pt,me.lightProbe.needsUpdate=pt,me.directionalLights.needsUpdate=pt,me.directionalLightShadows.needsUpdate=pt,me.pointLights.needsUpdate=pt,me.pointLightShadows.needsUpdate=pt,me.spotLights.needsUpdate=pt,me.spotLightShadows.needsUpdate=pt,me.rectAreaLights.needsUpdate=pt,me.hemisphereLights.needsUpdate=pt}function dp(me){return me.isMeshLambertMaterial||me.isMeshToonMaterial||me.isMeshPhongMaterial||me.isMeshStandardMaterial||me.isShadowMaterial||me.isShaderMaterial&&me.lights===!0}this.getActiveCubeFace=function(){return X},this.getActiveMipmapLevel=function(){return De},this.getRenderTarget=function(){return $e},this.setRenderTargetTextures=function(me,pt,At){const St=de.get(me);St.__autoAllocateDepthBuffer=me.resolveDepthBuffer===!1,St.__autoAllocateDepthBuffer===!1&&(St.__useRenderToTexture=!1),de.get(me.texture).__webglTexture=pt,de.get(me.depthTexture).__webglTexture=St.__autoAllocateDepthBuffer?void 0:At,St.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(me,pt){const At=de.get(me);At.__webglFramebuffer=pt,At.__useDefaultFramebuffer=pt===void 0};const Cd=qe.createFramebuffer();this.setRenderTarget=function(me,pt=0,At=0){$e=me,X=pt,De=At;let St=null,_t=!1,Rn=!1;if(me){const Mn=de.get(me);if(Mn.__useDefaultFramebuffer!==void 0){Fn.bindFramebuffer(qe.FRAMEBUFFER,Mn.__webglFramebuffer),ce.copy(me.viewport),Ge.copy(me.scissor),Ie=me.scissorTest,Fn.viewport(ce),Fn.scissor(Ge),Fn.setScissorTest(Ie),ot=-1;return}else if(Mn.__webglFramebuffer===void 0)dt.setupRenderTarget(me);else if(Mn.__hasExternalTextures)dt.rebindTextures(me,de.get(me.texture).__webglTexture,de.get(me.depthTexture).__webglTexture);else if(me.depthBuffer){const ur=me.depthTexture;if(Mn.__boundDepthTexture!==ur){if(ur!==null&&de.has(ur)&&(me.width!==ur.image.width||me.height!==ur.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");dt.setupDepthRenderbuffer(me)}}const On=me.texture;(On.isData3DTexture||On.isDataArrayTexture||On.isCompressedArrayTexture)&&(Rn=!0);const Kn=de.get(me).__webglFramebuffer;me.isWebGLCubeRenderTarget?(Array.isArray(Kn[pt])?St=Kn[pt][At]:St=Kn[pt],_t=!0):me.samples>0&&dt.useMultisampledRTT(me)===!1?St=de.get(me).__webglMultisampledFramebuffer:Array.isArray(Kn)?St=Kn[At]:St=Kn,ce.copy(me.viewport),Ge.copy(me.scissor),Ie=me.scissorTest}else ce.copy(Tt).multiplyScalar(Ot).floor(),Ge.copy(Gt).multiplyScalar(Ot).floor(),Ie=$t;if(At!==0&&(St=Cd),Fn.bindFramebuffer(qe.FRAMEBUFFER,St)&&Fn.drawBuffers(me,St),Fn.viewport(ce),Fn.scissor(Ge),Fn.setScissorTest(Ie),_t){const Mn=de.get(me.texture);qe.framebufferTexture2D(qe.FRAMEBUFFER,qe.COLOR_ATTACHMENT0,qe.TEXTURE_CUBE_MAP_POSITIVE_X+pt,Mn.__webglTexture,At)}else if(Rn){const Mn=pt;for(let On=0;On<me.textures.length;On++){const Kn=de.get(me.textures[On]);qe.framebufferTextureLayer(qe.FRAMEBUFFER,qe.COLOR_ATTACHMENT0+On,Kn.__webglTexture,At,Mn)}}else if(me!==null&&At!==0){const Mn=de.get(me.texture);qe.framebufferTexture2D(qe.FRAMEBUFFER,qe.COLOR_ATTACHMENT0,qe.TEXTURE_2D,Mn.__webglTexture,At)}ot=-1},this.readRenderTargetPixels=function(me,pt,At,St,_t,Rn,Bn,Mn=0){if(!(me&&me.isWebGLRenderTarget)){jt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let On=de.get(me).__webglFramebuffer;if(me.isWebGLCubeRenderTarget&&Bn!==void 0&&(On=On[Bn]),On){Fn.bindFramebuffer(qe.FRAMEBUFFER,On);try{const Kn=me.textures[Mn],ur=Kn.format,zr=Kn.type;if(me.textures.length>1&&qe.readBuffer(qe.COLOR_ATTACHMENT0+Mn),!gi.textureFormatReadable(ur)){jt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!gi.textureTypeReadable(zr)){jt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}pt>=0&&pt<=me.width-St&&At>=0&&At<=me.height-_t&&qe.readPixels(pt,At,St,_t,gn.convert(ur),gn.convert(zr),Rn)}finally{const Kn=$e!==null?de.get($e).__webglFramebuffer:null;Fn.bindFramebuffer(qe.FRAMEBUFFER,Kn)}}},this.readRenderTargetPixelsAsync=async function(me,pt,At,St,_t,Rn,Bn,Mn=0){if(!(me&&me.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let On=de.get(me).__webglFramebuffer;if(me.isWebGLCubeRenderTarget&&Bn!==void 0&&(On=On[Bn]),On)if(pt>=0&&pt<=me.width-St&&At>=0&&At<=me.height-_t){Fn.bindFramebuffer(qe.FRAMEBUFFER,On);const Kn=me.textures[Mn],ur=Kn.format,zr=Kn.type;if(me.textures.length>1&&qe.readBuffer(qe.COLOR_ATTACHMENT0+Mn),!gi.textureFormatReadable(ur))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!gi.textureTypeReadable(zr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const pr=qe.createBuffer();qe.bindBuffer(qe.PIXEL_PACK_BUFFER,pr),qe.bufferData(qe.PIXEL_PACK_BUFFER,Rn.byteLength,qe.STREAM_READ),qe.readPixels(pt,At,St,_t,gn.convert(ur),gn.convert(zr),0);const li=$e!==null?de.get($e).__webglFramebuffer:null;Fn.bindFramebuffer(qe.FRAMEBUFFER,li);const Ni=qe.fenceSync(qe.SYNC_GPU_COMMANDS_COMPLETE,0);return qe.flush(),await CNe(qe,Ni,4),qe.bindBuffer(qe.PIXEL_PACK_BUFFER,pr),qe.getBufferSubData(qe.PIXEL_PACK_BUFFER,0,Rn),qe.deleteBuffer(pr),qe.deleteSync(Ni),Rn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(me,pt=null,At=0){const St=Math.pow(2,-At),_t=Math.floor(me.image.width*St),Rn=Math.floor(me.image.height*St),Bn=pt!==null?pt.x:0,Mn=pt!==null?pt.y:0;dt.setTexture2D(me,0),qe.copyTexSubImage2D(qe.TEXTURE_2D,At,0,0,Bn,Mn,_t,Rn),Fn.unbindTexture()};const hp=qe.createFramebuffer(),fp=qe.createFramebuffer();this.copyTextureToTexture=function(me,pt,At=null,St=null,_t=0,Rn=0){let Bn,Mn,On,Kn,ur,zr,pr,li,Ni;const Ki=me.isCompressedTexture?me.mipmaps[Rn]:me.image;if(At!==null)Bn=At.max.x-At.min.x,Mn=At.max.y-At.min.y,On=At.isBox3?At.max.z-At.min.z:1,Kn=At.min.x,ur=At.min.y,zr=At.isBox3?At.min.z:0;else{const Nr=Math.pow(2,-_t);Bn=Math.floor(Ki.width*Nr),Mn=Math.floor(Ki.height*Nr),me.isDataArrayTexture?On=Ki.depth:me.isData3DTexture?On=Math.floor(Ki.depth*Nr):On=1,Kn=0,ur=0,zr=0}St!==null?(pr=St.x,li=St.y,Ni=St.z):(pr=0,li=0,Ni=0);const ii=gn.convert(pt.format),Os=gn.convert(pt.type);let nr;pt.isData3DTexture?(dt.setTexture3D(pt,0),nr=qe.TEXTURE_3D):pt.isDataArrayTexture||pt.isCompressedArrayTexture?(dt.setTexture2DArray(pt,0),nr=qe.TEXTURE_2D_ARRAY):(dt.setTexture2D(pt,0),nr=qe.TEXTURE_2D),qe.pixelStorei(qe.UNPACK_FLIP_Y_WEBGL,pt.flipY),qe.pixelStorei(qe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pt.premultiplyAlpha),qe.pixelStorei(qe.UNPACK_ALIGNMENT,pt.unpackAlignment);const Qo=qe.getParameter(qe.UNPACK_ROW_LENGTH),si=qe.getParameter(qe.UNPACK_IMAGE_HEIGHT),ha=qe.getParameter(qe.UNPACK_SKIP_PIXELS),Xs=qe.getParameter(qe.UNPACK_SKIP_ROWS),Do=qe.getParameter(qe.UNPACK_SKIP_IMAGES);qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Ki.width),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,Ki.height),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,Kn),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,ur),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,zr);const Bc=me.isDataArrayTexture||me.isData3DTexture,xi=pt.isDataArrayTexture||pt.isData3DTexture;if(me.isDepthTexture){const Nr=de.get(me),Oo=de.get(pt),xs=de.get(Nr.__renderTarget),i0=de.get(Oo.__renderTarget);Fn.bindFramebuffer(qe.READ_FRAMEBUFFER,xs.__webglFramebuffer),Fn.bindFramebuffer(qe.DRAW_FRAMEBUFFER,i0.__webglFramebuffer);for(let Aa=0;Aa<On;Aa++)Bc&&(qe.framebufferTextureLayer(qe.READ_FRAMEBUFFER,qe.COLOR_ATTACHMENT0,de.get(me).__webglTexture,_t,zr+Aa),qe.framebufferTextureLayer(qe.DRAW_FRAMEBUFFER,qe.COLOR_ATTACHMENT0,de.get(pt).__webglTexture,Rn,Ni+Aa)),qe.blitFramebuffer(Kn,ur,Bn,Mn,pr,li,Bn,Mn,qe.DEPTH_BUFFER_BIT,qe.NEAREST);Fn.bindFramebuffer(qe.READ_FRAMEBUFFER,null),Fn.bindFramebuffer(qe.DRAW_FRAMEBUFFER,null)}else if(_t!==0||me.isRenderTargetTexture||de.has(me)){const Nr=de.get(me),Oo=de.get(pt);Fn.bindFramebuffer(qe.READ_FRAMEBUFFER,hp),Fn.bindFramebuffer(qe.DRAW_FRAMEBUFFER,fp);for(let xs=0;xs<On;xs++)Bc?qe.framebufferTextureLayer(qe.READ_FRAMEBUFFER,qe.COLOR_ATTACHMENT0,Nr.__webglTexture,_t,zr+xs):qe.framebufferTexture2D(qe.READ_FRAMEBUFFER,qe.COLOR_ATTACHMENT0,qe.TEXTURE_2D,Nr.__webglTexture,_t),xi?qe.framebufferTextureLayer(qe.DRAW_FRAMEBUFFER,qe.COLOR_ATTACHMENT0,Oo.__webglTexture,Rn,Ni+xs):qe.framebufferTexture2D(qe.DRAW_FRAMEBUFFER,qe.COLOR_ATTACHMENT0,qe.TEXTURE_2D,Oo.__webglTexture,Rn),_t!==0?qe.blitFramebuffer(Kn,ur,Bn,Mn,pr,li,Bn,Mn,qe.COLOR_BUFFER_BIT,qe.NEAREST):xi?qe.copyTexSubImage3D(nr,Rn,pr,li,Ni+xs,Kn,ur,Bn,Mn):qe.copyTexSubImage2D(nr,Rn,pr,li,Kn,ur,Bn,Mn);Fn.bindFramebuffer(qe.READ_FRAMEBUFFER,null),Fn.bindFramebuffer(qe.DRAW_FRAMEBUFFER,null)}else xi?me.isDataTexture||me.isData3DTexture?qe.texSubImage3D(nr,Rn,pr,li,Ni,Bn,Mn,On,ii,Os,Ki.data):pt.isCompressedArrayTexture?qe.compressedTexSubImage3D(nr,Rn,pr,li,Ni,Bn,Mn,On,ii,Ki.data):qe.texSubImage3D(nr,Rn,pr,li,Ni,Bn,Mn,On,ii,Os,Ki):me.isDataTexture?qe.texSubImage2D(qe.TEXTURE_2D,Rn,pr,li,Bn,Mn,ii,Os,Ki.data):me.isCompressedTexture?qe.compressedTexSubImage2D(qe.TEXTURE_2D,Rn,pr,li,Ki.width,Ki.height,ii,Ki.data):qe.texSubImage2D(qe.TEXTURE_2D,Rn,pr,li,Bn,Mn,ii,Os,Ki);qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Qo),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,si),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,ha),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,Xs),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,Do),Rn===0&&pt.generateMipmaps&&qe.generateMipmap(nr),Fn.unbindTexture()},this.initRenderTarget=function(me){de.get(me).__webglFramebuffer===void 0&&dt.setupRenderTarget(me)},this.initTexture=function(me){me.isCubeTexture?dt.setTextureCube(me,0):me.isData3DTexture?dt.setTexture3D(me,0):me.isDataArrayTexture||me.isCompressedArrayTexture?dt.setTexture2DArray(me,0):dt.setTexture2D(me,0),Fn.unbindTexture()},this.resetState=function(){X=0,De=0,$e=null,Fn.reset(),un.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ql}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Xn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Xn._getUnpackColorSpace()}}const cj=!0,uj=document.location.hash.search("editor")>-1;var ok=(i=>(i.LOAD_COMPLETE="Events::loadComplete",i))(ok||{});const VH=new Yl;function dj(i,e,t,n){return new(t||(t=Promise))(function(r,s){function a(p){try{d(n.next(p))}catch(y){s(y)}}function c(p){try{d(n.throw(p))}catch(y){s(y)}}function d(p){var y;p.done?r(p.value):(y=p.value,y instanceof t?y:new t(function(x){x(y)})).then(a,c)}d((n=n.apply(i,[])).next())})}const TBe=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function v4e(i){return i=i.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const _8e=typeof window>"u",X1=(()=>{if(_8e)return;const{userAgent:i,platform:e,maxTouchPoints:t}=window.navigator,n=/(iphone|ipod|ipad)/i.test(i),r=e==="iPad"||e==="MacIntel"&&t>0&&!window.MSStream;return{isIpad:r,isMobile:/android/i.test(i)||n||r,isSafari12:/Version\/12.+Safari/.test(i),isFirefox:/Firefox/.test(i)}})();function EBe(i,e,t){if(!t)return[e];const n=function(p){const y=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,x=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,w=p.createShader(35633),C=p.createShader(35632),N=p.createProgram();if(!(C&&w&&N))return;p.shaderSource(w,y),p.shaderSource(C,x),p.compileShader(w),p.compileShader(C),p.attachShader(N,w),p.attachShader(N,C),p.linkProgram(N),p.detachShader(N,w),p.detachShader(N,C),p.deleteShader(w),p.deleteShader(C),p.useProgram(N);const F=p.createBuffer();p.bindBuffer(34962,F),p.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const U=p.getAttribLocation(N,"aPosition");p.vertexAttribPointer(U,3,5126,!1,0,0),p.enableVertexAttribArray(U),p.clearColor(1,1,1,1),p.clear(16384),p.viewport(0,0,1,1),p.drawArrays(4,0,3);const R=new Uint8Array(4);return p.readPixels(0,0,1,1,6408,5121,R),p.deleteProgram(N),p.deleteBuffer(F),R.join("")}(i),r="801621810",s="8016218135",a="80162181161",c=X1!=null&&X1.isIpad?[["a7",a,12],["a8",s,15],["a8x",s,15],["a9",s,15],["a9x",s,15],["a10",s,15],["a10x",s,15],["a12",r,15],["a12x",r,15],["a12z",r,15],["a14",r,15],["a15",r,15],["m1",r,15],["m2",r,15]]:[["a7",a,12],["a8",s,12],["a9",s,15],["a10",s,15],["a11",r,15],["a12",r,15],["a13",r,15],["a14",r,15],["a15",r,15],["a16",r,15],["a17",r,15]];let d;return n==="80162181255"?d=c.filter(([,,p])=>p>=14):(d=c.filter(([,p])=>p===n),d.length||(d=c)),d.map(([p])=>`apple ${p} gpu`)}let y4e=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}};const hj=[],_4e=[];function MBe(i,e){if(i===e)return 0;const t=i;i.length>e.length&&(i=e,e=t);let n=i.length,r=e.length;for(;n>0&&i.charCodeAt(~-n)===e.charCodeAt(~-r);)n--,r--;let s,a=0;for(;a<n&&i.charCodeAt(a)===e.charCodeAt(a);)a++;if(n-=a,r-=a,n===0)return r;let c,d,p=0,y=0,x=0;for(;y<n;)_4e[y]=i.charCodeAt(a+y),hj[y]=++y;for(;x<r;)for(s=e.charCodeAt(a+x),c=x++,p=x,y=0;y<n;y++)d=s===_4e[y]?c:c+1,c=hj[y],p=hj[y]=c>p?d>p?p+1:d:d>c?c+1:d;return p}function CBe(i){return i!=null}const ABe=({mobileTiers:i=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:n,failIfMajorPerformanceCaveat:r=!1,benchmarksURL:s="https://unpkg.com/detect-gpu@5.0.70/dist/benchmarks"}={})=>dj(void 0,void 0,void 0,function*(){const a={};if(_8e)return{tier:0,type:"SSR"};const{isIpad:c=!!(X1!=null&&X1.isIpad),isMobile:d=!!(X1!=null&&X1.isMobile),screenSize:p=window.screen,loadBenchmarks:y=ne=>dj(void 0,void 0,void 0,function*(){const se=yield fetch(`${s}/${ne}`).then(oe=>oe.json());if(parseInt(se.shift().split(".")[0],10)<4)throw new y4e("Detect GPU benchmark data is out of date. Please update to version 4x");return se})}=t;let{renderer:x}=t;const w=(ne,se,oe,G,ie)=>({device:ie,fps:G,gpu:oe,isMobile:d,tier:ne,type:se});let C,N="";if(x)x=v4e(x),C=[x];else{const ne=n||function(oe,G=!1){const ie={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:G,powerPreference:"high-performance",stencil:!1};oe&&delete ie.powerPreference;const Me=window.document.createElement("canvas"),X=Me.getContext("webgl",ie)||Me.getContext("experimental-webgl",ie);return X??void 0}(X1==null?void 0:X1.isSafari12,r);if(!ne)return w(0,"WEBGL_UNSUPPORTED");const se=X1!=null&&X1.isFirefox?null:ne.getExtension("WEBGL_debug_renderer_info");if(x=se?ne.getParameter(se.UNMASKED_RENDERER_WEBGL):ne.getParameter(ne.RENDERER),!x)return w(1,"FALLBACK");N=x,x=v4e(x),C=function(oe,G,ie){return G==="apple gpu"?EBe(oe,G,ie):[G]}(ne,x,d)}const F=(yield Promise.all(C.map(function(ne){var se;return dj(this,void 0,void 0,function*(){const oe=(Ot=>{const wn=d?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const bn of wn)if(Ot.includes(bn))return bn})(ne);if(!oe)return;const G=`${d?"m":"d"}-${oe}${c?"-ipad":""}.json`,ie=a[G]=(se=a[G])!==null&&se!==void 0?se:y(G);let Me;try{Me=yield ie}catch(Ot){if(Ot instanceof y4e)throw Ot;return}const X=function(Ot){var wn;const bn=(Ot=Ot.replace(/\([^)]+\)/,"")).match(/\d+/)||Ot.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(wn=bn==null?void 0:bn.join("").replace(/\W|amd/g,""))!==null&&wn!==void 0?wn:""}(ne);let De=Me.filter(([,Ot])=>Ot===X);De.length||(De=Me.filter(([Ot])=>Ot.includes(ne)));const $e=De.length;if($e===0)return;const ot=ne.split(/[.,()\[\]/\s]/g).sort().filter((Ot,wn,bn)=>wn===0||Ot!==bn[wn-1]).join(" ");let He,[ce,,,,Ge]=$e>1?De.map(Ot=>[Ot,MBe(ot,Ot[2])]).sort(([,Ot],[,wn])=>Ot-wn)[0][0]:De[0],Ie=Number.MAX_VALUE;const{devicePixelRatio:st}=window,bt=p.width*st*p.height*st;for(const Ot of Ge){const[wn,bn]=Ot,Tt=wn*bn,Gt=Math.abs(bt-Tt);Gt<Ie&&(Ie=Gt,He=Ot)}if(!He)return;const[,,Ne,ht]=He;return[Ie,Ne,ce,ht]})}))).filter(CBe).sort(([ne=Number.MAX_VALUE,se],[oe=Number.MAX_VALUE,G])=>ne===oe?se-G:ne-oe);if(!F.length){const ne=TBe.find(se=>x.includes(se));return ne?w(0,"BLOCKLISTED",ne):w(1,"FALLBACK",`${x} (${N})`)}const[,U,R,B]=F[0];if(U===-1)return w(0,"BLOCKLISTED",R,U,B);const Y=d?i:e;let A=0;for(let ne=0;ne<Y.length;ne++)U>=Y[ne]&&(A=ne);return w(A,"BENCHMARK",R,U,B)});function PBe(i){let e=0;const t=performance.now();function n(){e++;const r=performance.now();if(r-t>=100){const s=e/((r-t)/1e3),a=Math.round(s/30)*30;i(a)}else requestAnimationFrame(n)}requestAnimationFrame(n)}function RBe(i=!1,e=!1){return new Promise(t=>{ABe().then(n=>{let r=!1;const s=document.createElement("canvas"),a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(r="transferControlToOffscreen"in s,a){const d=navigator.userAgent.match(/version\/(\d+)/i);r=(d?parseInt(d[1]):0)>=17}const c={dpr:devicePixelRatio,fps:30,width:innerWidth,height:innerHeight,mobile:n.isMobile!==void 0?n.isMobile:!1,supportOffScreenCanvas:r,supportWebGPU:!!navigator.gpu,quality:"Low",dev:i,editor:e};n.tier===3?c.quality="High":n.tier===2&&(c.quality="Medium"),PBe(d=>{c.fps=d,t(c)})})})}class IBe{constructor(){Xe(this,"assets",{audio:new Map,image:new Map,json:new Map,model:new Map,video:new Map});Xe(this,"components",new Map);Xe(this,"settings",{dpr:1,fps:30,width:0,height:0,mobile:!1,supportOffScreenCanvas:!1,supportWebGPU:!1,quality:"Low",dev:!1,editor:!1});Xe(this,"onUpdateCallback");Xe(this,"playing",!1);Xe(this,"rafID",-1);Xe(this,"play",()=>{this.playing||(this.playing=!0,this.onUpdate())});Xe(this,"pause",()=>{this.playing&&(this.playing=!1,cancelAnimationFrame(this.rafID),this.rafID=-1)});Xe(this,"onUpdate",()=>{this.update(),this.isApp&&this.draw(),this.onUpdateCallback&&this.onUpdateCallback(),this.rafID=requestAnimationFrame(this.onUpdate)})}dispose(){this.pause(),this.components.forEach(e=>e.dispose()),this.components.clear()}detectSettings(e=!1,t=!1){return new Promise(n=>{RBe(e,t).then(r=>{this.settings=r,n()})})}update(){}draw(){}addComponent(e,t){this.components.set(e,t)}get debugEnabled(){return this.settings.dev}get isApp(){return!this.editor}set isApp(e){this.editor=!e}get editor(){return this.settings.editor}set editor(e){this.settings.editor=e}}var NBe=Pve();class x8e{constructor(e,t=!1,n=!1){Xe(this,"name");Xe(this,"_debug",!1);Xe(this,"_editor",!1);Xe(this,"broadcastChannel");this.name=e,this._debug=t,this._editor=n,t&&(this.broadcastChannel=new BroadcastChannel(e),this.broadcastChannel.addEventListener("message",this.messageHandler.bind(this)))}dispose(){var e,t;(e=this.broadcastChannel)==null||e.removeEventListener("message",this.messageHandler.bind(this)),(t=this.broadcastChannel)==null||t.close()}get debug(){return this._debug}get editor(){return this._editor}send(e){var n;if(this.editor&&e.target==="app"||!this.editor&&e.target==="editor")try{(n=this.broadcastChannel)==null||n.postMessage(e)}catch(r){console.log("Hermes - Error sending message:"),console.log(r),console.log(e)}}messageHandler(e){const t=e.data;t.target==="app"?this.handleApp(t):this.handleEditor(t)}handleApp(e){}handleEditor(e){}}const b8e=()=>{};function ak(i){return i.substring(0,1).toUpperCase()+i.substring(1)}function kBe(i){const e=JSON.stringify(i);return navigator.clipboard.writeText(e),e}function nl(){return Math.round(Math.random()*1e6).toString()}function DBe(i){return i.r!==void 0&&i.g!==void 0&&i.b!==void 0}function x4e(i){const e=Math.round(i.r*255),t=Math.round(i.g*255),n=Math.round(i.b*255),r=d=>{const p=d.toString(16);return p.length===1?"0"+p:p},s=r(e),a=r(t),c=r(n);return"#"+s+a+c}function OBe(i,e,t,n,r){const s=1-i;return s*s*s*e+3*s*s*i*t+3*s*i*i*n+i*i*i*r}function LBe(i,e,t){if(i.type!=="bezier"||i.handles.length!==4)throw new Error("Invalid keyframe data for Bzier interpolation.");const[n,r]=i.handles,s=(t-i.position)/(e.position-i.position);return OBe(s,i.value,i.value+n,e.value+r,e.value)}class FBe extends x8e{constructor(t=!1,n=!1){super("RemoteTheatre",t,n);Xe(this,"project");Xe(this,"sheets",new Map);Xe(this,"sheetObjects",new Map);Xe(this,"sheetObjectCBs",new Map);Xe(this,"sheetObjectUnsubscribe",new Map);Xe(this,"activeSheet");Xe(this,"studio")}dispose(){this.project=void 0,this.sheets=new Map,this.sheetObjects=new Map,this.sheetObjectCBs=new Map,this.sheetObjectUnsubscribe=new Map}loadProject(t,n){return this.project=NBe.getProject(t,{state:n}),new Promise((r,s)=>{var a;(a=this.project)==null||a.ready.then(()=>{if(n){const c=n.sheetsById;for(const d in c)this.sheet(d)}r()}).catch(()=>s())})}getSheetInstance(t,n){return n!==void 0?`${t}-${n}`:t}sheet(t,n){var a;if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const r=this.getSheetInstance(t,n);let s=this.sheets.get(r);return s!==void 0||(s=(a=this.project)==null?void 0:a.sheet(t,n),this.sheets.set(r,s)),s}playSheet(t,n,r){return new Promise(s=>{var a;(a=this.sheet(t,r))==null||a.sequence.play(n).then(c=>s(c)),this.send({event:"playSheet",target:"editor",data:{sheet:t,instance:r,value:n}})})}pauseSheet(t,n){var r;(r=this.sheet(t,n))==null||r.sequence.pause(),this.send({event:"pauseSheet",target:"editor",data:{sheet:t,instance:n}})}clearSheetObjects(t){this.sheetObjects.forEach((n,r)=>{r.search(`${t}_`)>-1&&this.unsubscribe(n)})}sheetObject(t,n,r,s,a){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const c=this.sheet(t,a);if(c===void 0)return;const p=`${this.getSheetInstance(t,a)}_${n}`;let y=this.sheetObjects.get(p),x=r;y!==void 0&&(x={...r,...y.value}),y=c.object(n,x,{reconfigure:!0}),this.sheetObjects.set(p,y),this.sheetObjectCBs.set(p,s!==void 0?s:b8e);function w(N,F,U){if(typeof U=="object")if(DBe(U))N[F]={r:U.r,g:U.g,b:U.b,a:U.a};else for(const R in U){const B=U[R];typeof B=="object"&&w(U,R,B)}}const C=y.onValuesChange(N=>{const F=this.sheetObjectCBs.get(p);if(this.editor){for(const U in N){const R=N[U];typeof R=="object"&&w(N,U,R)}this.send({event:"updateSheetObject",target:"app",data:{sheet:t,sheetObject:p,values:N}}),F&&F(N)}else F&&F(N)});return this.sheetObjectUnsubscribe.set(p,C),y}getSheetObjectKeyframes(t,n,r){const s=this.sheet(t);if(s===void 0)return[];const a=`${t}_${n}`,c=this.sheetObjects.get(a);return c===void 0?[]:s.sequence.__experimental_getKeyframes(c.props[r])}getSheetObjectVectors(t,n){const r=this.sheet(t);if(r===void 0)return[];const s=`${t}_${n}`,a=this.sheetObjects.get(s);if(a===void 0)return[];const c=[],d=r.sequence.__experimental_getKeyframes(a.props.x),p=r.sequence.__experimental_getKeyframes(a.props.y),y=r.sequence.__experimental_getKeyframes(a.props.z),x=new Set;return d.forEach(C=>x.add(C.position)),p.forEach(C=>x.add(C.position)),y.forEach(C=>x.add(C.position)),Array.from(x).sort((C,N)=>C-N).forEach(C=>{const N=(F,U)=>{const R=F.find((A,ne)=>{var se;return A.position<=U&&(((se=F[ne+1])==null?void 0:se.position)||1/0)>U}),B=F.find(A=>A.position>U);if(!R)return(B==null?void 0:B.value)||0;if(!B||R.position===U)return R.value;if(R.type==="bezier")return LBe(R,B,U);const Y=(U-R.position)/(B.position-R.position);return R.value+Y*(B.value-R.value)};c.push({position:C,x:N(d,C),y:N(p,C),z:N(y,C)})}),c}update(t){}unsubscribe(t){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const n=t.address.sheetId,r=t.address.objectKey,s=this.sheets.get(n);s==null||s.detachObject(r);const a=`${n}_${r}`,c=this.sheetObjectUnsubscribe.get(a);c!==void 0&&(this.sheetObjects.delete(a),this.sheetObjectCBs.delete(a),this.sheetObjectUnsubscribe.delete(a),c())}handleApp(t){var r,s;let n;switch(t.event){case"setSheet":n=this.sheets.get(t.data.sheet),n!==void 0?(r=this.studio)==null||r.setSelection([n]):console.log(`Hermes - Can't set Sheet: ${t.data.sheet}`,n);break;case"setSheetObject":n=this.sheetObjects.get(`${t.data.sheet}_${t.data.key}`),n!==void 0?(s=this.studio)==null||s.setSelection([n]):console.log(`Hermes - Can't set Sheet Object: ${t.data.sheet}, ${t.data.key}: ${t.data.sheet}_${t.data.key}`,n);break;case"updateSheetObject":n=this.sheets.get(t.data.sheet),n!==void 0&&n.sequence.pause(),n=this.sheetObjectCBs.get(t.data.sheetObject),n!==void 0?n(t.data.values):console.log(`Hermes - Can't update Sheet Object: ${t.data.sheetObject}, ${t.data.sheet}`,n);break;case"updateTimeline":n=this.sheets.get(t.data.sheet),n!==void 0?n.sequence.position=t.data.position:console.log(`Hermes - Can't update sheet position: ${t.data.sheet}, ${t.data.position}`);break}}handleEditor(t){var n,r;switch(t.event){case"playSheet":(n=this.sheet(t.data.sheet,t.data.instance))==null||n.sequence.play(t.data.value);break;case"pauseSheet":(r=this.sheet(t.data.sheet,t.data.instance))==null||r.sequence.pause();break}}getSheetNames(){const t=[];return this.sheets.forEach((n,r)=>{t.push(r)}),t}handleEditorApp(){var t,n,r;if(this.editor){(t=this.studio)==null||t.ui.restore(),(n=this.studio)==null||n.onSelectionChange(d=>{d.length<1||d.forEach(p=>{let y=p.address.sheetId,x="setSheet",w={};switch(p.type){case"Theatre_Sheet_PublicAPI":x="setSheet",w={sheet:p.address.sheetId},this.activeSheet=this.sheets.get(p.address.sheetId);break;case"Theatre_SheetObject_PublicAPI":x="setSheetObject",y+=`_${p.address.objectKey}`,w={id:y,sheet:p.address.sheetId,key:p.address.objectKey},this.activeSheet=this.sheets.get(p.address.sheetId);break}this.send({event:x,target:"app",data:w})})});let s=-1;const a=()=>{if(this.activeSheet!==void 0&&s!==this.activeSheet.sequence.position){s=this.activeSheet.sequence.position;const d=this.activeSheet;this.send({event:"updateTimeline",target:"app",data:{position:s,sheet:d.address.sheetId}})}},c=()=>{a(),requestAnimationFrame(c)};a(),c()}else(r=this.studio)==null||r.ui.hide()}}const sq=new Ii;sq.setAttribute("position",new Rr([-.5,-.5,0,1.5,-.5,0,-.5,1.5,0],3));sq.setAttribute("normal",new Rr([0,0,1,0,0,1],3));sq.setAttribute("uv",new Rr([0,0,2,0,0,2],2));new w2(-.5,.5,.5,-.5,0,100);const b4e=i=>{i==null||i.dispose()},S8e=i=>{if(i)if(Array.isArray(i))i.forEach(e=>S8e(e));else{for(const e in i){const t=i[e];t!==null&&t instanceof ro&&b4e(t)}if(i.isShaderMaterial===!0){const e=i;for(const t in e.uniforms){const n=e.uniforms[t];n.value!==null&&n.value instanceof ro&&b4e(n.value)}}i.dispose()}},Mh=i=>{var e;if(i){for(;i.children.length>0;){const t=i.children[0];t.type==="Audio"?(t.pause(),t.parent&&t.parent.remove(t)):Mh(t)}if(i.parent&&i.parent.remove(i),i.isMesh){const t=i;(e=t.geometry)==null||e.dispose(),S8e(t.material)}i.dispose!==void 0&&i.dispose()}};let GH=0;const nN=()=>{GH=0},y2=i=>{if(!i)return;let e=i.name.replaceAll(" ","").replaceAll("/",".");if(e.length===0&&(e=`obj_${GH}`,GH++),i.parent!==null&&i.parent.uuid.length>0&&(e=`${i.parent.uuid}.${e}`),i.uuid=e,i.isMesh!==void 0){const t=i;if(Array.isArray(t.material))t.material.forEach((n,r)=>{n.uuid=`${e}.material.${r}`});else{const n=t.material;n.uuid=`${e}.material`}}i.children.forEach(t=>y2(t))};class el{static init(){this.inited||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.inited=!0)}static renderToBlob(e){this.init();const t=e.repeat.clone(),n=e.offset.clone();if(e.repeat.set(1,1),e.offset.set(0,0),this.context!==null){this.context.clearRect(0,0,this.width,this.height);const r=e.image;if(r!=null&&r.width>0){this.canvas.title=e.sourceFile;const s=this.canvas.width/r.width,a=this.renderToCanvas(e);this.context.drawImage(a,0,0,r.width*s,r.height*s)}}return e.repeat.copy(t),e.offset.copy(n),this.canvas.toDataURL("image/png")}static renderToCanvas(e){if(this.material===null){this.camera=new w2(-.5,.5,.5,-.5,0,100),this.scene=new c6,this.material=new Ua;const t=new Ii;t.setAttribute("position",new Rr([-.5,-.5,0,1.5,-.5,0,-.5,1.5,0],3)),t.setAttribute("normal",new Rr([0,0,1,0,0,1],3)),t.setAttribute("uv",new Rr([0,0,2,0,0,2],2));const n=new fn(t,this.material);this.scene.add(n)}if(e.isRenderTargetTexture)this.material.map=e,this.renderer.render(this.scene,this.camera);else{const t=this.renderer.outputColorSpace,n=e.colorSpace;this.renderer.outputColorSpace=Fc,e.colorSpace=Fc,this.material.map=e,this.renderer.render(this.scene,this.camera),this.renderer.outputColorSpace=t,e.colorSpace=n}return this.renderer.domElement}}Xe(el,"renderer"),Xe(el,"canvas"),Xe(el,"context",null),Xe(el,"scene",null),Xe(el,"camera",null),Xe(el,"material",null),Xe(el,"inited",!1),Xe(el,"width",100),Xe(el,"height",100);function UBe(i){if(i.name==="cameras")return"camera";if(i.name==="interactive")return"interactive";if(i.name==="lights")return"light";if(i.name==="ui")return"ui";if(i.name==="utils")return"utils";const e=i.type;return e.search("Helper")>-1?"icon_utils":e.search("Camera")>-1?"camera":e.search("Light")>-1?"light":"obj3D"}function r4(i){const e={name:i.name,type:i.type,uuid:i.uuid,children:[]};return i.children.forEach(t=>{e.children.push(r4(t))}),e}function BBe(i){const e={};for(const t in i){const n=i[t].value;e[t]={value:n},n===null?e[t].value={src:"",offset:[0,0],repeat:[1,1]}:n!==void 0&&n.isTexture&&(e[t].value={src:n.image.src,offset:[n.offset.x,n.offset.y],repeat:[n.repeat.x,n.repeat.y]})}return e}function zBe(i){switch(i){case"blendSrcAlpha":case"blendDstAlpha":case"blendEquationAlpha":case"clippingPlanes":case"shadowSide":case"precision":return!0}return!1}function w_(i){const e={};for(const t in i){if(t.substring(0,1)==="_"||t.substring(0,2)==="is"||zBe(t))continue;const n=typeof i[t],r=i[t];switch(n){case"boolean":case"number":case"string":e[t]=r;break;case"object":r!==null?(e[t]=r,r.isTexture?e[t]={src:el.renderToBlob(r),offset:[r.offset.x,r.offset.y],repeat:[r.repeat.x,r.repeat.y]}:t==="uniforms"&&(e[t]=BBe(e[t]))):t==="glslVersion"?e[t]="":e[t]={src:"",offset:[0,0],repeat:[1,1]};break}}return i.anisotropy!==void 0&&(e.anisotropy=i.anisotropy),i.clearcoat!==void 0&&(e.clearcoat=i.clearcoat),i.iridescence!==void 0&&(e.iridescence=i.iridescence),i.dispersion!==void 0&&(e.dispersion=i.dispersion),i.sheen!==void 0&&(e.sheen=i.sheen),i.transmission!==void 0&&(e.transmission=i.transmission),i.transmission!==void 0&&(e.transmission=i.transmission),e}function fj(i){i.updateMatrix();const e={name:i.name,type:i.type,uuid:i.uuid,visible:i.visible,matrix:i.matrix.elements,animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};i.animations.forEach(n=>{e.animations.push({name:n.name,duration:n.duration,blendMode:n.blendMode})});const t=i.type.toLowerCase();if(t.search("mesh")>-1){const n=i;if(Array.isArray(n.material)){const r=[];n.material.forEach(s=>{r.push(w_(s))}),e.material=r}else e.material=w_(n.material)}else if(t.search("points")>-1){const n=i;if(Array.isArray(n.material)){const r=[];n.material.forEach(s=>{r.push(w_(s))}),e.material=r}else e.material=w_(n.material)}else if(t.search("line")>-1){const n=i;if(Array.isArray(n.material)){const r=[];n.material.forEach(s=>{r.push(w_(s))}),e.material=r}else e.material=w_(n.material)}else t.search("camera")>-1?i.type==="PerspectiveCamera"?e.perspectiveCameraInfo={fov:i.fov,zoom:i.zoom,near:i.near,far:i.far,focus:i.focus,aspect:i.aspect,filmGauge:i.filmGauge,filmOffset:i.filmOffset}:i.type==="OrthographicCamera"&&(e.orthographicCameraInfo={zoom:i.zoom,near:i.near,far:i.far,left:i.left,right:i.right,top:i.top,bottom:i.bottom}):t.search("light")>-1&&(e.lightInfo={color:i.color,intensity:i.intensity,decay:i.decay,distance:i.distance,angle:i.angle,penumbra:i.penumbra,groundColor:i.groundColor,width:i.width,height:i.height});return e}function VBe(i,e){const t=e.split(".");switch(t.length){case 1:return i[t[0]];case 2:return i[t[0]][t[1]];case 3:return i[t[0]][t[1]][t[2]];case 4:return i[t[0]][t[1]][t[2]][t[3]];case 5:return i[t[0]][t[1]][t[2]][t[3]][t[4]];case 6:return i[t[0]][t[1]][t[2]][t[3]][t[4]][t[5]]}}function GBe(i,e){for(const t in e)i[t]=e[t]}function Ea(i,e,t){if(i===void 0){console.log(`Hermes - Can't set props: ${e}`,t);return}const n=e.split("."),r=n.length;if(typeof t!="object")switch(r){case 1:i[n[0]]=t;break;case 2:i[n[0]][n[1]]=t;break;case 3:i[n[0]][n[1]][n[2]]=t;break;case 4:i[n[0]][n[1]][n[2]][n[3]]=t;break;case 5:i[n[0]][n[1]][n[2]][n[3]][n[4]]=t;break}else{let a;switch(r){case 1:a=i[n[0]];break;case 2:a=i[n[0]][n[1]];break;case 3:a=i[n[0]][n[1]][n[2]];break;case 4:a=i[n[0]][n[1]][n[2]][n[3]];break;case 5:a=i[n[0]][n[1]][n[2]][n[3]][n[4]];break}a!=null?GBe(a,t):console.log(`Hermes - Can't set props because target isn't found: ${e}`,t)}}function oq(i){return new Promise((e,t)=>{const n=new Image;n.onload=()=>{const r=new ro(n);r.wrapS=bd,r.wrapT=bd,r.needsUpdate=!0,e(r)},n.onerror=t,n.src=i})}function F8(i,e,t){return Math.min(e,Math.max(i,t))}function S4e(i,e,t){return(t-i)/(e-i)}function jH(i,e,t){return i*(1-t)+e*t}function Yf(i,e=1){return Number(i.toFixed(e))}var _i=(i=>(i.CUSTOM="ToolEvents::custom",i.SELECT_DROPDOWN="ToolEvents::selectDropdown",i.DRAG_UPDATE="ToolEvents::dragUpdate",i.ADD_SCENE="ToolEvents::addScene",i.REFRESH_SCENE="ToolEvents::refreshScene",i.REMOVE_SCENE="ToolEvents::removeScene",i.SET_SCENE="ToolEvents::setScene",i.SET_OBJECT="ToolEvents::setObject",i.CLEAR_OBJECT="ToolEvents::clearObject",i.ADD_CAMERA="ToolEvents::addCamera",i.REMOVE_CAMERA="ToolEvents::removeCamera",i.ADD_GROUP="ToolEvents::addGroup",i.REMOVE_GROUP="ToolEvents::removeGroup",i.ADD_SPLINE="ToolEvents::addSpline",i.ADD_RENDERER="ToolEvents::addRenderer",i.UPDATE_RENDERER="ToolEvents::updateRenderer",i))(_i||{});class jBe extends x8e{constructor(t,n=!1,r=!1){super("RemoteThree",n,r);Xe(this,"name");Xe(this,"canvas",null);Xe(this,"inputElement",null);Xe(this,"scene");Xe(this,"scenes",new Map);Xe(this,"renderer");Xe(this,"renderTargets",new Map);Xe(this,"renderTargetsResize",new Map);Xe(this,"groups",new Map);Xe(this,"_listeners",{});this.name=t}dispose(){var t;this.scenes.forEach(n=>{Mh(n)}),this.scenes.clear(),this.scene&&Mh(this.scene),this.renderTargets.forEach(n=>{n.dispose()}),this.renderTargets.clear(),(t=this.renderer)==null||t.dispose()}addEventListener(t,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(n)===-1&&r[t].push(n)}hasEventListener(t,n){const r=this._listeners;return r===void 0?!1:r[t]!==void 0&&r[t].indexOf(n)!==-1}removeEventListener(t,n){const r=this._listeners;if(r===void 0)return;const s=r[t];if(s!==void 0){const a=s.indexOf(n);a!==-1&&s.splice(a,1)}}dispatchEvent(t){const n=this._listeners;if(n===void 0)return;const r=n[t.type];if(r!==void 0){const s={...t,target:this},a=r.slice(0);for(let c=0,d=a.length;c<d;c++)a[c].call(this,s)}}getObjectByUUID(t){const n=t.split(".")[0],r=this.scenes.get(n);if(r!==void 0)return r.getObjectByProperty("uuid",t)}getObject(t){if(!this.debug)return;this.renderer!==void 0&&(el.renderer=this.renderer);const n=this.getObjectByUUID(t);n&&this.setObject(n)}setObject(t){this.renderer!==void 0&&(el.renderer=this.renderer);const n=fj(t);this.dispatchEvent({type:"ToolEvents::setObject",value:n})}requestMethod(t,n,r,s){const a=this.getObjectByUUID(t);if(a)try{s!==void 0?VBe(a,s)[n](r):a[n](r)}catch(c){console.log("Hermes - Error requesting method:",t,n,r),console.log(c)}}updateObject(t,n,r){this.send({event:"updateObject",target:"app",data:{uuid:t,key:n,value:r}})}createTexture(t,n,r){this.send({event:"createTexture",target:"app",data:{uuid:t,key:n,value:r}})}onUpdateObject(t,n,r){const s=this.getObjectByUUID(t);s&&Ea(s,n,r)}onCreateTexture(t,n,r){const s=this.getObjectByUUID(t);if(s){const a=c=>{const d=n.split(".");switch(d.length){case 1:s[d[0]]=c;break;case 2:s[d[0]][d[1]]=c;break;case 3:s[d[0]][d[1]][d[2]]=c;break;case 4:s[d[0]][d[1]][d[2]][d[3]]=c;break;case 5:s[d[0]][d[1]][d[2]][d[3]][d[4]]=c;break}s.material.needsUpdate=!0};r.src.length>0?oq(r.src).then(c=>{c.offset.set(r.offset[0],r.offset[1]),c.repeat.set(r.repeat[0],r.repeat[1]),a(c)}):a(null)}}addGroup(t){this.groups.get(t.title)===void 0&&(this.groups.set(t.title,{title:t.title,onUpdate:t.onUpdate}),this.send({event:"addGroup",target:"editor",data:JSON.stringify(t)}))}removeGroup(t){this.groups.get(t)!==void 0&&(this.groups.delete(t),this.send({event:"removeGroup",target:"editor",data:t}))}updateGroup(t,n,r){this.send({event:"updateGroup",target:"app",data:JSON.stringify({group:t,prop:n,value:r})})}addSplineCurve(t){setTimeout(()=>{this.send({event:"addSpline",target:"editor",data:JSON.stringify(t.toJSON())})},1)}addSplineObject(t){setTimeout(()=>{this.send({event:"addSpline",target:"editor",data:JSON.stringify(t)})},1)}setRenderer(t,n=null){if(this.renderer=t,this.canvas=t.domElement,this.inputElement=n!==null?n:this.canvas,!this.debug)return;const r=`#${t.getClearColor(new xn).getHexString()}`;this.send({event:"addRenderer",target:"editor",data:{autoClear:t.autoClear,autoClearColor:t.autoClearColor,autoClearDepth:t.autoClearDepth,autoClearStencil:t.autoClearStencil,outputColorSpace:t.outputColorSpace,localClippingEnabled:t.localClippingEnabled,clearColor:r,clearAlpha:t.getClearAlpha(),colorManagement:Xn.enabled,toneMapping:t.toneMapping,toneMappingExposure:t.toneMappingExposure,type:t.isWebGLRenderer?"WebGLRenderer":"WebGPURenderer"}})}updateRenderer(t){this.send({event:"updateRenderer",target:"app",data:t})}addScene(t){if(t===void 0||(this.scenes.set(t.name,t),!this.debug))return;nN(),y2(t);const n=r4(t);this.send({event:"addScene",target:"editor",data:n})}refreshScene(t){if(!this.debug)return;const n=this.scenes.get(t);if(n!==void 0){const r=r4(n);this.send({event:"refreshScene",target:"app",data:r})}}removeScene(t){if(t===void 0||(this.scenes.delete(t.name),!this.debug))return;const n=r4(t);this.send({event:"removeScene",target:"editor",data:n})}removeAllScenes(){this.scenes.forEach(t=>this.removeScene(t))}getScene(t){let n=null;return this.scene!==void 0&&this.scene.uuid.search(t)>-1?this.scene:(this.scenes.forEach((r,s)=>{t.search(s)>-1&&(n=r)}),n)}setScene(t){if(t===void 0||(this.scene=t,!this.debug))return;this.renderer!==void 0&&(el.renderer=this.renderer),nN(),y2(t);const n=r4(t);this.send({event:"setScene",target:"editor",data:n})}requestSize(){this.send({event:"requestSize",target:"app"})}requestRenderer(){this.send({event:"requestRenderer",target:"app"})}requestScene(){this.send({event:"requestScene",target:"app"})}addCamera(t){if(!this.debug)return;const n=fj(t);this.send({event:"addCamera",target:"editor",data:n})}removeCamera(t){if(!this.debug)return;const n=fj(t);this.send({event:"removeCamera",target:"editor",data:n})}handleApp(t){switch(t.event){case"refreshScene":this.send({event:"refreshScene",target:"editor",data:r4(this.scenes.get(t.data.name))});break;case"updateRenderer":this.renderer&&(this.renderer.autoClearColor=t.data.autoClearColor,this.renderer.outputColorSpace=t.data.outputColorSpace,this.renderer.localClippingEnabled=t.data.localClippingEnabled,this.renderer.setClearColor(t.data.clearColor,t.data.clearAlpha),this.renderer.toneMapping=t.data.toneMapping,this.renderer.toneMappingExposure=t.data.toneMappingExposure,Xn.enabled=t.data.colorManagement);break;case"requestRenderer":if(this.renderer!==void 0){const n=`#${this.renderer.getClearColor(new xn).getHexString()}`;this.send({event:"addRenderer",target:"editor",data:{autoClear:this.renderer.autoClear,autoClearColor:this.renderer.autoClearColor,autoClearDepth:this.renderer.autoClearDepth,autoClearStencil:this.renderer.autoClearStencil,outputColorSpace:this.renderer.outputColorSpace,localClippingEnabled:this.renderer.localClippingEnabled,clearColor:n,clearAlpha:this.renderer.getClearAlpha(),colorManagement:Xn.enabled,toneMapping:this.renderer.toneMapping,toneMappingExposure:this.renderer.toneMappingExposure,type:this.renderer.isWebGLRenderer?"WebGLRenderer":"WebGPURenderer"}})}break;case"requestScene":this.scenes.forEach(n=>{nN(),y2(n),this.send({event:"addScene",target:"editor",data:r4(n)})}),this.scene!==void 0&&(this.renderer!==void 0&&(el.renderer=this.renderer),nN(),y2(this.scene),this.send({event:"setScene",target:"editor",data:r4(this.scene)}));break}if(t.event==="updateGroup"){const n=JSON.parse(t.data),r=this.groups.get(n.group);r==null||r.onUpdate(n.prop,n.value)}}handleEditor(t){switch(t.event){case"addScene":this.dispatchEvent({type:"ToolEvents::addScene",value:t.data});break;case"refreshScene":this.dispatchEvent({type:"ToolEvents::refreshScene",value:t.data});break;case"removeScene":this.dispatchEvent({type:"ToolEvents::removeScene",value:t.data});break;case"setScene":this.dispatchEvent({type:"ToolEvents::setScene",value:t.data});break;case"addCamera":this.dispatchEvent({type:"ToolEvents::addCamera",value:t.data});break;case"removeCamera":this.dispatchEvent({type:"ToolEvents::removeCamera",value:t.data});break;case"addGroup":this.dispatchEvent({type:"ToolEvents::addGroup",value:t.data});break;case"removeGroup":this.dispatchEvent({type:"ToolEvents::removeGroup",value:t.data});break;case"addSpline":this.dispatchEvent({type:"ToolEvents::addSpline",value:t.data});break;case"addRenderer":this.dispatchEvent({type:"ToolEvents::addRenderer",value:t.data})}}messageHandler(t){const n=t.data;if(n.event==="updateObject"){this.onUpdateObject(n.data.uuid,n.data.key,n.data.value);return}else if(n.event==="createTexture"){this.onCreateTexture(n.data.uuid,n.data.key,n.data.value);return}else if(n.event==="requestSize"){n.target==="app"?this.send({event:"requestSize",target:"editor",data:{width:this.width,height:this.height}}):this.scenes.forEach(r=>{r.resize!==void 0&&r.resize(n.data.width,n.data.height)});return}n.target==="app"?this.handleApp(n):this.handleEditor(n)}addRT(t,n=!0,r){const s=new Ja(32,32,r);s.texture.name=t,this.renderTargets.set(t,s),this.renderTargetsResize.set(t,n)}removeRT(t){this.renderTargets.delete(t),this.renderTargetsResize.delete(t)}resize(t,n){var a,c;const r=this.dpr;this.renderTargets.forEach((d,p)=>{this.renderTargetsResize.get(p)&&d.setSize(t*r,n*r)});const s=!(((a=this.renderer)==null?void 0:a.domElement)instanceof OffscreenCanvas);(c=this.renderer)==null||c.setSize(t,n,s)}set dpr(t){var n;(n=this.renderer)==null||n.setPixelRatio(F8(1,2,t))}get dpr(){var t;return this.renderer!==void 0?(t=this.renderer)==null?void 0:t.getPixelRatio():1}get width(){return this.renderer!==void 0?this.renderer.domElement.width/this.dpr:0}get height(){return this.renderer!==void 0?this.renderer.domElement.height/this.dpr:0}}function HBe(i){const t=i.app.components.get("theatre");return t.studio=Rve,t.handleEditorApp(),null}function WBe(i){return rt.jsxs("div",{className:"editor",ref:i.ref,style:i.style,children:[rt.jsx("div",{className:"header",children:i.header}),i.children,rt.jsx("div",{className:"footer",children:i.footer})]})}/**
 * @license
 * Copyright 2010-2026 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const qBe=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],pj=new WeakMap;class $Be{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=qBe,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:n,material:r,object:s}=e;if(t={material:this.getMaterialData(r),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexId:n.index?n.index.id:null,indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:s.matrixWorld.clone()},s.center&&(t.center=s.center.clone()),s.morphTargetInfluences&&(t.morphTargetInfluences=s.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:a,height:c}=e.context;t.bufferWidth=a,t.bufferHeight=c}t.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const r=e[n];t[n]={id:r.id,version:r.version}}return t}containsNode(e){const t=e.material;for(const n in t)if(t[n]&&t[n].isNode)return!0;return!!(e.context.modelViewMatrix||e.context.modelNormalViewMatrix||e.context.getAO||e.context.getShadow)}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const r=e[n];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[n]={id:r.id,version:r.version}:t[n]=r.clone():t[n]=r)}return t}equals(e,t){const{object:n,material:r,geometry:s}=e,a=this.getRenderObjectData(e);if(a.worldMatrix.equals(n.matrixWorld)!==!0)return a.worldMatrix.copy(n.matrixWorld),!1;const c=a.material;for(const B in c){const Y=c[B],A=r[B];if(Y.equals!==void 0){if(Y.equals(A)===!1)return Y.copy(A),!1}else if(A.isTexture===!0){if(Y.id!==A.id||Y.version!==A.version)return Y.id=A.id,Y.version=A.version,!1}else if(Y!==A)return c[B]=A,!1}if(c.transmission>0){const{width:B,height:Y}=e.context;if(a.bufferWidth!==B||a.bufferHeight!==Y)return a.bufferWidth=B,a.bufferHeight=Y,!1}const d=a.geometry,p=s.attributes,y=d.attributes,x=Object.keys(y),w=Object.keys(p);if(d.id!==s.id)return d.id=s.id,!1;if(x.length!==w.length)return a.geometry.attributes=this.getAttributesData(p),!1;for(const B of x){const Y=y[B],A=p[B];if(A===void 0)return delete y[B],!1;if(Y.id!==A.id||Y.version!==A.version)return Y.id=A.id,Y.version=A.version,!1}const C=s.index,N=d.indexId,F=d.indexVersion,U=C?C.id:null,R=C?C.version:null;if(N!==U||F!==R)return d.indexId=U,d.indexVersion=R,!1;if(d.drawRange.start!==s.drawRange.start||d.drawRange.count!==s.drawRange.count)return d.drawRange.start=s.drawRange.start,d.drawRange.count=s.drawRange.count,!1;if(a.morphTargetInfluences){let B=!1;for(let Y=0;Y<a.morphTargetInfluences.length;Y++)a.morphTargetInfluences[Y]!==n.morphTargetInfluences[Y]&&(a.morphTargetInfluences[Y]=n.morphTargetInfluences[Y],B=!0);if(B)return!1}if(a.lights){for(let B=0;B<t.length;B++)if(a.lights[B].map!==t[B].map)return!1}return a.center&&a.center.equals(n.center)===!1?(a.center.copy(n.center),!0):(e.bundle!==null&&(a.version=e.bundle.version),!0)}getLightsData(e){const t=[];for(const n of e)n.isSpotLight===!0&&n.map!==null&&t.push({map:n.map.version});return t}getLights(e,t){if(pj.has(e)){const r=pj.get(e);if(r.renderId===t)return r.lightsData}const n=this.getLightsData(e.getLights());return pj.set(e,{renderId:t,lightsData:n}),n}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const r=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;if(r||s)return!1;const a=this.getLights(e.lightsNode,n);return this.equals(e,a)!==!0}}const XBe=[/^StackTrace\.js$/,/^TSLCore\.js$/,/^.*Node\.js$/,/^three\.webgpu.*\.js$/];function YBe(i){const e=/(?:at\s+(.+?)\s+\()?(?:(.+?)@)?([^@\s()]+):(\d+):(\d+)/;return i.split(`
`).map(t=>{const n=t.match(e);if(!n)return null;const r=n[1]||n[2]||"",s=n[3].split("?")[0],a=parseInt(n[4],10),c=parseInt(n[5],10),d=s.split("/").pop();return{fn:r,file:d,line:a,column:c}}).filter(t=>t&&!XBe.some(n=>n.test(t.file)))}class da{constructor(e=null){this.isStackTrace=!0,this.stack=YBe(e||new Error().stack)}getLocation(){if(this.stack.length===0)return"[Unknown location]";const e=this.stack[0],t=e.fn;return`${t?`"${t}()" at `:""}"${e.file}:${e.line}"`}getError(e){if(this.stack.length===0)return e;const t=this.stack.map(n=>{const r=`${n.file}:${n.line}:${n.column}`;return n.fn?`    at ${n.fn} (${r})`:`    at ${r}`}).join(`
`);return`${e}
${t}`}}function aq(i,e=0){let t=3735928559^e,n=1103547991^e;if(i instanceof Array)for(let r=0,s;r<i.length;r++)s=i[r],t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);else for(let r=0,s;r<i.length;r++)s=i.charCodeAt(r),t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}const Xx=i=>aq(i),VE=i=>aq(i),HT=(...i)=>aq(i),KBe=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),w4e=new WeakMap;function w8e(i){return KBe.get(i)}function lk(i){if(/[iu]?vec\d/.test(i))return i.startsWith("ivec")?Int32Array:i.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(i)||/float/.test(i))return Float32Array;if(/uint/.test(i))return Uint32Array;if(/int/.test(i))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${i}`)}function T8e(i){if(/float|int|uint/.test(i))return 1;if(/vec2/.test(i))return 2;if(/vec3/.test(i))return 3;if(/vec4/.test(i)||/mat2/.test(i))return 4;if(/mat3/.test(i))return 9;if(/mat4/.test(i))return 16;jt(`TSL: Unsupported type: ${i}`,new da)}function ZBe(i){if(/float|int|uint/.test(i))return 1;if(/vec2/.test(i))return 2;if(/vec3/.test(i))return 3;if(/vec4/.test(i)||/mat2/.test(i))return 4;if(/mat3/.test(i))return 12;if(/mat4/.test(i))return 16;jt(`TSL: Unsupported type: ${i}`,new da)}function QBe(i){if(/float|int|uint/.test(i))return 4;if(/vec2/.test(i))return 8;if(/vec3/.test(i)||/vec4/.test(i))return 16;if(/mat2/.test(i))return 8;if(/mat3/.test(i)||/mat4/.test(i))return 16;jt(`TSL: Unsupported type: ${i}`,new da)}function f4(i){if(i==null)return null;const e=typeof i;return i.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":i.isVector2===!0?"vec2":i.isVector3===!0?"vec3":i.isVector4===!0?"vec4":i.isMatrix2===!0?"mat2":i.isMatrix3===!0?"mat3":i.isMatrix4===!0?"mat4":i.isColor===!0?"color":i instanceof ArrayBuffer?"ArrayBuffer":null}function lq(i,...e){const t=i?i.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),i==="color"?new xn(...e):t==="vec2"?new vn(...e):t==="vec3"?new _e(...e):t==="vec4"?new wr(...e):t==="mat2"?new $k(...e):t==="mat3"?new Xr(...e):t==="mat4"?new An(...e):i==="bool"?e[0]||!1:i==="float"||i==="int"||i==="uint"?e[0]||0:i==="string"?e[0]||"":i==="ArrayBuffer"?eze(e[0]):null}function E8e(i){let e=w4e.get(i);return e===void 0&&(e={},w4e.set(i,e)),e}function JBe(i){let e="";const t=new Uint8Array(i);for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function eze(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0)).buffer}const DT={VERTEX:"vertex",FRAGMENT:"fragment"},Fr={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},tze={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},sl={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},M8e=["fragment","vertex"],HH=["setup","analyze","generate"],WH=[...M8e,"compute"],y6=["x","y","z","w"],nze={analyze:"setup",generate:"analyze"};let rze=0,Yn=class C8e extends Yl{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Fr.NONE,this.updateBeforeType=Fr.NONE,this.updateAfterType=Fr.NONE,this.uuid=E0.generateUUID(),this.version=0,this.name="",this.global=!1,this.parents=!1,this.isNode=!0,this._beforeNodes=null,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:rze++}),this.stackTrace=null,C8e.captureStackTrace===!0&&(this.stackTrace=new da)}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,Fr.FRAME)}onRenderUpdate(e){return this.onUpdate(e,Fr.RENDER)}onObjectUpdate(e){return this.onUpdate(e,Fr.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of this._getChildren())yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}_getChildren(e=new Set){const t=[];e.add(this);for(const n of Object.getOwnPropertyNames(this)){const r=this[n];if(!(n.startsWith("_")===!0||e.has(r))){if(Array.isArray(r)===!0)for(let s=0;s<r.length;s++){const a=r[s];a&&a.isNode===!0&&t.push({property:n,index:s,childNode:a})}else if(r&&r.isNode===!0)t.push({property:n,childNode:r});else if(r&&Object.getPrototypeOf(r)===Object.prototype)for(const s in r){if(s.startsWith("_")===!0)continue;const a=r[s];a&&a.isNode===!0&&t.push({property:n,index:s,childNode:a})}}}return t}getCacheKey(e=!1,t=null){if(e=e||this.version!==this._cacheKeyVersion,e===!0||this._cacheKey===null){t===null&&(t=new Set);const n=[];for(const{property:r,childNode:s}of this._getChildren(t))n.push(Xx(r.slice(0,-4)),s.getCacheKey(e,t));this._cacheKey=HT(VE(n),this.customCacheKey()),this._cacheKeyVersion=this.version}return this._cacheKey}customCacheKey(){return this.id}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())t["node"+n++]=r;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(this.parents===!0){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(n===1){const r=e.getNodeProperties(this);for(const s of Object.values(r))s&&s.isNode===!0&&s.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&n.isNode===!0)return n.build(e,t)}updateBefore(){Wt("Abstract function.")}updateAfter(){Wt("Abstract function.")}update(){Wt("Abstract function.")}before(e){return this._beforeNodes===null&&(this._beforeNodes=[]),this._beforeNodes.push(e),this}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);if(this._beforeNodes!==null){const d=this._beforeNodes;this._beforeNodes=null;for(const p of d)p.build(e,t);this._beforeNodes=d}const r=e.getDataFromNode(this);r.buildStages=r.buildStages||{},r.buildStages[e.buildStage]=!0;const s=nze[e.buildStage];if(s&&r.buildStages[s]!==!0){const d=e.getBuildStage();e.setBuildStage(s),this.build(e),e.setBuildStage(d)}e.addChain(this);let a=null;const c=e.getBuildStage();if(c==="setup"){e.addNode(this),this.updateReference(e);const d=e.getNodeProperties(this);if(d.initialized!==!0){d.initialized=!0,d.outputNode=this.setup(e)||d.outputNode||null;for(const p of Object.values(d))if(p&&p.isNode===!0){if(p.parents===!0){const y=e.getNodeProperties(p);y.parents=y.parents||[],y.parents.push(this)}p.build(e)}e.addSequentialNode(this)}a=d.outputNode}else if(c==="analyze")this.analyze(e,t);else if(c==="generate"){if(this.generate.length<2){const p=this.getNodeType(e),y=e.getDataFromNode(this);a=y.snippet,a===void 0?y.generated===void 0?(y.generated=!0,a=this.generate(e)||"",y.snippet=a):(Wt("Node: Recursion detected.",this),a="/* Recursion detected. */"):y.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),a=e.format(a,p,t)}else a=this.generate(e,t)||"";a===""&&t!==null&&t!=="void"&&t!=="OutputType"&&(jt(`TSL: Invalid generated code, expected a "${t}".`),a=e.generateConst(t))}return e.removeChain(this),a}getSerializeChildren(){return this._getChildren()}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:s,childNode:a}of t)s!==void 0?(n[r]===void 0&&(n[r]=Number.isInteger(s)?[]:{}),n[r][s]=a.toJSON(e.meta).uuid):n[r]=a.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const s of e.inputNodes[n])r.push(t[s]);this[n]=r}else if(typeof e.inputNodes[n]=="object"){const r={};for(const s in e.inputNodes[n]){const a=e.inputNodes[n][s];r[s]=t[a]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function a(c){const d=[];for(const p in c){const y=c[p];delete y.metadata,d.push(y)}return d}if(r){const c=a(e.textures),d=a(e.images),p=a(e.nodes);c.length>0&&(s.textures=c),d.length>0&&(s.images=d),p.length>0&&(s.nodes=p)}return s}};Yn.captureStackTrace=!1;class _6 extends Yn{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}generate(e){const t=this.indexNode.getNodeType(e),n=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${n}[ ${r} ]`}}class A8e extends Yn{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))(n===null||e.getTypeLength(t)===e.getTypeLength(r))&&(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),s=n.build(e,r);return e.format(s,r,t)}}class Yo extends Yn{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const a=super.build(e,r),c=e.getVarFromNode(this,null,r),d=e.getPropertyName(c);return e.addLineFlowCode(`${d} = ${a}`,this),s.snippet=a,s.propertyName=d,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class ize extends Yo{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),r=e.getTypeLength(n),s=this.nodes,a=e.getComponentType(n),c=[];let d=0;for(const y of s){if(d>=r){jt(`TSL: Length of parameters exceeds maximum length of function '${n}()' type.`,this.stackTrace);break}let x=y.getNodeType(e),w=e.getTypeLength(x),C;if(d+w>r&&(jt(`TSL: Length of '${n}()' data exceeds maximum length of output type.`,this.stackTrace),w=r-d,x=e.getTypeFromLength(w)),d+=w,C=y.build(e,x),e.getComponentType(x)!==a){const F=e.getTypeFromLength(w,a);C=e.format(C,x,F)}c.push(C)}const p=`${e.getType(n)}( ${c.join(", ")} )`;return e.format(p,n,t)}}const sze=y6.join("");class P8e extends Yn{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(y6.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let s=null;if(r>1){let a=null;this.getVectorLength()>=r&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const d=n.build(e,a);this.components.length===r&&this.components===sze.slice(0,this.components.length)?s=e.format(d,a,t):s=e.format(`${d}.${this.components}`,this.getNodeType(e),t)}else s=n.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class oze extends Yo{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,s=this.getNodeType(e),a=e.getComponentType(r.getNodeType(e)),c=e.getTypeFromLength(n.length,a),d=r.build(e,c),p=t.build(e,s),y=e.getTypeLength(s),x=[];for(let w=0;w<y;w++){const C=y6[w];C===n[0]?(x.push(d),w+=n.length-1):x.push(p+"."+C)}return`${e.getType(s)}( ${x.join(", ")} )`}}class aze extends Yo{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),s=n.build(e),a=e.getVarFromNode(this),c=e.getPropertyName(a);e.addLineFlowCode(c+" = "+s,this);const d=e.getTypeLength(r),p=[];let y=0;for(let x=0;x<d;x++){const w=y6[x];w===t[y]?(p.push("1.0 - "+(c+"."+w)),y++):p.push(c+"."+w)}return`${e.getType(r)}( ${p.join(", ")} )`}}class cq extends Yn{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?f4(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=f4(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=JBe(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?lq(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){Wt("Abstract function.")}}const T4e=/float|u?int/;class Ih extends cq{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return T4e.test(n)&&T4e.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class lze extends Yn{static get type(){return"MemberNode"}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}hasMember(e){return this.structNode.isMemberNode&&this.structNode.hasMember(e)===!1?!1:this.structNode.getMemberType(e,this.property)!=="void"}getNodeType(e){return this.hasMember(e)===!1?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(this.hasMember(e)===!1)return"float";const n=this.getNodeType(e);return e.getStructTypeNode(n).getMemberType(e,t)}generate(e){if(this.hasMember(e)===!1){Wt(`TSL: Member "${this.property}" does not exist in struct.`,this.stackTrace);const n=this.getNodeType(e);return e.generateConst(n)}return this.structNode.build(e)+"."+this.property}}let P4=null;const qH=new Map;function Ut(i,e){if(qH.has(i)){Wt(`TSL: Redefinition of method chaining '${i}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${i} is not a function`);qH.set(i,e),i!=="assign"&&(Yn.prototype[i]=function(...t){return this.isStackNode?this.addToStack(e(...t)):e(this,...t)},Yn.prototype[i+"Assign"]=function(...t){return this.isStackNode?this.assign(t[0],e(...t)):this.assign(e(this,...t))})}const cze=i=>i.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),E4e=i=>cze(i).split("").sort().join("");Yn.prototype.assign=function(...i){if(this.isStackNode!==!0)return P4!==null?P4.assign(this,...i):jt("TSL: No stack defined for assign operation. Make sure the assign is inside a Fn().",new da),this;{const e=qH.get("assign");return this.addToStack(e(...i))}};Yn.prototype.toVarIntent=function(){return this};Yn.prototype.get=function(i){return new lze(this,i)};const WT={};function rN(i,e,t){WT[i]=WT[e]=WT[t]={get(){this._cache=this._cache||{};let a=this._cache[i];return a===void 0&&(a=new P8e(this,i),this._cache[i]=a),a},set(a){this[i].assign(qn(a))}};const n=i.toUpperCase(),r=e.toUpperCase(),s=t.toUpperCase();Yn.prototype["set"+n]=Yn.prototype["set"+r]=Yn.prototype["set"+s]=function(a){const c=E4e(i);return new oze(this,c,qn(a))},Yn.prototype["flip"+n]=Yn.prototype["flip"+r]=Yn.prototype["flip"+s]=function(){const a=E4e(i);return new aze(this,a)}}const U1=["x","y","z","w"],B1=["r","g","b","a"],z1=["s","t","p","q"];for(let i=0;i<4;i++){let e=U1[i],t=B1[i],n=z1[i];rN(e,t,n);for(let r=0;r<4;r++){e=U1[i]+U1[r],t=B1[i]+B1[r],n=z1[i]+z1[r],rN(e,t,n);for(let s=0;s<4;s++){e=U1[i]+U1[r]+U1[s],t=B1[i]+B1[r]+B1[s],n=z1[i]+z1[r]+z1[s],rN(e,t,n);for(let a=0;a<4;a++)e=U1[i]+U1[r]+U1[s]+U1[a],t=B1[i]+B1[r]+B1[s]+B1[a],n=z1[i]+z1[r]+z1[s]+z1[a],rN(e,t,n)}}}for(let i=0;i<32;i++)WT[i]={get(){this._cache=this._cache||{};let e=this._cache[i];return e===void 0&&(e=new _6(this,new Ih(i,"uint")),this._cache[i]=e),e},set(e){this[i].assign(qn(e))}};Object.defineProperties(Yn.prototype,WT);const M4e=new WeakMap,uze=function(i,e=null){const t=f4(i);return t==="node"?i:e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string"?qn($H(i,e)):t==="shader"?i.isFn?i:We(i):i},dze=function(i,e=null){for(const t in i)i[t]=qn(i[t],e);return i},hze=function(i,e=null){const t=i.length;for(let n=0;n<t;n++)i[n]=qn(i[n],e);return i},R8e=function(i,e=null,t=null,n=null){function r(y){return n!==null?(y=qn(Object.assign(y,n)),n.intent===!0&&(y=y.toVarIntent())):y=qn(y),y}let s,a=e,c,d;function p(y){let x;return a?x=/[a-z]/i.test(a)?a+"()":a:x=i.type,c!==void 0&&y.length<c?(jt(`TSL: "${x}" parameter length is less than minimum required.`,new da),y.concat(new Array(c-y.length).fill(0))):d!==void 0&&y.length>d?(jt(`TSL: "${x}" parameter length exceeds limit.`,new da),y.slice(0,d)):y}return e===null?s=(...y)=>r(new i(...J8(p(y)))):t!==null?(t=qn(t),s=(...y)=>r(new i(e,...J8(p(y)),t))):s=(...y)=>r(new i(e,...J8(p(y)))),s.setParameterLength=(...y)=>(y.length===1?c=d=y[0]:y.length===2&&([c,d]=y),s),s.setName=y=>(a=y,s),s},fze=function(i,...e){return new i(...J8(e))};class pze extends Yn{constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getElementType(e){return this.getOutputNode(e).getElementType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,rawInputs:n}=this,r=e.getNodeProperties(t),s=e.getClosestSubBuild(t.subBuilds)||"",a=s||"default";if(r[a])return r[a];const c=e.subBuildFn,d=e.fnCall;e.subBuildFn=s,e.fnCall=this;let p=null;if(t.layout){let y=M4e.get(e.constructor);y===void 0&&(y=new WeakMap,M4e.set(e.constructor,y));let x=y.get(t);x===void 0&&(x=qn(e.buildFunctionNode(t)),y.set(t,x)),e.addInclude(x);const w=n?mze(n):null;p=qn(x.call(w))}else{const y=new Proxy(e,{get:(F,U,R)=>{let B;return Symbol.iterator===U?B=function*(){yield void 0}:B=Reflect.get(F,U,R),B}}),x=n?gze(n):null,w=Array.isArray(n)?n.length>0:n!==null,C=t.jsFunc,N=w||C.length>1?C(x,y):C(y);p=qn(N)}return e.subBuildFn=c,e.fnCall=d,t.once&&(r[a]=p),p}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getSubBuildOutput(this);return t[n]=t[n]||this.setupOutput(e),t[n].subBuild=e.getClosestSubBuild(this),t[n]}build(e,t=null){let n=null;const r=e.getBuildStage(),s=e.getNodeProperties(this),a=e.getSubBuildOutput(this),c=this.getOutputNode(e),d=e.fnCall;if(e.fnCall=this,r==="setup"){const p=e.getSubBuildProperty("initialized",this);if(s[p]!==!0&&(s[p]=!0,s[a]=this.getOutputNode(e),s[a].build(e),this.shaderNode.subBuilds))for(const y of e.chaining){const x=e.getDataFromNode(y,"any");x.subBuilds=x.subBuilds||new Set;for(const w of this.shaderNode.subBuilds)x.subBuilds.add(w)}n=s[a]}else r==="analyze"?c.build(e,t):r==="generate"&&(n=c.build(e,t)||"");return e.fnCall=d,n}}function mze(i){let e;return Qk(i),i[0]&&(i[0].isNode||Object.getPrototypeOf(i[0])!==Object.prototype)?e=[...i]:e=i[0],e}function gze(i){let e=0;return Qk(i),new Proxy(i,{get:(t,n,r)=>{let s;if(n==="length")return s=i.length,s;if(Symbol.iterator===n)s=function*(){for(const a of i)yield qn(a)};else{if(i.length>0)if(Object.getPrototypeOf(i[0])===Object.prototype){const a=i[0];a[n]===void 0?s=a[e++]:s=Reflect.get(a,n,r)}else i[0]instanceof Yn&&(i[n]===void 0?s=i[e++]:s=Reflect.get(i,n,r));else s=Reflect.get(t,n,r);s=qn(s)}return s}})}class vze extends Yn{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}getLayout(){return this.layout}call(e=null){return new pze(this,e)}setup(){return this.call()}}const yze=[!1,!0],_ze=[0,1,2,3],xze=[-1,-2],I8e=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],uq=new Map;for(const i of yze)uq.set(i,new Ih(i));const dq=new Map;for(const i of _ze)dq.set(i,new Ih(i,"uint"));const hq=new Map([...dq].map(i=>new Ih(i.value,"int")));for(const i of xze)hq.set(i,new Ih(i,"int"));const Kk=new Map([...hq].map(i=>new Ih(i.value)));for(const i of I8e)Kk.set(i,new Ih(i));for(const i of I8e)Kk.set(-i,new Ih(-i));const Zk={bool:uq,uint:dq,ints:hq,float:Kk},C4e=new Map([...uq,...Kk]),$H=(i,e)=>C4e.has(i)?C4e.get(i):i.isNode===!0?i:new Ih(i,e),Va=function(i,e=null){return(...t)=>{for(const r of t)if(r===void 0)return jt(`TSL: Invalid parameter for the type "${i}".`,new da),new Ih(0,i);if((t.length===0||!["bool","float","int","uint"].includes(i)&&t.every(r=>{const s=typeof r;return s!=="object"&&s!=="function"}))&&(t=[lq(i,...t)]),t.length===1&&e!==null&&e.has(t[0]))return OT(e.get(t[0]));if(t.length===1){const r=$H(t[0],i);return r.nodeType===i?OT(r):OT(new A8e(r,i))}const n=t.map(r=>$H(r));return OT(new ize(n,i))}},bE=i=>typeof i=="object"&&i!==null?i.value:i,N8e=i=>i!=null?i.nodeType||i.convertTo||(typeof i=="string"?i:null):null;function q_(i,e){return new vze(i,e)}const qn=(i,e=null)=>uze(i,e),OT=(i,e=null)=>qn(i,e).toVarIntent(),Qk=(i,e=null)=>new dze(i,e),J8=(i,e=null)=>new hze(i,e),Yr=(i,e=null,t=null,n=null)=>new R8e(i,e,t,n),En=(i,...e)=>new fze(i,...e),sn=(i,e=null,t=null,n={})=>new R8e(i,e,t,{...n,intent:!0});let bze=0;class Sze extends Yn{constructor(e,t=null){super();let n=null;t!==null&&(typeof t=="object"?n=t.return:(typeof t=="string"?n=t:jt("TSL: Invalid layout type.",new da),t=null)),this.shaderNode=new q_(e,n),t!==null&&this.setLayout(t),this.isFn=!0}setLayout(e){const t=this.shaderNode.nodeType;if(typeof e.inputs!="object"){const n={name:"fn"+bze++,type:t,inputs:[]};for(const r in e)r!=="return"&&n.inputs.push({name:r,type:e[r]});e=n}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const t=this.shaderNode.call(e);return this.shaderNode.nodeType==="void"&&t.toStack(),t.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const t=this.getNodeType(e);return jt('TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".',this.stackTrace),e.generateConst(t)}}function We(i,e=null){const t=new Sze(i,e);return new Proxy(()=>{},{apply(n,r,s){return t.call(...s)},get(n,r,s){return Reflect.get(t,r,s)},set(n,r,s,a){return Reflect.set(t,r,s,a)}})}const SE=i=>{P4=i},fq=()=>P4,gr=(...i)=>P4.If(...i),wze=(...i)=>P4.Switch(...i);function Jk(i){return P4&&P4.addToStack(i),i}Ut("toStack",Jk);const k8e=new Va("color"),xe=new Va("float",Zk.float),Fe=new Va("int",Zk.ints),Zt=new Va("uint",Zk.uint),Ch=new Va("bool",Zk.bool),en=new Va("vec2"),La=new Va("ivec2"),pq=new Va("uvec2"),D8e=new Va("bvec2"),Ve=new Va("vec3"),mq=new Va("ivec3"),x6=new Va("uvec3"),gq=new Va("bvec3"),hr=new Va("vec4"),vq=new Va("ivec4"),yq=new Va("uvec4"),O8e=new Va("bvec4"),eD=new Va("mat2"),P0=new Va("mat3"),b4=new Va("mat4"),Tze=(i="")=>new Ih(i,"string"),Eze=i=>new Ih(i,"ArrayBuffer");Ut("toColor",k8e);Ut("toFloat",xe);Ut("toInt",Fe);Ut("toUint",Zt);Ut("toBool",Ch);Ut("toVec2",en);Ut("toIVec2",La);Ut("toUVec2",pq);Ut("toBVec2",D8e);Ut("toVec3",Ve);Ut("toIVec3",mq);Ut("toUVec3",x6);Ut("toBVec3",gq);Ut("toVec4",hr);Ut("toIVec4",vq);Ut("toUVec4",yq);Ut("toBVec4",O8e);Ut("toMat2",eD);Ut("toMat3",P0);Ut("toMat4",b4);const L8e=Yr(_6).setParameterLength(2),F8e=(i,e)=>new A8e(qn(i),e),Mze=(i,e)=>new P8e(qn(i),e);Ut("element",L8e);Ut("convert",F8e);const Cze=i=>(Wt("TSL: append() has been renamed to Stack().",new da),Jk(i));Ut("append",i=>(Wt("TSL: .append() has been renamed to .toStack().",new da),Jk(i)));class rs extends Yn{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}customCacheKey(){return Xx(this.type+":"+(this.name||"")+":"+(this.varying?"1":"0"))}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const b2=(i,e)=>new rs(i,e),wE=(i,e)=>new rs(i,e,!0),vs=En(rs,"vec4","DiffuseColor"),V8=En(rs,"vec3","DiffuseContribution"),XH=En(rs,"vec3","EmissiveColor"),J1=En(rs,"float","Roughness"),_2=En(rs,"float","Metalness"),ck=En(rs,"float","Clearcoat"),ex=En(rs,"float","ClearcoatRoughness"),vd=En(rs,"vec3","Sheen"),o4=En(rs,"float","SheenRoughness"),tD=En(rs,"float","Iridescence"),uk=En(rs,"float","IridescenceIOR"),dk=En(rs,"float","IridescenceThickness"),hk=En(rs,"float","AlphaT"),s4=En(rs,"float","Anisotropy"),qT=En(rs,"vec3","AnisotropyT"),e6=En(rs,"vec3","AnisotropyB"),R4=En(rs,"color","SpecularColor"),$8=En(rs,"color","SpecularColorBlended"),X8=En(rs,"float","SpecularF90"),fk=En(rs,"float","Shininess"),tx=En(rs,"vec4","Output"),$N=En(rs,"float","dashSize"),YH=En(rs,"float","gapSize"),Aze=En(rs,"float","pointWidth"),$T=En(rs,"float","IOR"),pk=En(rs,"float","Transmission"),_q=En(rs,"float","Thickness"),xq=En(rs,"float","AttenuationDistance"),bq=En(rs,"color","AttenuationColor"),Sq=En(rs,"float","Dispersion");class U8e extends Yn{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const B8e=i=>new U8e(i),nD=(i,e=0)=>new U8e(i,!0,e),z8e=nD("frame"),cr=nD("render"),wq=B8e("object");class GE extends cq{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=wq}setName(e){return this.name=e,this}label(e){return Wt('TSL: "label()" has been deprecated. Use "setName()" instead.',new da),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(n=>{const r=e(n,this);r!==void 0&&(this.value=r)},t)}getInputType(e){let t=super.getInputType(e);return t==="bool"&&(t="uint"),t}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let s=e.getNodeFromHash(r);s===void 0&&(e.setHashNode(this,r),s=this);const a=s.getInputType(e),c=e.getUniformFromNode(s,a,e.shaderStage,this.name||e.context.nodeName),d=e.getPropertyName(c);e.context.nodeName!==void 0&&delete e.context.nodeName;let p=d;if(n==="bool"){const y=e.getDataFromNode(this);let x=y.propertyName;if(x===void 0){const w=e.getVarFromNode(this,null,"bool");x=e.getPropertyName(w),y.propertyName=x,p=e.format(d,a,n),e.addLineFlowCode(`${x} = ${p}`,this)}p=x}return e.format(p,n,t)}}const rr=(i,e)=>{const t=N8e(e||i);if(t===i&&(i=lq(t)),i&&i.isNode===!0){let n=i.value;i.traverse(r=>{r.isConstNode===!0&&(n=r.value)}),i=n}return new GE(i,t)};class A4e extends Yo{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return this.nodeType===null?this.values[0].getNodeType(e):this.nodeType}getElementType(e){return this.getNodeType(e)}getMemberType(e,t){return this.nodeType===null?this.values[0].getMemberType(e,t):super.getMemberType(e,t)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const V8e=(...i)=>{let e;if(i.length===1){const t=i[0];e=new A4e(null,t.length,t)}else{const t=i[0],n=i[1];e=new A4e(t,n)}return qn(e)};Ut("toArray",(i,e)=>V8e(Array(e).fill(i)));class Pze extends Yo{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return y6.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,r=t.getScope(),s=e.getDataFromNode(r);s.assign=!0;const a=e.getNodeProperties(this);a.sourceNode=n,a.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:r}=e.getNodeProperties(this),s=this.needsSplitAssign(e),a=n.build(e),c=n.getNodeType(e),d=r.build(e,c),p=r.getNodeType(e),y=e.getDataFromNode(this);let x;if(y.initialized===!0)t!=="void"&&(x=a);else if(s){const w=e.getVarFromNode(this,null,c),C=e.getPropertyName(w);e.addLineFlowCode(`${C} = ${d}`,this);const N=n.node,U=N.node.context({assign:!0}).build(e);for(let R=0;R<N.components.length;R++){const B=N.components[R];e.addLineFlowCode(`${U}.${B} = ${C}[ ${R} ]`,this)}t!=="void"&&(x=a)}else x=`${a} = ${d}`,(t==="void"||p==="void")&&(e.addLineFlowCode(x,this),t!=="void"&&(x=a));return y.initialized=!0,e.format(x,c,t)}}const G8e=Yr(Pze).setParameterLength(2);Ut("assign",G8e);class Rze extends Yo{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),s=this.parameters,a=(d,p)=>{const y=p.type,x=y==="pointer";let w;return x?w="&"+d.build(e):w=d.build(e,y),w};if(Array.isArray(s)){if(s.length>r.length)jt("TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),s.length=r.length;else if(s.length<r.length)for(jt("TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");s.length<r.length;)s.push(xe(0));for(let d=0;d<s.length;d++)t.push(a(s[d],r[d]))}else for(const d of r){const p=s[d.name];p!==void 0?t.push(a(p,d)):(jt(`TSL: Input '${d.name}' not found in 'Fn()'.`),t.push(a(xe(0),d)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}const j8e=(i,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?J8(e):Qk(e[0]),new Rze(qn(i),e));Ut("call",j8e);const Ize={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class Ro extends Yo{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let s=new Ro(e,t,n);for(let a=0;a<r.length-1;a++)s=new Ro(e,s,r[a]);t=s,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(Ize[this.op],t)}getNodeType(e,t=null){const n=this.op,r=this.aNode,s=this.bNode,a=r.getNodeType(e),c=s?s.getNodeType(e):null;if(a==="void"||c==="void")return t||"void";if(n==="%")return a;if(n==="~"||n==="&"||n==="|"||n==="^"||n===">>"||n==="<<")return e.getIntegerType(a);if(n==="!"||n==="&&"||n==="||"||n==="^^")return"bool";if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">="){const d=Math.max(e.getTypeLength(a),e.getTypeLength(c));return d>1?`bvec${d}`:"bool"}else{if(e.isMatrix(a)){if(c==="float")return a;if(e.isVector(c))return e.getVectorFromMatrix(a);if(e.isMatrix(c))return a}else if(e.isMatrix(c)){if(a==="float")return c;if(e.isVector(a))return e.getVectorFromMatrix(c)}return e.getTypeLength(c)>e.getTypeLength(a)?c:a}}generate(e,t){const n=this.op,{aNode:r,bNode:s}=this,a=this.getNodeType(e,t);let c=null,d=null;a!=="void"?(c=r.getNodeType(e),d=s?s.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="||n==="!="?e.isVector(c)?d=c:e.isVector(d)?c=d:c!==d&&(c=d="float"):n===">>"||n==="<<"?(c=a,d=e.changeComponentType(d,"uint")):n==="%"?(c=a,d=e.isInteger(c)&&e.isInteger(d)?d:c):e.isMatrix(c)?d==="float"?d="float":e.isVector(d)?d=e.getVectorFromMatrix(c):e.isMatrix(d)||(c=d=a):e.isMatrix(d)?c==="float"?c="float":e.isVector(c)?c=e.getVectorFromMatrix(d):c=d=a:c=d=a):c=d=a;const p=r.build(e,c),y=s?s.build(e,d):null,x=e.getFunctionOperator(n);if(t!=="void"){const w=e.renderer.coordinateSystem===ql;if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">=")return w?e.isVector(c)?e.format(`${this.getOperatorMethod(e,t)}( ${p}, ${y} )`,a,t):e.format(`( ${p} ${n} ${y} )`,a,t):e.format(`( ${p} ${n} ${y} )`,a,t);if(n==="%")return e.isInteger(d)?e.format(`( ${p} % ${y} )`,a,t):e.format(`${this.getOperatorMethod(e,a)}( ${p}, ${y} )`,a,t);if(n==="!"||n==="~")return e.format(`(${n}${p})`,c,t);if(x)return e.format(`${x}( ${p}, ${y} )`,a,t);if(e.isMatrix(c)&&d==="float")return e.format(`( ${y} ${n} ${p} )`,a,t);if(c==="float"&&e.isMatrix(d))return e.format(`${p} ${n} ${y}`,a,t);{let C=`( ${p} ${n} ${y} )`;return!w&&a==="bool"&&e.isVector(c)&&e.isVector(d)&&(C=`all${C}`),e.format(C,a,t)}}else if(c!=="void")return x?e.format(`${x}( ${p}, ${y} )`,a,t):e.isMatrix(c)&&d==="float"?e.format(`${y} ${n} ${p}`,a,t):e.format(`${p} ${n} ${y}`,a,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Ca=sn(Ro,"+").setParameterLength(2,1/0).setName("add"),Ri=sn(Ro,"-").setParameterLength(2,1/0).setName("sub"),Ur=sn(Ro,"*").setParameterLength(2,1/0).setName("mul"),wd=sn(Ro,"/").setParameterLength(2,1/0).setName("div"),jE=sn(Ro,"%").setParameterLength(2).setName("mod"),H8e=sn(Ro,"==").setParameterLength(2).setName("equal"),W8e=sn(Ro,"!=").setParameterLength(2).setName("notEqual"),q8e=sn(Ro,"<").setParameterLength(2).setName("lessThan"),Tq=sn(Ro,">").setParameterLength(2).setName("greaterThan"),$8e=sn(Ro,"<=").setParameterLength(2).setName("lessThanEqual"),X8e=sn(Ro,">=").setParameterLength(2).setName("greaterThanEqual"),Y8e=sn(Ro,"&&").setParameterLength(2,1/0).setName("and"),K8e=sn(Ro,"||").setParameterLength(2,1/0).setName("or"),Z8e=sn(Ro,"!").setParameterLength(1).setName("not"),Q8e=sn(Ro,"^^").setParameterLength(2).setName("xor"),J8e=sn(Ro,"&").setParameterLength(2).setName("bitAnd"),e6e=sn(Ro,"~").setParameterLength(1).setName("bitNot"),t6e=sn(Ro,"|").setParameterLength(2).setName("bitOr"),n6e=sn(Ro,"^").setParameterLength(2).setName("bitXor"),r6e=sn(Ro,"<<").setParameterLength(2).setName("shiftLeft"),i6e=sn(Ro,">>").setParameterLength(2).setName("shiftRight"),s6e=We(([i])=>(i.addAssign(1),i)),o6e=We(([i])=>(i.subAssign(1),i)),a6e=We(([i])=>{const e=Fe(i).toConst();return i.addAssign(1),e}),l6e=We(([i])=>{const e=Fe(i).toConst();return i.subAssign(1),e});Ut("add",Ca);Ut("sub",Ri);Ut("mul",Ur);Ut("div",wd);Ut("mod",jE);Ut("equal",H8e);Ut("notEqual",W8e);Ut("lessThan",q8e);Ut("greaterThan",Tq);Ut("lessThanEqual",$8e);Ut("greaterThanEqual",X8e);Ut("and",Y8e);Ut("or",K8e);Ut("not",Z8e);Ut("xor",Q8e);Ut("bitAnd",J8e);Ut("bitNot",e6e);Ut("bitOr",t6e);Ut("bitXor",n6e);Ut("shiftLeft",r6e);Ut("shiftRight",i6e);Ut("incrementBefore",s6e);Ut("decrementBefore",o6e);Ut("increment",a6e);Ut("decrement",l6e);const c6e=(i,e)=>(Wt('TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.',new da),jE(Fe(i),Fe(e)));Ut("modInt",c6e);class gt extends Yo{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){if(super(),(e===gt.MAX||e===gt.MIN)&&arguments.length>3){let s=new gt(e,t,n);for(let a=2;a<arguments.length-1;a++)s=new gt(e,s,arguments[a]);t=s,n=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),a=e.isMatrix(n)?0:e.getTypeLength(n),c=e.isMatrix(r)?0:e.getTypeLength(r);return s>a&&s>c?t:a>c?n:c>s?r:t}getNodeType(e){const t=this.method;return t===gt.LENGTH||t===gt.DISTANCE||t===gt.DOT?"float":t===gt.CROSS?"vec3":t===gt.ALL||t===gt.ANY?"bool":t===gt.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:r}=this;let s=null;if(r===gt.ONE_MINUS)s=Ri(1,t);else if(r===gt.RECIPROCAL)s=wd(1,t);else if(r===gt.DIFFERENCE)s=Vs(Ri(t,n));else if(r===gt.TRANSFORM_DIRECTION){let a=t,c=n;e.isMatrix(a.getNodeType(e))?c=hr(Ve(c),0):a=hr(Ve(a),0);const d=Ur(a,c).xyz;s=Au(d)}return s!==null?s:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const s=this.getNodeType(e),a=this.getInputType(e),c=this.aNode,d=this.bNode,p=this.cNode,y=e.renderer.coordinateSystem;if(r===gt.NEGATE)return e.format("( - "+c.build(e,a)+" )",s,t);{const x=[];return r===gt.CROSS?x.push(c.build(e,s),d.build(e,s)):y===ql&&r===gt.STEP?x.push(c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":a),d.build(e,a)):y===ql&&(r===gt.MIN||r===gt.MAX)?x.push(c.build(e,a),d.build(e,e.getTypeLength(d.getNodeType(e))===1?"float":a)):r===gt.REFRACT?x.push(c.build(e,a),d.build(e,a),p.build(e,"float")):r===gt.MIX?x.push(c.build(e,a),d.build(e,a),p.build(e,e.getTypeLength(p.getNodeType(e))===1?"float":a)):(y===Sd&&r===gt.ATAN&&d!==null&&(r="atan2"),e.shaderStage!=="fragment"&&(r===gt.DFDX||r===gt.DFDY)&&(Wt(`TSL: '${r}' is not supported in the ${e.shaderStage} stage.`,this.stackTrace),r="/*"+r+"*/"),x.push(c.build(e,a)),d!==null&&x.push(d.build(e,a)),p!==null&&x.push(p.build(e,a))),e.format(`${e.getMethod(r,s)}( ${x.join(", ")} )`,s,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}gt.ALL="all";gt.ANY="any";gt.RADIANS="radians";gt.DEGREES="degrees";gt.EXP="exp";gt.EXP2="exp2";gt.LOG="log";gt.LOG2="log2";gt.SQRT="sqrt";gt.INVERSE_SQRT="inversesqrt";gt.FLOOR="floor";gt.CEIL="ceil";gt.NORMALIZE="normalize";gt.FRACT="fract";gt.SIN="sin";gt.COS="cos";gt.TAN="tan";gt.ASIN="asin";gt.ACOS="acos";gt.ATAN="atan";gt.ABS="abs";gt.SIGN="sign";gt.LENGTH="length";gt.NEGATE="negate";gt.ONE_MINUS="oneMinus";gt.DFDX="dFdx";gt.DFDY="dFdy";gt.ROUND="round";gt.RECIPROCAL="reciprocal";gt.TRUNC="trunc";gt.FWIDTH="fwidth";gt.TRANSPOSE="transpose";gt.DETERMINANT="determinant";gt.INVERSE="inverse";gt.EQUALS="equals";gt.MIN="min";gt.MAX="max";gt.STEP="step";gt.REFLECT="reflect";gt.DISTANCE="distance";gt.DIFFERENCE="difference";gt.DOT="dot";gt.CROSS="cross";gt.POW="pow";gt.TRANSFORM_DIRECTION="transformDirection";gt.MIX="mix";gt.CLAMP="clamp";gt.REFRACT="refract";gt.SMOOTHSTEP="smoothstep";gt.FACEFORWARD="faceforward";const Eq=xe(1e-6),Nze=xe(1e6),mk=xe(Math.PI),kze=xe(Math.PI*2),Dze=xe(Math.PI*2),Oze=xe(Math.PI*.5),u6e=sn(gt,gt.ALL).setParameterLength(1),d6e=sn(gt,gt.ANY).setParameterLength(1),h6e=sn(gt,gt.RADIANS).setParameterLength(1),f6e=sn(gt,gt.DEGREES).setParameterLength(1),Mq=sn(gt,gt.EXP).setParameterLength(1),kx=sn(gt,gt.EXP2).setParameterLength(1),rD=sn(gt,gt.LOG).setParameterLength(1),sm=sn(gt,gt.LOG2).setParameterLength(1),Lc=sn(gt,gt.SQRT).setParameterLength(1),Cq=sn(gt,gt.INVERSE_SQRT).setParameterLength(1),om=sn(gt,gt.FLOOR).setParameterLength(1),iD=sn(gt,gt.CEIL).setParameterLength(1),Au=sn(gt,gt.NORMALIZE).setParameterLength(1),sp=sn(gt,gt.FRACT).setParameterLength(1),Nc=sn(gt,gt.SIN).setParameterLength(1),Kf=sn(gt,gt.COS).setParameterLength(1),p6e=sn(gt,gt.TAN).setParameterLength(1),m6e=sn(gt,gt.ASIN).setParameterLength(1),Aq=sn(gt,gt.ACOS).setParameterLength(1),Pq=sn(gt,gt.ATAN).setParameterLength(1,2),Vs=sn(gt,gt.ABS).setParameterLength(1),Rq=sn(gt,gt.SIGN).setParameterLength(1),am=sn(gt,gt.LENGTH).setParameterLength(1),Iq=sn(gt,gt.NEGATE).setParameterLength(1),g6e=sn(gt,gt.ONE_MINUS).setParameterLength(1),Nq=sn(gt,gt.DFDX).setParameterLength(1),kq=sn(gt,gt.DFDY).setParameterLength(1),v6e=sn(gt,gt.ROUND).setParameterLength(1),y6e=sn(gt,gt.RECIPROCAL).setParameterLength(1),Dq=sn(gt,gt.TRUNC).setParameterLength(1),Oq=sn(gt,gt.FWIDTH).setParameterLength(1),_6e=sn(gt,gt.TRANSPOSE).setParameterLength(1),x6e=sn(gt,gt.DETERMINANT).setParameterLength(1),b6e=sn(gt,gt.INVERSE).setParameterLength(1),Pu=sn(gt,gt.MIN).setParameterLength(2,1/0),Io=sn(gt,gt.MAX).setParameterLength(2,1/0),Dx=sn(gt,gt.STEP).setParameterLength(2),S6e=sn(gt,gt.REFLECT).setParameterLength(2),w6e=sn(gt,gt.DISTANCE).setParameterLength(2),T6e=sn(gt,gt.DIFFERENCE).setParameterLength(2),Ah=sn(gt,gt.DOT).setParameterLength(2),T2=sn(gt,gt.CROSS).setParameterLength(2),Sh=sn(gt,gt.POW).setParameterLength(2),Lq=i=>Ur(i,i),E6e=i=>Ur(i,i,i),Fq=i=>Ur(i,i,i,i),M6e=sn(gt,gt.TRANSFORM_DIRECTION).setParameterLength(2),C6e=i=>Ur(Rq(i),Sh(Vs(i),1/3)),Uq=i=>Ah(i,i),Ei=sn(gt,gt.MIX).setParameterLength(3),op=(i,e=0,t=1)=>new gt(gt.CLAMP,qn(i),qn(e),qn(t)),sD=i=>op(i),Bq=sn(gt,gt.REFRACT).setParameterLength(3),ap=sn(gt,gt.SMOOTHSTEP).setParameterLength(3),zq=sn(gt,gt.FACEFORWARD).setParameterLength(3),A6e=We(([i])=>{const n=43758.5453,r=Ah(i.xy,en(12.9898,78.233)),s=jE(r,mk);return sp(Nc(s).mul(n))}),P6e=(i,e,t)=>Ei(e,t,i),R6e=(i,e,t)=>ap(e,t,i),I6e=(i,e)=>Dx(e,i),Lze=zq,Fze=Cq;Ut("all",u6e);Ut("any",d6e);Ut("radians",h6e);Ut("degrees",f6e);Ut("exp",Mq);Ut("exp2",kx);Ut("log",rD);Ut("log2",sm);Ut("sqrt",Lc);Ut("inverseSqrt",Cq);Ut("floor",om);Ut("ceil",iD);Ut("normalize",Au);Ut("fract",sp);Ut("sin",Nc);Ut("cos",Kf);Ut("tan",p6e);Ut("asin",m6e);Ut("acos",Aq);Ut("atan",Pq);Ut("abs",Vs);Ut("sign",Rq);Ut("length",am);Ut("lengthSq",Uq);Ut("negate",Iq);Ut("oneMinus",g6e);Ut("dFdx",Nq);Ut("dFdy",kq);Ut("round",v6e);Ut("reciprocal",y6e);Ut("trunc",Dq);Ut("fwidth",Oq);Ut("min",Pu);Ut("max",Io);Ut("step",I6e);Ut("reflect",S6e);Ut("distance",w6e);Ut("dot",Ah);Ut("cross",T2);Ut("pow",Sh);Ut("pow2",Lq);Ut("pow3",E6e);Ut("pow4",Fq);Ut("transformDirection",M6e);Ut("mix",P6e);Ut("clamp",op);Ut("refract",Bq);Ut("smoothstep",R6e);Ut("faceForward",zq);Ut("difference",T6e);Ut("saturate",sD);Ut("cbrt",C6e);Ut("transpose",_6e);Ut("determinant",x6e);Ut("inverse",b6e);Ut("rand",A6e);class Uze extends Yn{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(t===void 0)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const r=t.getNodeType(e);if(n!==null){const s=n.getNodeType(e);if(e.getTypeLength(s)>e.getTypeLength(r))return s}return r}setup(e){const t=this.condNode,n=this.ifNode.isolate(),r=this.elseNode?this.elseNode.isolate():null,s=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=s,r!==null&&(e.getDataFromNode(r).parentNodeBlock=s);const a=e.context.uniformFlow,c=e.getNodeProperties(this);c.condNode=t,c.ifNode=a?n:n.context({nodeBlock:n}),c.elseNode=r?a?r:r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:s,ifNode:a,elseNode:c}=e.getNodeProperties(this),d=e.currentFunctionNode,p=t!=="void",y=p?b2(n).build(e):"";r.nodeProperty=y;const x=s.build(e,"bool");if(e.context.uniformFlow&&c!==null){const N=a.build(e,n),F=c.build(e,n),U=e.getTernary(x,N,F);return e.format(U,n,t)}e.addFlowCode(`
${e.tab}if ( ${x} ) {

`).addFlowTab();let C=a.build(e,n);if(C&&(p?C=y+" = "+C+";":(C="return "+C+";",d===null&&(Wt("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values.",this.stackTrace),C="// "+C))),e.removeFlowTab().addFlowCode(e.tab+"	"+C+`

`+e.tab+"}"),c!==null){e.addFlowCode(` else {

`).addFlowTab();let N=c.build(e,n);N&&(p?N=y+" = "+N+";":(N="return "+N+";",d===null&&(Wt("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values.",this.stackTrace),N="// "+N))),e.removeFlowTab().addFlowCode(e.tab+"	"+N+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(y,n,t)}}const $l=Yr(Uze).setParameterLength(2,3);Ut("select",$l);class N6e extends Yn{static get type(){return"ContextNode"}constructor(e=null,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getFlowContextData(){const e=[];return this.traverse(t=>{t.isContextNode===!0&&e.push(t.value)}),Object.assign({},...e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){const t=e.addContext(this.value);this.node.build(e),e.setContext(t)}setup(e){const t=e.addContext(this.value);this.node.build(e),e.setContext(t)}generate(e,t){const n=e.addContext(this.value),r=this.node.build(e,t);return e.setContext(n),r}}const C2=(i=null,e={})=>{let t=i;return(t===null||t.isNode!==!0)&&(e=t||e,t=null),new N6e(t,e)},k6e=i=>C2(i,{uniformFlow:!0}),Vq=(i,e)=>C2(i,{nodeName:e});function D6e(i,e,t=null){return C2(t,{getShadow:({light:n,shadowColorNode:r})=>e===n?r.mul(i):r})}function O6e(i,e=null){return C2(e,{getAO:(t,{material:n})=>n.transparent===!0?t:t!==null?t.mul(i):i})}function L6e(i,e){return Wt('TSL: "label()" has been deprecated. Use "setName()" instead.'),Vq(i,e)}Ut("context",C2);Ut("label",L6e);Ut("uniformFlow",k6e);Ut("setName",Vq);Ut("builtinShadowContext",(i,e,t)=>D6e(e,t,i));Ut("builtinAOContext",(i,e)=>O6e(e,i));class XN extends Yn{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}isIntent(e){return e.getDataFromNode(this).forceDeclaration===!0?!1:this.intent}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}isAssign(e){return e.getDataFromNode(this).assign}build(...e){const t=e[0];if(this._hasStack(t)===!1&&t.buildStage==="setup"&&(t.context.nodeLoop||t.context.nodeBlock)){let n=!1;if(this.node.isShaderCallNodeInternal&&this.node.shaderNode.getLayout()===null&&t.fnCall&&t.fnCall.shaderNode&&t.getDataFromNode(this.node.shaderNode).hasLoop){const a=t.getDataFromNode(this);a.forceDeclaration=!0,n=!0}const r=t.getBaseStack();n?r.addToStackBefore(this):r.addToStack(this)}return this.isIntent(t)&&this.isAssign(t)!==!0?this.node.build(...e):super.build(...e)}generate(e){const{node:t,name:n,readOnly:r}=this,{renderer:s}=e,a=s.backend.isWebGPUBackend===!0;let c=!1,d=!1;r&&(c=e.isDeterministic(t),d=a?r:c);const p=this.getNodeType(e);if(p=="void")return this.isIntent(e)!==!0&&jt('TSL: ".toVar()" can not be used with void type.',this.stackTrace),t.build(e);const y=e.getVectorType(p),x=t.build(e,y),w=e.getVarFromNode(this,n,y,void 0,d),C=e.getPropertyName(w);let N=C;if(d)if(a)N=c?`const ${C}`:`let ${C}`;else{const F=t.getArrayCount(e);N=`const ${e.getVar(w.type,C,F)}`}return e.addLineFlowCode(`${N} = ${x}`,this),C}_hasStack(e){return e.getDataFromNode(this).stack!==void 0}}const Gq=Yr(XN),F6e=(i,e=null)=>Gq(i,e).toStack(),U6e=(i,e=null)=>Gq(i,e,!0).toStack(),B6e=i=>Gq(i).setIntent(!0).toStack();Ut("toVar",F6e);Ut("toConst",U6e);Ut("toVarIntent",B6e);class Bze extends Yn{static get type(){return"SubBuild"}constructor(e,t,n=null){super(n),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(this.nodeType!==null)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const n=this.node.build(e,...t);return e.removeSubBuild(),n}}const t6=(i,e,t=null)=>new Bze(qn(i),e,t);class zze extends Yn{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=t6(e,"VERTEX"),this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(n===void 0){const r=this.name,s=this.getNodeType(e),a=this.interpolationType,c=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,r,s,a,c),t.node=t6(this.node,"VERTEX")}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(DT.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(DT.VERTEX,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),n=e.getNodeProperties(this),r=this.setupVarying(e);if(n[t]===void 0){const s=this.getNodeType(e),a=e.getPropertyName(r,DT.VERTEX);e.flowNodeFromShaderStage(DT.VERTEX,n.node,s,a),n[t]=a}return e.getPropertyName(r)}}const k4=Yr(zze).setParameterLength(1,2),z6e=i=>k4(i);Ut("toVarying",k4);Ut("toVertexStage",z6e);const V6e=We(([i])=>{const e=i.mul(.9478672986).add(.0521327014).pow(2.4),t=i.mul(.0773993808),n=i.lessThanEqual(.04045);return Ei(e,t,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),G6e=We(([i])=>{const e=i.pow(.41666).mul(1.055).sub(.055),t=i.mul(12.92),n=i.lessThanEqual(.0031308);return Ei(e,t,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),jq="WorkingColorSpace",Vze="OutputColorSpace";class Hq extends Yo{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===jq?Xn.workingColorSpace:t===Vze?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let s=t;return Xn.enabled===!1||n===r||!n||!r||(Xn.getTransfer(n)===Wn&&(s=hr(V6e(s.rgb),s.a)),Xn.getPrimaries(n)!==Xn.getPrimaries(r)&&(s=hr(P0(Xn._getMatrix(new Xr,n,r)).mul(s.rgb),s.a)),Xn.getTransfer(r)===Wn&&(s=hr(G6e(s.rgb),s.a))),s}}const j6e=(i,e)=>new Hq(qn(i),jq,e),oD=(i,e)=>new Hq(qn(i),e,jq),Gze=(i,e,t)=>new Hq(qn(i),e,t);Ut("workingToColorSpace",j6e);Ut("colorSpaceToWorking",oD);let jze=class extends _6{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class H6e extends Yn{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=Fr.OBJECT}setGroup(e){return this.group=e,this}element(e){return new jze(this,qn(e))}setNodeType(e){const t=rr(null,e);this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Hze=(i,e,t)=>new H6e(i,e,t);class Wze extends H6e{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(cr)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const W6e=(i,e,t=null)=>new Wze(i,e,t);class qze extends Yo{static get type(){return"ToneMappingNode"}constructor(e,t=$6e,n=null){super("vec3"),this._toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return HT(this._toneMapping)}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup(e){const t=this.colorNode||e.context.color,n=this._toneMapping;if(n===Qa)return t;let r=null;const s=e.renderer.library.getToneMappingFunction(n);return s!==null?r=hr(s(t.rgb,this.exposureNode),t.a):(jt("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const q6e=(i,e,t)=>new qze(i,qn(e),qn(t)),$6e=W6e("toneMappingExposure","float");Ut("toneMapping",(i,e,t)=>q6e(e,t,i));const P4e=new WeakMap;function R4e(i,e){let t=P4e.get(i);return t===void 0&&(t=new Gve(i,e),P4e.set(i,t)),t}class K9 extends cq{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=Px,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&e.itemSize<=4&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),n=e.getTypeLength(t),r=this.value,s=this.bufferStride||n,a=this.bufferOffset;let c;r.isInterleavedBuffer===!0?c=r:r.isBufferAttribute===!0?c=R4e(r.array,s):c=R4e(r,s);const d=new HW(c,n,a);c.setUsage(this.usage),this.attribute=d,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,s=r):s=k4(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}function aD(i,e=null,t=0,n=0,r=Px,s=!1){return e==="mat3"||e===null&&i.itemSize===9?P0(new K9(i,"vec3",9,0).setUsage(r).setInstanced(s),new K9(i,"vec3",9,3).setUsage(r).setInstanced(s),new K9(i,"vec3",9,6).setUsage(r).setInstanced(s)):e==="mat4"||e===null&&i.itemSize===16?b4(new K9(i,"vec4",16,0).setUsage(r).setInstanced(s),new K9(i,"vec4",16,4).setUsage(r).setInstanced(s),new K9(i,"vec4",16,8).setUsage(r).setInstanced(s),new K9(i,"vec4",16,12).setUsage(r).setInstanced(s)):new K9(i,e,t,n).setUsage(r)}const Wq=(i,e=null,t=0,n=0)=>aD(i,e,t,n),$ze=(i,e=null,t=0,n=0)=>aD(i,e,t,n,uE),gk=(i,e=null,t=0,n=0)=>aD(i,e,t,n,Px,!0),KH=(i,e=null,t=0,n=0)=>aD(i,e,t,n,uE,!0);Ut("toAttribute",i=>Wq(i.value));class Xze extends Yn{static get type(){return"ComputeNode"}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=Fr.OBJECT,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return Wt('TSL: "label()" has been deprecated. Use "setName()" instead.',new da),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const n=e.getNodeProperties(this);n.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if(n==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const s=e.getNodeProperties(this).outputComputeNode;if(s)return s.build(e,t)}}}const qq=(i,e=[64])=>{(e.length===0||e.length>3)&&jt("TSL: compute() workgroupSize must have 1, 2, or 3 elements",new da);for(let t=0;t<e.length;t++){const n=e[t];(typeof n!="number"||n<=0||!Number.isInteger(n))&&jt(`TSL: compute() workgroupSize element at index [ ${t} ] must be a positive integer`,new da)}for(;e.length<3;)e.push(1);return new Xze(qn(i),e)},X6e=(i,e,t)=>qq(i,t).setCount(e);Ut("compute",X6e);Ut("computeKernel",qq);class Yze extends Yn{static get type(){return"IsolateNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isIsolateNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.build(e,...t);return e.setCache(n),s}setParent(e){return this.parent=e,this}getParent(){return this.parent}}const nx=i=>new Yze(qn(i));function Y6e(i,e=!0){return Wt('TSL: "cache()" has been deprecated. Use "isolate()" instead.'),nx(i).setParent(e)}Ut("cache",Y6e);Ut("isolate",nx);class Kze extends Yn{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const K6e=Yr(Kze).setParameterLength(2);Ut("bypass",K6e);class Z6e extends Yn{static get type(){return"RemapNode"}constructor(e,t,n,r=xe(0),s=xe(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:s,doClamp:a}=this;let c=e.sub(t).div(n.sub(t));return a===!0&&(c=c.clamp()),c.mul(s.sub(r)).add(r)}}const Q6e=Yr(Z6e,null,null,{doClamp:!1}).setParameterLength(3,5),J6e=Yr(Z6e).setParameterLength(3,5);Ut("remap",Q6e);Ut("remapClamp",J6e);class YN extends Yn{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if(n==="void")e.addLineFlowCode(r,this);else return e.format(r,n,t)}}const tp=Yr(YN).setParameterLength(1,2),eye=i=>(i?$l(i,tp("discard")):tp("discard")).toStack(),Zze=()=>tp("return").toStack();Ut("discard",eye);class Qze extends Yo{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this._toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup({context:e}){let t=this.colorNode||e.color;const n=(this._toneMapping!==null?this._toneMapping:e.toneMapping)||Qa,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||il;return n!==Qa&&(t=t.toneMapping(n)),r!==il&&r!==Xn.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const tye=(i,e=null,t=null)=>new Qze(qn(i),e,t);Ut("renderOutput",tye);class Jze extends Yo{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e);if(t!==null)t(e,n);else{const r="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(r.length);let a="";a+="// #"+r+`#
`,a+=e.flow.code.replace(/^\t/mg,"")+`
`,a+="/* ... */ "+n+` /* ... */
`,a+="// #"+s+`#
`,fE(a)}return n}}const nye=(i,e=null)=>new Jze(qn(i),e).toStack();Ut("debug",nye);class rye{constructor(){this._renderer=null,this.currentFrame=null}get nodeFrame(){return this._renderer._nodes.nodeFrame}setRenderer(e){return this._renderer=e,this}getRenderer(){return this._renderer}init(){}begin(){}finish(){}inspect(){}computeAsync(){}beginCompute(){}finishCompute(){}beginRender(){}finishRender(){}copyTextureToTexture(){}copyFramebufferToTexture(){}}class eVe extends Yn{static get type(){return"InspectorNode"}constructor(e,t="",n=null){super(),this.node=e,this.name=t,this.callback=n,this.updateType=Fr.FRAME,this.isInspectorNode=!0}getName(){return this.name||this.node.name}update(e){e.renderer.inspector.inspect(this)}getNodeType(e){return this.node.getNodeType(e)}setup(e){let t=this.node;return e.context.inspector===!0&&this.callback!==null&&(t=this.callback(t)),e.renderer.backend.isWebGPUBackend!==!0&&e.renderer.inspector.constructor!==rye&&ns('TSL: ".toInspector()" is only available with WebGPU.'),t}}function iye(i,e="",t=null){return i=qn(i),i.before(new eVe(i,e,t))}Ut("toInspector",iye);function tVe(i){Wt("TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",i)}class sye extends Yn{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),a=e.getTypeFromAttribute(s),c=e.getAttribute(t,a);return e.shaderStage==="vertex"?e.format(c.name,a,n):k4(this).build(e,n)}else return Wt(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const E2=(i,e=null)=>new sye(i,e),Es=(i=0)=>E2("uv"+(i>0?i:""),"vec2");class nVe extends Yn{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const S4=Yr(nVe).setParameterLength(1,2);class rVe extends GE{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Fr.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&n.width!==void 0){const{width:r,height:s}=n;this.value=Math.log2(Math.max(r,s))}}}const $q=Yr(rVe).setParameterLength(1);class oye extends Error{constructor(e,t=null){super(e),this.name="NodeError",this.stackTrace=t}}const Xq=new ro;class fm extends GE{static get type(){return"TextureNode"}constructor(e=Xq,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Fr.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this._flipYUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===ys?"uvec4":this.value.type===C0?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Es(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=rr(this.value.matrix)),this._matrixUniform.mul(Ve(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this}setupUV(e,t){return e.isFlipY()&&(this._flipYUniform===null&&(this._flipYUniform=rr(!1)),t=t.toVar(),this.sampler?t=this._flipYUniform.select(t.flipY(),t):t=this._flipYUniform.select(t.setY(Fe(S4(this,this.levelNode).y).sub(t.y).sub(1)),t)),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||n.isTexture!==!0)throw new oye("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().",this.stackTrace);const r=We(()=>{let d=this.uvNode;return(d===null||e.context.forceUVContext===!0)&&e.context.getUV&&(d=e.context.getUV(this,e)),d||(d=this.getDefaultUV()),this.updateMatrix===!0&&(d=this.getTransformedUV(d)),d=this.setupUV(e,d),this.updateType=this._matrixUniform!==null||this._flipYUniform!==null?Fr.OBJECT:Fr.NONE,d})();let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this));let a=null,c=null;this.compareNode!==null&&(e.renderer.hasCompatibility(x4.TEXTURE_COMPARE)?a=this.compareNode:this.value.compareFunction===null||this.value.compareFunction===Gk?c=this.compareNode:(a=this.compareNode,ns('TSL: Only "LessCompare" is supported for depth texture comparison fallback.'))),t.uvNode=r,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=a,t.compareStepNode=c,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,n,r,s,a,c,d,p){const y=this.value;let x;return s?x=e.generateTextureBias(y,t,n,s,a,p):d?x=e.generateTextureGrad(y,t,n,d,a,p):c?x=e.generateTextureCompare(y,t,n,c,a,p):this.sampler===!1?x=e.generateTextureLoad(y,t,n,r,a,p):r?x=e.generateTextureLevel(y,t,n,r,a,p):x=e.generateTexture(y,t,n,a,p),x}generate(e,t){const n=this.value,r=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const a=e.getDataFromNode(this),c=this.getNodeType(e);let d=a.propertyName;if(d===void 0){const{uvNode:y,levelNode:x,biasNode:w,compareNode:C,compareStepNode:N,depthNode:F,gradNode:U,offsetNode:R}=r,B=this.generateUV(e,y),Y=x?x.build(e,"float"):null,A=w?w.build(e,"float"):null,ne=F?F.build(e,"int"):null,se=C?C.build(e,"float"):null,oe=N?N.build(e,"float"):null,G=U?[U[0].build(e,"vec2"),U[1].build(e,"vec2")]:null,ie=R?this.generateOffset(e,R):null,Me=e.getVarFromNode(this);d=e.getPropertyName(Me);let X=this.generateSnippet(e,s,B,Y,A,ne,se,G,ie);oe!==null&&(X=Dx(tp(oe,"float"),tp(X,c)).build(e,c)),e.addLineFlowCode(`${d} = ${X}`,this),a.snippet=X,a.propertyName=d}let p=d;return e.needsToWorkingColorSpace(n)&&(p=oD(tp(p,c),n.colorSpace).setup(e).build(e,c)),e.format(p,c,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}sample(e){const t=this.clone();return t.uvNode=qn(e),t.referenceNode=this.getBase(),qn(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){const t=this.clone();t.biasNode=qn(e).mul($q(t)),t.referenceNode=this.getBase();const n=t.value;return t.generateMipmaps===!1&&(n&&n.generateMipmaps===!1||n.minFilter===Hi||n.magFilter===Hi)&&(Wt("TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),qn(t)}level(e){const t=this.clone();return t.levelNode=qn(e),t.referenceNode=this.getBase(),qn(t)}size(e){return S4(this,e)}bias(e){const t=this.clone();return t.biasNode=qn(e),t.referenceNode=this.getBase(),qn(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const t=this.clone();return t.compareNode=qn(e),t.referenceNode=this.getBase(),qn(t)}grad(e,t){const n=this.clone();return n.gradNode=[qn(e),qn(t)],n.referenceNode=this.getBase(),qn(n)}depth(e){const t=this.clone();return t.depthNode=qn(e),t.referenceNode=this.getBase(),qn(t)}offset(e){const t=this.clone();return t.offsetNode=qn(e),t.referenceNode=this.getBase(),qn(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix();const n=this._flipYUniform;n!==null&&(n.value=e.image instanceof ImageBitmap&&e.flipY===!0||e.isRenderTargetTexture===!0||e.isFramebufferTexture===!0||e.isDepthTexture===!0)}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const iVe=Yr(fm).setParameterLength(1,4).setName("texture"),$i=(i=Xq,e=null,t=null,n=null)=>{let r;return i&&i.isTextureNode===!0?(r=qn(i.clone()),r.referenceNode=i.getBase(),e!==null&&(r.uvNode=qn(e)),t!==null&&(r.levelNode=qn(t)),n!==null&&(r.biasNode=qn(n))):r=iVe(i,e,t,n),r},sVe=(i=Xq)=>$i(i),$o=(...i)=>$i(...i).setSampler(!1),oVe=(i,e,t)=>$i(i,e).level(t),aVe=i=>(i.isNode===!0?i:$i(i)).convert("sampler"),lVe=i=>(i.isNode===!0?i:$i(i)).convert("samplerComparison");class Yq extends GE{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n,this.updateRanges=[]}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const HE=(i,e,t)=>new Yq(i,e,t);class cVe extends _6{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,n)}}class uVe extends Yq{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?f4(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=Fr.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if(n==="float"||n==="int"||n==="uint")for(let r=0;r<e.length;r++){const s=r*4;t[s]=e[r]}else if(n==="color")for(let r=0;r<e.length;r++){const s=r*4,a=e[r];t[s]=a.r,t[s+1]=a.g,t[s+2]=a.b||0}else if(n==="mat2")for(let r=0;r<e.length;r++){const s=r*4,a=e[r];t[s]=a.elements[0],t[s+1]=a.elements[1],t[s+2]=a.elements[2],t[s+3]=a.elements[3]}else if(n==="mat3")for(let r=0;r<e.length;r++){const s=r*16,a=e[r];t[s]=a.elements[0],t[s+1]=a.elements[1],t[s+2]=a.elements[2],t[s+4]=a.elements[3],t[s+5]=a.elements[4],t[s+6]=a.elements[5],t[s+8]=a.elements[6],t[s+9]=a.elements[7],t[s+10]=a.elements[8],t[s+15]=1}else if(n==="mat4")for(let r=0;r<e.length;r++){const s=r*16,a=e[r];for(let c=0;c<a.elements.length;c++)t[s+c]=a.elements[c]}else for(let r=0;r<e.length;r++){const s=r*4,a=e[r];t[s]=a.x,t[s+1]=a.y,t[s+2]=a.z||0,t[s+3]=a.w||0}}setup(e){const t=this.array.length,n=this.elementType;let r=Float32Array;const s=this.paddedType,a=e.getTypeLength(s);return n.charAt(0)==="i"&&(r=Int32Array),n.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*a),this.bufferCount=t,this.bufferType=s,this.update(),super.setup(e)}element(e){return new cVe(this,qn(e))}}const Hl=(i,e)=>new uVe(i,e);class dVe extends Yn{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const A2=Yr(dVe).setParameterLength(1);let oT,aT;class qs extends Yn{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===qs.DPR?"float":this.scope===qs.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=Fr.NONE;return(this.scope===qs.SIZE||this.scope===qs.VIEWPORT||this.scope===qs.DPR)&&(e=Fr.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===qs.VIEWPORT?t!==null?aT.copy(t.viewport):(e.getViewport(aT),aT.multiplyScalar(e.getPixelRatio())):this.scope===qs.DPR?this._output.value=e.getPixelRatio():t!==null?(oT.width=t.width,oT.height=t.height):e.getDrawingBufferSize(oT)}setup(){const e=this.scope;let t=null;return e===qs.SIZE?t=rr(oT||(oT=new vn)):e===qs.VIEWPORT?t=rr(aT||(aT=new wr)):e===qs.DPR?t=rr(1):t=en(b6.div(d6)),this._output=t,t}generate(e){if(this.scope===qs.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(d6).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}qs.COORDINATE="coordinate";qs.VIEWPORT="viewport";qs.SIZE="size";qs.UV="uv";qs.DPR="dpr";const aye=En(qs,qs.DPR),lm=En(qs,qs.UV),d6=En(qs,qs.SIZE),b6=En(qs,qs.COORDINATE),Kq=En(qs,qs.VIEWPORT),Zq=Kq.zw,lye=b6.sub(Kq.xy),hVe=lye.div(Zq),fVe=We(()=>(Wt('TSL: "viewportResolution" is deprecated. Use "screenSize" instead.',new da),d6),"vec2").once()();let mj=null,iN=null,gj=null,sN=null,vj=null,oN=null,yj=null,aN=null,_j=null,lN=null,xj=null,cN=null,bj=null,uN=null;const D4=rr(0,"uint").setName("u_cameraIndex").setGroup(nD("cameraIndex")).toVarying("v_cameraIndex"),a4=rr("float").setName("cameraNear").setGroup(cr).onRenderUpdate(({camera:i})=>i.near),l4=rr("float").setName("cameraFar").setGroup(cr).onRenderUpdate(({camera:i})=>i.far),S2=We(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const n of i.cameras)t.push(n.projectionMatrix);iN===null?iN=Hl(t).setGroup(cr).setName("cameraProjectionMatrices"):iN.array=t,e=iN.element(i.isMultiViewCamera?A2("gl_ViewID_OVR"):D4).toConst("cameraProjectionMatrix")}else mj===null&&(mj=rr(i.projectionMatrix).setName("cameraProjectionMatrix").setGroup(cr).onRenderUpdate(({camera:t})=>t.projectionMatrix)),e=mj;return e}).once()(),cye=We(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const n of i.cameras)t.push(n.projectionMatrixInverse);sN===null?sN=Hl(t).setGroup(cr).setName("cameraProjectionMatricesInverse"):sN.array=t,e=sN.element(i.isMultiViewCamera?A2("gl_ViewID_OVR"):D4).toConst("cameraProjectionMatrixInverse")}else gj===null&&(gj=rr(i.projectionMatrixInverse).setName("cameraProjectionMatrixInverse").setGroup(cr).onRenderUpdate(({camera:t})=>t.projectionMatrixInverse)),e=gj;return e}).once()(),Nh=We(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const n of i.cameras)t.push(n.matrixWorldInverse);oN===null?oN=Hl(t).setGroup(cr).setName("cameraViewMatrices"):oN.array=t,e=oN.element(i.isMultiViewCamera?A2("gl_ViewID_OVR"):D4).toConst("cameraViewMatrix")}else vj===null&&(vj=rr(i.matrixWorldInverse).setName("cameraViewMatrix").setGroup(cr).onRenderUpdate(({camera:t})=>t.matrixWorldInverse)),e=vj;return e}).once()(),pVe=We(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const n of i.cameras)t.push(n.matrixWorld);aN===null?aN=Hl(t).setGroup(cr).setName("cameraWorldMatrices"):aN.array=t,e=aN.element(i.isMultiViewCamera?A2("gl_ViewID_OVR"):D4).toConst("cameraWorldMatrix")}else yj===null&&(yj=rr(i.matrixWorld).setName("cameraWorldMatrix").setGroup(cr).onRenderUpdate(({camera:t})=>t.matrixWorld)),e=yj;return e}).once()(),mVe=We(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const n of i.cameras)t.push(n.normalMatrix);lN===null?lN=Hl(t).setGroup(cr).setName("cameraNormalMatrices"):lN.array=t,e=lN.element(i.isMultiViewCamera?A2("gl_ViewID_OVR"):D4).toConst("cameraNormalMatrix")}else _j===null&&(_j=rr(i.normalMatrix).setName("cameraNormalMatrix").setGroup(cr).onRenderUpdate(({camera:t})=>t.normalMatrix)),e=_j;return e}).once()(),uye=We(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(let n=0,r=i.cameras.length;n<r;n++)t.push(new _e);cN===null?cN=Hl(t).setGroup(cr).setName("cameraPositions").onRenderUpdate(({camera:n},r)=>{const s=n.cameras,a=r.array;for(let c=0,d=s.length;c<d;c++)a[c].setFromMatrixPosition(s[c].matrixWorld)}):cN.array=t,e=cN.element(i.isMultiViewCamera?A2("gl_ViewID_OVR"):D4).toConst("cameraPosition")}else xj===null&&(xj=rr(new _e).setName("cameraPosition").setGroup(cr).onRenderUpdate(({camera:t},n)=>n.value.setFromMatrixPosition(t.matrixWorld))),e=xj;return e}).once()(),gVe=We(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const n of i.cameras)t.push(n.viewport);uN===null?uN=Hl(t,"vec4").setGroup(cr).setName("cameraViewports"):uN.array=t,e=uN.element(D4).toConst("cameraViewport")}else bj===null&&(bj=hr(0,0,d6.x,d6.y).toConst("cameraViewport")),e=bj;return e}).once()(),I4e=new M2;class Pi extends Yn{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=Fr.OBJECT,this.uniformNode=new GE(null)}getNodeType(){const e=this.scope;if(e===Pi.WORLD_MATRIX)return"mat4";if(e===Pi.POSITION||e===Pi.VIEW_POSITION||e===Pi.DIRECTION||e===Pi.SCALE)return"vec3";if(e===Pi.RADIUS)return"float"}update(e){const t=this.object3d,n=this.uniformNode,r=this.scope;if(r===Pi.WORLD_MATRIX)n.value=t.matrixWorld;else if(r===Pi.POSITION)n.value=n.value||new _e,n.value.setFromMatrixPosition(t.matrixWorld);else if(r===Pi.SCALE)n.value=n.value||new _e,n.value.setFromMatrixScale(t.matrixWorld);else if(r===Pi.DIRECTION)n.value=n.value||new _e,t.getWorldDirection(n.value);else if(r===Pi.VIEW_POSITION){const s=e.camera;n.value=n.value||new _e,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(s.matrixWorldInverse)}else if(r===Pi.RADIUS){const s=e.object.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),I4e.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),n.value=I4e.radius}}generate(e){const t=this.scope;return t===Pi.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===Pi.POSITION||t===Pi.VIEW_POSITION||t===Pi.DIRECTION||t===Pi.SCALE?this.uniformNode.nodeType="vec3":t===Pi.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Pi.WORLD_MATRIX="worldMatrix";Pi.POSITION="position";Pi.SCALE="scale";Pi.VIEW_POSITION="viewPosition";Pi.DIRECTION="direction";Pi.RADIUS="radius";const vVe=Yr(Pi,Pi.DIRECTION).setParameterLength(1),yVe=Yr(Pi,Pi.WORLD_MATRIX).setParameterLength(1),_Ve=Yr(Pi,Pi.POSITION).setParameterLength(1),xVe=Yr(Pi,Pi.SCALE).setParameterLength(1),bVe=Yr(Pi,Pi.VIEW_POSITION).setParameterLength(1),SVe=Yr(Pi,Pi.RADIUS).setParameterLength(1);class Ph extends Pi{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const wVe=En(Ph,Ph.DIRECTION),wh=En(Ph,Ph.WORLD_MATRIX),TVe=En(Ph,Ph.POSITION),EVe=En(Ph,Ph.SCALE),MVe=En(Ph,Ph.VIEW_POSITION),CVe=En(Ph,Ph.RADIUS),dye=rr(new Xr).onObjectUpdate(({object:i},e)=>e.value.getNormalMatrix(i.matrixWorld)),AVe=rr(new An).onObjectUpdate(({object:i},e)=>e.value.copy(i.matrixWorld).invert()),O4=We(i=>i.context.modelViewMatrix||hye).once()().toVar("modelViewMatrix"),hye=Nh.mul(wh),ZH=We(i=>(i.context.isHighPrecisionModelViewMatrix=!0,rr("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),QH=We(i=>{const e=i.context.isHighPrecisionModelViewMatrix;return rr("mat3").onObjectUpdate(({object:t,camera:n})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),fye=We(i=>i.shaderStage!=="fragment"?(ns("TSL: `clipSpace` is only available in fragment stage."),hr()):i.context.clipSpace.toVarying("v_clipSpace")).once()(),WE=E2("position","vec3"),Po=WE.toVarying("positionLocal"),Ox=WE.toVarying("positionPrevious"),cm=We(i=>wh.mul(Po).xyz.toVarying(i.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),Qq=We(()=>Po.transformDirection(wh).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),ua=We(i=>{if(i.shaderStage==="fragment"&&i.material.vertexNode){const e=cye.mul(fye);return e.xyz.div(e.w).toVar("positionView")}return i.context.setupPositionView().toVarying("v_positionView")},"vec3").once(["POSITION","VERTEX"])(),ks=We(i=>{let e;return i.camera.isOrthographicCamera?e=Ve(0,0,1):e=ua.negate().toVarying("v_positionViewDirection").normalize(),e.toVar("positionViewDirection")},"vec3").once(["POSITION"])();class PVe extends Yn{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if(e.shaderStage!=="fragment")return"true";const{material:t}=e;return t.side===Ui?"false":e.getFrontFacing()}}const pye=En(PVe),Jq=xe(pye).mul(2).sub(1),Yx=We(([i],{material:e})=>{const t=e.side;return t===Ui?i=i.mul(-1):t===no&&(i=i.mul(Jq)),i}),lD=E2("normal","vec3"),Ru=We(i=>i.geometry.hasAttribute("normal")===!1?(Wt('TSL: Vertex attribute "normal" not found on geometry.'),Ve(0,1,0)):lD,"vec3").once()().toVar("normalLocal"),mye=ua.dFdx().cross(ua.dFdy()).normalize().toVar("normalFlat"),Lx=We(i=>{let e;return i.isFlatShading()?e=mye:e=e$(Ru).toVarying("v_normalViewGeometry").normalize(),e},"vec3").once()().toVar("normalViewGeometry"),gye=We(i=>{let e=Lx.transformDirection(Nh);return i.isFlatShading()!==!0&&(e=e.toVarying("v_normalWorldGeometry")),e.normalize().toVar("normalWorldGeometry")},"vec3").once()(),ji=We(i=>{let e;return i.subBuildFn==="NORMAL"||i.subBuildFn==="VERTEX"?(e=Lx,i.isFlatShading()!==!0&&(e=Yx(e))):e=i.context.setupNormal().context({getUV:null,getTextureLevel:null}),e},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),L4=ji.transformDirection(Nh).toVar("normalWorld"),c4=We(({subBuildFn:i,context:e})=>{let t;return i==="NORMAL"||i==="VERTEX"?t=ji:t=e.setupClearcoatNormal().context({getUV:null,getTextureLevel:null}),t},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),vye=We(([i,e=wh])=>{const t=P0(e),n=i.div(Ve(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(n).xyz}),e$=We(([i],e)=>{const t=e.context.modelNormalViewMatrix;if(t)return t.transformDirection(i);const n=dye.mul(i);return Nh.transformDirection(n)}),RVe=We(()=>(Wt('TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),ji)).once(["NORMAL","VERTEX"])(),IVe=We(()=>(Wt('TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),L4)).once(["NORMAL","VERTEX"])(),NVe=We(()=>(Wt('TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),c4)).once(["NORMAL","VERTEX"])(),N4e=new Ao,Sj=new An,yye=rr(0).onReference(({material:i})=>i).onObjectUpdate(({material:i})=>i.refractionRatio),KN=rr(1).onReference(({material:i})=>i).onObjectUpdate(function({material:i,scene:e}){return i.envMap?i.envMapIntensity:e.environmentIntensity}),t$=rr(new An).onReference(function(i){return i.material}).onObjectUpdate(function({material:i,scene:e}){const t=e.environment!==null&&i.envMap===null?e.environmentRotation:i.envMapRotation;return t?(N4e.copy(t),Sj.makeRotationFromEuler(N4e)):Sj.identity(),Sj}),_ye=ks.negate().reflect(ji),xye=ks.negate().refract(ji,yye),bye=_ye.transformDirection(Nh).toVar("reflectVector"),Sye=xye.transformDirection(Nh).toVar("reflectVector"),wye=new g6;class kVe extends fm{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return this.value.isDepthTexture===!0?"cubeDepthTexture":"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===np?bye:e.mapping===hm?Sye:(jt('CubeTextureNode: Mapping "%s" not supported.',e.mapping),Ve(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return n.isDepthTexture===!0?e.renderer.coordinateSystem===Sd?Ve(t.x,t.y.negate(),t.z):t:((e.renderer.coordinateSystem===Sd||!n.isRenderTargetTexture)&&(t=Ve(t.x.negate(),t.yz)),t$.mul(t))}generateUV(e,t){return t.build(e,this.sampler===!0?"vec3":"ivec3")}}const n$=Yr(kVe).setParameterLength(1,4).setName("cubeTexture"),Dc=(i=wye,e=null,t=null,n=null)=>{let r;return i&&i.isCubeTextureNode===!0?(r=qn(i.clone()),r.referenceNode=i,e!==null&&(r.uvNode=qn(e)),t!==null&&(r.levelNode=qn(t)),n!==null&&(r.biasNode=qn(n))):r=n$(i,e,t,n),r},DVe=(i=wye)=>n$(i);class OVe extends _6{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class cD extends Yn{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=Fr.OBJECT}element(e){return new OVe(this,qn(e))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return Wt('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let t=null;this.count!==null?t=HE(null,e,this.count):Array.isArray(this.getValueFromReference())?t=Hl(null,e):e==="texture"?t=$i(null):e==="cubeTexture"?t=Dc(null):t=rr(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.setName(this.name),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const to=(i,e,t)=>new cD(i,e,t),JH=(i,e,t,n)=>new cD(i,e,n,t);class LVe extends cD{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const f2=(i,e,t=null)=>new LVe(i,e,t),Tye=Es(),FVe=ua.dFdx(),UVe=ua.dFdy(),Eye=Tye.dFdx(),Mye=Tye.dFdy(),Cye=ji,Aye=UVe.cross(Cye),Pye=Cye.cross(FVe),eW=Aye.mul(Eye.x).add(Pye.mul(Mye.x)),tW=Aye.mul(Eye.y).add(Pye.mul(Mye.y)),k4e=eW.dot(eW).max(tW.dot(tW)),Rye=k4e.equal(0).select(0,k4e.inverseSqrt()),BVe=eW.mul(Rye).toVar("tangentViewFrame"),zVe=tW.mul(Rye).toVar("bitangentViewFrame"),uD=E2("tangent","vec4"),Fx=uD.xyz.toVar("tangentLocal"),dD=We(i=>{let e;return i.subBuildFn==="VERTEX"||i.geometry.hasAttribute("tangent")?e=O4.mul(hr(Fx,0)).xyz.toVarying("v_tangentView").normalize():e=BVe,i.isFlatShading()!==!0&&(e=Yx(e)),e},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),Iye=dD.transformDirection(Nh).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),hD=We(([i,e],t)=>{let n=i.mul(uD.w).xyz;return t.subBuildFn==="NORMAL"&&t.isFlatShading()!==!0&&(n=n.toVarying(e)),n}).once(["NORMAL"]),VVe=hD(lD.cross(uD),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),GVe=hD(Ru.cross(Fx),"v_bitangentLocal").normalize().toVar("bitangentLocal"),Nye=We(i=>{let e;return i.subBuildFn==="VERTEX"||i.geometry.hasAttribute("tangent")?e=hD(ji.cross(dD),"v_bitangentView").normalize():e=zVe,i.isFlatShading()!==!0&&(e=Yx(e)),e},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),jVe=hD(L4.cross(Iye),"v_bitangentWorld").normalize().toVar("bitangentWorld"),Y8=P0(dD,Nye,ji).toVar("TBNViewMatrix"),kye=ks.mul(Y8),HVe=(i,e)=>i.sub(kye.mul(e)),Dye=We(()=>{let i=e6.cross(ks);return i=i.cross(e6).normalize(),i=Ei(i,ji,s4.mul(J1.oneMinus()).oneMinus().pow2().pow2()).normalize(),i}).once()(),Oye=i=>qn(i).mul(.5).add(.5),WVe=i=>qn(i).mul(2).sub(1),nW=i=>Ve(i,Lc(sD(xe(1).sub(Ah(i,i)))));class qVe extends Yo{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=im,this.unpackNormalMode=CG}setup(e){const{normalMapType:t,scaleNode:n,unpackNormalMode:r}=this;let s=this.node.mul(2).sub(1);if(t===im?r===Fve?s=nW(s.xy):r===dNe?s=nW(s.yw):r!==CG&&console.error(`THREE.NodeMaterial: Unexpected unpack normal mode: ${r}`):r!==CG&&console.error(`THREE.NodeMaterial: Normal map type '${t}' is not compatible with unpack normal mode '${r}'`),n!==null){let c=n;e.isFlatShading()===!0&&(c=Yx(c)),s=Ve(s.xy.mul(c),s.z)}let a=null;return t===Lve?a=e$(s):t===im?a=Y8.mul(s).normalize():(jt(`NodeMaterial: Unsupported normal map type: ${t}`),a=ji),a}}const rW=Yr(qVe).setParameterLength(1,2),$Ve=We(({textureNode:i,bumpScale:e})=>{const t=r=>i.isolate().context({getUV:s=>r(s.uvNode||Es()),forceUVContext:!0}),n=xe(t(r=>r));return en(xe(t(r=>r.add(r.dFdx()))).sub(n),xe(t(r=>r.add(r.dFdy()))).sub(n)).mul(e)}),XVe=We(i=>{const{surf_pos:e,surf_norm:t,dHdxy:n}=i,r=e.dFdx().normalize(),s=e.dFdy().normalize(),a=t,c=s.cross(a),d=a.cross(r),p=r.dot(c).mul(Jq),y=p.sign().mul(n.x.mul(c).add(n.y.mul(d)));return p.abs().mul(t).sub(y).normalize()});class YVe extends Yo{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=$Ve({textureNode:this.textureNode,bumpScale:e});return XVe({surf_pos:ua,surf_norm:ji,dHdxy:t})}}const r$=Yr(YVe).setParameterLength(1,2),D4e=new Map;class Vt extends Yn{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=D4e.get(e);return n===void 0&&(n=f2(e,t),D4e.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===Vt.COLOR){const s=t.color!==void 0?this.getColor(n):Ve();t.map&&t.map.isTexture===!0?r=s.mul(this.getTexture("map")):r=s}else if(n===Vt.OPACITY){const s=this.getFloat(n);t.alphaMap&&t.alphaMap.isTexture===!0?r=s.mul(this.getTexture("alpha")):r=s}else if(n===Vt.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=xe(1);else if(n===Vt.SPECULAR_INTENSITY){const s=this.getFloat(n);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=s.mul(this.getTexture(n).a):r=s}else if(n===Vt.SPECULAR_COLOR){const s=this.getColor(n);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=s.mul(this.getTexture(n).rgb):r=s}else if(n===Vt.ROUGHNESS){const s=this.getFloat(n);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).g):r=s}else if(n===Vt.METALNESS){const s=this.getFloat(n);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=s.mul(this.getTexture(n).b):r=s}else if(n===Vt.EMISSIVE){const s=this.getFloat("emissiveIntensity"),a=this.getColor(n).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=a.mul(this.getTexture(n)):r=a}else if(n===Vt.NORMAL)t.normalMap?(r=rW(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType,(t.normalMap.format==Oc||t.normalMap.format==a6||t.normalMap.format==o6)&&(r.unpackNormalMode=Fve)):t.bumpMap?r=r$(this.getTexture("bump").r,this.getFloat("bumpScale")):r=ji;else if(n===Vt.CLEARCOAT){const s=this.getFloat(n);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=s.mul(this.getTexture(n).r):r=s}else if(n===Vt.CLEARCOAT_ROUGHNESS){const s=this.getFloat(n);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).r):r=s}else if(n===Vt.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=rW(this.getTexture(n),this.getCache(n+"Scale","vec2")):r=ji;else if(n===Vt.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=s.mul(this.getTexture("sheenColor").rgb):r=s}else if(n===Vt.SHEEN_ROUGHNESS){const s=this.getFloat(n);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).a):r=s,r=r.clamp(1e-4,1)}else if(n===Vt.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(n);r=eD(z_.x,z_.y,z_.y.negate(),z_.x).mul(s.rg.mul(2).sub(en(1)).normalize().mul(s.b))}else r=z_;else if(n===Vt.IRIDESCENCE_THICKNESS){const s=to("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const a=to("0","float",t.iridescenceThicknessRange);r=s.sub(a).mul(this.getTexture(n).g).add(a)}else r=s}else if(n===Vt.TRANSMISSION){const s=this.getFloat(n);t.transmissionMap?r=s.mul(this.getTexture(n).r):r=s}else if(n===Vt.THICKNESS){const s=this.getFloat(n);t.thicknessMap?r=s.mul(this.getTexture(n).g):r=s}else if(n===Vt.IOR)r=this.getFloat(n);else if(n===Vt.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===Vt.AO)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===Vt.LINE_DASH_OFFSET)r=t.dashOffset?this.getFloat(n):xe(0);else{const s=this.getNodeType(e);r=this.getCache(n,s)}return r}}Vt.ALPHA_TEST="alphaTest";Vt.COLOR="color";Vt.OPACITY="opacity";Vt.SHININESS="shininess";Vt.SPECULAR="specular";Vt.SPECULAR_STRENGTH="specularStrength";Vt.SPECULAR_INTENSITY="specularIntensity";Vt.SPECULAR_COLOR="specularColor";Vt.REFLECTIVITY="reflectivity";Vt.ROUGHNESS="roughness";Vt.METALNESS="metalness";Vt.NORMAL="normal";Vt.CLEARCOAT="clearcoat";Vt.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Vt.CLEARCOAT_NORMAL="clearcoatNormal";Vt.EMISSIVE="emissive";Vt.ROTATION="rotation";Vt.SHEEN="sheen";Vt.SHEEN_ROUGHNESS="sheenRoughness";Vt.ANISOTROPY="anisotropy";Vt.IRIDESCENCE="iridescence";Vt.IRIDESCENCE_IOR="iridescenceIOR";Vt.IRIDESCENCE_THICKNESS="iridescenceThickness";Vt.IOR="ior";Vt.TRANSMISSION="transmission";Vt.THICKNESS="thickness";Vt.ATTENUATION_DISTANCE="attenuationDistance";Vt.ATTENUATION_COLOR="attenuationColor";Vt.LINE_SCALE="scale";Vt.LINE_DASH_SIZE="dashSize";Vt.LINE_GAP_SIZE="gapSize";Vt.LINE_WIDTH="linewidth";Vt.LINE_DASH_OFFSET="dashOffset";Vt.POINT_SIZE="size";Vt.DISPERSION="dispersion";Vt.LIGHT_MAP="light";Vt.AO="ao";const Lye=En(Vt,Vt.ALPHA_TEST),Fye=En(Vt,Vt.COLOR),Uye=En(Vt,Vt.SHININESS),Bye=En(Vt,Vt.EMISSIVE),i$=En(Vt,Vt.OPACITY),zye=En(Vt,Vt.SPECULAR),iW=En(Vt,Vt.SPECULAR_INTENSITY),Vye=En(Vt,Vt.SPECULAR_COLOR),XT=En(Vt,Vt.SPECULAR_STRENGTH),ZN=En(Vt,Vt.REFLECTIVITY),Gye=En(Vt,Vt.ROUGHNESS),jye=En(Vt,Vt.METALNESS),Hye=En(Vt,Vt.NORMAL),Wye=En(Vt,Vt.CLEARCOAT),qye=En(Vt,Vt.CLEARCOAT_ROUGHNESS),$ye=En(Vt,Vt.CLEARCOAT_NORMAL),Xye=En(Vt,Vt.ROTATION),Yye=En(Vt,Vt.SHEEN),Kye=En(Vt,Vt.SHEEN_ROUGHNESS),Zye=En(Vt,Vt.ANISOTROPY),Qye=En(Vt,Vt.IRIDESCENCE),Jye=En(Vt,Vt.IRIDESCENCE_IOR),e7e=En(Vt,Vt.IRIDESCENCE_THICKNESS),t7e=En(Vt,Vt.TRANSMISSION),n7e=En(Vt,Vt.THICKNESS),r7e=En(Vt,Vt.IOR),i7e=En(Vt,Vt.ATTENUATION_DISTANCE),s7e=En(Vt,Vt.ATTENUATION_COLOR),o7e=En(Vt,Vt.LINE_SCALE),a7e=En(Vt,Vt.LINE_DASH_SIZE),l7e=En(Vt,Vt.LINE_GAP_SIZE),KVe=En(Vt,Vt.LINE_WIDTH),c7e=En(Vt,Vt.LINE_DASH_OFFSET),u7e=En(Vt,Vt.POINT_SIZE),d7e=En(Vt,Vt.DISPERSION),s$=En(Vt,Vt.LIGHT_MAP),h7e=En(Vt,Vt.AO),z_=rr(new vn).onReference(function(i){return i.material}).onRenderUpdate(function({material:i}){this.value.set(i.anisotropy*Math.cos(i.anisotropyRotation),i.anisotropy*Math.sin(i.anisotropyRotation))}),f7e=We(i=>i.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class ZVe extends _6{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const n=this.storageBufferNode.structTypeNode;return n?n.getMemberType(e,t):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let n;const r=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&r!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?n=e.generatePBO(this):n=this.node.build(e):n=super.generate(e),r!==!0){const s=this.getNodeType(e);n=e.format(n,s,t)}return n}}const QVe=Yr(ZVe).setParameterLength(2);class JVe extends Yq{static get type(){return"StorageBufferNode"}constructor(e,t=null,n=0){let r,s=null;t&&t.isStruct?(r="struct",s=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(n=e.count)):t===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(r=w8e(e.itemSize),n=e.count):r=t,super(e,r,n),this.isStorageBufferNode=!0,this.structTypeNode=s,this.access=sl.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return QVe(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(sl.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=Wq(this.value),this._varying=k4(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return this.structTypeNode!==null?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:n}=this.getAttributeData(),r=n.build(e);return e.registerTransform(r,t),r}}const w4=(i,e=null,t=0)=>new JVe(i,e,t);class po extends Yn{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let r;if(n===po.VERTEX)r=e.getVertexIndex();else if(n===po.INSTANCE)r=e.getInstanceIndex();else if(n===po.DRAW)r=e.getDrawIndex();else if(n===po.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(n===po.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(n===po.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=r:s=k4(this).build(e,t),s}}po.VERTEX="vertex";po.INSTANCE="instance";po.SUBGROUP="subgroup";po.INVOCATION_LOCAL="invocationLocal";po.INVOCATION_SUBGROUP="invocationSubgroup";po.DRAW="draw";const p7e=En(po,po.VERTEX),um=En(po,po.INSTANCE),eGe=En(po,po.SUBGROUP),tGe=En(po,po.INVOCATION_SUBGROUP),nGe=En(po,po.INVOCATION_LOCAL),m7e=En(po,po.DRAW);class g7e extends Yn{static get type(){return"InstanceNode"}constructor(e,t,n=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=n,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=Fr.FRAME,this.buffer=null,this.bufferColor=null,this.previousInstanceMatrixNode=null}get isStorageMatrix(){const{instanceMatrix:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}get isStorageColor(){const{instanceColor:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}setup(e){let{instanceMatrixNode:t,instanceColorNode:n}=this;t===null&&(t=this._createInstanceMatrixNode(!0,e),this.instanceMatrixNode=t);const{instanceColor:r,isStorageColor:s}=this;if(r&&n===null){if(s)n=w4(r,"vec3",Math.max(r.count,1)).element(um);else{const c=new J_(r.array,3),d=r.usage===uE?KH:gk;this.bufferColor=c,n=Ve(d(c,"vec3",3,0))}this.instanceColorNode=n}const a=t.mul(Po).xyz;if(Po.assign(a),e.needsPreviousData()&&Ox.assign(this.getPreviousInstancedPosition(e)),e.hasGeometryAttribute("normal")){const c=vye(Ru,t);Ru.assign(c)}this.instanceColorNode!==null&&wE("vec3","vInstanceColor").assign(this.instanceColorNode)}update(e){this.buffer!==null&&this.isStorageMatrix!==!0&&(this.buffer.clearUpdateRanges(),this.buffer.updateRanges.push(...this.instanceMatrix.updateRanges),this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version)),this.instanceColor&&this.bufferColor!==null&&this.isStorageColor!==!0&&(this.bufferColor.clearUpdateRanges(),this.bufferColor.updateRanges.push(...this.instanceColor.updateRanges),this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)),this.previousInstanceMatrixNode!==null&&e.object.previousInstanceMatrix.array.set(this.instanceMatrix.array)}getPreviousInstancedPosition(e){const t=e.object;return this.previousInstanceMatrixNode===null&&(t.previousInstanceMatrix=this.instanceMatrix.clone(),this.previousInstanceMatrixNode=this._createInstanceMatrixNode(!1,e)),this.previousInstanceMatrixNode.mul(Ox).xyz}_createInstanceMatrixNode(e,t){let n;const{instanceMatrix:r}=this,{count:s}=r;if(this.isStorageMatrix)n=w4(r,"mat4",Math.max(s,1)).element(um);else if(s*16*4<=t.getUniformBufferLimit())n=HE(r.array,"mat4",Math.max(s,1)).element(um);else{const c=new bDe(r.array,16,1);e===!0&&(this.buffer=c);const d=r.usage===uE?KH:gk,p=[d(c,"vec4",16,0),d(c,"vec4",16,4),d(c,"vec4",16,8),d(c,"vec4",16,12)];n=b4(...p)}return n}}const rGe=Yr(g7e).setParameterLength(2,3);class iGe extends g7e{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:n,instanceColor:r}=e;super(t,n,r),this.instancedMesh=e}}const v7e=Yr(iGe).setParameterLength(1);class sGe extends Yn{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=um:this.batchingIdNode=m7e);const n=We(([N])=>{const F=Fe(S4($o(this.batchMesh._indirectTexture),0).x).toConst(),U=Fe(N).mod(F).toConst(),R=Fe(N).div(F).toConst();return $o(this.batchMesh._indirectTexture,La(U,R)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(Fe(this.batchingIdNode)),r=this.batchMesh._matricesTexture,s=Fe(S4($o(r),0).x).toConst(),a=xe(n).mul(4).toInt().toConst(),c=a.mod(s).toConst(),d=a.div(s).toConst(),p=b4($o(r,La(c,d)),$o(r,La(c.add(1),d)),$o(r,La(c.add(2),d)),$o(r,La(c.add(3),d))),y=this.batchMesh._colorsTexture;if(y!==null){const F=We(([U])=>{const R=Fe(S4($o(y),0).x).toConst(),B=U,Y=B.mod(R).toConst(),A=B.div(R).toConst();return $o(y,La(Y,A)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(n);wE("vec3","vBatchColor").assign(F)}const x=P0(p);Po.assign(p.mul(Po));const w=Ru.div(Ve(x[0].dot(x[0]),x[1].dot(x[1]),x[2].dot(x[2]))),C=x.mul(w).xyz;Ru.assign(C),e.hasGeometryAttribute("tangent")&&Fx.mulAssign(x)}}const y7e=Yr(sGe).setParameterLength(1),O4e=new WeakMap;class _7e extends Yn{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=Fr.OBJECT,this.skinIndexNode=E2("skinIndex","uvec4"),this.skinWeightNode=E2("skinWeight","vec4"),this.bindMatrixNode=to("bindMatrix","mat4"),this.bindMatrixInverseNode=to("bindMatrixInverse","mat4"),this.boneMatricesNode=JH("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=Po,this.toPositionNode=Po,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:a}=this,c=e.element(n.x),d=e.element(n.y),p=e.element(n.z),y=e.element(n.w),x=s.mul(t),w=Ca(c.mul(r.x).mul(x),d.mul(r.y).mul(x),p.mul(r.z).mul(x),y.mul(r.w).mul(x));return a.mul(w).xyz}getSkinnedNormalAndTangent(e=this.boneMatricesNode,t=Ru,n=Fx){const{skinIndexNode:r,skinWeightNode:s,bindMatrixNode:a,bindMatrixInverseNode:c}=this,d=e.element(r.x),p=e.element(r.y),y=e.element(r.z),x=e.element(r.w);let w=Ca(s.x.mul(d),s.y.mul(p),s.z.mul(y),s.w.mul(x));w=c.mul(w).mul(a);const C=w.transformDirection(t).xyz,N=w.transformDirection(n).xyz;return{skinNormal:C,skinTangent:N}}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=JH("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,Ox)}setup(e){e.needsPreviousData()&&Ox.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const{skinNormal:n,skinTangent:r}=this.getSkinnedNormalAndTangent();Ru.assign(n),e.hasGeometryAttribute("tangent")&&Fx.assign(r)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;O4e.get(t)!==e.frameId&&(O4e.set(t,e.frameId),this.previousBoneMatricesNode!==null&&(t.previousBoneMatrices===null&&(t.previousBoneMatrices=new Float32Array(t.boneMatrices)),t.previousBoneMatrices.set(t.boneMatrices)),t.update())}}const x7e=i=>new _7e(i),oGe=(i,e=null)=>{const t=new _7e(i);return t.positionNode=w4(new J_(i.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(um).toVar(),t.skinIndexNode=w4(new J_(new Uint32Array(i.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(um).toVar(),t.skinWeightNode=w4(new J_(i.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(um).toVar(),t.bindMatrixNode=rr(i.bindMatrix,"mat4"),t.bindMatrixInverseNode=rr(i.bindMatrixInverse,"mat4"),t.boneMatricesNode=HE(i.skeleton.boneMatrices,"mat4",i.skeleton.bones.length),t.toPositionNode=e,qn(t)};class aGe extends Yn{static get type(){return"LoopNode"}constructor(e=[]){super("void"),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const n={};for(let c=0,d=this.params.length-1;c<d;c++){const p=this.params[c],y=p.isNode!==!0&&p.name||this.getVarName(c),x=p.isNode!==!0&&p.type||"int";n[y]=tp(y,x)}const r=e.addStack(),s=this.params[this.params.length-1](n);t.returnsNode=s.context({nodeLoop:s}),t.stackNode=r;const a=this.params[0];if(a.isNode!==!0&&typeof a.update=="function"){const c=We(this.params[0].update)(n);t.updateNode=c.context({nodeLoop:c})}return e.removeStack(),t}setup(e){if(this.getProperties(e),e.fnCall){const t=e.getDataFromNode(e.fnCall.shaderNode);t.hasLoop=!0}}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let a=0,c=n.length-1;a<c;a++){const d=n[a];let p=!1,y=null,x=null,w=null,C=null,N=null,F=null;d.isNode?d.getNodeType(e)==="bool"?(p=!0,C="bool",x=d.build(e,C)):(C="int",w=this.getVarName(a),y="0",x=d.build(e,C),N="<"):(C=d.type||"int",w=d.name||this.getVarName(a),y=d.start,x=d.end,N=d.condition,F=d.update,typeof y=="number"?y=e.generateConst(C,y):y&&y.isNode&&(y=y.build(e,C)),typeof x=="number"?x=e.generateConst(C,x):x&&x.isNode&&(x=x.build(e,C)),y!==void 0&&x===void 0?(y=y+" - 1",x="0",N=">="):x!==void 0&&y===void 0&&(y="0",N="<"),N===void 0&&(Number(y)>Number(x)?N=">=":N="<"));let U;if(p)U=`while ( ${x} )`;else{const R={start:y,end:x},B=R.start,Y=R.end;let A;const ne=()=>N.includes("<")?"+=":"-=";if(F!=null)switch(typeof F){case"function":A=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":A=w+" "+ne()+" "+e.generateConst(C,F);break;case"string":A=w+" "+F;break;default:F.isNode?A=w+" "+ne()+" "+F.build(e):(jt("TSL: 'Loop( { update: ... } )' is not a function, string or number.",this.stackTrace),A="break /* invalid update */")}else C==="int"||C==="uint"?F=N.includes("<")?"++":"--":F=ne()+" 1.",A=w+" "+F;const se=e.getVar(C,w)+" = "+B,oe=w+" "+N+" "+Y;U=`for ( ${se}; ${oe}; ${A} )`}e.addFlowCode((a===0?`
`:"")+e.tab+U+` {

`).addFlowTab()}const s=r.build(e,"void");t.returnsNode.build(e,"void"),e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,c=this.params.length-1;a<c;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();e.addFlowTab()}}const _s=(...i)=>new aGe(J8(i,"int")).toStack(),lGe=()=>tp("continue").toStack(),b7e=()=>tp("break").toStack(),wj=new WeakMap,gd=new wr,L4e=We(({bufferMap:i,influence:e,stride:t,width:n,depth:r,offset:s})=>{const a=Fe(p7e).mul(t).add(s),c=a.div(n),d=a.sub(c.mul(n));return $o(i,La(d,c)).depth(r).xyz.mul(e)});function cGe(i){const e=i.morphAttributes.position!==void 0,t=i.morphAttributes.normal!==void 0,n=i.morphAttributes.color!==void 0,r=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,s=r!==void 0?r.length:0;let a=wj.get(i);if(a===void 0||a.count!==s){let B=function(){U.dispose(),wj.delete(i),i.removeEventListener("dispose",B)};var c=B;a!==void 0&&a.texture.dispose();const d=i.morphAttributes.position||[],p=i.morphAttributes.normal||[],y=i.morphAttributes.color||[];let x=0;e===!0&&(x=1),t===!0&&(x=2),n===!0&&(x=3);let w=i.attributes.position.count*x,C=1;const N=4096;w>N&&(C=Math.ceil(w/N),w=N);const F=new Float32Array(w*C*4*s),U=new VW(F,w,C,s);U.type=mo,U.needsUpdate=!0;const R=x*4;for(let Y=0;Y<s;Y++){const A=d[Y],ne=p[Y],se=y[Y],oe=w*C*4*Y;for(let G=0;G<A.count;G++){const ie=G*R;e===!0&&(gd.fromBufferAttribute(A,G),F[oe+ie+0]=gd.x,F[oe+ie+1]=gd.y,F[oe+ie+2]=gd.z,F[oe+ie+3]=0),t===!0&&(gd.fromBufferAttribute(ne,G),F[oe+ie+4]=gd.x,F[oe+ie+5]=gd.y,F[oe+ie+6]=gd.z,F[oe+ie+7]=0),n===!0&&(gd.fromBufferAttribute(se,G),F[oe+ie+8]=gd.x,F[oe+ie+9]=gd.y,F[oe+ie+10]=gd.z,F[oe+ie+11]=se.itemSize===4?gd.w:1)}}a={count:s,texture:U,stride:x,size:new vn(w,C)},wj.set(i,a),i.addEventListener("dispose",B)}return a}class uGe extends Yn{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=rr(1),this.updateType=Fr.OBJECT}setup(e){const{geometry:t}=e,n=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,a=s!==void 0?s.length:0,{texture:c,stride:d,size:p}=cGe(t);n===!0&&Po.mulAssign(this.morphBaseInfluence),r===!0&&Ru.mulAssign(this.morphBaseInfluence);const y=Fe(p.width);_s(a,({i:x})=>{const w=xe(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?w.assign($o(this.mesh.morphTexture,La(Fe(x).add(1),Fe(um))).r):w.assign(to("morphTargetInfluences","float").element(x).toVar()),gr(w.notEqual(0),()=>{n===!0&&Po.addAssign(L4e({bufferMap:c,influence:w,stride:d,width:y,depth:x,offset:Fe(0)})),r===!0&&Ru.addAssign(L4e({bufferMap:c,influence:w,stride:d,width:y,depth:x,offset:Fe(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,n)=>t+n,0)}}const S7e=Yr(uGe).setParameterLength(1);class Kx extends Yn{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class dGe extends Kx{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class hGe extends N6e{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,r=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n=Ve().toVar("directDiffuse"),r=Ve().toVar("directSpecular"),s=Ve().toVar("indirectDiffuse"),a=Ve().toVar("indirectSpecular"),c={directDiffuse:n,directSpecular:r,indirectDiffuse:s,indirectSpecular:a};return{radiance:Ve().toVar("radiance"),irradiance:Ve().toVar("irradiance"),iblIrradiance:Ve().toVar("iblIrradiance"),ambientOcclusion:xe(1).toVar("ambientOcclusion"),reflectedLight:c,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const w7e=Yr(hGe);class fGe extends Kx{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}const T_=new vn;class fD extends fm{static get type(){return"ViewportTextureNode"}constructor(e=lm,t=null,n=null){let r=null;n===null?(r=new YW,r.minFilter=Tu,n=r):r=n,super(n,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=r,this.isOutputTextureNode=!0,this.updateBeforeType=Fr.RENDER,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let t,n;if(this.referenceNode?(t=this.referenceNode.defaultFramebuffer,n=this.referenceNode._cacheTextures):(t=this.defaultFramebuffer,n=this._cacheTextures),e===null)return t;if(n.has(e)===!1){const r=t.clone();n.set(e,r)}return n.get(e)}updateReference(e){const t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){const t=e.renderer,n=t.getRenderTarget();n===null?t.getDrawingBufferSize(T_):T_.set(n.width,n.height);const r=this.getTextureForReference(n);(r.image.width!==T_.width||r.image.height!==T_.height)&&(r.image.width=T_.width,r.image.height=T_.height,r.needsUpdate=!0);const s=r.generateMipmaps;r.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(r),r.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const pGe=Yr(fD).setParameterLength(0,3),o$=Yr(fD,null,null,{generateMipmaps:!0}).setParameterLength(0,3),mGe=o$(),T7e=(i=lm,e=null)=>mGe.sample(i,e);let dN=null;class gGe extends fD{static get type(){return"ViewportDepthTextureNode"}constructor(e=lm,t=null){dN===null&&(dN=new ll),super(e,t,dN)}getTextureForReference(){return dN}}const a$=Yr(gGe).setParameterLength(0,2);class Eu extends Yn{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Eu.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===Eu.DEPTH_BASE)n!==null&&(r=M7e().assign(n));else if(t===Eu.DEPTH)e.isPerspectiveCamera?r=l$(ua.z,a4,l4):r=rx(ua.z,a4,l4);else if(t===Eu.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const s=c$(n,a4,l4);r=rx(s,a4,l4)}else r=n;else r=rx(ua.z,a4,l4);return r}}Eu.DEPTH_BASE="depthBase";Eu.DEPTH="depth";Eu.LINEAR_DEPTH="linearDepth";const rx=(i,e,t)=>i.add(e).div(e.sub(t)),vGe=(i,e,t)=>i.add(t).div(t.sub(e)),yGe=We(([i,e,t],n)=>n.renderer.reversedDepthBuffer===!0?t.sub(e).mul(i).sub(t):e.sub(t).mul(i).sub(e)),l$=(i,e,t)=>e.add(i).mul(t).div(t.sub(e).mul(i)),E7e=(i,e,t)=>e.mul(i.add(t)).div(i.mul(e.sub(t))),c$=We(([i,e,t],n)=>n.renderer.reversedDepthBuffer===!0?e.mul(t).div(e.sub(t).mul(i).sub(e)):e.mul(t).div(t.sub(e).mul(i).sub(t))),u$=(i,e,t)=>{e=e.max(1e-6).toVar();const n=sm(i.negate().div(e)),r=sm(t.div(e));return n.div(r)},_Ge=(i,e,t)=>{const n=i.mul(rD(t.div(e)));return xe(Math.E).pow(n).mul(e).negate()},M7e=Yr(Eu,Eu.DEPTH_BASE),d$=En(Eu,Eu.DEPTH),vk=Yr(Eu,Eu.LINEAR_DEPTH).setParameterLength(0,1),xGe=vk(a$());d$.assign=i=>M7e(i);class Eh extends Yn{static get type(){return"ClippingNode"}constructor(e=Eh.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===Eh.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,r):this.scope===Eh.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(n,r)}setupAlphaToCoverage(e,t){return We(()=>{const n=xe().toVar("distanceToPlane"),r=xe().toVar("distanceToGradient"),s=xe(1).toVar("clipOpacity"),a=t.length;if(this.hardwareClipping===!1&&a>0){const d=Hl(t).setGroup(cr);_s(a,({i:p})=>{const y=d.element(p);n.assign(ua.dot(y.xyz).negate().add(y.w)),r.assign(n.fwidth().div(2)),s.mulAssign(ap(r.negate(),r,n))})}const c=e.length;if(c>0){const d=Hl(e).setGroup(cr),p=xe(1).toVar("intersectionClipOpacity");_s(c,({i:y})=>{const x=d.element(y);n.assign(ua.dot(x.xyz).negate().add(x.w)),r.assign(n.fwidth().div(2)),p.mulAssign(ap(r.negate(),r,n).oneMinus())}),s.mulAssign(p.oneMinus())}vs.a.mulAssign(s),vs.a.equal(0).discard()})()}setupDefault(e,t){return We(()=>{const n=t.length;if(this.hardwareClipping===!1&&n>0){const s=Hl(t).setGroup(cr);_s(n,({i:a})=>{const c=s.element(a);ua.dot(c.xyz).greaterThan(c.w).discard()})}const r=e.length;if(r>0){const s=Hl(e).setGroup(cr),a=Ch(!0).toVar("clipped");_s(r,({i:c})=>{const d=s.element(c);a.assign(ua.dot(d.xyz).greaterThan(d.w).and(a))}),a.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),We(()=>{const r=Hl(e).setGroup(cr),s=A2(t.getClipDistance());_s(n,({i:a})=>{const c=r.element(a),d=ua.dot(c.xyz).sub(c.w).negate();s.element(a).assign(d)})})()}}Eh.ALPHA_TO_COVERAGE="alphaToCoverage";Eh.DEFAULT="default";Eh.HARDWARE="hardware";const bGe=()=>new Eh,SGe=()=>new Eh(Eh.ALPHA_TO_COVERAGE),wGe=()=>new Eh(Eh.HARDWARE),TGe=.05,F4e=We(([i])=>sp(Ur(1e4,Nc(Ur(17,i.x).add(Ur(.1,i.y)))).mul(Ca(.1,Vs(Nc(Ur(13,i.y).add(i.x))))))),U4e=We(([i])=>F4e(en(F4e(i.xy),i.z))),EGe=We(([i])=>{const e=Io(am(Nq(i.xyz)),am(kq(i.xyz))),t=xe(1).div(xe(TGe).mul(e)).toVar("pixScale"),n=en(kx(om(sm(t))),kx(iD(sm(t)))),r=en(U4e(om(n.x.mul(i.xyz))),U4e(om(n.y.mul(i.xyz)))),s=sp(sm(t)),a=Ca(Ur(s.oneMinus(),r.x),Ur(s,r.y)),c=Pu(s,s.oneMinus()),d=Ve(a.mul(a).div(Ur(2,c).mul(Ri(1,c))),a.sub(Ur(.5,c)).div(Ri(1,c)),Ri(1,Ri(1,a).mul(Ri(1,a)).div(Ur(2,c).mul(Ri(1,c))))),p=a.lessThan(c.oneMinus()).select(a.lessThan(c).select(d.x,d.y),d.z);return op(p,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class MGe extends sye{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),n=e.hasGeometryAttribute(t);let r;return n===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new wr(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const C7e=(i=0)=>new MGe(i),CGe=We(([i,e])=>Pu(1,i.oneMinus().div(e)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),AGe=We(([i,e])=>Pu(i.div(e.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),PGe=We(([i,e])=>i.oneMinus().mul(e.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),RGe=We(([i,e])=>Ei(i.mul(2).mul(e),i.oneMinus().mul(2).mul(e.oneMinus()).oneMinus(),Dx(.5,i))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),IGe=We(([i,e])=>{const t=e.a.add(i.a.mul(e.a.oneMinus()));return hr(e.rgb.mul(e.a).add(i.rgb.mul(i.a).mul(e.a.oneMinus())).div(t),t)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),A7e=We(([i])=>hr(i.rgb.mul(i.a),i.a),{color:"vec4",return:"vec4"}),NGe=We(([i])=>(gr(i.a.equal(0),()=>hr(0)),hr(i.rgb.div(i.a),i.a)),{color:"vec4",return:"vec4"});class No extends R0{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.maskShadowNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,this.contextNode=null}_getNodeChildren(){const e=[];for(const t of Object.getOwnPropertyNames(this)){if(t.startsWith("_")===!0)continue;const n=this[t];n&&n.isNode===!0&&e.push({property:t,childNode:n})}return e}customProgramCacheKey(){const e=[];for(const{property:t,childNode:n}of this._getNodeChildren())e.push(Xx(t.slice(0,-4)),n.getCacheKey());return this.type+VE(e)}build(e){this.setup(e)}setupObserver(e){return new $Be(e)}setup(e){e.context.setupNormal=()=>t6(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,n=t.getRenderTarget();t.contextNode.isContextNode===!0?e.context={...e.context,...t.contextNode.getFlowContextData()}:jt('NodeMaterial: "renderer.contextNode" must be an instance of `context()`.'),this.contextNode!==null&&(this.contextNode.isContextNode===!0?e.context={...e.context,...this.contextNode.getFlowContextData()}:jt('NodeMaterial: "material.contextNode" must be an instance of `context()`.')),e.addStack();const r=this.setupVertex(e),s=t6(this.vertexNode||r,"VERTEX");e.context.clipSpace=s,e.stack.outputNode=s,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let a;const c=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(n!==null?n.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const d=this.setupLighting(e);c!==null&&e.stack.addToStack(c);const p=hr(d,vs.a).max(0);a=this.setupOutput(e,p),tx.assign(a);const y=this.outputNode!==null;if(y&&(a=this.outputNode),e.context.getOutput&&(a=e.context.getOutput(a,e)),n!==null){const x=t.getMRT(),w=this.mrtNode;x!==null?(y&&tx.assign(a),a=x,w!==null&&(a=x.merge(w))):w!==null&&(a=w)}}else{let d=this.fragmentNode;d.isOutputStructNode!==!0&&(d=hr(d)),a=this.setupOutput(e,d)}e.stack.outputNode=a,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:n}=e.clippingContext;let r=null;if(t.length>0||n.length>0){const s=e.renderer.currentSamples;this.alphaToCoverage&&s>1?r=SGe():e.stack.addToStack(bGe())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.addToStack(wGe()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:n}=e;let r=this.depthNode;if(r===null){const s=t.getMRT();s&&s.has("depth")?r=s.get("depth"):t.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?r=u$(ua.z,a4,l4):r=rx(ua.z,a4,l4))}r!==null&&d$.assign(r).toStack()}setupPositionView(){return O4.mul(Po).xyz}setupModelViewProjection(){return S2.mul(ua)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.position=e.removeStack(),f7e}setupPosition(e){const{object:t,geometry:n}=e;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&S7e(t).toStack(),t.isSkinnedMesh===!0&&x7e(t).toStack(),this.displacementMap){const r=f2("displacementMap","texture"),s=f2("displacementScale","float"),a=f2("displacementBias","float");Po.addAssign(Ru.normalize().mul(r.x.mul(s).add(a)))}return t.isBatchedMesh&&y7e(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&v7e(t).toStack(),this.positionNode!==null&&Po.assign(t6(this.positionNode,"POSITION","vec3")),Po}setupDiffuseColor(e){const{object:t,geometry:n}=e;this.maskNode!==null&&Ch(this.maskNode).not().discard();let r=this.colorNode?hr(this.colorNode):Fye;this.vertexColors===!0&&n.hasAttribute("color")&&(r=r.mul(C7e())),t.instanceColor&&(r=wE("vec3","vInstanceColor").mul(r)),t.isBatchedMesh&&t._colorsTexture&&(r=wE("vec3","vBatchColor").mul(r)),vs.assign(r);const s=this.opacityNode?xe(this.opacityNode):i$;vs.a.assign(vs.a.mul(s));let a=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(a=this.alphaTestNode!==null?xe(this.alphaTestNode):Lye,this.alphaToCoverage===!0?(vs.a=ap(a,a.add(Oq(vs.a)),vs.a),vs.a.lessThanEqual(0).discard()):vs.a.lessThanEqual(a).discard()),this.alphaHash===!0&&vs.a.lessThan(EGe(Po)).discard(),e.isOpaque()&&vs.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Ve(0):vs.rgb}setupNormal(){return this.normalNode?Ve(this.normalNode):Hye}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?f2("envMap","cubeTexture"):f2("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new fGe(s$)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const r=this.setupLightMap(e);r&&r.isLightingNode&&t.push(r);let s=this.aoNode;s===null&&e.material.aoMap&&(s=h7e),e.context.getAO&&(s=e.context.getAO(s,e)),s&&t.push(new dGe(s));let a=this.lightsNode||e.lightsNode;return t.length>0&&(a=e.renderer.lighting.createNode([...a.getLights(),...t])),a}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:r,emissiveNode:s}=this,c=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let d=this.setupOutgoingLight(e);if(c&&c.getScope().hasLights){const p=this.setupLightingModel(e)||null;d=w7e(c,p,n,r)}else n!==null&&(d=Ve(r!==null?Ei(d,n,r):n));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(XH.assign(Ve(s||Bye)),d=d.add(XH)),d}setupFog(e,t){const n=e.fogNode;return n&&(tx.assign(t),t=hr(n.toVar())),t}setupPremultipliedAlpha(e,t){return A7e(t)}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),this.premultipliedAlpha===!0&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(const n in e){const r=e[n];this[n]===void 0&&(this[n]=r,r&&r.clone&&(this[n]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&t[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const n=R0.prototype.toJSON.call(this,e);n.inputNodes={};for(const{property:s,childNode:a}of this._getNodeChildren())n.inputNodes[s]=a.toJSON(e).uuid;function r(s){const a=[];for(const c in s){const d=s[c];delete d.metadata,a.push(d)}return a}if(t){const s=r(e.textures),a=r(e.images),c=r(e.nodes);s.length>0&&(n.textures=s),a.length>0&&(n.images=a),c.length>0&&(n.nodes=c)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.aoNode=e.aoNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.maskShadowNode=e.maskShadowNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,this.contextNode=e.contextNode,super.copy(e)}}const kGe=new Td;class DGe extends No{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(kGe),this.setValues(e)}}const OGe=new Vke;class LGe extends No{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(OGe),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?xe(this.offsetNode):c7e,t=this.dashScaleNode?xe(this.dashScaleNode):o7e,n=this.dashSizeNode?xe(this.dashSizeNode):a7e,r=this.gapSizeNode?xe(this.gapSizeNode):l7e;$N.assign(n),YH.assign(r);const s=k4(E2("lineDistance").mul(t));(e?s.add(e):s).mod($N.add(YH)).greaterThan($N).discard()}}const FGe=new eq;class h$ extends No{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(FGe),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?xe(this.opacityNode):i$;vs.assign(oD(hr(Oye(ji),e),ti))}}const f$=We(([i=Qq])=>{const e=i.z.atan(i.x).mul(1/(Math.PI*2)).add(.5),t=i.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return en(e,t)});class P7e extends lp{constructor(e=1,t={}){super(e,e,t),this.isCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new g6(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new qo(5,5,5),a=f$(Qq),c=new No;c.colorNode=$i(t,a,0),c.side=Ui,c.blending=vo;const d=new fn(s,c),p=new c6;p.add(d),t.minFilter===Tu&&(t.minFilter=Bi);const y=new l8e(1,10,this),x=e.getMRT();return e.setMRT(null),y.update(e,p),e.setMRT(x),t.minFilter=n,t.currentGenerateMipmaps=r,d.geometry.dispose(),d.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(s)}}const YT=new WeakMap;class UGe extends Yo{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=Dc(null);const t=new g6;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=Fr.RENDER}updateBefore(e){const{renderer:t,material:n}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const s=r.isTextureNode?r.value:n[r.property];if(s&&s.isTexture){const a=s.mapping;if(a===K8||a===K_){if(YT.has(s)){const c=YT.get(s);B4e(c,s.mapping),this._cubeTexture=c}else{const c=s.image;if(BGe(c)){const d=new P7e(c.height);d.fromEquirectangularTexture(t,s),B4e(d.texture,s.mapping),this._cubeTexture=d.texture,YT.set(s,d.texture),s.addEventListener("dispose",R7e)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function BGe(i){return i==null?!1:i.height>0}function R7e(i){const e=i.target;e.removeEventListener("dispose",R7e);const t=YT.get(e);t!==void 0&&(YT.delete(e),t.dispose())}function B4e(i,e){e===K8?i.mapping=np:e===K_&&(i.mapping=hm)}const I7e=Yr(UGe).setParameterLength(1);class p$ extends Kx{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=I7e(this.envNode)}}class zGe extends Kx{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=xe(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class pD{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class N7e extends pD{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,n=e.reflectedLight,r=e.irradianceLightMap;n.indirectDiffuse.assign(hr(0)),r?n.indirectDiffuse.addAssign(r):n.indirectDiffuse.addAssign(hr(1,1,1,0)),n.indirectDiffuse.mulAssign(t),n.indirectDiffuse.mulAssign(vs.rgb)}finish(e){const{material:t,context:n}=e,r=n.outgoingLight,s=e.context.environment;if(s)switch(t.combine){case DE:r.rgb.assign(Ei(r.rgb,r.rgb.mul(s.rgb),XT.mul(ZN)));break;case Dve:r.rgb.assign(Ei(r.rgb,s.rgb,XT.mul(ZN)));break;case Ove:r.rgb.addAssign(s.rgb.mul(XT.mul(ZN)));break;default:Wt("BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const VGe=new Ua;class m$ extends No{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(VGe),this.setValues(e)}setupNormal(){return Yx(Lx)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new p$(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new zGe(s$)),t}setupOutgoingLight(){return vs.rgb}setupLightingModel(){return new N7e}}const Ux=We(({f0:i,f90:e,dotVH:t})=>{const n=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return i.mul(n.oneMinus()).add(e.mul(n))}),h6=We(i=>i.diffuseColor.mul(1/Math.PI)),GGe=()=>xe(.25),jGe=We(({dotNH:i})=>fk.mul(xe(.5)).add(1).mul(xe(1/Math.PI)).mul(i.pow(fk))),HGe=We(({lightDirection:i})=>{const e=i.add(ks).normalize(),t=ji.dot(e).clamp(),n=ks.dot(e).clamp(),r=Ux({f0:R4,f90:1,dotVH:n}),s=GGe(),a=jGe({dotNH:t});return r.mul(s).mul(a)});class k7e extends N7e{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=ji.dot(e).clamp().mul(t);n.directDiffuse.addAssign(s.mul(h6({diffuseColor:vs.rgb}))),this.specular===!0&&n.directSpecular.addAssign(s.mul(HGe({lightDirection:e})).mul(XT))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(h6({diffuseColor:vs}))),r.indirectDiffuse.mulAssign(t)}}const WGe=new Qve;class qGe extends No{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(WGe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new p$(t):null}setupLightingModel(){return new k7e(!1)}}const $Ge=new q8;class XGe extends No{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues($Ge),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new p$(t):null}setupLightingModel(){return new k7e}setupVariants(){const e=(this.shininessNode?xe(this.shininessNode):Uye).max(1e-4);fk.assign(e);const t=this.specularNode||zye;R4.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const D7e=We(i=>{if(i.geometry.hasAttribute("normal")===!1)return xe(0);const e=Lx.dFdx().abs().max(Lx.dFdy().abs());return e.x.max(e.y).max(e.z)}),g$=We(i=>{const{roughness:e}=i,t=D7e();let n=e.max(.0525);return n=n.add(t),n=n.min(1),n}),O7e=We(({alpha:i,dotNL:e,dotNV:t})=>{const n=i.pow2(),r=e.mul(n.add(n.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return wd(.5,r.add(s).max(Eq))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),YGe=We(({alphaT:i,alphaB:e,dotTV:t,dotBV:n,dotTL:r,dotBL:s,dotNV:a,dotNL:c})=>{const d=c.mul(Ve(i.mul(t),e.mul(n),a).length()),p=a.mul(Ve(i.mul(r),e.mul(s),c).length());return wd(.5,d.add(p))}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),L7e=We(({alpha:i,dotNH:e})=>{const t=i.pow2(),n=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),KGe=xe(1/Math.PI),ZGe=We(({alphaT:i,alphaB:e,dotNH:t,dotTH:n,dotBH:r})=>{const s=i.mul(e),a=Ve(e.mul(n),i.mul(r),s.mul(t)),c=a.dot(a),d=s.div(c);return KGe.mul(s.mul(d.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),v$=We(({lightDirection:i,f0:e,f90:t,roughness:n,f:r,normalView:s=ji,USE_IRIDESCENCE:a,USE_ANISOTROPY:c})=>{const d=n.pow2(),p=i.add(ks).normalize(),y=s.dot(i).clamp(),x=s.dot(ks).clamp(),w=s.dot(p).clamp(),C=ks.dot(p).clamp();let N=Ux({f0:e,f90:t,dotVH:C}),F,U;if(bE(a)&&(N=tD.mix(N,r)),bE(c)){const R=qT.dot(i),B=qT.dot(ks),Y=qT.dot(p),A=e6.dot(i),ne=e6.dot(ks),se=e6.dot(p);F=YGe({alphaT:hk,alphaB:d,dotTV:B,dotBV:ne,dotTL:R,dotBL:A,dotNV:x,dotNL:y}),U=ZGe({alphaT:hk,alphaB:d,dotNH:w,dotTH:Y,dotBH:se})}else F=O7e({alpha:d,dotNL:y,dotNV:x}),U=L7e({alpha:d,dotNH:w});return N.mul(F).mul(U)}),QGe=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let V1=null;const TE=We(({roughness:i,dotNV:e})=>{V1===null&&(V1=new d4(QGe,16,16,Oc,Gs),V1.name="DFG_LUT",V1.minFilter=Bi,V1.magFilter=Bi,V1.wrapS=Co,V1.wrapT=Co,V1.generateMipmaps=!1,V1.needsUpdate=!0);const t=en(i,e);return $i(V1,t).rg}),JGe=We(({lightDirection:i,f0:e,f90:t,roughness:n,f:r,USE_IRIDESCENCE:s,USE_ANISOTROPY:a})=>{const c=v$({lightDirection:i,f0:e,f90:t,roughness:n,f:r,USE_IRIDESCENCE:s,USE_ANISOTROPY:a}),d=ji.dot(i).clamp(),p=ji.dot(ks).clamp(),y=TE({roughness:n,dotNV:p}),x=TE({roughness:n,dotNV:d}),w=e.mul(y.x).add(t.mul(y.y)),C=e.mul(x.x).add(t.mul(x.y)),N=y.x.add(y.y),F=x.x.add(x.y),U=xe(1).sub(N),R=xe(1).sub(F),B=e.add(e.oneMinus().mul(.047619)),Y=w.mul(C).mul(B).div(xe(1).sub(U.mul(R).mul(B).mul(B)).add(Eq)),A=U.mul(R),ne=Y.mul(A);return c.add(ne)}),F7e=We(i=>{const{dotNV:e,specularColor:t,specularF90:n,roughness:r}=i,s=TE({dotNV:e,roughness:r});return t.mul(s.x).add(n.mul(s.y))}),sW=We(({f:i,f90:e,dotVH:t})=>{const n=t.oneMinus().saturate(),r=n.mul(n),s=n.mul(r,r).clamp(0,.9999);return i.sub(Ve(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),eje=We(({roughness:i,dotNH:e})=>{const t=i.pow2(),n=xe(1).div(t),s=e.pow2().oneMinus().max(.0078125);return xe(2).add(n).mul(s.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),tje=We(({dotNV:i,dotNL:e})=>xe(1).div(xe(4).mul(e.add(i).sub(e.mul(i))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),nje=We(({lightDirection:i})=>{const e=i.add(ks).normalize(),t=ji.dot(i).clamp(),n=ji.dot(ks).clamp(),r=ji.dot(e).clamp(),s=eje({roughness:o4,dotNH:r}),a=tje({dotNV:n,dotNL:t});return vd.mul(s).mul(a)}),z4e=We(({N:i,V:e,roughness:t})=>{const s=.0078125,a=i.dot(e).saturate(),c=en(t,a.oneMinus().sqrt());return c.assign(c.mul(.984375).add(s)),c}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),rje=We(({f:i})=>{const e=i.length();return Io(e.mul(e).add(i.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),hN=We(({v1:i,v2:e})=>{const t=i.dot(e),n=t.abs().toVar(),r=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),s=n.add(4.1616724).mul(n).add(3.417594).toVar(),a=r.div(s),c=t.greaterThan(0).select(a,Io(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return i.cross(e).mul(c)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),Tj=We(({N:i,V:e,P:t,mInv:n,p0:r,p1:s,p2:a,p3:c})=>{const d=s.sub(r).toVar(),p=c.sub(r).toVar(),y=d.cross(p),x=Ve().toVar();return gr(y.dot(t.sub(r)).greaterThanEqual(0),()=>{const w=e.sub(i.mul(e.dot(i))).normalize(),C=i.cross(w).negate(),N=n.mul(P0(w,C,i).transpose()).toVar(),F=N.mul(r.sub(t)).normalize().toVar(),U=N.mul(s.sub(t)).normalize().toVar(),R=N.mul(a.sub(t)).normalize().toVar(),B=N.mul(c.sub(t)).normalize().toVar(),Y=Ve(0).toVar();Y.addAssign(hN({v1:F,v2:U})),Y.addAssign(hN({v1:U,v2:R})),Y.addAssign(hN({v1:R,v2:B})),Y.addAssign(hN({v1:B,v2:F})),x.assign(Ve(rje({f:Y})))}),x}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),mD=1/6,U7e=i=>Ur(mD,Ur(i,Ur(i,i.negate().add(3)).sub(3)).add(1)),oW=i=>Ur(mD,Ur(i,Ur(i,Ur(3,i).sub(6))).add(4)),B7e=i=>Ur(mD,Ur(i,Ur(i,Ur(-3,i).add(3)).add(3)).add(1)),aW=i=>Ur(mD,Sh(i,3)),V4e=i=>U7e(i).add(oW(i)),G4e=i=>B7e(i).add(aW(i)),j4e=i=>Ca(-1,oW(i).div(U7e(i).add(oW(i)))),H4e=i=>Ca(1,aW(i).div(B7e(i).add(aW(i)))),W4e=(i,e,t)=>{const n=i.uvNode,r=Ur(n,e.zw).add(.5),s=om(r),a=sp(r),c=V4e(a.x),d=G4e(a.x),p=j4e(a.x),y=H4e(a.x),x=j4e(a.y),w=H4e(a.y),C=en(s.x.add(p),s.y.add(x)).sub(.5).mul(e.xy),N=en(s.x.add(y),s.y.add(x)).sub(.5).mul(e.xy),F=en(s.x.add(p),s.y.add(w)).sub(.5).mul(e.xy),U=en(s.x.add(y),s.y.add(w)).sub(.5).mul(e.xy),R=V4e(a.y).mul(Ca(c.mul(i.sample(C).level(t)),d.mul(i.sample(N).level(t)))),B=G4e(a.y).mul(Ca(c.mul(i.sample(F).level(t)),d.mul(i.sample(U).level(t))));return R.add(B)},y$=We(([i,e])=>{const t=en(i.size(Fe(e))),n=en(i.size(Fe(e.add(1)))),r=wd(1,t),s=wd(1,n),a=W4e(i,hr(r,t),om(e)),c=W4e(i,hr(s,n),iD(e));return sp(e).mix(a,c)}),ije=We(([i,e])=>{const t=e.mul($q(i));return y$(i,t)}),q4e=We(([i,e,t,n,r])=>{const s=Ve(Bq(e.negate(),Au(i),wd(1,n))),a=Ve(am(r[0].xyz),am(r[1].xyz),am(r[2].xyz));return Au(s).mul(t.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),sje=We(([i,e])=>i.mul(op(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),oje=o$(),aje=T7e(),$4e=We(([i,e,t],{material:n})=>{const s=(n.side===Ui?oje:aje).sample(i),a=sm(d6.x).mul(sje(e,t));return y$(s,a)}),X4e=We(([i,e,t])=>(gr(t.notEqual(0),()=>{const n=rD(e).negate().div(t);return Mq(n.negate().mul(i))}),Ve(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),lje=We(([i,e,t,n,r,s,a,c,d,p,y,x,w,C,N])=>{let F,U;if(N){F=hr().toVar(),U=Ve().toVar();const ne=y.sub(1).mul(N.mul(.025)),se=Ve(y.sub(ne),y,y.add(ne));_s({start:0,end:3},({i:oe})=>{const G=se.element(oe),ie=q4e(i,e,x,G,c),Me=a.add(ie),X=p.mul(d.mul(hr(Me,1))),De=en(X.xy.div(X.w)).toVar();De.addAssign(1),De.divAssign(2),De.assign(en(De.x,De.y.oneMinus()));const $e=$4e(De,t,G);F.element(oe).assign($e.element(oe)),F.a.addAssign($e.a),U.element(oe).assign(n.element(oe).mul(X4e(am(ie),w,C).element(oe)))}),F.a.divAssign(3)}else{const ne=q4e(i,e,x,y,c),se=a.add(ne),oe=p.mul(d.mul(hr(se,1))),G=en(oe.xy.div(oe.w)).toVar();G.addAssign(1),G.divAssign(2),G.assign(en(G.x,G.y.oneMinus())),F=$4e(G,t,y),U=n.mul(X4e(am(ne),w,C))}const R=U.rgb.mul(F.rgb),B=i.dot(e).clamp(),Y=Ve(F7e({dotNV:B,specularColor:r,specularF90:s,roughness:t})),A=U.r.add(U.g,U.b).div(3);return hr(Y.oneMinus().mul(R),F.a.oneMinus().mul(A).oneMinus())}),cje=P0(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),uje=i=>{const e=i.sqrt();return Ve(1).add(e).div(Ve(1).sub(e))},Y4e=(i,e)=>i.sub(e).div(i.add(e)).pow2(),dje=(i,e)=>{const t=i.mul(2*Math.PI*1e-9),n=Ve(54856e-17,44201e-17,52481e-17),r=Ve(1681e3,1795300,2208400),s=Ve(43278e5,93046e5,66121e5),a=xe(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let c=n.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return c=Ve(c.x.add(a),c.y,c.z).div(10685e-11),cje.mul(c)},K4e=We(({outsideIOR:i,eta2:e,cosTheta1:t,thinFilmThickness:n,baseF0:r})=>{const s=Ei(i,e,ap(0,.03,n)),c=i.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();gr(c.lessThan(0),()=>Ve(1));const d=c.sqrt(),p=Y4e(s,i),y=Ux({f0:p,f90:1,dotVH:t}),x=y.oneMinus(),w=s.lessThan(i).select(Math.PI,0),C=xe(Math.PI).sub(w),N=uje(r.clamp(0,.9999)),F=Y4e(N,s.toVec3()),U=Ux({f0:F,f90:1,dotVH:d}),R=Ve(N.x.lessThan(s).select(Math.PI,0),N.y.lessThan(s).select(Math.PI,0),N.z.lessThan(s).select(Math.PI,0)),B=s.mul(n,d,2),Y=Ve(C).add(R),A=y.mul(U).clamp(1e-5,.9999),ne=A.sqrt(),se=x.pow2().mul(U).div(Ve(1).sub(A)),G=y.add(se).toVar(),ie=se.sub(x).toVar();return _s({start:1,end:2,condition:"<=",name:"m"},({m:Me})=>{ie.mulAssign(ne);const X=dje(xe(Me).mul(B),xe(Me).mul(Y)).mul(2);G.addAssign(ie.mul(X))}),G.max(Ve(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),lT=We(({normal:i,viewDir:e,roughness:t})=>{const n=i.dot(e).saturate(),r=t.mul(t),s=t.add(.1).reciprocal(),a=xe(-1.9362).add(t.mul(1.0678)).add(r.mul(.4573)).sub(s.mul(.8469)),c=xe(-.6014).add(t.mul(.5538)).sub(r.mul(.467)).sub(s.mul(.1255));return a.mul(n).add(c).exp().saturate()}),cT=Ve(.04),fN=xe(1);class z7e extends pD{constructor(e=!1,t=!1,n=!1,r=!1,s=!1,a=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=r,this.transmission=s,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null,this.iridescenceF0Dielectric=null,this.iridescenceF0Metallic=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Ve().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Ve().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Ve().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Ve().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Ve().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=ji.dot(ks).clamp(),n=K4e({outsideIOR:xe(1),eta2:uk,cosTheta1:t,thinFilmThickness:dk,baseF0:R4}),r=K4e({outsideIOR:xe(1),eta2:uk,cosTheta1:t,thinFilmThickness:dk,baseF0:vs.rgb});this.iridescenceFresnel=Ei(n,r,_2),this.iridescenceF0Dielectric=sW({f:n,f90:1,dotVH:t}),this.iridescenceF0Metallic=sW({f:r,f90:1,dotVH:t}),this.iridescenceF0=Ei(this.iridescenceF0Dielectric,this.iridescenceF0Metallic,_2)}if(this.transmission===!0){const t=cm,n=uye.sub(cm).normalize(),r=L4,s=e.context;s.backdrop=lje(r,n,J1,V8,$8,X8,t,wh,Nh,S2,$T,_q,bq,xq,this.dispersion?Sq:null),s.backdropAlpha=pk,vs.a.mulAssign(Ei(1,s.backdrop.a,pk))}super.start(e)}computeMultiscattering(e,t,n,r,s=null){const a=ji.dot(ks).clamp(),c=TE({roughness:J1,dotNV:a}),d=s?tD.mix(r,s):r,p=d.mul(c.x).add(n.mul(c.y)),x=c.x.add(c.y).oneMinus(),w=d.add(d.oneMinus().mul(.047619)),C=p.mul(w).div(x.mul(w).oneMinus());e.addAssign(p),t.addAssign(C.mul(x))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=ji.dot(e).clamp().mul(t).toVar();if(this.sheen===!0){this.sheenSpecularDirect.addAssign(s.mul(nje({lightDirection:e})));const a=lT({normal:ji,viewDir:ks,roughness:o4}),c=lT({normal:ji,viewDir:e,roughness:o4}),d=vd.r.max(vd.g).max(vd.b).mul(a.max(c)).oneMinus();s.mulAssign(d)}if(this.clearcoat===!0){const c=c4.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(c.mul(v$({lightDirection:e,f0:cT,f90:fN,roughness:ex,normalView:c4})))}n.directDiffuse.addAssign(s.mul(h6({diffuseColor:V8}))),n.directSpecular.addAssign(s.mul(JGe({lightDirection:e,f0:$8,f90:1,roughness:J1,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:r,reflectedLight:s,ltc_1:a,ltc_2:c}){const d=t.add(n).sub(r),p=t.sub(n).sub(r),y=t.sub(n).add(r),x=t.add(n).add(r),w=ji,C=ks,N=ua.toVar(),F=z4e({N:w,V:C,roughness:J1}),U=a.sample(F).toVar(),R=c.sample(F).toVar(),B=P0(Ve(U.x,0,U.y),Ve(0,1,0),Ve(U.z,0,U.w)).toVar(),Y=$8.mul(R.x).add(X8.sub($8).mul(R.y)).toVar();if(s.directSpecular.addAssign(e.mul(Y).mul(Tj({N:w,V:C,P:N,mInv:B,p0:d,p1:p,p2:y,p3:x}))),s.directDiffuse.addAssign(e.mul(V8).mul(Tj({N:w,V:C,P:N,mInv:P0(1,0,0,0,1,0,0,0,1),p0:d,p1:p,p2:y,p3:x}))),this.clearcoat===!0){const A=c4,ne=z4e({N:A,V:C,roughness:ex}),se=a.sample(ne),oe=c.sample(ne),G=P0(Ve(se.x,0,se.y),Ve(0,1,0),Ve(se.z,0,se.w)),ie=cT.mul(oe.x).add(fN.sub(cT).mul(oe.y));this.clearcoatSpecularDirect.addAssign(e.mul(ie).mul(Tj({N:A,V:C,P:N,mInv:G,p0:d,p1:p,p2:y,p3:x})))}}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:n}=e.context,r=t.mul(h6({diffuseColor:V8})).toVar();if(this.sheen===!0){const s=lT({normal:ji,viewDir:ks,roughness:o4}),a=vd.r.max(vd.g).max(vd.b).mul(s).oneMinus();r.mulAssign(a)}n.indirectDiffuse.addAssign(r)}indirectSpecular(e){const{radiance:t,iblIrradiance:n,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(n.mul(vd,lT({normal:ji,viewDir:ks,roughness:o4}))),this.clearcoat===!0){const U=c4.dot(ks).clamp(),R=F7e({dotNV:U,specularColor:cT,specularF90:fN,roughness:ex});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(R))}const s=Ve().toVar("singleScatteringDielectric"),a=Ve().toVar("multiScatteringDielectric"),c=Ve().toVar("singleScatteringMetallic"),d=Ve().toVar("multiScatteringMetallic");this.computeMultiscattering(s,a,X8,R4,this.iridescenceF0Dielectric),this.computeMultiscattering(c,d,X8,vs.rgb,this.iridescenceF0Metallic);const p=Ei(s,c,_2),y=Ei(a,d,_2),x=s.add(a),w=V8.mul(x.oneMinus()),C=n.mul(1/Math.PI),N=t.mul(p).add(y.mul(C)).toVar(),F=w.mul(C).toVar();if(this.sheen===!0){const U=lT({normal:ji,viewDir:ks,roughness:o4}),R=vd.r.max(vd.g).max(vd.b).mul(U).oneMinus();N.mulAssign(R),F.mulAssign(R)}r.indirectSpecular.addAssign(N),r.indirectDiffuse.addAssign(F)}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:n}=e.context,s=ji.dot(ks).clamp().add(t),a=J1.mul(-16).oneMinus().negate().exp2(),c=t.sub(s.pow(a).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(c)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const n=c4.dot(ks).clamp(),r=Ux({dotVH:n,f0:cT,f90:fN}),s=t.mul(ck.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(ck));t.assign(s)}if(this.sheen===!0){const n=t.add(this.sheenSpecularDirect,this.sheenSpecularIndirect.mul(1/Math.PI));t.assign(n)}}}const Z4e=xe(1),lW=xe(-2),pN=xe(.8),Ej=xe(-1),mN=xe(.4),Mj=xe(2),gN=xe(.305),Cj=xe(3),Q4e=xe(.21),hje=xe(4),J4e=xe(4),fje=xe(16),pje=We(([i])=>{const e=Ve(Vs(i)).toVar(),t=xe(-1).toVar();return gr(e.x.greaterThan(e.z),()=>{gr(e.x.greaterThan(e.y),()=>{t.assign($l(i.x.greaterThan(0),0,3))}).Else(()=>{t.assign($l(i.y.greaterThan(0),1,4))})}).Else(()=>{gr(e.z.greaterThan(e.y),()=>{t.assign($l(i.z.greaterThan(0),2,5))}).Else(()=>{t.assign($l(i.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),mje=We(([i,e])=>{const t=en().toVar();return gr(e.equal(0),()=>{t.assign(en(i.z,i.y).div(Vs(i.x)))}).ElseIf(e.equal(1),()=>{t.assign(en(i.x.negate(),i.z.negate()).div(Vs(i.y)))}).ElseIf(e.equal(2),()=>{t.assign(en(i.x.negate(),i.y).div(Vs(i.z)))}).ElseIf(e.equal(3),()=>{t.assign(en(i.z.negate(),i.y).div(Vs(i.x)))}).ElseIf(e.equal(4),()=>{t.assign(en(i.x.negate(),i.z).div(Vs(i.y)))}).Else(()=>{t.assign(en(i.x,i.y).div(Vs(i.z)))}),Ur(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),gje=We(([i])=>{const e=xe(0).toVar();return gr(i.greaterThanEqual(pN),()=>{e.assign(Z4e.sub(i).mul(Ej.sub(lW)).div(Z4e.sub(pN)).add(lW))}).ElseIf(i.greaterThanEqual(mN),()=>{e.assign(pN.sub(i).mul(Mj.sub(Ej)).div(pN.sub(mN)).add(Ej))}).ElseIf(i.greaterThanEqual(gN),()=>{e.assign(mN.sub(i).mul(Cj.sub(Mj)).div(mN.sub(gN)).add(Mj))}).ElseIf(i.greaterThanEqual(Q4e),()=>{e.assign(gN.sub(i).mul(hje.sub(Cj)).div(gN.sub(Q4e)).add(Cj))}).Else(()=>{e.assign(xe(-2).mul(sm(Ur(1.16,i))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),V7e=We(([i,e])=>{const t=i.toVar();t.assign(Ur(2,t).sub(1));const n=Ve(t,1).toVar();return gr(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),G7e=We(([i,e,t,n,r,s])=>{const a=xe(t),c=Ve(e),d=op(gje(a),lW,s),p=sp(d),y=om(d),x=Ve(EE(i,c,y,n,r,s)).toVar();return gr(p.notEqual(0),()=>{const w=Ve(EE(i,c,y.add(1),n,r,s)).toVar();x.assign(Ei(x,w,p))}),x}),EE=We(([i,e,t,n,r,s])=>{const a=xe(t).toVar(),c=Ve(e),d=xe(pje(c)).toVar(),p=xe(Io(J4e.sub(a),0)).toVar();a.assign(Io(a,J4e));const y=xe(kx(a)).toVar(),x=en(mje(c,d).mul(y.sub(2)).add(1)).toVar();return gr(d.greaterThan(2),()=>{x.y.addAssign(y),d.subAssign(3)}),x.x.addAssign(d.mul(y)),x.x.addAssign(p.mul(Ur(3,fje))),x.y.addAssign(Ur(4,kx(s).sub(y))),x.x.mulAssign(n),x.y.mulAssign(r),i.sample(x).grad(en(),en())}),Aj=We(({envMap:i,mipInt:e,outputDirection:t,theta:n,axis:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:c})=>{const d=Kf(n),p=t.mul(d).add(r.cross(t).mul(Nc(n))).add(r.mul(r.dot(t).mul(d.oneMinus())));return EE(i,p,e,s,a,c)}),j7e=We(({n:i,latitudinal:e,poleAxis:t,outputDirection:n,weights:r,samples:s,dTheta:a,mipInt:c,envMap:d,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x})=>{const w=Ve($l(e,t,T2(t,n))).toVar();gr(w.equal(Ve(0)),()=>{w.assign(Ve(n.z,0,n.x.negate()))}),w.assign(Au(w));const C=Ve().toVar();return C.addAssign(r.element(0).mul(Aj({theta:0,axis:w,outputDirection:n,mipInt:c,envMap:d,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x}))),_s({start:Fe(1),end:i},({i:N})=>{gr(N.greaterThanEqual(s),()=>{b7e()});const F=xe(a.mul(xe(N))).toVar();C.addAssign(r.element(N).mul(Aj({theta:F.mul(-1),axis:w,outputDirection:n,mipInt:c,envMap:d,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x}))),C.addAssign(r.element(N).mul(Aj({theta:F,axis:w,outputDirection:n,mipInt:c,envMap:d,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x})))}),hr(C,1)}),vje=We(([i])=>{const e=Zt(i).toVar();return e.assign(e.shiftLeft(Zt(16)).bitOr(e.shiftRight(Zt(16)))),e.assign(e.bitAnd(Zt(1431655765)).shiftLeft(Zt(1)).bitOr(e.bitAnd(Zt(2863311530)).shiftRight(Zt(1)))),e.assign(e.bitAnd(Zt(858993459)).shiftLeft(Zt(2)).bitOr(e.bitAnd(Zt(3435973836)).shiftRight(Zt(2)))),e.assign(e.bitAnd(Zt(252645135)).shiftLeft(Zt(4)).bitOr(e.bitAnd(Zt(4042322160)).shiftRight(Zt(4)))),e.assign(e.bitAnd(Zt(16711935)).shiftLeft(Zt(8)).bitOr(e.bitAnd(Zt(4278255360)).shiftRight(Zt(8)))),xe(e).mul(23283064365386963e-26)}),yje=We(([i,e])=>en(xe(i).div(xe(e)),vje(i))),_je=We(([i,e,t])=>{const n=t.mul(t).toConst(),r=Ve(1,0,0).toConst(),s=T2(e,r).toConst(),a=Lc(i.x).toConst(),c=Ur(2,3.14159265359).mul(i.y).toConst(),d=a.mul(Kf(c)).toConst(),p=a.mul(Nc(c)).toVar(),y=Ur(.5,e.z.add(1)).toConst();p.assign(y.oneMinus().mul(Lc(d.mul(d).oneMinus())).add(y.mul(p)));const x=r.mul(d).add(s.mul(p)).add(e.mul(Lc(Io(0,d.mul(d).add(p.mul(p)).oneMinus()))));return Au(Ve(n.mul(x.x),n.mul(x.y),Io(0,x.z)))}),H7e=We(({roughness:i,mipInt:e,envMap:t,N_immutable:n,GGX_SAMPLES:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:c})=>{const d=Ve(n).toVar(),p=Ve(0).toVar(),y=xe(0).toVar();return gr(i.lessThan(.001),()=>{p.assign(EE(t,d,e,s,a,c))}).Else(()=>{const x=$l(Vs(d.z).lessThan(.999),Ve(0,0,1),Ve(1,0,0)),w=Au(T2(x,d)).toVar(),C=T2(d,w).toVar();_s({start:Zt(0),end:r},({i:N})=>{const F=yje(N,r),U=_je(F,Ve(0,0,1),i),R=Au(w.mul(U.x).add(C.mul(U.y)).add(d.mul(U.z))),B=Au(R.mul(Ah(d,R).mul(2)).sub(d)),Y=Io(Ah(d,B),0);gr(Y.greaterThan(0),()=>{const A=EE(t,B,e,s,a,c);p.addAssign(A.mul(Y)),y.addAssign(Y)})}),gr(y.greaterThan(0),()=>{p.assign(p.div(y))})}),hr(p,1)}),p4=4,e5e=[.125,.215,.35,.446,.526,.582],G8=20,xje=512,uT=new w2(-1,1,1,-1,0,1),bje=new ca(90,1),t5e=new xn;let Pj=null,Rj=0,Ij=0;const Sje=new _e,yk=new WeakMap,wje=[3,1,5,0,4,2],Nj=V7e(Es(),E2("faceIndex")).normalize(),gD=Ve(Nj.x,Nj.y,Nj.z);class Tje{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._ggxMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,n=.1,r=100,s={}){const{size:a=256,position:c=Sje,renderTarget:d=null}=s;if(this._setSize(a),this._hasInitialized===!1){Wt('PMREMGenerator: ".fromScene()" called before the backend is initialized. Try using "await renderer.init()" instead.');const y=d||this._allocateTarget();return s.renderTarget=y,this.fromSceneAsync(e,t,n,r,s),y}Pj=this._renderer.getRenderTarget(),Rj=this._renderer.getActiveCubeFace(),Ij=this._renderer.getActiveMipmapLevel();const p=d||this._allocateTarget();return p.depthBuffer=!0,this._init(p),this._sceneToCubeUV(e,n,r,p,c),t>0&&this._blur(p,0,0,t),this._applyPMREM(p),this._cleanup(p),p}async fromSceneAsync(e,t=0,n=.1,r=100,s={}){return ns('PMREMGenerator: ".fromSceneAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this.fromScene(e,t,n,r,s)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){Wt('PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using "await renderer.init()" instead.'),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return ns('PMREMGenerator: ".fromEquirectangularAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){Wt("PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return ns('PMREMGenerator: ".fromCubemapAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=r5e(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=i5e(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===np||e.mapping===hm?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(Pj,Rj,Ij),e.scissorTest=!1,E_(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),Pj=this._renderer.getRenderTarget(),Rj=this._renderer.getActiveCubeFace(),Ij=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTarget();return this._init(n),this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return n5e(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=n5e(e.width,e.height);const{_lodMax:t}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=Eje(t)),this._blurMaterial=Mje(t,e.width,e.height),this._ggxMaterial=Cje(t,e.width,e.height)}}async _compileMaterial(e){const t=new fn(new Ii,e);await this._renderer.compile(t,uT)}_sceneToCubeUV(e,t,n,r,s){const a=bje;a.near=t,a.far=n;const c=[1,1,1,1,-1,1],d=[1,-1,1,-1,1,-1],p=this._renderer,y=p.autoClear;p.getClearColor(t5e),p.autoClear=!1,this._backgroundBox===null&&(this._backgroundBox=new fn(new qo,new Ua({name:"PMREM.Background",side:Ui,depthWrite:!1,depthTest:!1})));const x=this._backgroundBox,w=x.material;let C=!1;const N=e.background;N?N.isColor&&(w.color.copy(N),e.background=null,C=!0):(w.color.copy(t5e),C=!0),p.setRenderTarget(r),p.clear(),C&&p.render(x,a);for(let F=0;F<6;F++){const U=F%3;U===0?(a.up.set(0,c[F],0),a.position.set(s.x,s.y,s.z),a.lookAt(s.x+d[F],s.y,s.z)):U===1?(a.up.set(0,0,c[F]),a.position.set(s.x,s.y,s.z),a.lookAt(s.x,s.y+d[F],s.z)):(a.up.set(0,c[F],0),a.position.set(s.x,s.y,s.z),a.lookAt(s.x,s.y,s.z+d[F]));const R=this._cubeSize;E_(r,U*R,F>2?R:0,R,R),p.render(e,a)}p.autoClear=y,e.background=N}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===np||e.mapping===hm;r?this._cubemapMaterial===null&&(this._cubemapMaterial=r5e(e)):this._equirectMaterial===null&&(this._equirectMaterial=i5e(e));const s=r?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const a=this._lodMeshes[0];a.material=s;const c=this._cubeSize;E_(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(a,uT)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,c=this._lodMeshes[n];c.material=a;const d=yk.get(a),p=n/(this._lodMeshes.length-1),y=t/(this._lodMeshes.length-1),x=Math.sqrt(p*p-y*y),w=0+p*1.25,C=x*w,{_lodMax:N}=this,F=this._sizeLods[n],U=3*F*(n>N-p4?n-N+p4:0),R=4*(this._cubeSize-F);e.texture.frame=(e.texture.frame||0)+1,d.envMap.value=e.texture,d.roughness.value=C,d.mipInt.value=N-t,E_(s,U,R,3*F,2*F),r.setRenderTarget(s),r.render(c,uT),s.texture.frame=(s.texture.frame||0)+1,d.envMap.value=s.texture,d.roughness.value=0,d.mipInt.value=N-n,E_(e,U,R,3*F,2*F),r.setRenderTarget(e),r.render(c,uT)}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,c){const d=this._renderer,p=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&jt("blur direction must be either latitudinal or longitudinal!");const y=3,x=this._lodMeshes[r];x.material=p;const w=yk.get(p),C=this._sizeLods[n]-1,N=isFinite(s)?Math.PI/(2*C):2*Math.PI/(2*G8-1),F=s/N,U=isFinite(s)?1+Math.floor(y*F):G8;U>G8&&Wt(`sigmaRadians, ${s}, is too large and will clip, as it requested ${U} samples when the maximum is set to ${G8}`);const R=[];let B=0;for(let oe=0;oe<G8;++oe){const G=oe/F,ie=Math.exp(-G*G/2);R.push(ie),oe===0?B+=ie:oe<U&&(B+=2*ie)}for(let oe=0;oe<R.length;oe++)R[oe]=R[oe]/B;e.texture.frame=(e.texture.frame||0)+1,w.envMap.value=e.texture,w.samples.value=U,w.weights.array=R,w.latitudinal.value=a==="latitudinal"?1:0,c&&(w.poleAxis.value=c);const{_lodMax:Y}=this;w.dTheta.value=N,w.mipInt.value=Y-n;const A=this._sizeLods[r],ne=3*A*(r>Y-p4?r-Y+p4:0),se=4*(this._cubeSize-A);E_(t,ne,se,3*A,2*A),d.setRenderTarget(t),d.render(x,uT)}}function Eje(i){const e=[],t=[],n=[];let r=i;const s=i-p4+1+e5e.length;for(let a=0;a<s;a++){const c=Math.pow(2,r);e.push(c);let d=1/c;a>i-p4?d=e5e[a-i+p4-1]:a===0&&(d=0),t.push(d);const p=1/(c-2),y=-p,x=1+p,w=[y,y,x,y,x,x,y,y,x,x,y,x],C=6,N=6,F=3,U=2,R=1,B=new Float32Array(F*N*C),Y=new Float32Array(U*N*C),A=new Float32Array(R*N*C);for(let se=0;se<C;se++){const oe=se%3*2/3-1,G=se>2?0:-1,ie=[oe,G,0,oe+2/3,G,0,oe+2/3,G+1,0,oe,G,0,oe+2/3,G+1,0,oe,G+1,0],Me=wje[se];B.set(ie,F*N*Me),Y.set(w,U*N*Me);const X=[Me,Me,Me,Me,Me,Me];A.set(X,R*N*Me)}const ne=new Ii;ne.setAttribute("position",new Ba(B,F)),ne.setAttribute("uv",new Ba(Y,U)),ne.setAttribute("faceIndex",new Ba(A,R)),n.push(new fn(ne,null)),r>p4&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function n5e(i,e){const t={magFilter:Bi,minFilter:Bi,generateMipmaps:!1,type:Gs,format:$s,colorSpace:Fc},n=new lp(i,e,t);return n.texture.mapping=i6,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function E_(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function vD(i){const e=new No;return e.depthTest=!1,e.depthWrite=!1,e.blending=vo,e.name=`PMREM_${i}`,e}function Mje(i,e,t){const n=Hl(new Array(G8).fill(0)),r=rr(new _e(0,1,0)),s=rr(0),a=xe(G8),c=rr(0),d=rr(1),p=$i(),y=rr(0),x=xe(1/e),w=xe(1/t),C=xe(i),N={n:a,latitudinal:c,weights:n,poleAxis:r,outputDirection:gD,dTheta:s,samples:d,envMap:p,mipInt:y,CUBEUV_TEXEL_WIDTH:x,CUBEUV_TEXEL_HEIGHT:w,CUBEUV_MAX_MIP:C},F=vD("blur");return F.fragmentNode=j7e({...N,latitudinal:c.equal(1)}),yk.set(F,N),F}function Cje(i,e,t){const n=$i(),r=rr(0),s=rr(0),a=xe(1/e),c=xe(1/t),d=xe(i),p={envMap:n,roughness:r,mipInt:s,CUBEUV_TEXEL_WIDTH:a,CUBEUV_TEXEL_HEIGHT:c,CUBEUV_MAX_MIP:d},y=vD("ggx");return y.fragmentNode=H7e({...p,N_immutable:gD,GGX_SAMPLES:Zt(xje)}),yk.set(y,p),y}function r5e(i){const e=vD("cubemap");return e.fragmentNode=Dc(i,gD),e}function i5e(i){const e=vD("equirect");return e.fragmentNode=$i(i,f$(gD),0),e}const s5e=new WeakMap;function Aje(i){const e=Math.log2(i)-2,t=1/i;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function Pje(i,e,t){const n=Rje(e);let r=n.get(i);if((r!==void 0?r.pmremVersion:-1)!==i.pmremVersion){const a=i.image;if(i.isCubeTexture)if(Nje(a))r=t.fromCubemap(i,r);else return null;else if(kje(a))r=t.fromEquirectangular(i,r);else return null;r.pmremVersion=i.pmremVersion,n.set(i,r)}return r.texture}function Rje(i){let e=s5e.get(i);return e===void 0&&(e=new WeakMap,s5e.set(i,e)),e}class Ije extends Yo{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const r=new ro;r.isRenderTargetTexture=!0,this._texture=$i(r),this._width=rr(0),this._height=rr(0),this._maxMip=rr(0),this.updateBeforeType=Fr.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=Aje(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const n=t?t.pmremVersion:-1,r=this._value;n!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=Pje(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new Tje(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this,e)),t=t$.mul(Ve(t.x,t.y.negate(),t.z));let n=this.levelNode;return n===null&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),G7e(this._texture,t,n,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function Nje(i){if(i==null)return!1;let e=0;const t=6;for(let n=0;n<t;n++)i[n]!==void 0&&e++;return e===t}function kje(i){return i==null?!1:i.height>0}const _$=Yr(Ije).setParameterLength(1,3),o5e=new WeakMap;class Dje extends Kx{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const x=n.isTextureNode?n.value:t[n.property],w=this._getPMREMNodeCache(e.renderer);let C=w.get(x);C===void 0&&(C=_$(x),w.set(x,C)),n=C}const s=t.useAnisotropy===!0||t.anisotropy>0?Dye:ji,a=n.context(a5e(J1,s)).mul(KN),c=n.context(Oje(L4)).mul(Math.PI).mul(KN),d=nx(a),p=nx(c);e.context.radiance.addAssign(d),e.context.iblIrradiance.addAssign(p);const y=e.context.lightingModel.clearcoatRadiance;if(y){const x=n.context(a5e(ex,c4)).mul(KN),w=nx(x);y.addAssign(w)}}_getPMREMNodeCache(e){let t=o5e.get(e);return t===void 0&&(t=new WeakMap,o5e.set(e,t)),t}}const a5e=(i,e)=>{let t=null;return{getUV:()=>(t===null&&(t=ks.negate().reflect(e),t=Fq(i).mix(t,e).normalize(),t=t.transformDirection(Nh)),t),getTextureLevel:()=>i}},Oje=i=>({getUV:()=>i,getTextureLevel:()=>xe(1)}),Lje=new Zve;class W7e extends No{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(Lje),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new Dje(t):null}setupLightingModel(){return new z7e}setupSpecular(){const e=Ei(Ve(.04),vs.rgb,_2);R4.assign(Ve(.04)),$8.assign(e),X8.assign(1)}setupVariants(){const e=this.metalnessNode?xe(this.metalnessNode):jye;_2.assign(e);let t=this.roughnessNode?xe(this.roughnessNode):Gye;t=g$({roughness:t}),J1.assign(t),this.setupSpecular(),V8.assign(vs.rgb.mul(e.oneMinus()))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Fje=new vE;class Uje extends W7e{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Fje),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?xe(this.iorNode):r7e;$T.assign(e),R4.assign(Pu(Lq($T.sub(1).div($T.add(1))).mul(Vye),Ve(1)).mul(iW)),$8.assign(Ei(R4,vs.rgb,_2)),X8.assign(Ei(iW,1,_2))}setupLightingModel(){return new z7e(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?xe(this.clearcoatNode):Wye,n=this.clearcoatRoughnessNode?xe(this.clearcoatRoughnessNode):qye;ck.assign(t),ex.assign(g$({roughness:n}))}if(this.useSheen){const t=this.sheenNode?Ve(this.sheenNode):Yye,n=this.sheenRoughnessNode?xe(this.sheenRoughnessNode):Kye;vd.assign(t),o4.assign(n)}if(this.useIridescence){const t=this.iridescenceNode?xe(this.iridescenceNode):Qye,n=this.iridescenceIORNode?xe(this.iridescenceIORNode):Jye,r=this.iridescenceThicknessNode?xe(this.iridescenceThicknessNode):e7e;tD.assign(t),uk.assign(n),dk.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?en(this.anisotropyNode):Zye).toVar();s4.assign(t.length()),gr(s4.equal(0),()=>{t.assign(en(1,0))}).Else(()=>{t.divAssign(en(s4)),s4.assign(s4.saturate())}),hk.assign(s4.pow2().mix(J1.pow2(),1)),qT.assign(Y8[0].mul(t.x).add(Y8[1].mul(t.y))),e6.assign(Y8[1].mul(t.x).sub(Y8[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?xe(this.transmissionNode):t7e,n=this.thicknessNode?xe(this.thicknessNode):n7e,r=this.attenuationDistanceNode?xe(this.attenuationDistanceNode):i7e,s=this.attenuationColorNode?Ve(this.attenuationColorNode):s7e;if(pk.assign(t),_q.assign(n),xq.assign(r),bq.assign(s),this.useDispersion){const a=this.dispersionNode?xe(this.dispersionNode):d7e;Sq.assign(a)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Ve(this.clearcoatNormalNode):$ye}setup(e){e.context.setupClearcoatNormal=()=>t6(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.iorNode=e.iorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const Bje=We(({normal:i,lightDirection:e,builder:t})=>{const n=i.dot(e),r=en(n.mul(.5).add(.5),0);if(t.material.gradientMap){const s=f2("gradientMap","texture").context({getUV:()=>r});return Ve(s.r)}else{const s=r.fwidth().mul(.5);return Ei(Ve(.7),Ve(1),ap(xe(.7).sub(s.x),xe(.7).add(s.x),r.x))}});class zje extends pD{direct({lightDirection:e,lightColor:t,reflectedLight:n},r){const s=Bje({normal:lD,lightDirection:e,builder:r}).mul(t);n.directDiffuse.addAssign(s.mul(h6({diffuseColor:vs.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(h6({diffuseColor:vs}))),r.indirectDiffuse.mulAssign(t)}}const Vje=new Bke;class Gje extends No{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Vje),this.setValues(e)}setupLightingModel(){return new zje}}const q7e=We(()=>{const i=Ve(ks.z,0,ks.x.negate()).normalize(),e=ks.cross(i);return en(i.dot(ji),e.dot(ji)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),jje=new tq;class Hje extends No{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(jje),this.setValues(e)}setupVariants(e){const t=q7e;let n;e.material.matcap?n=f2("matcap","texture").context({getUV:()=>t}):n=Ve(Ei(.2,.8,t.y)),vs.rgb.mulAssign(n.rgb)}}class Wje extends Yo{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),a=t.sin();return eD(s,a,a.negate(),s).mul(n)}else{const s=t,a=b4(hr(1,0,0,0),hr(0,Kf(s.x),Nc(s.x).negate(),0),hr(0,Nc(s.x),Kf(s.x),0),hr(0,0,0,1)),c=b4(hr(Kf(s.y),0,Nc(s.y),0),hr(0,1,0,0),hr(Nc(s.y).negate(),0,Kf(s.y),0),hr(0,0,0,1)),d=b4(hr(Kf(s.z),Nc(s.z).negate(),0,0),hr(Nc(s.z),Kf(s.z),0,0),hr(0,0,1,0),hr(0,0,0,1));return a.mul(c).mul(d).mul(hr(n,1)).xyz}}}const qE=Yr(Wje).setParameterLength(2),qje=new ake;class $7e extends No{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(qje),this.setValues(e)}setupPositionView(e){const{object:t,camera:n}=e,{positionNode:r,rotationNode:s,scaleNode:a,sizeAttenuation:c}=this,d=O4.mul(Ve(r||0));let p=en(wh[0].xyz.length(),wh[1].xyz.length());a!==null&&(p=p.mul(en(a))),n.isPerspectiveCamera&&c===!1&&(p=p.mul(d.z.negate()));let y=WE.xy;if(t.center&&t.center.isVector2===!0){const C=Hze("center","vec2",t);y=y.sub(C.sub(.5))}y=y.mul(p);const x=xe(s||Xye),w=qE(y,x);return hr(d.xy.add(w),d.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const $je=new XW,Xje=new vn;class Yje extends $7e{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues($je),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return O4.mul(Ve(e||Po)).xyz}setupVertexSprite(e){const{material:t,camera:n}=e,{rotationNode:r,scaleNode:s,sizeNode:a,sizeAttenuation:c}=this;let d=super.setupVertex(e);if(t.isNodeMaterial!==!0)return d;let p=a!==null?en(a):u7e;p=p.mul(aye),n.isPerspectiveCamera&&c===!0&&(p=p.mul(Kje.div(ua.z.negate()))),s&&s.isNode&&(p=p.mul(en(s)));let y=WE.xy;if(r&&r.isNode){const x=xe(r);y=qE(y,x)}return y=y.mul(p),y=y.div(Zq.div(2)),y=y.mul(d.w),d=d.add(hr(y,0,0)),d}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const Kje=rr(1).onFrameUpdate(function({renderer:i}){const e=i.getSize(Xje);this.value=.5*e.y});class Zje extends pD{constructor(){super(),this.shadowNode=xe(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){vs.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(vs.rgb)}}const Qje=new kke;class Jje extends No{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(Qje),this.setValues(e)}setupLightingModel(){return new Zje}}b2("vec3");b2("vec3");b2("vec3");class eHe{constructor(e,t,n){this.renderer=e,this.nodes=t,this.info=n,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,n)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this.renderer._inspector.begin(),this._animationLoop!==null&&this._animationLoop(t,n),this.renderer._inspector.finish()};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class I4{constructor(){this.weakMaps={}}_getWeakMap(e){const t=e.length;let n=this.weakMaps[t];return n===void 0&&(n=new WeakMap,this.weakMaps[t]=n),n}get(e){let t=this._getWeakMap(e);for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let n=this._getWeakMap(e);for(let r=0;r<e.length-1;r++){const s=e[r];n.has(s)===!1&&n.set(s,new WeakMap),n=n.get(s)}return n.set(e[e.length-1],t),this}delete(e){let t=this._getWeakMap(e);for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return!1;return t.delete(e[e.length-1])}}let tHe=0;function nHe(i){const e=Object.keys(i);let t=Object.getPrototypeOf(i);for(;t;){const n=Object.getOwnPropertyDescriptors(t);for(const r in n)if(n[r]!==void 0){const s=n[r];s&&typeof s.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class rHe{constructor(e,t,n,r,s,a,c,d,p,y){this.id=tHe++,this._nodes=e,this._geometries=t,this.renderer=n,this.object=r,this.material=s,this.scene=a,this.camera=c,this.lightsNode=d,this.context=p,this.geometry=r.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=y,this.clippingContextCacheKey=y!==null?y.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getIndirectOffset(){return this._geometries.getIndirectOffset(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],r=new Set,s={};for(const a of e){let c;if(a.node&&a.node.attribute?c=a.node.attribute:(c=t.getAttribute(a.name),s[a.name]=c.id),c===void 0)continue;n.push(c);const d=c.isInterleavedBufferAttribute?c.data:c;r.add(d)}return this.attributes=n,this.attributesId=s,this.vertexBuffers=Array.from(r.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:r,drawRange:s}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),c=this.getIndex(),d=c!==null;let p=1;if(n.isInstancedBufferGeometry===!0?p=n.instanceCount:e.count!==void 0&&(p=Math.max(0,e.count)),p===0)return null;if(a.instanceCount=p,e.isBatchedMesh===!0)return a;let y=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(y=2);let x=s.start*y,w=(s.start+s.count)*y;r!==null&&(x=Math.max(x,r.start*y),w=Math.min(w,(r.start+r.count)*y));const C=n.attributes.position;let N=1/0;d?N=c.count:C!=null&&(N=C.count),x=Math.max(x,0),w=Math.min(w,N);const F=w-x;return F<0||F===1/0?null:(a.vertexCount=F,a.firstVertex=x,a)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const r=e.attributes[n];t+=n+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const n of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[n];t+="morph-"+n+",";for(let s=0,a=r.length;s<a;s++){const c=r[s];t+=c.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t,renderer:n}=this;let r=t.customProgramCacheKey();for(const s of nHe(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(s))continue;const a=t[s];let c;if(a!==null){const d=typeof a;d==="number"?c=a!==0?"1":"0":d==="object"?(c="{",a.isTexture&&(c+=a.mapping,n.backend.isWebGPUBackend===!0&&(c+=a.magFilter,c+=a.minFilter,c+=a.wrapS,c+=a.wrapT,c+=a.wrapR)),c+="}"):c=String(a)}else c=String(a);r+=c+","}return r+=this.clippingContextCacheKey+",",e.geometry&&(r+=this.getGeometryCacheKey()),e.skeleton&&(r+=e.skeleton.bones.length+","),e.isBatchedMesh&&(r+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(r+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1||Array.isArray(e.morphTargetInfluences))&&(r+=e.uuid+","),r+=this.context.id+",",r+=e.receiveShadow+",",Xx(r)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(this.attributes!==null){const e=this.attributesId;for(const t in e){const n=this.geometry.getAttribute(t);if(n===void 0||e[t]!==n.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=HT(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=HT(e,1)),e=HT(e,this.renderer.contextNode.id,this.renderer.contextNode.version),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const G1=[];class iHe{constructor(e,t,n,r,s,a){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=r,this.bindings=s,this.info=a,this.chainMaps={}}get(e,t,n,r,s,a,c,d){const p=this.getChainMap(d);G1[0]=e,G1[1]=t,G1[2]=a,G1[3]=s;let y=p.get(G1);return y===void 0?(y=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,s,a,c,d),p.set(G1,y)):(y.camera=r,y.updateClipping(c),y.needsGeometryUpdate&&y.setGeometry(e.geometry),(y.version!==t.version||y.needsUpdate)&&(y.initialCacheKey!==y.getCacheKey()?(y.dispose(),y=this.get(e,t,n,r,s,a,c,d)):y.version=t.version)),G1[0]=null,G1[1]=null,G1[2]=null,G1[3]=null,y}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new I4)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,r,s,a,c,d,p,y,x){const w=this.getChainMap(x),C=new rHe(e,t,n,r,s,a,c,d,p,y);return C.onDispose=()=>{this.pipelines.delete(C),this.bindings.deleteForRender(C),this.nodes.delete(C),w.delete(C.getChainArray())},C}}class F4{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const Th={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},u4=16,sHe=211,oHe=212;class aHe extends F4{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(n.version===void 0)t===Th.VERTEX?this.backend.createAttribute(e):t===Th.INDEX?this.backend.createIndexAttribute(e):t===Th.STORAGE?this.backend.createStorageAttribute(e):t===Th.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(n.version<r.version||r.usage===uE)&&(this.backend.updateAttribute(e),n.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function X7e(i){return i.index!==null?i.index.version:i.attributes.position.version}function Y7e(i){return i.index!==null?i.index.id:i.attributes.position.id}function l5e(i){const e=[],t=i.index,n=i.attributes.position;if(t!==null){const s=t.array;for(let a=0,c=s.length;a<c;a+=3){const d=s[a+0],p=s[a+1],y=s[a+2];e.push(d,p,p,y,y,d)}}else{const s=n.array;for(let a=0,c=s.length/3-1;a<c;a+=3){const d=a+0,p=a+1,y=a+2;e.push(d,p,p,y,y,d)}}const r=new(n.count>=65535?jW:jk)(e,1);return r.version=X7e(i),r.__id=Y7e(i),r}class lHe extends F4{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap,this._geometryDisposeListeners=new Map}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,n=this.get(t);n.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,a=e.getAttributes();s!==null&&this.attributes.delete(s);for(const d of a)this.attributes.delete(d);const c=this.wireframes.get(t);c!==void 0&&this.attributes.delete(c),t.removeEventListener("dispose",r),this._geometryDisposeListeners.delete(t)};t.addEventListener("dispose",r),this._geometryDisposeListeners.set(t,r)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,Th.STORAGE):this.updateAttribute(s,Th.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,Th.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,Th.INDIRECT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndirectOffset(e){return e.geometry.indirectOffset}getIndex(e){const{geometry:t,material:n}=e;let r=t.index;if(n.wireframe===!0){const s=this.wireframes;let a=s.get(t);a===void 0?(a=l5e(t),s.set(t,a)):(a.version!==X7e(t)||a.__id!==Y7e(t))&&(this.attributes.delete(a),a=l5e(t),s.set(t,a)),r=a}return r}dispose(){for(const[e,t]of this._geometryDisposeListeners.entries())e.removeEventListener("dispose",t);this._geometryDisposeListeners.clear()}}class cHe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):jt("WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class K7e{constructor(e){this.cacheKey=e,this.usedTimes=0}}class uHe extends K7e{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class dHe extends K7e{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let hHe=0;class kj{constructor(e,t,n,r=null,s=null){this.id=hHe++,this.code=e,this.stage=t,this.name=n,this.transforms=r,this.attributes=s,this.usedTimes=0}}class fHe extends F4{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const a=this.nodes.getForCompute(e);let c=this.programs.compute.get(a.computeShader);c===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),c=new kj(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,c),n.createProgram(c));const d=this._getComputeCacheKey(e,c);let p=this.caches.get(d);p===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),p=this._getComputePipeline(e,c,d,t)),p.usedTimes++,c.usedTimes++,r.version=e.version,r.pipeline=p}return r.pipeline}getForRender(e,t=null){const{backend:n}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const a=e.getNodeBuilderState(),c=e.material?e.material.name:"";let d=this.programs.vertex.get(a.vertexShader);d===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),d=new kj(a.vertexShader,"vertex",c),this.programs.vertex.set(a.vertexShader,d),n.createProgram(d));let p=this.programs.fragment.get(a.fragmentShader);p===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),p=new kj(a.fragmentShader,"fragment",c),this.programs.fragment.set(a.fragmentShader,p),n.createProgram(p));const y=this._getRenderCacheKey(e,d,p);let x=this.caches.get(y);x===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),x=this._getRenderPipeline(e,d,p,y,t)):e.pipeline=x,x.usedTimes++,d.usedTimes++,p.usedTimes++,r.pipeline=x}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,r){n=n||this._getComputeCacheKey(e,t);let s=this.caches.get(n);return s===void 0&&(s=new dHe(n,t),this.caches.set(n,s),this.backend.createComputePipeline(s,r)),s}_getRenderPipeline(e,t,n,r,s){r=r||this._getRenderCacheKey(e,t,n);let a=this.caches.get(r);return a===void 0&&(a=new uHe(r,t,n),this.caches.set(r,a),e.pipeline=a,this.backend.createRenderPipeline(e,s)),a}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class pHe extends F4{constructor(e,t,n,r,s,a){super(),this.backend=e,this.textures=n,this.pipelines=s,this.attributes=r,this.nodes=t,this.info=a,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}deleteForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t)this.backend.deleteBindGroupData(n),this.delete(n)}deleteForRender(e){const t=e.getBindings();for(const n of t)this.backend.deleteBindGroupData(n),this.delete(n)}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isSampler)this.textures.updateSampler(t.texture);else if(t.isStorageBuffer){const n=t.attribute,r=n.isIndirectStorageBufferAttribute?Th.INDIRECT:Th.STORAGE;this.attributes.update(n,r)}}_update(e,t){const{backend:n}=this;let r=!1,s=!0,a=0,c=0;for(const d of e.bindings)if(this.nodes.updateGroup(d)!==!1){if(d.isStorageBuffer){const y=d.attribute,x=y.isIndirectStorageBufferAttribute?Th.INDIRECT:Th.STORAGE,w=n.get(d);this.attributes.update(y,x),w.attribute!==y&&(w.attribute=y,r=!0)}if(d.isUniformBuffer)d.update()&&n.updateBinding(d);else if(d.isSampledTexture){const y=d.update(),x=d.texture,w=this.textures.get(x);if(y&&(this.textures.updateTexture(x),d.generation!==w.generation&&(d.generation=w.generation,r=!0),w.bindGroups.add(e)),n.get(x).externalTexture!==void 0||w.isDefaultTexture?s=!1:(a=a*10+x.id,c+=x.version),x.isStorageTexture===!0&&x.mipmapsAutoUpdate===!0){const N=this.get(x);d.store===!0?N.needsMipmap=!0:this.textures.needsMipmaps(x)&&N.needsMipmap===!0&&(this.backend.generateMipmaps(x),N.needsMipmap=!1)}}else if(d.isSampler&&d.update()){const x=this.textures.updateSampler(d.texture);d.samplerKey!==x&&(d.samplerKey=x,r=!0)}d.isBuffer&&d.updateRanges.length>0&&d.clearUpdateRanges()}r===!0&&this.backend.updateBindings(e,t,s?a:0,c)}}function mHe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?i.z-e.z:i.id-e.id}function c5e(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function u5e(i){return(i.transmission>0||i.transmissionNode&&i.transmissionNode.isNode)&&i.side===no&&i.forceSinglePass===!1}class gHe{constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,r,s,a,c){let d=this.renderItems[this.renderItemsIndex];return d===void 0?(d={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:s,group:a,clippingContext:c},this.renderItems[this.renderItemsIndex]=d):(d.id=e.id,d.object=e,d.geometry=t,d.material=n,d.groupOrder=r,d.renderOrder=e.renderOrder,d.z=s,d.group=a,d.clippingContext=c),this.renderItemsIndex++,d}push(e,t,n,r,s,a,c){const d=this.getNextRenderItem(e,t,n,r,s,a,c);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0||n.transmissionNode&&n.transmissionNode.isNode||n.backdropNode&&n.backdropNode.isNode?(u5e(n)&&this.transparentDoublePass.push(d),this.transparent.push(d)):this.opaque.push(d)}unshift(e,t,n,r,s,a,c){const d=this.getNextRenderItem(e,t,n,r,s,a,c);n.transparent===!0||n.transmission>0||n.transmissionNode&&n.transmissionNode.isNode||n.backdropNode&&n.backdropNode.isNode?(u5e(n)&&this.transparentDoublePass.unshift(d),this.transparent.unshift(d)):this.opaque.unshift(d)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||mHe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||c5e),this.transparent.length>1&&this.transparent.sort(t||c5e)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}const M_=[];class vHe{constructor(e){this.lighting=e,this.lists=new I4}get(e,t){const n=this.lists;M_[0]=e,M_[1]=t;let r=n.get(M_);return r===void 0&&(r=new gHe(this.lighting,e,t),n.set(M_,r)),M_[0]=null,M_[1]=null,r}dispose(){this.lists=new I4}}let yHe=0;class _He{constructor(){this.id=yHe++,this.mrt=null,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new wr,this.scissor=!1,this.scissorValue=new wr,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.camera=null,this.isRenderContext=!0}getCacheKey(){return Z7e(this)}}function Z7e(i){const{textures:e,activeCubeFace:t,activeMipmapLevel:n}=i,r=[t,n];for(const s of e)r.push(s.id);return VE(r)}class xHe{constructor(e){this.renderer=e,this._renderContexts={}}get(e=null,t=null,n=0){let r;if(e===null)r="default";else{const d=e.texture.format,p=e.texture.type;r=`${e.textures.length}:${d}:${p}:${e.samples}:${e.depthBuffer}:${e.stencilBuffer}`}const s=t!==null?t.id:"default",a=r+"-"+s+"-"+n;let c=this._renderContexts[a];return c===void 0&&(c=new _He,c.mrt=t,this._renderContexts[a]=c),e!==null&&(c.sampleCount=e.samples===0?1:e.samples),c.clearDepthValue=this.renderer.getClearDepth(),c.clearStencilValue=this.renderer.getClearStencil(),c}dispose(){this._renderContexts={}}}const bHe=new _e;class SHe extends F4{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),r=e.samples===0?1:e.samples,s=n.depthTextureMips||(n.depthTextureMips={}),a=e.textures,c=this.getSize(a[0]),d=c.width>>t,p=c.height>>t;let y=e.depthTexture||s[t];const x=e.depthBuffer===!0||e.stencilBuffer===!0;let w=!1;y===void 0&&x&&(y=new ll,y.format=e.stencilBuffer?Wl:al,y.type=e.stencilBuffer?Cu:ys,y.image.width=d,y.image.height=p,y.image.depth=c.depth,y.renderTarget=e,y.isArrayTexture=e.multiview===!0&&c.depth>1,s[t]=y),(n.width!==c.width||c.height!==n.height)&&(w=!0,y&&(y.needsUpdate=!0,y.image.width=d,y.image.height=p,y.image.depth=y.isArrayTexture?y.image.depth:1)),n.width=c.width,n.height=c.height,n.textures=a,n.depthTexture=y||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==r&&(w=!0,y&&(y.needsUpdate=!0),n.sampleCount=r);const C={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let N=0;N<a.length;N++){const F=a[N];w&&(F.needsUpdate=!0),this.updateTexture(F,C)}y&&this.updateTexture(y,C)}n.initialized!==!0&&(n.initialized=!0,n.onDispose=()=>{this._destroyRenderTarget(e)},e.addEventListener("dispose",n.onDispose))}updateTexture(e,t={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(r&&n.initialized===!0&&s.destroyTexture(e),e.isFramebufferTexture){const p=this.renderer.getRenderTarget();p?e.type=p.texture.type:e.type=Yi}const{width:a,height:c,depth:d}=this.getSize(e);if(t.width=a,t.height=c,t.depth=d,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,a,c):1,e.isCubeTexture&&e.mipmaps.length>0&&t.levels++,r||e.isStorageTexture===!0||e.isExternalTexture===!0)s.createTexture(e,t),n.generation=e.version;else if(e.version>0){const p=e.image;if(p===void 0)Wt("Renderer: Texture marked for update but image is undefined.");else if(p.complete===!1)Wt("Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const x=[];for(const w of e.images)x.push(w);t.images=x}else t.image=p;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(s.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t);const y=e.isStorageTexture===!0&&e.mipmapsAutoUpdate===!1;t.needsMipmaps&&e.mipmaps.length===0&&!y&&s.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}else s.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;n.initialized!==!0&&(n.initialized=!0,n.generation=e.version,n.bindGroups=new Set,this.info.memory.textures++,e.isVideoTexture&&Xn.enabled===!0&&Xn.getTransfer(e.colorSpace)!==Wn&&Wt("WebGPURenderer: Video textures must use a color space with a sRGB transfer function, e.g. SRGBColorSpace."),n.onDispose=()=>{this._destroyTexture(e)},e.addEventListener("dispose",n.onDispose)),n.version=e.version}updateSampler(e){return this.backend.updateSampler(e)}getSize(e,t=bHe){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?(t.width=n.videoWidth||1,t.height=n.videoHeight||1,t.depth=1):typeof VideoFrame<"u"&&n instanceof VideoFrame?(t.width=n.displayWidth||1,t.height=n.displayHeight||1,t.depth=1):(t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1)):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let r;return e.mipmaps.length>0?r=e.mipmaps.length:e.isCompressedTexture===!0?r=1:r=Math.floor(Math.log2(Math.max(t,n)))+1,r}needsMipmaps(e){return e.generateMipmaps===!0||e.mipmaps.length>0}_destroyRenderTarget(e){if(this.has(e)===!0){const t=this.get(e),n=t.textures,r=t.depthTexture;e.removeEventListener("dispose",t.onDispose);for(let s=0;s<n.length;s++)this._destroyTexture(n[s]);r&&this._destroyTexture(r),this.delete(e),this.backend.delete(e)}}_destroyTexture(e){if(this.has(e)===!0){const t=this.get(e);e.removeEventListener("dispose",t.onDispose);const n=t.isDefaultTexture;if(this.backend.destroyTexture(e,n),t.bindGroups)for(const r of t.bindGroups){const s=this.backend.get(r);s.groups=void 0,s.versions=void 0}this.delete(e),this.info.memory.textures--}}}class x$ extends xn{constructor(e,t,n,r=1){super(e,t,n),this.a=r}set(e,t,n,r=1){return this.a=r,super.set(e,t,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class Q7e extends rs{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getMemberType(e,t){const n=this.getNodeType(e),r=e.getStructTypeNode(n);let s;return r!==null?s=r.getMemberType(e,t):(jt(`TSL: Member "${t}" not found in struct "${n}".`,new da),s="float"),s}getHash(){return this.uuid}generate(){return this.name}}const wHe=(i,e)=>new Q7e(i,e);class THe extends Yn{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this._currentNode=null,this.isStackNode=!0}getElementType(e){return this.hasOutput(e)?this.outputNode.getElementType(e):"void"}getNodeType(e){return this.hasOutput(e)?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.hasOutput(e)?this.outputNode.getMemberType(e,t):"void"}addToStack(e,t=this.nodes.length){return e.isNode!==!0?(jt("TSL: Invalid node added to stack.",new da),this):(this.nodes.splice(t,0,e),this)}addToStackBefore(e){const t=this._currentNode?this.nodes.indexOf(this._currentNode):0;return this.addToStack(e,t)}If(e,t){const n=new q_(t);return this._currentCond=$l(e,n),this.addToStack(this._currentCond)}ElseIf(e,t){const n=new q_(t),r=$l(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new q_(e),this}Switch(e){return this._expressionNode=qn(e),this}Case(...e){const t=[];if(e.length>=2)for(let c=0;c<e.length-1;c++)t.push(this._expressionNode.equal(qn(e[c])));else jt("TSL: Invalid parameter length. Case() requires at least two parameters.",new da);const n=e[e.length-1],r=new q_(n);let s=t[0];for(let c=1;c<t.length;c++)s=s.or(t[c]);const a=$l(s,r);return this._currentCond===null?(this._currentCond=a,this.addToStack(this._currentCond)):(this._currentCond.elseNode=a,this._currentCond=a,this)}Default(e){return this.Else(e),this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())r.isVarNode&&r.isIntent(e)&&r.isAssign(e)!==!0||(t["node"+n++]=r);return t.outputNode||null}hasOutput(e){return this.outputNode&&this.outputNode.isNode&&this.outputNode.getNodeType(e)!=="void"}build(e,...t){const n=fq(),r=e.buildStage;SE(this),e.setActiveStack(this);const s=p=>{if(this._currentNode=p,!(p.isVarNode&&p.isIntent(e)&&p.isAssign(e)!==!0)){if(r==="setup")p.build(e);else if(r==="analyze")p.build(e,this);else if(r==="generate"){const y=e.getDataFromNode(p,"any").stages,x=y&&y[e.shaderStage];if(p.isVarNode&&x&&x.length===1&&x[0]&&x[0].isStackNode)return;p.build(e,"void")}}},a=[...this.nodes];for(const p of a)s(p);this._currentNode=null;const c=this.nodes.filter(p=>a.indexOf(p)===-1);for(const p of c)s(p);let d;return this.hasOutput(e)?d=this.outputNode.build(e,...t):d=super.build(e,...t),SE(n),e.removeActiveStack(this),d}}const QN=Yr(THe).setParameterLength(0,1);function EHe(i){return Object.entries(i).map(([e,t])=>typeof t=="string"?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})}class MHe extends Yn{static get type(){return"StructTypeNode"}constructor(e,t=null){super("struct"),this.membersLayout=EHe(e),this.name=t,this.isStructLayoutNode=!0}getLength(){const e=Float32Array.BYTES_PER_ELEMENT;let t=1,n=0;for(const r of this.membersLayout){const s=r.type,a=ZBe(s),c=QBe(s)/e;t=Math.max(t,c);const p=n%t%c;p!==0&&(n+=c-p),n+=a}return Math.ceil(n/t)*t}getMemberType(e,t){const n=this.membersLayout.find(r=>r.name===t);return n?n.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.getStructTypeFromNode(this,this.membersLayout,this.name),e.addInclude(this)}generate(e){return this.getNodeType(e)}}class CHe extends Yn{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structTypeNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structTypeNode.getNodeType(e)}getMemberType(e,t){return this.structTypeNode.getMemberType(e,t)}_getChildren(){const e=super._getChildren(),t=e.find(n=>n.childNode===this.structTypeNode);return e.splice(e.indexOf(t),1),e.push(t),e}generate(e){const t=e.getVarFromNode(this),n=t.type,r=e.getPropertyName(t);return e.addLineFlowCode(`${r} = ${e.generateStruct(n,this.structTypeNode.membersLayout,this.values)}`,this),t.name}}const AHe=(i,e=null)=>{const t=new MHe(i,e),n=(...r)=>{let s=null;if(r.length>0)if(r[0].isNode){s={};const a=Object.keys(i);for(let c=0;c<r.length;c++)s[a[c]]=r[c]}else s=r[0];return new CHe(t,s)};return n.layout=t,n.isStruct=!0,n};class J7e extends Yn{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(){return"OutputType"}generate(e){const t=e.getDataFromNode(this);if(t.membersLayout===void 0){const a=this.members,c=[];for(let d=0;d<a.length;d++){const p="m"+d,y=a[d].getNodeType(e);c.push({name:p,type:y,index:d})}t.membersLayout=c,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}const n=e.getOutputStructName(),r=this.members,s=n!==""?n+".":"";for(let a=0;a<r.length;a++){const c=r[a].build(e);e.addLineFlowCode(`${s}m${a} = ${c}`,this)}return n}}const PHe=Yr(J7e);let e_e=class{constructor(e=rl){this.blending=e,this.blendSrc=E4,this.blendDst=M4,this.blendEquation=A0,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.premultiplyAlpha=!1}copy(e){return this.blending=e.blending,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.premultiplyAlpha=e.premultiplyAlpha,this}clone(){return new this.constructor().copy(this)}};const RHe=new e_e(vo),IHe=new e_e(SW);function t_e(i,e){for(let t=0;t<i.length;t++)if(i[t].name===e)return t;return-1}class NHe extends J7e{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.blendModes={output:IHe},this.isMRTNode=!0}setBlendMode(e,t){return this.blendModes[e]=t,this}getBlendMode(e){return this.blendModes[e]||RHe}has(e){return this.outputNodes[e]!==void 0}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes},n={...this.blendModes,...e.blendModes},r=n_e(t);return r.blendings=n,r}setup(e){const t=this.outputNodes,n=e.renderer.getRenderTarget(),r=[],s=n.textures;for(const a in t){const c=t_e(s,a);r[c]=hr(t[a])}return this.members=r,super.setup(e)}}const n_e=Yr(NHe);class $E extends Yo{static get type(){return"BitcastNode"}constructor(e,t,n=null){super(),this.valueNode=e,this.conversionType=t,this.inputType=n,this.isBitcastNode=!0}getNodeType(e){if(this.inputType!==null){const t=this.valueNode.getNodeType(e),n=e.getTypeLength(t);return e.getTypeFromLength(n,this.conversionType)}return this.conversionType}generate(e){const t=this.getNodeType(e);let n="";if(this.inputType!==null){const r=this.valueNode.getNodeType(e);n=e.getTypeLength(r)===1?this.inputType:e.changeComponentType(r,this.inputType)}else n=this.valueNode.getNodeType(e);return`${e.getBitcastMethod(t,n)}( ${this.valueNode.build(e,n)} )`}}const r_e=sn($E).setParameterLength(2),kHe=i=>new $E(i,"int","float"),i_e=i=>new $E(i,"uint","float"),DHe=i=>new $E(i,"float","int"),OHe=i=>new $E(i,"float","uint"),vN={};class xd extends gt{static get type(){return"BitcountNode"}constructor(e,t){super(e,t),this.isBitcountNode=!0}_resolveElementType(e,t,n){n==="int"?t.assign(r_e(e,"uint")):t.assign(e)}_returnDataNode(e){switch(e){case"uint":return Zt;case"int":return Fe;case"uvec2":return pq;case"uvec3":return x6;case"uvec4":return yq;case"ivec2":return La;case"ivec3":return mq;case"ivec4":return vq}}_createTrailingZerosBaseLayout(e,t){const n=this._returnDataNode(t);return We(([s])=>{const a=Zt(0);this._resolveElementType(s,a,t);const c=xe(a.bitAnd(Iq(a))),p=i_e(c).shiftRight(23).sub(127);return n(p)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createLeadingZerosBaseLayout(e,t){const n=this._returnDataNode(t);return We(([s])=>{gr(s.equal(Zt(0)),()=>Zt(32));const a=Zt(0),c=Zt(0);return this._resolveElementType(s,a,t),gr(a.shiftRight(16).equal(0),()=>{c.addAssign(16),a.shiftLeftAssign(16)}),gr(a.shiftRight(24).equal(0),()=>{c.addAssign(8),a.shiftLeftAssign(8)}),gr(a.shiftRight(28).equal(0),()=>{c.addAssign(4),a.shiftLeftAssign(4)}),gr(a.shiftRight(30).equal(0),()=>{c.addAssign(2),a.shiftLeftAssign(2)}),gr(a.shiftRight(31).equal(0),()=>{c.addAssign(1)}),n(c)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createOneBitsBaseLayout(e,t){const n=this._returnDataNode(t);return We(([s])=>{const a=Zt(0);this._resolveElementType(s,a,t),a.assign(a.sub(a.shiftRight(Zt(1)).bitAnd(Zt(1431655765)))),a.assign(a.bitAnd(Zt(858993459)).add(a.shiftRight(Zt(2)).bitAnd(Zt(858993459))));const c=a.add(a.shiftRight(Zt(4))).bitAnd(Zt(252645135)).mul(Zt(16843009)).shiftRight(Zt(24));return n(c)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createMainLayout(e,t,n,r){const s=this._returnDataNode(t);return We(([c])=>{if(n===1)return s(r(c));{const d=s(0),p=["x","y","z","w"];for(let y=0;y<n;y++){const x=p[y];d[x].assign(r(c[x]))}return d}}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}setup(e){const{method:t,aNode:n}=this,{renderer:r}=e;if(r.backend.isWebGPUBackend)return super.setup(e);const s=this.getInputType(e),a=e.getElementType(s),c=e.getTypeLength(s),d=`${t}_base_${a}`,p=`${t}_${s}`;let y=vN[d];if(y===void 0){switch(t){case xd.COUNT_LEADING_ZEROS:{y=this._createLeadingZerosBaseLayout(d,a);break}case xd.COUNT_TRAILING_ZEROS:{y=this._createTrailingZerosBaseLayout(d,a);break}case xd.COUNT_ONE_BITS:{y=this._createOneBitsBaseLayout(d,a);break}}vN[d]=y}let x=vN[p];return x===void 0&&(x=this._createMainLayout(p,s,c,y),vN[p]=x),We(()=>x(n))()}}xd.COUNT_TRAILING_ZEROS="countTrailingZeros";xd.COUNT_LEADING_ZEROS="countLeadingZeros";xd.COUNT_ONE_BITS="countOneBits";const LHe=sn(xd,xd.COUNT_TRAILING_ZEROS).setParameterLength(1),FHe=sn(xd,xd.COUNT_LEADING_ZEROS).setParameterLength(1),UHe=sn(xd,xd.COUNT_ONE_BITS).setParameterLength(1),BHe=We(([i])=>{const e=i.toUint().mul(747796405).add(2891336453),t=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return t.shiftRight(22).bitXor(t).toFloat().mul(1/2**32)}),cW=(i,e)=>Sh(Ur(4,i.mul(Ri(1,i))),e),zHe=(i,e)=>i.lessThan(.5)?cW(i.mul(2),e).div(2):Ri(1,cW(Ur(Ri(1,i),2),e).div(2)),VHe=(i,e,t)=>Sh(wd(Sh(i,e),Ca(Sh(i,e),Sh(Ri(1,i),t))),1/e),GHe=(i,e)=>Nc(mk.mul(e.mul(i).sub(1))).div(mk.mul(e.mul(i).sub(1)));class b$ extends Yo{static get type(){return"PackFloatNode"}constructor(e,t){super(),this.vectorNode=t,this.encoding=e,this.isPackFloatNode=!0}getNodeType(){return"uint"}generate(e){const t=this.vectorNode.getNodeType(e);return`${e.getFloatPackingMethod(this.encoding)}(${this.vectorNode.build(e,t)})`}}const jHe=sn(b$,"snorm").setParameterLength(1),HHe=sn(b$,"unorm").setParameterLength(1),WHe=sn(b$,"float16").setParameterLength(1);class S$ extends Yo{static get type(){return"UnpackFloatNode"}constructor(e,t){super(),this.uintNode=t,this.encoding=e,this.isUnpackFloatNode=!0}getNodeType(){return"vec2"}generate(e){const t=this.uintNode.getNodeType(e);return`${e.getFloatUnpackingMethod(this.encoding)}(${this.uintNode.build(e,t)})`}}const qHe=sn(S$,"snorm").setParameterLength(1),$He=sn(S$,"unorm").setParameterLength(1),XHe=sn(S$,"float16").setParameterLength(1),d2=We(([i])=>i.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),YHe=We(([i])=>Ve(d2(i.z.add(d2(i.y.mul(1)))),d2(i.z.add(d2(i.x.mul(1)))),d2(i.y.add(d2(i.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),KHe=We(([i,e,t])=>{const n=Ve(i).toVar(),r=xe(1.4).toVar(),s=xe(0).toVar(),a=Ve(n).toVar();return _s({start:xe(0),end:xe(3),type:"float",condition:"<="},()=>{const c=Ve(YHe(a.mul(2))).toVar();n.addAssign(c.add(t.mul(xe(.1).mul(e)))),a.mulAssign(1.8),r.mulAssign(1.5),n.mulAssign(1.2);const d=xe(d2(n.z.add(d2(n.x.add(d2(n.y)))))).toVar();s.addAssign(d.div(r)),a.addAssign(.14)}),s}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class ZHe extends Yn{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFn=null,this.global=!0}getNodeType(e){return this.getCandidateFn(e).shaderNode.layout.type}getCandidateFn(e){const t=this.parametersNodes;let n=this._candidateFn;if(n===null){let r=null,s=-1;for(const a of this.functionNodes){const d=a.shaderNode.layout;if(d===null)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const p=d.inputs;if(t.length===p.length){let y=0;for(let x=0;x<t.length;x++){const w=t[x],C=p[x];w.getNodeType(e)===C.type&&y++}y>s&&(r=a,s=y)}}this._candidateFn=n=r}return n}setup(e){return this.getCandidateFn(e)(...this.parametersNodes)}}const QHe=Yr(ZHe),cl=i=>(...e)=>QHe(i,...e),Zx=rr(0).setGroup(cr).onRenderUpdate(i=>i.time),JHe=rr(0).setGroup(cr).onRenderUpdate(i=>i.deltaTime),s_e=rr(0,"uint").setGroup(cr).onRenderUpdate(i=>i.frameId),eWe=(i=Zx)=>i.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5),tWe=(i=Zx)=>i.fract().round(),nWe=(i=Zx)=>i.add(.5).fract().mul(2).sub(1).abs(),rWe=(i=Zx)=>i.fract();function iWe(i,e=null){return C2(e,{getUV:typeof i=="function"?i:()=>i})}const sWe=We(([i,e,t=en(.5)])=>qE(i.sub(t),e).add(t)),oWe=We(([i,e,t=en(.5)])=>{const n=i.sub(t),r=n.dot(n),a=r.mul(r).mul(e);return i.add(n.mul(a))}),aWe=We(({position:i=null,horizontal:e=!0,vertical:t=!1})=>{let n;i!==null?(n=wh.toVar(),n[3][0]=i.x,n[3][1]=i.y,n[3][2]=i.z):n=wh;const r=Nh.mul(n);return bE(e)&&(r[0][0]=wh[0].length(),r[0][1]=0,r[0][2]=0),bE(t)&&(r[1][0]=0,r[1][1]=wh[1].length(),r[1][2]=0),r[2][0]=0,r[2][1]=0,r[2][2]=1,S2.mul(r).mul(Po)}),lWe=We(([i=null])=>{const e=vk();return vk(a$(i)).sub(e).lessThan(0).select(lm,i)}),cWe=We(([i,e=Es(),t=xe(0)])=>{const n=i.x,r=i.y,s=t.mod(n.mul(r)).floor(),a=s.mod(n),c=r.sub(s.add(1).div(n).ceil()),d=i.reciprocal(),p=en(a,c);return e.add(p).mul(d)}),o_e=We(([i,e=null,t=null,n=xe(1),r=Po,s=Ru])=>{let a=s.abs().normalize();a=a.div(a.dot(Ve(1)));const c=r.yz.mul(n),d=r.zx.mul(n),p=r.xy.mul(n),y=i.value,x=e!==null?e.value:y,w=t!==null?t.value:y,C=$i(y,c).mul(a.x),N=$i(x,d).mul(a.y),F=$i(w,p).mul(a.z);return Ca(C,N,F)}),uWe=(...i)=>o_e(...i),C_=new Z1,C8=new _e,A_=new _e,Dj=new _e,dT=new An,yN=new _e(0,0,-1),j1=new wr,hT=new _e,_N=new _e,fT=new wr,xN=new vn,_k=new lp,dWe=lm.flipX();_k.depthTexture=new ll(1,1);let bN=!1;class w$ extends fm{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||_k.texture,dWe),this._reflectorBaseNode=e.reflector||new hWe(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(this._depthNode===null){if(this._reflectorBaseNode.depth!==!0)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=new w$({defaultTexture:_k.depthTexture,reflector:this._reflectorBaseNode})}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class hWe extends Yn{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:n=new hi,resolutionScale:r=1,generateMipmaps:s=!1,bounces:a=!0,depth:c=!1,samples:d=0}=t;this.textureNode=e,this.target=n,this.resolutionScale=r,t.resolution!==void 0&&(ns('ReflectorNode: The "resolution" parameter has been renamed to "resolutionScale".'),this.resolutionScale=t.resolution),this.generateMipmaps=s,this.bounces=a,this.depth=c,this.samples=d,this.updateBeforeType=a?Fr.RENDER:Fr.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}_updateResolution(e,t){const n=this.resolutionScale;t.getDrawingBufferSize(xN),e.setSize(Math.round(xN.width*n),Math.round(xN.height*n))}setup(e){return this._updateResolution(_k,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return t===void 0&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return t===void 0&&(t=new lp(0,0,{type:Gs,samples:this.samples}),this.generateMipmaps===!0&&(t.texture.minFilter=sNe,t.texture.generateMipmaps=!0),this.depth===!0&&(t.depthTexture=new ll),this.renderTargets.set(e,t)),t}updateBefore(e){if(this.bounces===!1&&bN)return!1;bN=!0;const{scene:t,camera:n,renderer:r,material:s}=e,{target:a}=this,c=this.getVirtualCamera(n),d=this.getRenderTarget(c);r.getDrawingBufferSize(xN),this._updateResolution(d,r),A_.setFromMatrixPosition(a.matrixWorld),Dj.setFromMatrixPosition(n.matrixWorld),dT.extractRotation(a.matrixWorld),C8.set(0,0,1),C8.applyMatrix4(dT),hT.subVectors(A_,Dj);const p=hT.dot(C8)>0;let y=!1;if(p===!0&&this.forceUpdate===!1){if(this.hasOutput===!1){bN=!1;return}y=!0}hT.reflect(C8).negate(),hT.add(A_),dT.extractRotation(n.matrixWorld),yN.set(0,0,-1),yN.applyMatrix4(dT),yN.add(Dj),_N.subVectors(A_,yN),_N.reflect(C8).negate(),_N.add(A_),c.coordinateSystem=n.coordinateSystem,c.position.copy(hT),c.up.set(0,1,0),c.up.applyMatrix4(dT),c.up.reflect(C8),c.lookAt(_N),c.near=n.near,c.far=n.far,c.updateMatrixWorld(),c.projectionMatrix.copy(n.projectionMatrix),C_.setFromNormalAndCoplanarPoint(C8,A_),C_.applyMatrix4(c.matrixWorldInverse),j1.set(C_.normal.x,C_.normal.y,C_.normal.z,C_.constant);const x=c.projectionMatrix;fT.x=(Math.sign(j1.x)+x.elements[8])/x.elements[0],fT.y=(Math.sign(j1.y)+x.elements[9])/x.elements[5],fT.z=-1,fT.w=(1+x.elements[10])/x.elements[14],j1.multiplyScalar(1/j1.dot(fT));const w=0;x.elements[2]=j1.x,x.elements[6]=j1.y,x.elements[10]=r.coordinateSystem===Sd?j1.z-w:j1.z+1-w,x.elements[14]=j1.w,this.textureNode.value=d.texture,this.depth===!0&&(this.textureNode.getDepthNode().value=d.depthTexture),s.visible=!1;const C=r.getRenderTarget(),N=r.getMRT(),F=r.autoClear;r.setMRT(null),r.setRenderTarget(d),r.autoClear=!0;const U=t.name;t.name=(t.name||"Scene")+" [ Reflector ]",y?(r.clear(),this.hasOutput=!1):(r.render(t,c),this.hasOutput=!0),t.name=U,r.setMRT(N),r.setRenderTarget(C),r.autoClear=F,s.visible=!0,bN=!1,this.forceUpdate=!1}get resolution(){return ns('ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale}set resolution(e){ns('ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale=e}}const fWe=i=>new w$(i),Oj=new w2(-1,1,1,-1,0,1);class pWe extends Ii{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Rr([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Rr(t,2))}}const mWe=new pWe;class yD extends fn{constructor(e=null){super(mWe,e),this.camera=Oj,this.isQuadMesh=!0}async renderAsync(e){ns('QuadMesh: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await e.init(),e.render(this,Oj)}render(e){e.render(this,Oj)}}const gWe=new vn;class vWe extends fm{static get type(){return"RTTNode"}constructor(e,t=null,n=null,r={type:Gs}){const s=new lp(t,n,r);super(s.texture,Es()),this.isRTTNode=!0,this.node=e,this.width=t,this.height=n,this.pixelRatio=1,this.renderTarget=s,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new yD(new No),this.updateBeforeType=Fr.RENDER}get autoResize(){return this.width===null}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const n=e*this.pixelRatio,r=t*this.pixelRatio;this.renderTarget.setSize(n,r),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(this.textureNeedsUpdate===!1&&this.autoUpdate===!1)return;if(this.textureNeedsUpdate=!1,this.autoResize===!0){const r=e.getPixelRatio(),s=e.getSize(gWe),a=Math.floor(s.width*r),c=Math.floor(s.height*r);(a!==this.renderTarget.width||c!==this.renderTarget.height)&&(this.renderTarget.setSize(a,c),this.textureNeedsUpdate=!0)}let t="RTT";this.node.name&&(t=this.node.name+" [ "+t+" ]"),this._quadMesh.material.fragmentNode=this._rttNode,this._quadMesh.name=t;const n=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(n)}clone(){const e=new fm(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const a_e=(i,...e)=>new vWe(qn(i),...e),yWe=(i,...e)=>i.isSampleNode||i.isTextureNode?i:i.isPassNode?i.getTextureNode():a_e(i,...e),V_=We(([i,e,t],n)=>{let r;n.renderer.coordinateSystem===Sd?(i=en(i.x,i.y.oneMinus()).mul(2).sub(1),r=hr(Ve(i,e),1)):r=hr(Ve(i.x,i.y.oneMinus(),e).mul(2).sub(1),1);const s=hr(t.mul(r));return s.xyz.div(s.w)}),_We=We(([i,e])=>{const t=e.mul(hr(i,1)),n=t.xy.div(t.w).mul(.5).add(.5).toVar();return en(n.x,n.y.oneMinus())}),xWe=We(([i,e,t])=>{const n=S4($o(e)),r=La(i.mul(n)).toVar(),s=$o(e,r).toVar(),a=$o(e,r.sub(La(2,0))).toVar(),c=$o(e,r.sub(La(1,0))).toVar(),d=$o(e,r.add(La(1,0))).toVar(),p=$o(e,r.add(La(2,0))).toVar(),y=$o(e,r.add(La(0,2))).toVar(),x=$o(e,r.add(La(0,1))).toVar(),w=$o(e,r.sub(La(0,1))).toVar(),C=$o(e,r.sub(La(0,2))).toVar(),N=Vs(Ri(xe(2).mul(c).sub(a),s)).toVar(),F=Vs(Ri(xe(2).mul(d).sub(p),s)).toVar(),U=Vs(Ri(xe(2).mul(x).sub(y),s)).toVar(),R=Vs(Ri(xe(2).mul(w).sub(C),s)).toVar(),B=V_(i,s,t).toVar(),Y=N.lessThan(F).select(B.sub(V_(i.sub(en(xe(1).div(n.x),0)),c,t)),B.negate().add(V_(i.add(en(xe(1).div(n.x),0)),d,t))),A=U.lessThan(R).select(B.sub(V_(i.add(en(0,xe(1).div(n.y))),x,t)),B.negate().add(V_(i.sub(en(0,xe(1).div(n.y))),w,t)));return Au(T2(Y,A))}),T$=We(([i])=>sp(xe(52.9829189).mul(sp(Ah(i,en(.06711056,.00583715)))))).setLayout({name:"interleavedGradientNoise",type:"float",inputs:[{name:"position",type:"vec2"}]}),Qf=We(([i,e,t])=>{const n=xe(2.399963229728653),r=Lc(xe(i).add(.5).div(xe(e))),s=xe(i).mul(n).add(t);return en(Kf(s),Nc(s)).mul(r)}).setLayout({name:"vogelDiskSample",type:"vec2",inputs:[{name:"sampleIndex",type:"int"},{name:"samplesCount",type:"int"},{name:"phi",type:"float"}]});class bWe extends Yn{static get type(){return"SampleNode"}constructor(e,t=null){super(),this.callback=e,this.uvNode=t,this.isSampleNode=!0}setup(){return this.sample(Es())}sample(e){return this.callback(e)}}const SWe=(i,e=null)=>new bWe(i,qn(e));class Mu extends Yn{static get type(){return"EventNode"}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===Mu.OBJECT?this.updateType=Fr.OBJECT:e===Mu.MATERIAL?this.updateType=Fr.RENDER:e===Mu.BEFORE_OBJECT?this.updateBeforeType=Fr.OBJECT:e===Mu.BEFORE_MATERIAL&&(this.updateBeforeType=Fr.RENDER)}update(e){this.callback(e)}updateBefore(e){this.callback(e)}}Mu.OBJECT="object";Mu.MATERIAL="material";Mu.BEFORE_OBJECT="beforeObject";Mu.BEFORE_MATERIAL="beforeMaterial";const _D=(i,e)=>new Mu(i,e).toStack(),wWe=i=>_D(Mu.OBJECT,i),TWe=i=>_D(Mu.MATERIAL,i),EWe=i=>_D(Mu.BEFORE_OBJECT,i),MWe=i=>_D(Mu.BEFORE_MATERIAL,i);class CWe extends J_{constructor(e,t,n=Float32Array){const r=ArrayBuffer.isView(e)?e:new n(e*t);super(r,t),this.isStorageInstancedBufferAttribute=!0}}class AWe extends Ba{constructor(e,t,n=Float32Array){const r=ArrayBuffer.isView(e)?e:new n(e*t);super(r,t),this.isStorageBufferAttribute=!0}}const PWe=(i,e="float")=>{let t,n;e.isStruct===!0?(t=e.layout.getLength(),n=lk("float")):(t=T8e(e),n=lk(e));const r=new AWe(i,t,n);return w4(r,e,i)},RWe=(i,e="float")=>{let t,n;e.isStruct===!0?(t=e.layout.getLength(),n=lk("float")):(t=T8e(e),n=lk(e));const r=new CWe(i,t,n);return w4(r,e,r.count)};class IWe extends Yn{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const NWe=En(IWe),pT=new Ao,Lj=new An,l_e=rr(0).setGroup(cr).onRenderUpdate(({scene:i})=>i.backgroundBlurriness),uW=rr(1).setGroup(cr).onRenderUpdate(({scene:i})=>i.backgroundIntensity),c_e=rr(new An).setGroup(cr).onRenderUpdate(({scene:i})=>{const e=i.background;return e!==null&&e.isTexture&&e.mapping!==j8?(pT.copy(i.backgroundRotation),pT.x*=-1,pT.y*=-1,pT.z*=-1,Lj.makeRotationFromEuler(pT)):Lj.identity(),Lj});class kWe extends fm{static get type(){return"StorageTextureNode"}constructor(e,t,n=null){super(e,t),this.storeNode=n,this.mipLevel=0,this.isStorageTextureNode=!0,this.access=sl.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);return t.storeNode=this.storeNode,t}setAccess(e){return this.access=e,this}setMipLevel(e){return this.mipLevel=e,this}generate(e,t){let n;return this.storeNode!==null?n=this.generateStore(e):n=super.generate(e,t),n}generateSnippet(e,t,n,r,s,a,c,d,p){const y=this.value;return e.generateStorageTextureLoad(y,t,n,r,a,p)}toReadWrite(){return this.setAccess(sl.READ_WRITE)}toReadOnly(){return this.setAccess(sl.READ_ONLY)}toWriteOnly(){return this.setAccess(sl.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:n,storeNode:r,depthNode:s}=t,a=super.generate(e,"property"),c=n.build(e,this.value.is3DTexture===!0?"uvec3":"uvec2"),d=r.build(e,"vec4"),p=s?s.build(e,"int"):null,y=e.generateTextureStore(e,a,c,p,d);e.addLineFlowCode(y,this)}clone(){const e=super.clone();return e.storeNode=this.storeNode,e.mipLevel=this.mipLevel,e.access=this.access,e}}const u_e=Yr(kWe).setParameterLength(1,3),DWe=(i,e,t)=>{let n;return i.isStorageTextureNode===!0?(n=i.clone(),n.uvNode=e,n.storeNode=t):n=u_e(i,e,t),t!==null&&n.toStack(),n},OWe=We(({texture:i,uv:e})=>{const n=Ve().toVar();return gr(e.x.lessThan(1e-4),()=>{n.assign(Ve(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{n.assign(Ve(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{n.assign(Ve(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{n.assign(Ve(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{n.assign(Ve(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{n.assign(Ve(0,0,-1))}).Else(()=>{const s=i.sample(e.add(Ve(-.01,0,0))).r.sub(i.sample(e.add(Ve(.01,0,0))).r),a=i.sample(e.add(Ve(0,-.01,0))).r.sub(i.sample(e.add(Ve(0,.01,0))).r),c=i.sample(e.add(Ve(0,0,-.01))).r.sub(i.sample(e.add(Ve(0,0,.01))).r);n.assign(Ve(s,a,c))}),n.normalize()});class LWe extends fm{static get type(){return"Texture3DNode"}constructor(e,t=null,n=null){super(e,t,n),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Ve(.5,.5,.5)}setUpdateMatrix(){}generateUV(e,t){return t.build(e,this.sampler===!0?"vec3":"ivec3")}generateOffset(e,t){return t.build(e,"ivec3")}normal(e){return OWe({texture:this,uv:e})}}const xD=Yr(LWe).setParameterLength(1,3),FWe=(...i)=>xD(...i).setSampler(!1),UWe=(i,e,t)=>xD(i,e).level(t);class BWe extends cD{static get type(){return"UserDataNode"}constructor(e,t,n=null){super(e,t,n),this.userData=n}updateReference(e){return this.reference=this.userData!==null?this.userData:e.object.userData,this.reference}}const zWe=(i,e,t)=>new BWe(i,e,t),d5e=new WeakMap;class VWe extends Yo{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=Fr.OBJECT,this.updateAfterType=Fr.OBJECT,this.previousModelWorldMatrix=rr(new An),this.previousProjectionMatrix=rr(new An).setGroup(cr),this.previousCameraViewMatrix=rr(new An)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:n}){const r=h5e(n);this.previousModelWorldMatrix.value.copy(r);const s=d_e(t);s.frameId!==e&&(s.frameId=e,s.previousProjectionMatrix===void 0?(s.previousProjectionMatrix=new An,s.previousCameraViewMatrix=new An,s.currentProjectionMatrix=new An,s.currentCameraViewMatrix=new An,s.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(s.previousProjectionMatrix.copy(s.currentProjectionMatrix),s.previousCameraViewMatrix.copy(s.currentCameraViewMatrix)),s.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(s.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(s.previousCameraViewMatrix))}updateAfter({object:e}){h5e(e).copy(e.matrixWorld)}setup(){const e=this.projectionMatrix===null?S2:rr(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),n=e.mul(O4).mul(Po),r=this.previousProjectionMatrix.mul(t).mul(Ox),s=n.xy.div(n.w),a=r.xy.div(r.w);return Ri(s,a)}}function d_e(i){let e=d5e.get(i);return e===void 0&&(e={},d5e.set(i,e)),e}function h5e(i,e=0){const t=d_e(i);let n=t[e];return n===void 0&&(t[e]=n=new An,t[e].copy(i.matrixWorld)),n}const GWe=En(VWe),jWe=We(([i])=>E$(i.rgb)),HWe=We(([i,e=xe(1)])=>e.mix(E$(i.rgb),i.rgb)),WWe=We(([i,e=xe(1)])=>{const t=Ca(i.r,i.g,i.b).div(3),n=i.r.max(i.g.max(i.b)),r=n.sub(t).mul(e).mul(-3);return Ei(i.rgb,n,r)}),qWe=We(([i,e=xe(1)])=>{const t=Ve(.57735,.57735,.57735),n=e.cos();return Ve(i.rgb.mul(n).add(t.cross(i.rgb).mul(e.sin()).add(t.mul(Ah(t,i.rgb).mul(n.oneMinus())))))}),E$=(i,e=Ve(Xn.getLuminanceCoefficients(new _e)))=>Ah(i,e),$We=We(([i,e=Ve(1),t=Ve(0),n=Ve(1),r=xe(1),s=Ve(Xn.getLuminanceCoefficients(new _e,Fc))])=>{const a=i.rgb.dot(Ve(s)),c=Io(i.rgb.mul(e).add(t),0).toVar(),d=c.pow(n).toVar();return gr(c.r.greaterThan(0),()=>{c.r.assign(d.r)}),gr(c.g.greaterThan(0),()=>{c.g.assign(d.g)}),gr(c.b.greaterThan(0),()=>{c.b.assign(d.b)}),c.assign(a.add(c.sub(a).mul(r))),hr(c.rgb,i.a)}),XWe=We(([i,e])=>i.mul(e).floor().div(e));let SN=null;class YWe extends fD{static get type(){return"ViewportSharedTextureNode"}constructor(e=lm,t=null){SN===null&&(SN=new YW),super(e,t,SN)}getTextureForReference(){return SN}updateReference(){return this}}const KWe=Yr(YWe).setParameterLength(0,2),wN=new vn;class h_e extends fm{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.isPassTextureNode=!0,this.setUpdateMatrix(!1)}setup(e){const t=e.getNodeProperties(this);return t.passNode=this.passNode,super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class f5e extends h_e{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n,this.isPassMultipleTextureNode=!0}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}class pm extends Yo{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const s=new ll;s.isRenderTargetTexture=!0,s.name="depth";const a=new lp(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Gs,...r});a.texture.name="output",a.depthTexture=s,this.renderTarget=a,this.overrideMaterial=null,this.transparent=!0,this.opaque=!0,this.contextNode=null,this._contextNodeCache=null,this._textures={output:a.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=rr(0),this._cameraFar=rr(0),this._mrt=null,this._layers=null,this._resolutionScale=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=Fr.FRAME,this.global=!0}setResolutionScale(e){return this._resolutionScale=e,this}getResolutionScale(){return this._resolutionScale}setResolution(e){return Wt("PassNode: .setResolution() is deprecated. Use .setResolutionScale() instead."),this.setResolutionScale(e)}getResolution(){return Wt("PassNode: .getResolution() is deprecated. Use .getResolutionScale() instead."),this.getResolutionScale()}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=new f5e(this,e),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=new f5e(this,e,!0),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=c$(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=rx(s,n,r)}return t}async compileAsync(e){const t=e.getRenderTarget(),n=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(n)}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,this.renderTarget.texture.type=e.getOutputBufferType(),this.scope===pm.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let r,s;const a=t.getOutputRenderTarget();a&&a.isXRRenderTarget===!0?(s=1,r=t.xr.getCamera(),t.xr.updateCamera(r),wN.set(a.width,a.height)):(r=this.camera,s=t.getPixelRatio(),t.getSize(wN)),this._pixelRatio=s,this.setSize(wN.width,wN.height);const c=t.getRenderTarget(),d=t.getMRT(),p=t.autoClear,y=t.transparent,x=t.opaque,w=r.layers.mask,C=t.contextNode,N=n.overrideMaterial;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const U in this._previousTextures)this.toggleTexture(U);this.overrideMaterial!==null&&(n.overrideMaterial=this.overrideMaterial),t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.autoClear=!0,t.transparent=this.transparent,t.opaque=this.opaque,this.contextNode!==null&&((this._contextNodeCache===null||this._contextNodeCache.version!==this.version)&&(this._contextNodeCache={version:this.version,context:C2({...t.contextNode.getFlowContextData(),...this.contextNode.getFlowContextData()})}),t.contextNode=this._contextNodeCache.context);const F=n.name;n.name=this.name?this.name:n.name,t.render(n,r),n.name=F,n.overrideMaterial=N,t.setRenderTarget(c),t.setMRT(d),t.autoClear=p,t.transparent=y,t.opaque=x,t.contextNode=C,r.layers.mask=w}setSize(e,t){this._width=e,this._height=t;const n=Math.floor(this._width*this._pixelRatio*this._resolutionScale),r=Math.floor(this._height*this._pixelRatio*this._resolutionScale);this.renderTarget.setSize(n,r),this._scissor!==null&&this.renderTarget.scissor.copy(this._scissor),this._viewport!==null&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,n,r){e===null?this._scissor=null:(this._scissor===null&&(this._scissor=new wr),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,n,r),this._scissor.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setViewport(e,t,n,r){e===null?this._viewport=null:(this._viewport===null&&(this._viewport=new wr),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,n,r),this._viewport.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}pm.COLOR="color";pm.DEPTH="depth";const ZWe=(i,e,t)=>new pm(pm.COLOR,i,e,t),QWe=(i,e)=>new h_e(i,e),JWe=(i,e,t)=>new pm(pm.DEPTH,i,e,t);class eqe extends pm{static get type(){return"ToonOutlinePassNode"}constructor(e,t,n,r,s){super(pm.COLOR,e,t),this.colorNode=n,this.thicknessNode=r,this.alphaNode=s,this._materialCache=new WeakMap,this.name="Outline Pass"}updateBefore(e){const{renderer:t}=e,n=t.getRenderObjectFunction();t.setRenderObjectFunction((r,s,a,c,d,p,y,x)=>{if((d.isMeshToonMaterial||d.isMeshToonNodeMaterial)&&d.wireframe===!1){const w=this._getOutlineMaterial(d);t.renderObject(r,s,a,c,w,p,y,x)}t.renderObject(r,s,a,c,d,p,y,x)}),super.updateBefore(e),t.setRenderObjectFunction(n)}_createMaterial(){const e=new No;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=Ui;const t=Ru.negate(),n=S2.mul(O4),r=xe(1),s=n.mul(hr(Po,1)),a=n.mul(hr(Po.add(t),1)),c=Au(s.sub(a));return e.vertexNode=s.add(c.mul(this.thicknessNode).mul(s.w).mul(r)),e.colorNode=hr(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return t===void 0&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const tqe=(i,e,t=new xn(0,0,0),n=.003,r=1)=>new eqe(i,e,qn(t),qn(n),qn(r)),f_e=We(([i,e])=>i.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),p_e=We(([i,e])=>(i=i.mul(e),i.div(i.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),m_e=We(([i,e])=>{i=i.mul(e),i=i.sub(.004).max(0);const t=i.mul(i.mul(6.2).add(.5)),n=i.mul(i.mul(6.2).add(1.7)).add(.06);return t.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),nqe=We(([i])=>{const e=i.mul(i.add(.0245786)).sub(90537e-9),t=i.mul(i.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),g_e=We(([i,e])=>{const t=P0(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=P0(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return i=i.mul(e).div(.6),i=t.mul(i),i=nqe(i),i=n.mul(i),i.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),rqe=P0(Ve(1.6605,-.1246,-.0182),Ve(-.5876,1.1329,-.1006),Ve(-.0728,-.0083,1.1187)),iqe=P0(Ve(.6274,.0691,.0164),Ve(.3293,.9195,.088),Ve(.0433,.0113,.8956)),sqe=We(([i])=>{const e=Ve(i).toVar(),t=Ve(e.mul(e)).toVar(),n=Ve(t.mul(t)).toVar();return xe(15.5).mul(n.mul(t)).sub(Ur(40.14,n.mul(e))).add(Ur(31.96,n).sub(Ur(6.868,t.mul(e))).add(Ur(.4298,t).add(Ur(.1191,e).sub(.00232))))}),v_e=We(([i,e])=>{const t=Ve(i).toVar(),n=P0(Ve(.856627153315983,.137318972929847,.11189821299995),Ve(.0951212405381588,.761241990602591,.0767994186031903),Ve(.0482516061458583,.101439036467562,.811302368396859)),r=P0(Ve(1.1271005818144368,-.1413297634984383,-.14132976349843826),Ve(-.11060664309660323,1.157823702216272,-.11060664309660294),Ve(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=xe(-12.47393),a=xe(4.026069);return t.mulAssign(e),t.assign(iqe.mul(t)),t.assign(n.mul(t)),t.assign(Io(t,1e-10)),t.assign(sm(t)),t.assign(t.sub(s).div(a.sub(s))),t.assign(op(t,0,1)),t.assign(sqe(t)),t.assign(r.mul(t)),t.assign(Sh(Io(Ve(0),t),Ve(2.2))),t.assign(rqe.mul(t)),t.assign(op(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),y_e=We(([i,e])=>{const t=xe(.76),n=xe(.15);i=i.mul(e);const r=Pu(i.r,Pu(i.g,i.b)),s=$l(r.lessThan(.08),r.sub(Ur(6.25,r.mul(r))),.04);i.subAssign(s);const a=Io(i.r,Io(i.g,i.b));gr(a.lessThan(t),()=>i);const c=Ri(1,t),d=Ri(1,c.mul(c).div(a.add(c.sub(t))));i.mulAssign(d.div(a));const p=Ri(1,wd(1,n.mul(a.sub(d)).add(1)));return Ei(i,Ve(d),p)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class Za extends Yn{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const bD=Yr(Za).setParameterLength(1,3),oqe=(i,e)=>bD(i,e,"js"),aqe=(i,e)=>bD(i,e,"wgsl"),lqe=(i,e)=>bD(i,e,"glsl");class __e extends Za{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,t){const n=this.getNodeType(e);return e.getStructTypeNode(n).getMemberType(e,t)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),r=n.name,s=n.type,a=e.getCodeFromNode(this,s);r!==""&&(a.name=r);const c=e.getPropertyName(a),d=this.getNodeFunction(e).getCode(c);return a.code=d+`
`,t==="property"?c:e.format(`${c}()`,s,t)}}const x_e=(i,e=[],t="")=>{for(let s=0;s<e.length;s++){const a=e[s];typeof a=="function"&&(e[s]=a.functionNode)}const n=new __e(i,e,t),r=(...s)=>n.call(...s);return r.functionNode=n,r},cqe=(i,e)=>x_e(i,e,"glsl"),uqe=(i,e)=>x_e(i,e,"wgsl");function M$(i){let e;const t=i.context.getViewZ;return t!==void 0&&(e=t(this)),(e||ua.z).negate()}const b_e=We(([i,e],t)=>{const n=M$(t);return ap(i,e,n)}),S_e=We(([i],e)=>{const t=M$(e);return i.mul(i,t,t).negate().exp().oneMinus()}),dqe=We(([i,e],t)=>{const n=M$(t),s=e.sub(cm.y).max(0).toConst().mul(n).toConst();return i.mul(i,s,s).negate().exp().oneMinus()}),dW=We(([i,e])=>hr(e.toFloat().mix(tx.rgb,i.toVec3()),tx.a));let A8=null,P8=null;class hqe extends Yn{static get type(){return"RangeNode"}constructor(e=xe(),t=xe()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=this.getConstNode(this.minNode),n=this.getConstNode(this.maxNode),r=e.getTypeLength(f4(t.value)),s=e.getTypeLength(f4(n.value));return r>s?r:s}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}getConstNode(e){let t=null;if(e.traverse(n=>{n.isConstNode===!0&&(t=n)}),t===null)throw new oye('THREE.TSL: No "ConstNode" found in node graph.',this.stackTrace);return t}setup(e){const t=e.object;let n=null;if(t.count>1){const r=this.getConstNode(this.minNode),s=this.getConstNode(this.maxNode),a=r.value,c=s.value,d=e.getTypeLength(f4(a)),p=e.getTypeLength(f4(c));A8=A8||new wr,P8=P8||new wr,A8.setScalar(0),P8.setScalar(0),d===1?A8.setScalar(a):a.isColor?A8.set(a.r,a.g,a.b,1):A8.set(a.x,a.y,a.z||0,a.w||0),p===1?P8.setScalar(c):c.isColor?P8.set(c.r,c.g,c.b,1):P8.set(c.x,c.y,c.z||0,c.w||0);const y=4,x=y*t.count,w=new Float32Array(x);for(let F=0;F<x;F++){const U=F%y,R=A8.getComponent(U),B=P8.getComponent(U);w[F]=E0.lerp(R,B,Math.random())}const C=this.getNodeType(e);if(t.count*4*4<=e.getUniformBufferLimit())n=HE(w,"vec4",t.count).element(um).convert(C);else{const F=new J_(w,4);e.geometry.setAttribute("__range"+this.id,F),n=gk(F).convert(C)}}else n=xe(0);return n}}const fqe=Yr(hqe).setParameterLength(2);class pqe extends Yn{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const n=this.getBuiltinName(e),r=this.getNodeType(e);return e.shaderStage==="compute"?e.format(n,r,t):(Wt(`ComputeBuiltinNode: Compute built-in value ${n} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(r))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const XE=(i,e)=>new pqe(i,e),mqe=XE("numWorkgroups","uvec3"),gqe=XE("workgroupId","uvec3"),vqe=XE("globalId","uvec3"),yqe=XE("localId","uvec3"),_qe=XE("subgroupSize","uint");class xqe extends Yn{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}const C$=Yr(xqe),bqe=()=>C$("workgroup").toStack(),Sqe=()=>C$("storage").toStack(),wqe=()=>C$("texture").toStack();class Tqe extends _6{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let n;const r=e.context.assign;if(n=super.generate(e),r!==!0){const s=this.getNodeType(e);n=e.format(n,s,t)}return n}}class Eqe extends Yn{constructor(e,t,n=0){super(t),this.bufferType=t,this.bufferCount=n,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e,this.name=""}setName(e){return this.name=e,this}label(e){return Wt('TSL: "label()" has been deprecated. Use "setName()" instead.',new da),this.setName(e)}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return new Tqe(this,e)}generate(e){const t=this.name!==""?this.name:`${this.scope}Array_${this.id}`;return e.getScopedArray(t,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}const Mqe=(i,e)=>new Eqe("Workgroup",i,e);class n0 extends Yn{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,r=this.method,s=this.getNodeType(e),a=this.getInputType(e),c=this.pointerNode,d=this.valueNode,p=[];p.push(`&${c.build(e,a)}`),d!==null&&p.push(d.build(e,a));const y=`${e.getMethod(r,s)}( ${p.join(", ")} )`;if(n?n.length===1&&n[0].isStackNode===!0:!1)e.addLineFlowCode(y,this);else return t.constNode===void 0&&(t.constNode=tp(y,s).toConst()),t.constNode.build(e)}}n0.ATOMIC_LOAD="atomicLoad";n0.ATOMIC_STORE="atomicStore";n0.ATOMIC_ADD="atomicAdd";n0.ATOMIC_SUB="atomicSub";n0.ATOMIC_MAX="atomicMax";n0.ATOMIC_MIN="atomicMin";n0.ATOMIC_AND="atomicAnd";n0.ATOMIC_OR="atomicOr";n0.ATOMIC_XOR="atomicXor";const Cqe=Yr(n0),mm=(i,e,t)=>Cqe(i,e,t).toStack(),Aqe=i=>mm(n0.ATOMIC_LOAD,i,null),Pqe=(i,e)=>mm(n0.ATOMIC_STORE,i,e),Rqe=(i,e)=>mm(n0.ATOMIC_ADD,i,e),Iqe=(i,e)=>mm(n0.ATOMIC_SUB,i,e),Nqe=(i,e)=>mm(n0.ATOMIC_MAX,i,e),kqe=(i,e)=>mm(n0.ATOMIC_MIN,i,e),Dqe=(i,e)=>mm(n0.ATOMIC_AND,i,e),Oqe=(i,e)=>mm(n0.ATOMIC_OR,i,e),Lqe=(i,e)=>mm(n0.ATOMIC_XOR,i,e);class Pn extends Yo{static get type(){return"SubgroupFunctionNode"}constructor(e,t=null,n=null){super(),this.method=e,this.aNode=t,this.bNode=n}getInputType(e){const t=this.aNode?this.aNode.getNodeType(e):null,n=this.bNode?this.bNode.getNodeType(e):null,r=e.isMatrix(t)?0:e.getTypeLength(t),s=e.isMatrix(n)?0:e.getTypeLength(n);return r>s?t:n}getNodeType(e){const t=this.method;return t===Pn.SUBGROUP_ELECT?"bool":t===Pn.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,t){const n=this.method,r=this.getNodeType(e),s=this.getInputType(e),a=this.aNode,c=this.bNode,d=[];if(n===Pn.SUBGROUP_BROADCAST||n===Pn.SUBGROUP_SHUFFLE||n===Pn.QUAD_BROADCAST){const y=c.getNodeType(e);d.push(a.build(e,r),c.build(e,y==="float"?"int":r))}else n===Pn.SUBGROUP_SHUFFLE_XOR||n===Pn.SUBGROUP_SHUFFLE_DOWN||n===Pn.SUBGROUP_SHUFFLE_UP?d.push(a.build(e,r),c.build(e,"uint")):(a!==null&&d.push(a.build(e,s)),c!==null&&d.push(c.build(e,s)));const p=d.length===0?"()":`( ${d.join(", ")} )`;return e.format(`${e.getMethod(n,r)}${p}`,r,t)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Pn.SUBGROUP_ELECT="subgroupElect";Pn.SUBGROUP_BALLOT="subgroupBallot";Pn.SUBGROUP_ADD="subgroupAdd";Pn.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd";Pn.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd";Pn.SUBGROUP_MUL="subgroupMul";Pn.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul";Pn.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul";Pn.SUBGROUP_AND="subgroupAnd";Pn.SUBGROUP_OR="subgroupOr";Pn.SUBGROUP_XOR="subgroupXor";Pn.SUBGROUP_MIN="subgroupMin";Pn.SUBGROUP_MAX="subgroupMax";Pn.SUBGROUP_ALL="subgroupAll";Pn.SUBGROUP_ANY="subgroupAny";Pn.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst";Pn.QUAD_SWAP_X="quadSwapX";Pn.QUAD_SWAP_Y="quadSwapY";Pn.QUAD_SWAP_DIAGONAL="quadSwapDiagonal";Pn.SUBGROUP_BROADCAST="subgroupBroadcast";Pn.SUBGROUP_SHUFFLE="subgroupShuffle";Pn.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor";Pn.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp";Pn.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown";Pn.QUAD_BROADCAST="quadBroadcast";const Fqe=sn(Pn,Pn.SUBGROUP_ELECT).setParameterLength(0),Uqe=sn(Pn,Pn.SUBGROUP_BALLOT).setParameterLength(1),Bqe=sn(Pn,Pn.SUBGROUP_ADD).setParameterLength(1),zqe=sn(Pn,Pn.SUBGROUP_INCLUSIVE_ADD).setParameterLength(1),Vqe=sn(Pn,Pn.SUBGROUP_EXCLUSIVE_AND).setParameterLength(1),Gqe=sn(Pn,Pn.SUBGROUP_MUL).setParameterLength(1),jqe=sn(Pn,Pn.SUBGROUP_INCLUSIVE_MUL).setParameterLength(1),Hqe=sn(Pn,Pn.SUBGROUP_EXCLUSIVE_MUL).setParameterLength(1),Wqe=sn(Pn,Pn.SUBGROUP_AND).setParameterLength(1),qqe=sn(Pn,Pn.SUBGROUP_OR).setParameterLength(1),$qe=sn(Pn,Pn.SUBGROUP_XOR).setParameterLength(1),Xqe=sn(Pn,Pn.SUBGROUP_MIN).setParameterLength(1),Yqe=sn(Pn,Pn.SUBGROUP_MAX).setParameterLength(1),Kqe=sn(Pn,Pn.SUBGROUP_ALL).setParameterLength(0),Zqe=sn(Pn,Pn.SUBGROUP_ANY).setParameterLength(0),Qqe=sn(Pn,Pn.SUBGROUP_BROADCAST_FIRST).setParameterLength(2),Jqe=sn(Pn,Pn.QUAD_SWAP_X).setParameterLength(1),e$e=sn(Pn,Pn.QUAD_SWAP_Y).setParameterLength(1),t$e=sn(Pn,Pn.QUAD_SWAP_DIAGONAL).setParameterLength(1),n$e=sn(Pn,Pn.SUBGROUP_BROADCAST).setParameterLength(2),r$e=sn(Pn,Pn.SUBGROUP_SHUFFLE).setParameterLength(2),i$e=sn(Pn,Pn.SUBGROUP_SHUFFLE_XOR).setParameterLength(2),s$e=sn(Pn,Pn.SUBGROUP_SHUFFLE_UP).setParameterLength(2),o$e=sn(Pn,Pn.SUBGROUP_SHUFFLE_DOWN).setParameterLength(2),a$e=sn(Pn,Pn.QUAD_BROADCAST).setParameterLength(1);let TN;function SD(i){TN=TN||new WeakMap;let e=TN.get(i);return e===void 0&&TN.set(i,e={}),e}function wD(i){const e=SD(i);return e.shadowMatrix||(e.shadowMatrix=rr("mat4").setGroup(cr).onRenderUpdate(t=>((i.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&(i.shadow.camera.coordinateSystem!==t.camera.coordinateSystem&&(i.shadow.camera.coordinateSystem=t.camera.coordinateSystem,i.shadow.camera.updateProjectionMatrix()),i.shadow.updateMatrices(i)),i.shadow.matrix)))}function w_e(i,e=cm){const t=wD(i).mul(e);return t.xyz.div(t.w)}function A$(i){const e=SD(i);return e.position||(e.position=rr(new _e).setGroup(cr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(i.matrixWorld)))}function T_e(i){const e=SD(i);return e.targetPosition||(e.targetPosition=rr(new _e).setGroup(cr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(i.target.matrixWorld)))}function P$(i){const e=SD(i);return e.viewPosition||(e.viewPosition=rr(new _e).setGroup(cr).onRenderUpdate(({camera:t},n)=>{n.value=n.value||new _e,n.value.setFromMatrixPosition(i.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)}))}const R$=i=>Nh.transformDirection(A$(i).sub(T_e(i))),l$e=i=>i.sort((e,t)=>e.id-t.id),c$e=(i,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===i)return t;return null},Fj=new WeakMap,mT=[];class I$ extends Yn{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=b2("vec3","totalDiffuse"),this.totalSpecularNode=b2("vec3","totalSpecular"),this.outgoingLightNode=b2("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let n=0;n<e.length;n++){const r=e[n];if(mT.push(r.id),mT.push(r.castShadow?1:0),r.isSpotLight===!0){const s=r.map!==null?r.map.id:-1,a=r.colorNode?r.colorNode.getCacheKey():-1;mT.push(s,a)}}const t=VE(mT);return mT.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const n of this._lightNodes)t.push(n.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const n of t.nodes)n.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,r=l$e(this._lights),s=e.renderer.library;for(const a of r)if(a.isNode)t.push(qn(a));else{let c=null;if(n!==null&&(c=c$e(a.id,n)),c===null){const d=s.getLightNodeClass(a.constructor);if(d===null){Wt(`LightsNode.setupNodeLights: Light node not found for ${a.constructor.name}`);continue}let p=null;Fj.has(a)?p=Fj.get(a):(p=new d(a),Fj.set(a,p)),t.push(p)}}this._lightNodes=t}setupDirectLight(e,t,n){const{lightingModel:r,reflectedLight:s}=e.context;r.direct({...n,lightNode:t,reflectedLight:s},e)}setupDirectRectAreaLight(e,t,n){const{lightingModel:r,reflectedLight:s}=e.context;r.directRectArea({...n,lightNode:t,reflectedLight:s},e)}setupLights(e,t){for(const n of t)n.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let n=this.outgoingLightNode;const r=e.context,s=r.lightingModel,a=e.getNodeProperties(this);if(s){const{totalDiffuseNode:c,totalSpecularNode:d}=this;r.outgoingLight=n;const p=e.addStack();a.nodes=p.nodes,s.start(e);const{backdrop:y,backdropAlpha:x}=r,{directDiffuse:w,directSpecular:C,indirectDiffuse:N,indirectSpecular:F}=r.reflectedLight;let U=w.add(N);y!==null&&(x!==null?U=Ve(x.mix(U,y)):U=Ve(y)),c.assign(U),d.assign(C.add(F)),n.assign(c.add(d)),s.finish(e),n=n.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=t,n}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const u$e=(i=[])=>new I$().setLights(i);class d$e extends Yn{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=Fr.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){N$.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||cm)}}const N$=b2("vec3","shadowPositionWorld");function h$e(i,e={}){return e.toneMapping=i.toneMapping,e.toneMappingExposure=i.toneMappingExposure,e.outputColorSpace=i.outputColorSpace,e.renderTarget=i.getRenderTarget(),e.activeCubeFace=i.getActiveCubeFace(),e.activeMipmapLevel=i.getActiveMipmapLevel(),e.renderObjectFunction=i.getRenderObjectFunction(),e.pixelRatio=i.getPixelRatio(),e.mrt=i.getMRT(),e.clearColor=i.getClearColor(e.clearColor||new xn),e.clearAlpha=i.getClearAlpha(),e.autoClear=i.autoClear,e.scissorTest=i.getScissorTest(),e}function f$e(i,e){return e=h$e(i,e),i.setMRT(null),i.setRenderObjectFunction(null),i.setClearColor(0,1),i.autoClear=!0,e}function p$e(i,e){i.toneMapping=e.toneMapping,i.toneMappingExposure=e.toneMappingExposure,i.outputColorSpace=e.outputColorSpace,i.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),i.setRenderObjectFunction(e.renderObjectFunction),i.setPixelRatio(e.pixelRatio),i.setMRT(e.mrt),i.setClearColor(e.clearColor,e.clearAlpha),i.autoClear=e.autoClear,i.setScissorTest(e.scissorTest)}function m$e(i,e={}){return e.background=i.background,e.backgroundNode=i.backgroundNode,e.overrideMaterial=i.overrideMaterial,e}function g$e(i,e){return e=m$e(i,e),i.background=null,i.backgroundNode=null,i.overrideMaterial=null,e}function v$e(i,e){i.background=e.background,i.backgroundNode=e.backgroundNode,i.overrideMaterial=e.overrideMaterial}function y$e(i,e,t){return t=f$e(i,t),t=g$e(e,t),t}function _$e(i,e,t){p$e(i,t),v$e(e,t)}const xk=new WeakMap,E_e=We(({depthTexture:i,shadowCoord:e,depthLayer:t})=>{let n=$i(i,e.xy).setName("t_basic");return i.isArrayTexture&&(n=n.depth(t)),n.compare(e.z)}),M_e=We(({depthTexture:i,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(y,x)=>{let w=$i(i,y);return i.isArrayTexture&&(w=w.depth(n)),w.compare(x)},s=to("mapSize","vec2",t).setGroup(cr),a=to("radius","float",t).setGroup(cr),c=en(1).div(s),d=a.mul(c.x),p=T$(b6.xy).mul(6.28318530718);return Ca(r(e.xy.add(Qf(0,5,p).mul(d)),e.z),r(e.xy.add(Qf(1,5,p).mul(d)),e.z),r(e.xy.add(Qf(2,5,p).mul(d)),e.z),r(e.xy.add(Qf(3,5,p).mul(d)),e.z),r(e.xy.add(Qf(4,5,p).mul(d)),e.z)).mul(1/5)}),C_e=We(({depthTexture:i,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(x,w)=>{let C=$i(i,x);return i.isArrayTexture&&(C=C.depth(n)),C.compare(w)},s=to("mapSize","vec2",t).setGroup(cr),a=en(1).div(s),c=a.x,d=a.y,p=e.xy,y=sp(p.mul(s).add(.5));return p.subAssign(y.mul(a)),Ca(r(p,e.z),r(p.add(en(c,0)),e.z),r(p.add(en(0,d)),e.z),r(p.add(a),e.z),Ei(r(p.add(en(c.negate(),0)),e.z),r(p.add(en(c.mul(2),0)),e.z),y.x),Ei(r(p.add(en(c.negate(),d)),e.z),r(p.add(en(c.mul(2),d)),e.z),y.x),Ei(r(p.add(en(0,d.negate())),e.z),r(p.add(en(0,d.mul(2))),e.z),y.y),Ei(r(p.add(en(c,d.negate())),e.z),r(p.add(en(c,d.mul(2))),e.z),y.y),Ei(Ei(r(p.add(en(c.negate(),d.negate())),e.z),r(p.add(en(c.mul(2),d.negate())),e.z),y.x),Ei(r(p.add(en(c.negate(),d.mul(2))),e.z),r(p.add(en(c.mul(2),d.mul(2))),e.z),y.x),y.y)).mul(1/9)}),A_e=We(({depthTexture:i,shadowCoord:e,depthLayer:t},n)=>{let r=$i(i).sample(e.xy);i.isArrayTexture&&(r=r.depth(t)),r=r.rg;const s=r.x,a=Io(1e-7,r.y.mul(r.y)),c=n.renderer.reversedDepthBuffer?Dx(s,e.z):Dx(e.z,s),d=xe(1).toVar();return gr(c.notEqual(1),()=>{const p=e.z.sub(s);let y=a.div(a.add(p.mul(p)));y=op(Ri(y,.3).div(.65)),d.assign(Io(c,y))}),d}),P_e=i=>{let e=xk.get(i);return e===void 0&&(e=new No,e.colorNode=hr(0,0,0,1),e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.blending=vo,e.fog=!1,xk.set(i,e)),e},R_e=i=>{const e=xk.get(i);e!==void 0&&(e.dispose(),xk.delete(i))},p5e=new I4,P_=[],I_e=(i,e,t,n)=>{P_[0]=i,P_[1]=e;let r=p5e.get(P_);return(r===void 0||r.shadowType!==t||r.useVelocity!==n)&&(r=(s,a,c,d,p,y,...x)=>{(s.castShadow===!0||s.receiveShadow&&t===em)&&(n&&(E8e(s).useVelocity=!0),s.onBeforeShadow(i,s,c,e.camera,d,a.overrideMaterial,y),i.renderObject(s,a,c,d,p,y,...x),s.onAfterShadow(i,s,c,e.camera,d,a.overrideMaterial,y))},r.shadowType=t,r.useVelocity=n,p5e.set(P_,r)),P_[0]=null,P_[1]=null,r},x$e=We(({samples:i,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const s=xe(0).toVar("meanVertical"),a=xe(0).toVar("squareMeanVertical"),c=i.lessThanEqual(xe(1)).select(xe(0),xe(2).div(i.sub(1))),d=i.lessThanEqual(xe(1)).select(xe(0),xe(-1));_s({start:Fe(0),end:Fe(i),type:"int",condition:"<"},({i:y})=>{const x=d.add(xe(y).mul(c));let w=n.sample(Ca(b6.xy,en(0,x).mul(e)).div(t));n.value.isArrayTexture&&(w=w.depth(r)),w=w.x,s.addAssign(w),a.addAssign(w.mul(w))}),s.divAssign(i),a.divAssign(i);const p=Lc(a.sub(s.mul(s)).max(0));return en(s,p)}),b$e=We(({samples:i,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const s=xe(0).toVar("meanHorizontal"),a=xe(0).toVar("squareMeanHorizontal"),c=i.lessThanEqual(xe(1)).select(xe(0),xe(2).div(i.sub(1))),d=i.lessThanEqual(xe(1)).select(xe(0),xe(-1));_s({start:Fe(0),end:Fe(i),type:"int",condition:"<"},({i:y})=>{const x=d.add(xe(y).mul(c));let w=n.sample(Ca(b6.xy,en(x,0).mul(e)).div(t));n.value.isArrayTexture&&(w=w.depth(r)),s.addAssign(w.x),a.addAssign(Ca(w.y.mul(w.y),w.x.mul(w.x)))}),s.divAssign(i),a.divAssign(i);const p=Lc(a.sub(s.mul(s)).max(0));return en(s,p)}),S$e=[E_e,M_e,C_e,A_e];let Uj;const EN=new yD;class N_e extends d$e{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._currentShadowType=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:s,depthLayer:a}){const c=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),d=t({depthTexture:n,shadowCoord:r,shadow:s,depthLayer:a});return c.select(d,xe(1))}setupShadowCoord(e,t){const{shadow:n}=this,{renderer:r}=e,s=n.biasNode||to("bias","float",n).setGroup(cr);let a=t,c;if(n.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)a=a.xyz.div(a.w),c=a.z;else{const d=a.w;a=a.xy.div(d);const p=to("near","float",n.camera).setGroup(cr),y=to("far","float",n.camera).setGroup(cr);c=u$(d.negate(),p,y)}return a=Ve(a.x,a.y.oneMinus(),r.reversedDepthBuffer?c.sub(s):c.add(s)),a}getShadowFilterFn(e){return S$e[e]}setupRenderTarget(e,t){const n=new ll(e.mapSize.width,e.mapSize.height);n.name="ShadowDepthTexture",n.compareFunction=t.renderer.reversedDepthBuffer?p6:f6;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=n,{shadowMap:r,depthTexture:n}}setupShadow(e){const{renderer:t,camera:n}=e,{light:r,shadow:s}=this,{depthTexture:a,shadowMap:c}=this.setupRenderTarget(s,e),d=t.shadowMap.type;if(d===Y_||d===kve?(a.minFilter=Bi,a.magFilter=Bi):(a.minFilter=Hi,a.magFilter=Hi),s.camera.coordinateSystem=n.coordinateSystem,s.camera.updateProjectionMatrix(),d===em&&s.isPointLightShadow!==!0){a.compareFunction=null,c.depth>1?(c._vsmShadowMapVertical||(c._vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Oc,type:Gs,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=c._vsmShadowMapVertical,c._vsmShadowMapHorizontal||(c._vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Oc,type:Gs,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=c._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Oc,type:Gs,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Oc,type:Gs,depthBuffer:!1}));let Y=$i(a);a.isArrayTexture&&(Y=Y.depth(this.depthLayer));let A=$i(this.vsmShadowMapVertical.texture);a.isArrayTexture&&(A=A.depth(this.depthLayer));const ne=to("blurSamples","float",s).setGroup(cr),se=to("radius","float",s).setGroup(cr),oe=to("mapSize","vec2",s).setGroup(cr);let G=this.vsmMaterialVertical||(this.vsmMaterialVertical=new No);G.fragmentNode=x$e({samples:ne,radius:se,size:oe,shadowPass:Y,depthLayer:this.depthLayer}).context(e.getSharedContext()),G.name="VSMVertical",G=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new No),G.fragmentNode=b$e({samples:ne,radius:se,size:oe,shadowPass:A,depthLayer:this.depthLayer}).context(e.getSharedContext()),G.name="VSMHorizontal"}const p=to("intensity","float",s).setGroup(cr),y=to("normalBias","float",s).setGroup(cr),x=wD(r).mul(N$.add(L4.mul(y))),w=this.setupShadowCoord(e,x),C=s.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(C===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const N=d===em&&s.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:a,F=this.setupShadowFilter(e,{filterFn:C,shadowTexture:c.texture,depthTexture:N,shadowCoord:w,shadow:s,depthLayer:this.depthLayer});let U;t.shadowMap.transmitted===!0&&(c.texture.isCubeTexture?U=Dc(c.texture,w.xyz):(U=$i(c.texture,w),a.isArrayTexture&&(U=U.depth(this.depthLayer))));let R;U?R=Ei(1,F.rgb.mix(U,1),p.mul(U.a)).toVar():R=Ei(1,F,p).toVar(),this.shadowMap=c,this.shadow.map=c;const B=`${this.light.type} Shadow [ ${this.light.name||"ID: "+this.light.id} ]`;return U&&R.toInspector(`${B} / Color`,()=>this.shadowMap.texture.isCubeTexture?Dc(this.shadowMap.texture):$i(this.shadowMap.texture)),R.toInspector(`${B} / Depth`,()=>this.shadowMap.texture.isCubeTexture?Dc(this.shadowMap.texture).r.oneMinus():$o(this.shadowMap.depthTexture,Es().mul(S4($i(this.shadowMap.depthTexture)))).r.oneMinus())}setup(e){if(e.renderer.shadowMap.enabled!==!1)return We(()=>{const t=e.renderer.shadowMap.type;this._currentShadowType!==t&&(this._reset(),this._node=null);let n=this._node;return this.setupShadowPosition(e),n===null&&(this._node=n=this.setupShadow(e),this._currentShadowType=t),e.material.receivedShadowNode&&(n=e.material.receivedShadowNode(n)),n})()}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:s,scene:a}=e;t.updateMatrices(r),n.setSize(t.mapSize.width,t.mapSize.height,n.depth);const c=a.name;a.name=`Shadow Map [ ${r.name||"ID: "+r.id} ]`,s.render(a,t.camera),a.name=c}updateShadow(e){const{shadowMap:t,light:n,shadow:r}=this,{renderer:s,scene:a,camera:c}=e,d=s.shadowMap.type,p=t.depthTexture.version;this._depthVersionCached=p;const y=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=c.layers.mask);const x=s.getRenderObjectFunction(),w=s.getMRT(),C=w?w.has("velocity"):!1;Uj=y$e(s,a,Uj),a.overrideMaterial=P_e(n),s.setRenderObjectFunction(I_e(s,r,d,C)),s.setClearColor(0,0),s.setRenderTarget(t),this.renderShadow(e),s.setRenderObjectFunction(x),d===em&&r.isPointLightShadow!==!0&&this.vsmPass(s),r.camera.layers.mask=y,_$e(s,a,Uj)}vsmPass(e){const{shadow:t}=this,n=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,n),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,n),e.setRenderTarget(this.vsmShadowMapVertical),EN.material=this.vsmMaterialVertical,EN.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),EN.material=this.vsmMaterialHorizontal,EN.render(e)}dispose(){this._reset(),super.dispose()}_reset(){this._currentShadowType=null,R_e(this.light),this.shadowMap&&(this.shadowMap.dispose(),this.shadowMap=null),this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null)}updateBefore(e){const{shadow:t}=this;let n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const k_e=(i,e)=>new N_e(i,e),w$e=new xn,m5e=new An,gT=new _e,Bj=new _e,T$e=[new _e(1,0,0),new _e(-1,0,0),new _e(0,-1,0),new _e(0,1,0),new _e(0,0,1),new _e(0,0,-1)],E$e=[new _e(0,-1,0),new _e(0,-1,0),new _e(0,0,-1),new _e(0,0,1),new _e(0,-1,0),new _e(0,-1,0)],M$e=[new _e(1,0,0),new _e(-1,0,0),new _e(0,1,0),new _e(0,-1,0),new _e(0,0,1),new _e(0,0,-1)],C$e=[new _e(0,-1,0),new _e(0,-1,0),new _e(0,0,1),new _e(0,0,-1),new _e(0,-1,0),new _e(0,-1,0)],D_e=We(({depthTexture:i,bd3D:e,dp:t})=>Dc(i,e).compare(t)),O_e=We(({depthTexture:i,bd3D:e,dp:t,shadow:n})=>{const r=to("radius","float",n).setGroup(cr),s=to("mapSize","vec2",n).setGroup(cr),a=r.div(s.x),c=Vs(e),d=Au(T2(e,c.x.greaterThan(c.z).select(Ve(0,1,0),Ve(1,0,0)))),p=T2(e,d),y=T$(b6.xy).mul(6.28318530718),x=Qf(0,5,y),w=Qf(1,5,y),C=Qf(2,5,y),N=Qf(3,5,y),F=Qf(4,5,y);return Dc(i,e.add(d.mul(x.x).add(p.mul(x.y)).mul(a))).compare(t).add(Dc(i,e.add(d.mul(w.x).add(p.mul(w.y)).mul(a))).compare(t)).add(Dc(i,e.add(d.mul(C.x).add(p.mul(C.y)).mul(a))).compare(t)).add(Dc(i,e.add(d.mul(N.x).add(p.mul(N.y)).mul(a))).compare(t)).add(Dc(i,e.add(d.mul(F.x).add(p.mul(F.y)).mul(a))).compare(t)).mul(1/5)}),A$e=We(({filterFn:i,depthTexture:e,shadowCoord:t,shadow:n},r)=>{const s=t.xyz.toConst(),a=s.abs().toConst(),c=a.x.max(a.y).max(a.z),d=rr("float").setGroup(cr).onRenderUpdate(()=>n.camera.near),p=rr("float").setGroup(cr).onRenderUpdate(()=>n.camera.far),y=to("bias","float",n).setGroup(cr),x=xe(1).toVar();return gr(c.sub(p).lessThanEqual(0).and(c.sub(d).greaterThanEqual(0)),()=>{let w;r.renderer.reversedDepthBuffer?(w=E7e(c.negate(),d,p),w.subAssign(y)):(w=l$(c.negate(),d,p),w.addAssign(y));const C=s.normalize();x.assign(i({depthTexture:e,bd3D:C,dp:w,shadow:n}))}),x});class P$e extends N_e{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===rNe?D_e:O_e}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:s}){return A$e({filterFn:t,depthTexture:n,shadowCoord:r,shadow:s})}setupRenderTarget(e,t){const n=new jve(e.mapSize.width);n.name="PointShadowDepthTexture",n.compareFunction=t.renderer.reversedDepthBuffer?p6:f6;const r=t.createCubeRenderTarget(e.mapSize.width);return r.texture.name="PointShadowMap",r.depthTexture=n,{shadowMap:r,depthTexture:n}}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:s,scene:a}=e,c=t.camera,d=t.matrix,p=s.coordinateSystem===Sd,y=p?T$e:M$e,x=p?E$e:C$e;n.setSize(t.mapSize.width,t.mapSize.width);const w=s.autoClear,C=s.getClearColor(w$e),N=s.getClearAlpha();s.autoClear=!1,s.setClearColor(t.clearColor,t.clearAlpha);for(let F=0;F<6;F++){s.setRenderTarget(n,F),s.clear();const U=r.distance||c.far;U!==c.far&&(c.far=U,c.updateProjectionMatrix()),gT.setFromMatrixPosition(r.matrixWorld),c.position.copy(gT),Bj.copy(c.position),Bj.add(y[F]),c.up.copy(x[F]),c.lookAt(Bj),c.updateMatrixWorld(),d.makeTranslation(-gT.x,-gT.y,-gT.z),m5e.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),t._frustum.setFromProjectionMatrix(m5e,c.coordinateSystem,c.reversedDepth);const R=a.name;a.name=`Point Light Shadow [ ${r.name||"ID: "+r.id} ] - Face ${F+1}`,s.render(a,c),a.name=R}s.autoClear=w,s.setClearColor(C,N)}}const L_e=(i,e)=>new P$e(i,e);class S6 extends Kx{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new xn,this.colorNode=e&&e.colorNode||rr(this.color).setGroup(cr),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=Fr.FRAME,e&&e.shadow&&(this._shadowDisposeListener=()=>{this.disposeShadow()},e.addEventListener("dispose",this._shadowDisposeListener))}dispose(){this._shadowDisposeListener&&this.light.removeEventListener("dispose",this._shadowDisposeListener),super.dispose()}disposeShadow(){this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null),this.shadowColorNode=null,this.baseColorNode!==null&&(this.colorNode=this.baseColorNode,this.baseColorNode=null)}getHash(){return this.light.uuid}getLightVector(e){return P$(this.light).sub(e.context.positionView||ua)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return k_e(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const r=this.light.shadow.shadowNode;let s;r!==void 0?s=qn(r):s=this.setupShadowNode(),this.shadowNode=s,this.shadowColorNode=n=this.colorNode.mul(s),this.baseColorNode=this.colorNode}e.context.getShadow&&(n=e.context.getShadow(this,e)),this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const k$=We(({lightDistance:i,cutoffDistance:e,decayExponent:t})=>{const n=i.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(n.mul(i.div(e).pow4().oneMinus().clamp().pow2()),n)}),F_e=({color:i,lightVector:e,cutoffDistance:t,decayExponent:n})=>{const r=e.normalize(),s=e.length(),a=k$({lightDistance:s,cutoffDistance:t,decayExponent:n}),c=i.mul(a);return{lightDirection:r,lightColor:c}};class R$e extends S6{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=rr(0).setGroup(cr),this.decayExponentNode=rr(2).setGroup(cr)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return L_e(this.light)}setupDirect(e){return F_e({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const I$e=We(([i=Es()])=>{const e=i.mul(2),t=e.x.floor(),n=e.y.floor();return t.add(n).mod(2).sign()}),N$e=We(([i=Es()],{renderer:e,material:t})=>{const n=Uq(i.mul(2).sub(1));let r;if(t.alphaToCoverage&&e.currentSamples>0){const s=xe(n.fwidth()).toVar();r=ap(s.oneMinus(),s.add(1),n).oneMinus()}else r=$l(n.greaterThan(1),0,1);return r}),KT=We(([i,e,t])=>{const n=xe(t).toVar(),r=xe(e).toVar(),s=Ch(i).toVar();return $l(s,r,n)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),bk=We(([i,e])=>{const t=Ch(e).toVar(),n=xe(i).toVar();return $l(t,n.negate(),n)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),Ma=We(([i])=>{const e=xe(i).toVar();return Fe(om(e))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),yo=We(([i,e])=>{const t=xe(i).toVar();return e.assign(Ma(t)),t.sub(xe(e))}),k$e=We(([i,e,t,n,r,s])=>{const a=xe(s).toVar(),c=xe(r).toVar(),d=xe(n).toVar(),p=xe(t).toVar(),y=xe(e).toVar(),x=xe(i).toVar(),w=xe(Ri(1,c)).toVar();return Ri(1,a).mul(x.mul(w).add(y.mul(c))).add(a.mul(p.mul(w).add(d.mul(c))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),D$e=We(([i,e,t,n,r,s])=>{const a=xe(s).toVar(),c=xe(r).toVar(),d=Ve(n).toVar(),p=Ve(t).toVar(),y=Ve(e).toVar(),x=Ve(i).toVar(),w=xe(Ri(1,c)).toVar();return Ri(1,a).mul(x.mul(w).add(y.mul(c))).add(a.mul(p.mul(w).add(d.mul(c))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),U_e=cl([k$e,D$e]),O$e=We(([i,e,t,n,r,s,a,c,d,p,y])=>{const x=xe(y).toVar(),w=xe(p).toVar(),C=xe(d).toVar(),N=xe(c).toVar(),F=xe(a).toVar(),U=xe(s).toVar(),R=xe(r).toVar(),B=xe(n).toVar(),Y=xe(t).toVar(),A=xe(e).toVar(),ne=xe(i).toVar(),se=xe(Ri(1,C)).toVar(),oe=xe(Ri(1,w)).toVar();return xe(Ri(1,x)).toVar().mul(oe.mul(ne.mul(se).add(A.mul(C))).add(w.mul(Y.mul(se).add(B.mul(C))))).add(x.mul(oe.mul(R.mul(se).add(U.mul(C))).add(w.mul(F.mul(se).add(N.mul(C))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),L$e=We(([i,e,t,n,r,s,a,c,d,p,y])=>{const x=xe(y).toVar(),w=xe(p).toVar(),C=xe(d).toVar(),N=Ve(c).toVar(),F=Ve(a).toVar(),U=Ve(s).toVar(),R=Ve(r).toVar(),B=Ve(n).toVar(),Y=Ve(t).toVar(),A=Ve(e).toVar(),ne=Ve(i).toVar(),se=xe(Ri(1,C)).toVar(),oe=xe(Ri(1,w)).toVar();return xe(Ri(1,x)).toVar().mul(oe.mul(ne.mul(se).add(A.mul(C))).add(w.mul(Y.mul(se).add(B.mul(C))))).add(x.mul(oe.mul(R.mul(se).add(U.mul(C))).add(w.mul(F.mul(se).add(N.mul(C))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),B_e=cl([O$e,L$e]),F$e=We(([i,e,t])=>{const n=xe(t).toVar(),r=xe(e).toVar(),s=Zt(i).toVar(),a=Zt(s.bitAnd(Zt(7))).toVar(),c=xe(KT(a.lessThan(Zt(4)),r,n)).toVar(),d=xe(Ur(2,KT(a.lessThan(Zt(4)),n,r))).toVar();return bk(c,Ch(a.bitAnd(Zt(1)))).add(bk(d,Ch(a.bitAnd(Zt(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),U$e=We(([i,e,t,n])=>{const r=xe(n).toVar(),s=xe(t).toVar(),a=xe(e).toVar(),c=Zt(i).toVar(),d=Zt(c.bitAnd(Zt(15))).toVar(),p=xe(KT(d.lessThan(Zt(8)),a,s)).toVar(),y=xe(KT(d.lessThan(Zt(4)),s,KT(d.equal(Zt(12)).or(d.equal(Zt(14))),a,r))).toVar();return bk(p,Ch(d.bitAnd(Zt(1)))).add(bk(y,Ch(d.bitAnd(Zt(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),M0=cl([F$e,U$e]),B$e=We(([i,e,t])=>{const n=xe(t).toVar(),r=xe(e).toVar(),s=x6(i).toVar();return Ve(M0(s.x,r,n),M0(s.y,r,n),M0(s.z,r,n))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),z$e=We(([i,e,t,n])=>{const r=xe(n).toVar(),s=xe(t).toVar(),a=xe(e).toVar(),c=x6(i).toVar();return Ve(M0(c.x,a,s,r),M0(c.y,a,s,r),M0(c.z,a,s,r))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),_h=cl([B$e,z$e]),V$e=We(([i])=>{const e=xe(i).toVar();return Ur(.6616,e)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),G$e=We(([i])=>{const e=xe(i).toVar();return Ur(.982,e)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),j$e=We(([i])=>{const e=Ve(i).toVar();return Ur(.6616,e)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),z_e=cl([V$e,j$e]),H$e=We(([i])=>{const e=Ve(i).toVar();return Ur(.982,e)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),V_e=cl([G$e,H$e]),_d=We(([i,e])=>{const t=Fe(e).toVar(),n=Zt(i).toVar();return n.shiftLeft(t).bitOr(n.shiftRight(Fe(32).sub(t)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),G_e=We(([i,e,t])=>{i.subAssign(t),i.bitXorAssign(_d(t,Fe(4))),t.addAssign(e),e.subAssign(i),e.bitXorAssign(_d(i,Fe(6))),i.addAssign(t),t.subAssign(e),t.bitXorAssign(_d(e,Fe(8))),e.addAssign(i),i.subAssign(t),i.bitXorAssign(_d(t,Fe(16))),t.addAssign(e),e.subAssign(i),e.bitXorAssign(_d(i,Fe(19))),i.addAssign(t),t.subAssign(e),t.bitXorAssign(_d(e,Fe(4))),e.addAssign(i)}),YE=We(([i,e,t])=>{const n=Zt(t).toVar(),r=Zt(e).toVar(),s=Zt(i).toVar();return n.bitXorAssign(r),n.subAssign(_d(r,Fe(14))),s.bitXorAssign(n),s.subAssign(_d(n,Fe(11))),r.bitXorAssign(s),r.subAssign(_d(s,Fe(25))),n.bitXorAssign(r),n.subAssign(_d(r,Fe(16))),s.bitXorAssign(n),s.subAssign(_d(n,Fe(4))),r.bitXorAssign(s),r.subAssign(_d(s,Fe(14))),n.bitXorAssign(r),n.subAssign(_d(r,Fe(24))),n}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),Xl=We(([i])=>{const e=Zt(i).toVar();return xe(e).div(xe(Zt(Fe(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),dm=We(([i])=>{const e=xe(i).toVar();return e.mul(e).mul(e).mul(e.mul(e.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),W$e=We(([i])=>{const e=Fe(i).toVar(),t=Zt(Zt(1)).toVar(),n=Zt(Zt(Fe(3735928559)).add(t.shiftLeft(Zt(2))).add(Zt(13))).toVar();return YE(n.add(Zt(e)),n,n)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),q$e=We(([i,e])=>{const t=Fe(e).toVar(),n=Fe(i).toVar(),r=Zt(Zt(2)).toVar(),s=Zt().toVar(),a=Zt().toVar(),c=Zt().toVar();return s.assign(a.assign(c.assign(Zt(Fe(3735928559)).add(r.shiftLeft(Zt(2))).add(Zt(13))))),s.addAssign(Zt(n)),a.addAssign(Zt(t)),YE(s,a,c)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),$$e=We(([i,e,t])=>{const n=Fe(t).toVar(),r=Fe(e).toVar(),s=Fe(i).toVar(),a=Zt(Zt(3)).toVar(),c=Zt().toVar(),d=Zt().toVar(),p=Zt().toVar();return c.assign(d.assign(p.assign(Zt(Fe(3735928559)).add(a.shiftLeft(Zt(2))).add(Zt(13))))),c.addAssign(Zt(s)),d.addAssign(Zt(r)),p.addAssign(Zt(n)),YE(c,d,p)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),X$e=We(([i,e,t,n])=>{const r=Fe(n).toVar(),s=Fe(t).toVar(),a=Fe(e).toVar(),c=Fe(i).toVar(),d=Zt(Zt(4)).toVar(),p=Zt().toVar(),y=Zt().toVar(),x=Zt().toVar();return p.assign(y.assign(x.assign(Zt(Fe(3735928559)).add(d.shiftLeft(Zt(2))).add(Zt(13))))),p.addAssign(Zt(c)),y.addAssign(Zt(a)),x.addAssign(Zt(s)),G_e(p,y,x),p.addAssign(Zt(r)),YE(p,y,x)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),Y$e=We(([i,e,t,n,r])=>{const s=Fe(r).toVar(),a=Fe(n).toVar(),c=Fe(t).toVar(),d=Fe(e).toVar(),p=Fe(i).toVar(),y=Zt(Zt(5)).toVar(),x=Zt().toVar(),w=Zt().toVar(),C=Zt().toVar();return x.assign(w.assign(C.assign(Zt(Fe(3735928559)).add(y.shiftLeft(Zt(2))).add(Zt(13))))),x.addAssign(Zt(p)),w.addAssign(Zt(d)),C.addAssign(Zt(c)),G_e(x,w,C),x.addAssign(Zt(a)),w.addAssign(Zt(s)),YE(x,w,C)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),Ts=cl([W$e,q$e,$$e,X$e,Y$e]),K$e=We(([i,e])=>{const t=Fe(e).toVar(),n=Fe(i).toVar(),r=Zt(Ts(n,t)).toVar(),s=x6().toVar();return s.x.assign(r.bitAnd(Fe(255))),s.y.assign(r.shiftRight(Fe(8)).bitAnd(Fe(255))),s.z.assign(r.shiftRight(Fe(16)).bitAnd(Fe(255))),s}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Z$e=We(([i,e,t])=>{const n=Fe(t).toVar(),r=Fe(e).toVar(),s=Fe(i).toVar(),a=Zt(Ts(s,r,n)).toVar(),c=x6().toVar();return c.x.assign(a.bitAnd(Fe(255))),c.y.assign(a.shiftRight(Fe(8)).bitAnd(Fe(255))),c.z.assign(a.shiftRight(Fe(16)).bitAnd(Fe(255))),c}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),xh=cl([K$e,Z$e]),Q$e=We(([i])=>{const e=en(i).toVar(),t=Fe().toVar(),n=Fe().toVar(),r=xe(yo(e.x,t)).toVar(),s=xe(yo(e.y,n)).toVar(),a=xe(dm(r)).toVar(),c=xe(dm(s)).toVar(),d=xe(U_e(M0(Ts(t,n),r,s),M0(Ts(t.add(Fe(1)),n),r.sub(1),s),M0(Ts(t,n.add(Fe(1))),r,s.sub(1)),M0(Ts(t.add(Fe(1)),n.add(Fe(1))),r.sub(1),s.sub(1)),a,c)).toVar();return z_e(d)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),J$e=We(([i])=>{const e=Ve(i).toVar(),t=Fe().toVar(),n=Fe().toVar(),r=Fe().toVar(),s=xe(yo(e.x,t)).toVar(),a=xe(yo(e.y,n)).toVar(),c=xe(yo(e.z,r)).toVar(),d=xe(dm(s)).toVar(),p=xe(dm(a)).toVar(),y=xe(dm(c)).toVar(),x=xe(B_e(M0(Ts(t,n,r),s,a,c),M0(Ts(t.add(Fe(1)),n,r),s.sub(1),a,c),M0(Ts(t,n.add(Fe(1)),r),s,a.sub(1),c),M0(Ts(t.add(Fe(1)),n.add(Fe(1)),r),s.sub(1),a.sub(1),c),M0(Ts(t,n,r.add(Fe(1))),s,a,c.sub(1)),M0(Ts(t.add(Fe(1)),n,r.add(Fe(1))),s.sub(1),a,c.sub(1)),M0(Ts(t,n.add(Fe(1)),r.add(Fe(1))),s,a.sub(1),c.sub(1)),M0(Ts(t.add(Fe(1)),n.add(Fe(1)),r.add(Fe(1))),s.sub(1),a.sub(1),c.sub(1)),d,p,y)).toVar();return V_e(x)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),D$=cl([Q$e,J$e]),eXe=We(([i])=>{const e=en(i).toVar(),t=Fe().toVar(),n=Fe().toVar(),r=xe(yo(e.x,t)).toVar(),s=xe(yo(e.y,n)).toVar(),a=xe(dm(r)).toVar(),c=xe(dm(s)).toVar(),d=Ve(U_e(_h(xh(t,n),r,s),_h(xh(t.add(Fe(1)),n),r.sub(1),s),_h(xh(t,n.add(Fe(1))),r,s.sub(1)),_h(xh(t.add(Fe(1)),n.add(Fe(1))),r.sub(1),s.sub(1)),a,c)).toVar();return z_e(d)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),tXe=We(([i])=>{const e=Ve(i).toVar(),t=Fe().toVar(),n=Fe().toVar(),r=Fe().toVar(),s=xe(yo(e.x,t)).toVar(),a=xe(yo(e.y,n)).toVar(),c=xe(yo(e.z,r)).toVar(),d=xe(dm(s)).toVar(),p=xe(dm(a)).toVar(),y=xe(dm(c)).toVar(),x=Ve(B_e(_h(xh(t,n,r),s,a,c),_h(xh(t.add(Fe(1)),n,r),s.sub(1),a,c),_h(xh(t,n.add(Fe(1)),r),s,a.sub(1),c),_h(xh(t.add(Fe(1)),n.add(Fe(1)),r),s.sub(1),a.sub(1),c),_h(xh(t,n,r.add(Fe(1))),s,a,c.sub(1)),_h(xh(t.add(Fe(1)),n,r.add(Fe(1))),s.sub(1),a,c.sub(1)),_h(xh(t,n.add(Fe(1)),r.add(Fe(1))),s,a.sub(1),c.sub(1)),_h(xh(t.add(Fe(1)),n.add(Fe(1)),r.add(Fe(1))),s.sub(1),a.sub(1),c.sub(1)),d,p,y)).toVar();return V_e(x)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),KE=cl([eXe,tXe]),nXe=We(([i])=>{const e=xe(i).toVar(),t=Fe(Ma(e)).toVar();return Xl(Ts(t))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),rXe=We(([i])=>{const e=en(i).toVar(),t=Fe(Ma(e.x)).toVar(),n=Fe(Ma(e.y)).toVar();return Xl(Ts(t,n))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),iXe=We(([i])=>{const e=Ve(i).toVar(),t=Fe(Ma(e.x)).toVar(),n=Fe(Ma(e.y)).toVar(),r=Fe(Ma(e.z)).toVar();return Xl(Ts(t,n,r))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),sXe=We(([i])=>{const e=hr(i).toVar(),t=Fe(Ma(e.x)).toVar(),n=Fe(Ma(e.y)).toVar(),r=Fe(Ma(e.z)).toVar(),s=Fe(Ma(e.w)).toVar();return Xl(Ts(t,n,r,s))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),oXe=cl([nXe,rXe,iXe,sXe]),aXe=We(([i])=>{const e=xe(i).toVar(),t=Fe(Ma(e)).toVar();return Ve(Xl(Ts(t,Fe(0))),Xl(Ts(t,Fe(1))),Xl(Ts(t,Fe(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),lXe=We(([i])=>{const e=en(i).toVar(),t=Fe(Ma(e.x)).toVar(),n=Fe(Ma(e.y)).toVar();return Ve(Xl(Ts(t,n,Fe(0))),Xl(Ts(t,n,Fe(1))),Xl(Ts(t,n,Fe(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),cXe=We(([i])=>{const e=Ve(i).toVar(),t=Fe(Ma(e.x)).toVar(),n=Fe(Ma(e.y)).toVar(),r=Fe(Ma(e.z)).toVar();return Ve(Xl(Ts(t,n,r,Fe(0))),Xl(Ts(t,n,r,Fe(1))),Xl(Ts(t,n,r,Fe(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),uXe=We(([i])=>{const e=hr(i).toVar(),t=Fe(Ma(e.x)).toVar(),n=Fe(Ma(e.y)).toVar(),r=Fe(Ma(e.z)).toVar(),s=Fe(Ma(e.w)).toVar();return Ve(Xl(Ts(t,n,r,s,Fe(0))),Xl(Ts(t,n,r,s,Fe(1))),Xl(Ts(t,n,r,s,Fe(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),TD=cl([aXe,lXe,cXe,uXe]),Sk=We(([i,e,t,n])=>{const r=xe(n).toVar(),s=xe(t).toVar(),a=Fe(e).toVar(),c=Ve(i).toVar(),d=xe(0).toVar(),p=xe(1).toVar();return _s(a,()=>{d.addAssign(p.mul(D$(c))),p.mulAssign(r),c.mulAssign(s)}),d}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),ED=We(([i,e,t,n])=>{const r=xe(n).toVar(),s=xe(t).toVar(),a=Fe(e).toVar(),c=Ve(i).toVar(),d=Ve(0).toVar(),p=xe(1).toVar();return _s(a,()=>{d.addAssign(p.mul(KE(c))),p.mulAssign(r),c.mulAssign(s)}),d}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),dXe=We(([i,e,t,n])=>{const r=xe(n).toVar(),s=xe(t).toVar(),a=Fe(e).toVar(),c=Ve(i).toVar();return en(Sk(c,a,s,r),Sk(c.add(Ve(Fe(19),Fe(193),Fe(17))),a,s,r))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),hXe=We(([i,e,t,n])=>{const r=xe(n).toVar(),s=xe(t).toVar(),a=Fe(e).toVar(),c=Ve(i).toVar(),d=Ve(ED(c,a,s,r)).toVar(),p=xe(Sk(c.add(Ve(Fe(19),Fe(193),Fe(17))),a,s,r)).toVar();return hr(d,p)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),fXe=We(([i,e,t,n,r,s,a])=>{const c=Fe(a).toVar(),d=xe(s).toVar(),p=Fe(r).toVar(),y=Fe(n).toVar(),x=Fe(t).toVar(),w=Fe(e).toVar(),C=en(i).toVar(),N=Ve(TD(en(w.add(y),x.add(p)))).toVar(),F=en(N.x,N.y).toVar();F.subAssign(.5),F.mulAssign(d),F.addAssign(.5);const U=en(en(xe(w),xe(x)).add(F)).toVar(),R=en(U.sub(C)).toVar();return gr(c.equal(Fe(2)),()=>Vs(R.x).add(Vs(R.y))),gr(c.equal(Fe(3)),()=>Io(Vs(R.x),Vs(R.y))),Ah(R,R)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),pXe=We(([i,e,t,n,r,s,a,c,d])=>{const p=Fe(d).toVar(),y=xe(c).toVar(),x=Fe(a).toVar(),w=Fe(s).toVar(),C=Fe(r).toVar(),N=Fe(n).toVar(),F=Fe(t).toVar(),U=Fe(e).toVar(),R=Ve(i).toVar(),B=Ve(TD(Ve(U.add(C),F.add(w),N.add(x)))).toVar();B.subAssign(.5),B.mulAssign(y),B.addAssign(.5);const Y=Ve(Ve(xe(U),xe(F),xe(N)).add(B)).toVar(),A=Ve(Y.sub(R)).toVar();return gr(p.equal(Fe(2)),()=>Vs(A.x).add(Vs(A.y)).add(Vs(A.z))),gr(p.equal(Fe(3)),()=>Io(Vs(A.x),Vs(A.y),Vs(A.z))),Ah(A,A)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Qx=cl([fXe,pXe]),mXe=We(([i,e,t])=>{const n=Fe(t).toVar(),r=xe(e).toVar(),s=en(i).toVar(),a=Fe().toVar(),c=Fe().toVar(),d=en(yo(s.x,a),yo(s.y,c)).toVar(),p=xe(1e6).toVar();return _s({start:-1,end:Fe(1),name:"x",condition:"<="},({x:y})=>{_s({start:-1,end:Fe(1),name:"y",condition:"<="},({y:x})=>{const w=xe(Qx(d,y,x,a,c,r,n)).toVar();p.assign(Pu(p,w))})}),gr(n.equal(Fe(0)),()=>{p.assign(Lc(p))}),p}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),gXe=We(([i,e,t])=>{const n=Fe(t).toVar(),r=xe(e).toVar(),s=en(i).toVar(),a=Fe().toVar(),c=Fe().toVar(),d=en(yo(s.x,a),yo(s.y,c)).toVar(),p=en(1e6,1e6).toVar();return _s({start:-1,end:Fe(1),name:"x",condition:"<="},({x:y})=>{_s({start:-1,end:Fe(1),name:"y",condition:"<="},({y:x})=>{const w=xe(Qx(d,y,x,a,c,r,n)).toVar();gr(w.lessThan(p.x),()=>{p.y.assign(p.x),p.x.assign(w)}).ElseIf(w.lessThan(p.y),()=>{p.y.assign(w)})})}),gr(n.equal(Fe(0)),()=>{p.assign(Lc(p))}),p}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),vXe=We(([i,e,t])=>{const n=Fe(t).toVar(),r=xe(e).toVar(),s=en(i).toVar(),a=Fe().toVar(),c=Fe().toVar(),d=en(yo(s.x,a),yo(s.y,c)).toVar(),p=Ve(1e6,1e6,1e6).toVar();return _s({start:-1,end:Fe(1),name:"x",condition:"<="},({x:y})=>{_s({start:-1,end:Fe(1),name:"y",condition:"<="},({y:x})=>{const w=xe(Qx(d,y,x,a,c,r,n)).toVar();gr(w.lessThan(p.x),()=>{p.z.assign(p.y),p.y.assign(p.x),p.x.assign(w)}).ElseIf(w.lessThan(p.y),()=>{p.z.assign(p.y),p.y.assign(w)}).ElseIf(w.lessThan(p.z),()=>{p.z.assign(w)})})}),gr(n.equal(Fe(0)),()=>{p.assign(Lc(p))}),p}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),yXe=We(([i,e,t])=>{const n=Fe(t).toVar(),r=xe(e).toVar(),s=Ve(i).toVar(),a=Fe().toVar(),c=Fe().toVar(),d=Fe().toVar(),p=Ve(yo(s.x,a),yo(s.y,c),yo(s.z,d)).toVar(),y=xe(1e6).toVar();return _s({start:-1,end:Fe(1),name:"x",condition:"<="},({x})=>{_s({start:-1,end:Fe(1),name:"y",condition:"<="},({y:w})=>{_s({start:-1,end:Fe(1),name:"z",condition:"<="},({z:C})=>{const N=xe(Qx(p,x,w,C,a,c,d,r,n)).toVar();y.assign(Pu(y,N))})})}),gr(n.equal(Fe(0)),()=>{y.assign(Lc(y))}),y}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),_Xe=cl([mXe,yXe]),xXe=We(([i,e,t])=>{const n=Fe(t).toVar(),r=xe(e).toVar(),s=Ve(i).toVar(),a=Fe().toVar(),c=Fe().toVar(),d=Fe().toVar(),p=Ve(yo(s.x,a),yo(s.y,c),yo(s.z,d)).toVar(),y=en(1e6,1e6).toVar();return _s({start:-1,end:Fe(1),name:"x",condition:"<="},({x})=>{_s({start:-1,end:Fe(1),name:"y",condition:"<="},({y:w})=>{_s({start:-1,end:Fe(1),name:"z",condition:"<="},({z:C})=>{const N=xe(Qx(p,x,w,C,a,c,d,r,n)).toVar();gr(N.lessThan(y.x),()=>{y.y.assign(y.x),y.x.assign(N)}).ElseIf(N.lessThan(y.y),()=>{y.y.assign(N)})})})}),gr(n.equal(Fe(0)),()=>{y.assign(Lc(y))}),y}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),bXe=cl([gXe,xXe]),SXe=We(([i,e,t])=>{const n=Fe(t).toVar(),r=xe(e).toVar(),s=Ve(i).toVar(),a=Fe().toVar(),c=Fe().toVar(),d=Fe().toVar(),p=Ve(yo(s.x,a),yo(s.y,c),yo(s.z,d)).toVar(),y=Ve(1e6,1e6,1e6).toVar();return _s({start:-1,end:Fe(1),name:"x",condition:"<="},({x})=>{_s({start:-1,end:Fe(1),name:"y",condition:"<="},({y:w})=>{_s({start:-1,end:Fe(1),name:"z",condition:"<="},({z:C})=>{const N=xe(Qx(p,x,w,C,a,c,d,r,n)).toVar();gr(N.lessThan(y.x),()=>{y.z.assign(y.y),y.y.assign(y.x),y.x.assign(N)}).ElseIf(N.lessThan(y.y),()=>{y.z.assign(y.y),y.y.assign(N)}).ElseIf(N.lessThan(y.z),()=>{y.z.assign(N)})})})}),gr(n.equal(Fe(0)),()=>{y.assign(Lc(y))}),y}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),O$=cl([vXe,SXe]),wXe=We(([i,e,t,n,r,s,a,c,d,p,y])=>{const x=Fe(i).toVar(),w=en(e).toVar(),C=en(t).toVar(),N=en(n).toVar(),F=xe(r).toVar(),U=xe(s).toVar(),R=xe(a).toVar(),B=Ch(c).toVar(),Y=Fe(d).toVar(),A=xe(p).toVar(),ne=xe(y).toVar(),se=w.mul(C).add(N),oe=xe(0).toVar();return gr(x.equal(Fe(0)),()=>{oe.assign(KE(se))}),gr(x.equal(Fe(1)),()=>{oe.assign(TD(se))}),gr(x.equal(Fe(2)),()=>{oe.assign(O$(se,F,Fe(0)))}),gr(x.equal(Fe(3)),()=>{oe.assign(ED(Ve(se,0),Y,A,ne))}),oe.assign(oe.mul(R.sub(U)).add(U)),gr(B,()=>{oe.assign(op(oe,U,R))}),oe}).setLayout({name:"mx_unifiednoise2d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"texcoord",type:"vec2"},{name:"freq",type:"vec2"},{name:"offset",type:"vec2"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),TXe=We(([i,e,t,n,r,s,a,c,d,p,y])=>{const x=Fe(i).toVar(),w=Ve(e).toVar(),C=Ve(t).toVar(),N=Ve(n).toVar(),F=xe(r).toVar(),U=xe(s).toVar(),R=xe(a).toVar(),B=Ch(c).toVar(),Y=Fe(d).toVar(),A=xe(p).toVar(),ne=xe(y).toVar(),se=w.mul(C).add(N),oe=xe(0).toVar();return gr(x.equal(Fe(0)),()=>{oe.assign(KE(se))}),gr(x.equal(Fe(1)),()=>{oe.assign(TD(se))}),gr(x.equal(Fe(2)),()=>{oe.assign(O$(se,F,Fe(0)))}),gr(x.equal(Fe(3)),()=>{oe.assign(ED(se,Y,A,ne))}),oe.assign(oe.mul(R.sub(U)).add(U)),gr(B,()=>{oe.assign(op(oe,U,R))}),oe}).setLayout({name:"mx_unifiednoise3d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"position",type:"vec3"},{name:"freq",type:"vec3"},{name:"offset",type:"vec3"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),EXe=We(([i])=>{const e=i.y,t=i.z,n=Ve().toVar();return gr(e.lessThan(1e-4),()=>{n.assign(Ve(t,t,t))}).Else(()=>{let r=i.x;r=r.sub(om(r)).mul(6).toVar();const s=Fe(Dq(r)),a=r.sub(xe(s)),c=t.mul(e.oneMinus()),d=t.mul(e.mul(a).oneMinus()),p=t.mul(e.mul(a.oneMinus()).oneMinus());gr(s.equal(Fe(0)),()=>{n.assign(Ve(t,p,c))}).ElseIf(s.equal(Fe(1)),()=>{n.assign(Ve(d,t,c))}).ElseIf(s.equal(Fe(2)),()=>{n.assign(Ve(c,t,p))}).ElseIf(s.equal(Fe(3)),()=>{n.assign(Ve(c,d,t))}).ElseIf(s.equal(Fe(4)),()=>{n.assign(Ve(p,c,t))}).Else(()=>{n.assign(Ve(t,c,d))})}),n}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),MXe=We(([i])=>{const e=Ve(i).toVar(),t=xe(e.x).toVar(),n=xe(e.y).toVar(),r=xe(e.z).toVar(),s=xe(Pu(t,Pu(n,r))).toVar(),a=xe(Io(t,Io(n,r))).toVar(),c=xe(a.sub(s)).toVar(),d=xe().toVar(),p=xe().toVar(),y=xe().toVar();return y.assign(a),gr(a.greaterThan(0),()=>{p.assign(c.div(a))}).Else(()=>{p.assign(0)}),gr(p.lessThanEqual(0),()=>{d.assign(0)}).Else(()=>{gr(t.greaterThanEqual(a),()=>{d.assign(n.sub(r).div(c))}).ElseIf(n.greaterThanEqual(a),()=>{d.assign(Ca(2,r.sub(t).div(c)))}).Else(()=>{d.assign(Ca(4,t.sub(n).div(c)))}),d.mulAssign(1/6),gr(d.lessThan(0),()=>{d.addAssign(1)})}),Ve(d,p,y)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),CXe=We(([i])=>{const e=Ve(i).toVar(),t=gq(Tq(e,Ve(.04045))).toVar(),n=Ve(e.div(12.92)).toVar(),r=Ve(Sh(Io(e.add(Ve(.055)),Ve(0)).div(1.055),Ve(2.4))).toVar();return Ei(n,r,t)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),j_e=(i,e)=>{i=xe(i),e=xe(e);const t=en(e.dFdx(),e.dFdy()).length().mul(.7071067811865476);return ap(i.sub(t),i.add(t),e)},H_e=(i,e,t,n)=>Ei(i,e,t[n].clamp()),AXe=(i,e,t=Es())=>H_e(i,e,t,"x"),PXe=(i,e,t=Es())=>H_e(i,e,t,"y"),RXe=(i,e,t,n,r=Es())=>{const s=r.x.clamp(),a=r.y.clamp(),c=Ei(i,e,s),d=Ei(t,n,s);return Ei(c,d,a)},W_e=(i,e,t,n,r)=>Ei(i,e,j_e(t,n[r])),IXe=(i,e,t,n=Es())=>W_e(i,e,t,n,"x"),NXe=(i,e,t,n=Es())=>W_e(i,e,t,n,"y"),kXe=(i=1,e=0,t=Es())=>t.mul(i).add(e),DXe=(i,e=1)=>(i=xe(i),i.abs().pow(e).mul(i.sign())),OXe=(i,e=1,t=.5)=>xe(i).sub(t).mul(e).add(t),LXe=(i=Es(),e=1,t=0)=>D$(i.convert("vec2|vec3")).mul(e).add(t),FXe=(i=Es(),e=1,t=0)=>KE(i.convert("vec2|vec3")).mul(e).add(t),UXe=(i=Es(),e=1,t=0)=>(i=i.convert("vec2|vec3"),hr(KE(i),D$(i.add(en(19,73)))).mul(e).add(t)),BXe=(i,e=Es(),t=en(1,1),n=en(0,0),r=1,s=0,a=1,c=!1,d=1,p=2,y=.5)=>wXe(i,e.convert("vec2|vec3"),t,n,r,s,a,c,d,p,y),zXe=(i,e=Es(),t=en(1,1),n=en(0,0),r=1,s=0,a=1,c=!1,d=1,p=2,y=.5)=>TXe(i,e.convert("vec2|vec3"),t,n,r,s,a,c,d,p,y),VXe=(i=Es(),e=1)=>_Xe(i.convert("vec2|vec3"),e,Fe(1)),GXe=(i=Es(),e=1)=>bXe(i.convert("vec2|vec3"),e,Fe(1)),jXe=(i=Es(),e=1)=>O$(i.convert("vec2|vec3"),e,Fe(1)),HXe=(i=Es())=>oXe(i.convert("vec2|vec3")),WXe=(i=Es(),e=3,t=2,n=.5,r=1)=>Sk(i,Fe(e),t,n).mul(r),qXe=(i=Es(),e=3,t=2,n=.5,r=1)=>dXe(i,Fe(e),t,n).mul(r),$Xe=(i=Es(),e=3,t=2,n=.5,r=1)=>ED(i,Fe(e),t,n).mul(r),XXe=(i=Es(),e=3,t=2,n=.5,r=1)=>hXe(i,Fe(e),t,n).mul(r),YXe=(i,e=xe(0))=>Ca(i,e),KXe=(i,e=xe(0))=>Ri(i,e),ZXe=(i,e=xe(1))=>Ur(i,e),QXe=(i,e=xe(1))=>wd(i,e),JXe=(i,e=xe(1))=>jE(i,e),eYe=(i,e=xe(1))=>Sh(i,e),tYe=(i=xe(0),e=xe(1))=>Pq(i,e),nYe=()=>Zx,rYe=()=>s_e,iYe=(i,e=xe(1))=>Ri(e,i),sYe=(i,e,t,n)=>i.greaterThan(e).mix(t,n),oYe=(i,e,t,n)=>i.greaterThanEqual(e).mix(t,n),aYe=(i,e,t,n)=>i.equal(e).mix(t,n),lYe=(i,e=null)=>{if(typeof e=="string"){const t={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3},n=e.replace(/^out/,"").toLowerCase();if(t[n]!==void 0)return i.element(t[n])}if(typeof e=="number")return i.element(e);if(typeof e=="string"&&e.length===1){const t={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};if(t[e]!==void 0)return i.element(t[e])}return i},cYe=(i,e=en(.5,.5),t=en(1,1),n=xe(0),r=en(0,0))=>{let s=i;if(e&&(s=s.sub(e)),t&&(s=s.mul(t)),n){const a=n.mul(Math.PI/180),c=a.cos(),d=a.sin();s=en(s.x.mul(c).sub(s.y.mul(d)),s.x.mul(d).add(s.y.mul(c)))}return e&&(s=s.add(e)),r&&(s=s.add(r)),s},uYe=(i,e)=>{i=en(i),e=xe(e);const t=e.mul(Math.PI/180);return qE(i,t)},dYe=(i,e,t)=>{i=Ve(i),e=xe(e),t=Ve(t);const n=e.mul(Math.PI/180),r=t.normalize(),s=n.cos(),a=n.sin(),c=xe(1).sub(s);return i.mul(s).add(r.cross(i).mul(a)).add(r.mul(r.dot(i)).mul(c))},hYe=(i,e)=>(i=Ve(i),e=xe(e),r$(i,e)),fYe=We(([i,e,t])=>{const n=Au(i).toVar(),r=Ri(xe(.5).mul(e.sub(t)),cm).div(n).toVar(),s=Ri(xe(-.5).mul(e.sub(t)),cm).div(n).toVar(),a=Ve().toVar();a.x=n.x.greaterThan(xe(0)).select(r.x,s.x),a.y=n.y.greaterThan(xe(0)).select(r.y,s.y),a.z=n.z.greaterThan(xe(0)).select(r.z,s.z);const c=Pu(a.x,a.y,a.z).toVar();return cm.add(n.mul(c)).toVar().sub(t)}),q_e=We(([i,e])=>{const t=i.x,n=i.y,r=i.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(n)),s=s.add(e.element(2).mul(2*.511664).mul(r)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(n)),s=s.add(e.element(5).mul(2*.429043).mul(n).mul(r)),s=s.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(r)),s=s.add(e.element(8).mul(.429043).mul(Ur(t,t).sub(Ur(n,n)))),s});var Z=Object.freeze({__proto__:null,BRDF_GGX:v$,BRDF_Lambert:h6,BasicPointShadowFilter:D_e,BasicShadowFilter:E_e,Break:b7e,Const:U6e,Continue:lGe,DFGLUT:TE,D_GGX:L7e,Discard:eye,EPSILON:Eq,F_Schlick:Ux,Fn:We,HALF_PI:Oze,INFINITY:Nze,If:gr,Loop:_s,NodeAccess:sl,NodeShaderStage:DT,NodeType:tze,NodeUpdateType:Fr,OnBeforeMaterialUpdate:MWe,OnBeforeObjectUpdate:EWe,OnMaterialUpdate:TWe,OnObjectUpdate:wWe,PCFShadowFilter:M_e,PCFSoftShadowFilter:C_e,PI:mk,PI2:kze,PointShadowFilter:O_e,Return:Zze,Schlick_to_F0:sW,ShaderNode:q_,Stack:Jk,Switch:wze,TBNViewMatrix:Y8,TWO_PI:Dze,VSMShadowFilter:A_e,V_GGX_SmithCorrelated:O7e,Var:F6e,VarIntent:B6e,abs:Vs,acesFilmicToneMapping:g_e,acos:Aq,add:Ca,addMethodChaining:Ut,addNodeElement:tVe,agxToneMapping:v_e,all:u6e,alphaT:hk,and:Y8e,anisotropy:s4,anisotropyB:e6,anisotropyT:qT,any:d6e,append:Cze,array:V8e,arrayBuffer:Eze,asin:m6e,assign:G8e,atan:Pq,atomicAdd:Rqe,atomicAnd:Dqe,atomicFunc:mm,atomicLoad:Aqe,atomicMax:Nqe,atomicMin:kqe,atomicOr:Oqe,atomicStore:Pqe,atomicSub:Iqe,atomicXor:Lqe,attenuationColor:bq,attenuationDistance:xq,attribute:E2,attributeArray:PWe,backgroundBlurriness:l_e,backgroundIntensity:uW,backgroundRotation:c_e,batch:y7e,bentNormalView:Dye,billboarding:aWe,bitAnd:J8e,bitNot:e6e,bitOr:t6e,bitXor:n6e,bitangentGeometry:VVe,bitangentLocal:GVe,bitangentView:Nye,bitangentWorld:jVe,bitcast:r_e,blendBurn:CGe,blendColor:IGe,blendDodge:AGe,blendOverlay:RGe,blendScreen:PGe,blur:j7e,bool:Ch,buffer:HE,bufferAttribute:Wq,builtin:A2,builtinAOContext:O6e,builtinShadowContext:D6e,bumpMap:r$,bvec2:D8e,bvec3:gq,bvec4:O8e,bypass:K6e,cache:Y6e,call:j8e,cameraFar:l4,cameraIndex:D4,cameraNear:a4,cameraNormalMatrix:mVe,cameraPosition:uye,cameraProjectionMatrix:S2,cameraProjectionMatrixInverse:cye,cameraViewMatrix:Nh,cameraViewport:gVe,cameraWorldMatrix:pVe,cbrt:C6e,cdl:$We,ceil:iD,checker:I$e,cineonToneMapping:m_e,clamp:op,clearcoat:ck,clearcoatNormalView:c4,clearcoatRoughness:ex,clipSpace:fye,code:bD,color:k8e,colorSpaceToWorking:oD,colorToDirection:WVe,compute:X6e,computeKernel:qq,computeSkinning:oGe,context:C2,convert:F8e,convertColorSpace:Gze,convertToTexture:yWe,cos:Kf,countLeadingZeros:FHe,countOneBits:UHe,countTrailingZeros:LHe,cross:T2,cubeTexture:Dc,cubeTextureBase:n$,dFdx:Nq,dFdy:kq,dashSize:$N,debug:nye,decrement:l6e,decrementBefore:o6e,defaultBuildStages:HH,defaultShaderStages:M8e,defined:bE,degrees:f6e,deltaTime:JHe,densityFogFactor:S_e,depth:d$,depthPass:JWe,determinant:x6e,difference:T6e,diffuseColor:vs,diffuseContribution:V8,directPointLight:F_e,directionToColor:Oye,directionToFaceDirection:Yx,dispersion:Sq,disposeShadowMaterial:R_e,distance:w6e,div:wd,dot:Ah,drawIndex:m7e,dynamicBufferAttribute:$ze,element:L8e,emissive:XH,equal:H8e,equirectUV:f$,exp:Mq,exp2:kx,exponentialHeightFogFactor:dqe,expression:tp,faceDirection:Jq,faceForward:zq,faceforward:Lze,float:xe,floatBitsToInt:kHe,floatBitsToUint:i_e,floor:om,fog:dW,fract:sp,frameGroup:z8e,frameId:s_e,frontFacing:pye,fwidth:Oq,gain:zHe,gapSize:YH,getConstNodeType:N8e,getCurrentStack:fq,getDirection:V7e,getDistanceAttenuation:k$,getGeometryRoughness:D7e,getNormalFromDepth:xWe,getParallaxCorrectNormal:fYe,getRoughness:g$,getScreenPosition:_We,getShIrradianceAt:q_e,getShadowMaterial:P_e,getShadowRenderObjectFunction:I_e,getTextureIndex:t_e,getViewPosition:V_,ggxConvolution:H7e,globalId:vqe,glsl:lqe,glslFn:cqe,grayscale:jWe,greaterThan:Tq,greaterThanEqual:X8e,hash:BHe,highpModelNormalViewMatrix:QH,highpModelViewMatrix:ZH,hue:qWe,increment:a6e,incrementBefore:s6e,inspector:iye,instance:rGe,instanceIndex:um,instancedArray:RWe,instancedBufferAttribute:gk,instancedDynamicBufferAttribute:KH,instancedMesh:v7e,int:Fe,intBitsToFloat:DHe,interleavedGradientNoise:T$,inverse:b6e,inverseSqrt:Cq,inversesqrt:Fze,invocationLocalIndex:nGe,invocationSubgroupIndex:tGe,ior:$T,iridescence:tD,iridescenceIOR:uk,iridescenceThickness:dk,isolate:nx,ivec2:La,ivec3:mq,ivec4:vq,js:oqe,label:L6e,length:am,lengthSq:Uq,lessThan:q8e,lessThanEqual:$8e,lightPosition:A$,lightProjectionUV:w_e,lightShadowMatrix:wD,lightTargetDirection:R$,lightTargetPosition:T_e,lightViewPosition:P$,lightingContext:w7e,lights:u$e,linearDepth:vk,linearToneMapping:f_e,localId:yqe,log:rD,log2:sm,logarithmicDepthToViewZ:_Ge,luminance:E$,mat2:eD,mat3:P0,mat4:b4,matcapUV:q7e,materialAO:h7e,materialAlphaTest:Lye,materialAnisotropy:Zye,materialAnisotropyVector:z_,materialAttenuationColor:s7e,materialAttenuationDistance:i7e,materialClearcoat:Wye,materialClearcoatNormal:$ye,materialClearcoatRoughness:qye,materialColor:Fye,materialDispersion:d7e,materialEmissive:Bye,materialEnvIntensity:KN,materialEnvRotation:t$,materialIOR:r7e,materialIridescence:Qye,materialIridescenceIOR:Jye,materialIridescenceThickness:e7e,materialLightMap:s$,materialLineDashOffset:c7e,materialLineDashSize:a7e,materialLineGapSize:l7e,materialLineScale:o7e,materialLineWidth:KVe,materialMetalness:jye,materialNormal:Hye,materialOpacity:i$,materialPointSize:u7e,materialReference:f2,materialReflectivity:ZN,materialRefractionRatio:yye,materialRotation:Xye,materialRoughness:Gye,materialSheen:Yye,materialSheenRoughness:Kye,materialShininess:Uye,materialSpecular:zye,materialSpecularColor:Vye,materialSpecularIntensity:iW,materialSpecularStrength:XT,materialThickness:n7e,materialTransmission:t7e,max:Io,maxMipLevel:$q,mediumpModelViewMatrix:hye,metalness:_2,min:Pu,mix:Ei,mixElement:P6e,mod:jE,modInt:c6e,modelDirection:wVe,modelNormalMatrix:dye,modelPosition:TVe,modelRadius:CVe,modelScale:EVe,modelViewMatrix:O4,modelViewPosition:MVe,modelViewProjection:f7e,modelWorldMatrix:wh,modelWorldMatrixInverse:AVe,morphReference:S7e,mrt:n_e,mul:Ur,mx_aastep:j_e,mx_add:YXe,mx_atan2:tYe,mx_cell_noise_float:HXe,mx_contrast:OXe,mx_divide:QXe,mx_fractal_noise_float:WXe,mx_fractal_noise_vec2:qXe,mx_fractal_noise_vec3:$Xe,mx_fractal_noise_vec4:XXe,mx_frame:rYe,mx_heighttonormal:hYe,mx_hsvtorgb:EXe,mx_ifequal:aYe,mx_ifgreater:sYe,mx_ifgreatereq:oYe,mx_invert:iYe,mx_modulo:JXe,mx_multiply:ZXe,mx_noise_float:LXe,mx_noise_vec3:FXe,mx_noise_vec4:UXe,mx_place2d:cYe,mx_power:eYe,mx_ramp4:RXe,mx_ramplr:AXe,mx_ramptb:PXe,mx_rgbtohsv:MXe,mx_rotate2d:uYe,mx_rotate3d:dYe,mx_safepower:DXe,mx_separate:lYe,mx_splitlr:IXe,mx_splittb:NXe,mx_srgb_texture_to_lin_rec709:CXe,mx_subtract:KXe,mx_timer:nYe,mx_transform_uv:kXe,mx_unifiednoise2d:BXe,mx_unifiednoise3d:zXe,mx_worley_noise_float:VXe,mx_worley_noise_vec2:GXe,mx_worley_noise_vec3:jXe,negate:Iq,neutralToneMapping:y_e,nodeArray:J8,nodeImmutable:En,nodeObject:qn,nodeObjectIntent:OT,nodeObjects:Qk,nodeProxy:Yr,nodeProxyIntent:sn,normalFlat:mye,normalGeometry:lD,normalLocal:Ru,normalMap:rW,normalView:ji,normalViewGeometry:Lx,normalWorld:L4,normalWorldGeometry:gye,normalize:Au,not:Z8e,notEqual:W8e,numWorkgroups:mqe,objectDirection:vVe,objectGroup:wq,objectPosition:_Ve,objectRadius:SVe,objectScale:xVe,objectViewPosition:bVe,objectWorldMatrix:yVe,oneMinus:g6e,or:K8e,orthographicDepthToViewZ:yGe,oscSawtooth:rWe,oscSine:eWe,oscSquare:tWe,oscTriangle:nWe,output:tx,outputStruct:PHe,overloadingFn:cl,packHalf2x16:WHe,packSnorm2x16:jHe,packUnorm2x16:HHe,parabola:cW,parallaxDirection:kye,parallaxUV:HVe,parameter:wHe,pass:ZWe,passTexture:QWe,pcurve:VHe,perspectiveDepthToViewZ:c$,pmremTexture:_$,pointShadow:L_e,pointUV:NWe,pointWidth:Aze,positionGeometry:WE,positionLocal:Po,positionPrevious:Ox,positionView:ua,positionViewDirection:ks,positionWorld:cm,positionWorldDirection:Qq,posterize:XWe,pow:Sh,pow2:Lq,pow3:E6e,pow4:Fq,premultiplyAlpha:A7e,property:b2,quadBroadcast:a$e,quadSwapDiagonal:t$e,quadSwapX:Jqe,quadSwapY:e$e,radians:h6e,rand:A6e,range:fqe,rangeFogFactor:b_e,reciprocal:y6e,reference:to,referenceBuffer:JH,reflect:S6e,reflectVector:bye,reflectView:_ye,reflector:fWe,refract:Bq,refractVector:Sye,refractView:xye,reinhardToneMapping:p_e,remap:Q6e,remapClamp:J6e,renderGroup:cr,renderOutput:tye,rendererReference:W6e,replaceDefaultUV:iWe,rotate:qE,rotateUV:sWe,roughness:J1,round:v6e,rtt:a_e,sRGBTransferEOTF:V6e,sRGBTransferOETF:G6e,sample:SWe,sampler:aVe,samplerComparison:lVe,saturate:sD,saturation:HWe,screenCoordinate:b6,screenDPR:aye,screenSize:d6,screenUV:lm,select:$l,setCurrentStack:SE,setName:Vq,shaderStages:WH,shadow:k_e,shadowPositionWorld:N$,shapeCircle:N$e,sharedUniformGroup:nD,sheen:vd,sheenRoughness:o4,shiftLeft:r6e,shiftRight:i6e,shininess:fk,sign:Rq,sin:Nc,sinc:GHe,skinning:x7e,smoothstep:ap,smoothstepElement:R6e,specularColor:R4,specularColorBlended:$8,specularF90:X8,spherizeUV:oWe,split:Mze,spritesheetUV:cWe,sqrt:Lc,stack:QN,step:Dx,stepElement:I6e,storage:w4,storageBarrier:Sqe,storageTexture:u_e,string:Tze,struct:AHe,sub:Ri,subBuild:t6,subgroupAdd:Bqe,subgroupAll:Kqe,subgroupAnd:Wqe,subgroupAny:Zqe,subgroupBallot:Uqe,subgroupBroadcast:n$e,subgroupBroadcastFirst:Qqe,subgroupElect:Fqe,subgroupExclusiveAdd:Vqe,subgroupExclusiveMul:Hqe,subgroupInclusiveAdd:zqe,subgroupInclusiveMul:jqe,subgroupIndex:eGe,subgroupMax:Yqe,subgroupMin:Xqe,subgroupMul:Gqe,subgroupOr:qqe,subgroupShuffle:r$e,subgroupShuffleDown:o$e,subgroupShuffleUp:s$e,subgroupShuffleXor:i$e,subgroupSize:_qe,subgroupXor:$qe,tan:p6e,tangentGeometry:uD,tangentLocal:Fx,tangentView:dD,tangentWorld:Iye,texture:$i,texture3D:xD,texture3DLevel:UWe,texture3DLoad:FWe,textureBarrier:wqe,textureBicubic:ije,textureBicubicLevel:y$,textureCubeUV:G7e,textureLevel:oVe,textureLoad:$o,textureSize:S4,textureStore:DWe,thickness:_q,time:Zx,toneMapping:q6e,toneMappingExposure:$6e,toonOutlinePass:tqe,transformDirection:M6e,transformNormal:vye,transformNormalToView:e$,transformedClearcoatNormalView:NVe,transformedNormalView:RVe,transformedNormalWorld:IVe,transmission:pk,transpose:_6e,triNoise3D:KHe,triplanarTexture:uWe,triplanarTextures:o_e,trunc:Dq,uint:Zt,uintBitsToFloat:OHe,uniform:rr,uniformArray:Hl,uniformCubeTexture:DVe,uniformFlow:k6e,uniformGroup:B8e,uniformTexture:sVe,unpackHalf2x16:XHe,unpackNormal:nW,unpackSnorm2x16:qHe,unpackUnorm2x16:$He,unpremultiplyAlpha:NGe,userData:zWe,uv:Es,uvec2:pq,uvec3:x6,uvec4:yq,varying:k4,varyingProperty:wE,vec2:en,vec3:Ve,vec4:hr,vectorComponents:y6,velocity:GWe,vertexColor:C7e,vertexIndex:p7e,vertexStage:z6e,vibrance:WWe,viewZToLogarithmicDepth:u$,viewZToOrthographicDepth:rx,viewZToPerspectiveDepth:l$,viewZToReversedOrthographicDepth:vGe,viewZToReversedPerspectiveDepth:E7e,viewport:Kq,viewportCoordinate:lye,viewportDepthTexture:a$,viewportLinearDepth:xGe,viewportMipTexture:o$,viewportOpaqueMipTexture:T7e,viewportResolution:fVe,viewportSafeUV:lWe,viewportSharedTexture:KWe,viewportSize:Zq,viewportTexture:pGe,viewportUV:hVe,vogelDiskSample:Qf,wgsl:aqe,wgslFn:uqe,workgroupArray:Mqe,workgroupBarrier:bqe,workgroupId:gqe,workingToColorSpace:j6e,xor:Q8e});const jf=new x$;class pYe extends F4{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const r=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let a=!1;if(s===null)r._clearColor.getRGB(jf),jf.a=r._clearColor.a;else if(s.isColor===!0)s.getRGB(jf),jf.a=1,a=!0;else if(s.isNode===!0){const p=this.get(e),y=s;jf.copy(r._clearColor);let x=p.backgroundMesh;if(x===void 0){let A=function(){s.removeEventListener("dispose",A),x.material.dispose(),x.geometry.dispose()};var d=A;const C=hr(y).mul(uW).context({getUV:()=>c_e.mul(gye),getTextureLevel:()=>l_e}),N=S2.element(3).element(3).equal(1),F=wd(1,S2.element(1).element(1)).mul(3),U=N.select(Po.mul(F),Po),R=O4.mul(hr(U,0));let B=S2.mul(hr(R.xyz,1));B=B.setZ(B.w);const Y=new No;Y.name="Background.material",Y.side=Ui,Y.depthTest=!1,Y.depthWrite=!1,Y.allowOverride=!1,Y.fog=!1,Y.lights=!1,Y.vertexNode=B,Y.colorNode=C,p.backgroundMeshNode=C,p.backgroundMesh=x=new fn(new ip(1,32,32),Y),x.frustumCulled=!1,x.name="Background.mesh",s.addEventListener("dispose",A)}const w=y.getCacheKey();p.backgroundCacheKey!==w&&(p.backgroundMeshNode.node=hr(y).mul(uW),p.backgroundMeshNode.needsUpdate=!0,x.material.needsUpdate=!0,p.backgroundCacheKey=w),t.unshift(x,x.geometry,x.material,0,0,null,null)}else jt("Renderer: Unsupported background configuration.",s);const c=r.xr.getEnvironmentBlendMode();if(c==="additive"?jf.set(0,0,0,1):c==="alpha-blend"&&jf.set(0,0,0,0),r.autoClear===!0||a===!0){const p=n.clearColorValue;p.r=jf.r,p.g=jf.g,p.b=jf.b,p.a=jf.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(p.r*=p.a,p.g*=p.a,p.b*=p.a),n.depthClearValue=r.getClearDepth(),n.stencilClearValue=r.getClearStencil(),n.clearColor=r.autoClearColor===!0,n.clearDepth=r.autoClearDepth===!0,n.clearStencil=r.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let mYe=0;class hW{constructor(e="",t=[],n=0){this.name=e,this.bindings=t,this.index=n,this.id=mYe++}}class gYe{constructor(e,t,n,r,s,a,c,d,p,y=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=y,this.nodeAttributes=r,this.bindings=s,this.updateNodes=a,this.updateBeforeNodes=c,this.updateAfterNodes=d,this.observer=p,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new hW(t.name,[],t.index);e.push(r);for(const s of t.bindings)r.bindings.push(s.clone())}else e.push(t);return e}}class g5e{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class vYe{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class $_e{constructor(e,t,n=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=n,this.count=r}}class yYe extends $_e{constructor(e,t,n=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=n,this.interpolationSampling=r}}class _Ye{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let xYe=0;class zj{constructor(e=null){this.id=xYe++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class bYe{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class U4{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0,this.index=-1}setValue(e){this.value=e}getValue(){return this.value}}class SYe extends U4{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class wYe extends U4{constructor(e,t=new vn){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class TYe extends U4{constructor(e,t=new _e){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class EYe extends U4{constructor(e,t=new wr){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class MYe extends U4{constructor(e,t=new xn){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class CYe extends U4{constructor(e,t=new $k){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class AYe extends U4{constructor(e,t=new Xr){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class PYe extends U4{constructor(e,t=new An){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class RYe extends SYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class IYe extends wYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class NYe extends TYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class kYe extends EYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class DYe extends MYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class OYe extends CYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class LYe extends AYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class FYe extends PYe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}let UYe=0;const v5e=new WeakMap,BYe=new WeakMap,zYe=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),MN=i=>/e/g.test(i)?String(i).replace(/\+/g,""):(i=Number(i),i+(i%1?"":".0"));class X_e{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=QN(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new zj,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.activeStacks=[],this.subBuildFn=null,this.fnCall=null,Object.defineProperty(this,"id",{value:UYe++})}isFlatShading(){return this.material.flatShading===!0||this.geometry.hasAttribute("normal")===!1}isOpaque(){const e=this.material;return e.transparent===!1&&e.blending===rl&&e.alphaToCoverage===!1}createRenderTarget(e,t,n){return new lp(e,t,n)}createCubeRenderTarget(e,t){return new P7e(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const n=t[0].groupNode;let r=n.shared;if(r)for(let a=1;a<t.length;a++)n!==t[a].groupNode&&(r=!1);let s;if(r){let a="";for(const y of t)if(y.isNodeUniformsGroup){y.uniforms.sort((x,w)=>x.nodeUniform.node.id-w.nodeUniform.node.id);for(const x of y.uniforms)a+=x.nodeUniform.node.id}else a+=y.nodeUniform.id;const c=this.renderer._currentRenderContext||this.renderer;let d=v5e.get(c);d===void 0&&(d=new Map,v5e.set(c,d));const p=Xx(a);s=d.get(p),s===void 0&&(s=new hW(e,t,this.bindingsIndexes[e].group),d.set(p,s))}else s=new hW(e,t,this.bindingsIndexes[e].group);return s}getBindGroupArray(e,t){const n=this.bindings[t];let r=n[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},n=this.bindings;for(const r of WH)for(const s in n[r]){const a=n[r][s],c=t[s]||(t[s]=[]);for(const d of a)c.includes(d)===!1&&c.push(d)}e=[];for(const r in t){const s=t[r],a=this._getBindGroup(r,s);e.push(a)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,n)=>t.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();(t!==Fr.NONE||n!==Fr.NONE)&&this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==Fr.NONE&&this.updateNodes.push(e);for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==Fr.NONE&&this.updateBeforeNodes.push(e),n!==Fr.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Bi||e.magFilter===Z_||e.magFilter===v2||e.magFilter===Tu||e.minFilter===Bi||e.minFilter===Z_||e.minFilter===v2||e.minFilter===Tu}getUniformBufferLimit(){return 16384}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}addContext(e){const t=this.getContext();return this.setContext({...this.context,...e}),t}getSharedContext(){const e={...this.context};return delete e.material,delete e.getUV,delete e.getOutput,delete e.getTextureLevel,delete e.getAO,delete e.getShadow,e}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new zj(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){Wt("Abstract function.")}getInstanceIndex(){Wt("Abstract function.")}getDrawIndex(){Wt("Abstract function.")}getFrontFacing(){Wt("Abstract function.")}getFragCoord(){Wt("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){Wt("Abstract function.")}generateTextureLod(){Wt("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,n=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let s=0;s<t;s++){const a=n?n[s]:null;a!==null?r+=a.build(this,e):r+=this.generateConst(e),s<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,n=null){const r=[];for(const s of t){const{name:a,type:c}=s;n&&n[a]&&n[a].isNode?r.push(n[a].build(this,c)):r.push(this.generateConst(c))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new xn:e==="vec2"||e==="uvec2"||e==="ivec2"?t=new vn:e==="vec3"||e==="uvec3"||e==="ivec3"?t=new _e:(e==="vec4"||e==="uvec4"||e==="ivec4")&&(t=new wr)),e==="float")return MN(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${MN(t.r)}, ${MN(t.g)}, ${MN(t.b)} )`;const n=this.getTypeLength(e),r=this.getComponentType(e),s=a=>this.generateConst(r,a);if(n===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(n===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(n===4&&e!=="mat2")return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(n>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const n=this.attributes;for(const s of n)if(s.name===e)return s;const r=new g5e(e,t);return this.registerDeclaration(r),n.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===C0)return"int";if(t===ys)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let n=w8e(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(n=n.replace("vec","mat")),r+n}getTypeFromArray(e){return zYe.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,r=e.itemSize,s=e.normalized;let a;return!(e instanceof Vve)&&s!==!0&&(a=this.getTypeFromArray(n)),this.getTypeFromLength(r,a)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return n!==null?Number(n[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}setActiveStack(e){this.activeStacks.push(e)}removeActiveStack(e){if(this.activeStacks[this.activeStacks.length-1]===e)this.activeStacks.pop();else throw new Error("NodeBuilder: Invalid active stack removal.")}getActiveStack(){return this.activeStacks[this.activeStacks.length-1]}getBaseStack(){return this.activeStacks[0]}addStack(){this.stack=QN(this.stack);const e=fq();return this.stacks.push(e),SE(this.stack),this.stack}removeStack(){const e=this.stack;for(const t of e.nodes){const n=this.getDataFromNode(t);n.stack=e}return this.stack=e.parent,SE(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let r=n.getData(e);r===void 0&&(r={},n.setData(e,r)),r[t]===void 0&&(r[t]={});let s=r[t];const a=r.any?r.any.subBuilds:null,c=this.getClosestSubBuild(a);return c&&(s.subBuildsCache===void 0&&(s.subBuildsCache={}),s=s.subBuildsCache[c]||(s.subBuildsCache[c]={}),s.subBuilds=a),s}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e,"vertex");let r=n.bufferAttribute;if(r===void 0){const s=this.uniforms.index++;r=new g5e("nodeAttribute"+s,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}getStructTypeNode(e,t=this.shaderStage){return this.types[t][e]||null}getStructTypeFromNode(e,t,n=null,r=this.shaderStage){const s=this.getDataFromNode(e,r,this.globalCache);let a=s.structType;if(a===void 0){const c=this.structs.index++;n===null&&(n="StructType"+c),a=new bYe(n,t),this.structs[r].push(a),this.types[r][n]=e,s.structType=a}return a}getOutputStructTypeFromNode(e,t){const n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}getUniformFromNode(e,t,n=this.shaderStage,r=null){const s=this.getDataFromNode(e,n,this.globalCache);let a=s.uniform;if(a===void 0){const c=this.uniforms.index++;a=new vYe(r||"nodeUniform"+c,t,e),this.uniforms[n].push(a),this.registerDeclaration(a),s.uniform=a}return a}getVarFromNode(e,t=null,n=e.getNodeType(this),r=this.shaderStage,s=!1){const a=this.getDataFromNode(e,r),c=this.getSubBuildProperty("variable",a.subBuilds);let d=a[c];if(d===void 0){const p=s?"_const":"_var",y=this.vars[r]||(this.vars[r]=[]),x=this.vars[p]||(this.vars[p]=0);t===null&&(t=(s?"nodeConst":"nodeVar")+x,this.vars[p]++),c!=="variable"&&(t=this.getSubBuildProperty(t,a.subBuilds));const w=e.getArrayCount(this);d=new $_e(t,n,s,w),s||y.push(d),this.registerDeclaration(d),a[c]=d}return d}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,n=e.getNodeType(this),r=null,s=null){const a=this.getDataFromNode(e,"any"),c=this.getSubBuildProperty("varying",a.subBuilds);let d=a[c];if(d===void 0){const p=this.varyings,y=p.length;t===null&&(t="nodeVarying"+y),c!=="varying"&&(t=this.getSubBuildProperty(t,a.subBuilds)),d=new yYe(t,n,r,s),p.push(d),this.registerDeclaration(d),a[c]=d}return d}registerDeclaration(e){const t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let s=1,a=r;for(;n[a]!==void 0;)a=r+"_"+s++;s>1&&(e.name=a,Wt(`TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${a}'.`)),n[a]=e}getCodeFromNode(e,t,n=this.shaderStage){const r=this.getDataFromNode(e);let s=r.code;if(s===void 0){const a=this.codes[n]||(this.codes[n]=[]),c=a.length;s=new _Ye("nodeCode"+c,t),a.push(s),r.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:r}=this.getDataFromNode(e);let s=!0,a=t;for(;a;){if(r.get(a)===!0){s=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(s)for(const c of n)this.addLineFlowCode(c)}addLineFlowCodeBlock(e,t,n){const r=this.getDataFromNode(e),s=r.flowCodes||(r.flowCodes=[]),a=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);s.push(t),a.set(n,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new __e,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let a=0;const c=Object.values(this);return{next:()=>({value:c[a],done:a++>=c.length})}}};for(const a of t.inputs)n[a.name]=new Q7e(a.type,a.name);e.layout=null;const r=e.call(n),s=this.flowStagesNode(r,t.type);return e.layout=t,s}flowBuildStage(e,t,n=null){const r=this.getBuildStage();this.setBuildStage(t);const s=e.build(this,n);return this.setBuildStage(r),s}flowStagesNode(e,t=null){const n=this.flow,r=this.vars,s=this.declarations,a=this.cache,c=this.buildStage,d=this.stack,p={code:""};this.flow=p,this.vars={},this.declarations={},this.cache=new zj,this.stack=QN();for(const y of HH)this.setBuildStage(y),p.result=e.build(this,t);return p.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.declarations=s,this.cache=a,this.stack=d,this.setBuildStage(c),p}getFunctionOperator(){return null}buildFunctionCode(){Wt("Abstract function.")}flowChildNode(e,t=null){const n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}flowNodeFromShaderStage(e,t,n=null,r=null){const s=this.tab,a=this.cache,c=this.shaderStage,d=this.context;this.setShaderStage(e);const p={...this.context};delete p.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=p;let y=null;if(this.buildStage==="generate"){const x=this.flowChildNode(t,n);r!==null&&(x.code+=`${this.tab+r} = ${x.result};
`),this.flowCode[e]=this.flowCode[e]+x.code,y=x}else y=t.build(this);return this.setShaderStage(c),this.cache=a,this.tab=s,this.context=d,y}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){Wt("Abstract function.")}getVaryings(){Wt("Abstract function.")}getVar(e,t,n=null){return`${n!==null?this.generateArrayDeclaration(e,n):this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(n!==void 0)for(const r of n)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){Wt("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(t!==void 0)for(const r of t)n+=r.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){Wt("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(e&&e.isNode?e.isShaderCallNodeInternal?t=e.shaderNode.subBuilds:e.isStackNode?t=[e.subBuild]:t=this.getDataFromNode(e,"any").subBuilds:e instanceof Set?t=[...e]:t=e,!t)return null;const n=this.subBuildLayers;for(let r=t.length-1;r>=0;r--){const s=t[r];if(n.includes(s))return s}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",t=null){let n;t!==null?n=this.getClosestSubBuild(t):n=this.subBuildFn;let r;return n?r=e?n+"_"+e:n:r=e,r}build(){const{object:e,material:t,renderer:n}=this;if(t!==null){let r=n.library.fromMaterial(t);r===null&&(jt(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new No),r.build(this)}else this.addFlow("compute",e);for(const r of HH){this.setBuildStage(r),this.context.position&&this.context.position.isNode&&this.flowNodeFromShaderStage("vertex",this.context.position);for(const s of WH){this.setShaderStage(s);const a=this.flowNodes[s];for(const c of a)r==="generate"?this.flowNode(c):c.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getSharedDataFromNode(e){let t=BYe.get(e);return t===void 0&&(t={}),t}getNodeUniform(e,t){const n=this.getSharedDataFromNode(e);let r=n.cache;if(r===void 0){if(t==="float"||t==="int"||t==="uint")r=new RYe(e);else if(t==="vec2"||t==="ivec2"||t==="uvec2")r=new IYe(e);else if(t==="vec3"||t==="ivec3"||t==="uvec3")r=new NYe(e);else if(t==="vec4"||t==="ivec4"||t==="uvec4")r=new kYe(e);else if(t==="color")r=new DYe(e);else if(t==="mat2")r=new OYe(e);else if(t==="mat3")r=new LYe(e);else if(t==="mat4")r=new FYe(e);else throw new Error(`Uniform "${t}" not implemented.`);n.cache=r}return r}format(e,t,n){if(t=this.getVectorType(t),n=this.getVectorType(n),t===n||n===null||this.isReference(n))return e;const r=this.getTypeLength(t),s=this.getTypeLength(n);return r===16&&s===9?`${this.getType(n)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&s===4?`${this.getType(n)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||s>4||s===0?e:r===s?`${this.getType(n)}( ${e} )`:r>s?(e=n==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,s)}`,this.format(e,this.getTypeFromLength(s,this.getComponentType(t)),n)):s===4&&r>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&s>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${N4} - Node System
`}needsPreviousData(){const e=this.renderer.getMRT();return e&&e.has("velocity")||E8e(this.object).useVelocity===!0}}class y5e{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return n===void 0&&(n={renderId:0,frameId:0},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===Fr.FRAME){const r=this._getMaps(this.updateBeforeMap,n);if(r.frameId!==this.frameId){const s=r.frameId;r.frameId=this.frameId,e.updateBefore(this)===!1&&(r.frameId=s)}}else if(t===Fr.RENDER){const r=this._getMaps(this.updateBeforeMap,n);if(r.renderId!==this.renderId){const s=r.renderId;r.renderId=this.renderId,e.updateBefore(this)===!1&&(r.renderId=s)}}else t===Fr.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===Fr.FRAME){const r=this._getMaps(this.updateAfterMap,n);r.frameId!==this.frameId&&e.updateAfter(this)!==!1&&(r.frameId=this.frameId)}else if(t===Fr.RENDER){const r=this._getMaps(this.updateAfterMap,n);r.renderId!==this.renderId&&e.updateAfter(this)!==!1&&(r.renderId=this.renderId)}else t===Fr.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===Fr.FRAME){const r=this._getMaps(this.updateMap,n);r.frameId!==this.frameId&&e.update(this)!==!1&&(r.frameId=this.frameId)}else if(t===Fr.RENDER){const r=this._getMaps(this.updateMap,n);r.renderId!==this.renderId&&e.update(this)!==!1&&(r.renderId=this.renderId)}else t===Fr.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class L${constructor(e,t,n=null,r="",s=!1){this.type=e,this.name=t,this.count=n,this.qualifier=r,this.isConst=s}}L$.isNodeFunctionInput=!0;class VYe extends S6{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class GYe extends S6{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:R$(this.light),lightColor:e}}}class jYe extends S6{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=A$(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=rr(new xn).setGroup(cr)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:r}=this,a=L4.dot(r).mul(.5).add(.5),c=Ei(n,t,a);e.context.irradiance.addAssign(c)}}class F$ extends S6{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=rr(0).setGroup(cr),this.penumbraCosNode=rr(0).setGroup(cr),this.cutoffDistanceNode=rr(0).setGroup(cr),this.decayExponentNode=rr(0).setGroup(cr),this.colorNode=rr(this.color).setGroup(cr)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:n,penumbraCosNode:r}=this;return ap(n,r,t)}getLightCoord(e){const t=e.getNodeProperties(this);let n=t.projectionUV;return n===void 0&&(n=w_e(this.light,e.context.positionWorld),t.projectionUV=n),n}setupDirect(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:r,light:s}=this,a=this.getLightVector(e),c=a.normalize(),d=c.dot(R$(s)),p=this.getSpotAttenuation(e,d),y=a.length(),x=k$({lightDistance:y,cutoffDistance:n,decayExponent:r});let w=t.mul(p).mul(x),C,N;return s.colorNode?(N=this.getLightCoord(e),C=s.colorNode(N)):s.map&&(N=this.getLightCoord(e),C=$i(s.map,N.xy).onRenderUpdate(()=>s.map)),C&&(w=N.mul(2).sub(1).abs().lessThan(1).all().select(w.mul(C),w)),{lightColor:w,lightDirection:c}}}class HYe extends F${static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const n=this.light.iesMap;let r=null;if(n&&n.isTexture===!0){const s=t.acos().mul(1/Math.PI);r=$i(n,en(s,0),0).r}else r=super.getSpotAttenuation(t);return r}}class WYe extends S6{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let n=0;n<9;n++)t.push(new _e);this.lightProbe=Hl(t)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=q_e(L4,this.lightProbe);e.context.irradiance.addAssign(t)}}const qYe=We(([i,e])=>{const t=i.abs().sub(e);return am(Io(t,0)).add(Pu(Io(t.x,t.y),0))});class $Ye extends F${static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let n=1;t.map!==null&&(n=t.map.width/t.map.height),t.shadow.aspect=n}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=xe(0),n=this.penumbraCosNode,r=wD(this.light).mul(e.context.positionWorld||cm);return gr(r.w.greaterThan(0),()=>{const s=r.xyz.div(r.w),a=qYe(s.xy.sub(en(.5)),en(.5)),c=wd(-1,Ri(1,Aq(n)).sub(1));t.assign(sD(a.mul(-2).mul(c)))}),t}}const Vj=new An,CN=new An;let vT=null;class XYe extends S6{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=rr(new _e).setGroup(cr),this.halfWidth=rr(new _e).setGroup(cr),this.updateType=Fr.RENDER}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;CN.identity(),Vj.copy(t.matrixWorld),Vj.premultiply(n),CN.extractRotation(Vj),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(CN),this.halfHeight.value.applyMatrix4(CN)}setupDirectRectArea(e){let t,n;e.isAvailable("float32Filterable")?(t=$i(vT.LTC_FLOAT_1),n=$i(vT.LTC_FLOAT_2)):(t=$i(vT.LTC_HALF_1),n=$i(vT.LTC_HALF_2));const{colorNode:r,light:s}=this,a=P$(s);return{lightColor:r,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}static setLTC(e){vT=e}}class Y_e{parseFunction(){Wt("Abstract function.")}}class U${constructor(e,t,n="",r=""){this.type=e,this.inputs=t,this.name=n,this.precision=r}getCode(){Wt("Abstract function.")}}U$.isNodeFunction=!0;const YYe=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,KYe=/[a-z_0-9]+/ig,_5e="#pragma main",ZYe=i=>{i=i.trim();const e=i.indexOf(_5e),t=e!==-1?i.slice(e+_5e.length):i,n=t.match(YYe);if(n!==null&&n.length===5){const r=n[4],s=[];let a=null;for(;(a=KYe.exec(r))!==null;)s.push(a);const c=[];let d=0;for(;d<s.length;){const N=s[d][0]==="const";N===!0&&d++;let F=s[d][0];F==="in"||F==="out"||F==="inout"?d++:F="";const U=s[d++][0];let R=Number.parseInt(s[d][0]);Number.isNaN(R)===!1?d++:R=null;const B=s[d++][0];c.push(new L$(U,B,R,F,N))}const p=t.substring(n[0].length),y=n[3]!==void 0?n[3]:"",x=n[2],w=n[1]!==void 0?n[1]:"",C=e!==-1?i.slice(0,e):"";return{type:x,inputs:c,name:y,precision:w,inputsCode:r,blockCode:p,headerCode:C}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class QYe extends U${constructor(e){const{type:t,inputs:n,name:r,precision:s,inputsCode:a,blockCode:c,headerCode:d}=ZYe(e);super(t,n,r,s),this.inputsCode=a,this.blockCode=c,this.headerCode=d}getCode(e=this.name){let t;const n=this.blockCode;if(n!==""){const{type:r,inputsCode:s,headerCode:a,precision:c}=this;let d=`${r} ${e} ( ${s.trim()} )`;c!==""&&(d=`${c} ${d}`),t=a+d+n}else t="";return t}}class JYe extends Y_e{parseFunction(e){return new QYe(e)}}const x5e=new WeakMap,vh=[],Z9=[];class eKe extends F4{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new y5e,this.nodeBuilderCache=new Map,this.callHashCache=new I4,this.groupsData=new I4,this.cacheLib={}}updateGroup(e){const t=e.groupNode,n=t.name;if(n===wq.name)return!0;if(n===cr.name){const s=this.get(e),a=this.nodeFrame.renderId;return s.renderId!==a?(s.renderId=a,!0):!1}if(n===z8e.name){const s=this.get(e),a=this.nodeFrame.frameId;return s.frameId!==a?(s.frameId=a,!0):!1}vh[0]=t,vh[1]=e;let r=this.groupsData.get(vh);return r===void 0&&this.groupsData.set(vh,r={}),vh[0]=null,vh[1]=null,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:r}=this,s=this.getForRenderCacheKey(e);if(n=r.get(s),n===void 0){const a=d=>{const p=this.backend.createNodeBuilder(e.object,this.renderer);return p.scene=e.scene,p.material=d,p.camera=e.camera,p.context.material=d,p.lightsNode=e.lightsNode,p.environmentNode=this.getEnvironmentNode(e.scene),p.fogNode=this.getFogNode(e.scene),p.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&p.enableMultiview(),p};let c=a(e.material);try{c.build()}catch(d){c=a(new No),c.build();let p=d.stackTrace;!p&&d.stack&&(p=new da(d.stack)),jt("TSL: "+d,p)}n=this._createNodeBuilderState(c),r.set(s,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new gYe(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){vh[0]=e,vh[1]=t;const n=this.renderer.info.calls,r=this.callHashCache.get(vh)||{};if(r.callId!==n){const s=this.getEnvironmentNode(e),a=this.getFogNode(e);t&&Z9.push(t.getCacheKey(!0)),s&&Z9.push(s.getCacheKey()),a&&Z9.push(a.getCacheKey()),Z9.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),Z9.push(this.renderer.shadowMap.enabled?1:0),Z9.push(this.renderer.shadowMap.type),r.callId=n,r.cacheKey=VE(Z9),this.callHashCache.set(vh,r),Z9.length=0}return vh[0]=null,vh[1]=null,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==n||r){const s=this.getCacheNode("background",n,()=>{if(n.isCubeTexture===!0||n.mapping===K8||n.mapping===K_||n.mapping===i6){if(e.backgroundBlurriness>0||n.mapping===i6)return _$(n);{let a;return n.isCubeTexture===!0?a=Dc(n):a=$i(n),I7e(a)}}else{if(n.isTexture===!0)return $i(n,lm.flipY()).setUpdateMatrix(!0);n.isColor!==!0&&jt("WebGPUNodes: Unsupported background configuration.",n)}},r);t.backgroundNode=s,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,n,r=!1){const s=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let a=s.get(t);return(a===void 0||r)&&(a=n(),s.set(t,a)),a}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){const r=this.getCacheNode("fog",n,()=>{if(n.isFogExp2){const s=to("color","color",n).setGroup(cr),a=to("density","float",n).setGroup(cr);return dW(s,S_e(a))}else if(n.isFog){const s=to("color","color",n).setGroup(cr),a=to("near","float",n).setGroup(cr),c=to("far","float",n).setGroup(cr);return dW(s,b_e(a,c))}else jt("Renderer: Unsupported fog configuration.",n)});t.fogNode=r,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){const r=this.getCacheNode("environment",n,()=>{if(n.isCubeTexture===!0)return Dc(n);if(n.isTexture===!0)return $i(n);jt("Nodes: Unsupported environment configuration.",n)});t.environmentNode=r,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,r=null,s=null){const a=this.nodeFrame;return a.renderer=e,a.scene=t,a.object=n,a.camera=r,a.material=s,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return x5e.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),r=e.isArrayTexture?xD(e,Ve(lm,A2("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):$i(e,lm).renderOutput(t.toneMapping,t.currentColorSpace);return x5e.set(e,n),r}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const r of n.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const r of n.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new y5e,this.nodeBuilderCache=new Map,this.cacheLib={}}}const Gj=new Z1;class wk{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Xr,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,n){const r=e.length;for(let s=0;s<r;s++){Gj.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const a=t[n+s],c=Gj.normal;a.x=-c.x,a.y=-c.y,a.z=-c.z,a.w=Gj.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,s=r.length;let a,c;if(this.clipIntersection?(a=this.intersectionPlanes,c=e.intersectionPlanes.length):(a=this.unionPlanes,c=e.unionPlanes.length),a.length!==c+s){a.length=c+s;for(let d=0;d<s;d++)a[c+d]=new wr;n=!0}this.projectPlanes(r,a,c),n&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new wk(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class tKe{constructor(e,t){this.bundleGroup=e,this.camera=t}}const R_=[];class nKe{constructor(){this.bundles=new I4}get(e,t){const n=this.bundles;R_[0]=e,R_[1]=t;let r=n.get(R_);return r===void 0&&(r=new tKe(e,t),n.set(R_,r)),R_[0]=null,R_[1]=null,r}dispose(){this.bundles=new I4}}class K_e{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){t=new n;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t)){Wt(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}addClass(e,t,n){if(n.has(t)){Wt(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}const rKe=new I$,b5e=new WeakMap;class iKe{createNode(e=[]){return new I$().setLights(e)}getNode(e){if(e.isQuadMesh)return rKe;let t=b5e.get(e);return t===void 0&&(t=this.createNode(),b5e.set(e,t)),t}}class LT extends lp{constructor(e=1,t=1,n={}){super(e,t,n),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const S5e=new _e,w5e=new _e;class sKe extends Yl{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new ca,this._cameraL.viewport=new wr,this._cameraR=new ca,this._cameraR.viewport=new wr,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new c8e,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding=typeof XRWebGLBinding<"u",this._frameBufferTargets=null,this._createXRLayer=dKe.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new vn,this._onSessionEvent=lKe.bind(this),this._onSessionEnd=cKe.bind(this),this._onInputSourcesChange=uKe.bind(this),this._onAnimationFrame=hKe.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&Wt("XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&Wt("XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getBinding(){return this._glBinding===null&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,n,r,s,a,c,d={}){const p=new rp(e,t),y=new LT(s,a,{format:$s,type:Yi,depthTexture:new ll(s,a,d.stencil?Cu:ys,void 0,void 0,void 0,void 0,void 0,void 0,d.stencil?Wl:al),stencilBuffer:d.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});y._autoAllocateDepthBuffer=!0;const x=new Ua({color:16777215,side:ol});x.map=y.texture,x.map.offset.y=1,x.map.repeat.y=-1;const w=new fn(p,x);w.position.copy(n),w.quaternion.copy(r);const C={type:"quad",width:e,height:t,translation:n,quaternion:r,pixelwidth:s,pixelheight:a,plane:w,material:x,rendercall:c,renderTarget:y};if(this._layers.push(C),this._session!==null){C.plane.material=new Ua({color:16777215,side:ol}),C.plane.material.blending=m4,C.plane.material.blendEquation=A0,C.plane.material.blendSrc=Xf,C.plane.material.blendDst=Xf,C.xrlayer=this._createXRLayer(C);const N=this._session.renderState.layers;N.unshift(C.xrlayer),this._session.updateRenderState({layers:N})}else y.isXRRenderTarget=!1;return w}createCylinderLayer(e,t,n,r,s,a,c,d,p={}){const y=new J0(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),x=new LT(a,c,{format:$s,type:Yi,depthTexture:new ll(a,c,p.stencil?Cu:ys,void 0,void 0,void 0,void 0,void 0,void 0,p.stencil?Wl:al),stencilBuffer:p.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});x._autoAllocateDepthBuffer=!0;const w=new Ua({color:16777215,side:Ui});w.map=x.texture,w.map.offset.y=1,w.map.repeat.y=-1;const C=new fn(y,w);C.position.copy(r),C.quaternion.copy(s);const N={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:r,quaternion:s,pixelwidth:a,pixelheight:c,plane:C,material:w,rendercall:d,renderTarget:x};if(this._layers.push(N),this._session!==null){N.plane.material=new Ua({color:16777215,side:Ui}),N.plane.material.blending=m4,N.plane.material.blendEquation=A0,N.plane.material.blendSrc=Xf,N.plane.material.blendDst=Xf,N.xrlayer=this._createXRLayer(N);const F=this._session.renderState.layers;F.unshift(N.xrlayer),this._session.updateRenderState({layers:F})}else x.isXRRenderTarget=!1;return C}renderLayers(){const e=new _e,t=new us,n=this._renderer,r=this.isPresenting,s=n.getOutputRenderTarget(),a=n._frameBufferTarget;this.isPresenting=!1;const c=new vn;n.getSize(c);const d=n._quad;for(const p of this._layers)if(p.renderTarget.isXRRenderTarget=this._session!==null,p.renderTarget._hasExternalTextures=p.renderTarget.isXRRenderTarget,p.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){p.xrlayer.transform=new XRRigidTransform(p.plane.getWorldPosition(e),p.plane.getWorldQuaternion(t));const y=this._glBinding.getSubImage(p.xrlayer,this._xrFrame);n.backend.setXRRenderTargetTextures(p.renderTarget,y.colorTexture,void 0),n._setXRLayerSize(p.renderTarget.width,p.renderTarget.height),n.setOutputRenderTarget(p.renderTarget),n.setRenderTarget(null),n._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:x,quad:w}=this._frameBufferTargets.get(p.renderTarget)||{frameBufferTarget:null,quad:null};x?(n._frameBufferTarget=x,n._quad=w):(n._quad=new yD(new No),this._frameBufferTargets.set(p.renderTarget,{frameBufferTarget:n._getFrameBufferTarget(),quad:n._quad})),p.rendercall(),n._frameBufferTarget=null}else n.setRenderTarget(p.renderTarget),p.rendercall();n.setRenderTarget(null),n.setOutputRenderTarget(s),n._frameBufferTarget=a,n._setXRLayerSize(c.x,c.y),n._quad=d,this.isPresenting=r}getSession(){return this._session}async setSession(e){const t=this._renderer,n=t.backend;this._gl=t.getContext();const r=this._gl,s=r.getContextAttributes();if(this._session=e,e!==null){if(n.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await n.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._supportsLayers===!0){let a=null,c=null,d=null;t.depth&&(d=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,a=t.stencil?Wl:al,c=t.stencil?Cu:ys);const p={colorFormat:r.RGBA8,depthFormat:d,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(p.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();const y=this._glBinding.createProjectionLayer(p),x=[y];this._glProjLayer=y,t.setPixelRatio(1),t._setXRLayerSize(y.textureWidth,y.textureHeight);const w=this._useMultiview?2:1,C=new ll(y.textureWidth,y.textureHeight,c,void 0,void 0,void 0,void 0,void 0,void 0,a,w);if(this._xrRenderTarget=new LT(y.textureWidth,y.textureHeight,{format:$s,type:Yi,colorSpace:t.outputColorSpace,depthTexture:C,stencilBuffer:t.stencil,samples:s.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(const N of this._layers)N.plane.material=new Ua({color:16777215,side:N.type==="cylinder"?Ui:ol}),N.plane.material.blending=m4,N.plane.material.blendEquation=A0,N.plane.material.blendSrc=Xf,N.plane.material.blendDst=Xf,N.xrlayer=this._createXRLayer(N),x.unshift(N.xrlayer);e.updateRenderState({layers:x})}else{const a={antialias:t.currentSamples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},c=new XRWebGLLayer(e,r,a);this._glBaseLayer=c,e.updateRenderState({baseLayer:c}),t.setPixelRatio(1),t._setXRLayerSize(c.framebufferWidth,c.framebufferHeight),this._xrRenderTarget=new LT(c.framebufferWidth,c.framebufferHeight,{format:$s,type:Yi,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:c.ignoreDepthValues===!1,resolveStencilBuffer:c.ignoreDepthValues===!1}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const n=e.near,r=e.far,s=this._cameraXR,a=this._cameraL,c=this._cameraR;s.near=c.near=a.near=n,s.far=c.far=a.far=r,s.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==s.near||this._currentDepthFar!==s.far)&&(t.updateRenderState({depthNear:s.near,depthFar:s.far}),this._currentDepthNear=s.near,this._currentDepthFar=s.far),s.layers.mask=e.layers.mask|6,a.layers.mask=s.layers.mask&-5,c.layers.mask=s.layers.mask&-3;const d=e.parent,p=s.cameras;T5e(s,d);for(let y=0;y<p.length;y++)T5e(p[y],d);p.length===2?oKe(s,a,c):s.projectionMatrix.copy(a.projectionMatrix),aKe(e,s,d)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new HN,this._controllers[e]=t),t}}function oKe(i,e,t){S5e.setFromMatrixPosition(e.matrixWorld),w5e.setFromMatrixPosition(t.matrixWorld);const n=S5e.distanceTo(w5e),r=e.projectionMatrix.elements,s=t.projectionMatrix.elements,a=r[14]/(r[10]-1),c=r[14]/(r[10]+1),d=(r[9]+1)/r[5],p=(r[9]-1)/r[5],y=(r[8]-1)/r[0],x=(s[8]+1)/s[0],w=a*y,C=a*x,N=n/(-y+x),F=N*-y;if(e.matrixWorld.decompose(i.position,i.quaternion,i.scale),i.translateX(F),i.translateZ(N),i.matrixWorld.compose(i.position,i.quaternion,i.scale),i.matrixWorldInverse.copy(i.matrixWorld).invert(),r[10]===-1)i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const U=a+N,R=c+N,B=w-F,Y=C+(n-F),A=d*c/R*U,ne=p*c/R*U;i.projectionMatrix.makePerspective(B,Y,A,ne,U,R),i.projectionMatrixInverse.copy(i.projectionMatrix).invert()}}function T5e(i,e){e===null?i.matrixWorld.copy(i.matrix):i.matrixWorld.multiplyMatrices(e.matrixWorld,i.matrix),i.matrixWorldInverse.copy(i.matrixWorld).invert()}function aKe(i,e,t){t===null?i.matrix.copy(e.matrixWorld):(i.matrix.copy(t.matrixWorld),i.matrix.invert(),i.matrix.multiply(e.matrixWorld)),i.matrix.decompose(i.position,i.quaternion,i.scale),i.updateMatrixWorld(!0),i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse),i.isPerspectiveCamera&&(i.fov=l6*2*Math.atan(1/i.projectionMatrix.elements[5]),i.zoom=1)}function lKe(i){const e=this._controllerInputSources.indexOf(i.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const n=this.getReferenceSpace();t.update(i.inputSource,i.frame,n),t.dispatchEvent({type:i.type,data:i.inputSource})}}function cKe(){const i=this._session,e=this._renderer;i.removeEventListener("select",this._onSessionEvent),i.removeEventListener("selectstart",this._onSessionEvent),i.removeEventListener("selectend",this._onSessionEvent),i.removeEventListener("squeeze",this._onSessionEvent),i.removeEventListener("squeezestart",this._onSessionEvent),i.removeEventListener("squeezeend",this._onSessionEvent),i.removeEventListener("end",this._onSessionEnd),i.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const n=this._controllerInputSources[t];n!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(n))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._glBinding=null,this._glBaseLayer=null,this._glProjLayer=null,this._sessionUsesLayers===!0)for(const t of this._layers)t.renderTarget=new LT(t.pixelwidth,t.pixelheight,{format:$s,type:Yi,depthTexture:new ll(t.pixelwidth,t.pixelheight,t.stencilBuffer?Cu:ys,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?Wl:al),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function uKe(i){const e=this._controllers,t=this._controllerInputSources;for(let n=0;n<i.removed.length;n++){const r=i.removed[n],s=t.indexOf(r);s>=0&&(t[s]=null,e[s].disconnect(r))}for(let n=0;n<i.added.length;n++){const r=i.added[n];let s=t.indexOf(r);if(s===-1){for(let c=0;c<e.length;c++)if(c>=t.length){t.push(r),s=c;break}else if(t[c]===null){t[c]=r,s=c;break}if(s===-1)break}const a=e[s];a&&a.connect(r)}}function dKe(i){return i.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(i.translation,i.quaternion),width:i.width/2,height:i.height/2,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(i.translation,i.quaternion),radius:i.radius,centralAngle:i.centralAngle,aspectRatio:i.aspectRatio,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight,clearOnAccess:!1})}function hKe(i,e){if(e===void 0)return;const t=this._cameraXR,n=this._renderer,r=n.backend,s=this._glBaseLayer,a=this.getReferenceSpace(),c=e.getViewerPose(a);if(this._xrFrame=e,c!==null){const d=c.views;this._glBaseLayer!==null&&r.setXRTarget(s.framebuffer);let p=!1;d.length!==t.cameras.length&&(t.cameras.length=0,p=!0);for(let y=0;y<d.length;y++){const x=d[y];let w;if(this._supportsLayers===!0){const N=this._glBinding.getViewSubImage(this._glProjLayer,x);w=N.viewport,y===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,N.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:N.depthStencilTexture)}else w=s.getViewport(x);let C=this._cameras[y];C===void 0&&(C=new ca,C.layers.enable(y),C.viewport=new wr,this._cameras[y]=C),C.matrix.fromArray(x.transform.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale),C.projectionMatrix.fromArray(x.projectionMatrix),C.projectionMatrixInverse.copy(C.projectionMatrix).invert(),C.viewport.set(w.x,w.y,w.width,w.height),y===0&&(t.matrix.copy(C.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),p===!0&&t.cameras.push(C)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let d=0;d<this._controllers.length;d++){const p=this._controllerInputSources[d],y=this._controllers[d];p!==null&&y!==void 0&&y.update(p,e,a)}this._currentAnimationLoop&&this._currentAnimationLoop(i,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}class fKe extends Yl{constructor(e){super(),this.domElement=e,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new wr(0,0,this._width,this._height),this._scissor=new wr(0,0,this._width,this._height),this._scissorTest=!1,this.colorTexture=new YW,this.depthTexture=new ll}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._dispatchResize())}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._dispatchResize())}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,r){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,n,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,r,s=0,a=1){const c=this._viewport;e.isVector4?c.copy(e):c.set(e,t,n,r),c.minDepth=s,c.maxDepth=a}_dispatchResize(){this.dispatchEvent({type:"resize"})}dispose(){this.dispatchEvent({type:"dispose"})}}const E5e=new c6,I_=new vn,jj=new wr,Hj=new UE,Wj=new $W,AN=new An,c2=new wr,pKe={[ol]:Ui,[Ui]:ol,[no]:no};class mKe{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,reversedDepthBuffer:r=!1,alpha:s=!0,depth:a=!0,stencil:c=!1,antialias:d=!1,samples:p=0,getFallback:y=null,outputBufferType:x=Gs,multiview:w=!1}=t;this.backend=e,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=s,this.logarithmicDepthBuffer=n,this.reversedDepthBuffer=r,this.outputColorSpace=ti,this.toneMapping=Qa,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=a,this.stencil=c,this.info=new cHe,this.contextNode=C2(),this.library=new K_e,this.lighting=new iKe,this._samples=p||d===!0?4:0,this._onCanvasTargetResize=this._onCanvasTargetResize.bind(this),this._canvasTarget=new fKe(e.getDomElement()),this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize),this._canvasTarget.isDefaultCanvasTarget=!0,this._inspector=new rye,this._inspector.setRenderer(this),this._getFallback=y,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new yD(new No),this._quad.name="Output Color Transform",this._quad.material.name="outputColorTransform",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const C=this.alpha===!0?0:1;this._clearColor=new x$(0,0,0,C),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._outputBufferType=x,this._cacheShadowNodes=new WeakMap,this._initialized=!1,this._callDepth=-1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,transmitted:!1,type:Y_},this.xr=new sKe(this,w),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(N,F,U)=>{await this.compileAsync(N,F);const R=this._renderLists.get(N,F),B=this._renderContexts.get(this._renderTarget,this._mrt),Y=N.overrideMaterial||U.material,A=this._objects.get(U,Y,N,F,R.lightsNode,B,B.clippingContext),{fragmentShader:ne,vertexShader:se}=A.getNodeBuilderState();return{fragmentShader:ne,vertexShader:se}}}}async init(){return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=n=this._getFallback(r),await n.init(this)}catch(s){t(s);return}else{t(r);return}}this._nodes=new eKe(this,n),this._animation=new eHe(this,this._nodes,this.info),this._attributes=new aHe(n),this._background=new pYe(this,this._nodes),this._geometries=new lHe(this._attributes,this.info),this._textures=new SHe(this,n,this.info),this._pipelines=new fHe(n,this._nodes),this._bindings=new pHe(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new iHe(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new vHe(this.lighting),this._bundles=new nKe,this._renderContexts=new xHe(this),this._animation.start(),this._initialized=!0,this._inspector.init(),e(this)}),this._initPromise)}get domElement(){return this._canvasTarget.domElement}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,s=r.renderId,a=this._currentRenderContext,c=this._currentRenderObjectFunction,d=this._handleObjectFunction,p=this._compilationPromises,y=e.isScene===!0?e:E5e;n===null&&(n=e);const x=this._renderTarget,w=this._renderContexts.get(x,this._mrt),C=this._activeMipmapLevel,N=[];this._currentRenderContext=w,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=N,r.renderId++,r.update(),w.depth=this.depth,w.stencil=this.stencil,w.clippingContext||(w.clippingContext=new wk),w.clippingContext.updateGlobal(y,t),y.onBeforeRender(this,e,t,x);const F=this._renderLists.get(e,t);if(F.begin(),this._projectObject(e,t,0,F,w.clippingContext),n!==e&&n.traverseVisible(function(A){A.isLight&&A.layers.test(t.layers)&&F.pushLight(A)}),F.finish(),x!==null){this._textures.updateRenderTarget(x,C);const A=this._textures.get(x);w.textures=A.textures,w.depthTexture=A.depthTexture}else w.textures=null,w.depthTexture=null;n!==e?this._background.update(n,F,w):this._background.update(y,F,w);const U=F.opaque,R=F.transparent,B=F.transparentDoublePass,Y=F.lightsNode;this.opaque===!0&&U.length>0&&this._renderObjects(U,t,y,Y),this.transparent===!0&&R.length>0&&this._renderTransparents(R,B,t,y,Y),r.renderId=s,this._currentRenderContext=a,this._currentRenderObjectFunction=c,this._handleObjectFunction=d,this._compilationPromises=p,await Promise.all(N)}async renderAsync(e,t){ns('Renderer: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.render(e,t)}async waitForGPU(){jt("Renderer: waitForGPU() has been removed. Read https://github.com/mrdoob/three.js/issues/32012 for more information.")}set inspector(e){this._inspector!==null&&this._inspector.setRenderer(null),this._inspector=e,this._inspector.setRenderer(this)}get inspector(){return this._inspector}set highPrecision(e){const t=this.contextNode.value;e===!0?(t.modelViewMatrix=ZH,t.modelNormalViewMatrix=QH):this.highPrecision&&(delete t.modelViewMatrix,delete t.modelNormalViewMatrix)}get highPrecision(){const e=this.contextNode.value;return e.modelViewMatrix===ZH&&e.modelNormalViewMatrix===QH}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getOutputBufferType(){return this._outputBufferType}getColorBufferType(){return ns('Renderer: ".getColorBufferType()" has been renamed to ".getOutputBufferType()".'),this.getOutputBufferType()}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),jt(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:r,camera:s,renderList:a}=e,c=this._currentRenderContext,d=this._bundles.get(r,s),p=this.backend.get(d);p.renderContexts===void 0&&(p.renderContexts=new Set);const y=r.version!==p.version,x=p.renderContexts.has(c)===!1||y;if(p.renderContexts.add(c),x){this.backend.beginBundle(c),(p.renderObjects===void 0||y)&&(p.renderObjects=[]),this._currentRenderBundle=d;const{transparentDoublePass:w,transparent:C,opaque:N}=a;this.opaque===!0&&N.length>0&&this._renderObjects(N,s,t,n),this.transparent===!0&&C.length>0&&this._renderTransparents(C,w,s,t,n),this._currentRenderBundle=null,this.backend.finishBundle(c,d),p.version=r.version}else{const{renderObjects:w}=p;for(let C=0,N=w.length;C<N;C++){const F=w[C];this._nodes.needsRefresh(F)&&(this._nodes.updateBefore(F),this._nodes.updateForRender(F),this._bindings.updateForRender(F),this._nodes.updateAfter(F))}}this.backend.addBundle(c,d)}render(e,t){if(this._initialized===!1)throw new Error('Renderer: .render() called before the backend is initialized. Use "await renderer.init();" before rendering.');this._renderScene(e,t)}get initialized(){return this._initialized}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this,n=e!==Qa,r=t!==Xn.workingColorSpace;if(n===!1&&r===!1)return null;const{width:s,height:a}=this.getDrawingBufferSize(I_),{depth:c,stencil:d}=this;let p=this._frameBufferTarget;p===null&&(p=new lp(s,a,{depthBuffer:c,stencilBuffer:d,type:this._outputBufferType,format:$s,colorSpace:Xn.workingColorSpace,generateMipmaps:!1,minFilter:Bi,magFilter:Bi,samples:this.samples}),p.isPostProcessingRenderTarget=!0,this._frameBufferTarget=p);const y=this.getOutputRenderTarget();p.depthBuffer=c,p.stencilBuffer=d,y!==null?p.setSize(y.width,y.height,y.depth):p.setSize(s,a,1);const x=this._canvasTarget;return p.viewport.copy(x._viewport),p.scissor.copy(x._scissor),p.viewport.multiplyScalar(x._pixelRatio),p.scissor.multiplyScalar(x._pixelRatio),p.scissorTest=x._scissorTest,p.multiview=y!==null?y.multiview:!1,p.resolveDepthBuffer=y!==null?y.resolveDepthBuffer:!0,p._autoAllocateDepthBuffer=y!==null?y._autoAllocateDepthBuffer:!1,p}_renderScene(e,t,n=!0){if(this._isDeviceLost===!0)return;const r=n?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,a=s.renderId,c=this._currentRenderContext,d=this._currentRenderObjectFunction,p=this._handleObjectFunction;this._callDepth++;const y=e.isScene===!0?e:E5e,x=this._renderTarget||this._outputRenderTarget,w=this._activeCubeFace,C=this._activeMipmapLevel;let N;r!==null?(N=r,this.setRenderTarget(N)):N=x;const F=this._renderContexts.get(N,this._mrt,this._callDepth);this._currentRenderContext=F,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this._handleObjectFunction=this._renderObjectDirect,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls,this.backend.updateTimeStampUID(F),this.inspector.beginRender(this.backend.getTimestampUID(F),e,t,N);const U=this.xr;if(U.isPresenting===!1){let ot=!1;if(this.reversedDepthBuffer===!0&&t.reversedDepth!==!0){if(t._reversedDepth=!0,t.isArrayCamera)for(const ce of t.cameras)ce._reversedDepth=!0;ot=!0}const He=this.coordinateSystem;if(t.coordinateSystem!==He){if(t.coordinateSystem=He,t.isArrayCamera)for(const ce of t.cameras)ce.coordinateSystem=He;ot=!0}if(ot===!0&&(t.updateProjectionMatrix(),t.isArrayCamera))for(const ce of t.cameras)ce.updateProjectionMatrix()}e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),U.enabled===!0&&U.isPresenting===!0&&(U.cameraAutoUpdate===!0&&U.updateCamera(t),t=U.getCamera());const R=this._canvasTarget;let B=R._viewport,Y=R._scissor,A=R._pixelRatio;N!==null&&(B=N.viewport,Y=N.scissor,A=1),this.getDrawingBufferSize(I_),jj.set(0,0,I_.width,I_.height);const ne=B.minDepth===void 0?0:B.minDepth,se=B.maxDepth===void 0?1:B.maxDepth;F.viewportValue.copy(B).multiplyScalar(A).floor(),F.viewportValue.width>>=C,F.viewportValue.height>>=C,F.viewportValue.minDepth=ne,F.viewportValue.maxDepth=se,F.viewport=F.viewportValue.equals(jj)===!1,F.scissorValue.copy(Y).multiplyScalar(A).floor(),F.scissor=R._scissorTest&&F.scissorValue.equals(jj)===!1,F.scissorValue.width>>=C,F.scissorValue.height>>=C,F.clippingContext||(F.clippingContext=new wk),F.clippingContext.updateGlobal(y,t),y.onBeforeRender(this,e,t,N);const oe=t.isArrayCamera?Wj:Hj;t.isArrayCamera||(AN.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),oe.setFromProjectionMatrix(AN,t.coordinateSystem,t.reversedDepth));const G=this._renderLists.get(e,t);if(G.begin(),this._projectObject(e,t,0,G,F.clippingContext),G.finish(),this.sortObjects===!0&&G.sort(this._opaqueSort,this._transparentSort),N!==null){this._textures.updateRenderTarget(N,C);const ot=this._textures.get(N);F.textures=ot.textures,F.depthTexture=ot.depthTexture,F.width=ot.width,F.height=ot.height,F.renderTarget=N,F.depth=N.depthBuffer,F.stencil=N.stencilBuffer}else F.textures=null,F.depthTexture=null,F.width=I_.width,F.height=I_.height,F.depth=this.depth,F.stencil=this.stencil;F.width>>=C,F.height>>=C,F.activeCubeFace=w,F.activeMipmapLevel=C,F.occlusionQueryCount=G.occlusionQueryCount,F.scissorValue.max(c2.set(0,0,0,0)),F.scissorValue.x+F.scissorValue.width>F.width&&(F.scissorValue.width=Math.max(F.width-F.scissorValue.x,0)),F.scissorValue.y+F.scissorValue.height>F.height&&(F.scissorValue.height=Math.max(F.height-F.scissorValue.y,0)),this._background.update(y,G,F),F.camera=t,this.backend.beginRender(F);const{bundles:ie,lightsNode:Me,transparentDoublePass:X,transparent:De,opaque:$e}=G;return ie.length>0&&this._renderBundles(ie,y,Me),this.opaque===!0&&$e.length>0&&this._renderObjects($e,t,y,Me),this.transparent===!0&&De.length>0&&this._renderTransparents(De,X,t,y,Me),this.backend.finishRender(F),s.renderId=a,this._currentRenderContext=c,this._currentRenderObjectFunction=d,this._handleObjectFunction=p,this._callDepth--,r!==null&&(this.setRenderTarget(x,w,C),this._renderOutput(N)),y.onAfterRender(this,e,t,N),this.inspector.finishRender(this.backend.getTimestampUID(F)),F}_setXRLayerSize(e,t){this._canvasTarget._width=e,this._canvasTarget._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const n=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}getAnimationLoop(){return this._animation.getAnimationLoop()}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._canvasTarget.getPixelRatio()}getDrawingBufferSize(e){return this._canvasTarget.getDrawingBufferSize(e)}getSize(e){return this._canvasTarget.getSize(e)}setPixelRatio(e=1){this._canvasTarget.setPixelRatio(e)}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||this._canvasTarget.setDrawingBufferSize(e,t,n)}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||this._canvasTarget.setSize(e,t,n)}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){return this._canvasTarget.getScissor(e)}setScissor(e,t,n,r){this._canvasTarget.setScissor(e,t,n,r)}getScissorTest(){return this._canvasTarget.getScissorTest()}setScissorTest(e){this._canvasTarget.setScissorTest(e),this.backend.setScissorTest(e)}getViewport(e){return this._canvasTarget.getViewport(e)}setViewport(e,t,n,r,s=0,a=1){this._canvasTarget.setViewport(e,t,n,r,s,a)}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this.reversedDepthBuffer===!0?1-this._clearDepth:this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(this._initialized===!1)throw new Error('Renderer: .clear() called before the backend is initialized. Use "await renderer.init();" before before using this method.');const r=this._renderTarget||this._getFrameBufferTarget();let s=null;if(r!==null){this._textures.updateRenderTarget(r);const a=this._textures.get(r);s=this._renderContexts.get(r),s.textures=a.textures,s.depthTexture=a.depthTexture,s.width=a.width,s.height=a.height,s.renderTarget=r,s.depth=r.depthBuffer,s.stencil=r.stencilBuffer;const c=this.backend.getClearColor();s.clearColorValue.r=c.r,s.clearColorValue.g=c.g,s.clearColorValue.b=c.b,s.clearColorValue.a=c.a,s.clearDepthValue=this.getClearDepth(),s.clearStencilValue=this.getClearStencil(),s.activeCubeFace=this.getActiveCubeFace(),s.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,s),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){this.clear(!0,!1,!1)}clearDepth(){this.clear(!1,!0,!1)}clearStencil(){this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){ns('Renderer: "clearAsync()" has been deprecated. Use "clear()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.clear(e,t,n)}async clearColorAsync(){ns('Renderer: "clearColorAsync()" has been deprecated. Use "clearColor()" and "await renderer.init();" when creating the renderer.'),this.clear(!0,!1,!1)}async clearDepthAsync(){ns('Renderer: "clearDepthAsync()" has been deprecated. Use "clearDepth()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!0,!1)}async clearStencilAsync(){ns('Renderer: "clearStencilAsync()" has been deprecated. Use "clearStencil()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!1,!0)}get needsFrameBufferTarget(){const e=this.currentToneMapping!==Qa,t=this.currentColorSpace!==Xn.workingColorSpace;return e||t}get samples(){return this._samples}get currentSamples(){let e=this._samples;return this._renderTarget!==null?e=this._renderTarget.samples:this.needsFrameBufferTarget&&(e=0),e}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:Qa}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Xn.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this._initialized===!0&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._geometries.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setCanvasTarget(e){this._canvasTarget.removeEventListener("resize",this._onCanvasTargetResize),this._canvasTarget=e,this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize)}getCanvasTarget(){return this._canvasTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e,t=null){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return Wt("Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e,t);const n=this._nodes.nodeFrame,r=n.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,n.renderId=this.info.calls,this.backend.updateTimeStampUID(e),this.inspector.beginCompute(this.backend.getTimestampUID(e),e);const s=this.backend,a=this._pipelines,c=this._bindings,d=this._nodes,p=Array.isArray(e)?e:[e];if(p[0]===void 0||p[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");s.beginCompute(e);for(const y of p){if(a.has(y)===!1){const C=()=>{y.removeEventListener("dispose",C),a.delete(y),c.deleteForCompute(y),d.delete(y)};y.addEventListener("dispose",C);const N=y.onInitFunction;N!==null&&N.call(y,{renderer:this})}d.updateForCompute(y),c.updateForCompute(y);const x=c.getForCompute(y),w=a.getForCompute(y,x);s.compute(e,y,x,w,t)}s.finishCompute(e),n.renderId=r,this.inspector.finishCompute(this.backend.getTimestampUID(e))}async computeAsync(e,t=null){this._initialized===!1&&await this.init(),this.compute(e,t)}async hasFeatureAsync(e){return ns('Renderer: "hasFeatureAsync()" has been deprecated. Use "hasFeature()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){if(this._initialized===!1)throw new Error('Renderer: .hasFeature() called before the backend is initialized. Use "await renderer.init();" before before using this method.');return this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){ns('Renderer: "initTextureAsync()" has been deprecated. Use "initTexture()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.initTexture(e)}initTexture(e){if(this._initialized===!1)throw new Error('Renderer: .initTexture() called before the backend is initialized. Use "await renderer.init();" before before using this method.');this._textures.updateTexture(e)}initRenderTarget(e){if(this._initialized===!1)throw new Error('Renderer: .initRenderTarget() called before the backend is initialized. Use "await renderer.init();" before before using this method.');this._textures.updateRenderTarget(e);const t=this._textures.get(e),n=this._renderContexts.get(e);n.textures=t.textures,n.depthTexture=t.depthTexture,n.width=t.width,n.height=t.height,n.renderTarget=e,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,this.backend.initRenderTarget(n)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=c2.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=c2.copy(t).floor();else{jt("Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=c2.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,r;n!==null?r=n.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),n=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,n,t),this._inspector.copyFramebufferToTexture(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,s,a),this._inspector.copyTextureToTexture(e,t)}async readRenderTargetPixelsAsync(e,t,n,r,s,a=0,c=0){return this.backend.copyTextureToBuffer(e.textures[a],t,n,r,s,c)}_projectObject(e,t,n,r,s){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(s=s.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const d=t.isArrayCamera?Wj:Hj;if(!e.frustumCulled||d.intersectsSprite(e,t)){this.sortObjects===!0&&c2.setFromMatrixPosition(e.matrixWorld).applyMatrix4(AN);const{geometry:p,material:y}=e;y.visible&&r.push(e,p,y,n,c2.z,null,s)}}else if(e.isLineLoop)jt("Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const d=t.isArrayCamera?Wj:Hj;if(!e.frustumCulled||d.intersectsObject(e,t)){const{geometry:p,material:y}=e;if(this.sortObjects===!0&&(p.boundingSphere===null&&p.computeBoundingSphere(),c2.copy(p.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(AN)),Array.isArray(y)){const x=p.groups;for(let w=0,C=x.length;w<C;w++){const N=x[w],F=y[N.materialIndex];F&&F.visible&&r.push(e,p,F,n,c2.z,N,s)}}else y.visible&&r.push(e,p,y,n,c2.z,null,s)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const d=r;r=this._renderLists.get(e,t),r.begin(),d.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const c=e.children;for(let d=0,p=c.length;d<p;d++)this._projectObject(c[d],t,n,r,s)}_renderBundles(e,t,n){for(const r of e)this._renderBundle(r,t,n)}_renderTransparents(e,t,n,r,s){if(t.length>0){for(const{material:a}of t)a.side=Ui;this._renderObjects(t,n,r,s,"backSide");for(const{material:a}of t)a.side=ol;this._renderObjects(e,n,r,s);for(const{material:a}of t)a.side=no}else this._renderObjects(e,n,r,s)}_renderObjects(e,t,n,r,s=null){for(let a=0,c=e.length;a<c;a++){const{object:d,geometry:p,material:y,group:x,clippingContext:w}=e[a];this._currentRenderObjectFunction(d,n,t,p,y,x,r,w,s)}}_getShadowNodes(e){const t=e.version;let n=this._cacheShadowNodes.get(e);if(n===void 0||n.version!==t){const r=e.map!==null,s=e.colorNode&&e.colorNode.isNode,a=e.castShadowNode&&e.castShadowNode.isNode,c=e.maskShadowNode&&e.maskShadowNode.isNode||e.maskNode&&e.maskNode.isNode;let d=null,p=null,y=null;if(r||s||a||c){let x,w;if(a?(x=e.castShadowNode.rgb,w=e.castShadowNode.a,this.shadowMap.transmitted!==!0&&ns("Renderer: `shadowMap.transmitted` needs to be set to `true` when using `material.castShadowNode`.")):(x=Ve(0),w=xe(1)),r&&(w=w.mul(to("map","texture",e).a)),s&&(w=w.mul(e.colorNode.a)),p=hr(x,w),c){const C=e.maskShadowNode||e.maskNode;p=We(([N])=>(C.not().discard(),N))(p)}}e.depthNode&&e.depthNode.isNode&&(y=e.depthNode),e.castShadowPositionNode&&e.castShadowPositionNode.isNode?d=e.castShadowPositionNode:e.positionNode&&e.positionNode.isNode&&(d=e.positionNode),n={version:t,colorNode:p,depthNode:y,positionNode:d},this._cacheShadowNodes.set(e,n)}return n}renderObject(e,t,n,r,s,a,c,d=null,p=null){let y=!1,x,w,C,N;if(e.onBeforeRender(this,t,n,r,s,a),s.allowOverride===!0&&t.overrideMaterial!==null){const F=t.overrideMaterial;if(y=!0,x=F.isNodeMaterial?F.colorNode:null,w=F.isNodeMaterial?F.depthNode:null,C=F.isNodeMaterial?F.positionNode:null,N=t.overrideMaterial.side,s.positionNode&&s.positionNode.isNode&&(F.positionNode=s.positionNode),F.alphaTest=s.alphaTest,F.alphaMap=s.alphaMap,F.transparent=s.transparent||s.transmission>0||s.transmissionNode&&s.transmissionNode.isNode||s.backdropNode&&s.backdropNode.isNode,F.isShadowPassMaterial){const{colorNode:U,depthNode:R,positionNode:B}=this._getShadowNodes(s);this.shadowMap.type===em?F.side=s.shadowSide!==null?s.shadowSide:s.side:F.side=s.shadowSide!==null?s.shadowSide:pKe[s.side],U!==null&&(F.colorNode=U),R!==null&&(F.depthNode=R),B!==null&&(F.positionNode=B)}s=F}s.transparent===!0&&s.side===no&&s.forceSinglePass===!1?(s.side=Ui,this._handleObjectFunction(e,s,t,n,c,a,d,"backSide"),s.side=ol,this._handleObjectFunction(e,s,t,n,c,a,d,p),s.side=no):this._handleObjectFunction(e,s,t,n,c,a,d,p),y&&(t.overrideMaterial.colorNode=x,t.overrideMaterial.depthNode=w,t.overrideMaterial.positionNode=C,t.overrideMaterial.side=N),e.onAfterRender(this,t,n,r,s,a)}hasCompatibility(e){return this.backend.hasCompatibility(e)}_renderObjectDirect(e,t,n,r,s,a,c,d){const p=this._objects.get(e,t,n,r,s,this._currentRenderContext,c,d);p.drawRange=e.geometry.drawRange,p.group=a,this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(p),p.bundle=this._currentRenderBundle.bundleGroup);const y=this._nodes.needsRefresh(p);y&&(this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p)),this._pipelines.updateForRender(p),this.backend.draw(p,this.info),y&&this._nodes.updateAfter(p)}_createObjectPipeline(e,t,n,r,s,a,c,d){const p=this._objects.get(e,t,n,r,s,this._currentRenderContext,c,d);p.drawRange=e.geometry.drawRange,p.group=a,this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p),this._pipelines.getForRender(p,this._compilationPromises),this._nodes.updateAfter(p)}_onCanvasTargetResize(){this._initialized&&this.backend.updateSize()}get compile(){return this.compileAsync}}class Z_e{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}getVisibility(){return this.visibility}clone(){return Object.assign(new this.constructor,this)}}function gKe(i){return i+(u4-i%u4)%u4}class Q_e extends Z_e{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t,this._updateRanges=[]}get updateRanges(){return this._updateRanges}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}get byteLength(){return gKe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class J_e extends Q_e{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let vKe=0;class exe extends J_e{constructor(e,t){super("UniformBuffer_"+vKe++,e?e.value:null),this.nodeUniform=e,this.groupNode=t,this.isNodeUniformBuffer=!0}set updateRanges(e){this.nodeUniform.updateRanges=e}get updateRanges(){return this.nodeUniform.updateRanges}addUpdateRange(e,t){this.nodeUniform.addUpdateRange(e,t)}clearUpdateRanges(){this.nodeUniform.clearUpdateRanges()}get buffer(){return this.nodeUniform.value}}class yKe extends J_e{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[],this._updateRangeCache=new Map}addUniformUpdateRange(e){const t=e.index;if(this._updateRangeCache.has(t)!==!0){const n=this.updateRanges,r=e.offset,s=e.itemSize,a={start:r,count:s};n.push(a),this._updateRangeCache.set(t,a)}}clearUpdateRanges(){this._updateRangeCache.clear(),super.clearUpdateRanges()}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let n=0,r=this.uniforms.length;n<r;n++){const s=this.uniforms[n],a=s.boundary,c=s.itemSize*e,d=t%u4,p=d%a,y=d+p;t+=p,y!==0&&u4-y<c&&(t+=u4-y),s.offset=t/e,s.index=n,t+=c}return Math.ceil(t/u4)*u4}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);jt("WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s]!==r){const c=this._getBufferForType(a);c[s]=n[s]=r,t=!0,this.addUniformUpdateRange(e)}return t}updateVector2(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y){const c=this._getBufferForType(a);c[s+0]=n[s+0]=r.x,c[s+1]=n[s+1]=r.y,t=!0,this.addUniformUpdateRange(e)}return t}updateVector3(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y||n[s+2]!==r.z){const c=this._getBufferForType(a);c[s+0]=n[s+0]=r.x,c[s+1]=n[s+1]=r.y,c[s+2]=n[s+2]=r.z,t=!0,this.addUniformUpdateRange(e)}return t}updateVector4(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y||n[s+2]!==r.z||n[s+4]!==r.w){const c=this._getBufferForType(a);c[s+0]=n[s+0]=r.x,c[s+1]=n[s+1]=r.y,c[s+2]=n[s+2]=r.z,c[s+3]=n[s+3]=r.w,t=!0,this.addUniformUpdateRange(e)}return t}updateColor(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset;if(n[s+0]!==r.r||n[s+1]!==r.g||n[s+2]!==r.b){const a=this.buffer;a[s+0]=n[s+0]=r.r,a[s+1]=n[s+1]=r.g,a[s+2]=n[s+2]=r.b,t=!0,this.addUniformUpdateRange(e)}return t}updateMatrix3(e){let t=!1;const n=this.values,r=e.getValue().elements,s=e.offset;if(n[s+0]!==r[0]||n[s+1]!==r[1]||n[s+2]!==r[2]||n[s+4]!==r[3]||n[s+5]!==r[4]||n[s+6]!==r[5]||n[s+8]!==r[6]||n[s+9]!==r[7]||n[s+10]!==r[8]){const a=this.buffer;a[s+0]=n[s+0]=r[0],a[s+1]=n[s+1]=r[1],a[s+2]=n[s+2]=r[2],a[s+4]=n[s+4]=r[3],a[s+5]=n[s+5]=r[4],a[s+6]=n[s+6]=r[5],a[s+8]=n[s+8]=r[6],a[s+9]=n[s+9]=r[7],a[s+10]=n[s+10]=r[8],t=!0,this.addUniformUpdateRange(e)}return t}updateMatrix4(e){let t=!1;const n=this.values,r=e.getValue().elements,s=e.offset;return xKe(n,r,s)===!1&&(this.buffer.set(r,s),_Ke(n,r,s),t=!0,this.addUniformUpdateRange(e)),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function _Ke(i,e,t){for(let n=0,r=e.length;n<r;n++)i[t+n]=e[n]}function xKe(i,e,t){for(let n=0,r=e.length;n<r;n++)if(i[t+n]!==e[n])return!1;return!0}let bKe=0;class txe extends yKe{constructor(e,t){super(e),this.id=bKe++,this.groupNode=t,this.isNodeUniformsGroup=!0}}class nxe extends Z_e{constructor(e,t){super(e),this._texture=null,this._onTextureDispose=()=>{this.generation=null,this.version=-1},this.texture=t,this.version=t?t.version:-1,this.generation=null,this.samplerKey="",this.isSampler=!0}set texture(e){this._texture!==e&&(this._texture&&this._texture.removeEventListener("dispose",this._onTextureDispose),this._texture=e,this.generation=null,this.version=-1,this._texture&&this._texture.addEventListener("dispose",this._onTextureDispose))}get texture(){return this._texture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}clone(){const e=super.clone();return e._texture=null,e._onTextureDispose=()=>{e.generation=null,e.version=-1},e.texture=this.texture,e}}let SKe=0;class wKe extends nxe{constructor(e,t){super(e,t),this.id=SKe++,this.store=!1,this.mipLevel=0,this.isSampledTexture=!0}}class MD extends wKe{constructor(e,t,n,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=r}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class rxe extends MD{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledCubeTexture=!0}}class fW extends MD{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledTexture3D=!0}}const M5e={bitcast_int_uint:new Za("uint tsl_bitcast_int_to_uint ( int x ) { return floatBitsToUint( intBitsToFloat ( x ) ); }"),bitcast_uint_int:new Za("uint tsl_bitcast_uint_to_int ( uint x ) { return floatBitsToInt( uintBitsToFloat ( x ) ); }")},TKe={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint",bitcast_uint_int:"tsl_bitcast_uint_to_int",bitcast_int_uint:"tsl_bitcast_int_to_uint",floatpack_snorm_2x16:"packSnorm2x16",floatpack_unorm_2x16:"packUnorm2x16",floatpack_float16_2x16:"packHalf2x16",floatunpack_snorm_2x16:"unpackSnorm2x16",floatunpack_unorm_2x16:"unpackUnorm2x16",floatunpack_float16_2x16:"unpackHalf2x16"},C5e={low:"lowp",medium:"mediump",high:"highp"},A5e={swizzleAssign:!0,storageBuffer:!1},P5e={perspective:"smooth",linear:"noperspective"},R5e={centroid:"centroid"},I5e=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision highp sampler2DShadow;
precision highp sampler2DArrayShadow;
precision highp samplerCubeShadow;
`;class EKe extends X_e{constructor(e,t){super(e,t,new JYe),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==il}_include(e){const t=M5e[e];return t.build(this),this.addInclude(t),t}getMethod(e){return M5e[e]!==void 0&&this._include(e),TKe[e]||e}getBitcastMethod(e,t){return this.getMethod(`bitcast_${t}_${e}`)}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,t,n){return`${e} ? ${t} : ${n}`}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(this.getType(a.type)+" "+a.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const n=t.array,r=t.count*t.itemSize,{itemSize:s}=t,a=t.array.constructor.name.toLowerCase().includes("int");let c=a?zx:LE;s===2?c=a?Vx:Oc:s===3?c=a?oNe:OE:s===4&&(c=a?Gx:$s);const d={Float32Array:mo,Uint8Array:Yi,Uint16Array:Jf,Uint32Array:ys,Int8Array:Z8,Int16Array:Q8,Int32Array:C0,Uint8ClampedArray:Yi},p=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let y=Math.ceil(r/s/p);p*y*s<r&&y++;const x=p*y*s,w=new n.constructor(x);w.set(n,0),t.array=w;const C=new d4(t.array,p,y,c,d[t.array.constructor.name]||mo);C.needsUpdate=!0,C.isPBOTexture=!0;const N=new fm(C,null,null);N.setPrecision("high"),t.pboNode=N,t.pbo=N.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,r=t.value;if(this.renderer.backend.has(r)){const y=this.renderer.backend.get(r);y.pbo=r.pbo}const s=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.nodeName),a=this.getPropertyName(s);this.increaseUsage(n);const c=n.build(this,"uint"),d=this.getDataFromNode(e);let p=d.propertyName;if(p===void 0){const y=this.getVarFromNode(e);p=this.getPropertyName(y);const x=this.getDataFromNode(t);let w=x.propertySizeName;w===void 0&&(w=p+"Size",this.getVarFromNode(t,w,"uint"),this.addLineFlowCode(`${w} = uint( textureSize( ${a}, 0 ).x )`,e),x.propertySizeName=w);const{itemSize:C}=r,N="."+y6.join("").slice(0,C),F=`ivec2(${c} % ${w}, ${c} / ${w})`,U=this.generateTextureLoad(null,a,F,"0",null,null);let R="vec4";r.pbo.type===ys?R="uvec4":r.pbo.type===C0&&(R="ivec4"),this.addLineFlowCode(`${p} = ${R}(${U})${N}`,e),d.propertyName=p}return p}generateTextureLoad(e,t,n,r,s,a){r===null&&(r="0");let c;return s?a?c=`texelFetchOffset( ${t}, ivec3( ${n}, ${s} ), ${r}, ${a} )`:c=`texelFetch( ${t}, ivec3( ${n}, ${s} ), ${r} )`:a?c=`texelFetchOffset( ${t}, ${n}, ${r}, ${a} )`:c=`texelFetch( ${t}, ${n}, ${r} )`,e!==null&&e.isDepthTexture&&(c+=".x"),c}generateTexture(e,t,n,r,s){return r&&(n=`vec3( ${n}, ${r} )`),e.isDepthTexture?s?`textureOffset( ${t}, ${n}, ${s} ).x`:`texture( ${t}, ${n} ).x`:s?`textureOffset( ${t}, ${n}, ${s} )`:`texture( ${t}, ${n} )`}generateTextureLevel(e,t,n,r,s,a){return s&&(n=`vec3( ${n}, ${s} )`),a?`textureLodOffset( ${t}, ${n}, ${r}, ${a} )`:`textureLod( ${t}, ${n}, ${r} )`}generateTextureBias(e,t,n,r,s,a){return s&&(n=`vec3( ${n}, ${s} )`),a?`textureOffset( ${t}, ${n}, ${a}, ${r} )`:`texture( ${t}, ${n}, ${r} )`}generateTextureGrad(e,t,n,r,s,a){return s&&(n=`vec3( ${n}, ${s} )`),a?`textureGradOffset( ${t}, ${n}, ${r[0]}, ${r[1]}, ${a} )`:`textureGrad( ${t}, ${n}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,n,r,s,a,c=this.shaderStage){if(c==="fragment")return e.isCubeTexture?`texture( ${t}, vec4( ${n}, ${r} ) )`:s?a?`textureOffset( ${t}, vec4( ${n}, ${s}, ${r} ), ${a} )`:`texture( ${t}, vec4( ${n}, ${s}, ${r} ) )`:a?`textureOffset( ${t}, vec3( ${n}, ${r} ), ${a} )`:`texture( ${t}, vec3( ${n}, ${r} ) )`;jt(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${c} shader.`)}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],n=[],r={};for(const a of t){let c=null,d=!1;if(a.type==="texture"||a.type==="texture3D"){const p=a.node.value;let y="";(p.isDataTexture===!0||p.isData3DTexture===!0)&&(p.type===ys?y="u":p.type===C0&&(y="i")),a.type==="texture3D"&&p.isArrayTexture===!1?c=`${y}sampler3D ${a.name};`:p.compareFunction?p.isArrayTexture===!0?c=`sampler2DArrayShadow ${a.name};`:c=`sampler2DShadow ${a.name};`:p.isArrayTexture===!0||p.isDataArrayTexture===!0||p.isCompressedArrayTexture===!0?c=`${y}sampler2DArray ${a.name};`:c=`${y}sampler2D ${a.name};`}else if(a.type==="cubeTexture")c=`samplerCube ${a.name};`;else if(a.type==="cubeDepthTexture")a.node.value.compareFunction?c=`samplerCubeShadow ${a.name};`:c=`samplerCube ${a.name};`;else if(a.type==="buffer"){const p=a.node,y=this.getType(p.bufferType),x=p.bufferCount,w=x>0?x:"";c=`${p.name} {
	${y} ${a.name}[${w}];
};
`}else{const p=a.groupNode.name;if(r[p]===void 0){const y=this.uniformGroups[p];if(y!==void 0){const x=[];for(const w of y.uniforms){const C=w.getType(),N=this.getVectorType(C),F=w.nodeUniform.node.precision;let U=`${N} ${w.name};`;F!==null&&(U=C5e[F]+" "+U),x.push("	"+U)}r[p]=x}}d=!0}if(!d){const p=a.node.precision;p!==null&&(c=C5e[p]+" "+c),c="uniform "+c,n.push(c)}}let s="";for(const a in r){const c=r[a];s+=this._getGLSLUniformStruct(a,c.join(`
`))+`
`}return s+=n.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==C0){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let r=0;for(const s of n)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[];for(const n of e.members)t.push(`	${n.type} ${n.name};`);return t.join(`
`)}getStructs(e){const t=[],n=this.structs[e],r=[];for(const s of n)if(s.output)for(const a of s.members)r.push(`layout( location = ${a.index} ) out ${a.type} ${a.name};`);else{let a="struct "+s.name+` {
`;a+=this.getStructMembers(s),a+=`
};
`,t.push(a)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const r of n){e==="compute"&&(r.needsInterpolation=!0);const s=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const a=P5e[r.interpolationType]||r.interpolationType,c=R5e[r.interpolationSampling]||"";t+=`${a} ${c} out ${s} ${r.name};
`}else{const a=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${a}out ${s} ${r.name};
`}else t+=`${s} ${r.name};
`}else if(e==="fragment"){for(const r of n)if(r.needsInterpolation){const s=this.getType(r.type);if(r.interpolationType){const a=P5e[r.interpolationType]||r.interpolationType,c=R5e[r.interpolationSampling]||"";t+=`${a} ${c} in ${s} ${r.name};
`}else{const a=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${a}in ${s} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((n,r)=>n*r,1)}u`}getSubgroupSize(){jt("GLSLNodeBuilder: WebGLBackend does not support the subgroupSize node")}getInvocationSubgroupIndex(){jt("GLSLNodeBuilder: WebGLBackend does not support the invocationSubgroupIndex node")}getSubgroupIndex(){jt("GLSLNodeBuilder: WebGLBackend does not support the subgroupIndex node")}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const r=this.extensions[n]||(this.extensions[n]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:r,behavior:s}of n.values())t.push(`#extension ${r} : ${s}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=A5e[e];if(t===void 0){let n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance";break}if(n!==void 0){const r=this.renderer.backend.extensions;r.has(n)&&(r.get(n),t=!0)}A5e[e]=t}return t}isFlipY(){return!0}getUniformBufferLimit(){const e=this.renderer.backend.gl;return e.getParameter(e.MAX_UNIFORM_BLOCK_SIZE)}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const r=e[n],s=this.getPropertyName(r.attributeNode);s&&(t+=`${r.varyingName} = ${s};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${I5e}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${I5e}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n=`// code

`;n+=this.flowCode[t];const r=this.flowNodes[t],s=r[r.length-1];for(const c of r){const d=this.getFlowData(c),p=c.name;p&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${p}
	`),n+=`${d.code}
	`,c===s&&t!=="compute"&&(n+=`// result
	`,t==="vertex"?(n+="gl_Position = ",n+=`${d.result};`):t==="fragment"&&(c.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${d.result};`)))}const a=e[t];a.extensions=this.getExtensions(t),a.uniforms=this.getUniforms(t),a.attributes=this.getAttributes(t),a.varyings=this.getVaryings(t),a.vars=this.getVars(t),a.structs=this.getStructs(t),a.codes=this.getCodes(t),a.transforms=this.getTransforms(t),a.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,r=null){const s=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);let c=a.uniformGPU;if(c===void 0){const d=e.groupNode,p=d.name,y=this.getBindGroupArray(p,n);if(t==="texture")c=new MD(s.name,s.node,d),y.push(c);else if(t==="cubeTexture"||t==="cubeDepthTexture")c=new rxe(s.name,s.node,d),y.push(c);else if(t==="texture3D")c=new fW(s.name,s.node,d),y.push(c);else if(t==="buffer"){s.name=`buffer${e.id}`;const x=this.getSharedDataFromNode(e);let w=x.buffer;w===void 0&&(e.name=`NodeBuffer_${e.id}`,w=new exe(e,d),w.name=e.name,x.buffer=w),y.push(w),c=w}else{let x=this.uniformGroups[p];x===void 0?(x=new txe(p,d),this.uniformGroups[p]=x,y.push(x)):y.indexOf(x)===-1&&y.push(x),c=this.getNodeUniform(s,t);const w=c.name;x.uniforms.some(N=>N.name===w)||x.addUniform(c)}a.uniformGPU=c}return s}}let qj=null,N_=null;class ixe{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={[tm.RENDER]:null,[tm.COMPUTE]:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}updateSampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}updateTimeStampUID(e){const t=this.get(e),n=this.renderer.info.frame;let r;e.isComputeNode===!0?r="c:"+this.renderer.info.compute.frameCalls:r="r:"+this.renderer.info.render.frameCalls,t.timestampUID=r+":"+e.id+":f"+n}getTimestampUID(e){return this.get(e).timestampUID}getTimestampFrames(e){const t=this.timestampQueryPool[e];return t?t.getTimestampFrames():[]}_getQueryPool(e){const t=e.startsWith("c:")?tm.COMPUTE:tm.RENDER;return this.timestampQueryPool[t]}getTimestamp(e){return this._getQueryPool(e).getTimestamp(e)}hasTimestamp(e){return this._getQueryPool(e).hasTimestamp(e)}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){ns("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t)return;const n=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=n,n}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return qj=qj||new vn,this.renderer.getDrawingBufferSize(qj)}setScissorTest(){}getClearColor(){const e=this.renderer;return N_=N_||new x$,e.getClearColor(N_),N_.getRGB(N_),N_}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:Uve(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${N4} webgpu`),this.domElement=e),e}hasCompatibility(){return!1}initRenderTarget(){}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}deleteBindGroupData(){}dispose(){}}let MKe=0;class CKe{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class AKe{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:r}=n,s=e.array,a=e.usage||r.STATIC_DRAW,c=e.isInterleavedBufferAttribute?e.data:e,d=n.get(c);let p=d.bufferGPU;p===void 0&&(p=this._createBuffer(r,t,s,a),d.bufferGPU=p,d.bufferType=t,d.version=c.version);let y;if(s instanceof Float32Array)y=r.FLOAT;else if(typeof Float16Array<"u"&&s instanceof Float16Array)y=r.HALF_FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?y=r.HALF_FLOAT:y=r.UNSIGNED_SHORT;else if(s instanceof Int16Array)y=r.SHORT;else if(s instanceof Uint32Array)y=r.UNSIGNED_INT;else if(s instanceof Int32Array)y=r.INT;else if(s instanceof Int8Array)y=r.BYTE;else if(s instanceof Uint8Array)y=r.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)y=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let x={bufferGPU:p,bufferType:t,type:y,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:y===r.INT||y===r.UNSIGNED_INT||e.gpuType===C0,id:MKe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const w=this._createBuffer(r,t,s,a);x=new CKe(x,w)}n.set(e,x)}updateAttribute(e){const t=this.backend,{gl:n}=t,r=e.array,s=e.isInterleavedBufferAttribute?e.data:e,a=t.get(s),c=a.bufferType,d=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(c,a.bufferGPU),d.length===0)n.bufferSubData(c,0,r);else{for(let p=0,y=d.length;p<y;p++){const x=d[p];n.bufferSubData(c,x.start*r.BYTES_PER_ELEMENT,r,x.start,x.count)}s.clearUpdateRanges()}n.bindBuffer(c,null),a.version=s.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(r),a=e.array,c=a.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,s);const d=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,d),n.bufferData(n.COPY_WRITE_BUFFER,c,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,c),await t.utils._clientWaitAsync();const p=new e.array.constructor(a.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,d),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,p),n.deleteBuffer(d),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),p.buffer}_createBuffer(e,t,n,r){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,n,r),e.bindBuffer(t,null),s}}let yT,u2;class PKe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthReversed=!1,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;yT={[A0]:e.FUNC_ADD,[Pk]:e.FUNC_SUBTRACT,[Rk]:e.FUNC_REVERSE_SUBTRACT},u2={[Xf]:e.ZERO,[CE]:e.ONE,[AE]:e.SRC_COLOR,[E4]:e.SRC_ALPHA,[Ik]:e.SRC_ALPHA_SATURATE,[NE]:e.DST_COLOR,[RE]:e.DST_ALPHA,[PE]:e.ONE_MINUS_SRC_COLOR,[M4]:e.ONE_MINUS_SRC_ALPHA,[kE]:e.ONE_MINUS_DST_COLOR,[IE]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),n=e.getParameter(e.VIEWPORT);this.currentScissor=new wr().fromArray(t),this.currentViewport=new wr().fromArray(n),this._tempVec4=new wr}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==Ive?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===TH?t.cullFace(t.BACK):e===Nve?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setMRTBlending(e,t,n){const r=this.gl,s=this.backend.drawBuffersIndexedExt;if(!s){ns("WebGPURenderer: Multiple Render Targets (MRT) blending configuration is not fully supported in compatibility mode. The material blending will be used for all render targets.");return}for(let a=0;a<e.length;a++){const c=e[a];let d=null;if(t!==null){const p=t.getBlendMode(c.name);p.blending===SW?d=n:p.blending!==vo&&(d=p)}else d=n;d!==null?this._setMRTBlendingIndex(a,d):s.blendFuncSeparateiOES(a,r.ONE,r.ZERO,r.ONE,r.ZERO)}}_setMRTBlendingIndex(e,t){const{gl:n}=this,r=this.backend.drawBuffersIndexedExt,s=t.blending,a=t.blendSrc,c=t.blendDst,d=t.blendEquation,p=t.premultipliedAlpha;if(s===m4){const y=t.blendSrcAlpha!==null?t.blendSrcAlpha:a,x=t.blendDstAlpha!==null?t.blendDstAlpha:c,w=t.blendEquationAlpha!==null?t.blendEquationAlpha:d;r.blendEquationSeparateiOES(e,yT[d],yT[w]),r.blendFuncSeparateiOES(e,u2[a],u2[c],u2[y],u2[x])}else if(r.blendEquationSeparateiOES(e,n.FUNC_ADD,n.FUNC_ADD),p)switch(s){case rl:r.blendFuncSeparateiOES(e,n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case p2:r.blendFuncSeparateiOES(e,n.ONE,n.ONE,n.ONE,n.ONE);break;case m2:r.blendFuncSeparateiOES(e,n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case g2:r.blendFuncSeparateiOES(e,n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:r.blendFuncSeparateiOES(e,n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break}else switch(s){case rl:r.blendFuncSeparateiOES(e,n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case p2:r.blendFuncSeparateiOES(e,n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case m2:r.blendFuncSeparateiOES(e,n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case g2:r.blendFuncSeparateiOES(e,n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:r.blendFuncSeparateiOES(e,n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break}}setBlending(e,t,n,r,s,a,c,d){const{gl:p}=this;if(e===vo){this.currentBlendingEnabled===!0&&(this.disable(p.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(p.BLEND),this.currentBlendingEnabled=!0),e!==m4){if(e!==this.currentBlending||d!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==A0||this.currentBlendEquationAlpha!==A0)&&(p.blendEquation(p.FUNC_ADD),this.currentBlendEquation=A0,this.currentBlendEquationAlpha=A0),d)switch(e){case rl:p.blendFuncSeparate(p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case p2:p.blendFunc(p.ONE,p.ONE);break;case m2:p.blendFuncSeparate(p.ZERO,p.ONE_MINUS_SRC_COLOR,p.ZERO,p.ONE);break;case g2:p.blendFuncSeparate(p.DST_COLOR,p.ONE_MINUS_SRC_ALPHA,p.ZERO,p.ONE);break;default:jt("WebGLState: Invalid blending: ",e);break}else switch(e){case rl:p.blendFuncSeparate(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case p2:p.blendFuncSeparate(p.SRC_ALPHA,p.ONE,p.ONE,p.ONE);break;case m2:jt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case g2:jt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:jt("WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=d}return}s=s||t,a=a||n,c=c||r,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(p.blendEquationSeparate(yT[t],yT[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(n!==this.currentBlendSrc||r!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||c!==this.currentBlendDstAlpha)&&(p.blendFuncSeparate(u2[n],u2[r],u2[a],u2[c]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=c),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setReversedDepth(e){if(this.currentDepthReversed!==e){const t=this.backend.extensions.get("EXT_clip_control");e?t.clipControlEXT(t.LOWER_LEFT_EXT,t.ZERO_TO_ONE_EXT):t.clipControlEXT(t.LOWER_LEFT_EXT,t.NEGATIVE_ONE_TO_ONE_EXT),this.currentDepthReversed=e}}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthReversed&&(e=UW[e]),this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case JT:t.depthFunc(t.NEVER);break;case eE:t.depthFunc(t.ALWAYS);break;case tE:t.depthFunc(t.LESS);break;case C4:t.depthFunc(t.LEQUAL);break;case nE:t.depthFunc(t.EQUAL);break;case rE:t.depthFunc(t.GEQUAL);break;case iE:t.depthFunc(t.GREATER);break;case sE:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,n,r){const s=this._tempVec4.set(e,t,n,r);if(this.currentScissor.equals(s)===!1){const{gl:a}=this;a.scissor(s.x,s.y,s.z,s.w),this.currentScissor.copy(s)}}viewport(e,t,n,r){const s=this._tempVec4.set(e,t,n,r);if(this.currentViewport.equals(s)===!1){const{gl:a}=this;a.viewport(s.x,s.y,s.z,s.w),this.currentViewport.copy(s)}}setScissorTest(e){const t=this.gl;e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t,n){const{gl:r}=this;e.side===no?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let s=e.side===Ui;t&&(s=!s),this.setFlipSided(s),e.blending===rl&&e.transparent===!1?this.setBlending(vo):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.currentSamples>0?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(let d=0;d<8;d++)d<n?this.enable(12288+d):this.disable(12288+d)}setPolygonOffset(e,t,n){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==n)&&(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const n=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(n.bindVertexArray(e),t!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:r}=this;return r[e]!==t?(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:n}=this;let r=[],s=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const a=e.textures;if(r.length!==a.length||r[0]!==n.COLOR_ATTACHMENT0){for(let c=0,d=a.length;c<d;c++)r[c]=n.COLOR_ATTACHMENT0+c;r.length=a.length,s=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,s=!0);s&&n.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:r,currentTextureSlot:s,currentBoundTextures:a,maxTextures:c}=this;n===void 0&&(s===null?n=r.TEXTURE0+c-1:n=s);let d=a[n];d===void 0&&(d={type:void 0,texture:void 0},a[n]=d),(d.type!==e||d.texture!==t)&&(s!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),d.type=e,d.texture=t)}bindBufferBase(e,t,n){const{gl:r}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==n?(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[s]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,r=n[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class RKe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=il){const{gl:n,extensions:r}=this;let s;const a=Xn.getTransfer(t);if(e===Yi)return n.UNSIGNED_BYTE;if(e===Uk)return n.UNSIGNED_SHORT_4_4_4_4;if(e===Bk)return n.UNSIGNED_SHORT_5_5_5_1;if(e===zk)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===Vk)return n.UNSIGNED_INT_10F_11F_11F_REV;if(e===Z8)return n.BYTE;if(e===Q8)return n.SHORT;if(e===Jf)return n.UNSIGNED_SHORT;if(e===C0)return n.INT;if(e===ys)return n.UNSIGNED_INT;if(e===mo)return n.FLOAT;if(e===Gs)return n.HALF_FLOAT;if(e===IW)return n.ALPHA;if(e===OE)return n.RGB;if(e===$s)return n.RGBA;if(e===al)return n.DEPTH_COMPONENT;if(e===Wl)return n.DEPTH_STENCIL;if(e===LE)return n.RED;if(e===zx)return n.RED_INTEGER;if(e===Oc)return n.RG;if(e===Vx)return n.RG_INTEGER;if(e===Gx)return n.RGBA_INTEGER;if(e===g4||e===v4||e===y4||e===_4)if(a===Wn)if(s=r.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===g4)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===v4)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===y4)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===_4)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=r.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===g4)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===v4)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===y4)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===_4)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===oE||e===aE||e===lE||e===cE)if(s=r.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===oE)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===aE)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===lE)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===cE)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===ix||e===sx||e===ox||e===ax||e===lx||e===o6||e===cx)if(s=r.get("WEBGL_compressed_texture_etc"),s!==null){if(e===ix||e===sx)return a===Wn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===ox)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(e===ax)return s.COMPRESSED_R11_EAC;if(e===lx)return s.COMPRESSED_SIGNED_R11_EAC;if(e===o6)return s.COMPRESSED_RG11_EAC;if(e===cx)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(e===ux||e===dx||e===hx||e===fx||e===px||e===mx||e===gx||e===vx||e===yx||e===_x||e===xx||e===bx||e===Sx||e===wx)if(s=r.get("WEBGL_compressed_texture_astc"),s!==null){if(e===ux)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===dx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===hx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===fx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===px)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===mx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===gx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===vx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===yx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===_x)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===xx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===bx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Sx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===wx)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===Tx)if(s=r.get("EXT_texture_compression_bptc"),s!==null){if(e===Tx)return a===Wn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===Ex||e===Mx||e===a6||e===Cx)if(s=r.get("EXT_texture_compression_rgtc"),s!==null){if(e===Ex)return s.COMPRESSED_RED_RGTC1_EXT;if(e===Mx)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===a6)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===Cx)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===Cu?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,r)=>{function s(){const a=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(t),r();return}if(a===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),n()}s()})}}let N5e=!1,PN,$j,k5e;class IKe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},this._srcFramebuffer=null,this._dstFramebuffer=null,N5e===!1&&(this._init(),N5e=!0)}_init(){const e=this.gl;PN={[bd]:e.REPEAT,[Co]:e.CLAMP_TO_EDGE,[s6]:e.MIRRORED_REPEAT},$j={[Hi]:e.NEAREST,[RW]:e.NEAREST_MIPMAP_NEAREST,[v2]:e.NEAREST_MIPMAP_LINEAR,[Bi]:e.LINEAR,[Z_]:e.LINEAR_MIPMAP_NEAREST,[Tu]:e.LINEAR_MIPMAP_LINEAR},k5e={[kW]:e.NEVER,[FW]:e.ALWAYS,[Gk]:e.LESS,[f6]:e.LEQUAL,[DW]:e.EQUAL,[p6]:e.GEQUAL,[OW]:e.GREATER,[LW]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let n;return e.isCubeTexture===!0?n=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=t.TEXTURE_3D:n=t.TEXTURE_2D,n}getInternalFormat(e,t,n,r,s=!1){const{gl:a,extensions:c}=this;if(e!==null){if(a[e]!==void 0)return a[e];Wt("WebGLBackend: Attempt to use non-existing WebGL internal format '"+e+"'")}let d=t;if(t===a.RED&&(n===a.FLOAT&&(d=a.R32F),n===a.HALF_FLOAT&&(d=a.R16F),n===a.UNSIGNED_BYTE&&(d=a.R8),n===a.UNSIGNED_SHORT&&(d=a.R16),n===a.UNSIGNED_INT&&(d=a.R32UI),n===a.BYTE&&(d=a.R8I),n===a.SHORT&&(d=a.R16I),n===a.INT&&(d=a.R32I)),t===a.RED_INTEGER&&(n===a.UNSIGNED_BYTE&&(d=a.R8UI),n===a.UNSIGNED_SHORT&&(d=a.R16UI),n===a.UNSIGNED_INT&&(d=a.R32UI),n===a.BYTE&&(d=a.R8I),n===a.SHORT&&(d=a.R16I),n===a.INT&&(d=a.R32I)),t===a.RG&&(n===a.FLOAT&&(d=a.RG32F),n===a.HALF_FLOAT&&(d=a.RG16F),n===a.UNSIGNED_BYTE&&(d=a.RG8),n===a.UNSIGNED_SHORT&&(d=a.RG16),n===a.UNSIGNED_INT&&(d=a.RG32UI),n===a.BYTE&&(d=a.RG8I),n===a.SHORT&&(d=a.RG16I),n===a.INT&&(d=a.RG32I)),t===a.RG_INTEGER&&(n===a.UNSIGNED_BYTE&&(d=a.RG8UI),n===a.UNSIGNED_SHORT&&(d=a.RG16UI),n===a.UNSIGNED_INT&&(d=a.RG32UI),n===a.BYTE&&(d=a.RG8I),n===a.SHORT&&(d=a.RG16I),n===a.INT&&(d=a.RG32I)),t===a.RGB){const p=s?Ax:Xn.getTransfer(r);n===a.FLOAT&&(d=a.RGB32F),n===a.HALF_FLOAT&&(d=a.RGB16F),n===a.UNSIGNED_BYTE&&(d=a.RGB8),n===a.UNSIGNED_SHORT&&(d=a.RGB16),n===a.UNSIGNED_INT&&(d=a.RGB32UI),n===a.BYTE&&(d=a.RGB8I),n===a.SHORT&&(d=a.RGB16I),n===a.INT&&(d=a.RGB32I),n===a.UNSIGNED_BYTE&&(d=p===Wn?a.SRGB8:a.RGB8),n===a.UNSIGNED_SHORT_5_6_5&&(d=a.RGB565),n===a.UNSIGNED_SHORT_5_5_5_1&&(d=a.RGB5_A1),n===a.UNSIGNED_SHORT_4_4_4_4&&(d=a.RGB4),n===a.UNSIGNED_INT_5_9_9_9_REV&&(d=a.RGB9_E5),n===a.UNSIGNED_INT_10F_11F_11F_REV&&(d=a.R11F_G11F_B10F)}if(t===a.RGB_INTEGER&&(n===a.UNSIGNED_BYTE&&(d=a.RGB8UI),n===a.UNSIGNED_SHORT&&(d=a.RGB16UI),n===a.UNSIGNED_INT&&(d=a.RGB32UI),n===a.BYTE&&(d=a.RGB8I),n===a.SHORT&&(d=a.RGB16I),n===a.INT&&(d=a.RGB32I)),t===a.RGBA){const p=s?Ax:Xn.getTransfer(r);n===a.FLOAT&&(d=a.RGBA32F),n===a.HALF_FLOAT&&(d=a.RGBA16F),n===a.UNSIGNED_BYTE&&(d=a.RGBA8),n===a.UNSIGNED_SHORT&&(d=a.RGBA16),n===a.UNSIGNED_INT&&(d=a.RGBA32UI),n===a.BYTE&&(d=a.RGBA8I),n===a.SHORT&&(d=a.RGBA16I),n===a.INT&&(d=a.RGBA32I),n===a.UNSIGNED_BYTE&&(d=p===Wn?a.SRGB8_ALPHA8:a.RGBA8),n===a.UNSIGNED_SHORT_4_4_4_4&&(d=a.RGBA4),n===a.UNSIGNED_SHORT_5_5_5_1&&(d=a.RGB5_A1)}return t===a.RGBA_INTEGER&&(n===a.UNSIGNED_BYTE&&(d=a.RGBA8UI),n===a.UNSIGNED_SHORT&&(d=a.RGBA16UI),n===a.UNSIGNED_INT&&(d=a.RGBA32UI),n===a.BYTE&&(d=a.RGBA8I),n===a.SHORT&&(d=a.RGBA16I),n===a.INT&&(d=a.RGBA32I)),t===a.DEPTH_COMPONENT&&(n===a.UNSIGNED_SHORT&&(d=a.DEPTH_COMPONENT16),n===a.UNSIGNED_INT&&(d=a.DEPTH_COMPONENT24),n===a.FLOAT&&(d=a.DEPTH_COMPONENT32F)),t===a.DEPTH_STENCIL&&n===a.UNSIGNED_INT_24_8&&(d=a.DEPTH24_STENCIL8),(d===a.R16F||d===a.R32F||d===a.RG16F||d===a.RG32F||d===a.RGBA16F||d===a.RGBA32F)&&c.get("EXT_color_buffer_float"),d}setTextureParameters(e,t){const{gl:n,extensions:r,backend:s}=this,a=Xn.getPrimaries(Xn.workingColorSpace),c=t.colorSpace===il?null:Xn.getPrimaries(t.colorSpace),d=t.colorSpace===il||a===c?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,d),n.texParameteri(e,n.TEXTURE_WRAP_S,PN[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,PN[t.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||n.texParameteri(e,n.TEXTURE_WRAP_R,PN[t.wrapR])),n.texParameteri(e,n.TEXTURE_MAG_FILTER,$j[t.magFilter]);const p=t.mipmaps!==void 0&&t.mipmaps.length>0,y=t.minFilter===Bi&&p?Tu:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,$j[y]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,k5e[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===Hi||t.minFilter!==v2&&t.minFilter!==Tu||t.type===mo&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const x=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,x.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:r}=this,s=this.getGLTextureType(e);let a=r[s];a===void 0&&(a=t.createTexture(),n.state.bindTexture(s,a),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),r[s]=a),n.set(e,{textureGPU:a,glTextureType:s})}createTexture(e,t){const{gl:n,backend:r}=this,{levels:s,width:a,height:c,depth:d}=t,p=r.utils.convert(e.format,e.colorSpace),y=r.utils.convert(e.type),x=this.getInternalFormat(e.internalFormat,p,y,e.colorSpace,e.isVideoTexture),w=n.createTexture(),C=this.getGLTextureType(e);r.state.bindTexture(C,w),this.setTextureParameters(C,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,s,x,a,c,d):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,s,x,a,c,d):e.isVideoTexture||n.texStorage2D(C,s,x,a,c),r.set(e,{textureGPU:w,glTextureType:C,glFormat:p,glType:y,glInternalFormat:x})}copyBufferToTexture(e,t){const{gl:n,backend:r}=this,{textureGPU:s,glTextureType:a,glFormat:c,glType:d}=r.get(t),{width:p,height:y}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(a,s),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(a,0,0,0,p,y,c,d,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:r,height:s}=t,{textureGPU:a,glTextureType:c,glFormat:d,glType:p,glInternalFormat:y}=this.backend.get(e);if(!(e.isRenderTargetTexture||a===void 0))if(this.backend.state.bindTexture(c,a),this.setTextureParameters(c,e),e.isCompressedTexture){const x=e.mipmaps,w=t.image;for(let C=0;C<x.length;C++){const N=x[C];e.isCompressedArrayTexture?e.format!==n.RGBA?d!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,C,0,0,0,N.width,N.height,w.depth,d,N.data):Wt("WebGLBackend: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,C,0,0,0,N.width,N.height,w.depth,d,p,N.data):d!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,C,0,0,N.width,N.height,d,N.data):Wt("WebGLBackend: Unsupported compressed texture format")}}else if(e.isCubeTexture){const x=t.images,w=e.mipmaps;for(let C=0;C<6;C++){const N=RN(x[C]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+C,0,0,0,r,s,d,p,N);for(let F=0;F<w.length;F++){const U=w[F],R=RN(U.images[C]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+C,F+1,0,0,R.width,R.height,d,p,R)}}}else if(e.isDataArrayTexture||e.isArrayTexture){const x=t.image;if(e.layerUpdates.size>0){const w=UH(x.width,x.height,e.format,e.type);for(const C of e.layerUpdates){const N=x.data.subarray(C*w/x.data.BYTES_PER_ELEMENT,(C+1)*w/x.data.BYTES_PER_ELEMENT);n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,C,x.width,x.height,1,d,p,N)}e.clearLayerUpdates()}else n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,x.width,x.height,x.depth,d,p,x.data)}else if(e.isData3DTexture){const x=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,x.width,x.height,x.depth,d,p,x.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(c,0,y,d,p,t.image);else{const x=e.mipmaps;if(x.length>0)for(let w=0,C=x.length;w<C;w++){const N=x[w],F=RN(N);n.texSubImage2D(c,w,0,0,N.width,N.height,d,p,F)}else{const w=RN(t.image);n.texSubImage2D(c,0,0,0,r,s,d,p,w)}}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:r,glTextureType:s}=n.get(e);n.state.bindTexture(s,r),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const s in r.framebuffers)t.deleteFramebuffer(r.framebuffers[s]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let s=0;s<r.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(r.msaaRenderbuffers[s]);delete r.msaaRenderbuffers}}}destroyTexture(e,t=!1){const{gl:n,backend:r}=this,{textureGPU:s,renderTarget:a}=r.get(e);this.deallocateRenderBuffers(a),t===!1&&n.deleteTexture(s),r.delete(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){const{gl:c,backend:d}=this,{state:p}=this.backend,{textureGPU:y,glTextureType:x,glType:w,glFormat:C}=d.get(t);p.bindTexture(x,y);let N,F,U,R,B,Y,A,ne,se;const oe=e.isCompressedTexture?e.mipmaps[a]:e.image;if(n!==null)N=n.max.x-n.min.x,F=n.max.y-n.min.y,U=n.isBox3?n.max.z-n.min.z:1,R=n.min.x,B=n.min.y,Y=n.isBox3?n.min.z:0;else{const He=Math.pow(2,-s);N=Math.floor(oe.width*He),F=Math.floor(oe.height*He),e.isDataArrayTexture||e.isArrayTexture?U=oe.depth:e.isData3DTexture?U=Math.floor(oe.depth*He):U=1,R=0,B=0,Y=0}r!==null?(A=r.x,ne=r.y,se=r.z):(A=0,ne=0,se=0),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,t.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,t.unpackAlignment);const G=c.getParameter(c.UNPACK_ROW_LENGTH),ie=c.getParameter(c.UNPACK_IMAGE_HEIGHT),Me=c.getParameter(c.UNPACK_SKIP_PIXELS),X=c.getParameter(c.UNPACK_SKIP_ROWS),De=c.getParameter(c.UNPACK_SKIP_IMAGES);c.pixelStorei(c.UNPACK_ROW_LENGTH,oe.width),c.pixelStorei(c.UNPACK_IMAGE_HEIGHT,oe.height),c.pixelStorei(c.UNPACK_SKIP_PIXELS,R),c.pixelStorei(c.UNPACK_SKIP_ROWS,B),c.pixelStorei(c.UNPACK_SKIP_IMAGES,Y);const $e=e.isDataArrayTexture||e.isData3DTexture||t.isArrayTexture,ot=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isDepthTexture){const He=d.get(e),ce=d.get(t),Ge=d.get(He.renderTarget),Ie=d.get(ce.renderTarget),st=Ge.framebuffers[He.cacheKey],bt=Ie.framebuffers[ce.cacheKey];p.bindFramebuffer(c.READ_FRAMEBUFFER,st),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,bt);for(let Ne=0;Ne<U;Ne++)$e&&(c.framebufferTextureLayer(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,He.textureGPU,s,Y+Ne),c.framebufferTextureLayer(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0,y,a,se+Ne)),c.blitFramebuffer(R,B,N,F,A,ne,N,F,c.DEPTH_BUFFER_BIT,c.NEAREST);p.bindFramebuffer(c.READ_FRAMEBUFFER,null),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,null)}else if(s!==0||e.isRenderTargetTexture||d.has(e)){const He=d.get(e);this._srcFramebuffer===null&&(this._srcFramebuffer=c.createFramebuffer()),this._dstFramebuffer===null&&(this._dstFramebuffer=c.createFramebuffer()),p.bindFramebuffer(c.READ_FRAMEBUFFER,this._srcFramebuffer),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,this._dstFramebuffer);for(let ce=0;ce<U;ce++)$e?c.framebufferTextureLayer(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,He.textureGPU,s,Y+ce):c.framebufferTexture2D(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,He.textureGPU,s),ot?c.framebufferTextureLayer(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0,y,a,se+ce):c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,y,a),s!==0?c.blitFramebuffer(R,B,N,F,A,ne,N,F,c.COLOR_BUFFER_BIT,c.NEAREST):ot?c.copyTexSubImage3D(x,a,A,ne,se+ce,R,B,N,F):c.copyTexSubImage2D(x,a,A,ne,R,B,N,F);p.bindFramebuffer(c.READ_FRAMEBUFFER,null),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,null)}else ot?e.isDataTexture||e.isData3DTexture?c.texSubImage3D(x,a,A,ne,se,N,F,U,C,w,oe.data):t.isCompressedArrayTexture?c.compressedTexSubImage3D(x,a,A,ne,se,N,F,U,C,oe.data):c.texSubImage3D(x,a,A,ne,se,N,F,U,C,w,oe):e.isDataTexture?c.texSubImage2D(c.TEXTURE_2D,a,A,ne,N,F,C,w,oe.data):e.isCompressedTexture?c.compressedTexSubImage2D(c.TEXTURE_2D,a,A,ne,oe.width,oe.height,C,oe.data):c.texSubImage2D(c.TEXTURE_2D,a,A,ne,N,F,C,w,oe);c.pixelStorei(c.UNPACK_ROW_LENGTH,G),c.pixelStorei(c.UNPACK_IMAGE_HEIGHT,ie),c.pixelStorei(c.UNPACK_SKIP_PIXELS,Me),c.pixelStorei(c.UNPACK_SKIP_ROWS,X),c.pixelStorei(c.UNPACK_SKIP_IMAGES,De),a===0&&t.generateMipmaps&&c.generateMipmap(x),p.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:r}=this,{state:s}=this.backend,{textureGPU:a}=this.backend.get(e),{x:c,y:d,z:p,w:y}=n,x=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,w=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(x){const C=c!==0||d!==0;let N,F;if(e.isDepthTexture===!0?(N=r.DEPTH_BUFFER_BIT,F=r.DEPTH_ATTACHMENT,t.stencil&&(N|=r.STENCIL_BUFFER_BIT)):(N=r.COLOR_BUFFER_BIT,F=r.COLOR_ATTACHMENT0),C){const U=this.backend.get(t.renderTarget),R=U.framebuffers[t.getCacheKey()],B=U.msaaFrameBuffer;s.bindFramebuffer(r.DRAW_FRAMEBUFFER,R),s.bindFramebuffer(r.READ_FRAMEBUFFER,B);const Y=w-d-y;r.blitFramebuffer(c,Y,c+p,Y+y,c,Y,c+p,Y+y,N,r.NEAREST),s.bindFramebuffer(r.READ_FRAMEBUFFER,R),s.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,c,Y,p,y),s.unbindTexture()}else{const U=r.createFramebuffer();s.bindFramebuffer(r.DRAW_FRAMEBUFFER,U),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,F,r.TEXTURE_2D,a,0),r.blitFramebuffer(0,0,p,y,0,0,p,y,N,r.NEAREST),r.deleteFramebuffer(U)}}else s.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,c,w-y-d,p,y),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,n,r=!1){const{gl:s}=this,a=t.renderTarget,{depthTexture:c,depthBuffer:d,stencilBuffer:p,width:y,height:x}=a;if(s.bindRenderbuffer(s.RENDERBUFFER,e),d&&!p){let w=s.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(s.RENDERBUFFER,a.samples,w,y,x):n>0?(c&&c.isDepthTexture&&c.type===s.FLOAT&&(w=s.DEPTH_COMPONENT32F),s.renderbufferStorageMultisample(s.RENDERBUFFER,n,w,y,x)):s.renderbufferStorage(s.RENDERBUFFER,w,y,x),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e)}else d&&p&&(n>0?s.renderbufferStorageMultisample(s.RENDERBUFFER,n,s.DEPTH24_STENCIL8,y,x):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,y,x),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e));s.bindRenderbuffer(s.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,n,r,s,a){const{backend:c,gl:d}=this,{textureGPU:p,glFormat:y,glType:x}=this.backend.get(e),w=d.createFramebuffer();c.state.bindFramebuffer(d.READ_FRAMEBUFFER,w);const C=e.isCubeTexture?d.TEXTURE_CUBE_MAP_POSITIVE_X+a:d.TEXTURE_2D;d.framebufferTexture2D(d.READ_FRAMEBUFFER,d.COLOR_ATTACHMENT0,C,p,0);const N=this._getTypedArrayType(x),F=this._getBytesPerTexel(x,y),R=r*s*F,B=d.createBuffer();d.bindBuffer(d.PIXEL_PACK_BUFFER,B),d.bufferData(d.PIXEL_PACK_BUFFER,R,d.STREAM_READ),d.readPixels(t,n,r,s,y,x,0),d.bindBuffer(d.PIXEL_PACK_BUFFER,null),await c.utils._clientWaitAsync();const Y=new N(R/N.BYTES_PER_ELEMENT);return d.bindBuffer(d.PIXEL_PACK_BUFFER,B),d.getBufferSubData(d.PIXEL_PACK_BUFFER,0,Y),d.bindBuffer(d.PIXEL_PACK_BUFFER,null),c.state.bindFramebuffer(d.READ_FRAMEBUFFER,null),d.deleteFramebuffer(w),Y}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let r=0;if(e===n.UNSIGNED_BYTE&&(r=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(r=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(r=4),t===n.RGBA)return r*4;if(t===n.RGB)return r*3;if(t===n.ALPHA)return r}dispose(){const{gl:e}=this;this._srcFramebuffer!==null&&e.deleteFramebuffer(this._srcFramebuffer),this._dstFramebuffer!==null&&e.deleteFramebuffer(this._dstFramebuffer)}}function RN(i){return i.isDataTexture?i.image.data:typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?i:i.data}class NKe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class kKe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const D5e={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-s3tc",EXT_texture_compression_bptc:"texture-compression-bc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class DKe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:r,object:s,type:a,info:c,index:d}=this;d!==0?n.drawElements(r,t,a,e):n.drawArrays(r,e,t),c.update(s,t,1)}renderInstances(e,t,n){const{gl:r,mode:s,type:a,index:c,object:d,info:p}=this;n!==0&&(c!==0?r.drawElementsInstanced(s,t,a,e,n):r.drawArraysInstanced(s,e,t,n),p.update(d,t,n))}renderMultiDraw(e,t,n){const{extensions:r,mode:s,object:a,info:c}=this;if(n===0)return;const d=r.get("WEBGL_multi_draw");if(d===null)for(let p=0;p<n;p++)this.render(e[p],t[p]);else{this.index!==0?d.multiDrawElementsWEBGL(s,t,0,this.type,e,0,n):d.multiDrawArraysWEBGL(s,e,0,t,0,n);let p=0;for(let y=0;y<n;y++)p+=t[y];c.update(a,p,1)}}renderMultiDrawInstances(e,t,n,r){const{extensions:s,mode:a,object:c,info:d}=this;if(n===0)return;const p=s.get("WEBGL_multi_draw");if(p===null)for(let y=0;y<n;y++)this.renderInstances(e[y],t[y],r[y]);else{this.index!==0?p.multiDrawElementsInstancedWEBGL(a,t,0,this.type,e,0,r,0,n):p.multiDrawArraysInstancedWEBGL(a,e,0,t,0,r,0,n);let y=0;for(let x=0;x<n;x++)y+=t[x]*r[x];d.update(c,y,1)}}}class sxe{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.frames=[],this.pendingResolve=!1,this.timestamps=new Map}getTimestampFrames(){return this.frames}getTimestamp(e){let t=this.timestamps.get(e);return t===void 0&&(Wt(`TimestampQueryPool: No timestamp available for uid ${e}.`),t=0),t}hasTimestamp(e){return this.timestamps.has(e)}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class OKe extends sxe{constructor(e,t,n=2048){if(super(n),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){Wt("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return ns(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t==null||this.activeQuery!==null)return;const n=this.queries[t];if(n)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){jt("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){jt("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=new Map;for(const[s,a]of this.queryOffsets)if(this.queryStates.get(a)==="ended"){const d=this.queries[a];e.set(s,this.resolveQuery(d))}if(e.size===0)return this.lastValue;const t={},n=[];for(const[s,a]of e){const c=s.match(/^(.*):f(\d+)$/),d=parseInt(c[2]);n.includes(d)===!1&&n.push(d),t[d]===void 0&&(t[d]=0);const p=await a;this.timestamps.set(s,p),t[d]+=p}const r=t[n[n.length-1]];return this.lastValue=r,this.frames=n,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,r}catch(e){return jt("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let n,r=!1;const s=()=>{n&&(clearTimeout(n),n=null)},a=d=>{r||(r=!0,s(),t(d))},c=()=>{if(this.isDisposed){a(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){a(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){n=setTimeout(c,1);return}const y=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(y)/1e6)}catch(d){jt("Error checking query:",d),t(this.lastValue)}};c()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class O5e extends ixe{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,n={antialias:e.currentSamples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",n);function s(a){a.preventDefault();const c={api:"WebGL",message:a.statusMessage||"Unknown reason",reason:null,originalEvent:a};e.onDeviceLost(c)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=r,this.extensions=new NKe(this),this.capabilities=new kKe(this),this.attributeUtils=new AKe(this),this.textureUtils=new IKe(this),this.bufferRenderer=new DKe(this),this.state=new PKe(this),this.utils=new RKe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.extensions.get("EXT_clip_control"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this.drawBuffersIndexedExt=this.extensions.get("OES_draw_buffers_indexed"),t.reversedDepthBuffer===!0&&this.extensions.has("EXT_clip_control")&&this.state.setReversedDepth(!0)}get coordinateSystem(){return ql}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,n=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),n!==null){const s=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:s}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer===!0&&e.multiview===!1&&Wt("WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new OKe(this.gl,e,2048));const n=this.timestampQueryPool[e];n.allocateQueriesForContext(t)!==null&&n.beginQuery(t)}prepareTimestampBuffer(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e].endQuery(t)}getContext(){return this.gl}beginRender(e){const{state:t}=this,n=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:s,height:a}=this.getDrawingBufferSize();t.viewport(0,0,s,a)}if(e.scissor)this.updateScissor(e);else{const{width:s,height:a}=this.getDrawingBufferSize();t.scissor(0,0,s,a)}this.initTimestampQuery(tm.RENDER,this.getTimestampUID(e)),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const r=e.occlusionQueryCount;r>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(r),n.occlusionQueryObjects=new Array(r),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,r=this.get(e),s=r.previousContext;n.resetVertexState();const a=e.occlusionQueryCount;a>0&&(a>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const c=e.textures;if(c!==null)for(let d=0;d<c.length;d++){const p=c[d];p.generateMipmaps&&this.generateMipmaps(p)}if(this._currentContext=s,this._resolveRenderTarget(e),s!==null){if(this._setFramebuffer(s),s.viewport)this.updateViewport(s);else{const{width:d,height:p}=this.getDrawingBufferSize();n.viewport(0,0,d,p)}if(s.scissor)this.updateScissor(s);else{const{width:d,height:p}=this.getDrawingBufferSize();n.scissor(0,0,d,p)}}this.prepareTimestampBuffer(tm.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const s=new WeakSet,{gl:a}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const c=()=>{let d=0;for(let p=0;p<n.length;p++){const y=n[p];y!==null&&a.getQueryParameter(y,a.QUERY_RESULT_AVAILABLE)&&(a.getQueryParameter(y,a.QUERY_RESULT)===0&&s.add(r[p]),n[p]=null,a.deleteQuery(y),d++)}d<n.length?requestAnimationFrame(c):t.occluded=s};c()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:n,y:r,width:s,height:a}=e.viewportValue;t.viewport(n,e.height-a-r,s,a)}updateScissor(e){const{state:t}=this,{x:n,y:r,width:s,height:a}=e.scissorValue;t.scissor(n,e.height-a-r,s,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,n,r=null,s=!0,a=!0){const{gl:c,renderer:d}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let p=0;if(e&&(p|=c.COLOR_BUFFER_BIT),t&&(p|=c.DEPTH_BUFFER_BIT),n&&(p|=c.STENCIL_BUFFER_BIT),p!==0){let y;r.clearColorValue?y=r.clearColorValue:y=this.getClearColor();const x=d.getClearDepth(),w=d.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)c.clearColor(y.r,y.g,y.b,y.a),c.clear(p);else{if(s&&this._setFramebuffer(r),e)for(let C=0;C<r.textures.length;C++)C===0?c.clearBufferfv(c.COLOR,C,[y.r,y.g,y.b,y.a]):c.clearBufferfv(c.COLOR,C,[0,0,0,1]);t&&n?c.clearBufferfi(c.DEPTH_STENCIL,0,x,w):t?c.clearBufferfv(c.DEPTH,0,[x]):n&&c.clearBufferiv(c.STENCIL,0,[w]),s&&a&&this._resolveRenderTarget(r)}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(tm.COMPUTE,this.getTimestampUID(e))}compute(e,t,n,r,s=null){const{state:a,gl:c}=this;this.discard===!1&&(a.enable(c.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:d,transformBuffers:p,attributes:y}=this.get(r),x=this._getVaoKey(y),w=this.vaoCache[x];w===void 0?this.vaoCache[x]=this._createVao(y):a.setVertexState(w),a.useProgram(d),this._bindUniforms(n);const C=this._getTransformFeedback(p);c.bindTransformFeedback(c.TRANSFORM_FEEDBACK,C),c.beginTransformFeedback(c.POINTS),s=s!==null?s:t.count,Array.isArray(s)?(ns("WebGLBackend.compute(): The count parameter must be a single number, not an array."),s=s[0]):s&&typeof s=="object"&&s.isIndirectStorageBufferAttribute&&(ns("WebGLBackend.compute(): The count parameter must be a single number, not IndirectStorageBufferAttribute"),s=t.count),y[0].isStorageInstancedBufferAttribute?c.drawArraysInstanced(c.POINTS,0,1,s):c.drawArrays(c.POINTS,0,s),c.endTransformFeedback(),c.bindTransformFeedback(c.TRANSFORM_FEEDBACK,null);for(let N=0;N<p.length;N++){const F=p[N];F.pbo&&this.has(F.pbo)&&this.textureUtils.copyBufferToTexture(F.transformBuffer,F.pbo),F.switchBuffers()}}finishCompute(e){const{state:t,gl:n}=this;this.discard=!1,t.disable(n.RASTERIZER_DISCARD),this.prepareTimestampBuffer(tm.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:n,material:r,context:s,hardwareClippingPlanes:a}=e,{programGPU:c}=this.get(n),{gl:d,state:p}=this,y=this.get(s),x=e.getDrawParameters();if(x===null)return;this._bindUniforms(e.getBindings());const w=t.isMesh&&t.matrixWorld.determinant()<0;p.setMaterial(r,w,a),s.mrt!==null&&s.textures!==null&&p.setMRTBlending(s.textures,s.mrt,r),p.useProgram(c);const C=e.getAttributes(),N=this.get(C);let F=N.vaoGPU;if(F===void 0){const G=this._getVaoKey(C);F=this.vaoCache[G],F===void 0&&(F=this._createVao(C),this.vaoCache[G]=F,N.vaoGPU=F)}const U=e.getIndex(),R=U!==null?this.get(U).bufferGPU:null;p.setVertexState(F,R);const B=y.lastOcclusionObject;if(B!==t&&B!==void 0){if(B!==null&&B.occlusionTest===!0&&(d.endQuery(d.ANY_SAMPLES_PASSED),y.occlusionQueryIndex++),t.occlusionTest===!0){const G=d.createQuery();d.beginQuery(d.ANY_SAMPLES_PASSED,G),y.occlusionQueries[y.occlusionQueryIndex]=G,y.occlusionQueryObjects[y.occlusionQueryIndex]=t}y.lastOcclusionObject=t}const Y=this.bufferRenderer;t.isPoints?Y.mode=d.POINTS:t.isLineSegments?Y.mode=d.LINES:t.isLine?Y.mode=d.LINE_STRIP:t.isLineLoop?Y.mode=d.LINE_LOOP:r.wireframe===!0?(p.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),Y.mode=d.LINES):Y.mode=d.TRIANGLES;const{vertexCount:A,instanceCount:ne}=x;let{firstVertex:se}=x;if(Y.object=t,U!==null){se*=U.array.BYTES_PER_ELEMENT;const G=this.get(U);Y.index=U.count,Y.type=G.type}else Y.index=0;const oe=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(ns("WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Y.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?Y.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):ns("WebGLBackend: WEBGL_multi_draw not supported."):ne>1?Y.renderInstances(se,A,ne):Y.render(se,A)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const G=this.get(e.camera),ie=e.camera.cameras,Me=e.getBindingGroup("cameraIndex").bindings[0];if(G.indexesGPU===void 0||G.indexesGPU.length!==ie.length){const ce=new Uint32Array([0,0,0,0]),Ge=[];for(let Ie=0,st=ie.length;Ie<st;Ie++){const bt=d.createBuffer();ce[0]=Ie,d.bindBuffer(d.UNIFORM_BUFFER,bt),d.bufferData(d.UNIFORM_BUFFER,ce,d.STATIC_DRAW),Ge.push(bt)}G.indexesGPU=Ge}const X=this.get(Me),De=this.renderer.getPixelRatio(),$e=this._currentContext.renderTarget,ot=this._isRenderCameraDepthArray(this._currentContext),He=this._currentContext.activeCubeFace;if(ot){const ce=this.get($e.depthTexture);if(ce.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){ce.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:Ge}=$e;for(let Ie=0,st=ie.length;Ie<st;Ie++)this.renderer._activeCubeFace=Ie,this._currentContext.activeCubeFace=Ie,this._setFramebuffer(this._currentContext),this.clear(!1,!0,Ge,this._currentContext,!1,!1);this.renderer._activeCubeFace=He,this._currentContext.activeCubeFace=He}}for(let ce=0,Ge=ie.length;ce<Ge;ce++){const Ie=ie[ce];if(t.layers.test(Ie.layers)){ot&&(this.renderer._activeCubeFace=ce,this._currentContext.activeCubeFace=ce,this._setFramebuffer(this._currentContext));const st=Ie.viewport;if(st!==void 0){const bt=st.x*De,Ne=st.y*De,ht=st.width*De,Ot=st.height*De;p.viewport(Math.floor(bt),Math.floor(e.context.height-Ot-Ne),Math.floor(ht),Math.floor(Ot))}p.bindBufferBase(d.UNIFORM_BUFFER,X.index,G.indexesGPU[ce]),oe()}this._currentContext.activeCubeFace=He,this.renderer._activeCubeFace=He}}else oe()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,t=!1){this.textureUtils.destroyTexture(e,t)}async copyTextureToBuffer(e,t,n,r,s,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,s,a)}updateSampler(){return""}createNodeBuilder(e,t){return new EKe(e,t)}createProgram(e){const t=this.gl,{stage:n,code:r}=e,s=n==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,r),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const n=this.gl,r=e.pipeline,{fragmentProgram:s,vertexProgram:a}=r,c=n.createProgram(),d=this.get(s).shaderGPU,p=this.get(a).shaderGPU;if(n.attachShader(c,d),n.attachShader(c,p),n.linkProgram(c),this.set(r,{programGPU:c,fragmentShader:d,vertexShader:p}),t!==null&&this.parallel){const y=new Promise(x=>{const w=this.parallel,C=()=>{n.getProgramParameter(c,w.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),x()):requestAnimationFrame(C)};C()});t.push(y);return}this._completeCompile(e,r)}_handleSource(e,t){const n=e.split(`
`),r=[],s=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let c=s;c<a;c++){const d=c+1;r.push(`${d===t?">":" "} ${d}: ${n[c]}`)}return r.join(`
`)}_getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),a=(e.getShaderInfoLog(t)||"").trim();if(r&&a==="")return"";const c=/ERROR: 0:(\d+)/.exec(a);if(c){const d=parseInt(c[1]);return n.toUpperCase()+`

`+a+`

`+this._handleSource(e.getShaderSource(t),d)}else return a}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const r=this.gl,a=(r.getProgramInfoLog(e)||"").trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,n,t);else{const c=this._getShaderErrors(r,n,"vertex"),d=this._getShaderErrors(r,t,"fragment");jt("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+a+`
`+c+`
`+d)}else a!==""&&Wt("WebGLProgram: Program Info Log:",a)}}_completeCompile(e,t){const{state:n,gl:r}=this,s=this.get(t),{programGPU:a,fragmentShader:c,vertexShader:d}=s;r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,c,d),n.useProgram(a);const p=e.getBindings();this._setupBindings(p,a),this.set(t,{programGPU:a})}createComputePipeline(e,t){const{state:n,gl:r}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:a}=e,c=r.createProgram(),d=this.get(s).shaderGPU,p=this.get(a).shaderGPU,y=a.transforms,x=[],w=[];for(let U=0;U<y.length;U++){const R=y[U];x.push(R.varyingName),w.push(R.attributeNode)}r.attachShader(c,d),r.attachShader(c,p),r.transformFeedbackVaryings(c,x,r.SEPARATE_ATTRIBS),r.linkProgram(c),r.getProgramParameter(c,r.LINK_STATUS)===!1&&this._logProgramError(c,d,p),n.useProgram(c),this._setupBindings(t,c);const C=a.attributes,N=[],F=[];for(let U=0;U<C.length;U++){const R=C[U].node.attribute;N.push(R),this.has(R)||this.attributeUtils.createAttribute(R,r.ARRAY_BUFFER)}for(let U=0;U<w.length;U++){const R=w[U].attribute;this.has(R)||this.attributeUtils.createAttribute(R,r.ARRAY_BUFFER);const B=this.get(R);F.push(B)}this.set(e,{programGPU:c,transformBuffers:F,attributes:N})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let n=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:n});for(const a of s.bindings)a.isUniformBuffer&&n++,a.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let r=n.uniformBuffers,s=n.textures;for(const a of e.bindings){const c=this.get(a);if(a.isUniformsGroup||a.isUniformBuffer){const d=a.buffer;let{bufferGPU:p}=this.get(d);p===void 0?(p=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,p),t.bufferData(t.UNIFORM_BUFFER,d.byteLength,t.DYNAMIC_DRAW),this.set(d,{bufferGPU:p})):t.bindBuffer(t.UNIFORM_BUFFER,p);const y=a.updateRanges;if(t.bindBuffer(t.UNIFORM_BUFFER,p),y.length===0)t.bufferData(t.UNIFORM_BUFFER,d,t.DYNAMIC_DRAW);else{const x=dE(d),w=x?1:d.BYTES_PER_ELEMENT;for(let C=0,N=y.length;C<N;C++){const F=y[C],U=F.start*w,R=F.count*w,B=U*(x?d.BYTES_PER_ELEMENT:1);t.bufferSubData(t.UNIFORM_BUFFER,B,d,U,R)}}c.index=r++,c.bufferGPU=p,this.set(a,c)}else if(a.isSampledTexture){const{textureGPU:d,glTextureType:p}=this.get(a.texture);c.index=s++,c.textureGPU=d,c.glTextureType=p,this.set(a,c)}}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer,a=e.updateRanges;if(t.bindBuffer(t.UNIFORM_BUFFER,r),a.length===0)t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW);else{const c=dE(s),d=c?1:s.BYTES_PER_ELEMENT;for(let p=0,y=a.length;p<y;p++){const x=a[p],w=x.start*d,C=x.count*d,N=w*(c?s.BYTES_PER_ELEMENT:1);t.bufferSubData(t.UNIFORM_BUFFER,N,s,w,C)}}}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(D5e).filter(r=>D5e[r]===e),n=this.extensions;for(let r=0;r<t.length;r++)if(n.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){this.textureUtils.copyTextureToTexture(e,t,n,r,s,a)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}hasCompatibility(e){return e===x4.TEXTURE_COMPARE?!0:super.hasCompatibility(e)}initRenderTarget(e){const{gl:t,state:n}=this;this._setFramebuffer(e),n.bindFramebuffer(t.FRAMEBUFFER,null)}_setFramebuffer(e){const{gl:t,state:n}=this;let r=null;if(e.textures!==null){const s=e.renderTarget,a=this.get(s),{samples:c,depthBuffer:d,stencilBuffer:p}=s,y=s.isCubeRenderTarget===!0,x=s.isRenderTarget3D===!0,w=s.depth>1,C=s.isXRRenderTarget===!0,N=C===!0&&s._hasExternalTextures===!0;let F=a.msaaFrameBuffer,U=a.depthRenderbuffer;const R=this.extensions.get("WEBGL_multisampled_render_to_texture"),B=this.extensions.get("OVR_multiview2"),Y=this._useMultisampledExtension(s),A=Z7e(e);let ne;if(y?(a.cubeFramebuffers||(a.cubeFramebuffers={}),ne=a.cubeFramebuffers[A]):C&&N===!1?ne=this._xrFramebuffer:(a.framebuffers||(a.framebuffers={}),ne=a.framebuffers[A]),ne===void 0){ne=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,ne);const se=e.textures,oe=[];if(y){a.cubeFramebuffers[A]=ne;const{textureGPU:ie}=this.get(se[0]),Me=this.renderer._activeCubeFace,X=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ie,X)}else{a.framebuffers[A]=ne;for(let ie=0;ie<se.length;ie++){const Me=se[ie],X=this.get(Me);X.renderTarget=e.renderTarget,X.cacheKey=A;const De=t.COLOR_ATTACHMENT0+ie;if(s.multiview)B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,De,X.textureGPU,0,c,0,2);else if(x||w){const $e=this.renderer._activeCubeFace,ot=this.renderer._activeMipmapLevel;t.framebufferTextureLayer(t.FRAMEBUFFER,De,X.textureGPU,ot,$e)}else if(Y)R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,De,t.TEXTURE_2D,X.textureGPU,0,c);else{const $e=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,De,t.TEXTURE_2D,X.textureGPU,$e)}}}const G=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const ie=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(ie,e,0,Y),a.xrDepthRenderbuffer=ie,oe.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,ie),t.framebufferRenderbuffer(t.FRAMEBUFFER,G,t.RENDERBUFFER,ie)}else if(e.depthTexture!==null){oe.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const ie=this.get(e.depthTexture);if(ie.renderTarget=e.renderTarget,ie.cacheKey=A,s.multiview)B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,G,ie.textureGPU,0,c,0,2);else if(N&&Y)R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,G,t.TEXTURE_2D,ie.textureGPU,0,c);else if(e.depthTexture.isArrayTexture){const Me=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,G,ie.textureGPU,0,Me)}else if(e.depthTexture.isCubeTexture){const Me=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,G,t.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ie.textureGPU,0)}else t.framebufferTexture2D(t.FRAMEBUFFER,G,t.TEXTURE_2D,ie.textureGPU,0)}a.depthInvalidationArray=oe}else{if(this._isRenderCameraDepthArray(e)){n.bindFramebuffer(t.FRAMEBUFFER,ne);const oe=this.renderer._activeCubeFace,G=this.get(e.depthTexture),ie=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,ie,G.textureGPU,0,oe)}if((C||Y||s.multiview)&&s._isOpaqueFramebuffer!==!0){n.bindFramebuffer(t.FRAMEBUFFER,ne);const oe=this.get(e.textures[0]);s.multiview?B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,oe.textureGPU,0,c,0,2):Y?R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,oe.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,oe.textureGPU,0);const G=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const ie=a.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,ie),t.framebufferRenderbuffer(t.FRAMEBUFFER,G,t.RENDERBUFFER,ie)}else{const ie=this.get(e.depthTexture);s.multiview?B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,G,ie.textureGPU,0,c,0,2):Y?R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,G,t.TEXTURE_2D,ie.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,G,t.TEXTURE_2D,ie.textureGPU,0)}}}if(c>0&&Y===!1&&!s.multiview){if(F===void 0){const se=[];F=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,F);const oe=[],G=e.textures;for(let ie=0;ie<G.length;ie++){oe[ie]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,oe[ie]),se.push(t.COLOR_ATTACHMENT0+ie);const Me=e.textures[ie],X=this.get(Me);t.renderbufferStorageMultisample(t.RENDERBUFFER,c,X.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ie,t.RENDERBUFFER,oe[ie])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),a.msaaFrameBuffer=F,a.msaaRenderbuffers=oe,d&&U===void 0){U=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(U,e,c),a.depthRenderbuffer=U;const ie=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;se.push(ie)}a.invalidationArray=se}r=a.msaaFrameBuffer}else r=ne;n.drawBuffers(e,ne)}n.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let n=0;n<e.length;n++){const r=this.get(e[n]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,n=t.createVertexArray();t.bindVertexArray(n);for(let r=0;r<e.length;r++){const s=e[r],a=this.get(s);t.bindBuffer(t.ARRAY_BUFFER,a.bufferGPU),t.enableVertexAttribArray(r);let c,d;s.isInterleavedBufferAttribute===!0?(c=s.data.stride*a.bytesPerElement,d=s.offset*a.bytesPerElement):(c=0,d=0),a.isInteger?t.vertexAttribIPointer(r,s.itemSize,a.type,c,d):t.vertexAttribPointer(r,s.itemSize,a.type,s.normalized,c,d),s.isInstancedBufferAttribute&&!s.isInterleavedBufferAttribute?t.vertexAttribDivisor(r,s.meshPerAttribute):s.isInterleavedBufferAttribute&&s.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(r,s.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),n}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let n=this.transformFeedbackCache[t];if(n!==void 0)return n;const{gl:r}=this;n=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let s=0;s<e.length;s++){const a=e[s];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,s,a.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const r of e)for(const s of r.bindings){const c=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const d=n.getUniformBlockIndex(t,s.name);n.uniformBlockBinding(t,d,c)}else if(s.isSampledTexture){const d=n.getUniformLocation(t,s.name);n.uniform1i(d,c)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const r of e)for(const s of r.bindings){const a=this.get(s),c=a.index;s.isUniformsGroup||s.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,c,a.bufferGPU):s.isSampledTexture&&n.bindTexture(a.glTextureType,a.textureGPU,t.TEXTURE0+c)}}_resolveRenderTarget(e){const{gl:t,state:n}=this,r=e.renderTarget;if(e.textures!==null&&r){const s=this.get(r);if(r.samples>0&&this._useMultisampledExtension(r)===!1){const a=s.framebuffers[e.getCacheKey()];let c=t.COLOR_BUFFER_BIT;r.resolveDepthBuffer&&(r.depthBuffer&&(c|=t.DEPTH_BUFFER_BIT),r.stencilBuffer&&r.resolveStencilBuffer&&(c|=t.STENCIL_BUFFER_BIT));const d=s.msaaFrameBuffer,p=s.msaaRenderbuffers,y=e.textures,x=y.length>1;if(n.bindFramebuffer(t.READ_FRAMEBUFFER,d),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),x)for(let w=0;w<y.length;w++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+w,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+w,t.TEXTURE_2D,null,0);for(let w=0;w<y.length;w++){if(x){const{textureGPU:C}=this.get(y[w]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,p[w]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,C,0)}if(e.scissor){const{x:C,y:N,width:F,height:U}=e.scissorValue,R=e.height-U-N;t.blitFramebuffer(C,R,C+F,R+U,C,R,C+F,R+U,c,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,c,t.NEAREST)}if(x)for(let w=0;w<y.length;w++){const{textureGPU:C}=this.get(y[w]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+w,t.RENDERBUFFER,p[w]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+w,t.TEXTURE_2D,C,0)}this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,s.invalidationArray)}else if(r.resolveDepthBuffer===!1&&s.framebuffers){const a=s.framebuffers[e.getCacheKey()];n.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,s.depthInvalidationArray)}}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer!==!1}dispose(){this.textureUtils!==null&&this.textureUtils.dispose();const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const IN={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list"},nm=typeof self<"u"&&self.GPUShaderStage?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},Q0={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Rc={Store:"store"},gs={Load:"load",Clear:"clear"},L5e={CCW:"ccw",CW:"cw"},F5e={None:"none",Back:"back"},Tk={Uint16:"uint16",Uint32:"uint32"},je={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rg11b10ufloat",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-unorm-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},Xj={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},Y1={Linear:"linear",Nearest:"nearest"},Li={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},R8={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},U5e={None:0,All:15},Q9={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},Yj={Storage:"storage",ReadOnlyStorage:"read-only-storage"},Kj={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},B5e={NonFiltering:"non-filtering",Comparison:"comparison"},I8={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},z5e={TwoD:"2d",ThreeD:"3d"},jl={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},LKe={All:"all"},NN={Vertex:"vertex",Instance:"instance"},pW={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"},V5e={"texture-compression-s3tc":"texture-compression-bc","texture-compression-etc1":"texture-compression-etc2"};class FKe extends nxe{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class UKe extends Q_e{constructor(e,t){super(e,t?t.array:null),this._attribute=t,this.isStorageBuffer=!0}get attribute(){return this._attribute}}let BKe=0;class zKe extends UKe{constructor(e,t){super("StorageBuffer_"+BKe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:sl.READ_WRITE,this.groupNode=t}get attribute(){return this.nodeUniform.value}get buffer(){return this.nodeUniform.value.array}}class VKe extends F4{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4f,
	@location( 0 ) vTex : vec2f,
	@location( 1 ) @interpolate(flat, either) vBaseArrayLayer: u32,
};

@group( 0 ) @binding ( 2 )
var<uniform> flipY: u32;

@vertex
fn mainVS(
		@builtin( vertex_index ) vertexIndex : u32,
		@builtin( instance_index ) instanceIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array(
		vec2f( -1, -1 ),
		vec2f( -1,  3 ),
		vec2f(  3, -1 ),
	);

	let p = pos[ vertexIndex ];
	let mult = select( vec2f( 0.5, -0.5 ), vec2f( 0.5, 0.5 ), flipY != 0 );
	Varys.vTex = p * mult + vec2f( 0.5 );
	Varys.Position = vec4f( p, 0, 1 );
	Varys.vBaseArrayLayer = instanceIndex;

	return Varys;

}

@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img2d : texture_2d<f32>;

@fragment
fn main_2d( Varys: VarysStruct ) -> @location( 0 ) vec4<f32> {

	return textureSample( img2d, imgSampler, Varys.vTex );

}

@group( 0 ) @binding( 1 )
var img2dArray : texture_2d_array<f32>;

@fragment
fn main_2d_array( Varys: VarysStruct ) -> @location( 0 ) vec4<f32> {

	return textureSample( img2dArray, imgSampler, Varys.vTex, Varys.vBaseArrayLayer );

}

const faceMat = array(
  mat3x3f(  0,  0,  -2,  0, -2,   0,  1,  1,   1 ),   // pos-x
  mat3x3f(  0,  0,   2,  0, -2,   0, -1,  1,  -1 ),   // neg-x
  mat3x3f(  2,  0,   0,  0,  0,   2, -1,  1,  -1 ),   // pos-y
  mat3x3f(  2,  0,   0,  0,  0,  -2, -1, -1,   1 ),   // neg-y
  mat3x3f(  2,  0,   0,  0, -2,   0, -1,  1,   1 ),   // pos-z
  mat3x3f( -2,  0,   0,  0, -2,   0,  1,  1,  -1 ),   // neg-z
);

@group( 0 ) @binding( 1 )
var imgCube : texture_cube<f32>;

@fragment
fn main_cube( Varys: VarysStruct ) -> @location( 0 ) vec4<f32> {

	return textureSample( imgCube, imgSampler, faceMat[ Varys.vBaseArrayLayer ] * vec3f( fract( Varys.vTex ), 1 ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:Y1.Linear}),this.flipYSampler=e.createSampler({minFilter:Y1.Nearest}),this.flipUniformBuffer=e.createBuffer({size:4,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),e.queue.writeBuffer(this.flipUniformBuffer,0,new Uint32Array([1])),this.noFlipUniformBuffer=e.createBuffer({size:4,usage:GPUBufferUsage.UNIFORM}),this.transferPipelines={},this.mipmapShaderModule=e.createShaderModule({label:"mipmap",code:t})}getTransferPipeline(e,t){t=t||"2d-array";const n=`${e}-${t}`;let r=this.transferPipelines[n];return r===void 0&&(r=this.device.createRenderPipeline({label:`mipmap-${e}-${t}`,vertex:{module:this.mipmapShaderModule},fragment:{module:this.mipmapShaderModule,entryPoint:`main_${t.replace("-","_")}`,targets:[{format:e}]},layout:"auto"}),this.transferPipelines[n]=r),r}flipY(e,t,n=0){const r=t.format,{width:s,height:a}=t.size,c=this.device.createTexture({size:{width:s,height:a},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),d=this.getTransferPipeline(r,e.textureBindingViewDimension),p=this.getTransferPipeline(r,c.textureBindingViewDimension),y=this.device.createCommandEncoder({}),x=(w,C,N,F,U,R)=>{const B=w.getBindGroupLayout(0),Y=this.device.createBindGroup({layout:B,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:C.createView({dimension:C.textureBindingViewDimension||"2d-array",baseMipLevel:0,mipLevelCount:1})},{binding:2,resource:{buffer:R?this.flipUniformBuffer:this.noFlipUniformBuffer}}]}),A=y.beginRenderPass({colorAttachments:[{view:F.createView({dimension:"2d",baseMipLevel:0,mipLevelCount:1,baseArrayLayer:U,arrayLayerCount:1}),loadOp:gs.Clear,storeOp:Rc.Store}]});A.setPipeline(w),A.setBindGroup(0,Y),A.draw(3,1,0,N),A.end()};x(d,e,n,c,0,!1),x(p,c,0,e,n,!0),this.device.queue.submit([y.finish()]),c.destroy()}generateMipmaps(e,t=null){const n=this.get(e),r=n.layers||this._mipmapCreateBundles(e),s=t||this.device.createCommandEncoder({label:"mipmapEncoder"});this._mipmapRunBundles(s,r),t===null&&this.device.queue.submit([s.finish()]),n.layers=r}_mipmapCreateBundles(e){const t=e.textureBindingViewDimension||"2d-array",n=this.getTransferPipeline(e.format,t),r=n.getBindGroupLayout(0),s=[];for(let a=1;a<e.mipLevelCount;a++)for(let c=0;c<e.depthOrArrayLayers;c++){const d=this.device.createBindGroup({layout:r,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:e.createView({dimension:t,baseMipLevel:a-1,mipLevelCount:1})},{binding:2,resource:{buffer:this.noFlipUniformBuffer}}]}),p={colorAttachments:[{view:e.createView({dimension:"2d",baseMipLevel:a,mipLevelCount:1,baseArrayLayer:c,arrayLayerCount:1}),loadOp:gs.Clear,storeOp:Rc.Store}]},y=this.device.createRenderBundleEncoder({colorFormats:[e.format]});y.setPipeline(n),y.setBindGroup(0,d),y.draw(3,1,0,c),s.push({renderBundles:[y.finish()],passDescriptor:p})}return s}_mipmapRunBundles(e,t){const n=t.length;for(let r=0;r<n;r++){const s=t[r],a=e.beginRenderPass(s.passDescriptor);a.executeBundles(s.renderBundles),a.end()}}}const GKe={[kW]:"never",[Gk]:"less",[DW]:"equal",[f6]:"less-equal",[OW]:"greater",[p6]:"greater-equal",[FW]:"always",[LW]:"not-equal"},jKe=[0,1,3,2,4,5];class HKe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this._samplerCache=new Map}updateSampler(e){const t=this.backend,n=e.minFilter+"-"+e.magFilter+"-"+e.wrapS+"-"+e.wrapT+"-"+(e.wrapR||"0")+"-"+e.anisotropy+"-"+(e.compareFunction||0);let r=this._samplerCache.get(n);if(r===void 0){const a={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};e.isDepthTexture&&e.compareFunction===null&&(a.magFilter=Y1.Nearest,a.minFilter=Y1.Nearest,a.mipmapFilter=Y1.Nearest),a.magFilter===Y1.Linear&&a.minFilter===Y1.Linear&&a.mipmapFilter===Y1.Linear&&(a.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&t.hasCompatibility(x4.TEXTURE_COMPARE)&&(a.compare=GKe[e.compareFunction]),r={sampler:t.device.createSampler(a),usedTimes:0},this._samplerCache.set(n,r)}const s=t.get(e);if(s.sampler!==r.sampler){if(s.sampler!==void 0){const a=this._samplerCache.get(s.samplerKey);a.usedTimes--,a.usedTimes===0&&this._samplerCache.delete(s.samplerKey)}s.samplerKey=n,s.sampler=r.sampler,r.usedTimes++}return n}createDefaultTexture(e){let t;const n=mW(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture){r.texture=e.sourceTexture,r.initialized=!0;return}t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:a,depth:c,levels:d}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const p=this._getDimension(e),y=e.internalFormat||t.format||mW(e,n.device);r.format=y;const{samples:x,primarySamples:w,isMSAA:C}=n.utils.getTextureSampleData(e);let N=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(N|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&y!==je.RGB9E5UFloat&&(N|=GPUTextureUsage.RENDER_ATTACHMENT);const F={label:e.name,size:{width:s,height:a,depthOrArrayLayers:c},mipLevelCount:d,sampleCount:w,dimension:p,format:y,usage:N};if(y===void 0){Wt("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(F.textureBindingViewDimension=jl.Cube);try{r.texture=n.device.createTexture(F)}catch{Wt("WebGPURenderer: Failed to create texture with descriptor:",F),this.createDefaultTexture(e);return}if(C){const U=Object.assign({},F);U.label=U.label+"-msaa",U.sampleCount=x,U.mipLevelCount=1,r.msaaTexture=n.device.createTexture(U)}r.initialized=!0,r.textureDescriptorGPU=F}destroyTexture(e,t=!1){const n=this.backend,r=n.get(e);r.texture!==void 0&&t===!1&&r.texture.destroy(),r.msaaTexture!==void 0&&r.msaaTexture.destroy(),n.delete(e)}generateMipmaps(e,t=null){const n=this.backend.get(e);this._generateMipmaps(n.texture,t)}getColorBuffer(){const e=this.backend,t=e.renderer.getCanvasTarget(),{width:n,height:r}=e.getDrawingBufferSize(),s=e.renderer.currentSamples,a=t.colorTexture,c=e.get(a);if(a.width===n&&a.height===r&&a.samples===s)return c.texture;let d=c.texture;return d&&d.destroy(),d=e.device.createTexture({label:"colorBuffer",size:{width:n,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.currentSamples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),a.source.width=n,a.source.height=r,a.samples=s,c.texture=d,d}getDepthBuffer(e=!0,t=!1){const n=this.backend,r=n.renderer.getCanvasTarget(),{width:s,height:a}=n.getDrawingBufferSize(),c=n.renderer.currentSamples,d=r.depthTexture;if(d.width===s&&d.height===a&&d.samples===c&&d.depth===e&&d.stencil===t)return n.get(d).texture;const p=n.get(d).texture;let y,x;if(t?(y=Wl,x=Cu):e&&(y=al,x=ys),p!==void 0){if(d.image.width===s&&d.image.height===a&&d.format===y&&d.type===x&&d.samples===c)return p;this.destroyTexture(d)}return d.name="depthBuffer",d.format=y,d.type=x,d.image.width=s,d.image.height=a,d.samples=c,this.createTexture(d,{width:s,height:a}),n.get(d).texture}updateTexture(e,t){const n=this.backend.get(e),r=e.mipmaps,{textureDescriptorGPU:s}=n;if(!(e.isRenderTargetTexture||s===void 0)){if(e.isDataTexture)if(r.length>0)for(let a=0,c=r.length;a<c;a++){const d=r[a];this._copyBufferToTexture(d,n.texture,s,0,e.flipY,0,a)}else this._copyBufferToTexture(t.image,n.texture,s,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let a=0;a<t.image.depth;a++)this._copyBufferToTexture(t.image,n.texture,s,a,e.flipY,a);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,s);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,n.texture,s);else if(r.length>0)for(let a=0,c=r.length;a<c;a++){const d=r[a];this._copyImageToTexture(d,n.texture,s,0,e.flipY,e.premultiplyAlpha,a)}else this._copyImageToTexture(t.image,n.texture,s,0,e.flipY,e.premultiplyAlpha);n.version=e.version}}async copyTextureToBuffer(e,t,n,r,s,a){const c=this.backend.device,d=this.backend.get(e),p=d.texture,y=d.textureDescriptorGPU.format,x=this._getBytesPerTexel(y);let w=r*x;w=Math.ceil(w/256)*256;const C=c.createBuffer({size:(s-1)*w+r*x,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),N=c.createCommandEncoder();N.copyTextureToBuffer({texture:p,origin:{x:t,y:n,z:a}},{buffer:C,bytesPerRow:w},{width:r,height:s});const F=this._getTypedArrayType(y);c.queue.submit([N.finish()]),await C.mapAsync(GPUMapMode.READ);const U=C.getMappedRange();return new F(U)}dispose(){this._samplerCache.clear()}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new ro;n.minFilter=Hi,n.magFilter=Hi,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultCubeTexture[e];if(t===void 0){const n=new g6;n.minFilter=Hi,n.magFilter=Hi,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_copyCubeMapToTexture(e,t,n){const r=e.images,s=e.mipmaps;for(let a=0;a<6;a++){const c=r[a],d=e.flipY===!0?jKe[a]:a;c.isDataTexture?this._copyBufferToTexture(c.image,t,n,d,e.flipY):this._copyImageToTexture(c,t,n,d,e.flipY,e.premultiplyAlpha);for(let p=0;p<s.length;p++){const x=s[p].images[a];x.isDataTexture?this._copyBufferToTexture(x.image,t,n,d,e.flipY,0,p+1):this._copyImageToTexture(x,t,n,d,e.flipY,e.premultiplyAlpha,p+1)}}}_copyImageToTexture(e,t,n,r,s,a,c=0){const d=this.backend.device,p=c>0?e.width:n.size.width,y=c>0?e.height:n.size.height;try{d.queue.copyExternalImageToTexture({source:e,flipY:s},{texture:t,mipLevel:c,origin:{x:0,y:0,z:r},premultipliedAlpha:a},{width:p,height:y,depthOrArrayLayers:1})}catch{}}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new VKe(this.backend.device)),e}_generateMipmaps(e,t=null){this._getPassUtils().generateMipmaps(e,t)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,r,s,a=0,c=0){const d=this.backend.device,p=e.data,y=this._getBytesPerTexel(n.format),x=e.width*y;d.queue.writeTexture({texture:t,mipLevel:c,origin:{x:0,y:0,z:r}},p,{offset:e.width*e.height*y*a,bytesPerRow:x},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,n,r)}_copyCompressedBufferToTexture(e,t,n){const r=this.backend.device,s=this._getBlockData(n.format),a=n.size.depthOrArrayLayers>1;for(let c=0;c<e.length;c++){const d=e[c],p=d.width,y=d.height,x=a?n.size.depthOrArrayLayers:1,w=Math.ceil(p/s.width)*s.byteLength,C=w*Math.ceil(y/s.height);for(let N=0;N<x;N++)r.queue.writeTexture({texture:t,mipLevel:c,origin:{x:0,y:0,z:N}},d.data,{offset:N*C,bytesPerRow:w,rowsPerImage:Math.ceil(y/s.height)},{width:Math.ceil(p/s.width)*s.width,height:Math.ceil(y/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===je.BC1RGBAUnorm||e===je.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===je.BC2RGBAUnorm||e===je.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===je.BC3RGBAUnorm||e===je.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===je.BC4RUnorm||e===je.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===je.BC5RGUnorm||e===je.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===je.BC6HRGBUFloat||e===je.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===je.BC7RGBAUnorm||e===je.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===je.ETC2RGB8Unorm||e===je.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===je.ETC2RGB8A1Unorm||e===je.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===je.ETC2RGBA8Unorm||e===je.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===je.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===je.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===je.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===je.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===je.ASTC4x4Unorm||e===je.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===je.ASTC5x4Unorm||e===je.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===je.ASTC5x5Unorm||e===je.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===je.ASTC6x5Unorm||e===je.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===je.ASTC6x6Unorm||e===je.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===je.ASTC8x5Unorm||e===je.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===je.ASTC8x6Unorm||e===je.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===je.ASTC8x8Unorm||e===je.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===je.ASTC10x5Unorm||e===je.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===je.ASTC10x6Unorm||e===je.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===je.ASTC10x8Unorm||e===je.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===je.ASTC10x10Unorm||e===je.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===je.ASTC12x10Unorm||e===je.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===je.ASTC12x12Unorm||e===je.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=Xj.ClampToEdge;return e===bd?t=Xj.Repeat:e===s6&&(t=Xj.MirrorRepeat),t}_convertFilterMode(e){let t=Y1.Linear;return(e===Hi||e===RW||e===v2)&&(t=Y1.Nearest),t}_getBytesPerTexel(e){if(e===je.R8Unorm||e===je.R8Snorm||e===je.R8Uint||e===je.R8Sint)return 1;if(e===je.R16Uint||e===je.R16Sint||e===je.R16Float||e===je.RG8Unorm||e===je.RG8Snorm||e===je.RG8Uint||e===je.RG8Sint)return 2;if(e===je.R32Uint||e===je.R32Sint||e===je.R32Float||e===je.RG16Uint||e===je.RG16Sint||e===je.RG16Float||e===je.RGBA8Unorm||e===je.RGBA8UnormSRGB||e===je.RGBA8Snorm||e===je.RGBA8Uint||e===je.RGBA8Sint||e===je.BGRA8Unorm||e===je.BGRA8UnormSRGB||e===je.RGB9E5UFloat||e===je.RGB10A2Unorm||e===je.RG11B10UFloat||e===je.Depth32Float||e===je.Depth24Plus||e===je.Depth24PlusStencil8||e===je.Depth32FloatStencil8)return 4;if(e===je.RG32Uint||e===je.RG32Sint||e===je.RG32Float||e===je.RGBA16Uint||e===je.RGBA16Sint||e===je.RGBA16Float)return 8;if(e===je.RGBA32Uint||e===je.RGBA32Sint||e===je.RGBA32Float)return 16}_getTypedArrayType(e){if(e===je.R8Uint)return Uint8Array;if(e===je.R8Sint)return Int8Array;if(e===je.R8Unorm)return Uint8Array;if(e===je.R8Snorm)return Int8Array;if(e===je.RG8Uint)return Uint8Array;if(e===je.RG8Sint)return Int8Array;if(e===je.RG8Unorm)return Uint8Array;if(e===je.RG8Snorm)return Int8Array;if(e===je.RGBA8Uint)return Uint8Array;if(e===je.RGBA8Sint)return Int8Array;if(e===je.RGBA8Unorm||e===je.RGBA8UnormSRGB)return Uint8Array;if(e===je.RGBA8Snorm)return Int8Array;if(e===je.R16Uint)return Uint16Array;if(e===je.R16Sint)return Int16Array;if(e===je.RG16Uint)return Uint16Array;if(e===je.RG16Sint)return Int16Array;if(e===je.RGBA16Uint)return Uint16Array;if(e===je.RGBA16Sint)return Int16Array;if(e===je.R16Float||e===je.RG16Float||e===je.RGBA16Float)return Uint16Array;if(e===je.R32Uint)return Uint32Array;if(e===je.R32Sint)return Int32Array;if(e===je.R32Float)return Float32Array;if(e===je.RG32Uint)return Uint32Array;if(e===je.RG32Sint)return Int32Array;if(e===je.RG32Float)return Float32Array;if(e===je.RGBA32Uint)return Uint32Array;if(e===je.RGBA32Sint)return Int32Array;if(e===je.RGBA32Float)return Float32Array;if(e===je.BGRA8Unorm||e===je.BGRA8UnormSRGB)return Uint8Array;if(e===je.RGB10A2Unorm||e===je.RGB9E5UFloat||e===je.RG11B10UFloat)return Uint32Array;if(e===je.Depth32Float)return Float32Array;if(e===je.Depth24Plus||e===je.Depth24PlusStencil8)return Uint32Array;if(e===je.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.is3DTexture||e.isData3DTexture?t=z5e.ThreeD:t=z5e.TwoD,t}}function mW(i,e=null){const t=i.format,n=i.type,r=i.colorSpace,s=Xn.getTransfer(r);let a;if(i.isCompressedTexture===!0||i.isCompressedArrayTexture===!0)switch(t){case g4:case v4:a=s===Wn?je.BC1RGBAUnormSRGB:je.BC1RGBAUnorm;break;case y4:a=s===Wn?je.BC2RGBAUnormSRGB:je.BC2RGBAUnorm;break;case _4:a=s===Wn?je.BC3RGBAUnormSRGB:je.BC3RGBAUnorm;break;case Ex:a=je.BC4RUnorm;break;case Mx:a=je.BC4RSnorm;break;case a6:a=je.BC5RGUnorm;break;case Cx:a=je.BC5RGSnorm;break;case Tx:a=s===Wn?je.BC7RGBAUnormSRGB:je.BC7RGBAUnorm;break;case sx:case ix:a=s===Wn?je.ETC2RGB8UnormSRGB:je.ETC2RGB8Unorm;break;case ox:a=s===Wn?je.ETC2RGBA8UnormSRGB:je.ETC2RGBA8Unorm;break;case ax:a=je.EACR11Unorm;break;case lx:a=je.EACR11Snorm;break;case o6:a=je.EACRG11Unorm;break;case cx:a=je.EACRG11Snorm;break;case ux:a=s===Wn?je.ASTC4x4UnormSRGB:je.ASTC4x4Unorm;break;case dx:a=s===Wn?je.ASTC5x4UnormSRGB:je.ASTC5x4Unorm;break;case hx:a=s===Wn?je.ASTC5x5UnormSRGB:je.ASTC5x5Unorm;break;case fx:a=s===Wn?je.ASTC6x5UnormSRGB:je.ASTC6x5Unorm;break;case px:a=s===Wn?je.ASTC6x6UnormSRGB:je.ASTC6x6Unorm;break;case mx:a=s===Wn?je.ASTC8x5UnormSRGB:je.ASTC8x5Unorm;break;case gx:a=s===Wn?je.ASTC8x6UnormSRGB:je.ASTC8x6Unorm;break;case vx:a=s===Wn?je.ASTC8x8UnormSRGB:je.ASTC8x8Unorm;break;case yx:a=s===Wn?je.ASTC10x5UnormSRGB:je.ASTC10x5Unorm;break;case _x:a=s===Wn?je.ASTC10x6UnormSRGB:je.ASTC10x6Unorm;break;case xx:a=s===Wn?je.ASTC10x8UnormSRGB:je.ASTC10x8Unorm;break;case bx:a=s===Wn?je.ASTC10x10UnormSRGB:je.ASTC10x10Unorm;break;case Sx:a=s===Wn?je.ASTC12x10UnormSRGB:je.ASTC12x10Unorm;break;case wx:a=s===Wn?je.ASTC12x12UnormSRGB:je.ASTC12x12Unorm;break;case $s:a=s===Wn?je.RGBA8UnormSRGB:je.RGBA8Unorm;break;default:jt("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case $s:switch(n){case Z8:a=je.RGBA8Snorm;break;case Q8:a=je.RGBA16Sint;break;case Jf:a=je.RGBA16Uint;break;case ys:a=je.RGBA32Uint;break;case C0:a=je.RGBA32Sint;break;case Yi:a=s===Wn?je.RGBA8UnormSRGB:je.RGBA8Unorm;break;case Gs:a=je.RGBA16Float;break;case mo:a=je.RGBA32Float;break;default:jt("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case OE:switch(n){case zk:a=je.RGB9E5UFloat;break;case Vk:a=je.RG11B10UFloat;break;default:jt("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case LE:switch(n){case Z8:a=je.R8Snorm;break;case Q8:a=je.R16Sint;break;case Jf:a=je.R16Uint;break;case ys:a=je.R32Uint;break;case C0:a=je.R32Sint;break;case Yi:a=je.R8Unorm;break;case Gs:a=je.R16Float;break;case mo:a=je.R32Float;break;default:jt("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case Oc:switch(n){case Z8:a=je.RG8Snorm;break;case Q8:a=je.RG16Sint;break;case Jf:a=je.RG16Uint;break;case ys:a=je.RG32Uint;break;case C0:a=je.RG32Sint;break;case Yi:a=je.RG8Unorm;break;case Gs:a=je.RG16Float;break;case mo:a=je.RG32Float;break;default:jt("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case al:switch(n){case Jf:a=je.Depth16Unorm;break;case ys:a=je.Depth24Plus;break;case mo:a=je.Depth32Float;break;default:jt("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case Wl:switch(n){case Cu:a=je.Depth24PlusStencil8;break;case mo:e&&e.features.has(pW.Depth32FloatStencil8)===!1&&jt('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),a=je.Depth32FloatStencil8;break;default:jt("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case zx:switch(n){case C0:a=je.R32Sint;break;case ys:a=je.R32Uint;break;default:jt("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case Vx:switch(n){case C0:a=je.RG32Sint;break;case ys:a=je.RG32Uint;break;default:jt("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case Gx:switch(n){case C0:a=je.RGBA32Sint;break;case ys:a=je.RGBA32Uint;break;default:jt("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:jt("WebGPURenderer: Unsupported texture format.",t)}return a}const WKe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,qKe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,G5e={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},$Ke=i=>{i=i.trim();const e=i.match(WKe);if(e!==null&&e.length===4){const t=e[2],n=[];let r=null;for(;(r=qKe.exec(t))!==null;)n.push({name:r[1],type:r[2]});const s=[];for(let y=0;y<n.length;y++){const{name:x,type:w}=n[y];let C=w;C.startsWith("ptr")?C="pointer":(C.startsWith("texture")&&(C=w.split("<")[0]),C=G5e[C]),s.push(new L$(C,x))}const a=i.substring(e[0].length),c=e[3]||"void",d=e[1]!==void 0?e[1]:"";return{type:G5e[c]||c,inputs:s,name:d,inputsCode:t,blockCode:a,outputType:c}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class XKe extends U${constructor(e){const{type:t,inputs:n,name:r,inputsCode:s,blockCode:a,outputType:c}=$Ke(e);super(t,n,r),this.inputsCode=s,this.blockCode=a,this.outputType=c}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class YKe extends Y_e{parseFunction(e){return new XKe(e)}}const KKe={[sl.READ_ONLY]:"read",[sl.WRITE_ONLY]:"write",[sl.READ_WRITE]:"read_write"},j5e={[bd]:"repeat",[Co]:"clamp",[s6]:"mirror"},Zj={vertex:nm.VERTEX,fragment:nm.FRAGMENT,compute:nm.COMPUTE},H5e={instance:!0,swizzleAssign:!1,storageBuffer:!0},ZKe={"^^":"tsl_xor"},QKe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},W5e={},_T={tsl_xor:new Za("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new Za("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new Za("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new Za("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new Za("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new Za("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new Za("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new Za("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new Za("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new Za("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new Za("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new Za("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new Za(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`),biquadraticTextureArray:new Za(`
fn tsl_biquadraticTexture_array( map : texture_2d_array<f32>, coord : vec2f, iRes : vec2u, layer : u32, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, layer, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, layer, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, layer, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, layer, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},JKe={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>",floatpack_snorm_2x16:"pack2x16snorm",floatpack_unorm_2x16:"pack2x16unorm",floatpack_float16_2x16:"pack2x16float",floatunpack_snorm_2x16:"unpack2x16snorm",floatunpack_unorm_2x16:"unpack2x16unorm",floatunpack_float16_2x16:"unpack2x16float"};let oxe="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(oxe+=`diagnostic( off, derivative_uniformity );
`);class eZe extends X_e{constructor(e,t){super(e,t,new YKe),this.uniformGroups={},this.uniformGroupsBindings={},this.builtins={},this.directives={},this.scopedArrays=new Map}_generateTextureSample(e,t,n,r,s,a=this.shaderStage){return a==="fragment"?r?s?`textureSample( ${t}, ${t}_sampler, ${n}, ${r}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${n}, ${r} )`:s?`textureSample( ${t}, ${t}_sampler, ${n}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this.generateTextureSampleLevel(e,t,n,"0",r)}generateTextureSampleLevel(e,t,n,r,s,a){return this.isUnfilterable(e)===!1?s?a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${s}, ${r}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${s}, ${r} )`:a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,a,r,s):this.generateTextureLod(e,t,n,s,a,r)}generateWrapFunction(e){const t=`tsl_coord_${j5e[e.wrapS]}S_${j5e[e.wrapT]}_${e.is3DTexture||e.isData3DTexture?"3d":"2d"}T`;let n=W5e[t];if(n===void 0){const r=[],s=e.is3DTexture||e.isData3DTexture?"vec3f":"vec2f";let a=`fn ${t}( coord : ${s} ) -> ${s} {

	return ${s}(
`;const c=(d,p)=>{d===bd?(r.push(_T.repeatWrapping_float),a+=`		tsl_repeatWrapping_float( coord.${p} )`):d===Co?(r.push(_T.clampWrapping_float),a+=`		tsl_clampWrapping_float( coord.${p} )`):d===s6?(r.push(_T.mirrorWrapping_float),a+=`		tsl_mirrorWrapping_float( coord.${p} )`):(a+=`		coord.${p}`,Wt(`WebGPURenderer: Unsupported texture wrap type "${d}" for vertex shader.`))};c(e.wrapS,"x"),a+=`,
`,c(e.wrapT,"y"),(e.is3DTexture||e.isData3DTexture)&&(a+=`,
`,c(e.wrapR,"z")),a+=`
	);

}
`,W5e[t]=n=new Za(a,r)}return n.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,n){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let s=r.dimensionsSnippet[n];if(r.dimensionsSnippet[n]===void 0){let a,c;const{primarySamples:d}=this.renderer.backend.utils.getTextureSampleData(e),p=d>1;e.is3DTexture||e.isData3DTexture?c="vec3<u32>":c="vec2<u32>",p||e.isStorageTexture?a=t:a=`${t}${n?`, u32( ${n} )`:""}`,s=new XN(new YN(`textureDimensions( ${a} )`,c)),r.dimensionsSnippet[n]=s,(e.isArrayTexture||e.isDataArrayTexture||e.is3DTexture||e.isData3DTexture)&&(r.arrayLayerCount=new XN(new YN(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new XN(new YN("6u","u32")))}return s.build(this)}generateFilteredTexture(e,t,n,r,s="0u",a){const c=this.generateWrapFunction(e),d=this.generateTextureDimension(e,t,s);return r&&(n=`${n} + vec2<f32>(${r}) / ${d}`),a?(this._include("biquadraticTextureArray"),`tsl_biquadraticTexture_array( ${t}, ${c}( ${n} ), ${d}, u32( ${a} ), u32( ${s} ) )`):(this._include("biquadraticTexture"),`tsl_biquadraticTexture( ${t}, ${c}( ${n} ), ${d}, u32( ${s} ) )`)}generateTextureLod(e,t,n,r,s,a="0u"){if(e.isCubeTexture===!0){s&&(n=`${n} + vec3<f32>(${s})`);const C=e.isDepthTexture?"u32":"f32";return`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${C}( ${a} ) )`}const c=this.generateWrapFunction(e),d=this.generateTextureDimension(e,t,a),p=e.is3DTexture||e.isData3DTexture?"vec3":"vec2",y=p==="vec3"?"vec3<u32>( 1, 1, 1 )":"vec2<u32>( 1, 1 )";s&&(n=`${n} + ${p}<f32>(${s}) / ${p}<f32>( ${d} )`);const x=`${p}<f32>( 0 )`,w=`${p}<f32>( ${d} - ${y} )`;return n=`${p}<u32>( clamp( floor( ${c}( ${n} ) * ${p}<f32>( ${d} ) ), ${x}, ${w} ) )`,this.generateTextureLoad(e,t,n,a,r,null)}generateStorageTextureLoad(e,t,n,r,s,a){a&&(n=`${n} + ${a}`);let c;return s?c=`textureLoad( ${t}, ${n}, ${s} )`:c=`textureLoad( ${t}, ${n} )`,c}generateTextureLoad(e,t,n,r,s,a){r===null&&(r="0u"),a&&(n=`${n} + ${a}`);let c;return s?c=`textureLoad( ${t}, ${n}, ${s}, u32( ${r} ) )`:(c=`textureLoad( ${t}, ${n}, u32( ${r} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(c+=".x")),c}generateTextureStore(e,t,n,r,s){let a;return r?a=`textureStore( ${t}, ${n}, ${r}, ${s} )`:a=`textureStore( ${t}, ${n}, ${s} )`,a}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null&&this.renderer.hasCompatibility(x4.TEXTURE_COMPARE)}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===mo||this.isSampleCompare(e)===!1&&e.minFilter===Hi&&e.magFilter===Hi||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,n,r,s,a=this.shaderStage){let c=null;return this.isUnfilterable(e)?c=this.generateTextureLod(e,t,n,r,s,"0",a):c=this._generateTextureSample(e,t,n,r,s,a),c}generateTextureGrad(e,t,n,r,s,a,c=this.shaderStage){if(c==="fragment")return s?a?`textureSampleGrad( ${t}, ${t}_sampler, ${n}, ${s}, ${r[0]}, ${r[1]}, ${a} )`:`textureSampleGrad( ${t}, ${t}_sampler, ${n}, ${s}, ${r[0]}, ${r[1]} )`:a?`textureSampleGrad( ${t}, ${t}_sampler, ${n}, ${r[0]}, ${r[1]}, ${a} )`:`textureSampleGrad( ${t}, ${t}_sampler, ${n}, ${r[0]}, ${r[1]} )`;jt(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${c} shader.`)}generateTextureCompare(e,t,n,r,s,a,c=this.shaderStage){if(c==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?a?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${s}, ${r}, ${a} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${s}, ${r} )`:a?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r} )`;jt(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${c} shader.`)}generateTextureLevel(e,t,n,r,s,a){return this.isUnfilterable(e)===!1?s?a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${s}, ${r}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${s}, ${r} )`:a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,a,r,s):this.generateTextureLod(e,t,n,s,a,r)}generateTextureBias(e,t,n,r,s,a,c=this.shaderStage){if(c==="fragment")return s?a?`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${s}, ${r}, ${a} )`:`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${s}, ${r} )`:a?`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r} )`;jt(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${c} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="cubeDepthTexture"||r==="storageTexture"||r==="texture3D"?n:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?n:n+".value":e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=ZKe[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?e.isAtomic===!0?(Wt("WebGPURenderer: Atomic operations are only supported in compute shaders."),sl.READ_WRITE):sl.READ_ONLY:e.access}getStorageAccess(e,t){return KKe[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,n,r=null){const s=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);if(a.uniformGPU===void 0){let c;const d=e.groupNode,p=d.name,y=this.getBindGroupArray(p,n);if(t==="texture"||t==="cubeTexture"||t==="cubeDepthTexture"||t==="storageTexture"||t==="texture3D"){let x=null;const w=this.getNodeAccess(e,n);if(t==="texture"||t==="storageTexture"?e.value.is3DTexture===!0?x=new fW(s.name,s.node,d,w):x=new MD(s.name,s.node,d,w):t==="cubeTexture"||t==="cubeDepthTexture"?x=new rxe(s.name,s.node,d,w):t==="texture3D"&&(x=new fW(s.name,s.node,d,w)),x.store=e.isStorageTextureNode===!0,x.mipLevel=x.store?e.mipLevel:0,x.setVisibility(Zj[n]),e.value.isCubeTexture===!0||this.isUnfilterable(e.value)===!1&&x.store===!1){const N=new FKe(`${s.name}_sampler`,s.node,d);N.setVisibility(Zj[n]),y.push(N,x),c=[N,x]}else y.push(x),c=[x]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const x=this.getSharedDataFromNode(e);let w=x.buffer;if(w===void 0){const C=t==="buffer"?exe:zKe;w=new C(e,d),x.buffer=w}w.setVisibility(w.getVisibility()|Zj[n]),y.push(w),c=w,s.name=r||"NodeBuffer_"+s.id}else{let x=this.uniformGroups[p];x===void 0&&(x=new txe(p,d),x.setVisibility(nm.VERTEX|nm.FRAGMENT|nm.COMPUTE),this.uniformGroups[p]=x),y.indexOf(x)===-1&&y.push(x),c=this.getNodeUniform(s,t);const w=c.name;x.uniforms.some(N=>N.name===w)||x.addUniform(c)}a.uniformGPU=c}return s}getBuiltin(e,t,n,r=this.shaderStage){const s=this.builtins[r]||(this.builtins[r]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(a.name+" : "+this.getType(a.type));let s=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${n.vars}
${n.code}
`;return n.result&&(s+=`	return ${n.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(n!==void 0)for(const r of n)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],n=this.builtins[e];if(n!==void 0)for(const{name:r,property:s,type:a}of n.values())t.push(`@builtin( ${r} ) ${s} : ${a}`);return t.join(`,
	`)}getScopedArray(e,t,n,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:n,scope:r,bufferType:s,bufferCount:a}of this.scopedArrays.values()){const c=this.getType(s);t.push(`var<${r}> ${n}: array< ${c}, ${a} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&t.push(n);const r=this.getAttributesArray();for(let s=0,a=r.length;s<a;s++){const c=r[s],d=c.name,p=this.getType(c.type);t.push(`@location( ${s} ) ${d} : ${p}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const n of e.members){const r=e.output?"@location( "+n.index+" ) ":"";let s=this.getType(n.type);n.atomic&&(s="atomic< "+s+" >"),t.push(`	${r+n.name} : ${s}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const n=this.structs[e];if(n.length>0){const r=[];for(const s of n){let a=`struct ${s.name} {
`;a+=this.getStructMembers(s),a+=`
};`,r.push(a)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,n=null){let r=`var ${t} : `;return n!==null?r+=this.generateArrayDeclaration(e,n):r+=this.getType(e),r}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","builtinClipSpace","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,a=this.vars[e];for(let c=0;c<s.length;c++){const d=s[c];if(d.needsInterpolation){let p=`@location( ${c} )`;if(d.interpolationType){const y=d.interpolationSampling!==null?`, ${d.interpolationSampling} )`:" )";p+=` @interpolate( ${d.interpolationType}${y}`}else/^(int|uint|ivec|uvec)/.test(d.type)&&(p+=" @interpolate(flat, either)");t.push(`${p} ${d.name} : ${this.getType(d.type)}`)}else e==="vertex"&&a.includes(d)===!1&&a.push(d)}}const n=this.getBuiltins(e);n&&t.push(n);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,n=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&n.structTypeNode!==null,s=n.value&&n.value.array&&typeof n.value.itemSize=="number"&&n.value.array.length>n.value.itemSize;return r&&!s}getUniforms(e){const t=this.uniforms[e],n=[],r=[],s=[],a={};for(const d of t){const p=d.groupNode.name,y=this.bindingsIndexes[p];if(d.type==="texture"||d.type==="cubeTexture"||d.type==="cubeDepthTexture"||d.type==="storageTexture"||d.type==="texture3D"){const x=d.node.value;(x.isCubeTexture===!0||this.isUnfilterable(x)===!1&&d.node.isStorageTextureNode!==!0)&&(this.isSampleCompare(x)?n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${d.name}_sampler : sampler_comparison;`):n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${d.name}_sampler : sampler;`));let C,N="";const{primarySamples:F}=this.renderer.backend.utils.getTextureSampleData(x);if(F>1&&(N="_multisampled"),x.isCubeTexture===!0&&x.isDepthTexture===!0)C="texture_depth_cube";else if(x.isCubeTexture===!0)C="texture_cube<f32>";else if(x.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&x.compareFunction===null?C=`texture${N}_2d<f32>`:C=`texture_depth${N}_2d${x.isArrayTexture===!0?"_array":""}`;else if(d.node.isStorageTextureNode===!0){const U=mW(x),R=this.getStorageAccess(d.node,e),B=d.node.value.is3DTexture,Y=d.node.value.isArrayTexture;C=`texture_storage_${B?"3d":`2d${Y?"_array":""}`}<${U}, ${R}>`}else if(x.isArrayTexture===!0||x.isDataArrayTexture===!0||x.isCompressedArrayTexture===!0)C="texture_2d_array<f32>";else if(x.is3DTexture===!0||x.isData3DTexture===!0)C="texture_3d<f32>";else{const U=this.getComponentTypeFromTexture(x).charAt(0);C=`texture${N}_2d<${U}32>`}n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${d.name} : ${C};`)}else if(d.type==="buffer"||d.type==="storageBuffer"||d.type==="indirectStorageBuffer"){const x=d.node,w=this.getType(x.getNodeType(this)),C=x.bufferCount,N=C>0&&d.type==="buffer"?", "+C:"",F=x.isStorageBufferNode?`storage, ${this.getStorageAccess(x,e)}`:"uniform";if(this.isCustomStruct(d))r.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var<${F}> ${d.name} : ${w};`);else{const R=`	value : array< ${x.isAtomic?`atomic<${w}>`:`${w}`}${N} >`;r.push(this._getWGSLStructBinding(d.name,R,F,y.binding++,y.group))}}else{const x=d.groupNode.name;if(a[x]===void 0){const w=this.uniformGroups[x];if(w!==void 0){const C=[];for(const F of w.uniforms){const U=F.getType(),R=this.getType(this.getVectorType(U));C.push(`	${F.name} : ${R}`)}let N=this.uniformGroupsBindings[x];N===void 0&&(N={index:y.binding++,id:y.group},this.uniformGroupsBindings[x]=N),a[x]={index:N.index,id:N.id,snippets:C}}}}}for(const d in a){const p=a[d];s.push(this._getWGSLStructBinding(d,p.snippets.join(`,
`),"uniform",p.index,p.id))}return[...n,...r,...s].join(`
`)}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const s=this.flowNodes[t],a=s[s.length-1],c=a.outputNode,d=c!==void 0&&c.isOutputStructNode===!0;for(const p of s){const y=this.getFlowData(p),x=p.name;if(x&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${x}
`),r+=`${y.code}
	`,p===a&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.builtinClipSpace = ${y.result};`;else if(t==="fragment")if(d)n.returnType=c.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",r+=`return ${y.result};`;else{let w="	@location(0) color: vec4<f32>";const C=this.getBuiltins("output");C&&(w+=`,
	`+C),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",w),n.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${y.result};

	return output;`}}}n.flow=r}if(this.shaderStage=null,this.material!==null)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{const t=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,t)}}getMethod(e,t=null){let n;return t!==null&&(n=this._getWGSLMethod(e+"_"+t)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getBitcastMethod(e){return`bitcast<${this.getType(e)}>`}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,t,n){return`select( ${n}, ${t}, ${e} )`}getType(e){return QKe[e]||e}isAvailable(e){let t=H5e[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),H5e[e]=t),t}getUniformBufferLimit(){return this.renderer.backend.device.limits.maxUniformBufferBindingSize}_getWGSLMethod(e){return _T[e]!==void 0&&this._include(e),JKe[e]}_include(e){const t=_T[e];return t.build(this),this.addInclude(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${oxe}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){const[n,r,s]=t;return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${n}, ${r}, ${s} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x
		+ globalId.y * ( ${n} * numWorkgroups.x )
		+ globalId.z * ( ${n} * numWorkgroups.x ) * ( ${r} * numWorkgroups.y );

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,n,r=0,s=0){const a=e+"Struct";return`${this._getWGSLStruct(a,t)}
@binding( ${r} ) @group( ${s} )
var<${n}> ${e} : ${a};`}}class tZe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depth&&(e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.stencil?t=je.Depth24PlusStencil8:t=je.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const s=this.backend.renderer,a=s.getRenderTarget();t=a?a.samples:s.currentSamples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const n=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:n?1:t,isMSAA:n}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorFormats(e){return e.textures!==null?e.textures.map(t=>this.getTextureFormatGPU(t)):[this.getPreferredCanvasFormat()]}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return IN.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return IN.LineList;if(e.isLine)return IN.LineStrip;if(e.isMesh)return IN.TriangleList}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.currentSamples)}getPreferredCanvasFormat(){const t=this.backend.parameters.outputType;if(t===void 0)return navigator.gpu.getPreferredCanvasFormat();if(t===Yi)return je.BGRA8Unorm;if(t===Gs)return je.RGBA16Float;throw new Error("Unsupported output buffer type.")}}const axe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);typeof Float16Array<"u"&&axe.set(Float16Array,["float16"]);const nZe=new Map([[Vve,["float16"]]]),rZe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class iZe{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),r=this.backend,s=r.get(n);let a=s.buffer;if(a===void 0){const c=r.device;let d=n.array;if(e.normalized===!1){if(d.constructor===Int16Array||d.constructor===Int8Array)d=new Int32Array(d);else if((d.constructor===Uint16Array||d.constructor===Uint8Array)&&(d=new Uint32Array(d),t&GPUBufferUsage.INDEX))for(let x=0;x<d.length;x++)d[x]===65535&&(d[x]=4294967295)}if(n.array=d,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){d=new d.constructor(n.count*4);for(let x=0;x<n.count;x++)d.set(n.array.subarray(x*3,x*3+3),x*4);n.itemSize=4,n.array=d,s._force3to4BytesAlignment=!0}const p=d.byteLength,y=p+(4-p%4)%4;a=c.createBuffer({label:n.name,size:y,usage:t,mappedAtCreation:!0}),new d.constructor(a.getMappedRange()).set(d),a.unmap(),s.buffer=a}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,r=n.device,s=n.get(t),a=n.get(t).buffer;let c=t.array;if(s._force3to4BytesAlignment===!0){c=new c.constructor(t.count*4);for(let p=0;p<t.count;p++)c.set(t.array.subarray(p*3,p*3+3),p*4);t.array=c}const d=t.updateRanges;if(d.length===0)r.queue.writeBuffer(a,0,c,0);else{const p=dE(c),y=p?1:c.BYTES_PER_ELEMENT;for(let x=0,w=d.length;x<w;x++){const C=d[x];let N,F;if(s._force3to4BytesAlignment===!0){const R=Math.floor(C.start/3),B=Math.ceil(C.count/3);N=R*4*y,F=B*4*y}else N=C.start*y,F=C.count*y;const U=N*(p?c.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(a,U,c,N,F)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let r=0;r<t.length;r++){const s=t[r],a=s.array.BYTES_PER_ELEMENT,c=this._getBufferAttribute(s);let d=n.get(c);if(d===void 0){let x,w;s.isInterleavedBufferAttribute===!0?(x=s.data.stride*a,w=s.data.isInstancedInterleavedBuffer?NN.Instance:NN.Vertex):(x=s.itemSize*a,w=s.isInstancedBufferAttribute?NN.Instance:NN.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(x=4),d={arrayStride:x,attributes:[],stepMode:w},n.set(c,d)}const p=this._getVertexFormat(s),y=s.isInterleavedBufferAttribute===!0?s.offset*a:0;d.attributes.push({shaderLocation:r,offset:y,format:p})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,s=t.get(this._getBufferAttribute(e)).buffer,a=s.size,c=n.createBuffer({label:`${e.name}_readback`,size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),d=n.createCommandEncoder({label:`readback_encoder_${e.name}`});d.copyBufferToBuffer(s,0,c,0,a);const p=d.finish();n.queue.submit([p]),await c.mapAsync(GPUMapMode.READ);const y=c.getMappedRange(),x=new e.array.constructor(y.slice(0));return c.unmap(),x.buffer}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,r=e.array.constructor,s=e.constructor;let a;if(t===1)a=rZe.get(r);else{const d=(nZe.get(s)||axe.get(r))[n?1:0];if(d){const p=r.BYTES_PER_ELEMENT*t,x=Math.floor((p+3)/4)*4/r.BYTES_PER_ELEMENT;if(x%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");a=`${d}x${x}`}}return a||jt("WebGPUAttributeUtils: Vertex format not supported yet."),a}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class sZe{constructor(e){this.layoutGPU=e,this.usedTimes=0}}class oZe{constructor(e){this.backend=e,this._bindGroupLayoutCache=new Map}createBindingsLayout(e){const t=this.backend,n=t.device,r=t.get(e);if(r.layout)return r.layout.layoutGPU;const s=this._createLayoutEntries(e),a=Xx(JSON.stringify(s));let c=this._bindGroupLayoutCache.get(a);return c===void 0&&(c=new sZe(n.createBindGroupLayout({entries:s})),this._bindGroupLayoutCache.set(a,c)),c.usedTimes++,r.layout=c,r.layoutKey=a,c.layoutGPU}createBindings(e,t,n,r=0){const{backend:s}=this,a=s.get(e),c=this.createBindingsLayout(e);let d;n>0&&(a.groups===void 0&&(a.groups=[],a.versions=[]),a.versions[n]===r&&(d=a.groups[n])),d===void 0&&(d=this.createBindGroup(e,c),n>0&&(a.groups[n]=d,a.versions[n]=r)),a.group=d}updateBinding(e){const t=this.backend,n=t.device,r=e.buffer,s=t.get(e).buffer,a=e.updateRanges;if(a.length===0)n.queue.writeBuffer(s,0,r,0);else{const c=dE(r),d=c?1:r.BYTES_PER_ELEMENT;for(let p=0,y=a.length;p<y;p++){const x=a[p],w=x.start*d,C=x.count*d,N=w*(c?r.BYTES_PER_ELEMENT:1);n.queue.writeBuffer(s,N,r,w,C)}}}createBindGroupIndex(e,t){const r=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a=e[0],c=r.createBuffer({label:"bindingCameraIndex_"+a,size:16,usage:s});r.queue.writeBuffer(c,0,e,0);const d=[{binding:0,resource:{buffer:c}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+a,layout:t,entries:d})}createBindGroup(e,t){const n=this.backend,r=n.device;let s=0;const a=[];for(const c of e.bindings){if(c.isUniformBuffer){const d=n.get(c);if(d.buffer===void 0){const p=c.byteLength,y=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,x=[];c.visibility&nm.VERTEX&&x.push("vertex"),c.visibility&nm.FRAGMENT&&x.push("fragment"),c.visibility&nm.COMPUTE&&x.push("compute");const w=`(${x.join(",")})`,C=r.createBuffer({label:`bindingBuffer${c.id}_${c.name}_${w}`,size:p,usage:y});d.buffer=C}a.push({binding:s,resource:{buffer:d.buffer}})}else if(c.isStorageBuffer){const d=n.get(c.attribute).buffer;a.push({binding:s,resource:{buffer:d}})}else if(c.isSampledTexture){const d=n.get(c.texture);let p;if(d.externalTexture!==void 0)p=r.importExternalTexture({source:d.externalTexture});else{const y=c.store?1:d.texture.mipLevelCount,x=c.store?c.mipLevel:0;let w=`view-${d.texture.width}-${d.texture.height}`;if(d.texture.depthOrArrayLayers>1&&(w+=`-${d.texture.depthOrArrayLayers}`),w+=`-${y}-${x}`,p=d[w],p===void 0){const C=LKe.All;let N;c.isSampledCubeTexture?N=jl.Cube:c.isSampledTexture3D?N=jl.ThreeD:c.texture.isArrayTexture||c.texture.isDataArrayTexture||c.texture.isCompressedArrayTexture?N=jl.TwoDArray:N=jl.TwoD,p=d[w]=d.texture.createView({aspect:C,dimension:N,mipLevelCount:y,baseMipLevel:x})}}a.push({binding:s,resource:p})}else if(c.isSampler){const d=n.get(c.texture);a.push({binding:s,resource:d.sampler})}s++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:a})}_createLayoutEntries(e){const t=[];let n=0;for(const r of e.bindings){const s=this.backend,a={binding:n,visibility:r.visibility};if(r.isUniformBuffer||r.isStorageBuffer){const c={};r.isStorageBuffer&&(r.visibility&nm.COMPUTE&&(r.access===sl.READ_WRITE||r.access===sl.WRITE_ONLY)?c.type=Yj.Storage:c.type=Yj.ReadOnlyStorage),a.buffer=c}else if(r.isSampledTexture&&r.store){const c={};c.format=this.backend.get(r.texture).texture.format;const d=r.access;d===sl.READ_WRITE?c.access=Kj.ReadWrite:d===sl.WRITE_ONLY?c.access=Kj.WriteOnly:c.access=Kj.ReadOnly,r.texture.isArrayTexture?c.viewDimension=jl.TwoDArray:r.texture.is3DTexture&&(c.viewDimension=jl.ThreeD),a.storageTexture=c}else if(r.isSampledTexture){const c={},{primarySamples:d}=s.utils.getTextureSampleData(r.texture);if(d>1&&(c.multisampled=!0,r.texture.isDepthTexture||(c.sampleType=I8.UnfilterableFloat)),r.texture.isDepthTexture)s.compatibilityMode&&r.texture.compareFunction===null?c.sampleType=I8.UnfilterableFloat:c.sampleType=I8.Depth;else if(r.texture.isDataTexture||r.texture.isDataArrayTexture||r.texture.isData3DTexture){const p=r.texture.type;p===C0?c.sampleType=I8.SInt:p===ys?c.sampleType=I8.UInt:p===mo&&(this.backend.hasFeature("float32-filterable")?c.sampleType=I8.Float:c.sampleType=I8.UnfilterableFloat)}r.isSampledCubeTexture?c.viewDimension=jl.Cube:r.texture.isArrayTexture||r.texture.isDataArrayTexture||r.texture.isCompressedArrayTexture?c.viewDimension=jl.TwoDArray:r.isSampledTexture3D&&(c.viewDimension=jl.ThreeD),a.texture=c}else if(r.isSampler){const c={};r.texture.isDepthTexture&&(r.texture.compareFunction!==null&&s.hasCompatibility(x4.TEXTURE_COMPARE)?c.type=B5e.Comparison:c.type=B5e.NonFiltering),a.sampler=c}else jt(`WebGPUBindingUtils: Unsupported binding "${r}".`);t.push(a),n++}return t}deleteBindGroupData(e){const{backend:t}=this,n=t.get(e);n.layout&&(n.layout.usedTimes--,n.layout.usedTimes===0&&this._bindGroupLayoutCache.delete(n.layoutKey),n.layout=void 0,n.layoutKey=void 0)}dispose(){this._bindGroupLayoutCache.clear()}}class aZe{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:r,geometry:s,pipeline:a}=e,{vertexProgram:c,fragmentProgram:d}=a,p=this.backend,y=p.device,x=p.utils,w=p.get(a),C=[];for(const $e of e.getBindings()){const ot=p.get($e),{layoutGPU:He}=ot.layout;C.push(He)}const N=p.attributeUtils.createShaderVertexBuffers(e);let F;r.blending!==vo&&(r.blending!==rl||r.transparent!==!1)&&(F=this._getBlending(r));let U={};r.stencilWrite===!0&&(U={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const R=this._getColorWriteMask(r),B=[];if(e.context.textures!==null){const $e=e.context.textures,ot=e.context.mrt;for(let He=0;He<$e.length;He++){const ce=$e[He],Ge=x.getTextureFormatGPU(ce);let Ie;if(ot!==null)if(this.backend.compatibilityMode!==!0){const st=ot.getBlendMode(ce.name);st.blending===SW?Ie=F:st.blending!==vo&&(Ie=this._getBlending(st))}else ns("WebGPURenderer: Multiple Render Targets (MRT) blending configuration is not fully supported in compatibility mode. The material blending will be used for all render targets."),Ie=F;else Ie=F;B.push({format:Ge,blend:Ie,writeMask:R})}}else{const $e=x.getCurrentColorFormat(e.context);B.push({format:$e,blend:F,writeMask:R})}const Y=p.get(c).module,A=p.get(d).module,ne=this._getPrimitiveState(n,s,r),se=this._getDepthCompare(r),oe=x.getCurrentDepthStencilFormat(e.context),G=this._getSampleCount(e.context),ie={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},Y,{buffers:N}),fragment:Object.assign({},A,{targets:B}),primitive:ne,multisample:{count:G,alphaToCoverageEnabled:r.alphaToCoverage&&G>1},layout:y.createPipelineLayout({bindGroupLayouts:C})},Me={},X=e.context.depth,De=e.context.stencil;if((X===!0||De===!0)&&(X===!0&&(Me.format=oe,Me.depthWriteEnabled=r.depthWrite,Me.depthCompare=se),De===!0&&(Me.stencilFront=U,Me.stencilBack=U,Me.stencilReadMask=r.stencilFuncMask,Me.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(Me.depthBias=r.polygonOffsetUnits,Me.depthBiasSlopeScale=r.polygonOffsetFactor,Me.depthBiasClamp=0),ie.depthStencil=Me),y.pushErrorScope("validation"),t===null)w.pipeline=y.createRenderPipeline(ie),y.popErrorScope().then($e=>{$e!==null&&(w.error=!0,jt($e.message))});else{const $e=new Promise(async ot=>{try{w.pipeline=await y.createRenderPipelineAsync(ie)}catch{}const He=await y.popErrorScope();He!==null&&(w.error=!0,jt(He.message)),ot()});t.push($e)}}createBundleEncoder(e,t="renderBundleEncoder"){const n=this.backend,{utils:r,device:s}=n,a=r.getCurrentDepthStencilFormat(e),c=r.getCurrentColorFormats(e),d=this._getSampleCount(e),p={label:t,colorFormats:c,depthStencilFormat:a,sampleCount:d};return s.createRenderBundleEncoder(p)}createComputePipeline(e,t){const n=this.backend,r=n.device,s=n.get(e.computeProgram).module,a=n.get(e),c=[];for(const d of t){const p=n.get(d),{layoutGPU:y}=p.layout;c.push(y)}a.pipeline=r.createComputePipeline({compute:s,layout:r.createPipelineLayout({bindGroupLayouts:c})})}_getBlending(e){let t,n;const r=e.blending,s=e.blendSrc,a=e.blendDst,c=e.blendEquation;if(r===m4){const d=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,p=e.blendDstAlpha!==null?e.blendDstAlpha:a,y=e.blendEquationAlpha!==null?e.blendEquationAlpha:c;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(c)},n={srcFactor:this._getBlendFactor(d),dstFactor:this._getBlendFactor(p),operation:this._getBlendOperation(y)}}else{const d=e.premultipliedAlpha,p=(y,x,w,C)=>{t={srcFactor:y,dstFactor:x,operation:R8.Add},n={srcFactor:w,dstFactor:C,operation:R8.Add}};if(d)switch(r){case rl:p(Li.One,Li.OneMinusSrcAlpha,Li.One,Li.OneMinusSrcAlpha);break;case p2:p(Li.One,Li.One,Li.One,Li.One);break;case m2:p(Li.Zero,Li.OneMinusSrc,Li.Zero,Li.One);break;case g2:p(Li.Dst,Li.OneMinusSrcAlpha,Li.Zero,Li.One);break}else switch(r){case rl:p(Li.SrcAlpha,Li.OneMinusSrcAlpha,Li.One,Li.OneMinusSrcAlpha);break;case p2:p(Li.SrcAlpha,Li.One,Li.One,Li.One);break;case m2:jt(`WebGPURenderer: "SubtractiveBlending" requires "${e.isMaterial?"material":"blendMode"}.premultipliedAlpha = true".`);break;case g2:jt(`WebGPURenderer: "MultiplyBlending" requires "${e.isMaterial?"material":"blendMode"}.premultipliedAlpha = true".`);break}}if(t!==void 0&&n!==void 0)return{color:t,alpha:n};jt("WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case Xf:t=Li.Zero;break;case CE:t=Li.One;break;case AE:t=Li.Src;break;case PE:t=Li.OneMinusSrc;break;case E4:t=Li.SrcAlpha;break;case M4:t=Li.OneMinusSrcAlpha;break;case NE:t=Li.Dst;break;case kE:t=Li.OneMinusDst;break;case RE:t=Li.DstAlpha;break;case IE:t=Li.OneMinusDstAlpha;break;case Ik:t=Li.SrcAlphaSaturated;break;case sHe:t=Li.Constant;break;case oHe:t=Li.OneMinusConstant;break;default:jt("WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case _Ne:t=Q0.Never;break;case AH:t=Q0.Always;break;case xNe:t=Q0.Less;break;case SNe:t=Q0.LessEqual;break;case bNe:t=Q0.Equal;break;case ENe:t=Q0.GreaterEqual;break;case wNe:t=Q0.Greater;break;case TNe:t=Q0.NotEqual;break;default:jt("WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case L8:t=Q9.Keep;break;case hNe:t=Q9.Zero;break;case fNe:t=Q9.Replace;break;case yNe:t=Q9.Invert;break;case pNe:t=Q9.IncrementClamp;break;case mNe:t=Q9.DecrementClamp;break;case gNe:t=Q9.IncrementWrap;break;case vNe:t=Q9.DecrementWrap;break;default:jt("WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case A0:t=R8.Add;break;case Pk:t=R8.Subtract;break;case Rk:t=R8.ReverseSubtract;break;case wW:t=R8.Min;break;case TW:t=R8.Max;break;default:jt("WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const r={},s=this.backend.utils;r.topology=s.getPrimitiveTopology(e,n),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?Tk.Uint16:Tk.Uint32);let a=n.side===Ui;return e.isMesh&&e.matrixWorld.determinant()<0&&(a=!a),r.frontFace=a===!0?L5e.CW:L5e.CCW,r.cullMode=n.side===no?F5e.None:F5e.Back,r}_getColorWriteMask(e){return e.colorWrite===!0?U5e.All:U5e.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=Q0.Always;else{const n=this.backend.parameters.reversedDepthBuffer?UW[e.depthFunc]:e.depthFunc;switch(n){case JT:t=Q0.Never;break;case eE:t=Q0.Always;break;case tE:t=Q0.Less;break;case C4:t=Q0.LessEqual;break;case nE:t=Q0.Equal;break;case rE:t=Q0.GreaterEqual;break;case iE:t=Q0.Greater;break;case sE:t=Q0.NotEqual;break;default:jt("WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class lZe extends sxe{constructor(e,t,n=2048){super(n),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return ns(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,n=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,n);const s=r.finish();if(this.device.queue.submit([s]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,n),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const a=new BigUint64Array(this.resultBuffer.getMappedRange(0,n)),c={},d=[];for(const[y,x]of e){const w=y.match(/^(.*):f(\d+)$/),C=parseInt(w[2]);d.includes(C)===!1&&d.push(C),c[C]===void 0&&(c[C]=0);const N=a[x],F=a[x+1],U=Number(F-N)/1e6;this.timestamps.set(y,U),c[C]+=U}const p=c[d[d.length-1]];return this.resultBuffer.unmap(),this.lastValue=p,this.frames=d,p}catch(e){return jt("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){jt("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){jt("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class cZe extends ixe{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=null,this.device=null,this.defaultRenderPassdescriptor=null,this.utils=new tZe(this),this.attributeUtils=new iZe(this),this.bindingUtils=new oZe(this),this.pipelineUtils=new aZe(this),this.textureUtils=new HKe(this),this.occludedResolveCache=new Map;const t=typeof navigator>"u"?!0:/Android/.test(navigator.userAgent)===!1;this._compatibility={[x4.TEXTURE_COMPARE]:t}}async init(e){await super.init(e);const t=this.parameters;let n;if(t.device===void 0){const r={powerPreference:t.powerPreference,featureLevel:"compatibility"},s=typeof navigator<"u"?await navigator.gpu.requestAdapter(r):null;if(s===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const a=Object.values(pW),c=[];for(const p of a)s.features.has(p)&&c.push(p);const d={requiredFeatures:c,requiredLimits:t.requiredLimits};n=await s.requestDevice(d)}else n=t.device;this.compatibilityMode=!n.features.has("core-features-and-limits"),this.compatibilityMode&&(e._samples=0),n.lost.then(r=>{if(r.reason==="destroyed")return;const s={api:"WebGPU",message:r.message||"Unknown reason",reason:r.reason||null,originalEvent:r};e.onDeviceLost(s)}),this.device=n,this.trackTimestamp=this.trackTimestamp&&this.hasFeature(pW.TimestampQuery),this.updateSize()}get context(){const e=this.renderer.getCanvasTarget(),t=this.get(e);let n=t.context;if(n===void 0){const r=this.parameters;e.isDefaultCanvasTarget===!0&&r.context!==void 0?n=r.context:n=e.domElement.getContext("webgpu"),"setAttribute"in e.domElement&&e.domElement.setAttribute("data-engine",`three.js r${N4} webgpu`);const s=r.alpha?"premultiplied":"opaque",a=r.outputType===Gs?"extended":"standard";n.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s,toneMapping:{mode:a}}),t.context=n}return n}get coordinateSystem(){return Sd}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){const e=this.renderer,t=e.getCanvasTarget(),n=this.get(t),r=e.currentSamples;let s=n.descriptor;if(s===void 0||n.samples!==r){s={colorAttachments:[{view:null}]},(e.depth===!0||e.stencil===!0)&&(s.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(e.depth,e.stencil).createView()});const c=s.colorAttachments[0];r>0?c.view=this.textureUtils.getColorBuffer().createView():c.resolveTarget=void 0,n.descriptor=s,n.samples=r}const a=s.colorAttachments[0];return r>0?a.resolveTarget=this.context.getCurrentTexture().createView():a.view=this.context.getCurrentTexture().createView(),s}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const n=e.renderTarget,r=this.get(n);let s=r.descriptors;(s===void 0||r.width!==n.width||r.height!==n.height||r.samples!==n.samples)&&(s={},r.descriptors=s);const a=e.getCacheKey();let c=s[a];if(c===void 0){const p=e.textures,y=[];let x;const w=this._isRenderCameraDepthArray(e);for(let C=0;C<p.length;C++){const N=this.get(p[C]),F={label:`colorAttachment_${C}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:jl.TwoD};if(n.isRenderTarget3D)x=e.activeCubeFace,F.baseArrayLayer=0,F.dimension=jl.ThreeD,F.depthOrArrayLayers=p[C].image.depth;else if(n.isRenderTarget&&p[C].image.depth>1)if(w===!0){const U=e.camera.cameras;for(let R=0;R<U.length;R++){const B={...F,baseArrayLayer:R,arrayLayerCount:1,dimension:jl.TwoD},Y=N.texture.createView(B);y.push({view:Y,resolveTarget:void 0,depthSlice:void 0})}}else F.dimension=jl.TwoDArray,F.depthOrArrayLayers=p[C].image.depth;if(w!==!0){const U=N.texture.createView(F);let R,B;N.msaaTexture!==void 0?(R=N.msaaTexture.createView(),B=U):(R=U,B=void 0),y.push({view:R,resolveTarget:B,depthSlice:x})}}if(c={textureViews:y},e.depth){const C=this.get(e.depthTexture),N={};(e.depthTexture.isArrayTexture||e.depthTexture.isCubeTexture)&&(N.dimension=jl.TwoD,N.arrayLayerCount=1,N.baseArrayLayer=e.activeCubeFace),c.depthStencilView=C.texture.createView(N)}s[a]=c,r.width=n.width,r.height=n.height,r.samples=n.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace}const d={colorAttachments:[]};for(let p=0;p<c.textureViews.length;p++){const y=c.textureViews[p];let x={r:0,g:0,b:0,a:1};p===0&&t.clearValue&&(x=t.clearValue),d.colorAttachments.push({view:y.view,depthSlice:y.depthSlice,resolveTarget:y.resolveTarget,loadOp:t.loadOp||gs.Load,storeOp:t.storeOp||Rc.Store,clearValue:x})}return c.depthStencilView&&(d.depthStencilAttachment={view:c.depthStencilView}),d}beginRender(e){const t=this.get(e),n=this.device,r=e.occlusionQueryCount;let s;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=n.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let a;e.textures===null?a=this._getDefaultRenderPassDescriptor():a=this._getRenderPassDescriptor(e,{loadOp:gs.Load}),this.initTimestampQuery(tm.RENDER,this.getTimestampUID(e),a),a.occlusionQuerySet=s;const c=a.depthStencilAttachment;if(e.textures!==null){const p=a.colorAttachments;for(let y=0;y<p.length;y++){const x=p[y];e.clearColor?(x.clearValue=y===0?e.clearColorValue:{r:0,g:0,b:0,a:1},x.loadOp=gs.Clear):x.loadOp=gs.Load,x.storeOp=Rc.Store}}else{const p=a.colorAttachments[0];e.clearColor?(p.clearValue=e.clearColorValue,p.loadOp=gs.Clear):p.loadOp=gs.Load,p.storeOp=Rc.Store}e.depth&&(e.clearDepth?(c.depthClearValue=e.clearDepthValue,c.depthLoadOp=gs.Clear):c.depthLoadOp=gs.Load,c.depthStoreOp=Rc.Store),e.stencil&&(e.clearStencil?(c.stencilClearValue=e.clearStencilValue,c.stencilLoadOp=gs.Clear):c.stencilLoadOp=gs.Load,c.stencilStoreOp=Rc.Store);const d=n.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const p=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==p.length?this._createDepthLayerDescriptors(e,t,a,p):this._updateDepthLayerDescriptors(e,t,p),t.bundleEncoders=[],t.bundleSets=[];for(let y=0;y<p.length;y++){const x=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+y),w={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(x),t.bundleSets.push(w)}t.currentPass=null}else{const p=d.beginRenderPass(a);t.currentPass=p,e.viewport&&this.updateViewport(e),e.scissor&&this.updateScissor(e)}t.descriptor=a,t.encoder=d,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,n,r){const s=n.depthStencilAttachment;t.layerDescriptors=[];const a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let c=0;c<r.length;c++){const d={...n,colorAttachments:[{...n.colorAttachments[0],view:n.colorAttachments[c].view}]};if(n.depthStencilAttachment){const p=c;a.viewCache[p]||(a.viewCache[p]=a.texture.createView({dimension:jl.TwoD,baseArrayLayer:c,arrayLayerCount:1})),d.depthStencilAttachment={view:a.viewCache[p],depthLoadOp:s.depthLoadOp||gs.Clear,depthStoreOp:s.depthStoreOp||Rc.Store,depthClearValue:s.depthClearValue||1},e.stencil&&(d.depthStencilAttachment.stencilLoadOp=s.stencilLoadOp,d.depthStencilAttachment.stencilStoreOp=s.stencilStoreOp,d.depthStencilAttachment.stencilClearValue=s.stencilClearValue)}else d.depthStencilAttachment={...s};t.layerDescriptors.push(d)}}_updateDepthLayerDescriptors(e,t,n){for(let r=0;r<n.length;r++){const s=t.layerDescriptors[r];if(s.depthStencilAttachment){const a=s.depthStencilAttachment;e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=gs.Clear):a.depthLoadOp=gs.Load),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=gs.Clear):a.stencilLoadOp=gs.Load)}}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const s=[];for(let a=0;a<t.bundleEncoders.length;a++){const c=t.bundleEncoders[a];s.push(c.finish())}for(let a=0;a<t.layerDescriptors.length;a++)if(a<s.length){const c=t.layerDescriptors[a],d=r.beginRenderPass(c);if(e.viewport){const{x:p,y,width:x,height:w,minDepth:C,maxDepth:N}=e.viewportValue;d.setViewport(p,y,x,w,C,N)}if(e.scissor){const{x:p,y,width:x,height:w}=e.scissorValue;d.setScissorRect(p,y,x,w)}d.executeBundles([s[a]]),d.end()}}else t.currentPass&&t.currentPass.end();if(n>0){const s=n*8;let a=this.occludedResolveCache.get(s);a===void 0&&(a=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,a));const c=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,a,0),t.encoder.copyBufferToBuffer(a,0,c,0,s),t.occlusionQueryBuffer=c,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const s=e.textures;for(let a=0;a<s.length;a++){const c=s[a];c.generateMipmaps===!0&&this.textureUtils.generateMipmaps(c)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const a=n.getMappedRange(),c=new BigUint64Array(a);for(let d=0;d<r.length;d++)c[d]===BigInt(0)&&s.add(r[d]);n.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:s,height:a,minDepth:c,maxDepth:d}=e.viewportValue;t.setViewport(n,r,s,a,c,d)}updateScissor(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:s,height:a}=e.scissorValue;t.setScissorRect(n,r,s,a)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,n,r=null){const s=this.device,a=this.renderer;let c=[],d,p,y,x;if(e){const N=this.getClearColor();p={r:N.r,g:N.g,b:N.b,a:N.a}}if(r===null){y=a.depth,x=a.stencil;const N=this._getDefaultRenderPassDescriptor();if(e){c=N.colorAttachments;const F=c[0];F.clearValue=p,F.loadOp=gs.Clear,F.storeOp=Rc.Store}(y||x)&&(d=N.depthStencilAttachment)}else{y=r.depth,x=r.stencil;const N={loadOp:e?gs.Clear:gs.Load,clearValue:e?p:void 0};y&&(N.depthLoadOp=t?gs.Clear:gs.Load,N.depthClearValue=t?a.getClearDepth():void 0,N.depthStoreOp=Rc.Store),x&&(N.stencilLoadOp=n?gs.Clear:gs.Load,N.stencilClearValue=n?a.getClearStencil():void 0,N.stencilStoreOp=Rc.Store);const F=this._getRenderPassDescriptor(r,N);c=F.colorAttachments,d=F.depthStencilAttachment}y&&d&&(t?(d.depthLoadOp=gs.Clear,d.depthClearValue=a.getClearDepth(),d.depthStoreOp=Rc.Store):(d.depthLoadOp=gs.Load,d.depthStoreOp=Rc.Store)),x&&d&&(n?(d.stencilLoadOp=gs.Clear,d.stencilClearValue=a.getClearStencil(),d.stencilStoreOp=Rc.Store):(d.stencilLoadOp=gs.Load,d.stencilStoreOp=Rc.Store));const w=s.createCommandEncoder({label:"clear"});w.beginRenderPass({colorAttachments:c,depthStencilAttachment:d}).end(),s.queue.submit([w.finish()])}beginCompute(e){const t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(tm.COMPUTE,this.getTimestampUID(e),n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,r,s=null){const a=this.get(t),{passEncoderGPU:c}=this.get(e),d=this.get(r).pipeline;this.pipelineUtils.setPipeline(c,d);for(let p=0,y=n.length;p<y;p++){const x=n[p],w=this.get(x);c.setBindGroup(p,w.group)}if(s===null&&(s=t.count),s&&typeof s=="object"&&s.isIndirectStorageBufferAttribute){const p=this.get(s).buffer;c.dispatchWorkgroupsIndirect(p,0);return}if(typeof s=="number"){const p=s;if(a.dispatchSize===void 0||a.count!==p){a.dispatchSize=[0,1,1],a.count=p;const y=t.workgroupSize;let x=y[0];for(let N=1;N<y.length;N++)x*=y[N];const w=Math.ceil(p/x),C=this.device.limits.maxComputeWorkgroupsPerDimension;s=[w,1,1],w>C&&(s[0]=Math.min(w,C),s[1]=Math.ceil(w/C)),a.dispatchSize=s}s=a.dispatchSize}c.dispatchWorkgroups(s[0],s[1]||1,s[2]||1)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}draw(e,t){const{object:n,material:r,context:s,pipeline:a}=e,c=e.getBindings(),d=this.get(s),p=this.get(a),y=p.pipeline;if(p.error===!0)return;const x=e.getIndex(),w=x!==null,C=e.getDrawParameters();if(C===null)return;const N=(U,R)=>{this.pipelineUtils.setPipeline(U,y),R.pipeline=y;const B=R.bindingGroups;for(let A=0,ne=c.length;A<ne;A++){const se=c[A],oe=this.get(se);B[se.index]!==se.id&&(U.setBindGroup(se.index,oe.group),B[se.index]=se.id)}if(w===!0&&R.index!==x){const A=this.get(x).buffer,ne=x.array instanceof Uint16Array?Tk.Uint16:Tk.Uint32;U.setIndexBuffer(A,ne),R.index=x}const Y=e.getVertexBuffers();for(let A=0,ne=Y.length;A<ne;A++){const se=Y[A];if(R.attributes[A]!==se){const oe=this.get(se).buffer;U.setVertexBuffer(A,oe),R.attributes[A]=se}}s.stencil===!0&&r.stencilWrite===!0&&d.currentStencilRef!==r.stencilRef&&(U.setStencilReference(r.stencilRef),d.currentStencilRef=r.stencilRef)},F=(U,R)=>{if(N(U,R),n.isBatchedMesh===!0){const B=n._multiDrawStarts,Y=n._multiDrawCounts,A=n._multiDrawCount,ne=n._multiDrawInstances;ne!==null&&ns("WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");let se=w===!0?x.array.BYTES_PER_ELEMENT:1;r.wireframe&&(se=n.geometry.attributes.position.count>65535?4:2);for(let oe=0;oe<A;oe++){const G=ne?ne[oe]:1,ie=G>1?0:oe;w===!0?U.drawIndexed(Y[oe],G,B[oe]/se,0,ie):U.draw(Y[oe],G,B[oe],ie),t.update(n,Y[oe],G)}}else if(w===!0){const{vertexCount:B,instanceCount:Y,firstVertex:A}=C,ne=e.getIndirect();if(ne!==null){const se=this.get(ne).buffer,oe=e.getIndirectOffset(),G=Array.isArray(oe)?oe:[oe];for(let ie=0;ie<G.length;ie++)U.drawIndexedIndirect(se,G[ie])}else U.drawIndexed(B,Y,A,0,0);t.update(n,B,Y)}else{const{vertexCount:B,instanceCount:Y,firstVertex:A}=C,ne=e.getIndirect();if(ne!==null){const se=this.get(ne).buffer,oe=e.getIndirectOffset(),G=Array.isArray(oe)?oe:[oe];for(let ie=0;ie<G.length;ie++)U.drawIndirect(se,G[ie])}else U.draw(B,Y,A,0);t.update(n,B,Y)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const U=this.get(e.camera),R=e.camera.cameras,B=e.getBindingGroup("cameraIndex");if(U.indexesGPU===void 0||U.indexesGPU.length!==R.length){const A=this.get(B),ne=[],se=new Uint32Array([0,0,0,0]);for(let oe=0,G=R.length;oe<G;oe++){se[0]=oe;const{layoutGPU:ie}=A.layout,Me=this.bindingUtils.createBindGroupIndex(se,ie);ne.push(Me)}U.indexesGPU=ne}const Y=this.renderer.getPixelRatio();for(let A=0,ne=R.length;A<ne;A++){const se=R[A];if(n.layers.test(se.layers)){const oe=se.viewport;let G=d.currentPass,ie=d.currentSets;if(d.bundleEncoders){const Me=d.bundleEncoders[A],X=d.bundleSets[A];G=Me,ie=X}oe&&G.setViewport(Math.floor(oe.x*Y),Math.floor(oe.y*Y),Math.floor(oe.width*Y),Math.floor(oe.height*Y),s.viewportValue.minDepth,s.viewportValue.maxDepth),B&&U.indexesGPU&&(G.setBindGroup(B.index,U.indexesGPU[A]),ie.bindingGroups[B.index]=B.id),F(G,ie)}}}else if(d.currentPass){if(d.occlusionQuerySet!==void 0){const U=d.lastOcclusionObject;U!==n&&(U!==null&&U.occlusionTest===!0&&(d.currentPass.endOcclusionQuery(),d.occlusionQueryIndex++),n.occlusionTest===!0&&(d.currentPass.beginOcclusionQuery(d.occlusionQueryIndex),d.occlusionQueryObjects[d.occlusionQueryIndex]=n),d.lastOcclusionObject=n)}F(d.currentPass,d.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:r}=e,s=this.utils,a=s.getSampleCountRenderContext(e.context),c=s.getCurrentColorSpace(e.context),d=s.getCurrentColorFormat(e.context),p=s.getCurrentDepthStencilFormat(e.context),y=s.getPrimitiveTopology(n,r);let x=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==a||t.colorSpace!==c||t.colorFormat!==d||t.depthStencilFormat!==p||t.primitiveTopology!==y||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=a,t.colorSpace=c,t.colorFormat=d,t.depthStencilFormat=p,t.primitiveTopology=y,t.clippingContextCacheKey=e.clippingContextCacheKey,x=!0),x}getRenderCacheKey(e){const{object:t,material:n}=e,r=this.utils,s=e.context,a=t.isMesh&&t.matrixWorld.determinant()<0;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,a,r.getSampleCountRenderContext(s),r.getCurrentColorSpace(s),r.getCurrentColorFormat(s),r.getCurrentDepthStencilFormat(s),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}updateSampler(e){return this.textureUtils.updateSampler(e)}createDefaultTexture(e){return this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,t=!1){this.textureUtils.destroyTexture(e,t)}async copyTextureToBuffer(e,t,n,r,s,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,s,a)}initTimestampQuery(e,t,n){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new lZe(this.device,e,2048));const r=this.timestampQueryPool[e],s=r.allocateQueriesForContext(t);n.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:s,endOfPassWriteIndex:s+1}}createNodeBuilder(e,t){return new eZe(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),s=n.currentPass.finish();this.get(t).bundleGPU=s,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}deleteBindGroupData(e){this.bindingUtils.deleteBindGroupData(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.delete(this.renderer.getCanvasTarget())}getMaxAnisotropy(){return 16}hasFeature(e){return V5e[e]!==void 0&&(e=V5e[e]),this.device.features.has(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){let c=0,d=0,p=0,y=0,x=0,w=0,C=e.image.width,N=e.image.height,F=1;n!==null&&(n.isBox3===!0?(y=n.min.x,x=n.min.y,w=n.min.z,C=n.max.x-n.min.x,N=n.max.y-n.min.y,F=n.max.z-n.min.z):(y=n.min.x,x=n.min.y,C=n.max.x-n.min.x,N=n.max.y-n.min.y,F=1)),r!==null&&(c=r.x,d=r.y,p=r.z||0);const U=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),R=this.get(e).texture,B=this.get(t).texture;U.copyTextureToTexture({texture:R,mipLevel:s,origin:{x:y,y:x,z:w}},{texture:B,mipLevel:a,origin:{x:c,y:d,z:p}},[C,N,F]),this.device.queue.submit([U.finish()]),a===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,n){const r=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const a=this.get(e).texture;if(s.format!==a.format){jt("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,a.format);return}let c;if(r.currentPass?(r.currentPass.end(),c=r.encoder):c=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),c.copyTextureToTexture({texture:s,origin:[n.x,n.y,0]},{texture:a},[n.z,n.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e,c),r.currentPass){const{descriptor:d}=r;for(let p=0;p<d.colorAttachments.length;p++)d.colorAttachments[p].loadOp=gs.Load;t.depth&&(d.depthStencilAttachment.depthLoadOp=gs.Load),t.stencil&&(d.depthStencilAttachment.stencilLoadOp=gs.Load),r.currentPass=c.beginRenderPass(d),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor&&this.updateScissor(t)}else this.device.queue.submit([c.finish()])}hasCompatibility(e){return this._compatibility[x4.TEXTURE_COMPARE]!==void 0?this._compatibility[x4.TEXTURE_COMPARE]:super.hasCompatibility(e)}dispose(){if(this.bindingUtils.dispose(),this.textureUtils.dispose(),this.occludedResolveCache){for(const e of this.occludedResolveCache.values())e.destroy();this.occludedResolveCache.clear()}if(this.timestampQueryPool)for(const e of Object.values(this.timestampQueryPool))e!==null&&e.dispose();this.parameters.device===void 0&&this.device!==null&&this.device.destroy()}}class uZe extends qx{constructor(e,t,n,r,s,a){super(e,t,n,r,s,a),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class dZe extends qx{constructor(e,t,n,r,s,a){super(e,t,n,r,s,a),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class hZe extends K_e{constructor(){super(),this.addMaterial(XGe,"MeshPhongMaterial"),this.addMaterial(W7e,"MeshStandardMaterial"),this.addMaterial(Uje,"MeshPhysicalMaterial"),this.addMaterial(Gje,"MeshToonMaterial"),this.addMaterial(m$,"MeshBasicMaterial"),this.addMaterial(qGe,"MeshLambertMaterial"),this.addMaterial(h$,"MeshNormalMaterial"),this.addMaterial(Hje,"MeshMatcapMaterial"),this.addMaterial(DGe,"LineBasicMaterial"),this.addMaterial(LGe,"LineDashedMaterial"),this.addMaterial(Yje,"PointsMaterial"),this.addMaterial($7e,"SpriteMaterial"),this.addMaterial(Jje,"ShadowMaterial"),this.addLight(R$e,OH),this.addLight(GYe,qk),this.addLight(XYe,a8e),this.addLight(F$,qx),this.addLight(VYe,o8e),this.addLight(jYe,s8e),this.addLight(WYe,iDe),this.addLight(HYe,uZe),this.addLight($Ye,dZe),this.addToneMapping(f_e,Nk),this.addToneMapping(p_e,kk),this.addToneMapping(m_e,Dk),this.addToneMapping(g_e,Ok),this.addToneMapping(v_e,Lk),this.addToneMapping(y_e,Fk)}}class JN extends mKe{constructor(e={}){let t;e.forceWebGL?t=O5e:(t=cZe,e.getFallback=()=>(Wt("WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new O5e(e)));const n=new t(e);super(n,e),this.library=new hZe,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class fZe extends wu{constructor(e,t){const n=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],r=new Ii;r.setAttribute("position",new Rr(n,3)),r.computeBoundingSphere();const s=new Td({fog:!1});super(r,s),this.light=e,this.color=t,this.type="RectAreaLightHelper";const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new Ii;c.setAttribute("position",new Rr(a,3)),c.computeBoundingSphere(),this.add(new fn(c,new Ua({side:Ui,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const q5e={type:"change"},B$={type:"start"},lxe={type:"end"},kN=new jx,$5e=new Z1,pZe=Math.cos(70*E0.DEG2RAD),Ka=new _e,_u=2*Math.PI,zs={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Qj=1e-6;class mZe extends h8e{constructor(e,t=null){super(e,t),this.state=zs.NONE,this.target=new _e,this.cursor=new _e,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:X_.ROTATE,MIDDLE:X_.DOLLY,RIGHT:X_.PAN},this.touches={ONE:j_.ROTATE,TWO:j_.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._cursorStyle="auto",this._domElementKeyEvents=null,this._lastPosition=new _e,this._lastQuaternion=new us,this._lastTargetPosition=new _e,this._quat=new us().setFromUnitVectors(e.up,new _e(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new FH,this._sphericalDelta=new FH,this._scale=1,this._panOffset=new _e,this._rotateStart=new vn,this._rotateEnd=new vn,this._rotateDelta=new vn,this._panStart=new vn,this._panEnd=new vn,this._panDelta=new vn,this._dollyStart=new vn,this._dollyEnd=new vn,this._dollyDelta=new vn,this._dollyDirection=new _e,this._mouse=new vn,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=vZe.bind(this),this._onPointerDown=gZe.bind(this),this._onPointerUp=yZe.bind(this),this._onContextMenu=EZe.bind(this),this._onMouseWheel=bZe.bind(this),this._onKeyDown=SZe.bind(this),this._onTouchStart=wZe.bind(this),this._onTouchMove=TZe.bind(this),this._onMouseDown=_Ze.bind(this),this._onMouseMove=xZe.bind(this),this._interceptControlDown=MZe.bind(this),this._interceptControlUp=CZe.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}set cursorStyle(e){this._cursorStyle=e,e==="grab"?this.domElement.style.cursor="grab":this.domElement.style.cursor="auto"}get cursorStyle(){return this._cursorStyle}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(q5e),this.update(),this.state=zs.NONE}pan(e,t){this._pan(e,t),this.update()}dollyIn(e){this._dollyIn(e),this.update()}dollyOut(e){this._dollyOut(e),this.update()}rotateLeft(e){this._rotateLeft(e),this.update()}rotateUp(e){this._rotateUp(e),this.update()}update(e=null){const t=this.object.position;Ka.copy(t).sub(this.target),Ka.applyQuaternion(this._quat),this._spherical.setFromVector3(Ka),this.autoRotate&&this.state===zs.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=_u:n>Math.PI&&(n-=_u),r<-Math.PI?r+=_u:r>Math.PI&&(r-=_u),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=a!=this._spherical.radius}if(Ka.setFromSpherical(this._spherical),Ka.applyQuaternion(this._quatInverse),t.copy(this.target).add(Ka),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let a=null;if(this.object.isPerspectiveCamera){const c=Ka.length();a=this._clampDistance(c*this._scale);const d=c-a;this.object.position.addScaledVector(this._dollyDirection,d),this.object.updateMatrixWorld(),s=!!d}else if(this.object.isOrthographicCamera){const c=new _e(this._mouse.x,this._mouse.y,0);c.unproject(this.object);const d=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=d!==this.object.zoom;const p=new _e(this._mouse.x,this._mouse.y,0);p.unproject(this.object),this.object.position.sub(p).add(c),this.object.updateMatrixWorld(),a=Ka.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;a!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(a).add(this.object.position):(kN.origin.copy(this.object.position),kN.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(kN.direction))<pZe?this.object.lookAt(this.target):($5e.setFromNormalAndCoplanarPoint(this.object.up,this.target),kN.intersectPlane($5e,this.target))))}else if(this.object.isOrthographicCamera){const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),a!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>Qj||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Qj||this._lastTargetPosition.distanceToSquared(this.target)>Qj?(this.dispatchEvent(q5e),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?_u/60*this.autoRotateSpeed*e:_u/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Ka.setFromMatrixColumn(t,0),Ka.multiplyScalar(-e),this._panOffset.add(Ka)}_panUp(e,t){this.screenSpacePanning===!0?Ka.setFromMatrixColumn(t,1):(Ka.setFromMatrixColumn(t,0),Ka.crossVectors(this.object.up,Ka)),Ka.multiplyScalar(e),this._panOffset.add(Ka)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;Ka.copy(r).sub(this.target);let s=Ka.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/n.clientHeight,this.object.matrix),this._panUp(2*t*s/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,s=t-n.top,a=n.width,c=n.height;this._mouse.x=r/a*2-1,this._mouse.y=-(s/c)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(_u*this._rotateDelta.x/t.clientHeight),this._rotateUp(_u*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(_u*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-_u*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(_u*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-_u*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(_u*this._rotateDelta.x/t.clientHeight),this._rotateUp(_u*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=(e.pageX+t.x)*.5,c=(e.pageY+t.y)*.5;this._updateZoomParameters(a,c)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new vn,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function gZe(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i),this._cursorStyle==="grab"&&(this.domElement.style.cursor="grabbing")))}function vZe(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function yZe(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(lxe),this.state=zs.NONE,this._cursorStyle==="grab"&&(this.domElement.style.cursor="grab");break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function _Ze(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case X_.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=zs.DOLLY;break;case X_.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=zs.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=zs.ROTATE}break;case X_.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=zs.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=zs.PAN}break;default:this.state=zs.NONE}this.state!==zs.NONE&&this.dispatchEvent(B$)}function xZe(i){switch(this.state){case zs.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case zs.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case zs.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function bZe(i){this.enabled===!1||this.enableZoom===!1||this.state!==zs.NONE||(i.preventDefault(),this.dispatchEvent(B$),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(lxe))}function SZe(i){this.enabled!==!1&&this._handleKeyDown(i)}function wZe(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case j_.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=zs.TOUCH_ROTATE;break;case j_.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=zs.TOUCH_PAN;break;default:this.state=zs.NONE}break;case 2:switch(this.touches.TWO){case j_.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=zs.TOUCH_DOLLY_PAN;break;case j_.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=zs.TOUCH_DOLLY_ROTATE;break;default:this.state=zs.NONE}break;default:this.state=zs.NONE}this.state!==zs.NONE&&this.dispatchEvent(B$)}function TZe(i){switch(this._trackPointer(i),this.state){case zs.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case zs.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case zs.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case zs.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=zs.NONE}}function EZe(i){this.enabled!==!1&&i.preventDefault()}function MZe(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function CZe(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const AZe=Math.PI/180,PZe=180/Math.PI;function k_(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function Jj(i,e,t){return(1-t)*i+t*e}function gW(i){return i*AZe}function RZe(i){return i*PZe}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const Wo={LEFT:1,RIGHT:2,MIDDLE:4},Rt=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),D_={NONE:0,IN:1,OUT:-1};function N8(i){return i.isPerspectiveCamera}function i4(i){return i.isOrthographicCamera}const O_=Math.PI*2,X5e=Math.PI/2,cxe=1e-5,xT=Math.PI/180;function Wf(i,e,t){return Math.max(e,Math.min(t,i))}function eo(i,e=cxe){return Math.abs(i)<e}function ws(i,e,t=cxe){return eo(i-e,t)}function Y5e(i,e){return Math.round(i/e)*e}function bT(i){return isFinite(i)?i:i<0?-Number.MAX_VALUE:Number.MAX_VALUE}function ST(i){return Math.abs(i)<Number.MAX_VALUE?i:i*(1/0)}function DN(i,e,t,n,r=1/0,s){n=Math.max(1e-4,n);const a=2/n,c=a*s,d=1/(1+c+.48*c*c+.235*c*c*c);let p=i-e;const y=e,x=r*n;p=Wf(p,-x,x),e=i-p;const w=(t.value+a*p)*s;t.value=(t.value-a*w)*d;let C=e+(p+w)*d;return y-i>0==C>y&&(C=y,t.value=(C-y)/s),C}function K5e(i,e,t,n,r=1/0,s,a){n=Math.max(1e-4,n);const c=2/n,d=c*s,p=1/(1+d+.48*d*d+.235*d*d*d);let y=e.x,x=e.y,w=e.z,C=i.x-y,N=i.y-x,F=i.z-w;const U=y,R=x,B=w,Y=r*n,A=Y*Y,ne=C*C+N*N+F*F;if(ne>A){const He=Math.sqrt(ne);C=C/He*Y,N=N/He*Y,F=F/He*Y}y=i.x-C,x=i.y-N,w=i.z-F;const se=(t.x+c*C)*s,oe=(t.y+c*N)*s,G=(t.z+c*F)*s;t.x=(t.x-c*se)*p,t.y=(t.y-c*oe)*p,t.z=(t.z-c*G)*p,a.x=y+(C+se)*p,a.y=x+(N+oe)*p,a.z=w+(F+G)*p;const ie=U-i.x,Me=R-i.y,X=B-i.z,De=a.x-U,$e=a.y-R,ot=a.z-B;return ie*De+Me*$e+X*ot>0&&(a.x=U,a.y=R,a.z=B,t.x=(a.x-U)/s,t.y=(a.y-R)/s,t.z=(a.z-B)/s),a}function eH(i,e){e.set(0,0),i.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=i.length,e.y/=i.length}function tH(i,e){return i4(i)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class IZe{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e)}}}var nH;const NZe="2.10.1",ON=1/8,kZe=/Mac/.test((nH=globalThis==null?void 0:globalThis.navigator)===null||nH===void 0?void 0:nH.platform);let Jr,Z5e,LN,rH,xu,mi,ls,L_,wT,H1,W1,k8,Q5e,J5e,yh,TT,F_,eve,iH,tve,sH,oH,FN;class K1 extends IZe{static install(e){Jr=e.THREE,Z5e=Object.freeze(new Jr.Vector3(0,0,0)),LN=Object.freeze(new Jr.Vector3(0,1,0)),rH=Object.freeze(new Jr.Vector3(0,0,1)),xu=new Jr.Vector2,mi=new Jr.Vector3,ls=new Jr.Vector3,L_=new Jr.Vector3,wT=new Jr.Vector3,H1=new Jr.Vector3,W1=new Jr.Vector3,k8=new Jr.Vector3,Q5e=new Jr.Vector3,J5e=new Jr.Vector3,yh=new Jr.Spherical,TT=new Jr.Spherical,F_=new Jr.Box3,eve=new Jr.Box3,iH=new Jr.Sphere,tve=new Jr.Quaternion,sH=new Jr.Quaternion,oH=new Jr.Matrix4,FN=new Jr.Raycaster}static get ACTION(){return Rt}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Rt.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=D_.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Jr.Vector3,this._focalOffsetVelocity=new Jr.Vector3,this._zoomVelocity={value:0},this._truckInternal=(R,B,Y,A)=>{let ne,se;if(N8(this._camera)){const oe=mi.copy(this._camera.position).sub(this._target),G=this._camera.getEffectiveFOV()*xT,ie=oe.length()*Math.tan(G*.5);ne=this.truckSpeed*R*ie/this._elementRect.height,se=this.truckSpeed*B*ie/this._elementRect.height}else if(i4(this._camera)){const oe=this._camera;ne=this.truckSpeed*R*(oe.right-oe.left)/oe.zoom/this._elementRect.width,se=this.truckSpeed*B*(oe.top-oe.bottom)/oe.zoom/this._elementRect.height}else return;A?(Y?this.setFocalOffset(this._focalOffsetEnd.x+ne,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(ne,0,!0),this.forward(-se,!0)):Y?this.setFocalOffset(this._focalOffsetEnd.x+ne,this._focalOffsetEnd.y+se,this._focalOffsetEnd.z,!0):this.truck(ne,se,!0)},this._rotateInternal=(R,B)=>{const Y=O_*this.azimuthRotateSpeed*R/this._elementRect.height,A=O_*this.polarRotateSpeed*B/this._elementRect.height;this.rotate(Y,A,!0)},this._dollyInternal=(R,B,Y)=>{const A=Math.pow(.95,-R*this.dollySpeed),ne=this._sphericalEnd.radius,se=this._sphericalEnd.radius*A,oe=Wf(se,this.minDistance,this.maxDistance),G=oe-se;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(se,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(G,!0),this._dollyToNoClamp(oe,!0)):this._dollyToNoClamp(oe,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?se:oe)-ne,this._dollyControlCoord.set(B,Y)),this._lastDollyDirection=Math.sign(-R)},this._zoomInternal=(R,B,Y)=>{const A=Math.pow(.95,R*this.dollySpeed),ne=this._zoom,se=this._zoom*A;this.zoomTo(se,!0),this.dollyToCursor&&(this._changedZoom+=se-ne,this._dollyControlCoord.set(B,Y))},typeof Jr>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Jr.Quaternion().setFromUnitVectors(this._camera.up,LN),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Rt.NONE,this._target=new Jr.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Jr.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Jr.Spherical().setFromVector3(mi.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Jr.Vector3,new Jr.Vector3,new Jr.Vector3,new Jr.Vector3],this._updateNearPlaneCorners(),this._boundary=new Jr.Box3(new Jr.Vector3(-1/0,-1/0,-1/0),new Jr.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Jr.Vector2,this.mouseButtons={left:Rt.ROTATE,middle:Rt.DOLLY,right:Rt.TRUCK,wheel:N8(this._camera)?Rt.DOLLY:i4(this._camera)?Rt.ZOOM:Rt.NONE},this.touches={one:Rt.TOUCH_ROTATE,two:N8(this._camera)?Rt.TOUCH_DOLLY_TRUCK:i4(this._camera)?Rt.TOUCH_ZOOM_TRUCK:Rt.NONE,three:Rt.TOUCH_TRUCK};const n=new Jr.Vector2,r=new Jr.Vector2,s=new Jr.Vector2,a=R=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const A=this._domElement.getBoundingClientRect(),ne=R.clientX/A.width,se=R.clientY/A.height;if(ne<this._interactiveArea.left||ne>this._interactiveArea.right||se<this._interactiveArea.top||se>this._interactiveArea.bottom)return}const B=R.pointerType!=="mouse"?null:(R.buttons&Wo.LEFT)===Wo.LEFT?Wo.LEFT:(R.buttons&Wo.MIDDLE)===Wo.MIDDLE?Wo.MIDDLE:(R.buttons&Wo.RIGHT)===Wo.RIGHT?Wo.RIGHT:null;if(B!==null){const A=this._findPointerByMouseButton(B);A&&this._disposePointer(A)}if((R.buttons&Wo.LEFT)===Wo.LEFT&&this._lockedPointer)return;const Y={pointerId:R.pointerId,clientX:R.clientX,clientY:R.clientY,deltaX:0,deltaY:0,mouseButton:B};this._activePointers.push(Y),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),this._isDragging=!0,w(R)},c=R=>{R.cancelable&&R.preventDefault();const B=R.pointerId,Y=this._lockedPointer||this._findPointerById(B);if(Y){if(Y.clientX=R.clientX,Y.clientY=R.clientY,Y.deltaX=R.movementX,Y.deltaY=R.movementY,this._state=0,R.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(R.buttons&Wo.LEFT)===Wo.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(R.buttons&Wo.MIDDLE)===Wo.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(R.buttons&Wo.RIGHT)===Wo.RIGHT&&(this._state=this._state|this.mouseButtons.right);C()}},d=R=>{const B=this._findPointerById(R.pointerId);if(!(B&&B===this._lockedPointer)){if(B&&this._disposePointer(B),R.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=Rt.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=Rt.NONE;N()}};let p=-1;const y=R=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Rt.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const se=this._domElement.getBoundingClientRect(),oe=R.clientX/se.width,G=R.clientY/se.height;if(oe<this._interactiveArea.left||oe>this._interactiveArea.right||G<this._interactiveArea.top||G>this._interactiveArea.bottom)return}if(R.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Rt.ROTATE||this.mouseButtons.wheel===Rt.TRUCK){const se=performance.now();p-se<1e3&&this._getClientRect(this._elementRect),p=se}const B=kZe?-1:-3,Y=R.deltaMode===1||R.ctrlKey?R.deltaY/B:R.deltaY/(B*10),A=this.dollyToCursor?(R.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,ne=this.dollyToCursor?(R.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Rt.ROTATE:{this._rotateInternal(R.deltaX,R.deltaY),this._isUserControllingRotate=!0;break}case Rt.TRUCK:{this._truckInternal(R.deltaX,R.deltaY,!1,!1),this._isUserControllingTruck=!0;break}case Rt.SCREEN_PAN:{this._truckInternal(R.deltaX,R.deltaY,!1,!0),this._isUserControllingTruck=!0;break}case Rt.OFFSET:{this._truckInternal(R.deltaX,R.deltaY,!0,!1),this._isUserControllingOffset=!0;break}case Rt.DOLLY:{this._dollyInternal(-Y,A,ne),this._isUserControllingDolly=!0;break}case Rt.ZOOM:{this._zoomInternal(-Y,A,ne),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},x=R=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===K1.ACTION.NONE){const B=R instanceof PointerEvent?R.pointerId:0,Y=this._findPointerById(B);Y&&this._disposePointer(Y),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d);return}R.preventDefault()}},w=R=>{if(!this._enabled)return;if(eH(this._activePointers,xu),this._getClientRect(this._elementRect),n.copy(xu),r.copy(xu),this._activePointers.length>=2){const Y=xu.x-this._activePointers[1].clientX,A=xu.y-this._activePointers[1].clientY,ne=Math.sqrt(Y*Y+A*A);s.set(0,ne);const se=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,oe=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(se,oe)}if(this._state=0,!R)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in R&&R.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(R.buttons&Wo.LEFT)===Wo.LEFT&&(this._state=this._state|this.mouseButtons.left),(R.buttons&Wo.MIDDLE)===Wo.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(R.buttons&Wo.RIGHT)===Wo.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&Rt.ROTATE)===Rt.ROTATE||(this._state&Rt.TOUCH_ROTATE)===Rt.TOUCH_ROTATE||(this._state&Rt.TOUCH_DOLLY_ROTATE)===Rt.TOUCH_DOLLY_ROTATE||(this._state&Rt.TOUCH_ZOOM_ROTATE)===Rt.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Rt.TRUCK)===Rt.TRUCK||(this._state&Rt.SCREEN_PAN)===Rt.SCREEN_PAN||(this._state&Rt.TOUCH_TRUCK)===Rt.TOUCH_TRUCK||(this._state&Rt.TOUCH_SCREEN_PAN)===Rt.TOUCH_SCREEN_PAN||(this._state&Rt.TOUCH_DOLLY_TRUCK)===Rt.TOUCH_DOLLY_TRUCK||(this._state&Rt.TOUCH_DOLLY_SCREEN_PAN)===Rt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Rt.TOUCH_ZOOM_TRUCK)===Rt.TOUCH_ZOOM_TRUCK||(this._state&Rt.TOUCH_ZOOM_SCREEN_PAN)===Rt.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Rt.DOLLY)===Rt.DOLLY||(this._state&Rt.TOUCH_DOLLY)===Rt.TOUCH_DOLLY||(this._state&Rt.TOUCH_DOLLY_TRUCK)===Rt.TOUCH_DOLLY_TRUCK||(this._state&Rt.TOUCH_DOLLY_SCREEN_PAN)===Rt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Rt.TOUCH_DOLLY_OFFSET)===Rt.TOUCH_DOLLY_OFFSET||(this._state&Rt.TOUCH_DOLLY_ROTATE)===Rt.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Rt.ZOOM)===Rt.ZOOM||(this._state&Rt.TOUCH_ZOOM)===Rt.TOUCH_ZOOM||(this._state&Rt.TOUCH_ZOOM_TRUCK)===Rt.TOUCH_ZOOM_TRUCK||(this._state&Rt.TOUCH_ZOOM_SCREEN_PAN)===Rt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Rt.TOUCH_ZOOM_OFFSET)===Rt.TOUCH_ZOOM_OFFSET||(this._state&Rt.TOUCH_ZOOM_ROTATE)===Rt.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Rt.OFFSET)===Rt.OFFSET||(this._state&Rt.TOUCH_OFFSET)===Rt.TOUCH_OFFSET||(this._state&Rt.TOUCH_DOLLY_OFFSET)===Rt.TOUCH_DOLLY_OFFSET||(this._state&Rt.TOUCH_ZOOM_OFFSET)===Rt.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},C=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,eH(this._activePointers,xu);const B=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,Y=B?-B.deltaX:r.x-xu.x,A=B?-B.deltaY:r.y-xu.y;if(r.copy(xu),((this._state&Rt.ROTATE)===Rt.ROTATE||(this._state&Rt.TOUCH_ROTATE)===Rt.TOUCH_ROTATE||(this._state&Rt.TOUCH_DOLLY_ROTATE)===Rt.TOUCH_DOLLY_ROTATE||(this._state&Rt.TOUCH_ZOOM_ROTATE)===Rt.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(Y,A),this._isUserControllingRotate=!0),(this._state&Rt.DOLLY)===Rt.DOLLY||(this._state&Rt.ZOOM)===Rt.ZOOM){const ne=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,se=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,oe=this.dollyDragInverted?-1:1;(this._state&Rt.DOLLY)===Rt.DOLLY?(this._dollyInternal(oe*A*ON,ne,se),this._isUserControllingDolly=!0):(this._zoomInternal(oe*A*ON,ne,se),this._isUserControllingZoom=!0)}if((this._state&Rt.TOUCH_DOLLY)===Rt.TOUCH_DOLLY||(this._state&Rt.TOUCH_ZOOM)===Rt.TOUCH_ZOOM||(this._state&Rt.TOUCH_DOLLY_TRUCK)===Rt.TOUCH_DOLLY_TRUCK||(this._state&Rt.TOUCH_ZOOM_TRUCK)===Rt.TOUCH_ZOOM_TRUCK||(this._state&Rt.TOUCH_DOLLY_SCREEN_PAN)===Rt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Rt.TOUCH_ZOOM_SCREEN_PAN)===Rt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Rt.TOUCH_DOLLY_OFFSET)===Rt.TOUCH_DOLLY_OFFSET||(this._state&Rt.TOUCH_ZOOM_OFFSET)===Rt.TOUCH_ZOOM_OFFSET||(this._state&Rt.TOUCH_DOLLY_ROTATE)===Rt.TOUCH_DOLLY_ROTATE||(this._state&Rt.TOUCH_ZOOM_ROTATE)===Rt.TOUCH_ZOOM_ROTATE){const ne=xu.x-this._activePointers[1].clientX,se=xu.y-this._activePointers[1].clientY,oe=Math.sqrt(ne*ne+se*se),G=s.y-oe;s.set(0,oe);const ie=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,Me=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Rt.TOUCH_DOLLY)===Rt.TOUCH_DOLLY||(this._state&Rt.TOUCH_DOLLY_ROTATE)===Rt.TOUCH_DOLLY_ROTATE||(this._state&Rt.TOUCH_DOLLY_TRUCK)===Rt.TOUCH_DOLLY_TRUCK||(this._state&Rt.TOUCH_DOLLY_SCREEN_PAN)===Rt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Rt.TOUCH_DOLLY_OFFSET)===Rt.TOUCH_DOLLY_OFFSET?(this._dollyInternal(G*ON,ie,Me),this._isUserControllingDolly=!0):(this._zoomInternal(G*ON,ie,Me),this._isUserControllingZoom=!0)}((this._state&Rt.TRUCK)===Rt.TRUCK||(this._state&Rt.TOUCH_TRUCK)===Rt.TOUCH_TRUCK||(this._state&Rt.TOUCH_DOLLY_TRUCK)===Rt.TOUCH_DOLLY_TRUCK||(this._state&Rt.TOUCH_ZOOM_TRUCK)===Rt.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(Y,A,!1,!1),this._isUserControllingTruck=!0),((this._state&Rt.SCREEN_PAN)===Rt.SCREEN_PAN||(this._state&Rt.TOUCH_SCREEN_PAN)===Rt.TOUCH_SCREEN_PAN||(this._state&Rt.TOUCH_DOLLY_SCREEN_PAN)===Rt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Rt.TOUCH_ZOOM_SCREEN_PAN)===Rt.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(Y,A,!1,!0),this._isUserControllingTruck=!0),((this._state&Rt.OFFSET)===Rt.OFFSET||(this._state&Rt.TOUCH_OFFSET)===Rt.TOUCH_OFFSET||(this._state&Rt.TOUCH_DOLLY_OFFSET)===Rt.TOUCH_DOLLY_OFFSET||(this._state&Rt.TOUCH_ZOOM_OFFSET)===Rt.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(Y,A,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},N=()=>{eH(this._activePointers,xu),r.copy(xu),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",F),this._domElement.ownerDocument.addEventListener("pointerlockerror",U),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),w())},this.unlockPointer=()=>{var R,B,Y;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(R=this._domElement)===null||R===void 0||R.ownerDocument.exitPointerLock(),(B=this._domElement)===null||B===void 0||B.ownerDocument.removeEventListener("pointerlockchange",F),(Y=this._domElement)===null||Y===void 0||Y.ownerDocument.removeEventListener("pointerlockerror",U),this.cancel()};const F=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},U=()=>{this.unlockPointer()};this._addAllEventListeners=R=>{this._domElement=R,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",a),this._domElement.addEventListener("pointercancel",d),this._domElement.addEventListener("wheel",y,{passive:!1}),this._domElement.addEventListener("contextmenu",x)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",a),this._domElement.removeEventListener("pointercancel",d),this._domElement.removeEventListener("wheel",y,{passive:!1}),this._domElement.removeEventListener("contextmenu",x),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.removeEventListener("pointerlockchange",F),this._domElement.ownerDocument.removeEventListener("pointerlockerror",U))},this.cancel=()=>{this._state!==Rt.NONE&&(this._state=Rt.NONE,this._activePointers.length=0,N())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=Wf(e.width,0,1),this._interactiveArea.height=Wf(e.height,0,1),this._interactiveArea.x=Wf(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Wf(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const r=Wf(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=Wf(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const a=!n||ws(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&ws(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=D_.NONE,this._changedDolly=0,this._dollyToNoClamp(Wf(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const a=this._collisionTest(),c=ws(a,this._spherical.radius);if(!(n>e)&&c)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,a)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const s=!t||ws(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(wT).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||ws(this._target.x,this._targetEnd.x,this.restThreshold)&&ws(this._target.y,this._targetEnd.y,this.restThreshold)&&ws(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=Wf(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||ws(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),H1.setFromMatrixColumn(this._camera.matrix,0),W1.setFromMatrixColumn(this._camera.matrix,1),H1.multiplyScalar(e),W1.multiplyScalar(-t);const r=mi.copy(H1).add(W1),s=ls.copy(this._targetEnd).add(r);return this.moveTo(s.x,s.y,s.z,n)}forward(e,t=!1){mi.setFromMatrixColumn(this._camera.matrix,0),mi.crossVectors(this._camera.up,mi),mi.multiplyScalar(e);const n=ls.copy(this._targetEnd).add(mi);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return mi.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+mi.x,this._targetEnd.y+mi.y,this._targetEnd.z+mi.z,t)}moveTo(e,t,n,r=!1){this._isUserControllingTruck=!1;const s=mi.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const a=!r||ws(this._target.x,this._targetEnd.x,this.restThreshold)&&ws(this._target.y,this._targetEnd.y,this.restThreshold)&&ws(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}lookInDirectionOf(e,t,n,r=!1){const c=mi.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(c.x,c.y,c.z,r)}fitToBox(e,t,{cover:n=!1,paddingLeft:r=0,paddingRight:s=0,paddingBottom:a=0,paddingTop:c=0}={}){const d=[],p=e.isBox3?F_.copy(e):F_.setFromObject(e);p.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const y=Y5e(this._sphericalEnd.theta,X5e),x=Y5e(this._sphericalEnd.phi,X5e);d.push(this.rotateTo(y,x,t));const w=mi.setFromSpherical(this._sphericalEnd).normalize(),C=tve.setFromUnitVectors(w,rH),N=ws(Math.abs(w.y),1);N&&C.multiply(sH.setFromAxisAngle(LN,y)),C.multiply(this._yAxisUpSpaceInverse);const F=eve.makeEmpty();ls.copy(p.min).applyQuaternion(C),F.expandByPoint(ls),ls.copy(p.min).setX(p.max.x).applyQuaternion(C),F.expandByPoint(ls),ls.copy(p.min).setY(p.max.y).applyQuaternion(C),F.expandByPoint(ls),ls.copy(p.max).setZ(p.min.z).applyQuaternion(C),F.expandByPoint(ls),ls.copy(p.min).setZ(p.max.z).applyQuaternion(C),F.expandByPoint(ls),ls.copy(p.max).setY(p.min.y).applyQuaternion(C),F.expandByPoint(ls),ls.copy(p.max).setX(p.min.x).applyQuaternion(C),F.expandByPoint(ls),ls.copy(p.max).applyQuaternion(C),F.expandByPoint(ls),F.min.x-=r,F.min.y-=a,F.max.x+=s,F.max.y+=c,C.setFromUnitVectors(rH,w),N&&C.premultiply(sH.invert()),C.premultiply(this._yAxisUpSpace);const U=F.getSize(mi),R=F.getCenter(ls).applyQuaternion(C);if(N8(this._camera)){const B=this.getDistanceToFitBox(U.x,U.y,U.z,n);d.push(this.moveTo(R.x,R.y,R.z,t)),d.push(this.dollyTo(B,t)),d.push(this.setFocalOffset(0,0,0,t))}else if(i4(this._camera)){const B=this._camera,Y=B.right-B.left,A=B.top-B.bottom,ne=n?Math.max(Y/U.x,A/U.y):Math.min(Y/U.x,A/U.y);d.push(this.moveTo(R.x,R.y,R.z,t)),d.push(this.zoomTo(ne,t)),d.push(this.setFocalOffset(0,0,0,t))}return Promise.all(d)}fitToSphere(e,t){const n=[],s="isObject3D"in e?K1.createBoundingSphere(e,iH):iH.copy(e);if(n.push(this.moveTo(s.center.x,s.center.y,s.center.z,t)),N8(this._camera)){const a=this.getDistanceToFitSphere(s.radius);n.push(this.dollyTo(a,t))}else if(i4(this._camera)){const a=this._camera.right-this._camera.left,c=this._camera.top-this._camera.bottom,d=2*s.radius,p=Math.min(a/d,c/d);n.push(this.zoomTo(p,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,r,s,a,c=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=D_.NONE,this._changedDolly=0;const d=ls.set(r,s,a),p=mi.set(e,t,n);this._targetEnd.copy(d),this._sphericalEnd.setFromVector3(p.sub(d).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,c||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const y=!c||ws(this._target.x,this._targetEnd.x,this.restThreshold)&&ws(this._target.y,this._targetEnd.y,this.restThreshold)&&ws(this._target.z,this._targetEnd.z,this.restThreshold)&&ws(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&ws(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&ws(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(y)}lerpLookAt(e,t,n,r,s,a,c,d,p,y,x,w,C,N=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=D_.NONE,this._changedDolly=0;const F=mi.set(r,s,a),U=ls.set(e,t,n);yh.setFromVector3(U.sub(F).applyQuaternion(this._yAxisUpSpace));const R=L_.set(y,x,w),B=ls.set(c,d,p);TT.setFromVector3(B.sub(R).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(F.lerp(R,C));const Y=TT.theta-yh.theta,A=TT.phi-yh.phi,ne=TT.radius-yh.radius;this._sphericalEnd.set(yh.radius+ne*C,yh.phi+A*C,yh.theta+Y*C),this.normalizeRotations(),this._needsUpdate=!0,N||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const se=!N||ws(this._target.x,this._targetEnd.x,this.restThreshold)&&ws(this._target.y,this._targetEnd.y,this.restThreshold)&&ws(this._target.z,this._targetEnd.z,this.restThreshold)&&ws(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&ws(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&ws(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(se)}setPosition(e,t,n,r=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n,r=!1){const s=this.getPosition(mi),a=this.setLookAt(s.x,s.y,s.z,e,t,n,r);return this._sphericalEnd.phi=Wf(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),a}setFocalOffset(e,t,n,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const s=!r||ws(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&ws(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&ws(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),H1.setFromMatrixColumn(this._camera.matrixWorldInverse,0),W1.setFromMatrixColumn(this._camera.matrixWorldInverse,1),k8.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=mi.set(e,t,n),s=r.distanceTo(this._camera.position),a=r.sub(this._camera.position);H1.multiplyScalar(a.x),W1.multiplyScalar(a.y),k8.multiplyScalar(a.z),mi.copy(H1).add(W1).add(k8),mi.z=mi.z+s,this.dollyTo(s,!1),this.setFocalOffset(-mi.x,mi.y,-mi.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Jr.Vector4,typeof e=="number"?this._viewport.set(e,t,n,r):this._viewport.copy(e)}getDistanceToFitBox(e,t,n,r=!1){if(tH(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=e/t,a=this._camera.getEffectiveFOV()*xT,c=this._camera.aspect;return((r?s>c:s<c)?t:e/c)*.5/Math.tan(a*.5)+n*.5}getDistanceToFitSphere(e){if(tH(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*xT,n=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,r=1<this._camera.aspect?t:n;return e/Math.sin(r*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Jr.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Jr.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new Jr.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Jr.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%O_,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=O_),this._spherical.theta+=O_*Math.round((this._sphericalEnd.theta-this._spherical.theta)/O_)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!ws(this._camera.up.x,this._cameraUp0.x)||!ws(this._camera.up.y,this._cameraUp0.y)||!ws(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const n=this.getPosition(mi);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,LN),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=mi.subVectors(this._target,this._camera.position).normalize(),t=ls.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(mi);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,s=Q5e.subVectors(this._targetEnd,this._target),a=J5e.subVectors(this._focalOffsetEnd,this._focalOffset),c=this._zoomEnd-this._zoom;if(eo(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=DN(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,x,1/0,e),this._needsUpdate=!0}if(eo(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=DN(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,x,1/0,e),this._needsUpdate=!0}if(eo(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const x=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=DN(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,x,this.maxSpeed,e),this._needsUpdate=!0}if(eo(s.x)&&eo(s.y)&&eo(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const x=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;K5e(this._target,this._targetEnd,this._targetVelocity,x,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(eo(a.x)&&eo(a.y)&&eo(a.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const x=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;K5e(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,x,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(eo(c))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const x=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=DN(this._zoom,this._zoomEnd,this._zoomVelocity,x,1/0,e)}if(this.dollyToCursor){if(N8(this._camera)&&this._changedDolly!==0){const x=this._spherical.radius-this._lastDistance,w=this._camera,C=this._getCameraDirection(wT),N=mi.copy(C).cross(w.up).normalize();N.lengthSq()===0&&(N.x=1);const F=ls.crossVectors(N,C),U=this._sphericalEnd.radius*Math.tan(w.getEffectiveFOV()*xT*.5),B=(this._sphericalEnd.radius-x-this._sphericalEnd.radius)/this._sphericalEnd.radius,Y=L_.copy(this._targetEnd).add(N.multiplyScalar(this._dollyControlCoord.x*U*w.aspect)).add(F.multiplyScalar(this._dollyControlCoord.y*U)),A=mi.copy(this._targetEnd).lerp(Y,B),ne=this._lastDollyDirection===D_.IN&&this._spherical.radius<=this.minDistance,se=this._lastDollyDirection===D_.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(ne||se)){this._sphericalEnd.radius-=x,this._spherical.radius-=x;const G=ls.copy(C).multiplyScalar(-x);A.add(G)}this._boundary.clampPoint(A,A);const oe=ls.subVectors(A,this._targetEnd);this._targetEnd.copy(A),this._target.add(oe),this._changedDolly-=x,eo(this._changedDolly)&&(this._changedDolly=0)}else if(i4(this._camera)&&this._changedZoom!==0){const x=this._zoom-this._lastZoom,w=this._camera,C=mi.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(w.near+w.far)/(w.near-w.far)).unproject(w),N=ls.set(0,0,-1).applyQuaternion(w.quaternion),F=L_.copy(C).add(N.multiplyScalar(-C.dot(w.up))),R=-(this._zoom-x-this._zoom)/this._zoom,B=this._getCameraDirection(wT),Y=this._targetEnd.dot(B),A=mi.copy(this._targetEnd).lerp(F,R),ne=A.dot(B),se=B.multiplyScalar(ne-Y);A.sub(se),this._boundary.clampPoint(A,A);const oe=ls.subVectors(A,this._targetEnd);this._targetEnd.copy(A),this._target.add(oe),this._changedZoom-=x,eo(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const d=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,d),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!eo(this._focalOffset.x)||!eo(this._focalOffset.y)||!eo(this._focalOffset.z))&&(H1.setFromMatrixColumn(this._camera.matrix,0),W1.setFromMatrixColumn(this._camera.matrix,1),k8.setFromMatrixColumn(this._camera.matrix,2),H1.multiplyScalar(this._focalOffset.x),W1.multiplyScalar(-this._focalOffset.y),k8.multiplyScalar(this._focalOffset.z),mi.copy(H1).add(W1).add(k8),this._camera.position.add(mi),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),mi.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const y=this._needsUpdate;return y&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):y?(this.dispatchEvent({type:"update"}),eo(t,this.restThreshold)&&eo(n,this.restThreshold)&&eo(r,this.restThreshold)&&eo(s.x,this.restThreshold)&&eo(s.y,this.restThreshold)&&eo(s.z,this.restThreshold)&&eo(a.x,this.restThreshold)&&eo(a.y,this.restThreshold)&&eo(a.z,this.restThreshold)&&eo(c,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!y&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=y,this._needsUpdate=!1,y}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:bT(this.maxDistance),minZoom:this.minZoom,maxZoom:bT(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:bT(this.maxPolarAngle),minAzimuthAngle:bT(this.minAzimuthAngle),maxAzimuthAngle:bT(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:mi.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=ST(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=ST(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=ST(n.maxPolarAngle),this.minAzimuthAngle=ST(n.minAzimuthAngle),this.maxAzimuthAngle=ST(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),yh.setFromVector3(mi.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(yh.theta,yh.phi,t),this.dollyTo(yh.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",NZe),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(r===0)return e;const s=ls.copy(t).add(e),c=this._boundary.clampPoint(s,L_).sub(s),d=c.lengthSq();if(d===0)return e.add(t);if(d===r)return e;if(n===0)return e.add(t).add(c);{const p=1+n*d/t.dot(c);return e.add(ls.copy(t).multiplyScalar(p)).add(c.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(N8(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*xT,r=Math.tan(n*.5)*t,s=r*e.aspect;this._nearPlaneCorners[0].set(-s,-r,0),this._nearPlaneCorners[1].set(s,-r,0),this._nearPlaneCorners[2].set(s,r,0),this._nearPlaneCorners[3].set(-s,r,0)}else if(i4(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,s=e.top*t,a=e.bottom*t;this._nearPlaneCorners[0].set(n,s,0),this._nearPlaneCorners[1].set(r,s,0),this._nearPlaneCorners[2].set(r,a,0),this._nearPlaneCorners[3].set(n,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||tH(this._camera,"_collisionTest"))return e;const n=this._getTargetDirection(wT);oH.lookAt(Z5e,n,this._camera.up);for(let r=0;r<4;r++){const s=ls.copy(this._nearPlaneCorners[r]);s.applyMatrix4(oH);const a=L_.addVectors(this._target,s);FN.set(a,n),FN.far=this._spherical.radius+1;const c=FN.intersectObjects(this.colliderMeshes);c.length!==0&&c[0].distance<e&&(e=c[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const n=()=>{this.removeEventListener("rest",n),t()};this.addEventListener("rest",n)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Jr.Sphere){const n=t,r=n.center;F_.makeEmpty(),e.traverseVisible(a=>{a.isMesh&&F_.expandByObject(a)}),F_.getCenter(r);let s=0;return e.traverseVisible(a=>{if(!a.isMesh)return;const c=a;if(!c.geometry)return;const d=c.geometry.clone();d.applyMatrix4(c.matrixWorld);const y=d.attributes.position;for(let x=0,w=y.count;x<w;x++)mi.fromBufferAttribute(y,x),s=Math.max(s,r.distanceToSquared(mi))}),n.radius=Math.sqrt(s),n}}const Ek=i=>{const[e,t]=Nn.useState(i.options[i.index]),n=()=>{i.onToggle(!i.open)},r=a=>{a!==e&&(i.onSelect(a),t(a)),i.onToggle(!1)},s=i.open?`${i.options.length*31-1}px`:"0px";return rt.jsxs("div",{className:`dropdown ${i.up===!0?"up":""}`,children:[rt.jsx("div",{className:"dropdown-toggle",onClick:n,children:`${i.title}: ${e}`}),rt.jsx("ul",{className:"dropdown-menu",style:{height:s},children:i.options.map(a=>rt.jsx("li",{onClick:()=>r(a),children:a},a))})]})},D8=Nn.forwardRef(function(e,t){const n=["Renderer","Depth","Normals","UVs","Wireframe"],[r,s]=Nn.useState("Renderer"),[a,c]=Nn.useState(!1),[d,p]=Nn.useState(!1),[y,x]=Nn.useState(!1);return rt.jsxs("div",{className:`CameraWindow ${e.name}`,children:[rt.jsx("div",{ref:t,className:"clickable",onClick:()=>{y&&x(!1)}}),rt.jsxs("div",{className:"options",children:[e.camera!==null&&rt.jsx(Ek,{title:"Camera",index:e.options.indexOf(e.camera.name),open:y,options:e.options,onSelect:e.onSelectCamera,onToggle:w=>{w&&d&&p(!1),x(w)},up:!0}),rt.jsx(Ek,{title:"Mode",index:n.indexOf(r),open:d,options:n,onSelect:w=>{if(w===r)return;const C=w;e.onSelectRenderMode(C),s(C)},onToggle:w=>{w&&y&&x(!1),a&&c(!1),p(w)},up:!0})]})]})}),DZe=`out vec3 worldPosition;
uniform float uDistance;

void main() {
  // Scale the plane by the drawing distance
  worldPosition = position.xzy * uDistance;
  worldPosition.xz += cameraPosition.xz;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(worldPosition, 1.0);
}`,OZe=`out vec4 fragColor;
in vec3 worldPosition;
uniform float uDivisions;
uniform float uScale;
uniform vec3 uColor;
uniform float uDistance;
uniform float uGridOpacity;
uniform float uSubgridOpacity;

#define minAlpha 0.00784313725490196

float getGrid(float gapSize) {
  vec2 worldPositionByDivision = worldPosition.xz / gapSize;

  // Inverted, 0 where line, >1 where there's no line
  // We use the worldPosition (which in this case we use similarly to UVs) differential to control the anti-aliasing
  // We need to do the -0.5)-0.5 trick because the result fades out from 0 to 1, and we want both
  // worldPositionByDivision == 0.3 and worldPositionByDivision == 0.7 to result in the same fade, i.e. 0.3,
  // otherwise only one side of the line will be anti-aliased
  vec2 grid = abs(fract(worldPositionByDivision-0.5)-0.5) / fwidth(worldPositionByDivision) / 2.0;
  float gridLine = min(grid.x, grid.y);

  // Uninvert and clamp
  return 1.0 - min(gridLine, 1.0);
}

void main() {
  float cameraDistanceToGridPlane = max(200.0, distance(cameraPosition.y, worldPosition.y));
  float cameraDistanceToFragmentOnGridPlane = distance(cameraPosition.xyz, worldPosition.xyz);

  // The size of the grid and subgrid are powers of each other and they are determined based on camera distance.
  // The current grid will become the next subgrid when it becomes too small, and its next power becomes the new grid.
  float subGridPower = pow(uDivisions, floor(log(cameraDistanceToGridPlane) / log(uDivisions)));
  float gridPower = subGridPower * uDivisions;

  // If we want to fade both the grid and its subgrid, we need to displays 3 different opacities, with the next grid being the third
  float nextGridPower = gridPower * uDivisions;

  // 1 where grid, 0 where no grid
  float subgrid = getGrid(subGridPower * uScale);
  float grid = getGrid(gridPower * uScale);
  float nextGrid = getGrid(nextGridPower * uScale);

  // Where we are between the introduction of the current grid power and when we switch to the next grid power
  float stepPercentage = (cameraDistanceToGridPlane - subGridPower)/(gridPower - subGridPower);

  // The last x percentage of the current step over which we want to fade
  float fadeRange = 0.3;

  // We calculate the fade percentage from the step percentage and the fade range
  float fadePercentage = max(stepPercentage - 1.0 + fadeRange, 0.0) / fadeRange;

  // Set base opacity based on how close we are to the drawing distance, with a cubic falloff
  float baseOpacity = subgrid * pow(1.0 - min(cameraDistanceToFragmentOnGridPlane / uDistance, 1.0), 3.0);

  // Shade the subgrid
  fragColor = vec4(uColor.rgb, (baseOpacity - fadePercentage) * uSubgridOpacity);

  // Somewhat arbitrary additional fade coefficient to counter anti-aliasing popping when switching between grid powers
  float fadeCoefficient = 0.5;

  // Shade the grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity - fadePercentage * (uGridOpacity - uSubgridOpacity) * fadeCoefficient, grid);

  // Shade the next grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity, nextGrid);

  if (fragColor.a <= minAlpha) discard;
}`;class LZe extends za{constructor(e){super({extensions:{derivatives:!0},uniforms:{uScale:{value:(e==null?void 0:e.scale)!==void 0?e==null?void 0:e.scale:.1},uDivisions:{value:(e==null?void 0:e.divisions)!==void 0?e==null?void 0:e.divisions:10},uColor:{value:(e==null?void 0:e.color)!==void 0?e==null?void 0:e.color:new xn(16777215)},uDistance:{value:(e==null?void 0:e.distance)!==void 0?e==null?void 0:e.distance:1e4},uSubgridOpacity:{value:(e==null?void 0:e.subgridOpacity)!==void 0?e==null?void 0:e.subgridOpacity:.15},uGridOpacity:{value:(e==null?void 0:e.gridOpacity)!==void 0?e==null?void 0:e.gridOpacity:.25}},glslVersion:PH,side:no,transparent:!0,name:"InfiniteGrid",vertexShader:DZe,fragmentShader:OZe})}get color(){return this.uniforms.uColor.value}set color(e){this.uniforms.uColor.value=e}get gridOpacity(){return this.uniforms.uGridOpacity.value}set gridOpacity(e){this.uniforms.uGridOpacity.value=e}get subgridOpacity(){return this.uniforms.uSubgridOpacity.value}set subgridOpacity(e){this.uniforms.uSubgridOpacity.value=e}}class FZe extends fn{constructor(t){const n=new LZe(t);super(new rp,n);Xe(this,"gridMaterial");this.gridMaterial=n,this.frustumCulled=!1,this.name="InfiniteGridHelper"}get color(){return this.gridMaterial.color}set color(t){this.gridMaterial.color=t}get gridOpacity(){return this.gridMaterial.gridOpacity}set gridOpacity(t){this.gridMaterial.gridOpacity=t}get subgridOpacity(){return this.gridMaterial.subgridOpacity}set subgridOpacity(t){this.gridMaterial.subgridOpacity=t}}/**
 * @license
 * Copyright 2010-2026 Three.js Authors
 * SPDX-License-Identifier: MIT
 */Z.BRDF_GGX;Z.BRDF_Lambert;Z.BasicPointShadowFilter;Z.BasicShadowFilter;Z.Break;Z.Const;Z.Continue;Z.DFGLUT;Z.D_GGX;const UZe=Z.Discard;Z.EPSILON;Z.F_Schlick;const aH=Z.Fn;Z.INFINITY;const BZe=Z.If;Z.Loop;Z.NodeAccess;Z.NodeShaderStage;Z.NodeType;Z.NodeUpdateType;Z.PCFShadowFilter;Z.PCFSoftShadowFilter;Z.PI;Z.PI2;Z.TWO_PI;Z.HALF_PI;Z.PointShadowFilter;Z.Return;Z.Schlick_to_F0;Z.ShaderNode;Z.Stack;Z.Switch;Z.TBNViewMatrix;Z.VSMShadowFilter;Z.V_GGX_SmithCorrelated;Z.Var;Z.VarIntent;const nve=Z.abs;Z.acesFilmicToneMapping;Z.acos;Z.add;Z.addMethodChaining;Z.addNodeElement;Z.agxToneMapping;Z.all;Z.alphaT;Z.and;Z.anisotropy;Z.anisotropyB;Z.anisotropyT;Z.any;Z.append;Z.array;Z.arrayBuffer;Z.asin;Z.assign;Z.atan;Z.atomicAdd;Z.atomicAnd;Z.atomicFunc;Z.atomicLoad;Z.atomicMax;Z.atomicMin;Z.atomicOr;Z.atomicStore;Z.atomicSub;Z.atomicXor;Z.attenuationColor;Z.attenuationDistance;Z.attribute;Z.attributeArray;Z.backgroundBlurriness;Z.backgroundIntensity;Z.backgroundRotation;Z.batch;Z.bentNormalView;Z.billboarding;Z.bitAnd;Z.bitNot;Z.bitOr;Z.bitXor;Z.bitangentGeometry;Z.bitangentLocal;Z.bitangentView;Z.bitangentWorld;Z.bitcast;Z.blendBurn;Z.blendColor;Z.blendDodge;Z.blendOverlay;Z.blendScreen;Z.blur;Z.bool;Z.buffer;Z.bufferAttribute;Z.bumpMap;Z.builtin;Z.builtinAOContext;Z.builtinShadowContext;Z.bvec2;Z.bvec3;Z.bvec4;Z.bypass;Z.cache;Z.call;Z.cameraFar;Z.cameraIndex;Z.cameraNear;Z.cameraNormalMatrix;const UN=Z.cameraPosition;Z.cameraProjectionMatrix;Z.cameraProjectionMatrixInverse;Z.cameraViewMatrix;Z.cameraViewport;Z.cameraWorldMatrix;Z.cbrt;Z.cdl;Z.ceil;Z.checker;Z.cineonToneMapping;Z.clamp;Z.clearcoat;Z.clearcoatNormalView;Z.clearcoatRoughness;Z.clipSpace;Z.code;Z.color;Z.colorSpaceToWorking;Z.colorToDirection;Z.compute;Z.computeKernel;Z.computeSkinning;Z.context;Z.convert;Z.convertColorSpace;Z.convertToTexture;Z.countLeadingZeros;Z.countOneBits;Z.countTrailingZeros;Z.cos;Z.cross;Z.cubeTexture;Z.cubeTextureBase;Z.dFdx;Z.dFdy;Z.dashSize;Z.debug;Z.decrement;Z.decrementBefore;Z.defaultBuildStages;Z.defaultShaderStages;Z.defined;Z.degrees;Z.deltaTime;Z.densityFog;Z.densityFogFactor;Z.depth;Z.depthPass;Z.determinant;Z.difference;Z.diffuseColor;Z.directPointLight;Z.directionToColor;Z.directionToFaceDirection;Z.dispersion;const zZe=Z.distance;Z.div;Z.dot;Z.drawIndex;Z.dynamicBufferAttribute;Z.element;Z.emissive;Z.equal;Z.equirectUV;Z.exp;Z.exp2;Z.exponentialHeightFogFactor;Z.expression;Z.faceDirection;Z.faceForward;Z.faceforward;const bu=Z.float;Z.floatBitsToInt;Z.floatBitsToUint;const VZe=Z.floor;Z.fog;const GZe=Z.fract;Z.frameGroup;Z.frameId;Z.frontFacing;const jZe=Z.fwidth;Z.gain;Z.gapSize;Z.getConstNodeType;Z.getCurrentStack;Z.getDirection;Z.getDistanceAttenuation;Z.getGeometryRoughness;Z.getNormalFromDepth;Z.interleavedGradientNoise;Z.vogelDiskSample;Z.getParallaxCorrectNormal;Z.getRoughness;Z.getScreenPosition;Z.getShIrradianceAt;Z.getShadowMaterial;Z.getShadowRenderObjectFunction;Z.getTextureIndex;Z.getViewPosition;Z.globalId;Z.glsl;Z.glslFn;Z.grayscale;Z.greaterThan;Z.greaterThanEqual;Z.hash;Z.highpModelNormalViewMatrix;Z.highpModelViewMatrix;Z.hue;Z.increment;Z.incrementBefore;Z.instance;Z.instanceIndex;Z.instancedArray;Z.instancedBufferAttribute;Z.instancedDynamicBufferAttribute;Z.instancedMesh;Z.int;Z.intBitsToFloat;Z.inverse;Z.inverseSqrt;Z.inversesqrt;Z.invocationLocalIndex;Z.invocationSubgroupIndex;Z.ior;Z.iridescence;Z.iridescenceIOR;Z.iridescenceThickness;Z.ivec2;Z.ivec3;Z.ivec4;Z.js;Z.label;Z.length;Z.lengthSq;Z.lessThan;const HZe=Z.lessThanEqual;Z.lightPosition;Z.lightProjectionUV;Z.lightShadowMatrix;Z.lightTargetDirection;Z.lightTargetPosition;Z.lightViewPosition;Z.lightingContext;Z.lights;const WZe=Z.linearDepth;Z.linearToneMapping;Z.localId;const rve=Z.log;Z.log2;Z.logarithmicDepthToViewZ;Z.luminance;Z.mat2;Z.mat3;Z.mat4;Z.matcapUV;Z.materialAO;Z.materialAlphaTest;Z.materialAnisotropy;Z.materialAnisotropyVector;Z.materialAttenuationColor;Z.materialAttenuationDistance;Z.materialClearcoat;Z.materialClearcoatNormal;Z.materialClearcoatRoughness;Z.materialColor;Z.materialDispersion;Z.materialEmissive;Z.materialEnvIntensity;Z.materialEnvRotation;Z.materialIOR;Z.materialIridescence;Z.materialIridescenceIOR;Z.materialIridescenceThickness;Z.materialLightMap;Z.materialLineDashOffset;Z.materialLineDashSize;Z.materialLineGapSize;Z.materialLineScale;Z.materialLineWidth;Z.materialMetalness;Z.materialNormal;Z.materialOpacity;Z.materialPointSize;Z.materialReference;Z.materialReflectivity;Z.materialRefractionRatio;Z.materialRotation;Z.materialRoughness;Z.materialSheen;Z.materialSheenRoughness;Z.materialShininess;Z.materialSpecular;Z.materialSpecularColor;Z.materialSpecularIntensity;Z.materialSpecularStrength;Z.materialThickness;Z.materialTransmission;const ive=Z.max;Z.maxMipLevel;Z.mediumpModelViewMatrix;Z.metalness;const lH=Z.min,sve=Z.mix;Z.mixElement;Z.mod;Z.modInt;Z.modelDirection;Z.modelNormalMatrix;Z.modelPosition;Z.modelRadius;Z.modelScale;Z.modelViewMatrix;Z.modelViewPosition;Z.modelViewProjection;Z.modelWorldMatrix;Z.modelWorldMatrixInverse;Z.morphReference;Z.mrt;Z.mul;Z.mx_aastep;Z.mx_add;Z.mx_atan2;Z.mx_cell_noise_float;Z.mx_contrast;Z.mx_divide;Z.mx_fractal_noise_float;Z.mx_fractal_noise_vec2;Z.mx_fractal_noise_vec3;Z.mx_fractal_noise_vec4;Z.mx_frame;Z.mx_heighttonormal;Z.mx_hsvtorgb;Z.mx_ifequal;Z.mx_ifgreater;Z.mx_ifgreatereq;Z.mx_invert;Z.mx_modulo;Z.mx_multiply;Z.mx_noise_float;Z.mx_noise_vec3;Z.mx_noise_vec4;Z.mx_place2d;Z.mx_power;Z.mx_ramp4;Z.mx_ramplr;Z.mx_ramptb;Z.mx_rgbtohsv;Z.mx_rotate2d;Z.mx_rotate3d;Z.mx_safepower;Z.mx_separate;Z.mx_splitlr;Z.mx_splittb;Z.mx_srgb_texture_to_lin_rec709;Z.mx_subtract;Z.mx_timer;Z.mx_transform_uv;Z.mx_unifiednoise2d;Z.mx_unifiednoise3d;Z.mx_worley_noise_float;Z.mx_worley_noise_vec2;Z.mx_worley_noise_vec3;Z.negate;Z.neutralToneMapping;Z.nodeArray;Z.nodeImmutable;Z.nodeObject;Z.nodeObjectIntent;Z.nodeObjects;Z.nodeProxy;Z.nodeProxyIntent;Z.normalFlat;Z.normalGeometry;Z.normalLocal;Z.normalMap;Z.normalView;Z.normalViewGeometry;Z.normalWorld;Z.normalWorldGeometry;Z.normalize;Z.not;Z.notEqual;Z.numWorkgroups;Z.objectDirection;Z.objectGroup;Z.objectPosition;Z.objectRadius;Z.objectScale;Z.objectViewPosition;Z.objectWorldMatrix;Z.OnBeforeObjectUpdate;Z.OnBeforeMaterialUpdate;Z.OnObjectUpdate;Z.OnMaterialUpdate;Z.oneMinus;Z.or;Z.orthographicDepthToViewZ;Z.oscSawtooth;Z.oscSine;Z.oscSquare;Z.oscTriangle;Z.output;Z.outputStruct;Z.overloadingFn;Z.packHalf2x16;Z.packSnorm2x16;Z.packUnorm2x16;Z.parabola;Z.parallaxDirection;Z.parallaxUV;Z.parameter;Z.pass;Z.passTexture;Z.pcurve;Z.perspectiveDepthToViewZ;Z.pmremTexture;Z.pointShadow;Z.pointUV;Z.pointWidth;Z.positionGeometry;const qZe=Z.positionLocal;Z.positionPrevious;Z.positionView;Z.positionViewDirection;Z.positionWorld;Z.positionWorldDirection;Z.posterize;const ove=Z.pow;Z.pow2;Z.pow3;Z.pow4;Z.premultiplyAlpha;Z.property;Z.radians;Z.rand;Z.range;Z.rangeFog;Z.rangeFogFactor;Z.reciprocal;Z.reference;Z.referenceBuffer;Z.reflect;Z.reflectVector;Z.reflectView;Z.reflector;Z.refract;Z.refractVector;Z.refractView;Z.reinhardToneMapping;Z.remap;const $Ze=Z.remapClamp;Z.renderGroup;Z.renderOutput;Z.rendererReference;Z.replaceDefaultUV;Z.rotate;Z.rotateUV;Z.roughness;Z.round;Z.rtt;Z.sRGBTransferEOTF;Z.sRGBTransferOETF;Z.sample;Z.sampler;Z.samplerComparison;Z.saturate;Z.saturation;Z.screen;Z.screenCoordinate;Z.screenDPR;Z.screenSize;Z.screenUV;Z.select;Z.setCurrentStack;Z.setName;Z.shaderStages;Z.shadow;Z.shadowPositionWorld;Z.shapeCircle;Z.sharedUniformGroup;Z.sheen;Z.sheenRoughness;Z.shiftLeft;Z.shiftRight;Z.shininess;Z.sign;Z.sin;Z.sinc;Z.skinning;Z.smoothstep;Z.smoothstepElement;Z.specularColor;Z.specularF90;Z.spherizeUV;Z.split;Z.spritesheetUV;Z.sqrt;Z.stack;Z.step;Z.stepElement;Z.storage;Z.storageBarrier;Z.storageTexture;Z.string;Z.struct;Z.sub;Z.subgroupAdd;Z.subgroupAll;Z.subgroupAnd;Z.subgroupAny;Z.subgroupBallot;Z.subgroupBroadcast;Z.subgroupBroadcastFirst;Z.subBuild;Z.subgroupElect;Z.subgroupExclusiveAdd;Z.subgroupExclusiveMul;Z.subgroupInclusiveAdd;Z.subgroupInclusiveMul;Z.subgroupIndex;Z.subgroupMax;Z.subgroupMin;Z.subgroupMul;Z.subgroupOr;Z.subgroupShuffle;Z.subgroupShuffleDown;Z.subgroupShuffleUp;Z.subgroupShuffleXor;Z.subgroupSize;Z.subgroupXor;Z.tan;Z.tangentGeometry;Z.tangentLocal;Z.tangentView;Z.tangentWorld;Z.texture;Z.texture3D;Z.textureBarrier;Z.textureBicubic;Z.textureBicubicLevel;Z.textureCubeUV;Z.textureLoad;Z.textureSize;Z.textureLevel;Z.textureStore;Z.thickness;Z.time;Z.toneMapping;Z.toneMappingExposure;Z.toonOutlinePass;Z.transformDirection;Z.transformNormal;Z.transformNormalToView;Z.transformedClearcoatNormalView;Z.transformedNormalView;Z.transformedNormalWorld;Z.transmission;Z.transpose;Z.triNoise3D;Z.triplanarTexture;Z.triplanarTextures;Z.trunc;Z.uint;Z.uintBitsToFloat;const U_=Z.uniform;Z.uniformArray;Z.uniformCubeTexture;Z.uniformGroup;Z.uniformFlow;Z.uniformTexture;Z.unpackHalf2x16;Z.unpackSnorm2x16;Z.unpackUnorm2x16;Z.unpremultiplyAlpha;Z.userData;const XZe=Z.uv;Z.uvec2;Z.uvec3;Z.uvec4;Z.varying;const YZe=Z.varyingProperty;Z.vec2;const KZe=Z.vec3,z$=Z.vec4;Z.vectorComponents;Z.velocity;Z.vertexColor;Z.vertexIndex;Z.vertexStage;Z.vibrance;Z.viewZToLogarithmicDepth;Z.viewZToOrthographicDepth;Z.viewZToPerspectiveDepth;Z.viewZToReversedOrthographicDepth;Z.viewZToReversedPerspectiveDepth;Z.viewport;Z.viewportCoordinate;Z.viewportDepthTexture;Z.viewportLinearDepth;Z.viewportMipTexture;Z.viewportOpaqueMipTexture;Z.viewportResolution;Z.viewportSafeUV;Z.viewportSharedTexture;Z.viewportSize;Z.viewportTexture;Z.viewportUV;Z.wgsl;Z.wgslFn;Z.workgroupArray;Z.workgroupBarrier;Z.workgroupId;Z.workingToColorSpace;Z.xor;class ZZe extends No{constructor(t){super();Xe(this,"uScale");Xe(this,"uDivisions");Xe(this,"uColor");Xe(this,"uDistance");Xe(this,"uSubgridOpacity");Xe(this,"uGridOpacity");this.name="InfiniteGrid",this.side=no,this.transparent=!0,this.uScale=U_((t==null?void 0:t.scale)??.1),this.uDivisions=U_((t==null?void 0:t.divisions)??10),this.uColor=U_((t==null?void 0:t.color)??new xn(16777215)),this.uDistance=U_((t==null?void 0:t.distance)??1e4),this.uSubgridOpacity=U_((t==null?void 0:t.subgridOpacity)??.15),this.uGridOpacity=U_((t==null?void 0:t.gridOpacity)??.25);const{uScale:n,uDivisions:r,uColor:s,uDistance:a,uSubgridOpacity:c,uGridOpacity:d}=this,p=YZe("vec3","vWorldPosition");this.positionNode=aH(()=>{const x=qZe.xzy.mul(a).add(KZe(UN.x,bu(0),UN.z));return p.assign(x),x})();const y=aH(([x])=>{const w=p.xz.div(x),C=jZe(w),N=nve(GZe(w.sub(.5)).sub(.5)).div(C).div(2),F=lH(N.x,N.y);return bu(1).sub(lH(F,bu(1)))});this.outputNode=aH(()=>{const x=p,w=ive(bu(200),nve(UN.y.sub(x.y))),C=bu(zZe(UN,x)),N=rve(w).div(rve(r)),F=ove(r,VZe(N)),U=F.mul(r),R=U.mul(r),B=y(F.mul(n)),Y=y(U.mul(n)),A=y(R.mul(n)),ne=w.sub(F).div(U.sub(F)),se=bu(.3),oe=ive(ne.sub(bu(1)).add(se),bu(0)).div(se),G=B.mul(ove(bu(1).sub(lH(C.div(a),bu(1))),bu(3))),ie=bu(.5),Me=G.sub(oe).mul(c),X=sve(Me,G.mul(d).sub(oe.mul(d.sub(c)).mul(ie)),Y),De=bu(sve(X,G.mul(d),A));return BZe(HZe(De,bu(1/127)),()=>{UZe()}),z$(s,De)})()}get color(){return this.uColor.value}set color(t){this.uColor.value=t}get gridOpacity(){return this.uGridOpacity.value}set gridOpacity(t){this.uGridOpacity.value=t}get subgridOpacity(){return this.uSubgridOpacity.value}set subgridOpacity(t){this.uSubgridOpacity.value=t}}class QZe extends fn{constructor(t){const n=new ZZe(t);super(new rp,n);Xe(this,"gridMaterial");this.gridMaterial=n,this.frustumCulled=!1,this.name="InfiniteGridHelper"}get color(){return this.gridMaterial.color}set color(t){this.gridMaterial.color=t}get gridOpacity(){return this.gridMaterial.gridOpacity}set gridOpacity(t){this.gridMaterial.gridOpacity=t}get subgridOpacity(){return this.gridMaterial.subgridOpacity}set subgridOpacity(t){this.gridMaterial.subgridOpacity=t}}function ZT(i){const[e,t]=Nn.useState(i.open!==void 0?i.open:!1),[n,r]=Nn.useState(i.visible!==void 0?i.visible:!1),s=!e||i.children===void 0,a=()=>{i.three.dispatchEvent({type:_i.REMOVE_SCENE,value:i.scene})};return rt.jsxs("div",{className:`accordion ${s?"hide":""}`,children:[rt.jsxs("button",{className:"toggle",onClick:()=>{const c=!e;i.onToggle!==void 0&&i.onToggle(c),t(c)},children:[rt.jsx("p",{className:`status ${e?"open":""}`,children:"Toggle"}),rt.jsx("p",{className:"label",children:ak(i.label)})]}),i.onRefresh?rt.jsxs(rt.Fragment,{children:[rt.jsx("button",{className:"visibility",style:{opacity:n?1:.25},onClick:()=>{const d=i.three.getScene(i.scene.uuid);if(d){const p=!d.visible;d.visible=p,r(p)}}}),rt.jsx("button",{className:"refresh",onClick:i.onRefresh}),rt.jsx("button",{className:"remove",onClick:a})]}):null,i.button,rt.jsx("div",{className:e?"open":"",children:rt.jsx("div",{children:i.children})},Math.random())]})}function FT(i){const[e,t]=Nn.useState(i.defaultValue);return Nn.useEffect(()=>{var C,N;let n=!1,r=-1,s=0,a=i.defaultValue,c=!1;const d=F=>{c=F.ctrlKey},p=F=>{var U;n=!0,s=Number((U=i.input.current)==null?void 0:U.value),r=F.clientX,document.addEventListener("mouseup",x,!1),document.addEventListener("mousemove",y,!1),document.addEventListener("contextmenu",x,!1)},y=F=>{if(!n)return;const U=i.step!==void 0?i.step:1,R=(F.clientX-r)*U*(c?10:1);a=Number((s+R).toFixed(4)),i.min!==void 0&&(a=Math.max(a,i.min)),i.max!==void 0&&(a=Math.min(a,i.max)),i.onChange!==void 0&&i.onChange(a),t(a)},x=()=>{n=!1,document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",y),document.removeEventListener("contextmenu",x)},w=F=>{const U=Number(F.target.value);i.onChange!==void 0&&i.onChange(U),t(U)};return(C=i.label.current)==null||C.addEventListener("mousedown",p,!1),i.sliderRef!==void 0&&((N=i.sliderRef.current)==null||N.addEventListener("input",w)),document.addEventListener("keydown",d,!1),document.addEventListener("keyup",d,!1),()=>{var F,U;(F=i.label.current)==null||F.removeEventListener("mousedown",p),i.sliderRef!==void 0&&((U=i.sliderRef.current)==null||U.removeEventListener("input",w)),document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",y),document.removeEventListener("contextmenu",x),document.removeEventListener("keydown",d),document.addEventListener("keyup",d,!1)}},[]),e}function n6(i){const e=Nn.useRef(null),t=Nn.useRef(null),[n,r]=Nn.useState(i.value);return FT({label:i.labelRef,input:e,sliderRef:t,defaultValue:n,min:i.min,max:i.max,step:i.step,onChange:s=>{r(s),i.onChange!==void 0&&i.onChange(i.prop,s)}}),rt.jsxs(rt.Fragment,{children:[i.type==="number"&&rt.jsx("input",{alt:i.alt,className:i.className,ref:e,type:"number",value:n,min:i.min,max:i.max,step:i.step,disabled:i.disabled,name:nl(),onChange:s=>{if(r(s.target.value),s.target.value.length===0)return;const a=Number(s.target.value);isNaN(a)||i.onChange!==void 0&&i.onChange(i.prop,a)}}),i.type==="range"&&rt.jsxs(rt.Fragment,{children:[rt.jsx("input",{type:"text",value:n.toString(),disabled:i.disabled,ref:e,className:"min",name:nl(),onChange:s=>{if(s.target.value.length===0)return;const a=Number(s.target.value);isNaN(a)||(r(a),i.onChange!==void 0&&i.onChange(i.prop,a))}}),rt.jsx("input",{disabled:i.disabled,type:"range",value:n,min:i.min,max:i.max,step:i.step,ref:t,name:nl(),onChange:b8e})]})]})}function JZe(i){const e=Nn.useRef(null),t=Nn.useRef(null),n=Nn.useRef(null),r=Nn.useRef(null),s=Nn.useRef(null),a=Nn.useRef(null),c=Nn.useRef(null),d=Nn.useRef(null),p=Nn.useRef(null),y=Nn.useRef(null),[x,w]=Nn.useState(i.value.x),[C,N]=Nn.useState(i.value.y),[F,U]=Nn.useState({min:Math.min(i.min,Math.min(i.value.x,i.value.y)),max:Math.max(i.max,Math.max(i.value.x,i.value.y))}),[R,B]=Nn.useState(!1);FT({label:c,input:e,defaultValue:x,min:F.min,max:F.max,step:.01,onChange:ie=>{w(ie),i.onChange({target:{value:{x:ie,y:C}}})}}),FT({label:d,input:t,defaultValue:C,min:F.min,max:F.max,step:.01,onChange:ie=>{N(ie),i.onChange({target:{value:{x,y:ie}}})}}),FT({label:p,input:n,defaultValue:F.min,min:F.min-1,max:F.max+1,step:.01,onChange:ie=>{U({min:ie,max:F.max})}}),FT({label:y,input:r,defaultValue:F.max,min:F.min-1,max:F.max+1,step:.01,onChange:ie=>{U({min:F.min,max:ie})}});function Y(){R||(window.addEventListener("mousemove",ne),window.addEventListener("mouseup",A),B(!0))}function A(){window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",A),B(!1)}function ne(ie){const Me=s.current.getBoundingClientRect(),X=F8(0,99,ie.clientX-Me.left)/99,De=1-F8(0,99,ie.clientY-Me.top)/99,$e=Yf(jH(F.min,F.max,X),3),ot=Yf(jH(F.min,F.max,De),3);i.onChange({target:{value:{x:$e,y:ot}}}),w($e),N(ot)}function se(){const ie=Number(n.current.value);U({min:ie,max:F.max}),x<ie&&w(F8(ie,F.max,x)),C<ie&&N(F8(ie,F.max,C))}function oe(){const ie=Number(r.current.value);U({min:F.min,max:ie}),x>ie&&w(F8(F.min,ie,x)),C>ie&&N(F8(F.min,ie,C))}Nn.useEffect(()=>{a.current.style.left=`${S4e(F.min,F.max,x)*100}%`,a.current.style.top=`${(1-S4e(F.min,F.max,C))*100}%`},[F,x,C]);const G=i.step!==void 0?i.step:.01;return rt.jsxs("div",{className:"vector2",children:[rt.jsxs("div",{className:"fields",children:[rt.jsxs("div",{children:[rt.jsx("span",{ref:c,children:"X"}),rt.jsx("input",{ref:e,type:"number",value:x,min:F.min,max:F.max,step:G,name:nl(),onChange:ie=>{if(w(ie.target.value),ie.target.value.length===0)return;const Me=Number(ie.target.value);isNaN(Me)||(i.onChange({target:{value:{x:Me,y:C}}}),Me<F.min&&U({min:Me,max:F.max}))}})]}),rt.jsxs("div",{children:[rt.jsx("span",{ref:d,children:"Y"}),rt.jsx("input",{ref:t,type:"number",value:C,min:F.min,max:F.max,step:G,name:nl(),onChange:ie=>{if(N(ie.target.value),ie.target.value.length===0)return;const Me=Number(ie.target.value);isNaN(Me)||(i.onChange({target:{value:{x,y:Me}}}),Me>F.max&&U({min:F.min,max:Me}))}})]}),rt.jsxs("div",{children:[rt.jsx("span",{ref:p,children:"Min"}),rt.jsx("input",{ref:n,type:"number",value:F.min,step:G,name:nl(),onChange:se})]}),rt.jsxs("div",{children:[rt.jsx("span",{ref:y,children:"Max"}),rt.jsx("input",{ref:r,type:"number",value:F.max,step:G,name:nl(),onChange:oe})]})]}),rt.jsxs("div",{className:"input",ref:s,onMouseDown:Y,onMouseUp:A,children:[rt.jsx("div",{className:"x"}),rt.jsx("div",{className:"y"}),rt.jsx("div",{className:"pt",ref:a})]})]})}function ave(i){const e=i.value.x!==void 0&&i.value.y!==void 0&&i.value.z!==void 0,t=i.value.isEuler!==void 0,n=i.value.elements!==void 0,r=i.step!==void 0?i.step:.01,s=[];if(t){const a=Nn.useMemo(()=>i.value,[]);["_x","_y","_z"].forEach(d=>{const p=Nn.useRef(null);s.push(rt.jsxs("div",{children:[rt.jsx("span",{ref:p,children:d.substring(1).toUpperCase()}),rt.jsx(n6,{value:RZe(a[d]),type:"number",prop:d,step:.1,labelRef:p,onChange:(y,x)=>{a[y]=gW(x),i.onChange({target:{value:a}})}})]},d))})}else if(e){const a=Nn.useMemo(()=>i.value,[]),c=(p,y)=>{a[p]=y,i.onChange({target:{value:a}})};["x","y","z"].forEach(p=>{const y=Nn.useRef(null);s.push(rt.jsxs("div",{children:[rt.jsx("label",{ref:y,children:p.toUpperCase()}),rt.jsx(n6,{value:a[p],type:"number",prop:p,step:r,labelRef:y,onChange:c})]},p))})}else if(n){const a=Nn.useMemo(()=>i.value,[]),c=(d,p)=>{const y=Number(d);a.elements[y]=p,i.onChange({target:{value:a}})};for(let d=0;d<9;d++){const p=Nn.useRef(null);s.push(rt.jsxs("div",{children:[rt.jsx("label",{ref:p,children:d+1}),rt.jsx(n6,{value:a.elements[d],type:"number",prop:d.toString(),step:r,labelRef:p,onChange:c})]},d.toString()))}}return rt.jsx("div",{className:"grid3",children:s},Math.random().toString())}function eQe(i){const e=i.value.x!==void 0,t=i.step!==void 0?i.step:.01,n=[];if(e){const r=Nn.useMemo(()=>i.value,[]),s=(c,d)=>{r[c]=d,i.onChange({target:{value:r}})};["x","y","z","w"].forEach(c=>{const d=Nn.useRef(null);n.push(rt.jsxs("div",{children:[rt.jsx("label",{ref:d,children:c.toUpperCase()}),rt.jsx(n6,{value:r[c],type:"number",prop:c,step:t,labelRef:d,onChange:s})]},c))})}else{const r=Nn.useMemo(()=>i.value,[]),s=(a,c)=>{const d=Number(a);r.elements[d]=c,i.onChange({target:{value:r}})};for(let a=0;a<16;a++){const c=Nn.useRef(null);n.push(rt.jsxs("div",{children:[rt.jsx("span",{ref:c,children:a+1}),rt.jsx(n6,{value:r.elements[a],type:"number",prop:a.toString(),step:t,labelRef:c,onChange:s})]},a.toString()))}}return rt.jsx("div",{className:"grid4",children:n})}function tQe(i){return!(i==="defaultAttributeValues"||i==="forceSinglePass"||i==="linecap"||i==="linejoin"||i==="linewidth"||i==="normalMapType"||i==="precision"||i==="shadowSide"||i==="uniformsGroups"||i==="uniformsNeedUpdate"||i==="userData"||i==="version"||i==="wireframeLinecap"||i==="wireframeLinejoin"||i==="wireframeLinewidth"||i.slice(0,4)==="clip"||i.slice(0,7)==="polygon"||i.slice(0,7)==="stencil"||i.slice(0,2)==="is")}function nQe(i){switch(i){case"Alpha Map":return"alphaMap";case"Anisotropy Map":return"anisotropyMap";case"AO Map":return"aoMap";case"Bump Map":return"bumpMap";case"Clearcoat Map":return"clearcoatMap";case"Clearcoat Normal Map":return"clearcoatNormalMap";case"Clearcoat Roughness Map":return"clearcoatRoughnessMap";case"Displacement Map":return"displacementMap";case"Emissive Map":return"emissiveMap";case"Gradient Map":return"gradientMap";case"Iridescence Map":return"iridescenceMap";case"Iridescence Thickness Map":return"iridescenceThicknessMap";case"Map":return"map";case"Matcap":return"matcap";case"Normal Map":return"normalMap";case"Roughness Map":return"roughnessMap";case"Sheen Color Map":return"sheenColorMap";case"Sheen Roughness Map":return"sheenRoughnessMap";case"Specular Color Map":return"specularColorMap";case"Specular Map Intensity":return"specularIntensityMap";case"Thickness Map":return"thicknessMap";case"Transmission Map":return"transmissionMap"}return i}function CD(i){switch(i){case"alphaHash":return"Alpha Hash";case"alphaMap":return"Alpha Map";case"alphaToCoverage":return"Alpha To Coverage";case"anisotropy":return"Anisotropy";case"anisotropyMap":return"Anisotropy Map";case"anisotropyRotation":return"Anisotropy Rotation";case"aoMap":return"AO Map";case"aoMapIntensity":return"AO Map Intensity";case"attenuationColor":return"Attenuation Color";case"attenuationDistance":return"Attenuation Distance";case"blendAlpha":return"Blend Alpha";case"blendColor":return"Blend Color";case"blendDst":return"Blend Dst";case"blendDstAlpha":return"Blend Dst Alha";case"blendEquation":return"Blend Equation";case"blendEquationAlpha":return"Blend Equation Alpha";case"blending":return"Blending";case"blendSrc":return"Blend Src";case"blendSrcAlpha":return"Blend Src Alpha";case"bumpMap":return"Bump Map";case"bumpScale":return"Bump Scale";case"clearcoat":return"Clearcoat";case"clearcoatMap":return"Clearcoat Map";case"clearcoatNormalMap":return"Clearcoat Normal Map";case"clearcoatNormalScale":return"Clearcoat Normal Scale";case"clearcoatRoughness":return"Clearcoat Roughness";case"clearcoatRoughnessMap":return"Clearcoat Roughness Map";case"color":return"Color";case"colorWrite":return"Color Write";case"defines":return"Defines";case"depthFunc":return"Depth Func";case"depthTest":return"Depth Test";case"depthWrite":return"Depth Write";case"dispersion":return"Dispersion";case"displacementBias":return"Displacement Bias";case"displacementMap":return"Displacement Map";case"displacementScale":return"Displacement Scale";case"dithering":return"Dithering";case"emissive":return"Emissive";case"emissiveMap":return"Emissive Map";case"emissiveIntensity":return"Emissive Intensity";case"envMap":return"Environment Map";case"envMapIntensity":return"Environment Map Intensity";case"envMapRotation":return"Environment Map Rotation";case"extensions":return"Extensions";case"flatShading":return"Flat Shading";case"fragmentShader":return"Fragment Shader";case"fog":return"Fog";case"glslVersion":return"GLSL Version";case"gradientMap":return"Gradient Map";case"ior":return"IOR";case"iridescence":return"Iridescence";case"iridescenceIOR":return"Iridescence IOR";case"iridescenceMap":return"Iridescence Map";case"iridescenceThicknessMap":return"Iridescence Thickness Map";case"iridescenceThicknessRange":return"Iridescence Thickness Range";case"lights":return"Lights";case"lightMap":return"Light Map";case"lightMapIntensity":return"Light Map Intensity";case"map":return"Map";case"matcap":return"Matcap";case"metalness":return"Metalness";case"metalnessMap":return"Metalness Map";case"name":return"Name";case"normalMap":return"Normal Map";case"normalScale":return"Normal Scale";case"premultipliedAlpha":return"Premultiplied Alpha";case"opacity":return"Opacity";case"reflectivity":return"Reflectivity";case"refractionRatio":return"Refraction Ratio";case"roughness":return"Roughness";case"roughnessMap":return"Roughness Map";case"sheen":return"Sheen";case"sheenColor":return"Sheen Color";case"sheenColorMap":return"Sheen Color Map";case"sheenRoughness":return"Sheen Roughness";case"sheenRoughnessMap":return"Sheen Roughness Map";case"shininess":return"Shininess";case"side":return"Side";case"size":return"Size";case"sizeAttenuation":return"Size Attenuation";case"specular":return"Specular";case"specularColor":return"Specular Color";case"specularColorMap":return"Specular Color Map";case"specularIntensity":return"Specular Intensity";case"specularIntensityMap":return"Specular Map Intensity";case"thickness":return"Thickness";case"thicknessMap":return"Thickness Map";case"toneMapped":return"Tone Mapped";case"transmission":return"Transmission";case"transmissionMap":return"Transmission Map";case"transparent":return"Transparent";case"type":return"Type";case"uuid":return"UUID";case"uniforms":return"Uniforms";case"vertexColors":return"Vertex Colors";case"vertexShader":return"Vertex Shader";case"visible":return"Visible";case"wireframe":return"Wireframe"}return i}function uxe(i){const e=i.toLowerCase();return e.search("intensity")>-1||e==="anisotropyrotation"||e==="blendalpha"||e==="bumpscale"||e==="clearcoatroughness"||e==="displacementbias"||e==="displacementscale"||e==="metalness"||e==="opacity"||e==="reflectivity"||e==="refractionratio"||e==="roughness"||e==="sheenroughness"}function rQe(){const i=document.createElement("input");return i.type="file",new Promise((e,t)=>{i.addEventListener("change",function(){if(i.files===null)t();else{const n=i.files[0],r=new FileReader;r.onload=function(s){e(s.target.result)},r.readAsDataURL(n)}}),i.click()})}const iQe=[{title:"Front",value:ol},{title:"Back",value:Ui},{title:"Double",value:no}],sQe=[{title:"No Blending",value:vo},{title:"Normal",value:rl},{title:"Additive",value:p2},{title:"Subtractive",value:m2},{title:"Multiply",value:g2},{title:"Custom",value:m4}],oQe=[{title:"Add",value:A0},{title:"Subtract",value:Pk},{title:"Reverse Subtract",value:Rk},{title:"Min",value:wW},{title:"Max",value:TW}],aQe=[{title:"Zero",value:Xf},{title:"One",value:CE},{title:"Src Color",value:AE},{title:"One Minus Src Color",value:PE},{title:"Src Alpha",value:E4},{title:"One Minus Src Alpha",value:M4},{title:"Dst Alpha",value:RE},{title:"One Minus Dst Alpha",value:IE},{title:"Dst Color",value:NE},{title:"One Minus Dst Color",value:kE},{title:"Src Alpha Saturate",value:Ik},{title:"Constant Color",value:EW},{title:"One Minus Constant Color",value:MW},{title:"Constant Alpha",value:CW},{title:"One Minus Constant Alpha",value:AW}],lQe=[{title:"Zero",value:Xf},{title:"One",value:CE},{title:"Src Color",value:AE},{title:"One Minus Src Color",value:PE},{title:"Src Alpha",value:E4},{title:"One Minus Src Alpha",value:M4},{title:"Dst Alpha",value:RE},{title:"One Minus Dst Alpha",value:IE},{title:"Dst Color",value:NE},{title:"One Minus Dst Color",value:kE},{title:"Constant Color",value:EW},{title:"One Minus Constant Color",value:MW},{title:"Constant Alpha",value:CW},{title:"One Minus Constant Alpha",value:AW}];function ET(i,e){i.needsUpdate=!0,i.type="option",i.options=e}function cQe(i,e,t,n){return{type:"boolean",title:CD(i),prop:i,value:e,needsUpdate:!0,onChange:(r,s)=>{n.updateObject(t.uuid,`material.${i}`,s),n.updateObject(t.uuid,"material.needsUpdate",!0);const a=n.getScene(t.uuid);if(a!==null){const c=a.getObjectByProperty("uuid",t.uuid);Ea(c,`material.${i}`,s)}}}}function uQe(i,e,t,n){const r={type:"number",title:CD(i),prop:i,value:e,min:void 0,max:void 0,step:.01,needsUpdate:!0,onChange:(s,a)=>{n.updateObject(t.uuid,`material.${i}`,a),n.updateObject(t.uuid,"material.needsUpdate",!0);const c=n.getScene(t.uuid);if(c!==null){const d=c.getObjectByProperty("uuid",t.uuid);Ea(d,`material.${i}`,a)}}};switch(i){case"blending":ET(r,sQe);break;case"blendDst":ET(r,lQe);break;case"blendEquation":ET(r,oQe);break;case"blendSrc":ET(r,aQe);break;case"side":ET(r,iQe);break}return uxe(i)&&(r.value=Number(e),r.type="range",r.min=Math.min(0,r.value),r.max=Math.max(1,r.value),r.step=.01),r}function dQe(i,e,t,n){const r={type:"string",title:CD(i),prop:i,value:e,needsUpdate:!0,onChange:(a,c)=>{n.updateObject(t.uuid,`material.${i}`,c),n.updateObject(t.uuid,"material.needsUpdate",!0);const d=n.getScene(t.uuid);if(d!==null){const p=d.getObjectByProperty("uuid",t.uuid);Ea(p,`material.${i}`,c)}},onKeyDown:a=>{}};return(i==="vertexShader"||i==="fragmentShader")&&(r.type="field",r.disabled=!1,r.latest=r.value,r.onChange=(a,c)=>{r.latest=c,n.updateObject(t.uuid,`material.${i}`,c);const d=n.getScene(t.uuid);if(d!==null){const p=d.getObjectByProperty("uuid",t.uuid);Ea(p,`material.${i}`,c)}},r.onKeyDown=a=>{if(a.key==="Enter"&&(a.altKey||a.metaKey)){n.updateObject(t.uuid,"material.needsUpdate",!0);const c=n.getScene(t.uuid);if(c!==null){const d=c.getObjectByProperty("uuid",t.uuid);Ea(d,"material.needsUpdate",!0)}}}),r}function hQe(i){return i.x!==void 0&&i.y!==void 0&&i.z===void 0}function fQe(i){return i.x!==void 0&&i.y!==void 0&&i.z!==void 0&&i.w===void 0}function pQe(i){return i.x!==void 0&&i.y!==void 0&&i.z!==void 0&&i.w!==void 0}function vW(i){i.sort((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)}function UT(i,e,t,n,r="",s=!1){const a=CD(i).split(".")[0].replaceAll("[","").replaceAll("]",""),c=r.length>0?`${r}.${i}`:i,d=typeof e;if(d==="boolean"||d==="string")return{title:a,prop:c,type:d,value:e,disabled:s,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const w=x.getObjectByProperty("uuid",t.uuid);Ea(w,`material.${c}`,y)}}};if(d==="number"){const p={title:a,prop:c,type:"number",value:e,step:.01,disabled:s,onChange:(y,x)=>{n.updateObject(t.uuid,`material.${c}`,x);const w=n.getScene(t.uuid);if(w!==null){const C=w.getObjectByProperty("uuid",t.uuid);Ea(C,`material.${c}`,x)}}};return uxe(a)&&(p.type="range",p.min=0,p.max=1),p}else{if(e.isColor)return{title:a,prop:c,type:"color",value:e,disabled:s,onChange:(p,y)=>{const x=new xn(y);n.updateObject(t.uuid,`material.${c}`,x);const w=n.getScene(t.uuid);if(w!==null){const C=w.getObjectByProperty("uuid",t.uuid);Ea(C,`material.${c}`,x)}}};if(Array.isArray(e)){const p=[];for(const y in e){const x=e[y],w=`[${y.toString()}]`;if(x.value!==void 0){const C=UT(`${w}.value`,x.value,t,n,c,s);C!==void 0&&p.push(C)}else{const C=UT(w,x,t,n,c,s);C!==void 0&&p.push(C)}}if(p.length>0)return vW(p),{title:a,items:p}}else{if(hQe(e))return{title:a,prop:c,type:"vector2",value:e,disabled:s,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const w=x.getObjectByProperty("uuid",t.uuid);Ea(w,`material.${c}`,y)}}};if(fQe(e))return{title:a,prop:c,type:"grid3",value:e,disabled:s,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const w=x.getObjectByProperty("uuid",t.uuid);Ea(w,`material.${c}`,y)}}};if(pQe(e))return{title:a,prop:c,type:"grid4",value:e,disabled:s,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const w=x.getObjectByProperty("uuid",t.uuid);Ea(w,`material.${c}`,y)}}};if(e.isEuler)return{title:a,prop:c,type:"euler",value:e,disabled:s,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const w=x.getObjectByProperty("uuid",t.uuid);Ea(w,`material.${c}`,y)}}};if(e.src!==void 0)return{title:a,type:"image",value:e,disabled:s,onChange:(p,y)=>{const x=nQe(i),w=r.length>0?`${r}.${x}`:x;n.createTexture(t.uuid,`material.${w}`,y);const C=n.getScene(t.uuid);if(C!==null){const N=C.getObjectByProperty("uuid",t.uuid);if(N!==void 0){const F=U=>{const R=N.material,B=w.split(".");switch(B.length){case 1:R[B[0]]=U;break;case 2:R[B[0]][B[1]]=U;break;case 3:R[B[0]][B[1]][B[2]]=U;break;case 4:R[B[0]][B[1]][B[2]][B[3]]=U;break;case 5:R[B[0]][B[1]][B[2]][B[3]][B[4]]=U;break}R.needsUpdate=!0};y.src.length>0?oq(y.src).then(U=>{U.offset.set(y.offset[0],y.offset[1]),U.repeat.set(y.repeat[0],y.repeat[1]),F(U)}):F(null)}}}};if(e.elements!==void 0)return{title:a,prop:c,type:e.elements.length>9?"grid4":"grid3",value:e,disabled:s,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${c}`,y);const x=n.getScene(t.uuid);if(x!==null){const w=x.getObjectByProperty("uuid",t.uuid);Ea(w,`material.${c}`,y)}}};{const p=[],y=i==="defines"||i==="extensions";try{for(const x in e){const w=e[x];if(w!==void 0)if(w.value!==void 0){const C=UT(`${x}.value`,w.value,t,n,c,y);C!==void 0&&p.push(C)}else{const C=UT(x,w,t,n,c,y);C!==void 0&&p.push(C)}}}catch{console.log("Hermes - Issue cycling through material object:",i,e)}if(p.length>0)return vW(p),{title:a,items:p}}}}}function lve(i,e,t){const n=[];for(const r in i){if(!tQe(r)||r.search("Node")>-1)continue;const s=typeof i[r],a=i[r];if(s==="boolean")n.push(cQe(r,a,e,t));else if(s==="number")n.push(uQe(r,a,e,t));else if(s==="string")n.push(dQe(r,a,e,t));else if(s==="object"){const c=UT(r,a,e,t);c!==void 0&&n.push(c)}else a!==void 0&&console.log("Hermes - Other Material Prop Type:",r,s,a)}return vW(n),n.push({title:"Update Material",type:"button",onChange:()=>{t.updateObject(e.uuid,"material.needsUpdate",!0);const r=t.getScene(e.uuid);if(r!==null){const s=r.getObjectByProperty("uuid",e.uuid);Ea(s,"material.needsUpdate",!0)}}}),n}function mQe(i,e){function t(){return`${e.name}_material`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function s(c){localStorage.setItem(t(),c?"open":"closed")}const a=i.material;if(Array.isArray(a)){const c=[],d=a.length;for(let p=0;p<d;p++)c.push(rt.jsx(Rh,{three:e,title:`Material ${p}`,items:lve(a[p],i,e)},`Material ${p}`));return rt.jsx(rt.Fragment,{children:c})}else return rt.jsx(Rh,{three:e,title:"Material",items:lve(a,i,e),expanded:r,onToggle:c=>{s(c)}})}const cve="data:image/gif;base64,R0lGODlhDgFkAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuZGJhM2RhM2I1LCAyMDIzLzEyLzE1LTEwOjQyOjM3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjUuNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyMDk3M0NEODAxQjQxMUVGODVGNENDMkUyMUExNDk1NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyMDk3M0NEOTAxQjQxMUVGODVGNENDMkUyMUExNDk1NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE4ODc3Qzg5MDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE4ODc3QzhBMDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAAAAAAAsAAAAAA4BZAAAAv+Mj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqTkJAGDQ+dnpuekmGgAKejpKuiZqmprKqoZKGyrbOlqrejub6xvLGyw8TFzcprurGuvqybxq7ETbrItsCz0l7Zpc+6p9/cS967w9/S2FTF0u/mzehK4Oqz3eTl9vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0XHDt6/AgypMiRJEuaPIkypcqVLFt+KwAAOw==";function gQe(i){const e=i.step!==void 0?i.step:.01,t=Nn.useRef(null),n=Nn.useRef(null),r=Nn.useRef(null),s=Nn.useRef(null),a=Nn.useRef(null),[c]=Nn.useState(i.value),[d,p]=Nn.useState(i.value.offset[0]),[y,x]=Nn.useState(i.value.offset[1]),[w,C]=Nn.useState(i.value.repeat[0]),[N,F]=Nn.useState(i.value.repeat[1]);function U(B,Y,A,ne,se){if(i.onChange!==void 0){const oe=i.prop!==void 0?i.prop:i.title;i.onChange(oe,{src:B,offset:[Y,A],repeat:[ne,se]})}}function R(B){const Y=t.current.src,A=B.target.value;switch(B.target){case n.current:p(A),U(Y,A,y,w,N);break;case r.current:x(A),U(Y,d,A,w,N);break;case s.current:C(A),U(Y,d,y,A,N);break;case a.current:F(A),U(Y,d,y,w,A);break}}return rt.jsxs("div",{className:"imageField",children:[rt.jsx("img",{alt:i.title,ref:t,onClick:()=>{rQe().then(B=>{t.current.src=B,U(B,d,y,w,N)})},src:c.src.length>0?c.src:cve}),rt.jsxs("div",{className:"fields",children:[rt.jsxs("div",{children:[rt.jsx("span",{children:"Offset:"}),rt.jsx("input",{ref:n,type:"number",value:d,step:e,name:nl(),onChange:R}),rt.jsx("input",{ref:r,type:"number",value:y,step:e,name:nl(),onChange:R})]}),rt.jsxs("div",{children:[rt.jsx("span",{children:"Repeat:"}),rt.jsx("input",{ref:s,type:"number",value:w,step:e,name:nl(),onChange:R}),rt.jsx("input",{ref:a,type:"number",value:N,step:e,name:nl(),onChange:R})]}),rt.jsx("button",{onClick:()=>{U("",d,y,w,N),t.current.src=cve},children:"Clear"})]})]})}function ek(i){var p;let e=i.value;e!==void 0&&(e.isColor!==void 0?e=x4e(i.value):i.type==="color"&&(e=x4e(new xn().setStyle(i.value,Fc))));const[t,n]=Nn.useState(e),r=Nn.useRef(null),s=y=>{let x=y.target.value;if(i.type==="boolean")x=y.target.checked;else if(i.type==="option"&&(typeof i.value=="number"?x=Number(x):typeof i.value=="boolean"?x=!!x:typeof i.value=="object"&&(x=JSON.parse(x)),i.options!==void 0)){const w=i.options.length;for(let C=0;C<w&&i.options[C].value!==x;C++);}n(x),i.onChange!==void 0&&i.onChange(i.prop!==void 0?i.prop:i.title,x)},a={};i.disabled&&(a.opacity=.8);const c=i.type==="field"||i.type==="string"&&(t.length>100||t.search(`
`)>-1),d=c||i.type==="image"||i.type==="vector2";return rt.jsxs("div",{className:`field ${d?"block":""}`,style:a,children:[i.type!=="button"&&rt.jsx("span",{ref:r,children:ak(i.title)},"fieldLabel"),i.type==="string"&&!c&&rt.jsx("input",{type:"text",disabled:i.disabled,onChange:s,value:t,name:nl()}),(i.type==="field"||i.type==="string"&&c)&&rt.jsx("textarea",{cols:50,rows:10,disabled:i.disabled!==void 0?i.disabled:!0,onChange:s,onKeyDown:y=>{i.onKeyDown!==void 0&&i.onKeyDown(y)},value:t,name:nl()}),i.type==="boolean"&&rt.jsx("input",{type:"checkbox",disabled:i.disabled,onChange:s,checked:t,name:nl()}),i.type==="number"&&rt.jsx(n6,{value:t,type:i.type,prop:i.prop!==void 0?i.prop:i.title,min:i.min,max:i.max,step:i.step,disabled:i.disabled,labelRef:r,onChange:i.onChange}),i.type==="range"&&rt.jsx(n6,{value:t,type:i.type,prop:i.prop!==void 0?i.prop:i.title,min:i.min,max:i.max,step:i.step,disabled:i.disabled,labelRef:r,onChange:i.onChange}),i.type==="color"&&rt.jsxs(rt.Fragment,{children:[rt.jsx("input",{type:"text",value:t.toString(),onChange:s,disabled:i.disabled,className:"color",name:nl()}),rt.jsx("input",{type:"color",value:t,onChange:s,disabled:i.disabled,name:nl()})]}),i.type==="button"&&rt.jsx("button",{disabled:i.disabled,onClick:()=>{i.onChange!==void 0&&i.onChange(i.prop!==void 0?i.prop:i.title,!0)},children:i.title}),i.type==="image"&&rt.jsx(gQe,{title:i.title,prop:i.prop,value:i.value,onChange:i.onChange}),i.type==="option"&&rt.jsx(rt.Fragment,{children:rt.jsx("select",{onChange:s,disabled:i.disabled,defaultValue:i.value,name:nl(),children:(p=i.options)==null?void 0:p.map((y,x)=>rt.jsx("option",{value:y.value,children:ak(y.title)},x))})}),i.type==="vector2"&&rt.jsx(JZe,{step:i.step,value:t,min:0,max:1,onChange:s}),i.type==="grid3"&&rt.jsx(ave,{step:i.step,value:t,onChange:s}),i.type==="grid4"&&rt.jsx(eQe,{step:i.step,value:t,onChange:s}),i.type==="euler"&&rt.jsx(ave,{step:i.step,value:t,onChange:s})]})}function vQe(i){return"items"in i}class Rh extends Nn.Component{constructor(t){super(t);Xe(this,"subgroupNames",[]);Xe(this,"subgroupElements",[]);Xe(this,"valueOverrides",new Map);Xe(this,"three");this.three=t.three,this.state={lastUpdated:Date.now()}}addGroup(t){const n=[];t.items.forEach(a=>{n.push({type:a.type,prop:a.prop,title:a.title!==void 0?a.title:a.prop,value:a.value,min:a.min,max:a.max,step:a.step,options:a.options,disabled:a.disabled,onChange:(c,d)=>{t.onUpdate(c,d)}})});const r=Nn.createRef(),s=rt.jsx(Rh,{three:this.props.three,ref:r,title:t.title,expanded:t.expanded,items:n},Math.random());return this.subgroupNames.push(t.title),this.subgroupElements.push(s),this.setState({lastUpdated:Date.now()}),r}removeGroup(t){const n=this.subgroupNames.length;for(let r=0;r<n;r++){const s=this.subgroupNames[r];if(t===s){this.subgroupNames.splice(r,1),this.subgroupElements.splice(r,1),this.setState({lastUpdated:Date.now()});return}}}setField(t,n){this.valueOverrides.set(t,n),this.setState({lastUpdated:Date.now()})}render(){const t=[];return this.props.items.forEach(n=>{if(vQe(n))t.push(rt.jsx(Rh,{three:this.props.three,title:ak(n.title),items:n.items},Math.random()));else{const r=this.valueOverrides.get(n.title),s=r!==void 0?r:n.value;t.push(rt.jsx(ek,{title:n.title,prop:n.prop,value:s,type:n.type,min:n.min,max:n.max,step:n.step,disabled:n.disabled,options:n.options,onChange:(a,c)=>{n.onChange!==void 0&&(this.valueOverrides.delete(n.title),n.onChange(a,c))},onKeyDown:a=>{n.onKeyDown!==void 0&&n.onKeyDown(a)}},Math.random()))}}),this.subgroupElements.forEach(n=>t.push(n)),rt.jsx(ZT,{three:this.props.three,label:this.props.title,open:this.props.expanded===!0,onToggle:n=>{var r;this.props.onToggle&&((r=this.props)==null||r.onToggle(n))},children:t})}}const Xi=class Xi extends Nn.Component{constructor(t){super(t);Xe(this,"addGroup",t=>{const n=JSON.parse(t.value),r=[];n.items.forEach(s=>{r.push({type:s.type,prop:s.prop,title:s.title!==void 0?s.title:s.prop,value:s.value,min:s.min,max:s.max,step:s.step,options:s.options,disabled:s.disabled,onChange:(a,c)=>{this.props.three.updateGroup(n.title,a,c)}})}),Xi.groups.push(rt.jsx(Rh,{three:this.props.three,title:n.title,items:r},Math.random())),Xi.groupTitles.push(n.title),this.setState({lastUpdate:Date.now()})});Xe(this,"removeGroup",t=>{const n=t.value,r=Xi.groupTitles.length;for(let s=0;s<r;s++)if(n===Xi.groupTitles[s]){Xi.groups.splice(s,1),Xi.groupTitles.splice(s,1),this.setState({lastUpdate:Date.now()});return}});this.state={lastUpdate:Date.now()},Xi.instance=this,Xi.three=t.three,t.three.addEventListener(_i.ADD_GROUP,this.addGroup),t.three.addEventListener(_i.REMOVE_GROUP,this.removeGroup)}componentWillUnmount(){this.props.three.removeEventListener(_i.ADD_GROUP,this.addGroup),this.props.three.removeEventListener(_i.REMOVE_GROUP,this.removeGroup)}render(){return rt.jsx("div",{className:"customGroups",children:Xi.groups},this.state.lastUpdate)}static addEditorGroup(t){const n=Xi.groupTitles.length;for(let c=0;c<n;c++)if(Xi.groupTitles[c]===t.title)return Xi.groupsRefs[c];const r=[];t.items.forEach(c=>{r.push({type:c.type,prop:c.prop,title:c.title!==void 0?c.title:c.prop,value:c.value,min:c.min,max:c.max,step:c.step,options:c.options,disabled:c.disabled,onChange:(d,p)=>{t.onUpdate(d,p)}})}),t.subgroups&&t.subgroups.length>0&&t.subgroups.forEach(c=>{const d=[];c.items.forEach(p=>{d.push({type:p.type,prop:p.prop,title:p.title!==void 0?p.title:p.prop,value:p.value,min:p.min,max:p.max,step:p.step,options:p.options,disabled:p.disabled,onChange:(y,x)=>{c.onUpdate(y,x)}})}),r.push({three:Xi.three,title:c.title,expanded:c.expanded,items:d})});const s=Nn.createRef(),a=rt.jsx(Rh,{three:Xi.three,ref:s,title:t.title,expanded:t.expanded,items:r},Math.random());return Xi.groups.push(a),Xi.groupsRefs.push(s),Xi.groupTitles.push(t.title),setTimeout(()=>{Xi.instance.setState({lastUpdate:Date.now()})},0),s}static removeEditorGroup(t){const n=Xi.groupTitles.length;for(let r=0;r<n;r++)if(t===Xi.groupTitles[r]){Xi.groups.splice(r,1),Xi.groupTitles.splice(r,1),Xi.instance.setState({lastUpdate:Date.now()});return}}static removeAllGroups(){for(let t=Xi.groupTitles.length;t>0;t--)Xi.groups.splice(t,1),Xi.groupTitles.splice(t,1);Xi.instance.setState({lastUpdate:Date.now()})}};Xe(Xi,"instance"),Xe(Xi,"groups",[]),Xe(Xi,"groupsRefs",[]),Xe(Xi,"groupTitles",[]),Xe(Xi,"three");let T4=Xi;const Ck=class Ck extends Nn.Component{constructor(t){super(t);Xe(this,"matrix",new An);Xe(this,"position",new _e);Xe(this,"rotation",new Ao);Xe(this,"scale",new _e);Xe(this,"open",!1);Xe(this,"updateTransform",(t,n)=>{const r=t==="rotation"?{x:n._x,y:n._y,z:n._z}:n;this.props.three.updateObject(this.props.object.uuid,t,r);const s=this.props.three.getScene(this.props.object.uuid);if(s){const a=s.getObjectByProperty("uuid",this.props.object.uuid);Ea(a,t,r)}});const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;this.open=r,this.saveExpanded(),this.state={lastUpdated:0,expanded:r},this.matrix.elements=t.object.matrix,t.object.uuid.length>0&&(this.position.setFromMatrixPosition(this.matrix),this.rotation.setFromRotationMatrix(this.matrix),this.scale.setFromMatrixScale(this.matrix)),Ck.instance=this}update(){if(Fa.instance){const t=Fa.instance.selectedItem;if(t===void 0)return;this.position.x=Yf(t.position.x,3),this.position.y=Yf(t.position.y,3),this.position.z=Yf(t.position.z,3),this.rotation.copy(t.rotation),this.scale.x=Yf(t.scale.x,3),this.scale.y=Yf(t.scale.y,3),this.scale.z=Yf(t.scale.z,3),this.setState({lastUpdated:Date.now()})}}render(){return rt.jsx(Rh,{three:this.props.three,title:"Transform",expanded:this.open,items:[{title:"Position",prop:"position",type:"grid3",step:.1,value:this.position,onChange:this.updateTransform},{title:"Rotation",prop:"rotation",type:"euler",value:this.rotation,onChange:this.updateTransform},{title:"Scale",prop:"scale",type:"grid3",value:this.scale,onChange:this.updateTransform},{title:"Visible",prop:"visible",type:"boolean",value:this.props.object.visible,onChange:this.updateTransform}],onToggle:t=>{this.open=t,this.saveExpanded()}},this.state.lastUpdated)}saveExpanded(){localStorage.setItem(this.expandedName,this.open?"open":"closed")}get expandedName(){return`${this.props.three.name}_transform`}};Xe(Ck,"instance");let Mk=Ck;function cH(i){const[e,t]=Nn.useState(i.selected),n="toggle"+(e?" selected":"");return rt.jsx("button",{className:n,onClick:()=>{const r=!e;t(r),i.onClick(r)},style:{backgroundImage:`url(${i.icon})`,backgroundPositionX:"center",backgroundPositionY:i.top!==void 0?`${i.top}px`:"center",backgroundSize:`${i.width!==void 0?`${i.width}px`:"26px"} ${i.height}px`}},i.name)}class yQe extends m${constructor(){super();const e=$Ze(WZe(),.1,.5,0,1).oneMinus();this.colorNode=z$(e,e,e,1)}}const _Qe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {
  #include <uv_vertex>
  #include <color_vertex>
  #include <morphcolor_vertex>
  #include <batching_vertex>

  #if defined ( USE_SKINNING )
    #include <beginnormal_vertex>
    #include <morphnormal_vertex>
    #include <skinbase_vertex>
    #include <skinnormal_vertex>
    #include <defaultnormal_vertex>
  #endif

  #include <begin_vertex>
  #include <morphtarget_vertex>
  #include <skinning_vertex>
  #include <project_vertex>
  #include <logdepthbuf_vertex>
  #include <clipping_planes_vertex>
  #include <worldpos_vertex>
}`,xQe=`
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
  #include <clipping_planes_fragment>
  if (opacity < 0.015) discard;
  gl_FragColor = vec4(vec3(vUv, 0.0), opacity);
}`;class bQe extends za{constructor(){super({defines:{USE_UV:""},uniforms:{opacity:{value:1}},vertexShader:_Qe,fragmentShader:xQe,transparent:!0})}}class SQe extends m${constructor(){super(),this.colorNode=z$(XZe(),0,1)}}const O8=new xE,Gl=new _e,J9=new _e,Mo=new us,uve={X:new _e(1,0,0),Y:new _e(0,1,0),Z:new _e(0,0,1)},uH={type:"change"},dve={type:"mouseDown",mode:null},hve={type:"mouseUp",mode:null},fve={type:"objectChange"};class wQe extends h8e{constructor(e,t=null){super(void 0,t);const n=new PQe(this);this._root=n;const r=new RQe;this._gizmo=r,n.add(r);const s=new IQe;this._plane=s,n.add(s);const a=this;function c(Y,A){let ne=A;Object.defineProperty(a,Y,{get:function(){return ne!==void 0?ne:A},set:function(se){ne!==se&&(ne=se,s[Y]=se,r[Y]=se,a.dispatchEvent({type:Y+"-changed",value:se}),a.dispatchEvent(uH))}}),a[Y]=A,s[Y]=A,r[Y]=A}c("camera",e),c("object",void 0),c("enabled",!0),c("axis",null),c("mode","translate"),c("translationSnap",null),c("rotationSnap",null),c("scaleSnap",null),c("space","world"),c("size",1),c("dragging",!1),c("showX",!0),c("showY",!0),c("showZ",!0),c("minX",-1/0),c("maxX",1/0),c("minY",-1/0),c("maxY",1/0),c("minZ",-1/0),c("maxZ",1/0);const d=new _e,p=new _e,y=new us,x=new us,w=new _e,C=new us,N=new _e,F=new _e,U=new _e,R=0,B=new _e;c("worldPosition",d),c("worldPositionStart",p),c("worldQuaternion",y),c("worldQuaternionStart",x),c("cameraPosition",w),c("cameraQuaternion",C),c("pointStart",N),c("pointEnd",F),c("rotationAxis",U),c("rotationAngle",R),c("eye",B),this._offset=new _e,this._startNorm=new _e,this._endNorm=new _e,this._cameraScale=new _e,this._parentPosition=new _e,this._parentQuaternion=new us,this._parentQuaternionInv=new us,this._parentScale=new _e,this._worldScaleStart=new _e,this._worldQuaternionInv=new us,this._worldScale=new _e,this._positionStart=new _e,this._quaternionStart=new us,this._scaleStart=new _e,this._getPointer=TQe.bind(this),this._onPointerDown=MQe.bind(this),this._onPointerHover=EQe.bind(this),this._onPointerMove=CQe.bind(this),this._onPointerUp=AQe.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;e!==null&&O8.setFromCamera(e,this.camera);const t=dH(this._gizmo.picker[this.mode],O8);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e!=null&&e.button!==0)&&this.axis!==null){e!==null&&O8.setFromCamera(e,this.camera);const t=dH(this._plane,O8,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,dve.mode=this.mode,this.dispatchEvent(dve)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let s=this.space;if(n==="scale"?s="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(s="world"),r===void 0||t===null||this.dragging===!1||e!==null&&e.button!==-1)return;e!==null&&O8.setFromCamera(e,this.camera);const a=dH(this._plane,O8,!0);if(a){if(this.pointEnd.copy(a.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),s==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),s==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(s==="local"&&(r.position.applyQuaternion(Mo.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),s==="world"&&(r.parent&&r.position.add(Gl.setFromMatrixPosition(r.parent.matrixWorld)),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(Gl.setFromMatrixPosition(r.parent.matrixWorld)))),r.position.x=Math.max(this.minX,Math.min(this.maxX,r.position.x)),r.position.y=Math.max(this.minY,Math.min(this.maxY,r.position.y)),r.position.z=Math.max(this.minZ,Math.min(this.maxZ,r.position.z));else if(n==="scale"){if(t.search("XYZ")!==-1){let c=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(c*=-1),J9.set(c,c,c)}else Gl.copy(this.pointStart),J9.copy(this.pointEnd),Gl.applyQuaternion(this._worldQuaternionInv),J9.applyQuaternion(this._worldQuaternionInv),J9.divide(Gl),t.search("X")===-1&&(J9.x=1),t.search("Y")===-1&&(J9.y=1),t.search("Z")===-1&&(J9.z=1);r.scale.copy(this._scaleStart).multiply(J9),this.scaleSnap&&(t.search("X")!==-1&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const c=20/this.worldPosition.distanceTo(Gl.setFromMatrixPosition(this.camera.matrixWorld));let d=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Gl.copy(this.rotationAxis).cross(this.eye))*c):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(uve[t]),Gl.copy(uve[t]),s==="local"&&Gl.applyQuaternion(this.worldQuaternion),Gl.cross(this.eye),Gl.length()===0?d=!0:this.rotationAngle=this._offset.dot(Gl.normalize())*c),(t==="E"||d)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),s==="local"&&t!=="E"&&t!=="XYZE"?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(Mo.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(Mo.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(uH),this.dispatchEvent(fve)}}pointerUp(e){e!==null&&e.button!==0||(this.dragging&&this.axis!==null&&(hve.mode=this.mode,this.dispatchEvent(hve)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this._root.dispose()}attach(e){return this.object=e,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(uH),this.dispatchEvent(fve),this.pointStart.copy(this.pointEnd))}getRaycaster(){return O8}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}setColors(e,t,n,r){const s=this._gizmo.materialLib;s.xAxis.color.set(e),s.yAxis.color.set(t),s.zAxis.color.set(n),s.active.color.set(r),s.xAxisTransparent.color.set(e),s.yAxisTransparent.color.set(t),s.zAxisTransparent.color.set(n),s.activeTransparent.color.set(r),s.xAxis._color&&s.xAxis._color.set(e),s.yAxis._color&&s.yAxis._color.set(t),s.zAxis._color&&s.zAxis._color.set(n),s.active._color&&s.active._color.set(r),s.xAxisTransparent._color&&s.xAxisTransparent._color.set(e),s.yAxisTransparent._color&&s.yAxisTransparent._color.set(t),s.zAxisTransparent._color&&s.zAxisTransparent._color.set(n),s.activeTransparent._color&&s.activeTransparent._color.set(r)}}function TQe(i){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:i.button};{const e=this.domElement.getBoundingClientRect();return{x:(i.clientX-e.left)/e.width*2-1,y:-(i.clientY-e.top)/e.height*2+1,button:i.button}}}function EQe(i){if(this.enabled)switch(i.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(i));break}}function MQe(i){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(i)),this.pointerDown(this._getPointer(i)))}function CQe(i){this.enabled&&this.pointerMove(this._getPointer(i))}function AQe(i){this.enabled&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(i)))}function dH(i,e,t){const n=e.intersectObject(i,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const BN=new Ao,Ws=new _e(0,1,0),pve=new _e(0,0,0),mve=new An,zN=new us,tk=new us,q1=new _e,gve=new An,BT=new _e(1,0,0),U8=new _e(0,1,0),zT=new _e(0,0,1),VN=new _e,MT=new _e,CT=new _e;class PQe extends hi{constructor(e){super(),this.isTransformControlsRoot=!0,this.controls=e,this.visible=!1}updateMatrixWorld(e){const t=this.controls;t.object!==void 0&&(t.object.updateMatrixWorld(),t.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):t.object.parent.matrixWorld.decompose(t._parentPosition,t._parentQuaternion,t._parentScale),t.object.matrixWorld.decompose(t.worldPosition,t.worldQuaternion,t._worldScale),t._parentQuaternionInv.copy(t._parentQuaternion).invert(),t._worldQuaternionInv.copy(t.worldQuaternion).invert()),t.camera.updateMatrixWorld(),t.camera.matrixWorld.decompose(t.cameraPosition,t.cameraQuaternion,t._cameraScale),t.camera.isOrthographicCamera?t.camera.getWorldDirection(t.eye).negate():t.eye.copy(t.cameraPosition).sub(t.worldPosition).normalize(),super.updateMatrixWorld(e)}dispose(){this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}}class RQe extends hi{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Ua({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Td({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const a=e.clone();a.color.setHex(65280);const c=e.clone();c.color.setHex(255);const d=e.clone();d.color.setHex(16711680),d.opacity=.5;const p=e.clone();p.color.setHex(65280),p.opacity=.5;const y=e.clone();y.color.setHex(255),y.opacity=.5;const x=e.clone();x.opacity=.25;const w=e.clone();w.color.setHex(16776960),w.opacity=.25;const C=e.clone();C.color.setHex(16776960);const N=e.clone();N.color.setHex(7895160),this.materialLib={xAxis:s,yAxis:a,zAxis:c,active:C,xAxisTransparent:d,yAxisTransparent:p,zAxisTransparent:y,activeTransparent:w};const F=new J0(0,.04,.1,12);F.translate(0,.05,0);const U=new qo(.08,.08,.08);U.translate(0,.04,0);const R=new Ii;R.setAttribute("position",new Rr([0,0,0,1,0,0],3));const B=new J0(.0075,.0075,.5,3);B.translate(0,.25,0);function Y(He,ce){const Ge=new B8(He,.0075,3,64,ce*Math.PI*2);return Ge.rotateY(Math.PI/2),Ge.rotateX(Math.PI/2),Ge}function A(){const He=new Ii;return He.setAttribute("position",new Rr([0,0,0,1,1,1],3)),He}const ne={X:[[new fn(F,s),[.5,0,0],[0,0,-Math.PI/2]],[new fn(F,s),[-.5,0,0],[0,0,Math.PI/2]],[new fn(B,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new fn(F,a),[0,.5,0]],[new fn(F,a),[0,-.5,0],[Math.PI,0,0]],[new fn(B,a)]],Z:[[new fn(F,c),[0,0,.5],[Math.PI/2,0,0]],[new fn(F,c),[0,0,-.5],[-Math.PI/2,0,0]],[new fn(B,c),null,[Math.PI/2,0,0]]],XYZ:[[new fn(new W8(.1,0),x),[0,0,0]]],XY:[[new fn(new qo(.15,.15,.01),y),[.15,.15,0]]],YZ:[[new fn(new qo(.15,.15,.01),d),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fn(new qo(.15,.15,.01),p),[.15,0,.15],[-Math.PI/2,0,0]]]},se={X:[[new fn(new J0(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new fn(new J0(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new fn(new J0(.2,0,.6,4),n),[0,.3,0]],[new fn(new J0(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new fn(new J0(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new fn(new J0(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new fn(new W8(.2,0),n)]],XY:[[new fn(new qo(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new fn(new qo(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fn(new qo(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},oe={START:[[new fn(new W8(.01,2),r),null,null,null,"helper"]],END:[[new fn(new W8(.01,2),r),null,null,null,"helper"]],DELTA:[[new wu(A(),r),null,null,null,"helper"]],X:[[new wu(R,r),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new wu(R,r),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new wu(R,r),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},G={XYZE:[[new fn(Y(.5,1),N),null,[0,Math.PI/2,0]]],X:[[new fn(Y(.5,.5),s)]],Y:[[new fn(Y(.5,.5),a),null,[0,0,-Math.PI/2]]],Z:[[new fn(Y(.5,.5),c),null,[0,Math.PI/2,0]]],E:[[new fn(Y(.75,1),w),null,[0,Math.PI/2,0]]]},ie={AXIS:[[new wu(R,r),[-1e3,0,0],null,[1e6,1,1],"helper"]]},Me={XYZE:[[new fn(new ip(.25,10,8),n)]],X:[[new fn(new B8(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new fn(new B8(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new fn(new B8(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new fn(new B8(.75,.1,2,24),n)]]},X={X:[[new fn(U,s),[.5,0,0],[0,0,-Math.PI/2]],[new fn(B,s),[0,0,0],[0,0,-Math.PI/2]],[new fn(U,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new fn(U,a),[0,.5,0]],[new fn(B,a)],[new fn(U,a),[0,-.5,0],[0,0,Math.PI]]],Z:[[new fn(U,c),[0,0,.5],[Math.PI/2,0,0]],[new fn(B,c),[0,0,0],[Math.PI/2,0,0]],[new fn(U,c),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new fn(new qo(.15,.15,.01),y),[.15,.15,0]]],YZ:[[new fn(new qo(.15,.15,.01),d),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fn(new qo(.15,.15,.01),p),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new fn(new qo(.1,.1,.1),x)]]},De={X:[[new fn(new J0(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new fn(new J0(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new fn(new J0(.2,0,.6,4),n),[0,.3,0]],[new fn(new J0(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new fn(new J0(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new fn(new J0(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new fn(new qo(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new fn(new qo(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new fn(new qo(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new fn(new qo(.2,.2,.2),n),[0,0,0]]]},$e={X:[[new wu(R,r),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new wu(R,r),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new wu(R,r),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function ot(He){const ce=new hi;for(const Ge in He)for(let Ie=He[Ge].length;Ie--;){const st=He[Ge][Ie][0].clone(),bt=He[Ge][Ie][1],Ne=He[Ge][Ie][2],ht=He[Ge][Ie][3],Ot=He[Ge][Ie][4];st.name=Ge,st.tag=Ot,bt&&st.position.set(bt[0],bt[1],bt[2]),Ne&&st.rotation.set(Ne[0],Ne[1],Ne[2]),ht&&st.scale.set(ht[0],ht[1],ht[2]),st.updateMatrix();const wn=st.geometry.clone();wn.applyMatrix4(st.matrix),st.geometry=wn,st.renderOrder=1/0,st.position.set(0,0,0),st.rotation.set(0,0,0),st.scale.set(1,1,1),ce.add(st)}return ce}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=ot(ne)),this.add(this.gizmo.rotate=ot(G)),this.add(this.gizmo.scale=ot(X)),this.add(this.picker.translate=ot(se)),this.add(this.picker.rotate=ot(Me)),this.add(this.picker.scale=ot(De)),this.add(this.helper.translate=ot(oe)),this.add(this.helper.rotate=ot(ie)),this.add(this.helper.scale=ot($e)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:tk;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const a=r[s];a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition);let c;if(this.camera.isOrthographicCamera?c=(this.camera.top-this.camera.bottom)/this.camera.zoom:c=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(c*this.size/4),a.tag==="helper"){a.visible=!1,a.name==="AXIS"?(a.visible=!!this.axis,this.axis==="X"&&(Mo.setFromEuler(BN.set(0,0,0)),a.quaternion.copy(n).multiply(Mo),Math.abs(Ws.copy(BT).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Y"&&(Mo.setFromEuler(BN.set(0,0,Math.PI/2)),a.quaternion.copy(n).multiply(Mo),Math.abs(Ws.copy(U8).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Z"&&(Mo.setFromEuler(BN.set(0,Math.PI/2,0)),a.quaternion.copy(n).multiply(Mo),Math.abs(Ws.copy(zT).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="XYZE"&&(Mo.setFromEuler(BN.set(0,Math.PI/2,0)),Ws.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(mve.lookAt(pve,Ws,U8)),a.quaternion.multiply(Mo),a.visible=this.dragging),this.axis==="E"&&(a.visible=!1)):a.name==="START"?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):a.name==="END"?(a.position.copy(this.worldPosition),a.visible=this.dragging):a.name==="DELTA"?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),Gl.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Gl.applyQuaternion(this.worldQuaternionStart.clone().invert()),a.scale.copy(Gl),a.visible=this.dragging):(a.quaternion.copy(n),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=this.axis.search(a.name)!==-1));continue}a.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(a.name==="X"&&Math.abs(Ws.copy(BT).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Y"&&Math.abs(Ws.copy(U8).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Z"&&Math.abs(Ws.copy(zT).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XY"&&Math.abs(Ws.copy(zT).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="YZ"&&Math.abs(Ws.copy(BT).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XZ"&&Math.abs(Ws.copy(U8).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1)):this.mode==="rotate"&&(zN.copy(n),Ws.copy(this.eye).applyQuaternion(Mo.copy(n).invert()),a.name.search("E")!==-1&&a.quaternion.setFromRotationMatrix(mve.lookAt(this.eye,pve,U8)),a.name==="X"&&(Mo.setFromAxisAngle(BT,Math.atan2(-Ws.y,Ws.z)),Mo.multiplyQuaternions(zN,Mo),a.quaternion.copy(Mo)),a.name==="Y"&&(Mo.setFromAxisAngle(U8,Math.atan2(Ws.x,Ws.z)),Mo.multiplyQuaternions(zN,Mo),a.quaternion.copy(Mo)),a.name==="Z"&&(Mo.setFromAxisAngle(zT,Math.atan2(Ws.y,Ws.x)),Mo.multiplyQuaternions(zN,Mo),a.quaternion.copy(Mo))),a.visible=a.visible&&(a.name.indexOf("X")===-1||this.showX),a.visible=a.visible&&(a.name.indexOf("Y")===-1||this.showY),a.visible=a.visible&&(a.name.indexOf("Z")===-1||this.showZ),a.visible=a.visible&&(a.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),a.material._color=a.material._color||a.material.color.clone(),a.material._opacity=a.material._opacity||a.material.opacity,a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled&&this.axis&&(a.name===this.axis?(a.material.color.copy(this.materialLib.active.color),a.material.opacity=1):this.axis.split("").some(function(d){return a.name===d})&&(a.material.color.copy(this.materialLib.active.color),a.material.opacity=1))}super.updateMatrixWorld(e)}}class IQe extends fn{constructor(){super(new rp(1e5,1e5,2,2),new Ua({visible:!1,wireframe:!0,side:no,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),VN.copy(BT).applyQuaternion(t==="local"?this.worldQuaternion:tk),MT.copy(U8).applyQuaternion(t==="local"?this.worldQuaternion:tk),CT.copy(zT).applyQuaternion(t==="local"?this.worldQuaternion:tk),Ws.copy(MT),this.mode){case"translate":case"scale":switch(this.axis){case"X":Ws.copy(this.eye).cross(VN),q1.copy(VN).cross(Ws);break;case"Y":Ws.copy(this.eye).cross(MT),q1.copy(MT).cross(Ws);break;case"Z":Ws.copy(this.eye).cross(CT),q1.copy(CT).cross(Ws);break;case"XY":q1.copy(CT);break;case"YZ":q1.copy(VN);break;case"XZ":Ws.copy(CT),q1.copy(MT);break;case"XYZ":case"E":q1.set(0,0,0);break}break;case"rotate":default:q1.set(0,0,0)}q1.length()===0?this.quaternion.copy(this.cameraQuaternion):(gve.lookAt(Gl.set(0,0,0),q1,Ws),this.quaternion.setFromRotationMatrix(gve)),super.updateMatrixWorld(e)}}const qf=class qf extends Yl{constructor(){super(...arguments);Xe(this,"three");Xe(this,"activeCamera");Xe(this,"controls",new Map);Xe(this,"visibility",new Map);Xe(this,"setScene",()=>{this.clear()})}setApp(t){this.three=t,this.three.addEventListener(_i.SET_SCENE,this.setScene)}clear(){for(const t of this.controls.values()){t.detach(),t.disconnect();const n=t.getHelper();Mh(n)}this.controls=new Map,this.visibility=new Map}add(t){let n=this.controls.get(t);if(n===void 0){const r=document.querySelector(".clickable");n=new wQe(this.activeCamera,r),n.getHelper().name=t,n.setSize(.5),n.setSpace("local"),this.controls.set(t,n),this.visibility.set(t,!0),n.addEventListener("mouseDown",()=>{this.dispatchEvent({type:qf.DRAG_START})}),n.addEventListener("mouseUp",()=>{this.dispatchEvent({type:qf.DRAG_END})}),n.addEventListener("dragging-changed",s=>{var a;(a=Fa.instance)==null||a.toggleOrbitControls(s.value)})}return n}get(t){return this.controls.get(t)}remove(t){const n=this.get(t);return n===void 0?!1:(n.detach(),n.disconnect(),Mh(n.getHelper()),this.controls.delete(t),!0)}enabled(t){this.controls.forEach(n=>{n.enabled=t})}updateCamera(t,n){this.activeCamera=t,this.controls.forEach(r=>{r.camera!==t&&(r.camera=t,t.getWorldPosition(r.cameraPosition),t.getWorldQuaternion(r.cameraQuaternion)),r.domElement!==n&&(r.disconnect(),r.domElement=n,r.connect(n))})}show(){this.controls.forEach(t=>{const n=t.getHelper(),r=this.visibility.get(n.name);r!==void 0&&(n.visible=r)})}hide(){this.controls.forEach(t=>{const n=t.getHelper();this.visibility.set(n.name,n.visible),n.visible=!1})}static get instance(){return qf._instance||(qf._instance=new qf),qf._instance}};Xe(qf,"DRAG_START","Transform::dragStart"),Xe(qf,"DRAG_END","Transform::dragEnd"),Xe(qf,"_instance");let yd=qf;const NQe=new qo,hH=new vn;class fH extends hi{constructor(t,n){const r=new xn(Jj(.5,1,Math.random()),Jj(.5,1,Math.random()),Jj(.5,1,Math.random()));super();Xe(this,"curve",new I9e);Xe(this,"line");Xe(this,"draggable");Xe(this,"curvePos");Xe(this,"tension",.5);Xe(this,"closed",!1);Xe(this,"subdivide",50);Xe(this,"curveType");Xe(this,"offset",1);Xe(this,"lineMaterial");Xe(this,"_camera");Xe(this,"_curvePercentage",0);Xe(this,"_draggableScale",10);Xe(this,"_transform");Xe(this,"raycaster");Xe(this,"draggedMat",new Ua);Xe(this,"parentGroup");Xe(this,"group");Xe(this,"dispose",()=>{this._transform&&(this._transform.removeEventListener("objectChange",this.updateSpline),yd.instance.remove(this.name)),this.disable(),this.parentGroup.removeGroup(this.name)});Xe(this,"hideTransform",()=>{var t;(t=this._transform)==null||t.detach()});Xe(this,"exportSpline",()=>{const t=[];this.draggable.children.forEach(n=>{t.push([Yf(n.position.x,3),Yf(n.position.y,3),Yf(n.position.z,3)])}),kBe({name:this.name,points:t,tension:this.tension,closed:this.closed,subdivide:this.subdivide,type:this.curveType}),console.log("Spline copied!")});Xe(this,"showPoints",(t=!0)=>{this.draggable.visible=t});Xe(this,"addPoints",(t=[])=>{if(t.length>0){const n=t.length-1;for(let r=0;r<n;r++)this.addPoint(t[r],!1);this.addPoint(t[n])}});Xe(this,"addPoint",(t,n=!0)=>{var c;const r=this.draggable.children.length,s=new fn(NQe,this.draggedMat);s.name=`point_${r}`,s.position.copy(t),s.scale.setScalar(this._draggableScale),this.draggable.add(s),(c=this._transform)==null||c.attach(s);const a=this.points.length>1;return a&&n&&this.updateSpline(),this.line.visible=a,this.updateCurrentPoint(),s});Xe(this,"addNextPt",()=>{const t=this.draggable.children.length,n=t>1?this.draggable.children[t-1].position.clone():new _e,r=this.addPoint(n);this.updateField(r.position)});Xe(this,"removePoint",t=>{var n,r,s;if(((n=this._transform)==null?void 0:n.object)===t){(r=this._transform)==null||r.detach();const a=this.draggable.children[this.draggable.children.length-1];(s=this._transform)==null||s.attach(a),this.updateField(a.position)}Mh(t),this.updateSpline()});Xe(this,"removePointAt",t=>{const n=this.draggable.children[t];this.removePoint(n)});Xe(this,"removeSelectedPt",()=>{var t,n;((t=this._transform)==null?void 0:t.object)!==void 0&&this.removePoint((n=this._transform)==null?void 0:n.object)});Xe(this,"updateSpline",()=>{this.points.length<2||(this.curve=new I9e(this.points,this.closed,this.curveType,this.tension),this.line.geometry.dispose(),this.line.geometry=new Ii().setFromPoints(this.curve.getPoints(this.subdivide)),this.curvePos.position.copy(this.getPointAt(this._curvePercentage)))});Xe(this,"onMouseClick",t=>{var a,c;if(!Fa.instance||!Fa.instance.currentWindow||this._transform&&!this._transform.getHelper().visible)return;const r=Fa.instance.currentWindow.current.getBoundingClientRect();hH.x=(t.clientX-r.x)/r.width*2-1,hH.y=-((t.clientY-r.y)/r.height)*2+1,this.raycaster.setFromCamera(hH,this.camera);const s=this.raycaster.intersectObjects(this.draggable.children,!1);if(s.length>0){const d=s[0].object;d!==((a=this._transform)==null?void 0:a.object)&&((c=this._transform)==null||c.attach(d),this.updateField(d.position))}});Xe(this,"onUpdateTransform",()=>{this.updateCurrentPoint(),this.updateSpline()});Xe(this,"debugPoint",t=>{t.name,t.visible=this.draggable.visible});this.name=t,this.lineMaterial=new Td({color:r}),this.line=new wu(new Ii,this.lineMaterial),this.line.name="line",this.line.visible=!1,this.add(this.line),this._camera=n,this.curveType="catmullrom",this.draggedMat.color=r,this.draggable=new hi,this.draggable.name="draggablePoints",this.add(this.draggable),this.curvePos=new fn(new ip(1.5),new Ua({color:r})),this.curvePos.name="curvePos",this.curvePos.scale.setScalar(this._draggableScale),this.curvePos.visible=!1,this.add(this.curvePos),this.raycaster=new xE,this.raycaster.params.Line.threshold=3,this.enable()}enable(){document.addEventListener("pointerdown",this.onMouseClick)}disable(){document.removeEventListener("pointerdown",this.onMouseClick)}updateLastPoint(t){const n=this.draggable.children.length;n>0&&(this.draggable.children[n-1].position.copy(t),this.updateSpline())}updateField(t){var n;(n=this.group.current)==null||n.setField("Current Point",t)}getPointAt(t){return this.curve.points.length>1?this.curve.getPointAt(t):this.curve.points.length===1?this.curve.points[0]:new _e}getTangentAt(t){return this.curve.getTangentAt(t)}get points(){const t=[];return this.draggable.children.forEach(n=>{t.push(n.position)}),t}get total(){return this.draggable.children.length}get draggableScale(){return this._draggableScale}set draggableScale(t){this._draggableScale=t,this.draggable.children.forEach(n=>n.scale.setScalar(t)),this.curvePos.scale.setScalar(t)}get camera(){return this._camera}set camera(t){this._camera=t,this._transform!==void 0&&(this._transform.camera=t)}get curvePercentage(){return this._curvePercentage}set curvePercentage(t){this._curvePercentage=t,this.curvePos.position.copy(this.getPointAt(t))}updateCurrentPoint(){var t,n;if((t=this._transform)!=null&&t.object&&this.group){const r=(n=this._transform)==null?void 0:n.object;r.name.search("point")>-1&&this.updateField(r.position)}}initDebug(t,n){var a;const r=this.draggable.children;this.visible=n,this.parentGroup=t,this._transform=yd.instance.add(this.name),this._transform.camera=this._camera,this._transform.addEventListener("objectChange",this.onUpdateTransform),r.length>0&&this._transform.attach(r[r.length-1]),(a=Fa.instance)==null||a.helpersContainer.add(this._transform.getHelper());const s=r.length>0?r[r.length-1].position:{x:0,y:0,z:0};this.group=t.addGroup({title:this.name,expanded:n,items:[{prop:"Closed",type:"boolean",value:this.closed},{prop:"Visible",type:"boolean",value:this.visible},{prop:"Show Position",type:"boolean",value:this.curvePos.visible},{prop:"Show Points",type:"boolean",value:this.draggable.visible},{prop:"Color",type:"color",value:`#${this.draggedMat.color.getHexString()}`},{prop:"Curve",type:"option",options:[{title:"Catmullrom",value:"catmullrom"},{title:"Centripetal",value:"centripetal"},{title:"Chordal",value:"chordal"}]},{prop:"Draggable Scale",type:"range",min:.01,max:100,step:.01,value:this._draggableScale},{prop:"Subdivide",type:"range",min:1,max:1e3,step:1,value:this.subdivide},{prop:"Tension",type:"range",min:0,max:1,step:.01,value:this.tension},{prop:"New Pt Offset",type:"range",min:0,max:10,value:this.offset},{prop:"Curve At",type:"range",min:0,max:1,step:.01,value:0},{prop:"Toggle Transform",type:"button"},{prop:"Add Point",type:"button"},{prop:"Remove Point",type:"button"},{prop:"Export",type:"button"},{prop:"Delete",type:"button"},{prop:"Current Point",type:"grid3",value:s}],onUpdate:(c,d)=>{var p,y;switch(c){case"Closed":this.closed=d,this.updateSpline();break;case"Visible":this.visible=d;break;case"Color":this.lineMaterial.color.setStyle(d),this.draggedMat.color.setStyle(d);break;case"Curve":this.curveType=d,this.updateSpline();break;case"Draggable Scale":this.draggableScale=d;break;case"Subdivide":this.subdivide=d,this.updateSpline();break;case"Tension":this.tension=d,this.updateSpline();break;case"New Pt Offset":this.offset=d;break;case"Curve At":this.curvePos.position.copy(this.getPointAt(d));break;case"Show Position":this.curvePos.visible=d;break;case"Show Points":this.draggable.visible=d;break;case"Toggle Transform":this._transform&&(this._transform.getHelper().visible=!this._transform.getHelper().visible);break;case"Add Point":this.addNextPt();break;case"Remove Point":this.removeSelectedPt();break;case"Export":this.exportSpline();break;case"Delete":this.parent.currentSpline=null,Mh(this);break;case"Current Point":if(this.group.current&&((p=this._transform)!=null&&p.object)){const x=(y=this._transform)==null?void 0:y.object;x.name.search("point")>-1&&(x.position.copy(d),this.updateSpline())}break}}}),this.draggable.children.forEach(c=>{this.debugPoint(c)})}}let GN=0;class kQe extends hi{constructor(t,n){super();Xe(this,"defaultScale",10);Xe(this,"currentSpline",null);Xe(this,"_camera");Xe(this,"group",null);Xe(this,"three");Xe(this,"splineDataText","");Xe(this,"createSpline",(t=[])=>{const n=`Spline ${GN+1}`,r=new fH(n,this._camera);return r.addPoints(t),this.addSpline(r,!0),GN++,r});Xe(this,"createSplineFromArray",t=>{const n=[];return t.forEach(r=>{n.push(new _e(r[0],r[1],r[2]))}),this.createSpline(n)});Xe(this,"createSplineFromCatmullRom",t=>this.createSpline(t.points));Xe(this,"createSplineFromJSON",t=>{const n=[];t.points.forEach(s=>{n.push(new _e(s[0],s[1],s[2]))});const r=new fH(t.name,this._camera);return r.closed=t.closed,r.subdivide=t.subdivide,r.tension=t.tension,r.type=t.type,r.addPoints(n),r.updateSpline(),this.addSpline(r,!1),r});Xe(this,"showPoints",(t=!0)=>{this.children.forEach(n=>{n.showPoints(t)})});Xe(this,"onAddSpline",t=>{const n=JSON.parse(t.value),r=n.name!==void 0?n.name:`Spline ${GN+1}`,s=new fH(r,this.camera);n.tension!==void 0&&(s.tension=n.tension),n.closed!==void 0&&(s.closed=n.closed),n.subdivide!==void 0&&(s.subdivide=n.subdivide),n.type!==void 0&&(s.curveType=n.type);const a=[];n.points.forEach(c=>{a.push(new _e(c[0],c[1],c[2]))}),s.addPoints(a),this.addSpline(s,!1),GN++});Xe(this,"isMouseDown",!1);Xe(this,"onClickCanvas",t=>{var d;if(t.button!==0)return;if(this._camera.type!=="OrthographicCamera"){console.warn("Spline Editor - 3D Camera not supported in Draw Mode");return}const r=t.target.getBoundingClientRect(),s=(t.clientX-r.left)/r.width*2-1,a=-((t.clientY-r.top)/r.height)*2+1;if(Fa.instance){const p=new xE;p.setFromCamera(new vn(s,a),this._camera);const y=p.intersectObjects(Fa.instance.helpersContainer.children,!0);for(let x=0;x<y.length;x++){const w=y[x];if(!(w.object.isLine||w.object.isTransformControlsPlane)&&w.object.isObject3D)return}}this.currentSpline===null&&(this.currentSpline=this.createSpline());const c=this.mouseToSplinePos(s,a,r.width,r.height);(d=this.currentSpline)==null||d.addPoint(c),this.isMouseDown=!0});Xe(this,"onMouseMove",t=>{var d,p;if(!this.isMouseDown)return;const r=t.target.getBoundingClientRect(),s=(t.clientX-r.left)/r.width*2-1,a=-((t.clientY-r.top)/r.height)*2+1,c=this.mouseToSplinePos(s,a,r.width,r.height);(d=this.currentSpline)==null||d.updateLastPoint(c),(p=this.currentSpline)==null||p.updateField(c)});Xe(this,"onMouseUp",()=>{this.isMouseDown=!1});this.name="Spline Editor",this._camera=t,this.three=n,this.three.addEventListener(_i.ADD_SPLINE,this.onAddSpline)}initDebug(){this.group=T4.addEditorGroup({title:this.name,items:[{type:"field",prop:"Spline Data",value:"",disabled:!1},{type:"button",prop:"Import Spline"},{type:"button",prop:"New Spline"},{type:"boolean",prop:"Show Points",value:!0},{type:"boolean",prop:"Draw Mode",value:!1},{type:"boolean",prop:"Visible",value:this.visible},{type:"range",prop:"Default Scale",min:0,max:50,step:.01,value:this.defaultScale}],onUpdate:(t,n)=>{switch(t){case"New Spline":this.createSpline();break;case"Spline Data":this.splineDataText=n;break;case"Import Spline":this.createSplineFromJSON(JSON.parse(this.splineDataText));break;case"Show Points":this.showPoints(n);break;case"Visible":this.visible=n;break;case"Default Scale":this.defaultScale=n;break;case"Draw Mode":n?this.enableClickToDraw():this.disableClickToDraw();break}}})}dispose(){this.three.removeEventListener(_i.ADD_SPLINE,this.onAddSpline),T4.removeEditorGroup(this.name)}addSpline(t,n){var r;t.draggableScale=this.defaultScale,t.hideTransform(),((r=this.group)==null?void 0:r.current)!==null&&t.initDebug(this.group.current,n),this.add(t),this.currentSpline=t}enableClickToDraw(){document.querySelectorAll(".clickable").forEach(t=>{t.addEventListener("mousedown",this.onClickCanvas),t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mouseup",this.onMouseUp)})}disableClickToDraw(){document.querySelectorAll(".clickable").forEach(t=>{t.removeEventListener("mousedown",this.onClickCanvas),t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mouseup",this.onMouseUp)})}mouseToSplinePos(t,n,r,s){const a=new _e,c=Math.PI/2,d=this._camera,p=d.zoom,y=d.rotation.x===-6123233995736766e-32&&d.rotation.y===0&&d.rotation.z===0,x=d.rotation.x===-Math.PI&&d.rotation.y===12246467991473532e-32&&d.rotation.z===Math.PI,w=d.rotation.x===-6162975822039155e-48&&d.rotation.y===-c&&d.rotation.z===0,C=d.rotation.x===-6162975822039155e-48&&d.rotation.y===c&&d.rotation.z===0,N=d.rotation.x===-1.5707953264174506&&d.rotation.y===0&&d.rotation.z===0,F=d.rotation.x===1.5707953264174506&&d.rotation.y===0&&d.rotation.z===0;let U=t,R=n;x||C?U*=-1:N&&(R*=-1);const B=r/2/p,Y=s/2/p;if(this.currentSpline===null&&(this.currentSpline=this.createSpline()),y||x){const A=U*B+d.position.x,ne=R*Y+d.position.y;a.set(A,ne,0)}else if(w||C){const A=U*B+d.position.z,ne=R*Y+d.position.y;a.set(0,ne,A)}else if(N||F){const A=U*B+d.position.x,ne=R*Y+d.position.z;a.set(A,0,ne)}return a}get camera(){return this._camera}set camera(t){this._camera=t,this.children.forEach(n=>{const r=n;r.camera=t})}}const vve=["Single","Side by Side","Stacked","Quad"],DQe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC60lEQVRYhe2YT4hNcRTHP48xpmYaNAvRyEQxEhnKQljYsRm9/EmSyJiMFAsMZWNhJYoNIUVJ2VGiyb9ZzIpMpkQSahbGv9GMYWrM+1rc2zjvzvvdd+99rzdvMd+6de75nd+5387vnN/v/G5KEuWMKRNNIB8mCRaKiiL5qQb2ApuBuUAV0Ad0AJeB3sSeJRX6LJbULTf6JTUn9Z+KWMUpPyp/Avoa4CNQZ3Sj/lNpdL/xottR7AjOkHRUUpekN5I6JbVLavDH75lIfZN0UFKTpCWS0pJem/HeJBEMG6yV1ONYtgFJbZJ+GF1jDh+zJb03NuliEuwMkMo4yErS2RA/LcbuYVyCrm1mA7Dal/8Cu4FG4JD/HsTTkCy6a+SVMTPQuc1sBKb78nHghi+/A+YBxwL2lbhRY+ThuARdEVxu5JdGFvACr0otdoZ8Y4+Rn0Sn5sFFsMvI6YB9MzA1YJ8mN8k1wAHzfj4uQVdyrpI0aJL7oqTtkq4FiqPLyCOSbktqlbRL0jlJQ2b8QdwCUZ4qvhRStZL0XFK1pMd57CRvq5mfhKBriRfiFUMY6oD7eOdwPlQAN4G10dfWg+uouwXsiOssAj4AC+JMcEWwvnAuOTEr7gTXPmg34zagOwkbIIOXAo9CbDYBrcBXYN+4UUdy2sRflyS5zVNlfPX7ugpJW5V9nI7mmh+lYU0lCZ2B3TOnAVuAk0BTwC5nuhWro46KauBOQJch5OpRaoIW34GreGf+YZdRqS9NAj4Bp4ClQDvwOWxCqSM4ADQEdKE5XvbXzlITrAVe4TW+M6NMKDXBFLAMuAD0ACfIc7pMZBXXA2cY3/xmodQRHAL2A2+NLtj8ZiEKwUL/z2WMPAJcAVYALWSf8dZuDFGWeBHwKxm3sWYhiGG8Tfo6sA2vSfiSy4GrH3wGrDcfKSSKKf6v1E9yF0XK9Q1XBPuMXMw8HXTonQFwETwNzMFr64v1jzgFHIk9ybHEZYPJo65QlD3Bf2/Q/eaHPiSWAAAAAElFTkSuQmCC",OQe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAETklEQVRYhe2YXYhVVRTHf3d0/JhyUrMpFbImM+whSa3Mynww+4AeIgiKoozooQ+KyMyXIAujF6OXqHyI6iEKKYgIP/owsjSFqCkprdDUTEcjbWZ0HHV+Pex1ucfb9Z57Z9REXHA4Z++99l7/s/ZZ/7X2KaiczNLwfwPIk9MA+yunNMAG4DHgV+BvoB3YFff2TPstYEyfrajVroI6Sr1GvahsbJC63HzZq04pmztSvU5tVRuqYRiYg78JeBR4HPg5ntdmxovz9wJfA3uAxuibDLQCA+IqynnAQuBuYCnwMLC1rx48U12U8cZqdWqMDcx4cI16qTpYbVKHqa+ovWUeHKsujn7VL9ULq2HI+wY7gVeBJdGeFu3J4ZUiy/cAXeHRRuAQsC/GC0B3eG4BcH/0tUV7czUAeVsMsBF4Kha9HZgCvAncAuwPnXHA0wFuGLANuDrGuoGDwFxgTqzzQ7RX5FrP2eLsdb76vnogtme6+nE8H1YPlQXHwbi3q9eqn0e7Tb25VrsF68vFY0lb1AGcDTwItGQ8tQM4AIwGmqP/EPAu8A0wElgJfFGzxTo8mKWXu9Rd4ZF96jvqjSbauEC9Sn1O3R463epLaku99voCsFXdkAH3kNpcQW+IiT/bQne3eufxBtioPqP2mKhioXpWzpxb1T8C5Ifh4ZptVoriRmAIKdrI3Lujf3bobAPeJpF0NVkKrAFuI9HTOBIxnxFrF4OgQKKr/dnJlQA+AcwABgOHA4zAamA5cE7orQL+zAEHiWI+A2bFC7aSguheYCgpqAphZz3wSB7AecCICv2TgH8oFRib4gVqka0k0h8CXAxMBW6ooDejFoCvA9OBQUAvKWM0kDz4XUZvNKXtyZMWUl7vBbaQXq457PeEziDgx/KJlQAuIPFdMcEXv5OdYWBP9M8k8VpnDQCvB4aTSrCNJB5cSdrW3tBpIJVnR0qdUTxAfdGUOVTnmwqEanNmqltC/9OgqePKg5eom8PgdvW+oJ9Kupera0O3U50TL3lcAaI+oHaF4R3qa6Z822wq0Saq89T1lmSxOrxeW/Xm4uGkiqQDmECKuKHxHW0HdpMiewSpvGqKeR8Ay0iBsYIjg6261PE2o9Q3Yqv+MqWxO9R1Hl12qs+q49Vlppy82pSr+5xJKsko4AXgHlJ0t5NIeg3wLXAlqZhtIUV8J6nmWwX8QiLjdhL5TwMWkY4R6/rrwYKlMr1Y321QZ/vfwBijPqm+rF4Wc7PjE9QllurGVeoV5gRNHsAm9fnMom3qrKPoTjKdMXaYyrFygEWQ72XWW24qhPu8xcUc2UU6O8wFPjmK7jhgPHAuMJGUGQ6U6WwE5sfzTXGvei7KA9hFOiR9D/wOfFVFt4dS2tpfRe83Ur7/CPiJakfOGgBCypubatArl2r8VfOax/LfzABKtePAzHO/5FgC7KBEzB2kOrDfUm8mOeFySv9+OyFyGmB/5aQH+C9BVKmVCNuMZgAAAABJRU5ErkJggg==",LQe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQ0lEQVQ4jWP8////fwYqAxYozUhFM/8zkaKYWIWkGEq0b0ZdSjQY5i79TyWagRGaTUdzFEEw6lLqGzqwLoVVJ1StpwA9sBwbUqAh5gAAAABJRU5ErkJggg==",Ak=class Ak extends Nn.Component{constructor(t){super(t);Xe(this,"scene");Xe(this,"renderer");Xe(this,"currentScene");Xe(this,"scenes",new Map);Xe(this,"cameras",new Map);Xe(this,"controls",new Map);Xe(this,"currentCamera");Xe(this,"currentWindow");Xe(this,"helpersContainer",new H8);Xe(this,"grid");Xe(this,"cameraHelpers",new Map);Xe(this,"lightHelpers",new Map);Xe(this,"interactionHelper",new RDe(25));Xe(this,"currentTransform");Xe(this,"splineEditor");Xe(this,"depthMaterial");Xe(this,"normalsMaterial");Xe(this,"uvMaterial");Xe(this,"wireframeMaterial",new Ua({opacity:.33,transparent:!0,wireframe:!0}));Xe(this,"playing",!1);Xe(this,"rafID",-1);Xe(this,"cameraControlsRafID",-1);Xe(this,"width",0);Xe(this,"height",0);Xe(this,"tlCam",null);Xe(this,"trCam",null);Xe(this,"blCam",null);Xe(this,"brCam",null);Xe(this,"tlRender","Renderer");Xe(this,"trRender","Renderer");Xe(this,"blRender","Renderer");Xe(this,"brRender","Renderer");Xe(this,"cameraVisibility",!0);Xe(this,"lightVisibility",!0);Xe(this,"gridVisibility",!0);Xe(this,"rendererReady",!1);Xe(this,"selectedItem");Xe(this,"debugCamera");Xe(this,"raycaster",new xE);Xe(this,"pointer",new vn);Xe(this,"cameraControls");Xe(this,"canvasRef");Xe(this,"containerRef");Xe(this,"tlWindow");Xe(this,"trWindow");Xe(this,"blWindow");Xe(this,"brWindow");Xe(this,"editorCameras",["Top","Bottom","Left","Right","Front","Back","Orthographic","UI","Debug"]);Xe(this,"setupRenderer",t=>{this.renderer&&this.renderer.dispose(),this.rendererReady=!1;const n=this.canvasRef.current;this.props.three.canvas=n;const r=t.value;r.type==="WebGLRenderer"?(this.renderer=new qN({canvas:n,stencil:!1}),this.depthMaterial=new Jve,this.normalsMaterial=new eq,this.uvMaterial=new bQe,this.grid=new FZe,this.scene.add(this.grid),this.rendererReady=!0):r.type==="WebGPURenderer"&&(this.renderer=new JN({canvas:n,stencil:!1}),this.grid=new QZe,this.scene.add(this.grid)),this.renderer&&(this.renderer.autoClear=!1,this.renderer.shadowMap.enabled=!0,this.renderer.setClearColor(0),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setScissorTest(!0),this.resize(),this.props.three.renderer=this.renderer,this.depthMaterial=new yQe,this.normalsMaterial=new h$,this.uvMaterial=new SQe,r.type==="WebGPURenderer"&&this.renderer.init().then(()=>{this.rendererReady=!0})),this.props.three.requestScene()});Xe(this,"onUpdate",()=>{this.playing&&(this.update(),this.draw(),this.rafID=requestAnimationFrame(this.onUpdate))});Xe(this,"resize",()=>{var c;this.width=window.innerWidth-300,this.height=window.innerHeight,(c=this.renderer)==null||c.setSize(this.width,this.height);const t=Math.floor(this.width/2),n=Math.floor(this.height/2);this.props.three.resize(this.width,this.height),this.props.onSceneResize!==void 0&&this.currentScene!==void 0&&this.props.onSceneResize(this.currentScene,this.width,this.height);let r=this.width,s=this.height;switch(this.state.mode){case"Side by Side":r=t,s=this.height;break;case"Stacked":r=this.width,s=n;break;case"Quad":r=t,s=n;break}const a=r/s;this.cameras.forEach(d=>{var p;d instanceof w2?(d.left=r/-2,d.right=r/2,d.top=s/2,d.bottom=s/-2,d.name==="UI"&&(d.position.x=this.width/2,d.position.y=this.height/-2,d.position.z=100),d.updateProjectionMatrix()):d instanceof ca&&(d.aspect=a,d.updateProjectionMatrix()),(p=this.cameraHelpers.get(d.name))==null||p.update()})});Xe(this,"addScene",t=>{const n=this.props.scenes.get(t.value.name);if(n!==void 0){const r=new n;r.visible=!1,this.props.onSceneAdd!==void 0&&this.props.onSceneAdd(r),this.props.three.scene=r,this.scenes.set(t.value.name,r),this.scene.add(r)}else console.log("Hermes - Scene not found:",t.value.name,this.props.scenes)});Xe(this,"sceneUpdate",t=>{this.currentScene!==void 0&&(this.currentScene.visible=!1,this.clearLightHelpers());const n=this.scene.getObjectByName(t.value.name);n!==void 0&&(this.currentScene=n,this.currentScene.visible=!0,this.addLightHelpers(this.currentScene))});Xe(this,"removeScene",t=>{const n=t.value.name;this.scenes.delete(n);const r=this.scene.getObjectByName(n);r&&setTimeout(()=>{Mh(r)},100),this.clearLightHelpers()});Xe(this,"addCamera",t=>{var a;const n=t.value,r=n.uuid,s=(a=this.props.three.scene)==null?void 0:a.getObjectByProperty("uuid",n.uuid);if(s!==void 0){const c=s;this.cameras.set(r,c);const d=new PDe(c);d.visible=this.cameraVisibility,this.cameraHelpers.set(r,d),this.helpersContainer.add(d),this.setState({lastUpdate:Date.now()})}});Xe(this,"removeCamera",t=>{const r=t.value.uuid,s=this.cameraHelpers.get(r);s!==void 0&&(this.helpersContainer.remove(s),s.dispose()),this.cameras.delete(r),this.setState({lastUpdate:Date.now()})});Xe(this,"onMouseMove",t=>{var x;const n=new vn;(x=this.renderer)==null||x.getSize(n);const r=Math.min(t.clientX,n.x),s=Math.min(t.clientY,n.y);this.pointer.x=k_(r,0,n.x,-1,1),this.pointer.y=k_(s,0,n.y,1,-1);const a=n.x/2,c=n.y/2,d=()=>{r<a?this.pointer.x=k_(r,0,a,-1,1):this.pointer.x=k_(r,a,n.x,-1,1)},p=()=>{s<c?this.pointer.y=k_(s,0,c,1,-1):this.pointer.y=k_(s,c,n.y,1,-1)};switch(this.state.mode){case"Quad":d(),p();break;case"Side by Side":d();break;case"Stacked":p(),p();break}if(this.updateCamera(r,s,a,c),this.state.interactionMode==="Orbit"||this.currentScene===void 0)return;const y=this.raycaster.intersectObjects(this.currentScene.children);y.length>0&&this.interactionHelper.position.copy(y[0].point)});Xe(this,"onClick",t=>{if(this.state.interactionMode==="Orbit"||this.currentScene===void 0)return;const n=new vn;if(this.renderer.getSize(n),t.clientX>=n.x)return;this.onMouseMove(t);const r=this.raycaster.intersectObjects(this.currentScene.children);r.length>0&&(this.props.three.getObject(r[0].object.uuid),this.interactionHelper.visible=!1,this.setState({interactionMode:"Orbit",lastUpdate:Date.now()}))});Xe(this,"onKey",t=>{if(this.selectedItem!==void 0){if(t.ctrlKey){if(this.currentCamera.name==="UI")return;const n=this.controls.get(this.currentCamera.name);t.key==="0"?(t.preventDefault(),this.clearControls(),this.cameraControls=new K1(this.currentCamera,this.currentWindow.current),this.selectedItem instanceof fn||this.selectedItem instanceof WW?(this.selectedItem.geometry.computeBoundingBox(),this.cameraControls.fitToBox(this.selectedItem.geometry.boundingBox,!0)):this.cameraControls.fitToSphere(this.selectedItem,!0),this.updateCameraControls(n,!0)):t.key==="1"?(t.preventDefault(),this.clearControls(),this.cameraControls=new K1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,Math.PI*.5,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="2"?(t.preventDefault(),this.clearControls(),this.cameraControls=new K1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,0,!0),this.cameraControls.moveTo(this.selectedItem.position.x,0,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="3"?(t.preventDefault(),this.clearControls(),this.cameraControls=new K1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI/2,Math.PI/2,!0),this.cameraControls.moveTo(0,this.selectedItem.position.y,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="4"?(t.preventDefault(),this.clearControls(),this.cameraControls=new K1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI,Math.PI/2,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="5"&&(t.preventDefault(),this.clearControls(),this.cameraControls=new K1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(gW(45),gW(45),!0),this.updateCameraControls(n))}else if(this.currentTransform!==void 0)switch(t.key){case"r":this.currentTransform.setMode("rotate");break;case"s":this.currentTransform.setMode("scale");break;case"t":this.currentTransform.setMode("translate");break;case"q":this.currentTransform.setSpace(this.currentTransform.space==="local"?"world":"local");break}}});Xe(this,"onSetSelectedItem",t=>{this.selectedItem!==void 0&&this.updateSelectedItemHelper(!1),this.selectedItem=void 0;const n=t.value.uuid;if(this.scenes.forEach(r=>{n.search(r.uuid)>-1&&(this.selectedItem=r.getObjectByProperty("uuid",n))}),this.selectedItem===void 0){console.log(`Hermes - Can't find selected item: ${t.value.uuid}, ${t.value.name}`);return}this.currentTransform!==void 0&&(this.currentTransform.removeEventListener("objectChange",this.onUpdateTransform),yd.instance.remove(this.currentTransform.getHelper().name)),this.currentTransform=yd.instance.add(t.value.name),this.currentTransform&&(this.currentTransform.attach(this.selectedItem),this.helpersContainer.add(this.currentTransform.getHelper()),this.currentTransform.addEventListener("objectChange",this.onUpdateTransform)),this.updateSelectedItemHelper(!0)});Xe(this,"onUpdateTransform",()=>{this.selectedItem!==void 0&&(this.props.three.updateObject(this.selectedItem.uuid,"position",this.selectedItem.position),this.props.three.updateObject(this.selectedItem.uuid,"rotation",{x:this.selectedItem.rotation.x,y:this.selectedItem.rotation.y,z:this.selectedItem.rotation.z}),this.props.three.updateObject(this.selectedItem.uuid,"scale",this.selectedItem.scale),Mk.instance.update())});Xe(this,"clearLightHelpers",()=>{this.lightHelpers.forEach(t=>{this.helpersContainer.remove(t),t.dispose()}),this.lightHelpers.clear()});Xe(this,"addLightHelpers",t=>{t.traverse(n=>{if(n.type.search("Light")>-1){let r;switch(n.type){case"DirectionalLight":r=new ADe(n,100),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"HemisphereLight":r=new CDe(n,250),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"RectAreaLight":r=new fZe(n),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"PointLight":r=new EDe(n,100),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"SpotLight":r=new wDe(n),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break}}})});Xe(this,"updateCamera",(t,n,r,s)=>{switch(this.state.mode){case"Quad":n<s?t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam:t<r?this.currentCamera=this.blCam:this.currentCamera=this.brCam;break;case"Side by Side":t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break;case"Single":this.currentCamera=this.tlCam;break;case"Stacked":n<s?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break}this.splineEditor.camera=this.currentCamera,this.raycaster.setFromCamera(this.pointer,this.currentCamera),this.currentCamera===this.tlCam?this.currentWindow=this.tlWindow:this.currentCamera===this.trCam?this.currentWindow=this.trWindow:this.currentCamera===this.blCam?this.currentWindow=this.blWindow:this.currentCamera===this.brCam&&(this.currentWindow=this.brWindow),yd.instance.updateCamera(this.currentCamera,this.currentWindow.current)});Xe(this,"updateCameraControls",(t,n=!1)=>{if(this.selectedItem===void 0)return;cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.cameraControls&&(this.cameraControls.smoothTime=.1);const r=.15,s=new SDe;s.start(),this.selectedItem.getWorldPosition(t.target0);const a=()=>{const c=s.getDelta();this.cameraControls&&this.cameraControls.update(c),n&&(t.target.lerp(t.target0,r),t.object.position.lerp(t.position0,r),t.object.zoom=jH(t.object.zoom,t.zoom0,r),t.object.updateProjectionMatrix(),t.dispatchEvent({type:"change"})),s.getElapsedTime()>=.5?(cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.clearControls()):this.cameraControlsRafID=requestAnimationFrame(a)};a()});Xe(this,"clearControls",()=>{this.cameraControls!==void 0&&(this.cameraControls.disconnect(),this.cameraControls.dispose(),this.cameraControls=void 0)});Xe(this,"drawDouble",()=>{const t=this.getSceneOverride(this.tlRender),n=this.getSceneOverride(this.trRender),r=Math.floor(this.width/2),s=Math.floor(this.height/2),a=this.renderer instanceof JN;if(this.state.mode==="Side by Side")this.drawTo(0,0,r,this.height,this.tlCam,t),this.drawTo(r,0,r,this.height,this.trCam,n);else{const c=this.height-s;a?(this.drawTo(0,0,this.width,s,this.tlCam,t),this.drawTo(0,c,this.width,s,this.trCam,n)):(this.drawTo(0,c,this.width,s,this.tlCam,t),this.drawTo(0,0,this.width,s,this.trCam,n))}});Xe(this,"drawQuad",()=>{const t=this.renderer instanceof JN,n=this.getSceneOverride(this.tlRender),r=this.getSceneOverride(this.trRender),s=this.getSceneOverride(this.blRender),a=this.getSceneOverride(this.brRender),c=Math.floor(this.width/2),d=Math.floor(this.height/2),p=this.height-d;let y=0,x=t?0:this.height-d;y=0,this.drawTo(y,x,c,d,this.tlCam,n),y=c,this.drawTo(y,x,c,d,this.trCam,r),x=t?p:0,y=0,this.scene.overrideMaterial=s,this.drawTo(y,x,c,d,this.blCam,s),y=c,this.drawTo(y,x,c,d,this.brCam,a)});this.props.three.addEventListener(_i.ADD_RENDERER,this.setupRenderer),this.scene=new c6,this.scene.name=this.scene.uuid="",this.canvasRef=Nn.createRef(),this.containerRef=Nn.createRef(),this.tlWindow=Nn.createRef(),this.trWindow=Nn.createRef(),this.blWindow=Nn.createRef(),this.brWindow=Nn.createRef();const n=t.three.name,r=localStorage,s=r.getItem(`${n}_mode`);this.state={mode:s!==null?s:"Single",modeOpen:!1,renderModeOpen:!1,interactionMode:"Orbit",interactionModeOpen:!1,lastUpdate:Date.now()},r.setItem(`${n}_mode`,this.state.mode),r.setItem(`${n}_tlCam`,r.getItem(`${n}_tlCam`)!==null?r.getItem(`${n}_tlCam`):"Debug"),r.setItem(`${n}_trCam`,r.getItem(`${n}_trCam`)!==null?r.getItem(`${n}_trCam`):"Orthographic"),r.setItem(`${n}_blCam`,r.getItem(`${n}_blCam`)!==null?r.getItem(`${n}_blCam`):"Front"),r.setItem(`${n}_brCam`,r.getItem(`${n}_brCam`)!==null?r.getItem(`${n}_brCam`):"Top"),r.setItem(`${n}_tlRender`,r.getItem(`${n}_tlRender`)!==null?r.getItem(`${n}_tlRender`):"Renderer"),r.setItem(`${n}_trRender`,r.getItem(`${n}_trRender`)!==null?r.getItem(`${n}_trRender`):"Renderer"),r.setItem(`${n}_blRender`,r.getItem(`${n}_blRender`)!==null?r.getItem(`${n}_blRender`):"Renderer"),r.setItem(`${n}_brRender`,r.getItem(`${n}_brRender`)!==null?r.getItem(`${n}_brRender`):"Renderer");const a={Vector2:vn,Vector3:_e,Vector4:wr,Quaternion:us,Matrix4:An,Spherical:FH,Box3:m6,Sphere:M2,Raycaster:xE};K1.install({THREE:a}),this.setupScene(),this.setupTools();const c=localStorage.getItem(this.expandedCameraVisibility);c!==null&&(this.cameraVisibility=c==="open"),this.saveExpandedCameraVisibility();const d=localStorage.getItem(this.expandedLightVisibility);d!==null&&(this.lightVisibility=d==="open"),this.saveExpandedLightVisibility();const p=localStorage.getItem(this.expandedGridVisibility);p!==null&&(this.gridVisibility=p==="open"),this.grid&&(this.grid.visible=this.gridVisibility),this.saveExpandedGridVisibility(),Ak.instance=this}componentDidMount(){this.enable(),this.assignControls(),this.resize(),this.play(),yd.instance.setApp(this.props.three),yd.instance.activeCamera=this.debugCamera,this.props.three.requestRenderer()}componentDidUpdate(t,n,r){n.mode!==this.state.mode&&(this.assignControls(),this.resize())}componentWillUnmount(){this.disable(),this.clear(),T4.removeEditorGroup("View Settings")}render(){const t=[];return this.cameras.forEach((n,r)=>{t.push(r)}),rt.jsxs("div",{className:"multiview",children:[rt.jsx("canvas",{ref:this.canvasRef}),rt.jsxs("div",{className:`cameras ${this.state.mode==="Single"||this.state.mode==="Stacked"?"single":""}`,ref:this.containerRef,children:[this.state.mode==="Single"&&rt.jsx(rt.Fragment,{children:rt.jsx(D8,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var s;(s=this.controls.get(this.tlCam.name))==null||s.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}})}),(this.state.mode==="Side by Side"||this.state.mode==="Stacked")&&rt.jsxs(rt.Fragment,{children:[rt.jsx(D8,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var s;(s=this.controls.get(this.tlCam.name))==null||s.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),rt.jsx(D8,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var s;(s=this.controls.get(this.trCam.name))==null||s.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}})]}),this.state.mode==="Quad"&&rt.jsxs(rt.Fragment,{children:[rt.jsx(D8,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var s;(s=this.controls.get(this.tlCam.name))==null||s.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),rt.jsx(D8,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var s;(s=this.controls.get(this.trCam.name))==null||s.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}}),rt.jsx(D8,{name:"bl",camera:this.blCam,options:t,ref:this.blWindow,onSelectCamera:n=>{var s;(s=this.controls.get(this.blCam.name))==null||s.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.blCam),this.blCam=r,localStorage.setItem(`${this.appID}_blCam`,r.name),this.createControls(r,this.blWindow.current))},onSelectRenderMode:n=>{this.blRender=n,localStorage.setItem(`${this.appID}_blRender`,n)}}),rt.jsx(D8,{name:"br",camera:this.brCam,options:t,ref:this.brWindow,onSelectCamera:n=>{var s;(s=this.controls.get(this.brCam.name))==null||s.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.brCam),this.brCam=r,localStorage.setItem(`${this.appID}_brCam`,r.name),this.createControls(r,this.brWindow.current))},onSelectRenderMode:n=>{this.brRender=n,localStorage.setItem(`${this.appID}_brRender`,n)}})]})]}),rt.jsxs("div",{className:"settings",children:[rt.jsx(Ek,{title:"View",index:vve.indexOf(this.state.mode),options:vve,onSelect:n=>{n!==this.state.mode&&(this.killControls(),this.setState({mode:n}),localStorage.setItem(`${this.appID}_mode`,n))},open:this.state.modeOpen,onToggle:n=>{this.setState({modeOpen:n,renderModeOpen:!1,interactionModeOpen:!1})}}),rt.jsx(Ek,{title:"Interact",index:this.state.interactionMode==="Orbit"?0:1,options:["Orbit Mode","Selection Mode"],onSelect:n=>{this.interactionHelper.visible=n==="Selection Mode",this.setState({interactionMode:this.interactionHelper.visible?"Selection":"Orbit"})},open:this.state.interactionModeOpen,onToggle:n=>{this.setState({modeOpen:!1,renderModeOpen:!1,interactionModeOpen:n})}}),rt.jsx(cH,{name:"cameraHelper",icon:DQe,selected:this.cameraVisibility,height:24,top:2,onClick:n=>{if(this.cameraVisibility=n,this.saveExpandedCameraVisibility(),this.cameraHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n){const r=this.cameraHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),rt.jsx(cH,{name:"lightHelper",icon:OQe,selected:this.lightVisibility,height:24,top:4,onClick:n=>{if(this.lightVisibility=n,this.saveExpandedLightVisibility(),this.lightHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n&&this.selectedItem.isLight===!0){const r=this.lightHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),rt.jsx(cH,{name:"gridHelper",icon:LQe,selected:this.gridVisibility,height:21,width:21,onClick:n=>{this.setGridVisibility(n)}})]},this.state.lastUpdate)]})}setupScene(){this.helpersContainer.name="helpers",this.scene.add(this.helpersContainer),this.interactionHelper.name="interactionHelper",this.interactionHelper.visible=!1,this.helpersContainer.add(this.interactionHelper);const t=(a,c)=>{const d=new w2(-100,100,100,-100,0,3e3);return d.name=a,d.position.copy(c),d.lookAt(0,0,0),this.cameras.set(a,d),d},n=1e3;t("Top",new _e(0,n,0)),t("Bottom",new _e(0,-n,0)),t("Left",new _e(-n,0,0)),t("Right",new _e(n,0,0)),t("Front",new _e(0,0,n)),t("Back",new _e(0,0,-n)),t("Orthographic",new _e(n,n,n)),t("UI",new _e),this.debugCamera=new ca(60,1,.01,3e3),this.debugCamera.name="Debug",this.debugCamera.position.set(300,300,300),this.debugCamera.lookAt(0,0,0),this.cameras.set("Debug",this.debugCamera),this.currentCamera=this.debugCamera;const r=localStorage,s=this.props.three.name;this.tlCam=this.cameras.get(r.getItem(`${s}_tlCam`)),this.trCam=this.cameras.get(r.getItem(`${s}_trCam`)),this.blCam=this.cameras.get(r.getItem(`${s}_blCam`)),this.brCam=this.cameras.get(r.getItem(`${s}_brCam`)),this.tlCam===void 0&&(this.tlCam=this.cameras.get("Debug")),this.trCam===void 0&&(this.trCam=this.cameras.get("Orthographic")),this.blCam===void 0&&(this.blCam=this.cameras.get("Front")),this.brCam===void 0&&(this.brCam=this.cameras.get("Top")),T4.addEditorGroup({title:"Editor",items:[{type:"button",prop:"Hide All Transforms"},{type:"button",prop:"Resize"}],onUpdate:(a,c)=>{switch(a){case"Hide All Transforms":yd.instance.hide();break;case"Resize":this.resize();break}},subgroups:[{title:"Debug Camera",items:[{type:"range",prop:"Near",step:1e-4,min:.001,max:1e3,value:this.debugCamera.near},{type:"range",prop:"Far",step:.001,min:.001,max:1e4,value:this.debugCamera.far}],onUpdate:(a,c)=>{switch(a){case"Near":this.debugCamera.near=c,this.debugCamera.updateProjectionMatrix();break;case"Far":this.debugCamera.far=c,this.debugCamera.updateProjectionMatrix();break}}},{title:"Grid",items:[{type:"number",prop:"Position",value:0},{type:"color",prop:"Color",value:"#FFFFFF"},{type:"range",prop:"Grid Opacity",value:.25,min:0,max:1,step:.01},{type:"range",prop:"Subgrid Opacity",value:.15,min:0,max:1,step:.01}],onUpdate:(a,c)=>{switch(a){case"Position":this.grid&&(this.grid.position.y=c);break;case"Color":this.grid&&this.grid.color.setStyle(c);break;case"Grid Opacity":this.grid&&(this.grid.gridOpacity=c);break;case"Subgrid Opacity":this.grid&&(this.grid.subgridOpacity=c);break}}}]})}setupTools(){this.splineEditor=new kQe(this.currentCamera,this.three),this.splineEditor.initDebug(),this.helpersContainer.add(this.splineEditor)}play(){this.playing=!0,this.onUpdate()}pause(){this.playing=!1,cancelAnimationFrame(this.rafID),this.rafID=-1}toggleOrbitControls(t){this.controls.forEach(n=>{n.enabled=!t})}clear(){this.three.dispatchEvent({type:_i.CLEAR_OBJECT}),T4.removeAllGroups(),this.clearLightHelpers(),this.clearControls(),this.currentTransform!==void 0&&(this.currentTransform.removeEventListener("objectChange",this.onUpdateTransform),yd.instance.remove(this.currentTransform.getHelper().name)),this.currentTransform=void 0,yd.instance.clear(),this.cameras.forEach(t=>{this.editorCameras.indexOf(t.name)<0&&this.three.dispatchEvent({type:_i.REMOVE_CAMERA,value:t})}),this.currentCamera=this.debugCamera,this.currentScene=void 0,this.scenes.forEach(t=>{this.three.dispatchEvent({type:_i.REMOVE_SCENE,value:t})}),this.scenes.clear()}setGridVisibility(t){this.gridVisibility=t,this.saveExpandedGridVisibility(),this.grid&&(this.grid.visible=t)}update(){var t;this.renderer&&this.rendererReady&&((t=this.renderer)==null||t.clear()),this.controls.forEach(n=>n.update()),this.cameraHelpers.forEach(n=>n.update()),this.lightHelpers.forEach(n=>{n.update!==void 0&&n.update()}),this.props.onSceneUpdate!==void 0&&this.currentScene!==void 0&&this.props.onSceneUpdate(this.currentScene)}draw(){var t;if(this.rendererReady)switch(this.renderer&&((t=this.renderer)==null||t.clear()),this.state.mode){case"Single":this.drawSingle();break;case"Side by Side":case"Stacked":this.drawDouble();break;case"Quad":this.drawQuad();break}}enable(){const t=this.containerRef.current;t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("click",this.onClick),window.addEventListener("keydown",this.onKey),window.addEventListener("resize",this.resize),this.three.addEventListener(_i.ADD_SCENE,this.addScene),this.three.addEventListener(_i.SET_SCENE,this.sceneUpdate),this.three.addEventListener(_i.REMOVE_SCENE,this.removeScene),this.three.addEventListener(_i.ADD_CAMERA,this.addCamera),this.three.addEventListener(_i.REMOVE_CAMERA,this.removeCamera),this.three.addEventListener(_i.SET_OBJECT,this.onSetSelectedItem)}disable(){const t=this.containerRef.current;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("click",this.onClick),window.removeEventListener("keydown",this.onKey),window.removeEventListener("resize",this.resize),this.three.removeEventListener(_i.ADD_SCENE,this.addScene),this.three.removeEventListener(_i.SET_SCENE,this.sceneUpdate),this.three.removeEventListener(_i.ADD_CAMERA,this.addCamera),this.three.removeEventListener(_i.REMOVE_CAMERA,this.removeCamera),this.three.removeEventListener(_i.SET_OBJECT,this.onSetSelectedItem)}updateSelectedItemHelper(t){if(this.selectedItem!==void 0)if(this.cameraVisibility){if(this.selectedItem.isLight===!0&&!this.lightVisibility){const n=this.lightHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}else{const n=this.cameraHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}createControls(t,n){const r=this.controls.get(t.name);if(r!==void 0&&r.dispose(),this.controls.delete(t.name),t.name==="UI")return;const s=new mZe(t,n);switch(s.enableDamping=!0,s.dampingFactor=.1,t.name){case"Top":case"Bottom":case"Left":case"Right":case"Front":case"Back":s.enableRotate=!1;break}this.controls.set(t.name,s)}clearCamera(t){const n=this.cameraHelpers.get(t.name);n!==void 0&&(this.helpersContainer.remove(n),n.dispose(),this.cameraHelpers.delete(t.name));const r=this.controls.get(t.name);r!==void 0&&(r.dispose(),this.controls.delete(t.name))}killControls(){this.controls.forEach((t,n)=>{t.dispose();const r=this.cameraHelpers.get(n);r!==void 0&&(this.helpersContainer.remove(r),r.dispose()),this.cameraHelpers.delete(n),this.controls.delete(n)}),this.controls.clear(),this.cameraHelpers.clear()}assignControls(){switch(this.state.mode){case"Single":this.createControls(this.tlCam,this.tlWindow.current);break;case"Side by Side":case"Stacked":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current);break;case"Quad":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current),this.createControls(this.blCam,this.blWindow.current),this.createControls(this.brCam,this.brWindow.current);break}}saveExpandedCameraVisibility(){localStorage.setItem(this.expandedCameraVisibility,this.cameraVisibility?"open":"closed")}saveExpandedLightVisibility(){localStorage.setItem(this.expandedLightVisibility,this.lightVisibility?"open":"closed")}saveExpandedGridVisibility(){localStorage.setItem(this.expandedGridVisibility,this.gridVisibility?"open":"closed")}getSceneOverride(t){switch(t){case"Depth":return this.depthMaterial;case"Normals":return this.normalsMaterial;case"Renderer":return null;case"UVs":return this.uvMaterial;case"Wireframe":return this.wireframeMaterial}return null}drawTo(t,n,r,s,a,c){var d,p,y;switch(a.name){case"Left":case"Right":this.grid&&(this.grid.rotation.z=Math.PI/2);break;case"Front":case"Back":this.grid&&(this.grid.rotation.x=Math.PI/2);break}this.scene.overrideMaterial=c,this.renderer&&((d=this.renderer)==null||d.setScissor(t,n,r,s),(p=this.renderer)==null||p.setViewport(t,n,r,s),(y=this.renderer)==null||y.render(this.scene,a)),this.grid&&this.grid.rotation.set(0,0,0)}drawSingle(){const t=this.getSceneOverride(this.tlRender);this.drawTo(0,0,this.width,this.height,this.tlCam,t)}get appID(){return this.props.three.name}get mode(){return this.state.mode}get three(){return this.props.three}get expandedCameraVisibility(){return`${this.appID}_multiviewCameraVisibility`}get expandedLightVisibility(){return`${this.appID}_multiviewLightVisibility`}get expandedGridVisibility(){return`${this.appID}_multiviewGridVisibility`}};Xe(Ak,"instance",null);let Fa=Ak;function dxe(i){if(i.child===void 0)return console.log("Hermes - No child attached"),null;const e=Nn.useRef(null),[t,n]=Nn.useState(!1),r=i.child.children.length>0,s=[];return i.child.children.length>0&&i.child.children.map((a,c)=>{s.push(rt.jsx(dxe,{child:a,three:i.three},c))}),Nn.useEffect(()=>{if(i.child){const a=i.child.uuid.split(".")[0],c=i.three.getScene(a);if(c!==null)try{const d=c.getObjectByProperty("uuid",i.child.uuid);d!==void 0?e.current.style.opacity=d.visible?"1":"0.25":console.log(`Hermes - Can't find child: ${i.child.uuid}`)}catch(d){console.log("Error looking for child:",d),console.log(i.child),console.log(i.three.scenes),console.log(c)}else console.log(`Hermes (ChildObject) - Can't find Scene: ${a} with child UUID: ${i.child.uuid}`,i.three.scenes,i.three.scene,c)}},[t]),rt.jsxs("div",{className:"childObject",children:[rt.jsxs("div",{className:"child",children:[r?rt.jsx("button",{className:"status",style:{backgroundPositionX:t?"-14px":"2px"},onClick:()=>{n(!t)}}):null,rt.jsx("button",{className:"name",style:{left:r?"20px":"5px"},onClick:()=>{i.child!==void 0?(i.three.getObject(i.child.uuid),!t&&r&&n(!0)):console.log("Hermes - No child attached...")},children:i.child.name.length>0?`${i.child.name} (${i.child.type})`:`${i.child.type}::${i.child.uuid}`}),rt.jsx("button",{className:"visibility",ref:e,onClick:()=>{if(i.child){const a=i.three.getScene(i.child.uuid);if(a!==null){const c=a.getObjectByProperty("uuid",i.child.uuid);if(c!==void 0){const d="visible",p=!c.visible;e.current.style.opacity=p?"1":"0.25",i.three.updateObject(i.child.uuid,d,p),Ea(c,d,p)}else console.log(`Hermes - Couldn't find object: ${i.child.uuid}`,a)}else console.log(`Hermes - Couldn't find object in scene: ${i.child.uuid}, ${i.child.name}`)}}}),rt.jsx("div",{className:`icon ${UBe(i.child)}`})]}),rt.jsx("div",{className:t?"open":"",children:rt.jsx("div",{className:"container",children:s})})]},Math.random())}function pH(i){var t;const e=[];return(t=i.child)==null||t.children.map((n,r)=>{e.push(rt.jsx(dxe,{child:n,scene:i.scene,three:i.three},r))}),rt.jsx("div",{className:`scene ${i.class!==void 0?i.class:""}`,children:e})}function yve(i){switch(i){case"fov":return"FOV";case"zoom":return"Zoom";case"near":return"Near";case"far":return"Far";case"focus":return"Focus";case"aspect":return"Aspect";case"filmGauge":return"Film Gauge";case"filmOffset":return"Film Offset";case"left":return"Left";case"right":return"Right";case"top":return"Top";case"bottom":return"Bottom"}return i}function FQe(i,e){function t(){return`${e.name}_camera`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function s(c){localStorage.setItem(t(),c?"open":"closed")}const a=[];if(i.perspectiveCameraInfo!==void 0)for(const c in i.perspectiveCameraInfo)a.push({title:yve(c),prop:c,type:"number",step:.01,value:i.perspectiveCameraInfo[c],onChange:(d,p)=>{e.updateObject(i.uuid,d,p),e.requestMethod(i.uuid,"updateProjectionMatrix");const y=e.getScene(i.uuid);if(y!==null){const x=y.getObjectByProperty("uuid",i.uuid);x!==void 0&&(Ea(x,d,p),x.updateProjectionMatrix())}}});else if(i.orthographicCameraInfo!==void 0)for(const c in i.orthographicCameraInfo)a.push({title:yve(c),prop:c,type:"number",step:.01,value:i.orthographicCameraInfo[c],onChange:(d,p)=>{e.updateObject(i.uuid,d,p),e.requestMethod(i.uuid,"updateProjectionMatrix");const y=e.getScene(i.uuid);if(y!==null){const x=y.getObjectByProperty("uuid",i.uuid);x!==void 0&&(Ea(x,d,p),x.updateProjectionMatrix())}}});return rt.jsx(Rh,{three:e,title:"Camera",items:a,expanded:r,onToggle:c=>{s(c)}})}function _ve(i){switch(i){case"color":return"Color";case"intensity":return"Intensity";case"decay":return"Decay";case"distance":return"Distance";case"angle":return"Angle";case"penumbra":return"Penumbra";case"groundColor":return"Ground Color";case"width":return"Width";case"height":return"Height"}return i}function UQe(i,e){function t(){return`${e.name}_light`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function s(c){localStorage.setItem(t(),c?"open":"closed")}const a=[];if(i.lightInfo!==void 0)for(const c in i.lightInfo){const d=i.lightInfo[c];d!==void 0&&(d.isColor!==void 0?a.push({title:_ve(c),prop:c,type:"color",value:d,onChange:(p,y)=>{const x=new xn(y);e.updateObject(i.uuid,p,x);const w=e.getScene(i.uuid);if(w!==null){const C=w.getObjectByProperty("uuid",i.uuid);Ea(C,p,x)}}}):a.push({title:_ve(c),prop:c,type:typeof d,value:d,step:typeof d=="number"?.01:void 0,onChange:(p,y)=>{e.updateObject(i.uuid,p,y);const x=e.getScene(i.uuid);if(x!==null){const w=x.getObjectByProperty("uuid",i.uuid);Ea(w,p,y)}}}))}return rt.jsx(Rh,{three:e,title:"Light",items:a,expanded:r,onToggle:c=>{s(c)}})}function BQe(i){var w;const e=i.object,t=i.three;function n(){return`${t.name}_animation`}const r=localStorage.getItem(n()),s=r!==null?r==="open":!1;function a(C){localStorage.setItem(n(),C?"open":"closed")}const c=[],d=[];let p=0;e.animations.forEach(C=>{p=Math.max(p,C.duration),C.duration>0&&d.push({title:C.name,items:[{title:"Duration",type:"number",value:C.duration,disabled:!0},{title:"Blend Mode",type:"option",disabled:!0,options:[{title:"Normal",value:2500},{title:"Additive",value:2501}]}]})}),c.push({title:"Animations",items:d});let y;const x=t.getScene(e.uuid);if(x!==null){const C=x.getObjectByProperty("uuid",e.uuid);if(C!==void 0){const N=C.mixer;if(N!==void 0){const U=[{title:"Time Scale",type:"range",value:N.timeScale,step:.01,min:-1,max:2,onChange:(R,B)=>{N.timeScale=B,t.updateObject(e.uuid,"mixer.timeScale",B)}}];U.push({title:"Stop All",type:"button",onChange:()=>{N.stopAllAction(),t.requestMethod(e.uuid,"stopAllAction",void 0,"mixer")}}),c.push({title:"Mixer",items:U}),y=new TDe(C),(w=Fa.instance)==null||w.scene.add(y)}}}return Nn.useEffect(()=>()=>{y!==void 0&&Mh(y)},[]),rt.jsx(Rh,{three:i.three,title:"Animation",items:c,expanded:s,onToggle:C=>{a(C)}})}const mH={name:"",uuid:"",type:"",visible:!1,matrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};function zQe(i){const[e,t]=Nn.useState(mH);Nn.useEffect(()=>{function a(d){t(d.value)}function c(){t(mH)}return i.three.addEventListener(_i.CLEAR_OBJECT,c),i.three.addEventListener(_i.SET_SCENE,c),i.three.addEventListener(_i.SET_OBJECT,a),()=>{i.three.removeEventListener(_i.CLEAR_OBJECT,c),i.three.removeEventListener(_i.SET_SCENE,c),i.three.removeEventListener(_i.SET_OBJECT,a)}},[]);const n=e.type.toLowerCase(),r=e.animations.length>0||e.mixer!==void 0,s=n.search("mesh")>-1||n.search("line")>-1||n.search("points")>-1;return s&&console.log(n,e),rt.jsx(ZT,{three:i.three,label:"Inspector",button:e.uuid.length>0?rt.jsx("button",{className:"remove",onClick:()=>{yd.instance.remove(e.name),t(mH)}}):void 0,children:rt.jsx("div",{id:"Inspector",className:i.class,children:e.uuid.length>0&&rt.jsxs(rt.Fragment,{children:[rt.jsxs(rt.Fragment,{children:[rt.jsx(ek,{type:"string",title:"Name",prop:"name",value:e.name,disabled:!0}),rt.jsx(ek,{type:"string",title:"Type",prop:"type",value:e.type,disabled:!0}),rt.jsx(ek,{type:"string",title:"UUID",prop:"uuid",value:e.uuid,disabled:!0})]}),rt.jsxs(rt.Fragment,{children:[rt.jsx(Mk,{object:e,three:i.three}),r?rt.jsx(BQe,{object:e,three:i.three}):null,n.search("camera")>-1?FQe(e,i.three):null,n.search("light")>-1?UQe(e,i.three):null,s?mQe(e,i.three):null]})]})})},"Inspector")}class VQe extends Nn.Component{constructor(t){super(t);Xe(this,"autoClear",!0);Xe(this,"autoClearColor",!0);Xe(this,"autoClearDepth",!0);Xe(this,"autoClearStencil",!0);Xe(this,"outputColorSpace",ti);Xe(this,"localClippingEnabled",!1);Xe(this,"clearColor",new xn(0));Xe(this,"clearAlpha",1);Xe(this,"toneMapping",Qa);Xe(this,"toneMappingExposure",1);Xe(this,"type","");Xe(this,"onAddRenderer",t=>{const n=t.value;if(this.autoClear=n.autoClear,this.autoClearColor=n.autoClearColor,this.autoClearDepth=n.autoClearDepth,this.autoClearStencil=n.autoClearStencil,this.outputColorSpace=n.outputColorSpace,this.localClippingEnabled=n.localClippingEnabled,this.clearAlpha=n.clearAlpha,this.type=n.type,this.toneMapping=n.toneMapping,this.toneMappingExposure=n.toneMappingExposure,this.clearColor.setStyle(n.clearColor,Fc),Xn.enabled=n.colorManagement,Fa.instance){const r=Fa.instance.renderer;r&&(r.autoClearColor=this.autoClearColor,r.outputColorSpace=this.outputColorSpace,r instanceof qN&&(r.localClippingEnabled=this.localClippingEnabled),r.toneMapping=this.toneMapping,r.toneMappingExposure=this.toneMappingExposure,r.setClearColor(n.clearColor,this.clearAlpha))}this.setState({lastUpdated:Date.now()})});const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;if(this.state={expanded:r,lastUpdated:Date.now()},this.saveExpanded(r),Fa.instance){const s=Fa.instance.renderer;s&&(this.autoClear=s.autoClear,this.autoClearColor=s.autoClearColor,this.autoClearDepth=s.autoClearDepth,this.autoClearStencil=s.autoClearStencil,this.clearAlpha=s.getClearAlpha(),this.toneMapping=s.toneMapping,this.toneMappingExposure=s.toneMappingExposure,s instanceof qN&&(this.localClippingEnabled=s.localClippingEnabled,s.getClearColor(this.clearColor)))}this.props.three.addEventListener(_i.ADD_RENDERER,this.onAddRenderer)}componentwillunmount(){this.props.three.removeEventListener(_i.ADD_RENDERER,this.onAddRenderer)}render(){const t=()=>{if(Fa.instance){const n=Fa.instance.renderer;n&&(n.autoClearColor=this.autoClearColor,n.outputColorSpace=this.outputColorSpace,n instanceof qN&&(n.localClippingEnabled=this.localClippingEnabled),n.toneMapping=this.toneMapping,n.toneMappingExposure=this.toneMappingExposure,n.setClearColor(this.clearColor.getStyle(),this.clearAlpha),this.props.three.updateRenderer({autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,outputColorSpace:this.outputColorSpace,localClippingEnabled:this.localClippingEnabled,clearAlpha:this.clearAlpha,clearColor:this.clearColor.getStyle(),colorManagement:Xn.enabled,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure}))}};return rt.jsx(Rh,{three:this.props.three,title:"Renderer",expanded:this.state.expanded,items:[{type:"boolean",title:"Auto Clear",value:this.autoClear,onChange:(n,r)=>{this.autoClear=r}},{type:"boolean",title:"Auto Clear Color",value:this.autoClearColor,onChange:(n,r)=>{this.autoClearColor=r,t()}},{type:"boolean",title:"Auto Clear Depth",value:this.autoClearDepth,onChange:(n,r)=>{this.autoClearDepth=r,t()}},{type:"boolean",title:"Auto Clear Stencil",value:this.autoClearStencil,onChange:(n,r)=>{this.autoClearStencil=r,t()}},{type:"boolean",title:"Local Clipping",value:this.localClippingEnabled,onChange:(n,r)=>{this.localClippingEnabled=r,t()}},{type:"color",title:"Clear Color",value:`#${this.clearColor.getHexString()}`,onChange:(n,r)=>{this.clearColor.setStyle(r),t()}},{type:"range",title:"Clear Alpha",min:0,max:1,step:.01,value:this.clearAlpha,onChange:(n,r)=>{this.clearAlpha=r,t()}},{type:"boolean",title:"Color Management",value:Xn.enabled,onChange:(n,r)=>{Xn.enabled=r,t()}},{type:"option",title:"Color Space",value:this.outputColorSpace,options:[{title:"No Color Space",value:il},{title:"SRB Color Space",value:ti},{title:"Linear SRB Color Space",value:Fc}],onChange:(n,r)=>{this.outputColorSpace=r,t()}},{type:"option",title:"Tone Mapping",value:this.toneMapping,options:[{title:"None ",value:Qa},{title:"Linear ",value:Nk},{title:"Reinhard",value:kk},{title:"Cineon ",value:Dk},{title:"ACES Filmic",value:Ok},{title:"AgX",value:Lk},{title:"Neutral",value:Fk},{title:"Custom",value:PW}],onChange:(n,r)=>{this.toneMapping=r,t()}},{type:"range",title:"Tone Mapping Exposure",value:this.toneMappingExposure,min:0,max:2,step:.01,onChange:(n,r)=>{this.toneMappingExposure=r,t()}},{type:"string",title:"Type",value:this.type,disabled:!0},{type:"button",title:"Resize Scenes from Source",onChange:()=>{this.props.three.requestSize()}}],onToggle:n=>{this.setState({expanded:n}),this.saveExpanded(n)}},Math.random())}saveExpanded(t){localStorage.setItem(this.expandedName,t?"open":"closed")}get expandedName(){return`${this.props.three.name}_renderer`}}function GQe(i){const[e]=Nn.useState([]),[t]=Nn.useState([]),[n,r]=Nn.useState(0),s=p=>{const y=p.value;e.push(y),t.push(rt.jsx(ZT,{three:i.three,label:`Scene: ${y.name}`,scene:y,open:!1,visible:!1,onRefresh:()=>{i.three.refreshScene(y.name)},children:rt.jsx(pH,{child:y,scene:y,three:i.three})},y.name)),r(Date.now())},a=p=>{const y=p.value;for(let x=0;x<e.length;x++)if(y.uuid===e[x].uuid){e[x]=y,t[x]=rt.jsx(ZT,{three:i.three,label:`Scene: ${y.name}`,scene:y,open:t[x].props.open,visible:t[x].props.visible,onRefresh:()=>{i.three.refreshScene(y.name)},children:rt.jsx(pH,{child:y,scene:y,three:i.three})},y.name),r(Date.now());return}},c=p=>{const y=p.value;for(let x=0;x<e.length;x++)if(y.uuid===e[x].uuid){e.splice(x,1),t.splice(x,1),r(Date.now());return}},d=p=>{const y=p.value.name;for(let x=0;x<e.length;x++){const w=e[x],C=w.name===y;t[x]=rt.jsx(ZT,{three:i.three,label:`Scene: ${w.name}`,scene:w,open:C,visible:C,onRefresh:()=>{i.three.refreshScene(w.name)},children:rt.jsx(pH,{child:w,scene:w,three:i.three})},w.name)}r(Date.now())};return Nn.useEffect(()=>(i.three.addEventListener(_i.ADD_SCENE,s),i.three.addEventListener(_i.SET_SCENE,d),i.three.addEventListener(_i.REFRESH_SCENE,a),i.three.addEventListener(_i.REMOVE_SCENE,c),()=>{i.three.removeEventListener(_i.ADD_SCENE,s),i.three.removeEventListener(_i.SET_SCENE,d),i.three.removeEventListener(_i.REFRESH_SCENE,a),i.three.removeEventListener(_i.REMOVE_SCENE,c)}),[]),rt.jsxs("div",{id:"SidePanel",children:[rt.jsx("div",{className:"scenes",children:t},n),rt.jsx(zQe,{three:i.three}),rt.jsx(VQe,{three:i.three}),rt.jsx(T4,{three:i.three})]})}function jQe(i){return rt.jsx(WBe,{children:rt.jsxs(rt.Fragment,{children:[rt.jsx(Fa,{three:i.three,scenes:i.scenes,onSceneAdd:i.onSceneAdd,onSceneResize:i.onSceneResize,onSceneUpdate:i.onSceneUpdate}),rt.jsx(GQe,{three:i.three})]})})}async function HQe(){var n;for(;!document.getElementById("theatrejs-studio-root");)await new Promise(r=>setTimeout(r,100));const i=document.getElementById("theatrejs-studio-root");if(i===null||i.shadowRoot===null)return;const e=i.shadowRoot.getElementById("pointer-root");if(e===null)return;const t=e.children[0];if(t!==null){try{const s=t.children[1].children[1];(n=s.parentElement)==null||n.removeChild(s)}catch{}try{const r=t.children[3];r.style.top="0",r.style.right="300px"}catch{}}}/**
 * postprocessing v6.37.6 build Fri Jul 04 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var gH=1/1e3,WQe=1e3,qQe=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(i){typeof document<"u"&&document.hidden!==void 0&&(i?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=i)}get delta(){return this._delta*gH}get fixedDelta(){return this._fixedDelta*gH}set fixedDelta(i){this._fixedDelta=i*WQe}get elapsed(){return this._elapsed*gH}update(i){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(i!==void 0?i:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(i){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},$Qe=(()=>{const i=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new Ii;return t.setAttribute("position",new Ba(i,3)),t.setAttribute("uv",new Ba(e,2)),t})(),kh=class yW{static get fullscreenGeometry(){return $Qe}constructor(e="Pass",t=new c6,n=new Wk){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new fn(yW.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new c6),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=FE){}render(e,t,n,r,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Ja||t instanceof R0||t instanceof ro||t instanceof yW)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},XQe=class extends kh{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(i,e,t,n,r){const s=i.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},YQe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,hxe="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",V$=class extends za{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ds(null),opacity:new Ds(1)},blending:vo,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:YQe,vertexShader:hxe})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}getOpacity(i){return this.uniforms.opacity.value}setOpacity(i){this.uniforms.opacity.value=i}},KQe=class extends kh{constructor(i,e=!0){super("CopyPass"),this.fullscreenMaterial=new V$,this.needsSwap=!1,this.renderTarget=i,i===void 0&&(this.renderTarget=new Ja(1,1,{minFilter:Bi,magFilter:Bi,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(i){this.autoResize=i}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(i){this.autoResize=i}render(i,e,t,n,r){this.fullscreenMaterial.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){this.autoResize&&this.renderTarget.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==Yi?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":i!==null&&i.outputColorSpace===ti&&(this.renderTarget.texture.colorSpace=ti))}},xve=new xn,fxe=class extends kh{constructor(i=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=i,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(i,e,t){this.color=i,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(i){this.overrideClearColor=i}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(i){this.overrideClearAlpha=i}render(i,e,t,n,r){const s=this.overrideClearColor,a=this.overrideClearAlpha,c=i.getClearAlpha(),d=s!==null,p=a>=0;d?(i.getClearColor(xve),i.setClearColor(s,p?a:c)):p&&i.setClearAlpha(a),i.setRenderTarget(this.renderToScreen?null:e),i.clear(this.color,this.depth,this.stencil),d?i.setClearColor(xve,c):p&&i.setClearAlpha(c)}},ZQe=class extends kh{constructor(i,e){super("MaskPass",i,e),this.needsSwap=!1,this.clearPass=new fxe(!1,!1,!0),this.inverse=!1}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get inverted(){return this.inverse}set inverted(i){this.inverse=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(i){this.inverted=i}render(i,e,t,n,r){const s=i.getContext(),a=i.state.buffers,c=this.scene,d=this.camera,p=this.clearPass,y=this.inverted?0:1,x=1-y;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,y,4294967295),a.stencil.setClear(x),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(i,null):(p.render(i,e),p.render(i,t))),this.renderToScreen?(i.setRenderTarget(null),i.render(c,d)):(i.setRenderTarget(e),i.render(c,d),i.setRenderTarget(t),i.render(c,d)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},QQe=class{constructor(i=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:n=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,r,n),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new KQe,this.depthTexture=null,this.passes=[],this.timer=new qQe,this.autoRenderToScreen=!0,this.setRenderer(i)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(i){const e=this.inputBuffer,t=this.multisampling;t>0&&i>0?(this.inputBuffer.samples=i,this.outputBuffer.samples=i,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==i&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,i),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(i){if(this.renderer=i,i!==null){const e=i.getSize(new vn),t=i.getContext().getContextAttributes().alpha,n=this.inputBuffer.texture.type;n===Yi&&i.outputColorSpace===ti&&(this.inputBuffer.texture.colorSpace=ti,this.outputBuffer.texture.colorSpace=ti,this.inputBuffer.dispose(),this.outputBuffer.dispose()),i.autoClear=!1,this.setSize(e.width,e.height);for(const r of this.passes)r.initialize(i,t,n)}}replaceRenderer(i,e=!0){const t=this.renderer,n=t.domElement.parentNode;return this.setRenderer(i),e&&n!==null&&(n.removeChild(t.domElement),n.appendChild(i.domElement)),t}createDepthTexture(){const i=this.depthTexture=new ll;return this.inputBuffer.depthTexture=i,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(i.format=Wl,i.type=Cu):i.type=ys,i}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const i of this.passes)i.setDepthTexture(null)}}createBuffer(i,e,t,n){const r=this.renderer,s=r===null?new vn:r.getDrawingBufferSize(new vn),a={minFilter:Bi,magFilter:Bi,stencilBuffer:e,depthBuffer:i,type:t},c=new Ja(s.width,s.height,a);return n>0&&(c.ignoreDepthForMultisampleCopy=!1,c.samples=n),t===Yi&&r!==null&&r.outputColorSpace===ti&&(c.texture.colorSpace=ti),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(i){for(const e of this.passes)e.mainScene=i}setMainCamera(i){for(const e of this.passes)e.mainCamera=i}addPass(i,e){const t=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new vn),s=n.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(i.setRenderer(n),i.setSize(r.width,r.height),i.initialize(n,s,a),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),i.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,i):t.push(i),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),i.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(i of t)i.setDepthTexture(c)}else i.setDepthTexture(this.depthTexture)}removePass(i){const e=this.passes,t=e.indexOf(i);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const s=(c,d)=>c||d.needsDepthTexture;e.reduce(s,!1)||(i.getDepthTexture()===this.depthTexture&&i.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(i.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const i=this.passes;this.deleteDepthTexture(),i.length>0&&(this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!1),this.passes=[])}render(i){const e=this.renderer,t=this.copyPass;let n=this.inputBuffer,r=this.outputBuffer,s=!1,a,c,d;i===void 0&&(this.timer.update(),i=this.timer.getDelta());for(const p of this.passes)p.enabled&&(p.render(e,n,r,i,s),p.needsSwap&&(s&&(t.renderToScreen=p.renderToScreen,a=e.getContext(),c=e.state.buffers.stencil,c.setFunc(a.NOTEQUAL,1,4294967295),t.render(e,n,r,i,s),c.setFunc(a.EQUAL,1,4294967295)),d=n,n=r,r=d),p instanceof ZQe?s=!0:p instanceof XQe&&(s=!1))}setSize(i,e,t){const n=this.renderer,r=n.getSize(new vn);(i===void 0||e===void 0)&&(i=r.width,e=r.height),(r.width!==i||r.height!==e)&&n.setSize(i,e,t);const s=n.getDrawingBufferSize(new vn);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const a of this.passes)a.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const i of this.passes)i.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),kh.fullscreenGeometry.dispose()}},r6={NONE:0,DEPTH:1,CONVOLUTION:2},cs={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},JQe=class{constructor(){this.shaderParts=new Map([[cs.FRAGMENT_HEAD,null],[cs.FRAGMENT_MAIN_UV,null],[cs.FRAGMENT_MAIN_IMAGE,null],[cs.VERTEX_HEAD,null],[cs.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=r6.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Fc}},vH=!1,bve=class{constructor(i=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(i),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case no:t=this.materialsFlatShadedDoubleSide;break;case Ui:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case no:t=this.materialsDoubleSide;break;case Ui:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(i){if(!(i instanceof za))return i.clone();const e=i.uniforms,t=new Map;for(const r in e){const s=e[r].value;s.isRenderTargetTexture&&(e[r].value=null,t.set(r,s))}const n=i.clone();for(const r of t)e[r[0]].value=r[1],n.uniforms[r[0]].value=r[1];return n}setMaterial(i){if(this.disposeMaterials(),this.material=i,i!==null){const e=this.materials=[this.cloneMaterial(i),this.cloneMaterial(i),this.cloneMaterial(i)];for(const t of e)t.uniforms=Object.assign({},i.uniforms),t.side=ol;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=Ui,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=no,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=Ui,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=no,n})}}render(i,e,t){const n=i.shadowMap.enabled;if(i.shadowMap.enabled=!1,vH){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),i.render(e,t);for(const s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,i.render(e,t),e.overrideMaterial=r}i.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const i=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of i)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return vH}static set workaroundEnabled(i){vH=i}},e4=-1,rm=class extends Yl{constructor(i,e=e4,t=e4,n=1){super(),this.resizable=i,this.baseSize=new vn(1,1),this.preferredSize=new vn(e,t),this.target=this.preferredSize,this.s=n,this.effectiveSize=new vn,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const i=this.baseSize,e=this.preferredSize,t=this.effectiveSize,n=this.scale;e.width!==e4?t.width=e.width:e.height!==e4?t.width=Math.round(e.height*(i.width/Math.max(i.height,1))):t.width=Math.round(i.width*n),e.height!==e4?t.height=e.height:e.width!==e4?t.height=Math.round(e.width/Math.max(i.width/Math.max(i.height,1),1)):t.height=Math.round(i.height*n)}get width(){return this.effectiveSize.width}set width(i){this.preferredWidth=i}get height(){return this.effectiveSize.height}set height(i){this.preferredHeight=i}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(i){this.s!==i&&(this.s=i,this.preferredSize.setScalar(e4),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(i){this.scale=i}get baseWidth(){return this.baseSize.width}set baseWidth(i){this.baseSize.width!==i&&(this.baseSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(i){this.baseWidth=i}get baseHeight(){return this.baseSize.height}set baseHeight(i){this.baseSize.height!==i&&(this.baseSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(i){this.baseHeight=i}setBaseSize(i,e){(this.baseSize.width!==i||this.baseSize.height!==e)&&(this.baseSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(i){this.preferredSize.width!==i&&(this.preferredSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(i){this.preferredWidth=i}get preferredHeight(){return this.preferredSize.height}set preferredHeight(i){this.preferredSize.height!==i&&(this.preferredSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(i){this.preferredHeight=i}setPreferredSize(i,e){(this.preferredSize.width!==i||this.preferredSize.height!==e)&&(this.preferredSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(i){this.s=i.scale,this.baseSize.set(i.baseWidth,i.baseHeight),this.preferredSize.set(i.preferredWidth,i.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return e4}},Fi={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},eJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),opacity);}",tJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",nJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),opacity);}",rJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",iJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),opacity);}",sJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),opacity);}",oJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),opacity);}",aJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),opacity);}",lJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),opacity);}",cJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),opacity);}",uJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),opacity);}",dJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),opacity);}",hJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),opacity);}",fJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),opacity);}",pJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),opacity);}",mJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),opacity);}",gJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",vJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),opacity);}",yJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",_Je="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),opacity);}",xJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),opacity);}",bJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),opacity);}",SJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",wJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),opacity);}",TJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),opacity);}",EJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),opacity);}",MJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",CJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),opacity);}",AJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),opacity);}",PJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",RJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),opacity);}",IJe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),opacity);}",NJe=new Map([[Fi.ADD,eJe],[Fi.ALPHA,tJe],[Fi.AVERAGE,nJe],[Fi.COLOR,rJe],[Fi.COLOR_BURN,iJe],[Fi.COLOR_DODGE,sJe],[Fi.DARKEN,oJe],[Fi.DIFFERENCE,aJe],[Fi.DIVIDE,lJe],[Fi.DST,null],[Fi.EXCLUSION,cJe],[Fi.HARD_LIGHT,uJe],[Fi.HARD_MIX,dJe],[Fi.HUE,hJe],[Fi.INVERT,fJe],[Fi.INVERT_RGB,pJe],[Fi.LIGHTEN,mJe],[Fi.LINEAR_BURN,gJe],[Fi.LINEAR_DODGE,vJe],[Fi.LINEAR_LIGHT,yJe],[Fi.LUMINOSITY,_Je],[Fi.MULTIPLY,xJe],[Fi.NEGATION,bJe],[Fi.NORMAL,SJe],[Fi.OVERLAY,wJe],[Fi.PIN_LIGHT,TJe],[Fi.REFLECT,EJe],[Fi.SATURATION,MJe],[Fi.SCREEN,CJe],[Fi.SOFT_LIGHT,AJe],[Fi.SRC,PJe],[Fi.SUBTRACT,RJe],[Fi.VIVID_LIGHT,IJe]]),kJe=class extends Yl{constructor(i,e=1){super(),this._blendFunction=i,this.opacity=new Ds(e)}getOpacity(){return this.opacity.value}setOpacity(i){this.opacity.value=i}get blendFunction(){return this._blendFunction}set blendFunction(i){this._blendFunction=i,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(i){this.blendFunction=i}getShaderCode(){return NJe.get(this.blendFunction)}},G$=class extends Yl{constructor(i,e,{attributes:t=r6.NONE,blendFunction:n=Fi.NORMAL,defines:r=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:c=null}={}){super(),this.name=i,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=c,this.defines=r,this.uniforms=s,this.extensions=a,this.blendMode=new kJe(n),this.blendMode.addEventListener("change",d=>this.setChanged()),this._inputColorSpace=Fc,this._outputColorSpace=il}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(i){this._inputColorSpace=i,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(i){this._outputColorSpace=i,this.setChanged()}set mainScene(i){}set mainCamera(i){}getName(){return this.name}setRenderer(i){this.renderer=i}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(i){this.attributes=i,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(i){this.fragmentShader=i,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(i){this.vertexShader=i,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(i,e=FE){}update(i,e,t){}setSize(i,e){}initialize(i,e,t){}dispose(){for(const i of Object.keys(this)){const e=this[i];(e instanceof Ja||e instanceof R0||e instanceof ro||e instanceof kh)&&this[i].dispose()}}},j$={MEDIUM:2,LARGE:3},DJe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,OJe="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",LJe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],FJe=class extends za{constructor(i=new wr){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ds(null),texelSize:new Ds(new wr),scale:new Ds(1),kernel:new Ds(0)},blending:vo,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:DJe,vertexShader:OJe}),this.setTexelSize(i.x,i.y),this.kernelSize=j$.MEDIUM}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.inputBuffer=i}get kernelSequence(){return LJe[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(i){this.uniforms.scale.value=i}getScale(){return this.uniforms.scale.value}setScale(i){this.uniforms.scale.value=i}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(i){this.uniforms.kernel.value=i}setKernel(i){this.kernel=i}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e,i*.5,e*.5)}setSize(i,e){const t=1/i,n=1/e;this.uniforms.texelSize.value.set(t,n,t*.5,n*.5)}},UJe=class extends kh{constructor({kernelSize:i=j$.MEDIUM,resolutionScale:e=.5,width:t=rm.AUTO_SIZE,height:n=rm.AUTO_SIZE,resolutionX:r=t,resolutionY:s=n}={}){super("KawaseBlurPass"),this.renderTargetA=new Ja(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const a=this.resolution=new rm(this,r,s,e);a.addEventListener("change",c=>this.setSize(a.baseWidth,a.baseHeight)),this._blurMaterial=new FJe,this._blurMaterial.kernelSize=i,this.copyMaterial=new V$}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(i){this._blurMaterial=i}get dithering(){return this.copyMaterial.dithering}set dithering(i){this.copyMaterial.dithering=i}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(i){this.blurMaterial.kernelSize=i}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get scale(){return this.blurMaterial.scale}set scale(i){this.blurMaterial.scale=i}getScale(){return this.blurMaterial.scale}setScale(i){this.blurMaterial.scale=i}getKernelSize(){return this.kernelSize}setKernelSize(i){this.kernelSize=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}render(i,e,t,n,r){const s=this.scene,a=this.camera,c=this.renderTargetA,d=this.renderTargetB,p=this.blurMaterial,y=p.kernelSequence;let x=e;this.fullscreenMaterial=p;for(let w=0,C=y.length;w<C;++w){const N=(w&1)===0?c:d;p.kernel=y[w],p.inputBuffer=x.texture,i.setRenderTarget(N),i.render(s,a),x=N}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=x.texture,i.setRenderTarget(this.renderToScreen?null:t),i.render(s,a)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e);const n=t.width,r=t.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==Yi?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):i!==null&&i.outputColorSpace===ti&&(this.renderTargetA.texture.colorSpace=ti,this.renderTargetB.texture.colorSpace=ti))}static get AUTO_SIZE(){return rm.AUTO_SIZE}},BJe=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,zJe=class extends za{constructor(i=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:N4.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ds(null),threshold:new Ds(0),smoothing:new Ds(1),range:new Ds(null)},blending:vo,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:BJe,vertexShader:hxe}),this.colorOutput=i,this.luminanceRange=e}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get threshold(){return this.uniforms.threshold.value}set threshold(i){this.smoothing>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=i}getThreshold(){return this.threshold}setThreshold(i){this.threshold=i}get smoothing(){return this.uniforms.smoothing.value}set smoothing(i){this.threshold>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=i}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(i){this.smoothing=i}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(i){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(i){i?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(i){return this.colorOutput}setColorOutputEnabled(i){this.colorOutput=i}get useRange(){return this.luminanceRange!==null}set useRange(i){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(i){i!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=i,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(i){this.luminanceRange=i}},VJe=class extends kh{constructor({renderTarget:i,luminanceRange:e,colorOutput:t,resolutionScale:n=1,width:r=rm.AUTO_SIZE,height:s=rm.AUTO_SIZE,resolutionX:a=r,resolutionY:c=s}={}){super("LuminancePass"),this.fullscreenMaterial=new zJe(t,e),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Ja(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const d=this.resolution=new rm(this,a,c,n);d.addEventListener("change",p=>this.setSize(d.baseWidth,d.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(i,e,t,n,r){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height)}initialize(i,e,t){t!==void 0&&t!==Yi&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},GJe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,jJe="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",HJe=class extends za{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Ds(null),texelSize:new Ds(new vn)},blending:vo,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:GJe,vertexShader:jJe})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},WJe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,qJe="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",$Je=class extends za{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Ds(null),supportBuffer:new Ds(null),texelSize:new Ds(new vn),radius:new Ds(.85)},blending:vo,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:WJe,vertexShader:qJe})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}set supportBuffer(i){this.uniforms.supportBuffer.value=i}get radius(){return this.uniforms.radius.value}set radius(i){this.uniforms.radius.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},XJe=class extends kh{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Ja(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new HJe,this.upsamplingMaterial=new $Je,this.resolution=new vn}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(i){if(this.levels!==i){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<i;++t){const n=e.clone();n.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(n)}this.upsamplingMipmaps.push(e);for(let t=1,n=i-1;t<n;++t){const r=e.clone();r.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(r)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(i){this.upsamplingMaterial.radius=i}render(i,e,t,n,r){const{scene:s,camera:a}=this,{downsamplingMaterial:c,upsamplingMaterial:d}=this,{downsamplingMipmaps:p,upsamplingMipmaps:y}=this;let x=e;this.fullscreenMaterial=c;for(let w=0,C=p.length;w<C;++w){const N=p[w];c.setSize(x.width,x.height),c.inputBuffer=x.texture,i.setRenderTarget(N),i.render(s,a),x=N}this.fullscreenMaterial=d;for(let w=y.length-1;w>=0;--w){const C=y[w];d.setSize(x.width,x.height),d.inputBuffer=x.texture,d.supportBuffer=p[w].texture,i.setRenderTarget(C),i.render(s,a),x=C}}setSize(i,e){const t=this.resolution;t.set(i,e);let n=t.width,r=t.height;for(let s=0,a=this.downsamplingMipmaps.length;s<a;++s)n=Math.round(n*.5),r=Math.round(r*.5),this.downsamplingMipmaps[s].setSize(n,r),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(n,r)}initialize(i,e,t){if(t!==void 0){const n=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const r of n)r.texture.type=t;if(t!==Yi)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(i!==null&&i.outputColorSpace===ti)for(const r of n)r.texture.colorSpace=ti}}dispose(){super.dispose();for(const i of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))i.dispose()}},YJe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,KJe=class extends G${constructor({blendFunction:i=Fi.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:n=!0,intensity:r=1,radius:s=.85,levels:a=8,kernelSize:c=j$.LARGE,resolutionScale:d=.5,width:p=rm.AUTO_SIZE,height:y=rm.AUTO_SIZE,resolutionX:x=p,resolutionY:w=y}={}){super("BloomEffect",YJe,{blendFunction:i,uniforms:new Map([["map",new Ds(null)],["intensity",new Ds(r)]])}),this.renderTarget=new Ja(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new UJe({kernelSize:c}),this.luminancePass=new VJe({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new XJe,this.mipmapBlurPass.enabled=n,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=a,this.uniforms.get("map").value=n?this.mipmapBlurPass.texture:this.renderTarget.texture;const C=this.resolution=new rm(this,x,w,d);C.addEventListener("change",N=>this.setSize(C.baseWidth,C.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get dithering(){return this.blurPass.dithering}set dithering(i){this.blurPass.dithering=i}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(i){this.blurPass.kernelSize=i}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(i){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(i){this.uniforms.get("intensity").value=i}getIntensity(){return this.intensity}setIntensity(i){this.intensity=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}update(i,e,t){const n=this.renderTarget,r=this.luminancePass;r.enabled?(r.render(i,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,r.renderTarget):this.blurPass.render(i,r.renderTarget,n)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,e):this.blurPass.render(i,e,n)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(i,e),this.mipmapBlurPass.setSize(i,e)}initialize(i,e,t){this.blurPass.initialize(i,e,t),this.luminancePass.initialize(i,e,t),this.mipmapBlurPass.initialize(i,e,t),t!==void 0&&(this.renderTarget.texture.type=t,i!==null&&i.outputColorSpace===ti&&(this.renderTarget.texture.colorSpace=ti))}},ZJe=class extends kh{constructor(i,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=i,this.input=e}setInput(i){this.input=i}render(i,e,t,n,r){const s=this.fullscreenMaterial.uniforms;e!==null&&s!==void 0&&s[this.input]!==void 0&&(s[this.input].value=e.texture),i.setRenderTarget(this.renderToScreen?null:t),i.render(this.scene,this.camera)}initialize(i,e,t){t!==void 0&&t!==Yi&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},QJe=`#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))
#define ONE_OVER_TWELVE 0.08333333333333333
varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;vec4 fxaa(const in vec4 inputColor,const in vec2 uv){float lumaCenter=luminance(inputColor.rgb);float lumaDown=luminance(texture2D(inputBuffer,vUvDown).rgb);float lumaUp=luminance(texture2D(inputBuffer,vUvUp).rgb);float lumaLeft=luminance(texture2D(inputBuffer,vUvLeft).rgb);float lumaRight=luminance(texture2D(inputBuffer,vUvRight).rgb);float lumaMin=min(lumaCenter,min(min(lumaDown,lumaUp),min(lumaLeft,lumaRight)));float lumaMax=max(lumaCenter,max(max(lumaDown,lumaUp),max(lumaLeft,lumaRight)));float lumaRange=lumaMax-lumaMin;if(lumaRange<max(EDGE_THRESHOLD_MIN,lumaMax*EDGE_THRESHOLD_MAX)){return inputColor;}float lumaDownLeft=luminance(texture2D(inputBuffer,vUvDownLeft).rgb);float lumaUpRight=luminance(texture2D(inputBuffer,vUvUpRight).rgb);float lumaUpLeft=luminance(texture2D(inputBuffer,vUvUpLeft).rgb);float lumaDownRight=luminance(texture2D(inputBuffer,vUvDownRight).rgb);float lumaDownUp=lumaDown+lumaUp;float lumaLeftRight=lumaLeft+lumaRight;float lumaLeftCorners=lumaDownLeft+lumaUpLeft;float lumaDownCorners=lumaDownLeft+lumaDownRight;float lumaRightCorners=lumaDownRight+lumaUpRight;float lumaUpCorners=lumaUpRight+lumaUpLeft;float edgeHorizontal=(abs(-2.0*lumaLeft+lumaLeftCorners)+abs(-2.0*lumaCenter+lumaDownUp)*2.0+abs(-2.0*lumaRight+lumaRightCorners));float edgeVertical=(abs(-2.0*lumaUp+lumaUpCorners)+abs(-2.0*lumaCenter+lumaLeftRight)*2.0+abs(-2.0*lumaDown+lumaDownCorners));bool isHorizontal=(edgeHorizontal>=edgeVertical);float stepLength=isHorizontal?texelSize.y:texelSize.x;float luma1=isHorizontal?lumaDown:lumaLeft;float luma2=isHorizontal?lumaUp:lumaRight;float gradient1=abs(luma1-lumaCenter);float gradient2=abs(luma2-lumaCenter);bool is1Steepest=gradient1>=gradient2;float gradientScaled=0.25*max(gradient1,gradient2);float lumaLocalAverage=0.0;if(is1Steepest){stepLength=-stepLength;lumaLocalAverage=0.5*(luma1+lumaCenter);}else{lumaLocalAverage=0.5*(luma2+lumaCenter);}vec2 currentUv=uv;if(isHorizontal){currentUv.y+=stepLength*0.5;}else{currentUv.x+=stepLength*0.5;}vec2 offset=isHorizontal?vec2(texelSize.x,0.0):vec2(0.0,texelSize.y);vec2 uv1=currentUv-offset*QUALITY(0);vec2 uv2=currentUv+offset*QUALITY(0);float lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);float lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd1-=lumaLocalAverage;lumaEnd2-=lumaLocalAverage;bool reached1=abs(lumaEnd1)>=gradientScaled;bool reached2=abs(lumaEnd2)>=gradientScaled;bool reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(1);}if(!reached2){uv2+=offset*QUALITY(1);}if(!reachedBoth){for(int i=2;i<SAMPLES;++i){if(!reached1){lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);lumaEnd1=lumaEnd1-lumaLocalAverage;}if(!reached2){lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd2=lumaEnd2-lumaLocalAverage;}reached1=abs(lumaEnd1)>=gradientScaled;reached2=abs(lumaEnd2)>=gradientScaled;reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(i);}if(!reached2){uv2+=offset*QUALITY(i);}if(reachedBoth){break;}}}float distance1=isHorizontal?(uv.x-uv1.x):(uv.y-uv1.y);float distance2=isHorizontal?(uv2.x-uv.x):(uv2.y-uv.y);bool isDirection1=distance1<distance2;float distanceFinal=min(distance1,distance2);float edgeThickness=(distance1+distance2);bool isLumaCenterSmaller=lumaCenter<lumaLocalAverage;bool correctVariation1=(lumaEnd1<0.0)!=isLumaCenterSmaller;bool correctVariation2=(lumaEnd2<0.0)!=isLumaCenterSmaller;bool correctVariation=isDirection1?correctVariation1:correctVariation2;float pixelOffset=-distanceFinal/edgeThickness+0.5;float finalOffset=correctVariation?pixelOffset:0.0;float lumaAverage=ONE_OVER_TWELVE*(2.0*(lumaDownUp+lumaLeftRight)+lumaLeftCorners+lumaRightCorners);float subPixelOffset1=clamp(abs(lumaAverage-lumaCenter)/lumaRange,0.0,1.0);float subPixelOffset2=(-2.0*subPixelOffset1+3.0)*subPixelOffset1*subPixelOffset1;float subPixelOffsetFinal=subPixelOffset2*subPixelOffset2*SUBPIXEL_QUALITY;finalOffset=max(finalOffset,subPixelOffsetFinal);vec2 finalUv=uv;if(isHorizontal){finalUv.y+=finalOffset*stepLength;}else{finalUv.x+=finalOffset*stepLength;}return texture2D(inputBuffer,finalUv);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=fxaa(inputColor,uv);}`,JJe="varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;void mainSupport(const in vec2 uv){vUvDown=uv+vec2(0.0,-1.0)*texelSize;vUvUp=uv+vec2(0.0,1.0)*texelSize;vUvRight=uv+vec2(1.0,0.0)*texelSize;vUvLeft=uv+vec2(-1.0,0.0)*texelSize;vUvDownLeft=uv+vec2(-1.0,-1.0)*texelSize;vUvUpRight=uv+vec2(1.0,1.0)*texelSize;vUvUpLeft=uv+vec2(-1.0,1.0)*texelSize;vUvDownRight=uv+vec2(1.0,-1.0)*texelSize;}",eet=class extends G${constructor({blendFunction:i=Fi.SRC}={}){super("FXAAEffect",QJe,{vertexShader:JJe,blendFunction:i,defines:new Map([["EDGE_THRESHOLD_MIN","0.0312"],["EDGE_THRESHOLD_MAX","0.125"],["SUBPIXEL_QUALITY","0.75"],["SAMPLES","12"]])})}get minEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MIN"))}set minEdgeThreshold(i){this.defines.set("EDGE_THRESHOLD_MIN",i.toFixed(12)),this.setChanged()}get maxEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MAX"))}set maxEdgeThreshold(i){this.defines.set("EDGE_THRESHOLD_MAX",i.toFixed(12)),this.setChanged()}get subpixelQuality(){return Number(this.defines.get("SUBPIXEL_QUALITY"))}set subpixelQuality(i){this.defines.set("SUBPIXEL_QUALITY",i.toFixed(12)),this.setChanged()}get samples(){return Number(this.defines.get("SAMPLES"))}set samples(i){this.defines.set("SAMPLES",i.toFixed(0)),this.setChanged()}},tet=class extends kh{constructor(i,e,t=null){super("RenderPass",i,e),this.needsSwap=!1,this.clearPass=new fxe,this.overrideMaterialManager=t===null?null:new bve(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get renderToScreen(){return super.renderToScreen}set renderToScreen(i){super.renderToScreen=i,this.clearPass.renderToScreen=i}get overrideMaterial(){const i=this.overrideMaterialManager;return i!==null?i.material:null}set overrideMaterial(i){const e=this.overrideMaterialManager;i!==null?e!==null?e.setMaterial(i):this.overrideMaterialManager=new bve(i):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(i){this.overrideMaterial=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getSelection(){return this.selection}setSelection(i){this.selection=i}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(i){this.ignoreBackground=i}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(i){this.skipShadowMapUpdate=i}getClearPass(){return this.clearPass}render(i,e,t,n,r){const s=this.scene,a=this.camera,c=this.selection,d=a.layers.mask,p=s.background,y=i.shadowMap.autoUpdate,x=this.renderToScreen?null:e;c!==null&&a.layers.set(c.getLayer()),this.skipShadowMapUpdate&&(i.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(i,e),i.setRenderTarget(x),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(i,s,a):i.render(s,a),a.layers.mask=d,s.background=p,i.shadowMap.autoUpdate=y}},AT={DEFAULT:0,ESKIL:1},net=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,ret=class extends G${constructor({blendFunction:i,eskil:e=!1,technique:t=e?AT.ESKIL:AT.DEFAULT,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",net,{blendFunction:i,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Ds(n)],["darkness",new Ds(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(i){this.technique!==i&&(this.defines.set("VIGNETTE_TECHNIQUE",i.toFixed(0)),this.setChanged())}get eskil(){return this.technique===AT.ESKIL}set eskil(i){this.technique=i?AT.ESKIL:AT.DEFAULT}getTechnique(){return this.technique}setTechnique(i){this.technique=i}get offset(){return this.uniforms.get("offset").value}set offset(i){this.uniforms.get("offset").value=i}getOffset(){return this.offset}setOffset(i){this.offset=i}get darkness(){return this.uniforms.get("darkness").value}set darkness(i){this.uniforms.get("darkness").value=i}getDarkness(){return this.darkness}setDarkness(i){this.darkness=i}},iet=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,set="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",oet=class extends za{constructor(i,e,t,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:N4.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ds(null),depthBuffer:new Ds(null),resolution:new Ds(new vn),texelSize:new Ds(new vn),cameraNear:new Ds(.3),cameraFar:new Ds(1e3),aspect:new Ds(1),time:new Ds(0)},blending:vo,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),i&&this.setShaderParts(i),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(i){this.uniforms.depthBuffer.value=i}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=FE){this.depthBuffer=i,this.depthPacking=e}setShaderData(i){this.setShaderParts(i.shaderParts),this.setDefines(i.defines),this.setUniforms(i.uniforms),this.setExtensions(i.extensions)}setShaderParts(i){return this.fragmentShader=iet.replace(cs.FRAGMENT_HEAD,i.get(cs.FRAGMENT_HEAD)||"").replace(cs.FRAGMENT_MAIN_UV,i.get(cs.FRAGMENT_MAIN_UV)||"").replace(cs.FRAGMENT_MAIN_IMAGE,i.get(cs.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=set.replace(cs.VERTEX_HEAD,i.get(cs.VERTEX_HEAD)||"").replace(cs.VERTEX_MAIN_SUPPORT,i.get(cs.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(i){for(const e of i.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(i){for(const e of i.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(i){this.extensions={};for(const e of i)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(i){this.encodeOutput!==i&&(i?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(i){return this.encodeOutput}setOutputEncodingEnabled(i){this.encodeOutput=i}get time(){return this.uniforms.time.value}set time(i){this.uniforms.time.value=i}setDeltaTime(i){this.uniforms.time.value+=i}adoptCameraSettings(i){this.copyCameraSettings(i)}copyCameraSettings(i){i&&(this.uniforms.cameraNear.value=i.near,this.uniforms.cameraFar.value=i.far,i instanceof ca?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(i,e){const t=this.uniforms;t.resolution.value.set(i,e),t.texelSize.value.set(1/i,1/e),t.aspect.value=i/e}static get Section(){return cs}};function Sve(i,e,t){for(const n of e){const r="$1"+i+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(s,r))}}function aet(i,e,t){let n=e.getFragmentShader(),r=e.getVertexShader();const s=n!==void 0&&/mainImage/.test(n),a=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&(t.attributes&r6.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const c=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,d=t.shaderParts;let p=d.get(cs.FRAGMENT_HEAD)||"",y=d.get(cs.FRAGMENT_MAIN_UV)||"",x=d.get(cs.FRAGMENT_MAIN_IMAGE)||"",w=d.get(cs.VERTEX_HEAD)||"",C=d.get(cs.VERTEX_MAIN_SUPPORT)||"";const N=new Set,F=new Set;if(a&&(y+=`	${i}MainUv(UV);
`,t.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const B=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);C+=`	${i}MainSupport(`,C+=B?`vUv);
`:`);
`;for(const Y of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const A of Y[1].split(/\s*,\s*/))t.varyings.add(A),N.add(A),F.add(A);for(const Y of r.matchAll(c))F.add(Y[1])}for(const B of n.matchAll(c))F.add(B[1]);for(const B of e.defines.keys())F.add(B.replace(/\([\w\s,]*\)/g,""));for(const B of e.uniforms.keys())F.add(B);F.delete("while"),F.delete("for"),F.delete("if"),e.uniforms.forEach((B,Y)=>t.uniforms.set(i+Y.charAt(0).toUpperCase()+Y.slice(1),B)),e.defines.forEach((B,Y)=>t.defines.set(i+Y.charAt(0).toUpperCase()+Y.slice(1),B));const U=new Map([["fragment",n],["vertex",r]]);Sve(i,F,t.defines),Sve(i,F,U),n=U.get("fragment"),r=U.get("vertex");const R=e.blendMode;if(t.blendModes.set(R.blendFunction,R),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(x+=e.inputColorSpace===ti?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==il?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const B=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;x+=`${i}MainImage(color0, UV, `,(t.attributes&r6.DEPTH)!==0&&B.test(n)&&(x+="depth, ",t.readDepth=!0),x+=`color1);
	`;const Y=i+"BlendOpacity";t.uniforms.set(Y,R.opacity),x+=`color0 = blend${R.blendFunction}(color0, color1, ${Y});

	`,p+=`uniform float ${Y};

`}if(p+=n+`
`,r!==null&&(w+=r+`
`),d.set(cs.FRAGMENT_HEAD,p),d.set(cs.FRAGMENT_MAIN_UV,y),d.set(cs.FRAGMENT_MAIN_IMAGE,x),d.set(cs.VERTEX_HEAD,w),d.set(cs.VERTEX_MAIN_SUPPORT,C),e.extensions!==null)for(const B of e.extensions)t.extensions.add(B)}}var cet=class extends kh{constructor(i,...e){super("EffectPass"),this.fullscreenMaterial=new oet(null,null,null,i),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(i){for(const e of this.effects)e.mainScene=i}set mainCamera(i){this.fullscreenMaterial.copyCameraSettings(i);for(const e of this.effects)e.mainCamera=i}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(i){this.fullscreenMaterial.encodeOutput=i}get dithering(){return this.fullscreenMaterial.dithering}set dithering(i){const e=this.fullscreenMaterial;e.dithering=i,e.needsUpdate=!0}setEffects(i){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=i.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const i=new JQe;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===Fi.DST)i.attributes|=a.getAttributes()&r6.DEPTH;else{if((i.attributes&a.getAttributes()&r6.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${a.name})`);aet("e"+e++,a,i)}let t=i.shaderParts.get(cs.FRAGMENT_HEAD),n=i.shaderParts.get(cs.FRAGMENT_MAIN_IMAGE),r=i.shaderParts.get(cs.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const a of i.blendModes.values())t+=a.getShaderCode().replace(s,`blend${a.blendFunction}`)+`
`;(i.attributes&r6.DEPTH)!==0?(i.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,i.colorSpace===ti&&(n+=`color0 = sRGBToLinear(color0);
	`),i.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,i.defines.set("UV","transformedUv")):i.defines.set("UV","vUv"),i.shaderParts.set(cs.FRAGMENT_HEAD,t),i.shaderParts.set(cs.FRAGMENT_MAIN_IMAGE,n),i.shaderParts.set(cs.FRAGMENT_MAIN_UV,r);for(const[a,c]of i.shaderParts)c!==null&&i.shaderParts.set(a,c.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(i)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(i,e=FE){this.fullscreenMaterial.depthBuffer=i,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(i,e)}render(i,e,t,n,r){for(const s of this.effects)s.update(i,e,n);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=n*this.timeScale,i.setRenderTarget(this.renderToScreen?null:t),i.render(this.scene,this.camera)}}setSize(i,e){this.fullscreenMaterial.setSize(i,e);for(const t of this.effects)t.setSize(i,e)}initialize(i,e,t){this.renderer=i;for(const n of this.effects)n.initialize(i,e,t);this.updateMaterial(),t!==void 0&&t!==Yi&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const i of this.effects)i.removeEventListener("change",this.listener),i.dispose()}handleEvent(i){switch(i.type){case"change":this.recompile();break}}};const uet=`varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,det=`struct Light {
  float intensity;
  vec3 position;
  vec3 color;
};

uniform float time;
uniform float opacity;
uniform vec2 resolution;
uniform vec3 diffuse;
uniform vec3 mouse;
uniform sampler2D map;
uniform Light light;
uniform Light lights[3];
varying vec2 vUv;

#define MIN_ALPHA 2.0 / 255.0

void main() {
  if (opacity < MIN_ALPHA) discard;
  vec2 imageUV = vUv * 10.0;
  vec3 image = texture2D(map, imageUV).rgb;
  vec3 col = image * diffuse;
  col += (sin(time * 0.1) * 0.5 + 0.5) * 0.2;
  col += vec3(resolution, 0.0);
  col += mouse;
  gl_FragColor = vec4(col, opacity);
}`,het="data:image/png;base64,R0lGODlhCAAIAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OTc3NywgMjAyMy8wNi8yNS0yMzo1NzoxNCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjVENjQyODM4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjVENjQyODQ4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2NUQ2NDI4MThBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2NUQ2NDI4MjhBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAAAAAAALAAAAAAIAAgAAAIOjH8AprzRkHyspqSoNAUAOw==";class pxe extends za{constructor(){super({vertexShader:uet,fragmentShader:det,name:"ExampleScene/SimpleShader",transparent:!0,uniforms:{diffuse:{value:new xn(16777215)},opacity:{value:1},time:{value:0},map:{value:null},resolution:{value:new vn},mouse:{value:new _e},v4:{value:new wr},euler:{value:new Ao},testM3:{value:new Xr},testM4:{value:new An},light:{value:{position:new vn(5,10),intensity:1,color:new xn(16711935)}},lights:{value:[{position:new vn(1,1),intensity:1,color:new xn(16711680)},{position:new vn(2,2),intensity:2,color:new xn(65280)},{position:new vn(3,3),intensity:3,color:new xn(255)}]}}}),oq(het).then(e=>{this.uniforms.map.value=e})}update(e){this.uniforms.opacity.value=this.opacity,this.uniforms.time.value+=e}}function fet(i){const e=new Map,t=new Map,n=i.clone();return mxe(i,n,function(r,s){e.set(s,r),t.set(r,s)}),n.traverse(function(r){if(!r.isSkinnedMesh)return;const s=r,a=e.get(r),c=a.skeleton.bones;s.skeleton=a.skeleton.clone(),s.bindMatrix.copy(a.bindMatrix),s.skeleton.bones=c.map(function(d){return t.get(d)}),s.bind(s.skeleton,s.bindMatrix)}),n}function mxe(i,e,t){t(i,e);for(let n=0;n<i.children.length;n++)mxe(i.children[n],e.children[n],t)}/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var bh=Uint8Array,$_=Uint16Array,pet=Int32Array,gxe=new bh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vxe=new bh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),met=new bh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yxe=function(i,e){for(var t=new $_(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new pet(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return{b:t,r}},_xe=yxe(gxe,2),xxe=_xe.b,get=_xe.r;xxe[28]=258,get[258]=28;var vet=yxe(vxe,0),yet=vet.b,_W=new $_(32768);for(var go=0;go<32768;++go){var t4=(go&43690)>>1|(go&21845)<<1;t4=(t4&52428)>>2|(t4&13107)<<2,t4=(t4&61680)>>4|(t4&3855)<<4,_W[go]=((t4&65280)>>8|(t4&255)<<8)>>1}var QT=function(i,e,t){for(var n=i.length,r=0,s=new $_(e);r<n;++r)i[r]&&++s[i[r]-1];var a=new $_(e);for(r=1;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var c;if(t){c=new $_(1<<e);var d=15-e;for(r=0;r<n;++r)if(i[r])for(var p=r<<4|i[r],y=e-i[r],x=a[i[r]-1]++<<y,w=x|(1<<y)-1;x<=w;++x)c[_W[x]>>d]=p}else for(c=new $_(n),r=0;r<n;++r)i[r]&&(c[r]=_W[a[i[r]-1]++]>>15-i[r]);return c},ZE=new bh(288);for(var go=0;go<144;++go)ZE[go]=8;for(var go=144;go<256;++go)ZE[go]=9;for(var go=256;go<280;++go)ZE[go]=7;for(var go=280;go<288;++go)ZE[go]=8;var bxe=new bh(32);for(var go=0;go<32;++go)bxe[go]=5;var _et=QT(ZE,9,1),xet=QT(bxe,5,1),yH=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Hf=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},_H=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},bet=function(i){return(i+7)/8|0},wet=function(i,e,t){return(t==null||t>i.length)&&(t=i.length),new bh(i.subarray(e,t))},Tet=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$f=function(i,e,t){var n=new Error(e||Tet[i]);if(n.code=i,Error.captureStackTrace&&Error.captureStackTrace(n,$f),!t)throw n;return n},Eet=function(i,e,t,n){var r=i.length,s=0;if(!r||e.f&&!e.l)return t||new bh(0);var a=!t,c=a||e.i!=2,d=e.i;a&&(t=new bh(r*3));var p=function(fr){var ds=t.length;if(fr>ds){var Wr=new bh(Math.max(ds*2,fr));Wr.set(t),t=Wr}},y=e.f||0,x=e.p||0,w=e.b||0,C=e.l,N=e.d,F=e.m,U=e.n,R=r*8;do{if(!C){y=Hf(i,x,1);var B=Hf(i,x+1,3);if(x+=3,B)if(B==1)C=_et,N=xet,F=9,U=5;else if(B==2){var se=Hf(i,x,31)+257,oe=Hf(i,x+10,15)+4,G=se+Hf(i,x+5,31)+1;x+=14;for(var ie=new bh(G),Me=new bh(19),X=0;X<oe;++X)Me[met[X]]=Hf(i,x+X*3,7);x+=oe*3;for(var De=yH(Me),$e=(1<<De)-1,ot=QT(Me,De,1),X=0;X<G;){var He=ot[Hf(i,x,$e)];x+=He&15;var Y=He>>4;if(Y<16)ie[X++]=Y;else{var ce=0,Ge=0;for(Y==16?(Ge=3+Hf(i,x,3),x+=2,ce=ie[X-1]):Y==17?(Ge=3+Hf(i,x,7),x+=3):Y==18&&(Ge=11+Hf(i,x,127),x+=7);Ge--;)ie[X++]=ce}}var Ie=ie.subarray(0,se),st=ie.subarray(se);F=yH(Ie),U=yH(st),C=QT(Ie,F,1),N=QT(st,U,1)}else $f(1);else{var Y=bet(x)+4,A=i[Y-4]|i[Y-3]<<8,ne=Y+A;if(ne>r){d&&$f(0);break}c&&p(w+A),t.set(i.subarray(Y,ne),w),e.b=w+=A,e.p=x=ne*8,e.f=y;continue}if(x>R){d&&$f(0);break}}c&&p(w+131072);for(var bt=(1<<F)-1,Ne=(1<<U)-1,ht=x;;ht=x){var ce=C[_H(i,x)&bt],Ot=ce>>4;if(x+=ce&15,x>R){d&&$f(0);break}if(ce||$f(2),Ot<256)t[w++]=Ot;else if(Ot==256){ht=x,C=null;break}else{var wn=Ot-254;if(Ot>264){var X=Ot-257,bn=gxe[X];wn=Hf(i,x,(1<<bn)-1)+xxe[X],x+=bn}var Tt=N[_H(i,x)&Ne],Gt=Tt>>4;Tt||$f(3),x+=Tt&15;var st=yet[Gt];if(Gt>3){var bn=vxe[Gt];st+=_H(i,x)&(1<<bn)-1,x+=bn}if(x>R){d&&$f(0);break}c&&p(w+131072);var $t=w+wn;if(w<st){var Ln=s-st,jn=Math.min(st,$t);for(Ln+w<0&&$f(3);w<jn;++w)t[w]=n[Ln+w]}for(;w<$t;++w)t[w]=t[w-st]}}e.l=C,e.p=ht,e.b=w,e.f=y,C&&(y=1,e.m=F,e.d=N,e.n=U)}while(!y);return w!=t.length&&a?wet(t,0,w):t.subarray(0,w)},Met=new bh(0),Cet=function(i,e){return((i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31)&&$f(6,"invalid zlib data"),(i[1]>>5&1)==1&&$f(6,"invalid zlib data: "+(i[1]&32?"need":"unexpected")+" dictionary"),(i[1]>>3&4)+2};function Aet(i,e){return Eet(i.subarray(Cet(i),-4),{i:2},e,e)}var Pet=typeof TextDecoder<"u"&&new TextDecoder,Ret=0;try{Pet.decode(Met,{stream:!0}),Ret=1}catch{}function Sxe(i,e,t){const n=t.length-i-1;if(e>=t[n])return n-1;if(e<=t[i])return i;let r=i,s=n,a=Math.floor((r+s)/2);for(;e<t[a]||e>=t[a+1];)e<t[a]?s=a:r=a,a=Math.floor((r+s)/2);return a}function Iet(i,e,t,n){const r=[],s=[],a=[];r[0]=1;for(let c=1;c<=t;++c){s[c]=e-n[i+1-c],a[c]=n[i+c]-e;let d=0;for(let p=0;p<c;++p){const y=a[p+1],x=s[c-p],w=r[p]/(y+x);r[p]=d+y*w,d=x*w}r[c]=d}return r}function Net(i,e,t,n){const r=Sxe(i,n,e),s=Iet(r,n,i,e),a=new wr(0,0,0,0);for(let c=0;c<=i;++c){const d=t[r-i+c],p=s[c],y=d.w*p;a.x+=d.x*y,a.y+=d.y*y,a.z+=d.z*y,a.w+=d.w*p}return a}function ket(i,e,t,n,r){const s=[];for(let x=0;x<=t;++x)s[x]=0;const a=[];for(let x=0;x<=n;++x)a[x]=s.slice(0);const c=[];for(let x=0;x<=t;++x)c[x]=s.slice(0);c[0][0]=1;const d=s.slice(0),p=s.slice(0);for(let x=1;x<=t;++x){d[x]=e-r[i+1-x],p[x]=r[i+x]-e;let w=0;for(let C=0;C<x;++C){const N=p[C+1],F=d[x-C];c[x][C]=N+F;const U=c[C][x-1]/c[x][C];c[C][x]=w+N*U,w=F*U}c[x][x]=w}for(let x=0;x<=t;++x)a[0][x]=c[x][t];for(let x=0;x<=t;++x){let w=0,C=1;const N=[];for(let F=0;F<=t;++F)N[F]=s.slice(0);N[0][0]=1;for(let F=1;F<=n;++F){let U=0;const R=x-F,B=t-F;x>=F&&(N[C][0]=N[w][0]/c[B+1][R],U=N[C][0]*c[R][B]);const Y=R>=-1?1:-R,A=x-1<=B?F-1:t-x;for(let se=Y;se<=A;++se)N[C][se]=(N[w][se]-N[w][se-1])/c[B+1][R+se],U+=N[C][se]*c[R+se][B];x<=B&&(N[C][F]=-N[w][F-1]/c[B+1][x],U+=N[C][F]*c[x][B]),a[F][x]=U;const ne=w;w=C,C=ne}}let y=t;for(let x=1;x<=n;++x){for(let w=0;w<=t;++w)a[x][w]*=y;y*=t-x}return a}function Det(i,e,t,n,r){const s=r<i?r:i,a=[],c=Sxe(i,n,e),d=ket(c,n,i,s,e),p=[];for(let y=0;y<t.length;++y){const x=t[y].clone(),w=x.w;x.x*=w,x.y*=w,x.z*=w,p[y]=x}for(let y=0;y<=s;++y){const x=p[c-i].clone().multiplyScalar(d[y][0]);for(let w=1;w<=i;++w)x.add(p[c-i+w].clone().multiplyScalar(d[y][w]));a[y]=x}for(let y=s+1;y<=r+1;++y)a[y]=new wr(0,0,0);return a}function Oet(i,e){let t=1;for(let r=2;r<=i;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=i-e;++r)n*=r;return t/n}function Let(i){const e=i.length,t=[],n=[];for(let s=0;s<e;++s){const a=i[s];t[s]=new _e(a.x,a.y,a.z),n[s]=a.w}const r=[];for(let s=0;s<e;++s){const a=t[s].clone();for(let c=1;c<=s;++c)a.sub(r[s-c].clone().multiplyScalar(Oet(s,c)*n[c]));r[s]=a.divideScalar(n[0])}return r}function Fet(i,e,t,n,r){const s=Det(i,e,t,n,r);return Let(s)}class Uet extends Wve{constructor(e,t,n,r,s){super();const a=t?t.length-1:0,c=n?n.length:0;this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||a;for(let d=0;d<c;++d){const p=n[d];this.controlPoints[d]=new wr(p.x,p.y,p.z,p.w)}}getPoint(e,t=new _e){const n=t,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=Net(this.degree,this.knots,this.controlPoints,r);return s.w!==1&&s.divideScalar(s.w),n.set(s.x,s.y,s.z)}getTangent(e,t=new _e){const n=t,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),s=Fet(this.degree,this.knots,this.controlPoints,r,1);return n.copy(s[1]).normalize(),n}toJSON(){const e=super.toJSON();return e.degree=this.degree,e.knots=[...this.knots],e.controlPoints=this.controlPoints.map(t=>t.toArray()),e.startKnot=this.startKnot,e.endKnot=this.endKnot,e}fromJSON(e){return super.fromJSON(e),this.degree=e.degree,this.knots=[...e.knots],this.controlPoints=e.controlPoints.map(t=>new wr(t[0],t[1],t[2],t[3])),this.startKnot=e.startKnot,this.endKnot=e.endKnot,this}}let Ti,Ta,Ic;class Bet extends A4{constructor(e){super(e)}load(e,t,n,r){const s=this,a=s.path===""?sDe.extractUrlBase(e):s.path,c=new Qke(this.manager);c.setPath(s.path),c.setResponseType("arraybuffer"),c.setRequestHeader(s.requestHeader),c.setWithCredentials(s.withCredentials),c.load(e,function(d){try{t(s.parse(d,a))}catch(p){r?r(p):console.error(p),s.manager.itemError(e)}},n,r)}parse(e,t){if(Wet(e))Ti=new Het().parse(e);else{const r=Exe(e);if(!qet(r))throw new Error("THREE.FBXLoader: Unknown format.");if(Tve(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Tve(r));Ti=new jet().parse(r)}const n=new i8e(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new zet(n,this.manager).parse(Ti)}}class zet{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Ta=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),s=new Vet().parse(r);return this.parseScene(r,s,n),Ic}parseConnections(){const e=new Map;return"Connections"in Ti&&Ti.Connections.connections.forEach(function(n){const r=n[0],s=n[1],a=n[2];e.has(r)||e.set(r,{parents:[],children:[]});const c={ID:s,relationship:a};e.get(r).parents.push(c),e.has(s)||e.set(s,{parents:[],children:[]});const d={ID:r,relationship:a};e.get(s).children.push(d)}),e}parseImages(){const e={},t={};if("Video"in Ti.Objects){const n=Ti.Objects.Video;for(const r in n){const s=n[r],a=parseInt(r);if(e[a]=s.RelativeFilename||s.Filename,"Content"in s){const c=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,d=typeof s.Content=="string"&&s.Content!=="";if(c||d){const p=this.parseImage(n[r]);t[s.RelativeFilename||s.Filename]=p}}}}for(const n in e){const r=e[n];t[r]!==void 0?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),s="image/tga";break;case"webp":s="image/webp";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof t=="string")return"data:"+s+";base64,"+t;{const a=new Uint8Array(t);return window.URL.createObjectURL(new Blob([a],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in Ti.Objects){const n=Ti.Objects.Texture;for(const r in n){const s=this.parseTexture(n[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,a=r!==void 0?r.value:0,c=s!==void 0?s.value:0;if(n.wrapS=a===0?bd:Co,n.wrapT=c===0?bd:Co,"Scaling"in e){const d=e.Scaling.value;n.repeat.x=d[0],n.repeat.y=d[1]}if("Translation"in e){const d=e.Translation.value;n.offset.x=d[0],n.offset.y=d[1]}return n}loadTexture(e,t){const n=e.FileName.split(".").pop().toLowerCase();let r=this.manager.getHandler(`.${n}`);r===null&&(r=this.textureLoader);const s=r.path;s||r.setPath(this.textureLoader.path);const a=Ta.get(e.id).children;let c;if(a!==void 0&&a.length>0&&t[a[0].ID]!==void 0&&(c=t[a[0].ID],(c.indexOf("blob:")===0||c.indexOf("data:")===0)&&r.setPath(void 0)),c===void 0)return console.warn("FBXLoader: Undefined filename, creating placeholder texture."),new ro;const d=r.load(c);return r.setPath(s),d}parseMaterials(e){const t=new Map;if("Material"in Ti.Objects){const n=Ti.Objects.Material;for(const r in n){const s=this.parseMaterial(n[r],e);s!==null&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let s=e.ShadingModel;if(typeof s=="object"&&(s=s.value),!Ta.has(n))return null;const a=this.parseParameters(e,t,n);let c;switch(s.toLowerCase()){case"phong":c=new q8;break;case"lambert":c=new Qve;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),c=new q8;break}return c.setValues(a),c.name=r,c}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=Xn.colorSpaceToWorking(new xn().fromArray(e.Diffuse.value),ti):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=Xn.colorSpaceToWorking(new xn().fromArray(e.DiffuseColor.value),ti)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=Xn.colorSpaceToWorking(new xn().fromArray(e.Emissive.value),ti):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=Xn.colorSpaceToWorking(new xn().fromArray(e.EmissiveColor.value),ti)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),r.opacity=1-(e.TransparencyFactor?parseFloat(e.TransparencyFactor.value):0),(r.opacity===1||r.opacity===0)&&(r.opacity=e.Opacity?parseFloat(e.Opacity.value):null,r.opacity===null&&(r.opacity=1-(e.TransparentColor?parseFloat(e.TransparentColor.value[0]):0))),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=Xn.colorSpaceToWorking(new xn().fromArray(e.Specular.value),ti):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=Xn.colorSpaceToWorking(new xn().fromArray(e.SpecularColor.value),ti));const s=this;return Ta.get(n).children.forEach(function(a){const c=a.relationship;switch(c){case"Bump":r.bumpMap=s.getTexture(t,a.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,a.ID),r.map!==void 0&&(r.map.colorSpace=ti);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,a.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,a.ID),r.emissiveMap!==void 0&&(r.emissiveMap.colorSpace=ti);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,a.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,a.ID),r.envMap!==void 0&&(r.envMap.mapping=K8,r.envMap.colorSpace=ti);break;case"SpecularColor":r.specularMap=s.getTexture(t,a.ID),r.specularMap!==void 0&&(r.specularMap.colorSpace=ti);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,a.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",c);break}}),r}getTexture(e,t){return"LayeredTexture"in Ti.Objects&&t in Ti.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Ta.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Ti.Objects){const n=Ti.Objects.Deformer;for(const r in n){const s=n[r],a=Ta.get(parseInt(r));if(s.attrType==="Skin"){const c=this.parseSkeleton(a,n);c.ID=r,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=a.parents[0].ID,e[r]=c}else if(s.attrType==="BlendShape"){const c={id:r};c.rawTargets=this.parseMorphTargets(a,n),c.id=r,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=c}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(r){const s=t[r.ID];if(s.attrType!=="Cluster")return;const a={ID:r.ID,indices:[],weights:[],transformLink:new An().fromArray(s.TransformLink.a)};"Indexes"in s&&(a.indices=s.Indexes.a,a.weights=s.Weights.a),n.push(a)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],a=t[s.ID],c={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;c.geoID=Ta.get(parseInt(s.ID)).children.filter(function(d){return d.relationship===void 0})[0].ID,n.push(c)}return n}parseScene(e,t,n){Ic=new H8;const r=this.parseModels(e.skeletons,t,n),s=Ti.Objects.Model,a=this;r.forEach(function(d){const p=s[d.ID];a.setLookAtProperties(d,p),Ta.get(d.ID).parents.forEach(function(x){const w=r.get(x.ID);w!==void 0&&w.add(d)}),d.parent===null&&Ic.add(d)}),this.bindSkeleton(e.skeletons,t,r),this.addGlobalSceneSettings(),Ic.traverse(function(d){if(d.userData.transformData){d.parent&&(d.userData.transformData.parentMatrix=d.parent.matrix,d.userData.transformData.parentMatrixWorld=d.parent.matrixWorld);const p=Txe(d.userData.transformData);d.applyMatrix4(p),d.updateWorldMatrix()}});const c=new Get().parse();Ic.children.length===1&&Ic.children[0].isGroup&&(Ic.children[0].animations=c,Ic=Ic.children[0]),Ic.animations=c}parseModels(e,t,n){const r=new Map,s=Ti.Objects.Model;for(const a in s){const c=parseInt(a),d=s[a],p=Ta.get(c);let y=this.buildSkeleton(p,e,c,d.attrName);if(!y){switch(d.attrType){case"Camera":y=this.createCamera(p);break;case"Light":y=this.createLight(p);break;case"Mesh":y=this.createMesh(p,t,n);break;case"NurbsCurve":y=this.createCurve(p,t);break;case"LimbNode":case"Root":y=new RH;break;case"Null":default:y=new H8;break}y.name=d.attrName?ts.sanitizeNodeName(d.attrName):"",y.userData.originalName=d.attrName,y.ID=c}this.getTransformData(y,d),r.set(c,y)}return r}buildSkeleton(e,t,n,r){let s=null;return e.parents.forEach(function(a){for(const c in t){const d=t[c];d.rawBones.forEach(function(p,y){if(p.ID===a.ID){const x=s;s=new RH,s.matrixWorld.copy(p.transformLink),s.name=r?ts.sanitizeNodeName(r):"",s.userData.originalName=r,s.ID=n,d.bones[y]=s,x!==null&&s.add(x)}})}}),s}createCamera(e){let t,n;if(e.children.forEach(function(r){const s=Ti.Objects.NodeAttribute[r.ID];s!==void 0&&(n=s)}),n===void 0)t=new hi;else{let r=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(r=1);let s=1;n.NearPlane!==void 0&&(s=n.NearPlane.value/1e3);let a=1e3;n.FarPlane!==void 0&&(a=n.FarPlane.value/1e3);let c=window.innerWidth,d=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(c=n.AspectWidth.value,d=n.AspectHeight.value);const p=c/d;let y=45;n.FieldOfView!==void 0&&(y=n.FieldOfView.value);const x=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new ca(y,p,s,a),x!==null&&t.setFocalLength(x);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),t=new hi;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new hi;break}}return t}createLight(e){let t,n;if(e.children.forEach(function(r){const s=Ti.Objects.NodeAttribute[r.ID];s!==void 0&&(n=s)}),n===void 0)t=new hi;else{let r;n.LightType===void 0?r=0:r=n.LightType.value;let s=16777215;n.Color!==void 0&&(s=Xn.colorSpaceToWorking(new xn().fromArray(n.Color.value),ti));let a=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(a=0);let c=0;n.FarAttenuationEnd!==void 0&&(n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?c=0:c=n.FarAttenuationEnd.value);const d=1;switch(r){case 0:t=new OH(s,a,c,d);break;case 1:t=new qk(s,a);break;case 2:let p=Math.PI/3;n.InnerAngle!==void 0&&(p=E0.degToRad(n.InnerAngle.value));let y=0;n.OuterAngle!==void 0&&(y=E0.degToRad(n.OuterAngle.value),y=Math.max(y,1)),t=new qx(s,a,c,p,y,d);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new OH(s,a);break}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,s=null,a=null;const c=[];if(e.children.forEach(function(d){t.has(d.ID)&&(s=t.get(d.ID)),n.has(d.ID)&&c.push(n.get(d.ID))}),c.length>1?a=c:c.length>0?a=c[0]:(a=new q8({name:A4.DEFAULT_MATERIAL_NAME,color:13421772}),c.push(a)),"color"in s.attributes&&c.forEach(function(d){d.vertexColors=!0}),s.groups.length>0){let d=!1;for(let p=0,y=s.groups.length;p<y;p++){const x=s.groups[p];(x.materialIndex<0||x.materialIndex>=c.length)&&(x.materialIndex=c.length,d=!0)}if(d){const p=new q8;c.push(p)}}return s.FBX_Deformer?(r=new WW(s,a),r.normalizeSkinWeights()):r=new fn(s,a),r}createCurve(e,t){const n=e.children.reduce(function(s,a){return t.has(a.ID)&&(s=t.get(a.ID)),s},null),r=new Td({name:A4.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new wu(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?n.eulerOrder=ME(t.RotationOrder.value):n.eulerOrder=ME(0),"Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&Ta.get(e.ID).children.forEach(function(r){if(r.relationship==="LookAtProperty"){const s=Ti.Objects.Model[r.ID];if("Lcl_Translation"in s){const a=s.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(a),Ic.add(e.target)):e.lookAt(new _e().fromArray(a))}}})}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const s in e){const a=e[s];Ta.get(parseInt(a.ID)).parents.forEach(function(d){if(t.has(d.ID)){const p=d.ID;Ta.get(p).parents.forEach(function(x){n.has(x.ID)&&n.get(x.ID).bind(new qW(a.bones),r[x.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in Ti.Objects){const t=Ti.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach(function(s){e[s.Node]=new An().fromArray(s.Matrix.a)}):e[r.Node]=new An().fromArray(r.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in Ti){if("AmbientColor"in Ti.GlobalSettings){const e=Ti.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(t!==0||n!==0||r!==0){const s=new xn().setRGB(t,n,r,ti);Ic.add(new o8e(s,1))}}"UnitScaleFactor"in Ti.GlobalSettings&&(Ic.userData.unitScaleFactor=Ti.GlobalSettings.UnitScaleFactor.value)}}}class Vet{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in Ti.Objects){const n=Ti.Objects.Geometry;for(const r in n){const s=Ta.get(parseInt(r)),a=this.parseGeometry(s,n[r],e);t.set(parseInt(r),a)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,s=[],a=e.parents.map(function(x){return Ti.Objects.Model[x.ID]});if(a.length===0)return;const c=e.children.reduce(function(x,w){return r[w.ID]!==void 0&&(x=r[w.ID]),x},null);e.children.forEach(function(x){n.morphTargets[x.ID]!==void 0&&s.push(n.morphTargets[x.ID])});const d=a[0],p={};"RotationOrder"in d&&(p.eulerOrder=ME(d.RotationOrder.value)),"InheritType"in d&&(p.inheritType=parseInt(d.InheritType.value)),"GeometricTranslation"in d&&(p.translation=d.GeometricTranslation.value),"GeometricRotation"in d&&(p.rotation=d.GeometricRotation.value),"GeometricScaling"in d&&(p.scale=d.GeometricScaling.value);const y=Txe(p);return this.genGeometry(t,c,s,y)}genGeometry(e,t,n,r){const s=new Ii;e.attrName&&(s.name=e.attrName);const a=this.parseGeoNode(e,t),c=this.genBuffers(a),d=new Rr(c.vertex,3);if(d.applyMatrix4(r),s.setAttribute("position",d),c.colors.length>0&&s.setAttribute("color",new Rr(c.colors,3)),t&&(s.setAttribute("skinIndex",new jk(c.weightsIndices,4)),s.setAttribute("skinWeight",new Rr(c.vertexWeights,4)),s.FBX_Deformer=t),c.normal.length>0){const p=new Xr().getNormalMatrix(r),y=new Rr(c.normal,3);y.applyNormalMatrix(p),s.setAttribute("normal",y)}if(c.uvs.forEach(function(p,y){const x=y===0?"uv":`uv${y}`;s.setAttribute(x,new Rr(c.uvs[y],2))}),a.material&&a.material.mappingType!=="AllSame"){let p=c.materialIndex[0],y=0;if(c.materialIndex.forEach(function(x,w){x!==p&&(s.addGroup(y,w-y,p),p=x,y=w)}),s.groups.length>0){const x=s.groups[s.groups.length-1],w=x.start+x.count;w!==c.materialIndex.length&&s.addGroup(w,c.materialIndex.length-w,p)}s.groups.length===0&&s.addGroup(0,c.materialIndex.length,c.materialIndex[0])}return this.addMorphTargets(s,e,n,r),s}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&e.LayerElementColor[0].Colors&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach(function(r,s){r.indices.forEach(function(a,c){n.weightTable[a]===void 0&&(n.weightTable[a]=[]),n.weightTable[a].push({id:s,weight:r.weights[c]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,s=!1,a=[],c=[],d=[],p=[],y=[],x=[];const w=this;return e.vertexIndices.forEach(function(C,N){let F,U=!1;C<0&&(C=C^-1,U=!0);let R=[],B=[];if(a.push(C*3,C*3+1,C*3+2),e.color){const Y=jN(N,n,C,e.color);d.push(Y[0],Y[1],Y[2])}if(e.skeleton){if(e.weightTable[C]!==void 0&&e.weightTable[C].forEach(function(Y){B.push(Y.weight),R.push(Y.id)}),B.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const Y=[0,0,0,0],A=[0,0,0,0];B.forEach(function(ne,se){let oe=ne,G=R[se];A.forEach(function(ie,Me,X){if(oe>ie){X[Me]=oe,oe=ie;const De=Y[Me];Y[Me]=G,G=De}})}),R=Y,B=A}for(;B.length<4;)B.push(0),R.push(0);for(let Y=0;Y<4;++Y)y.push(B[Y]),x.push(R[Y])}if(e.normal){const Y=jN(N,n,C,e.normal);c.push(Y[0],Y[1],Y[2])}e.material&&e.material.mappingType!=="AllSame"&&(F=jN(N,n,C,e.material)[0],F<0&&(w.negativeMaterialIndices=!0,F=0)),e.uv&&e.uv.forEach(function(Y,A){const ne=jN(N,n,C,Y);p[A]===void 0&&(p[A]=[]),p[A].push(ne[0]),p[A].push(ne[1])}),r++,U&&(w.genFace(t,e,a,F,c,d,p,y,x,r),n++,r=0,a=[],c=[],d=[],p=[],y=[],x=[])}),t}getNormalNewell(e){const t=new _e(0,0,0);for(let n=0;n<e.length;n++){const r=e[n],s=e[(n+1)%e.length];t.x+=(r.y-s.y)*(r.z+s.z),t.y+=(r.z-s.z)*(r.x+s.x),t.z+=(r.x-s.x)*(r.y+s.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){const t=this.getNormalNewell(e),r=(Math.abs(t.z)>.5?new _e(0,1,0):new _e(0,0,1)).cross(t).normalize(),s=t.clone().cross(r).normalize();return{normal:t,tangent:r,bitangent:s}}flattenVertex(e,t,n){return new vn(e.dot(t),e.dot(n))}genFace(e,t,n,r,s,a,c,d,p,y){let x;if(y>3){const w=[],C=t.baseVertexPositions||t.vertexPositions;for(let R=0;R<n.length;R+=3)w.push(new _e(C[n[R]],C[n[R+1]],C[n[R+2]]));const{tangent:N,bitangent:F}=this.getNormalTangentAndBitangent(w),U=[];for(const R of w)U.push(this.flattenVertex(R,N,F));x=QW.triangulateShape(U,[])}else x=[[0,1,2]];for(const[w,C,N]of x)e.vertex.push(t.vertexPositions[n[w*3]]),e.vertex.push(t.vertexPositions[n[w*3+1]]),e.vertex.push(t.vertexPositions[n[w*3+2]]),e.vertex.push(t.vertexPositions[n[C*3]]),e.vertex.push(t.vertexPositions[n[C*3+1]]),e.vertex.push(t.vertexPositions[n[C*3+2]]),e.vertex.push(t.vertexPositions[n[N*3]]),e.vertex.push(t.vertexPositions[n[N*3+1]]),e.vertex.push(t.vertexPositions[n[N*3+2]]),t.skeleton&&(e.vertexWeights.push(d[w*4]),e.vertexWeights.push(d[w*4+1]),e.vertexWeights.push(d[w*4+2]),e.vertexWeights.push(d[w*4+3]),e.vertexWeights.push(d[C*4]),e.vertexWeights.push(d[C*4+1]),e.vertexWeights.push(d[C*4+2]),e.vertexWeights.push(d[C*4+3]),e.vertexWeights.push(d[N*4]),e.vertexWeights.push(d[N*4+1]),e.vertexWeights.push(d[N*4+2]),e.vertexWeights.push(d[N*4+3]),e.weightsIndices.push(p[w*4]),e.weightsIndices.push(p[w*4+1]),e.weightsIndices.push(p[w*4+2]),e.weightsIndices.push(p[w*4+3]),e.weightsIndices.push(p[C*4]),e.weightsIndices.push(p[C*4+1]),e.weightsIndices.push(p[C*4+2]),e.weightsIndices.push(p[C*4+3]),e.weightsIndices.push(p[N*4]),e.weightsIndices.push(p[N*4+1]),e.weightsIndices.push(p[N*4+2]),e.weightsIndices.push(p[N*4+3])),t.color&&(e.colors.push(a[w*3]),e.colors.push(a[w*3+1]),e.colors.push(a[w*3+2]),e.colors.push(a[C*3]),e.colors.push(a[C*3+1]),e.colors.push(a[C*3+2]),e.colors.push(a[N*3]),e.colors.push(a[N*3+1]),e.colors.push(a[N*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[w*3]),e.normal.push(s[w*3+1]),e.normal.push(s[w*3+2]),e.normal.push(s[C*3]),e.normal.push(s[C*3+1]),e.normal.push(s[C*3+2]),e.normal.push(s[N*3]),e.normal.push(s[N*3+1]),e.normal.push(s[N*3+2])),t.uv&&t.uv.forEach(function(F,U){e.uvs[U]===void 0&&(e.uvs[U]=[]),e.uvs[U].push(c[U][w*2]),e.uvs[U].push(c[U][w*2+1]),e.uvs[U].push(c[U][C*2]),e.uvs[U].push(c[U][C*2+1]),e.uvs[U].push(c[U][N*2]),e.uvs[U].push(c[U][N*2+1])})}addMorphTargets(e,t,n,r){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;n.forEach(function(a){a.rawTargets.forEach(function(c){const d=Ti.Objects.Geometry[c.geoID];d!==void 0&&s.genMorphGeometry(e,t,d,r,c.name)})})}genMorphGeometry(e,t,n,r,s){const a=t.Vertices!==void 0?t.Vertices.a:[],c=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],d=n.Vertices!==void 0?n.Vertices.a:[],p=n.Indexes!==void 0?n.Indexes.a:[],y=e.attributes.position.count*3,x=new Float32Array(y);for(let F=0;F<p.length;F++){const U=p[F]*3;x[U]=d[F*3],x[U+1]=d[F*3+1],x[U+2]=d[F*3+2]}const w={vertexIndices:c,vertexPositions:x,baseVertexPositions:a},C=this.genBuffers(w),N=new Rr(C.vertex,3);N.name=s||n.attrName,N.applyMatrix4(r),e.morphAttributes.position.push(N)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let s=[];return n==="IndexToDirect"&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:s,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let s=[];return n==="IndexToDirect"&&(s=e.UVIndex.a),{dataSize:2,buffer:r,indices:s,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let s=[];n==="IndexToDirect"&&(s=e.ColorIndex.a);for(let a=0,c=new xn;a<r.length;a+=4)c.fromArray(r,a),Xn.colorSpaceToWorking(c,ti),c.toArray(r,a);return{dataSize:4,buffer:r,indices:s,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,s=[];for(let a=0;a<r.length;++a)s.push(a);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Ii;const n=t-1,r=e.KnotVector.a,s=[],a=e.Points.a;for(let x=0,w=a.length;x<w;x+=4)s.push(new wr().fromArray(a,x));let c,d;if(e.Form==="Closed")s.push(s[0]);else if(e.Form==="Periodic"){c=n,d=r.length-1-c;for(let x=0;x<n;++x)s.push(s[x])}const y=new Uet(n,r,s,c,d).getPoints(s.length*12);return new Ii().setFromPoints(y)}}class Get{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const r=t[n],s=this.addClip(r);e.push(s)}return e}parseClips(){if(Ti.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Ti.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const s={id:r.id,attr:r.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=Ti.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map($et),values:t[n].KeyValueFloat.a},s=Ta.get(r.id);if(s!==void 0){const a=s.parents[0].ID,c=s.parents[0].relationship;c.match(/X/)?e.get(a).curves.x=r:c.match(/Y/)?e.get(a).curves.y=r:c.match(/Z/)?e.get(a).curves.z=r:c.match(/DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=r)}}}parseAnimationLayers(e){const t=Ti.Objects.AnimationLayer,n=new Map;for(const r in t){const s=[],a=Ta.get(parseInt(r));a!==void 0&&(a.children.forEach(function(d,p){if(e.has(d.ID)){const y=e.get(d.ID);if(y.curves.x!==void 0||y.curves.y!==void 0||y.curves.z!==void 0){if(s[p]===void 0){const x=Ta.get(d.ID).parents.filter(function(w){return w.relationship!==void 0})[0].ID;if(x!==void 0){const w=Ti.Objects.Model[x.toString()];if(w===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",d);return}const C={modelName:w.attrName?ts.sanitizeNodeName(w.attrName):"",ID:w.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Ic.traverse(function(N){N.ID===w.id&&(C.transform=N.matrix,N.userData.transformData&&(C.eulerOrder=N.userData.transformData.eulerOrder))}),C.transform||(C.transform=new An),"PreRotation"in w&&(C.preRotation=w.PreRotation.value),"PostRotation"in w&&(C.postRotation=w.PostRotation.value),s[p]=C}}s[p]&&(s[p][y.attr]=y)}else if(y.curves.morph!==void 0){if(s[p]===void 0){const x=Ta.get(d.ID).parents.filter(function(R){return R.relationship!==void 0})[0].ID,w=Ta.get(x).parents[0].ID,C=Ta.get(w).parents[0].ID,N=Ta.get(C).parents[0].ID,F=Ti.Objects.Model[N],U={modelName:F.attrName?ts.sanitizeNodeName(F.attrName):"",morphName:Ti.Objects.Deformer[x].attrName};s[p]=U}s[p][y.attr]=y}}}),n.set(parseInt(r),s))}return n}parseAnimStacks(e){const t=Ti.Objects.AnimationStack,n={};for(const r in t){const s=Ta.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(s[0].ID);n[r]={name:t[r].attrName,layer:a}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(r){t=t.concat(n.generateTracks(r))}),new DH(e.name,-1,t)}generateTracks(e){const t=[];let n=new _e,r=new _e;if(e.transform&&e.transform.decompose(n,new us,r),n=n.toArray(),r=r.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const s=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");s!==void 0&&t.push(s)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const s=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);s!==void 0&&t.push(s)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const s=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");s!==void 0&&t.push(s)}if(e.DeformPercent!==void 0){const s=this.generateMorphTrack(e);s!==void 0&&t.push(s)}return t}generateVectorTrack(e,t,n,r){const s=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(s,t,n);return new _E(e+"."+r,s,a)}generateRotationTrack(e,t,n,r,s){let a,c;if(t.x!==void 0&&t.y!==void 0&&t.z!==void 0){const w=this.interpolateRotations(t.x,t.y,t.z,s);a=w[0],c=w[1]}const d=ME(0);n!==void 0&&(n=n.map(E0.degToRad),n.push(d),n=new Ao().fromArray(n),n=new us().setFromEuler(n)),r!==void 0&&(r=r.map(E0.degToRad),r.push(d),r=new Ao().fromArray(r),r=new us().setFromEuler(r).invert());const p=new us,y=new Ao,x=[];if(!c||!a)return new Nx(e+".quaternion",[0],[0]);for(let w=0;w<c.length;w+=3)y.set(c[w],c[w+1],c[w+2],s),p.setFromEuler(y),n!==void 0&&p.premultiply(n),r!==void 0&&p.multiply(r),w>2&&new us().fromArray(x,(w-3)/3*4).dot(p)<0&&p.set(-p.x,-p.y,-p.z,-p.w),p.toArray(x,w/3*4);return new Nx(e+".quaternion",a,x)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(s){return s/100}),r=Ic.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new yE(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(n,r){return n-r}),t.length>1){let n=1,r=t[0];for(let s=1;s<t.length;s++){const a=t[s];a!==r&&(t[n]=a,r=a,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,s=[];let a=-1,c=-1,d=-1;return e.forEach(function(p){if(t.x&&(a=t.x.times.indexOf(p)),t.y&&(c=t.y.times.indexOf(p)),t.z&&(d=t.z.times.indexOf(p)),a!==-1){const y=t.x.values[a];s.push(y),r[0]=y}else s.push(r[0]);if(c!==-1){const y=t.y.values[c];s.push(y),r[1]=y}else s.push(r[1]);if(d!==-1){const y=t.z.values[d];s.push(y),r[2]=y}else s.push(r[2])}),s}interpolateRotations(e,t,n,r){const s=[],a=[];s.push(e.times[0]),a.push(E0.degToRad(e.values[0])),a.push(E0.degToRad(t.values[0])),a.push(E0.degToRad(n.values[0]));for(let c=1;c<e.values.length;c++){const d=[e.values[c-1],t.values[c-1],n.values[c-1]];if(isNaN(d[0])||isNaN(d[1])||isNaN(d[2]))continue;const p=d.map(E0.degToRad),y=[e.values[c],t.values[c],n.values[c]];if(isNaN(y[0])||isNaN(y[1])||isNaN(y[2]))continue;const x=y.map(E0.degToRad),w=[y[0]-d[0],y[1]-d[1],y[2]-d[2]],C=[Math.abs(w[0]),Math.abs(w[1]),Math.abs(w[2])];if(C[0]>=180||C[1]>=180||C[2]>=180){const F=Math.max(...C)/180,U=new Ao(...p,r),R=new Ao(...x,r),B=new us().setFromEuler(U),Y=new us().setFromEuler(R);B.dot(Y)&&Y.set(-Y.x,-Y.y,-Y.z,-Y.w);const A=e.times[c-1],ne=e.times[c]-A,se=new us,oe=new Ao;for(let G=0;G<1;G+=1/F)se.copy(B.clone().slerp(Y.clone(),G)),s.push(A+G*ne),oe.setFromQuaternion(se,r),a.push(oe.x),a.push(oe.y),a.push(oe.z)}else s.push(e.times[c]),a.push(E0.degToRad(e.values[c])),a.push(E0.degToRad(t.values[c])),a.push(E0.degToRad(n.values[c]))}return[s,a]}}class jet{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new wxe,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(r,s){const a=r.match(/^[\s\t]*;/),c=r.match(/^[\s\t]*$/);if(a||c)return;const d=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),p=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),y=r.match("^\\t{"+(t.currentIndent-1)+"}}");d?t.parseNodeBegin(r,d):p?t.parseNodeProperty(r,p,n[++s]):y?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(d){return d.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:n},a=this.parseNodeAttr(r),c=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,s):n in c?(n==="PoseNode"?c.PoseNode.push(s):c[n].id!==void 0&&(c[n]={},c[n][c[n].id]=c[n]),a.id!==""&&(c[n][a.id]=s)):typeof a.id=="number"?(c[n]={},c[n][a.id]=s):n!=="Properties70"&&(n==="PoseNode"?c[n]=[s]:c[n]=s),typeof a.id=="number"&&(s.id=a.id),a.name!==""&&(s.attrName=a.name),a.type!==""&&(s.attrType=a.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&s===","&&(s=n.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name==="Properties70"){this.parseNodeSpecialProperty(e,r,s);return}if(r==="C"){const d=s.split(",").slice(1),p=parseInt(d[0]),y=parseInt(d[1]);let x=s.split(",").slice(3);x=x.map(function(w){return w.trim().replace(/^"/,"")}),r="connections",s=[p,y],Yet(s,x),a[r]===void 0&&(a[r]=[])}r==="Node"&&(a.id=s),r in a&&Array.isArray(a[r])?a[r].push(s):r!=="a"?a[r]=s:a.a=s,this.setCurrentProp(a,r),r==="a"&&s.slice(-1)!==","&&(a.a=bH(s))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=bH(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map(function(y){return y.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=r[0],a=r[1],c=r[2],d=r[3];let p=r[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":p=parseFloat(p);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":p=bH(p);break}this.getPrevNode()[s]={type:a,type2:c,flag:d,value:p},this.setCurrentProp(this.getPrevNode(),s)}}class Het{parse(e){const t=new wve(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new wxe;for(;!this.endOfContent(t);){const s=this.parseNode(t,n);s!==null&&r.add(s.name,s)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),c=e.getString(a);if(r===0)return null;const d=[];for(let w=0;w<s;w++)d.push(this.parseProperty(e));const p=d.length>0?d[0]:"",y=d.length>1?d[1]:"",x=d.length>2?d[2]:"";for(n.singleProperty=s===1&&e.getOffset()===r;r>e.getOffset();){const w=this.parseNode(e,t);w!==null&&this.parseSubNode(c,n,w)}return n.propertyList=d,typeof p=="number"&&(n.id=p),y!==""&&(n.attrName=y),x!==""&&(n.attrType=x),c!==""&&(n.name=c),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if(e==="Connections"&&n.name==="C"){const r=[];n.propertyList.forEach(function(s,a){a!==0&&r.push(s)}),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(n.name==="Properties70")Object.keys(n).forEach(function(s){t[s]=n[s]});else if(e==="Properties70"&&n.name==="P"){let r=n.propertyList[0],s=n.propertyList[1];const a=n.propertyList[2],c=n.propertyList[3];let d;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),s==="Color"||s==="ColorRGB"||s==="Vector"||s==="Vector3D"||s.indexOf("Lcl_")===0?d=[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:d=n.propertyList[4],t[r]={type:s,type2:a,flag:c,value:d}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),a=e.getUint32();if(s===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const c=Aet(new Uint8Array(e.getArrayBuffer(a))),d=new wve(c.buffer);switch(t){case"b":case"c":return d.getBooleanArray(r);case"d":return d.getFloat64Array(r);case"f":return d.getFloat32Array(r);case"i":return d.getInt32Array(r);case"l":return d.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class wve{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const r=n.indexOf(0);return r>=0&&(n=new Uint8Array(this.dv.buffer,t,r)),this._textDecoder.decode(n)}}class wxe{add(e,t){this[e]=t}}function Wet(i){const e="Kaydara FBX Binary  \0";return i.byteLength>=e.length&&e===Exe(i,0,e.length)}function qet(i){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(r){const s=i[r-1];return i=i.slice(t+r),t++,s}for(let r=0;r<e.length;++r)if(n(1)===e[r])return!1;return!0}function Tve(i){const e=/FBXVersion: (\d+)/,t=i.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function $et(i){return i/46186158e3}const Xet=[];function jN(i,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=i;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(r=n.indices[r]);const s=r*n.dataSize,a=s+n.dataSize;return Ket(Xet,n.buffer,s,a)}const xH=new Ao,B_=new _e;function Txe(i){const e=new An,t=new An,n=new An,r=new An,s=new An,a=new An,c=new An,d=new An,p=new An,y=new An,x=new An,w=new An,C=i.inheritType?i.inheritType:0;i.translation&&e.setPosition(B_.fromArray(i.translation));const N=ME(0);if(i.preRotation){const X=i.preRotation.map(E0.degToRad);X.push(N),t.makeRotationFromEuler(xH.fromArray(X))}if(i.rotation){const X=i.rotation.map(E0.degToRad);X.push(i.eulerOrder||N),n.makeRotationFromEuler(xH.fromArray(X))}if(i.postRotation){const X=i.postRotation.map(E0.degToRad);X.push(N),r.makeRotationFromEuler(xH.fromArray(X)),r.invert()}i.scale&&s.scale(B_.fromArray(i.scale)),i.scalingOffset&&c.setPosition(B_.fromArray(i.scalingOffset)),i.scalingPivot&&a.setPosition(B_.fromArray(i.scalingPivot)),i.rotationOffset&&d.setPosition(B_.fromArray(i.rotationOffset)),i.rotationPivot&&p.setPosition(B_.fromArray(i.rotationPivot)),i.parentMatrixWorld&&(x.copy(i.parentMatrix),y.copy(i.parentMatrixWorld));const F=t.clone().multiply(n).multiply(r),U=new An;U.extractRotation(y);const R=new An;R.copyPosition(y);const B=R.clone().invert().multiply(y),Y=U.clone().invert().multiply(B),A=s,ne=new An;if(C===0)ne.copy(U).multiply(F).multiply(Y).multiply(A);else if(C===1)ne.copy(U).multiply(Y).multiply(F).multiply(A);else{const De=new An().scale(new _e().setFromMatrixScale(x)).clone().invert(),$e=Y.clone().multiply(De);ne.copy(U).multiply(F).multiply($e).multiply(A)}const se=p.clone().invert(),oe=a.clone().invert();let G=e.clone().multiply(d).multiply(p).multiply(t).multiply(n).multiply(r).multiply(se).multiply(c).multiply(a).multiply(s).multiply(oe);const ie=new An().copyPosition(G),Me=y.clone().multiply(ie);return w.copyPosition(Me),G=w.clone().multiply(ne),G.premultiply(y.invert()),G}function ME(i){i=i||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return i===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[i]}function bH(i){return i.split(",").map(function(t){return parseFloat(t)})}function Exe(i,e,t){return e===void 0&&(e=0),t===void 0&&(t=i.byteLength),new TextDecoder().decode(new Uint8Array(i,e,t))}function Yet(i,e){for(let t=0,n=i.length,r=e.length;t<r;t++,n++)i[n]=e[t]}function Ket(i,e,t,n){for(let r=t,s=0;r<n;r++,s++)i[s]=e[r];return i}const AD=new Map,Mxe=new Map,Cxe=new Map,H$=new Map;function Zet(i,e){return new Promise((t,n)=>{new Jke().setPath("images/milkyWay/").load(e,r=>{AD.set(i,r),t(r)},void 0,()=>{n()})})}function Qet(i,e){return new Promise((t,n)=>{new Bet().setPath("./models/").loadAsync(e).then(r=>{r.traverse(s=>{s.isMesh&&(s.castShadow=!0,s.receiveShadow=!0)}),Cxe.set(i,r),t(r)}).catch(r=>{console.log("Couldn't load:",e),console.log(r),n()})})}function Jet(i,e){return new Promise((t,n)=>{new i8e().load(e,r=>{r.wrapS=bd,r.wrapT=bd,r.needsUpdate=!0,H$.set(i,r),t(r)},void 0,()=>{n()})})}function ett(i,e){return new Promise((t,n)=>{fetch(e).then(r=>{if(!r.ok)throw new Error(`Network response was not ok: ${r.status}`);return r.json()}).then(r=>{Mxe.set(i,r),t(r)}).catch(()=>{console.log(`Couldn't load: ${e}`),n()})})}function ttt(i){return new Promise((e,t)=>{const n=[()=>Zet("environment",["dark-s_px.jpg","dark-s_nx.jpg","dark-s_py.jpg","dark-s_ny.jpg","dark-s_pz.jpg","dark-s_nz.jpg"]),()=>Jet("uv_grid","images/uv_grid_opengl.jpg"),()=>Qet("Flair","Flair.fbx"),()=>ett("animation","json/animation.json")];Promise.all(n.map(r=>r())).then(()=>{const r=i.components.get("theatre"),s=Mxe.get("animation");r.loadProject("RemoteApp",s).then(()=>{VH.dispatchEvent({type:ok.LOAD_COMPLETE}),e()})}).catch(r=>{console.log(r),t()})})}class Axe extends hi{constructor(t){super();Xe(this,"mixer");this.name=t,this.scale.setScalar(.5);const n=Cxe.get(t),r=fet(n);this.add(r),this.mixer=new xDe(r),r.mixer=this.mixer,this.mixer.clipAction(r.animations[0]).play()}update(t){this.mixer.update(t)}get timeScale(){return this.mixer.timeScale}set timeScale(t){this.mixer.timeScale=t}}class PD extends c6{constructor(){super();Xe(this,"app");Xe(this,"camera");Xe(this,"renderer");Xe(this,"clock");this.clock=new oDe,this.clock.connect(document);const t=new hi;t.name="cameras",this.add(t),this.camera=new ca(90,1,10,1e3),this.camera.name="SceneCamera",this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),t.add(this.camera)}setup(t,n){this.app=t,this.renderer=n}init(){}dispose(){this.app.components.get("theatre").clearSheetObjects(this.name),this.clock.disconnect()}resize(t,n){this.camera.aspect=t/n,this.camera.updateProjectionMatrix()}update(){}draw(){this.renderer.render(this,this.camera)}}let xW=[];function ntt(i,e,t=!0){el.renderer=e.renderer;const n=[];n.push({type:"boolean",prop:"Enabled",value:i.enabled});let r=(a,c)=>{console.log("Default Handle Pass:",a,c)};if(i.name==="EffectPass")i.effects.forEach(a=>{a.uniforms.size>0&&a.uniforms.forEach((c,d)=>{if(d==="map")return;const p=`${a.name.replace("Effect","")} ${d}`;if(c.value===null&&t)n.push({prop:d,title:p,type:"image",value:{offset:[0,0],repeat:[1,1],src:""}});else if(c.value.isTexture&&t){const y=c.value,x=el.renderToBlob(y);n.push({prop:d,title:p,type:"image",value:{offset:[y.offset.x,y.offset.y],repeat:[y.repeat.x,y.repeat.y],src:x}})}else typeof c.value=="number"?n.push({prop:d,title:p,type:"number",value:c.value,step:.01}):typeof c.value=="string"?n.push({prop:d,title:p,type:"string",value:c.value}):typeof c.value=="boolean"&&n.push({prop:d,title:p,type:"boolean",value:c.value})})}),r=(a,c)=>{i.effects.forEach(d=>{d.uniforms.size>0&&d.uniforms.forEach((p,y)=>{y===a&&(p.value=c)})})};else if(i.name==="ShaderPass"){const a=i.fullscreenMaterial;for(const c in a.uniforms){if(c==="inputBuffer"||c==="map")continue;const d=a.uniforms[c],p=`${a.name.replace("Material","")} ${c}`;if(d.value===null&&t)n.push({title:p,prop:c,type:"image",value:{offset:[0,0],repeat:[1,1],src:""}});else if(d.value.isTexture&&t){const y=d.value,x=el.renderToBlob(y);n.push({title:p,prop:c,type:"image",value:{offset:[y.offset.x,y.offset.y],repeat:[y.repeat.x,y.repeat.y],src:x}})}else typeof d.value=="number"?n.push({title:p,prop:c,type:"number",value:d.value,step:.01}):typeof d.value=="string"?n.push({title:p,prop:c,type:"string",value:d.value}):typeof d.value=="boolean"&&n.push({title:p,prop:c,type:"boolean",value:d.value})}r=(c,d)=>{const p=a.uniforms[c];p.value=d}}else return;const s=`${i.name}: ${i.scene.name}`;e.addGroup({title:s,items:n,onUpdate:(a,c)=>{a==="Enabled"?i.enabled=c:r(a,c)}}),xW.push(s)}function rtt(i,e){i.passes.forEach(t=>{ntt(t,e)})}function itt(i){xW.forEach(e=>{i.removeGroup(e)}),xW=[]}class Pxe extends PD{constructor(){super();Xe(this,"dance");Xe(this,"composer");Xe(this,"customMat");this.name="Scene1"}init(){const t=AD.get("environment");this.background=t,this.camera.position.set(0,50,50),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createPost(),this.createAnimation(),y2(this);const n=this.app.components.get("three");n.addScene(this),n.setScene(this),n.addCamera(this.camera)}dispose(){var n;const t=this.app.components.get("three");(n=this.composer)==null||n.dispose(),t.removeCamera(this.camera),super.dispose()}createLights(){const t=new hi;t.name="lights",this.add(t);const n=new qk(16777215,.25);n.name="sun",n.castShadow=!0,n.position.set(0,50,50);const r=1024;n.shadow.camera.top=r,n.shadow.camera.bottom=-r,n.shadow.camera.left=-r,n.shadow.camera.right=r,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=10,n.shadow.camera.far=1e3,n.shadow.bias=-.001,t.add(n);const s=new s8e(7320802,12872999,.5);s.name="hemi",t.add(s);const a=new qx(16777215,3);a.angle=5.8,a.decay=0,a.distance=1e3,a.penumbra=Math.PI,a.name="spotlight",a.castShadow=!0,a.shadow.mapSize.width=1024,a.shadow.mapSize.height=1024,a.shadow.camera.near=10,a.shadow.camera.far=1e3,a.shadow.bias=-.001,a.position.set(-50,200,200),a.lookAt(0,50,0),t.add(a)}createWorld(){const t=new hi;t.name="world",this.add(t);const n=H$.get("uv_grid");n.repeat.setScalar(10),n.needsUpdate=!0;const r=new q8({map:n}),s=new fn(new Hk(500,36),r);s.name="floor",s.receiveShadow=!0,s.rotateX(-Math.PI/2),t.add(s),this.dance=new Axe("Flair"),this.dance.position.set(0,0,0),t.add(this.dance),this.createTestMaterials(t)}createTestMaterials(t){const n=new ip(20),r=[],s=new fn(n,new Ua({name:"BasicMaterial",transparent:!0}));s.name="Basic",t.add(s),r.push(s);const a=new fn(n,new tq({transparent:!0}));a.name="Matcap",t.add(a),r.push(a);const c=new fn(n,new q8({name:"PhongMaterial",transparent:!0}));c.name="Phong",t.add(c),r.push(c);const d=new fn(n,new vE({name:"PhysicalMaterial",transparent:!0}));if(d.name="Physical",t.add(d),r.push(d),this.app.components.get("three").renderer.isWebGLRenderer){this.customMat=new pxe;const C=new fn(n,this.customMat);C.name="Shader",t.add(C),r.push(C)}const y=50,x=r.length,w=(x-1)/2*y;for(let C=0;C<x;C++){const N=C*y-w;r[C].position.set(N,100,-150),r[C].castShadow=!0}}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Break Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.playSheet(this.name,{iterationCount:1/0})}createPost(){var s,a,c;const t=this.app.components.get("three");this.composer=new QQe(t.renderer,{frameBufferType:Gs}),(s=this.composer)==null||s.addPass(new tet(this,this.camera));const n=new cet(this.camera,new eet,new KJe,new ret);n.scene.name="FXAA/Bloom/Vignette",(a=this.composer)==null||a.addPass(n);const r=new ZJe(new V$);r.scene.name="Display",(c=this.composer)==null||c.addPass(r),rtt(this.composer,t)}update(){var n;const t=this.clock.getDelta();(n=this.customMat)==null||n.update(t),this.dance.update(t)}draw(){var t;(t=this.composer)==null||t.render()}resize(t,n){var r;super.resize(t,n),this.app.isApp&&((r=this.composer)==null||r.setSize(t,n))}}class Bx{static init(){const e=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-448815e-12,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,907581e-12,1.12813,.997866,-896716e-12,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,879224e-12,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,655682e-12,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,462391e-12,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,304092e-12,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,173682e-12,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,778271e-13,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-627338e-12,.0306409,197672e-13,99168e-8,-158573e-10,.0314638,499803e-12,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,237499e-13,-999999e-13,282592e-10,114596e-15,100292e-11,-166369e-11,250354e-9,677492e-14,350752e-11,-637769e-11,357289e-9,631655e-13,826445e-11,-174689e-10,516179e-9,31851e-11,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],t=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,545037e-15,0,0,.999994,285095e-14,0,0,.999989,126931e-13,0,0,.999973,489938e-13,0,0,.999947,166347e-12,0,0,.999894,502694e-12,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,115855e-15,0,0,.999996,66947e-14,0,0,.999991,330863e-14,0,0,.999983,141737e-13,0,0,.999968,532626e-13,0,0,.99994,177431e-12,0,0,.999891,528835e-12,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,222338e-15,0,0,.999995,10967e-13,0,0,.999991,482132e-14,0,0,.999981,189434e-13,0,0,.999967,667716e-13,0,0,.999938,212066e-12,0,0,.999886,60977e-11,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,101739e-15,0,0,.999997,470132e-15,0,0,.999993,200436e-14,0,0,.999988,783682e-14,0,0,.999979,280338e-13,0,0,.999962,917033e-13,0,0,.999933,274514e-12,0,0,.999881,753201e-12,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,251859e-15,0,0,.999996,996192e-15,0,0,.999992,374531e-14,0,0,.999986,132022e-13,0,0,.999975,433315e-13,0,0,.999959,131956e-12,0,0,.999927,372249e-12,0,0,.999871,972461e-12,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,179597e-15,0,0,.999997,602367e-15,0,0,.999994,206835e-14,0,0,.99999,694952e-14,0,0,.999984,223363e-13,0,0,.999972,678578e-13,0,0,.999952,193571e-12,0,0,.999919,516594e-12,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,114608e-15,0,0,.999998,210507e-15,0,0,.999997,499595e-15,0,0,.999995,139897e-14,0,0,.999994,419818e-14,0,0,.999988,127042e-13,0,0,.999979,375153e-13,0,0,.999965,106206e-12,0,0,.999945,285381e-12,0,0,.999908,723611e-12,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,286798e-15,0,0,1,286877e-15,0,0,1,288094e-15,0,0,1,293506e-15,0,0,1,309262e-15,0,0,.999999,348593e-15,0,0,.999999,444582e-15,0,0,.999998,688591e-15,0,0,.999996,134391e-14,0,0,.999993,317438e-14,0,0,.999989,835609e-14,0,0,.999983,228677e-13,0,0,.999974,623361e-13,0,0,.999959,165225e-12,0,0,.999936,419983e-12,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,168222e-12,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,109018e-14,0,0,1,10904e-13,0,0,1,109393e-14,0,0,1,11095e-13,0,0,1,1154e-12,0,0,1,126089e-14,0,0,.999999,15059e-13,0,0,.999997,207899e-14,0,0,.999994,348164e-14,0,0,.999993,705728e-14,0,0,.999987,163692e-13,0,0,.999981,406033e-13,0,0,.999969,10245e-11,0,0,.999953,255023e-12,0,0,.999925,61511e-11,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,354014e-14,0,0,1,354073e-14,0,0,1,354972e-14,0,0,1,358929e-14,0,0,1,370093e-14,0,0,.999999,396194e-14,0,0,.999998,453352e-14,0,0,.999997,578828e-14,0,0,.999994,863812e-14,0,0,.999991,153622e-13,0,0,.999985,316356e-13,0,0,.999977,712781e-13,0,0,.999964,166725e-12,0,0,.999945,390501e-12,0,0,.999912,895622e-12,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,10153e-12,0,0,1,101544e-13,0,0,1,101751e-13,0,0,1,102662e-13,0,0,1,10521e-12,0,0,.999999,111049e-13,0,0,.999999,123408e-13,0,0,.999996,14924e-12,0,0,.999992,204471e-13,0,0,.999989,326539e-13,0,0,.99998,603559e-13,0,0,.999971,123936e-12,0,0,.999955,269058e-12,0,0,.999933,593604e-12,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,22038e-11,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,263344e-13,0,0,1,263373e-13,0,0,1,263815e-13,0,0,1,265753e-13,0,0,1,271132e-13,0,0,.999999,283279e-13,0,0,.999997,30833e-12,0,0,.999995,358711e-13,0,0,.999992,461266e-13,0,0,.999985,67574e-12,0,0,.999977,11358e-11,0,0,.999966,213657e-12,0,0,.999948,431151e-12,0,0,.999923,896656e-12,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,628647e-13,0,0,1,628705e-13,0,0,1,629587e-13,0,0,1,633441e-13,0,0,.999999,644087e-13,0,0,.999998,667856e-13,0,0,.999997,715889e-13,0,0,.999995,809577e-13,0,0,.999989,992764e-13,0,0,.999983,135834e-12,0,0,.999974,210482e-12,0,0,.999959,365215e-12,0,0,.999939,686693e-12,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,139968e-12,0,0,1,139979e-12,0,0,1,140145e-12,0,0,1,14087e-11,0,0,.999999,142865e-12,0,0,.999998,147279e-12,0,0,.999997,156057e-12,0,0,.999992,17276e-11,0,0,.999989,204352e-12,0,0,.99998,26494e-11,0,0,.999969,383435e-12,0,0,.999953,618641e-12,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,29368e-11,0,0,1,2937e-10,0,0,1,293998e-12,0,0,1,295298e-12,0,0,.999999,298865e-12,0,0,.999998,3067e-10,0,0,.999995,322082e-12,0,0,.999992,350767e-12,0,0,.999986,403538e-12,0,0,.999976,501372e-12,0,0,.999964,68562e-11,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,585473e-12,0,0,1,585507e-12,0,0,1,58602e-11,0,0,.999999,588259e-12,0,0,.999999,594381e-12,0,0,.999998,607754e-12,0,0,.999995,633729e-12,0,0,.99999,68137e-11,0,0,.999984,767003e-12,0,0,.999973,921212e-12,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,88288e-11,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],n=new Float32Array(e),r=new Float32Array(t),s=new d4(n,64,64,$s,mo,j8,Co,Co,Bi,Hi,1),a=new d4(r,64,64,$s,mo,j8,Co,Co,Bi,Hi,1);s.needsUpdate=!0,a.needsUpdate=!0;const c=new Uint16Array(e.length);e.forEach(function(x,w){c[w]=m9e.toHalfFloat(x)});const d=new Uint16Array(t.length);t.forEach(function(x,w){d[w]=m9e.toHalfFloat(x)});const p=new d4(c,64,64,$s,Gs,j8,Co,Co,Bi,Hi,1),y=new d4(d,64,64,$s,Gs,j8,Co,Co,Bi,Hi,1);return p.needsUpdate=!0,y.needsUpdate=!0,this.LTC_HALF_1=p,this.LTC_HALF_2=y,this.LTC_FLOAT_1=s,this.LTC_FLOAT_2=a,this}}Bx.LTC_HALF_1=null;Bx.LTC_HALF_2=null;Bx.LTC_FLOAT_1=null;Bx.LTC_FLOAT_2=null;class stt{static init(){Bx.init();const{LTC_FLOAT_1:e,LTC_FLOAT_2:t,LTC_HALF_1:n,LTC_HALF_2:r}=Bx;kn.LTC_FLOAT_1=e,kn.LTC_FLOAT_2=t,kn.LTC_HALF_1=n,kn.LTC_HALF_2=r}}const Eve=new _e;class Rxe extends PD{constructor(){super();Xe(this,"renderTarget");Xe(this,"mesh");this.name="RTTScene",this.camera.position.set(0,0,100),this.camera.lookAt(Eve)}init(){const t=AD.get("environment").clone();this.background=t;const n=new qk(new xn(16777215),1);n.name="sun",this.add(n),this.mesh=new fn(new JW(10,3,100,6),new vE({envMap:t,envMapIntensity:10})),this.mesh.name="normalMesh",this.add(this.mesh);const r=new fn(new ip(10),new eq);r.name="ball",r.position.set(25,25,0),this.add(r);const s=new fn(new rp(200,200),new vE({envMap:t}));s.name="floor",s.rotation.x=-Math.PI/2,s.position.set(0,-20,0),this.add(s),this.renderTarget=new lp(512,512),y2(this);const a=this.app.components.get("three");a.addScene(this),a.addCamera(this.camera)}dispose(){const t=this.app.components.get("three");t.removeCamera(this.camera),t.removeScene(this),super.dispose()}draw(){const t=this.clock.getElapsed(),n=100,r=t*.05*Math.PI*2,s=Math.cos(r)*n,a=Math.sin(r)*n;this.camera.position.set(s,0,a),this.camera.lookAt(Eve),this.renderer&&(this.renderer.setRenderTarget(this.renderTarget),this.renderer.clear(),this.renderer.render(this,this.camera),this.renderer.setRenderTarget(null))}}const Mve="Custom Group";class Ixe extends PD{constructor(){super();Xe(this,"dance");Xe(this,"rttScene");Xe(this,"speed",1);this.name="Scene2",this.rttScene=new Rxe}setup(t,n){super.setup(t,n),this.rttScene.setup(t,n)}init(){this.rttScene.init();const t=this.app.components.get("three");this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createAnimation(),y2(this),t.addScene(this),t.addCamera(this.camera),t.setScene(this),t.renderer&&(this.renderer=t.renderer)}dispose(){const t=this.app.components.get("three");t.removeCamera(this.camera),t.removeGroup(Mve),Mh(this.rttScene),super.dispose()}createLights(){const t=this.app.components.get("three"),n=new hi;n.name="lights",this.add(n);const r=new qx(16777215,3);if(r.angle=5.8,r.decay=0,r.distance=1e3,r.penumbra=Math.PI,r.name="spotlight",r.position.set(-250,200,200),r.lookAt(0,50,0),n.add(r),t.renderer!==void 0&&t.renderer.isWebGLRenderer){stt.init();const s=new a8e(16711680,1,300,100);s.name="rectLight",s.position.set(250,100,100),s.lookAt(0,50,0),n.add(s)}}createWorld(){const t=this.app.components.get("three"),n=AD.get("environment").clone();this.background=n;const r=new hi;r.name="world",this.add(r);const s=H$.get("uv_grid");s.repeat.setScalar(10),s.needsUpdate=!0;const a=new vE({map:s,envMap:n}),c=new fn(new Hk(250,36),a);c.name="floor",c.receiveShadow=!0,c.position.y=-2,c.rotateX(-Math.PI/2),r.add(c);const d=new pke(new ip(50),new XW({size:.5}));d.name="points",d.position.set(-100,50,0),r.add(d);const p=new BE(new ip(50),new Td);p.name="lines",p.position.set(100,50,0),r.add(p);const y=new Ua;y.map=this.rttScene.renderTarget.texture;const x=new fn(new rp(100,100),y);if(x.name="rttExample",x.position.set(-75,50,-125),r.add(x),t.renderer.isWebGLRenderer){const w=new fn(new rp(100,100),new pxe);w.name="customShaderMaterial",w.position.set(75,50,-125),r.add(w)}else x.scale.y=-1,y.side=Ui,y.needsUpdate=!0;this.dance=new Axe("Flair"),this.dance.name="flair",this.dance.traverse(w=>{if(w instanceof WW){const C=w;C.material=new tq}}),r.add(this.dance),t.addGroup({title:Mve,items:[{title:"Speed",prop:"speed",value:1,min:0,max:2,step:.01,type:"range"},{title:"Name",prop:"name",value:"Hello World!",type:"string"},{title:"Color",prop:"color",value:new xn(16711680),type:"color"}],onUpdate:(w,C)=>{switch(console.log(w,C),w){case"speed":this.speed=C;break}}})}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)})}update(){const t=this.clock.getDelta();this.dance.update(t*this.speed),this.rttScene.update(),this.rttScene.draw()}resize(t,n){super.resize(t,n),this.rttScene.resize(t,n)}}class Nxe extends PD{constructor(){super(),this.name="Scene3",this.camera.position.y=0,this.camera.rotation.set(0,0,0)}init(){const e=new h$,t=new fn(new ip(50),e);t.name="mesh",this.add(t);const n=this.app.components.get("three");y2(this),n.addScene(this),n.addCamera(this.camera),n.setScene(this)}}function ott(i){Nn.useEffect(()=>{HQe()},[]);const e=i.app.components.get("three"),t=new Map;return t.set("Scene1",Pxe),t.set("Scene2",Ixe),t.set("Scene3",Nxe),t.set("RTTScene",Rxe),rt.jsx(jQe,{three:e,scenes:t,onSceneAdd:n=>{var r;n.setup(i.app,(r=Fa.instance)==null?void 0:r.renderer),n.init()},onSceneUpdate:n=>{n.update()}})}class kxe{constructor(e,t,n){this.id=0,this.name=e,this.fg=t,this.bg=n,this.gradient=null,this.PR=Math.round(window.devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=document.createElement("canvas"),this.canvas.width=this.WIDTH,this.canvas.height=this.HEIGHT,this.canvas.style.width="90px",this.canvas.style.height="48px",this.canvas.style.position="absolute",this.canvas.style.cssText="width:90px;height:48px;background-color: transparent !important;",this.context=this.canvas.getContext("2d"),this.initializeCanvas()}createGradient(){if(!this.context)throw new Error("No context");const e=this.context.createLinearGradient(0,this.GRAPH_Y,0,this.GRAPH_Y+this.GRAPH_HEIGHT);let t;const n=this.fg;switch(this.fg.toLowerCase()){case"#0ff":t="#006666";break;case"#0f0":t="#006600";break;case"#ff0":t="#666600";break;case"#e1e1e1":t="#666666";break;default:t=this.bg;break}return e.addColorStop(0,t),e.addColorStop(1,n),e}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.gradient=this.createGradient(),this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}update(e,t,n=0){if(!this.context||!this.gradient)return;const r=Math.min(1/0,e),s=Math.max(t,e);this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(`${e.toFixed(n)} ${this.name} (${r.toFixed(n)}-${parseFloat(s.toFixed(n))})`,this.TEXT_X,this.TEXT_Y)}updateGraph(e,t){if(!this.context||!this.gradient)return;e===0&&t===0&&(t=1),t=Math.max(t,e,.1),e=Math.max(e,0);const n=Math.round(this.GRAPH_X),r=Math.round(this.GRAPH_Y),s=Math.round(this.GRAPH_WIDTH),a=Math.round(this.GRAPH_HEIGHT),c=Math.round(this.PR);this.context.drawImage(this.canvas,n+c,r,s-c,a,n,r,s-c,a),this.context.fillStyle=this.bg,this.context.fillRect(n+s-c,r,c,a);const d=Math.min(a,Math.round(e/t*a));d>0&&(this.context.globalAlpha=.9,this.context.fillStyle=this.gradient,this.context.fillRect(n+s-c,r+(a-d),c,d)),this.context.globalAlpha=1}}class att extends kxe{constructor(e,t,n){super(e,t,n),this.vsyncValue=0,this.SMALL_HEIGHT=9*this.PR,this.HEIGHT=this.SMALL_HEIGHT,this.WIDTH=35*this.PR,this.TEXT_Y=0*this.PR,this.canvas.height=this.HEIGHT,this.canvas.width=this.WIDTH,this.canvas.style.height="9px",this.canvas.style.width="35px",this.canvas.style.cssText=`
            width: 35px;
            height: 9px;
            position: absolute;
            top: 0;
            left: 0;
            background-color: transparent !important;
            pointer-events: none;
        `,this.initializeCanvas()}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.context.globalAlpha=1)}update(e,t,n=0){this.context&&(this.vsyncValue=e,this.context.clearRect(0,0,this.WIDTH,this.HEIGHT),this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillText(`${e.toFixed(0)}Hz`,this.TEXT_X,this.TEXT_Y))}updateGraph(e,t){}setOffset(e,t){this.canvas.style.transform=`translate(${e}px, ${t}px)`}}const Dxe=class G_{constructor({trackGPU:e=!1,trackCPT:t=!1,trackHz:n=!1,logsPerSecond:r=4,graphsPerSecond:s=30,samplesLog:a=40,samplesGraph:c=10,precision:d=2,minimal:p=!1,horizontal:y=!0,mode:x=0}={}){this.gl=null,this.ext=null,this.activeQuery=null,this.gpuQueries=[],this.threeRendererPatched=!1,this.frameTimes=[],this.renderCount=0,this.totalCpuDuration=0,this.totalGpuDuration=0,this.totalGpuDurationCompute=0,this.gpuPanel=null,this.gpuPanelCompute=null,this.vsyncPanel=null,this.averageFps={logs:[],graph:[]},this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.averageGpuCompute={logs:[],graph:[]},this.updateCounter=0,this.lastMin={},this.lastMax={},this.lastValue={},this.VSYNC_RATES=[{refreshRate:60,frameTime:16.67},{refreshRate:75,frameTime:13.33},{refreshRate:90,frameTime:11.11},{refreshRate:120,frameTime:8.33},{refreshRate:144,frameTime:6.94},{refreshRate:165,frameTime:6.06},{refreshRate:240,frameTime:4.17}],this.detectedVSync=null,this.frameTimeHistory=[],this.HISTORY_SIZE=120,this.VSYNC_THRESHOLD=.05,this.lastFrameTime=0,this.handleClick=C=>{C.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},this.handleResize=()=>{this.resizePanel(this.fpsPanel),this.resizePanel(this.msPanel),this.gpuPanel&&this.resizePanel(this.gpuPanel),this.gpuPanelCompute&&this.resizePanel(this.gpuPanelCompute)},this.mode=x,this.horizontal=y,this.minimal=p,this.trackGPU=e,this.trackCPT=t,this.trackHz=n,this.samplesLog=a,this.samplesGraph=c,this.precision=d,this.logsPerSecond=r,this.graphsPerSecond=s;const w=performance.now();this.prevGraphTime=w,this.dom=document.createElement("div"),this.initializeDOM(),this.beginTime=performance.now(),this.prevTextTime=this.beginTime,this.prevCpuTime=this.beginTime,this._panelId=0,this.fpsPanel=this.addPanel(new G_.Panel("FPS","#0ff","#002")),this.msPanel=this.addPanel(new G_.Panel("CPU","#0f0","#020")),this.trackHz===!0&&(this.vsyncPanel=new att("","#f0f","#202"),this.dom.appendChild(this.vsyncPanel.canvas),this.vsyncPanel.setOffset(56,35)),this.setupEventListeners()}initializeDOM(){this.dom.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      opacity: 0.9;
      z-index: 10000;
      ${this.minimal?"cursor: pointer;":""}
    `}setupEventListeners(){this.minimal?(this.dom.addEventListener("click",this.handleClick),this.showPanel(this.mode)):window.addEventListener("resize",this.handleResize)}async init(e){if(!e){console.error('Stats: The "canvas" parameter is undefined.');return}if(!this.handleThreeRenderer(e)&&!await this.handleWebGPURenderer(e))if(this.initializeWebGL(e)){this.trackGPU&&this.initializeGPUTracking();return}else console.error("Stats-gl: Failed to initialize WebGL context")}handleThreeRenderer(e){return e.isWebGLRenderer&&!this.threeRendererPatched?(this.patchThreeRenderer(e),this.gl=e.getContext(),this.trackGPU&&this.initializeGPUTracking(),!0):!1}async handleWebGPURenderer(e){return e.isWebGPURenderer?((this.trackGPU||this.trackCPT)&&(e.backend.trackTimestamp=!0,await e.hasFeatureAsync("timestamp-query")&&this.initializeWebGPUPanels()),this.info=e.info,this.patchThreeWebGPU(e),!0):!1}initializeWebGPUPanels(){this.trackGPU&&(this.gpuPanel=this.addPanel(new G_.Panel("GPU","#ff0","#220"))),this.trackCPT&&(this.gpuPanelCompute=this.addPanel(new G_.Panel("CPT","#e1e1e1","#212121")))}initializeWebGL(e){if(e instanceof WebGL2RenderingContext)this.gl=e;else if(e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas){if(this.gl=e.getContext("webgl2"),!this.gl)return console.error("Stats: Unable to obtain WebGL2 context."),!1}else return console.error("Stats: Invalid input type. Expected WebGL2RenderingContext, HTMLCanvasElement, or OffscreenCanvas."),!1;return!0}initializeGPUTracking(){this.gl&&(this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new G_.Panel("GPU","#ff0","#220"))))}begin(){this.beginProfiling("cpu-started"),!(!this.gl||!this.ext)&&(this.activeQuery&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.activeQuery=this.gl.createQuery(),this.activeQuery&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery))}end(){this.renderCount++,this.gl&&this.ext&&this.activeQuery&&(this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.gpuQueries.push({query:this.activeQuery}),this.activeQuery=null),this.endProfiling("cpu-started","cpu-finished","cpu-duration")}update(){this.endProfiling("cpu-started","cpu-finished","cpu-duration"),this.info?this.processWebGPUTimestamps():this.processGpuQueries(),this.updateAverages(),this.resetCounters()}processWebGPUTimestamps(){this.totalGpuDuration=this.info.render.timestamp,this.totalGpuDurationCompute=this.info.compute.timestamp}resetCounters(){this.renderCount=0,this.totalCpuDuration=0,this.beginTime=this.endInternal()}resizePanel(e){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=e.id*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=e.id*e.HEIGHT/e.PR+"px"))}addPanel(e){return e.canvas&&(this.dom.appendChild(e.canvas),e.id=this._panelId,this.resizePanel(e),this._panelId++),e}showPanel(e){for(let t=0;t<this.dom.children.length;t++){const n=this.dom.children[t];n.style.display=t===e?"block":"none"}this.mode=e}processGpuQueries(){!this.gl||!this.ext||(this.totalGpuDuration=0,this.gpuQueries.forEach((e,t)=>{if(this.gl){const n=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),r=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT);if(n&&!r){const a=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT)*1e-6;this.totalGpuDuration+=a,this.gl.deleteQuery(e.query),this.gpuQueries.splice(t,1)}}}))}detectVSync(e){if(this.lastFrameTime===0){this.lastFrameTime=e;return}const t=e-this.lastFrameTime;if(this.lastFrameTime=e,this.frameTimeHistory.push(t),this.frameTimeHistory.length>this.HISTORY_SIZE&&this.frameTimeHistory.shift(),this.frameTimeHistory.length<60)return;const n=this.frameTimeHistory.reduce((d,p)=>d+p)/this.frameTimeHistory.length,r=this.frameTimeHistory.reduce((d,p)=>d+Math.pow(p-n,2),0)/this.frameTimeHistory.length;if(Math.sqrt(r)>2){this.detectedVSync=null;return}let a=null,c=1/0;for(const d of this.VSYNC_RATES){const p=Math.abs(n-d.frameTime);p<c&&(c=p,a=d)}a&&c/a.frameTime<=this.VSYNC_THRESHOLD?this.detectedVSync=a:this.detectedVSync=null}endInternal(){var e;const t=performance.now();for(this.frameTimes.push(t);this.frameTimes.length>0&&this.frameTimes[0]<=t-1e3;)this.frameTimes.shift();const n=Math.round(this.frameTimes.length);this.addToAverage(n,this.averageFps);const r=t>=this.prevTextTime+1e3/this.logsPerSecond,s=t>=this.prevGraphTime+1e3/this.graphsPerSecond;if(this.updatePanelComponents(this.fpsPanel,this.averageFps,0,r,s),this.updatePanelComponents(this.msPanel,this.averageCpu,this.precision,r,s),this.gpuPanel&&this.updatePanelComponents(this.gpuPanel,this.averageGpu,this.precision,r,s),this.trackCPT&&this.gpuPanelCompute&&this.updatePanelComponents(this.gpuPanelCompute,this.averageGpuCompute,this.precision,r,s),r&&(this.prevTextTime=t),s&&(this.prevGraphTime=t),this.vsyncPanel!==null){this.detectVSync(t);const a=((e=this.detectedVSync)==null?void 0:e.refreshRate)||0;r&&a>0&&this.vsyncPanel.update(a,a)}return t}updatePanelComponents(e,t,n,r,s){if(!e||t.logs.length===0)return;e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const a=t.logs[t.logs.length-1];this.lastMax[e.name]=Math.max(...t.logs),this.lastMin[e.name]=Math.min(this.lastMin[e.name],a),this.lastValue[e.name]=this.lastValue[e.name]*.7+a*.3;const c=Math.max(Math.max(...t.logs),...t.graph.slice(-this.samplesGraph));this.updateCounter++,r&&e.update(this.lastValue[e.name],this.lastMax[e.name],n),s&&e.updateGraph(a,c)}beginProfiling(e){if(window.performance)try{window.performance.clearMarks(e),window.performance.mark(e)}catch(t){console.debug("Stats: Performance marking failed:",t)}}endProfiling(e,t,n){if(!(!window.performance||!t||!e))try{window.performance.getEntriesByName(e,"mark").length===0&&this.beginProfiling(e),window.performance.clearMarks(t),window.performance.mark(t),window.performance.clearMeasures(n);const s=performance.measure(n,e,t);this.totalCpuDuration+=s.duration,window.performance.clearMarks(e),window.performance.clearMarks(t),window.performance.clearMeasures(n)}catch(r){console.debug("Stats: Performance measurement failed:",r)}}updatePanel(e,t,n=2){if(!e||t.logs.length===0)return;const r=performance.now();e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const s=t.logs[t.logs.length-1],a=Math.max(...t.logs.slice(-30));this.lastMin[e.name]=Math.min(this.lastMin[e.name],s),this.lastMax[e.name]=Math.max(this.lastMax[e.name],s),this.lastValue[e.name]=this.lastValue[e.name]*.7+s*.3;const c=Math.max(a,...t.graph.slice(-this.samplesGraph));this.updateCounter++,this.updateCounter%(this.logsPerSecond*2)===0&&(this.lastMax[e.name]=a,this.lastMin[e.name]=s),e.update&&(r>=this.prevCpuTime+1e3/this.logsPerSecond&&e.update(this.lastValue[e.name],s,this.lastMax[e.name],c,n),r>=this.prevGraphTime+1e3/this.graphsPerSecond&&(e.updateGraph(s,c),this.prevGraphTime=r))}updateAverages(){this.addToAverage(this.totalCpuDuration,this.averageCpu),this.addToAverage(this.totalGpuDuration,this.averageGpu),this.info&&this.totalGpuDurationCompute!==void 0&&this.addToAverage(this.totalGpuDurationCompute,this.averageGpuCompute)}addToAverage(e,t){t.logs.push(e),t.logs.length>this.samplesLog&&(t.logs=t.logs.slice(-this.samplesLog)),t.graph.push(e),t.graph.length>this.samplesGraph&&(t.graph=t.graph.slice(-this.samplesGraph))}get domElement(){return this.dom}patchThreeWebGPU(e){const t=e.info.reset,n=this;e.info.reset=function(){n.beginProfiling("cpu-started"),t.call(this)}}patchThreeRenderer(e){const t=e.render,n=this;e.render=function(r,s){n.begin(),t.call(this,r,s),n.end()},this.threeRendererPatched=!0}};Dxe.Panel=kxe;let ltt=Dxe,$1,Eo,n4="",Cve=!1;function ctt(i){const e=i.app,t=Nn.useRef(null),n=i.app.components.get("three");console.log("Settings",e.settings),e.isApp&&Nn.useEffect(()=>{const d=t.current;$1=new JN({canvas:d,stencil:!1}),$1.shadowMap.enabled=!0,$1.setPixelRatio(devicePixelRatio),$1.setClearColor(0),n.setRenderer($1,d),$1.init().then(()=>{Cve=!0});const p=new ltt;p.init($1),document.body.appendChild(p.dom);let y=-1;const x=()=>{const C=window.innerWidth,N=window.innerHeight;Eo==null||Eo.resize(C,N),$1.setSize(C,N)},w=()=>{Cve&&(Eo==null||Eo.update(),Eo==null||Eo.draw()),p.update(),y=requestAnimationFrame(w)};return window.addEventListener("resize",x),x(),w(),()=>{Eo!==void 0&&(n.removeCamera(Eo.camera),n.removeScene(Eo),Mh(Eo)),window.removeEventListener("resize",x),cancelAnimationFrame(y),y=-1,$1.dispose()}},[]);const r=()=>{Eo!==void 0&&(Eo.camera!==void 0&&n.removeCamera(Eo.camera),n.removeScene(Eo),Mh(Eo),itt(n)),n4==="scene1"?Eo=new Pxe:n4==="scene2"?Eo=new Ixe:Eo=new Nxe,Eo.setup(e,$1),Eo.init(),Eo.resize(window.innerWidth,window.innerHeight)},s=()=>{n4!=="scene1"&&(n4="scene1",r())},a=()=>{n4!=="scene2"&&(n4="scene2",r())},c=()=>{n4!=="scene3"&&(n4="scene3",r())};return rt.jsx(rt.Fragment,{children:e.isApp&&rt.jsxs(rt.Fragment,{children:[rt.jsx("canvas",{ref:t}),rt.jsxs("div",{style:{position:"absolute",bottom:"20px",left:"20px"},children:[rt.jsx("button",{onClick:s,children:"Scene 1"}),rt.jsx("button",{onClick:a,children:"Scene 2"}),rt.jsx("button",{onClick:c,children:"Scene 3"})]})]})})}function utt(i){const[e,t]=Nn.useState(!1);return Nn.useEffect(()=>{const n=()=>{VH.removeEventListener(ok.LOAD_COMPLETE,n),t(!0)};VH.addEventListener(ok.LOAD_COMPLETE,n),ttt(i.app)},[t]),rt.jsxs(rt.Fragment,{children:[!e&&rt.jsx("p",{children:"Loading..."}),e&&i.app.isApp&&rt.jsx(ctt,{app:i.app})]})}function dtt(){const[i,e]=Nn.useState(null);return Nn.useEffect(()=>{const t=new IBe;t.detectSettings(cj,uj).then(()=>{t.addComponent("theatre",new FBe(cj,uj));const n=new jBe("Hermes Example",cj,uj);t.addComponent("three",n),e(t)})},[]),rt.jsx(rt.Fragment,{children:i!==null&&rt.jsxs(rt.Fragment,{children:[i.debugEnabled&&rt.jsx(HBe,{app:i}),i.editor&&rt.jsx(ott,{app:i}),rt.jsx(utt,{app:i})]})})}Rve.initialize();eNe.createRoot(document.getElementById("root")).render(rt.jsx(rt.Fragment,{children:rt.jsx(rt.Fragment,{children:rt.jsx(dtt,{})})}));
