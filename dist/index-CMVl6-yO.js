var iTe=Object.defineProperty;var sTe=(s,e,t)=>e in s?iTe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Qe=(s,e,t)=>sTe(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var xa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function h9e(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var fz={exports:{}},fw={},pz={exports:{}},wi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bpe;function aTe(){if(Bpe)return wi;Bpe=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function S(De){return De===null||typeof De!="object"?null:(De=x&&De[x]||De["@@iterator"],typeof De=="function"?De:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,L={};function U(De,_t,Jt){this.props=De,this.context=_t,this.refs=L,this.updater=Jt||A}U.prototype.isReactComponent={},U.prototype.setState=function(De,_t){if(typeof De!="object"&&typeof De!="function"&&De!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,De,_t,"setState")},U.prototype.forceUpdate=function(De){this.updater.enqueueForceUpdate(this,De,"forceUpdate")};function P(){}P.prototype=U.prototype;function $(De,_t,Jt){this.props=De,this.context=_t,this.refs=L,this.updater=Jt||A}var Z=$.prototype=new P;Z.constructor=$,k(Z,U.prototype),Z.isPureReactComponent=!0;var I=Array.isArray,ie=Object.prototype.hasOwnProperty,ce={current:null},ue={key:!0,ref:!0,__self:!0,__source:!0};function Q(De,_t,Jt){var dt,Dt={},gn=null,qt=null;if(_t!=null)for(dt in _t.ref!==void 0&&(qt=_t.ref),_t.key!==void 0&&(gn=""+_t.key),_t)ie.call(_t,dt)&&!ue.hasOwnProperty(dt)&&(Dt[dt]=_t[dt]);var wn=arguments.length-2;if(wn===1)Dt.children=Jt;else if(1<wn){for(var rr=Array(wn),Xn=0;Xn<wn;Xn++)rr[Xn]=arguments[Xn+2];Dt.children=rr}if(De&&De.defaultProps)for(dt in wn=De.defaultProps,wn)Dt[dt]===void 0&&(Dt[dt]=wn[dt]);return{$$typeof:s,type:De,key:gn,ref:qt,props:Dt,_owner:ce.current}}function oe(De,_t){return{$$typeof:s,type:De.type,key:_t,ref:De.ref,props:De.props,_owner:De._owner}}function le(De){return typeof De=="object"&&De!==null&&De.$$typeof===s}function J(De){var _t={"=":"=0",":":"=2"};return"$"+De.replace(/[=:]/g,function(Jt){return _t[Jt]})}var Be=/\/+/g;function He(De,_t){return typeof De=="object"&&De!==null&&De.key!=null?J(""+De.key):_t.toString(36)}function rt(De,_t,Jt,dt,Dt){var gn=typeof De;(gn==="undefined"||gn==="boolean")&&(De=null);var qt=!1;if(De===null)qt=!0;else switch(gn){case"string":case"number":qt=!0;break;case"object":switch(De.$$typeof){case s:case e:qt=!0}}if(qt)return qt=De,Dt=Dt(qt),De=dt===""?"."+He(qt,0):dt,I(Dt)?(Jt="",De!=null&&(Jt=De.replace(Be,"$&/")+"/"),rt(Dt,_t,Jt,"",function(Xn){return Xn})):Dt!=null&&(le(Dt)&&(Dt=oe(Dt,Jt+(!Dt.key||qt&&qt.key===Dt.key?"":(""+Dt.key).replace(Be,"$&/")+"/")+De)),_t.push(Dt)),1;if(qt=0,dt=dt===""?".":dt+":",I(De))for(var wn=0;wn<De.length;wn++){gn=De[wn];var rr=dt+He(gn,wn);qt+=rt(gn,_t,Jt,rr,Dt)}else if(rr=S(De),typeof rr=="function")for(De=rr.call(De),wn=0;!(gn=De.next()).done;)gn=gn.value,rr=dt+He(gn,wn++),qt+=rt(gn,_t,Jt,rr,Dt);else if(gn==="object")throw _t=String(De),Error("Objects are not valid as a React child (found: "+(_t==="[object Object]"?"object with keys {"+Object.keys(De).join(", ")+"}":_t)+"). If you meant to render a collection of children, use an array instead.");return qt}function ot(De,_t,Jt){if(De==null)return De;var dt=[],Dt=0;return rt(De,dt,"","",function(gn){return _t.call(Jt,gn,Dt++)}),dt}function Se(De){if(De._status===-1){var _t=De._result;_t=_t(),_t.then(function(Jt){(De._status===0||De._status===-1)&&(De._status=1,De._result=Jt)},function(Jt){(De._status===0||De._status===-1)&&(De._status=2,De._result=Jt)}),De._status===-1&&(De._status=0,De._result=_t)}if(De._status===1)return De._result.default;throw De._result}var gt={current:null},Ae={transition:null},lt={ReactCurrentDispatcher:gt,ReactCurrentBatchConfig:Ae,ReactCurrentOwner:ce};function pt(){throw Error("act(...) is not supported in production builds of React.")}return wi.Children={map:ot,forEach:function(De,_t,Jt){ot(De,function(){_t.apply(this,arguments)},Jt)},count:function(De){var _t=0;return ot(De,function(){_t++}),_t},toArray:function(De){return ot(De,function(_t){return _t})||[]},only:function(De){if(!le(De))throw Error("React.Children.only expected to receive a single React element child.");return De}},wi.Component=U,wi.Fragment=t,wi.Profiler=r,wi.PureComponent=$,wi.StrictMode=n,wi.Suspense=h,wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lt,wi.act=pt,wi.cloneElement=function(De,_t,Jt){if(De==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+De+".");var dt=k({},De.props),Dt=De.key,gn=De.ref,qt=De._owner;if(_t!=null){if(_t.ref!==void 0&&(gn=_t.ref,qt=ce.current),_t.key!==void 0&&(Dt=""+_t.key),De.type&&De.type.defaultProps)var wn=De.type.defaultProps;for(rr in _t)ie.call(_t,rr)&&!ue.hasOwnProperty(rr)&&(dt[rr]=_t[rr]===void 0&&wn!==void 0?wn[rr]:_t[rr])}var rr=arguments.length-2;if(rr===1)dt.children=Jt;else if(1<rr){wn=Array(rr);for(var Xn=0;Xn<rr;Xn++)wn[Xn]=arguments[Xn+2];dt.children=wn}return{$$typeof:s,type:De.type,key:Dt,ref:gn,props:dt,_owner:qt}},wi.createContext=function(De){return De={$$typeof:o,_currentValue:De,_currentValue2:De,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},De.Provider={$$typeof:i,_context:De},De.Consumer=De},wi.createElement=Q,wi.createFactory=function(De){var _t=Q.bind(null,De);return _t.type=De,_t},wi.createRef=function(){return{current:null}},wi.forwardRef=function(De){return{$$typeof:l,render:De}},wi.isValidElement=le,wi.lazy=function(De){return{$$typeof:y,_payload:{_status:-1,_result:De},_init:Se}},wi.memo=function(De,_t){return{$$typeof:p,type:De,compare:_t===void 0?null:_t}},wi.startTransition=function(De){var _t=Ae.transition;Ae.transition={};try{De()}finally{Ae.transition=_t}},wi.unstable_act=pt,wi.useCallback=function(De,_t){return gt.current.useCallback(De,_t)},wi.useContext=function(De){return gt.current.useContext(De)},wi.useDebugValue=function(){},wi.useDeferredValue=function(De){return gt.current.useDeferredValue(De)},wi.useEffect=function(De,_t){return gt.current.useEffect(De,_t)},wi.useId=function(){return gt.current.useId()},wi.useImperativeHandle=function(De,_t,Jt){return gt.current.useImperativeHandle(De,_t,Jt)},wi.useInsertionEffect=function(De,_t){return gt.current.useInsertionEffect(De,_t)},wi.useLayoutEffect=function(De,_t){return gt.current.useLayoutEffect(De,_t)},wi.useMemo=function(De,_t){return gt.current.useMemo(De,_t)},wi.useReducer=function(De,_t,Jt){return gt.current.useReducer(De,_t,Jt)},wi.useRef=function(De){return gt.current.useRef(De)},wi.useState=function(De){return gt.current.useState(De)},wi.useSyncExternalStore=function(De,_t,Jt){return gt.current.useSyncExternalStore(De,_t,Jt)},wi.useTransition=function(){return gt.current.useTransition()},wi.version="18.3.1",wi}var zpe;function Sj(){return zpe||(zpe=1,pz.exports=aTe()),pz.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vpe;function oTe(){if(Vpe)return fw;Vpe=1;var s=Sj(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(l,h,p){var y,x={},S=null,A=null;p!==void 0&&(S=""+p),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(A=h.ref);for(y in h)n.call(h,y)&&!i.hasOwnProperty(y)&&(x[y]=h[y]);if(l&&l.defaultProps)for(y in h=l.defaultProps,h)x[y]===void 0&&(x[y]=h[y]);return{$$typeof:e,type:l,key:S,ref:A,props:x,_owner:r.current}}return fw.Fragment=t,fw.jsx=o,fw.jsxs=o,fw}var Gpe;function lTe(){return Gpe||(Gpe=1,fz.exports=oTe()),fz.exports}var et=lTe(),Fn=Sj(),JP={},mz={exports:{}},Tu={},gz={exports:{}},vz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hpe;function uTe(){return Hpe||(Hpe=1,function(s){function e(Ae,lt){var pt=Ae.length;Ae.push(lt);e:for(;0<pt;){var De=pt-1>>>1,_t=Ae[De];if(0<r(_t,lt))Ae[De]=lt,Ae[pt]=_t,pt=De;else break e}}function t(Ae){return Ae.length===0?null:Ae[0]}function n(Ae){if(Ae.length===0)return null;var lt=Ae[0],pt=Ae.pop();if(pt!==lt){Ae[0]=pt;e:for(var De=0,_t=Ae.length,Jt=_t>>>1;De<Jt;){var dt=2*(De+1)-1,Dt=Ae[dt],gn=dt+1,qt=Ae[gn];if(0>r(Dt,pt))gn<_t&&0>r(qt,Dt)?(Ae[De]=qt,Ae[gn]=pt,De=gn):(Ae[De]=Dt,Ae[dt]=pt,De=dt);else if(gn<_t&&0>r(qt,pt))Ae[De]=qt,Ae[gn]=pt,De=gn;else break e}}return lt}function r(Ae,lt){var pt=Ae.sortIndex-lt.sortIndex;return pt!==0?pt:Ae.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;s.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();s.unstable_now=function(){return o.now()-l}}var h=[],p=[],y=1,x=null,S=3,A=!1,k=!1,L=!1,U=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Z(Ae){for(var lt=t(p);lt!==null;){if(lt.callback===null)n(p);else if(lt.startTime<=Ae)n(p),lt.sortIndex=lt.expirationTime,e(h,lt);else break;lt=t(p)}}function I(Ae){if(L=!1,Z(Ae),!k)if(t(h)!==null)k=!0,Se(ie);else{var lt=t(p);lt!==null&&gt(I,lt.startTime-Ae)}}function ie(Ae,lt){k=!1,L&&(L=!1,P(Q),Q=-1),A=!0;var pt=S;try{for(Z(lt),x=t(h);x!==null&&(!(x.expirationTime>lt)||Ae&&!J());){var De=x.callback;if(typeof De=="function"){x.callback=null,S=x.priorityLevel;var _t=De(x.expirationTime<=lt);lt=s.unstable_now(),typeof _t=="function"?x.callback=_t:x===t(h)&&n(h),Z(lt)}else n(h);x=t(h)}if(x!==null)var Jt=!0;else{var dt=t(p);dt!==null&&gt(I,dt.startTime-lt),Jt=!1}return Jt}finally{x=null,S=pt,A=!1}}var ce=!1,ue=null,Q=-1,oe=5,le=-1;function J(){return!(s.unstable_now()-le<oe)}function Be(){if(ue!==null){var Ae=s.unstable_now();le=Ae;var lt=!0;try{lt=ue(!0,Ae)}finally{lt?He():(ce=!1,ue=null)}}else ce=!1}var He;if(typeof $=="function")He=function(){$(Be)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,ot=rt.port2;rt.port1.onmessage=Be,He=function(){ot.postMessage(null)}}else He=function(){U(Be,0)};function Se(Ae){ue=Ae,ce||(ce=!0,He())}function gt(Ae,lt){Q=U(function(){Ae(s.unstable_now())},lt)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Ae){Ae.callback=null},s.unstable_continueExecution=function(){k||A||(k=!0,Se(ie))},s.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):oe=0<Ae?Math.floor(1e3/Ae):5},s.unstable_getCurrentPriorityLevel=function(){return S},s.unstable_getFirstCallbackNode=function(){return t(h)},s.unstable_next=function(Ae){switch(S){case 1:case 2:case 3:var lt=3;break;default:lt=S}var pt=S;S=lt;try{return Ae()}finally{S=pt}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Ae,lt){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var pt=S;S=Ae;try{return lt()}finally{S=pt}},s.unstable_scheduleCallback=function(Ae,lt,pt){var De=s.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?De+pt:De):pt=De,Ae){case 1:var _t=-1;break;case 2:_t=250;break;case 5:_t=1073741823;break;case 4:_t=1e4;break;default:_t=5e3}return _t=pt+_t,Ae={id:y++,callback:lt,priorityLevel:Ae,startTime:pt,expirationTime:_t,sortIndex:-1},pt>De?(Ae.sortIndex=pt,e(p,Ae),t(h)===null&&Ae===t(p)&&(L?(P(Q),Q=-1):L=!0,gt(I,pt-De))):(Ae.sortIndex=_t,e(h,Ae),k||A||(k=!0,Se(ie))),Ae},s.unstable_shouldYield=J,s.unstable_wrapCallback=function(Ae){var lt=S;return function(){var pt=S;S=lt;try{return Ae.apply(this,arguments)}finally{S=pt}}}}(vz)),vz}var jpe;function cTe(){return jpe||(jpe=1,gz.exports=uTe()),gz.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wpe;function hTe(){if(Wpe)return Tu;Wpe=1;var s=Sj(),e=cTe();function t(d){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+d,M=1;M<arguments.length;M++)g+="&args[]="+encodeURIComponent(arguments[M]);return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function i(d,g){o(d,g),o(d+"Capture",g)}function o(d,g){for(r[d]=g,d=0;d<g.length;d++)n.add(g[d])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},x={};function S(d){return h.call(x,d)?!0:h.call(y,d)?!1:p.test(d)?x[d]=!0:(y[d]=!0,!1)}function A(d,g,M,O){if(M!==null&&M.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return O?!1:M!==null?!M.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function k(d,g,M,O){if(g===null||typeof g>"u"||A(d,g,M,O))return!0;if(O)return!1;if(M!==null)switch(M.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function L(d,g,M,O,q,ee,ge){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=O,this.attributeNamespace=q,this.mustUseProperty=M,this.propertyName=d,this.type=g,this.sanitizeURL=ee,this.removeEmptyString=ge}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){U[d]=new L(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var g=d[0];U[g]=new L(g,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){U[d]=new L(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){U[d]=new L(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){U[d]=new L(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){U[d]=new L(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){U[d]=new L(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){U[d]=new L(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){U[d]=new L(d,5,!1,d.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function $(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var g=d.replace(P,$);U[g]=new L(g,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var g=d.replace(P,$);U[g]=new L(g,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var g=d.replace(P,$);U[g]=new L(g,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){U[d]=new L(d,1,!1,d.toLowerCase(),null,!1,!1)}),U.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){U[d]=new L(d,1,!1,d.toLowerCase(),null,!0,!0)});function Z(d,g,M,O){var q=U.hasOwnProperty(g)?U[g]:null;(q!==null?q.type!==0:O||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(k(g,M,q,O)&&(M=null),O||q===null?S(g)&&(M===null?d.removeAttribute(g):d.setAttribute(g,""+M)):q.mustUseProperty?d[q.propertyName]=M===null?q.type===3?!1:"":M:(g=q.attributeName,O=q.attributeNamespace,M===null?d.removeAttribute(g):(q=q.type,M=q===3||q===4&&M===!0?"":""+M,O?d.setAttributeNS(O,g,M):d.setAttribute(g,M))))}var I=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ie=Symbol.for("react.element"),ce=Symbol.for("react.portal"),ue=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),oe=Symbol.for("react.profiler"),le=Symbol.for("react.provider"),J=Symbol.for("react.context"),Be=Symbol.for("react.forward_ref"),He=Symbol.for("react.suspense"),rt=Symbol.for("react.suspense_list"),ot=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),gt=Symbol.for("react.offscreen"),Ae=Symbol.iterator;function lt(d){return d===null||typeof d!="object"?null:(d=Ae&&d[Ae]||d["@@iterator"],typeof d=="function"?d:null)}var pt=Object.assign,De;function _t(d){if(De===void 0)try{throw Error()}catch(M){var g=M.stack.trim().match(/\n( *(at )?)/);De=g&&g[1]||""}return`
`+De+d}var Jt=!1;function dt(d,g){if(!d||Jt)return"";Jt=!0;var M=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Ot){var O=Ot}Reflect.construct(d,[],g)}else{try{g.call()}catch(Ot){O=Ot}d.call(g.prototype)}else{try{throw Error()}catch(Ot){O=Ot}d()}}catch(Ot){if(Ot&&O&&typeof Ot.stack=="string"){for(var q=Ot.stack.split(`
`),ee=O.stack.split(`
`),ge=q.length-1,Fe=ee.length-1;1<=ge&&0<=Fe&&q[ge]!==ee[Fe];)Fe--;for(;1<=ge&&0<=Fe;ge--,Fe--)if(q[ge]!==ee[Fe]){if(ge!==1||Fe!==1)do if(ge--,Fe--,0>Fe||q[ge]!==ee[Fe]){var Xe=`
`+q[ge].replace(" at new "," at ");return d.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",d.displayName)),Xe}while(1<=ge&&0<=Fe);break}}}finally{Jt=!1,Error.prepareStackTrace=M}return(d=d?d.displayName||d.name:"")?_t(d):""}function Dt(d){switch(d.tag){case 5:return _t(d.type);case 16:return _t("Lazy");case 13:return _t("Suspense");case 19:return _t("SuspenseList");case 0:case 2:case 15:return d=dt(d.type,!1),d;case 11:return d=dt(d.type.render,!1),d;case 1:return d=dt(d.type,!0),d;default:return""}}function gn(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case ue:return"Fragment";case ce:return"Portal";case oe:return"Profiler";case Q:return"StrictMode";case He:return"Suspense";case rt:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case J:return(d.displayName||"Context")+".Consumer";case le:return(d._context.displayName||"Context")+".Provider";case Be:var g=d.render;return d=d.displayName,d||(d=g.displayName||g.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case ot:return g=d.displayName||null,g!==null?g:gn(d.type)||"Memo";case Se:g=d._payload,d=d._init;try{return gn(d(g))}catch{}}return null}function qt(d){var g=d.type;switch(d.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=g.render,d=d.displayName||d.name||"",g.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gn(g);case 8:return g===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function wn(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function rr(d){var g=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Xn(d){var g=rr(d)?"checked":"value",M=Object.getOwnPropertyDescriptor(d.constructor.prototype,g),O=""+d[g];if(!d.hasOwnProperty(g)&&typeof M<"u"&&typeof M.get=="function"&&typeof M.set=="function"){var q=M.get,ee=M.set;return Object.defineProperty(d,g,{configurable:!0,get:function(){return q.call(this)},set:function(ge){O=""+ge,ee.call(this,ge)}}),Object.defineProperty(d,g,{enumerable:M.enumerable}),{getValue:function(){return O},setValue:function(ge){O=""+ge},stopTracking:function(){d._valueTracker=null,delete d[g]}}}}function ni(d){d._valueTracker||(d._valueTracker=Xn(d))}function oi(d){if(!d)return!1;var g=d._valueTracker;if(!g)return!0;var M=g.getValue(),O="";return d&&(O=rr(d)?d.checked?"true":"false":d.value),d=O,d!==M?(g.setValue(d),!0):!1}function $r(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function $e(d,g){var M=g.checked;return pt({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:M??d._wrapperState.initialChecked})}function zs(d,g){var M=g.defaultValue==null?"":g.defaultValue,O=g.checked!=null?g.checked:g.defaultChecked;M=wn(g.value!=null?g.value:M),d._wrapperState={initialChecked:O,initialValue:M,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function li(d,g){g=g.checked,g!=null&&Z(d,"checked",g,!1)}function Ci(d,g){li(d,g);var M=wn(g.value),O=g.type;if(M!=null)O==="number"?(M===0&&d.value===""||d.value!=M)&&(d.value=""+M):d.value!==""+M&&(d.value=""+M);else if(O==="submit"||O==="reset"){d.removeAttribute("value");return}g.hasOwnProperty("value")?Ar(d,g.type,M):g.hasOwnProperty("defaultValue")&&Ar(d,g.type,wn(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(d.defaultChecked=!!g.defaultChecked)}function Ln(d,g,M){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var O=g.type;if(!(O!=="submit"&&O!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+d._wrapperState.initialValue,M||g===d.value||(d.value=g),d.defaultValue=g}M=d.name,M!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,M!==""&&(d.name=M)}function Ar(d,g,M){(g!=="number"||$r(d.ownerDocument)!==d)&&(M==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+M&&(d.defaultValue=""+M))}var ar=Array.isArray;function fr(d,g,M,O){if(d=d.options,g){g={};for(var q=0;q<M.length;q++)g["$"+M[q]]=!0;for(M=0;M<d.length;M++)q=g.hasOwnProperty("$"+d[M].value),d[M].selected!==q&&(d[M].selected=q),q&&O&&(d[M].defaultSelected=!0)}else{for(M=""+wn(M),g=null,q=0;q<d.length;q++){if(d[q].value===M){d[q].selected=!0,O&&(d[q].defaultSelected=!0);return}g!==null||d[q].disabled||(g=d[q])}g!==null&&(g.selected=!0)}}function gi(d,g){if(g.dangerouslySetInnerHTML!=null)throw Error(t(91));return pt({},g,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Oe(d,g){var M=g.value;if(M==null){if(M=g.children,g=g.defaultValue,M!=null){if(g!=null)throw Error(t(92));if(ar(M)){if(1<M.length)throw Error(t(93));M=M[0]}g=M}g==null&&(g=""),M=g}d._wrapperState={initialValue:wn(M)}}function _e(d,g){var M=wn(g.value),O=wn(g.defaultValue);M!=null&&(M=""+M,M!==d.value&&(d.value=M),g.defaultValue==null&&d.defaultValue!==M&&(d.defaultValue=M)),O!=null&&(d.defaultValue=""+O)}function Ct(d){var g=d.textContent;g===d._wrapperState.initialValue&&g!==""&&g!==null&&(d.value=g)}function Kt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zt(d,g){return d==null||d==="http://www.w3.org/1999/xhtml"?Kt(g):d==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var Ht,or=function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,M,O,q){MSApp.execUnsafeLocalFunction(function(){return d(g,M,O,q)})}:d}(function(d,g){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=g;else{for(Ht=Ht||document.createElement("div"),Ht.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=Ht.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;g.firstChild;)d.appendChild(g.firstChild)}});function An(d,g){if(g){var M=d.firstChild;if(M&&M===d.lastChild&&M.nodeType===3){M.nodeValue=g;return}}d.textContent=g}var Hn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lr=["Webkit","ms","Moz","O"];Object.keys(Hn).forEach(function(d){lr.forEach(function(g){g=g+d.charAt(0).toUpperCase()+d.substring(1),Hn[g]=Hn[d]})});function Qt(d,g,M){return g==null||typeof g=="boolean"||g===""?"":M||typeof g!="number"||g===0||Hn.hasOwnProperty(d)&&Hn[d]?(""+g).trim():g+"px"}function jn(d,g){d=d.style;for(var M in g)if(g.hasOwnProperty(M)){var O=M.indexOf("--")===0,q=Qt(M,g[M],O);M==="float"&&(M="cssFloat"),O?d.setProperty(M,q):d[M]=q}}var Mr=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gr(d,g){if(g){if(Mr[d]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(t(137,d));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(t(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(t(61))}if(g.style!=null&&typeof g.style!="object")throw Error(t(62))}}function Pn(d,g){if(d.indexOf("-")===-1)return typeof g.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sr=null;function Ze(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Tn=null,nn=null,kn=null;function ln(d){if(d=hd(d)){if(typeof Tn!="function")throw Error(t(280));var g=d.stateNode;g&&(g=g2(g),Tn(d.stateNode,d.type,g))}}function en(d){nn?kn?kn.push(d):kn=[d]:nn=d}function Yn(){if(nn){var d=nn,g=kn;if(kn=nn=null,ln(d),g)for(d=0;d<g.length;d++)ln(g[d])}}function br(d,g){return d(g)}function xi(){}var Kr=!1;function Vs(d,g,M){if(Kr)return d(g,M);Kr=!0;try{return br(d,g,M)}finally{Kr=!1,(nn!==null||kn!==null)&&(xi(),Yn())}}function la(d,g){var M=d.stateNode;if(M===null)return null;var O=g2(M);if(O===null)return null;M=O[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(d=d.type,O=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!O;break e;default:d=!1}if(d)return null;if(M&&typeof M!="function")throw Error(t(231,g,typeof M));return M}var Fu=!1;if(l)try{var Ps={};Object.defineProperty(Ps,"passive",{get:function(){Fu=!0}}),window.addEventListener("test",Ps,Ps),window.removeEventListener("test",Ps,Ps)}catch{Fu=!1}function Gs(d,g,M,O,q,ee,ge,Fe,Xe){var Ot=Array.prototype.slice.call(arguments,3);try{g.apply(M,Ot)}catch(an){this.onError(an)}}var _0=!1,$l=null,tl=!1,ka=null,Lc={onError:function(d){_0=!0,$l=d}};function Uc(d,g,M,O,q,ee,ge,Fe,Xe){_0=!1,$l=null,Gs.apply(Lc,arguments)}function Pf(d,g,M,O,q,ee,ge,Fe,Xe){if(Uc.apply(this,arguments),_0){if(_0){var Ot=$l;_0=!1,$l=null}else throw Error(t(198));tl||(tl=!0,ka=Ot)}}function ua(d){var g=d,M=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,(g.flags&4098)!==0&&(M=g.return),d=g.return;while(d)}return g.tag===3?M:null}function Xh(d){if(d.tag===13){var g=d.memoizedState;if(g===null&&(d=d.alternate,d!==null&&(g=d.memoizedState)),g!==null)return g.dehydrated}return null}function ql(d){if(ua(d)!==d)throw Error(t(188))}function Bc(d){var g=d.alternate;if(!g){if(g=ua(d),g===null)throw Error(t(188));return g!==d?null:d}for(var M=d,O=g;;){var q=M.return;if(q===null)break;var ee=q.alternate;if(ee===null){if(O=q.return,O!==null){M=O;continue}break}if(q.child===ee.child){for(ee=q.child;ee;){if(ee===M)return ql(q),d;if(ee===O)return ql(q),g;ee=ee.sibling}throw Error(t(188))}if(M.return!==O.return)M=q,O=ee;else{for(var ge=!1,Fe=q.child;Fe;){if(Fe===M){ge=!0,M=q,O=ee;break}if(Fe===O){ge=!0,O=q,M=ee;break}Fe=Fe.sibling}if(!ge){for(Fe=ee.child;Fe;){if(Fe===M){ge=!0,M=ee,O=q;break}if(Fe===O){ge=!0,O=ee,M=q;break}Fe=Fe.sibling}if(!ge)throw Error(t(189))}}if(M.alternate!==O)throw Error(t(190))}if(M.tag!==3)throw Error(t(188));return M.stateNode.current===M?d:g}function Yh(d){return d=Bc(d),d!==null?Kh(d):null}function Kh(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var g=Kh(d);if(g!==null)return g;d=d.sibling}return null}var Rf=e.unstable_scheduleCallback,we=e.unstable_cancelCallback,st=e.unstable_shouldYield,Pt=e.unstable_requestPaint,bt=e.unstable_now,ht=e.unstable_getCurrentPriorityLevel,vn=e.unstable_ImmediatePriority,Dn=e.unstable_UserBlockingPriority,Bn=e.unstable_NormalPriority,Wn=e.unstable_LowPriority,ur=e.unstable_IdlePriority,vr=null,Kn=null;function Fr(d){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(vr,d,void 0,(d.current.flags&128)===128)}catch{}}var Lr=Math.clz32?Math.clz32:ri,Di=Math.log,Zi=Math.LN2;function ri(d){return d>>>=0,d===0?32:31-(Di(d)/Zi|0)|0}var er=64,Qi=4194304;function Zr(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function Rs(d,g){var M=d.pendingLanes;if(M===0)return 0;var O=0,q=d.suspendedLanes,ee=d.pingedLanes,ge=M&268435455;if(ge!==0){var Fe=ge&~q;Fe!==0?O=Zr(Fe):(ee&=ge,ee!==0&&(O=Zr(ee)))}else ge=M&~q,ge!==0?O=Zr(ge):ee!==0&&(O=Zr(ee));if(O===0)return 0;if(g!==0&&g!==O&&(g&q)===0&&(q=O&-O,ee=g&-g,q>=ee||q===16&&(ee&4194240)!==0))return g;if((O&4)!==0&&(O|=M&16),g=d.entangledLanes,g!==0)for(d=d.entanglements,g&=O;0<g;)M=31-Lr(g),q=1<<M,O|=d[M],g&=~q;return O}function qo(d,g){switch(d){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Na(d,g){for(var M=d.suspendedLanes,O=d.pingedLanes,q=d.expirationTimes,ee=d.pendingLanes;0<ee;){var ge=31-Lr(ee),Fe=1<<ge,Xe=q[ge];Xe===-1?((Fe&M)===0||(Fe&O)!==0)&&(q[ge]=qo(Fe,g)):Xe<=g&&(d.expiredLanes|=Fe),ee&=~Fe}}function x0(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Oi(){var d=er;return er<<=1,(er&4194240)===0&&(er=64),d}function gs(d){for(var g=[],M=0;31>M;M++)g.push(d);return g}function Is(d,g,M){d.pendingLanes|=g,g!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,g=31-Lr(g),d[g]=M}function Hs(d,g){var M=d.pendingLanes&~g;d.pendingLanes=g,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=g,d.mutableReadLanes&=g,d.entangledLanes&=g,g=d.entanglements;var O=d.eventTimes;for(d=d.expirationTimes;0<M;){var q=31-Lr(M),ee=1<<q;g[q]=0,O[q]=-1,d[q]=-1,M&=~ee}}function ws(d,g){var M=d.entangledLanes|=g;for(d=d.entanglements;M;){var O=31-Lr(M),q=1<<O;q&g|d[O]&g&&(d[O]|=g),M&=~q}}var hi=0;function ra(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Zh,m1,Xl,g1,jg,v1=!1,Qh=[],nl=null,js=null,b0=null,zc=new Map,Vc=new Map,rl=[],Wg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function y1(d,g){switch(d){case"focusin":case"focusout":nl=null;break;case"dragenter":case"dragleave":js=null;break;case"mouseover":case"mouseout":b0=null;break;case"pointerover":case"pointerout":zc.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vc.delete(g.pointerId)}}function Gc(d,g,M,O,q,ee){return d===null||d.nativeEvent!==ee?(d={blockedOn:g,domEventName:M,eventSystemFlags:O,nativeEvent:ee,targetContainers:[q]},g!==null&&(g=hd(g),g!==null&&m1(g)),d):(d.eventSystemFlags|=O,g=d.targetContainers,q!==null&&g.indexOf(q)===-1&&g.push(q),d)}function $g(d,g,M,O,q){switch(g){case"focusin":return nl=Gc(nl,d,g,M,O,q),!0;case"dragenter":return js=Gc(js,d,g,M,O,q),!0;case"mouseover":return b0=Gc(b0,d,g,M,O,q),!0;case"pointerover":var ee=q.pointerId;return zc.set(ee,Gc(zc.get(ee)||null,d,g,M,O,q)),!0;case"gotpointercapture":return ee=q.pointerId,Vc.set(ee,Gc(Vc.get(ee)||null,d,g,M,O,q)),!0}return!1}function Yl(d){var g=T0(d.target);if(g!==null){var M=ua(g);if(M!==null){if(g=M.tag,g===13){if(g=Xh(M),g!==null){d.blockedOn=g,jg(d.priority,function(){Xl(M)});return}}else if(g===3&&M.stateNode.current.memoizedState.isDehydrated){d.blockedOn=M.tag===3?M.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Kl(d){if(d.blockedOn!==null)return!1;for(var g=d.targetContainers;0<g.length;){var M=kf(d.domEventName,d.eventSystemFlags,g[0],d.nativeEvent);if(M===null){M=d.nativeEvent;var O=new M.constructor(M.type,M);Sr=O,M.target.dispatchEvent(O),Sr=null}else return g=hd(M),g!==null&&m1(g),d.blockedOn=M,!1;g.shift()}return!0}function qg(d,g,M){Kl(d)&&M.delete(g)}function _1(){v1=!1,nl!==null&&Kl(nl)&&(nl=null),js!==null&&Kl(js)&&(js=null),b0!==null&&Kl(b0)&&(b0=null),zc.forEach(qg),Vc.forEach(qg)}function Hc(d,g){d.blockedOn===g&&(d.blockedOn=null,v1||(v1=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,_1)))}function Jh(d){function g(q){return Hc(q,d)}if(0<Qh.length){Hc(Qh[0],d);for(var M=1;M<Qh.length;M++){var O=Qh[M];O.blockedOn===d&&(O.blockedOn=null)}}for(nl!==null&&Hc(nl,d),js!==null&&Hc(js,d),b0!==null&&Hc(b0,d),zc.forEach(g),Vc.forEach(g),M=0;M<rl.length;M++)O=rl[M],O.blockedOn===d&&(O.blockedOn=null);for(;0<rl.length&&(M=rl[0],M.blockedOn===null);)Yl(M),M.blockedOn===null&&rl.shift()}var jc=I.ReactCurrentBatchConfig,Xo=!0;function Lu(d,g,M,O){var q=hi,ee=jc.transition;jc.transition=null;try{hi=1,Wc(d,g,M,O)}finally{hi=q,jc.transition=ee}}function Xg(d,g,M,O){var q=hi,ee=jc.transition;jc.transition=null;try{hi=4,Wc(d,g,M,O)}finally{hi=q,jc.transition=ee}}function Wc(d,g,M,O){if(Xo){var q=kf(d,g,M,O);if(q===null)u2(d,g,O,If,M),y1(d,O);else if($g(q,d,g,M,O))O.stopPropagation();else if(y1(d,O),g&4&&-1<Wg.indexOf(d)){for(;q!==null;){var ee=hd(q);if(ee!==null&&Zh(ee),ee=kf(d,g,M,O),ee===null&&u2(d,g,O,If,M),ee===q)break;q=ee}q!==null&&O.stopPropagation()}else u2(d,g,O,null,M)}}var If=null;function kf(d,g,M,O){if(If=null,d=Ze(O),d=T0(d),d!==null)if(g=ua(d),g===null)d=null;else if(M=g.tag,M===13){if(d=Xh(g),d!==null)return d;d=null}else if(M===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;d=null}else g!==d&&(d=null);return If=d,null}function x1(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ht()){case vn:return 1;case Dn:return 4;case Bn:case Wn:return 16;case ur:return 536870912;default:return 16}default:return 16}}var il=null,Nf=null,$c=null;function b1(){if($c)return $c;var d,g=Nf,M=g.length,O,q="value"in il?il.value:il.textContent,ee=q.length;for(d=0;d<M&&g[d]===q[d];d++);var ge=M-d;for(O=1;O<=ge&&g[M-O]===q[ee-O];O++);return $c=q.slice(d,1<O?1-O:void 0)}function Df(d){var g=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&g===13&&(d=13)):d=g,d===10&&(d=13),32<=d||d===13?d:0}function Zl(){return!0}function S1(){return!1}function ca(d){function g(M,O,q,ee,ge){this._reactName=M,this._targetInst=q,this.type=O,this.nativeEvent=ee,this.target=ge,this.currentTarget=null;for(var Fe in d)d.hasOwnProperty(Fe)&&(M=d[Fe],this[Fe]=M?M(ee):ee[Fe]);return this.isDefaultPrevented=(ee.defaultPrevented!=null?ee.defaultPrevented:ee.returnValue===!1)?Zl:S1,this.isPropagationStopped=S1,this}return pt(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var M=this.nativeEvent;M&&(M.preventDefault?M.preventDefault():typeof M.returnValue!="unknown"&&(M.returnValue=!1),this.isDefaultPrevented=Zl)},stopPropagation:function(){var M=this.nativeEvent;M&&(M.stopPropagation?M.stopPropagation():typeof M.cancelBubble!="unknown"&&(M.cancelBubble=!0),this.isPropagationStopped=Zl)},persist:function(){},isPersistent:Zl}),g}var Uu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mo=ca(Uu),S0=pt({},Uu,{view:0,detail:0}),ed=ca(S0),td,sl,Bu,al=pt({},S0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ff,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Bu&&(Bu&&d.type==="mousemove"?(td=d.screenX-Bu.screenX,sl=d.screenY-Bu.screenY):sl=td=0,Bu=d),td)},movementY:function(d){return"movementY"in d?d.movementY:sl}}),Ws=ca(al),Ql=pt({},al,{dataTransfer:0}),Of=ca(Ql),Yg=pt({},S0,{relatedTarget:0}),w0=ca(Yg),nd=pt({},Uu,{animationName:0,elapsedTime:0,pseudoElement:0}),Kg=ca(nd),Zg=pt({},Uu,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),w1=ca(Zg),d4=pt({},Uu,{data:0}),qc=ca(d4),E1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jg(d){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(d):(d=Qg[d])?!!g[d]:!1}function Ff(){return Jg}var rd=pt({},S0,{key:function(d){if(d.key){var g=E1[d.key]||d.key;if(g!=="Unidentified")return g}return d.type==="keypress"?(d=Df(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?T1[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ff,charCode:function(d){return d.type==="keypress"?Df(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Df(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),wa=ca(rd),f4=pt({},al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xc=ca(f4),M1=pt({},S0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ff}),e2=ca(M1),Ya=pt({},Uu,{propertyName:0,elapsedTime:0,pseudoElement:0}),p4=ca(Ya),m4=pt({},al,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),t2=ca(m4),C1=[9,13,27,32],zu=l&&"CompositionEvent"in window,ns=null;l&&"documentMode"in document&&(ns=document.documentMode);var id=l&&"TextEvent"in window&&!ns,ol=l&&(!zu||ns&&8<ns&&11>=ns),Jl=" ",A1=!1;function bi(d,g){switch(d){case"keyup":return C1.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vu(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Yc=!1;function P1(d,g){switch(d){case"compositionend":return Vu(g);case"keypress":return g.which!==32?null:(A1=!0,Jl);case"textInput":return d=g.data,d===Jl&&A1?null:d;default:return null}}function R1(d,g){if(Yc)return d==="compositionend"||!zu&&bi(d,g)?(d=b1(),$c=Nf=il=null,Yc=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return ol&&g.locale!=="ko"?null:g.data;default:return null}}var I1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n2(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g==="input"?!!I1[d.type]:g==="textarea"}function sd(d,g,M,O){en(O),g=U1(g,"onChange"),0<g.length&&(M=new Mo("onChange","change",null,M,O),d.push({event:M,listeners:g}))}var ll=null,Kc=null;function g4(d){o2(d,0)}function ad(d){var g=ju(d);if(oi(g))return d}function k1(d,g){if(d==="change")return g}var N1=!1;if(l){var de;if(l){var Pe="oninput"in document;if(!Pe){var Ye=document.createElement("div");Ye.setAttribute("oninput","return;"),Pe=typeof Ye.oninput=="function"}de=Pe}else de=!1;N1=de&&(!document.documentMode||9<document.documentMode)}function Bt(){ll&&(ll.detachEvent("onpropertychange",Cr),Kc=ll=null)}function Cr(d){if(d.propertyName==="value"&&ad(Kc)){var g=[];sd(g,Kc,d,Ze(d)),Vs(g4,g)}}function di(d,g,M){d==="focusin"?(Bt(),ll=g,Kc=M,ll.attachEvent("onpropertychange",Cr)):d==="focusout"&&Bt()}function ia(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ad(Kc)}function E0(d,g){if(d==="click")return ad(g)}function Lf(d,g){if(d==="input"||d==="change")return ad(g)}function Zc(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var Da=typeof Object.is=="function"?Object.is:Zc;function od(d,g){if(Da(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var M=Object.keys(d),O=Object.keys(g);if(M.length!==O.length)return!1;for(O=0;O<M.length;O++){var q=M[O];if(!h.call(g,q)||!Da(d[q],g[q]))return!1}return!0}function v4(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Fv(d,g){var M=v4(d);d=0;for(var O;M;){if(M.nodeType===3){if(O=d+M.textContent.length,d<=g&&O>=g)return{node:M,offset:g-d};d=O}e:{for(;M;){if(M.nextSibling){M=M.nextSibling;break e}M=M.parentNode}M=void 0}M=v4(M)}}function Lv(d,g){return d&&g?d===g?!0:d&&d.nodeType===3?!1:g&&g.nodeType===3?Lv(d,g.parentNode):"contains"in d?d.contains(g):d.compareDocumentPosition?!!(d.compareDocumentPosition(g)&16):!1:!1}function y4(){for(var d=window,g=$r();g instanceof d.HTMLIFrameElement;){try{var M=typeof g.contentWindow.location.href=="string"}catch{M=!1}if(M)d=g.contentWindow;else break;g=$r(d.document)}return g}function _4(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g&&(g==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||g==="textarea"||d.contentEditable==="true")}function mx(d){var g=y4(),M=d.focusedElem,O=d.selectionRange;if(g!==M&&M&&M.ownerDocument&&Lv(M.ownerDocument.documentElement,M)){if(O!==null&&_4(M)){if(g=O.start,d=O.end,d===void 0&&(d=g),"selectionStart"in M)M.selectionStart=g,M.selectionEnd=Math.min(d,M.value.length);else if(d=(g=M.ownerDocument||document)&&g.defaultView||window,d.getSelection){d=d.getSelection();var q=M.textContent.length,ee=Math.min(O.start,q);O=O.end===void 0?ee:Math.min(O.end,q),!d.extend&&ee>O&&(q=O,O=ee,ee=q),q=Fv(M,ee);var ge=Fv(M,O);q&&ge&&(d.rangeCount!==1||d.anchorNode!==q.node||d.anchorOffset!==q.offset||d.focusNode!==ge.node||d.focusOffset!==ge.offset)&&(g=g.createRange(),g.setStart(q.node,q.offset),d.removeAllRanges(),ee>O?(d.addRange(g),d.extend(ge.node,ge.offset)):(g.setEnd(ge.node,ge.offset),d.addRange(g)))}}for(g=[],d=M;d=d.parentNode;)d.nodeType===1&&g.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<g.length;M++)d=g[M],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Uv=l&&"documentMode"in document&&11>=document.documentMode,ul=null,x4=null,ld=null,Uf=!1;function b4(d,g,M){var O=M.window===M?M.document:M.nodeType===9?M:M.ownerDocument;Uf||ul==null||ul!==$r(O)||(O=ul,"selectionStart"in O&&_4(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),ld&&od(ld,O)||(ld=O,O=U1(x4,"onSelect"),0<O.length&&(g=new Mo("onSelect","select",null,g,M),d.push({event:g,listeners:O}),g.target=ul)))}function Bf(d,g){var M={};return M[d.toLowerCase()]=g.toLowerCase(),M["Webkit"+d]="webkit"+g,M["Moz"+d]="moz"+g,M}var Gu={animationend:Bf("Animation","AnimationEnd"),animationiteration:Bf("Animation","AnimationIteration"),animationstart:Bf("Animation","AnimationStart"),transitionend:Bf("Transition","TransitionEnd")},D1={},r2={};l&&(r2=document.createElement("div").style,"AnimationEvent"in window||(delete Gu.animationend.animation,delete Gu.animationiteration.animation,delete Gu.animationstart.animation),"TransitionEvent"in window||delete Gu.transitionend.transition);function O1(d){if(D1[d])return D1[d];if(!Gu[d])return d;var g=Gu[d],M;for(M in g)if(g.hasOwnProperty(M)&&M in r2)return D1[d]=g[M];return d}var Bv=O1("animationend"),i2=O1("animationiteration"),s2=O1("animationstart"),a2=O1("transitionend"),F1=new Map,S4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hu(d,g){F1.set(d,g),i(g,[d])}for(var zf=0;zf<S4.length;zf++){var L1=S4[zf],gx=L1.toLowerCase(),zv=L1[0].toUpperCase()+L1.slice(1);Hu(gx,"on"+zv)}Hu(Bv,"onAnimationEnd"),Hu(i2,"onAnimationIteration"),Hu(s2,"onAnimationStart"),Hu("dblclick","onDoubleClick"),Hu("focusin","onFocus"),Hu("focusout","onBlur"),Hu(a2,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w4=new Set("cancel close invalid load scroll toggle".split(" ").concat(ud));function E4(d,g,M){var O=d.type||"unknown-event";d.currentTarget=M,Pf(O,g,void 0,d),d.currentTarget=null}function o2(d,g){g=(g&4)!==0;for(var M=0;M<d.length;M++){var O=d[M],q=O.event;O=O.listeners;e:{var ee=void 0;if(g)for(var ge=O.length-1;0<=ge;ge--){var Fe=O[ge],Xe=Fe.instance,Ot=Fe.currentTarget;if(Fe=Fe.listener,Xe!==ee&&q.isPropagationStopped())break e;E4(q,Fe,Ot),ee=Xe}else for(ge=0;ge<O.length;ge++){if(Fe=O[ge],Xe=Fe.instance,Ot=Fe.currentTarget,Fe=Fe.listener,Xe!==ee&&q.isPropagationStopped())break e;E4(q,Fe,Ot),ee=Xe}}}if(tl)throw d=ka,tl=!1,ka=null,d}function rs(d,g){var M=g[V1];M===void 0&&(M=g[V1]=new Set);var O=d+"__bubble";M.has(O)||(T4(g,d,2,!1),M.add(O))}function l2(d,g,M){var O=0;g&&(O|=4),T4(M,d,O,g)}var Qc="_reactListening"+Math.random().toString(36).slice(2);function Vf(d){if(!d[Qc]){d[Qc]=!0,n.forEach(function(M){M!=="selectionchange"&&(w4.has(M)||l2(M,!1,d),l2(M,!0,d))});var g=d.nodeType===9?d:d.ownerDocument;g===null||g[Qc]||(g[Qc]=!0,l2("selectionchange",!1,g))}}function T4(d,g,M,O){switch(x1(g)){case 1:var q=Lu;break;case 4:q=Xg;break;default:q=Wc}M=q.bind(null,g,M,d),q=void 0,!Fu||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(q=!0),O?q!==void 0?d.addEventListener(g,M,{capture:!0,passive:q}):d.addEventListener(g,M,!0):q!==void 0?d.addEventListener(g,M,{passive:q}):d.addEventListener(g,M,!1)}function u2(d,g,M,O,q){var ee=O;if((g&1)===0&&(g&2)===0&&O!==null)e:for(;;){if(O===null)return;var ge=O.tag;if(ge===3||ge===4){var Fe=O.stateNode.containerInfo;if(Fe===q||Fe.nodeType===8&&Fe.parentNode===q)break;if(ge===4)for(ge=O.return;ge!==null;){var Xe=ge.tag;if((Xe===3||Xe===4)&&(Xe=ge.stateNode.containerInfo,Xe===q||Xe.nodeType===8&&Xe.parentNode===q))return;ge=ge.return}for(;Fe!==null;){if(ge=T0(Fe),ge===null)return;if(Xe=ge.tag,Xe===5||Xe===6){O=ee=ge;continue e}Fe=Fe.parentNode}}O=O.return}Vs(function(){var Ot=ee,an=Ze(M),yn=[];e:{var on=F1.get(d);if(on!==void 0){var $n=Mo,qn=d;switch(d){case"keypress":if(Df(M)===0)break e;case"keydown":case"keyup":$n=wa;break;case"focusin":qn="focus",$n=w0;break;case"focusout":qn="blur",$n=w0;break;case"beforeblur":case"afterblur":$n=w0;break;case"click":if(M.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$n=Ws;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$n=Of;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$n=e2;break;case Bv:case i2:case s2:$n=Kg;break;case a2:$n=p4;break;case"scroll":$n=ed;break;case"wheel":$n=t2;break;case"copy":case"cut":case"paste":$n=w1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$n=Xc}var Qn=(g&4)!==0,qs=!Qn&&d==="scroll",xt=Qn?on!==null?on+"Capture":null:on;Qn=[];for(var tt=Ot,At;tt!==null;){At=tt;var En=At.stateNode;if(At.tag===5&&En!==null&&(At=En,xt!==null&&(En=la(tt,xt),En!=null&&Qn.push(Gf(tt,En,At)))),qs)break;tt=tt.return}0<Qn.length&&(on=new $n(on,qn,null,M,an),yn.push({event:on,listeners:Qn}))}}if((g&7)===0){e:{if(on=d==="mouseover"||d==="pointerover",$n=d==="mouseout"||d==="pointerout",on&&M!==Sr&&(qn=M.relatedTarget||M.fromElement)&&(T0(qn)||qn[tu]))break e;if(($n||on)&&(on=an.window===an?an:(on=an.ownerDocument)?on.defaultView||on.parentWindow:window,$n?(qn=M.relatedTarget||M.toElement,$n=Ot,qn=qn?T0(qn):null,qn!==null&&(qs=ua(qn),qn!==qs||qn.tag!==5&&qn.tag!==6)&&(qn=null)):($n=null,qn=Ot),$n!==qn)){if(Qn=Ws,En="onMouseLeave",xt="onMouseEnter",tt="mouse",(d==="pointerout"||d==="pointerover")&&(Qn=Xc,En="onPointerLeave",xt="onPointerEnter",tt="pointer"),qs=$n==null?on:ju($n),At=qn==null?on:ju(qn),on=new Qn(En,tt+"leave",$n,M,an),on.target=qs,on.relatedTarget=At,En=null,T0(an)===Ot&&(Qn=new Qn(xt,tt+"enter",qn,M,an),Qn.target=At,Qn.relatedTarget=qs,En=Qn),qs=En,$n&&qn)t:{for(Qn=$n,xt=qn,tt=0,At=Qn;At;At=cd(At))tt++;for(At=0,En=xt;En;En=cd(En))At++;for(;0<tt-At;)Qn=cd(Qn),tt--;for(;0<At-tt;)xt=cd(xt),At--;for(;tt--;){if(Qn===xt||xt!==null&&Qn===xt.alternate)break t;Qn=cd(Qn),xt=cd(xt)}Qn=null}else Qn=null;$n!==null&&M4(yn,on,$n,Qn,!1),qn!==null&&qs!==null&&M4(yn,qs,qn,Qn,!0)}}e:{if(on=Ot?ju(Ot):window,$n=on.nodeName&&on.nodeName.toLowerCase(),$n==="select"||$n==="input"&&on.type==="file")var cr=k1;else if(n2(on))if(N1)cr=Lf;else{cr=ia;var wr=di}else($n=on.nodeName)&&$n.toLowerCase()==="input"&&(on.type==="checkbox"||on.type==="radio")&&(cr=E0);if(cr&&(cr=cr(d,Ot))){sd(yn,cr,M,an);break e}wr&&wr(d,on,Ot),d==="focusout"&&(wr=on._wrapperState)&&wr.controlled&&on.type==="number"&&Ar(on,"number",on.value)}switch(wr=Ot?ju(Ot):window,d){case"focusin":(n2(wr)||wr.contentEditable==="true")&&(ul=wr,x4=Ot,ld=null);break;case"focusout":ld=x4=ul=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,b4(yn,M,an);break;case"selectionchange":if(Uv)break;case"keydown":case"keyup":b4(yn,M,an)}var Er;if(zu)e:{switch(d){case"compositionstart":var Dr="onCompositionStart";break e;case"compositionend":Dr="onCompositionEnd";break e;case"compositionupdate":Dr="onCompositionUpdate";break e}Dr=void 0}else Yc?bi(d,M)&&(Dr="onCompositionEnd"):d==="keydown"&&M.keyCode===229&&(Dr="onCompositionStart");Dr&&(ol&&M.locale!=="ko"&&(Yc||Dr!=="onCompositionStart"?Dr==="onCompositionEnd"&&Yc&&(Er=b1()):(il=an,Nf="value"in il?il.value:il.textContent,Yc=!0)),wr=U1(Ot,Dr),0<wr.length&&(Dr=new qc(Dr,d,null,M,an),yn.push({event:Dr,listeners:wr}),Er?Dr.data=Er:(Er=Vu(M),Er!==null&&(Dr.data=Er)))),(Er=id?P1(d,M):R1(d,M))&&(Ot=U1(Ot,"onBeforeInput"),0<Ot.length&&(an=new qc("onBeforeInput","beforeinput",null,M,an),yn.push({event:an,listeners:Ot}),an.data=Er))}o2(yn,g)})}function Gf(d,g,M){return{instance:d,listener:g,currentTarget:M}}function U1(d,g){for(var M=g+"Capture",O=[];d!==null;){var q=d,ee=q.stateNode;q.tag===5&&ee!==null&&(q=ee,ee=la(d,M),ee!=null&&O.unshift(Gf(d,ee,q)),ee=la(d,g),ee!=null&&O.push(Gf(d,ee,q))),d=d.return}return O}function cd(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function M4(d,g,M,O,q){for(var ee=g._reactName,ge=[];M!==null&&M!==O;){var Fe=M,Xe=Fe.alternate,Ot=Fe.stateNode;if(Xe!==null&&Xe===O)break;Fe.tag===5&&Ot!==null&&(Fe=Ot,q?(Xe=la(M,ee),Xe!=null&&ge.unshift(Gf(M,Xe,Fe))):q||(Xe=la(M,ee),Xe!=null&&ge.push(Gf(M,Xe,Fe)))),M=M.return}ge.length!==0&&d.push({event:g,listeners:ge})}var Vv=/\r\n?/g,Gv=/\u0000|\uFFFD/g;function C4(d){return(typeof d=="string"?d:""+d).replace(Vv,`
`).replace(Gv,"")}function B1(d,g,M){if(g=C4(g),C4(d)!==g&&M)throw Error(t(425))}function z1(){}var c2=null,h2=null;function d2(d,g){return d==="textarea"||d==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var f2=typeof setTimeout=="function"?setTimeout:void 0,is=typeof clearTimeout=="function"?clearTimeout:void 0,A4=typeof Promise=="function"?Promise:void 0,vx=typeof queueMicrotask=="function"?queueMicrotask:typeof A4<"u"?function(d){return A4.resolve(null).then(d).catch(yx)}:f2;function yx(d){setTimeout(function(){throw d})}function Hf(d,g){var M=g,O=0;do{var q=M.nextSibling;if(d.removeChild(M),q&&q.nodeType===8)if(M=q.data,M==="/$"){if(O===0){d.removeChild(q),Jh(g);return}O--}else M!=="$"&&M!=="$?"&&M!=="$!"||O++;M=q}while(M);Jh(g)}function eu(d){for(;d!=null;d=d.nextSibling){var g=d.nodeType;if(g===1||g===3)break;if(g===8){if(g=d.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return d}function p2(d){d=d.previousSibling;for(var g=0;d;){if(d.nodeType===8){var M=d.data;if(M==="$"||M==="$!"||M==="$?"){if(g===0)return d;g--}else M==="/$"&&g++}d=d.previousSibling}return null}var cl=Math.random().toString(36).slice(2),vi="__reactFiber$"+cl,Jc="__reactProps$"+cl,tu="__reactContainer$"+cl,V1="__reactEvents$"+cl,P4="__reactListeners$"+cl,m2="__reactHandles$"+cl;function T0(d){var g=d[vi];if(g)return g;for(var M=d.parentNode;M;){if(g=M[tu]||M[vi]){if(M=g.alternate,g.child!==null||M!==null&&M.child!==null)for(d=p2(d);d!==null;){if(M=d[vi])return M;d=p2(d)}return g}d=M,M=d.parentNode}return null}function hd(d){return d=d[vi]||d[tu],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function ju(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(t(33))}function g2(d){return d[Jc]||null}var Wu=[],eh=-1;function $u(d){return{current:d}}function ss(d){0>eh||(d.current=Wu[eh],Wu[eh]=null,eh--)}function as(d,g){eh++,Wu[eh]=d.current,d.current=g}var nu={},Oa=$u(nu),Ka=$u(!1),th=nu;function dd(d,g){var M=d.type.contextTypes;if(!M)return nu;var O=d.stateNode;if(O&&O.__reactInternalMemoizedUnmaskedChildContext===g)return O.__reactInternalMemoizedMaskedChildContext;var q={},ee;for(ee in M)q[ee]=g[ee];return O&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=g,d.__reactInternalMemoizedMaskedChildContext=q),q}function Co(d){return d=d.childContextTypes,d!=null}function G1(){ss(Ka),ss(Oa)}function R4(d,g,M){if(Oa.current!==nu)throw Error(t(168));as(Oa,g),as(Ka,M)}function I4(d,g,M){var O=d.stateNode;if(g=g.childContextTypes,typeof O.getChildContext!="function")return M;O=O.getChildContext();for(var q in O)if(!(q in g))throw Error(t(108,qt(d)||"Unknown",q));return pt({},M,O)}function v2(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||nu,th=Oa.current,as(Oa,d),as(Ka,Ka.current),!0}function Hv(d,g,M){var O=d.stateNode;if(!O)throw Error(t(169));M?(d=I4(d,g,th),O.__reactInternalMemoizedMergedChildContext=d,ss(Ka),ss(Oa),as(Oa,d)):ss(Ka),as(Ka,M)}var M0=null,ru=!1,k4=!1;function N4(d){M0===null?M0=[d]:M0.push(d)}function jv(d){ru=!0,N4(d)}function hl(){if(!k4&&M0!==null){k4=!0;var d=0,g=hi;try{var M=M0;for(hi=1;d<M.length;d++){var O=M[d];do O=O(!0);while(O!==null)}M0=null,ru=!1}catch(q){throw M0!==null&&(M0=M0.slice(d+1)),Rf(vn,hl),q}finally{hi=g,k4=!1}}return null}var nh=[],fd=0,qu=null,Xu=0,C0=[],Ao=0,pd=null,dl=1,iu="";function md(d,g){nh[fd++]=Xu,nh[fd++]=qu,qu=d,Xu=g}function Wv(d,g,M){C0[Ao++]=dl,C0[Ao++]=iu,C0[Ao++]=pd,pd=d;var O=dl;d=iu;var q=32-Lr(O)-1;O&=~(1<<q),M+=1;var ee=32-Lr(g)+q;if(30<ee){var ge=q-q%5;ee=(O&(1<<ge)-1).toString(32),O>>=ge,q-=ge,dl=1<<32-Lr(g)+q|M<<q|O,iu=ee+d}else dl=1<<ee|M<<q|O,iu=d}function H1(d){d.return!==null&&(md(d,1),Wv(d,1,0))}function y2(d){for(;d===qu;)qu=nh[--fd],nh[fd]=null,Xu=nh[--fd],nh[fd]=null;for(;d===pd;)pd=C0[--Ao],C0[Ao]=null,iu=C0[--Ao],C0[Ao]=null,dl=C0[--Ao],C0[Ao]=null}var Po=null,Ro=null,vs=!1,fl=null;function _2(d,g){var M=R0(5,null,null,0);M.elementType="DELETED",M.stateNode=g,M.return=d,g=d.deletions,g===null?(d.deletions=[M],d.flags|=16):g.push(M)}function D4(d,g){switch(d.tag){case 5:var M=d.type;return g=g.nodeType!==1||M.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(d.stateNode=g,Po=d,Ro=eu(g.firstChild),!0):!1;case 6:return g=d.pendingProps===""||g.nodeType!==3?null:g,g!==null?(d.stateNode=g,Po=d,Ro=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(M=pd!==null?{id:dl,overflow:iu}:null,d.memoizedState={dehydrated:g,treeContext:M,retryLane:1073741824},M=R0(18,null,null,0),M.stateNode=g,M.return=d,d.child=M,Po=d,Ro=null,!0):!1;default:return!1}}function x2(d){return(d.mode&1)!==0&&(d.flags&128)===0}function O4(d){if(vs){var g=Ro;if(g){var M=g;if(!D4(d,g)){if(x2(d))throw Error(t(418));g=eu(M.nextSibling);var O=Po;g&&D4(d,g)?_2(O,M):(d.flags=d.flags&-4097|2,vs=!1,Po=d)}}else{if(x2(d))throw Error(t(418));d.flags=d.flags&-4097|2,vs=!1,Po=d}}}function $v(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Po=d}function j1(d){if(d!==Po)return!1;if(!vs)return $v(d),vs=!0,!1;var g;if((g=d.tag!==3)&&!(g=d.tag!==5)&&(g=d.type,g=g!=="head"&&g!=="body"&&!d2(d.type,d.memoizedProps)),g&&(g=Ro)){if(x2(d))throw F4(),Error(t(418));for(;g;)_2(d,g),g=eu(g.nextSibling)}if($v(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(t(317));e:{for(d=d.nextSibling,g=0;d;){if(d.nodeType===8){var M=d.data;if(M==="/$"){if(g===0){Ro=eu(d.nextSibling);break e}g--}else M!=="$"&&M!=="$!"&&M!=="$?"||g++}d=d.nextSibling}Ro=null}}else Ro=Po?eu(d.stateNode.nextSibling):null;return!0}function F4(){for(var d=Ro;d;)d=eu(d.nextSibling)}function jf(){Ro=Po=null,vs=!1}function rh(d){fl===null?fl=[d]:fl.push(d)}var L4=I.ReactCurrentBatchConfig;function W1(d,g,M){if(d=M.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(M._owner){if(M=M._owner,M){if(M.tag!==1)throw Error(t(309));var O=M.stateNode}if(!O)throw Error(t(147,d));var q=O,ee=""+d;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===ee?g.ref:(g=function(ge){var Fe=q.refs;ge===null?delete Fe[ee]:Fe[ee]=ge},g._stringRef=ee,g)}if(typeof d!="string")throw Error(t(284));if(!M._owner)throw Error(t(290,d))}return d}function b2(d,g){throw d=Object.prototype.toString.call(g),Error(t(31,d==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":d))}function $1(d){var g=d._init;return g(d._payload)}function qv(d){function g(xt,tt){if(d){var At=xt.deletions;At===null?(xt.deletions=[tt],xt.flags|=16):At.push(tt)}}function M(xt,tt){if(!d)return null;for(;tt!==null;)g(xt,tt),tt=tt.sibling;return null}function O(xt,tt){for(xt=new Map;tt!==null;)tt.key!==null?xt.set(tt.key,tt):xt.set(tt.index,tt),tt=tt.sibling;return xt}function q(xt,tt){return xt=fu(xt,tt),xt.index=0,xt.sibling=null,xt}function ee(xt,tt,At){return xt.index=At,d?(At=xt.alternate,At!==null?(At=At.index,At<tt?(xt.flags|=2,tt):At):(xt.flags|=2,tt)):(xt.flags|=1048576,tt)}function ge(xt){return d&&xt.alternate===null&&(xt.flags|=2),xt}function Fe(xt,tt,At,En){return tt===null||tt.tag!==6?(tt=d9(At,xt.mode,En),tt.return=xt,tt):(tt=q(tt,At),tt.return=xt,tt)}function Xe(xt,tt,At,En){var cr=At.type;return cr===ue?an(xt,tt,At.props.children,En,At.key):tt!==null&&(tt.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Se&&$1(cr)===tt.type)?(En=q(tt,At.props),En.ref=W1(xt,tt,At),En.return=xt,En):(En=h9(At.type,At.key,At.props,null,xt.mode,En),En.ref=W1(xt,tt,At),En.return=xt,En)}function Ot(xt,tt,At,En){return tt===null||tt.tag!==4||tt.stateNode.containerInfo!==At.containerInfo||tt.stateNode.implementation!==At.implementation?(tt=M5(At,xt.mode,En),tt.return=xt,tt):(tt=q(tt,At.children||[]),tt.return=xt,tt)}function an(xt,tt,At,En,cr){return tt===null||tt.tag!==7?(tt=ph(At,xt.mode,En,cr),tt.return=xt,tt):(tt=q(tt,At),tt.return=xt,tt)}function yn(xt,tt,At){if(typeof tt=="string"&&tt!==""||typeof tt=="number")return tt=d9(""+tt,xt.mode,At),tt.return=xt,tt;if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case ie:return At=h9(tt.type,tt.key,tt.props,null,xt.mode,At),At.ref=W1(xt,null,tt),At.return=xt,At;case ce:return tt=M5(tt,xt.mode,At),tt.return=xt,tt;case Se:var En=tt._init;return yn(xt,En(tt._payload),At)}if(ar(tt)||lt(tt))return tt=ph(tt,xt.mode,At,null),tt.return=xt,tt;b2(xt,tt)}return null}function on(xt,tt,At,En){var cr=tt!==null?tt.key:null;if(typeof At=="string"&&At!==""||typeof At=="number")return cr!==null?null:Fe(xt,tt,""+At,En);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case ie:return At.key===cr?Xe(xt,tt,At,En):null;case ce:return At.key===cr?Ot(xt,tt,At,En):null;case Se:return cr=At._init,on(xt,tt,cr(At._payload),En)}if(ar(At)||lt(At))return cr!==null?null:an(xt,tt,At,En,null);b2(xt,At)}return null}function $n(xt,tt,At,En,cr){if(typeof En=="string"&&En!==""||typeof En=="number")return xt=xt.get(At)||null,Fe(tt,xt,""+En,cr);if(typeof En=="object"&&En!==null){switch(En.$$typeof){case ie:return xt=xt.get(En.key===null?At:En.key)||null,Xe(tt,xt,En,cr);case ce:return xt=xt.get(En.key===null?At:En.key)||null,Ot(tt,xt,En,cr);case Se:var wr=En._init;return $n(xt,tt,At,wr(En._payload),cr)}if(ar(En)||lt(En))return xt=xt.get(At)||null,an(tt,xt,En,cr,null);b2(tt,En)}return null}function qn(xt,tt,At,En){for(var cr=null,wr=null,Er=tt,Dr=tt=0,Aa=null;Er!==null&&Dr<At.length;Dr++){Er.index>Dr?(Aa=Er,Er=null):Aa=Er.sibling;var Si=on(xt,Er,At[Dr],En);if(Si===null){Er===null&&(Er=Aa);break}d&&Er&&Si.alternate===null&&g(xt,Er),tt=ee(Si,tt,Dr),wr===null?cr=Si:wr.sibling=Si,wr=Si,Er=Aa}if(Dr===At.length)return M(xt,Er),vs&&md(xt,Dr),cr;if(Er===null){for(;Dr<At.length;Dr++)Er=yn(xt,At[Dr],En),Er!==null&&(tt=ee(Er,tt,Dr),wr===null?cr=Er:wr.sibling=Er,wr=Er);return vs&&md(xt,Dr),cr}for(Er=O(xt,Er);Dr<At.length;Dr++)Aa=$n(Er,xt,Dr,At[Dr],En),Aa!==null&&(d&&Aa.alternate!==null&&Er.delete(Aa.key===null?Dr:Aa.key),tt=ee(Aa,tt,Dr),wr===null?cr=Aa:wr.sibling=Aa,wr=Aa);return d&&Er.forEach(function(sc){return g(xt,sc)}),vs&&md(xt,Dr),cr}function Qn(xt,tt,At,En){var cr=lt(At);if(typeof cr!="function")throw Error(t(150));if(At=cr.call(At),At==null)throw Error(t(151));for(var wr=cr=null,Er=tt,Dr=tt=0,Aa=null,Si=At.next();Er!==null&&!Si.done;Dr++,Si=At.next()){Er.index>Dr?(Aa=Er,Er=null):Aa=Er.sibling;var sc=on(xt,Er,Si.value,En);if(sc===null){Er===null&&(Er=Aa);break}d&&Er&&sc.alternate===null&&g(xt,Er),tt=ee(sc,tt,Dr),wr===null?cr=sc:wr.sibling=sc,wr=sc,Er=Aa}if(Si.done)return M(xt,Er),vs&&md(xt,Dr),cr;if(Er===null){for(;!Si.done;Dr++,Si=At.next())Si=yn(xt,Si.value,En),Si!==null&&(tt=ee(Si,tt,Dr),wr===null?cr=Si:wr.sibling=Si,wr=Si);return vs&&md(xt,Dr),cr}for(Er=O(xt,Er);!Si.done;Dr++,Si=At.next())Si=$n(Er,xt,Dr,Si.value,En),Si!==null&&(d&&Si.alternate!==null&&Er.delete(Si.key===null?Dr:Si.key),tt=ee(Si,tt,Dr),wr===null?cr=Si:wr.sibling=Si,wr=Si);return d&&Er.forEach(function(Ex){return g(xt,Ex)}),vs&&md(xt,Dr),cr}function qs(xt,tt,At,En){if(typeof At=="object"&&At!==null&&At.type===ue&&At.key===null&&(At=At.props.children),typeof At=="object"&&At!==null){switch(At.$$typeof){case ie:e:{for(var cr=At.key,wr=tt;wr!==null;){if(wr.key===cr){if(cr=At.type,cr===ue){if(wr.tag===7){M(xt,wr.sibling),tt=q(wr,At.props.children),tt.return=xt,xt=tt;break e}}else if(wr.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Se&&$1(cr)===wr.type){M(xt,wr.sibling),tt=q(wr,At.props),tt.ref=W1(xt,wr,At),tt.return=xt,xt=tt;break e}M(xt,wr);break}else g(xt,wr);wr=wr.sibling}At.type===ue?(tt=ph(At.props.children,xt.mode,En,At.key),tt.return=xt,xt=tt):(En=h9(At.type,At.key,At.props,null,xt.mode,En),En.ref=W1(xt,tt,At),En.return=xt,xt=En)}return ge(xt);case ce:e:{for(wr=At.key;tt!==null;){if(tt.key===wr)if(tt.tag===4&&tt.stateNode.containerInfo===At.containerInfo&&tt.stateNode.implementation===At.implementation){M(xt,tt.sibling),tt=q(tt,At.children||[]),tt.return=xt,xt=tt;break e}else{M(xt,tt);break}else g(xt,tt);tt=tt.sibling}tt=M5(At,xt.mode,En),tt.return=xt,xt=tt}return ge(xt);case Se:return wr=At._init,qs(xt,tt,wr(At._payload),En)}if(ar(At))return qn(xt,tt,At,En);if(lt(At))return Qn(xt,tt,At,En);b2(xt,At)}return typeof At=="string"&&At!==""||typeof At=="number"?(At=""+At,tt!==null&&tt.tag===6?(M(xt,tt.sibling),tt=q(tt,At),tt.return=xt,xt=tt):(M(xt,tt),tt=d9(At,xt.mode,En),tt.return=xt,xt=tt),ge(xt)):M(xt,tt)}return qs}var Wf=qv(!0),gd=qv(!1),vd=$u(null),S2=null,yd=null,w2=null;function E2(){w2=yd=S2=null}function U4(d){var g=vd.current;ss(vd),d._currentValue=g}function q1(d,g,M){for(;d!==null;){var O=d.alternate;if((d.childLanes&g)!==g?(d.childLanes|=g,O!==null&&(O.childLanes|=g)):O!==null&&(O.childLanes&g)!==g&&(O.childLanes|=g),d===M)break;d=d.return}}function Yu(d,g){S2=d,w2=yd=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&g)!==0&&(Io=!0),d.firstContext=null)}function A0(d){var g=d._currentValue;if(w2!==d)if(d={context:d,memoizedValue:g,next:null},yd===null){if(S2===null)throw Error(t(308));yd=d,S2.dependencies={lanes:0,firstContext:d}}else yd=yd.next=d;return g}var ih=null;function X1(d){ih===null?ih=[d]:ih.push(d)}function B4(d,g,M,O){var q=g.interleaved;return q===null?(M.next=M,X1(g)):(M.next=q.next,q.next=M),g.interleaved=M,Ku(d,O)}function Ku(d,g){d.lanes|=g;var M=d.alternate;for(M!==null&&(M.lanes|=g),M=d,d=d.return;d!==null;)d.childLanes|=g,M=d.alternate,M!==null&&(M.childLanes|=g),M=d,d=d.return;return M.tag===3?M.stateNode:null}var su=!1;function T2(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _d(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Yo(d,g){return{eventTime:d,lane:g,tag:0,payload:null,callback:null,next:null}}function pl(d,g,M){var O=d.updateQueue;if(O===null)return null;if(O=O.shared,(Ai&2)!==0){var q=O.pending;return q===null?g.next=g:(g.next=q.next,q.next=g),O.pending=g,Ku(d,M)}return q=O.interleaved,q===null?(g.next=g,X1(O)):(g.next=q.next,q.next=g),O.interleaved=g,Ku(d,M)}function Y1(d,g,M){if(g=g.updateQueue,g!==null&&(g=g.shared,(M&4194240)!==0)){var O=g.lanes;O&=d.pendingLanes,M|=O,g.lanes=M,ws(d,M)}}function xd(d,g){var M=d.updateQueue,O=d.alternate;if(O!==null&&(O=O.updateQueue,M===O)){var q=null,ee=null;if(M=M.firstBaseUpdate,M!==null){do{var ge={eventTime:M.eventTime,lane:M.lane,tag:M.tag,payload:M.payload,callback:M.callback,next:null};ee===null?q=ee=ge:ee=ee.next=ge,M=M.next}while(M!==null);ee===null?q=ee=g:ee=ee.next=g}else q=ee=g;M={baseState:O.baseState,firstBaseUpdate:q,lastBaseUpdate:ee,shared:O.shared,effects:O.effects},d.updateQueue=M;return}d=M.lastBaseUpdate,d===null?M.firstBaseUpdate=g:d.next=g,M.lastBaseUpdate=g}function $f(d,g,M,O){var q=d.updateQueue;su=!1;var ee=q.firstBaseUpdate,ge=q.lastBaseUpdate,Fe=q.shared.pending;if(Fe!==null){q.shared.pending=null;var Xe=Fe,Ot=Xe.next;Xe.next=null,ge===null?ee=Ot:ge.next=Ot,ge=Xe;var an=d.alternate;an!==null&&(an=an.updateQueue,Fe=an.lastBaseUpdate,Fe!==ge&&(Fe===null?an.firstBaseUpdate=Ot:Fe.next=Ot,an.lastBaseUpdate=Xe))}if(ee!==null){var yn=q.baseState;ge=0,an=Ot=Xe=null,Fe=ee;do{var on=Fe.lane,$n=Fe.eventTime;if((O&on)===on){an!==null&&(an=an.next={eventTime:$n,lane:0,tag:Fe.tag,payload:Fe.payload,callback:Fe.callback,next:null});e:{var qn=d,Qn=Fe;switch(on=g,$n=M,Qn.tag){case 1:if(qn=Qn.payload,typeof qn=="function"){yn=qn.call($n,yn,on);break e}yn=qn;break e;case 3:qn.flags=qn.flags&-65537|128;case 0:if(qn=Qn.payload,on=typeof qn=="function"?qn.call($n,yn,on):qn,on==null)break e;yn=pt({},yn,on);break e;case 2:su=!0}}Fe.callback!==null&&Fe.lane!==0&&(d.flags|=64,on=q.effects,on===null?q.effects=[Fe]:on.push(Fe))}else $n={eventTime:$n,lane:on,tag:Fe.tag,payload:Fe.payload,callback:Fe.callback,next:null},an===null?(Ot=an=$n,Xe=yn):an=an.next=$n,ge|=on;if(Fe=Fe.next,Fe===null){if(Fe=q.shared.pending,Fe===null)break;on=Fe,Fe=on.next,on.next=null,q.lastBaseUpdate=on,q.shared.pending=null}}while(!0);if(an===null&&(Xe=yn),q.baseState=Xe,q.firstBaseUpdate=Ot,q.lastBaseUpdate=an,g=q.shared.interleaved,g!==null){q=g;do ge|=q.lane,q=q.next;while(q!==g)}else ee===null&&(q.shared.lanes=0);hu|=ge,d.lanes=ge,d.memoizedState=yn}}function Xv(d,g,M){if(d=g.effects,g.effects=null,d!==null)for(g=0;g<d.length;g++){var O=d[g],q=O.callback;if(q!==null){if(O.callback=null,O=M,typeof q!="function")throw Error(t(191,q));q.call(O)}}}var qf={},au=$u(qf),K1=$u(qf),Xf=$u(qf);function sh(d){if(d===qf)throw Error(t(174));return d}function z4(d,g){switch(as(Xf,g),as(K1,d),as(au,qf),d=g.nodeType,d){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:Zt(null,"");break;default:d=d===8?g.parentNode:g,g=d.namespaceURI||null,d=d.tagName,g=Zt(g,d)}ss(au),as(au,g)}function ou(){ss(au),ss(K1),ss(Xf)}function Z1(d){sh(Xf.current);var g=sh(au.current),M=Zt(g,d.type);g!==M&&(as(K1,d),as(au,M))}function V4(d){K1.current===d&&(ss(au),ss(K1))}var ys=$u(0);function M2(d){for(var g=d;g!==null;){if(g.tag===13){var M=g.memoizedState;if(M!==null&&(M=M.dehydrated,M===null||M.data==="$?"||M.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var G4=[];function C2(){for(var d=0;d<G4.length;d++)G4[d]._workInProgressVersionPrimary=null;G4.length=0}var A2=I.ReactCurrentDispatcher,H4=I.ReactCurrentBatchConfig,ah=0,ji=null,Es=null,ha=null,P2=!1,lu=!1,Zu=0,R2=0;function da(){throw Error(t(321))}function I2(d,g){if(g===null)return!1;for(var M=0;M<g.length&&M<d.length;M++)if(!Da(d[M],g[M]))return!1;return!0}function Yf(d,g,M,O,q,ee){if(ah=ee,ji=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,A2.current=d===null||d.memoizedState===null?Z4:ey,d=M(O,q),lu){ee=0;do{if(lu=!1,Zu=0,25<=ee)throw Error(t(301));ee+=1,ha=Es=null,g.updateQueue=null,A2.current=_x,d=M(O,q)}while(lu)}if(A2.current=rm,g=Es!==null&&Es.next!==null,ah=0,ha=Es=ji=null,P2=!1,g)throw Error(t(300));return d}function Q1(){var d=Zu!==0;return Zu=0,d}function uu(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ha===null?ji.memoizedState=ha=d:ha=ha.next=d,ha}function Ko(){if(Es===null){var d=ji.alternate;d=d!==null?d.memoizedState:null}else d=Es.next;var g=ha===null?ji.memoizedState:ha.next;if(g!==null)ha=g,Es=d;else{if(d===null)throw Error(t(310));Es=d,d={memoizedState:Es.memoizedState,baseState:Es.baseState,baseQueue:Es.baseQueue,queue:Es.queue,next:null},ha===null?ji.memoizedState=ha=d:ha=ha.next=d}return ha}function Kf(d,g){return typeof g=="function"?g(d):g}function j4(d){var g=Ko(),M=g.queue;if(M===null)throw Error(t(311));M.lastRenderedReducer=d;var O=Es,q=O.baseQueue,ee=M.pending;if(ee!==null){if(q!==null){var ge=q.next;q.next=ee.next,ee.next=ge}O.baseQueue=q=ee,M.pending=null}if(q!==null){ee=q.next,O=O.baseState;var Fe=ge=null,Xe=null,Ot=ee;do{var an=Ot.lane;if((ah&an)===an)Xe!==null&&(Xe=Xe.next={lane:0,action:Ot.action,hasEagerState:Ot.hasEagerState,eagerState:Ot.eagerState,next:null}),O=Ot.hasEagerState?Ot.eagerState:d(O,Ot.action);else{var yn={lane:an,action:Ot.action,hasEagerState:Ot.hasEagerState,eagerState:Ot.eagerState,next:null};Xe===null?(Fe=Xe=yn,ge=O):Xe=Xe.next=yn,ji.lanes|=an,hu|=an}Ot=Ot.next}while(Ot!==null&&Ot!==ee);Xe===null?ge=O:Xe.next=Fe,Da(O,g.memoizedState)||(Io=!0),g.memoizedState=O,g.baseState=ge,g.baseQueue=Xe,M.lastRenderedState=O}if(d=M.interleaved,d!==null){q=d;do ee=q.lane,ji.lanes|=ee,hu|=ee,q=q.next;while(q!==d)}else q===null&&(M.lanes=0);return[g.memoizedState,M.dispatch]}function k2(d){var g=Ko(),M=g.queue;if(M===null)throw Error(t(311));M.lastRenderedReducer=d;var O=M.dispatch,q=M.pending,ee=g.memoizedState;if(q!==null){M.pending=null;var ge=q=q.next;do ee=d(ee,ge.action),ge=ge.next;while(ge!==q);Da(ee,g.memoizedState)||(Io=!0),g.memoizedState=ee,g.baseQueue===null&&(g.baseState=ee),M.lastRenderedState=ee}return[ee,O]}function N2(){}function W4(d,g){var M=ji,O=Ko(),q=g(),ee=!Da(O.memoizedState,q);if(ee&&(O.memoizedState=q,Io=!0),O=O.queue,wd(Yv.bind(null,M,O,d),[d]),O.getSnapshot!==g||ee||ha!==null&&ha.memoizedState.tag&1){if(M.flags|=2048,oh(9,q4.bind(null,M,O,q,g),void 0,null),Ta===null)throw Error(t(349));(ah&30)!==0||$4(M,g,q)}return q}function $4(d,g,M){d.flags|=16384,d={getSnapshot:g,value:M},g=ji.updateQueue,g===null?(g={lastEffect:null,stores:null},ji.updateQueue=g,g.stores=[d]):(M=g.stores,M===null?g.stores=[d]:M.push(d))}function q4(d,g,M,O){g.value=M,g.getSnapshot=O,bd(g)&&X4(d)}function Yv(d,g,M){return M(function(){bd(g)&&X4(d)})}function bd(d){var g=d.getSnapshot;d=d.value;try{var M=g();return!Da(d,M)}catch{return!0}}function X4(d){var g=Ku(d,1);g!==null&&_l(g,d,1,-1)}function Kv(d){var g=uu();return typeof d=="function"&&(d=d()),g.memoizedState=g.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kf,lastRenderedState:d},g.queue=d,d=d.dispatch=K4.bind(null,ji,d),[g.memoizedState,d]}function oh(d,g,M,O){return d={tag:d,create:g,destroy:M,deps:O,next:null},g=ji.updateQueue,g===null?(g={lastEffect:null,stores:null},ji.updateQueue=g,g.lastEffect=d.next=d):(M=g.lastEffect,M===null?g.lastEffect=d.next=d:(O=M.next,M.next=d,d.next=O,g.lastEffect=d)),d}function D2(){return Ko().memoizedState}function J1(d,g,M,O){var q=uu();ji.flags|=d,q.memoizedState=oh(1|g,M,void 0,O===void 0?null:O)}function em(d,g,M,O){var q=Ko();O=O===void 0?null:O;var ee=void 0;if(Es!==null){var ge=Es.memoizedState;if(ee=ge.destroy,O!==null&&I2(O,ge.deps)){q.memoizedState=oh(g,M,ee,O);return}}ji.flags|=d,q.memoizedState=oh(1|g,M,ee,O)}function Sd(d,g){return J1(8390656,8,d,g)}function wd(d,g){return em(2048,8,d,g)}function Y4(d,g){return em(4,2,d,g)}function tm(d,g){return em(4,4,d,g)}function Zf(d,g){if(typeof g=="function")return d=d(),g(d),function(){g(null)};if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function Zv(d,g,M){return M=M!=null?M.concat([d]):null,em(4,4,Zf.bind(null,g,d),M)}function Qu(){}function Qf(d,g){var M=Ko();g=g===void 0?null:g;var O=M.memoizedState;return O!==null&&g!==null&&I2(g,O[1])?O[0]:(M.memoizedState=[d,g],d)}function O2(d,g){var M=Ko();g=g===void 0?null:g;var O=M.memoizedState;return O!==null&&g!==null&&I2(g,O[1])?O[0]:(d=d(),M.memoizedState=[d,g],d)}function F2(d,g,M){return(ah&21)===0?(d.baseState&&(d.baseState=!1,Io=!0),d.memoizedState=M):(Da(M,g)||(M=Oi(),ji.lanes|=M,hu|=M,d.baseState=!0),g)}function L2(d,g){var M=hi;hi=M!==0&&4>M?M:4,d(!0);var O=H4.transition;H4.transition={};try{d(!1),g()}finally{hi=M,H4.transition=O}}function Qv(){return Ko().memoizedState}function nm(d,g,M){var O=yl(d);if(M={lane:O,action:M,hasEagerState:!1,eagerState:null,next:null},Jv(d))U2(g,M);else if(M=B4(d,g,M,O),M!==null){var q=Ca();_l(M,d,O,q),B2(M,g,O)}}function K4(d,g,M){var O=yl(d),q={lane:O,action:M,hasEagerState:!1,eagerState:null,next:null};if(Jv(d))U2(g,q);else{var ee=d.alternate;if(d.lanes===0&&(ee===null||ee.lanes===0)&&(ee=g.lastRenderedReducer,ee!==null))try{var ge=g.lastRenderedState,Fe=ee(ge,M);if(q.hasEagerState=!0,q.eagerState=Fe,Da(Fe,ge)){var Xe=g.interleaved;Xe===null?(q.next=q,X1(g)):(q.next=Xe.next,Xe.next=q),g.interleaved=q;return}}catch{}finally{}M=B4(d,g,q,O),M!==null&&(q=Ca(),_l(M,d,O,q),B2(M,g,O))}}function Jv(d){var g=d.alternate;return d===ji||g!==null&&g===ji}function U2(d,g){lu=P2=!0;var M=d.pending;M===null?g.next=g:(g.next=M.next,M.next=g),d.pending=g}function B2(d,g,M){if((M&4194240)!==0){var O=g.lanes;O&=d.pendingLanes,M|=O,g.lanes=M,ws(d,M)}}var rm={readContext:A0,useCallback:da,useContext:da,useEffect:da,useImperativeHandle:da,useInsertionEffect:da,useLayoutEffect:da,useMemo:da,useReducer:da,useRef:da,useState:da,useDebugValue:da,useDeferredValue:da,useTransition:da,useMutableSource:da,useSyncExternalStore:da,useId:da,unstable_isNewReconciler:!1},Z4={readContext:A0,useCallback:function(d,g){return uu().memoizedState=[d,g===void 0?null:g],d},useContext:A0,useEffect:Sd,useImperativeHandle:function(d,g,M){return M=M!=null?M.concat([d]):null,J1(4194308,4,Zf.bind(null,g,d),M)},useLayoutEffect:function(d,g){return J1(4194308,4,d,g)},useInsertionEffect:function(d,g){return J1(4,2,d,g)},useMemo:function(d,g){var M=uu();return g=g===void 0?null:g,d=d(),M.memoizedState=[d,g],d},useReducer:function(d,g,M){var O=uu();return g=M!==void 0?M(g):g,O.memoizedState=O.baseState=g,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:g},O.queue=d,d=d.dispatch=nm.bind(null,ji,d),[O.memoizedState,d]},useRef:function(d){var g=uu();return d={current:d},g.memoizedState=d},useState:Kv,useDebugValue:Qu,useDeferredValue:function(d){return uu().memoizedState=d},useTransition:function(){var d=Kv(!1),g=d[0];return d=L2.bind(null,d[1]),uu().memoizedState=d,[g,d]},useMutableSource:function(){},useSyncExternalStore:function(d,g,M){var O=ji,q=uu();if(vs){if(M===void 0)throw Error(t(407));M=M()}else{if(M=g(),Ta===null)throw Error(t(349));(ah&30)!==0||$4(O,g,M)}q.memoizedState=M;var ee={value:M,getSnapshot:g};return q.queue=ee,Sd(Yv.bind(null,O,ee,d),[d]),O.flags|=2048,oh(9,q4.bind(null,O,ee,M,g),void 0,null),M},useId:function(){var d=uu(),g=Ta.identifierPrefix;if(vs){var M=iu,O=dl;M=(O&~(1<<32-Lr(O)-1)).toString(32)+M,g=":"+g+"R"+M,M=Zu++,0<M&&(g+="H"+M.toString(32)),g+=":"}else M=R2++,g=":"+g+"r"+M.toString(32)+":";return d.memoizedState=g},unstable_isNewReconciler:!1},ey={readContext:A0,useCallback:Qf,useContext:A0,useEffect:wd,useImperativeHandle:Zv,useInsertionEffect:Y4,useLayoutEffect:tm,useMemo:O2,useReducer:j4,useRef:D2,useState:function(){return j4(Kf)},useDebugValue:Qu,useDeferredValue:function(d){var g=Ko();return F2(g,Es.memoizedState,d)},useTransition:function(){var d=j4(Kf)[0],g=Ko().memoizedState;return[d,g]},useMutableSource:N2,useSyncExternalStore:W4,useId:Qv,unstable_isNewReconciler:!1},_x={readContext:A0,useCallback:Qf,useContext:A0,useEffect:wd,useImperativeHandle:Zv,useInsertionEffect:Y4,useLayoutEffect:tm,useMemo:O2,useReducer:k2,useRef:D2,useState:function(){return k2(Kf)},useDebugValue:Qu,useDeferredValue:function(d){var g=Ko();return Es===null?g.memoizedState=d:F2(g,Es.memoizedState,d)},useTransition:function(){var d=k2(Kf)[0],g=Ko().memoizedState;return[d,g]},useMutableSource:N2,useSyncExternalStore:W4,useId:Qv,unstable_isNewReconciler:!1};function ml(d,g){if(d&&d.defaultProps){g=pt({},g),d=d.defaultProps;for(var M in d)g[M]===void 0&&(g[M]=d[M]);return g}return g}function z2(d,g,M,O){g=d.memoizedState,M=M(O,g),M=M==null?g:pt({},g,M),d.memoizedState=M,d.lanes===0&&(d.updateQueue.baseState=M)}var im={isMounted:function(d){return(d=d._reactInternals)?ua(d)===d:!1},enqueueSetState:function(d,g,M){d=d._reactInternals;var O=Ca(),q=yl(d),ee=Yo(O,q);ee.payload=g,M!=null&&(ee.callback=M),g=pl(d,ee,q),g!==null&&(_l(g,d,q,O),Y1(g,d,q))},enqueueReplaceState:function(d,g,M){d=d._reactInternals;var O=Ca(),q=yl(d),ee=Yo(O,q);ee.tag=1,ee.payload=g,M!=null&&(ee.callback=M),g=pl(d,ee,q),g!==null&&(_l(g,d,q,O),Y1(g,d,q))},enqueueForceUpdate:function(d,g){d=d._reactInternals;var M=Ca(),O=yl(d),q=Yo(M,O);q.tag=2,g!=null&&(q.callback=g),g=pl(d,q,O),g!==null&&(_l(g,d,O,M),Y1(g,d,O))}};function Ju(d,g,M,O,q,ee,ge){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(O,ee,ge):g.prototype&&g.prototype.isPureReactComponent?!od(M,O)||!od(q,ee):!0}function lh(d,g,M){var O=!1,q=nu,ee=g.contextType;return typeof ee=="object"&&ee!==null?ee=A0(ee):(q=Co(g)?th:Oa.current,O=g.contextTypes,ee=(O=O!=null)?dd(d,q):nu),g=new g(M,ee),d.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=im,d.stateNode=g,g._reactInternals=d,O&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=q,d.__reactInternalMemoizedMaskedChildContext=ee),g}function Q4(d,g,M,O){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(M,O),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(M,O),g.state!==d&&im.enqueueReplaceState(g,g.state,null)}function V2(d,g,M,O){var q=d.stateNode;q.props=M,q.state=d.memoizedState,q.refs={},T2(d);var ee=g.contextType;typeof ee=="object"&&ee!==null?q.context=A0(ee):(ee=Co(g)?th:Oa.current,q.context=dd(d,ee)),q.state=d.memoizedState,ee=g.getDerivedStateFromProps,typeof ee=="function"&&(z2(d,g,ee,M),q.state=d.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(g=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),g!==q.state&&im.enqueueReplaceState(q,q.state,null),$f(d,M,q,O),q.state=d.memoizedState),typeof q.componentDidMount=="function"&&(d.flags|=4194308)}function ec(d,g){try{var M="",O=g;do M+=Dt(O),O=O.return;while(O);var q=M}catch(ee){q=`
Error generating stack: `+ee.message+`
`+ee.stack}return{value:d,source:g,stack:q,digest:null}}function G2(d,g,M){return{value:d,source:null,stack:M??null,digest:g??null}}function J4(d,g){try{console.error(g.value)}catch(M){setTimeout(function(){throw M})}}var sm=typeof WeakMap=="function"?WeakMap:Map;function e5(d,g,M){M=Yo(-1,M),M.tag=3,M.payload={element:null};var O=g.value;return M.callback=function(){fm||(fm=!0,_5=O),J4(d,g)},M}function am(d,g,M){M=Yo(-1,M),M.tag=3;var O=d.type.getDerivedStateFromError;if(typeof O=="function"){var q=g.value;M.payload=function(){return O(q)},M.callback=function(){J4(d,g)}}var ee=d.stateNode;return ee!==null&&typeof ee.componentDidCatch=="function"&&(M.callback=function(){J4(d,g),typeof O!="function"&&(P0===null?P0=new Set([this]):P0.add(this));var ge=g.stack;this.componentDidCatch(g.value,{componentStack:ge!==null?ge:""})}),M}function ty(d,g,M){var O=d.pingCache;if(O===null){O=d.pingCache=new sm;var q=new Set;O.set(g,q)}else q=O.get(g),q===void 0&&(q=new Set,O.set(g,q));q.has(M)||(q.add(M),d=Sy.bind(null,d,g,M),g.then(d,d))}function ny(d){do{var g;if((g=d.tag===13)&&(g=d.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return d;d=d.return}while(d!==null);return null}function t5(d,g,M,O,q){return(d.mode&1)===0?(d===g?d.flags|=65536:(d.flags|=128,M.flags|=131072,M.flags&=-52805,M.tag===1&&(M.alternate===null?M.tag=17:(g=Yo(-1,1),g.tag=2,pl(M,g,1))),M.lanes|=1),d):(d.flags|=65536,d.lanes=q,d)}var xx=I.ReactCurrentOwner,Io=!1;function ii(d,g,M,O){g.child=d===null?gd(g,null,M,O):Wf(g,d.child,M,O)}function Jf(d,g,M,O,q){M=M.render;var ee=g.ref;return Yu(g,q),O=Yf(d,g,M,O,ee,q),M=Q1(),d!==null&&!Io?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~q,tc(d,g,q)):(vs&&M&&H1(g),g.flags|=1,ii(d,g,O,q),g.child)}function ry(d,g,M,O,q){if(d===null){var ee=M.type;return typeof ee=="function"&&!u9(ee)&&ee.defaultProps===void 0&&M.compare===null&&M.defaultProps===void 0?(g.tag=15,g.type=ee,n5(d,g,ee,O,q)):(d=h9(M.type,null,O,g,g.mode,q),d.ref=g.ref,d.return=g,g.child=d)}if(ee=d.child,(d.lanes&q)===0){var ge=ee.memoizedProps;if(M=M.compare,M=M!==null?M:od,M(ge,O)&&d.ref===g.ref)return tc(d,g,q)}return g.flags|=1,d=fu(ee,O),d.ref=g.ref,d.return=g,g.child=d}function n5(d,g,M,O,q){if(d!==null){var ee=d.memoizedProps;if(od(ee,O)&&d.ref===g.ref)if(Io=!1,g.pendingProps=O=ee,(d.lanes&q)!==0)(d.flags&131072)!==0&&(Io=!0);else return g.lanes=d.lanes,tc(d,g,q)}return H2(d,g,M,O,q)}function iy(d,g,M){var O=g.pendingProps,q=O.children,ee=d!==null?d.memoizedState:null;if(O.mode==="hidden")if((g.mode&1)===0)g.memoizedState={baseLanes:0,cachePool:null,transitions:null},as(ip,Jo),Jo|=M;else{if((M&1073741824)===0)return d=ee!==null?ee.baseLanes|M:M,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:d,cachePool:null,transitions:null},g.updateQueue=null,as(ip,Jo),Jo|=d,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},O=ee!==null?ee.baseLanes:M,as(ip,Jo),Jo|=O}else ee!==null?(O=ee.baseLanes|M,g.memoizedState=null):O=M,as(ip,Jo),Jo|=O;return ii(d,g,q,M),g.child}function sy(d,g){var M=g.ref;(d===null&&M!==null||d!==null&&d.ref!==M)&&(g.flags|=512,g.flags|=2097152)}function H2(d,g,M,O,q){var ee=Co(M)?th:Oa.current;return ee=dd(g,ee),Yu(g,q),M=Yf(d,g,M,O,ee,q),O=Q1(),d!==null&&!Io?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~q,tc(d,g,q)):(vs&&O&&H1(g),g.flags|=1,ii(d,g,M,q),g.child)}function ay(d,g,M,O,q){if(Co(M)){var ee=!0;v2(g)}else ee=!1;if(Yu(g,q),g.stateNode===null)lm(d,g),lh(g,M,O),V2(g,M,O,q),O=!0;else if(d===null){var ge=g.stateNode,Fe=g.memoizedProps;ge.props=Fe;var Xe=ge.context,Ot=M.contextType;typeof Ot=="object"&&Ot!==null?Ot=A0(Ot):(Ot=Co(M)?th:Oa.current,Ot=dd(g,Ot));var an=M.getDerivedStateFromProps,yn=typeof an=="function"||typeof ge.getSnapshotBeforeUpdate=="function";yn||typeof ge.UNSAFE_componentWillReceiveProps!="function"&&typeof ge.componentWillReceiveProps!="function"||(Fe!==O||Xe!==Ot)&&Q4(g,ge,O,Ot),su=!1;var on=g.memoizedState;ge.state=on,$f(g,O,ge,q),Xe=g.memoizedState,Fe!==O||on!==Xe||Ka.current||su?(typeof an=="function"&&(z2(g,M,an,O),Xe=g.memoizedState),(Fe=su||Ju(g,M,Fe,O,on,Xe,Ot))?(yn||typeof ge.UNSAFE_componentWillMount!="function"&&typeof ge.componentWillMount!="function"||(typeof ge.componentWillMount=="function"&&ge.componentWillMount(),typeof ge.UNSAFE_componentWillMount=="function"&&ge.UNSAFE_componentWillMount()),typeof ge.componentDidMount=="function"&&(g.flags|=4194308)):(typeof ge.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=O,g.memoizedState=Xe),ge.props=O,ge.state=Xe,ge.context=Ot,O=Fe):(typeof ge.componentDidMount=="function"&&(g.flags|=4194308),O=!1)}else{ge=g.stateNode,_d(d,g),Fe=g.memoizedProps,Ot=g.type===g.elementType?Fe:ml(g.type,Fe),ge.props=Ot,yn=g.pendingProps,on=ge.context,Xe=M.contextType,typeof Xe=="object"&&Xe!==null?Xe=A0(Xe):(Xe=Co(M)?th:Oa.current,Xe=dd(g,Xe));var $n=M.getDerivedStateFromProps;(an=typeof $n=="function"||typeof ge.getSnapshotBeforeUpdate=="function")||typeof ge.UNSAFE_componentWillReceiveProps!="function"&&typeof ge.componentWillReceiveProps!="function"||(Fe!==yn||on!==Xe)&&Q4(g,ge,O,Xe),su=!1,on=g.memoizedState,ge.state=on,$f(g,O,ge,q);var qn=g.memoizedState;Fe!==yn||on!==qn||Ka.current||su?(typeof $n=="function"&&(z2(g,M,$n,O),qn=g.memoizedState),(Ot=su||Ju(g,M,Ot,O,on,qn,Xe)||!1)?(an||typeof ge.UNSAFE_componentWillUpdate!="function"&&typeof ge.componentWillUpdate!="function"||(typeof ge.componentWillUpdate=="function"&&ge.componentWillUpdate(O,qn,Xe),typeof ge.UNSAFE_componentWillUpdate=="function"&&ge.UNSAFE_componentWillUpdate(O,qn,Xe)),typeof ge.componentDidUpdate=="function"&&(g.flags|=4),typeof ge.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof ge.componentDidUpdate!="function"||Fe===d.memoizedProps&&on===d.memoizedState||(g.flags|=4),typeof ge.getSnapshotBeforeUpdate!="function"||Fe===d.memoizedProps&&on===d.memoizedState||(g.flags|=1024),g.memoizedProps=O,g.memoizedState=qn),ge.props=O,ge.state=qn,ge.context=Xe,O=Ot):(typeof ge.componentDidUpdate!="function"||Fe===d.memoizedProps&&on===d.memoizedState||(g.flags|=4),typeof ge.getSnapshotBeforeUpdate!="function"||Fe===d.memoizedProps&&on===d.memoizedState||(g.flags|=1024),O=!1)}return r5(d,g,M,O,ee,q)}function r5(d,g,M,O,q,ee){sy(d,g);var ge=(g.flags&128)!==0;if(!O&&!ge)return q&&Hv(g,M,!1),tc(d,g,ee);O=g.stateNode,xx.current=g;var Fe=ge&&typeof M.getDerivedStateFromError!="function"?null:O.render();return g.flags|=1,d!==null&&ge?(g.child=Wf(g,d.child,null,ee),g.child=Wf(g,null,Fe,ee)):ii(d,g,Fe,ee),g.memoizedState=O.state,q&&Hv(g,M,!0),g.child}function i5(d){var g=d.stateNode;g.pendingContext?R4(d,g.pendingContext,g.pendingContext!==g.context):g.context&&R4(d,g.context,!1),z4(d,g.containerInfo)}function oy(d,g,M,O,q){return jf(),rh(q),g.flags|=256,ii(d,g,M,O),g.child}var s5={dehydrated:null,treeContext:null,retryLane:0};function j2(d){return{baseLanes:d,cachePool:null,transitions:null}}function ly(d,g,M){var O=g.pendingProps,q=ys.current,ee=!1,ge=(g.flags&128)!==0,Fe;if((Fe=ge)||(Fe=d!==null&&d.memoizedState===null?!1:(q&2)!==0),Fe?(ee=!0,g.flags&=-129):(d===null||d.memoizedState!==null)&&(q|=1),as(ys,q&1),d===null)return O4(g),d=g.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((g.mode&1)===0?g.lanes=1:d.data==="$!"?g.lanes=8:g.lanes=1073741824,null):(ge=O.children,d=O.fallback,ee?(O=g.mode,ee=g.child,ge={mode:"hidden",children:ge},(O&1)===0&&ee!==null?(ee.childLanes=0,ee.pendingProps=ge):ee=ym(ge,O,0,null),d=ph(d,O,M,null),ee.return=g,d.return=g,ee.sibling=d,g.child=ee,g.child.memoizedState=j2(M),g.memoizedState=s5,d):a5(g,ge));if(q=d.memoizedState,q!==null&&(Fe=q.dehydrated,Fe!==null))return uy(d,g,ge,O,Fe,q,M);if(ee){ee=O.fallback,ge=g.mode,q=d.child,Fe=q.sibling;var Xe={mode:"hidden",children:O.children};return(ge&1)===0&&g.child!==q?(O=g.child,O.childLanes=0,O.pendingProps=Xe,g.deletions=null):(O=fu(q,Xe),O.subtreeFlags=q.subtreeFlags&14680064),Fe!==null?ee=fu(Fe,ee):(ee=ph(ee,ge,M,null),ee.flags|=2),ee.return=g,O.return=g,O.sibling=ee,g.child=O,O=ee,ee=g.child,ge=d.child.memoizedState,ge=ge===null?j2(M):{baseLanes:ge.baseLanes|M,cachePool:null,transitions:ge.transitions},ee.memoizedState=ge,ee.childLanes=d.childLanes&~M,g.memoizedState=s5,O}return ee=d.child,d=ee.sibling,O=fu(ee,{mode:"visible",children:O.children}),(g.mode&1)===0&&(O.lanes=M),O.return=g,O.sibling=null,d!==null&&(M=g.deletions,M===null?(g.deletions=[d],g.flags|=16):M.push(d)),g.child=O,g.memoizedState=null,O}function a5(d,g){return g=ym({mode:"visible",children:g},d.mode,0,null),g.return=d,d.child=g}function om(d,g,M,O){return O!==null&&rh(O),Wf(g,d.child,null,M),d=a5(g,g.pendingProps.children),d.flags|=2,g.memoizedState=null,d}function uy(d,g,M,O,q,ee,ge){if(M)return g.flags&256?(g.flags&=-257,O=G2(Error(t(422))),om(d,g,ge,O)):g.memoizedState!==null?(g.child=d.child,g.flags|=128,null):(ee=O.fallback,q=g.mode,O=ym({mode:"visible",children:O.children},q,0,null),ee=ph(ee,q,ge,null),ee.flags|=2,O.return=g,ee.return=g,O.sibling=ee,g.child=O,(g.mode&1)!==0&&Wf(g,d.child,null,ge),g.child.memoizedState=j2(ge),g.memoizedState=s5,ee);if((g.mode&1)===0)return om(d,g,ge,null);if(q.data==="$!"){if(O=q.nextSibling&&q.nextSibling.dataset,O)var Fe=O.dgst;return O=Fe,ee=Error(t(419)),O=G2(ee,O,void 0),om(d,g,ge,O)}if(Fe=(ge&d.childLanes)!==0,Io||Fe){if(O=Ta,O!==null){switch(ge&-ge){case 4:q=2;break;case 16:q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:q=32;break;case 536870912:q=268435456;break;default:q=0}q=(q&(O.suspendedLanes|ge))!==0?0:q,q!==0&&q!==ee.retryLane&&(ee.retryLane=q,Ku(d,q),_l(O,d,q,-1))}return vm(),O=G2(Error(t(421))),om(d,g,ge,O)}return q.data==="$?"?(g.flags|=128,g.child=d.child,g=o9.bind(null,d),q._reactRetry=g,null):(d=ee.treeContext,Ro=eu(q.nextSibling),Po=g,vs=!0,fl=null,d!==null&&(C0[Ao++]=dl,C0[Ao++]=iu,C0[Ao++]=pd,dl=d.id,iu=d.overflow,pd=g),g=a5(g,O.children),g.flags|=4096,g)}function cy(d,g,M){d.lanes|=g;var O=d.alternate;O!==null&&(O.lanes|=g),q1(d.return,g,M)}function uh(d,g,M,O,q){var ee=d.memoizedState;ee===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:O,tail:M,tailMode:q}:(ee.isBackwards=g,ee.rendering=null,ee.renderingStartTime=0,ee.last=O,ee.tail=M,ee.tailMode=q)}function ep(d,g,M){var O=g.pendingProps,q=O.revealOrder,ee=O.tail;if(ii(d,g,O.children,M),O=ys.current,(O&2)!==0)O=O&1|2,g.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&cy(d,M,g);else if(d.tag===19)cy(d,M,g);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}O&=1}if(as(ys,O),(g.mode&1)===0)g.memoizedState=null;else switch(q){case"forwards":for(M=g.child,q=null;M!==null;)d=M.alternate,d!==null&&M2(d)===null&&(q=M),M=M.sibling;M=q,M===null?(q=g.child,g.child=null):(q=M.sibling,M.sibling=null),uh(g,!1,q,M,ee);break;case"backwards":for(M=null,q=g.child,g.child=null;q!==null;){if(d=q.alternate,d!==null&&M2(d)===null){g.child=q;break}d=q.sibling,q.sibling=M,M=q,q=d}uh(g,!0,M,null,ee);break;case"together":uh(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function lm(d,g){(g.mode&1)===0&&d!==null&&(d.alternate=null,g.alternate=null,g.flags|=2)}function tc(d,g,M){if(d!==null&&(g.dependencies=d.dependencies),hu|=g.lanes,(M&g.childLanes)===0)return null;if(d!==null&&g.child!==d.child)throw Error(t(153));if(g.child!==null){for(d=g.child,M=fu(d,d.pendingProps),g.child=M,M.return=g;d.sibling!==null;)d=d.sibling,M=M.sibling=fu(d,d.pendingProps),M.return=g;M.sibling=null}return g.child}function hy(d,g,M){switch(g.tag){case 3:i5(g),jf();break;case 5:Z1(g);break;case 1:Co(g.type)&&v2(g);break;case 4:z4(g,g.stateNode.containerInfo);break;case 10:var O=g.type._context,q=g.memoizedProps.value;as(vd,O._currentValue),O._currentValue=q;break;case 13:if(O=g.memoizedState,O!==null)return O.dehydrated!==null?(as(ys,ys.current&1),g.flags|=128,null):(M&g.child.childLanes)!==0?ly(d,g,M):(as(ys,ys.current&1),d=tc(d,g,M),d!==null?d.sibling:null);as(ys,ys.current&1);break;case 19:if(O=(M&g.childLanes)!==0,(d.flags&128)!==0){if(O)return ep(d,g,M);g.flags|=128}if(q=g.memoizedState,q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),as(ys,ys.current),O)break;return null;case 22:case 23:return g.lanes=0,iy(d,g,M)}return tc(d,g,M)}var dy,o5,l5,fy;dy=function(d,g){for(var M=g.child;M!==null;){if(M.tag===5||M.tag===6)d.appendChild(M.stateNode);else if(M.tag!==4&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===g)break;for(;M.sibling===null;){if(M.return===null||M.return===g)return;M=M.return}M.sibling.return=M.return,M=M.sibling}},o5=function(){},l5=function(d,g,M,O){var q=d.memoizedProps;if(q!==O){d=g.stateNode,sh(au.current);var ee=null;switch(M){case"input":q=$e(d,q),O=$e(d,O),ee=[];break;case"select":q=pt({},q,{value:void 0}),O=pt({},O,{value:void 0}),ee=[];break;case"textarea":q=gi(d,q),O=gi(d,O),ee=[];break;default:typeof q.onClick!="function"&&typeof O.onClick=="function"&&(d.onclick=z1)}gr(M,O);var ge;M=null;for(Ot in q)if(!O.hasOwnProperty(Ot)&&q.hasOwnProperty(Ot)&&q[Ot]!=null)if(Ot==="style"){var Fe=q[Ot];for(ge in Fe)Fe.hasOwnProperty(ge)&&(M||(M={}),M[ge]="")}else Ot!=="dangerouslySetInnerHTML"&&Ot!=="children"&&Ot!=="suppressContentEditableWarning"&&Ot!=="suppressHydrationWarning"&&Ot!=="autoFocus"&&(r.hasOwnProperty(Ot)?ee||(ee=[]):(ee=ee||[]).push(Ot,null));for(Ot in O){var Xe=O[Ot];if(Fe=q!=null?q[Ot]:void 0,O.hasOwnProperty(Ot)&&Xe!==Fe&&(Xe!=null||Fe!=null))if(Ot==="style")if(Fe){for(ge in Fe)!Fe.hasOwnProperty(ge)||Xe&&Xe.hasOwnProperty(ge)||(M||(M={}),M[ge]="");for(ge in Xe)Xe.hasOwnProperty(ge)&&Fe[ge]!==Xe[ge]&&(M||(M={}),M[ge]=Xe[ge])}else M||(ee||(ee=[]),ee.push(Ot,M)),M=Xe;else Ot==="dangerouslySetInnerHTML"?(Xe=Xe?Xe.__html:void 0,Fe=Fe?Fe.__html:void 0,Xe!=null&&Fe!==Xe&&(ee=ee||[]).push(Ot,Xe)):Ot==="children"?typeof Xe!="string"&&typeof Xe!="number"||(ee=ee||[]).push(Ot,""+Xe):Ot!=="suppressContentEditableWarning"&&Ot!=="suppressHydrationWarning"&&(r.hasOwnProperty(Ot)?(Xe!=null&&Ot==="onScroll"&&rs("scroll",d),ee||Fe===Xe||(ee=[])):(ee=ee||[]).push(Ot,Xe))}M&&(ee=ee||[]).push("style",M);var Ot=ee;(g.updateQueue=Ot)&&(g.flags|=4)}},fy=function(d,g,M,O){M!==O&&(g.flags|=4)};function tp(d,g){if(!vs)switch(d.tailMode){case"hidden":g=d.tail;for(var M=null;g!==null;)g.alternate!==null&&(M=g),g=g.sibling;M===null?d.tail=null:M.sibling=null;break;case"collapsed":M=d.tail;for(var O=null;M!==null;)M.alternate!==null&&(O=M),M=M.sibling;O===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:O.sibling=null}}function Fa(d){var g=d.alternate!==null&&d.alternate.child===d.child,M=0,O=0;if(g)for(var q=d.child;q!==null;)M|=q.lanes|q.childLanes,O|=q.subtreeFlags&14680064,O|=q.flags&14680064,q.return=d,q=q.sibling;else for(q=d.child;q!==null;)M|=q.lanes|q.childLanes,O|=q.subtreeFlags,O|=q.flags,q.return=d,q=q.sibling;return d.subtreeFlags|=O,d.childLanes=M,g}function u5(d,g,M){var O=g.pendingProps;switch(y2(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fa(g),null;case 1:return Co(g.type)&&G1(),Fa(g),null;case 3:return O=g.stateNode,ou(),ss(Ka),ss(Oa),C2(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(d===null||d.child===null)&&(j1(g)?g.flags|=4:d===null||d.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,fl!==null&&(n9(fl),fl=null))),o5(d,g),Fa(g),null;case 5:V4(g);var q=sh(Xf.current);if(M=g.type,d!==null&&g.stateNode!=null)l5(d,g,M,O,q),d.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!O){if(g.stateNode===null)throw Error(t(166));return Fa(g),null}if(d=sh(au.current),j1(g)){O=g.stateNode,M=g.type;var ee=g.memoizedProps;switch(O[vi]=g,O[Jc]=ee,d=(g.mode&1)!==0,M){case"dialog":rs("cancel",O),rs("close",O);break;case"iframe":case"object":case"embed":rs("load",O);break;case"video":case"audio":for(q=0;q<ud.length;q++)rs(ud[q],O);break;case"source":rs("error",O);break;case"img":case"image":case"link":rs("error",O),rs("load",O);break;case"details":rs("toggle",O);break;case"input":zs(O,ee),rs("invalid",O);break;case"select":O._wrapperState={wasMultiple:!!ee.multiple},rs("invalid",O);break;case"textarea":Oe(O,ee),rs("invalid",O)}gr(M,ee),q=null;for(var ge in ee)if(ee.hasOwnProperty(ge)){var Fe=ee[ge];ge==="children"?typeof Fe=="string"?O.textContent!==Fe&&(ee.suppressHydrationWarning!==!0&&B1(O.textContent,Fe,d),q=["children",Fe]):typeof Fe=="number"&&O.textContent!==""+Fe&&(ee.suppressHydrationWarning!==!0&&B1(O.textContent,Fe,d),q=["children",""+Fe]):r.hasOwnProperty(ge)&&Fe!=null&&ge==="onScroll"&&rs("scroll",O)}switch(M){case"input":ni(O),Ln(O,ee,!0);break;case"textarea":ni(O),Ct(O);break;case"select":case"option":break;default:typeof ee.onClick=="function"&&(O.onclick=z1)}O=q,g.updateQueue=O,O!==null&&(g.flags|=4)}else{ge=q.nodeType===9?q:q.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Kt(M)),d==="http://www.w3.org/1999/xhtml"?M==="script"?(d=ge.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof O.is=="string"?d=ge.createElement(M,{is:O.is}):(d=ge.createElement(M),M==="select"&&(ge=d,O.multiple?ge.multiple=!0:O.size&&(ge.size=O.size))):d=ge.createElementNS(d,M),d[vi]=g,d[Jc]=O,dy(d,g,!1,!1),g.stateNode=d;e:{switch(ge=Pn(M,O),M){case"dialog":rs("cancel",d),rs("close",d),q=O;break;case"iframe":case"object":case"embed":rs("load",d),q=O;break;case"video":case"audio":for(q=0;q<ud.length;q++)rs(ud[q],d);q=O;break;case"source":rs("error",d),q=O;break;case"img":case"image":case"link":rs("error",d),rs("load",d),q=O;break;case"details":rs("toggle",d),q=O;break;case"input":zs(d,O),q=$e(d,O),rs("invalid",d);break;case"option":q=O;break;case"select":d._wrapperState={wasMultiple:!!O.multiple},q=pt({},O,{value:void 0}),rs("invalid",d);break;case"textarea":Oe(d,O),q=gi(d,O),rs("invalid",d);break;default:q=O}gr(M,q),Fe=q;for(ee in Fe)if(Fe.hasOwnProperty(ee)){var Xe=Fe[ee];ee==="style"?jn(d,Xe):ee==="dangerouslySetInnerHTML"?(Xe=Xe?Xe.__html:void 0,Xe!=null&&or(d,Xe)):ee==="children"?typeof Xe=="string"?(M!=="textarea"||Xe!=="")&&An(d,Xe):typeof Xe=="number"&&An(d,""+Xe):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(r.hasOwnProperty(ee)?Xe!=null&&ee==="onScroll"&&rs("scroll",d):Xe!=null&&Z(d,ee,Xe,ge))}switch(M){case"input":ni(d),Ln(d,O,!1);break;case"textarea":ni(d),Ct(d);break;case"option":O.value!=null&&d.setAttribute("value",""+wn(O.value));break;case"select":d.multiple=!!O.multiple,ee=O.value,ee!=null?fr(d,!!O.multiple,ee,!1):O.defaultValue!=null&&fr(d,!!O.multiple,O.defaultValue,!0);break;default:typeof q.onClick=="function"&&(d.onclick=z1)}switch(M){case"button":case"input":case"select":case"textarea":O=!!O.autoFocus;break e;case"img":O=!0;break e;default:O=!1}}O&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Fa(g),null;case 6:if(d&&g.stateNode!=null)fy(d,g,d.memoizedProps,O);else{if(typeof O!="string"&&g.stateNode===null)throw Error(t(166));if(M=sh(Xf.current),sh(au.current),j1(g)){if(O=g.stateNode,M=g.memoizedProps,O[vi]=g,(ee=O.nodeValue!==M)&&(d=Po,d!==null))switch(d.tag){case 3:B1(O.nodeValue,M,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&B1(O.nodeValue,M,(d.mode&1)!==0)}ee&&(g.flags|=4)}else O=(M.nodeType===9?M:M.ownerDocument).createTextNode(O),O[vi]=g,g.stateNode=O}return Fa(g),null;case 13:if(ss(ys),O=g.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(vs&&Ro!==null&&(g.mode&1)!==0&&(g.flags&128)===0)F4(),jf(),g.flags|=98560,ee=!1;else if(ee=j1(g),O!==null&&O.dehydrated!==null){if(d===null){if(!ee)throw Error(t(318));if(ee=g.memoizedState,ee=ee!==null?ee.dehydrated:null,!ee)throw Error(t(317));ee[vi]=g}else jf(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Fa(g),ee=!1}else fl!==null&&(n9(fl),fl=null),ee=!0;if(!ee)return g.flags&65536?g:null}return(g.flags&128)!==0?(g.lanes=M,g):(O=O!==null,O!==(d!==null&&d.memoizedState!==null)&&O&&(g.child.flags|=8192,(g.mode&1)!==0&&(d===null||(ys.current&1)!==0?Ur===0&&(Ur=3):vm())),g.updateQueue!==null&&(g.flags|=4),Fa(g),null);case 4:return ou(),o5(d,g),d===null&&Vf(g.stateNode.containerInfo),Fa(g),null;case 10:return U4(g.type._context),Fa(g),null;case 17:return Co(g.type)&&G1(),Fa(g),null;case 19:if(ss(ys),ee=g.memoizedState,ee===null)return Fa(g),null;if(O=(g.flags&128)!==0,ge=ee.rendering,ge===null)if(O)tp(ee,!1);else{if(Ur!==0||d!==null&&(d.flags&128)!==0)for(d=g.child;d!==null;){if(ge=M2(d),ge!==null){for(g.flags|=128,tp(ee,!1),O=ge.updateQueue,O!==null&&(g.updateQueue=O,g.flags|=4),g.subtreeFlags=0,O=M,M=g.child;M!==null;)ee=M,d=O,ee.flags&=14680066,ge=ee.alternate,ge===null?(ee.childLanes=0,ee.lanes=d,ee.child=null,ee.subtreeFlags=0,ee.memoizedProps=null,ee.memoizedState=null,ee.updateQueue=null,ee.dependencies=null,ee.stateNode=null):(ee.childLanes=ge.childLanes,ee.lanes=ge.lanes,ee.child=ge.child,ee.subtreeFlags=0,ee.deletions=null,ee.memoizedProps=ge.memoizedProps,ee.memoizedState=ge.memoizedState,ee.updateQueue=ge.updateQueue,ee.type=ge.type,d=ge.dependencies,ee.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),M=M.sibling;return as(ys,ys.current&1|2),g.child}d=d.sibling}ee.tail!==null&&bt()>ap&&(g.flags|=128,O=!0,tp(ee,!1),g.lanes=4194304)}else{if(!O)if(d=M2(ge),d!==null){if(g.flags|=128,O=!0,M=d.updateQueue,M!==null&&(g.updateQueue=M,g.flags|=4),tp(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!ge.alternate&&!vs)return Fa(g),null}else 2*bt()-ee.renderingStartTime>ap&&M!==1073741824&&(g.flags|=128,O=!0,tp(ee,!1),g.lanes=4194304);ee.isBackwards?(ge.sibling=g.child,g.child=ge):(M=ee.last,M!==null?M.sibling=ge:g.child=ge,ee.last=ge)}return ee.tail!==null?(g=ee.tail,ee.rendering=g,ee.tail=g.sibling,ee.renderingStartTime=bt(),g.sibling=null,M=ys.current,as(ys,O?M&1|2:M&1),g):(Fa(g),null);case 22:case 23:return i9(),O=g.memoizedState!==null,d!==null&&d.memoizedState!==null!==O&&(g.flags|=8192),O&&(g.mode&1)!==0?(Jo&1073741824)!==0&&(Fa(g),g.subtreeFlags&6&&(g.flags|=8192)):Fa(g),null;case 24:return null;case 25:return null}throw Error(t(156,g.tag))}function py(d,g){switch(y2(g),g.tag){case 1:return Co(g.type)&&G1(),d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 3:return ou(),ss(Ka),ss(Oa),C2(),d=g.flags,(d&65536)!==0&&(d&128)===0?(g.flags=d&-65537|128,g):null;case 5:return V4(g),null;case 13:if(ss(ys),d=g.memoizedState,d!==null&&d.dehydrated!==null){if(g.alternate===null)throw Error(t(340));jf()}return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 19:return ss(ys),null;case 4:return ou(),null;case 10:return U4(g.type._context),null;case 22:case 23:return i9(),null;case 24:return null;default:return null}}var um=!1,La=!1,bx=typeof WeakSet=="function"?WeakSet:Set,Zn=null;function np(d,g){var M=d.ref;if(M!==null)if(typeof M=="function")try{M(null)}catch(O){ks(d,g,O)}else M.current=null}function c5(d,g,M){try{M()}catch(O){ks(d,g,O)}}var W2=!1;function my(d,g){if(c2=Xo,d=y4(),_4(d)){if("selectionStart"in d)var M={start:d.selectionStart,end:d.selectionEnd};else e:{M=(M=d.ownerDocument)&&M.defaultView||window;var O=M.getSelection&&M.getSelection();if(O&&O.rangeCount!==0){M=O.anchorNode;var q=O.anchorOffset,ee=O.focusNode;O=O.focusOffset;try{M.nodeType,ee.nodeType}catch{M=null;break e}var ge=0,Fe=-1,Xe=-1,Ot=0,an=0,yn=d,on=null;t:for(;;){for(var $n;yn!==M||q!==0&&yn.nodeType!==3||(Fe=ge+q),yn!==ee||O!==0&&yn.nodeType!==3||(Xe=ge+O),yn.nodeType===3&&(ge+=yn.nodeValue.length),($n=yn.firstChild)!==null;)on=yn,yn=$n;for(;;){if(yn===d)break t;if(on===M&&++Ot===q&&(Fe=ge),on===ee&&++an===O&&(Xe=ge),($n=yn.nextSibling)!==null)break;yn=on,on=yn.parentNode}yn=$n}M=Fe===-1||Xe===-1?null:{start:Fe,end:Xe}}else M=null}M=M||{start:0,end:0}}else M=null;for(h2={focusedElem:d,selectionRange:M},Xo=!1,Zn=g;Zn!==null;)if(g=Zn,d=g.child,(g.subtreeFlags&1028)!==0&&d!==null)d.return=g,Zn=d;else for(;Zn!==null;){g=Zn;try{var qn=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if(qn!==null){var Qn=qn.memoizedProps,qs=qn.memoizedState,xt=g.stateNode,tt=xt.getSnapshotBeforeUpdate(g.elementType===g.type?Qn:ml(g.type,Qn),qs);xt.__reactInternalSnapshotBeforeUpdate=tt}break;case 3:var At=g.stateNode.containerInfo;At.nodeType===1?At.textContent="":At.nodeType===9&&At.documentElement&&At.removeChild(At.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(En){ks(g,g.return,En)}if(d=g.sibling,d!==null){d.return=g.return,Zn=d;break}Zn=g.return}return qn=W2,W2=!1,qn}function rp(d,g,M){var O=g.updateQueue;if(O=O!==null?O.lastEffect:null,O!==null){var q=O=O.next;do{if((q.tag&d)===d){var ee=q.destroy;q.destroy=void 0,ee!==void 0&&c5(g,M,ee)}q=q.next}while(q!==O)}}function Ed(d,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var M=g=g.next;do{if((M.tag&d)===d){var O=M.create;M.destroy=O()}M=M.next}while(M!==g)}}function h5(d){var g=d.ref;if(g!==null){var M=d.stateNode;switch(d.tag){case 5:d=M;break;default:d=M}typeof g=="function"?g(d):g.current=d}}function d5(d){var g=d.alternate;g!==null&&(d.alternate=null,d5(g)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(g=d.stateNode,g!==null&&(delete g[vi],delete g[Jc],delete g[V1],delete g[P4],delete g[m2])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function cm(d){return d.tag===5||d.tag===3||d.tag===4}function f5(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||cm(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function $2(d,g,M){var O=d.tag;if(O===5||O===6)d=d.stateNode,g?M.nodeType===8?M.parentNode.insertBefore(d,g):M.insertBefore(d,g):(M.nodeType===8?(g=M.parentNode,g.insertBefore(d,M)):(g=M,g.appendChild(d)),M=M._reactRootContainer,M!=null||g.onclick!==null||(g.onclick=z1));else if(O!==4&&(d=d.child,d!==null))for($2(d,g,M),d=d.sibling;d!==null;)$2(d,g,M),d=d.sibling}function nc(d,g,M){var O=d.tag;if(O===5||O===6)d=d.stateNode,g?M.insertBefore(d,g):M.appendChild(d);else if(O!==4&&(d=d.child,d!==null))for(nc(d,g,M),d=d.sibling;d!==null;)nc(d,g,M),d=d.sibling}var Ea=null,Zo=!1;function cu(d,g,M){for(M=M.child;M!==null;)q2(d,g,M),M=M.sibling}function q2(d,g,M){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(vr,M)}catch{}switch(M.tag){case 5:La||np(M,g);case 6:var O=Ea,q=Zo;Ea=null,cu(d,g,M),Ea=O,Zo=q,Ea!==null&&(Zo?(d=Ea,M=M.stateNode,d.nodeType===8?d.parentNode.removeChild(M):d.removeChild(M)):Ea.removeChild(M.stateNode));break;case 18:Ea!==null&&(Zo?(d=Ea,M=M.stateNode,d.nodeType===8?Hf(d.parentNode,M):d.nodeType===1&&Hf(d,M),Jh(d)):Hf(Ea,M.stateNode));break;case 4:O=Ea,q=Zo,Ea=M.stateNode.containerInfo,Zo=!0,cu(d,g,M),Ea=O,Zo=q;break;case 0:case 11:case 14:case 15:if(!La&&(O=M.updateQueue,O!==null&&(O=O.lastEffect,O!==null))){q=O=O.next;do{var ee=q,ge=ee.destroy;ee=ee.tag,ge!==void 0&&((ee&2)!==0||(ee&4)!==0)&&c5(M,g,ge),q=q.next}while(q!==O)}cu(d,g,M);break;case 1:if(!La&&(np(M,g),O=M.stateNode,typeof O.componentWillUnmount=="function"))try{O.props=M.memoizedProps,O.state=M.memoizedState,O.componentWillUnmount()}catch(Fe){ks(M,g,Fe)}cu(d,g,M);break;case 21:cu(d,g,M);break;case 22:M.mode&1?(La=(O=La)||M.memoizedState!==null,cu(d,g,M),La=O):cu(d,g,M);break;default:cu(d,g,M)}}function X2(d){var g=d.updateQueue;if(g!==null){d.updateQueue=null;var M=d.stateNode;M===null&&(M=d.stateNode=new bx),g.forEach(function(O){var q=op.bind(null,d,O);M.has(O)||(M.add(O),O.then(q,q))})}}function Qo(d,g){var M=g.deletions;if(M!==null)for(var O=0;O<M.length;O++){var q=M[O];try{var ee=d,ge=g,Fe=ge;e:for(;Fe!==null;){switch(Fe.tag){case 5:Ea=Fe.stateNode,Zo=!1;break e;case 3:Ea=Fe.stateNode.containerInfo,Zo=!0;break e;case 4:Ea=Fe.stateNode.containerInfo,Zo=!0;break e}Fe=Fe.return}if(Ea===null)throw Error(t(160));q2(ee,ge,q),Ea=null,Zo=!1;var Xe=q.alternate;Xe!==null&&(Xe.return=null),q.return=null}catch(Ot){ks(q,g,Ot)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)hm(g,d),g=g.sibling}function hm(d,g){var M=d.alternate,O=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Qo(g,d),gl(d),O&4){try{rp(3,d,d.return),Ed(3,d)}catch(Qn){ks(d,d.return,Qn)}try{rp(5,d,d.return)}catch(Qn){ks(d,d.return,Qn)}}break;case 1:Qo(g,d),gl(d),O&512&&M!==null&&np(M,M.return);break;case 5:if(Qo(g,d),gl(d),O&512&&M!==null&&np(M,M.return),d.flags&32){var q=d.stateNode;try{An(q,"")}catch(Qn){ks(d,d.return,Qn)}}if(O&4&&(q=d.stateNode,q!=null)){var ee=d.memoizedProps,ge=M!==null?M.memoizedProps:ee,Fe=d.type,Xe=d.updateQueue;if(d.updateQueue=null,Xe!==null)try{Fe==="input"&&ee.type==="radio"&&ee.name!=null&&li(q,ee),Pn(Fe,ge);var Ot=Pn(Fe,ee);for(ge=0;ge<Xe.length;ge+=2){var an=Xe[ge],yn=Xe[ge+1];an==="style"?jn(q,yn):an==="dangerouslySetInnerHTML"?or(q,yn):an==="children"?An(q,yn):Z(q,an,yn,Ot)}switch(Fe){case"input":Ci(q,ee);break;case"textarea":_e(q,ee);break;case"select":var on=q._wrapperState.wasMultiple;q._wrapperState.wasMultiple=!!ee.multiple;var $n=ee.value;$n!=null?fr(q,!!ee.multiple,$n,!1):on!==!!ee.multiple&&(ee.defaultValue!=null?fr(q,!!ee.multiple,ee.defaultValue,!0):fr(q,!!ee.multiple,ee.multiple?[]:"",!1))}q[Jc]=ee}catch(Qn){ks(d,d.return,Qn)}}break;case 6:if(Qo(g,d),gl(d),O&4){if(d.stateNode===null)throw Error(t(162));q=d.stateNode,ee=d.memoizedProps;try{q.nodeValue=ee}catch(Qn){ks(d,d.return,Qn)}}break;case 3:if(Qo(g,d),gl(d),O&4&&M!==null&&M.memoizedState.isDehydrated)try{Jh(g.containerInfo)}catch(Qn){ks(d,d.return,Qn)}break;case 4:Qo(g,d),gl(d);break;case 13:Qo(g,d),gl(d),q=d.child,q.flags&8192&&(ee=q.memoizedState!==null,q.stateNode.isHidden=ee,!ee||q.alternate!==null&&q.alternate.memoizedState!==null||(y5=bt())),O&4&&X2(d);break;case 22:if(an=M!==null&&M.memoizedState!==null,d.mode&1?(La=(Ot=La)||an,Qo(g,d),La=Ot):Qo(g,d),gl(d),O&8192){if(Ot=d.memoizedState!==null,(d.stateNode.isHidden=Ot)&&!an&&(d.mode&1)!==0)for(Zn=d,an=d.child;an!==null;){for(yn=Zn=an;Zn!==null;){switch(on=Zn,$n=on.child,on.tag){case 0:case 11:case 14:case 15:rp(4,on,on.return);break;case 1:np(on,on.return);var qn=on.stateNode;if(typeof qn.componentWillUnmount=="function"){O=on,M=on.return;try{g=O,qn.props=g.memoizedProps,qn.state=g.memoizedState,qn.componentWillUnmount()}catch(Qn){ks(O,M,Qn)}}break;case 5:np(on,on.return);break;case 22:if(on.memoizedState!==null){g5(yn);continue}}$n!==null?($n.return=on,Zn=$n):g5(yn)}an=an.sibling}e:for(an=null,yn=d;;){if(yn.tag===5){if(an===null){an=yn;try{q=yn.stateNode,Ot?(ee=q.style,typeof ee.setProperty=="function"?ee.setProperty("display","none","important"):ee.display="none"):(Fe=yn.stateNode,Xe=yn.memoizedProps.style,ge=Xe!=null&&Xe.hasOwnProperty("display")?Xe.display:null,Fe.style.display=Qt("display",ge))}catch(Qn){ks(d,d.return,Qn)}}}else if(yn.tag===6){if(an===null)try{yn.stateNode.nodeValue=Ot?"":yn.memoizedProps}catch(Qn){ks(d,d.return,Qn)}}else if((yn.tag!==22&&yn.tag!==23||yn.memoizedState===null||yn===d)&&yn.child!==null){yn.child.return=yn,yn=yn.child;continue}if(yn===d)break e;for(;yn.sibling===null;){if(yn.return===null||yn.return===d)break e;an===yn&&(an=null),yn=yn.return}an===yn&&(an=null),yn.sibling.return=yn.return,yn=yn.sibling}}break;case 19:Qo(g,d),gl(d),O&4&&X2(d);break;case 21:break;default:Qo(g,d),gl(d)}}function gl(d){var g=d.flags;if(g&2){try{e:{for(var M=d.return;M!==null;){if(cm(M)){var O=M;break e}M=M.return}throw Error(t(160))}switch(O.tag){case 5:var q=O.stateNode;O.flags&32&&(An(q,""),O.flags&=-33);var ee=f5(d);nc(d,ee,q);break;case 3:case 4:var ge=O.stateNode.containerInfo,Fe=f5(d);$2(d,Fe,ge);break;default:throw Error(t(161))}}catch(Xe){ks(d,d.return,Xe)}d.flags&=-3}g&4096&&(d.flags&=-4097)}function gy(d,g,M){Zn=d,p5(d)}function p5(d,g,M){for(var O=(d.mode&1)!==0;Zn!==null;){var q=Zn,ee=q.child;if(q.tag===22&&O){var ge=q.memoizedState!==null||um;if(!ge){var Fe=q.alternate,Xe=Fe!==null&&Fe.memoizedState!==null||La;Fe=um;var Ot=La;if(um=ge,(La=Xe)&&!Ot)for(Zn=q;Zn!==null;)ge=Zn,Xe=ge.child,ge.tag===22&&ge.memoizedState!==null?rc(q):Xe!==null?(Xe.return=ge,Zn=Xe):rc(q);for(;ee!==null;)Zn=ee,p5(ee),ee=ee.sibling;Zn=q,um=Fe,La=Ot}m5(d)}else(q.subtreeFlags&8772)!==0&&ee!==null?(ee.return=q,Zn=ee):m5(d)}}function m5(d){for(;Zn!==null;){var g=Zn;if((g.flags&8772)!==0){var M=g.alternate;try{if((g.flags&8772)!==0)switch(g.tag){case 0:case 11:case 15:La||Ed(5,g);break;case 1:var O=g.stateNode;if(g.flags&4&&!La)if(M===null)O.componentDidMount();else{var q=g.elementType===g.type?M.memoizedProps:ml(g.type,M.memoizedProps);O.componentDidUpdate(q,M.memoizedState,O.__reactInternalSnapshotBeforeUpdate)}var ee=g.updateQueue;ee!==null&&Xv(g,ee,O);break;case 3:var ge=g.updateQueue;if(ge!==null){if(M=null,g.child!==null)switch(g.child.tag){case 5:M=g.child.stateNode;break;case 1:M=g.child.stateNode}Xv(g,ge,M)}break;case 5:var Fe=g.stateNode;if(M===null&&g.flags&4){M=Fe;var Xe=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":Xe.autoFocus&&M.focus();break;case"img":Xe.src&&(M.src=Xe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var Ot=g.alternate;if(Ot!==null){var an=Ot.memoizedState;if(an!==null){var yn=an.dehydrated;yn!==null&&Jh(yn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}La||g.flags&512&&h5(g)}catch(on){ks(g,g.return,on)}}if(g===d){Zn=null;break}if(M=g.sibling,M!==null){M.return=g.return,Zn=M;break}Zn=g.return}}function g5(d){for(;Zn!==null;){var g=Zn;if(g===d){Zn=null;break}var M=g.sibling;if(M!==null){M.return=g.return,Zn=M;break}Zn=g.return}}function rc(d){for(;Zn!==null;){var g=Zn;try{switch(g.tag){case 0:case 11:case 15:var M=g.return;try{Ed(4,g)}catch(Xe){ks(g,M,Xe)}break;case 1:var O=g.stateNode;if(typeof O.componentDidMount=="function"){var q=g.return;try{O.componentDidMount()}catch(Xe){ks(g,q,Xe)}}var ee=g.return;try{h5(g)}catch(Xe){ks(g,ee,Xe)}break;case 5:var ge=g.return;try{h5(g)}catch(Xe){ks(g,ge,Xe)}}}catch(Xe){ks(g,g.return,Xe)}if(g===d){Zn=null;break}var Fe=g.sibling;if(Fe!==null){Fe.return=g.return,Zn=Fe;break}Zn=g.return}}var v5=Math.ceil,Y2=I.ReactCurrentDispatcher,K2=I.ReactCurrentOwner,ko=I.ReactCurrentBatchConfig,Ai=0,Ta=null,$s=null,Ma=0,Jo=0,ip=$u(0),Ur=0,ch=null,hu=0,sp=0,Z2=0,dm=null,fo=null,y5=0,ap=1/0,vl=null,fm=!1,_5=null,P0=null,pm=!1,du=null,mm=0,gm=0,Q2=null,J2=-1,e9=0;function Ca(){return(Ai&6)!==0?bt():J2!==-1?J2:J2=bt()}function yl(d){return(d.mode&1)===0?1:(Ai&2)!==0&&Ma!==0?Ma&-Ma:L4.transition!==null?(e9===0&&(e9=Oi()),e9):(d=hi,d!==0||(d=window.event,d=d===void 0?16:x1(d.type)),d)}function _l(d,g,M,O){if(50<gm)throw gm=0,Q2=null,Error(t(185));Is(d,M,O),((Ai&2)===0||d!==Ta)&&(d===Ta&&((Ai&2)===0&&(sp|=M),Ur===4&&ic(d,Ma)),po(d,O),M===1&&Ai===0&&(g.mode&1)===0&&(ap=bt()+500,ru&&hl()))}function po(d,g){var M=d.callbackNode;Na(d,g);var O=Rs(d,d===Ta?Ma:0);if(O===0)M!==null&&we(M),d.callbackNode=null,d.callbackPriority=0;else if(g=O&-O,d.callbackPriority!==g){if(M!=null&&we(M),g===1)d.tag===0?jv(b5.bind(null,d)):N4(b5.bind(null,d)),vx(function(){(Ai&6)===0&&hl()}),M=null;else{switch(ra(O)){case 1:M=vn;break;case 4:M=Dn;break;case 16:M=Bn;break;case 536870912:M=ur;break;default:M=Bn}M=l9(M,x5.bind(null,d))}d.callbackPriority=g,d.callbackNode=M}}function x5(d,g){if(J2=-1,e9=0,(Ai&6)!==0)throw Error(t(327));var M=d.callbackNode;if(Md()&&d.callbackNode!==M)return null;var O=Rs(d,d===Ta?Ma:0);if(O===0)return null;if((O&30)!==0||(O&d.expiredLanes)!==0||g)g=Td(d,O);else{g=O;var q=Ai;Ai|=2;var ee=w5();(Ta!==d||Ma!==g)&&(vl=null,ap=bt()+500,dh(d,g));do try{_y();break}catch(Fe){S5(d,Fe)}while(!0);E2(),Y2.current=ee,Ai=q,$s!==null?g=0:(Ta=null,Ma=0,g=Ur)}if(g!==0){if(g===2&&(q=x0(d),q!==0&&(O=q,g=t9(d,q))),g===1)throw M=ch,dh(d,0),ic(d,O),po(d,bt()),M;if(g===6)ic(d,O);else{if(q=d.current.alternate,(O&30)===0&&!vy(q)&&(g=Td(d,O),g===2&&(ee=x0(d),ee!==0&&(O=ee,g=t9(d,ee))),g===1))throw M=ch,dh(d,0),ic(d,O),po(d,bt()),M;switch(d.finishedWork=q,d.finishedLanes=O,g){case 0:case 1:throw Error(t(345));case 2:fh(d,fo,vl);break;case 3:if(ic(d,O),(O&130023424)===O&&(g=y5+500-bt(),10<g)){if(Rs(d,0)!==0)break;if(q=d.suspendedLanes,(q&O)!==O){Ca(),d.pingedLanes|=d.suspendedLanes&q;break}d.timeoutHandle=f2(fh.bind(null,d,fo,vl),g);break}fh(d,fo,vl);break;case 4:if(ic(d,O),(O&4194240)===O)break;for(g=d.eventTimes,q=-1;0<O;){var ge=31-Lr(O);ee=1<<ge,ge=g[ge],ge>q&&(q=ge),O&=~ee}if(O=q,O=bt()-O,O=(120>O?120:480>O?480:1080>O?1080:1920>O?1920:3e3>O?3e3:4320>O?4320:1960*v5(O/1960))-O,10<O){d.timeoutHandle=f2(fh.bind(null,d,fo,vl),O);break}fh(d,fo,vl);break;case 5:fh(d,fo,vl);break;default:throw Error(t(329))}}}return po(d,bt()),d.callbackNode===M?x5.bind(null,d):null}function t9(d,g){var M=dm;return d.current.memoizedState.isDehydrated&&(dh(d,g).flags|=256),d=Td(d,g),d!==2&&(g=fo,fo=M,g!==null&&n9(g)),d}function n9(d){fo===null?fo=d:fo.push.apply(fo,d)}function vy(d){for(var g=d;;){if(g.flags&16384){var M=g.updateQueue;if(M!==null&&(M=M.stores,M!==null))for(var O=0;O<M.length;O++){var q=M[O],ee=q.getSnapshot;q=q.value;try{if(!Da(ee(),q))return!1}catch{return!1}}}if(M=g.child,g.subtreeFlags&16384&&M!==null)M.return=g,g=M;else{if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function ic(d,g){for(g&=~Z2,g&=~sp,d.suspendedLanes|=g,d.pingedLanes&=~g,d=d.expirationTimes;0<g;){var M=31-Lr(g),O=1<<M;d[M]=-1,g&=~O}}function b5(d){if((Ai&6)!==0)throw Error(t(327));Md();var g=Rs(d,0);if((g&1)===0)return po(d,bt()),null;var M=Td(d,g);if(d.tag!==0&&M===2){var O=x0(d);O!==0&&(g=O,M=t9(d,O))}if(M===1)throw M=ch,dh(d,0),ic(d,g),po(d,bt()),M;if(M===6)throw Error(t(345));return d.finishedWork=d.current.alternate,d.finishedLanes=g,fh(d,fo,vl),po(d,bt()),null}function r9(d,g){var M=Ai;Ai|=1;try{return d(g)}finally{Ai=M,Ai===0&&(ap=bt()+500,ru&&hl())}}function hh(d){du!==null&&du.tag===0&&(Ai&6)===0&&Md();var g=Ai;Ai|=1;var M=ko.transition,O=hi;try{if(ko.transition=null,hi=1,d)return d()}finally{hi=O,ko.transition=M,Ai=g,(Ai&6)===0&&hl()}}function i9(){Jo=ip.current,ss(ip)}function dh(d,g){d.finishedWork=null,d.finishedLanes=0;var M=d.timeoutHandle;if(M!==-1&&(d.timeoutHandle=-1,is(M)),$s!==null)for(M=$s.return;M!==null;){var O=M;switch(y2(O),O.tag){case 1:O=O.type.childContextTypes,O!=null&&G1();break;case 3:ou(),ss(Ka),ss(Oa),C2();break;case 5:V4(O);break;case 4:ou();break;case 13:ss(ys);break;case 19:ss(ys);break;case 10:U4(O.type._context);break;case 22:case 23:i9()}M=M.return}if(Ta=d,$s=d=fu(d.current,null),Ma=Jo=g,Ur=0,ch=null,Z2=sp=hu=0,fo=dm=null,ih!==null){for(g=0;g<ih.length;g++)if(M=ih[g],O=M.interleaved,O!==null){M.interleaved=null;var q=O.next,ee=M.pending;if(ee!==null){var ge=ee.next;ee.next=q,O.next=ge}M.pending=O}ih=null}return d}function S5(d,g){do{var M=$s;try{if(E2(),A2.current=rm,P2){for(var O=ji.memoizedState;O!==null;){var q=O.queue;q!==null&&(q.pending=null),O=O.next}P2=!1}if(ah=0,ha=Es=ji=null,lu=!1,Zu=0,K2.current=null,M===null||M.return===null){Ur=1,ch=g,$s=null;break}e:{var ee=d,ge=M.return,Fe=M,Xe=g;if(g=Ma,Fe.flags|=32768,Xe!==null&&typeof Xe=="object"&&typeof Xe.then=="function"){var Ot=Xe,an=Fe,yn=an.tag;if((an.mode&1)===0&&(yn===0||yn===11||yn===15)){var on=an.alternate;on?(an.updateQueue=on.updateQueue,an.memoizedState=on.memoizedState,an.lanes=on.lanes):(an.updateQueue=null,an.memoizedState=null)}var $n=ny(ge);if($n!==null){$n.flags&=-257,t5($n,ge,Fe,ee,g),$n.mode&1&&ty(ee,Ot,g),g=$n,Xe=Ot;var qn=g.updateQueue;if(qn===null){var Qn=new Set;Qn.add(Xe),g.updateQueue=Qn}else qn.add(Xe);break e}else{if((g&1)===0){ty(ee,Ot,g),vm();break e}Xe=Error(t(426))}}else if(vs&&Fe.mode&1){var qs=ny(ge);if(qs!==null){(qs.flags&65536)===0&&(qs.flags|=256),t5(qs,ge,Fe,ee,g),rh(ec(Xe,Fe));break e}}ee=Xe=ec(Xe,Fe),Ur!==4&&(Ur=2),dm===null?dm=[ee]:dm.push(ee),ee=ge;do{switch(ee.tag){case 3:ee.flags|=65536,g&=-g,ee.lanes|=g;var xt=e5(ee,Xe,g);xd(ee,xt);break e;case 1:Fe=Xe;var tt=ee.type,At=ee.stateNode;if((ee.flags&128)===0&&(typeof tt.getDerivedStateFromError=="function"||At!==null&&typeof At.componentDidCatch=="function"&&(P0===null||!P0.has(At)))){ee.flags|=65536,g&=-g,ee.lanes|=g;var En=am(ee,Fe,g);xd(ee,En);break e}}ee=ee.return}while(ee!==null)}E5(M)}catch(cr){g=cr,$s===M&&M!==null&&($s=M=M.return);continue}break}while(!0)}function w5(){var d=Y2.current;return Y2.current=rm,d===null?rm:d}function vm(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),Ta===null||(hu&268435455)===0&&(sp&268435455)===0||ic(Ta,Ma)}function Td(d,g){var M=Ai;Ai|=2;var O=w5();(Ta!==d||Ma!==g)&&(vl=null,dh(d,g));do try{yy();break}catch(q){S5(d,q)}while(!0);if(E2(),Ai=M,Y2.current=O,$s!==null)throw Error(t(261));return Ta=null,Ma=0,Ur}function yy(){for(;$s!==null;)s9($s)}function _y(){for(;$s!==null&&!st();)s9($s)}function s9(d){var g=lp(d.alternate,d,Jo);d.memoizedProps=d.pendingProps,g===null?E5(d):$s=g,K2.current=null}function E5(d){var g=d;do{var M=g.alternate;if(d=g.return,(g.flags&32768)===0){if(M=u5(M,g,Jo),M!==null){$s=M;return}}else{if(M=py(M,g),M!==null){M.flags&=32767,$s=M;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Ur=6,$s=null;return}}if(g=g.sibling,g!==null){$s=g;return}$s=g=d}while(g!==null);Ur===0&&(Ur=5)}function fh(d,g,M){var O=hi,q=ko.transition;try{ko.transition=null,hi=1,xy(d,g,M,O)}finally{ko.transition=q,hi=O}return null}function xy(d,g,M,O){do Md();while(du!==null);if((Ai&6)!==0)throw Error(t(327));M=d.finishedWork;var q=d.finishedLanes;if(M===null)return null;if(d.finishedWork=null,d.finishedLanes=0,M===d.current)throw Error(t(177));d.callbackNode=null,d.callbackPriority=0;var ee=M.lanes|M.childLanes;if(Hs(d,ee),d===Ta&&($s=Ta=null,Ma=0),(M.subtreeFlags&2064)===0&&(M.flags&2064)===0||pm||(pm=!0,l9(Bn,function(){return Md(),null})),ee=(M.flags&15990)!==0,(M.subtreeFlags&15990)!==0||ee){ee=ko.transition,ko.transition=null;var ge=hi;hi=1;var Fe=Ai;Ai|=4,K2.current=null,my(d,M),hm(M,d),mx(h2),Xo=!!c2,h2=c2=null,d.current=M,gy(M),Pt(),Ai=Fe,hi=ge,ko.transition=ee}else d.current=M;if(pm&&(pm=!1,du=d,mm=q),ee=d.pendingLanes,ee===0&&(P0=null),Fr(M.stateNode),po(d,bt()),g!==null)for(O=d.onRecoverableError,M=0;M<g.length;M++)q=g[M],O(q.value,{componentStack:q.stack,digest:q.digest});if(fm)throw fm=!1,d=_5,_5=null,d;return(mm&1)!==0&&d.tag!==0&&Md(),ee=d.pendingLanes,(ee&1)!==0?d===Q2?gm++:(gm=0,Q2=d):gm=0,hl(),null}function Md(){if(du!==null){var d=ra(mm),g=ko.transition,M=hi;try{if(ko.transition=null,hi=16>d?16:d,du===null)var O=!1;else{if(d=du,du=null,mm=0,(Ai&6)!==0)throw Error(t(331));var q=Ai;for(Ai|=4,Zn=d.current;Zn!==null;){var ee=Zn,ge=ee.child;if((Zn.flags&16)!==0){var Fe=ee.deletions;if(Fe!==null){for(var Xe=0;Xe<Fe.length;Xe++){var Ot=Fe[Xe];for(Zn=Ot;Zn!==null;){var an=Zn;switch(an.tag){case 0:case 11:case 15:rp(8,an,ee)}var yn=an.child;if(yn!==null)yn.return=an,Zn=yn;else for(;Zn!==null;){an=Zn;var on=an.sibling,$n=an.return;if(d5(an),an===Ot){Zn=null;break}if(on!==null){on.return=$n,Zn=on;break}Zn=$n}}}var qn=ee.alternate;if(qn!==null){var Qn=qn.child;if(Qn!==null){qn.child=null;do{var qs=Qn.sibling;Qn.sibling=null,Qn=qs}while(Qn!==null)}}Zn=ee}}if((ee.subtreeFlags&2064)!==0&&ge!==null)ge.return=ee,Zn=ge;else e:for(;Zn!==null;){if(ee=Zn,(ee.flags&2048)!==0)switch(ee.tag){case 0:case 11:case 15:rp(9,ee,ee.return)}var xt=ee.sibling;if(xt!==null){xt.return=ee.return,Zn=xt;break e}Zn=ee.return}}var tt=d.current;for(Zn=tt;Zn!==null;){ge=Zn;var At=ge.child;if((ge.subtreeFlags&2064)!==0&&At!==null)At.return=ge,Zn=At;else e:for(ge=tt;Zn!==null;){if(Fe=Zn,(Fe.flags&2048)!==0)try{switch(Fe.tag){case 0:case 11:case 15:Ed(9,Fe)}}catch(cr){ks(Fe,Fe.return,cr)}if(Fe===ge){Zn=null;break e}var En=Fe.sibling;if(En!==null){En.return=Fe.return,Zn=En;break e}Zn=Fe.return}}if(Ai=q,hl(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(vr,d)}catch{}O=!0}return O}finally{hi=M,ko.transition=g}}return!1}function by(d,g,M){g=ec(M,g),g=e5(d,g,1),d=pl(d,g,1),g=Ca(),d!==null&&(Is(d,1,g),po(d,g))}function ks(d,g,M){if(d.tag===3)by(d,d,M);else for(;g!==null;){if(g.tag===3){by(g,d,M);break}else if(g.tag===1){var O=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(P0===null||!P0.has(O))){d=ec(M,d),d=am(g,d,1),g=pl(g,d,1),d=Ca(),g!==null&&(Is(g,1,d),po(g,d));break}}g=g.return}}function Sy(d,g,M){var O=d.pingCache;O!==null&&O.delete(g),g=Ca(),d.pingedLanes|=d.suspendedLanes&M,Ta===d&&(Ma&M)===M&&(Ur===4||Ur===3&&(Ma&130023424)===Ma&&500>bt()-y5?dh(d,0):Z2|=M),po(d,g)}function a9(d,g){g===0&&((d.mode&1)===0?g=1:(g=Qi,Qi<<=1,(Qi&130023424)===0&&(Qi=4194304)));var M=Ca();d=Ku(d,g),d!==null&&(Is(d,g,M),po(d,M))}function o9(d){var g=d.memoizedState,M=0;g!==null&&(M=g.retryLane),a9(d,M)}function op(d,g){var M=0;switch(d.tag){case 13:var O=d.stateNode,q=d.memoizedState;q!==null&&(M=q.retryLane);break;case 19:O=d.stateNode;break;default:throw Error(t(314))}O!==null&&O.delete(g),a9(d,M)}var lp;lp=function(d,g,M){if(d!==null)if(d.memoizedProps!==g.pendingProps||Ka.current)Io=!0;else{if((d.lanes&M)===0&&(g.flags&128)===0)return Io=!1,hy(d,g,M);Io=(d.flags&131072)!==0}else Io=!1,vs&&(g.flags&1048576)!==0&&Wv(g,Xu,g.index);switch(g.lanes=0,g.tag){case 2:var O=g.type;lm(d,g),d=g.pendingProps;var q=dd(g,Oa.current);Yu(g,M),q=Yf(null,g,O,d,q,M);var ee=Q1();return g.flags|=1,typeof q=="object"&&q!==null&&typeof q.render=="function"&&q.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Co(O)?(ee=!0,v2(g)):ee=!1,g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,T2(g),q.updater=im,g.stateNode=q,q._reactInternals=g,V2(g,O,d,M),g=r5(null,g,O,!0,ee,M)):(g.tag=0,vs&&ee&&H1(g),ii(null,g,q,M),g=g.child),g;case 16:O=g.elementType;e:{switch(lm(d,g),d=g.pendingProps,q=O._init,O=q(O._payload),g.type=O,q=g.tag=c9(O),d=ml(O,d),q){case 0:g=H2(null,g,O,d,M);break e;case 1:g=ay(null,g,O,d,M);break e;case 11:g=Jf(null,g,O,d,M);break e;case 14:g=ry(null,g,O,ml(O.type,d),M);break e}throw Error(t(306,O,""))}return g;case 0:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ml(O,q),H2(d,g,O,q,M);case 1:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ml(O,q),ay(d,g,O,q,M);case 3:e:{if(i5(g),d===null)throw Error(t(387));O=g.pendingProps,ee=g.memoizedState,q=ee.element,_d(d,g),$f(g,O,null,M);var ge=g.memoizedState;if(O=ge.element,ee.isDehydrated)if(ee={element:O,isDehydrated:!1,cache:ge.cache,pendingSuspenseBoundaries:ge.pendingSuspenseBoundaries,transitions:ge.transitions},g.updateQueue.baseState=ee,g.memoizedState=ee,g.flags&256){q=ec(Error(t(423)),g),g=oy(d,g,O,M,q);break e}else if(O!==q){q=ec(Error(t(424)),g),g=oy(d,g,O,M,q);break e}else for(Ro=eu(g.stateNode.containerInfo.firstChild),Po=g,vs=!0,fl=null,M=gd(g,null,O,M),g.child=M;M;)M.flags=M.flags&-3|4096,M=M.sibling;else{if(jf(),O===q){g=tc(d,g,M);break e}ii(d,g,O,M)}g=g.child}return g;case 5:return Z1(g),d===null&&O4(g),O=g.type,q=g.pendingProps,ee=d!==null?d.memoizedProps:null,ge=q.children,d2(O,q)?ge=null:ee!==null&&d2(O,ee)&&(g.flags|=32),sy(d,g),ii(d,g,ge,M),g.child;case 6:return d===null&&O4(g),null;case 13:return ly(d,g,M);case 4:return z4(g,g.stateNode.containerInfo),O=g.pendingProps,d===null?g.child=Wf(g,null,O,M):ii(d,g,O,M),g.child;case 11:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ml(O,q),Jf(d,g,O,q,M);case 7:return ii(d,g,g.pendingProps,M),g.child;case 8:return ii(d,g,g.pendingProps.children,M),g.child;case 12:return ii(d,g,g.pendingProps.children,M),g.child;case 10:e:{if(O=g.type._context,q=g.pendingProps,ee=g.memoizedProps,ge=q.value,as(vd,O._currentValue),O._currentValue=ge,ee!==null)if(Da(ee.value,ge)){if(ee.children===q.children&&!Ka.current){g=tc(d,g,M);break e}}else for(ee=g.child,ee!==null&&(ee.return=g);ee!==null;){var Fe=ee.dependencies;if(Fe!==null){ge=ee.child;for(var Xe=Fe.firstContext;Xe!==null;){if(Xe.context===O){if(ee.tag===1){Xe=Yo(-1,M&-M),Xe.tag=2;var Ot=ee.updateQueue;if(Ot!==null){Ot=Ot.shared;var an=Ot.pending;an===null?Xe.next=Xe:(Xe.next=an.next,an.next=Xe),Ot.pending=Xe}}ee.lanes|=M,Xe=ee.alternate,Xe!==null&&(Xe.lanes|=M),q1(ee.return,M,g),Fe.lanes|=M;break}Xe=Xe.next}}else if(ee.tag===10)ge=ee.type===g.type?null:ee.child;else if(ee.tag===18){if(ge=ee.return,ge===null)throw Error(t(341));ge.lanes|=M,Fe=ge.alternate,Fe!==null&&(Fe.lanes|=M),q1(ge,M,g),ge=ee.sibling}else ge=ee.child;if(ge!==null)ge.return=ee;else for(ge=ee;ge!==null;){if(ge===g){ge=null;break}if(ee=ge.sibling,ee!==null){ee.return=ge.return,ge=ee;break}ge=ge.return}ee=ge}ii(d,g,q.children,M),g=g.child}return g;case 9:return q=g.type,O=g.pendingProps.children,Yu(g,M),q=A0(q),O=O(q),g.flags|=1,ii(d,g,O,M),g.child;case 14:return O=g.type,q=ml(O,g.pendingProps),q=ml(O.type,q),ry(d,g,O,q,M);case 15:return n5(d,g,g.type,g.pendingProps,M);case 17:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ml(O,q),lm(d,g),g.tag=1,Co(O)?(d=!0,v2(g)):d=!1,Yu(g,M),lh(g,O,q),V2(g,O,q,M),r5(null,g,O,!0,d,M);case 19:return ep(d,g,M);case 22:return iy(d,g,M)}throw Error(t(156,g.tag))};function l9(d,g){return Rf(d,g)}function T5(d,g,M,O){this.tag=d,this.key=M,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function R0(d,g,M,O){return new T5(d,g,M,O)}function u9(d){return d=d.prototype,!(!d||!d.isReactComponent)}function c9(d){if(typeof d=="function")return u9(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Be)return 11;if(d===ot)return 14}return 2}function fu(d,g){var M=d.alternate;return M===null?(M=R0(d.tag,g,d.key,d.mode),M.elementType=d.elementType,M.type=d.type,M.stateNode=d.stateNode,M.alternate=d,d.alternate=M):(M.pendingProps=g,M.type=d.type,M.flags=0,M.subtreeFlags=0,M.deletions=null),M.flags=d.flags&14680064,M.childLanes=d.childLanes,M.lanes=d.lanes,M.child=d.child,M.memoizedProps=d.memoizedProps,M.memoizedState=d.memoizedState,M.updateQueue=d.updateQueue,g=d.dependencies,M.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},M.sibling=d.sibling,M.index=d.index,M.ref=d.ref,M}function h9(d,g,M,O,q,ee){var ge=2;if(O=d,typeof d=="function")u9(d)&&(ge=1);else if(typeof d=="string")ge=5;else e:switch(d){case ue:return ph(M.children,q,ee,g);case Q:ge=8,q|=8;break;case oe:return d=R0(12,M,g,q|2),d.elementType=oe,d.lanes=ee,d;case He:return d=R0(13,M,g,q),d.elementType=He,d.lanes=ee,d;case rt:return d=R0(19,M,g,q),d.elementType=rt,d.lanes=ee,d;case gt:return ym(M,q,ee,g);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case le:ge=10;break e;case J:ge=9;break e;case Be:ge=11;break e;case ot:ge=14;break e;case Se:ge=16,O=null;break e}throw Error(t(130,d==null?d:typeof d,""))}return g=R0(ge,M,g,q),g.elementType=d,g.type=O,g.lanes=ee,g}function ph(d,g,M,O){return d=R0(7,d,O,g),d.lanes=M,d}function ym(d,g,M,O){return d=R0(22,d,O,g),d.elementType=gt,d.lanes=M,d.stateNode={isHidden:!1},d}function d9(d,g,M){return d=R0(6,d,null,g),d.lanes=M,d}function M5(d,g,M){return g=R0(4,d.children!==null?d.children:[],d.key,g),g.lanes=M,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}function wy(d,g,M,O,q){this.tag=g,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gs(0),this.expirationTimes=gs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gs(0),this.identifierPrefix=O,this.onRecoverableError=q,this.mutableSourceEagerHydrationData=null}function _m(d,g,M,O,q,ee,ge,Fe,Xe){return d=new wy(d,g,M,Fe,Xe),g===1?(g=1,ee===!0&&(g|=8)):g=0,ee=R0(3,null,null,g),d.current=ee,ee.stateNode=d,ee.memoizedState={element:O,isDehydrated:M,cache:null,transitions:null,pendingSuspenseBoundaries:null},T2(ee),d}function Ey(d,g,M){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ce,key:O==null?null:""+O,children:d,containerInfo:g,implementation:M}}function Ty(d){if(!d)return nu;d=d._reactInternals;e:{if(ua(d)!==d||d.tag!==1)throw Error(t(170));var g=d;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Co(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(t(171))}if(d.tag===1){var M=d.type;if(Co(M))return I4(d,M,g)}return g}function f9(d,g,M,O,q,ee,ge,Fe,Xe){return d=_m(M,O,!0,d,q,ee,ge,Fe,Xe),d.context=Ty(null),M=d.current,O=Ca(),q=yl(M),ee=Yo(O,q),ee.callback=g??null,pl(M,ee,q),d.current.lanes=q,Is(d,q,O),po(d,O),d}function p9(d,g,M,O){var q=g.current,ee=Ca(),ge=yl(q);return M=Ty(M),g.context===null?g.context=M:g.pendingContext=M,g=Yo(ee,ge),g.payload={element:d},O=O===void 0?null:O,O!==null&&(g.callback=O),d=pl(q,g,ge),d!==null&&(_l(d,q,ge,ee),Y1(d,q,ge)),ge}function m9(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function g9(d,g){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var M=d.retryLane;d.retryLane=M!==0&&M<g?M:g}}function v9(d,g){g9(d,g),(d=d.alternate)&&g9(d,g)}function Sx(){return null}var C5=typeof reportError=="function"?reportError:function(d){console.error(d)};function A5(d){this._internalRoot=d}y9.prototype.render=A5.prototype.render=function(d){var g=this._internalRoot;if(g===null)throw Error(t(409));p9(d,g,null,null)},y9.prototype.unmount=A5.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var g=d.containerInfo;hh(function(){p9(null,d,null,null)}),g[tu]=null}};function y9(d){this._internalRoot=d}y9.prototype.unstable_scheduleHydration=function(d){if(d){var g=g1();d={blockedOn:null,target:d,priority:g};for(var M=0;M<rl.length&&g!==0&&g<rl[M].priority;M++);rl.splice(M,0,d),M===0&&Yl(d)}};function _9(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function x9(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function My(){}function Cy(d,g,M,O,q){if(q){if(typeof O=="function"){var ee=O;O=function(){var Ot=m9(ge);ee.call(Ot)}}var ge=f9(g,O,d,0,null,!1,!1,"",My);return d._reactRootContainer=ge,d[tu]=ge.current,Vf(d.nodeType===8?d.parentNode:d),hh(),ge}for(;q=d.lastChild;)d.removeChild(q);if(typeof O=="function"){var Fe=O;O=function(){var Ot=m9(Xe);Fe.call(Ot)}}var Xe=_m(d,0,!1,null,null,!1,!1,"",My);return d._reactRootContainer=Xe,d[tu]=Xe.current,Vf(d.nodeType===8?d.parentNode:d),hh(function(){p9(g,Xe,M,O)}),Xe}function b9(d,g,M,O,q){var ee=M._reactRootContainer;if(ee){var ge=ee;if(typeof q=="function"){var Fe=q;q=function(){var Xe=m9(ge);Fe.call(Xe)}}p9(g,ge,d,q)}else ge=Cy(M,g,d,q,O);return m9(ge)}Zh=function(d){switch(d.tag){case 3:var g=d.stateNode;if(g.current.memoizedState.isDehydrated){var M=Zr(g.pendingLanes);M!==0&&(ws(g,M|1),po(g,bt()),(Ai&6)===0&&(ap=bt()+500,hl()))}break;case 13:hh(function(){var O=Ku(d,1);if(O!==null){var q=Ca();_l(O,d,1,q)}}),v9(d,1)}},m1=function(d){if(d.tag===13){var g=Ku(d,134217728);if(g!==null){var M=Ca();_l(g,d,134217728,M)}v9(d,134217728)}},Xl=function(d){if(d.tag===13){var g=yl(d),M=Ku(d,g);if(M!==null){var O=Ca();_l(M,d,g,O)}v9(d,g)}},g1=function(){return hi},jg=function(d,g){var M=hi;try{return hi=d,g()}finally{hi=M}},Tn=function(d,g,M){switch(g){case"input":if(Ci(d,M),g=M.name,M.type==="radio"&&g!=null){for(M=d;M.parentNode;)M=M.parentNode;for(M=M.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<M.length;g++){var O=M[g];if(O!==d&&O.form===d.form){var q=g2(O);if(!q)throw Error(t(90));oi(O),Ci(O,q)}}}break;case"textarea":_e(d,M);break;case"select":g=M.value,g!=null&&fr(d,!!M.multiple,g,!1)}},br=r9,xi=hh;var Ay={usingClientEntryPoint:!1,Events:[hd,ju,g2,en,Yn,r9]},up={findFiberByHostInstance:T0,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wx={bundleType:up.bundleType,version:up.version,rendererPackageName:up.rendererPackageName,rendererConfig:up.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Yh(d),d===null?null:d.stateNode},findFiberByHostInstance:up.findFiberByHostInstance||Sx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var S9=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!S9.isDisabled&&S9.supportsFiber)try{vr=S9.inject(wx),Kn=S9}catch{}}return Tu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ay,Tu.createPortal=function(d,g){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_9(g))throw Error(t(200));return Ey(d,g,null,M)},Tu.createRoot=function(d,g){if(!_9(d))throw Error(t(299));var M=!1,O="",q=C5;return g!=null&&(g.unstable_strictMode===!0&&(M=!0),g.identifierPrefix!==void 0&&(O=g.identifierPrefix),g.onRecoverableError!==void 0&&(q=g.onRecoverableError)),g=_m(d,1,!1,null,null,M,!1,O,q),d[tu]=g.current,Vf(d.nodeType===8?d.parentNode:d),new A5(g)},Tu.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var g=d._reactInternals;if(g===void 0)throw typeof d.render=="function"?Error(t(188)):(d=Object.keys(d).join(","),Error(t(268,d)));return d=Yh(g),d=d===null?null:d.stateNode,d},Tu.flushSync=function(d){return hh(d)},Tu.hydrate=function(d,g,M){if(!x9(g))throw Error(t(200));return b9(null,d,g,!0,M)},Tu.hydrateRoot=function(d,g,M){if(!_9(d))throw Error(t(405));var O=M!=null&&M.hydratedSources||null,q=!1,ee="",ge=C5;if(M!=null&&(M.unstable_strictMode===!0&&(q=!0),M.identifierPrefix!==void 0&&(ee=M.identifierPrefix),M.onRecoverableError!==void 0&&(ge=M.onRecoverableError)),g=f9(g,null,d,1,M??null,q,!1,ee,ge),d[tu]=g.current,Vf(d),O)for(d=0;d<O.length;d++)M=O[d],q=M._getVersion,q=q(M._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[M,q]:g.mutableSourceEagerHydrationData.push(M,q);return new y9(g)},Tu.render=function(d,g,M){if(!x9(g))throw Error(t(200));return b9(null,d,g,!1,M)},Tu.unmountComponentAtNode=function(d){if(!x9(d))throw Error(t(40));return d._reactRootContainer?(hh(function(){b9(null,null,d,!1,function(){d._reactRootContainer=null,d[tu]=null})}),!0):!1},Tu.unstable_batchedUpdates=r9,Tu.unstable_renderSubtreeIntoContainer=function(d,g,M,O){if(!x9(M))throw Error(t(200));if(d==null||d._reactInternals===void 0)throw Error(t(38));return b9(d,g,M,!1,O)},Tu.version="18.3.1-next-f1338f8080-20240426",Tu}var $pe;function dTe(){if($pe)return mz.exports;$pe=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),mz.exports=hTe(),mz.exports}var qpe;function fTe(){if(qpe)return JP;qpe=1;var s=dTe();return JP.createRoot=s.createRoot,JP.hydrateRoot=s.hydrateRoot,JP}var pTe=fTe();const mTe=h9e(pTe);function eR(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yw={exports:{}},yz={},Xpe;function mn(){return Xpe||(Xpe=1,function(s){var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(de,Pe,Ye)=>Pe in de?e(de,Pe,{enumerable:!0,configurable:!0,writable:!0,value:Ye}):de[Pe]=Ye,h=(de,Pe)=>{for(var Ye in Pe||(Pe={}))i.call(Pe,Ye)&&l(de,Ye,Pe[Ye]);if(r)for(var Ye of r(Pe))o.call(Pe,Ye)&&l(de,Ye,Pe[Ye]);return de},p=(de,Pe)=>t(de,n(Pe)),y=de=>e(de,"__esModule",{value:!0}),x=(de,Pe)=>{y(de);for(var Ye in Pe)e(de,Ye,{get:Pe[Ye],enumerable:!0})};x(s,{Atom:()=>R1,PointerProxy:()=>N1,Ticker:()=>ad,getPointerParts:()=>S0,isPointer:()=>sl,isPrism:()=>Ql,iterateAndCountTicks:()=>Kc,iterateOver:()=>k1,pointer:()=>td,pointerToPrism:()=>sd,prism:()=>Jl,val:()=>ll});var S=Array.isArray,A=S,k=typeof xa=="object"&&xa&&xa.Object===Object&&xa,L=k,U=typeof self=="object"&&self&&self.Object===Object&&self,P=L||U||Function("return this")(),$=P,Z=$.Symbol,I=Z,ie=Object.prototype,ce=ie.hasOwnProperty,ue=ie.toString,Q=I?I.toStringTag:void 0;function oe(de){var Pe=ce.call(de,Q),Ye=de[Q];try{de[Q]=void 0;var Bt=!0}catch{}var Cr=ue.call(de);return Bt&&(Pe?de[Q]=Ye:delete de[Q]),Cr}var le=oe,J=Object.prototype,Be=J.toString;function He(de){return Be.call(de)}var rt=He,ot="[object Null]",Se="[object Undefined]",gt=I?I.toStringTag:void 0;function Ae(de){return de==null?de===void 0?Se:ot:gt&&gt in Object(de)?le(de):rt(de)}var lt=Ae;function pt(de){return de!=null&&typeof de=="object"}var De=pt,_t="[object Symbol]";function Jt(de){return typeof de=="symbol"||De(de)&&lt(de)==_t}var dt=Jt,Dt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gn=/^\w*$/;function qt(de,Pe){if(A(de))return!1;var Ye=typeof de;return Ye=="number"||Ye=="symbol"||Ye=="boolean"||de==null||dt(de)?!0:gn.test(de)||!Dt.test(de)||Pe!=null&&de in Object(Pe)}var wn=qt;function rr(de){var Pe=typeof de;return de!=null&&(Pe=="object"||Pe=="function")}var Xn=rr,ni="[object AsyncFunction]",oi="[object Function]",$r="[object GeneratorFunction]",$e="[object Proxy]";function zs(de){if(!Xn(de))return!1;var Pe=lt(de);return Pe==oi||Pe==$r||Pe==ni||Pe==$e}var li=zs,Ci=$["__core-js_shared__"],Ln=Ci,Ar=function(){var de=/[^.]+$/.exec(Ln&&Ln.keys&&Ln.keys.IE_PROTO||"");return de?"Symbol(src)_1."+de:""}();function ar(de){return!!Ar&&Ar in de}var fr=ar,gi=Function.prototype,Oe=gi.toString;function _e(de){if(de!=null){try{return Oe.call(de)}catch{}try{return de+""}catch{}}return""}var Ct=_e,Kt=/[\\^$.*+?()[\]{}|]/g,Zt=/^\[object .+?Constructor\]$/,Ht=Function.prototype,or=Object.prototype,An=Ht.toString,Hn=or.hasOwnProperty,lr=RegExp("^"+An.call(Hn).replace(Kt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qt(de){if(!Xn(de)||fr(de))return!1;var Pe=li(de)?lr:Zt;return Pe.test(Ct(de))}var jn=Qt;function Mr(de,Pe){return de==null?void 0:de[Pe]}var gr=Mr;function Pn(de,Pe){var Ye=gr(de,Pe);return jn(Ye)?Ye:void 0}var Sr=Pn,Ze=Sr(Object,"create"),Tn=Ze;function nn(){this.__data__=Tn?Tn(null):{},this.size=0}var kn=nn;function ln(de){var Pe=this.has(de)&&delete this.__data__[de];return this.size-=Pe?1:0,Pe}var en=ln,Yn="__lodash_hash_undefined__",br=Object.prototype,xi=br.hasOwnProperty;function Kr(de){var Pe=this.__data__;if(Tn){var Ye=Pe[de];return Ye===Yn?void 0:Ye}return xi.call(Pe,de)?Pe[de]:void 0}var Vs=Kr,la=Object.prototype,Fu=la.hasOwnProperty;function Ps(de){var Pe=this.__data__;return Tn?Pe[de]!==void 0:Fu.call(Pe,de)}var Gs=Ps,_0="__lodash_hash_undefined__";function $l(de,Pe){var Ye=this.__data__;return this.size+=this.has(de)?0:1,Ye[de]=Tn&&Pe===void 0?_0:Pe,this}var tl=$l;function ka(de){var Pe=-1,Ye=de==null?0:de.length;for(this.clear();++Pe<Ye;){var Bt=de[Pe];this.set(Bt[0],Bt[1])}}ka.prototype.clear=kn,ka.prototype.delete=en,ka.prototype.get=Vs,ka.prototype.has=Gs,ka.prototype.set=tl;var Lc=ka;function Uc(){this.__data__=[],this.size=0}var Pf=Uc;function ua(de,Pe){return de===Pe||de!==de&&Pe!==Pe}var Xh=ua;function ql(de,Pe){for(var Ye=de.length;Ye--;)if(Xh(de[Ye][0],Pe))return Ye;return-1}var Bc=ql,Yh=Array.prototype,Kh=Yh.splice;function Rf(de){var Pe=this.__data__,Ye=Bc(Pe,de);if(Ye<0)return!1;var Bt=Pe.length-1;return Ye==Bt?Pe.pop():Kh.call(Pe,Ye,1),--this.size,!0}var we=Rf;function st(de){var Pe=this.__data__,Ye=Bc(Pe,de);return Ye<0?void 0:Pe[Ye][1]}var Pt=st;function bt(de){return Bc(this.__data__,de)>-1}var ht=bt;function vn(de,Pe){var Ye=this.__data__,Bt=Bc(Ye,de);return Bt<0?(++this.size,Ye.push([de,Pe])):Ye[Bt][1]=Pe,this}var Dn=vn;function Bn(de){var Pe=-1,Ye=de==null?0:de.length;for(this.clear();++Pe<Ye;){var Bt=de[Pe];this.set(Bt[0],Bt[1])}}Bn.prototype.clear=Pf,Bn.prototype.delete=we,Bn.prototype.get=Pt,Bn.prototype.has=ht,Bn.prototype.set=Dn;var Wn=Bn,ur=Sr($,"Map"),vr=ur;function Kn(){this.size=0,this.__data__={hash:new Lc,map:new(vr||Wn),string:new Lc}}var Fr=Kn;function Lr(de){var Pe=typeof de;return Pe=="string"||Pe=="number"||Pe=="symbol"||Pe=="boolean"?de!=="__proto__":de===null}var Di=Lr;function Zi(de,Pe){var Ye=de.__data__;return Di(Pe)?Ye[typeof Pe=="string"?"string":"hash"]:Ye.map}var ri=Zi;function er(de){var Pe=ri(this,de).delete(de);return this.size-=Pe?1:0,Pe}var Qi=er;function Zr(de){return ri(this,de).get(de)}var Rs=Zr;function qo(de){return ri(this,de).has(de)}var Na=qo;function x0(de,Pe){var Ye=ri(this,de),Bt=Ye.size;return Ye.set(de,Pe),this.size+=Ye.size==Bt?0:1,this}var Oi=x0;function gs(de){var Pe=-1,Ye=de==null?0:de.length;for(this.clear();++Pe<Ye;){var Bt=de[Pe];this.set(Bt[0],Bt[1])}}gs.prototype.clear=Fr,gs.prototype.delete=Qi,gs.prototype.get=Rs,gs.prototype.has=Na,gs.prototype.set=Oi;var Is=gs,Hs="Expected a function";function ws(de,Pe){if(typeof de!="function"||Pe!=null&&typeof Pe!="function")throw new TypeError(Hs);var Ye=function(){var Bt=arguments,Cr=Pe?Pe.apply(this,Bt):Bt[0],di=Ye.cache;if(di.has(Cr))return di.get(Cr);var ia=de.apply(this,Bt);return Ye.cache=di.set(Cr,ia)||di,ia};return Ye.cache=new(ws.Cache||Is),Ye}ws.Cache=Is;var hi=ws,ra=500;function Zh(de){var Pe=hi(de,function(Bt){return Ye.size===ra&&Ye.clear(),Bt}),Ye=Pe.cache;return Pe}var m1=Zh,Xl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g1=/\\(\\)?/g,jg=m1(function(de){var Pe=[];return de.charCodeAt(0)===46&&Pe.push(""),de.replace(Xl,function(Ye,Bt,Cr,di){Pe.push(Cr?di.replace(g1,"$1"):Bt||Ye)}),Pe}),v1=jg;function Qh(de,Pe){for(var Ye=-1,Bt=de==null?0:de.length,Cr=Array(Bt);++Ye<Bt;)Cr[Ye]=Pe(de[Ye],Ye,de);return Cr}var nl=Qh,js=I?I.prototype:void 0,b0=js?js.toString:void 0;function zc(de){if(typeof de=="string")return de;if(A(de))return nl(de,zc)+"";if(dt(de))return b0?b0.call(de):"";var Pe=de+"";return Pe=="0"&&1/de==-1/0?"-0":Pe}var Vc=zc;function rl(de){return de==null?"":Vc(de)}var Wg=rl;function y1(de,Pe){return A(de)?de:wn(de,Pe)?[de]:v1(Wg(de))}var Gc=y1;function $g(de){if(typeof de=="string"||dt(de))return de;var Pe=de+"";return Pe=="0"&&1/de==-1/0?"-0":Pe}var Yl=$g;function Kl(de,Pe){Pe=Gc(Pe,de);for(var Ye=0,Bt=Pe.length;de!=null&&Ye<Bt;)de=de[Yl(Pe[Ye++])];return Ye&&Ye==Bt?de:void 0}var qg=Kl;function _1(de,Pe,Ye){var Bt=de==null?void 0:qg(de,Pe);return Bt===void 0?Ye:Bt}var Hc=_1;function Jh(de,Pe){return function(Ye){return de(Pe(Ye))}}var jc=Jh,Xo=jc(Object.getPrototypeOf,Object),Lu=Xo,Xg="[object Object]",Wc=Function.prototype,If=Object.prototype,kf=Wc.toString,x1=If.hasOwnProperty,il=kf.call(Object);function Nf(de){if(!De(de)||lt(de)!=Xg)return!1;var Pe=Lu(de);if(Pe===null)return!0;var Ye=x1.call(Pe,"constructor")&&Pe.constructor;return typeof Ye=="function"&&Ye instanceof Ye&&kf.call(Ye)==il}var $c=Nf;function b1(de){var Pe=de==null?0:de.length;return Pe?de[Pe-1]:void 0}var Df=b1,Zl=new WeakMap,S1=new WeakMap,ca=Symbol("pointerMeta"),Uu={get(de,Pe){if(Pe===ca)return Zl.get(de);let Ye=S1.get(de);Ye||(Ye=new Map,S1.set(de,Ye));const Bt=Ye.get(Pe);if(Bt!==void 0)return Bt;const Cr=Zl.get(de),di=ed({root:Cr.root,path:[...Cr.path,Pe]});return Ye.set(Pe,di),di}},Mo=de=>de[ca],S0=de=>{const{root:Pe,path:Ye}=Mo(de);return{root:Pe,path:Ye}};function ed(de){var Pe;const Ye={root:de.root,path:(Pe=de.path)!=null?Pe:[]},Bt={};return Zl.set(Bt,Ye),new Proxy(Bt,Uu)}var td=ed,sl=de=>de&&!!Mo(de);function Bu(de,Pe,Ye){return Pe.length===0?Ye(de):al(de,Pe,Ye)}var al=(de,Pe,Ye)=>{if(Pe.length===0)return Ye(de);if(Array.isArray(de)){let[Bt,...Cr]=Pe;Bt=parseInt(String(Bt),10),isNaN(Bt)&&(Bt=0);const di=de[Bt],ia=al(di,Cr,Ye);if(di===ia)return de;const E0=[...de];return E0.splice(Bt,1,ia),E0}else if(typeof de=="object"&&de!==null){const[Bt,...Cr]=Pe,di=de[Bt],ia=al(di,Cr,Ye);return di===ia?de:p(h({},de),{[Bt]:ia})}else{const[Bt,...Cr]=Pe;return{[Bt]:al(void 0,Cr,Ye)}}},Ws=class{constructor(){this._head=void 0}peek(){return this._head&&this._head.data}pop(){const de=this._head;if(de)return this._head=de.next,de.data}push(de){const Pe={next:this._head,data:de};this._head=Pe}};function Ql(de){return!!(de&&de.isPrism&&de.isPrism===!0)}function Of(){const de=()=>{},Pe=new Ws,Ye=de;return{type:"Dataverse_discoveryMechanism",startIgnoringDependencies:()=>{Pe.push(Ye)},stopIgnoringDependencies:()=>{Pe.peek()!==Ye||Pe.pop()},reportResolutionStart:Zc=>{const Da=Pe.peek();Da&&Da(Zc),Pe.push(Ye)},reportResolutionEnd:Zc=>{Pe.pop()},pushCollector:Zc=>{Pe.push(Zc)},popCollector:Zc=>{if(Pe.peek()!==Zc)throw new Error("Popped collector is not on top of the stack");Pe.pop()}}}function Yg(){const de="__dataverse_discoveryMechanism_sharedStack",Pe=typeof window<"u"?window:typeof xa<"u"?xa:{};if(Pe){const Ye=Pe[de];if(Ye&&typeof Ye=="object"&&Ye.type==="Dataverse_discoveryMechanism")return Ye;{const Bt=Of();return Pe[de]=Bt,Bt}}else return Of()}var{startIgnoringDependencies:w0,stopIgnoringDependencies:nd,reportResolutionEnd:Kg,reportResolutionStart:Zg,pushCollector:w1,popCollector:d4}=Yg(),qc=()=>{},E1=class{constructor(de,Pe){this._fn=de,this._prismInstance=Pe,this._didMarkDependentsAsStale=!1,this._isFresh=!1,this._cacheOfDendencyValues=new Map,this._dependents=new Set,this._dependencies=new Set,this._possiblyStaleDeps=new Set,this._scope=new Jg(this),this._lastValue=void 0,this._forciblySetToStale=!1,this._reactToDependencyGoingStale=Ye=>{this._possiblyStaleDeps.add(Ye),this._markAsStale()};for(const Ye of this._dependencies)Ye._addDependent(this._reactToDependencyGoingStale);w0(),this.getValue(),nd()}get hasDependents(){return this._dependents.size>0}removeDependent(de){this._dependents.delete(de)}addDependent(de){this._dependents.add(de)}destroy(){for(const de of this._dependencies)de._removeDependent(this._reactToDependencyGoingStale);Ff(this._scope)}getValue(){if(!this._isFresh){const de=this._recalculate();this._lastValue=de,this._isFresh=!0,this._didMarkDependentsAsStale=!1,this._forciblySetToStale=!1}return this._lastValue}_recalculate(){let de;if(!this._forciblySetToStale&&this._possiblyStaleDeps.size>0){let Bt=!1;w0();for(const Cr of this._possiblyStaleDeps)if(this._cacheOfDendencyValues.get(Cr)!==Cr.getValue()){Bt=!0;break}if(nd(),this._possiblyStaleDeps.clear(),!Bt)return this._lastValue}const Pe=new Set;this._cacheOfDendencyValues.clear();const Ye=Bt=>{Pe.add(Bt),this._addDependency(Bt)};w1(Ye),wa.push(this._scope);try{de=this._fn()}catch(Bt){console.error(Bt)}finally{wa.pop()!==this._scope&&console.warn("The Prism hook stack has slipped. This is a bug.")}d4(Ye);for(const Bt of this._dependencies)Pe.has(Bt)||this._removeDependency(Bt);this._dependencies=Pe,w0();for(const Bt of Pe)this._cacheOfDendencyValues.set(Bt,Bt.getValue());return nd(),de}forceStale(){this._forciblySetToStale=!0,this._markAsStale()}_markAsStale(){if(!this._didMarkDependentsAsStale){this._didMarkDependentsAsStale=!0,this._isFresh=!1;for(const de of this._dependents)de(this._prismInstance)}}_addDependency(de){this._dependencies.has(de)||(this._dependencies.add(de),de._addDependent(this._reactToDependencyGoingStale))}_removeDependency(de){this._dependencies.has(de)&&(this._dependencies.delete(de),de._removeDependent(this._reactToDependencyGoingStale))}},T1={},Qg=class{constructor(de){this._fn=de,this.isPrism=!0,this._state={hot:!1,handle:void 0}}get isHot(){return this._state.hot}onChange(de,Pe,Ye=!1){const Bt=()=>{de.onThisOrNextTick(di)};let Cr=T1;const di=()=>{const E0=this.getValue();E0!==Cr&&(Cr=E0,Pe(E0))};return this._addDependent(Bt),Ye&&(Cr=this.getValue(),Pe(Cr)),()=>{this._removeDependent(Bt),de.offThisOrNextTick(di),de.offNextTick(di)}}onStale(de){const Pe=()=>{this._removeDependent(Ye)},Ye=()=>de();return this._addDependent(Ye),Pe}keepHot(){return this.onStale(()=>{})}_addDependent(de){this._state.hot||this._goHot(),this._state.handle.addDependent(de)}_goHot(){const de=new E1(this._fn,this);this._state={hot:!0,handle:de}}_removeDependent(de){const Pe=this._state;if(!Pe.hot)return;const Ye=Pe.handle;Ye.removeDependent(de),Ye.hasDependents||(this._state={hot:!1,handle:void 0},Ye.destroy())}getValue(){Zg(this);const de=this._state;let Pe;return de.hot?Pe=de.handle.getValue():Pe=ol(this._fn),Kg(this),Pe}},Jg=class{constructor(de){this._hotHandle=de,this._refs=new Map,this.isPrismScope=!0,this.subs={},this.effects=new Map,this.memos=new Map}ref(de,Pe){let Ye=this._refs.get(de);if(Ye!==void 0)return Ye;{const Bt={current:Pe};return this._refs.set(de,Bt),Bt}}effect(de,Pe,Ye){let Bt=this.effects.get(de);Bt===void 0&&(Bt={cleanup:qc,deps:void 0},this.effects.set(de,Bt)),M1(Bt.deps,Ye)&&(Bt.cleanup(),w0(),Bt.cleanup=rd(Pe,qc).value,nd(),Bt.deps=Ye)}memo(de,Pe,Ye){let Bt=this.memos.get(de);return Bt===void 0&&(Bt={cachedValue:null,deps:void 0},this.memos.set(de,Bt)),M1(Bt.deps,Ye)&&(w0(),Bt.cachedValue=rd(Pe,void 0).value,nd(),Bt.deps=Ye),Bt.cachedValue}state(de,Pe){const{value:Ye,setValue:Bt}=this.memo("state/"+de,()=>{const Cr={current:Pe};return{value:Cr,setValue:ia=>{Cr.current=ia,this._hotHandle.forceStale()}}},[]);return[Ye.current,Bt]}sub(de){return this.subs[de]||(this.subs[de]=new Jg(this._hotHandle)),this.subs[de]}cleanupEffects(){for(const de of this.effects.values())rd(de.cleanup,void 0);this.effects.clear()}source(de,Pe){return this.effect("$$source/blah",()=>de(()=>{this._hotHandle.forceStale()}),[de]),Pe()}};function Ff(de){for(const Pe of Object.values(de.subs))Ff(Pe);de.cleanupEffects()}function rd(de,Pe){try{return{value:de(),ok:!0}}catch(Ye){return setTimeout(function(){throw Ye}),{value:Pe,ok:!1}}}var wa=new Ws;function f4(de,Pe){const Ye=wa.peek();if(!Ye)throw new Error("prism.ref() is called outside of a prism() call.");return Ye.ref(de,Pe)}function Xc(de,Pe,Ye){const Bt=wa.peek();if(!Bt)throw new Error("prism.effect() is called outside of a prism() call.");return Bt.effect(de,Pe,Ye)}function M1(de,Pe){if(de===void 0||Pe===void 0)return!0;const Ye=de.length;if(Ye!==Pe.length)return!0;for(let Bt=0;Bt<Ye;Bt++)if(de[Bt]!==Pe[Bt])return!0;return!1}function e2(de,Pe,Ye){const Bt=wa.peek();if(!Bt)throw new Error("prism.memo() is called outside of a prism() call.");return Bt.memo(de,Pe,Ye)}function Ya(de,Pe){const Ye=wa.peek();if(!Ye)throw new Error("prism.state() is called outside of a prism() call.");return Ye.state(de,Pe)}function p4(){if(!wa.peek())throw new Error("The parent function is called outside of a prism() call.")}function m4(de,Pe){const Ye=wa.peek();if(!Ye)throw new Error("prism.scope() is called outside of a prism() call.");const Bt=Ye.sub(de);wa.push(Bt);const Cr=rd(Pe,void 0).value;return wa.pop(),Cr}function t2(de,Pe,Ye){return e2(de,()=>ns(Pe),Ye).getValue()}function C1(){return!!wa.peek()}function zu(de,Pe){const Ye=wa.peek();if(!Ye)throw new Error("prism.source() is called outside of a prism() call.");return Ye.source(de,Pe)}var ns=de=>new Qg(de),id=class{effect(de,Pe,Ye){console.warn("prism.effect() does not run in cold prisms")}memo(de,Pe,Ye){return Pe()}state(de,Pe){return[Pe,()=>{}]}ref(de,Pe){return{current:Pe}}sub(de){return new id}source(de,Pe){return Pe()}};function ol(de){const Pe=new id;wa.push(Pe);let Ye;try{Ye=de()}catch(Bt){console.error(Bt)}finally{wa.pop()!==Pe&&console.warn("The Prism hook stack has slipped. This is a bug.")}return Ye}ns.ref=f4,ns.effect=Xc,ns.memo=e2,ns.ensurePrism=p4,ns.state=Ya,ns.scope=m4,ns.sub=t2,ns.inPrism=C1,ns.source=zu;var Jl=ns,A1;(function(de){de[de.Dict=0]="Dict",de[de.Array=1]="Array",de[de.Other=2]="Other"})(A1||(A1={}));var bi=de=>Array.isArray(de)?1:$c(de)?0:2,Vu=(de,Pe,Ye=bi(de))=>Ye===0&&typeof Pe=="string"||Ye===1&&Yc(Pe)?de[Pe]:void 0,Yc=de=>{const Pe=typeof de=="number"?de:parseInt(de,10);return!isNaN(Pe)&&Pe>=0&&Pe<1/0&&(Pe|0)===Pe},P1=class{constructor(de,Pe){this._parent=de,this._path=Pe,this.children=new Map,this.identityChangeListeners=new Set}addIdentityChangeListener(de){this.identityChangeListeners.add(de)}removeIdentityChangeListener(de){this.identityChangeListeners.delete(de),this._checkForGC()}removeChild(de){this.children.delete(de),this._checkForGC()}getChild(de){return this.children.get(de)}getOrCreateChild(de){let Pe=this.children.get(de);return Pe||(Pe=Pe=new P1(this,this._path.concat([de])),this.children.set(de,Pe)),Pe}_checkForGC(){this.identityChangeListeners.size>0||this.children.size>0||this._parent&&this._parent.removeChild(Df(this._path))}},R1=class{constructor(de){this.$$isPointerToPrismProvider=!0,this.pointer=td({root:this,path:[]}),this.prism=this.pointerToPrism(this.pointer),this._onPointerValueChange=(Pe,Ye)=>{const{path:Bt}=S0(Pe),Cr=this._getOrCreateScopeForPath(Bt);return Cr.identityChangeListeners.add(Ye),()=>{Cr.identityChangeListeners.delete(Ye)}},this._currentState=de,this._rootScope=new P1(void 0,[])}set(de){const Pe=this._currentState;this._currentState=de,this._checkUpdates(this._rootScope,Pe,de)}get(){return this._currentState}getByPointer(de){const Pe=sl(de)?de:de(this.pointer),Ye=S0(Pe).path;return this._getIn(Ye)}_getIn(de){return de.length===0?this.get():Hc(this.get(),de)}reduce(de){this.set(de(this.get()))}reduceByPointer(de,Pe){const Ye=sl(de)?de:de(this.pointer),Bt=S0(Ye).path,Cr=Bu(this.get(),Bt,Pe);this.set(Cr)}setByPointer(de,Pe){this.reduceByPointer(de,()=>Pe)}_checkUpdates(de,Pe,Ye){if(Pe===Ye)return;for(const di of de.identityChangeListeners)di(Ye);if(de.children.size===0)return;const Bt=bi(Pe),Cr=bi(Ye);if(!(Bt===2&&Bt===Cr))for(const[di,ia]of de.children){const E0=Vu(Pe,di,Bt),Lf=Vu(Ye,di,Cr);this._checkUpdates(ia,E0,Lf)}}_getOrCreateScopeForPath(de){let Pe=this._rootScope;for(const Ye of de)Pe=Pe.getOrCreateChild(Ye);return Pe}pointerToPrism(de){const{path:Pe}=S0(de),Ye=Cr=>this._onPointerValueChange(de,Cr),Bt=()=>this._getIn(Pe);return Jl(()=>Jl.source(Ye,Bt))}},I1=new WeakMap;function n2(de){return typeof de=="object"&&de!==null&&de.$$isPointerToPrismProvider===!0}var sd=de=>{const Pe=Mo(de);let Ye=I1.get(Pe);if(!Ye){const Bt=Pe.root;if(!n2(Bt))throw new Error("Cannot run pointerToPrism() on a pointer whose root is not an PointerToPrismProvider");Ye=Bt.pointerToPrism(de),I1.set(Pe,Ye)}return Ye},ll=de=>sl(de)?sd(de).getValue():Ql(de)?de.getValue():de;function*Kc(de){let Pe;if(sl(de))Pe=sd(de);else if(Ql(de))Pe=de;else throw new Error("Only pointers and prisms are supported");let Ye=0;const Bt=Pe.onStale(()=>{Ye++});try{for(;;){const Cr=Ye;Ye=0,yield{value:Pe.getValue(),ticks:Cr}}}finally{Bt()}}var g4=60*3,ad=class{constructor(de){this._conf=de,this._ticking=!1,this._dormant=!0,this._numberOfDormantTicks=0,this.__ticks=0,this._scheduledForThisOrNextTick=new Set,this._scheduledForNextTick=new Set,this._timeAtCurrentTick=0}get dormant(){return this._dormant}onThisOrNextTick(de){this._scheduledForThisOrNextTick.add(de),this._dormant&&this._goActive()}onNextTick(de){this._scheduledForNextTick.add(de),this._dormant&&this._goActive()}offThisOrNextTick(de){this._scheduledForThisOrNextTick.delete(de)}offNextTick(de){this._scheduledForNextTick.delete(de)}get time(){return this._ticking?this._timeAtCurrentTick:performance.now()}_goActive(){var de,Pe;this._dormant&&(this._dormant=!1,(Pe=(de=this._conf)==null?void 0:de.onActive)==null||Pe.call(de))}_goDormant(){var de,Pe;this._dormant||(this._dormant=!0,this._numberOfDormantTicks=0,(Pe=(de=this._conf)==null?void 0:de.onDormant)==null||Pe.call(de))}tick(de=performance.now()){if(this.__ticks++,!this._dormant&&this._scheduledForNextTick.size===0&&this._scheduledForThisOrNextTick.size===0&&(this._numberOfDormantTicks++,this._numberOfDormantTicks>=g4)){this._goDormant();return}this._ticking=!0,this._timeAtCurrentTick=de;for(const Pe of this._scheduledForNextTick)this._scheduledForThisOrNextTick.add(Pe);this._scheduledForNextTick.clear(),this._tick(0),this._ticking=!1}_tick(de){const Pe=this.time;if(de>10&&console.warn("_tick() recursing for 10 times"),de>100)throw new Error("Maximum recursion limit for _tick()");const Ye=this._scheduledForThisOrNextTick;this._scheduledForThisOrNextTick=new Set;for(const Bt of Ye)Bt(Pe);if(this._scheduledForThisOrNextTick.size>0)return this._tick(de+1)}};function*k1(de){let Pe;if(sl(de))Pe=sd(de);else if(Ql(de))Pe=de;else throw new Error("Only pointers and prisms are supported");const Ye=new ad,Bt=Pe.onChange(Ye,Cr=>{});try{for(;;)Ye.tick(),yield Pe.getValue()}finally{Bt()}}var N1=class{constructor(de){this.$$isPointerToPrismProvider=!0,this._currentPointerBox=new R1(de),this.pointer=td({root:this,path:[]})}setPointer(de){this._currentPointerBox.set(de)}pointerToPrism(de){const{path:Pe}=Mo(de);return Jl(()=>{const Ye=this._currentPointerBox.prism.getValue(),Bt=Pe.reduce((Cr,di)=>Cr[di],Ye);return ll(Bt)})}}}(yz)),yz}Yw.exports;var Ype;function gTe(){return Ype||(Ype=1,function(s,e){var t={},n=Object.create,r=Object.freeze,i=Object.defineProperty,o=Object.defineProperties,l=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertyNames,y=Object.getOwnPropertySymbols,x=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,k=(a,u)=>{if(u=Symbol[a])return u;throw Error("Symbol."+a+" is not defined")},L=Math.pow,U=(a,u,c)=>u in a?i(a,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[u]=c,P=(a,u)=>{for(var c in u||(u={}))S.call(u,c)&&U(a,c,u[c]);if(y)for(var c of y(u))A.call(u,c)&&U(a,c,u[c]);return a},$=(a,u)=>o(a,h(u)),Z=(a,u)=>{var c={};for(var m in a)S.call(a,m)&&u.indexOf(m)<0&&(c[m]=a[m]);if(a!=null&&y)for(var m of y(a))u.indexOf(m)<0&&A.call(a,m)&&(c[m]=a[m]);return c},I=(a,u)=>()=>(a&&(u=a(a=0)),u),ie=(a,u)=>()=>(u||a((u={exports:{}}).exports,u),u.exports),ce=(a,u)=>{for(var c in u)i(a,c,{get:u[c],enumerable:!0})},ue=(a,u,c,m)=>{if(u&&typeof u=="object"||typeof u=="function")for(let _ of p(u))!S.call(a,_)&&_!==c&&i(a,_,{get:()=>u[_],enumerable:!(m=l(u,_))||m.enumerable});return a},Q=(a,u,c)=>(c=a!=null?n(x(a)):{},ue(u||!a||!a.__esModule?i(c,"default",{value:a,enumerable:!0}):c,a)),oe=a=>ue(i({},"__esModule",{value:!0}),a),le=(a,u,c)=>(U(a,typeof u!="symbol"?u+"":u,c),c),J=(a,u)=>r(i(a,"raw",{value:r(a.slice())})),Be=(a,u,c)=>new Promise((m,_)=>{var b=R=>{try{T(c.next(R))}catch(N){_(N)}},E=R=>{try{T(c.throw(R))}catch(N){_(N)}},T=R=>R.done?m(R.value):Promise.resolve(R.value).then(b,E);T((c=c.apply(a,u)).next())}),He=function(a,u){this[0]=a,this[1]=u},rt=a=>{var u=a[k("asyncIterator")],c=!1,m,_={};return u==null?(u=a[k("iterator")](),m=b=>_[b]=E=>u[b](E)):(u=u.call(a),m=b=>_[b]=E=>{if(c){if(c=!1,b==="throw")throw E;return E}return c=!0,{done:!1,value:new He(new Promise(T=>{var R=u[b](E);if(!(R instanceof Object))throw TypeError("Object expected");T(R)}),1)}}),_[k("iterator")]=()=>_,m("next"),"throw"in u?m("throw"):_.throw=b=>{throw b},"return"in u&&m("return"),_};function ot(a){gt=a}function Se(){return gt}var gt,Ae=I(()=>{});function lt(a,u,c=[]){if(typeof a=="object"&&a){if(pt(a)||De(a)){u(a,c);return}for(let[m,_]of Object.entries(a))lt(_,u,[...c,m])}else{if(a==null)return;u(a,c)}}var pt,De,_t=I(()=>{pt=a=>typeof a=="object"&&a!==null&&Object.hasOwnProperty.call(a,"type")&&a.type==="image"&&Object.hasOwnProperty.call(a,"id")&&typeof a.id=="string"&&a.id!=="",De=a=>typeof a=="object"&&a!==null&&Object.hasOwnProperty.call(a,"r")&&Object.hasOwnProperty.call(a,"g")&&Object.hasOwnProperty.call(a,"b")&&Object.hasOwnProperty.call(a,"a")&&typeof a.r=="number"&&typeof a.g=="number"&&typeof a.b=="number"&&typeof a.a=="number"});function Jt(a){return u=>typeof u=="object"&&!!u&&u.type===a}var dt,Dt,gn,qt,wn,rr,Xn,ni,oi=I(()=>{dt=Jt("Theatre_Project"),Dt=Jt("Theatre_Sheet"),gn=Jt("Theatre_SheetTemplate"),qt=Jt("Theatre_SheetObject"),wn=Jt("Theatre_Sequence"),rr=Jt("Theatre_SheetObjectTemplate"),Xn=Jt("Theatre_Sheet_PublicAPI"),ni=Jt("Theatre_SheetObject_PublicAPI")}),$r,$e,zs=I(()=>{$r=typeof xa=="object"&&xa&&xa.Object===Object&&xa,$e=$r}),li,Ci,Ln,Ar=I(()=>{zs(),li=typeof self=="object"&&self&&self.Object===Object&&self,Ci=$e||li||Function("return this")(),Ln=Ci}),ar,fr,gi=I(()=>{Ar(),ar=Ln.Symbol,fr=ar});function Oe(a){var u=Ct.call(a,Zt),c=a[Zt];try{a[Zt]=void 0;var m=!0}catch{}var _=Kt.call(a);return m&&(u?a[Zt]=c:delete a[Zt]),_}var _e,Ct,Kt,Zt,Ht,or=I(()=>{gi(),_e=Object.prototype,Ct=_e.hasOwnProperty,Kt=_e.toString,Zt=fr?fr.toStringTag:void 0,Ht=Oe});function An(a){return lr.call(a)}var Hn,lr,Qt,jn=I(()=>{Hn=Object.prototype,lr=Hn.toString,Qt=An});function Mr(a){return a==null?a===void 0?Pn:gr:Sr&&Sr in Object(a)?Ht(a):Qt(a)}var gr,Pn,Sr,Ze,Tn=I(()=>{gi(),or(),jn(),gr="[object Null]",Pn="[object Undefined]",Sr=fr?fr.toStringTag:void 0,Ze=Mr});function nn(a){return a!=null&&typeof a=="object"}var kn,ln=I(()=>{kn=nn});function en(a){return typeof a=="symbol"||kn(a)&&Ze(a)==Yn}var Yn,br,xi=I(()=>{Tn(),ln(),Yn="[object Symbol]",br=en});function Kr(a,u){for(var c=-1,m=a==null?0:a.length,_=Array(m);++c<m;)_[c]=u(a[c],c,a);return _}var Vs,la=I(()=>{Vs=Kr}),Fu,Ps,Gs=I(()=>{Fu=Array.isArray,Ps=Fu});function _0(a){if(typeof a=="string")return a;if(Ps(a))return Vs(a,_0)+"";if(br(a))return ka?ka.call(a):"";var u=a+"";return u=="0"&&1/a==-$l?"-0":u}var $l,tl,ka,Lc,Uc=I(()=>{gi(),la(),Gs(),xi(),$l=1/0,tl=fr?fr.prototype:void 0,ka=tl?tl.toString:void 0,Lc=_0});function Pf(a){for(var u=a.length;u--&&ua.test(a.charAt(u)););return u}var ua,Xh,ql=I(()=>{ua=/\s/,Xh=Pf});function Bc(a){return a&&a.slice(0,Xh(a)+1).replace(Yh,"")}var Yh,Kh,Rf=I(()=>{ql(),Yh=/^\s+/,Kh=Bc});function we(a){var u=typeof a;return a!=null&&(u=="object"||u=="function")}var st,Pt=I(()=>{st=we});function bt(a){if(typeof a=="number")return a;if(br(a))return ht;if(st(a)){var u=typeof a.valueOf=="function"?a.valueOf():a;a=st(u)?u+"":u}if(typeof a!="string")return a===0?a:+a;a=Kh(a);var c=Dn.test(a);return c||Bn.test(a)?Wn(a.slice(2),c?2:8):vn.test(a)?ht:+a}var ht,vn,Dn,Bn,Wn,ur,vr=I(()=>{Rf(),Pt(),xi(),ht=NaN,vn=/^[-+]0x[0-9a-f]+$/i,Dn=/^0b[01]+$/i,Bn=/^0o[0-7]+$/i,Wn=parseInt,ur=bt});function Kn(a){if(!a)return a===0?a:0;if(a=ur(a),a===Fr||a===-Fr){var u=a<0?-1:1;return u*Lr}return a===a?a:0}var Fr,Lr,Di,Zi=I(()=>{vr(),Fr=1/0,Lr=17976931348623157e292,Di=Kn});function ri(a){var u=Di(a),c=u%1;return u===u?c?u-c:u:0}var er,Qi=I(()=>{Zi(),er=ri});function Zr(a){return a}var Rs,qo=I(()=>{Rs=Zr});function Na(a){if(!st(a))return!1;var u=Ze(a);return u==Oi||u==gs||u==x0||u==Is}var x0,Oi,gs,Is,Hs,ws=I(()=>{Tn(),Pt(),x0="[object AsyncFunction]",Oi="[object Function]",gs="[object GeneratorFunction]",Is="[object Proxy]",Hs=Na}),hi,ra,Zh=I(()=>{Ar(),hi=Ln["__core-js_shared__"],ra=hi});function m1(a){return!!Xl&&Xl in a}var Xl,g1,jg=I(()=>{Zh(),Xl=function(){var a=/[^.]+$/.exec(ra&&ra.keys&&ra.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),g1=m1});function v1(a){if(a!=null){try{return nl.call(a)}catch{}try{return a+""}catch{}}return""}var Qh,nl,js,b0=I(()=>{Qh=Function.prototype,nl=Qh.toString,js=v1});function zc(a){if(!st(a)||g1(a))return!1;var u=Hs(a)?Yl:rl;return u.test(js(a))}var Vc,rl,Wg,y1,Gc,$g,Yl,Kl,qg=I(()=>{ws(),jg(),Pt(),b0(),Vc=/[\\^$.*+?()[\]{}|]/g,rl=/^\[object .+?Constructor\]$/,Wg=Function.prototype,y1=Object.prototype,Gc=Wg.toString,$g=y1.hasOwnProperty,Yl=RegExp("^"+Gc.call($g).replace(Vc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Kl=zc});function _1(a,u){return a==null?void 0:a[u]}var Hc,Jh=I(()=>{Hc=_1});function jc(a,u){var c=Hc(a,u);return Kl(c)?c:void 0}var Xo,Lu=I(()=>{qg(),Jh(),Xo=jc}),Xg,Wc,If=I(()=>{Lu(),Ar(),Xg=Xo(Ln,"WeakMap"),Wc=Xg});function kf(a,u,c){switch(c.length){case 0:return a.call(u);case 1:return a.call(u,c[0]);case 2:return a.call(u,c[0],c[1]);case 3:return a.call(u,c[0],c[1],c[2])}return a.apply(u,c)}var x1,il=I(()=>{x1=kf});function Nf(){}var $c,b1=I(()=>{$c=Nf});function Df(a,u){var c=-1,m=a.length;for(u||(u=Array(m));++c<m;)u[c]=a[c];return u}var Zl,S1=I(()=>{Zl=Df});function ca(a){var u=0,c=0;return function(){var m=S0(),_=Mo-(m-c);if(c=m,_>0){if(++u>=Uu)return arguments[0]}else u=0;return a.apply(void 0,arguments)}}var Uu,Mo,S0,ed,td=I(()=>{Uu=800,Mo=16,S0=Date.now,ed=ca});function sl(a){return function(){return a}}var Bu,al=I(()=>{Bu=sl}),Ws,Ql,Of=I(()=>{Lu(),Ws=function(){try{var a=Xo(Object,"defineProperty");return a({},"",{}),a}catch{}}(),Ql=Ws}),Yg,w0,nd=I(()=>{al(),Of(),qo(),Yg=Ql?function(a,u){return Ql(a,"toString",{configurable:!0,enumerable:!1,value:Bu(u),writable:!0})}:Rs,w0=Yg}),Kg,Zg,w1=I(()=>{nd(),td(),Kg=ed(w0),Zg=Kg});function d4(a,u,c,m){for(var _=a.length,b=c+(m?1:-1);m?b--:++b<_;)if(u(a[b],b,a))return b;return-1}var qc,E1=I(()=>{qc=d4});function T1(a){return a!==a}var Qg,Jg=I(()=>{Qg=T1});function Ff(a,u,c){for(var m=c-1,_=a.length;++m<_;)if(a[m]===u)return m;return-1}var rd,wa=I(()=>{rd=Ff});function f4(a,u,c){return u===u?rd(a,u,c):qc(a,Qg,c)}var Xc,M1=I(()=>{E1(),Jg(),wa(),Xc=f4});function e2(a,u){var c=a==null?0:a.length;return!!c&&Xc(a,u,0)>-1}var Ya,p4=I(()=>{M1(),Ya=e2});function m4(a,u){var c=typeof a;return u=u??t2,!!u&&(c=="number"||c!="symbol"&&C1.test(a))&&a>-1&&a%1==0&&a<u}var t2,C1,zu,ns=I(()=>{t2=9007199254740991,C1=/^(?:0|[1-9]\d*)$/,zu=m4});function id(a,u,c){u=="__proto__"&&Ql?Ql(a,u,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[u]=c}var ol,Jl=I(()=>{Of(),ol=id});function A1(a,u){return a===u||a!==a&&u!==u}var bi,Vu=I(()=>{bi=A1});function Yc(a,u,c){var m=a[u];(!(R1.call(a,u)&&bi(m,c))||c===void 0&&!(u in a))&&ol(a,u,c)}var P1,R1,I1,n2=I(()=>{Jl(),Vu(),P1=Object.prototype,R1=P1.hasOwnProperty,I1=Yc});function sd(a,u,c){return u=ll(u===void 0?a.length-1:u,0),function(){for(var m=arguments,_=-1,b=ll(m.length-u,0),E=Array(b);++_<b;)E[_]=m[u+_];_=-1;for(var T=Array(u+1);++_<u;)T[_]=m[_];return T[u]=c(E),x1(a,this,T)}}var ll,Kc,g4=I(()=>{il(),ll=Math.max,Kc=sd});function ad(a,u){return Zg(Kc(a,u,Rs),a+"")}var k1,N1=I(()=>{qo(),g4(),w1(),k1=ad});function de(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=Pe}var Pe,Ye,Bt=I(()=>{Pe=9007199254740991,Ye=de});function Cr(a){return a!=null&&Ye(a.length)&&!Hs(a)}var di,ia=I(()=>{ws(),Bt(),di=Cr});function E0(a,u,c){if(!st(c))return!1;var m=typeof u;return(m=="number"?di(c)&&zu(u,c.length):m=="string"&&u in c)?bi(c[u],a):!1}var Lf,Zc=I(()=>{Vu(),ia(),ns(),Pt(),Lf=E0});function Da(a){var u=a&&a.constructor,c=typeof u=="function"&&u.prototype||od;return a===c}var od,v4,Fv=I(()=>{od=Object.prototype,v4=Da});function Lv(a,u){for(var c=-1,m=Array(a);++c<a;)m[c]=u(c);return m}var y4,_4=I(()=>{y4=Lv});function mx(a){return kn(a)&&Ze(a)==Uv}var Uv,ul,x4=I(()=>{Tn(),ln(),Uv="[object Arguments]",ul=mx}),ld,Uf,b4,Bf,Gu,D1=I(()=>{x4(),ln(),ld=Object.prototype,Uf=ld.hasOwnProperty,b4=ld.propertyIsEnumerable,Bf=ul(function(){return arguments}())?ul:function(a){return kn(a)&&Uf.call(a,"callee")&&!b4.call(a,"callee")},Gu=Bf});function r2(){return!1}var O1,Bv=I(()=>{O1=r2}),i2,s2,a2,F1,S4,Hu,zf,L1=I(()=>{Ar(),Bv(),i2=e&&!e.nodeType&&e,s2=i2&&!0&&s&&!s.nodeType&&s,a2=s2&&s2.exports===i2,F1=a2?Ln.Buffer:void 0,S4=F1?F1.isBuffer:void 0,Hu=S4||O1,zf=Hu});function gx(a){return kn(a)&&Ye(a.length)&&!!is[Ze(a)]}var zv,ud,w4,E4,o2,rs,l2,Qc,Vf,T4,u2,Gf,U1,cd,M4,Vv,Gv,C4,B1,z1,c2,h2,d2,f2,is,A4,vx=I(()=>{Tn(),Bt(),ln(),zv="[object Arguments]",ud="[object Array]",w4="[object Boolean]",E4="[object Date]",o2="[object Error]",rs="[object Function]",l2="[object Map]",Qc="[object Number]",Vf="[object Object]",T4="[object RegExp]",u2="[object Set]",Gf="[object String]",U1="[object WeakMap]",cd="[object ArrayBuffer]",M4="[object DataView]",Vv="[object Float32Array]",Gv="[object Float64Array]",C4="[object Int8Array]",B1="[object Int16Array]",z1="[object Int32Array]",c2="[object Uint8Array]",h2="[object Uint8ClampedArray]",d2="[object Uint16Array]",f2="[object Uint32Array]",is={},is[Vv]=is[Gv]=is[C4]=is[B1]=is[z1]=is[c2]=is[h2]=is[d2]=is[f2]=!0,is[zv]=is[ud]=is[cd]=is[w4]=is[M4]=is[E4]=is[o2]=is[rs]=is[l2]=is[Qc]=is[Vf]=is[T4]=is[u2]=is[Gf]=is[U1]=!1,A4=gx});function yx(a){return function(u){return a(u)}}var Hf,eu=I(()=>{Hf=yx}),p2,cl,vi,Jc,tu,V1,P4=I(()=>{zs(),p2=e&&!e.nodeType&&e,cl=p2&&!0&&s&&!s.nodeType&&s,vi=cl&&cl.exports===p2,Jc=vi&&$e.process,tu=function(){try{var a=cl&&cl.require&&cl.require("util").types;return a||Jc&&Jc.binding&&Jc.binding("util")}catch{}}(),V1=tu}),m2,T0,hd,ju=I(()=>{vx(),eu(),P4(),m2=V1&&V1.isTypedArray,T0=m2?Hf(m2):A4,hd=T0});function g2(a,u){var c=Ps(a),m=!c&&Gu(a),_=!c&&!m&&zf(a),b=!c&&!m&&!_&&hd(a),E=c||m||_||b,T=E?y4(a.length,String):[],R=T.length;for(var N in a)(u||eh.call(a,N))&&!(E&&(N=="length"||_&&(N=="offset"||N=="parent")||b&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||zu(N,R)))&&T.push(N);return T}var Wu,eh,$u,ss=I(()=>{_4(),D1(),Gs(),L1(),ns(),ju(),Wu=Object.prototype,eh=Wu.hasOwnProperty,$u=g2});function as(a,u){return function(c){return a(u(c))}}var nu,Oa=I(()=>{nu=as}),Ka,th,dd=I(()=>{Oa(),Ka=nu(Object.keys,Object),th=Ka});function Co(a){if(!v4(a))return th(a);var u=[];for(var c in Object(a))R4.call(a,c)&&c!="constructor"&&u.push(c);return u}var G1,R4,I4,v2=I(()=>{Fv(),dd(),G1=Object.prototype,R4=G1.hasOwnProperty,I4=Co});function Hv(a){return di(a)?$u(a):I4(a)}var M0,ru=I(()=>{ss(),v2(),ia(),M0=Hv});function k4(a,u){if(Ps(a))return!1;var c=typeof a;return c=="number"||c=="symbol"||c=="boolean"||a==null||br(a)?!0:jv.test(a)||!N4.test(a)||u!=null&&a in Object(u)}var N4,jv,hl,nh=I(()=>{Gs(),xi(),N4=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jv=/^\w*$/,hl=k4}),fd,qu,Xu=I(()=>{Lu(),fd=Xo(Object,"create"),qu=fd});function C0(){this.__data__=qu?qu(null):{},this.size=0}var Ao,pd=I(()=>{Xu(),Ao=C0});function dl(a){var u=this.has(a)&&delete this.__data__[a];return this.size-=u?1:0,u}var iu,md=I(()=>{iu=dl});function Wv(a){var u=this.__data__;if(qu){var c=u[a];return c===H1?void 0:c}return Po.call(u,a)?u[a]:void 0}var H1,y2,Po,Ro,vs=I(()=>{Xu(),H1="__lodash_hash_undefined__",y2=Object.prototype,Po=y2.hasOwnProperty,Ro=Wv});function fl(a){var u=this.__data__;return qu?u[a]!==void 0:D4.call(u,a)}var _2,D4,x2,O4=I(()=>{Xu(),_2=Object.prototype,D4=_2.hasOwnProperty,x2=fl});function $v(a,u){var c=this.__data__;return this.size+=this.has(a)?0:1,c[a]=qu&&u===void 0?j1:u,this}var j1,F4,jf=I(()=>{Xu(),j1="__lodash_hash_undefined__",F4=$v});function rh(a){var u=-1,c=a==null?0:a.length;for(this.clear();++u<c;){var m=a[u];this.set(m[0],m[1])}}var L4,W1=I(()=>{pd(),md(),vs(),O4(),jf(),rh.prototype.clear=Ao,rh.prototype.delete=iu,rh.prototype.get=Ro,rh.prototype.has=x2,rh.prototype.set=F4,L4=rh});function b2(){this.__data__=[],this.size=0}var $1,qv=I(()=>{$1=b2});function Wf(a,u){for(var c=a.length;c--;)if(bi(a[c][0],u))return c;return-1}var gd,vd=I(()=>{Vu(),gd=Wf});function S2(a){var u=this.__data__,c=gd(u,a);if(c<0)return!1;var m=u.length-1;return c==m?u.pop():w2.call(u,c,1),--this.size,!0}var yd,w2,E2,U4=I(()=>{vd(),yd=Array.prototype,w2=yd.splice,E2=S2});function q1(a){var u=this.__data__,c=gd(u,a);return c<0?void 0:u[c][1]}var Yu,A0=I(()=>{vd(),Yu=q1});function ih(a){return gd(this.__data__,a)>-1}var X1,B4=I(()=>{vd(),X1=ih});function Ku(a,u){var c=this.__data__,m=gd(c,a);return m<0?(++this.size,c.push([a,u])):c[m][1]=u,this}var su,T2=I(()=>{vd(),su=Ku});function _d(a){var u=-1,c=a==null?0:a.length;for(this.clear();++u<c;){var m=a[u];this.set(m[0],m[1])}}var Yo,pl=I(()=>{qv(),U4(),A0(),B4(),T2(),_d.prototype.clear=$1,_d.prototype.delete=E2,_d.prototype.get=Yu,_d.prototype.has=X1,_d.prototype.set=su,Yo=_d}),Y1,xd,$f=I(()=>{Lu(),Ar(),Y1=Xo(Ln,"Map"),xd=Y1});function Xv(){this.size=0,this.__data__={hash:new L4,map:new(xd||Yo),string:new L4}}var qf,au=I(()=>{W1(),pl(),$f(),qf=Xv});function K1(a){var u=typeof a;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?a!=="__proto__":a===null}var Xf,sh=I(()=>{Xf=K1});function z4(a,u){var c=a.__data__;return Xf(u)?c[typeof u=="string"?"string":"hash"]:c.map}var ou,Z1=I(()=>{sh(),ou=z4});function V4(a){var u=ou(this,a).delete(a);return this.size-=u?1:0,u}var ys,M2=I(()=>{Z1(),ys=V4});function G4(a){return ou(this,a).get(a)}var C2,A2=I(()=>{Z1(),C2=G4});function H4(a){return ou(this,a).has(a)}var ah,ji=I(()=>{Z1(),ah=H4});function Es(a,u){var c=ou(this,a),m=c.size;return c.set(a,u),this.size+=c.size==m?0:1,this}var ha,P2=I(()=>{Z1(),ha=Es});function lu(a){var u=-1,c=a==null?0:a.length;for(this.clear();++u<c;){var m=a[u];this.set(m[0],m[1])}}var Zu,R2=I(()=>{au(),M2(),A2(),ji(),P2(),lu.prototype.clear=qf,lu.prototype.delete=ys,lu.prototype.get=C2,lu.prototype.has=ah,lu.prototype.set=ha,Zu=lu});function da(a,u){if(typeof a!="function"||u!=null&&typeof u!="function")throw new TypeError(I2);var c=function(){var m=arguments,_=u?u.apply(this,m):m[0],b=c.cache;if(b.has(_))return b.get(_);var E=a.apply(this,m);return c.cache=b.set(_,E)||b,E};return c.cache=new(da.Cache||Zu),c}var I2,Yf,Q1=I(()=>{R2(),I2="Expected a function",da.Cache=Zu,Yf=da});function uu(a){var u=Yf(a,function(m){return c.size===Ko&&c.clear(),m}),c=u.cache;return u}var Ko,Kf,j4=I(()=>{Q1(),Ko=500,Kf=uu}),k2,N2,W4,$4,q4=I(()=>{j4(),k2=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,N2=/\\(\\)?/g,W4=Kf(function(a){var u=[];return a.charCodeAt(0)===46&&u.push(""),a.replace(k2,function(c,m,_,b){u.push(_?b.replace(N2,"$1"):m||c)}),u}),$4=W4});function Yv(a){return a==null?"":Lc(a)}var bd,X4=I(()=>{Uc(),bd=Yv});function Kv(a,u){return Ps(a)?a:hl(a,u)?[a]:$4(bd(a))}var oh,D2=I(()=>{Gs(),nh(),q4(),X4(),oh=Kv});function J1(a){if(typeof a=="string"||br(a))return a;var u=a+"";return u=="0"&&1/a==-em?"-0":u}var em,Sd,wd=I(()=>{xi(),em=1/0,Sd=J1});function Y4(a,u){u=oh(u,a);for(var c=0,m=u.length;a!=null&&c<m;)a=a[Sd(u[c++])];return c&&c==m?a:void 0}var tm,Zf=I(()=>{D2(),wd(),tm=Y4});function Zv(a,u,c){var m=a==null?void 0:tm(a,u);return m===void 0?c:m}var Qu,Qf=I(()=>{Zf(),Qu=Zv});function O2(a,u){for(var c=-1,m=u.length,_=a.length;++c<m;)a[_+c]=u[c];return a}var F2,L2=I(()=>{F2=O2});function Qv(a){return Ps(a)||Gu(a)||!!(nm&&a&&a[nm])}var nm,K4,Jv=I(()=>{gi(),D1(),Gs(),nm=fr?fr.isConcatSpreadable:void 0,K4=Qv});function U2(a,u,c,m,_){var b=-1,E=a.length;for(c||(c=K4),_||(_=[]);++b<E;){var T=a[b];u>0&&c(T)?u>1?U2(T,u-1,c,m,_):F2(_,T):m||(_[_.length]=T)}return _}var B2,rm=I(()=>{L2(),Jv(),B2=U2}),Z4,ey,_x=I(()=>{Oa(),Z4=nu(Object.getPrototypeOf,Object),ey=Z4});function ml(a){if(!kn(a)||Ze(a)!=z2)return!1;var u=ey(a);if(u===null)return!0;var c=Q4.call(u,"constructor")&&u.constructor;return typeof c=="function"&&c instanceof c&&lh.call(c)==V2}var z2,im,Ju,lh,Q4,V2,ec,G2=I(()=>{Tn(),_x(),ln(),z2="[object Object]",im=Function.prototype,Ju=Object.prototype,lh=im.toString,Q4=Ju.hasOwnProperty,V2=lh.call(Object),ec=ml});function J4(a){var u=Math[a];return function(c,m){if(c=ur(c),m=m==null?0:e5(er(m),292),m&&sm(c)){var _=(bd(c)+"e").split("e"),b=u(_[0]+"e"+(+_[1]+m));return _=(bd(b)+"e").split("e"),+(_[0]+"e"+(+_[1]-m))}return u(c)}}var sm,e5,am,ty=I(()=>{Ar(),Qi(),vr(),X4(),sm=Ln.isFinite,e5=Math.min,am=J4});function ny(a,u,c){return a===a&&(c!==void 0&&(a=a<=c?a:c),u!==void 0&&(a=a>=u?a:u)),a}var t5,xx=I(()=>{t5=ny});function Io(a,u,c){return c===void 0&&(c=u,u=void 0),c!==void 0&&(c=ur(c),c=c===c?c:0),u!==void 0&&(u=ur(u),u=u===u?u:0),t5(ur(a),u,c)}var ii,Jf=I(()=>{xx(),vr(),ii=Io});function ry(){this.__data__=new Yo,this.size=0}var n5,iy=I(()=>{pl(),n5=ry});function sy(a){var u=this.__data__,c=u.delete(a);return this.size=u.size,c}var H2,ay=I(()=>{H2=sy});function r5(a){return this.__data__.get(a)}var i5,oy=I(()=>{i5=r5});function s5(a){return this.__data__.has(a)}var j2,ly=I(()=>{j2=s5});function a5(a,u){var c=this.__data__;if(c instanceof Yo){var m=c.__data__;if(!xd||m.length<om-1)return m.push([a,u]),this.size=++c.size,this;c=this.__data__=new Zu(m)}return c.set(a,u),this.size=c.size,this}var om,uy,cy=I(()=>{pl(),$f(),R2(),om=200,uy=a5});function uh(a){var u=this.__data__=new Yo(a);this.size=u.size}var ep,lm=I(()=>{pl(),iy(),ay(),oy(),ly(),cy(),uh.prototype.clear=n5,uh.prototype.delete=H2,uh.prototype.get=i5,uh.prototype.has=j2,uh.prototype.set=uy,ep=uh});function tc(a,u){for(var c=-1,m=a==null?0:a.length,_=0,b=[];++c<m;){var E=a[c];u(E,c,a)&&(b[_++]=E)}return b}var hy,dy=I(()=>{hy=tc});function o5(){return[]}var l5,fy=I(()=>{l5=o5}),tp,Fa,u5,py,um,La=I(()=>{dy(),fy(),tp=Object.prototype,Fa=tp.propertyIsEnumerable,u5=Object.getOwnPropertySymbols,py=u5?function(a){return a==null?[]:(a=Object(a),hy(u5(a),function(u){return Fa.call(a,u)}))}:l5,um=py});function bx(a,u,c){var m=u(a);return Ps(a)?m:F2(m,c(a))}var Zn,np=I(()=>{L2(),Gs(),Zn=bx});function c5(a){return Zn(a,M0,um)}var W2,my=I(()=>{np(),La(),ru(),W2=c5}),rp,Ed,h5=I(()=>{Lu(),Ar(),rp=Xo(Ln,"DataView"),Ed=rp}),d5,cm,f5=I(()=>{Lu(),Ar(),d5=Xo(Ln,"Promise"),cm=d5}),$2,nc,Ea=I(()=>{Lu(),Ar(),$2=Xo(Ln,"Set"),nc=$2}),Zo,cu,q2,X2,Qo,hm,gl,gy,p5,m5,g5,rc,v5,Y2=I(()=>{h5(),$f(),f5(),Ea(),If(),Tn(),b0(),Zo="[object Map]",cu="[object Object]",q2="[object Promise]",X2="[object Set]",Qo="[object WeakMap]",hm="[object DataView]",gl=js(Ed),gy=js(xd),p5=js(cm),m5=js(nc),g5=js(Wc),rc=Ze,(Ed&&rc(new Ed(new ArrayBuffer(1)))!=hm||xd&&rc(new xd)!=Zo||cm&&rc(cm.resolve())!=q2||nc&&rc(new nc)!=X2||Wc&&rc(new Wc)!=Qo)&&(rc=function(a){var u=Ze(a),c=u==cu?a.constructor:void 0,m=c?js(c):"";if(m)switch(m){case gl:return hm;case gy:return Zo;case p5:return q2;case m5:return X2;case g5:return Qo}return u}),v5=rc}),K2,ko,Ai=I(()=>{Ar(),K2=Ln.Uint8Array,ko=K2});function Ta(a){return this.__data__.set(a,$s),this}var $s,Ma,Jo=I(()=>{$s="__lodash_hash_undefined__",Ma=Ta});function ip(a){return this.__data__.has(a)}var Ur,ch=I(()=>{Ur=ip});function hu(a){var u=-1,c=a==null?0:a.length;for(this.__data__=new Zu;++u<c;)this.add(a[u])}var sp,Z2=I(()=>{R2(),Jo(),ch(),hu.prototype.add=hu.prototype.push=Ma,hu.prototype.has=Ur,sp=hu});function dm(a,u){for(var c=-1,m=a==null?0:a.length;++c<m;)if(u(a[c],c,a))return!0;return!1}var fo,y5=I(()=>{fo=dm});function ap(a,u){return a.has(u)}var vl,fm=I(()=>{vl=ap});function _5(a,u,c,m,_,b){var E=c&P0,T=a.length,R=u.length;if(T!=R&&!(E&&R>T))return!1;var N=b.get(a),z=b.get(u);if(N&&z)return N==u&&z==a;var G=-1,V=!0,B=c&pm?new sp:void 0;for(b.set(a,u),b.set(u,a);++G<T;){var j=a[G],H=u[G];if(m)var X=E?m(H,j,G,u,a,b):m(j,H,G,a,u,b);if(X!==void 0){if(X)continue;V=!1;break}if(B){if(!fo(u,function(K,te){if(!vl(B,te)&&(j===K||_(j,K,c,m,b)))return B.push(te)})){V=!1;break}}else if(!(j===H||_(j,H,c,m,b))){V=!1;break}}return b.delete(a),b.delete(u),V}var P0,pm,du,mm=I(()=>{Z2(),y5(),fm(),P0=1,pm=2,du=_5});function gm(a){var u=-1,c=Array(a.size);return a.forEach(function(m,_){c[++u]=[_,m]}),c}var Q2,J2=I(()=>{Q2=gm});function e9(a){var u=-1,c=Array(a.size);return a.forEach(function(m){c[++u]=m}),c}var Ca,yl=I(()=>{Ca=e9});function _l(a,u,c,m,_,b,E){switch(c){case w5:if(a.byteLength!=u.byteLength||a.byteOffset!=u.byteOffset)return!1;a=a.buffer,u=u.buffer;case S5:return!(a.byteLength!=u.byteLength||!b(new ko(a),new ko(u)));case t9:case n9:case b5:return bi(+a,+u);case vy:return a.name==u.name&&a.message==u.message;case r9:case i9:return a==u+"";case ic:var T=Q2;case hh:var R=m&po;if(T||(T=Ca),a.size!=u.size&&!R)return!1;var N=E.get(a);if(N)return N==u;m|=x5,E.set(a,u);var z=du(T(a),T(u),m,_,b,E);return E.delete(a),z;case dh:if(Td)return Td.call(a)==Td.call(u)}return!1}var po,x5,t9,n9,vy,ic,b5,r9,hh,i9,dh,S5,w5,vm,Td,yy,_y=I(()=>{gi(),Ai(),Vu(),mm(),J2(),yl(),po=1,x5=2,t9="[object Boolean]",n9="[object Date]",vy="[object Error]",ic="[object Map]",b5="[object Number]",r9="[object RegExp]",hh="[object Set]",i9="[object String]",dh="[object Symbol]",S5="[object ArrayBuffer]",w5="[object DataView]",vm=fr?fr.prototype:void 0,Td=vm?vm.valueOf:void 0,yy=_l});function s9(a,u,c,m,_,b){var E=c&E5,T=W2(a),R=T.length,N=W2(u),z=N.length;if(R!=z&&!E)return!1;for(var G=R;G--;){var V=T[G];if(!(E?V in u:xy.call(u,V)))return!1}var B=b.get(a),j=b.get(u);if(B&&j)return B==u&&j==a;var H=!0;b.set(a,u),b.set(u,a);for(var X=E;++G<R;){V=T[G];var K=a[V],te=u[V];if(m)var se=E?m(te,K,V,u,a,b):m(K,te,V,a,u,b);if(!(se===void 0?K===te||_(K,te,c,m,b):se)){H=!1;break}X||(X=V=="constructor")}if(H&&!X){var pe=a.constructor,fe=u.constructor;pe!=fe&&"constructor"in a&&"constructor"in u&&!(typeof pe=="function"&&pe instanceof pe&&typeof fe=="function"&&fe instanceof fe)&&(H=!1)}return b.delete(a),b.delete(u),H}var E5,fh,xy,Md,by=I(()=>{my(),E5=1,fh=Object.prototype,xy=fh.hasOwnProperty,Md=s9});function ks(a,u,c,m,_,b){var E=Ps(a),T=Ps(u),R=E?o9:v5(a),N=T?o9:v5(u);R=R==a9?op:R,N=N==a9?op:N;var z=R==op,G=N==op,V=R==N;if(V&&zf(a)){if(!zf(u))return!1;E=!0,z=!1}if(V&&!z)return b||(b=new ep),E||hd(a)?du(a,u,c,m,_,b):yy(a,u,R,c,m,_,b);if(!(c&Sy)){var B=z&&l9.call(a,"__wrapped__"),j=G&&l9.call(u,"__wrapped__");if(B||j){var H=B?a.value():a,X=j?u.value():u;return b||(b=new ep),_(H,X,c,m,b)}}return V?(b||(b=new ep),Md(a,u,c,m,_,b)):!1}var Sy,a9,o9,op,lp,l9,T5,R0=I(()=>{lm(),mm(),_y(),by(),Y2(),Gs(),L1(),ju(),Sy=1,a9="[object Arguments]",o9="[object Array]",op="[object Object]",lp=Object.prototype,l9=lp.hasOwnProperty,T5=ks});function u9(a,u,c,m,_){return a===u?!0:a==null||u==null||!kn(a)&&!kn(u)?a!==a&&u!==u:T5(a,u,c,m,u9,_)}var c9,fu=I(()=>{R0(),ln(),c9=u9});function h9(a,u,c,m){var _=c.length,b=_,E=!m;if(a==null)return!b;for(a=Object(a);_--;){var T=c[_];if(E&&T[2]?T[1]!==a[T[0]]:!(T[0]in a))return!1}for(;++_<b;){T=c[_];var R=T[0],N=a[R],z=T[1];if(E&&T[2]){if(N===void 0&&!(R in a))return!1}else{var G=new ep;if(m)var V=m(N,z,R,a,u,G);if(!(V===void 0?c9(z,N,ph|ym,m,G):V))return!1}}return!0}var ph,ym,d9,M5=I(()=>{lm(),fu(),ph=1,ym=2,d9=h9});function wy(a){return a===a&&!st(a)}var _m,Ey=I(()=>{Pt(),_m=wy});function Ty(a){for(var u=M0(a),c=u.length;c--;){var m=u[c],_=a[m];u[c]=[m,_,_m(_)]}return u}var f9,p9=I(()=>{Ey(),ru(),f9=Ty});function m9(a,u){return function(c){return c==null?!1:c[a]===u&&(u!==void 0||a in Object(c))}}var g9,v9=I(()=>{g9=m9});function Sx(a){var u=f9(a);return u.length==1&&u[0][2]?g9(u[0][0],u[0][1]):function(c){return c===a||d9(c,a,u)}}var C5,A5=I(()=>{M5(),p9(),v9(),C5=Sx});function y9(a,u){return a!=null&&u in Object(a)}var _9,x9=I(()=>{_9=y9});function My(a,u,c){u=oh(u,a);for(var m=-1,_=u.length,b=!1;++m<_;){var E=Sd(u[m]);if(!(b=a!=null&&c(a,E)))break;a=a[E]}return b||++m!=_?b:(_=a==null?0:a.length,!!_&&Ye(_)&&zu(E,_)&&(Ps(a)||Gu(a)))}var Cy,b9=I(()=>{D2(),D1(),Gs(),ns(),Bt(),wd(),Cy=My});function Ay(a,u){return a!=null&&Cy(a,u,_9)}var up,wx=I(()=>{x9(),b9(),up=Ay});function S9(a,u){return hl(a)&&_m(u)?g9(Sd(a),u):function(c){var m=Qu(c,a);return m===void 0&&m===u?up(c,a):c9(u,m,d|g)}}var d,g,M,O=I(()=>{fu(),Qf(),wx(),nh(),Ey(),v9(),wd(),d=1,g=2,M=S9});function q(a){return function(u){return u==null?void 0:u[a]}}var ee,ge=I(()=>{ee=q});function Fe(a){return function(u){return tm(u,a)}}var Xe,Ot=I(()=>{Zf(),Xe=Fe});function an(a){return hl(a)?ee(Sd(a)):Xe(a)}var yn,on=I(()=>{ge(),Ot(),nh(),wd(),yn=an});function $n(a){return typeof a=="function"?a:a==null?Rs:typeof a=="object"?Ps(a)?M(a[0],a[1]):C5(a):yn(a)}var qn,Qn=I(()=>{A5(),O(),qo(),Gs(),on(),qn=$n});function qs(a,u,c,m){for(var _=-1,b=a==null?0:a.length;++_<b;){var E=a[_];u(m,E,c(E),a)}return m}var xt,tt=I(()=>{xt=qs});function At(a){return function(u,c,m){for(var _=-1,b=Object(u),E=m(u),T=E.length;T--;){var R=E[a?T:++_];if(c(b[R],R,b)===!1)break}return u}}var En,cr=I(()=>{En=At}),wr,Er,Dr=I(()=>{cr(),wr=En(),Er=wr});function Aa(a,u){return a&&Er(a,u,M0)}var Si,sc=I(()=>{Dr(),ru(),Si=Aa});function Ex(a,u){return function(c,m){if(c==null)return c;if(!di(c))return a(c,m);for(var _=c.length,b=u?_:-1,E=Object(c);(u?b--:++b<_)&&m(E[b],b,E)!==!1;);return c}}var Tx,eN=I(()=>{ia(),Tx=Ex}),ZE,Py,QE=I(()=>{sc(),eN(),ZE=Tx(Si),Py=ZE});function tN(a,u,c,m){return Py(a,function(_,b,E){u(m,_,c(_),E)}),m}var JE,nN=I(()=>{QE(),JE=tN});function rN(a,u){return function(c,m){var _=Ps(c)?xt:JE,b=u?u():{};return _(c,a,qn(m,2),b)}}var eT,Mx=I(()=>{tt(),nN(),Qn(),Gs(),eT=rN}),Ry,Iy,tT=I(()=>{Ar(),Ry=function(){return Ln.Date.now()},Iy=Ry});function nT(a,u,c){var m,_,b,E,T,R,N=0,z=!1,G=!1,V=!0;if(typeof a!="function")throw new TypeError(Cx);u=ur(u)||0,st(c)&&(z=!!c.leading,G="maxWait"in c,b=G?rT(ur(c.maxWait)||0,u):b,V="trailing"in c?!!c.trailing:V);function B(ye){var Ne=m,ze=_;return m=_=void 0,N=ye,E=a.apply(ze,Ne),E}function j(ye){return N=ye,T=setTimeout(K,u),z?B(ye):E}function H(ye){var Ne=ye-R,ze=ye-N,Me=u-Ne;return G?Ax(Me,b-ze):Me}function X(ye){var Ne=ye-R,ze=ye-N;return R===void 0||Ne>=u||Ne<0||G&&ze>=b}function K(){var ye=Iy();if(X(ye))return te(ye);T=setTimeout(K,H(ye))}function te(ye){return T=void 0,V&&m?B(ye):(m=_=void 0,E)}function se(){T!==void 0&&clearTimeout(T),N=0,m=R=_=T=void 0}function pe(){return T===void 0?E:te(Iy())}function fe(){var ye=Iy(),Ne=X(ye);if(m=arguments,_=this,R=ye,Ne){if(T===void 0)return j(R);if(G)return clearTimeout(T),T=setTimeout(K,u),B(R)}return T===void 0&&(T=setTimeout(K,u)),E}return fe.cancel=se,fe.flush=pe,fe}var Cx,rT,Ax,ky,iT=I(()=>{Pt(),tT(),vr(),Cx="Expected a function",rT=Math.max,Ax=Math.min,ky=nT});function iN(a,u,c){for(var m=-1,_=a==null?0:a.length;++m<_;)if(c(u,a[m]))return!0;return!1}var sT,aT=I(()=>{sT=iN});function sN(a){var u=a==null?0:a.length;return u?a[u-1]:void 0}var xm,Ny=I(()=>{xm=sN});function oT(a,u,c){var m=a==null?0:a.length;if(!m)return-1;var _=c==null?0:er(c);return _<0&&(_=lT(m+_,0)),qc(a,qn(u,3),_)}var lT,Px,aN=I(()=>{E1(),Qn(),Qi(),lT=Math.max,Px=oT});function oN(a,u,c){var m=a==null?0:a.length;if(!m)return-1;var _=m-1;return c!==void 0&&(_=er(c),_=c<0?w9(m+_,0):uT(_,m-1)),qc(a,qn(u,3),_,!0)}var w9,uT,Rx,lN=I(()=>{E1(),Qn(),Qi(),w9=Math.max,uT=Math.min,Rx=oN});function uN(a,u){var c=-1,m=di(a)?Array(a.length):[];return Py(a,function(_,b,E){m[++c]=u(_,b,E)}),m}var cT,Dy=I(()=>{QE(),ia(),cT=uN});function Ix(a,u,c){return a>=dT(u,c)&&a<hT(u,c)}var hT,dT,hs,xl=I(()=>{hT=Math.max,dT=Math.min,hs=Ix});function bl(a,u,c){return u=Di(u),c===void 0?(c=u,u=0):c=Di(c),a=ur(a),hs(a,u,c)}var Cd,_s=I(()=>{xl(),Zi(),vr(),Cd=bl});function Ad(a){return typeof a=="number"&&a==er(a)}var Oy,fT=I(()=>{Qi(),Oy=Ad}),pT,P5,cN=I(()=>{Jl(),Mx(),pT=eT(function(a,u,c){ol(a,c,u)}),P5=pT});function hN(a,u){var c={};return u=qn(u,3),Si(a,function(m,_,b){ol(c,_,u(m,_,b))}),c}var cp,kx=I(()=>{Jl(),sc(),Qn(),cp=hN});function Fy(a,u,c,m){if(!st(a))return a;u=oh(u,a);for(var _=-1,b=u.length,E=b-1,T=a;T!=null&&++_<b;){var R=Sd(u[_]),N=c;if(R==="__proto__"||R==="constructor"||R==="prototype")return a;if(_!=E){var z=T[R];N=m?m(z,R,T):void 0,N===void 0&&(N=st(z)?z:zu(u[_+1])?[]:{})}I1(T,R,N),T=T[R]}return a}var Nx,dN=I(()=>{n2(),D2(),ns(),Pt(),wd(),Nx=Fy});function mT(a,u){var c=a.length;for(a.sort(u);c--;)a[c]=a[c].value;return a}var Dx,gT=I(()=>{Dx=mT});function fN(a,u){if(a!==u){var c=a!==void 0,m=a===null,_=a===a,b=br(a),E=u!==void 0,T=u===null,R=u===u,N=br(u);if(!T&&!N&&!b&&a>u||b&&E&&R&&!T&&!N||m&&E&&R||!c&&R||!_)return 1;if(!m&&!b&&!N&&a<u||N&&c&&_&&!m&&!b||T&&c&&_||!E&&_||!R)return-1}return 0}var vT,yT=I(()=>{xi(),vT=fN});function pN(a,u,c){for(var m=-1,_=a.criteria,b=u.criteria,E=_.length,T=c.length;++m<E;){var R=vT(_[m],b[m]);if(R){if(m>=T)return R;var N=c[m];return R*(N=="desc"?-1:1)}}return a.index-u.index}var _T,R5=I(()=>{yT(),_T=pN});function xT(a,u,c){u.length?u=Vs(u,function(b){return Ps(b)?function(E){return tm(E,b.length===1?b[0]:b)}:b}):u=[Rs];var m=-1;u=Vs(u,Hf(qn));var _=cT(a,function(b,E,T){var R=Vs(u,function(N){return N(b)});return{criteria:R,index:++m,value:b}});return Dx(_,function(b,E){return _T(b,E,c)})}var bT,mN=I(()=>{la(),Zf(),Qn(),Dy(),gT(),eu(),R5(),qo(),Gs(),bT=xT});function Za(a,u,c,m){for(var _=c-1,b=a.length;++_<b;)if(m(a[_],u))return _;return-1}var Pd,gN=I(()=>{Pd=Za});function Ly(a,u,c,m){var _=m?Pd:Xc,b=-1,E=u.length,T=a;for(a===u&&(u=Zl(u)),c&&(T=Vs(a,Hf(c)));++b<E;)for(var R=0,N=u[b],z=c?c(N):N;(R=_(T,z,R,m))>-1;)T!==a&&Ox.call(T,R,1),Ox.call(a,R,1);return a}var ST,Ox,wT,vN=I(()=>{la(),M1(),gN(),eu(),S1(),ST=Array.prototype,Ox=ST.splice,wT=Ly});function Fx(a,u){return a&&a.length&&u&&u.length?wT(a,u):a}var ET,Uy=I(()=>{vN(),ET=Fx}),bm,TT,yN=I(()=>{N1(),Uy(),bm=k1(ET),TT=bm}),Lx,By,_N=I(()=>{ty(),Lx=am("round"),By=Lx});function zy(a,u,c){return a==null?a:Nx(a,u,c)}var Sm,Vy=I(()=>{dN(),Sm=zy}),MT,CT,xN=I(()=>{rm(),mN(),N1(),Zc(),MT=k1(function(a,u){if(a==null)return[];var c=u.length;return c>1&&Lf(a,u[0],u[1])?u=[]:c>2&&Lf(u[0],u[1],u[2])&&(u=[u[0]]),bT(a,B2(u,1),[])}),CT=MT}),AT,PT,RT,bN=I(()=>{Ea(),b1(),yl(),AT=1/0,PT=nc&&1/Ca(new nc([,-0]))[1]==AT?function(a){return new nc(a)}:$c,RT=PT});function wm(a,u,c){var m=-1,_=Ya,b=a.length,E=!0,T=[],R=T;if(c)E=!1,_=sT;else if(b>=hp){var N=u?null:RT(a);if(N)return Ca(N);E=!1,_=vl,R=new sp}else R=u?[]:T;e:for(;++m<b;){var z=a[m],G=u?u(z):z;if(z=c||z!==0?z:0,E&&G===G){for(var V=R.length;V--;)if(R[V]===G)continue e;u&&R.push(G),T.push(z)}else _(R,G,c)||(R!==T&&R.push(G),T.push(z))}return T}var hp,Em,Ux=I(()=>{Z2(),p4(),aT(),fm(),bN(),yl(),hp=200,Em=wm});function IT(a){return a&&a.length?Em(a):[]}var dp,kT=I(()=>{Ux(),dp=IT}),Ua=I(()=>{Jf(),iT(),aN(),_s(),fT(),G2(),Ny(),kx(),Q1(),_N(),kT()}),Bx=ie((a,u)=>{var c;u.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:xa):m=>(c||(c=Promise.resolve())).then(m).catch(_=>setTimeout(()=>{throw _},0))}),SN=ie(a=>{var u=Symbol.for("react.element"),c=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),T=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),z=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),V=Symbol.iterator;function B(be){return be===null||typeof be!="object"?null:(be=V&&be[V]||be["@@iterator"],typeof be=="function"?be:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,X={};function K(be,Ce,St){this.props=be,this.context=Ce,this.refs=X,this.updater=St||j}K.prototype.isReactComponent={},K.prototype.setState=function(be,Ce){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Ce,"setState")},K.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function te(){}te.prototype=K.prototype;function se(be,Ce,St){this.props=be,this.context=Ce,this.refs=X,this.updater=St||j}var pe=se.prototype=new te;pe.constructor=se,H(pe,K.prototype),pe.isPureReactComponent=!0;var fe=Array.isArray,ye=Object.prototype.hasOwnProperty,Ne={current:null},ze={key:!0,ref:!0,__self:!0,__source:!0};function Me(be,Ce,St){var Mt,It={},ut=null,Gn=null;if(Ce!=null)for(Mt in Ce.ref!==void 0&&(Gn=Ce.ref),Ce.key!==void 0&&(ut=""+Ce.key),Ce)ye.call(Ce,Mt)&&!ze.hasOwnProperty(Mt)&&(It[Mt]=Ce[Mt]);var Vt=arguments.length-2;if(Vt===1)It.children=St;else if(1<Vt){for(var Nn=Array(Vt),hr=0;hr<Vt;hr++)Nn[hr]=arguments[hr+2];It.children=Nn}if(be&&be.defaultProps)for(Mt in Vt=be.defaultProps,Vt)It[Mt]===void 0&&(It[Mt]=Vt[Mt]);return{$$typeof:u,type:be,key:ut,ref:Gn,props:It,_owner:Ne.current}}function je(be,Ce){return{$$typeof:u,type:be.type,key:Ce,ref:be.ref,props:be.props,_owner:be._owner}}function yt(be){return typeof be=="object"&&be!==null&&be.$$typeof===u}function xe(be){var Ce={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(St){return Ce[St]})}var We=/\/+/g;function ae(be,Ce){return typeof be=="object"&&be!==null&&be.key!=null?xe(""+be.key):Ce.toString(36)}function nt(be,Ce,St,Mt,It){var ut=typeof be;(ut==="undefined"||ut==="boolean")&&(be=null);var Gn=!1;if(be===null)Gn=!0;else switch(ut){case"string":case"number":Gn=!0;break;case"object":switch(be.$$typeof){case u:case c:Gn=!0}}if(Gn)return Gn=be,It=It(Gn),be=Mt===""?"."+ae(Gn,0):Mt,fe(It)?(St="",be!=null&&(St=be.replace(We,"$&/")+"/"),nt(It,Ce,St,"",function(hr){return hr})):It!=null&&(yt(It)&&(It=je(It,St+(!It.key||Gn&&Gn.key===It.key?"":(""+It.key).replace(We,"$&/")+"/")+be)),Ce.push(It)),1;if(Gn=0,Mt=Mt===""?".":Mt+":",fe(be))for(var Vt=0;Vt<be.length;Vt++){ut=be[Vt];var Nn=Mt+ae(ut,Vt);Gn+=nt(ut,Ce,St,Nn,It)}else if(Nn=B(be),typeof Nn=="function")for(be=Nn.call(be),Vt=0;!(ut=be.next()).done;)ut=ut.value,Nn=Mt+ae(ut,Vt++),Gn+=nt(ut,Ce,St,Nn,It);else if(ut==="object")throw Ce=String(be),Error("Objects are not valid as a React child (found: "+(Ce==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Ce)+"). If you meant to render a collection of children, use an array instead.");return Gn}function dn(be,Ce,St){if(be==null)return be;var Mt=[],It=0;return nt(be,Mt,"","",function(ut){return Ce.call(St,ut,It++)}),Mt}function Ve(be){if(be._status===-1){var Ce=be._result;Ce=Ce(),Ce.then(function(St){(be._status===0||be._status===-1)&&(be._status=1,be._result=St)},function(St){(be._status===0||be._status===-1)&&(be._status=2,be._result=St)}),be._status===-1&&(be._status=0,be._result=Ce)}if(be._status===1)return be._result.default;throw be._result}var Ue={current:null},at={transition:null},Wt={ReactCurrentDispatcher:Ue,ReactCurrentBatchConfig:at,ReactCurrentOwner:Ne};a.Children={map:dn,forEach:function(be,Ce,St){dn(be,function(){Ce.apply(this,arguments)},St)},count:function(be){var Ce=0;return dn(be,function(){Ce++}),Ce},toArray:function(be){return dn(be,function(Ce){return Ce})||[]},only:function(be){if(!yt(be))throw Error("React.Children.only expected to receive a single React element child.");return be}},a.Component=K,a.Fragment=m,a.Profiler=b,a.PureComponent=se,a.StrictMode=_,a.Suspense=N,a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wt,a.cloneElement=function(be,Ce,St){if(be==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+be+".");var Mt=H({},be.props),It=be.key,ut=be.ref,Gn=be._owner;if(Ce!=null){if(Ce.ref!==void 0&&(ut=Ce.ref,Gn=Ne.current),Ce.key!==void 0&&(It=""+Ce.key),be.type&&be.type.defaultProps)var Vt=be.type.defaultProps;for(Nn in Ce)ye.call(Ce,Nn)&&!ze.hasOwnProperty(Nn)&&(Mt[Nn]=Ce[Nn]===void 0&&Vt!==void 0?Vt[Nn]:Ce[Nn])}var Nn=arguments.length-2;if(Nn===1)Mt.children=St;else if(1<Nn){Vt=Array(Nn);for(var hr=0;hr<Nn;hr++)Vt[hr]=arguments[hr+2];Mt.children=Vt}return{$$typeof:u,type:be.type,key:It,ref:ut,props:Mt,_owner:Gn}},a.createContext=function(be){return be={$$typeof:T,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},be.Provider={$$typeof:E,_context:be},be.Consumer=be},a.createElement=Me,a.createFactory=function(be){var Ce=Me.bind(null,be);return Ce.type=be,Ce},a.createRef=function(){return{current:null}},a.forwardRef=function(be){return{$$typeof:R,render:be}},a.isValidElement=yt,a.lazy=function(be){return{$$typeof:G,_payload:{_status:-1,_result:be},_init:Ve}},a.memo=function(be,Ce){return{$$typeof:z,type:be,compare:Ce===void 0?null:Ce}},a.startTransition=function(be){var Ce=at.transition;at.transition={};try{be()}finally{at.transition=Ce}},a.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},a.useCallback=function(be,Ce){return Ue.current.useCallback(be,Ce)},a.useContext=function(be){return Ue.current.useContext(be)},a.useDebugValue=function(){},a.useDeferredValue=function(be){return Ue.current.useDeferredValue(be)},a.useEffect=function(be,Ce){return Ue.current.useEffect(be,Ce)},a.useId=function(){return Ue.current.useId()},a.useImperativeHandle=function(be,Ce,St){return Ue.current.useImperativeHandle(be,Ce,St)},a.useInsertionEffect=function(be,Ce){return Ue.current.useInsertionEffect(be,Ce)},a.useLayoutEffect=function(be,Ce){return Ue.current.useLayoutEffect(be,Ce)},a.useMemo=function(be,Ce){return Ue.current.useMemo(be,Ce)},a.useReducer=function(be,Ce,St){return Ue.current.useReducer(be,Ce,St)},a.useRef=function(be){return Ue.current.useRef(be)},a.useState=function(be){return Ue.current.useState(be)},a.useSyncExternalStore=function(be,Ce,St){return Ue.current.useSyncExternalStore(be,Ce,St)},a.useTransition=function(){return Ue.current.useTransition()},a.version="18.2.0"}),qe=ie((a,u)=>{u.exports=SN()}),NT=ie(a=>{function u(Ue,at){var Wt=Ue.length;Ue.push(at);e:for(;0<Wt;){var be=Wt-1>>>1,Ce=Ue[be];if(0<_(Ce,at))Ue[be]=at,Ue[Wt]=Ce,Wt=be;else break e}}function c(Ue){return Ue.length===0?null:Ue[0]}function m(Ue){if(Ue.length===0)return null;var at=Ue[0],Wt=Ue.pop();if(Wt!==at){Ue[0]=Wt;e:for(var be=0,Ce=Ue.length,St=Ce>>>1;be<St;){var Mt=2*(be+1)-1,It=Ue[Mt],ut=Mt+1,Gn=Ue[ut];if(0>_(It,Wt))ut<Ce&&0>_(Gn,It)?(Ue[be]=Gn,Ue[ut]=Wt,be=ut):(Ue[be]=It,Ue[Mt]=Wt,be=Mt);else if(ut<Ce&&0>_(Gn,Wt))Ue[be]=Gn,Ue[ut]=Wt,be=ut;else break e}}return at}function _(Ue,at){var Wt=Ue.sortIndex-at.sortIndex;return Wt!==0?Wt:Ue.id-at.id}typeof performance=="object"&&typeof performance.now=="function"?(b=performance,a.unstable_now=function(){return b.now()}):(E=Date,T=E.now(),a.unstable_now=function(){return E.now()-T});var b,E,T,R=[],N=[],z=1,G=null,V=3,B=!1,j=!1,H=!1,X=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(Ue){for(var at=c(N);at!==null;){if(at.callback===null)m(N);else if(at.startTime<=Ue)m(N),at.sortIndex=at.expirationTime,u(R,at);else break;at=c(N)}}function pe(Ue){if(H=!1,se(Ue),!j)if(c(R)!==null)j=!0,dn(fe);else{var at=c(N);at!==null&&Ve(pe,at.startTime-Ue)}}function fe(Ue,at){j=!1,H&&(H=!1,K(ze),ze=-1),B=!0;var Wt=V;try{for(se(at),G=c(R);G!==null&&(!(G.expirationTime>at)||Ue&&!yt());){var be=G.callback;if(typeof be=="function"){G.callback=null,V=G.priorityLevel;var Ce=be(G.expirationTime<=at);at=a.unstable_now(),typeof Ce=="function"?G.callback=Ce:G===c(R)&&m(R),se(at)}else m(R);G=c(R)}if(G!==null)var St=!0;else{var Mt=c(N);Mt!==null&&Ve(pe,Mt.startTime-at),St=!1}return St}finally{G=null,V=Wt,B=!1}}var ye=!1,Ne=null,ze=-1,Me=5,je=-1;function yt(){return!(a.unstable_now()-je<Me)}function xe(){if(Ne!==null){var Ue=a.unstable_now();je=Ue;var at=!0;try{at=Ne(!0,Ue)}finally{at?We():(ye=!1,Ne=null)}}else ye=!1}var We;typeof te=="function"?We=function(){te(xe)}:typeof MessageChannel<"u"?(ae=new MessageChannel,nt=ae.port2,ae.port1.onmessage=xe,We=function(){nt.postMessage(null)}):We=function(){X(xe,0)};var ae,nt;function dn(Ue){Ne=Ue,ye||(ye=!0,We())}function Ve(Ue,at){ze=X(function(){Ue(a.unstable_now())},at)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Ue){Ue.callback=null},a.unstable_continueExecution=function(){j||B||(j=!0,dn(fe))},a.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Me=0<Ue?Math.floor(1e3/Ue):5},a.unstable_getCurrentPriorityLevel=function(){return V},a.unstable_getFirstCallbackNode=function(){return c(R)},a.unstable_next=function(Ue){switch(V){case 1:case 2:case 3:var at=3;break;default:at=V}var Wt=V;V=at;try{return Ue()}finally{V=Wt}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(Ue,at){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var Wt=V;V=Ue;try{return at()}finally{V=Wt}},a.unstable_scheduleCallback=function(Ue,at,Wt){var be=a.unstable_now();switch(typeof Wt=="object"&&Wt!==null?(Wt=Wt.delay,Wt=typeof Wt=="number"&&0<Wt?be+Wt:be):Wt=be,Ue){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=Wt+Ce,Ue={id:z++,callback:at,priorityLevel:Ue,startTime:Wt,expirationTime:Ce,sortIndex:-1},Wt>be?(Ue.sortIndex=Wt,u(N,Ue),c(R)===null&&Ue===c(N)&&(H?(K(ze),ze=-1):H=!0,Ve(pe,Wt-be))):(Ue.sortIndex=Ce,u(R,Ue),j||B||(j=!0,dn(fe))),Ue},a.unstable_shouldYield=yt,a.unstable_wrapCallback=function(Ue){var at=V;return function(){var Wt=V;V=at;try{return Ue.apply(this,arguments)}finally{V=Wt}}}}),DT=ie((a,u)=>{u.exports=NT()}),wN=ie(a=>{var u=qe(),c=DT();function m(f){for(var v="https://reactjs.org/docs/error-decoder.html?invariant="+f,C=1;C<arguments.length;C++)v+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+f+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _=new Set,b={};function E(f,v){T(f,v),T(f+"Capture",v)}function T(f,v){for(b[f]=v,f=0;f<v.length;f++)_.add(v[f])}var R=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),N=Object.prototype.hasOwnProperty,z=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G={},V={};function B(f){return N.call(V,f)?!0:N.call(G,f)?!1:z.test(f)?V[f]=!0:(G[f]=!0,!1)}function j(f,v,C,F){if(C!==null&&C.type===0)return!1;switch(typeof v){case"function":case"symbol":return!0;case"boolean":return F?!1:C!==null?!C.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function H(f,v,C,F){if(v===null||typeof v>"u"||j(f,v,C,F))return!0;if(F)return!1;if(C!==null)switch(C.type){case 3:return!v;case 4:return v===!1;case 5:return isNaN(v);case 6:return isNaN(v)||1>v}return!1}function X(f,v,C,F,Y,ne,ve){this.acceptsBooleans=v===2||v===3||v===4,this.attributeName=F,this.attributeNamespace=Y,this.mustUseProperty=C,this.propertyName=f,this.type=v,this.sanitizeURL=ne,this.removeEmptyString=ve}var K={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){K[f]=new X(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var v=f[0];K[v]=new X(v,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){K[f]=new X(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){K[f]=new X(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){K[f]=new X(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){K[f]=new X(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){K[f]=new X(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){K[f]=new X(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){K[f]=new X(f,5,!1,f.toLowerCase(),null,!1,!1)});var te=/[\-:]([a-z])/g;function se(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var v=f.replace(te,se);K[v]=new X(v,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var v=f.replace(te,se);K[v]=new X(v,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var v=f.replace(te,se);K[v]=new X(v,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){K[f]=new X(f,1,!1,f.toLowerCase(),null,!1,!1)}),K.xlinkHref=new X("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){K[f]=new X(f,1,!1,f.toLowerCase(),null,!0,!0)});function pe(f,v,C,F){var Y=K.hasOwnProperty(v)?K[v]:null;(Y!==null?Y.type!==0:F||!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(H(v,C,Y,F)&&(C=null),F||Y===null?B(v)&&(C===null?f.removeAttribute(v):f.setAttribute(v,""+C)):Y.mustUseProperty?f[Y.propertyName]=C===null?Y.type===3?!1:"":C:(v=Y.attributeName,F=Y.attributeNamespace,C===null?f.removeAttribute(v):(Y=Y.type,C=Y===3||Y===4&&C===!0?"":""+C,F?f.setAttributeNS(F,v,C):f.setAttribute(v,C))))}var fe=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ye=Symbol.for("react.element"),Ne=Symbol.for("react.portal"),ze=Symbol.for("react.fragment"),Me=Symbol.for("react.strict_mode"),je=Symbol.for("react.profiler"),yt=Symbol.for("react.provider"),xe=Symbol.for("react.context"),We=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),nt=Symbol.for("react.suspense_list"),dn=Symbol.for("react.memo"),Ve=Symbol.for("react.lazy"),Ue=Symbol.for("react.offscreen"),at=Symbol.iterator;function Wt(f){return f===null||typeof f!="object"?null:(f=at&&f[at]||f["@@iterator"],typeof f=="function"?f:null)}var be=Object.assign,Ce;function St(f){if(Ce===void 0)try{throw Error()}catch(C){var v=C.stack.trim().match(/\n( *(at )?)/);Ce=v&&v[1]||""}return`
`+Ce+f}var Mt=!1;function It(f,v){if(!f||Mt)return"";Mt=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(v)if(v=function(){throw Error()},Object.defineProperty(v.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(v,[])}catch(Ut){var F=Ut}Reflect.construct(f,[],v)}else{try{v.call()}catch(Ut){F=Ut}f.call(v.prototype)}else{try{throw Error()}catch(Ut){F=Ut}f()}}catch(Ut){if(Ut&&F&&typeof Ut.stack=="string"){for(var Y=Ut.stack.split(`
`),ne=F.stack.split(`
`),ve=Y.length-1,Le=ne.length-1;1<=ve&&0<=Le&&Y[ve]!==ne[Le];)Le--;for(;1<=ve&&0<=Le;ve--,Le--)if(Y[ve]!==ne[Le]){if(ve!==1||Le!==1)do if(ve--,Le--,0>Le||Y[ve]!==ne[Le]){var Je=`
`+Y[ve].replace(" at new "," at ");return f.displayName&&Je.includes("<anonymous>")&&(Je=Je.replace("<anonymous>",f.displayName)),Je}while(1<=ve&&0<=Le);break}}}finally{Mt=!1,Error.prepareStackTrace=C}return(f=f?f.displayName||f.name:"")?St(f):""}function ut(f){switch(f.tag){case 5:return St(f.type);case 16:return St("Lazy");case 13:return St("Suspense");case 19:return St("SuspenseList");case 0:case 2:case 15:return f=It(f.type,!1),f;case 11:return f=It(f.type.render,!1),f;case 1:return f=It(f.type,!0),f;default:return""}}function Gn(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case ze:return"Fragment";case Ne:return"Portal";case je:return"Profiler";case Me:return"StrictMode";case ae:return"Suspense";case nt:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case xe:return(f.displayName||"Context")+".Consumer";case yt:return(f._context.displayName||"Context")+".Provider";case We:var v=f.render;return f=f.displayName,f||(f=v.displayName||v.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case dn:return v=f.displayName||null,v!==null?v:Gn(f.type)||"Memo";case Ve:v=f._payload,f=f._init;try{return Gn(f(v))}catch{}}return null}function Vt(f){var v=f.type;switch(f.tag){case 24:return"Cache";case 9:return(v.displayName||"Context")+".Consumer";case 10:return(v._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=v.render,f=f.displayName||f.name||"",v.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return v;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gn(v);case 8:return v===Me?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v}return null}function Nn(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function hr(f){var v=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function Rr(f){var v=hr(f)?"checked":"value",C=Object.getOwnPropertyDescriptor(f.constructor.prototype,v),F=""+f[v];if(!f.hasOwnProperty(v)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var Y=C.get,ne=C.set;return Object.defineProperty(f,v,{configurable:!0,get:function(){return Y.call(this)},set:function(ve){F=""+ve,ne.call(this,ve)}}),Object.defineProperty(f,v,{enumerable:C.enumerable}),{getValue:function(){return F},setValue:function(ve){F=""+ve},stopTracking:function(){f._valueTracker=null,delete f[v]}}}}function Tr(f){f._valueTracker||(f._valueTracker=Rr(f))}function Wi(f){if(!f)return!1;var v=f._valueTracker;if(!v)return!0;var C=v.getValue(),F="";return f&&(F=hr(f)?f.checked?"true":"false":f.value),f=F,f!==C?(v.setValue(f),!0):!1}function he(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Lt(f,v){var C=v.checked;return be({},v,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:C??f._wrapperState.initialChecked})}function kt(f,v){var C=v.defaultValue==null?"":v.defaultValue,F=v.checked!=null?v.checked:v.defaultChecked;C=Nn(v.value!=null?v.value:C),f._wrapperState={initialChecked:F,initialValue:C,controlled:v.type==="checkbox"||v.type==="radio"?v.checked!=null:v.value!=null}}function Ie(f,v){v=v.checked,v!=null&&pe(f,"checked",v,!1)}function Re(f,v){Ie(f,v);var C=Nn(v.value),F=v.type;if(C!=null)F==="number"?(C===0&&f.value===""||f.value!=C)&&(f.value=""+C):f.value!==""+C&&(f.value=""+C);else if(F==="submit"||F==="reset"){f.removeAttribute("value");return}v.hasOwnProperty("value")?Xt(f,v.type,C):v.hasOwnProperty("defaultValue")&&Xt(f,v.type,Nn(v.defaultValue)),v.checked==null&&v.defaultChecked!=null&&(f.defaultChecked=!!v.defaultChecked)}function ct(f,v,C){if(v.hasOwnProperty("value")||v.hasOwnProperty("defaultValue")){var F=v.type;if(!(F!=="submit"&&F!=="reset"||v.value!==void 0&&v.value!==null))return;v=""+f._wrapperState.initialValue,C||v===f.value||(f.value=v),f.defaultValue=v}C=f.name,C!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,C!==""&&(f.name=C)}function Xt(f,v,C){(v!=="number"||he(f.ownerDocument)!==f)&&(C==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+C&&(f.defaultValue=""+C))}var rn=Array.isArray;function wt(f,v,C,F){if(f=f.options,v){v={};for(var Y=0;Y<C.length;Y++)v["$"+C[Y]]=!0;for(C=0;C<f.length;C++)Y=v.hasOwnProperty("$"+f[C].value),f[C].selected!==Y&&(f[C].selected=Y),Y&&F&&(f[C].defaultSelected=!0)}else{for(C=""+Nn(C),v=null,Y=0;Y<f.length;Y++){if(f[Y].value===C){f[Y].selected=!0,F&&(f[Y].defaultSelected=!0);return}v!==null||f[Y].disabled||(v=f[Y])}v!==null&&(v.selected=!0)}}function fn(f,v){if(v.dangerouslySetInnerHTML!=null)throw Error(m(91));return be({},v,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function tn(f,v){var C=v.value;if(C==null){if(C=v.children,v=v.defaultValue,C!=null){if(v!=null)throw Error(m(92));if(rn(C)){if(1<C.length)throw Error(m(93));C=C[0]}v=C}v==null&&(v=""),C=v}f._wrapperState={initialValue:Nn(C)}}function sn(f,v){var C=Nn(v.value),F=Nn(v.defaultValue);C!=null&&(C=""+C,C!==f.value&&(f.value=C),v.defaultValue==null&&f.defaultValue!==C&&(f.defaultValue=C)),F!=null&&(f.defaultValue=""+F)}function xr(f){var v=f.textContent;v===f._wrapperState.initialValue&&v!==""&&v!==null&&(f.value=v)}function zi(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hr(f,v){return f==null||f==="http://www.w3.org/1999/xhtml"?zi(v):f==="http://www.w3.org/2000/svg"&&v==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var d0,i3=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(v,C,F,Y){MSApp.execUnsafeLocalFunction(function(){return f(v,C,F,Y)})}:f}(function(f,v){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=v;else{for(d0=d0||document.createElement("div"),d0.innerHTML="<svg>"+v.valueOf().toString()+"</svg>",v=d0.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;v.firstChild;)f.appendChild(v.firstChild)}});function F0(f,v){if(v){var C=f.firstChild;if(C&&C===f.lastChild&&C.nodeType===3){C.nodeValue=v;return}}f.textContent=v}var Kd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ma=["Webkit","ms","Moz","O"];Object.keys(Kd).forEach(function(f){ma.forEach(function(v){v=v+f.charAt(0).toUpperCase()+f.substring(1),Kd[v]=Kd[f]})});function C8(f,v,C){return v==null||typeof v=="boolean"||v===""?"":C||typeof v!="number"||v===0||Kd.hasOwnProperty(f)&&Kd[f]?(""+v).trim():v+"px"}function J6(f,v){f=f.style;for(var C in v)if(v.hasOwnProperty(C)){var F=C.indexOf("--")===0,Y=C8(C,v[C],F);C==="float"&&(C="cssFloat"),F?f.setProperty(C,Y):f[C]=Y}}var Zd=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function e7(f,v){if(v){if(Zd[f]&&(v.children!=null||v.dangerouslySetInnerHTML!=null))throw Error(m(137,f));if(v.dangerouslySetInnerHTML!=null){if(v.children!=null)throw Error(m(60));if(typeof v.dangerouslySetInnerHTML!="object"||!("__html"in v.dangerouslySetInnerHTML))throw Error(m(61))}if(v.style!=null&&typeof v.style!="object")throw Error(m(62))}}function AS(f,v){if(f.indexOf("-")===-1)return typeof v.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var PS=null;function RS(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var t7=null,wh=null,Qd=null;function Jhe(f){if(f=ZS(f)){if(typeof t7!="function")throw Error(m(280));var v=f.stateNode;v&&(v=mP(v),t7(f.stateNode,f.type,v))}}function ede(f){wh?Qd?Qd.push(f):Qd=[f]:wh=f}function tde(){if(wh){var f=wh,v=Qd;if(Qd=wh=null,Jhe(f),v)for(f=0;f<v.length;f++)Jhe(v[f])}}function nde(f,v){return f(v)}function rde(){}var NU=!1;function ide(f,v,C){if(NU)return f(v,C);NU=!0;try{return nde(f,v,C)}finally{NU=!1,(wh!==null||Qd!==null)&&(rde(),tde())}}function IS(f,v){var C=f.stateNode;if(C===null)return null;var F=mP(C);if(F===null)return null;C=F[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(F=!F.disabled)||(f=f.type,F=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!F;break e;default:f=!1}if(f)return null;if(C&&typeof C!="function")throw Error(m(231,v,typeof C));return C}var DU=!1;if(R)try{n7={},Object.defineProperty(n7,"passive",{get:function(){DU=!0}}),window.addEventListener("test",n7,n7),window.removeEventListener("test",n7,n7)}catch{DU=!1}var n7;function dwe(f,v,C,F,Y,ne,ve,Le,Je){var Ut=Array.prototype.slice.call(arguments,3);try{v.apply(C,Ut)}catch(_n){this.onError(_n)}}var kS=!1,jA=null,WA=!1,OU=null,fwe={onError:function(f){kS=!0,jA=f}};function pwe(f,v,C,F,Y,ne,ve,Le,Je){kS=!1,jA=null,dwe.apply(fwe,arguments)}function mwe(f,v,C,F,Y,ne,ve,Le,Je){if(pwe.apply(this,arguments),kS){if(kS){var Ut=jA;kS=!1,jA=null}else throw Error(m(198));WA||(WA=!0,OU=Ut)}}function A8(f){var v=f,C=f;if(f.alternate)for(;v.return;)v=v.return;else{f=v;do v=f,v.flags&4098&&(C=v.return),f=v.return;while(f)}return v.tag===3?C:null}function sde(f){if(f.tag===13){var v=f.memoizedState;if(v===null&&(f=f.alternate,f!==null&&(v=f.memoizedState)),v!==null)return v.dehydrated}return null}function ade(f){if(A8(f)!==f)throw Error(m(188))}function gwe(f){var v=f.alternate;if(!v){if(v=A8(f),v===null)throw Error(m(188));return v!==f?null:f}for(var C=f,F=v;;){var Y=C.return;if(Y===null)break;var ne=Y.alternate;if(ne===null){if(F=Y.return,F!==null){C=F;continue}break}if(Y.child===ne.child){for(ne=Y.child;ne;){if(ne===C)return ade(Y),f;if(ne===F)return ade(Y),v;ne=ne.sibling}throw Error(m(188))}if(C.return!==F.return)C=Y,F=ne;else{for(var ve=!1,Le=Y.child;Le;){if(Le===C){ve=!0,C=Y,F=ne;break}if(Le===F){ve=!0,F=Y,C=ne;break}Le=Le.sibling}if(!ve){for(Le=ne.child;Le;){if(Le===C){ve=!0,C=ne,F=Y;break}if(Le===F){ve=!0,F=ne,C=Y;break}Le=Le.sibling}if(!ve)throw Error(m(189))}}if(C.alternate!==F)throw Error(m(190))}if(C.tag!==3)throw Error(m(188));return C.stateNode.current===C?f:v}function ode(f){return f=gwe(f),f!==null?lde(f):null}function lde(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var v=lde(f);if(v!==null)return v;f=f.sibling}return null}var ude=c.unstable_scheduleCallback,cde=c.unstable_cancelCallback,vwe=c.unstable_shouldYield,ywe=c.unstable_requestPaint,Va=c.unstable_now,_we=c.unstable_getCurrentPriorityLevel,FU=c.unstable_ImmediatePriority,hde=c.unstable_UserBlockingPriority,$A=c.unstable_NormalPriority,xwe=c.unstable_LowPriority,dde=c.unstable_IdlePriority,qA=null,Hp=null;function bwe(f){if(Hp&&typeof Hp.onCommitFiberRoot=="function")try{Hp.onCommitFiberRoot(qA,f,void 0,(f.current.flags&128)===128)}catch{}}var Jd=Math.clz32?Math.clz32:Ewe,Swe=Math.log,wwe=Math.LN2;function Ewe(f){return f>>>=0,f===0?32:31-(Swe(f)/wwe|0)|0}var XA=64,YA=4194304;function NS(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function KA(f,v){var C=f.pendingLanes;if(C===0)return 0;var F=0,Y=f.suspendedLanes,ne=f.pingedLanes,ve=C&268435455;if(ve!==0){var Le=ve&~Y;Le!==0?F=NS(Le):(ne&=ve,ne!==0&&(F=NS(ne)))}else ve=C&~Y,ve!==0?F=NS(ve):ne!==0&&(F=NS(ne));if(F===0)return 0;if(v!==0&&v!==F&&!(v&Y)&&(Y=F&-F,ne=v&-v,Y>=ne||Y===16&&(ne&4194240)!==0))return v;if(F&4&&(F|=C&16),v=f.entangledLanes,v!==0)for(f=f.entanglements,v&=F;0<v;)C=31-Jd(v),Y=1<<C,F|=f[C],v&=~Y;return F}function Twe(f,v){switch(f){case 1:case 2:case 4:return v+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mwe(f,v){for(var C=f.suspendedLanes,F=f.pingedLanes,Y=f.expirationTimes,ne=f.pendingLanes;0<ne;){var ve=31-Jd(ne),Le=1<<ve,Je=Y[ve];Je===-1?(!(Le&C)||Le&F)&&(Y[ve]=Twe(Le,v)):Je<=v&&(f.expiredLanes|=Le),ne&=~Le}}function LU(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function fde(){var f=XA;return XA<<=1,!(XA&4194240)&&(XA=64),f}function UU(f){for(var v=[],C=0;31>C;C++)v.push(f);return v}function DS(f,v,C){f.pendingLanes|=v,v!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,v=31-Jd(v),f[v]=C}function Cwe(f,v){var C=f.pendingLanes&~v;f.pendingLanes=v,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=v,f.mutableReadLanes&=v,f.entangledLanes&=v,v=f.entanglements;var F=f.eventTimes;for(f=f.expirationTimes;0<C;){var Y=31-Jd(C),ne=1<<Y;v[Y]=0,F[Y]=-1,f[Y]=-1,C&=~ne}}function BU(f,v){var C=f.entangledLanes|=v;for(f=f.entanglements;C;){var F=31-Jd(C),Y=1<<F;Y&v|f[F]&v&&(f[F]|=v),C&=~Y}}var fs=0;function pde(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var mde,zU,gde,vde,yde,VU=!1,ZA=[],s3=null,a3=null,o3=null,OS=new Map,FS=new Map,l3=[],Awe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _de(f,v){switch(f){case"focusin":case"focusout":s3=null;break;case"dragenter":case"dragleave":a3=null;break;case"mouseover":case"mouseout":o3=null;break;case"pointerover":case"pointerout":OS.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":FS.delete(v.pointerId)}}function LS(f,v,C,F,Y,ne){return f===null||f.nativeEvent!==ne?(f={blockedOn:v,domEventName:C,eventSystemFlags:F,nativeEvent:ne,targetContainers:[Y]},v!==null&&(v=ZS(v),v!==null&&zU(v)),f):(f.eventSystemFlags|=F,v=f.targetContainers,Y!==null&&v.indexOf(Y)===-1&&v.push(Y),f)}function Pwe(f,v,C,F,Y){switch(v){case"focusin":return s3=LS(s3,f,v,C,F,Y),!0;case"dragenter":return a3=LS(a3,f,v,C,F,Y),!0;case"mouseover":return o3=LS(o3,f,v,C,F,Y),!0;case"pointerover":var ne=Y.pointerId;return OS.set(ne,LS(OS.get(ne)||null,f,v,C,F,Y)),!0;case"gotpointercapture":return ne=Y.pointerId,FS.set(ne,LS(FS.get(ne)||null,f,v,C,F,Y)),!0}return!1}function xde(f){var v=P8(f.target);if(v!==null){var C=A8(v);if(C!==null){if(v=C.tag,v===13){if(v=sde(C),v!==null){f.blockedOn=v,yde(f.priority,function(){gde(C)});return}}else if(v===3&&C.stateNode.current.memoizedState.isDehydrated){f.blockedOn=C.tag===3?C.stateNode.containerInfo:null;return}}}f.blockedOn=null}function QA(f){if(f.blockedOn!==null)return!1;for(var v=f.targetContainers;0<v.length;){var C=HU(f.domEventName,f.eventSystemFlags,v[0],f.nativeEvent);if(C===null){C=f.nativeEvent;var F=new C.constructor(C.type,C);PS=F,C.target.dispatchEvent(F),PS=null}else return v=ZS(C),v!==null&&zU(v),f.blockedOn=C,!1;v.shift()}return!0}function bde(f,v,C){QA(f)&&C.delete(v)}function Rwe(){VU=!1,s3!==null&&QA(s3)&&(s3=null),a3!==null&&QA(a3)&&(a3=null),o3!==null&&QA(o3)&&(o3=null),OS.forEach(bde),FS.forEach(bde)}function US(f,v){f.blockedOn===v&&(f.blockedOn=null,VU||(VU=!0,c.unstable_scheduleCallback(c.unstable_NormalPriority,Rwe)))}function BS(f){function v(Y){return US(Y,f)}if(0<ZA.length){US(ZA[0],f);for(var C=1;C<ZA.length;C++){var F=ZA[C];F.blockedOn===f&&(F.blockedOn=null)}}for(s3!==null&&US(s3,f),a3!==null&&US(a3,f),o3!==null&&US(o3,f),OS.forEach(v),FS.forEach(v),C=0;C<l3.length;C++)F=l3[C],F.blockedOn===f&&(F.blockedOn=null);for(;0<l3.length&&(C=l3[0],C.blockedOn===null);)xde(C),C.blockedOn===null&&l3.shift()}var r7=fe.ReactCurrentBatchConfig,JA=!0;function Iwe(f,v,C,F){var Y=fs,ne=r7.transition;r7.transition=null;try{fs=1,GU(f,v,C,F)}finally{fs=Y,r7.transition=ne}}function kwe(f,v,C,F){var Y=fs,ne=r7.transition;r7.transition=null;try{fs=4,GU(f,v,C,F)}finally{fs=Y,r7.transition=ne}}function GU(f,v,C,F){if(JA){var Y=HU(f,v,C,F);if(Y===null)iB(f,v,F,eP,C),_de(f,F);else if(Pwe(Y,f,v,C,F))F.stopPropagation();else if(_de(f,F),v&4&&-1<Awe.indexOf(f)){for(;Y!==null;){var ne=ZS(Y);if(ne!==null&&mde(ne),ne=HU(f,v,C,F),ne===null&&iB(f,v,F,eP,C),ne===Y)break;Y=ne}Y!==null&&F.stopPropagation()}else iB(f,v,F,null,C)}}var eP=null;function HU(f,v,C,F){if(eP=null,f=RS(F),f=P8(f),f!==null)if(v=A8(f),v===null)f=null;else if(C=v.tag,C===13){if(f=sde(v),f!==null)return f;f=null}else if(C===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;f=null}else v!==f&&(f=null);return eP=f,null}function Sde(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_we()){case FU:return 1;case hde:return 4;case $A:case xwe:return 16;case dde:return 536870912;default:return 16}default:return 16}}var u3=null,jU=null,tP=null;function wde(){if(tP)return tP;var f,v=jU,C=v.length,F,Y="value"in u3?u3.value:u3.textContent,ne=Y.length;for(f=0;f<C&&v[f]===Y[f];f++);var ve=C-f;for(F=1;F<=ve&&v[C-F]===Y[ne-F];F++);return tP=Y.slice(f,1<F?1-F:void 0)}function nP(f){var v=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&v===13&&(f=13)):f=v,f===10&&(f=13),32<=f||f===13?f:0}function rP(){return!0}function Ede(){return!1}function vc(f){function v(C,F,Y,ne,ve){this._reactName=C,this._targetInst=Y,this.type=F,this.nativeEvent=ne,this.target=ve,this.currentTarget=null;for(var Le in f)f.hasOwnProperty(Le)&&(C=f[Le],this[Le]=C?C(ne):ne[Le]);return this.isDefaultPrevented=(ne.defaultPrevented!=null?ne.defaultPrevented:ne.returnValue===!1)?rP:Ede,this.isPropagationStopped=Ede,this}return be(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var C=this.nativeEvent;C&&(C.preventDefault?C.preventDefault():typeof C.returnValue!="unknown"&&(C.returnValue=!1),this.isDefaultPrevented=rP)},stopPropagation:function(){var C=this.nativeEvent;C&&(C.stopPropagation?C.stopPropagation():typeof C.cancelBubble!="unknown"&&(C.cancelBubble=!0),this.isPropagationStopped=rP)},persist:function(){},isPersistent:rP}),v}var i7={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},WU=vc(i7),zS=be({},i7,{view:0,detail:0}),Nwe=vc(zS),$U,qU,VS,iP=be({},zS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:YU,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==VS&&(VS&&f.type==="mousemove"?($U=f.screenX-VS.screenX,qU=f.screenY-VS.screenY):qU=$U=0,VS=f),$U)},movementY:function(f){return"movementY"in f?f.movementY:qU}}),Tde=vc(iP),Dwe=be({},iP,{dataTransfer:0}),Owe=vc(Dwe),Fwe=be({},zS,{relatedTarget:0}),XU=vc(Fwe),Lwe=be({},i7,{animationName:0,elapsedTime:0,pseudoElement:0}),Uwe=vc(Lwe),Bwe=be({},i7,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),zwe=vc(Bwe),Vwe=be({},i7,{data:0}),Mde=vc(Vwe),Gwe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hwe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jwe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wwe(f){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(f):(f=jwe[f])?!!v[f]:!1}function YU(){return Wwe}var $we=be({},zS,{key:function(f){if(f.key){var v=Gwe[f.key]||f.key;if(v!=="Unidentified")return v}return f.type==="keypress"?(f=nP(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?Hwe[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:YU,charCode:function(f){return f.type==="keypress"?nP(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?nP(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),qwe=vc($we),Xwe=be({},iP,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cde=vc(Xwe),Ywe=be({},zS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:YU}),Kwe=vc(Ywe),Zwe=be({},i7,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qwe=vc(Zwe),Jwe=be({},iP,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),eEe=vc(Jwe),tEe=[9,13,27,32],KU=R&&"CompositionEvent"in window,GS=null;R&&"documentMode"in document&&(GS=document.documentMode);var nEe=R&&"TextEvent"in window&&!GS,Ade=R&&(!KU||GS&&8<GS&&11>=GS),Pde=" ",Rde=!1;function Ide(f,v){switch(f){case"keyup":return tEe.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kde(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var s7=!1;function rEe(f,v){switch(f){case"compositionend":return kde(v);case"keypress":return v.which!==32?null:(Rde=!0,Pde);case"textInput":return f=v.data,f===Pde&&Rde?null:f;default:return null}}function iEe(f,v){if(s7)return f==="compositionend"||!KU&&Ide(f,v)?(f=wde(),tP=jU=u3=null,s7=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return Ade&&v.locale!=="ko"?null:v.data;default:return null}}var sEe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nde(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v==="input"?!!sEe[f.type]:v==="textarea"}function Dde(f,v,C,F){ede(F),v=dP(v,"onChange"),0<v.length&&(C=new WU("onChange","change",null,C,F),f.push({event:C,listeners:v}))}var HS=null,jS=null;function aEe(f){Jde(f,0)}function sP(f){var v=c7(f);if(Wi(v))return f}function oEe(f,v){if(f==="change")return v}var Ode=!1;R&&(R?(aP="oninput"in document,aP||(QU=document.createElement("div"),QU.setAttribute("oninput","return;"),aP=typeof QU.oninput=="function"),ZU=aP):ZU=!1,Ode=ZU&&(!document.documentMode||9<document.documentMode));var ZU,aP,QU;function Fde(){HS&&(HS.detachEvent("onpropertychange",Lde),jS=HS=null)}function Lde(f){if(f.propertyName==="value"&&sP(jS)){var v=[];Dde(v,jS,f,RS(f)),ide(aEe,v)}}function lEe(f,v,C){f==="focusin"?(Fde(),HS=v,jS=C,HS.attachEvent("onpropertychange",Lde)):f==="focusout"&&Fde()}function uEe(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return sP(jS)}function cEe(f,v){if(f==="click")return sP(v)}function hEe(f,v){if(f==="input"||f==="change")return sP(v)}function dEe(f,v){return f===v&&(f!==0||1/f===1/v)||f!==f&&v!==v}var ef=typeof Object.is=="function"?Object.is:dEe;function WS(f,v){if(ef(f,v))return!0;if(typeof f!="object"||f===null||typeof v!="object"||v===null)return!1;var C=Object.keys(f),F=Object.keys(v);if(C.length!==F.length)return!1;for(F=0;F<C.length;F++){var Y=C[F];if(!N.call(v,Y)||!ef(f[Y],v[Y]))return!1}return!0}function Ude(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function Bde(f,v){var C=Ude(f);f=0;for(var F;C;){if(C.nodeType===3){if(F=f+C.textContent.length,f<=v&&F>=v)return{node:C,offset:v-f};f=F}e:{for(;C;){if(C.nextSibling){C=C.nextSibling;break e}C=C.parentNode}C=void 0}C=Ude(C)}}function zde(f,v){return f&&v?f===v?!0:f&&f.nodeType===3?!1:v&&v.nodeType===3?zde(f,v.parentNode):"contains"in f?f.contains(v):f.compareDocumentPosition?!!(f.compareDocumentPosition(v)&16):!1:!1}function Vde(){for(var f=window,v=he();v instanceof f.HTMLIFrameElement;){try{var C=typeof v.contentWindow.location.href=="string"}catch{C=!1}if(C)f=v.contentWindow;else break;v=he(f.document)}return v}function JU(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v&&(v==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||v==="textarea"||f.contentEditable==="true")}function fEe(f){var v=Vde(),C=f.focusedElem,F=f.selectionRange;if(v!==C&&C&&C.ownerDocument&&zde(C.ownerDocument.documentElement,C)){if(F!==null&&JU(C)){if(v=F.start,f=F.end,f===void 0&&(f=v),"selectionStart"in C)C.selectionStart=v,C.selectionEnd=Math.min(f,C.value.length);else if(f=(v=C.ownerDocument||document)&&v.defaultView||window,f.getSelection){f=f.getSelection();var Y=C.textContent.length,ne=Math.min(F.start,Y);F=F.end===void 0?ne:Math.min(F.end,Y),!f.extend&&ne>F&&(Y=F,F=ne,ne=Y),Y=Bde(C,ne);var ve=Bde(C,F);Y&&ve&&(f.rangeCount!==1||f.anchorNode!==Y.node||f.anchorOffset!==Y.offset||f.focusNode!==ve.node||f.focusOffset!==ve.offset)&&(v=v.createRange(),v.setStart(Y.node,Y.offset),f.removeAllRanges(),ne>F?(f.addRange(v),f.extend(ve.node,ve.offset)):(v.setEnd(ve.node,ve.offset),f.addRange(v)))}}for(v=[],f=C;f=f.parentNode;)f.nodeType===1&&v.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<v.length;C++)f=v[C],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var pEe=R&&"documentMode"in document&&11>=document.documentMode,a7=null,eB=null,$S=null,tB=!1;function Gde(f,v,C){var F=C.window===C?C.document:C.nodeType===9?C:C.ownerDocument;tB||a7==null||a7!==he(F)||(F=a7,"selectionStart"in F&&JU(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),$S&&WS($S,F)||($S=F,F=dP(eB,"onSelect"),0<F.length&&(v=new WU("onSelect","select",null,v,C),f.push({event:v,listeners:F}),v.target=a7)))}function oP(f,v){var C={};return C[f.toLowerCase()]=v.toLowerCase(),C["Webkit"+f]="webkit"+v,C["Moz"+f]="moz"+v,C}var o7={animationend:oP("Animation","AnimationEnd"),animationiteration:oP("Animation","AnimationIteration"),animationstart:oP("Animation","AnimationStart"),transitionend:oP("Transition","TransitionEnd")},nB={},Hde={};R&&(Hde=document.createElement("div").style,"AnimationEvent"in window||(delete o7.animationend.animation,delete o7.animationiteration.animation,delete o7.animationstart.animation),"TransitionEvent"in window||delete o7.transitionend.transition);function lP(f){if(nB[f])return nB[f];if(!o7[f])return f;var v=o7[f],C;for(C in v)if(v.hasOwnProperty(C)&&C in Hde)return nB[f]=v[C];return f}var jde=lP("animationend"),Wde=lP("animationiteration"),$de=lP("animationstart"),qde=lP("transitionend"),Xde=new Map,Yde="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function c3(f,v){Xde.set(f,v),E(v,[f])}for(cP=0;cP<Yde.length;cP++)uP=Yde[cP],Kde=uP.toLowerCase(),Zde=uP[0].toUpperCase()+uP.slice(1),c3(Kde,"on"+Zde);var uP,Kde,Zde,cP;c3(jde,"onAnimationEnd"),c3(Wde,"onAnimationIteration"),c3($de,"onAnimationStart"),c3("dblclick","onDoubleClick"),c3("focusin","onFocus"),c3("focusout","onBlur"),c3(qde,"onTransitionEnd"),T("onMouseEnter",["mouseout","mouseover"]),T("onMouseLeave",["mouseout","mouseover"]),T("onPointerEnter",["pointerout","pointerover"]),T("onPointerLeave",["pointerout","pointerover"]),E("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),E("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),E("onBeforeInput",["compositionend","keypress","textInput","paste"]),E("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mEe=new Set("cancel close invalid load scroll toggle".split(" ").concat(qS));function Qde(f,v,C){var F=f.type||"unknown-event";f.currentTarget=C,mwe(F,v,void 0,f),f.currentTarget=null}function Jde(f,v){v=(v&4)!==0;for(var C=0;C<f.length;C++){var F=f[C],Y=F.event;F=F.listeners;e:{var ne=void 0;if(v)for(var ve=F.length-1;0<=ve;ve--){var Le=F[ve],Je=Le.instance,Ut=Le.currentTarget;if(Le=Le.listener,Je!==ne&&Y.isPropagationStopped())break e;Qde(Y,Le,Ut),ne=Je}else for(ve=0;ve<F.length;ve++){if(Le=F[ve],Je=Le.instance,Ut=Le.currentTarget,Le=Le.listener,Je!==ne&&Y.isPropagationStopped())break e;Qde(Y,Le,Ut),ne=Je}}}if(WA)throw f=OU,WA=!1,OU=null,f}function Qs(f,v){var C=v[cB];C===void 0&&(C=v[cB]=new Set);var F=f+"__bubble";C.has(F)||(efe(v,f,2,!1),C.add(F))}function rB(f,v,C){var F=0;v&&(F|=4),efe(C,f,F,v)}var hP="_reactListening"+Math.random().toString(36).slice(2);function XS(f){if(!f[hP]){f[hP]=!0,_.forEach(function(C){C!=="selectionchange"&&(mEe.has(C)||rB(C,!1,f),rB(C,!0,f))});var v=f.nodeType===9?f:f.ownerDocument;v===null||v[hP]||(v[hP]=!0,rB("selectionchange",!1,v))}}function efe(f,v,C,F){switch(Sde(v)){case 1:var Y=Iwe;break;case 4:Y=kwe;break;default:Y=GU}C=Y.bind(null,v,C,f),Y=void 0,!DU||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(Y=!0),F?Y!==void 0?f.addEventListener(v,C,{capture:!0,passive:Y}):f.addEventListener(v,C,!0):Y!==void 0?f.addEventListener(v,C,{passive:Y}):f.addEventListener(v,C,!1)}function iB(f,v,C,F,Y){var ne=F;if(!(v&1)&&!(v&2)&&F!==null)e:for(;;){if(F===null)return;var ve=F.tag;if(ve===3||ve===4){var Le=F.stateNode.containerInfo;if(Le===Y||Le.nodeType===8&&Le.parentNode===Y)break;if(ve===4)for(ve=F.return;ve!==null;){var Je=ve.tag;if((Je===3||Je===4)&&(Je=ve.stateNode.containerInfo,Je===Y||Je.nodeType===8&&Je.parentNode===Y))return;ve=ve.return}for(;Le!==null;){if(ve=P8(Le),ve===null)return;if(Je=ve.tag,Je===5||Je===6){F=ne=ve;continue e}Le=Le.parentNode}}F=F.return}ide(function(){var Ut=ne,_n=RS(C),Sn=[];e:{var pn=Xde.get(f);if(pn!==void 0){var Jn=WU,dr=f;switch(f){case"keypress":if(nP(C)===0)break e;case"keydown":case"keyup":Jn=qwe;break;case"focusin":dr="focus",Jn=XU;break;case"focusout":dr="blur",Jn=XU;break;case"beforeblur":case"afterblur":Jn=XU;break;case"click":if(C.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Jn=Tde;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Jn=Owe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Jn=Kwe;break;case jde:case Wde:case $de:Jn=Uwe;break;case qde:Jn=Qwe;break;case"scroll":Jn=Nwe;break;case"wheel":Jn=eEe;break;case"copy":case"cut":case"paste":Jn=zwe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Jn=Cde}var mr=(v&4)!==0,Ga=!mr&&f==="scroll",Et=mr?pn!==null?pn+"Capture":null:pn;mr=[];for(var it=Ut,Rt;it!==null;){Rt=it;var Cn=Rt.stateNode;if(Rt.tag===5&&Cn!==null&&(Rt=Cn,Et!==null&&(Cn=IS(it,Et),Cn!=null&&mr.push(YS(it,Cn,Rt)))),Ga)break;it=it.return}0<mr.length&&(pn=new Jn(pn,dr,null,C,_n),Sn.push({event:pn,listeners:mr}))}}if(!(v&7)){e:{if(pn=f==="mouseover"||f==="pointerover",Jn=f==="mouseout"||f==="pointerout",pn&&C!==PS&&(dr=C.relatedTarget||C.fromElement)&&(P8(dr)||dr[tg]))break e;if((Jn||pn)&&(pn=_n.window===_n?_n:(pn=_n.ownerDocument)?pn.defaultView||pn.parentWindow:window,Jn?(dr=C.relatedTarget||C.toElement,Jn=Ut,dr=dr?P8(dr):null,dr!==null&&(Ga=A8(dr),dr!==Ga||dr.tag!==5&&dr.tag!==6)&&(dr=null)):(Jn=null,dr=Ut),Jn!==dr)){if(mr=Tde,Cn="onMouseLeave",Et="onMouseEnter",it="mouse",(f==="pointerout"||f==="pointerover")&&(mr=Cde,Cn="onPointerLeave",Et="onPointerEnter",it="pointer"),Ga=Jn==null?pn:c7(Jn),Rt=dr==null?pn:c7(dr),pn=new mr(Cn,it+"leave",Jn,C,_n),pn.target=Ga,pn.relatedTarget=Rt,Cn=null,P8(_n)===Ut&&(mr=new mr(Et,it+"enter",dr,C,_n),mr.target=Rt,mr.relatedTarget=Ga,Cn=mr),Ga=Cn,Jn&&dr)t:{for(mr=Jn,Et=dr,it=0,Rt=mr;Rt;Rt=l7(Rt))it++;for(Rt=0,Cn=Et;Cn;Cn=l7(Cn))Rt++;for(;0<it-Rt;)mr=l7(mr),it--;for(;0<Rt-it;)Et=l7(Et),Rt--;for(;it--;){if(mr===Et||Et!==null&&mr===Et.alternate)break t;mr=l7(mr),Et=l7(Et)}mr=null}else mr=null;Jn!==null&&tfe(Sn,pn,Jn,mr,!1),dr!==null&&Ga!==null&&tfe(Sn,Ga,dr,mr,!0)}}e:{if(pn=Ut?c7(Ut):window,Jn=pn.nodeName&&pn.nodeName.toLowerCase(),Jn==="select"||Jn==="input"&&pn.type==="file")var _r=oEe;else if(Nde(pn))if(Ode)_r=hEe;else{_r=uEe;var Ir=lEe}else(Jn=pn.nodeName)&&Jn.toLowerCase()==="input"&&(pn.type==="checkbox"||pn.type==="radio")&&(_r=cEe);if(_r&&(_r=_r(f,Ut))){Dde(Sn,_r,C,_n);break e}Ir&&Ir(f,pn,Ut),f==="focusout"&&(Ir=pn._wrapperState)&&Ir.controlled&&pn.type==="number"&&Xt(pn,"number",pn.value)}switch(Ir=Ut?c7(Ut):window,f){case"focusin":(Nde(Ir)||Ir.contentEditable==="true")&&(a7=Ir,eB=Ut,$S=null);break;case"focusout":$S=eB=a7=null;break;case"mousedown":tB=!0;break;case"contextmenu":case"mouseup":case"dragend":tB=!1,Gde(Sn,C,_n);break;case"selectionchange":if(pEe)break;case"keydown":case"keyup":Gde(Sn,C,_n)}var kr;if(KU)e:{switch(f){case"compositionstart":var jr="onCompositionStart";break e;case"compositionend":jr="onCompositionEnd";break e;case"compositionupdate":jr="onCompositionUpdate";break e}jr=void 0}else s7?Ide(f,C)&&(jr="onCompositionEnd"):f==="keydown"&&C.keyCode===229&&(jr="onCompositionStart");jr&&(Ade&&C.locale!=="ko"&&(s7||jr!=="onCompositionStart"?jr==="onCompositionEnd"&&s7&&(kr=wde()):(u3=_n,jU="value"in u3?u3.value:u3.textContent,s7=!0)),Ir=dP(Ut,jr),0<Ir.length&&(jr=new Mde(jr,f,null,C,_n),Sn.push({event:jr,listeners:Ir}),kr?jr.data=kr:(kr=kde(C),kr!==null&&(jr.data=kr)))),(kr=nEe?rEe(f,C):iEe(f,C))&&(Ut=dP(Ut,"onBeforeInput"),0<Ut.length&&(_n=new Mde("onBeforeInput","beforeinput",null,C,_n),Sn.push({event:_n,listeners:Ut}),_n.data=kr))}Jde(Sn,v)})}function YS(f,v,C){return{instance:f,listener:v,currentTarget:C}}function dP(f,v){for(var C=v+"Capture",F=[];f!==null;){var Y=f,ne=Y.stateNode;Y.tag===5&&ne!==null&&(Y=ne,ne=IS(f,C),ne!=null&&F.unshift(YS(f,ne,Y)),ne=IS(f,v),ne!=null&&F.push(YS(f,ne,Y))),f=f.return}return F}function l7(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function tfe(f,v,C,F,Y){for(var ne=v._reactName,ve=[];C!==null&&C!==F;){var Le=C,Je=Le.alternate,Ut=Le.stateNode;if(Je!==null&&Je===F)break;Le.tag===5&&Ut!==null&&(Le=Ut,Y?(Je=IS(C,ne),Je!=null&&ve.unshift(YS(C,Je,Le))):Y||(Je=IS(C,ne),Je!=null&&ve.push(YS(C,Je,Le)))),C=C.return}ve.length!==0&&f.push({event:v,listeners:ve})}var gEe=/\r\n?/g,vEe=/\u0000|\uFFFD/g;function nfe(f){return(typeof f=="string"?f:""+f).replace(gEe,`
`).replace(vEe,"")}function fP(f,v,C){if(v=nfe(v),nfe(f)!==v&&C)throw Error(m(425))}function pP(){}var sB=null,aB=null;function oB(f,v){return f==="textarea"||f==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var lB=typeof setTimeout=="function"?setTimeout:void 0,yEe=typeof clearTimeout=="function"?clearTimeout:void 0,rfe=typeof Promise=="function"?Promise:void 0,_Ee=typeof queueMicrotask=="function"?queueMicrotask:typeof rfe<"u"?function(f){return rfe.resolve(null).then(f).catch(xEe)}:lB;function xEe(f){setTimeout(function(){throw f})}function uB(f,v){var C=v,F=0;do{var Y=C.nextSibling;if(f.removeChild(C),Y&&Y.nodeType===8)if(C=Y.data,C==="/$"){if(F===0){f.removeChild(Y),BS(v);return}F--}else C!=="$"&&C!=="$?"&&C!=="$!"||F++;C=Y}while(C);BS(v)}function h3(f){for(;f!=null;f=f.nextSibling){var v=f.nodeType;if(v===1||v===3)break;if(v===8){if(v=f.data,v==="$"||v==="$!"||v==="$?")break;if(v==="/$")return null}}return f}function ife(f){f=f.previousSibling;for(var v=0;f;){if(f.nodeType===8){var C=f.data;if(C==="$"||C==="$!"||C==="$?"){if(v===0)return f;v--}else C==="/$"&&v++}f=f.previousSibling}return null}var u7=Math.random().toString(36).slice(2),jp="__reactFiber$"+u7,KS="__reactProps$"+u7,tg="__reactContainer$"+u7,cB="__reactEvents$"+u7,bEe="__reactListeners$"+u7,SEe="__reactHandles$"+u7;function P8(f){var v=f[jp];if(v)return v;for(var C=f.parentNode;C;){if(v=C[tg]||C[jp]){if(C=v.alternate,v.child!==null||C!==null&&C.child!==null)for(f=ife(f);f!==null;){if(C=f[jp])return C;f=ife(f)}return v}f=C,C=f.parentNode}return null}function ZS(f){return f=f[jp]||f[tg],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function c7(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(m(33))}function mP(f){return f[KS]||null}var hB=[],h7=-1;function d3(f){return{current:f}}function Js(f){0>h7||(f.current=hB[h7],hB[h7]=null,h7--)}function Fs(f,v){h7++,hB[h7]=f.current,f.current=v}var f3={},L0=d3(f3),xu=d3(!1),R8=f3;function d7(f,v){var C=f.type.contextTypes;if(!C)return f3;var F=f.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===v)return F.__reactInternalMemoizedMaskedChildContext;var Y={},ne;for(ne in C)Y[ne]=v[ne];return F&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=v,f.__reactInternalMemoizedMaskedChildContext=Y),Y}function bu(f){return f=f.childContextTypes,f!=null}function gP(){Js(xu),Js(L0)}function sfe(f,v,C){if(L0.current!==f3)throw Error(m(168));Fs(L0,v),Fs(xu,C)}function afe(f,v,C){var F=f.stateNode;if(v=v.childContextTypes,typeof F.getChildContext!="function")return C;F=F.getChildContext();for(var Y in F)if(!(Y in v))throw Error(m(108,Vt(f)||"Unknown",Y));return be({},C,F)}function vP(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||f3,R8=L0.current,Fs(L0,f),Fs(xu,xu.current),!0}function ofe(f,v,C){var F=f.stateNode;if(!F)throw Error(m(169));C?(f=afe(f,v,R8),F.__reactInternalMemoizedMergedChildContext=f,Js(xu),Js(L0),Fs(L0,f)):Js(xu),Fs(xu,C)}var ng=null,yP=!1,dB=!1;function lfe(f){ng===null?ng=[f]:ng.push(f)}function wEe(f){yP=!0,lfe(f)}function p3(){if(!dB&&ng!==null){dB=!0;var f=0,v=fs;try{var C=ng;for(fs=1;f<C.length;f++){var F=C[f];do F=F(!0);while(F!==null)}ng=null,yP=!1}catch(Y){throw ng!==null&&(ng=ng.slice(f+1)),ude(FU,p3),Y}finally{fs=v,dB=!1}}return null}var f7=[],p7=0,_P=null,xP=0,Eh=[],Th=0,I8=null,rg=1,ig="";function k8(f,v){f7[p7++]=xP,f7[p7++]=_P,_P=f,xP=v}function ufe(f,v,C){Eh[Th++]=rg,Eh[Th++]=ig,Eh[Th++]=I8,I8=f;var F=rg;f=ig;var Y=32-Jd(F)-1;F&=~(1<<Y),C+=1;var ne=32-Jd(v)+Y;if(30<ne){var ve=Y-Y%5;ne=(F&(1<<ve)-1).toString(32),F>>=ve,Y-=ve,rg=1<<32-Jd(v)+Y|C<<Y|F,ig=ne+f}else rg=1<<ne|C<<Y|F,ig=f}function fB(f){f.return!==null&&(k8(f,1),ufe(f,1,0))}function pB(f){for(;f===_P;)_P=f7[--p7],f7[p7]=null,xP=f7[--p7],f7[p7]=null;for(;f===I8;)I8=Eh[--Th],Eh[Th]=null,ig=Eh[--Th],Eh[Th]=null,rg=Eh[--Th],Eh[Th]=null}var yc=null,_c=null,sa=!1,tf=null;function cfe(f,v){var C=Ph(5,null,null,0);C.elementType="DELETED",C.stateNode=v,C.return=f,v=f.deletions,v===null?(f.deletions=[C],f.flags|=16):v.push(C)}function hfe(f,v){switch(f.tag){case 5:var C=f.type;return v=v.nodeType!==1||C.toLowerCase()!==v.nodeName.toLowerCase()?null:v,v!==null?(f.stateNode=v,yc=f,_c=h3(v.firstChild),!0):!1;case 6:return v=f.pendingProps===""||v.nodeType!==3?null:v,v!==null?(f.stateNode=v,yc=f,_c=null,!0):!1;case 13:return v=v.nodeType!==8?null:v,v!==null?(C=I8!==null?{id:rg,overflow:ig}:null,f.memoizedState={dehydrated:v,treeContext:C,retryLane:1073741824},C=Ph(18,null,null,0),C.stateNode=v,C.return=f,f.child=C,yc=f,_c=null,!0):!1;default:return!1}}function mB(f){return(f.mode&1)!==0&&(f.flags&128)===0}function gB(f){if(sa){var v=_c;if(v){var C=v;if(!hfe(f,v)){if(mB(f))throw Error(m(418));v=h3(C.nextSibling);var F=yc;v&&hfe(f,v)?cfe(F,C):(f.flags=f.flags&-4097|2,sa=!1,yc=f)}}else{if(mB(f))throw Error(m(418));f.flags=f.flags&-4097|2,sa=!1,yc=f}}}function dfe(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;yc=f}function bP(f){if(f!==yc)return!1;if(!sa)return dfe(f),sa=!0,!1;var v;if((v=f.tag!==3)&&!(v=f.tag!==5)&&(v=f.type,v=v!=="head"&&v!=="body"&&!oB(f.type,f.memoizedProps)),v&&(v=_c)){if(mB(f))throw ffe(),Error(m(418));for(;v;)cfe(f,v),v=h3(v.nextSibling)}if(dfe(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(m(317));e:{for(f=f.nextSibling,v=0;f;){if(f.nodeType===8){var C=f.data;if(C==="/$"){if(v===0){_c=h3(f.nextSibling);break e}v--}else C!=="$"&&C!=="$!"&&C!=="$?"||v++}f=f.nextSibling}_c=null}}else _c=yc?h3(f.stateNode.nextSibling):null;return!0}function ffe(){for(var f=_c;f;)f=h3(f.nextSibling)}function m7(){_c=yc=null,sa=!1}function vB(f){tf===null?tf=[f]:tf.push(f)}var EEe=fe.ReactCurrentBatchConfig;function nf(f,v){if(f&&f.defaultProps){v=be({},v),f=f.defaultProps;for(var C in f)v[C]===void 0&&(v[C]=f[C]);return v}return v}var SP=d3(null),wP=null,g7=null,yB=null;function _B(){yB=g7=wP=null}function xB(f){var v=SP.current;Js(SP),f._currentValue=v}function bB(f,v,C){for(;f!==null;){var F=f.alternate;if((f.childLanes&v)!==v?(f.childLanes|=v,F!==null&&(F.childLanes|=v)):F!==null&&(F.childLanes&v)!==v&&(F.childLanes|=v),f===C)break;f=f.return}}function v7(f,v){wP=f,yB=g7=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&v&&(Su=!0),f.firstContext=null)}function Mh(f){var v=f._currentValue;if(yB!==f)if(f={context:f,memoizedValue:v,next:null},g7===null){if(wP===null)throw Error(m(308));g7=f,wP.dependencies={lanes:0,firstContext:f}}else g7=g7.next=f;return v}var N8=null;function SB(f){N8===null?N8=[f]:N8.push(f)}function pfe(f,v,C,F){var Y=v.interleaved;return Y===null?(C.next=C,SB(v)):(C.next=Y.next,Y.next=C),v.interleaved=C,sg(f,F)}function sg(f,v){f.lanes|=v;var C=f.alternate;for(C!==null&&(C.lanes|=v),C=f,f=f.return;f!==null;)f.childLanes|=v,C=f.alternate,C!==null&&(C.childLanes|=v),C=f,f=f.return;return C.tag===3?C.stateNode:null}var m3=!1;function wB(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mfe(f,v){f=f.updateQueue,v.updateQueue===f&&(v.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function ag(f,v){return{eventTime:f,lane:v,tag:0,payload:null,callback:null,next:null}}function g3(f,v,C){var F=f.updateQueue;if(F===null)return null;if(F=F.shared,Vi&2){var Y=F.pending;return Y===null?v.next=v:(v.next=Y.next,Y.next=v),F.pending=v,sg(f,C)}return Y=F.interleaved,Y===null?(v.next=v,SB(F)):(v.next=Y.next,Y.next=v),F.interleaved=v,sg(f,C)}function EP(f,v,C){if(v=v.updateQueue,v!==null&&(v=v.shared,(C&4194240)!==0)){var F=v.lanes;F&=f.pendingLanes,C|=F,v.lanes=C,BU(f,C)}}function gfe(f,v){var C=f.updateQueue,F=f.alternate;if(F!==null&&(F=F.updateQueue,C===F)){var Y=null,ne=null;if(C=C.firstBaseUpdate,C!==null){do{var ve={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};ne===null?Y=ne=ve:ne=ne.next=ve,C=C.next}while(C!==null);ne===null?Y=ne=v:ne=ne.next=v}else Y=ne=v;C={baseState:F.baseState,firstBaseUpdate:Y,lastBaseUpdate:ne,shared:F.shared,effects:F.effects},f.updateQueue=C;return}f=C.lastBaseUpdate,f===null?C.firstBaseUpdate=v:f.next=v,C.lastBaseUpdate=v}function TP(f,v,C,F){var Y=f.updateQueue;m3=!1;var ne=Y.firstBaseUpdate,ve=Y.lastBaseUpdate,Le=Y.shared.pending;if(Le!==null){Y.shared.pending=null;var Je=Le,Ut=Je.next;Je.next=null,ve===null?ne=Ut:ve.next=Ut,ve=Je;var _n=f.alternate;_n!==null&&(_n=_n.updateQueue,Le=_n.lastBaseUpdate,Le!==ve&&(Le===null?_n.firstBaseUpdate=Ut:Le.next=Ut,_n.lastBaseUpdate=Je))}if(ne!==null){var Sn=Y.baseState;ve=0,_n=Ut=Je=null,Le=ne;do{var pn=Le.lane,Jn=Le.eventTime;if((F&pn)===pn){_n!==null&&(_n=_n.next={eventTime:Jn,lane:0,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null});e:{var dr=f,mr=Le;switch(pn=v,Jn=C,mr.tag){case 1:if(dr=mr.payload,typeof dr=="function"){Sn=dr.call(Jn,Sn,pn);break e}Sn=dr;break e;case 3:dr.flags=dr.flags&-65537|128;case 0:if(dr=mr.payload,pn=typeof dr=="function"?dr.call(Jn,Sn,pn):dr,pn==null)break e;Sn=be({},Sn,pn);break e;case 2:m3=!0}}Le.callback!==null&&Le.lane!==0&&(f.flags|=64,pn=Y.effects,pn===null?Y.effects=[Le]:pn.push(Le))}else Jn={eventTime:Jn,lane:pn,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null},_n===null?(Ut=_n=Jn,Je=Sn):_n=_n.next=Jn,ve|=pn;if(Le=Le.next,Le===null){if(Le=Y.shared.pending,Le===null)break;pn=Le,Le=pn.next,pn.next=null,Y.lastBaseUpdate=pn,Y.shared.pending=null}}while(!0);if(_n===null&&(Je=Sn),Y.baseState=Je,Y.firstBaseUpdate=Ut,Y.lastBaseUpdate=_n,v=Y.shared.interleaved,v!==null){Y=v;do ve|=Y.lane,Y=Y.next;while(Y!==v)}else ne===null&&(Y.shared.lanes=0);F8|=ve,f.lanes=ve,f.memoizedState=Sn}}function vfe(f,v,C){if(f=v.effects,v.effects=null,f!==null)for(v=0;v<f.length;v++){var F=f[v],Y=F.callback;if(Y!==null){if(F.callback=null,F=C,typeof Y!="function")throw Error(m(191,Y));Y.call(F)}}}var yfe=new u.Component().refs;function EB(f,v,C,F){v=f.memoizedState,C=C(F,v),C=C==null?v:be({},v,C),f.memoizedState=C,f.lanes===0&&(f.updateQueue.baseState=C)}var MP={isMounted:function(f){return(f=f._reactInternals)?A8(f)===f:!1},enqueueSetState:function(f,v,C){f=f._reactInternals;var F=kl(),Y=x3(f),ne=ag(F,Y);ne.payload=v,C!=null&&(ne.callback=C),v=g3(f,ne,Y),v!==null&&(af(v,f,Y,F),EP(v,f,Y))},enqueueReplaceState:function(f,v,C){f=f._reactInternals;var F=kl(),Y=x3(f),ne=ag(F,Y);ne.tag=1,ne.payload=v,C!=null&&(ne.callback=C),v=g3(f,ne,Y),v!==null&&(af(v,f,Y,F),EP(v,f,Y))},enqueueForceUpdate:function(f,v){f=f._reactInternals;var C=kl(),F=x3(f),Y=ag(C,F);Y.tag=2,v!=null&&(Y.callback=v),v=g3(f,Y,F),v!==null&&(af(v,f,F,C),EP(v,f,F))}};function _fe(f,v,C,F,Y,ne,ve){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(F,ne,ve):v.prototype&&v.prototype.isPureReactComponent?!WS(C,F)||!WS(Y,ne):!0}function xfe(f,v,C){var F=!1,Y=f3,ne=v.contextType;return typeof ne=="object"&&ne!==null?ne=Mh(ne):(Y=bu(v)?R8:L0.current,F=v.contextTypes,ne=(F=F!=null)?d7(f,Y):f3),v=new v(C,ne),f.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=MP,f.stateNode=v,v._reactInternals=f,F&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=Y,f.__reactInternalMemoizedMaskedChildContext=ne),v}function bfe(f,v,C,F){f=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(C,F),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(C,F),v.state!==f&&MP.enqueueReplaceState(v,v.state,null)}function TB(f,v,C,F){var Y=f.stateNode;Y.props=C,Y.state=f.memoizedState,Y.refs=yfe,wB(f);var ne=v.contextType;typeof ne=="object"&&ne!==null?Y.context=Mh(ne):(ne=bu(v)?R8:L0.current,Y.context=d7(f,ne)),Y.state=f.memoizedState,ne=v.getDerivedStateFromProps,typeof ne=="function"&&(EB(f,v,ne,C),Y.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof Y.getSnapshotBeforeUpdate=="function"||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(v=Y.state,typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount(),v!==Y.state&&MP.enqueueReplaceState(Y,Y.state,null),TP(f,C,Y,F),Y.state=f.memoizedState),typeof Y.componentDidMount=="function"&&(f.flags|=4194308)}function QS(f,v,C){if(f=C.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(m(309));var F=C.stateNode}if(!F)throw Error(m(147,f));var Y=F,ne=""+f;return v!==null&&v.ref!==null&&typeof v.ref=="function"&&v.ref._stringRef===ne?v.ref:(v=function(ve){var Le=Y.refs;Le===yfe&&(Le=Y.refs={}),ve===null?delete Le[ne]:Le[ne]=ve},v._stringRef=ne,v)}if(typeof f!="string")throw Error(m(284));if(!C._owner)throw Error(m(290,f))}return f}function CP(f,v){throw f=Object.prototype.toString.call(v),Error(m(31,f==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":f))}function Sfe(f){var v=f._init;return v(f._payload)}function wfe(f){function v(Et,it){if(f){var Rt=Et.deletions;Rt===null?(Et.deletions=[it],Et.flags|=16):Rt.push(it)}}function C(Et,it){if(!f)return null;for(;it!==null;)v(Et,it),it=it.sibling;return null}function F(Et,it){for(Et=new Map;it!==null;)it.key!==null?Et.set(it.key,it):Et.set(it.index,it),it=it.sibling;return Et}function Y(Et,it){return Et=S3(Et,it),Et.index=0,Et.sibling=null,Et}function ne(Et,it,Rt){return Et.index=Rt,f?(Rt=Et.alternate,Rt!==null?(Rt=Rt.index,Rt<it?(Et.flags|=2,it):Rt):(Et.flags|=2,it)):(Et.flags|=1048576,it)}function ve(Et){return f&&Et.alternate===null&&(Et.flags|=2),Et}function Le(Et,it,Rt,Cn){return it===null||it.tag!==6?(it=oz(Rt,Et.mode,Cn),it.return=Et,it):(it=Y(it,Rt),it.return=Et,it)}function Je(Et,it,Rt,Cn){var _r=Rt.type;return _r===ze?_n(Et,it,Rt.props.children,Cn,Rt.key):it!==null&&(it.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===Ve&&Sfe(_r)===it.type)?(Cn=Y(it,Rt.props),Cn.ref=QS(Et,it,Rt),Cn.return=Et,Cn):(Cn=$P(Rt.type,Rt.key,Rt.props,null,Et.mode,Cn),Cn.ref=QS(Et,it,Rt),Cn.return=Et,Cn)}function Ut(Et,it,Rt,Cn){return it===null||it.tag!==4||it.stateNode.containerInfo!==Rt.containerInfo||it.stateNode.implementation!==Rt.implementation?(it=lz(Rt,Et.mode,Cn),it.return=Et,it):(it=Y(it,Rt.children||[]),it.return=Et,it)}function _n(Et,it,Rt,Cn,_r){return it===null||it.tag!==7?(it=z8(Rt,Et.mode,Cn,_r),it.return=Et,it):(it=Y(it,Rt),it.return=Et,it)}function Sn(Et,it,Rt){if(typeof it=="string"&&it!==""||typeof it=="number")return it=oz(""+it,Et.mode,Rt),it.return=Et,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case ye:return Rt=$P(it.type,it.key,it.props,null,Et.mode,Rt),Rt.ref=QS(Et,null,it),Rt.return=Et,Rt;case Ne:return it=lz(it,Et.mode,Rt),it.return=Et,it;case Ve:var Cn=it._init;return Sn(Et,Cn(it._payload),Rt)}if(rn(it)||Wt(it))return it=z8(it,Et.mode,Rt,null),it.return=Et,it;CP(Et,it)}return null}function pn(Et,it,Rt,Cn){var _r=it!==null?it.key:null;if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return _r!==null?null:Le(Et,it,""+Rt,Cn);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case ye:return Rt.key===_r?Je(Et,it,Rt,Cn):null;case Ne:return Rt.key===_r?Ut(Et,it,Rt,Cn):null;case Ve:return _r=Rt._init,pn(Et,it,_r(Rt._payload),Cn)}if(rn(Rt)||Wt(Rt))return _r!==null?null:_n(Et,it,Rt,Cn,null);CP(Et,Rt)}return null}function Jn(Et,it,Rt,Cn,_r){if(typeof Cn=="string"&&Cn!==""||typeof Cn=="number")return Et=Et.get(Rt)||null,Le(it,Et,""+Cn,_r);if(typeof Cn=="object"&&Cn!==null){switch(Cn.$$typeof){case ye:return Et=Et.get(Cn.key===null?Rt:Cn.key)||null,Je(it,Et,Cn,_r);case Ne:return Et=Et.get(Cn.key===null?Rt:Cn.key)||null,Ut(it,Et,Cn,_r);case Ve:var Ir=Cn._init;return Jn(Et,it,Rt,Ir(Cn._payload),_r)}if(rn(Cn)||Wt(Cn))return Et=Et.get(Rt)||null,_n(it,Et,Cn,_r,null);CP(it,Cn)}return null}function dr(Et,it,Rt,Cn){for(var _r=null,Ir=null,kr=it,jr=it=0,Uo=null;kr!==null&&jr<Rt.length;jr++){kr.index>jr?(Uo=kr,kr=null):Uo=kr.sibling;var $i=pn(Et,kr,Rt[jr],Cn);if($i===null){kr===null&&(kr=Uo);break}f&&kr&&$i.alternate===null&&v(Et,kr),it=ne($i,it,jr),Ir===null?_r=$i:Ir.sibling=$i,Ir=$i,kr=Uo}if(jr===Rt.length)return C(Et,kr),sa&&k8(Et,jr),_r;if(kr===null){for(;jr<Rt.length;jr++)kr=Sn(Et,Rt[jr],Cn),kr!==null&&(it=ne(kr,it,jr),Ir===null?_r=kr:Ir.sibling=kr,Ir=kr);return sa&&k8(Et,jr),_r}for(kr=F(Et,kr);jr<Rt.length;jr++)Uo=Jn(kr,Et,jr,Rt[jr],Cn),Uo!==null&&(f&&Uo.alternate!==null&&kr.delete(Uo.key===null?jr:Uo.key),it=ne(Uo,it,jr),Ir===null?_r=Uo:Ir.sibling=Uo,Ir=Uo);return f&&kr.forEach(function(w3){return v(Et,w3)}),sa&&k8(Et,jr),_r}function mr(Et,it,Rt,Cn){var _r=Wt(Rt);if(typeof _r!="function")throw Error(m(150));if(Rt=_r.call(Rt),Rt==null)throw Error(m(151));for(var Ir=_r=null,kr=it,jr=it=0,Uo=null,$i=Rt.next();kr!==null&&!$i.done;jr++,$i=Rt.next()){kr.index>jr?(Uo=kr,kr=null):Uo=kr.sibling;var w3=pn(Et,kr,$i.value,Cn);if(w3===null){kr===null&&(kr=Uo);break}f&&kr&&w3.alternate===null&&v(Et,kr),it=ne(w3,it,jr),Ir===null?_r=w3:Ir.sibling=w3,Ir=w3,kr=Uo}if($i.done)return C(Et,kr),sa&&k8(Et,jr),_r;if(kr===null){for(;!$i.done;jr++,$i=Rt.next())$i=Sn(Et,$i.value,Cn),$i!==null&&(it=ne($i,it,jr),Ir===null?_r=$i:Ir.sibling=$i,Ir=$i);return sa&&k8(Et,jr),_r}for(kr=F(Et,kr);!$i.done;jr++,$i=Rt.next())$i=Jn(kr,Et,jr,$i.value,Cn),$i!==null&&(f&&$i.alternate!==null&&kr.delete($i.key===null?jr:$i.key),it=ne($i,it,jr),Ir===null?_r=$i:Ir.sibling=$i,Ir=$i);return f&&kr.forEach(function(rTe){return v(Et,rTe)}),sa&&k8(Et,jr),_r}function Ga(Et,it,Rt,Cn){if(typeof Rt=="object"&&Rt!==null&&Rt.type===ze&&Rt.key===null&&(Rt=Rt.props.children),typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case ye:e:{for(var _r=Rt.key,Ir=it;Ir!==null;){if(Ir.key===_r){if(_r=Rt.type,_r===ze){if(Ir.tag===7){C(Et,Ir.sibling),it=Y(Ir,Rt.props.children),it.return=Et,Et=it;break e}}else if(Ir.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===Ve&&Sfe(_r)===Ir.type){C(Et,Ir.sibling),it=Y(Ir,Rt.props),it.ref=QS(Et,Ir,Rt),it.return=Et,Et=it;break e}C(Et,Ir);break}else v(Et,Ir);Ir=Ir.sibling}Rt.type===ze?(it=z8(Rt.props.children,Et.mode,Cn,Rt.key),it.return=Et,Et=it):(Cn=$P(Rt.type,Rt.key,Rt.props,null,Et.mode,Cn),Cn.ref=QS(Et,it,Rt),Cn.return=Et,Et=Cn)}return ve(Et);case Ne:e:{for(Ir=Rt.key;it!==null;){if(it.key===Ir)if(it.tag===4&&it.stateNode.containerInfo===Rt.containerInfo&&it.stateNode.implementation===Rt.implementation){C(Et,it.sibling),it=Y(it,Rt.children||[]),it.return=Et,Et=it;break e}else{C(Et,it);break}else v(Et,it);it=it.sibling}it=lz(Rt,Et.mode,Cn),it.return=Et,Et=it}return ve(Et);case Ve:return Ir=Rt._init,Ga(Et,it,Ir(Rt._payload),Cn)}if(rn(Rt))return dr(Et,it,Rt,Cn);if(Wt(Rt))return mr(Et,it,Rt,Cn);CP(Et,Rt)}return typeof Rt=="string"&&Rt!==""||typeof Rt=="number"?(Rt=""+Rt,it!==null&&it.tag===6?(C(Et,it.sibling),it=Y(it,Rt),it.return=Et,Et=it):(C(Et,it),it=oz(Rt,Et.mode,Cn),it.return=Et,Et=it),ve(Et)):C(Et,it)}return Ga}var y7=wfe(!0),Efe=wfe(!1),JS={},Wp=d3(JS),ew=d3(JS),tw=d3(JS);function D8(f){if(f===JS)throw Error(m(174));return f}function MB(f,v){switch(Fs(tw,v),Fs(ew,f),Fs(Wp,JS),f=v.nodeType,f){case 9:case 11:v=(v=v.documentElement)?v.namespaceURI:Hr(null,"");break;default:f=f===8?v.parentNode:v,v=f.namespaceURI||null,f=f.tagName,v=Hr(v,f)}Js(Wp),Fs(Wp,v)}function _7(){Js(Wp),Js(ew),Js(tw)}function Tfe(f){D8(tw.current);var v=D8(Wp.current),C=Hr(v,f.type);v!==C&&(Fs(ew,f),Fs(Wp,C))}function CB(f){ew.current===f&&(Js(Wp),Js(ew))}var ga=d3(0);function AP(f){for(var v=f;v!==null;){if(v.tag===13){var C=v.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||C.data==="$?"||C.data==="$!"))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if(v.flags&128)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}var AB=[];function PB(){for(var f=0;f<AB.length;f++)AB[f]._workInProgressVersionPrimary=null;AB.length=0}var PP=fe.ReactCurrentDispatcher,RB=fe.ReactCurrentBatchConfig,O8=0,va=null,vo=null,Fo=null,RP=!1,nw=!1,rw=0,TEe=0;function U0(){throw Error(m(321))}function IB(f,v){if(v===null)return!1;for(var C=0;C<v.length&&C<f.length;C++)if(!ef(f[C],v[C]))return!1;return!0}function kB(f,v,C,F,Y,ne){if(O8=ne,va=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,PP.current=f===null||f.memoizedState===null?PEe:REe,f=C(F,Y),nw){ne=0;do{if(nw=!1,rw=0,25<=ne)throw Error(m(301));ne+=1,Fo=vo=null,v.updateQueue=null,PP.current=IEe,f=C(F,Y)}while(nw)}if(PP.current=NP,v=vo!==null&&vo.next!==null,O8=0,Fo=vo=va=null,RP=!1,v)throw Error(m(300));return f}function NB(){var f=rw!==0;return rw=0,f}function $p(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fo===null?va.memoizedState=Fo=f:Fo=Fo.next=f,Fo}function Ch(){if(vo===null){var f=va.alternate;f=f!==null?f.memoizedState:null}else f=vo.next;var v=Fo===null?va.memoizedState:Fo.next;if(v!==null)Fo=v,vo=f;else{if(f===null)throw Error(m(310));vo=f,f={memoizedState:vo.memoizedState,baseState:vo.baseState,baseQueue:vo.baseQueue,queue:vo.queue,next:null},Fo===null?va.memoizedState=Fo=f:Fo=Fo.next=f}return Fo}function iw(f,v){return typeof v=="function"?v(f):v}function DB(f){var v=Ch(),C=v.queue;if(C===null)throw Error(m(311));C.lastRenderedReducer=f;var F=vo,Y=F.baseQueue,ne=C.pending;if(ne!==null){if(Y!==null){var ve=Y.next;Y.next=ne.next,ne.next=ve}F.baseQueue=Y=ne,C.pending=null}if(Y!==null){ne=Y.next,F=F.baseState;var Le=ve=null,Je=null,Ut=ne;do{var _n=Ut.lane;if((O8&_n)===_n)Je!==null&&(Je=Je.next={lane:0,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null}),F=Ut.hasEagerState?Ut.eagerState:f(F,Ut.action);else{var Sn={lane:_n,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null};Je===null?(Le=Je=Sn,ve=F):Je=Je.next=Sn,va.lanes|=_n,F8|=_n}Ut=Ut.next}while(Ut!==null&&Ut!==ne);Je===null?ve=F:Je.next=Le,ef(F,v.memoizedState)||(Su=!0),v.memoizedState=F,v.baseState=ve,v.baseQueue=Je,C.lastRenderedState=F}if(f=C.interleaved,f!==null){Y=f;do ne=Y.lane,va.lanes|=ne,F8|=ne,Y=Y.next;while(Y!==f)}else Y===null&&(C.lanes=0);return[v.memoizedState,C.dispatch]}function OB(f){var v=Ch(),C=v.queue;if(C===null)throw Error(m(311));C.lastRenderedReducer=f;var F=C.dispatch,Y=C.pending,ne=v.memoizedState;if(Y!==null){C.pending=null;var ve=Y=Y.next;do ne=f(ne,ve.action),ve=ve.next;while(ve!==Y);ef(ne,v.memoizedState)||(Su=!0),v.memoizedState=ne,v.baseQueue===null&&(v.baseState=ne),C.lastRenderedState=ne}return[ne,F]}function Mfe(){}function Cfe(f,v){var C=va,F=Ch(),Y=v(),ne=!ef(F.memoizedState,Y);if(ne&&(F.memoizedState=Y,Su=!0),F=F.queue,FB(Rfe.bind(null,C,F,f),[f]),F.getSnapshot!==v||ne||Fo!==null&&Fo.memoizedState.tag&1){if(C.flags|=2048,sw(9,Pfe.bind(null,C,F,Y,v),void 0,null),Lo===null)throw Error(m(349));O8&30||Afe(C,v,Y)}return Y}function Afe(f,v,C){f.flags|=16384,f={getSnapshot:v,value:C},v=va.updateQueue,v===null?(v={lastEffect:null,stores:null},va.updateQueue=v,v.stores=[f]):(C=v.stores,C===null?v.stores=[f]:C.push(f))}function Pfe(f,v,C,F){v.value=C,v.getSnapshot=F,Ife(v)&&kfe(f)}function Rfe(f,v,C){return C(function(){Ife(v)&&kfe(f)})}function Ife(f){var v=f.getSnapshot;f=f.value;try{var C=v();return!ef(f,C)}catch{return!0}}function kfe(f){var v=sg(f,1);v!==null&&af(v,f,1,-1)}function Nfe(f){var v=$p();return typeof f=="function"&&(f=f()),v.memoizedState=v.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:iw,lastRenderedState:f},v.queue=f,f=f.dispatch=AEe.bind(null,va,f),[v.memoizedState,f]}function sw(f,v,C,F){return f={tag:f,create:v,destroy:C,deps:F,next:null},v=va.updateQueue,v===null?(v={lastEffect:null,stores:null},va.updateQueue=v,v.lastEffect=f.next=f):(C=v.lastEffect,C===null?v.lastEffect=f.next=f:(F=C.next,C.next=f,f.next=F,v.lastEffect=f)),f}function Dfe(){return Ch().memoizedState}function IP(f,v,C,F){var Y=$p();va.flags|=f,Y.memoizedState=sw(1|v,C,void 0,F===void 0?null:F)}function kP(f,v,C,F){var Y=Ch();F=F===void 0?null:F;var ne=void 0;if(vo!==null){var ve=vo.memoizedState;if(ne=ve.destroy,F!==null&&IB(F,ve.deps)){Y.memoizedState=sw(v,C,ne,F);return}}va.flags|=f,Y.memoizedState=sw(1|v,C,ne,F)}function Ofe(f,v){return IP(8390656,8,f,v)}function FB(f,v){return kP(2048,8,f,v)}function Ffe(f,v){return kP(4,2,f,v)}function Lfe(f,v){return kP(4,4,f,v)}function Ufe(f,v){if(typeof v=="function")return f=f(),v(f),function(){v(null)};if(v!=null)return f=f(),v.current=f,function(){v.current=null}}function Bfe(f,v,C){return C=C!=null?C.concat([f]):null,kP(4,4,Ufe.bind(null,v,f),C)}function LB(){}function zfe(f,v){var C=Ch();v=v===void 0?null:v;var F=C.memoizedState;return F!==null&&v!==null&&IB(v,F[1])?F[0]:(C.memoizedState=[f,v],f)}function Vfe(f,v){var C=Ch();v=v===void 0?null:v;var F=C.memoizedState;return F!==null&&v!==null&&IB(v,F[1])?F[0]:(f=f(),C.memoizedState=[f,v],f)}function Gfe(f,v,C){return O8&21?(ef(C,v)||(C=fde(),va.lanes|=C,F8|=C,f.baseState=!0),v):(f.baseState&&(f.baseState=!1,Su=!0),f.memoizedState=C)}function MEe(f,v){var C=fs;fs=C!==0&&4>C?C:4,f(!0);var F=RB.transition;RB.transition={};try{f(!1),v()}finally{fs=C,RB.transition=F}}function Hfe(){return Ch().memoizedState}function CEe(f,v,C){var F=x3(f);if(C={lane:F,action:C,hasEagerState:!1,eagerState:null,next:null},jfe(f))Wfe(v,C);else if(C=pfe(f,v,C,F),C!==null){var Y=kl();af(C,f,F,Y),$fe(C,v,F)}}function AEe(f,v,C){var F=x3(f),Y={lane:F,action:C,hasEagerState:!1,eagerState:null,next:null};if(jfe(f))Wfe(v,Y);else{var ne=f.alternate;if(f.lanes===0&&(ne===null||ne.lanes===0)&&(ne=v.lastRenderedReducer,ne!==null))try{var ve=v.lastRenderedState,Le=ne(ve,C);if(Y.hasEagerState=!0,Y.eagerState=Le,ef(Le,ve)){var Je=v.interleaved;Je===null?(Y.next=Y,SB(v)):(Y.next=Je.next,Je.next=Y),v.interleaved=Y;return}}catch{}finally{}C=pfe(f,v,Y,F),C!==null&&(Y=kl(),af(C,f,F,Y),$fe(C,v,F))}}function jfe(f){var v=f.alternate;return f===va||v!==null&&v===va}function Wfe(f,v){nw=RP=!0;var C=f.pending;C===null?v.next=v:(v.next=C.next,C.next=v),f.pending=v}function $fe(f,v,C){if(C&4194240){var F=v.lanes;F&=f.pendingLanes,C|=F,v.lanes=C,BU(f,C)}}var NP={readContext:Mh,useCallback:U0,useContext:U0,useEffect:U0,useImperativeHandle:U0,useInsertionEffect:U0,useLayoutEffect:U0,useMemo:U0,useReducer:U0,useRef:U0,useState:U0,useDebugValue:U0,useDeferredValue:U0,useTransition:U0,useMutableSource:U0,useSyncExternalStore:U0,useId:U0,unstable_isNewReconciler:!1},PEe={readContext:Mh,useCallback:function(f,v){return $p().memoizedState=[f,v===void 0?null:v],f},useContext:Mh,useEffect:Ofe,useImperativeHandle:function(f,v,C){return C=C!=null?C.concat([f]):null,IP(4194308,4,Ufe.bind(null,v,f),C)},useLayoutEffect:function(f,v){return IP(4194308,4,f,v)},useInsertionEffect:function(f,v){return IP(4,2,f,v)},useMemo:function(f,v){var C=$p();return v=v===void 0?null:v,f=f(),C.memoizedState=[f,v],f},useReducer:function(f,v,C){var F=$p();return v=C!==void 0?C(v):v,F.memoizedState=F.baseState=v,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:v},F.queue=f,f=f.dispatch=CEe.bind(null,va,f),[F.memoizedState,f]},useRef:function(f){var v=$p();return f={current:f},v.memoizedState=f},useState:Nfe,useDebugValue:LB,useDeferredValue:function(f){return $p().memoizedState=f},useTransition:function(){var f=Nfe(!1),v=f[0];return f=MEe.bind(null,f[1]),$p().memoizedState=f,[v,f]},useMutableSource:function(){},useSyncExternalStore:function(f,v,C){var F=va,Y=$p();if(sa){if(C===void 0)throw Error(m(407));C=C()}else{if(C=v(),Lo===null)throw Error(m(349));O8&30||Afe(F,v,C)}Y.memoizedState=C;var ne={value:C,getSnapshot:v};return Y.queue=ne,Ofe(Rfe.bind(null,F,ne,f),[f]),F.flags|=2048,sw(9,Pfe.bind(null,F,ne,C,v),void 0,null),C},useId:function(){var f=$p(),v=Lo.identifierPrefix;if(sa){var C=ig,F=rg;C=(F&~(1<<32-Jd(F)-1)).toString(32)+C,v=":"+v+"R"+C,C=rw++,0<C&&(v+="H"+C.toString(32)),v+=":"}else C=TEe++,v=":"+v+"r"+C.toString(32)+":";return f.memoizedState=v},unstable_isNewReconciler:!1},REe={readContext:Mh,useCallback:zfe,useContext:Mh,useEffect:FB,useImperativeHandle:Bfe,useInsertionEffect:Ffe,useLayoutEffect:Lfe,useMemo:Vfe,useReducer:DB,useRef:Dfe,useState:function(){return DB(iw)},useDebugValue:LB,useDeferredValue:function(f){var v=Ch();return Gfe(v,vo.memoizedState,f)},useTransition:function(){var f=DB(iw)[0],v=Ch().memoizedState;return[f,v]},useMutableSource:Mfe,useSyncExternalStore:Cfe,useId:Hfe,unstable_isNewReconciler:!1},IEe={readContext:Mh,useCallback:zfe,useContext:Mh,useEffect:FB,useImperativeHandle:Bfe,useInsertionEffect:Ffe,useLayoutEffect:Lfe,useMemo:Vfe,useReducer:OB,useRef:Dfe,useState:function(){return OB(iw)},useDebugValue:LB,useDeferredValue:function(f){var v=Ch();return vo===null?v.memoizedState=f:Gfe(v,vo.memoizedState,f)},useTransition:function(){var f=OB(iw)[0],v=Ch().memoizedState;return[f,v]},useMutableSource:Mfe,useSyncExternalStore:Cfe,useId:Hfe,unstable_isNewReconciler:!1};function x7(f,v){try{var C="",F=v;do C+=ut(F),F=F.return;while(F);var Y=C}catch(ne){Y=`
Error generating stack: `+ne.message+`
`+ne.stack}return{value:f,source:v,stack:Y,digest:null}}function UB(f,v,C){return{value:f,source:null,stack:C??null,digest:v??null}}function BB(f,v){try{console.error(v.value)}catch(C){setTimeout(function(){throw C})}}var kEe=typeof WeakMap=="function"?WeakMap:Map;function qfe(f,v,C){C=ag(-1,C),C.tag=3,C.payload={element:null};var F=v.value;return C.callback=function(){zP||(zP=!0,JB=F),BB(f,v)},C}function Xfe(f,v,C){C=ag(-1,C),C.tag=3;var F=f.type.getDerivedStateFromError;if(typeof F=="function"){var Y=v.value;C.payload=function(){return F(Y)},C.callback=function(){BB(f,v)}}var ne=f.stateNode;return ne!==null&&typeof ne.componentDidCatch=="function"&&(C.callback=function(){BB(f,v),typeof F!="function"&&(y3===null?y3=new Set([this]):y3.add(this));var ve=v.stack;this.componentDidCatch(v.value,{componentStack:ve!==null?ve:""})}),C}function Yfe(f,v,C){var F=f.pingCache;if(F===null){F=f.pingCache=new kEe;var Y=new Set;F.set(v,Y)}else Y=F.get(v),Y===void 0&&(Y=new Set,F.set(v,Y));Y.has(C)||(Y.add(C),f=$Ee.bind(null,f,v,C),v.then(f,f))}function Kfe(f){do{var v;if((v=f.tag===13)&&(v=f.memoizedState,v=v!==null?v.dehydrated!==null:!0),v)return f;f=f.return}while(f!==null);return null}function Zfe(f,v,C,F,Y){return f.mode&1?(f.flags|=65536,f.lanes=Y,f):(f===v?f.flags|=65536:(f.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(v=ag(-1,1),v.tag=2,g3(C,v,1))),C.lanes|=1),f)}var NEe=fe.ReactCurrentOwner,Su=!1;function Il(f,v,C,F){v.child=f===null?Efe(v,null,C,F):y7(v,f.child,C,F)}function Qfe(f,v,C,F,Y){C=C.render;var ne=v.ref;return v7(v,Y),F=kB(f,v,C,F,ne,Y),C=NB(),f!==null&&!Su?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~Y,og(f,v,Y)):(sa&&C&&fB(v),v.flags|=1,Il(f,v,F,Y),v.child)}function Jfe(f,v,C,F,Y){if(f===null){var ne=C.type;return typeof ne=="function"&&!az(ne)&&ne.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(v.tag=15,v.type=ne,epe(f,v,ne,F,Y)):(f=$P(C.type,null,F,v,v.mode,Y),f.ref=v.ref,f.return=v,v.child=f)}if(ne=f.child,!(f.lanes&Y)){var ve=ne.memoizedProps;if(C=C.compare,C=C!==null?C:WS,C(ve,F)&&f.ref===v.ref)return og(f,v,Y)}return v.flags|=1,f=S3(ne,F),f.ref=v.ref,f.return=v,v.child=f}function epe(f,v,C,F,Y){if(f!==null){var ne=f.memoizedProps;if(WS(ne,F)&&f.ref===v.ref)if(Su=!1,v.pendingProps=F=ne,(f.lanes&Y)!==0)f.flags&131072&&(Su=!0);else return v.lanes=f.lanes,og(f,v,Y)}return zB(f,v,C,F,Y)}function tpe(f,v,C){var F=v.pendingProps,Y=F.children,ne=f!==null?f.memoizedState:null;if(F.mode==="hidden")if(!(v.mode&1))v.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fs(S7,xc),xc|=C;else{if(!(C&1073741824))return f=ne!==null?ne.baseLanes|C:C,v.lanes=v.childLanes=1073741824,v.memoizedState={baseLanes:f,cachePool:null,transitions:null},v.updateQueue=null,Fs(S7,xc),xc|=f,null;v.memoizedState={baseLanes:0,cachePool:null,transitions:null},F=ne!==null?ne.baseLanes:C,Fs(S7,xc),xc|=F}else ne!==null?(F=ne.baseLanes|C,v.memoizedState=null):F=C,Fs(S7,xc),xc|=F;return Il(f,v,Y,C),v.child}function npe(f,v){var C=v.ref;(f===null&&C!==null||f!==null&&f.ref!==C)&&(v.flags|=512,v.flags|=2097152)}function zB(f,v,C,F,Y){var ne=bu(C)?R8:L0.current;return ne=d7(v,ne),v7(v,Y),C=kB(f,v,C,F,ne,Y),F=NB(),f!==null&&!Su?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~Y,og(f,v,Y)):(sa&&F&&fB(v),v.flags|=1,Il(f,v,C,Y),v.child)}function rpe(f,v,C,F,Y){if(bu(C)){var ne=!0;vP(v)}else ne=!1;if(v7(v,Y),v.stateNode===null)OP(f,v),xfe(v,C,F),TB(v,C,F,Y),F=!0;else if(f===null){var ve=v.stateNode,Le=v.memoizedProps;ve.props=Le;var Je=ve.context,Ut=C.contextType;typeof Ut=="object"&&Ut!==null?Ut=Mh(Ut):(Ut=bu(C)?R8:L0.current,Ut=d7(v,Ut));var _n=C.getDerivedStateFromProps,Sn=typeof _n=="function"||typeof ve.getSnapshotBeforeUpdate=="function";Sn||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Le!==F||Je!==Ut)&&bfe(v,ve,F,Ut),m3=!1;var pn=v.memoizedState;ve.state=pn,TP(v,F,ve,Y),Je=v.memoizedState,Le!==F||pn!==Je||xu.current||m3?(typeof _n=="function"&&(EB(v,C,_n,F),Je=v.memoizedState),(Le=m3||_fe(v,C,Le,F,pn,Je,Ut))?(Sn||typeof ve.UNSAFE_componentWillMount!="function"&&typeof ve.componentWillMount!="function"||(typeof ve.componentWillMount=="function"&&ve.componentWillMount(),typeof ve.UNSAFE_componentWillMount=="function"&&ve.UNSAFE_componentWillMount()),typeof ve.componentDidMount=="function"&&(v.flags|=4194308)):(typeof ve.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=F,v.memoizedState=Je),ve.props=F,ve.state=Je,ve.context=Ut,F=Le):(typeof ve.componentDidMount=="function"&&(v.flags|=4194308),F=!1)}else{ve=v.stateNode,mfe(f,v),Le=v.memoizedProps,Ut=v.type===v.elementType?Le:nf(v.type,Le),ve.props=Ut,Sn=v.pendingProps,pn=ve.context,Je=C.contextType,typeof Je=="object"&&Je!==null?Je=Mh(Je):(Je=bu(C)?R8:L0.current,Je=d7(v,Je));var Jn=C.getDerivedStateFromProps;(_n=typeof Jn=="function"||typeof ve.getSnapshotBeforeUpdate=="function")||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Le!==Sn||pn!==Je)&&bfe(v,ve,F,Je),m3=!1,pn=v.memoizedState,ve.state=pn,TP(v,F,ve,Y);var dr=v.memoizedState;Le!==Sn||pn!==dr||xu.current||m3?(typeof Jn=="function"&&(EB(v,C,Jn,F),dr=v.memoizedState),(Ut=m3||_fe(v,C,Ut,F,pn,dr,Je)||!1)?(_n||typeof ve.UNSAFE_componentWillUpdate!="function"&&typeof ve.componentWillUpdate!="function"||(typeof ve.componentWillUpdate=="function"&&ve.componentWillUpdate(F,dr,Je),typeof ve.UNSAFE_componentWillUpdate=="function"&&ve.UNSAFE_componentWillUpdate(F,dr,Je)),typeof ve.componentDidUpdate=="function"&&(v.flags|=4),typeof ve.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof ve.componentDidUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(v.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(v.flags|=1024),v.memoizedProps=F,v.memoizedState=dr),ve.props=F,ve.state=dr,ve.context=Je,F=Ut):(typeof ve.componentDidUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(v.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(v.flags|=1024),F=!1)}return VB(f,v,C,F,ne,Y)}function VB(f,v,C,F,Y,ne){npe(f,v);var ve=(v.flags&128)!==0;if(!F&&!ve)return Y&&ofe(v,C,!1),og(f,v,ne);F=v.stateNode,NEe.current=v;var Le=ve&&typeof C.getDerivedStateFromError!="function"?null:F.render();return v.flags|=1,f!==null&&ve?(v.child=y7(v,f.child,null,ne),v.child=y7(v,null,Le,ne)):Il(f,v,Le,ne),v.memoizedState=F.state,Y&&ofe(v,C,!0),v.child}function ipe(f){var v=f.stateNode;v.pendingContext?sfe(f,v.pendingContext,v.pendingContext!==v.context):v.context&&sfe(f,v.context,!1),MB(f,v.containerInfo)}function spe(f,v,C,F,Y){return m7(),vB(Y),v.flags|=256,Il(f,v,C,F),v.child}var GB={dehydrated:null,treeContext:null,retryLane:0};function HB(f){return{baseLanes:f,cachePool:null,transitions:null}}function ape(f,v,C){var F=v.pendingProps,Y=ga.current,ne=!1,ve=(v.flags&128)!==0,Le;if((Le=ve)||(Le=f!==null&&f.memoizedState===null?!1:(Y&2)!==0),Le?(ne=!0,v.flags&=-129):(f===null||f.memoizedState!==null)&&(Y|=1),Fs(ga,Y&1),f===null)return gB(v),f=v.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(v.mode&1?f.data==="$!"?v.lanes=8:v.lanes=1073741824:v.lanes=1,null):(ve=F.children,f=F.fallback,ne?(F=v.mode,ne=v.child,ve={mode:"hidden",children:ve},!(F&1)&&ne!==null?(ne.childLanes=0,ne.pendingProps=ve):ne=qP(ve,F,0,null),f=z8(f,F,C,null),ne.return=v,f.return=v,ne.sibling=f,v.child=ne,v.child.memoizedState=HB(C),v.memoizedState=GB,f):jB(v,ve));if(Y=f.memoizedState,Y!==null&&(Le=Y.dehydrated,Le!==null))return DEe(f,v,ve,F,Le,Y,C);if(ne){ne=F.fallback,ve=v.mode,Y=f.child,Le=Y.sibling;var Je={mode:"hidden",children:F.children};return!(ve&1)&&v.child!==Y?(F=v.child,F.childLanes=0,F.pendingProps=Je,v.deletions=null):(F=S3(Y,Je),F.subtreeFlags=Y.subtreeFlags&14680064),Le!==null?ne=S3(Le,ne):(ne=z8(ne,ve,C,null),ne.flags|=2),ne.return=v,F.return=v,F.sibling=ne,v.child=F,F=ne,ne=v.child,ve=f.child.memoizedState,ve=ve===null?HB(C):{baseLanes:ve.baseLanes|C,cachePool:null,transitions:ve.transitions},ne.memoizedState=ve,ne.childLanes=f.childLanes&~C,v.memoizedState=GB,F}return ne=f.child,f=ne.sibling,F=S3(ne,{mode:"visible",children:F.children}),!(v.mode&1)&&(F.lanes=C),F.return=v,F.sibling=null,f!==null&&(C=v.deletions,C===null?(v.deletions=[f],v.flags|=16):C.push(f)),v.child=F,v.memoizedState=null,F}function jB(f,v){return v=qP({mode:"visible",children:v},f.mode,0,null),v.return=f,f.child=v}function DP(f,v,C,F){return F!==null&&vB(F),y7(v,f.child,null,C),f=jB(v,v.pendingProps.children),f.flags|=2,v.memoizedState=null,f}function DEe(f,v,C,F,Y,ne,ve){if(C)return v.flags&256?(v.flags&=-257,F=UB(Error(m(422))),DP(f,v,ve,F)):v.memoizedState!==null?(v.child=f.child,v.flags|=128,null):(ne=F.fallback,Y=v.mode,F=qP({mode:"visible",children:F.children},Y,0,null),ne=z8(ne,Y,ve,null),ne.flags|=2,F.return=v,ne.return=v,F.sibling=ne,v.child=F,v.mode&1&&y7(v,f.child,null,ve),v.child.memoizedState=HB(ve),v.memoizedState=GB,ne);if(!(v.mode&1))return DP(f,v,ve,null);if(Y.data==="$!"){if(F=Y.nextSibling&&Y.nextSibling.dataset,F)var Le=F.dgst;return F=Le,ne=Error(m(419)),F=UB(ne,F,void 0),DP(f,v,ve,F)}if(Le=(ve&f.childLanes)!==0,Su||Le){if(F=Lo,F!==null){switch(ve&-ve){case 4:Y=2;break;case 16:Y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Y=32;break;case 536870912:Y=268435456;break;default:Y=0}Y=Y&(F.suspendedLanes|ve)?0:Y,Y!==0&&Y!==ne.retryLane&&(ne.retryLane=Y,sg(f,Y),af(F,f,Y,-1))}return sz(),F=UB(Error(m(421))),DP(f,v,ve,F)}return Y.data==="$?"?(v.flags|=128,v.child=f.child,v=qEe.bind(null,f),Y._reactRetry=v,null):(f=ne.treeContext,_c=h3(Y.nextSibling),yc=v,sa=!0,tf=null,f!==null&&(Eh[Th++]=rg,Eh[Th++]=ig,Eh[Th++]=I8,rg=f.id,ig=f.overflow,I8=v),v=jB(v,F.children),v.flags|=4096,v)}function ope(f,v,C){f.lanes|=v;var F=f.alternate;F!==null&&(F.lanes|=v),bB(f.return,v,C)}function WB(f,v,C,F,Y){var ne=f.memoizedState;ne===null?f.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:F,tail:C,tailMode:Y}:(ne.isBackwards=v,ne.rendering=null,ne.renderingStartTime=0,ne.last=F,ne.tail=C,ne.tailMode=Y)}function lpe(f,v,C){var F=v.pendingProps,Y=F.revealOrder,ne=F.tail;if(Il(f,v,F.children,C),F=ga.current,F&2)F=F&1|2,v.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=v.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&ope(f,C,v);else if(f.tag===19)ope(f,C,v);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===v)break e;for(;f.sibling===null;){if(f.return===null||f.return===v)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}F&=1}if(Fs(ga,F),!(v.mode&1))v.memoizedState=null;else switch(Y){case"forwards":for(C=v.child,Y=null;C!==null;)f=C.alternate,f!==null&&AP(f)===null&&(Y=C),C=C.sibling;C=Y,C===null?(Y=v.child,v.child=null):(Y=C.sibling,C.sibling=null),WB(v,!1,Y,C,ne);break;case"backwards":for(C=null,Y=v.child,v.child=null;Y!==null;){if(f=Y.alternate,f!==null&&AP(f)===null){v.child=Y;break}f=Y.sibling,Y.sibling=C,C=Y,Y=f}WB(v,!0,C,null,ne);break;case"together":WB(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function OP(f,v){!(v.mode&1)&&f!==null&&(f.alternate=null,v.alternate=null,v.flags|=2)}function og(f,v,C){if(f!==null&&(v.dependencies=f.dependencies),F8|=v.lanes,!(C&v.childLanes))return null;if(f!==null&&v.child!==f.child)throw Error(m(153));if(v.child!==null){for(f=v.child,C=S3(f,f.pendingProps),v.child=C,C.return=v;f.sibling!==null;)f=f.sibling,C=C.sibling=S3(f,f.pendingProps),C.return=v;C.sibling=null}return v.child}function OEe(f,v,C){switch(v.tag){case 3:ipe(v),m7();break;case 5:Tfe(v);break;case 1:bu(v.type)&&vP(v);break;case 4:MB(v,v.stateNode.containerInfo);break;case 10:var F=v.type._context,Y=v.memoizedProps.value;Fs(SP,F._currentValue),F._currentValue=Y;break;case 13:if(F=v.memoizedState,F!==null)return F.dehydrated!==null?(Fs(ga,ga.current&1),v.flags|=128,null):C&v.child.childLanes?ape(f,v,C):(Fs(ga,ga.current&1),f=og(f,v,C),f!==null?f.sibling:null);Fs(ga,ga.current&1);break;case 19:if(F=(C&v.childLanes)!==0,f.flags&128){if(F)return lpe(f,v,C);v.flags|=128}if(Y=v.memoizedState,Y!==null&&(Y.rendering=null,Y.tail=null,Y.lastEffect=null),Fs(ga,ga.current),F)break;return null;case 22:case 23:return v.lanes=0,tpe(f,v,C)}return og(f,v,C)}var upe,$B,cpe,hpe;upe=function(f,v){for(var C=v.child;C!==null;){if(C.tag===5||C.tag===6)f.appendChild(C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===v)break;for(;C.sibling===null;){if(C.return===null||C.return===v)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},$B=function(){},cpe=function(f,v,C,F){var Y=f.memoizedProps;if(Y!==F){f=v.stateNode,D8(Wp.current);var ne=null;switch(C){case"input":Y=Lt(f,Y),F=Lt(f,F),ne=[];break;case"select":Y=be({},Y,{value:void 0}),F=be({},F,{value:void 0}),ne=[];break;case"textarea":Y=fn(f,Y),F=fn(f,F),ne=[];break;default:typeof Y.onClick!="function"&&typeof F.onClick=="function"&&(f.onclick=pP)}e7(C,F);var ve;C=null;for(Ut in Y)if(!F.hasOwnProperty(Ut)&&Y.hasOwnProperty(Ut)&&Y[Ut]!=null)if(Ut==="style"){var Le=Y[Ut];for(ve in Le)Le.hasOwnProperty(ve)&&(C||(C={}),C[ve]="")}else Ut!=="dangerouslySetInnerHTML"&&Ut!=="children"&&Ut!=="suppressContentEditableWarning"&&Ut!=="suppressHydrationWarning"&&Ut!=="autoFocus"&&(b.hasOwnProperty(Ut)?ne||(ne=[]):(ne=ne||[]).push(Ut,null));for(Ut in F){var Je=F[Ut];if(Le=Y!=null?Y[Ut]:void 0,F.hasOwnProperty(Ut)&&Je!==Le&&(Je!=null||Le!=null))if(Ut==="style")if(Le){for(ve in Le)!Le.hasOwnProperty(ve)||Je&&Je.hasOwnProperty(ve)||(C||(C={}),C[ve]="");for(ve in Je)Je.hasOwnProperty(ve)&&Le[ve]!==Je[ve]&&(C||(C={}),C[ve]=Je[ve])}else C||(ne||(ne=[]),ne.push(Ut,C)),C=Je;else Ut==="dangerouslySetInnerHTML"?(Je=Je?Je.__html:void 0,Le=Le?Le.__html:void 0,Je!=null&&Le!==Je&&(ne=ne||[]).push(Ut,Je)):Ut==="children"?typeof Je!="string"&&typeof Je!="number"||(ne=ne||[]).push(Ut,""+Je):Ut!=="suppressContentEditableWarning"&&Ut!=="suppressHydrationWarning"&&(b.hasOwnProperty(Ut)?(Je!=null&&Ut==="onScroll"&&Qs("scroll",f),ne||Le===Je||(ne=[])):(ne=ne||[]).push(Ut,Je))}C&&(ne=ne||[]).push("style",C);var Ut=ne;(v.updateQueue=Ut)&&(v.flags|=4)}},hpe=function(f,v,C,F){C!==F&&(v.flags|=4)};function aw(f,v){if(!sa)switch(f.tailMode){case"hidden":v=f.tail;for(var C=null;v!==null;)v.alternate!==null&&(C=v),v=v.sibling;C===null?f.tail=null:C.sibling=null;break;case"collapsed":C=f.tail;for(var F=null;C!==null;)C.alternate!==null&&(F=C),C=C.sibling;F===null?v||f.tail===null?f.tail=null:f.tail.sibling=null:F.sibling=null}}function B0(f){var v=f.alternate!==null&&f.alternate.child===f.child,C=0,F=0;if(v)for(var Y=f.child;Y!==null;)C|=Y.lanes|Y.childLanes,F|=Y.subtreeFlags&14680064,F|=Y.flags&14680064,Y.return=f,Y=Y.sibling;else for(Y=f.child;Y!==null;)C|=Y.lanes|Y.childLanes,F|=Y.subtreeFlags,F|=Y.flags,Y.return=f,Y=Y.sibling;return f.subtreeFlags|=F,f.childLanes=C,v}function FEe(f,v,C){var F=v.pendingProps;switch(pB(v),v.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return B0(v),null;case 1:return bu(v.type)&&gP(),B0(v),null;case 3:return F=v.stateNode,_7(),Js(xu),Js(L0),PB(),F.pendingContext&&(F.context=F.pendingContext,F.pendingContext=null),(f===null||f.child===null)&&(bP(v)?v.flags|=4:f===null||f.memoizedState.isDehydrated&&!(v.flags&256)||(v.flags|=1024,tf!==null&&(nz(tf),tf=null))),$B(f,v),B0(v),null;case 5:CB(v);var Y=D8(tw.current);if(C=v.type,f!==null&&v.stateNode!=null)cpe(f,v,C,F,Y),f.ref!==v.ref&&(v.flags|=512,v.flags|=2097152);else{if(!F){if(v.stateNode===null)throw Error(m(166));return B0(v),null}if(f=D8(Wp.current),bP(v)){F=v.stateNode,C=v.type;var ne=v.memoizedProps;switch(F[jp]=v,F[KS]=ne,f=(v.mode&1)!==0,C){case"dialog":Qs("cancel",F),Qs("close",F);break;case"iframe":case"object":case"embed":Qs("load",F);break;case"video":case"audio":for(Y=0;Y<qS.length;Y++)Qs(qS[Y],F);break;case"source":Qs("error",F);break;case"img":case"image":case"link":Qs("error",F),Qs("load",F);break;case"details":Qs("toggle",F);break;case"input":kt(F,ne),Qs("invalid",F);break;case"select":F._wrapperState={wasMultiple:!!ne.multiple},Qs("invalid",F);break;case"textarea":tn(F,ne),Qs("invalid",F)}e7(C,ne),Y=null;for(var ve in ne)if(ne.hasOwnProperty(ve)){var Le=ne[ve];ve==="children"?typeof Le=="string"?F.textContent!==Le&&(ne.suppressHydrationWarning!==!0&&fP(F.textContent,Le,f),Y=["children",Le]):typeof Le=="number"&&F.textContent!==""+Le&&(ne.suppressHydrationWarning!==!0&&fP(F.textContent,Le,f),Y=["children",""+Le]):b.hasOwnProperty(ve)&&Le!=null&&ve==="onScroll"&&Qs("scroll",F)}switch(C){case"input":Tr(F),ct(F,ne,!0);break;case"textarea":Tr(F),xr(F);break;case"select":case"option":break;default:typeof ne.onClick=="function"&&(F.onclick=pP)}F=Y,v.updateQueue=F,F!==null&&(v.flags|=4)}else{ve=Y.nodeType===9?Y:Y.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=zi(C)),f==="http://www.w3.org/1999/xhtml"?C==="script"?(f=ve.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof F.is=="string"?f=ve.createElement(C,{is:F.is}):(f=ve.createElement(C),C==="select"&&(ve=f,F.multiple?ve.multiple=!0:F.size&&(ve.size=F.size))):f=ve.createElementNS(f,C),f[jp]=v,f[KS]=F,upe(f,v,!1,!1),v.stateNode=f;e:{switch(ve=AS(C,F),C){case"dialog":Qs("cancel",f),Qs("close",f),Y=F;break;case"iframe":case"object":case"embed":Qs("load",f),Y=F;break;case"video":case"audio":for(Y=0;Y<qS.length;Y++)Qs(qS[Y],f);Y=F;break;case"source":Qs("error",f),Y=F;break;case"img":case"image":case"link":Qs("error",f),Qs("load",f),Y=F;break;case"details":Qs("toggle",f),Y=F;break;case"input":kt(f,F),Y=Lt(f,F),Qs("invalid",f);break;case"option":Y=F;break;case"select":f._wrapperState={wasMultiple:!!F.multiple},Y=be({},F,{value:void 0}),Qs("invalid",f);break;case"textarea":tn(f,F),Y=fn(f,F),Qs("invalid",f);break;default:Y=F}e7(C,Y),Le=Y;for(ne in Le)if(Le.hasOwnProperty(ne)){var Je=Le[ne];ne==="style"?J6(f,Je):ne==="dangerouslySetInnerHTML"?(Je=Je?Je.__html:void 0,Je!=null&&i3(f,Je)):ne==="children"?typeof Je=="string"?(C!=="textarea"||Je!=="")&&F0(f,Je):typeof Je=="number"&&F0(f,""+Je):ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&ne!=="autoFocus"&&(b.hasOwnProperty(ne)?Je!=null&&ne==="onScroll"&&Qs("scroll",f):Je!=null&&pe(f,ne,Je,ve))}switch(C){case"input":Tr(f),ct(f,F,!1);break;case"textarea":Tr(f),xr(f);break;case"option":F.value!=null&&f.setAttribute("value",""+Nn(F.value));break;case"select":f.multiple=!!F.multiple,ne=F.value,ne!=null?wt(f,!!F.multiple,ne,!1):F.defaultValue!=null&&wt(f,!!F.multiple,F.defaultValue,!0);break;default:typeof Y.onClick=="function"&&(f.onclick=pP)}switch(C){case"button":case"input":case"select":case"textarea":F=!!F.autoFocus;break e;case"img":F=!0;break e;default:F=!1}}F&&(v.flags|=4)}v.ref!==null&&(v.flags|=512,v.flags|=2097152)}return B0(v),null;case 6:if(f&&v.stateNode!=null)hpe(f,v,f.memoizedProps,F);else{if(typeof F!="string"&&v.stateNode===null)throw Error(m(166));if(C=D8(tw.current),D8(Wp.current),bP(v)){if(F=v.stateNode,C=v.memoizedProps,F[jp]=v,(ne=F.nodeValue!==C)&&(f=yc,f!==null))switch(f.tag){case 3:fP(F.nodeValue,C,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&fP(F.nodeValue,C,(f.mode&1)!==0)}ne&&(v.flags|=4)}else F=(C.nodeType===9?C:C.ownerDocument).createTextNode(F),F[jp]=v,v.stateNode=F}return B0(v),null;case 13:if(Js(ga),F=v.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(sa&&_c!==null&&v.mode&1&&!(v.flags&128))ffe(),m7(),v.flags|=98560,ne=!1;else if(ne=bP(v),F!==null&&F.dehydrated!==null){if(f===null){if(!ne)throw Error(m(318));if(ne=v.memoizedState,ne=ne!==null?ne.dehydrated:null,!ne)throw Error(m(317));ne[jp]=v}else m7(),!(v.flags&128)&&(v.memoizedState=null),v.flags|=4;B0(v),ne=!1}else tf!==null&&(nz(tf),tf=null),ne=!0;if(!ne)return v.flags&65536?v:null}return v.flags&128?(v.lanes=C,v):(F=F!==null,F!==(f!==null&&f.memoizedState!==null)&&F&&(v.child.flags|=8192,v.mode&1&&(f===null||ga.current&1?yo===0&&(yo=3):sz())),v.updateQueue!==null&&(v.flags|=4),B0(v),null);case 4:return _7(),$B(f,v),f===null&&XS(v.stateNode.containerInfo),B0(v),null;case 10:return xB(v.type._context),B0(v),null;case 17:return bu(v.type)&&gP(),B0(v),null;case 19:if(Js(ga),ne=v.memoizedState,ne===null)return B0(v),null;if(F=(v.flags&128)!==0,ve=ne.rendering,ve===null)if(F)aw(ne,!1);else{if(yo!==0||f!==null&&f.flags&128)for(f=v.child;f!==null;){if(ve=AP(f),ve!==null){for(v.flags|=128,aw(ne,!1),F=ve.updateQueue,F!==null&&(v.updateQueue=F,v.flags|=4),v.subtreeFlags=0,F=C,C=v.child;C!==null;)ne=C,f=F,ne.flags&=14680066,ve=ne.alternate,ve===null?(ne.childLanes=0,ne.lanes=f,ne.child=null,ne.subtreeFlags=0,ne.memoizedProps=null,ne.memoizedState=null,ne.updateQueue=null,ne.dependencies=null,ne.stateNode=null):(ne.childLanes=ve.childLanes,ne.lanes=ve.lanes,ne.child=ve.child,ne.subtreeFlags=0,ne.deletions=null,ne.memoizedProps=ve.memoizedProps,ne.memoizedState=ve.memoizedState,ne.updateQueue=ve.updateQueue,ne.type=ve.type,f=ve.dependencies,ne.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),C=C.sibling;return Fs(ga,ga.current&1|2),v.child}f=f.sibling}ne.tail!==null&&Va()>w7&&(v.flags|=128,F=!0,aw(ne,!1),v.lanes=4194304)}else{if(!F)if(f=AP(ve),f!==null){if(v.flags|=128,F=!0,C=f.updateQueue,C!==null&&(v.updateQueue=C,v.flags|=4),aw(ne,!0),ne.tail===null&&ne.tailMode==="hidden"&&!ve.alternate&&!sa)return B0(v),null}else 2*Va()-ne.renderingStartTime>w7&&C!==1073741824&&(v.flags|=128,F=!0,aw(ne,!1),v.lanes=4194304);ne.isBackwards?(ve.sibling=v.child,v.child=ve):(C=ne.last,C!==null?C.sibling=ve:v.child=ve,ne.last=ve)}return ne.tail!==null?(v=ne.tail,ne.rendering=v,ne.tail=v.sibling,ne.renderingStartTime=Va(),v.sibling=null,C=ga.current,Fs(ga,F?C&1|2:C&1),v):(B0(v),null);case 22:case 23:return iz(),F=v.memoizedState!==null,f!==null&&f.memoizedState!==null!==F&&(v.flags|=8192),F&&v.mode&1?xc&1073741824&&(B0(v),v.subtreeFlags&6&&(v.flags|=8192)):B0(v),null;case 24:return null;case 25:return null}throw Error(m(156,v.tag))}function LEe(f,v){switch(pB(v),v.tag){case 1:return bu(v.type)&&gP(),f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 3:return _7(),Js(xu),Js(L0),PB(),f=v.flags,f&65536&&!(f&128)?(v.flags=f&-65537|128,v):null;case 5:return CB(v),null;case 13:if(Js(ga),f=v.memoizedState,f!==null&&f.dehydrated!==null){if(v.alternate===null)throw Error(m(340));m7()}return f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 19:return Js(ga),null;case 4:return _7(),null;case 10:return xB(v.type._context),null;case 22:case 23:return iz(),null;case 24:return null;default:return null}}var FP=!1,z0=!1,UEe=typeof WeakSet=="function"?WeakSet:Set,sr=null;function b7(f,v){var C=f.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(F){Ra(f,v,F)}else C.current=null}function dpe(f,v,C){try{C()}catch(F){Ra(f,v,F)}}var fpe=!1;function BEe(f,v){if(sB=JA,f=Vde(),JU(f)){if("selectionStart"in f)var C={start:f.selectionStart,end:f.selectionEnd};else e:{C=(C=f.ownerDocument)&&C.defaultView||window;var F=C.getSelection&&C.getSelection();if(F&&F.rangeCount!==0){C=F.anchorNode;var Y=F.anchorOffset,ne=F.focusNode;F=F.focusOffset;try{C.nodeType,ne.nodeType}catch{C=null;break e}var ve=0,Le=-1,Je=-1,Ut=0,_n=0,Sn=f,pn=null;t:for(;;){for(var Jn;Sn!==C||Y!==0&&Sn.nodeType!==3||(Le=ve+Y),Sn!==ne||F!==0&&Sn.nodeType!==3||(Je=ve+F),Sn.nodeType===3&&(ve+=Sn.nodeValue.length),(Jn=Sn.firstChild)!==null;)pn=Sn,Sn=Jn;for(;;){if(Sn===f)break t;if(pn===C&&++Ut===Y&&(Le=ve),pn===ne&&++_n===F&&(Je=ve),(Jn=Sn.nextSibling)!==null)break;Sn=pn,pn=Sn.parentNode}Sn=Jn}C=Le===-1||Je===-1?null:{start:Le,end:Je}}else C=null}C=C||{start:0,end:0}}else C=null;for(aB={focusedElem:f,selectionRange:C},JA=!1,sr=v;sr!==null;)if(v=sr,f=v.child,(v.subtreeFlags&1028)!==0&&f!==null)f.return=v,sr=f;else for(;sr!==null;){v=sr;try{var dr=v.alternate;if(v.flags&1024)switch(v.tag){case 0:case 11:case 15:break;case 1:if(dr!==null){var mr=dr.memoizedProps,Ga=dr.memoizedState,Et=v.stateNode,it=Et.getSnapshotBeforeUpdate(v.elementType===v.type?mr:nf(v.type,mr),Ga);Et.__reactInternalSnapshotBeforeUpdate=it}break;case 3:var Rt=v.stateNode.containerInfo;Rt.nodeType===1?Rt.textContent="":Rt.nodeType===9&&Rt.documentElement&&Rt.removeChild(Rt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(m(163))}}catch(Cn){Ra(v,v.return,Cn)}if(f=v.sibling,f!==null){f.return=v.return,sr=f;break}sr=v.return}return dr=fpe,fpe=!1,dr}function ow(f,v,C){var F=v.updateQueue;if(F=F!==null?F.lastEffect:null,F!==null){var Y=F=F.next;do{if((Y.tag&f)===f){var ne=Y.destroy;Y.destroy=void 0,ne!==void 0&&dpe(v,C,ne)}Y=Y.next}while(Y!==F)}}function LP(f,v){if(v=v.updateQueue,v=v!==null?v.lastEffect:null,v!==null){var C=v=v.next;do{if((C.tag&f)===f){var F=C.create;C.destroy=F()}C=C.next}while(C!==v)}}function qB(f){var v=f.ref;if(v!==null){var C=f.stateNode;switch(f.tag){case 5:f=C;break;default:f=C}typeof v=="function"?v(f):v.current=f}}function ppe(f){var v=f.alternate;v!==null&&(f.alternate=null,ppe(v)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(v=f.stateNode,v!==null&&(delete v[jp],delete v[KS],delete v[cB],delete v[bEe],delete v[SEe])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function mpe(f){return f.tag===5||f.tag===3||f.tag===4}function gpe(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||mpe(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function XB(f,v,C){var F=f.tag;if(F===5||F===6)f=f.stateNode,v?C.nodeType===8?C.parentNode.insertBefore(f,v):C.insertBefore(f,v):(C.nodeType===8?(v=C.parentNode,v.insertBefore(f,C)):(v=C,v.appendChild(f)),C=C._reactRootContainer,C!=null||v.onclick!==null||(v.onclick=pP));else if(F!==4&&(f=f.child,f!==null))for(XB(f,v,C),f=f.sibling;f!==null;)XB(f,v,C),f=f.sibling}function YB(f,v,C){var F=f.tag;if(F===5||F===6)f=f.stateNode,v?C.insertBefore(f,v):C.appendChild(f);else if(F!==4&&(f=f.child,f!==null))for(YB(f,v,C),f=f.sibling;f!==null;)YB(f,v,C),f=f.sibling}var f0=null,rf=!1;function v3(f,v,C){for(C=C.child;C!==null;)vpe(f,v,C),C=C.sibling}function vpe(f,v,C){if(Hp&&typeof Hp.onCommitFiberUnmount=="function")try{Hp.onCommitFiberUnmount(qA,C)}catch{}switch(C.tag){case 5:z0||b7(C,v);case 6:var F=f0,Y=rf;f0=null,v3(f,v,C),f0=F,rf=Y,f0!==null&&(rf?(f=f0,C=C.stateNode,f.nodeType===8?f.parentNode.removeChild(C):f.removeChild(C)):f0.removeChild(C.stateNode));break;case 18:f0!==null&&(rf?(f=f0,C=C.stateNode,f.nodeType===8?uB(f.parentNode,C):f.nodeType===1&&uB(f,C),BS(f)):uB(f0,C.stateNode));break;case 4:F=f0,Y=rf,f0=C.stateNode.containerInfo,rf=!0,v3(f,v,C),f0=F,rf=Y;break;case 0:case 11:case 14:case 15:if(!z0&&(F=C.updateQueue,F!==null&&(F=F.lastEffect,F!==null))){Y=F=F.next;do{var ne=Y,ve=ne.destroy;ne=ne.tag,ve!==void 0&&(ne&2||ne&4)&&dpe(C,v,ve),Y=Y.next}while(Y!==F)}v3(f,v,C);break;case 1:if(!z0&&(b7(C,v),F=C.stateNode,typeof F.componentWillUnmount=="function"))try{F.props=C.memoizedProps,F.state=C.memoizedState,F.componentWillUnmount()}catch(Le){Ra(C,v,Le)}v3(f,v,C);break;case 21:v3(f,v,C);break;case 22:C.mode&1?(z0=(F=z0)||C.memoizedState!==null,v3(f,v,C),z0=F):v3(f,v,C);break;default:v3(f,v,C)}}function ype(f){var v=f.updateQueue;if(v!==null){f.updateQueue=null;var C=f.stateNode;C===null&&(C=f.stateNode=new UEe),v.forEach(function(F){var Y=XEe.bind(null,f,F);C.has(F)||(C.add(F),F.then(Y,Y))})}}function sf(f,v){var C=v.deletions;if(C!==null)for(var F=0;F<C.length;F++){var Y=C[F];try{var ne=f,ve=v,Le=ve;e:for(;Le!==null;){switch(Le.tag){case 5:f0=Le.stateNode,rf=!1;break e;case 3:f0=Le.stateNode.containerInfo,rf=!0;break e;case 4:f0=Le.stateNode.containerInfo,rf=!0;break e}Le=Le.return}if(f0===null)throw Error(m(160));vpe(ne,ve,Y),f0=null,rf=!1;var Je=Y.alternate;Je!==null&&(Je.return=null),Y.return=null}catch(Ut){Ra(Y,v,Ut)}}if(v.subtreeFlags&12854)for(v=v.child;v!==null;)_pe(v,f),v=v.sibling}function _pe(f,v){var C=f.alternate,F=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(sf(v,f),qp(f),F&4){try{ow(3,f,f.return),LP(3,f)}catch(mr){Ra(f,f.return,mr)}try{ow(5,f,f.return)}catch(mr){Ra(f,f.return,mr)}}break;case 1:sf(v,f),qp(f),F&512&&C!==null&&b7(C,C.return);break;case 5:if(sf(v,f),qp(f),F&512&&C!==null&&b7(C,C.return),f.flags&32){var Y=f.stateNode;try{F0(Y,"")}catch(mr){Ra(f,f.return,mr)}}if(F&4&&(Y=f.stateNode,Y!=null)){var ne=f.memoizedProps,ve=C!==null?C.memoizedProps:ne,Le=f.type,Je=f.updateQueue;if(f.updateQueue=null,Je!==null)try{Le==="input"&&ne.type==="radio"&&ne.name!=null&&Ie(Y,ne),AS(Le,ve);var Ut=AS(Le,ne);for(ve=0;ve<Je.length;ve+=2){var _n=Je[ve],Sn=Je[ve+1];_n==="style"?J6(Y,Sn):_n==="dangerouslySetInnerHTML"?i3(Y,Sn):_n==="children"?F0(Y,Sn):pe(Y,_n,Sn,Ut)}switch(Le){case"input":Re(Y,ne);break;case"textarea":sn(Y,ne);break;case"select":var pn=Y._wrapperState.wasMultiple;Y._wrapperState.wasMultiple=!!ne.multiple;var Jn=ne.value;Jn!=null?wt(Y,!!ne.multiple,Jn,!1):pn!==!!ne.multiple&&(ne.defaultValue!=null?wt(Y,!!ne.multiple,ne.defaultValue,!0):wt(Y,!!ne.multiple,ne.multiple?[]:"",!1))}Y[KS]=ne}catch(mr){Ra(f,f.return,mr)}}break;case 6:if(sf(v,f),qp(f),F&4){if(f.stateNode===null)throw Error(m(162));Y=f.stateNode,ne=f.memoizedProps;try{Y.nodeValue=ne}catch(mr){Ra(f,f.return,mr)}}break;case 3:if(sf(v,f),qp(f),F&4&&C!==null&&C.memoizedState.isDehydrated)try{BS(v.containerInfo)}catch(mr){Ra(f,f.return,mr)}break;case 4:sf(v,f),qp(f);break;case 13:sf(v,f),qp(f),Y=f.child,Y.flags&8192&&(ne=Y.memoizedState!==null,Y.stateNode.isHidden=ne,!ne||Y.alternate!==null&&Y.alternate.memoizedState!==null||(QB=Va())),F&4&&ype(f);break;case 22:if(_n=C!==null&&C.memoizedState!==null,f.mode&1?(z0=(Ut=z0)||_n,sf(v,f),z0=Ut):sf(v,f),qp(f),F&8192){if(Ut=f.memoizedState!==null,(f.stateNode.isHidden=Ut)&&!_n&&f.mode&1)for(sr=f,_n=f.child;_n!==null;){for(Sn=sr=_n;sr!==null;){switch(pn=sr,Jn=pn.child,pn.tag){case 0:case 11:case 14:case 15:ow(4,pn,pn.return);break;case 1:b7(pn,pn.return);var dr=pn.stateNode;if(typeof dr.componentWillUnmount=="function"){F=pn,C=pn.return;try{v=F,dr.props=v.memoizedProps,dr.state=v.memoizedState,dr.componentWillUnmount()}catch(mr){Ra(F,C,mr)}}break;case 5:b7(pn,pn.return);break;case 22:if(pn.memoizedState!==null){Spe(Sn);continue}}Jn!==null?(Jn.return=pn,sr=Jn):Spe(Sn)}_n=_n.sibling}e:for(_n=null,Sn=f;;){if(Sn.tag===5){if(_n===null){_n=Sn;try{Y=Sn.stateNode,Ut?(ne=Y.style,typeof ne.setProperty=="function"?ne.setProperty("display","none","important"):ne.display="none"):(Le=Sn.stateNode,Je=Sn.memoizedProps.style,ve=Je!=null&&Je.hasOwnProperty("display")?Je.display:null,Le.style.display=C8("display",ve))}catch(mr){Ra(f,f.return,mr)}}}else if(Sn.tag===6){if(_n===null)try{Sn.stateNode.nodeValue=Ut?"":Sn.memoizedProps}catch(mr){Ra(f,f.return,mr)}}else if((Sn.tag!==22&&Sn.tag!==23||Sn.memoizedState===null||Sn===f)&&Sn.child!==null){Sn.child.return=Sn,Sn=Sn.child;continue}if(Sn===f)break e;for(;Sn.sibling===null;){if(Sn.return===null||Sn.return===f)break e;_n===Sn&&(_n=null),Sn=Sn.return}_n===Sn&&(_n=null),Sn.sibling.return=Sn.return,Sn=Sn.sibling}}break;case 19:sf(v,f),qp(f),F&4&&ype(f);break;case 21:break;default:sf(v,f),qp(f)}}function qp(f){var v=f.flags;if(v&2){try{e:{for(var C=f.return;C!==null;){if(mpe(C)){var F=C;break e}C=C.return}throw Error(m(160))}switch(F.tag){case 5:var Y=F.stateNode;F.flags&32&&(F0(Y,""),F.flags&=-33);var ne=gpe(f);YB(f,ne,Y);break;case 3:case 4:var ve=F.stateNode.containerInfo,Le=gpe(f);XB(f,Le,ve);break;default:throw Error(m(161))}}catch(Je){Ra(f,f.return,Je)}f.flags&=-3}v&4096&&(f.flags&=-4097)}function zEe(f,v,C){sr=f,xpe(f)}function xpe(f,v,C){for(var F=(f.mode&1)!==0;sr!==null;){var Y=sr,ne=Y.child;if(Y.tag===22&&F){var ve=Y.memoizedState!==null||FP;if(!ve){var Le=Y.alternate,Je=Le!==null&&Le.memoizedState!==null||z0;Le=FP;var Ut=z0;if(FP=ve,(z0=Je)&&!Ut)for(sr=Y;sr!==null;)ve=sr,Je=ve.child,ve.tag===22&&ve.memoizedState!==null?wpe(Y):Je!==null?(Je.return=ve,sr=Je):wpe(Y);for(;ne!==null;)sr=ne,xpe(ne),ne=ne.sibling;sr=Y,FP=Le,z0=Ut}bpe(f)}else Y.subtreeFlags&8772&&ne!==null?(ne.return=Y,sr=ne):bpe(f)}}function bpe(f){for(;sr!==null;){var v=sr;if(v.flags&8772){var C=v.alternate;try{if(v.flags&8772)switch(v.tag){case 0:case 11:case 15:z0||LP(5,v);break;case 1:var F=v.stateNode;if(v.flags&4&&!z0)if(C===null)F.componentDidMount();else{var Y=v.elementType===v.type?C.memoizedProps:nf(v.type,C.memoizedProps);F.componentDidUpdate(Y,C.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var ne=v.updateQueue;ne!==null&&vfe(v,ne,F);break;case 3:var ve=v.updateQueue;if(ve!==null){if(C=null,v.child!==null)switch(v.child.tag){case 5:C=v.child.stateNode;break;case 1:C=v.child.stateNode}vfe(v,ve,C)}break;case 5:var Le=v.stateNode;if(C===null&&v.flags&4){C=Le;var Je=v.memoizedProps;switch(v.type){case"button":case"input":case"select":case"textarea":Je.autoFocus&&C.focus();break;case"img":Je.src&&(C.src=Je.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(v.memoizedState===null){var Ut=v.alternate;if(Ut!==null){var _n=Ut.memoizedState;if(_n!==null){var Sn=_n.dehydrated;Sn!==null&&BS(Sn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(m(163))}z0||v.flags&512&&qB(v)}catch(pn){Ra(v,v.return,pn)}}if(v===f){sr=null;break}if(C=v.sibling,C!==null){C.return=v.return,sr=C;break}sr=v.return}}function Spe(f){for(;sr!==null;){var v=sr;if(v===f){sr=null;break}var C=v.sibling;if(C!==null){C.return=v.return,sr=C;break}sr=v.return}}function wpe(f){for(;sr!==null;){var v=sr;try{switch(v.tag){case 0:case 11:case 15:var C=v.return;try{LP(4,v)}catch(Je){Ra(v,C,Je)}break;case 1:var F=v.stateNode;if(typeof F.componentDidMount=="function"){var Y=v.return;try{F.componentDidMount()}catch(Je){Ra(v,Y,Je)}}var ne=v.return;try{qB(v)}catch(Je){Ra(v,ne,Je)}break;case 5:var ve=v.return;try{qB(v)}catch(Je){Ra(v,ve,Je)}}}catch(Je){Ra(v,v.return,Je)}if(v===f){sr=null;break}var Le=v.sibling;if(Le!==null){Le.return=v.return,sr=Le;break}sr=v.return}}var VEe=Math.ceil,UP=fe.ReactCurrentDispatcher,KB=fe.ReactCurrentOwner,Ah=fe.ReactCurrentBatchConfig,Vi=0,Lo=null,to=null,p0=0,xc=0,S7=d3(0),yo=0,lw=null,F8=0,BP=0,ZB=0,uw=null,wu=null,QB=0,w7=1/0,lg=null,zP=!1,JB=null,y3=null,VP=!1,_3=null,GP=0,cw=0,ez=null,HP=-1,jP=0;function kl(){return Vi&6?Va():HP!==-1?HP:HP=Va()}function x3(f){return f.mode&1?Vi&2&&p0!==0?p0&-p0:EEe.transition!==null?(jP===0&&(jP=fde()),jP):(f=fs,f!==0||(f=window.event,f=f===void 0?16:Sde(f.type)),f):1}function af(f,v,C,F){if(50<cw)throw cw=0,ez=null,Error(m(185));DS(f,C,F),(!(Vi&2)||f!==Lo)&&(f===Lo&&(!(Vi&2)&&(BP|=C),yo===4&&b3(f,p0)),Eu(f,F),C===1&&Vi===0&&!(v.mode&1)&&(w7=Va()+500,yP&&p3()))}function Eu(f,v){var C=f.callbackNode;Mwe(f,v);var F=KA(f,f===Lo?p0:0);if(F===0)C!==null&&cde(C),f.callbackNode=null,f.callbackPriority=0;else if(v=F&-F,f.callbackPriority!==v){if(C!=null&&cde(C),v===1)f.tag===0?wEe(Tpe.bind(null,f)):lfe(Tpe.bind(null,f)),_Ee(function(){!(Vi&6)&&p3()}),C=null;else{switch(pde(F)){case 1:C=FU;break;case 4:C=hde;break;case 16:C=$A;break;case 536870912:C=dde;break;default:C=$A}C=Npe(C,Epe.bind(null,f))}f.callbackPriority=v,f.callbackNode=C}}function Epe(f,v){if(HP=-1,jP=0,Vi&6)throw Error(m(327));var C=f.callbackNode;if(E7()&&f.callbackNode!==C)return null;var F=KA(f,f===Lo?p0:0);if(F===0)return null;if(F&30||F&f.expiredLanes||v)v=WP(f,F);else{v=F;var Y=Vi;Vi|=2;var ne=Cpe();(Lo!==f||p0!==v)&&(lg=null,w7=Va()+500,U8(f,v));do try{jEe();break}catch(Le){Mpe(f,Le)}while(!0);_B(),UP.current=ne,Vi=Y,to!==null?v=0:(Lo=null,p0=0,v=yo)}if(v!==0){if(v===2&&(Y=LU(f),Y!==0&&(F=Y,v=tz(f,Y))),v===1)throw C=lw,U8(f,0),b3(f,F),Eu(f,Va()),C;if(v===6)b3(f,F);else{if(Y=f.current.alternate,!(F&30)&&!GEe(Y)&&(v=WP(f,F),v===2&&(ne=LU(f),ne!==0&&(F=ne,v=tz(f,ne))),v===1))throw C=lw,U8(f,0),b3(f,F),Eu(f,Va()),C;switch(f.finishedWork=Y,f.finishedLanes=F,v){case 0:case 1:throw Error(m(345));case 2:B8(f,wu,lg);break;case 3:if(b3(f,F),(F&130023424)===F&&(v=QB+500-Va(),10<v)){if(KA(f,0)!==0)break;if(Y=f.suspendedLanes,(Y&F)!==F){kl(),f.pingedLanes|=f.suspendedLanes&Y;break}f.timeoutHandle=lB(B8.bind(null,f,wu,lg),v);break}B8(f,wu,lg);break;case 4:if(b3(f,F),(F&4194240)===F)break;for(v=f.eventTimes,Y=-1;0<F;){var ve=31-Jd(F);ne=1<<ve,ve=v[ve],ve>Y&&(Y=ve),F&=~ne}if(F=Y,F=Va()-F,F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3e3>F?3e3:4320>F?4320:1960*VEe(F/1960))-F,10<F){f.timeoutHandle=lB(B8.bind(null,f,wu,lg),F);break}B8(f,wu,lg);break;case 5:B8(f,wu,lg);break;default:throw Error(m(329))}}}return Eu(f,Va()),f.callbackNode===C?Epe.bind(null,f):null}function tz(f,v){var C=uw;return f.current.memoizedState.isDehydrated&&(U8(f,v).flags|=256),f=WP(f,v),f!==2&&(v=wu,wu=C,v!==null&&nz(v)),f}function nz(f){wu===null?wu=f:wu.push.apply(wu,f)}function GEe(f){for(var v=f;;){if(v.flags&16384){var C=v.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var F=0;F<C.length;F++){var Y=C[F],ne=Y.getSnapshot;Y=Y.value;try{if(!ef(ne(),Y))return!1}catch{return!1}}}if(C=v.child,v.subtreeFlags&16384&&C!==null)C.return=v,v=C;else{if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function b3(f,v){for(v&=~ZB,v&=~BP,f.suspendedLanes|=v,f.pingedLanes&=~v,f=f.expirationTimes;0<v;){var C=31-Jd(v),F=1<<C;f[C]=-1,v&=~F}}function Tpe(f){if(Vi&6)throw Error(m(327));E7();var v=KA(f,0);if(!(v&1))return Eu(f,Va()),null;var C=WP(f,v);if(f.tag!==0&&C===2){var F=LU(f);F!==0&&(v=F,C=tz(f,F))}if(C===1)throw C=lw,U8(f,0),b3(f,v),Eu(f,Va()),C;if(C===6)throw Error(m(345));return f.finishedWork=f.current.alternate,f.finishedLanes=v,B8(f,wu,lg),Eu(f,Va()),null}function rz(f,v){var C=Vi;Vi|=1;try{return f(v)}finally{Vi=C,Vi===0&&(w7=Va()+500,yP&&p3())}}function L8(f){_3!==null&&_3.tag===0&&!(Vi&6)&&E7();var v=Vi;Vi|=1;var C=Ah.transition,F=fs;try{if(Ah.transition=null,fs=1,f)return f()}finally{fs=F,Ah.transition=C,Vi=v,!(Vi&6)&&p3()}}function iz(){xc=S7.current,Js(S7)}function U8(f,v){f.finishedWork=null,f.finishedLanes=0;var C=f.timeoutHandle;if(C!==-1&&(f.timeoutHandle=-1,yEe(C)),to!==null)for(C=to.return;C!==null;){var F=C;switch(pB(F),F.tag){case 1:F=F.type.childContextTypes,F!=null&&gP();break;case 3:_7(),Js(xu),Js(L0),PB();break;case 5:CB(F);break;case 4:_7();break;case 13:Js(ga);break;case 19:Js(ga);break;case 10:xB(F.type._context);break;case 22:case 23:iz()}C=C.return}if(Lo=f,to=f=S3(f.current,null),p0=xc=v,yo=0,lw=null,ZB=BP=F8=0,wu=uw=null,N8!==null){for(v=0;v<N8.length;v++)if(C=N8[v],F=C.interleaved,F!==null){C.interleaved=null;var Y=F.next,ne=C.pending;if(ne!==null){var ve=ne.next;ne.next=Y,F.next=ve}C.pending=F}N8=null}return f}function Mpe(f,v){do{var C=to;try{if(_B(),PP.current=NP,RP){for(var F=va.memoizedState;F!==null;){var Y=F.queue;Y!==null&&(Y.pending=null),F=F.next}RP=!1}if(O8=0,Fo=vo=va=null,nw=!1,rw=0,KB.current=null,C===null||C.return===null){yo=1,lw=v,to=null;break}e:{var ne=f,ve=C.return,Le=C,Je=v;if(v=p0,Le.flags|=32768,Je!==null&&typeof Je=="object"&&typeof Je.then=="function"){var Ut=Je,_n=Le,Sn=_n.tag;if(!(_n.mode&1)&&(Sn===0||Sn===11||Sn===15)){var pn=_n.alternate;pn?(_n.updateQueue=pn.updateQueue,_n.memoizedState=pn.memoizedState,_n.lanes=pn.lanes):(_n.updateQueue=null,_n.memoizedState=null)}var Jn=Kfe(ve);if(Jn!==null){Jn.flags&=-257,Zfe(Jn,ve,Le,ne,v),Jn.mode&1&&Yfe(ne,Ut,v),v=Jn,Je=Ut;var dr=v.updateQueue;if(dr===null){var mr=new Set;mr.add(Je),v.updateQueue=mr}else dr.add(Je);break e}else{if(!(v&1)){Yfe(ne,Ut,v),sz();break e}Je=Error(m(426))}}else if(sa&&Le.mode&1){var Ga=Kfe(ve);if(Ga!==null){!(Ga.flags&65536)&&(Ga.flags|=256),Zfe(Ga,ve,Le,ne,v),vB(x7(Je,Le));break e}}ne=Je=x7(Je,Le),yo!==4&&(yo=2),uw===null?uw=[ne]:uw.push(ne),ne=ve;do{switch(ne.tag){case 3:ne.flags|=65536,v&=-v,ne.lanes|=v;var Et=qfe(ne,Je,v);gfe(ne,Et);break e;case 1:Le=Je;var it=ne.type,Rt=ne.stateNode;if(!(ne.flags&128)&&(typeof it.getDerivedStateFromError=="function"||Rt!==null&&typeof Rt.componentDidCatch=="function"&&(y3===null||!y3.has(Rt)))){ne.flags|=65536,v&=-v,ne.lanes|=v;var Cn=Xfe(ne,Le,v);gfe(ne,Cn);break e}}ne=ne.return}while(ne!==null)}Ppe(C)}catch(_r){v=_r,to===C&&C!==null&&(to=C=C.return);continue}break}while(!0)}function Cpe(){var f=UP.current;return UP.current=NP,f===null?NP:f}function sz(){(yo===0||yo===3||yo===2)&&(yo=4),Lo===null||!(F8&268435455)&&!(BP&268435455)||b3(Lo,p0)}function WP(f,v){var C=Vi;Vi|=2;var F=Cpe();(Lo!==f||p0!==v)&&(lg=null,U8(f,v));do try{HEe();break}catch(Y){Mpe(f,Y)}while(!0);if(_B(),Vi=C,UP.current=F,to!==null)throw Error(m(261));return Lo=null,p0=0,yo}function HEe(){for(;to!==null;)Ape(to)}function jEe(){for(;to!==null&&!vwe();)Ape(to)}function Ape(f){var v=kpe(f.alternate,f,xc);f.memoizedProps=f.pendingProps,v===null?Ppe(f):to=v,KB.current=null}function Ppe(f){var v=f;do{var C=v.alternate;if(f=v.return,v.flags&32768){if(C=LEe(C,v),C!==null){C.flags&=32767,to=C;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{yo=6,to=null;return}}else if(C=FEe(C,v,xc),C!==null){to=C;return}if(v=v.sibling,v!==null){to=v;return}to=v=f}while(v!==null);yo===0&&(yo=5)}function B8(f,v,C){var F=fs,Y=Ah.transition;try{Ah.transition=null,fs=1,WEe(f,v,C,F)}finally{Ah.transition=Y,fs=F}return null}function WEe(f,v,C,F){do E7();while(_3!==null);if(Vi&6)throw Error(m(327));C=f.finishedWork;var Y=f.finishedLanes;if(C===null)return null;if(f.finishedWork=null,f.finishedLanes=0,C===f.current)throw Error(m(177));f.callbackNode=null,f.callbackPriority=0;var ne=C.lanes|C.childLanes;if(Cwe(f,ne),f===Lo&&(to=Lo=null,p0=0),!(C.subtreeFlags&2064)&&!(C.flags&2064)||VP||(VP=!0,Npe($A,function(){return E7(),null})),ne=(C.flags&15990)!==0,C.subtreeFlags&15990||ne){ne=Ah.transition,Ah.transition=null;var ve=fs;fs=1;var Le=Vi;Vi|=4,KB.current=null,BEe(f,C),_pe(C,f),fEe(aB),JA=!!sB,aB=sB=null,f.current=C,zEe(C),ywe(),Vi=Le,fs=ve,Ah.transition=ne}else f.current=C;if(VP&&(VP=!1,_3=f,GP=Y),ne=f.pendingLanes,ne===0&&(y3=null),bwe(C.stateNode),Eu(f,Va()),v!==null)for(F=f.onRecoverableError,C=0;C<v.length;C++)Y=v[C],F(Y.value,{componentStack:Y.stack,digest:Y.digest});if(zP)throw zP=!1,f=JB,JB=null,f;return GP&1&&f.tag!==0&&E7(),ne=f.pendingLanes,ne&1?f===ez?cw++:(cw=0,ez=f):cw=0,p3(),null}function E7(){if(_3!==null){var f=pde(GP),v=Ah.transition,C=fs;try{if(Ah.transition=null,fs=16>f?16:f,_3===null)var F=!1;else{if(f=_3,_3=null,GP=0,Vi&6)throw Error(m(331));var Y=Vi;for(Vi|=4,sr=f.current;sr!==null;){var ne=sr,ve=ne.child;if(sr.flags&16){var Le=ne.deletions;if(Le!==null){for(var Je=0;Je<Le.length;Je++){var Ut=Le[Je];for(sr=Ut;sr!==null;){var _n=sr;switch(_n.tag){case 0:case 11:case 15:ow(8,_n,ne)}var Sn=_n.child;if(Sn!==null)Sn.return=_n,sr=Sn;else for(;sr!==null;){_n=sr;var pn=_n.sibling,Jn=_n.return;if(ppe(_n),_n===Ut){sr=null;break}if(pn!==null){pn.return=Jn,sr=pn;break}sr=Jn}}}var dr=ne.alternate;if(dr!==null){var mr=dr.child;if(mr!==null){dr.child=null;do{var Ga=mr.sibling;mr.sibling=null,mr=Ga}while(mr!==null)}}sr=ne}}if(ne.subtreeFlags&2064&&ve!==null)ve.return=ne,sr=ve;else e:for(;sr!==null;){if(ne=sr,ne.flags&2048)switch(ne.tag){case 0:case 11:case 15:ow(9,ne,ne.return)}var Et=ne.sibling;if(Et!==null){Et.return=ne.return,sr=Et;break e}sr=ne.return}}var it=f.current;for(sr=it;sr!==null;){ve=sr;var Rt=ve.child;if(ve.subtreeFlags&2064&&Rt!==null)Rt.return=ve,sr=Rt;else e:for(ve=it;sr!==null;){if(Le=sr,Le.flags&2048)try{switch(Le.tag){case 0:case 11:case 15:LP(9,Le)}}catch(_r){Ra(Le,Le.return,_r)}if(Le===ve){sr=null;break e}var Cn=Le.sibling;if(Cn!==null){Cn.return=Le.return,sr=Cn;break e}sr=Le.return}}if(Vi=Y,p3(),Hp&&typeof Hp.onPostCommitFiberRoot=="function")try{Hp.onPostCommitFiberRoot(qA,f)}catch{}F=!0}return F}finally{fs=C,Ah.transition=v}}return!1}function Rpe(f,v,C){v=x7(C,v),v=qfe(f,v,1),f=g3(f,v,1),v=kl(),f!==null&&(DS(f,1,v),Eu(f,v))}function Ra(f,v,C){if(f.tag===3)Rpe(f,f,C);else for(;v!==null;){if(v.tag===3){Rpe(v,f,C);break}else if(v.tag===1){var F=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&(y3===null||!y3.has(F))){f=x7(C,f),f=Xfe(v,f,1),v=g3(v,f,1),f=kl(),v!==null&&(DS(v,1,f),Eu(v,f));break}}v=v.return}}function $Ee(f,v,C){var F=f.pingCache;F!==null&&F.delete(v),v=kl(),f.pingedLanes|=f.suspendedLanes&C,Lo===f&&(p0&C)===C&&(yo===4||yo===3&&(p0&130023424)===p0&&500>Va()-QB?U8(f,0):ZB|=C),Eu(f,v)}function Ipe(f,v){v===0&&(f.mode&1?(v=YA,YA<<=1,!(YA&130023424)&&(YA=4194304)):v=1);var C=kl();f=sg(f,v),f!==null&&(DS(f,v,C),Eu(f,C))}function qEe(f){var v=f.memoizedState,C=0;v!==null&&(C=v.retryLane),Ipe(f,C)}function XEe(f,v){var C=0;switch(f.tag){case 13:var F=f.stateNode,Y=f.memoizedState;Y!==null&&(C=Y.retryLane);break;case 19:F=f.stateNode;break;default:throw Error(m(314))}F!==null&&F.delete(v),Ipe(f,C)}var kpe;kpe=function(f,v,C){if(f!==null)if(f.memoizedProps!==v.pendingProps||xu.current)Su=!0;else{if(!(f.lanes&C)&&!(v.flags&128))return Su=!1,OEe(f,v,C);Su=!!(f.flags&131072)}else Su=!1,sa&&v.flags&1048576&&ufe(v,xP,v.index);switch(v.lanes=0,v.tag){case 2:var F=v.type;OP(f,v),f=v.pendingProps;var Y=d7(v,L0.current);v7(v,C),Y=kB(null,v,F,f,Y,C);var ne=NB();return v.flags|=1,typeof Y=="object"&&Y!==null&&typeof Y.render=="function"&&Y.$$typeof===void 0?(v.tag=1,v.memoizedState=null,v.updateQueue=null,bu(F)?(ne=!0,vP(v)):ne=!1,v.memoizedState=Y.state!==null&&Y.state!==void 0?Y.state:null,wB(v),Y.updater=MP,v.stateNode=Y,Y._reactInternals=v,TB(v,F,f,C),v=VB(null,v,F,!0,ne,C)):(v.tag=0,sa&&ne&&fB(v),Il(null,v,Y,C),v=v.child),v;case 16:F=v.elementType;e:{switch(OP(f,v),f=v.pendingProps,Y=F._init,F=Y(F._payload),v.type=F,Y=v.tag=KEe(F),f=nf(F,f),Y){case 0:v=zB(null,v,F,f,C);break e;case 1:v=rpe(null,v,F,f,C);break e;case 11:v=Qfe(null,v,F,f,C);break e;case 14:v=Jfe(null,v,F,nf(F.type,f),C);break e}throw Error(m(306,F,""))}return v;case 0:return F=v.type,Y=v.pendingProps,Y=v.elementType===F?Y:nf(F,Y),zB(f,v,F,Y,C);case 1:return F=v.type,Y=v.pendingProps,Y=v.elementType===F?Y:nf(F,Y),rpe(f,v,F,Y,C);case 3:e:{if(ipe(v),f===null)throw Error(m(387));F=v.pendingProps,ne=v.memoizedState,Y=ne.element,mfe(f,v),TP(v,F,null,C);var ve=v.memoizedState;if(F=ve.element,ne.isDehydrated)if(ne={element:F,isDehydrated:!1,cache:ve.cache,pendingSuspenseBoundaries:ve.pendingSuspenseBoundaries,transitions:ve.transitions},v.updateQueue.baseState=ne,v.memoizedState=ne,v.flags&256){Y=x7(Error(m(423)),v),v=spe(f,v,F,C,Y);break e}else if(F!==Y){Y=x7(Error(m(424)),v),v=spe(f,v,F,C,Y);break e}else for(_c=h3(v.stateNode.containerInfo.firstChild),yc=v,sa=!0,tf=null,C=Efe(v,null,F,C),v.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(m7(),F===Y){v=og(f,v,C);break e}Il(f,v,F,C)}v=v.child}return v;case 5:return Tfe(v),f===null&&gB(v),F=v.type,Y=v.pendingProps,ne=f!==null?f.memoizedProps:null,ve=Y.children,oB(F,Y)?ve=null:ne!==null&&oB(F,ne)&&(v.flags|=32),npe(f,v),Il(f,v,ve,C),v.child;case 6:return f===null&&gB(v),null;case 13:return ape(f,v,C);case 4:return MB(v,v.stateNode.containerInfo),F=v.pendingProps,f===null?v.child=y7(v,null,F,C):Il(f,v,F,C),v.child;case 11:return F=v.type,Y=v.pendingProps,Y=v.elementType===F?Y:nf(F,Y),Qfe(f,v,F,Y,C);case 7:return Il(f,v,v.pendingProps,C),v.child;case 8:return Il(f,v,v.pendingProps.children,C),v.child;case 12:return Il(f,v,v.pendingProps.children,C),v.child;case 10:e:{if(F=v.type._context,Y=v.pendingProps,ne=v.memoizedProps,ve=Y.value,Fs(SP,F._currentValue),F._currentValue=ve,ne!==null)if(ef(ne.value,ve)){if(ne.children===Y.children&&!xu.current){v=og(f,v,C);break e}}else for(ne=v.child,ne!==null&&(ne.return=v);ne!==null;){var Le=ne.dependencies;if(Le!==null){ve=ne.child;for(var Je=Le.firstContext;Je!==null;){if(Je.context===F){if(ne.tag===1){Je=ag(-1,C&-C),Je.tag=2;var Ut=ne.updateQueue;if(Ut!==null){Ut=Ut.shared;var _n=Ut.pending;_n===null?Je.next=Je:(Je.next=_n.next,_n.next=Je),Ut.pending=Je}}ne.lanes|=C,Je=ne.alternate,Je!==null&&(Je.lanes|=C),bB(ne.return,C,v),Le.lanes|=C;break}Je=Je.next}}else if(ne.tag===10)ve=ne.type===v.type?null:ne.child;else if(ne.tag===18){if(ve=ne.return,ve===null)throw Error(m(341));ve.lanes|=C,Le=ve.alternate,Le!==null&&(Le.lanes|=C),bB(ve,C,v),ve=ne.sibling}else ve=ne.child;if(ve!==null)ve.return=ne;else for(ve=ne;ve!==null;){if(ve===v){ve=null;break}if(ne=ve.sibling,ne!==null){ne.return=ve.return,ve=ne;break}ve=ve.return}ne=ve}Il(f,v,Y.children,C),v=v.child}return v;case 9:return Y=v.type,F=v.pendingProps.children,v7(v,C),Y=Mh(Y),F=F(Y),v.flags|=1,Il(f,v,F,C),v.child;case 14:return F=v.type,Y=nf(F,v.pendingProps),Y=nf(F.type,Y),Jfe(f,v,F,Y,C);case 15:return epe(f,v,v.type,v.pendingProps,C);case 17:return F=v.type,Y=v.pendingProps,Y=v.elementType===F?Y:nf(F,Y),OP(f,v),v.tag=1,bu(F)?(f=!0,vP(v)):f=!1,v7(v,C),xfe(v,F,Y),TB(v,F,Y,C),VB(null,v,F,!0,f,C);case 19:return lpe(f,v,C);case 22:return tpe(f,v,C)}throw Error(m(156,v.tag))};function Npe(f,v){return ude(f,v)}function YEe(f,v,C,F){this.tag=f,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ph(f,v,C,F){return new YEe(f,v,C,F)}function az(f){return f=f.prototype,!(!f||!f.isReactComponent)}function KEe(f){if(typeof f=="function")return az(f)?1:0;if(f!=null){if(f=f.$$typeof,f===We)return 11;if(f===dn)return 14}return 2}function S3(f,v){var C=f.alternate;return C===null?(C=Ph(f.tag,v,f.key,f.mode),C.elementType=f.elementType,C.type=f.type,C.stateNode=f.stateNode,C.alternate=f,f.alternate=C):(C.pendingProps=v,C.type=f.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=f.flags&14680064,C.childLanes=f.childLanes,C.lanes=f.lanes,C.child=f.child,C.memoizedProps=f.memoizedProps,C.memoizedState=f.memoizedState,C.updateQueue=f.updateQueue,v=f.dependencies,C.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},C.sibling=f.sibling,C.index=f.index,C.ref=f.ref,C}function $P(f,v,C,F,Y,ne){var ve=2;if(F=f,typeof f=="function")az(f)&&(ve=1);else if(typeof f=="string")ve=5;else e:switch(f){case ze:return z8(C.children,Y,ne,v);case Me:ve=8,Y|=8;break;case je:return f=Ph(12,C,v,Y|2),f.elementType=je,f.lanes=ne,f;case ae:return f=Ph(13,C,v,Y),f.elementType=ae,f.lanes=ne,f;case nt:return f=Ph(19,C,v,Y),f.elementType=nt,f.lanes=ne,f;case Ue:return qP(C,Y,ne,v);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case yt:ve=10;break e;case xe:ve=9;break e;case We:ve=11;break e;case dn:ve=14;break e;case Ve:ve=16,F=null;break e}throw Error(m(130,f==null?f:typeof f,""))}return v=Ph(ve,C,v,Y),v.elementType=f,v.type=F,v.lanes=ne,v}function z8(f,v,C,F){return f=Ph(7,f,F,v),f.lanes=C,f}function qP(f,v,C,F){return f=Ph(22,f,F,v),f.elementType=Ue,f.lanes=C,f.stateNode={isHidden:!1},f}function oz(f,v,C){return f=Ph(6,f,null,v),f.lanes=C,f}function lz(f,v,C){return v=Ph(4,f.children!==null?f.children:[],f.key,v),v.lanes=C,v.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},v}function ZEe(f,v,C,F,Y){this.tag=v,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=UU(0),this.expirationTimes=UU(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=UU(0),this.identifierPrefix=F,this.onRecoverableError=Y,this.mutableSourceEagerHydrationData=null}function uz(f,v,C,F,Y,ne,ve,Le,Je){return f=new ZEe(f,v,C,Le,Je),v===1?(v=1,ne===!0&&(v|=8)):v=0,ne=Ph(3,null,null,v),f.current=ne,ne.stateNode=f,ne.memoizedState={element:F,isDehydrated:C,cache:null,transitions:null,pendingSuspenseBoundaries:null},wB(ne),f}function QEe(f,v,C){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ne,key:F==null?null:""+F,children:f,containerInfo:v,implementation:C}}function Dpe(f){if(!f)return f3;f=f._reactInternals;e:{if(A8(f)!==f||f.tag!==1)throw Error(m(170));var v=f;do{switch(v.tag){case 3:v=v.stateNode.context;break e;case 1:if(bu(v.type)){v=v.stateNode.__reactInternalMemoizedMergedChildContext;break e}}v=v.return}while(v!==null);throw Error(m(171))}if(f.tag===1){var C=f.type;if(bu(C))return afe(f,C,v)}return v}function Ope(f,v,C,F,Y,ne,ve,Le,Je){return f=uz(C,F,!0,f,Y,ne,ve,Le,Je),f.context=Dpe(null),C=f.current,F=kl(),Y=x3(C),ne=ag(F,Y),ne.callback=v??null,g3(C,ne,Y),f.current.lanes=Y,DS(f,Y,F),Eu(f,F),f}function XP(f,v,C,F){var Y=v.current,ne=kl(),ve=x3(Y);return C=Dpe(C),v.context===null?v.context=C:v.pendingContext=C,v=ag(ne,ve),v.payload={element:f},F=F===void 0?null:F,F!==null&&(v.callback=F),f=g3(Y,v,ve),f!==null&&(af(f,Y,ve,ne),EP(f,Y,ve)),ve}function YP(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function Fpe(f,v){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var C=f.retryLane;f.retryLane=C!==0&&C<v?C:v}}function cz(f,v){Fpe(f,v),(f=f.alternate)&&Fpe(f,v)}function JEe(){return null}var Lpe=typeof reportError=="function"?reportError:function(f){console.error(f)};function hz(f){this._internalRoot=f}KP.prototype.render=hz.prototype.render=function(f){var v=this._internalRoot;if(v===null)throw Error(m(409));XP(f,v,null,null)},KP.prototype.unmount=hz.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var v=f.containerInfo;L8(function(){XP(null,f,null,null)}),v[tg]=null}};function KP(f){this._internalRoot=f}KP.prototype.unstable_scheduleHydration=function(f){if(f){var v=vde();f={blockedOn:null,target:f,priority:v};for(var C=0;C<l3.length&&v!==0&&v<l3[C].priority;C++);l3.splice(C,0,f),C===0&&xde(f)}};function dz(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function ZP(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function Upe(){}function eTe(f,v,C,F,Y){if(Y){if(typeof F=="function"){var ne=F;F=function(){var Ut=YP(ve);ne.call(Ut)}}var ve=Ope(v,F,f,0,null,!1,!1,"",Upe);return f._reactRootContainer=ve,f[tg]=ve.current,XS(f.nodeType===8?f.parentNode:f),L8(),ve}for(;Y=f.lastChild;)f.removeChild(Y);if(typeof F=="function"){var Le=F;F=function(){var Ut=YP(Je);Le.call(Ut)}}var Je=uz(f,0,!1,null,null,!1,!1,"",Upe);return f._reactRootContainer=Je,f[tg]=Je.current,XS(f.nodeType===8?f.parentNode:f),L8(function(){XP(v,Je,C,F)}),Je}function QP(f,v,C,F,Y){var ne=C._reactRootContainer;if(ne){var ve=ne;if(typeof Y=="function"){var Le=Y;Y=function(){var Je=YP(ve);Le.call(Je)}}XP(v,ve,f,Y)}else ve=eTe(C,v,f,Y,F);return YP(ve)}mde=function(f){switch(f.tag){case 3:var v=f.stateNode;if(v.current.memoizedState.isDehydrated){var C=NS(v.pendingLanes);C!==0&&(BU(v,C|1),Eu(v,Va()),!(Vi&6)&&(w7=Va()+500,p3()))}break;case 13:L8(function(){var F=sg(f,1);if(F!==null){var Y=kl();af(F,f,1,Y)}}),cz(f,1)}},zU=function(f){if(f.tag===13){var v=sg(f,134217728);if(v!==null){var C=kl();af(v,f,134217728,C)}cz(f,134217728)}},gde=function(f){if(f.tag===13){var v=x3(f),C=sg(f,v);if(C!==null){var F=kl();af(C,f,v,F)}cz(f,v)}},vde=function(){return fs},yde=function(f,v){var C=fs;try{return fs=f,v()}finally{fs=C}},t7=function(f,v,C){switch(v){case"input":if(Re(f,C),v=C.name,C.type==="radio"&&v!=null){for(C=f;C.parentNode;)C=C.parentNode;for(C=C.querySelectorAll("input[name="+JSON.stringify(""+v)+'][type="radio"]'),v=0;v<C.length;v++){var F=C[v];if(F!==f&&F.form===f.form){var Y=mP(F);if(!Y)throw Error(m(90));Wi(F),Re(F,Y)}}}break;case"textarea":sn(f,C);break;case"select":v=C.value,v!=null&&wt(f,!!C.multiple,v,!1)}},nde=rz,rde=L8;var tTe={usingClientEntryPoint:!1,Events:[ZS,c7,mP,ede,tde,rz]},hw={findFiberByHostInstance:P8,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nTe={bundleType:hw.bundleType,version:hw.version,rendererPackageName:hw.rendererPackageName,rendererConfig:hw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fe.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=ode(f),f===null?null:f.stateNode},findFiberByHostInstance:hw.findFiberByHostInstance||JEe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(dw=__REACT_DEVTOOLS_GLOBAL_HOOK__,!dw.isDisabled&&dw.supportsFiber))try{qA=dw.inject(nTe),Hp=dw}catch{}var dw;a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tTe,a.createPortal=function(f,v){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dz(v))throw Error(m(200));return QEe(f,v,null,C)},a.createRoot=function(f,v){if(!dz(f))throw Error(m(299));var C=!1,F="",Y=Lpe;return v!=null&&(v.unstable_strictMode===!0&&(C=!0),v.identifierPrefix!==void 0&&(F=v.identifierPrefix),v.onRecoverableError!==void 0&&(Y=v.onRecoverableError)),v=uz(f,1,!1,null,null,C,!1,F,Y),f[tg]=v.current,XS(f.nodeType===8?f.parentNode:f),new hz(v)},a.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var v=f._reactInternals;if(v===void 0)throw typeof f.render=="function"?Error(m(188)):(f=Object.keys(f).join(","),Error(m(268,f)));return f=ode(v),f=f===null?null:f.stateNode,f},a.flushSync=function(f){return L8(f)},a.hydrate=function(f,v,C){if(!ZP(v))throw Error(m(200));return QP(null,f,v,!0,C)},a.hydrateRoot=function(f,v,C){if(!dz(f))throw Error(m(405));var F=C!=null&&C.hydratedSources||null,Y=!1,ne="",ve=Lpe;if(C!=null&&(C.unstable_strictMode===!0&&(Y=!0),C.identifierPrefix!==void 0&&(ne=C.identifierPrefix),C.onRecoverableError!==void 0&&(ve=C.onRecoverableError)),v=Ope(v,null,f,1,C??null,Y,!1,ne,ve),f[tg]=v.current,XS(f),F)for(f=0;f<F.length;f++)C=F[f],Y=C._getVersion,Y=Y(C._source),v.mutableSourceEagerHydrationData==null?v.mutableSourceEagerHydrationData=[C,Y]:v.mutableSourceEagerHydrationData.push(C,Y);return new KP(v)},a.render=function(f,v,C){if(!ZP(v))throw Error(m(200));return QP(null,f,v,!1,C)},a.unmountComponentAtNode=function(f){if(!ZP(f))throw Error(m(40));return f._reactRootContainer?(L8(function(){QP(null,null,f,!1,function(){f._reactRootContainer=null,f[tg]=null})}),!0):!1},a.unstable_batchedUpdates=rz,a.unstable_renderSubtreeIntoContainer=function(f,v,C,F){if(!ZP(C))throw Error(m(200));if(f==null||f._reactInternals===void 0)throw Error(m(38));return QP(f,v,C,!1,F)},a.version="18.2.0-next-9e3b772b8-20220608"}),mo=ie((a,u)=>{function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(m){console.error(m)}}c(),u.exports=wN()});function OT(a){let[,u]=(0,fp.useState)(0);return(0,fp.useCallback)(()=>{u(c=>c+1)},[])}function Gr(a,u,c){let m=(0,fp.useCallback)(a,u),_=(0,fp.useRef)(null);_.current?_.current.set(m):_.current=new Gy.Atom(m);let b=(0,fp.useRef)(null);return b.current||(b.current=(0,Gy.prism)(()=>_.current.prism.getValue()())),I5(b.current,c)}function EN(){Hy||(Hy=!0,(0,FT.default)(()=>{(0,LT.unstable_batchedUpdates)(function(){for(var a,u;ac.length>0;){let c=ac.shift();E9.delete(c);let m;pp&&((a=c.debug)==null||a.history.push("queue reached"));try{m=c.der.getValue()}catch(_){pp&&((u=c.debug)==null||u.history.push("queue: der.getValue() errored")),console.error("A `der.getValue()` in `usePrismInstance(der)` threw an error. This may be a zombie child issue, so we're gonna try to get its value again in a normal react render phase.If you see the same error again, then you either have an error in your prism code, or the deps array in `usePrism(fn, deps)` is missing a dependency and causing the prism to read stale values."),console.error(_),c.runUpdate();continue}m!==c.lastValue&&(c.lastValue=m,c.runUpdate())}Hy=!1},1)}))}function I5(a,u){var c;let m=OT(),_=(0,fp.useRef)(void 0);_.current||(zx++,_.current={order:zx,runUpdate:()=>{_.current.unmounted||m()},der:a,lastValue:void 0,unmounted:!1,queueUpdate:()=>{var E;pp&&((E=_.current.debug)==null||E.history.push("queueUpdate()")),UT(_.current)},untap:a.onStale(()=>{pp&&_.current.debug.history.push("onStale(cb)"),_.current.queueUpdate()})},pp&&(_.current.debug={label:u,traceOfFirstTimeRender:new Error,history:[]})),(0,fp.useLayoutEffect)(()=>function(){_.current.unmounted=!0,_.current.untap(),Gx(_.current)},[]),Gx(_.current);let b=_.current.der.getValue();return _.current.lastValue=b,pp&&((c=_.current.debug)==null||c.history.push("rendered")),b}var Gy,FT,fp,LT,pp,qr,zx,ac,E9,Hy,UT,Vx,Gx,tr=I(()=>{Gy=mn(),Ua(),FT=Q(Bx()),fp=Q(qe()),LT=Q(mo()),pp=!1,qr=(a,u)=>Gr(()=>(0,Gy.val)(a),[a],u),zx=0,ac=[],E9=new Set,Hy=!1,UT=a=>{Vx(a),EN()},Vx=a=>{if(!E9.has(a))if(E9.add(a),ac.length===0)ac.push(a);else{let u=Px(ac,c=>c.order>=a.order);u===-1?ac.push(a):ac[u].order>a.order&&ac.splice(u,0,a)}},Gx=a=>{if(!E9.has(a))return;E9.delete(a);let u=Px(ac,c=>c===a);ac.splice(u,1)}}),BT=ie(a=>{var u=60103,c=60106,m=60107,_=60108,b=60114,E=60109,T=60110,R=60112,N=60113,z=60120,G=60115,V=60116,B=60121,j=60122,H=60117,X=60129,K=60131;typeof Symbol=="function"&&Symbol.for&&(te=Symbol.for,u=te("react.element"),c=te("react.portal"),m=te("react.fragment"),_=te("react.strict_mode"),b=te("react.profiler"),E=te("react.provider"),T=te("react.context"),R=te("react.forward_ref"),N=te("react.suspense"),z=te("react.suspense_list"),G=te("react.memo"),V=te("react.lazy"),B=te("react.block"),j=te("react.server.block"),H=te("react.fundamental"),X=te("react.debug_trace_mode"),K=te("react.legacy_hidden"));var te;function se(ae){if(typeof ae=="object"&&ae!==null){var nt=ae.$$typeof;switch(nt){case u:switch(ae=ae.type,ae){case m:case b:case _:case N:case z:return ae;default:switch(ae=ae&&ae.$$typeof,ae){case T:case R:case V:case G:case E:return ae;default:return nt}}case c:return nt}}}var pe=E,fe=u,ye=R,Ne=m,ze=V,Me=G,je=c,yt=b,xe=_,We=N;a.ContextConsumer=T,a.ContextProvider=pe,a.Element=fe,a.ForwardRef=ye,a.Fragment=Ne,a.Lazy=ze,a.Memo=Me,a.Portal=je,a.Profiler=yt,a.StrictMode=xe,a.Suspense=We,a.isAsyncMode=function(){return!1},a.isConcurrentMode=function(){return!1},a.isContextConsumer=function(ae){return se(ae)===T},a.isContextProvider=function(ae){return se(ae)===E},a.isElement=function(ae){return typeof ae=="object"&&ae!==null&&ae.$$typeof===u},a.isForwardRef=function(ae){return se(ae)===R},a.isFragment=function(ae){return se(ae)===m},a.isLazy=function(ae){return se(ae)===V},a.isMemo=function(ae){return se(ae)===G},a.isPortal=function(ae){return se(ae)===c},a.isProfiler=function(ae){return se(ae)===b},a.isStrictMode=function(ae){return se(ae)===_},a.isSuspense=function(ae){return se(ae)===N},a.isValidElementType=function(ae){return typeof ae=="string"||typeof ae=="function"||ae===m||ae===b||ae===X||ae===_||ae===N||ae===z||ae===K||typeof ae=="object"&&ae!==null&&(ae.$$typeof===V||ae.$$typeof===G||ae.$$typeof===E||ae.$$typeof===T||ae.$$typeof===R||ae.$$typeof===H||ae.$$typeof===B||ae[0]===j)},a.typeOf=se}),TN=ie((a,u)=>{u.exports=BT()}),zT=ie((a,u)=>{u.exports=function(c,m,_,b){var E=_?_.call(b,c,m):void 0;if(E!==void 0)return!!E;if(c===m)return!0;if(typeof c!="object"||!c||typeof m!="object"||!m)return!1;var T=Object.keys(c),R=Object.keys(m);if(T.length!==R.length)return!1;for(var N=Object.prototype.hasOwnProperty.bind(m),z=0;z<T.length;z++){var G=T[z];if(!N(G))return!1;var V=c[G],B=m[G];if(E=_?_.call(b,V,B,G):void 0,E===!1||E===void 0&&V!==B)return!1}return!0}});function MN(a){function u(Ce,St,Mt,It,ut){for(var Gn=0,Vt=0,Nn=0,hr=0,Rr,Tr,Wi=0,he=0,Lt,kt=Lt=Rr=0,Ie=0,Re=0,ct=0,Xt=0,rn=Mt.length,wt=rn-1,fn,tn="",sn="",xr="",zi="",Hr;Ie<rn;){if(Tr=Mt.charCodeAt(Ie),Ie===wt&&Vt+hr+Nn+Gn!==0&&(Vt!==0&&(Tr=Vt===47?10:47),hr=Nn=Gn=0,rn++,wt++),Vt+hr+Nn+Gn===0){if(Ie===wt&&(0<Re&&(tn=tn.replace(V,"")),0<tn.trim().length)){switch(Tr){case 32:case 9:case 59:case 13:case 10:break;default:tn+=Mt.charAt(Ie)}Tr=59}switch(Tr){case 123:for(tn=tn.trim(),Rr=tn.charCodeAt(0),Lt=1,Xt=++Ie;Ie<rn;){switch(Tr=Mt.charCodeAt(Ie)){case 123:Lt++;break;case 125:Lt--;break;case 47:switch(Tr=Mt.charCodeAt(Ie+1)){case 42:case 47:e:{for(kt=Ie+1;kt<wt;++kt)switch(Mt.charCodeAt(kt)){case 47:if(Tr===42&&Mt.charCodeAt(kt-1)===42&&Ie+2!==kt){Ie=kt+1;break e}break;case 10:if(Tr===47){Ie=kt+1;break e}}Ie=kt}}break;case 91:Tr++;case 40:Tr++;case 34:case 39:for(;Ie++<wt&&Mt.charCodeAt(Ie)!==Tr;);}if(Lt===0)break;Ie++}switch(Lt=Mt.substring(Xt,Ie),Rr===0&&(Rr=(tn=tn.replace(G,"").trim()).charCodeAt(0)),Rr){case 64:switch(0<Re&&(tn=tn.replace(V,"")),Tr=tn.charCodeAt(1),Tr){case 100:case 109:case 115:case 45:Re=St;break;default:Re=dn}if(Lt=u(St,Re,Lt,Tr,ut+1),Xt=Lt.length,0<Ue&&(Re=c(dn,tn,ct),Hr=T(3,Lt,Re,St,We,xe,Xt,Tr,ut,It),tn=Re.join(""),Hr!==void 0&&(Xt=(Lt=Hr.trim()).length)===0&&(Tr=0,Lt="")),0<Xt)switch(Tr){case 115:tn=tn.replace(ye,E);case 100:case 109:case 45:Lt=tn+"{"+Lt+"}";break;case 107:tn=tn.replace(te,"$1 $2"),Lt=tn+"{"+Lt+"}",Lt=nt===1||nt===2&&b("@"+Lt,3)?"@-webkit-"+Lt+"@"+Lt:"@"+Lt;break;default:Lt=tn+Lt,It===112&&(Lt=(sn+=Lt,""))}else Lt="";break;default:Lt=u(St,c(St,tn,ct),Lt,It,ut+1)}xr+=Lt,Lt=ct=Re=kt=Rr=0,tn="",Tr=Mt.charCodeAt(++Ie);break;case 125:case 59:if(tn=(0<Re?tn.replace(V,""):tn).trim(),1<(Xt=tn.length))switch(kt===0&&(Rr=tn.charCodeAt(0),Rr===45||96<Rr&&123>Rr)&&(Xt=(tn=tn.replace(" ",":")).length),0<Ue&&(Hr=T(1,tn,St,Ce,We,xe,sn.length,It,ut,It))!==void 0&&(Xt=(tn=Hr.trim()).length)===0&&(tn="\0\0"),Rr=tn.charCodeAt(0),Tr=tn.charCodeAt(1),Rr){case 0:break;case 64:if(Tr===105||Tr===99){zi+=tn+Mt.charAt(Ie);break}default:tn.charCodeAt(Xt-1)!==58&&(sn+=_(tn,Rr,Tr,tn.charCodeAt(2)))}ct=Re=kt=Rr=0,tn="",Tr=Mt.charCodeAt(++Ie)}}switch(Tr){case 13:case 10:Vt===47?Vt=0:1+Rr===0&&It!==107&&0<tn.length&&(Re=1,tn+="\0"),0<Ue*Wt&&T(0,tn,St,Ce,We,xe,sn.length,It,ut,It),xe=1,We++;break;case 59:case 125:if(Vt+hr+Nn+Gn===0){xe++;break}default:switch(xe++,fn=Mt.charAt(Ie),Tr){case 9:case 32:if(hr+Gn+Vt===0)switch(Wi){case 44:case 58:case 9:case 32:fn="";break;default:Tr!==32&&(fn=" ")}break;case 0:fn="\\0";break;case 12:fn="\\f";break;case 11:fn="\\v";break;case 38:hr+Vt+Gn===0&&(Re=ct=1,fn="\f"+fn);break;case 108:if(hr+Vt+Gn+ae===0&&0<kt)switch(Ie-kt){case 2:Wi===112&&Mt.charCodeAt(Ie-3)===58&&(ae=Wi);case 8:he===111&&(ae=he)}break;case 58:hr+Vt+Gn===0&&(kt=Ie);break;case 44:Vt+Nn+hr+Gn===0&&(Re=1,fn+="\r");break;case 34:case 39:Vt===0&&(hr=hr===Tr?0:hr===0?Tr:hr);break;case 91:hr+Vt+Nn===0&&Gn++;break;case 93:hr+Vt+Nn===0&&Gn--;break;case 41:hr+Vt+Gn===0&&Nn--;break;case 40:if(hr+Vt+Gn===0){if(Rr===0)switch(2*Wi+3*he){case 533:break;default:Rr=1}Nn++}break;case 64:Vt+Nn+hr+Gn+kt+Lt===0&&(Lt=1);break;case 42:case 47:if(!(0<hr+Gn+Nn))switch(Vt){case 0:switch(2*Tr+3*Mt.charCodeAt(Ie+1)){case 235:Vt=47;break;case 220:Xt=Ie,Vt=42}break;case 42:Tr===47&&Wi===42&&Xt+2!==Ie&&(Mt.charCodeAt(Xt+2)===33&&(sn+=Mt.substring(Xt,Ie+1)),fn="",Vt=0)}}Vt===0&&(tn+=fn)}he=Wi,Wi=Tr,Ie++}if(Xt=sn.length,0<Xt){if(Re=St,0<Ue&&(Hr=T(2,sn,Re,Ce,We,xe,Xt,It,ut,It),Hr!==void 0&&(sn=Hr).length===0))return zi+sn+xr;if(sn=Re.join(",")+"{"+sn+"}",nt*ae!==0){switch(nt!==2||b(sn,2)||(ae=0),ae){case 111:sn=sn.replace(pe,":-moz-$1")+sn;break;case 112:sn=sn.replace(se,"::-webkit-input-$1")+sn.replace(se,"::-moz-$1")+sn.replace(se,":-ms-input-$1")+sn}ae=0}}return zi+sn+xr}function c(Ce,St,Mt){var It=St.trim().split(X);St=It;var ut=It.length,Gn=Ce.length;switch(Gn){case 0:case 1:var Vt=0;for(Ce=Gn===0?"":Ce[0]+" ";Vt<ut;++Vt)St[Vt]=m(Ce,St[Vt],Mt).trim();break;default:var Nn=Vt=0;for(St=[];Vt<ut;++Vt)for(var hr=0;hr<Gn;++hr)St[Nn++]=m(Ce[hr]+" ",It[Vt],Mt).trim()}return St}function m(Ce,St,Mt){var It=St.charCodeAt(0);switch(33>It&&(It=(St=St.trim()).charCodeAt(0)),It){case 38:return St.replace(K,"$1"+Ce.trim());case 58:return Ce.trim()+St.replace(K,"$1"+Ce.trim());default:if(0<1*Mt&&0<St.indexOf("\f"))return St.replace(K,(Ce.charCodeAt(0)===58?"":"$1")+Ce.trim())}return Ce+St}function _(Ce,St,Mt,It){var ut=Ce+";",Gn=2*St+3*Mt+4*It;if(Gn===944){Ce=ut.indexOf(":",9)+1;var Vt=ut.substring(Ce,ut.length-1).trim();return Vt=ut.substring(0,Ce).trim()+Vt+";",nt===1||nt===2&&b(Vt,1)?"-webkit-"+Vt+Vt:Vt}if(nt===0||nt===2&&!b(ut,1))return ut;switch(Gn){case 1015:return ut.charCodeAt(10)===97?"-webkit-"+ut+ut:ut;case 951:return ut.charCodeAt(3)===116?"-webkit-"+ut+ut:ut;case 963:return ut.charCodeAt(5)===110?"-webkit-"+ut+ut:ut;case 1009:if(ut.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+ut+ut;case 978:return"-webkit-"+ut+"-moz-"+ut+ut;case 1019:case 983:return"-webkit-"+ut+"-moz-"+ut+"-ms-"+ut+ut;case 883:if(ut.charCodeAt(8)===45)return"-webkit-"+ut+ut;if(0<ut.indexOf("image-set(",11))return ut.replace(yt,"$1-webkit-$2")+ut;break;case 932:if(ut.charCodeAt(4)===45)switch(ut.charCodeAt(5)){case 103:return"-webkit-box-"+ut.replace("-grow","")+"-webkit-"+ut+"-ms-"+ut.replace("grow","positive")+ut;case 115:return"-webkit-"+ut+"-ms-"+ut.replace("shrink","negative")+ut;case 98:return"-webkit-"+ut+"-ms-"+ut.replace("basis","preferred-size")+ut}return"-webkit-"+ut+"-ms-"+ut+ut;case 964:return"-webkit-"+ut+"-ms-flex-"+ut+ut;case 1023:if(ut.charCodeAt(8)!==99)break;return Vt=ut.substring(ut.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+Vt+"-webkit-"+ut+"-ms-flex-pack"+Vt+ut;case 1005:return j.test(ut)?ut.replace(B,":-webkit-")+ut.replace(B,":-moz-")+ut:ut;case 1e3:switch(Vt=ut.substring(13).trim(),St=Vt.indexOf("-")+1,Vt.charCodeAt(0)+Vt.charCodeAt(St)){case 226:Vt=ut.replace(fe,"tb");break;case 232:Vt=ut.replace(fe,"tb-rl");break;case 220:Vt=ut.replace(fe,"lr");break;default:return ut}return"-webkit-"+ut+"-ms-"+Vt+ut;case 1017:if(ut.indexOf("sticky",9)===-1)break;case 975:switch(St=(ut=Ce).length-10,Vt=(ut.charCodeAt(St)===33?ut.substring(0,St):ut).substring(Ce.indexOf(":",7)+1).trim(),Gn=Vt.charCodeAt(0)+(Vt.charCodeAt(7)|0)){case 203:if(111>Vt.charCodeAt(8))break;case 115:ut=ut.replace(Vt,"-webkit-"+Vt)+";"+ut;break;case 207:case 102:ut=ut.replace(Vt,"-webkit-"+(102<Gn?"inline-":"")+"box")+";"+ut.replace(Vt,"-webkit-"+Vt)+";"+ut.replace(Vt,"-ms-"+Vt+"box")+";"+ut}return ut+";";case 938:if(ut.charCodeAt(5)===45)switch(ut.charCodeAt(6)){case 105:return Vt=ut.replace("-items",""),"-webkit-"+ut+"-webkit-box-"+Vt+"-ms-flex-"+Vt+ut;case 115:return"-webkit-"+ut+"-ms-flex-item-"+ut.replace(ze,"")+ut;default:return"-webkit-"+ut+"-ms-flex-line-pack"+ut.replace("align-content","").replace(ze,"")+ut}break;case 973:case 989:if(ut.charCodeAt(3)!==45||ut.charCodeAt(4)===122)break;case 931:case 953:if(je.test(Ce)===!0)return(Vt=Ce.substring(Ce.indexOf(":")+1)).charCodeAt(0)===115?_(Ce.replace("stretch","fill-available"),St,Mt,It).replace(":fill-available",":stretch"):ut.replace(Vt,"-webkit-"+Vt)+ut.replace(Vt,"-moz-"+Vt.replace("fill-",""))+ut;break;case 962:if(ut="-webkit-"+ut+(ut.charCodeAt(5)===102?"-ms-"+ut:"")+ut,Mt+It===211&&ut.charCodeAt(13)===105&&0<ut.indexOf("transform",10))return ut.substring(0,ut.indexOf(";",27)+1).replace(H,"$1-webkit-$2")+ut}return ut}function b(Ce,St){var Mt=Ce.indexOf(St===1?":":"{"),It=Ce.substring(0,St!==3?Mt:10);return Mt=Ce.substring(Mt+1,Ce.length-1),at(St!==2?It:It.replace(Me,"$1"),Mt,St)}function E(Ce,St){var Mt=_(St,St.charCodeAt(0),St.charCodeAt(1),St.charCodeAt(2));return Mt!==St+";"?Mt.replace(Ne," or ($1)").substring(4):"("+St+")"}function T(Ce,St,Mt,It,ut,Gn,Vt,Nn,hr,Rr){for(var Tr=0,Wi=St,he;Tr<Ue;++Tr)switch(he=Ve[Tr].call(z,Ce,Wi,Mt,It,ut,Gn,Vt,Nn,hr,Rr)){case void 0:case!1:case!0:case null:break;default:Wi=he}if(Wi!==St)return Wi}function R(Ce){switch(Ce){case void 0:case null:Ue=Ve.length=0;break;default:if(typeof Ce=="function")Ve[Ue++]=Ce;else if(typeof Ce=="object")for(var St=0,Mt=Ce.length;St<Mt;++St)R(Ce[St]);else Wt=!!Ce|0}return R}function N(Ce){return Ce=Ce.prefix,Ce!==void 0&&(at=null,Ce?typeof Ce!="function"?nt=1:(nt=2,at=Ce):nt=0),N}function z(Ce,St){var Mt=Ce;if(33>Mt.charCodeAt(0)&&(Mt=Mt.trim()),be=Mt,Mt=[be],0<Ue){var It=T(-1,St,Mt,Mt,We,xe,0,0,0,0);It!==void 0&&typeof It=="string"&&(St=It)}var ut=u(dn,Mt,St,0,0);return 0<Ue&&(It=T(-2,ut,Mt,Mt,We,xe,ut.length,0,0,0),It!==void 0&&(ut=It)),be="",ae=0,xe=We=1,ut}var G=/^\0+/g,V=/[\0\r\f]/g,B=/: */g,j=/zoo|gra/,H=/([,: ])(transform)/g,X=/,\r+?/g,K=/([\t\r\n ])*\f?&/g,te=/@(k\w+)\s*(\S*)\s*/,se=/::(place)/g,pe=/:(read-only)/g,fe=/[svh]\w+-[tblr]{2}/,ye=/\(\s*(.*)\s*\)/g,Ne=/([\s\S]*?);/g,ze=/-self|flex-/g,Me=/[^]*?(:[rp][el]a[\w-]+)[^]*/,je=/stretch|:\s*\w+\-(?:conte|avail)/,yt=/([^-])(image-set\()/,xe=1,We=1,ae=0,nt=1,dn=[],Ve=[],Ue=0,at=null,Wt=0,be="";return z.use=R,z.set=N,a!==void 0&&N(a),z}var VT,jy=I(()=>{VT=MN}),GT,T9,CN=I(()=>{GT={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},T9=GT});function AN(a){var u=Object.create(null);return function(c){return u[c]===void 0&&(u[c]=a(c)),u[c]}}var HT,PN=I(()=>{HT=AN}),Wy,Hx,jx,RN=I(()=>{PN(),Wy=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Hx=HT(function(a){return Wy.test(a)||a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)<91}),jx=Hx}),pu=ie(a=>{var u=typeof Symbol=="function"&&Symbol.for,c=u?Symbol.for("react.element"):60103,m=u?Symbol.for("react.portal"):60106,_=u?Symbol.for("react.fragment"):60107,b=u?Symbol.for("react.strict_mode"):60108,E=u?Symbol.for("react.profiler"):60114,T=u?Symbol.for("react.provider"):60109,R=u?Symbol.for("react.context"):60110,N=u?Symbol.for("react.async_mode"):60111,z=u?Symbol.for("react.concurrent_mode"):60111,G=u?Symbol.for("react.forward_ref"):60112,V=u?Symbol.for("react.suspense"):60113,B=u?Symbol.for("react.suspense_list"):60120,j=u?Symbol.for("react.memo"):60115,H=u?Symbol.for("react.lazy"):60116,X=u?Symbol.for("react.block"):60121,K=u?Symbol.for("react.fundamental"):60117,te=u?Symbol.for("react.responder"):60118,se=u?Symbol.for("react.scope"):60119;function pe(ye){if(typeof ye=="object"&&ye!==null){var Ne=ye.$$typeof;switch(Ne){case c:switch(ye=ye.type,ye){case N:case z:case _:case E:case b:case V:return ye;default:switch(ye=ye&&ye.$$typeof,ye){case R:case G:case H:case j:case T:return ye;default:return Ne}}case m:return Ne}}}function fe(ye){return pe(ye)===z}a.AsyncMode=N,a.ConcurrentMode=z,a.ContextConsumer=R,a.ContextProvider=T,a.Element=c,a.ForwardRef=G,a.Fragment=_,a.Lazy=H,a.Memo=j,a.Portal=m,a.Profiler=E,a.StrictMode=b,a.Suspense=V,a.isAsyncMode=function(ye){return fe(ye)||pe(ye)===N},a.isConcurrentMode=fe,a.isContextConsumer=function(ye){return pe(ye)===R},a.isContextProvider=function(ye){return pe(ye)===T},a.isElement=function(ye){return typeof ye=="object"&&ye!==null&&ye.$$typeof===c},a.isForwardRef=function(ye){return pe(ye)===G},a.isFragment=function(ye){return pe(ye)===_},a.isLazy=function(ye){return pe(ye)===H},a.isMemo=function(ye){return pe(ye)===j},a.isPortal=function(ye){return pe(ye)===m},a.isProfiler=function(ye){return pe(ye)===E},a.isStrictMode=function(ye){return pe(ye)===b},a.isSuspense=function(ye){return pe(ye)===V},a.isValidElementType=function(ye){return typeof ye=="string"||typeof ye=="function"||ye===_||ye===z||ye===E||ye===b||ye===V||ye===B||typeof ye=="object"&&ye!==null&&(ye.$$typeof===H||ye.$$typeof===j||ye.$$typeof===T||ye.$$typeof===R||ye.$$typeof===G||ye.$$typeof===K||ye.$$typeof===te||ye.$$typeof===se||ye.$$typeof===X)},a.typeOf=pe}),Tm=ie((a,u)=>{u.exports=pu()}),Mm=ie((a,u)=>{var c=Tm(),m={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},_={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},b={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},E={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},T={};T[c.ForwardRef]=b,T[c.Memo]=E;function R(X){return c.isMemo(X)?E:T[X.$$typeof]||m}var N=Object.defineProperty,z=Object.getOwnPropertyNames,G=Object.getOwnPropertySymbols,V=Object.getOwnPropertyDescriptor,B=Object.getPrototypeOf,j=Object.prototype;function H(X,K,te){if(typeof K!="string"){if(j){var se=B(K);se&&se!==j&&H(X,se,te)}var pe=z(K);G&&(pe=pe.concat(G(K)));for(var fe=R(X),ye=R(K),Ne=0;Ne<pe.length;++Ne){var ze=pe[Ne];if(!_[ze]&&!(te&&te[ze])&&!(ye&&ye[ze])&&!(fe&&fe[ze])){var Me=V(K,ze);try{N(X,ze,Me)}catch{}}}}return X}u.exports=H});function oc(){return(oc=Object.assign||function(a){for(var u=1;u<arguments.length;u++){var c=arguments[u];for(var m in c)Object.prototype.hasOwnProperty.call(c,m)&&(a[m]=c[m])}return a}).apply(this,arguments)}function Rd(a){return typeof a=="function"}function Cm(a){return a.displayName||a.name||"Component"}function k5(a){return a&&typeof a.styledComponentId=="string"}function Id(a){for(var u=arguments.length,c=new Array(u>1?u-1:0),m=1;m<u;m++)c[m-1]=arguments[m];throw new Error("An error occurred. See https://git.io/JUIaE#"+a+" for more information."+(c.length>0?" Args: "+c.join(", "):""))}function $y(a){var u,c="";for(u=Math.abs(a);u>52;u=u/52|0)c=Jy(u%52)+c;return(Jy(u%52)+c).replace(YT,"$1-$2")}function jT(a){for(var u=0;u<a.length;u+=1){var c=a[u];if(Rd(c)&&!k5(c))return!1}return!0}function qy(a){var u,c,m,_,b=a===void 0?uc:a,E=b.options,T=E===void 0?uc:E,R=b.plugins,N=R===void 0?A9:R,z=new VT(T),G=[],V=function(H){function X(K){if(K)try{H(K+"}")}catch{}}return function(K,te,se,pe,fe,ye,Ne,ze,Me,je){switch(K){case 1:if(Me===0&&te.charCodeAt(0)===64)return H(te+";"),"";break;case 2:if(ze===0)return te+"/*|*/";break;case 3:switch(ze){case 102:case 112:return H(se[0]+te),"";default:return te+(je===0?"/*|*/":"")}case-2:te.split("/*|*/}").forEach(X)}}}(function(H){G.push(H)}),B=function(H,X,K){return X===0&&rb.indexOf(K[c.length])!==-1||K.match(_)?H:"."+u};function j(H,X,K,te){te===void 0&&(te="&");var se=H.replace(e6,""),pe=X&&K?K+" "+X+" { "+se+" }":se;return u=te,c=X,m=new RegExp("\\"+c+"\\b","g"),_=new RegExp("(\\"+c+"\\b){2,}"),z(K||!X?"":X,pe)}return z.use([].concat(N,[function(H,X,K){H===2&&K.length&&K[0].lastIndexOf(c)>0&&(K[0]=K[0].replace(m,B))},V,function(H){if(H===-2){var X=G;return G=[],X}}])),j.hash=N.length?N.reduce(function(H,X){return X.name||Id(15),vp(H,X.name)},5381).toString():"",j}function N5(){return(0,Xs.useContext)(t6)||r6}function mp(){return(0,Xs.useContext)(n6)||z5}function Xy(a){var u=(0,Xs.useState)(a.stylisPlugins),c=u[0],m=u[1],_=N5(),b=(0,Xs.useMemo)(function(){var T=_;return a.sheet?T=a.sheet:a.target&&(T=T.reconstructWithOptions({target:a.target},!1)),a.disableCSSOMInjection&&(T=T.reconstructWithOptions({useCSSOMInjection:!1})),T},[a.disableCSSOMInjection,a.sheet,a.target]),E=(0,Xs.useMemo)(function(){return qy({options:{prefix:!a.disableVendorPrefixes},plugins:c})},[a.disableVendorPrefixes,c]);return(0,Xs.useEffect)(function(){(0,F5.default)(c,a.stylisPlugins)||m(a.stylisPlugins)},[a.stylisPlugins]),Xs.default.createElement(t6.Provider,{value:b},Xs.default.createElement(n6.Provider,{value:E},a.children))}function Yy(a){return QT.test(a)?a.replace(w,W).replace(D,"-ms-"):a}function Am(a,u,c,m){if(Array.isArray(a)){for(var _,b=[],E=0,T=a.length;E<T;E+=1)(_=Am(a[E],u,c,m))!==""&&(Array.isArray(_)?b.push.apply(b,_):b.push(_));return b}if(re(a))return"";if(k5(a))return"."+a.styledComponentId;if(Rd(a)){if(typeof(N=a)!="function"||N.prototype&&N.prototype.isReactComponent||!u)return a;var R=a(u);return Am(R,u,c,m)}var N;return a instanceof ZT?c?(a.inject(c,m),a.getName(m)):a:C9(a)?function z(G,V){var B,j,H=[];for(var X in G)G.hasOwnProperty(X)&&!re(G[X])&&(Array.isArray(G[X])&&G[X].isCss||Rd(G[X])?H.push(Yy(X)+":",G[X],";"):C9(G[X])?H.push.apply(H,z(G[X],X)):H.push(Yy(X)+": "+(B=X,(j=G[X])==null||typeof j=="boolean"||j===""?"":typeof j!="number"||j===0||B in T9||B.startsWith("--")?String(j).trim():j+"px")+";"));return V?[V+" {"].concat(H,["}"]):H}(a):a.toString()}function e0(a){for(var u=arguments.length,c=new Array(u>1?u-1:0),m=1;m<u;m++)c[m-1]=arguments[m];return Rd(a)||C9(a)?me(Am(M9(A9,[a].concat(c)))):c.length===0&&a.length===1&&typeof a[0]=="string"?a:me(Am(M9(a,c)))}function lc(a){return a.replace(Ge,"-").replace(ft,"")}function D5(a){return typeof a=="string"&&!0}function Wx(a,u,c){var m=a[c];zt(u)&&zt(m)?O5(m,u):a[c]=u}function O5(a){for(var u=arguments.length,c=new Array(u>1?u-1:0),m=1;m<u;m++)c[m-1]=arguments[m];for(var _=0,b=c;_<b.length;_++){var E=b[_];if(zt(E))for(var T in E)xn(T)&&Wx(a,E[T],T)}return a}function Ky(a,u,c){var m=k5(a),_=!D5(a),b=u.attrs,E=b===void 0?A9:b,T=u.componentId,R=T===void 0?function(te,se){var pe=typeof te!="string"?"sc":lc(te);On[pe]=(On[pe]||0)+1;var fe=pe+"-"+Tt("5.3.11"+pe+On[pe]);return se?se+"-"+fe:fe}(u.displayName,u.parentComponentId):T,N=u.displayName,z=N===void 0?function(te){return D5(te)?"styled."+te:"Styled("+Cm(te)+")"}(a):N,G=u.displayName&&u.componentId?lc(u.displayName)+"-"+u.componentId:u.componentId||R,V=m&&a.attrs?Array.prototype.concat(a.attrs,E).filter(Boolean):E,B=u.shouldForwardProp;m&&a.shouldForwardProp&&(B=u.shouldForwardProp?function(te,se,pe){return a.shouldForwardProp(te,se,pe)&&u.shouldForwardProp(te,se,pe)}:a.shouldForwardProp);var j,H=new nb(c,G,m?a.componentStyle:void 0),X=H.isStatic&&E.length===0,K=function(te,se){return function(pe,fe,ye,Ne){var ze=pe.attrs,Me=pe.componentStyle,je=pe.defaultProps,yt=pe.foldedComponentIds,xe=pe.shouldForwardProp,We=pe.styledComponentId,ae=pe.target,nt=function(It,ut,Gn){It===void 0&&(It=uc);var Vt=oc({},ut,{theme:It}),Nn={};return Gn.forEach(function(hr){var Rr,Tr,Wi,he=hr;for(Rr in Rd(he)&&(he=he(Vt)),he)Vt[Rr]=Nn[Rr]=Rr==="className"?(Tr=Nn[Rr],Wi=he[Rr],Tr&&Wi?Tr+" "+Wi:Tr||Wi):he[Rr]}),[Vt,Nn]}(Ee(fe,(0,Xs.useContext)(bn),je)||uc,fe,ze),dn=nt[0],Ve=nt[1],Ue=function(It,ut,Gn,Vt){var Nn=N5(),hr=mp(),Rr=ut?It.generateAndInjectStyles(uc,Nn,hr):It.generateAndInjectStyles(Gn,Nn,hr);return Rr}(Me,Ne,dn),at=ye,Wt=Ve.$as||fe.$as||Ve.as||fe.as||ae,be=D5(Wt),Ce=Ve!==fe?oc({},fe,{},Ve):fe,St={};for(var Mt in Ce)Mt[0]!=="$"&&Mt!=="as"&&(Mt==="forwardedAs"?St.as=Ce[Mt]:(xe?xe(Mt,jx,Wt):!be||jx(Mt))&&(St[Mt]=Ce[Mt]));return fe.style&&Ve.style!==fe.style&&(St.style=oc({},fe.style,{},Ve.style)),St.className=Array.prototype.concat(yt,We,Ue!==We?Ue:null,fe.className,Ve.className).filter(Boolean).join(" "),St.ref=at,(0,Xs.createElement)(Wt,St)}(j,te,se,X)};return K.displayName=z,(j=Xs.default.forwardRef(K)).attrs=V,j.componentStyle=H,j.displayName=z,j.shouldForwardProp=B,j.foldedComponentIds=m?Array.prototype.concat(a.foldedComponentIds,a.styledComponentId):A9,j.styledComponentId=G,j.target=m?a.target:a,j.withComponent=function(te){var se=u.componentId,pe=function(ye,Ne){if(ye==null)return{};var ze,Me,je={},yt=Object.keys(ye);for(Me=0;Me<yt.length;Me++)ze=yt[Me],Ne.indexOf(ze)>=0||(je[ze]=ye[ze]);return je}(u,["componentId"]),fe=se&&se+"-"+(D5(te)?te:lc(Cm(te)));return Ky(te,oc({},pe,{attrs:V,componentId:fe}),c)},Object.defineProperty(j,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(te){this._foldedDefaultProps=m?O5({},a.defaultProps,te):te}}),Object.defineProperty(j,"toString",{value:function(){return"."+j.styledComponentId}}),_&&(0,Xx.default)(j,a,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),j}function $x(a){for(var u=arguments.length,c=new Array(u>1?u-1:0),m=1;m<u;m++)c[m-1]=arguments[m];var _=e0.apply(void 0,[a].concat(c)),b="sc-global-"+Tt(JSON.stringify(_)),E=new ir(_,b);function T(N){var z=N5(),G=mp(),V=(0,Xs.useContext)(bn),B=(0,Xs.useRef)(z.allocateGSInstance(b)).current;return z.server&&R(B,N,z,V,G),(0,Xs.useLayoutEffect)(function(){if(!z.server)return R(B,N,z,V,G),function(){return E.removeStyles(B,z)}},[B,N,z,V,G]),null}function R(N,z,G,V,B){if(E.isStatic)E.renderStyles(N,Yx,G,B);else{var j=oc({},z,{theme:Ee(z,V,T.defaultProps)});E.renderStyles(N,j,G,B)}}return Xs.default.memo(T)}var qx,Xs,F5,Xx,M9,C9,A9,uc,cc,P9,WT,Yx,Kx,kd,Pm,R9,L5,Zx,Qx,Jx,t0,$T,Zy,Qy,eb,U5,B5,qT,n0,XT,gp,YT,Jy,vp,tb,KT,nb,e6,rb,t6,n6,r6,z5,ZT,QT,w,D,W,re,me,Ee,Ge,ft,Tt,zt,xn,bn,On,pr,ir,Te,Ft=I(()=>{qx=Q(TN()),Xs=Q(qe()),F5=Q(zT()),jy(),CN(),RN(),Xx=Q(Mm()),M9=function(a,u){for(var c=[a[0]],m=0,_=u.length;m<_;m+=1)c.push(u[m],a[m+1]);return c},C9=function(a){return a!==null&&typeof a=="object"&&(a.toString?a.toString():Object.prototype.toString.call(a))==="[object Object]"&&!(0,qx.typeOf)(a)},A9=Object.freeze([]),uc=Object.freeze({}),cc=typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_ATTR||t.SC_ATTR)||"data-styled",P9=typeof window<"u"&&"HTMLElement"in window,WT=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&t.REACT_APP_SC_DISABLE_SPEEDY!==""?t.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&t.REACT_APP_SC_DISABLE_SPEEDY:t.SC_DISABLE_SPEEDY!==void 0&&t.SC_DISABLE_SPEEDY!==""&&t.SC_DISABLE_SPEEDY!=="false"&&t.SC_DISABLE_SPEEDY)),Yx={},Kx=function(){function a(c){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=c}var u=a.prototype;return u.indexOfGroup=function(c){for(var m=0,_=0;_<c;_++)m+=this.groupSizes[_];return m},u.insertRules=function(c,m){if(c>=this.groupSizes.length){for(var _=this.groupSizes,b=_.length,E=b;c>=E;)(E<<=1)<0&&Id(16,""+c);this.groupSizes=new Uint32Array(E),this.groupSizes.set(_),this.length=E;for(var T=b;T<E;T++)this.groupSizes[T]=0}for(var R=this.indexOfGroup(c+1),N=0,z=m.length;N<z;N++)this.tag.insertRule(R,m[N])&&(this.groupSizes[c]++,R++)},u.clearGroup=function(c){if(c<this.length){var m=this.groupSizes[c],_=this.indexOfGroup(c),b=_+m;this.groupSizes[c]=0;for(var E=_;E<b;E++)this.tag.deleteRule(_)}},u.getGroup=function(c){var m="";if(c>=this.length||this.groupSizes[c]===0)return m;for(var _=this.groupSizes[c],b=this.indexOfGroup(c),E=b+_,T=b;T<E;T++)m+=this.tag.getRule(T)+`/*!sc*/
`;return m},a}(),kd=new Map,Pm=new Map,R9=1,L5=function(a){if(kd.has(a))return kd.get(a);for(;Pm.has(R9);)R9++;var u=R9++;return kd.set(a,u),Pm.set(u,a),u},Zx=function(a){return Pm.get(a)},Qx=function(a,u){u>=R9&&(R9=u+1),kd.set(a,u),Pm.set(u,a)},Jx="style["+cc+'][data-styled-version="5.3.11"]',t0=new RegExp("^"+cc+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),$T=function(a,u,c){for(var m,_=c.split(","),b=0,E=_.length;b<E;b++)(m=_[b])&&a.registerName(u,m)},Zy=function(a,u){for(var c=(u.textContent||"").split(`/*!sc*/
`),m=[],_=0,b=c.length;_<b;_++){var E=c[_].trim();if(E){var T=E.match(t0);if(T){var R=0|parseInt(T[1],10),N=T[2];R!==0&&(Qx(N,R),$T(a,N,T[3]),a.getTag().insertRules(R,m)),m.length=0}else m.push(E)}}},Qy=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},eb=function(a){var u=document.head,c=a||u,m=document.createElement("style"),_=function(T){for(var R=T.childNodes,N=R.length;N>=0;N--){var z=R[N];if(z&&z.nodeType===1&&z.hasAttribute(cc))return z}}(c),b=_!==void 0?_.nextSibling:null;m.setAttribute(cc,"active"),m.setAttribute("data-styled-version","5.3.11");var E=Qy();return E&&m.setAttribute("nonce",E),c.insertBefore(m,b),m},U5=function(){function a(c){var m=this.element=eb(c);m.appendChild(document.createTextNode("")),this.sheet=function(_){if(_.sheet)return _.sheet;for(var b=document.styleSheets,E=0,T=b.length;E<T;E++){var R=b[E];if(R.ownerNode===_)return R}Id(17)}(m),this.length=0}var u=a.prototype;return u.insertRule=function(c,m){try{return this.sheet.insertRule(m,c),this.length++,!0}catch{return!1}},u.deleteRule=function(c){this.sheet.deleteRule(c),this.length--},u.getRule=function(c){var m=this.sheet.cssRules[c];return m!==void 0&&typeof m.cssText=="string"?m.cssText:""},a}(),B5=function(){function a(c){var m=this.element=eb(c);this.nodes=m.childNodes,this.length=0}var u=a.prototype;return u.insertRule=function(c,m){if(c<=this.length&&c>=0){var _=document.createTextNode(m),b=this.nodes[c];return this.element.insertBefore(_,b||null),this.length++,!0}return!1},u.deleteRule=function(c){this.element.removeChild(this.nodes[c]),this.length--},u.getRule=function(c){return c<this.length?this.nodes[c].textContent:""},a}(),qT=function(){function a(c){this.rules=[],this.length=0}var u=a.prototype;return u.insertRule=function(c,m){return c<=this.length&&(this.rules.splice(c,0,m),this.length++,!0)},u.deleteRule=function(c){this.rules.splice(c,1),this.length--},u.getRule=function(c){return c<this.length?this.rules[c]:""},a}(),n0=P9,XT={isServer:!P9,useCSSOMInjection:!WT},gp=function(){function a(c,m,_){c===void 0&&(c=uc),m===void 0&&(m={}),this.options=oc({},XT,{},c),this.gs=m,this.names=new Map(_),this.server=!!c.isServer,!this.server&&P9&&n0&&(n0=!1,function(b){for(var E=document.querySelectorAll(Jx),T=0,R=E.length;T<R;T++){var N=E[T];N&&N.getAttribute(cc)!=="active"&&(Zy(b,N),N.parentNode&&N.parentNode.removeChild(N))}}(this))}a.registerId=function(c){return L5(c)};var u=a.prototype;return u.reconstructWithOptions=function(c,m){return m===void 0&&(m=!0),new a(oc({},this.options,{},c),this.gs,m&&this.names||void 0)},u.allocateGSInstance=function(c){return this.gs[c]=(this.gs[c]||0)+1},u.getTag=function(){return this.tag||(this.tag=(_=(m=this.options).isServer,b=m.useCSSOMInjection,E=m.target,c=_?new qT(E):b?new U5(E):new B5(E),new Kx(c)));var c,m,_,b,E},u.hasNameForId=function(c,m){return this.names.has(c)&&this.names.get(c).has(m)},u.registerName=function(c,m){if(L5(c),this.names.has(c))this.names.get(c).add(m);else{var _=new Set;_.add(m),this.names.set(c,_)}},u.insertRules=function(c,m,_){this.registerName(c,m),this.getTag().insertRules(L5(c),_)},u.clearNames=function(c){this.names.has(c)&&this.names.get(c).clear()},u.clearRules=function(c){this.getTag().clearGroup(L5(c)),this.clearNames(c)},u.clearTag=function(){this.tag=void 0},u.toString=function(){return function(c){for(var m=c.getTag(),_=m.length,b="",E=0;E<_;E++){var T=Zx(E);if(T!==void 0){var R=c.names.get(T),N=m.getGroup(E);if(R&&N&&R.size){var z=cc+".g"+E+'[id="'+T+'"]',G="";R!==void 0&&R.forEach(function(V){V.length>0&&(G+=V+",")}),b+=""+N+z+'{content:"'+G+`"}/*!sc*/
`}}}return b}(this)},a}(),YT=/(a)(d)/gi,Jy=function(a){return String.fromCharCode(a+(a>25?39:97))},vp=function(a,u){for(var c=u.length;c;)a=33*a^u.charCodeAt(--c);return a},tb=function(a){return vp(5381,a)},KT=tb("5.3.11"),nb=function(){function a(u,c,m){this.rules=u,this.staticRulesId="",this.isStatic=(m===void 0||m.isStatic)&&jT(u),this.componentId=c,this.baseHash=vp(KT,c),this.baseStyle=m,gp.registerId(c)}return a.prototype.generateAndInjectStyles=function(u,c,m){var _=this.componentId,b=[];if(this.baseStyle&&b.push(this.baseStyle.generateAndInjectStyles(u,c,m)),this.isStatic&&!m.hash)if(this.staticRulesId&&c.hasNameForId(_,this.staticRulesId))b.push(this.staticRulesId);else{var E=Am(this.rules,u,c,m).join(""),T=$y(vp(this.baseHash,E)>>>0);if(!c.hasNameForId(_,T)){var R=m(E,"."+T,void 0,_);c.insertRules(_,T,R)}b.push(T),this.staticRulesId=T}else{for(var N=this.rules.length,z=vp(this.baseHash,m.hash),G="",V=0;V<N;V++){var B=this.rules[V];if(typeof B=="string")G+=B;else if(B){var j=Am(B,u,c,m),H=Array.isArray(j)?j.join(""):j;z=vp(z,H+V),G+=H}}if(G){var X=$y(z>>>0);if(!c.hasNameForId(_,X)){var K=m(G,"."+X,void 0,_);c.insertRules(_,X,K)}b.push(X)}}return b.join(" ")},a}(),e6=/^\s*\/\/.*$/gm,rb=[":","[",".","#"],t6=Xs.default.createContext(),t6.Consumer,n6=Xs.default.createContext(),r6=(n6.Consumer,new gp),z5=qy(),ZT=function(){function a(u,c){var m=this;this.inject=function(_,b){b===void 0&&(b=z5);var E=m.name+b.hash;_.hasNameForId(m.id,E)||_.insertRules(m.id,E,b(m.rules,E,"@keyframes"))},this.toString=function(){return Id(12,String(m.name))},this.name=u,this.id="sc-keyframes-"+u,this.rules=c}return a.prototype.getName=function(u){return u===void 0&&(u=z5),this.name+u.hash},a}(),QT=/([A-Z])/,w=/([A-Z])/g,D=/^ms-/,W=function(a){return"-"+a.toLowerCase()},re=function(a){return a==null||a===!1||a===""},me=function(a){return Array.isArray(a)&&(a.isCss=!0),a},Ee=function(a,u,c){return c===void 0&&(c=uc),a.theme!==c.theme&&a.theme||u||c.theme},Ge=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,ft=/(^-|-$)/g,Tt=function(a){return $y(tb(a)>>>0)},zt=function(a){return typeof a=="function"||typeof a=="object"&&a!==null&&!Array.isArray(a)},xn=function(a){return a!=="__proto__"&&a!=="constructor"&&a!=="prototype"},bn=Xs.default.createContext(),bn.Consumer,On={},pr=function(a){return function u(c,m,_){if(_===void 0&&(_=uc),!(0,qx.isValidElementType)(m))return Id(1,String(m));var b=function(){return c(m,_,e0.apply(void 0,arguments))};return b.withConfig=function(E){return u(c,m,oc({},_,{},E))},b.attrs=function(E){return u(c,m,oc({},_,{attrs:Array.prototype.concat(_.attrs,E).filter(Boolean)}))},b}(Ky,a)},["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(a){pr[a]=pr(a)}),ir=function(){function a(c,m){this.rules=c,this.componentId=m,this.isStatic=jT(c),gp.registerId(this.componentId+1)}var u=a.prototype;return u.createStyles=function(c,m,_,b){var E=b(Am(this.rules,m,_,b).join(""),""),T=this.componentId+c;_.insertRules(T,T,E)},u.removeStyles=function(c,m){m.clearRules(this.componentId+c)},u.renderStyles=function(c,m,_,b){c>2&&gp.registerId(this.componentId+c),this.removeStyles(c,_),this.createStyles(c,m,_,b)},a}(),function(){function a(){var c=this;this._emitSheetCSS=function(){var m=c.instance.toString();if(!m)return"";var _=Qy();return"<style "+[_&&'nonce="'+_+'"',cc+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+m+"</style>"},this.getStyleTags=function(){return c.sealed?Id(2):c._emitSheetCSS()},this.getStyleElement=function(){var m;if(c.sealed)return Id(2);var _=((m={})[cc]="",m["data-styled-version"]="5.3.11",m.dangerouslySetInnerHTML={__html:c.instance.toString()},m),b=Qy();return b&&(_.nonce=b),[Xs.default.createElement("style",oc({},_,{key:"sc-0-0"}))]},this.seal=function(){c.sealed=!0},this.instance=new gp({isServer:!0}),this.sealed=!1}var u=a.prototype;return u.collectStyles=function(c){return this.sealed?Id(2):Xs.default.createElement(Xy,{sheet:this.instance},c)},u.interleaveWithNodeStream=function(c){return Id(3)},a}(),Te=pr});function Or(){return Or=Object.assign||function(a){for(var u=1;u<arguments.length;u++){var c=arguments[u];for(var m in c)Object.prototype.hasOwnProperty.call(c,m)&&(a[m]=c[m])}return a},Or.apply(this,arguments)}var Li=I(()=>{});function No(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}var I0=I(()=>{});function Pa(a,u){return Pa=Object.setPrototypeOf||function(c,m){return c.__proto__=m,c},Pa(a,u)}var Ji=I(()=>{});function Do(a,u){a.prototype=Object.create(u.prototype),a.prototype.constructor=a,Pa(a,u)}var Sl=I(()=>{Ji()});function mu(a){return mu=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},mu(a)}var Rm=I(()=>{});function Im(a){return Function.toString.call(a).indexOf("[native code]")!==-1}var km=I(()=>{});function Nm(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dm=I(()=>{});function Ys(a,u,c){return Nm()?Ys=Reflect.construct:Ys=function(m,_,b){var E=[null];E.push.apply(E,_);var T=Function.bind.apply(m,E),R=new T;return b&&Pa(R,b.prototype),R},Ys.apply(null,arguments)}var wl=I(()=>{Ji(),Dm()});function os(a){var u=typeof Map=="function"?new Map:void 0;return os=function(c){if(c===null||!Im(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(c))return u.get(c);u.set(c,m)}function m(){return Ys(c,arguments,mu(this).constructor)}return m.prototype=Object.create(c.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),Pa(m,c)},os(a)}var Nd=I(()=>{Rm(),Ji(),km(),wl()}),Dd=I(()=>{});function E8e(a){return a.charAt(0).toUpperCase()+a.slice(1)}function T8e(a,u){if(!a)return u.toLowerCase();var c=a.split("-");if(c.length>1)return c.splice(1,0,u),c.reduce(function(_,b){return""+_+E8e(b)});var m=a.replace(/([a-z])([A-Z])/g,"$1"+u+"$2");return a===m?""+a+u:m}function M8e(a,u){for(var c={},m=0;m<u.length;m+=1)(u[m]||u[m]===0)&&(c[T8e(a,S$[m])]=u[m]);return c}function g$(a){for(var u=arguments.length,c=new Array(u>1?u-1:0),m=1;m<u;m++)c[m-1]=arguments[m];var _=c[0],b=c[1],E=b===void 0?_:b,T=c[2],R=T===void 0?_:T,N=c[3],z=N===void 0?E:N,G=[_,E,R,z];return M8e(a,G)}function IN(a){return Math.round(a*255)}function C8e(a,u,c){return IN(a)+","+IN(u)+","+IN(c)}function JT(a,u,c,m){if(m===void 0&&(m=C8e),u===0)return m(c,c,c);var _=(a%360+360)%360/60,b=(1-Math.abs(2*c-1))*u,E=b*(1-Math.abs(_%2-1)),T=0,R=0,N=0;_>=0&&_<1?(T=b,R=E):_>=1&&_<2?(T=E,R=b):_>=2&&_<3?(R=b,N=E):_>=3&&_<4?(R=E,N=b):_>=4&&_<5?(T=E,N=b):_>=5&&_<6&&(T=b,N=E);var z=c-b/2,G=T+z,V=R+z,B=N+z;return m(G,V,B)}function A8e(a){if(typeof a!="string")return a;var u=a.toLowerCase();return FN[u]?"#"+FN[u]:a}function v$(a){if(typeof a!="string")throw new Od(3);var u=A8e(a);if(u.match(w$))return{red:parseInt(""+u[1]+u[2],16),green:parseInt(""+u[3]+u[4],16),blue:parseInt(""+u[5]+u[6],16)};if(u.match(E$)){var c=parseFloat((parseInt(""+u[7]+u[8],16)/255).toFixed(2));return{red:parseInt(""+u[1]+u[2],16),green:parseInt(""+u[3]+u[4],16),blue:parseInt(""+u[5]+u[6],16),alpha:c}}if(u.match(T$))return{red:parseInt(""+u[1]+u[1],16),green:parseInt(""+u[2]+u[2],16),blue:parseInt(""+u[3]+u[3],16)};if(u.match(M$)){var m=parseFloat((parseInt(""+u[4]+u[4],16)/255).toFixed(2));return{red:parseInt(""+u[1]+u[1],16),green:parseInt(""+u[2]+u[2],16),blue:parseInt(""+u[3]+u[3],16),alpha:m}}var _=nM.exec(u);if(_)return{red:parseInt(""+_[1],10),green:parseInt(""+_[2],10),blue:parseInt(""+_[3],10)};var b=C$.exec(u.substring(0,50));if(b)return{red:parseInt(""+b[1],10),green:parseInt(""+b[2],10),blue:parseInt(""+b[3],10),alpha:parseFloat(""+b[4])};var E=A$.exec(u);if(E){var T=parseInt(""+E[1],10),R=parseInt(""+E[2],10)/100,N=parseInt(""+E[3],10)/100,z="rgb("+JT(T,R,N)+")",G=nM.exec(z);if(!G)throw new Od(4,u,z);return{red:parseInt(""+G[1],10),green:parseInt(""+G[2],10),blue:parseInt(""+G[3],10)}}var V=P$.exec(u.substring(0,50));if(V){var B=parseInt(""+V[1],10),j=parseInt(""+V[2],10)/100,H=parseInt(""+V[3],10)/100,X="rgb("+JT(B,j,H)+")",K=nM.exec(X);if(!K)throw new Od(4,u,X);return{red:parseInt(""+K[1],10),green:parseInt(""+K[2],10),blue:parseInt(""+K[3],10),alpha:parseFloat(""+V[4])}}throw new Od(5)}function P8e(a){var u=a.red/255,c=a.green/255,m=a.blue/255,_=Math.max(u,c,m),b=Math.min(u,c,m),E=(_+b)/2;if(_===b)return a.alpha!==void 0?{hue:0,saturation:0,lightness:E,alpha:a.alpha}:{hue:0,saturation:0,lightness:E};var T,R=_-b,N=E>.5?R/(2-_-b):R/(_+b);switch(_){case u:T=(c-m)/R+(c<m?6:0);break;case c:T=(m-u)/R+2;break;default:T=(u-c)/R+4;break}return T*=60,a.alpha!==void 0?{hue:T,saturation:N,lightness:E,alpha:a.alpha}:{hue:T,saturation:N,lightness:E}}function kN(a){return P8e(v$(a))}function V5(a){var u=a.toString(16);return u.length===1?"0"+u:u}function NN(a){return V5(Math.round(a*255))}function R8e(a,u,c){return rM("#"+NN(a)+NN(u)+NN(c))}function y$(a,u,c){return JT(a,u,c,R8e)}function I8e(a,u,c){if(typeof a=="object"&&u===void 0&&c===void 0)return y$(a.hue,a.saturation,a.lightness);throw new Od(1)}function k8e(a,u,c,m){if(typeof a=="object"&&u===void 0&&c===void 0&&m===void 0)return a.alpha>=1?y$(a.hue,a.saturation,a.lightness):"rgba("+JT(a.hue,a.saturation,a.lightness)+","+a.alpha+")";throw new Od(2)}function _$(a,u,c){if(typeof a=="number"&&typeof u=="number"&&typeof c=="number")return rM("#"+V5(a)+V5(u)+V5(c));if(typeof a=="object"&&u===void 0&&c===void 0)return rM("#"+V5(a.red)+V5(a.green)+V5(a.blue));throw new Od(6)}function x$(a,u,c,m){if(typeof a=="object"&&u===void 0&&c===void 0&&m===void 0)return a.alpha>=1?_$(a.red,a.green,a.blue):"rgba("+a.red+","+a.green+","+a.blue+","+a.alpha+")";throw new Od(7)}function DN(a){if(typeof a!="object")throw new Od(8);if(I$(a))return x$(a);if(R$(a))return _$(a);if(N$(a))return k8e(a);if(k$(a))return I8e(a);throw new Od(8)}function b$(a,u,c){return function(){var m=c.concat(Array.prototype.slice.call(arguments));return m.length>=u?a.apply(this,m):b$(a,u,m)}}function eM(a){return b$(a,a.length,[])}function tM(a,u,c){return Math.max(a,Math.min(u,c))}function N8e(a,u){if(u==="transparent")return u;var c=kN(u);return DN(Or({},c,{lightness:tM(0,1,c.lightness-parseFloat(a))}))}function D8e(a,u){if(u==="transparent")return u;var c=kN(u);return DN(Or({},c,{lightness:tM(0,1,c.lightness+parseFloat(a))}))}function O8e(a,u){if(u==="transparent")return u;var c=kN(u);return DN(Or({},c,{saturation:tM(0,1,c.saturation+parseFloat(a))}))}function F8e(a,u){if(u==="transparent")return u;var c=v$(u),m=typeof c.alpha=="number"?c.alpha:1,_=Or({},c,{alpha:tM(0,1,+(m*100-parseFloat(a)*100).toFixed(2)/100)});return x$(_)}function ON(a){for(var u=arguments.length,c=new Array(u>1?u-1:0),m=1;m<u;m++)c[m-1]=arguments[m];return D$.indexOf(a)>=0&&a?Or({},g$.apply(void 0,[""].concat(c)),{position:a}):g$.apply(void 0,["",a].concat(c))}var Od,S$,FN,w$,E$,T$,M$,nM,C$,A$,P$,rM,R$,I$,k$,N$,ib,i6,iM,Fd,D$,hc=I(()=>{Li(),I0(),Sl(),Nd(),Dd(),Od=function(a){Do(u,a);function u(c){var m;return m=a.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+c+" for more information.")||this,No(m)}return u}(os(Error)),S$=["Top","Right","Bottom","Left"],FN={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},w$=/^#[a-fA-F0-9]{6}$/,E$=/^#[a-fA-F0-9]{8}$/,T$=/^#[a-fA-F0-9]{3}$/,M$=/^#[a-fA-F0-9]{4}$/,nM=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,C$=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,A$=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,P$=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,rM=function(a){return a.length===7&&a[1]===a[2]&&a[3]===a[4]&&a[5]===a[6]?"#"+a[1]+a[3]+a[5]:a},R$=function(a){return typeof a.red=="number"&&typeof a.green=="number"&&typeof a.blue=="number"&&(typeof a.alpha!="number"||typeof a.alpha>"u")},I$=function(a){return typeof a.red=="number"&&typeof a.green=="number"&&typeof a.blue=="number"&&typeof a.alpha=="number"},k$=function(a){return typeof a.hue=="number"&&typeof a.saturation=="number"&&typeof a.lightness=="number"&&(typeof a.alpha!="number"||typeof a.alpha>"u")},N$=function(a){return typeof a.hue=="number"&&typeof a.saturation=="number"&&typeof a.lightness=="number"&&typeof a.alpha=="number"},ib=eM(N8e),i6=eM(D8e),iM=eM(O8e),Fd=eM(F8e),D$=["absolute","fixed","relative","static","sticky"]});function L8e(a,u,c){return u in a?Object.defineProperty(a,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[u]=c,a}function O$(a,u){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);u&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(a,_).enumerable})),c.push.apply(c,m)}return c}function G5(a){for(var u=1;u<arguments.length;u++){var c=arguments[u]!=null?arguments[u]:{};u%2?O$(Object(c),!0).forEach(function(m){L8e(a,m,c[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):O$(Object(c)).forEach(function(m){Object.defineProperty(a,m,Object.getOwnPropertyDescriptor(c,m))})}return a}function s6(a,u){if(a==null)return{};var c={},m=Object.keys(a),_,b;for(b=0;b<m.length;b++)_=m[b],!(u.indexOf(_)>=0)&&(c[_]=a[_]);return c}var sb=I(()=>{}),F$,LN,L$=I(()=>{F$=Q(qe()),LN=(0,F$.createContext)({})});function U8e(a,u,c){return u in a?Object.defineProperty(a,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[u]=c,a}function U$(a,u){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);u&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(a,_).enumerable})),c.push.apply(c,m)}return c}function a6(a){for(var u=1;u<arguments.length;u++){var c=arguments[u]!=null?arguments[u]:{};u%2?U$(Object(c),!0).forEach(function(m){U8e(a,m,c[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):U$(Object(c)).forEach(function(m){Object.defineProperty(a,m,Object.getOwnPropertyDescriptor(c,m))})}return a}function UN(a,u){if(a==null)return{};var c={},m=Object.keys(a),_,b;for(b=0;b<m.length;b++)_=m[b],!(u.indexOf(_)>=0)&&(c[_]=a[_]);return c}function B8e(a,u){if(a){if(typeof a=="string")return B$(a,u);var c=Object.prototype.toString.call(a).slice(8,-1);if(c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set")return Array.from(a);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return B$(a,u)}}function B$(a,u){(u==null||u>a.length)&&(u=a.length);for(var c=0,m=new Array(u);c<u;c++)m[c]=a[c];return m}function z$(a,u){var c;if(typeof Symbol>"u"||a[Symbol.iterator]==null){if(Array.isArray(a)||(c=B8e(a))||u){c&&(a=c);var m=0;return function(){return m>=a.length?{done:!0}:{done:!1,value:a[m++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return c=a[Symbol.iterator](),c.next.bind(c)}var sM=I(()=>{});function z8e(a){return typeof a=="function"}var BN,V$,V8e=I(()=>{BN=Q(qe()),L$(),sM(),V$=function(a,u,c){c===void 0&&(c=u.children);var m=(0,BN.useContext)(LN);if(m.useCreateElement)return m.useCreateElement(a,u,c);if(typeof a=="string"&&z8e(c)){u.children;var _=UN(u,["children"]);return c(_)}return(0,BN.createElement)(a,u,c)}});function G8e(a,u,c){return u in a?Object.defineProperty(a,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[u]=c,a}function G$(a,u){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);u&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(a,_).enumerable})),c.push.apply(c,m)}return c}function o6(a){for(var u=1;u<arguments.length;u++){var c=arguments[u]!=null?arguments[u]:{};u%2?G$(Object(c),!0).forEach(function(m){G8e(a,m,c[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):G$(Object(c)).forEach(function(m){Object.defineProperty(a,m,Object.getOwnPropertyDescriptor(c,m))})}return a}function H8e(a,u){if(a==null)return{};var c={},m=Object.keys(a),_,b;for(b=0;b<m.length;b++)_=m[b],!(u.indexOf(_)>=0)&&(c[_]=a[_]);return c}var H$=I(()=>{});function j8e(a){return typeof a=="object"&&a!=null}var W8e=I(()=>{});function zN(a){var u;if(!j8e(a))return!1;var c=Object.getPrototypeOf(a);return c==null?!0:((u=c.constructor)===null||u===void 0?void 0:u.toString())===Object.toString()}var j$=I(()=>{W8e()});function W$(a,u){for(var c=Object.keys(a),m={},_={},b=0,E=c;b<E.length;b++){var T=E[b];u.indexOf(T)>=0?m[T]=a[T]:_[T]=a[T]}return[m,_]}function $$(a,u){if(u===void 0&&(u=[]),!zN(a.state))return W$(a,u);var c=W$(a,[].concat(u,["state"])),m=c[0],_=c[1],b=m.state,E=H8e(m,["state"]);return[o6(o6({},b),E),_]}var $8e=I(()=>{H$(),j$()});function aM(a,u){if(a===u)return!0;if(!a||!u||typeof a!="object"||typeof u!="object")return!1;var c=Object.keys(a),m=Object.keys(u),_=c.length;if(m.length!==_)return!1;for(var b=0,E=c;b<E.length;b++){var T=E[b];if(a[T]!==u[T])return!1}return!0}var VN=I(()=>{});function q$(a){return a.name==="normalizePropsAreEqualInner"?a:function(u,c){return!zN(u.state)||!zN(c.state)?a(u,c):a(o6(o6({},u.state),u),o6(o6({},c.state),c))}}var q8e=I(()=>{H$(),j$()});function X8e(a){return(0,GN.forwardRef)(a)}function Y8e(a,u){return(0,GN.memo)(a,u)}function ab(a){var u=a.as,c=a.useHook,m=a.memo,_=a.propsAreEqual,b=_===void 0?c==null?void 0:c.unstable_propsAreEqual:_,E=a.keys,T=E===void 0?(c==null?void 0:c.__keys)||[]:E,R=a.useCreateElement,N=R===void 0?V$:R,z=function(G,V){var B=G.as,j=B===void 0?u:B,H=UN(G,["as"]);if(c){var X,K=$$(H,T),te=K[0],se=K[1],pe=c(te,a6({ref:V},se)),fe=pe.wrapElement,ye=UN(pe,["wrapElement"]),Ne=((X=j.render)===null||X===void 0?void 0:X.__keys)||j.__keys,ze=Ne&&$$(H,Ne)[0],Me=ze?a6(a6({},ye),ze):ye,je=N(j,Me);return fe?fe(je):je}return N(j,a6({ref:V},H))};return z=X8e(z),m&&(z=Y8e(z,b&&q$(b))),z.__keys=T,z.unstable_propsAreEqual=q$(b||aM),z}var GN,ob=I(()=>{GN=Q(qe()),sM(),V8e(),$8e(),VN(),q8e()});function X$(a,u){(0,HN.useDebugValue)(a);var c=(0,HN.useContext)(LN);return c[a]!=null?c[a]:u}var HN,Y$=I(()=>{HN=Q(qe()),L$()});function K8e(a,u,c){u===void 0&&(u={}),c===void 0&&(c={});var m="use"+a+"Props";(0,K$.useDebugValue)(m);var _=X$(m);return _?_(u,c):c}var K$,Z8e=I(()=>{K$=Q(qe()),Y$()});function Q8e(a,u,c){u===void 0&&(u={}),c===void 0&&(c={});var m="use"+a+"Options";(0,Z$.useDebugValue)(m);var _=X$(m);return _?a6(a6({},u),_(u,c)):u}var Z$,J8e=I(()=>{Z$=Q(qe()),Y$(),sM()});function eve(a){return Array.isArray(a)?a:typeof a<"u"?[a]:[]}var tve=I(()=>{});function lb(a){var u,c,m=eve(a.compose),_=function(T,R){if(a.useOptions&&(T=a.useOptions(T,R)),a.name&&(T=Q8e(a.name,T,R)),a.compose)for(var N=z$(m),z;!(z=N()).done;){var G=z.value;T=G.__useOptions(T,R)}return T},b=function(T,R,N){if(T===void 0&&(T={}),R===void 0&&(R={}),N===void 0&&(N=!1),N||(T=_(T,R)),a.useProps&&(R=a.useProps(T,R)),a.name&&(R=K8e(a.name,T,R)),a.compose)if(a.useComposeOptions&&(T=a.useComposeOptions(T,R)),a.useComposeProps)R=a.useComposeProps(T,R);else for(var z=z$(m),G;!(G=z()).done;){var V=G.value;R=V(T,R,!0)}var B={},j=R||{};for(var H in j)j[H]!==void 0&&(B[H]=j[H]);return B};b.__useOptions=_;var E=m.reduce(function(T,R){return T.push.apply(T,R.__keys||[]),T},[]);return b.__keys=[].concat(E,((u=a.useState)===null||u===void 0?void 0:u.__keys)||[],a.keys||[]),b.unstable_propsAreEqual=a.propsAreEqual||((c=m[0])===null||c===void 0?void 0:c.unstable_propsAreEqual)||aM,b}var ub=I(()=>{Q(qe()),Z8e(),sM(),J8e(),VN(),tve()});function Q$(a,u){u===void 0&&(u=null),a&&(typeof a=="function"?a(u):a.current=u)}function J$(a,u){return(0,eq.useMemo)(function(){return a==null&&u==null?null:function(c){Q$(a,c),Q$(u,c)}},[a,u])}var eq,tq=I(()=>{eq=Q(qe())});function jN(a){if(a.tagName==="BUTTON")return!0;if(a.tagName==="INPUT"){var u=a;return nq.indexOf(u.type)!==-1}return!1}var nq,WN=I(()=>{nq=["button","color","file","image","reset","submit"]}),$N=I(()=>{}),nve=I(()=>{$N(),Q(qe())}),oM=I(()=>{$N(),Q(qe()),nve()});function rve(a){return a?a.ownerDocument||a:document}var rq=I(()=>{});function ive(a){return iq}var iq,sve=I(()=>{rq();try{iq=window}catch{}});function ave(){var a=ive();return!!(typeof a<"u"&&a.document&&a.document.createElement)}var lM,qN=I(()=>{sve(),lM=ave()}),XN,YN,KN=I(()=>{XN=Q(qe()),qN(),YN=lM?XN.useLayoutEffect:XN.useEffect});function l6(a){var u=(0,sq.useRef)(a);return YN(function(){u.current=a}),u}var sq,aq=I(()=>{sq=Q(qe()),KN()});function ove(a){return a.target===a.currentTarget}var lve=I(()=>{});function uve(a){var u=rve(a),c=u.activeElement;return c!=null&&c.nodeName?c:null}var cve=I(()=>{rq()});function oq(a,u){return a===u||a.contains(u)}var lq=I(()=>{});function hve(a){var u=uve(a);if(!u)return!1;if(oq(a,u))return!0;var c=u.getAttribute("aria-activedescendant");return c?c===a.id?!0:!!a.querySelector("#"+c):!1}var dve=I(()=>{cve(),lq()});function fve(a){return!oq(a.currentTarget,a.target)}var pve=I(()=>{lq()});function uM(a){return lM?window.navigator.userAgent.indexOf(a)!==-1:!1}var mve=I(()=>{qN()});function gve(a,u){return"matches"in a?a.matches(u):"msMatchesSelector"in a?a.msMatchesSelector(u):a.webkitMatchesSelector(u)}var vve=I(()=>{});function yve(a){var u=a;return u.offsetWidth>0||u.offsetHeight>0||a.getClientRects().length>0}function _ve(a){return gve(a,uq)&&yve(a)}var uq,xve=I(()=>{vve(),uq="input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), a[href], button:not([disabled]), [tabindex], iframe, object, embed, area[href], audio[controls], video[controls], [contenteditable]:not([contenteditable='false'])"}),cq,cM,hq=I(()=>{sb(),ob(),ub(),VN(),cq=["unstable_system"],cM=lb({name:"Role",keys:cq,propsAreEqual:function(a,u){var c=a.unstable_system,m=s6(a,["unstable_system"]),_=u.unstable_system,b=s6(u,["unstable_system"]);return c!==_&&!aM(c,_)?!1:aM(m,b)}}),ab({as:"div",useHook:cM})});function dq(a){!hve(a)&&_ve(a)&&a.focus()}function bve(a){return a.tagName==="BUTTON"||a.tagName==="INPUT"||a.tagName==="SELECT"||a.tagName==="TEXTAREA"||a.tagName==="A"}function Sve(a){return a.tagName==="BUTTON"||a.tagName==="INPUT"||a.tagName==="SELECT"||a.tagName==="TEXTAREA"}function wve(a,u,c,m){return a?u&&!c?-1:void 0:u?m:m||0}function ZN(a,u){return(0,u6.useCallback)(function(c){var m;(m=a.current)===null||m===void 0||m.call(a,c),!c.defaultPrevented&&u&&(c.stopPropagation(),c.preventDefault())},[a,u])}var u6,fq,pq,QN,Eve=I(()=>{sb(),ob(),ub(),u6=Q(qe()),tq(),WN(),oM(),aq(),KN(),dve(),pve(),mve(),xve(),hq(),fq=["disabled","focusable"],pq=uM("Mac")&&!uM("Chrome")&&(uM("Safari")||uM("Firefox")),QN=lb({name:"Tabbable",compose:cM,keys:fq,useOptions:function(a,u){var c=u.disabled;return G5({disabled:c},a)},useProps:function(a,u){var c=u.ref,m=u.tabIndex,_=u.onClickCapture,b=u.onMouseDownCapture,E=u.onMouseDown,T=u.onKeyPressCapture,R=u.style,N=s6(u,["ref","tabIndex","onClickCapture","onMouseDownCapture","onMouseDown","onKeyPressCapture","style"]),z=(0,u6.useRef)(null),G=l6(_),V=l6(b),B=l6(E),j=l6(T),H=!!a.disabled&&!a.focusable,X=(0,u6.useState)(!0),K=X[0],te=X[1],se=(0,u6.useState)(!0),pe=se[0],fe=se[1],ye=a.disabled?G5({pointerEvents:"none"},R):R;YN(function(){var yt=z.current;yt&&(bve(yt)||te(!1),Sve(yt)||fe(!1))},[]);var Ne=ZN(G,a.disabled),ze=ZN(V,a.disabled),Me=ZN(j,a.disabled),je=(0,u6.useCallback)(function(yt){var xe;(xe=B.current)===null||xe===void 0||xe.call(B,yt);var We=yt.currentTarget;if(!yt.defaultPrevented&&pq&&!fve(yt)&&jN(We)){var ae=requestAnimationFrame(function(){We.removeEventListener("mouseup",nt,!0),dq(We)}),nt=function(){cancelAnimationFrame(ae),dq(We)};We.addEventListener("mouseup",nt,{once:!0,capture:!0})}},[]);return G5({ref:J$(z,c),style:ye,tabIndex:wve(H,K,pe,m),disabled:H&&pe?!0:void 0,"aria-disabled":a.disabled?!0:void 0,onClickCapture:Ne,onMouseDownCapture:ze,onMouseDown:je,onKeyPressCapture:Me},N)}}),ab({as:"div",useHook:QN})});function Tve(a){var u=a.currentTarget;return a.isTrusted?jN(u)||u.tagName==="INPUT"||u.tagName==="TEXTAREA"||u.tagName==="A"||u.tagName==="SELECT":!1}var hM,mq,JN,Mve=I(()=>{sb(),ob(),ub(),hM=Q(qe()),WN(),oM(),aq(),lve(),Eve(),mq=["unstable_clickOnEnter","unstable_clickOnSpace"],JN=lb({name:"Clickable",compose:QN,keys:mq,useOptions:function(a){var u=a.unstable_clickOnEnter,c=u===void 0?!0:u,m=a.unstable_clickOnSpace,_=m===void 0?!0:m,b=s6(a,["unstable_clickOnEnter","unstable_clickOnSpace"]);return G5({unstable_clickOnEnter:c,unstable_clickOnSpace:_},b)},useProps:function(a,u){var c=u.onKeyDown,m=u.onKeyUp,_=s6(u,["onKeyDown","onKeyUp"]),b=(0,hM.useState)(!1),E=b[0],T=b[1],R=l6(c),N=l6(m),z=(0,hM.useCallback)(function(V){var B;if((B=R.current)===null||B===void 0||B.call(R,V),!V.defaultPrevented&&!a.disabled&&!V.metaKey&&ove(V)){var j=a.unstable_clickOnEnter&&V.key==="Enter",H=a.unstable_clickOnSpace&&V.key===" ";if(j||H){if(Tve(V))return;V.preventDefault(),j?V.currentTarget.click():H&&T(!0)}}},[a.disabled,a.unstable_clickOnEnter,a.unstable_clickOnSpace]),G=(0,hM.useCallback)(function(V){var B;if((B=N.current)===null||B===void 0||B.call(N,V),!V.defaultPrevented&&!a.disabled&&!V.metaKey){var j=a.unstable_clickOnSpace&&V.key===" ";E&&j&&(T(!1),V.currentTarget.click())}},[a.disabled,a.unstable_clickOnSpace,E]);return G5({"data-active":E||void 0,onKeyDown:z,onKeyUp:G},_)}}),ab({as:"button",memo:!0,useHook:JN})}),cb,gq,vq,yq,Cve=I(()=>{sb(),ob(),ub(),cb=Q(qe()),tq(),WN(),oM(),Mve(),gq=[],vq=lb({name:"Button",compose:JN,keys:gq,useProps:function(a,u){var c=u.ref,m=s6(u,["ref"]),_=(0,cb.useRef)(null),b=(0,cb.useState)(void 0),E=b[0],T=b[1],R=(0,cb.useState)("button"),N=R[0],z=R[1];return(0,cb.useEffect)(function(){var G=_.current;G&&(jN(G)||(G.tagName!=="A"&&T("button"),z(void 0)))},[]),G5({ref:J$(_,c),role:E,type:N},m)}}),yq=ab({as:"button",memo:!0,useHook:vq})}),_q,xq,bq,Ave=I(()=>{sb(),ob(),ub(),hq(),_q=[],xq=lb({name:"Group",compose:cM,keys:_q,useProps:function(a,u){return G5({role:"group"},u)}}),bq=ab({as:"div",useHook:xq})});function Pve(){return lM?document.body:null}var Sq,c6,Rve=I(()=>{Sq=Q(qe()),KN(),qN(),Q(mo()),c6=(0,Sq.createContext)(Pve())}),eD,Ive=I(()=>{typeof window<"u"&&(eD={get passive(){}},window.addEventListener("testPassive",null,eD),window.removeEventListener("testPassive",null,eD))}),H5=I(()=>{Q(qe()),oM(),Cve(),Ave(),Q(mo()),Rve(),Ive(),$N()});function Ii(a){let u=(0,tD.useMemo)(()=>{let _=a;return{get current(){return _},set current(b){_=b,m(b)}}},[]),[c,m]=(0,tD.useState)(()=>a);return[u,c]}var tD,Ui=I(()=>{tD=Q(qe())});function kve(a){return u=>k0.default.createElement(Aq,null,k0.default.createElement(a,P({},u)))}var k0,wq,Eq,Fi,h6,Tq,Mq,Cq,nD,rD,Aq,Bi=I(()=>{hc(),Ft(),Ft(),k0=Q(qe()),wq=Q(mo()),H5(),Ui(),Fi=e0(Eq||(Eq=J([`
  #pointer-root & {
    pointer-events: none;
  }
  #pointer-root.normal & {
    pointer-events: auto;
  }
`]))),h6={panel:{bg:"#282b2f",head:{title:{color:"#bbb"},punctuation:{color:"#808080"}},body:{compoudThing:{label:{get color(){return i6(.6,h6.panel.bg)}}}}}},Mq=typeof window<"u"?$x(Tq||(Tq=J([`
  :host {
    all: initial;
    color: white;
    font: 11px -apple-system, BlinkMacSystemFont, Segoe WPC, Segoe Editor,
      HelveticaNeue-Light, Ubuntu, Droid Sans, sans-serif;
  }

  * {
    padding: 0;
    margin: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    list-style: none;
  }
`]))):{},nD=Te.div(Cq||(Cq=J([`
  z-index: 51;
  position: fixed;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  pointer-events: none;
`]))),rD=a=>k0.default.createElement(Xy,{disableVendorPrefixes:!0,target:a.target},k0.default.createElement(k0.default.Fragment,null,k0.default.createElement(Mq,null),a.children)),Aq=a=>{let[u,c]=(0,k0.useState)(null),[m,_]=(0,k0.useState)(null);(0,k0.useLayoutEffect)(()=>{if(!u)return;let{parentNode:T}=u;if(!T)return;let R=T.shadowRoot?parent.shadowRoot:T.attachShadow({mode:"open"});_(R)},[u]);let[b,E]=Ii(void 0);return m?wq.default.createPortal(k0.default.createElement(rD,{target:m},k0.default.createElement(k0.default.Fragment,null,k0.default.createElement(nD,{ref:b}),k0.default.createElement(c6.Provider,{value:E},a.children))),m):k0.default.createElement("template",{ref:c,"shadow-root":"open"},a.children)}}),d6,Pq,Rq,I9,Iq,hb,kq,Nq,dM,Dq,iD,yp,Om=I(()=>{Bi(),Ft(),d6={get outlinePanel(){return 1},get propsPanel(){return d6.outlinePanel},get sequenceEditorPanel(){return this.outlinePanel-1},get toolbar(){return this.outlinePanel+1},get pluginPanes(){return this.sequenceEditorPanel-1}},Pq=h6.panel.bg,I9=Te.span(Rq||(Rq=J([`
  white-space: nowrap;
`]))),hb=Te.span(Iq||(Iq=J([`
  white-space: nowrap;
  color: `,`;
`])),h6.panel.head.punctuation.color),Nq=Te.div(kq||(kq=J([`
  background: `,`;
  flex-grow: 1;
  overflow-y: scroll;
  padding: 0;
`])),Pq),dM=18,iD=Te.div(Dq||(Dq=J([`
  height: `,`px;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  padding: 0 10px;
  position: relative;
  color: #adadadb3;
  border-bottom: 1px solid rgb(0 0 0 / 13%);
  background-color: #25272b;
  font-size: 10px;
  font-weight: 500;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
`])),dM),yp=100}),Oq,Ld,f6=I(()=>{Oq=()=>{},Ld=Oq});function Nve(a){return sD.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),sD.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.775 2.781a.5.5 0 01.5.5v1.7H4.67c.108-.957.92-1.7 1.905-1.7h6.608a1.917 1.917 0 110 3.834H6.574c-.78 0-1.452-.466-1.751-1.135H2.275v5.03h2.39a2.032 2.032 0 012.023-1.854h6.38a2.031 2.031 0 110 4.063h-6.38c-.83 0-1.543-.497-1.858-1.21H1.775a.5.5 0 01-.5-.5V3.281a.5.5 0 01.5-.5zm4.799 1.5h6.608a.917.917 0 110 1.834H6.574a.917.917 0 110-1.834zm.114 5.875h6.38a1.031 1.031 0 110 2.063h-6.38a1.032 1.032 0 110-2.063z",fill:"currentColor"}))}var sD,aD,Dve=I(()=>{sD=Q(qe()),aD=Nve});function Ove(a){return oD.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),oD.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 10.5L4 6.654 5.2 5.5 8 8.385 10.8 5.5 12 6.654 8 10.5z",fill:"currentColor"}))}var oD,Fq,Fve=I(()=>{oD=Q(qe()),Fq=Ove});function Lve(a){return lD.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),lD.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.5 3c-1.072 0-1.969.904-1.969 1.969 0 1 .929 1.968 1.969 1.968h9A1.969 1.969 0 1012.5 3h-9zm9 1H5.531v1.938H12.5A.969.969 0 0012.5 4zM3.5 9.14a1.969 1.969 0 000 3.938h9a1.969 1.969 0 100-3.937h-9zm9 1H8.406v1.938H12.5a.969.969 0 100-1.937z",fill:"currentColor"}))}var lD,Lq,Uve=I(()=>{lD=Q(qe()),Lq=Lve});function Bve(a){return uD.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),uD.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M.166 7.994a2.26 2.26 0 114.518 0 2.26 2.26 0 01-4.518 0zM2.425 6.91a1.085 1.085 0 100 2.17 1.085 1.085 0 000-2.17zM5.74 7.994a2.26 2.26 0 114.519 0 2.26 2.26 0 01-4.519 0zM8 6.91a1.085 1.085 0 100 2.17 1.085 1.085 0 000-2.17zM13.575 5.735a2.26 2.26 0 100 4.519 2.26 2.26 0 000-4.52zm-1.086 2.26a1.085 1.085 0 112.171 0 1.085 1.085 0 01-2.17 0z",fill:"currentColor"}))}var uD,Uq,zve=I(()=>{uD=Q(qe()),Uq=Bve});function Vve(a){return cD.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),cD.createElement("path",{d:"M8.339 4.5l-2.055.644 4.451 1.393v2.748l-2.966.928-2.504-.783V6.738l2.42.758 2.055-.644-4.458-1.395L4 5.858v4.463L7.768 11.5 12 10.175V5.646L8.339 4.5z",fill:"currentColor"}))}var cD,hD,Gve=I(()=>{cD=Q(qe()),hD=Vve});function Hve(a){return dD.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),dD.createElement("path",{d:"M8 1.57c-.416 0-.752.36-.752.804v.482c-1.715.372-3.006 1.994-3.006 3.938v.473c0 1.18-.407 2.32-1.14 3.205l-.173.208a.85.85 0 00-.125.864.75.75 0 00.686.475h9.019a.752.752 0 00.686-.475.845.845 0 00-.125-.864l-.174-.208a5.026 5.026 0 01-1.139-3.205v-.473c0-1.944-1.291-3.566-3.006-3.938v-.482c0-.445-.336-.804-.752-.804zm1.063 12.39c.282-.301.44-.71.44-1.138H6.496c0 .428.158.837.44 1.138.281.302.664.47 1.063.47.4 0 .783-.168 1.064-.47z",fill:"currentColor"}))}var dD,fM,jve=I(()=>{dD=Q(qe()),fM=Hve});function Wve(a){return fD.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),fD.createElement("path",{d:"M6.8 11.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6zm6-7.2h-2.4v-.6A1.8 1.8 0 008.6 2H7.4a1.8 1.8 0 00-1.8 1.8v.6H3.2a.6.6 0 100 1.2h.6v6.6A1.8 1.8 0 005.6 14h4.8a1.8 1.8 0 001.8-1.8V5.6h.6a.6.6 0 100-1.2zm-6-.6a.6.6 0 01.6-.6h1.2a.6.6 0 01.6.6v.6H6.8v-.6zm4.2 8.4a.6.6 0 01-.6.6H5.6a.6.6 0 01-.6-.6V5.6h6v6.6zm-1.8-.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6z",fill:"currentColor"}))}var fD,pD,$ve=I(()=>{fD=Q(qe()),pD=Wve}),db=I(()=>{Dve(),Fve(),Uve(),zve(),Gve(),jve(),$ve()}),_p,Bq,pM,zq,Vq,Gq,Hq,jq,Wq,$q,qq,Xq,Yq,Kq,Zq,Qq,Jq,eX,fb,mM=I(()=>{_p=Q(qe()),Ft(),f6(),Bi(),db(),pM=Te.li(Bq||(Bq=J([`
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  justify-content: flex-start;
  flex-direction: column;
  align-items: flex-start;
`]))),Vq=Te.div(zq||(zq=J([""]))),Hq=Te(Vq)(Gq||(Gq=J([`
  position: relative;
  margin-top: 2px;
  margin-bottom: 2px;
  margin-left: calc(4px + var(--depth) * 16px);
  padding-left: 4px;
  padding-right: 8px;
  gap: 4px;
  height: 21px;
  line-height: 0;
  box-sizing: border-box;
  display: flex;
  flex-wrap: nowrap;
  align-items: center;
  pointer-events: none;
  white-space: nowrap;

  border-radius: 2px;
  box-shadow: 0 3px 4px -1px rgba(0, 0, 0, 0.48);

  color: rgba(255, 255, 255, 0.9);
  background: rgba(40, 43, 47, 0.65);
  backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);

  &.descendant-is-selected {
    background: rgba(29, 53, 59, 0.7);
  }

  `,`;
  &:not(.not-selectable):not(.selected):hover {
    background: rgba(59, 63, 69, 0.9);

    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &:not(.not-selectable):not(.selected):active {
    background: rgba(82, 88, 96, 0.9);
    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &.selected {
    background: rgba(30, 88, 102, 0.7);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Fi),Wq=e0(jq||(jq=J([`
  font-weight: 500;
  font-size: 11px;
  & {
  }
`]))),qq=Te.span($q||($q=J([`
  `,`;

  `,`;
  position: relative;
  // Compensate for border bottom
  top: 0.5px;
  display: flex;
  height: 20px;
  align-items: center;
  box-sizing: border-box;
`])),Wq,Fi),Yq=Te.div(Xq||(Xq=J([`
  font-weight: 500;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  opacity: 0.99;
`]))),Zq=Te.span(Kq||(Kq=J([`
  font-size: 9px;
  position: relative;
  display: block;
  transition: transform 0.1s ease-out;

  &:hover {
    transform: rotate(-20deg);
  }

  `,`.collapsed & {
    transform: rotate(-90deg);

    &:hover {
      transform: rotate(-70deg);
    }
  }
`])),pM),Jq=Te.ul(Qq||(Qq=J([`
  margin: 0;
  padding: 0;
  list-style: none;

  `,`.collapsed & {
    display: none;
  }
`])),pM),eX=({label:a,children:u,depth:c,select:m,selectionStatus:_,labelDecoration:b,collapsed:E=!1,setIsCollapsed:T})=>{let R=u!==void 0;return _p.default.createElement(pM,{style:{"--depth":c},className:E?"collapsed":""},_p.default.createElement(Hq,{className:_,onClick:m??Ld,"data-header":!0},_p.default.createElement(Yq,null,R?_p.default.createElement(Zq,{onClick:N=>{N.stopPropagation(),N.preventDefault(),T==null||T(!E)}},_p.default.createElement(Fq,null)):_p.default.createElement(hD,null)),_p.default.createElement(qq,null,_p.default.createElement("span",null,a)),b),R&&_p.default.createElement(Jq,null,u))},fb=eX});function qve(a){return Object.keys(a)}function Xve(a){return Object.keys((0,xp.val)(a.sheetTemplatesP))}function Yve(){let a=dp(k9().filter(u=>Dt(u)||qt(u)).map(u=>qt(u)?u.sheet:u))[0];if(a)return a.getSequence()}var xp,k9,tX,N9=I(()=>{xp=mn(),oi(),Ua(),Ae(),k9=()=>{var a;let u=(0,xp.val)(Se().projectsP),c=((a=(0,xp.val)(Se().atomP.historic.panels.outlinePanel.selection))!=null?a:[]).map(m=>{let _=u[m.projectId];if(!_)return;if(m.type==="Project")return _;if(!(0,xp.val)(_.sheetTemplatesP[m.sheetId]))return;let b=tX(_,m.sheetId);if(!b)return;if(m.type==="Sheet")return b;let E=(0,xp.val)(b.objectsP[m.objectKey]);if(E)return E});return dp(c.filter(m=>typeof m<"u"))},tX=(a,u)=>{let c=Se().atomP.historic.projects.stateByProjectId[a.address.projectId],m=(0,xp.val)(c.stateBySheetId[u].selectedInstanceId),_=(0,xp.val)(a.sheetTemplatesP[u]);if(_){if(m)return(0,xp.val)(_.instancesP[m]);{let b=(0,xp.val)(_.instancesP);return b[qve(b)[0]]}}}}),nX,rX,Kve=I(()=>{Ae(),nX=Q(qe()),mM(),tr(),N9(),rX=({sheetObject:a,depth:u,overrideLabel:c})=>{let m=()=>{Se().transaction(({stateEditors:b})=>{b.studio.historic.panels.outline.selection.set([a])})},_=Gr(()=>k9(),[]);return nX.default.createElement(fb,{select:m,label:c??a.address.objectKey,depth:u,selectionStatus:_.includes(a)?"selected":"not-selected"})}});function mD(a){var u;let c=a.type==="namespace"?"namespace:".concat(a.sheet.address.sheetId,":").concat(a.path.join("/")):a.type==="Theatre_Project"?"project":a.type==="Theatre_Sheet"?"sheetInstance:".concat(a.address.sheetId,":").concat(a.address.sheetInstanceId):"unknown",m=a.type==="namespace"?a.sheet.address.projectId:a.address.projectId,_=(u=qr(Se().atomP.ahistoric.projects.stateByProjectId[m].collapsedItemsInOutline[c]))!=null?u:!1,b=(0,iX.useCallback)(E=>{Se().transaction(({stateEditors:T})=>{T.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline.set({projectId:m,isCollapsed:E,itemKey:c})})},[c]);return{collapsed:_,setCollapsed:b}}var iX,gD=I(()=>{iX=Q(qe()),Ae(),tr()});function sX(a){return bp.default.createElement(bp.default.Fragment,null,[...a.namespace.entries()].map(([u,{object:c,nested:m}])=>bp.default.createElement(Zve,{key:u,label:u,object:c,nested:m,visualIndentation:a.visualIndentation,path:a.path,sheet:a.sheet})))}function Zve(a){let{nested:u,label:c,object:m,sheet:_}=a,{collapsed:b,setCollapsed:E}=mD({type:"namespace",sheet:_,path:[...a.path,c]}),T=u&&bp.default.createElement(sX,{namespace:u,path:[...a.path,c],key:"namespaceTree("+c+")",visualIndentation:a.visualIndentation+1,sheet:_}),R=m&&bp.default.createElement(rX,{depth:a.visualIndentation,key:"objectPath("+m.address.objectKey+")",sheetObject:m,overrideLabel:c});return bp.default.createElement(bp.default.Fragment,{key:"".concat(c," - ").concat(a.visualIndentation)},R,T&&bp.default.createElement(fb,{selectionStatus:"not-selectable",label:c,key:"baseItem(".concat(c,")"),depth:a.visualIndentation,children:T,collapsed:b,setIsCollapsed:E}))}function aX(a,u,c=Qve(u)){let[m,..._]=c,b=a.get(m);b||(b={nested:void 0,object:void 0,path:[...c]},a.set(m,b)),_.length===0?(console.assert(!b.object,"expect not to have existing object with same name",{existing:b,object:u}),b.object=u):(b.nested||(b.nested=new Map),aX(b.nested,u,_))}function Qve(a){let u=vD.get(a);return u||(u=a.address.objectKey.split(hX),console.assert(u.length>0,"expected not empty"),vD.set(a,u)),u}var oX,bp,lX,uX,cX,hX,vD,Jve=I(()=>{tr(),oX=mn(),bp=Q(qe()),Ft(),Kve(),mM(),gD(),Te.li(lX||(lX=J([`
  color: `,`;
`])),a=>a.isSelected?"white":"hsl(1, 1%, 80%)"),uX=({sheet:a,depth:u})=>Gr(()=>{let c=(0,oX.val)(a.objectsP),m=Object.values(c).filter(b=>b!=null),_=new Map;return m.forEach(b=>{aX(_,b)}),bp.default.createElement(sX,{namespace:_,visualIndentation:u,path:[],sheet:a})},[a,u]),cX=uX,hX=/\s*\/\s*/g,vD=new WeakMap}),p6,dX,fX,pX,mX,gX,vX,eye=I(()=>{Ae(),N9(),tr(),p6=Q(qe()),Ft(),Jve(),mM(),gD(),fX=Te.div(dX||(dX=J([`
  display: flex;
`]))),Te.li(pX||(pX=J([`
  color: `,`;
`])),a=>a.isSelected?"white":"hsl(1, 1%, 80%)"),gX=Te.div(mX||(mX=J([""]))),vX=({sheet:a,depth:u})=>{let{collapsed:c,setCollapsed:m}=mD(a),_=(0,p6.useCallback)(()=>{Se().transaction(({stateEditors:b})=>{b.studio.historic.panels.outline.selection.set([a])})},[a]);return Gr(()=>{let b=k9();return p6.default.createElement(fb,{depth:u,select:_,setIsCollapsed:m,collapsed:c,selectionStatus:b.some(E=>E===a)?"selected":b.some(E=>E.type==="Theatre_SheetObject"&&E.sheet===a)?"descendant-is-selected":"not-selected",label:p6.default.createElement(fX,null,a.address.sheetId,": ",a.address.sheetInstanceId)},p6.default.createElement(gX,null,p6.default.createElement(cX,{depth:u+1,sheet:a,key:"objectList"+a.address.sheetInstanceId})))},[u,c])}}),yD,m6,yX,_X,xX,bX,tye=I(()=>{tr(),yD=mn(),m6=Q(qe()),Ft(),eye(),Te.div(yX||(yX=J([`
  display: flex;
`]))),Te.li(_X||(_X=J([`
  color: `,`;
`])),a=>a.isSelected?"white":"hsl(1, 1%, 80%)"),Te.div(xX||(xX=J([""]))),bX=({sheetId:a,depth:u,project:c})=>Gr(()=>{let m=(0,yD.val)(c.sheetTemplatesP[a]);if(!m)return m6.default.createElement(m6.default.Fragment,null);let _=(0,yD.val)(m.instancesP);return m6.default.createElement(m6.default.Fragment,null,Object.entries(_).map(([b,E])=>m6.default.createElement(vX,{key:E.address.sheetInstanceId,sheet:E,depth:u})))},[u,a,c])}),gM,SX,wX,nye=I(()=>{N9(),tr(),gM=Q(qe()),tye(),SX=({project:a,depth:u})=>Gr(()=>{if(!a)return null;let c=Xve(a);return gM.default.createElement(gM.default.Fragment,null,c.map(m=>gM.default.createElement(bX,{depth:u,sheetId:m,key:"sheet-".concat(m),project:a})))},[a,u]),wX=SX}),pb,EX,TX,MX,CX,AX,rye=I(()=>{pb=Q(qe()),mM(),nye(),Ae(),tr(),N9(),EX=mn(),Ft(),gD(),MX=Te.div(TX||(TX=J([`
  color: #ff6363;
  margin-left: 11px;
  background: #4c282d;
  padding: 2px 8px;
  border-radius: 2px;
  font-size: 10px;
  box-shadow: 0 2px 8px -4px black;
`]))),CX=({depth:a,project:u})=>{let c=Gr(()=>k9(),[]),m=Gr(()=>{let T=u.address.projectId,R=(0,EX.val)(Se().atomP.ephemeral.coreByProject[T].loadingState);return(R==null?void 0:R.type)==="browserStateIsNotBasedOnDiskState"},[u]),_=(0,pb.useCallback)(()=>{Se().transaction(({stateEditors:T})=>{T.studio.historic.panels.outline.selection.set([u])})},[u]),{collapsed:b,setCollapsed:E}=mD(u);return pb.default.createElement(fb,{depth:a,label:u.address.projectId,setIsCollapsed:E,collapsed:b,labelDecoration:m?pb.default.createElement(MX,null,"Has Conflicts"):null,children:pb.default.createElement(wX,{project:u,depth:a+1}),selectionStatus:c.includes(u)?"selected":c.some(T=>T.address.projectId===u.address.projectId)?"descendant-is-selected":"not-selected",select:_})},AX=CX}),PX,_D,RX,IX,kX,NX,iye=I(()=>{PX=mn(),tr(),Ae(),_D=Q(qe()),Ft(),rye(),IX=Te.ul(RX||(RX=J([`
  list-style: none;
  margin: 0;
  padding: 0;
  padding-right: 4px;
`]))),kX=a=>Gr(()=>{let u=(0,PX.val)(Se().projectsP);return _D.default.createElement(IX,null,Object.keys(u).map(c=>{let m=u[c];return _D.default.createElement(AX,{depth:0,project:m,key:"projectListItem-".concat(c)})}))},[]),NX=kX});function DX(a){let[u,c]=(0,xD.useState)(!1);return(0,xD.useEffect)(()=>{let m=b=>{let E=u?200:50,T=56,R=a==="left"?b.x<E:b.x>window.innerWidth-E;R&&(R=b.y>T),c(!!R)};document.addEventListener("mousemove",m);let _=()=>{c(!1)};return document.addEventListener("mouseleave",_),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseleave",_)}},[u]),u}var xD,OX=I(()=>{xD=Q(qe())}),mb,g6,bD,FX,LX,UX,BX,vM,gb,zX,sye=I(()=>{mb=Q(qe()),Ft(),Om(),iye(),tr(),Ae(),OX(),g6=mn(),Bi(),bD="44px",LX=Te.div(FX||(FX=J([`
  `,`;
  background-color: transparent;
  position: absolute;
  left: 8px;
  z-index: `,`;

  top: calc(`,` + 8px);
  height: fit-content;
  max-height: calc(100% - `,`);
  overflow-y: scroll;
  overflow-x: hidden;
  padding: 0;
  user-select: none;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;

  display: `,`;

  &:hover {
    display: block;
  }

  // Create a small buffer on the bottom to aid selecting the bottom item in a long, scrolling list
  &::after {
    content: '';
    display: block;
    height: 20px;
  }
`])),Fi,d6.outlinePanel,bD,bD,({pin:a})=>a?"block":"none"),UX=()=>{var a;let u=(a=qr(Se().atomP.ahistoric.pinOutline))!=null?a:!0,c=qr(zX),m=DX("left");return(0,mb.useLayoutEffect)(()=>{vM.set(m)},[m]),(0,mb.useEffect)(()=>()=>{gb.set(!1),vM.set(!1)},[]),mb.default.createElement(LX,{pin:u||c,onMouseEnter:()=>{gb.set(!0)},onMouseLeave:()=>{gb.set(!1)}},mb.default.createElement(NX,null))},BX=UX,vM=new g6.Atom(!1),gb=new g6.Atom(!1),zX=(0,g6.prism)(()=>{let a=(0,g6.val)(gb.prism),u=(0,g6.val)(vM.prism);return a||u})}),VX,GX,HX,aye=I(()=>{Ft(),GX=Te.input.attrs({type:"checkbox"})(VX||(VX=J([`
  outline: none;
`]))),HX=GX});function oye({propConfig:a,editingTools:u,value:c,autoFocus:m}){let _=(0,SD.useCallback)(b=>{u.permanentlySetValue(!!b.target.checked)},[a,u]);return SD.default.createElement(WX,{checked:c,onChange:_,autoFocus:m})}var SD,jX,WX,$X,lye=I(()=>{SD=Q(qe()),Ft(),aye(),WX=Te(HX)(jX||(jX=J([`
  margin-left: 6px;

  :focus {
    outline: 1px solid #555;
  }
`]))),$X=oye});function yM(a){return u=>{a.forEach(c=>{typeof c=="function"?c(u):c!=null&&(c.current=u)})}}var _M=I(()=>{});function wD(a,u,c){(0,qX.useEffect)(()=>{if(!a||c===!1)return;let m=Array.isArray(a)?a.filter(b=>b):[a],_=b=>{m.every(E=>!b.composedPath().includes(E))&&u(b)};return window.addEventListener("mousedown",_,{capture:!0,passive:!1}),()=>{window.removeEventListener("mousedown",_,{capture:!0,passive:!1})}},[a,c])}var qX,ED=I(()=>{qX=Q(qe())}),Fm,XX,Lm,YX,KX,ZX,QX,TD,JX,mh,eY,dc=I(()=>{Fm=Q(qe()),Ft(),XX="pointer-root",Lm="--lockedCursor",KX=Te.div(YX||(YX=J([`
  pointer-events: auto;
  &.normal {
    pointer-events: none;
  }
`]))),QX=Te.div(ZX||(ZX=J([`
  position: absolute;
  inset: 0;
  pointer-events: none;

  #pointer-root:not(.normal) > & {
    pointer-events: auto;
  }
`]))),TD=(0,Fm.createContext)({}),JX=a=>{var u,c,m,_;let[b,E]=(0,Fm.useState)([]),T=(0,Fm.useMemo)(()=>({getLock:(N,z)=>{let G={className:N,cursor:z};return E(V=>[...V,G]),()=>{E(V=>V.filter(B=>B!==G))}}}),[]),R=(c=(u=b[0])==null?void 0:u.cursor)!=null?c:"";return Fm.default.createElement(TD.Provider,{value:T},Fm.default.createElement(KX,{id:XX,className:((_=(m=b[0])==null?void 0:m.className)!=null?_:"normal")+" "+a.className},Fm.default.createElement(QX,{style:{cursor:R,[Lm]:R}},a.children)))},mh=(a,u,c)=>{let m=(0,Fm.useContext)(TD);(0,Fm.useLayoutEffect)(()=>{if(a)return m.getLock(u,c)},[a,u,c])},eY=JX});function tY(a){return vb.default.createElement(MD.Provider,{value:a.logger},a.children)}function D9(a,u){let c=(0,vb.useContext)(MD);return(0,vb.useMemo)(()=>a?c.named(a,u):c,[c,a,u])}var vb,MD,O9=I(()=>{vb=Q(qe()),MD=vb.default.createContext(null)});function uye(){let a=D9("PointerCapturing"),u=Ud.default.useRef(null),c=()=>u.current!=null;return m=>{let _,b=E=>(_=E,u.current=E,E);return{capturing:{capturePointer(E){if(a._debug("Capturing pointer",{forDebugName:m,reason:E}),u.current!=null)throw new Error('"'.concat(m,'" attempted capturing pointer for "').concat(E,'" while already captured by "').concat(u.current.debugOwnerName,'" for "').concat(u.current.debugReason,'"'));let T=b({debugOwnerName:m,debugReason:E});return{isCapturing(){return T===u.current},release(){return T===u.current?(a._debug("Releasing pointer",{forDebugName:m,reason:E}),b(null),!0):!1}}},isPointerBeingCaptured:c},forceRelease(){_&&u.current===_&&(a._debug("Force releasing pointer",{localCapture:_}),b(null))}}}}function cye(a){let u=uye();return Ud.default.createElement(CD.Provider,{value:u},Ud.default.createElement(rY,{children:a.children}))}function nY(a){let u=(0,Ud.useContext)(CD),c=(0,Ud.useMemo)(()=>u(a),[a,u]);return(0,Ud.useEffect)(()=>()=>{c.forceRelease()},[c]),c.capturing}var Ud,CD,rY,AD=I(()=>{Ud=Q(qe()),O9(),CD=Ud.default.createContext(null),rY=Ud.default.memo(({children:a})=>Ud.default.createElement(Ud.default.Fragment,null,a))}),PD,hye=I(()=>{PD=typeof window<"u"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)});function fa(a,u){let c=(0,v6.useRef)(u);c.current=u;let m=u.shouldPointerLock&&!PD,_=(0,v6.useRef)({domDragStarted:!1}),{capturePointer:b}=nY("useDrag for ".concat(u.debugName)),E=(0,v6.useRef)({onDrag:Ld,onDragEnd:Ld,onClick:Ld}),T=(0,v6.useRef)(),[R,N]=Ii(!1);return(0,v6.useLayoutEffect)(()=>{if(!a)return;let z=()=>{let te=_.current.domDragStarted&&_.current.detection.detected;R.current!==te&&(R.current=te)},G=te=>{if(!_.current.domDragStarted)return;let se=_.current;if(!dye(te,se)&&(se.detection.detected||(se.detection.totalDistanceMoved+=Math.abs(te.movementY)+Math.abs(te.movementX),se.detection.totalDistanceMoved>iY&&(m&&a.requestPointerLock(),se.detection={detected:!0,dragMovement:{x:0,y:0},dragEventCount:0},z())),se.detection.detected)){se.detection.dragEventCount+=1;let{dragMovement:pe}=se.detection;if(m)pe.x+=te.movementX,pe.y+=te.movementY;else{let{startPos:fe}=se;pe.x=te.screenX-fe.x,pe.y=te.screenY-fe.y}E.current.onDrag(pe.x,pe.y,te,te.movementX,te.movementY)}},V=te=>{if(j(),!_.current.domDragStarted)return;let se=_.current.detection.detected;_.current={domDragStarted:!1},u.shouldPointerLock&&!PD&&document.exitPointerLock(),E.current.onDragEnd(se),window.focus(),se||E.current.onClick(te),z()},B=()=>{document.addEventListener("mousemove",G),document.addEventListener("mouseup",V)},j=()=>{var te;(te=T.current)==null||te.release(),document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",V)},H=te=>{c.current.disabled||_.current.domDragStarted&&_.current.detection.detected&&(c.current.dontBlockMouseDown||(te.stopPropagation(),te.preventDefault()),_.current.detection={detected:!1,totalDistanceMoved:0},z())},X=te=>{var se,pe,fe,ye;(se=T.current)==null||se.release();let Ne=c.current;if(Ne.disabled===!0||!((pe=Ne.buttons)!=null?pe:[0]).includes(te.button))return;let ze=Ne.onDragStart(te);ze!==!1&&(E.current.onDrag=ze.onDrag,E.current.onDragEnd=(fe=ze.onDragEnd)!=null?fe:Ld,E.current.onClick=(ye=ze.onClick)!=null?ye:Ld,T.current=b("Drag start"),Ne.dontBlockMouseDown||(te.stopPropagation(),te.preventDefault()),_.current={domDragStarted:!0,startPos:{x:te.screenX,y:te.screenY},detection:{detected:!1,totalDistanceMoved:0}},z(),B())},K=te=>{X(te)};return a.addEventListener("mousedown",K),a.addEventListener("click",H),()=>{var te,se;j(),a.removeEventListener("mousedown",K),a.removeEventListener("click",H),_.current.domDragStarted&&((se=(te=E.current).onDragEnd)==null||se.call(te,_.current.detection.detected)),_.current={domDragStarted:!1},z()}},[a]),mh(N&&!!u.lockCSSCursorTo,"dragging",u.lockCSSCursorTo),[N]}function dye(a,u){return(!u.detection.detected||u.detection.detected&&u.detection.dragEventCount<3)&&(Math.abs(a.movementX)>RD||Math.abs(a.movementY)>RD)}var v6,iY,RD,Qa=I(()=>{v6=Q(qe()),dc(),AD(),f6(),hye(),Ui(),iY=3,RD=100});function fye(a){return isNaN(a)?"NaN":Oy(a)?a.toFixed(0):By(a,3).toString()}var sY,aY,Um,oY,xM,lY,uY,cY,hY,dY,fY,pY,mY,bM,ID=I(()=>{Ua(),sY=Q(qe()),aY=Q(qe()),Um=Q(qe()),Ft(),_M(),Ui(),ED(),Qa(),xM=Te.div(oY||(oY=J([`
  height: 100%;
  width: 100%;
  position: relative;
  z-index: 0;
  box-sizing: border-box;
  display: flex;
  align-items: center;

  &:after {
    position: absolute;
    inset: 1px 0 2px;
    display: block;
    content: ' ';
    background-color: transparent;
    border: 1px solid transparent;
    z-index: -2;
    box-sizing: border-box;
    border-radius: 1px;
  }

  &:hover,
  &.dragging,
  &.editingViaKeyboard {
    &:after {
      background-color: #10101042;
      border-color: #00000059;
    }
  }
`]))),uY=Te.input(lY||(lY=J([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: ew-resize;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;

  &:focus {
    cursor: text;
  }
`]))),hY=Te.div(cY||(cY=J([`
  position: absolute;
  inset: 3px 2px 4px;
  transform: scale(var(--percentage), 1);
  transform-origin: top left;
  background-color: #2d5561;
  z-index: -1;
  border-radius: 2px;
  pointer-events: none;

  `,".dragging &, ",`.noFocus:hover & {
    background-color: #338198;
  }
`])),xM,xM),fY=Te.div(dY||(dY=J([`
  display: contents;
`]))),pY=a=>!0,mY=a=>{var u;let[c]=Ii({mode:"noFocus"}),m=(u=a.isValid)!=null?u:pY,_=(0,Um.useRef)(a);_.current=a;let b=(0,Um.useRef)(null);wD(b.current,()=>{b.current.blur()},c.current.mode==="editingViaKeyboard");let E=(0,Um.useRef)(null),T=(0,Um.useMemo)(()=>{let X=ze=>{let Me=ze.target,{value:je}=Me,yt=c.current;c.current=$(P({},yt),{currentEditedValueInString:je});let xe=parseFloat(je);!isFinite(xe)||!m(xe)||_.current.temporarilySetValue(xe)},K=()=>{c.current.mode==="editingViaKeyboard"&&(te(),c.current={mode:"noFocus"}),a.onBlur&&a.onBlur()},te=()=>{let ze=c.current,Me=parseFloat(ze.currentEditedValueInString);!isFinite(Me)||!m(Me)||ze.valueBeforeEditing===Me?_.current.discardTemporaryValue():_.current.permanentlySetValue(Me)},se=ze=>{ze.key==="Escape"?(_.current.discardTemporaryValue(),c.current={mode:"noFocus"},b.current.blur()):(ze.key==="Enter"||ze.key==="Tab")&&(te(),b.current.blur())},pe=ze=>{c.current.mode==="noFocus"&&(b.current.focus(),ze.preventDefault()),ze.stopPropagation()},fe=()=>{c.current.mode==="noFocus"?ye():c.current.mode},ye=()=>{let ze=_.current.value;c.current={mode:"editingViaKeyboard",currentEditedValueInString:String(ze),valueBeforeEditing:ze},setTimeout(()=>{b.current.focus(),b.current.setSelectionRange(0,100)})},Ne;return{inputChange:X,onBlur:K,transitionToDraggingMode:()=>{var ze;let Me=_.current.value;Ne=(ze=b.current)==null?void 0:ze.getBoundingClientRect().width,c.current={mode:"dragging"};let je=Me,yt=Me;return E.current=document.body.style.cursor,{onDrag(xe,We,ae,nt){let dn=ae.altKey?nt/10:nt,Ve=yt+a.nudge({deltaX:dn,deltaFraction:dn/Ne,magnitude:1});yt=a.range?ii(Ve,a.range[0],a.range[1]):Ve,_.current.temporarilySetValue(yt)},onDragEnd(xe){xe?(je===yt?_.current.discardTemporaryValue():_.current.permanentlySetValue(yt),c.current={mode:"noFocus"}):(_.current.discardTemporaryValue(),c.current={mode:"noFocus"})},onClick(){b.current.focus(),b.current.setSelectionRange(0,100)}}},onInputKeyDown:se,onClick:pe,onFocus:fe}},[]);(0,sY.useEffect)(()=>()=>{T.onBlur()},[]);let R=c.current.mode!=="editingViaKeyboard"?fye(a.value):c.current.currentEditedValueInString;typeof R=="number"&&isNaN(R)&&(R="NaN");let N=[b];a.inputRef&&N.push(a.inputRef);let z=Um.default.createElement(uY,{key:"input",type:"text",onChange:T.inputChange,value:R,onBlur:T.onBlur,onKeyDown:T.onInputKeyDown,onClick:T.onClick,onFocus:T.onFocus,ref:yM(N),onMouseDown:X=>{X.stopPropagation()},onDoubleClick:X=>{X.preventDefault(),X.stopPropagation()},autoFocus:a.autoFocus}),{range:G}=a,V=parseFloat(R),B=G?Um.default.createElement(hY,{style:{"--percentage":ii((V-G[0])/(G[1]-G[0]),0,1)}}):null,[j,H]=(0,aY.useState)(null);return fa(j,{debugName:"form/BasicNumberInput",onDragStart:T.transitionToDraggingMode,lockCSSCursorTo:"ew-resize",shouldPointerLock:!0,disabled:c.current.mode==="editingViaKeyboard"}),Um.default.createElement(xM,{className:a.className+" "+c.current.mode},Um.default.createElement(fY,{ref:H},z),B)},bM=mY});function pye({propConfig:a,editingTools:u,value:c,autoFocus:m}){let _=(0,kD.useCallback)(b=>a.nudgeFn($(P({},b),{config:a})),[a]);return kD.default.createElement(bM,{value:c,temporarilySetValue:u.temporarilySetValue,discardTemporaryValue:u.discardTemporaryValue,permanentlySetValue:u.permanentlySetValue,range:a.range,nudge:_,autoFocus:m})}var kD,ND,gY=I(()=>{ID(),kD=Q(qe()),ND=pye});function mye({value:a,onChange:u,options:c,autoFocus:m}){let _=(0,yb.useCallback)(b=>{u(String(b.target.value))},[u]);return yb.default.createElement(DD,{role:"radiogroup"},Object.keys(c).map((b,E)=>yb.default.createElement(_Y,{key:"label-"+E,"data-checked":a===b},c[b],yb.default.createElement(bY,{type:"radio",checked:a===b,value:b,onChange:_,name:"switchbox",autoFocus:m}))))}var yb,vY,DD,yY,_Y,xY,bY,SY,gye=I(()=>{hc(),yb=Q(qe()),Ft(),DD=Te.form(vY||(vY=J([`
  display: flex;
  flex-direction: row;
  align-items: stretch;
  vertical-align: middle;
  justify-content: stretch;
  height: 24px;
  width: 100%;
`]))),_Y=Te.label(yY||(yY=J([`
  padding: 0 0.5em;
  background: transparent;
  /* background: #373748; */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-grow: 1;
  color: #a7a7a7;
  border: 1px solid transparent;
  box-sizing: border-box;
  border-right-width: 0px;

  & + &:last-child {
    border-right-width: 1px;
  }

  `,`:hover > & {
    border-color: #1c2123;
    /* background-color: #373748; */
    /* color: `,`; */
  }

  &&:hover {
    background-color: #464654;
  }

  &&[data-checked='true'] {
    color: white;
    background: #3f3f4c;
  }
`])),DD,ib(.1,"white")),bY=Te.input(xY||(xY=J([`
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 0;
  height: 0;
`]))),SY=mye}),vye=I(()=>{}),OD,FD,LD,wY=I(()=>{OD=Q(qe()),FD={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},LD=OD.default.createContext&&OD.default.createContext(FD)});function EY(a){return a&&a.map(function(u,c){return _6.default.createElement(u.tag,Bm({key:c},u.attr),EY(u.child))})}function y6(a){return function(u){return _6.default.createElement(yye,Bm({attr:Bm({},a.attr)},u),EY(a.child))}}function yye(a){var u=function(c){var m=a.attr,_=a.size,b=a.title,E=TY(a,["attr","size","title"]),T=_||c.size||"1em",R;return c.className&&(R=c.className),a.className&&(R=(R?R+" ":"")+a.className),_6.default.createElement("svg",Bm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},c.attr,m,E,{className:R,style:Bm(Bm({color:a.color||c.color},c.style),a.style),height:T,width:T,xmlns:"http://www.w3.org/2000/svg"}),b&&_6.default.createElement("title",null,b),a.children)};return LD!==void 0?_6.default.createElement(LD.Consumer,null,function(c){return u(c)}):u(FD)}var _6,Bm,TY,_ye=I(()=>{_6=Q(qe()),wY(),Bm=function(){return Bm=Object.assign||function(a){for(var u,c=1,m=arguments.length;c<m;c++){u=arguments[c];for(var _ in u)Object.prototype.hasOwnProperty.call(u,_)&&(a[_]=u[_])}return a},Bm.apply(this,arguments)},TY=function(a,u){var c={};for(var m in a)Object.prototype.hasOwnProperty.call(a,m)&&u.indexOf(m)<0&&(c[m]=a[m]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,m=Object.getOwnPropertySymbols(a);_<m.length;_++)u.indexOf(m[_])<0&&Object.prototype.propertyIsEnumerable.call(a,m[_])&&(c[m[_]]=a[m[_]]);return c}}),Ba=I(()=>{vye(),_ye(),wY()}),xye=I(()=>{Ba()}),bye=I(()=>{Ba()});function Sye(a){return y6({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}}]})(a)}var wye=I(()=>{Ba()}),Eye=I(()=>{Ba()}),Tye=I(()=>{Ba()});function Mye(a){return y6({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5 5-5z"}}]})(a)}function Cye(a){return y6({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3l5 5z"}}]})(a)}var Aye=I(()=>{Ba()}),Pye=I(()=>{Ba()}),Rye=I(()=>{Ba()}),Iye=I(()=>{Ba()}),kye=I(()=>{Ba()}),Nye=I(()=>{Ba()}),Dye=I(()=>{Ba()}),Oye=I(()=>{Ba()}),Fye=I(()=>{Ba()}),Lye=I(()=>{Ba()});function MY(a){return y6({attr:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"}}]})(a)}var Uye=I(()=>{Ba()}),Bye=I(()=>{Ba()}),zye=I(()=>{Ba()}),Vye=I(()=>{Ba()});function Gye(a){return y6({attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M6 9.65685L7.41421 11.0711L11.6569 6.82843L15.8995 11.0711L17.3137 9.65685L11.6569 4L6 9.65685Z",fill:"currentColor"}},{tag:"path",attr:{d:"M6 14.4433L7.41421 13.0291L11.6569 17.2717L15.8995 13.0291L17.3137 14.4433L11.6569 20.1001L6 14.4433Z",fill:"currentColor"}}]})(a)}var Hye=I(()=>{Ba()});function jye(a){return y6({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M14 10.44l-.413.56H2.393L2 10.46 7.627 5h.827L14 10.44z"}}]})(a)}var Wye=I(()=>{Ba()}),x6=I(()=>{xye(),bye(),wye(),Eye(),Tye(),Aye(),Pye(),Rye(),Iye(),kye(),Nye(),Dye(),Oye(),Fye(),Lye(),Uye(),Bye(),zye(),Vye(),Hye(),Wye()});function $ye({value:a,onChange:u,options:c,className:m,autoFocus:_}){let b=(0,j5.useCallback)(E=>{u(String(E.target.value))},[u]);return j5.default.createElement(AY,null,j5.default.createElement(kY,{className:m,value:a,onChange:b,autoFocus:_},Object.keys(c).map((E,T)=>j5.default.createElement("option",{key:"option-"+T,value:E},c[E]))),j5.default.createElement(RY,null,j5.default.createElement(Gye,null)))}var j5,CY,AY,PY,RY,IY,kY,NY,qye=I(()=>{j5=Q(qe()),Ft(),x6(),AY=Te.div(CY||(CY=J([`
  width: 100%;
  position: relative;
`]))),RY=Te.div(PY||(PY=J([`
  position: absolute;
  right: 0px;
  top: 0;
  bottom: 0;
  width: 1.5em;
  font-size: 14px;
  display: flex;
  align-items: center;
  color: #6b7280;
  pointer-events: none;
`]))),kY=Te.select(IY||(IY=J([`
  appearance: none;
  background-color: transparent;
  box-sizing: border-box;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.85);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  text-align: left;
  width: 100%;
  border-radius: 2px;
  /*
  looks like putting percentages in the height of a select box doesn't work in Firefox. Not sure why.
  So we're hard-coding the height to 26px, unlike all other inputs that use a relative height.
  */
  height: 26px /* calc(100% - 4px); */;

  @supports (-moz-appearance: none) {
    /* Ugly hack to remove the extra left padding that shows up only in Firefox */
    text-indent: -2px;
  }

  &:hover,
  &:focus {
    background-color: #10101042;
    border-color: #00000059;
  }
`]))),NY=$ye});function Xye({propConfig:a,editingTools:u,value:c,autoFocus:m}){let _=(0,SM.useCallback)(b=>{u.permanentlySetValue(b)},[a,u]);return a.as==="menu"?SM.default.createElement(NY,{value:c,onChange:_,options:a.valuesAndLabels,autoFocus:m}):SM.default.createElement(SY,{value:c,onChange:_,options:a.valuesAndLabels,autoFocus:m})}var SM,DY,Yye=I(()=>{SM=Q(qe()),gye(),qye(),DY=Xye}),OY,_b,FY,LY,UY,BY,wM,UD=I(()=>{Ft(),OY=Q(qe()),_b=Q(qe()),_M(),Ui(),ED(),LY=Te.input.attrs({type:"text"})(FY||(FY=J([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;
  border: 1px solid transparent;
  box-sizing: border-box;

  &:hover {
    background-color: #10101042;
    border-color: #00000059;
  }

  &:hover,
  &:focus {
    cursor: text;
    background-color: #10101042;
    border-color: #00000059;
  }

  &.invalid {
    border-color: red;
  }
`]))),UY=a=>!0,BY=a=>{var u,c;let[m]=Ii({mode:"noFocus"}),_=(u=a.isValid)!=null?u:UY,b=(0,_b.useRef)(a);b.current=a;let E=(0,_b.useRef)(null);wD(E.current,()=>{E.current.blur()},m.current.mode==="editingViaKeyboard");let T=(0,_b.useMemo)(()=>{let z=K=>{let te=K.target,{value:se}=te,pe=m.current;m.current=$(P({},pe),{currentEditedValueInString:se}),_(se)&&b.current.temporarilySetValue(se)},G=()=>{var K,te;m.current.mode==="editingViaKeyboard"&&(V(),m.current={mode:"noFocus"}),(te=(K=b.current).onBlur)==null||te.call(K)},V=()=>{let K=m.current,te=K.currentEditedValueInString;_(te)?K.valueBeforeEditing===te?b.current.discardTemporaryValue():b.current.permanentlySetValue(te):b.current.discardTemporaryValue()},B=K=>{K.key==="Escape"?(b.current.discardTemporaryValue(),m.current={mode:"noFocus"},E.current.blur()):(K.key==="Enter"||K.key==="Tab")&&(V(),E.current.blur())},j=K=>{m.current.mode==="noFocus"&&(E.current.focus(),K.preventDefault()),K.stopPropagation()},H=()=>{m.current.mode==="noFocus"?X():m.current.mode},X=()=>{let K=b.current.value;m.current={mode:"editingViaKeyboard",currentEditedValueInString:String(K),valueBeforeEditing:K},setTimeout(()=>{E.current.focus()})};return{inputChange:z,onBlur:G,onInputKeyDown:B,onClick:j,onFocus:H}},[]);(0,OY.useEffect)(()=>()=>{T.onBlur()},[]);let R=m.current.mode!=="editingViaKeyboard"?a.value:m.current.currentEditedValueInString,N=[E];return a.inputRef&&N.push(a.inputRef),_b.default.createElement(LY,{key:"input",type:"text",className:"".concat((c=a.className)!=null?c:""," ").concat(_(R)?"":"invalid"),onChange:T.inputChange,value:R,onBlur:T.onBlur,onKeyDown:T.onInputKeyDown,onClick:T.onClick,onFocus:T.onFocus,ref:yM(N),onMouseDown:z=>{z.stopPropagation()},onDoubleClick:z=>{z.preventDefault(),z.stopPropagation()},autoFocus:a.autoFocus})},wM=BY});function Kye({editingTools:a,value:u,autoFocus:c}){return zY.default.createElement(wM,{value:u,temporarilySetValue:a.temporarilySetValue,discardTemporaryValue:a.discardTemporaryValue,permanentlySetValue:a.permanentlySetValue,autoFocus:c})}var zY,VY,Zye=I(()=>{zY=Q(qe()),UD(),VY=Kye});function Qye(a){a=a.trim().toLowerCase();let u=a.match(VD);if(!u)return{r:0,g:0,b:0,a:1};let c=Jye(u[1]);return{r:parseInt(c.substr(0,2),16)/255,g:parseInt(c.substr(2,2),16)/255,b:parseInt(c.substr(4,2),16)/255,a:parseInt(c.substr(6,2),16)/255}}function BD(a,{removeAlphaIfOpaque:u=!1}={}){let c=(a.a*255|256).toString(16).slice(1),m=(a.r*255|256).toString(16).slice(1)+(a.g*255|256).toString(16).slice(1)+(a.b*255|256).toString(16).slice(1)+(u&&c==="ff"?"":c);return"#".concat(m)}function zD(a){return $(P({},a),{toString(){return BD(this,{removeAlphaIfOpaque:!0})}})}function Jye(a){switch(a.length){case 3:return"".concat(a.repeat(2),"ff");case 4:let u=a.substr(0,3),c=a[3];return"".concat(u.repeat(2)).concat(c.repeat(2));case 6:return"".concat(a,"ff")}return a}var VD,GY=I(()=>{VD=/^#*([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i});function EM(a){let u=(0,GD.useRef)(a),c=(0,GD.useRef)(m=>{u.current&&u.current(m)});return u.current=a,c.current}var GD,HY=I(()=>{GD=Q(qe())}),W5,TM=I(()=>{W5=(a,u=0,c=1)=>a>c?c:a<u?u:a}),xb,HD,jY,jD,WD=I(()=>{xb=Q(qe()),HD=(0,xb.createContext)(void 0),jY=({children:a})=>{let[u,c]=(0,xb.useState)(!1);return xb.default.createElement(HD.Provider,{value:{editing:u,setEditing:c}},a)},jD=()=>(0,xb.useContext)(HD)}),F9,b6,WY,MM,$D,qD,$Y,qY,XY,YY,bb,CM=I(()=>{F9=Q(qe()),HY(),TM(),Ft(),WD(),b6=a=>"touches"in a,WY=(a,u)=>{for(let c=0;c<a.length;c++)if(a[c].identifier===u)return a[c];return a[0]},MM=a=>a&&a.ownerDocument.defaultView||self,$D=(a,u,c)=>{let m=a.getBoundingClientRect(),_=b6(u)?WY(u.touches,c):u;return{left:W5((_.pageX-(m.left+MM(a).pageXOffset))/m.width),top:W5((_.pageY-(m.top+MM(a).pageYOffset))/m.height)}},qD=a=>{!b6(a)&&a.preventDefault()},$Y=(a,u)=>u&&!b6(a),XY=Te.div(qY||(qY=J([`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  outline: none;
  /* Don't trigger the default scrolling behavior when the event is originating from this element */
  touch-action: none;
`]))),YY=a=>{var u=a,{onMove:c,onKey:m}=u,_=Z(u,["onMove","onKey"]);let b=(0,F9.useRef)(null),E=EM(c),T=EM(m),R=(0,F9.useRef)(null),N=(0,F9.useRef)(!1),{setEditing:z}=jD(),[G,V,B]=(0,F9.useMemo)(()=>{let j=({nativeEvent:se})=>{let pe=b.current;if(pe&&(qD(se),!($Y(se,N.current)||!pe))){if(b6(se)){N.current=!0;let fe=se.changedTouches||[];fe.length&&(R.current=fe[0].identifier)}pe.focus(),z(!0),E($D(pe,se,R.current)),te(!0)}},H=se=>{qD(se),(b6(se)?se.touches.length>0:se.buttons>0)&&b.current?E($D(b.current,se,R.current)):(z(!1),te(!1))},X=se=>{z(!1),te(!1)},K=se=>{let pe=se.which||se.keyCode;pe<37||pe>40||(se.preventDefault(),T({left:pe===39?.05:pe===37?-.05:0,top:pe===40?.05:pe===38?-.05:0}))};function te(se){let pe=N.current,fe=b.current,ye=MM(fe),Ne=se?ye.addEventListener:ye.removeEventListener;Ne(pe?"touchmove":"mousemove",H),Ne(pe?"touchend":"mouseup",X)}return[j,K,te]},[T,E]);return(0,F9.useEffect)(()=>B,[B]),F9.default.createElement(XY,$(P({},_),{onTouchStart:G,onMouseDown:G,ref:b,onKeyDown:V,tabIndex:0,role:"slider"}))},bb=F9.default.memo(YY)}),XD,KY,ZY,QY,JY,eK,tK,AM,YD=I(()=>{XD=Q(qe()),Ft(),CM(),ZY=Te(bb)(KY||(KY=J([""]))),JY=Te.div(QY||(QY=J([`
  position: absolute;
  z-index: 1;
  box-sizing: border-box;
  width: 16px;
  height: 16px;
  transform: translate(-50%, -50%);
  background-color: #fff;
  border: 1px solid #ffffff00;
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);

  `,`:focus & {
    transform: translate(-50%, -50%) scale(1.1);
  }
`])),ZY),tK=Te.div(eK||(eK=J([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;
`]))),AM=({className:a,color:u,left:c,top:m=.5})=>{let _={top:"".concat(m*100,"%"),left:"".concat(c*100,"%")};return XD.default.createElement(JY,{style:_,className:a},XD.default.createElement(tK,{style:{backgroundColor:u}}))}}),N0,PM=I(()=>{N0=(a,u=0,c=Math.pow(10,u))=>Math.round(c*a)/c}),KD,RM,IM,nK,rK,kM=I(()=>{PM(),KD=({h:a,s:u,v:c,a:m})=>{let _=(200-u)*c/100;return{h:N0(a),s:N0(_>0&&_<200?u*c/100/(_<=100?_:200-_)*100:0),l:N0(_/2),a:N0(m,2)}},RM=a=>{let{h:u,s:c,l:m}=KD(a);return"hsl(".concat(u,", ").concat(c,"%, ").concat(m,"%)")},IM=a=>{let{h:u,s:c,l:m,a:_}=KD(a);return"hsla(".concat(u,", ").concat(c,"%, ").concat(m,"%, ").concat(_,")")},nK=({h:a,s:u,v:c,a:m})=>{a=a/360*6,u=u/100,c=c/100;let _=Math.floor(a),b=c*(1-u),E=c*(1-(a-_)*u),T=c*(1-(1-a+_)*u),R=_%6;return{r:N0([c,E,b,b,T,c][R]*255),g:N0([T,c,c,E,b,b][R]*255),b:N0([b,b,T,c,c,E][R]*255),a:N0(m,2)}},rK=({r:a,g:u,b:c,a:m})=>{let _=Math.max(a,u,c),b=_-Math.min(a,u,c),E=b?_===a?(u-c)/b:_===u?2+(c-a)/b:4+(a-u)/b:0;return{h:N0(60*(E<0?E+6:E)),s:N0(_?b/_*100:0),v:N0(_/255*100),a:m}}}),Sb,iK,sK,aK,oK,lK,uK,e6e=I(()=>{Sb=Q(qe()),CM(),YD(),kM(),TM(),PM(),Ft(),sK=Te.div(iK||(iK=J([`
  position: relative;
  height: 16px;
  border-radius: 2px;

  background: linear-gradient(
    to right,
    #f00 0%,
    #ff0 17%,
    #0f0 33%,
    #0ff 50%,
    #00f 67%,
    #f0f 83%,
    #f00 100%
  );
`]))),oK=Te(AM)(aK||(aK=J([`
  z-index: 2;
`]))),lK=({className:a,hue:u,onChange:c})=>Sb.default.createElement(sK,{className:a},Sb.default.createElement(bb,{onMove:m=>{c({h:360*m.left})},onKey:m=>{c({h:W5(u+m.left*360,0,360)})},"aria-label":"Hue","aria-valuetext":N0(u)},Sb.default.createElement(oK,{left:u/360,color:RM({h:u,s:100,v:100,a:1})}))),uK=Sb.default.memo(lK)}),wb,cK,hK,dK,fK,pK,mK,t6e=I(()=>{wb=Q(qe()),CM(),YD(),kM(),TM(),PM(),Ft(),hK=Te.div(cK||(cK=J([`
  position: relative;
  flex-grow: 1;
  border-color: transparent; /* Fixes https://github.com/omgovich/react-colorful/issues/139 */
  border-bottom: 12px solid #000;
  border-radius: 2px;
  background-image: linear-gradient(to top, #000, rgba(0, 0, 0, 0)),
    linear-gradient(to right, #fff, rgba(255, 255, 255, 0));

  // Improve elements rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),fK=Te(AM)(dK||(dK=J([`
  z-index: 3;
`]))),pK=({hsva:a,onChange:u})=>{let c=b=>{u({s:b.left*100,v:100-b.top*100})},m=b=>{u({s:W5(a.s+b.left*100,0,100),v:W5(a.v-b.top*100,0,100)})},_={backgroundColor:RM({h:a.h,s:100,v:100,a:1})};return wb.default.createElement(hK,{style:_},wb.default.createElement(bb,{onMove:c,onKey:m,"aria-label":"Color","aria-valuetext":"Saturation ".concat(N0(a.s),"%, Brightness ").concat(N0(a.v),"%")},wb.default.createElement(fK,{top:1-a.v/100,left:a.s/100,color:RM(a)})))},mK=wb.default.memo(pK)}),Eb,gK,vK,yK,_K,xK,bK,SK,n6e=I(()=>{Eb=Q(qe()),CM(),YD(),kM(),TM(),PM(),Ft(),vK=Te.div(gK||(gK=J([`
  position: relative;
  height: 16px;
  border-radius: 2px;
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),_K=Te.div.attrs(({colorFrom:a,colorTo:u})=>({style:{backgroundImage:"linear-gradient(90deg, ".concat(a,", ").concat(u,")")}}))(yK||(yK=J([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;

  // Improve rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),bK=Te(AM)(xK||(xK=J([`
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),SK=({className:a,hsva:u,onChange:c})=>{let m=T=>{c({a:T.left})},_=T=>{c({a:W5(u.a+T.left)})},b=IM(Object.assign({},u,{a:0})),E=IM(Object.assign({},u,{a:1}));return Eb.default.createElement(vK,{className:a},Eb.default.createElement(_K,{colorFrom:b,colorTo:E}),Eb.default.createElement(bb,{onMove:m,onKey:_,"aria-label":"Alpha","aria-valuetext":"".concat(N0(u.a*100),"%")},Eb.default.createElement(bK,{left:u.a,color:IM(u)})))}}),NM,wK=I(()=>{NM=(a,u)=>{if(a===u)return!0;for(let c in a)if(a[c]!==u[c])return!1;return!0}});function r6e(a,u,c,m){let{editing:_}=jD(),[b,E]=(0,zm.useState)(u),T=EM(c),R=EM(m),N=_?b:u,[z,G]=(0,zm.useState)(()=>a.toHsva(N)),V=(0,zm.useRef)({color:N,hsva:z}),B=(0,zm.useRef)({color:N,hsva:z});(0,zm.useEffect)(()=>{_&&E(V.current.color)},[_]),(0,zm.useEffect)(()=>{let H=a.fromHsva(z);_?!NM(z,V.current.hsva)&&!a.equal(H,V.current.color)&&(V.current={hsva:z,color:H},E(H),T(H)):!NM(z,B.current.hsva)&&!a.equal(H,B.current.color)&&(B.current={hsva:z,color:H},V.current={hsva:z,color:H},R(H))},[_,z,a,T,R]),(0,zm.useEffect)(()=>{if(!_&&!a.equal(N,B.current.color)){let H=a.toHsva(N);B.current={hsva:H,color:N},G(H)}},[_,N,a]);let j=(0,zm.useCallback)(H=>{G(X=>Object.assign({},X,H))},[]);return[z,j]}var zm,i6e=I(()=>{zm=Q(qe()),wK(),HY(),WD()}),S6,EK,TK,MK,s6e=I(()=>{S6=Q(qe()),e6e(),t6e(),n6e(),i6e(),Ft(),TK=Te.div(EK||(EK=J([`
  position: relative;
  display: flex;
  gap: 4px;
  flex-direction: column;
  width: 200px;
  height: 200px;
  user-select: none;
  cursor: default;
`]))),MK=a=>{var u=a,{className:c,colorModel:m,color:_=m.defaultColor,temporarilySetValue:b,permanentlySetValue:E,discardTemporaryValue:T}=u,R=Z(u,["className","colorModel","color","temporarilySetValue","permanentlySetValue","discardTemporaryValue"]);let[N,z]=r6e(m,_,b,E);return(0,S6.useEffect)(()=>()=>{T()},[]),S6.default.createElement(TK,P({},R),S6.default.createElement(mK,{hsva:N,onChange:z}),S6.default.createElement(uK,{hue:N.h,onChange:z}),S6.default.createElement(SK,{hsva:N,onChange:z}))}}),ZD,CK,AK,PK,RK,a6e=I(()=>{ZD=Q(qe()),s6e(),wK(),kM(),WD(),CK=a=>({r:a.r/255,g:a.g/255,b:a.b/255,a:a.a}),AK=a=>({r:a.r*255,g:a.g*255,b:a.b*255,a:a.a}),PK={defaultColor:{r:0,g:0,b:0,a:1},toHsva:a=>rK(AK(a)),fromHsva:a=>CK(nK(a)),equal:NM},RK=a=>ZD.default.createElement(jY,null,ZD.default.createElement(MK,$(P({},a),{permanentlySetValue:u=>{a.permanentlySetValue(u)},colorModel:PK})))}),o6e=I(()=>{a6e()}),IK,kK,NK,l6e=I(()=>{IK=Q(qe()),kK=function(a){(0,IK.useEffect)(a,[])},NK=kK}),DK,OK,FK,u6e=I(()=>{DK=Q(qe()),l6e(),OK=function(a){var u=(0,DK.useRef)(a);u.current=a,NK(function(){return function(){return u.current()}})},FK=OK}),DM,LK,UK,c6e=I(()=>{DM=Q(qe()),u6e(),LK=function(a){var u=(0,DM.useRef)(0),c=(0,DM.useState)(a),m=c[0],_=c[1],b=(0,DM.useCallback)(function(E){cancelAnimationFrame(u.current),u.current=requestAnimationFrame(function(){_(E)})},[]);return FK(function(){cancelAnimationFrame(u.current)}),[m,b]},UK=LK});function h6e(a){for(var u=[],c=1;c<arguments.length;c++)u[c-1]=arguments[c];a&&a.addEventListener&&a.addEventListener.apply(a,u)}function d6e(a){for(var u=[],c=1;c<arguments.length;c++)u[c-1]=arguments[c];a&&a.removeEventListener&&a.removeEventListener.apply(a,u)}var OM,f6e=I(()=>{OM=typeof window<"u"}),BK,zK,FM,QD=I(()=>{BK=Q(qe()),c6e(),f6e(),zK=function(a,u){a===void 0&&(a=1/0),u===void 0&&(u=1/0);var c=UK({width:OM?window.innerWidth:a,height:OM?window.innerHeight:u}),m=c[0],_=c[1];return(0,BK.useEffect)(function(){if(OM){var b=function(){_({width:window.innerWidth,height:window.innerHeight})};return h6e(window,"resize",b),function(){d6e(window,"resize",b)}}},[]),m},FM=zK});function JD(a){let[u,c]=(0,eO.useState)(null);return(0,eO.useLayoutEffect)(()=>(a&&c(a.getBoundingClientRect()),()=>{c(null)}),[a]),u}var eO,VK=I(()=>{eO=Q(qe())}),GK,HK,tO,jK=I(()=>{GK=Q(qe()),HK=(0,GK.createContext)({}),tO=HK});function p6e(a,u,c){let m=a.getBoundingClientRect(),_=b=>{(b.clientX<m.left-u||b.clientX>m.left+m.width+u||b.clientY<m.top-u||b.clientY>m.top+m.height+u)&&c(b)};return window.addEventListener("mousemove",_),()=>{window.removeEventListener("mousemove",_)}}var m6e=I(()=>{}),WK,LM,nO,$K,rO,qK=I(()=>{WK=Q(qe()),LM=Q(qe()),QD(),VK(),jK(),Ui(),ED(),m6e(),f6(),Ua(),nO=8,$K=a=>{var u,c;let m=a.children(),[_,b]=Ii(null),E=m.props.style?P({},m.props.style):{};E.position="absolute";let T=JD(b),R=JD(a.target),N=FM(),[z,G]=(0,LM.useState)({});return(0,LM.useLayoutEffect)(()=>{var V,B,j;if(!T||!b||!R)return;let H=(V=a.verticalGap)!=null?V:8,X={},K=(B=a.verticalPlacement)!=null?B:"bottom",te=0,se=0;K==="bottom"?R.bottom+T.height+H<N.height?(K="bottom",te=R.bottom+H,X.top="0px"):R.top>T.height+H?(K="top",te=R.top-(T.height+H),X.bottom="0px",X.transform="rotateZ(180deg)"):K="overlay":K==="top"&&(R.top>T.height+H?(K="top",te=R.top-(T.height+H),X.bottom="0px",X.transform="rotateZ(180deg)"):R.bottom+T.height+H<N.height?(K="bottom",te=R.bottom+H,X.top="0px"):K="overlay");let pe=0;if(K!=="overlay"){let je=R.left+R.width/2;je<T.width/2?(se=H,pe=Math.max(je-H,nO)):je+T.width/2>N.width?(se=N.width-(H+T.width),pe=Math.min(je-se,T.width-nO)):(se=je-T.width/2,pe=T.width/2),X.left=pe+"px"}let{minX:fe=-1/0,maxX:ye=1/0,minY:Ne=-1/0,maxY:ze=1/0}=(j=a.constraints)!=null?j:{},Me={left:ii(se,fe,ye-T.width),top:ii(te,Ne,ze+T.height)};if(b.style.left=Me.left+"px",b.style.top=Me.top+"px",G(X),a.onPointerOutside)return p6e(b,a.onPointerOutside.threshold,a.onPointerOutside.callback)},[T,b,a.target,R,N,a.onPointerOutside]),wD([b,(u=a.target)!=null?u:null],(c=a.onClickOutside)!=null?c:Ld),WK.default.createElement(tO.Provider,{value:z},(0,LM.cloneElement)(m,{ref:_,style:E}))},rO=$K});function Sp(a,u){let{isPointerBeingCaptured:c}=nY("usePopover"),[m,_]=Ii({isOpen:!1}),b=(0,D0.useRef)(a),E=(0,D0.useCallback)(V=>{m.current={isOpen:!1}},[]),T=(0,D0.useCallback)((V,B)=>{var j;let H=typeof b.current=="function"?b.current():b.current;function X(){N.childHasFocusRef.current||H.closeOnClickOutside!==!1&&E("clicked outside popover")}m.current={isOpen:!0,clickPoint:{clientX:V.clientX,clientY:V.clientY},target:B,opts:H,onClickOutside:X,onPointerOutside:H.closeWhenPointerIsDistant===!1?void 0:{threshold:(j=H.pointerDistanceThreshold)!=null?j:100,callback:()=>{N.childHasFocusRef.current||c()||E("pointer outside")}}}},[]),R=(0,D0.useCallback)((...V)=>{m.current.isOpen?E("toggled"):T(...V)},[]),N=g6e({state:_}),[,z]=(0,D0.useContext)(Kb);(0,D0.useEffect)(()=>{let V;return _.isOpen&&(V=z()),()=>V==null?void 0:V()},[_.isOpen]);let G=(0,D0.useContext)(c6);return{node:_.isOpen?(0,XK.createPortal)(D0.default.createElement(iO.Provider,{value:N.childPopoverLock},D0.default.createElement(rO,{children:u,target:_.target,onClickOutside:_.onClickOutside,onPointerOutside:_.onPointerOutside,constraints:_.opts.constraints,verticalGap:_.opts.verticalGap})),G):D0.default.createElement(D0.default.Fragment,null),open:T,close:E,toggle:R,isOpen:_.isOpen}}function g6e(a){let u=(0,D0.useContext)(iO);(0,D0.useEffect)(()=>{if(a.state.isOpen){let m=u.takeFocus();return()=>{m.releaseFocus()}}},[a.state.isOpen]);let c=(0,D0.useRef)(!1);return{childHasFocusRef:c,childPopoverLock:{takeFocus(){return c.current=!0,{releaseFocus(){c.current=!1}}}}}}var D0,XK,iO,wp=I(()=>{AD(),Ui(),D0=Q(qe()),XK=Q(mo()),H5(),qK(),$O(),iO=D0.default.createContext({takeFocus(){return{releaseFocus(){}}}})}),Vm,YK,KK,ZK,QK,JK,eZ,tZ,nZ,rZ,iZ,sZ,aZ,v6e=I(()=>{Vm=Q(qe()),Ft(),jK(),KK=Te.div(YK||(YK=J([`
  position: absolute;
  width: 0;
  height: 0;
  color: var(--popover-arrow-color);
  pointer-events: none;
`]))),QK=Te.div(ZK||(ZK=J([`
  width: 12px;
  height: 8px;
  position: absolute;
  left: -7px;
  top: -8px;
  text-align: center;
  line-height: 0;
`]))),eZ=Te.path(JK||(JK=J([`
  fill: var(--popover-bg);
`]))),nZ=Te.path(tZ||(tZ=J([`
  fill: var(--popover-inner-stroke);
`]))),iZ=Te.path(rZ||(rZ=J([`
  fill: var(--popover-outer-stroke);
`]))),sZ=(0,Vm.forwardRef)(({className:a},u)=>{let c=(0,Vm.useContext)(tO);return Vm.default.createElement(KK,{className:a,ref:u,style:P({},c)},Vm.default.createElement(QK,null,Vm.default.createElement("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Vm.default.createElement(iZ,{d:"M6 0L0 6H12L6 0Z"}),Vm.default.createElement(nZ,{d:"M6 1.5L0 7.5H12L6 1.5Z"}),Vm.default.createElement(eZ,{d:"M6 3L0 9H12L6 3Z"}))))}),aZ=sZ}),UM,sO,oZ,lZ,uZ,Ep,Tp=I(()=>{Bi(),hc(),UM=Q(qe()),Ft(),v6e(),sO=Fd(.05,"#2a2a31"),lZ=Te.div(oZ||(oZ=J([`
  position: absolute;
  --popover-bg: `,`;
  --popover-inner-stroke: #505159;
  --popover-outer-stroke: #111;

  background: var(--popover-bg);

  color: white;
  padding: 0;
  margin: 0;
  cursor: default;
  `,`;
  border-radius: 3px;
  z-index: 10000;
  border: 1px solid var(--popover-inner-stroke);
  box-shadow: 0 0 0 1px var(--popover-outer-stroke), 0 6px 8px -4px black;
  backdrop-filter: blur(8px);

  & a {
    color: inherit;
  }
`])),sO,Fi),uZ=UM.default.forwardRef(({children:a,className:u,showPopoverEdgeTriangle:c=!0},m)=>UM.default.createElement(lZ,{className:u,ref:m},c?UM.default.createElement(aZ,null):void 0,a)),Ep=uZ});function y6e({editingTools:a,value:u,autoFocus:c}){let m=(0,Mp.useRef)(null),_=(0,Mp.useCallback)(E=>{let T=zD(Qye(E));a.permanentlySetValue(T)},[a]),b=Sp({debugName:"RgbaPropEditor"},()=>Mp.default.createElement(vZ,null,Mp.default.createElement(RK,{color:{r:u.r,g:u.g,b:u.b,a:u.a},temporarilySetValue:E=>{let T=zD(E);a.temporarilySetValue(T)},permanentlySetValue:E=>{let T=zD(E);a.permanentlySetValue(T)},discardTemporaryValue:a.discardTemporaryValue})));return Mp.default.createElement(Mp.default.Fragment,null,Mp.default.createElement(hZ,null,Mp.default.createElement(fZ,{rgbaColor:u,ref:m,onClick:E=>{b.toggle(E,m.current)}}),Mp.default.createElement(mZ,{value:BD(u,{removeAlphaIfOpaque:!0}),temporarilySetValue:aO,discardTemporaryValue:aO,permanentlySetValue:_,isValid:E=>!!E.match(VD),autoFocus:c})),b.node)}var Mp,cZ,hZ,dZ,fZ,pZ,mZ,aO,gZ,vZ,yZ,_6e=I(()=>{GY(),GY(),Mp=Q(qe()),o6e(),Ft(),wp(),UD(),Tp(),hZ=Te.div(cZ||(cZ=J([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),fZ=Te.div.attrs(a=>({style:{background:BD(a.rgbaColor)}}))(dZ||(dZ=J([`
  height: 18px;
  aspect-ratio: 1;
  border-radius: 99999px;
`]))),mZ=Te(wM)(pZ||(pZ=J([`
  flex: 1;
`]))),aO=()=>{},vZ=Te.div(gZ||(gZ=J([`
  position: absolute;
  background-color: `,`;
  color: white;
  margin: 0;
  cursor: default;
  border-radius: 3px;
  z-index: 10000;
  backdrop-filter: blur(8px);

  padding: 4px;
  pointer-events: all;

  border: none;
  box-shadow: none;
`])),sO),yZ=y6e});function x6e({propConfig:a,editingTools:u,value:c,autoFocus:m}){let[_,b]=Bd.default.useState();(0,Bd.useEffect)(()=>{b(c?u.getAssetUrl(c):void 0)},[c]);let E=(0,Bd.useCallback)(R=>Be(this,null,function*(){let N=R.target.files[0];u.permanentlySetValue({type:"image",id:void 0});let z=yield u.createAsset(N);z?u.permanentlySetValue({type:"image",id:z}):u.permanentlySetValue(c),R.target.value=null}),[u,c]),T=!(c!=null&&c.id);return Bd.default.createElement(oO,{empty:T},Bd.default.createElement(TZ,{empty:T,title:T?"Upload image":'"'.concat(c.id,'" (Click to upload new image)')},Bd.default.createElement(CZ,{type:"file",onChange:E,accept:"image/*,.hdr",autoFocus:m}),_?Bd.default.createElement(PZ,{src:_}):Bd.default.createElement(bZ,null)),!T&&Bd.default.createElement(IZ,{title:"Delete image",onClick:()=>{u.permanentlySetValue({type:"image",id:void 0})}},Bd.default.createElement(pD,null)))}var Bd,_Z,oO,xZ,bZ,SZ,wZ,EZ,TZ,MZ,CZ,AZ,PZ,RZ,IZ,kZ,b6e=I(()=>{db(),Bd=Q(qe()),Ft(),oO=Te.div(_Z||(_Z=J([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),bZ=Te.div(xZ||(xZ=J([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),TZ=Te.label(EZ||(EZ=J([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),a=>a.empty?e0(SZ||(SZ=J([""]))):e0(wZ||(wZ=J([""])))),CZ=Te.input.attrs({type:"file"})(MZ||(MZ=J([`
  display: none;
`]))),PZ=Te.img(AZ||(AZ=J([`
  position: absolute;
  inset: 0;
  height: 100%;
  aspect-ratio: 1;

  object-fit: cover;
`]))),IZ=Te.button(RZ||(RZ=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),oO),kZ=x6e});function S6e({propConfig:a,editingTools:u,value:c,autoFocus:m}){let[_,b]=zd.default.useState();(0,zd.useEffect)(()=>{b(c?u.getAssetUrl(c):void 0)},[c]);let E=(0,zd.useCallback)(R=>Be(this,null,function*(){let N=R.target.files[0];u.permanentlySetValue({type:"file",id:void 0});let z=yield u.createAsset(N);z?u.permanentlySetValue({type:"file",id:z}):u.permanentlySetValue(c),R.target.value=null}),[u,c]),T=!(c!=null&&c.id);return zd.default.createElement(lO,{empty:T},zd.default.createElement(BZ,{empty:T,title:T?"Upload file":'"'.concat(c.id,'" (Click to upload new file)')},zd.default.createElement(VZ,{type:"file",onChange:E,autoFocus:m}),_?zd.default.createElement(hD,null):zd.default.createElement(OZ,null)),!T&&zd.default.createElement(HZ,{title:"Delete file",onClick:()=>{u.permanentlySetValue({type:"file",id:void 0})}},zd.default.createElement(pD,null)))}var zd,NZ,lO,DZ,OZ,FZ,LZ,UZ,BZ,zZ,VZ,GZ,HZ,jZ,w6e=I(()=>{db(),zd=Q(qe()),Ft(),lO=Te.div(NZ||(NZ=J([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),OZ=Te.div(DZ||(DZ=J([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),BZ=Te.label(UZ||(UZ=J([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),a=>a.empty?e0(FZ||(FZ=J([""]))):e0(LZ||(LZ=J([""])))),VZ=Te.input.attrs({type:"file"})(zZ||(zZ=J([`
  display: none;
`]))),HZ=Te.button(GZ||(GZ=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),lO),jZ=S6e}),uO,WZ=I(()=>{lye(),gY(),Yye(),Zye(),_6e(),b6e(),w6e(),uO={number:ND,string:VY,boolean:$X,stringLiteral:DY,rgba:yZ,image:kZ,file:jZ}});function Tb(a){let u=new WeakMap;return c=>(u.has(c)||u.set(c,a(c)),u.get(c))}var BM=I(()=>{});function Cp(a){return a.type==="compound"||a.type==="enum"}function zM(a,u){if(!a)return;let[c,...m]=u;if(c===void 0)return a;if(!Cp(a))return;let _=a.type==="enum"?a.cases[c]:a.props[c];return zM(_,m)}function VM(a,u){let c=u.deserializeAndSanitize(a);return c===void 0?u.default:c}function E6e(a){return!Cp(a)}function*Mb(a,u){if(a.type==="compound")for(let c in a.props)yield*rt(Mb(a.props[c],[...u,c]));else{if(a.type==="enum")throw new Error("Not implemented yet");return yield{path:u,conf:a}}}var cO,L9=I(()=>{BM(),cO=Tb(a=>{if(a.type==="enum")throw new Error("Not implemented yet for enums");for(let u in a.props){let c=a.props[u];if(Cp(c)){if(cO(c))return!0}else return!0}return!1})}),hO,$Z=I(()=>{hO="calc(var(--left-pad) + var(--depth) * var(--step))"}),qZ,U9,$5=I(()=>{Ft(),U9=e0(qZ||(qZ=J([`
  font-weight: 300;
  font-size: 11px;
  color: `,`;
  text-shadow: 0.5px 0.5px 2px rgba(0, 0, 0, 0.3);
`])),a=>a.isHighlighted==="self"?"#CCC":"#919191")}),Cb,GM,XZ,YZ,KZ,ZZ,QZ,JZ,eQ=I(()=>{f6(),Cb=Q(qe()),Ft(),GM=26,YZ=Te.li(XZ||(XZ=J([`
  height: `,`px;
  padding: 0 12px;
  margin: 0;
  display: flex;
  align-items: center;
  font-size: 11px;
  font-weight: 400;
  position: relative;
  color: `,`;
  cursor: `,`;

  &:after {
    position: absolute;
    inset: 2px 1px;
    display: block;
    content: ' ';
    pointer-events: none;
    z-index: -1;
    border-radius: 3px;
  }

  &:hover:after {
    background-color: `,`;
  }
`])),GM,a=>a.enabled?"white":"#8f8f8f",a=>a.enabled?"normal":"not-allowed",a=>a.enabled?"rgba(63, 174, 191, 0.75)":"initial"),ZZ=Te.span(KZ||(KZ=J([""]))),QZ=a=>Cb.default.createElement(YZ,{onClick:a.enabled?a.onClick:Ld,enabled:a.enabled,title:a.enabled?void 0:"Disabled"},Cb.default.createElement(ZZ,null,Cb.default.createElement(Cb.default.Fragment,null,a.label))),JZ=QZ});function T6e(a){let u=(0,dO.useRef)(a);u.current=a,(0,dO.useEffect)(()=>{let c=m=>u.current(m);return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}},[])}var dO,M6e=I(()=>{dO=Q(qe())}),Ab,tQ,nQ,rQ,iQ,sQ,aQ,oQ,fO,lQ=I(()=>{Ab=Q(qe()),eQ(),Ft(),hc(),Bi(),tQ=190,nQ=!0,iQ=Te.ul(rQ||(rQ=J([`
  position: absolute;
  min-width: `,`px;
  z-index: 10000;
  background: `,`;
  backdrop-filter: blur(2px);
  color: white;
  list-style-type: none;
  padding: 2px 0;
  margin: 0;
  border-radius: 1px;
  cursor: default;
  `,`;
  border-radius: 3px;
`])),tQ,Fd(.2,"#111"),Fi),aQ=Te.div(sQ||(sQ=J([`
  padding: 4px 10px;
  border-bottom: 1px solid #6262626d;
  color: #adadadb3;
  font-size: 11px;
  font-weight: 500;
`]))),oQ=Ab.default.forwardRef((a,u)=>Ab.default.createElement(iQ,{ref:u},nQ&&a.displayName?Ab.default.createElement(aQ,null,a.displayName):null,a.items.map((c,m)=>Ab.default.createElement(JZ,{key:"item-".concat(m),label:c.label,enabled:c.enabled!==!1,onClick:_=>{c.callback&&c.callback(_),a.onRequestClose()}})))),fO=oQ}),uQ,cQ,HM,hQ,Pb,dQ,fQ,C6e=I(()=>{VK(),uQ=Q(qe()),cQ=Q(qe()),HM=Q(qe()),hQ=Q(mo()),QD(),eQ(),H5(),M6e(),lQ(),Pb=20,dQ=a=>{let[u,c]=(0,HM.useState)(null),m=JD(u),_=FM();(0,HM.useLayoutEffect)(()=>{if(!m||!u)return;let T={left:m.width/2,top:GM/2+(a.displayName?GM:0)},R={left:a.clickPoint.clientX-T.left,top:a.clickPoint.clientY-T.top};R.left<0?R.left=0:R.left+m.width>_.width&&(R.left=_.width-m.width),R.top<0?R.top=0:R.top+m.height>_.height&&(R.top=_.height-m.height),u.style.left=R.left+"px",u.style.top=R.top+"px";let N=z=>{(z.clientX<R.left-Pb||z.clientX>R.left+m.width+Pb||z.clientY<R.top-Pb||z.clientY>R.top+m.height+Pb)&&a.onRequestClose()};return window.addEventListener("mousemove",N),()=>{window.removeEventListener("mousemove",N)}},[m,u,a.clickPoint,_,a.onRequestClose]);let b=(0,cQ.useContext)(c6);T6e(T=>{T.key==="Escape"&&a.onRequestClose()});let E=(0,uQ.useMemo)(()=>{let T=Array.isArray(a.items)?a.items:a.items();return T.length>0?T:[{label:a.displayName?"No actions for ".concat(a.displayName):"No actions found",enabled:!1}]},[a.items]);return(0,hQ.createPortal)(HM.default.createElement(fO,{items:E,onRequestClose:a.onRequestClose,displayName:a.displayName,ref:c}),b)},fQ=dQ}),jM,pQ,mQ,A6e=I(()=>{jM=Q(qe()),pQ=(a,u)=>{let[c,m]=(0,jM.useState)({isOpen:!1}),_=(0,jM.useCallback)(()=>m({isOpen:!1}),[]);return(0,jM.useEffect)(()=>{if(!a||u.disabled===!0){m({isOpen:!1});return}let b=E=>{m({isOpen:!0,event:E}),E.preventDefault(),E.stopPropagation()};return a.addEventListener("contextmenu",b),()=>{a.removeEventListener("contextmenu",b)}},[a,u.disabled]),[c,_]},mQ=pQ});function El(a,u){let[c,m]=mQ(a,u),[,_]=(0,w6.useContext)(Kb);return(0,w6.useEffect)(()=>{var b;let E;return c.isOpen&&((b=u.onOpen)==null||b.call(u),E=_()),()=>E==null?void 0:E()},[c.isOpen,u.onOpen]),[c.isOpen?w6.default.createElement(fQ,{items:u.menuItems,displayName:u.displayName,clickPoint:c.event,onRequestClose:m}):gQ,m,c.isOpen]}var w6,gQ,Tl=I(()=>{w6=Q(qe()),C6e(),A6e(),$O(),gQ=w6.default.createElement(w6.default.Fragment,null)});function B9(a,u){return u.length===0?a:Qu(a,u)}var WM=I(()=>{Qf()});function vQ(a,u){return a==null?null:a instanceof Element&&a.matches(u)?a:vQ(a.parentElement,u)}var P6e=I(()=>{});function Rb(a,u){let c=a;for(let m of u)c=c[m];return c}var $M=I(()=>{});function R6e(a){let u=new XM.Atom(void 0),c=new XM.Atom({}),m=new XM.Atom({}),_=0;return{addRelatedFlags(b,E){let T=String(++_),R=E.map(N=>{let z={flag:N.flag},G=[N.affects,b,T];return m.setByPointer(V=>Rb(V,G),z),G});return()=>{for(let N of R)m.setByPointer(z=>Rb(z,N),void 0)}},usePresenceFlag(b){},setUserHover(b){let E=u.get();E!==b&&(E&&c.setByPointer(T=>T[E],!1),u.set(b),b&&c.setByPointer(T=>T[b],!0))}}}function q5(a){let u=qM.default.useContext(mO),c=u.usePresenceFlag(a);return{attrs:{[YM]:a},flag:c,useRelations(m,_){(0,pO.useEffect)(()=>a&&u.addRelatedFlags(a,m()),[a,..._])}}}function yQ(a){let u=qM.default.useContext(mO),c=D9("PresenceListeners");(0,pO.useEffect)(()=>{let m;if(!a)return;let _=b=>{if(b.target instanceof Node){let E=vQ(b.target,"[".concat(YM,"]"));if(E){let T=E.getAttribute(YM);m!==T&&(m=T,u.setUserHover(T||void 0),c._debug("Updated current hover",{itemKey:T}));return}m!=null&&(m=null,u.setUserHover(void 0),c._debug("Cleared current hover"))}};return a.addEventListener("mouseover",_),()=>{a.removeEventListener("mouseover",_),m!=null&&(m=null,c._debug("Cleared current hover as part of cleanup"))}},[a,u])}var qM,pO,_Q,XM,xQ,mO,YM,X5=I(()=>{qM=Q(qe()),pO=Q(qe()),O9(),_Q=mn(),XM=mn(),tr(),P6e(),$M(),xQ=(0,_Q.prism)(()=>{}),xQ.keepHot(),mO=qM.default.createContext(R6e()),YM="data-pi-key"}),r0,bQ,Ib,SQ,gO,z9,wQ,vO,EQ,TQ,MQ,KM,CQ,AQ,PQ,RQ,IQ,kQ,kb,NQ,yO,ZM=I(()=>{Bi(),hc(),r0=Q(qe()),Ft(),X5(),Ib=Te.div(bQ||(bQ=J([`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 16px;
  margin: 0 0px 0 2px;
  position: relative;
  z-index: 0;
  opacity: 0.7;

  &:after {
    position: absolute;
    left: -14px;
    right: -14px;
    top: -2px;
    bottom: -2px;
    content: ' ';
    display: none;
    z-index: -1;
    background: `,`;
  }

  &:hover {
    opacity: 1;
    &:after {
      display: block;
    }
  }
`])),Fd(.2,"black")),gO=Te.div(SQ||(SQ=J([`
  background: none;
  position: relative;
  border: 0;
  transition: transform 0.1s ease-out;
  z-index: 0;
  outline: none;
  cursor: pointer;

  &:after {
    display: none;
    `,`:hover & {
      display: block;
    }
    position: absolute;
    left: -4px;
    right: -4px;
    top: -4px;
    bottom: -4px;
    content: ' ';
    z-index: -1;
  }
`])),Ib),z9={offColor:"#555",onColor:"#e0c917"},vO=Te(gO)(wQ||(wQ=J([`
  &:hover {
    color: #e0c917;
  }

  color: `,`;
`])),a=>a.presence===2?"white":a.isOn?z9.onColor:z9.offColor),TQ=e0(EQ||(EQ=J([`
  pointer-events: none !important;
`]))),KM=Te(gO)(MQ||(MQ=J([`
  color: `,`;

  `,`;
`])),a=>a.flag===2?"white":a.available?z9.onColor:z9.offColor,a=>a.available?Fi:TQ),AQ=Te(KM)(CQ||(CQ=J([`
  transform: translateX(2px);
  `,`:hover & {
    transform: translateX(-7px);
  }
`])),Ib),RQ=Te(KM)(PQ||(PQ=J([`
  transform: translateX(-2px);
  `,`:hover & {
    transform: translateX(7px);
  }
`])),Ib),(a=>{let u=Te.g(IQ||(IQ=J([`
    stroke-width: 1;
    `,`:hover & path {
      stroke-width: 3;
    }
  `])),KM);a.Prev=()=>r0.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r0.default.createElement(u,{transform:"translate(6 3)"},r0.default.createElement("path",{d:"M4 1L1 4L4 7",stroke:"currentColor"}))),a.Next=()=>r0.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r0.default.createElement(u,{transform:"translate(1 3)"},r0.default.createElement("path",{d:"M1 1L4 4L1 7",stroke:"currentColor"})));let c=Te.g(kQ||(kQ=J([`
    stroke-width: 0;
    `,`:hover & path {
      stroke: currentColor;
      stroke-width: 2;
    }
  `])),vO);a.Cur=()=>r0.default.createElement("svg",{width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r0.default.createElement(c,{transform:"translate(1 4)"},r0.default.createElement("path",{d:"M3 0L6 3L3 6L0 3L3 0Z",fill:"currentColor"})))})(kb||(kb={})),NQ=a=>{var u,c,m,_,b;let E=q5((u=a.prev)==null?void 0:u.itemKey),T=q5(((c=a.cur)==null?void 0:c.type)==="on"?a.cur.itemKey:void 0),R=q5((m=a.next)==null?void 0:m.itemKey);return r0.default.createElement(Ib,null,r0.default.createElement(AQ,P({available:!!a.prev,onClick:(_=a.prev)==null?void 0:_.jump,flag:E.flag},E.attrs),r0.default.createElement(kb.Prev,null)),r0.default.createElement(vO,P({isOn:a.cur.type==="on",onClick:a.cur.toggle,presence:T.flag},T.attrs),r0.default.createElement(kb.Cur,null)),r0.default.createElement(RQ,P({available:!!a.next,onClick:(b=a.next)==null?void 0:b.jump,flag:R.flag},R.attrs),r0.default.createElement(kb.Next,null)))},yO=NQ}),QM,Nb,DQ,OQ,FQ,LQ,UQ,BQ,zQ,Db,VQ=I(()=>{hc(),QM=Q(qe()),Ft(),Ae(),ZM(),L9(),Nb={defaultState:{color:Fd(.95,"#C4C4C4"),hoverColor:Fd(.15,z9.onColor)},withStaticOverride:{color:Fd(.85,"#C4C4C4"),hoverColor:Fd(.15,z9.onColor)}},OQ=Te.div(DQ||(DQ=J([`
  width: 16px;
  margin: 0 0px 0 2px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  color: `,`;

  &:hover {
    color: `,`;
  }
`])),a=>a.hasStaticOverride?Nb.withStaticOverride.color:Nb.defaultState.color,a=>a.hasStaticOverride?Nb.withStaticOverride.hoverColor:Nb.defaultState.hoverColor),LQ=Te.div(FQ||(FQ=J([`
  width: 5px;
  height: 5px;
  border-radius: 1px;
  transform: rotate(45deg);
  /* border: 1px solid currentColor; */
  background-color: currentColor;
`]))),BQ=Te.div(UQ||(UQ=J([`
  width: 5px;
  height: 5px;
  background-color: currentColor;
  border-radius: 1px;
  transform: rotate(45deg);
`]))),zQ=a=>{let{hasStaticOverride:u,obj:c,propConfig:m,pathToProp:_}=a;return QM.default.createElement(OQ,{hasStaticOverride:u,onClick:()=>{Se().transaction(({stateEditors:b})=>{for(let{path:E,conf:T}of Mb(m,_)){if(Cp(T))continue;let R=$(P({},c.address),{pathToProp:E});b.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(R,m)}})},title:"Sequence this prop"},u?QM.default.createElement(BQ,{title:"The default value is overridden"}):QM.default.createElement(LQ,{title:"This is the default value for this prop"}))},Db=zQ});function Ob(a){return JSON.stringify(_O(a))}function _O(a){return ec(a)?Object.keys(a).sort().reduce((u,c)=>(u[c]=_O(a[c]),u),{}):Array.isArray(a)?a.map(_O):a}var I6e=I(()=>{Ua()}),GQ,Fb,HQ=I(()=>{GQ="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Fb=(a=21)=>{let u="",c=a;for(;c--;)u+=GQ[Math.random()*64|0];return u}});function jQ(){return Fb(10)}function k6e(){return Fb(10)}function N6e(){return Fb(10)}var go,Gm=I(()=>{I6e(),HQ(),go={forSheet(){return"sheet"},forSheetObject(a){return Ob({o:a.address.objectKey})},forSheetObjectProp(a,u){return Ob({o:a.address.objectKey,p:u})},forTrackKeyframe(a,u,c){return Ob({o:a.address.objectKey,t:u,k:c})},forSheetObjectAggregateKeyframe(a,u){return go.forCompoundPropAggregateKeyframe(a,[],u)},forSheetAggregateKeyframe(a,u){return Ob({o:a.address.sheetId,pos:u})},forCompoundPropAggregateKeyframe(a,u,c){return Ob({o:a.address.objectKey,p:u,pos:c})}}});function WQ(a,u,c){if(!u||u.data.keyframes.length===0)return $Q;let m=xO.get(u.data);if(m&&m[0]===c)return m[1];function _(E){if(!u)return;let T=u.data.keyframes[E];return T&&{kf:T,track:u,itemKey:go.forTrackKeyframe(a,u.id,T.id)}}let b=(()=>{let E=u.data.keyframes.findIndex(R=>R.position>=c);if(E===-1)return{prev:_(u.data.keyframes.length-1)};let T=_(E);return T.kf.position===c?{prev:_(E-1),cur:T,next:_(E+1)}:{next:T,prev:_(E-1)}})();return xO.set(u.data,[c,b]),b}var xO,$Q,qQ=I(()=>{Gm(),xO=new WeakMap,$Q={}}),bO,XQ=I(()=>{bO={}});function D6e(a,u,c){let m=(0,gh.getPointerParts)(a).path;return Gr(()=>{if(!cO(c))return{type:"AllStatic",beingScrubbed:!1,contextMenuItems:[],controlIndicators:Y5.default.createElement(Db,{hasStaticOverride:!1,obj:u,pathToProp:m,propConfig:c})};let _=!!(0,gh.val)(Qu(Se().atomP.ephemeral.projects.stateByProjectId[u.address.projectId].stateBySheetId[u.address.sheetId].stateByObjectKey[u.address.objectKey].valuesBeingScrubbed,(0,gh.getPointerParts)(a).path)),b=[],E={beingScrubbed:_,contextMenuItems:b,controlIndicators:Y5.default.createElement(Y5.default.Fragment,null)},T=(0,gh.val)(u.template.getMapOfValidSequenceTracks_forStudio()),R=B9(T,m),N=R!==void 0&&Object.keys(R).length!==0,z=[],G=(0,gh.val)(u.template.getStaticButNotSequencedOverrides()),V=B9(G??bO,m)!==void 0;if(N)for(let B of Mb(c,[])){if(Cp(B.conf))continue;let j=B9(R,B.path);typeof j!="string"?V=!0:z.push(j)}if((V||N)&&b.push({label:"Reset all to default",callback:()=>{Se().transaction(({unset:B})=>{B(a)})}}),N&&b.push({label:"Make all static",callback:()=>{Se().transaction(({stateEditors:B})=>{for(let{path:j,conf:H}of Mb(c,[])){if(Cp(H))continue;let X=$(P({},u.address),{pathToProp:[...m,...j]}),K=Rb(a,j);B.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic($(P({},X),{value:u.getValueByPointer(K)}))}})}}),(!N||N&&V)&&b.push({label:"Sequence all",callback:()=>{Se().transaction(({stateEditors:B})=>{for(let{path:j,conf:H}of Mb(c,m)){if(Cp(H))continue;let X=$(P({},u.address),{pathToProp:j});B.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(X,c)}})}}),N){let B=gh.prism.memo("controlIndicators",()=>Y5.default.createElement(O6e,{pointerToProp:a,obj:u,possibleSequenceTrackIds:R,listOfDescendantTrackIds:z}),[R,z]);return $(P({},E),{type:"HasSequences",controlIndicators:B})}else return $(P({},E),{type:"AllStatic",controlIndicators:Y5.default.createElement(Db,{hasStaticOverride:V,obj:u,pathToProp:m,propConfig:c})})},[])}function O6e({pointerToProp:a,obj:u,possibleSequenceTrackIds:c,listOfDescendantTrackIds:m}){return Gr(()=>{let _=(0,gh.getPointerParts)(a).path,b=(0,gh.val)(u.sheet.getSequence().positionPrism),E=m.map(B=>({trackId:B,track:(0,gh.val)(u.template.project.pointers.historic.sheetsById[u.address.sheetId].sequence.tracksByObject[u.address.objectKey].trackData[B])})).filter(({track:B})=>!!B).map(B=>$(P({},B),{nearbies:WQ(u,{id:B.trackId,data:B.track,sheetObject:u},b)})),T=E.find(({nearbies:B})=>!!B.cur),R=E.every(({nearbies:B})=>!!B.cur),N=E.reduce((B,j)=>j.nearbies.prev&&(B===void 0||j.nearbies.prev.kf.position>B.kf.position)?j.nearbies.prev:B,void 0),z=E.reduce((B,j)=>j.nearbies.next&&(B===void 0||j.nearbies.next.kf.position<B.kf.position)?j.nearbies.next:B,void 0),G=()=>{R?Se().transaction(B=>{B.unset(a)}):T?Se().transaction(B=>{B.set(a,(0,gh.val)(a))}):Se().transaction(B=>{B.set(a,(0,gh.val)(a))})},V={cur:T?{type:"on",itemKey:go.forCompoundPropAggregateKeyframe(u,_,b),toggle:G}:{toggle:G,type:"off"},prev:N!==void 0?{position:N.kf.position,itemKey:go.forCompoundPropAggregateKeyframe(u,_,N.kf.position),jump:()=>{u.sheet.getSequence().position=N.kf.position}}:void 0,next:z!==void 0?{position:z.kf.position,itemKey:go.forCompoundPropAggregateKeyframe(u,_,z.kf.position),jump:()=>{u.sheet.getSequence().position=z.kf.position}}:void 0};return Y5.default.createElement(yO,P({},V))},[a,u,c,m])}var gh,Y5,F6e=I(()=>{Ae(),WM(),tr(),gh=mn(),Qf(),Y5=Q(qe()),VQ(),L9(),Gm(),$M(),ZM(),qQ(),XQ()});function L6e(){let a=0,u=new ZQ.Atom({hasLock:!1});return{replaceLock(c,m){let _=a++,b=u.get();return b.hasLock&&b.cleanup(),u.set({hasLock:!0,lockId:_,cleanup:m,deepPath:U6e(YQ(c))}),function(){let E=u.get();E.hasLock&&E.lockId===_&&(E.cleanup(),u.set({hasLock:!1}))}},getIsPropHighlightedD(c){let m=Rb(u.pointer.deepPath,YQ(c));return(0,QQ.prism)(()=>{let _=(0,KQ.val)(m);return _===!0?"self":_?"descendent":null})}}}function YQ(a){return[a.projectId,a.sheetId,a.objectKey,...a.pathToProp]}function U6e(a){let u={};return Sm(u,a,!0),u}var KQ,ZQ,QQ,JM,SO=I(()=>{KQ=mn(),ZQ=mn(),QQ=mn(),$M(),Vy(),JM=L6e()});function B6e(a,u){return JSON.stringify(a,u,2).replace(/^([\{\[])\n (\s+)/,"$1$2").replace(/(\n[ ]+[\{\[])\n\s+/g,"$1 ").replace(/\n\s*([\]\}])/g," $1")}var z6e=I(()=>{});function JQ(a,u=!0){try{return typeof a=="string"?a:typeof a=="function"||a instanceof Error?a.toString():u?B6e(a):JSON.stringify(a)}catch{return(a==null?void 0:a.name)||String(a)}}var V6e=I(()=>{z6e()});function G6e(a,u,c){a||(arguments.length>2?eJ(u,c):eJ(u))}function eJ(a,u){let c=arguments.length>1,m=JQ(a),_=c?`
Instead found: `.concat(JQ(u)):"";throw new sJ("Invariant: ".concat(m).concat(_),u)}var tJ,nJ,rJ,iJ,sJ,H6e=I(()=>{V6e(),tJ=/^\s*at.+node:internal.+/gm,nJ=/^\s*(at|[^@]+@) (?:Object\.)?invariant.+/gm,rJ=/^\s*(at|[^@]+@).+test\-helpers.+/gm,iJ=/^\s*(at|[^@]+@).+(debounce|invariant|iif)\.[tj]s.*/gm,sJ=class extends Error{constructor(a,u){var c;super(a),le(this,"found"),u!==void 0&&(this.found=u),this.stack=(c=this.stack)==null?void 0:c.replace(nJ,"").replace(iJ,"").replace(rJ,"").replace(tJ,"")}}});function j6e(a){return(0,eC.prism)(()=>{if(Array.isArray(a)){let u=new Array(a.length);for(let c=0;c<a.length;c++)u[c]=a[c].getValue();return u}else{let u={};for(let c in a)u[c]=(0,eC.val)(a[c]);return u}})}function wO(a){let u=E6.default.memo(E6.default.forwardRef(function(c,m){let _=[],b={},E={ref:m};for(let z in c){let G=c[z];(0,eC.isPrism)(G)?(_.push(G),b[z]=G):E[z]=G}let T=(0,E6.useRef)(_.length);G6e(T.current===_.length,"expect same number of observable props on every invocation of deriver wrapped component.",{initial:T.current,count:_.length});let R=(0,E6.useMemo)(()=>j6e(b),_),N=I5(R);return N&&E6.default.createElement(a,P(P({},E),N))}));return u.displayName="deriver(".concat(a.displayName,")"),u}var eC,E6,aJ=I(()=>{eC=mn(),tr(),E6=Q(qe()),H6e()});function W6e(a,u,c){return(0,Vd.prism)(()=>{var m;let _=(0,Vd.getPointerParts)(a).path,b=u.getValueByPointer(a),E=Vd.prism.memo("editPropValue",()=>{let j=null;return{temporarilySetValue(H){j||(j=Se().scrub()),j.capture(X=>{X.set(a,H)})},discardTemporaryValue(){j&&(j.discard(),j=null)},permanentlySetValue(H){j?(j.capture(X=>{X.set(a,H)}),j.commit(),j=null):Se().transaction(X=>{X.set(a,H)})}}},[]),T={createAsset:j=>u.sheet.project.assetStorage.createAsset(j),getAssetUrl:j=>j.id?u.sheet.project.assetStorage.getAssetUrl(j.id):void 0},R=(0,Vd.val)(Qu(Se().atomP.ephemeral.projects.stateByProjectId[u.address.projectId].stateBySheetId[u.address.sheetId].stateByObjectKey[u.address.objectKey].valuesBeingScrubbed,(0,Vd.getPointerParts)(a).path))===!0,N=[],z=$(P(P({},E),T),{value:b,beingScrubbed:R,contextMenuItems:N,controlIndicators:T6.default.createElement(T6.default.Fragment,null)}),G=E6e(c);if(G){let j=(0,Vd.val)(u.template.getMapOfValidSequenceTracks_forStudio()),H=B9(j,_);if(typeof H=="string"){N.push({label:"Make static",callback:()=>{Se().transaction(({stateEditors:ye})=>{let Ne=$(P({},u.address),{pathToProp:_});ye.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic($(P({},Ne),{value:u.getValueByPointer(a)}))})}});let X=H,K=Vd.prism.sub("lcr",()=>{let ye=(0,Vd.val)(u.template.project.pointers.historic.sheetsById[u.address.sheetId].sequence.tracksByObject[u.address.objectKey].trackData[X]),Ne=(0,Vd.val)(u.sheet.getSequence().positionPrism);return WQ(u,ye&&{data:ye,id:X,sheetObject:u},Ne)},[X]),te;z.beingScrubbed?te="Sequenced_OnKeyframe_BeingScrubbed":K.cur?te="Sequenced_OnKeyframe":((m=K.prev)==null?void 0:m.kf.connectedRight)===!0?te="Sequenced_BeingInterpolated":te="Sequened_NotBeingInterpolated";let se=()=>{K.cur?Se().transaction(ye=>{ye.unset(a)}):Se().transaction(ye=>{ye.set(a,z.value)})},pe={cur:K.cur?{type:"on",itemKey:K.cur.itemKey,toggle:se}:{type:"off",toggle:se},prev:K.prev!==void 0?{itemKey:K.prev.itemKey,position:K.prev.kf.position,jump:()=>{u.sheet.getSequence().position=K.prev.kf.position}}:void 0,next:K.next!==void 0?{itemKey:K.next.itemKey,position:K.next.kf.position,jump:()=>{u.sheet.getSequence().position=K.next.kf.position}}:void 0},fe=T6.default.createElement(yO,P({},pe));return $(P({},z),{type:"Sequenced",shade:te,nearbyKeyframes:K,controlIndicators:fe})}}let V=(0,Vd.val)(u.template.getStaticValues()),B=B9(V,_);return typeof B<"u"&&N.push({label:"Reset to default",callback:()=>{Se().transaction(({unset:j})=>{j(a)})}}),G&&N.push({label:"Sequence",callback:()=>{Se().transaction(({stateEditors:j})=>{let H=$(P({},u.address),{pathToProp:_});j.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(H,c)})}}),typeof B<"u"?$(P({},z),{type:"Static",shade:z.beingScrubbed?"Static_BeingScrubbed":"Static",controlIndicators:T6.default.createElement(Db,{hasStaticOverride:!0,obj:u,pathToProp:_,propConfig:c})}):$(P({},z),{type:"Default",shade:"Default",controlIndicators:T6.default.createElement(Db,{hasStaticOverride:!0,obj:u,pathToProp:_,propConfig:c})})})}function $6e(a,u,c){if(tC.has(a))return tC.get(a);{let m=W6e(a,u,c);return tC.set(a,m),m}}function EO(a,u,c){let m=$6e(a,u,c);return I5(m)}var T6,Vd,tC,TO=I(()=>{Qf(),T6=Q(qe()),Vd=mn(),Ae(),WM(),tr(),L9(),VQ(),qQ(),ZM(),tC=new WeakMap});function q6e({propConfig:a,pointerToProp:u,obj:c,SimpleEditorComponent:m}){let _=EO(u,c,a);return i0.default.createElement(ND,{editingTools:_,propConfig:a,value:_.value})}function X6e({pointerToProp:a,obj:u,propConfig:c,visualIndentation:m}){var _;let b=(_=c.label)!=null?_:xm((0,Lb.getPointerParts)(a).path),E=Object.entries(c.props),T=E.filter(([se,pe])=>Cp(pe)),R=E.filter(([se,pe])=>!Cp(pe)),[N,z]=Ii(null),G=D6e(a,u,c),[V]=El(z,{menuItems:G.contextMenuItems}),B=T.length>0,j=(0,i0.useMemo)(()=>JM.getIsPropHighlightedD($(P({},u.address),{pathToProp:(0,Lb.getPointerParts)(a).path})),[a]),H="".concat(u.address.projectId,",").concat(u.address.sheetId,",").concat(u.address.sheetInstanceId,",").concat(u.address.objectKey,",").concat((0,Lb.getPointerParts)(a).path.join()),X=SJ(c);(0,i0.useLayoutEffect)(()=>{nC.has(H)||nC.set(H,new Lb.Atom(X))},[H,c]);let K=nC.get(H),te=Gr(()=>K?(0,oJ.val)(K.pointer):X,[K]);return i0.default.createElement(uJ,null,V,i0.default.createElement(MO,{style:{"--depth":m-1}},i0.default.createElement(dJ,{isVectorProp:X},i0.default.createElement(pJ,null,G.controlIndicators),i0.default.createElement(gJ,{isHighlighted:j,ref:N},i0.default.createElement("span",null,b||"Props")),i0.default.createElement(yJ,{isCollapsed:te,isVector:X,onClick:()=>{K==null||K.set(!K.get())}},i0.default.createElement(MY,null))),X&&te&&i0.default.createElement(EJ,null,[...E].map(([se,pe])=>i0.default.createElement(q6e,{key:"prop-"+se,propConfig:pe,pointerToProp:a[se],obj:u})))),!te&&i0.default.createElement(bJ,{style:{"--depth":m},depth:m,lastSubIsComposite:B},[...R,...T].map(([se,pe])=>i0.default.createElement(AO,{key:"prop-"+se,propConfig:pe,pointerToProp:a[se],obj:u,visualIndentation:m+1}))))}var Lb,i0,oJ,lJ,uJ,cJ,MO,hJ,dJ,fJ,pJ,mJ,gJ,vJ,yJ,_J,xJ,bJ,SJ,wJ,EJ,TJ,nC,Y6e=I(()=>{L9(),Lb=mn(),Ny(),hc(),i0=Q(qe()),Ft(),$Z(),$5(),Bi(),Ui(),BJ(),Tl(),F6e(),SO(),aJ(),gY(),TO(),tr(),oJ=mn(),x6(),BM(),uJ=Te.div(lJ||(lJ=J([`
  --step: 15px;
  --left-pad: 15px;
  `,`;
  --right-width: 60%;
`])),Fi),MO=Te.div(cJ||(cJ=J([`
  height: 30px;
  display: flex;
  align-items: stretch;
  position: relative;
`]))),dJ=Te.div(hJ||(hJ=J([`
  padding-left: `,`;
  display: flex;
  align-items: center;
  overflow: hidden;
  `,`;
`])),hO,({isVectorProp:a})=>a?"width: calc(100% - var(--right-width))":""),pJ=Te.div(fJ||(fJ=J([`
  flexshrink: 0;
`]))),gJ=wO(Te.div(mJ||(mJ=J([`
  margin-left: 4px;
  cursor: default;
  height: 100%;
  display: flex;
  align-items: center;
  gap: 4px;
  user-select: none;
  &:hover {
    color: white;
  }
  overflow: hidden;

  `,`;
`])),()=>U9)),yJ=Te.span(vJ||(vJ=J([`
  width: 28px;
  height: 28px;
  font-size: 9px;
  display: flex;
  align-items: center;
  justify-content: center;

  transition: transform 0.05s ease-out, color 0.1s ease-out;
  transform: rotateZ(`,`deg);
  color: #66686a;

  visibility: `,`;

  `,`:hover & {
    visibility: visible;
  }

  &:hover {
    transform: rotateZ(`,`deg);
    color: #c0c4c9;
  }
`])),a=>a.isCollapsed?0:90,a=>!a.isVector&&a.isCollapsed||a.isVector&&!a.isCollapsed?"visible":"hidden",MO,a=>a.isCollapsed?15:75),_J=Fd(.05,"#282b2f"),bJ=Te.div(xJ||(xJ=J([`
  /* background: `,`; */
  /* padding: `,` 0; */
`])),({depth:a})=>ib(a*.03,_J),a=>a.lastSubIsComposite?0:"4px"),SJ=Tb(a=>{let u=Object.entries(a.props);return u.length<=3&&u.every(([c,m])=>m.type==="number"&&["x","y","z"].includes(c))}),EJ=Te.div(wJ||(wJ=J([`
  display: flex;
  align-items: center;
  justify-content: stretch;
  padding: 0 8px 0 2px;
  box-sizing: border-box;
  height: 100%;
  width: var(--right-width);
  flex-shrink: 0;
  flex-grow: 0;
`]))),TJ=i0.default.memo(X6e),nC=new Map});function K6e({isHighlighted:a}){return a==="self"?"#1857a4":a==="descendent"?"#0a2f5c":"initial"}var Z6e=I(()=>{});function Q6e({propConfig:a,pointerToProp:u,editingTools:c,children:m,isPropHighlightedD:_}){var b;let E=(b=a.label)!=null?b:xm((0,CO.getPointerParts)(u).path),[T,R]=Ii(null),[N]=El(R,{menuItems:c.contextMenuItems});return M6.default.createElement(CJ,{isHighlighted:_},N,M6.default.createElement(PJ,null,M6.default.createElement(NJ,null,c.controlIndicators),M6.default.createElement(IJ,{isHighlighted:_,ref:T,title:["obj","props",...(0,CO.getPointerParts)(u).path].join(".")},E)),M6.default.createElement(OJ,null,m))}var CO,M6,MJ,CJ,AJ,PJ,RJ,IJ,kJ,NJ,DJ,OJ,J6e=I(()=>{CO=mn(),Tl(),Ui(),Ua(),M6=Q(qe()),Ft(),Bi(),$5(),aJ(),$Z(),Z6e(),CJ=wO(Te.div(MJ||(MJ=J([`
  display: flex;
  height: 30px;
  justify-content: flex-start;
  align-items: stretch;
  // We cannot calculate both the container (details panel) width and the descendant
  // (this) width dynamically. This leads to the container width being calculated
  // without this percentage being taken into consideration leads to horizontal
  // clipping/scrolling--the same way as if we explicitly fixed either the container
  // width, or the descendant width.
  // The correct solution for tabulated UIs with dynamic container widths is to use
  // CSS grid. For now I fixed this issue by just giving a great enough width
  // to the details panel so most things don't break.
  --right-width: 60%;
  position: relative;
  `,`;

  /* background-color: `,`; */
`])),Fi,K6e)),PJ=Te.div(AJ||(AJ=J([`
  box-sizing: border-box;
  padding-left: `,`;
  padding-right: 4px;
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: stretch;
  gap: 4px;
  flex-grow: 0;
  flex-shrink: 0;
  width: calc(100% - var(--right-width));
`])),hO),IJ=wO(Te.div(RJ||(RJ=J([`
  text-align: left;
  flex: 1 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: flex;
  align-items: center;
  user-select: none;
  cursor: default;

  `,`;
  &:hover {
    color: white;
  }
`])),U9)),NJ=Te.div(kJ||(kJ=J([`
  flex-basis: 8px;
  flex: 0 0;
  display: flex;
  align-items: center;
`]))),OJ=Te.div(DJ||(DJ=J([`
  display: flex;
  align-items: center;
  justify-content: stretch;
  padding: 0 8px 0 2px;
  box-sizing: border-box;
  height: 100%;
  width: var(--right-width);
  flex-shrink: 0;
  flex-grow: 0;
`])))});function e7e({propConfig:a,pointerToProp:u,obj:c,SimpleEditorComponent:m}){let _=EO(u,c,a),b=(0,Ub.useMemo)(()=>JM.getIsPropHighlightedD($(P({},c.address),{pathToProp:(0,FJ.getPointerParts)(u).path})),[u]);return Ub.default.createElement(Q6e,{editingTools:_,propConfig:a,pointerToProp:u,isPropHighlightedD:b},Ub.default.createElement(m,{editingTools:_,propConfig:a,value:_.value}))}var Ub,FJ,LJ,t7e=I(()=>{Ub=Q(qe()),TO(),J6e(),FJ=mn(),SO(),LJ=Ub.default.memo(e7e)}),Bb,UJ,AO,BJ=I(()=>{Bb=Q(qe()),WZ(),Y6e(),t7e(),UJ=({propConfig:a,visualIndentation:u,pointerToProp:c,obj:m})=>{if(a.type==="compound")return Bb.default.createElement(TJ,{obj:m,visualIndentation:u,pointerToProp:c,propConfig:a});if(a.type==="enum")return Bb.default.createElement(Bb.default.Fragment,null);{let _=uO[a.type];return Bb.default.createElement(LJ,{SimpleEditorComponent:_,obj:m,visualIndentation:u,pointerToProp:c,propConfig:a})}},AO=UJ});function zJ(a){return rC.has(a)||rC.set(a,(VJ++).toString()),rC.get(a)}var rC,VJ,GJ=I(()=>{rC=new WeakMap,VJ=0}),C6,HJ,jJ,WJ,$J,qJ,XJ,n7e=I(()=>{C6=Q(qe()),BJ(),tr(),GJ(),Ft(),jJ=Te.div(HJ||(HJ=J([`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 8px;
`]))),$J=Te.button(WJ||(WJ=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  border-radius: 2px;

  color: #a8a8a9;
  background: rgba(255, 255, 255, 0.1);

  border: none;
  height: 28px;

  &:hover {
    background: rgba(255, 255, 255, 0.15);
  }

  &:active {
    background: rgba(255, 255, 255, 0.2);
  }
`]))),qJ=({objects:a})=>{let u=a[0],c=qr(u.template.configPointer),m=qr(u.template._temp_actionsPointer);return C6.default.createElement(C6.default.Fragment,null,C6.default.createElement(AO,{key:zJ(u),obj:u,pointerToProp:u.propsP,propConfig:c,visualIndentation:1}),C6.default.createElement(jJ,null,m&&Object.entries(m).map(([_,b])=>C6.default.createElement($J,{key:_,onClick:()=>{b(u.publicApi)}},_))))},XJ=qJ}),YJ,KJ,iC,ZJ=I(()=>{Ft(),KJ=Te.button(YJ||(YJ=J([`
  text-align: center;
  padding: 8px;
  border-radius: 2px;
  border: 1px solid #627b7b87;
  background-color: #4b787d3d;
  color: #eaeaea;
  font-weight: 400;
  display: block;
  appearance: none;
  flex-grow: 1;
  cursor: `,`;
  opacity: `,`;

  &:hover {
    background-color: #7dc1c878;
    border-color: #9ebcbf;
  }
`])),a=>a.disabled?"none":"pointer",a=>a.disabled?.4:1),iC=KJ}),r7e=I(()=>{}),QJ,i7e=I(()=>{r7e(),QJ=(a=21)=>{let u="",c=crypto.getRandomValues(new Uint8Array(a));for(;a--;){let m=c[a]&63;m<36?u+=m.toString(36):m<62?u+=(m-26).toString(36).toUpperCase():m<63?u+="_":u+="-"}return u}});function JJ(){return QJ(16)}var eee=I(()=>{i7e()}),tee,Hm,PO,nee,ree,iee,see,aee=I(()=>{tee=mn(),Ui(),Hm=Q(qe()),PO=(0,Hm.createContext)(null),nee=0,ree=()=>{let a=(0,Hm.useMemo)(()=>nee++,[]),{cur:u,set:c}=(0,Hm.useContext)(PO),[m,_]=Ii(!1),b=(0,Hm.useCallback)((E,T)=>{c(E?a:-1,T)},[]);return(0,Hm.useEffect)(()=>u.onStale(()=>{let E=u.getValue()===a;m.current!==E&&(m.current=E)}),[u,a]),[_,b]},iee=({children:a})=>{let u=(0,Hm.useMemo)(()=>new tee.Atom(-1),[]),c=u.prism,m=(0,Hm.useMemo)(()=>{let _;return(b,E)=>{let T=_!==void 0;_!==void 0&&(clearTimeout(_),_=void 0),E===0||T?u.set(b):_=setTimeout(()=>{u.set(b),_=void 0},E)}},[]);return Hm.default.createElement(PO.Provider,{value:{cur:c,set:m}},a)},see=iee});function A6(a,u){let c=a.enabled!==!1,[m,_]=ree(),[b,E]=Ii(null);(0,lee.useEffect)(()=>{if(!c)return;let R=b.current;if(!R)return;let N=()=>{var G;return _(!0,(G=a.enterDelay)!=null?G:400)},z=()=>{var G;return _(!1,(G=a.exitDelay)!=null?G:200)};return R.addEventListener("mouseenter",N),R.addEventListener("mouseleave",z),()=>{R.removeEventListener("mouseenter",N),R.removeEventListener("mouseleave",z)}},[b,c,a.enterDelay,a.exitDelay]);let T=(0,oee.useContext)(c6);return[c&&m&&E?(0,uee.createPortal)(sC.default.createElement(rO,{children:u,target:E,onClickOutside:Ld,verticalPlacement:a.verticalPlacement,verticalGap:a.verticalGap}),T):sC.default.createElement(sC.default.Fragment,null),b,m]}var oee,lee,sC,uee,zb=I(()=>{Ui(),oee=Q(qe()),lee=Q(qe()),sC=Q(qe()),qK(),uee=Q(mo()),aee(),H5(),f6()}),cee,hee,P6,aC=I(()=>{Ft(),Tp(),hee=Te(Ep)(cee||(cee=J([`
  padding: 1em;
  max-width: 240px;
  pointer-events: none !important;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: #45464d;
`]))),P6=hee}),Ap,dee,fee,pee,mee,gee,vee,yee,_ee,xee,s7e=I(()=>{tr(),Ae(),Ap=Q(qe()),Ft(),eee(),zb(),aC(),ZJ(),fee=Te.div(dee||(dee=J([`
  padding: 8px 10px;
  position: relative;
  background-color: #6d232352;
  &:before {
    position: absolute;
    content: ' ';
    display: block;
    left: 0;
    top: 0;
    bottom: 0;
    width: 2px;
    background-color: #ff000070;
  }
`]))),mee=Te.div(pee||(pee=J([`
  margin-bottom: 1em;
  & a {
    color: inherit;
  }
`]))),vee=Te.div(gee||(gee=J([`
  display: flex;
  gap: 8px;
`]))),yee=({projectId:a})=>{let u=qr(Se().atomP.ephemeral.coreByProject[a].loadingState);return u&&u.type==="browserStateIsNotBasedOnDiskState"?Ap.default.createElement(_ee,{loadingState:u,projectId:a}):null},_ee=({projectId:a,loadingState:u})=>{let c=()=>{Se().transaction(({drafts:R,stateEditors:N})=>{N.coreByProject.historic.revisionHistory.add({projectId:a,revision:u.onDiskState.revisionHistory[0]}),N.coreByProject.historic.revisionHistory.add({projectId:a,revision:JJ()}),R.ephemeral.coreByProject[a].loadingState={type:"loaded"}})},m=()=>{Se().transaction(({drafts:R})=>{R.historic.coreByProject[a]=u.onDiskState,R.ephemeral.coreByProject[a].loadingState={type:"loaded"}})},[_,b]=A6({},()=>Ap.default.createElement(P6,null,"The browser's state will override the disk state.")),[E,T]=A6({},()=>Ap.default.createElement(P6,null,"The disk's state will override the browser's state."));return Ap.default.createElement(fee,null,Ap.default.createElement(mee,null,"Browser state is not based on disk state."," ",Ap.default.createElement("a",{href:"https://www.theatrejs.com/docs/latest/manual/projects#state",target:"_blank"},"Learn more.")),Ap.default.createElement(vee,null,_,Ap.default.createElement(iC,{onClick:c,ref:b},"Use browser's state"),E,Ap.default.createElement(iC,{onClick:m,ref:T},"Use disk state")))},xee=yee}),a7e=ie((a,u)=>{(function(c){typeof a=="object"&&typeof u<"u"?u.exports=c():(typeof window<"u"?window:typeof xa<"u"?xa:typeof self<"u"?self:this).JSZip=c()})(function(){return function c(m,_,b){function E(N,z){if(!_[N]){if(!m[N]){var G=typeof eR=="function"&&eR;if(!z&&G)return G(N,!0);if(T)return T(N,!0);var V=new Error("Cannot find module '"+N+"'");throw V.code="MODULE_NOT_FOUND",V}var B=_[N]={exports:{}};m[N][0].call(B.exports,function(j){var H=m[N][1][j];return E(H||j)},B,B.exports,c,m,_,b)}return _[N].exports}for(var T=typeof eR=="function"&&eR,R=0;R<b.length;R++)E(b[R]);return E}({1:[function(c,m,_){var b=c("./utils"),E=c("./support"),T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";_.encode=function(R){for(var N,z,G,V,B,j,H,X=[],K=0,te=R.length,se=te,pe=b.getTypeOf(R)!=="string";K<R.length;)se=te-K,G=pe?(N=R[K++],z=K<te?R[K++]:0,K<te?R[K++]:0):(N=R.charCodeAt(K++),z=K<te?R.charCodeAt(K++):0,K<te?R.charCodeAt(K++):0),V=N>>2,B=(3&N)<<4|z>>4,j=1<se?(15&z)<<2|G>>6:64,H=2<se?63&G:64,X.push(T.charAt(V)+T.charAt(B)+T.charAt(j)+T.charAt(H));return X.join("")},_.decode=function(R){var N,z,G,V,B,j,H=0,X=0,K="data:";if(R.substr(0,K.length)===K)throw new Error("Invalid base64 input, it looks like a data url.");var te,se=3*(R=R.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(R.charAt(R.length-1)===T.charAt(64)&&se--,R.charAt(R.length-2)===T.charAt(64)&&se--,se%1!=0)throw new Error("Invalid base64 input, bad content length.");for(te=E.uint8array?new Uint8Array(0|se):new Array(0|se);H<R.length;)N=T.indexOf(R.charAt(H++))<<2|(V=T.indexOf(R.charAt(H++)))>>4,z=(15&V)<<4|(B=T.indexOf(R.charAt(H++)))>>2,G=(3&B)<<6|(j=T.indexOf(R.charAt(H++))),te[X++]=N,B!==64&&(te[X++]=z),j!==64&&(te[X++]=G);return te}},{"./support":30,"./utils":32}],2:[function(c,m,_){var b=c("./external"),E=c("./stream/DataWorker"),T=c("./stream/Crc32Probe"),R=c("./stream/DataLengthProbe");function N(z,G,V,B,j){this.compressedSize=z,this.uncompressedSize=G,this.crc32=V,this.compression=B,this.compressedContent=j}N.prototype={getContentWorker:function(){var z=new E(b.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new R("data_length")),G=this;return z.on("end",function(){if(this.streamInfo.data_length!==G.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),z},getCompressedWorker:function(){return new E(b.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},N.createWorkerFrom=function(z,G,V){return z.pipe(new T).pipe(new R("uncompressedSize")).pipe(G.compressWorker(V)).pipe(new R("compressedSize")).withStreamInfo("compression",G)},m.exports=N},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(c,m,_){var b=c("./stream/GenericWorker");_.STORE={magic:"\0\0",compressWorker:function(){return new b("STORE compression")},uncompressWorker:function(){return new b("STORE decompression")}},_.DEFLATE=c("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(c,m,_){var b=c("./utils"),E=function(){for(var T,R=[],N=0;N<256;N++){T=N;for(var z=0;z<8;z++)T=1&T?3988292384^T>>>1:T>>>1;R[N]=T}return R}();m.exports=function(T,R){return T!==void 0&&T.length?b.getTypeOf(T)!=="string"?function(N,z,G,V){var B=E,j=V+G;N^=-1;for(var H=V;H<j;H++)N=N>>>8^B[255&(N^z[H])];return-1^N}(0|R,T,T.length,0):function(N,z,G,V){var B=E,j=V+G;N^=-1;for(var H=V;H<j;H++)N=N>>>8^B[255&(N^z.charCodeAt(H))];return-1^N}(0|R,T,T.length,0):0}},{"./utils":32}],5:[function(c,m,_){_.base64=!1,_.binary=!1,_.dir=!1,_.createFolders=!0,_.date=null,_.compression=null,_.compressionOptions=null,_.comment=null,_.unixPermissions=null,_.dosPermissions=null},{}],6:[function(c,m,_){var b=null;b=typeof Promise<"u"?Promise:c("lie"),m.exports={Promise:b}},{lie:37}],7:[function(c,m,_){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",E=c("pako"),T=c("./utils"),R=c("./stream/GenericWorker"),N=b?"uint8array":"array";function z(G,V){R.call(this,"FlateWorker/"+G),this._pako=null,this._pakoAction=G,this._pakoOptions=V,this.meta={}}_.magic="\b\0",T.inherits(z,R),z.prototype.processChunk=function(G){this.meta=G.meta,this._pako===null&&this._createPako(),this._pako.push(T.transformTo(N,G.data),!1)},z.prototype.flush=function(){R.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},z.prototype.cleanUp=function(){R.prototype.cleanUp.call(this),this._pako=null},z.prototype._createPako=function(){this._pako=new E[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var G=this;this._pako.onData=function(V){G.push({data:V,meta:G.meta})}},_.compressWorker=function(G){return new z("Deflate",G)},_.uncompressWorker=function(){return new z("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(c,m,_){function b(B,j){var H,X="";for(H=0;H<j;H++)X+=String.fromCharCode(255&B),B>>>=8;return X}function E(B,j,H,X,K,te){var se,pe,fe=B.file,ye=B.compression,Ne=te!==N.utf8encode,ze=T.transformTo("string",te(fe.name)),Me=T.transformTo("string",N.utf8encode(fe.name)),je=fe.comment,yt=T.transformTo("string",te(je)),xe=T.transformTo("string",N.utf8encode(je)),We=Me.length!==fe.name.length,ae=xe.length!==je.length,nt="",dn="",Ve="",Ue=fe.dir,at=fe.date,Wt={crc32:0,compressedSize:0,uncompressedSize:0};j&&!H||(Wt.crc32=B.crc32,Wt.compressedSize=B.compressedSize,Wt.uncompressedSize=B.uncompressedSize);var be=0;j&&(be|=8),Ne||!We&&!ae||(be|=2048);var Ce=0,St=0;Ue&&(Ce|=16),K==="UNIX"?(St=798,Ce|=function(It,ut){var Gn=It;return It||(Gn=ut?16893:33204),(65535&Gn)<<16}(fe.unixPermissions,Ue)):(St=20,Ce|=function(It){return 63&(It||0)}(fe.dosPermissions)),se=at.getUTCHours(),se<<=6,se|=at.getUTCMinutes(),se<<=5,se|=at.getUTCSeconds()/2,pe=at.getUTCFullYear()-1980,pe<<=4,pe|=at.getUTCMonth()+1,pe<<=5,pe|=at.getUTCDate(),We&&(dn=b(1,1)+b(z(ze),4)+Me,nt+="up"+b(dn.length,2)+dn),ae&&(Ve=b(1,1)+b(z(yt),4)+xe,nt+="uc"+b(Ve.length,2)+Ve);var Mt="";return Mt+=`
\0`,Mt+=b(be,2),Mt+=ye.magic,Mt+=b(se,2),Mt+=b(pe,2),Mt+=b(Wt.crc32,4),Mt+=b(Wt.compressedSize,4),Mt+=b(Wt.uncompressedSize,4),Mt+=b(ze.length,2),Mt+=b(nt.length,2),{fileRecord:G.LOCAL_FILE_HEADER+Mt+ze+nt,dirRecord:G.CENTRAL_FILE_HEADER+b(St,2)+Mt+b(yt.length,2)+"\0\0\0\0"+b(Ce,4)+b(X,4)+ze+nt+yt}}var T=c("../utils"),R=c("../stream/GenericWorker"),N=c("../utf8"),z=c("../crc32"),G=c("../signature");function V(B,j,H,X){R.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=j,this.zipPlatform=H,this.encodeFileName=X,this.streamFiles=B,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}T.inherits(V,R),V.prototype.push=function(B){var j=B.meta.percent||0,H=this.entriesCount,X=this._sources.length;this.accumulate?this.contentBuffer.push(B):(this.bytesWritten+=B.data.length,R.prototype.push.call(this,{data:B.data,meta:{currentFile:this.currentFile,percent:H?(j+100*(H-X-1))/H:100}}))},V.prototype.openedSource=function(B){this.currentSourceOffset=this.bytesWritten,this.currentFile=B.file.name;var j=this.streamFiles&&!B.file.dir;if(j){var H=E(B,j,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:H.fileRecord,meta:{percent:0}})}else this.accumulate=!0},V.prototype.closedSource=function(B){this.accumulate=!1;var j=this.streamFiles&&!B.file.dir,H=E(B,j,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(H.dirRecord),j)this.push({data:function(X){return G.DATA_DESCRIPTOR+b(X.crc32,4)+b(X.compressedSize,4)+b(X.uncompressedSize,4)}(B),meta:{percent:100}});else for(this.push({data:H.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},V.prototype.flush=function(){for(var B=this.bytesWritten,j=0;j<this.dirRecords.length;j++)this.push({data:this.dirRecords[j],meta:{percent:100}});var H=this.bytesWritten-B,X=function(K,te,se,pe,fe){var ye=T.transformTo("string",fe(pe));return G.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(K,2)+b(K,2)+b(te,4)+b(se,4)+b(ye.length,2)+ye}(this.dirRecords.length,H,B,this.zipComment,this.encodeFileName);this.push({data:X,meta:{percent:100}})},V.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},V.prototype.registerPrevious=function(B){this._sources.push(B);var j=this;return B.on("data",function(H){j.processChunk(H)}),B.on("end",function(){j.closedSource(j.previous.streamInfo),j._sources.length?j.prepareNextSource():j.end()}),B.on("error",function(H){j.error(H)}),this},V.prototype.resume=function(){return!!R.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},V.prototype.error=function(B){var j=this._sources;if(!R.prototype.error.call(this,B))return!1;for(var H=0;H<j.length;H++)try{j[H].error(B)}catch{}return!0},V.prototype.lock=function(){R.prototype.lock.call(this);for(var B=this._sources,j=0;j<B.length;j++)B[j].lock()},m.exports=V},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(c,m,_){var b=c("../compressions"),E=c("./ZipFileWorker");_.generateWorker=function(T,R,N){var z=new E(R.streamFiles,N,R.platform,R.encodeFileName),G=0;try{T.forEach(function(V,B){G++;var j=function(te,se){var pe=te||se,fe=b[pe];if(!fe)throw new Error(pe+" is not a valid compression method !");return fe}(B.options.compression,R.compression),H=B.options.compressionOptions||R.compressionOptions||{},X=B.dir,K=B.date;B._compressWorker(j,H).withStreamInfo("file",{name:V,dir:X,date:K,comment:B.comment||"",unixPermissions:B.unixPermissions,dosPermissions:B.dosPermissions}).pipe(z)}),z.entriesCount=G}catch(V){z.error(V)}return z}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(c,m,_){function b(){if(!(this instanceof b))return new b;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var E=new b;for(var T in this)typeof this[T]!="function"&&(E[T]=this[T]);return E}}(b.prototype=c("./object")).loadAsync=c("./load"),b.support=c("./support"),b.defaults=c("./defaults"),b.version="3.10.1",b.loadAsync=function(E,T){return new b().loadAsync(E,T)},b.external=c("./external"),m.exports=b},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(c,m,_){var b=c("./utils"),E=c("./external"),T=c("./utf8"),R=c("./zipEntries"),N=c("./stream/Crc32Probe"),z=c("./nodejsUtils");function G(V){return new E.Promise(function(B,j){var H=V.decompressed.getContentWorker().pipe(new N);H.on("error",function(X){j(X)}).on("end",function(){H.streamInfo.crc32!==V.decompressed.crc32?j(new Error("Corrupted zip : CRC32 mismatch")):B()}).resume()})}m.exports=function(V,B){var j=this;return B=b.extend(B||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:T.utf8decode}),z.isNode&&z.isStream(V)?E.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):b.prepareContent("the loaded zip file",V,!0,B.optimizedBinaryString,B.base64).then(function(H){var X=new R(B);return X.load(H),X}).then(function(H){var X=[E.Promise.resolve(H)],K=H.files;if(B.checkCRC32)for(var te=0;te<K.length;te++)X.push(G(K[te]));return E.Promise.all(X)}).then(function(H){for(var X=H.shift(),K=X.files,te=0;te<K.length;te++){var se=K[te],pe=se.fileNameStr,fe=b.resolve(se.fileNameStr);j.file(fe,se.decompressed,{binary:!0,optimizedBinaryString:!0,date:se.date,dir:se.dir,comment:se.fileCommentStr.length?se.fileCommentStr:null,unixPermissions:se.unixPermissions,dosPermissions:se.dosPermissions,createFolders:B.createFolders}),se.dir||(j.file(fe).unsafeOriginalName=pe)}return X.zipComment.length&&(j.comment=X.zipComment),j})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(c,m,_){var b=c("../utils"),E=c("../stream/GenericWorker");function T(R,N){E.call(this,"Nodejs stream input adapter for "+R),this._upstreamEnded=!1,this._bindStream(N)}b.inherits(T,E),T.prototype._bindStream=function(R){var N=this;(this._stream=R).pause(),R.on("data",function(z){N.push({data:z,meta:{percent:0}})}).on("error",function(z){N.isPaused?this.generatedError=z:N.error(z)}).on("end",function(){N.isPaused?N._upstreamEnded=!0:N.end()})},T.prototype.pause=function(){return!!E.prototype.pause.call(this)&&(this._stream.pause(),!0)},T.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},m.exports=T},{"../stream/GenericWorker":28,"../utils":32}],13:[function(c,m,_){var b=c("readable-stream").Readable;function E(T,R,N){b.call(this,R),this._helper=T;var z=this;T.on("data",function(G,V){z.push(G)||z._helper.pause(),N&&N(V)}).on("error",function(G){z.emit("error",G)}).on("end",function(){z.push(null)})}c("../utils").inherits(E,b),E.prototype._read=function(){this._helper.resume()},m.exports=E},{"../utils":32,"readable-stream":16}],14:[function(c,m,_){m.exports={isNode:typeof Buffer<"u",newBufferFrom:function(b,E){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(b,E);if(typeof b=="number")throw new Error('The "data" argument must not be a number');return new Buffer(b,E)},allocBuffer:function(b){if(Buffer.alloc)return Buffer.alloc(b);var E=new Buffer(b);return E.fill(0),E},isBuffer:function(b){return Buffer.isBuffer(b)},isStream:function(b){return b&&typeof b.on=="function"&&typeof b.pause=="function"&&typeof b.resume=="function"}}},{}],15:[function(c,m,_){function b(fe,ye,Ne){var ze,Me=T.getTypeOf(ye),je=T.extend(Ne||{},z);je.date=je.date||new Date,je.compression!==null&&(je.compression=je.compression.toUpperCase()),typeof je.unixPermissions=="string"&&(je.unixPermissions=parseInt(je.unixPermissions,8)),je.unixPermissions&&16384&je.unixPermissions&&(je.dir=!0),je.dosPermissions&&16&je.dosPermissions&&(je.dir=!0),je.dir&&(fe=K(fe)),je.createFolders&&(ze=X(fe))&&te.call(this,ze,!0);var yt=Me==="string"&&je.binary===!1&&je.base64===!1;Ne&&Ne.binary!==void 0||(je.binary=!yt),(ye instanceof G&&ye.uncompressedSize===0||je.dir||!ye||ye.length===0)&&(je.base64=!1,je.binary=!0,ye="",je.compression="STORE",Me="string");var xe=null;xe=ye instanceof G||ye instanceof R?ye:j.isNode&&j.isStream(ye)?new H(fe,ye):T.prepareContent(fe,ye,je.binary,je.optimizedBinaryString,je.base64);var We=new V(fe,xe,je);this.files[fe]=We}var E=c("./utf8"),T=c("./utils"),R=c("./stream/GenericWorker"),N=c("./stream/StreamHelper"),z=c("./defaults"),G=c("./compressedObject"),V=c("./zipObject"),B=c("./generate"),j=c("./nodejsUtils"),H=c("./nodejs/NodejsStreamInputAdapter"),X=function(fe){fe.slice(-1)==="/"&&(fe=fe.substring(0,fe.length-1));var ye=fe.lastIndexOf("/");return 0<ye?fe.substring(0,ye):""},K=function(fe){return fe.slice(-1)!=="/"&&(fe+="/"),fe},te=function(fe,ye){return ye=ye!==void 0?ye:z.createFolders,fe=K(fe),this.files[fe]||b.call(this,fe,null,{dir:!0,createFolders:ye}),this.files[fe]};function se(fe){return Object.prototype.toString.call(fe)==="[object RegExp]"}var pe={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(fe){var ye,Ne,ze;for(ye in this.files)ze=this.files[ye],(Ne=ye.slice(this.root.length,ye.length))&&ye.slice(0,this.root.length)===this.root&&fe(Ne,ze)},filter:function(fe){var ye=[];return this.forEach(function(Ne,ze){fe(Ne,ze)&&ye.push(ze)}),ye},file:function(fe,ye,Ne){if(arguments.length!==1)return fe=this.root+fe,b.call(this,fe,ye,Ne),this;if(se(fe)){var ze=fe;return this.filter(function(je,yt){return!yt.dir&&ze.test(je)})}var Me=this.files[this.root+fe];return Me&&!Me.dir?Me:null},folder:function(fe){if(!fe)return this;if(se(fe))return this.filter(function(Me,je){return je.dir&&fe.test(Me)});var ye=this.root+fe,Ne=te.call(this,ye),ze=this.clone();return ze.root=Ne.name,ze},remove:function(fe){fe=this.root+fe;var ye=this.files[fe];if(ye||(fe.slice(-1)!=="/"&&(fe+="/"),ye=this.files[fe]),ye&&!ye.dir)delete this.files[fe];else for(var Ne=this.filter(function(Me,je){return je.name.slice(0,fe.length)===fe}),ze=0;ze<Ne.length;ze++)delete this.files[Ne[ze].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(fe){var ye,Ne={};try{if((Ne=T.extend(fe||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:E.utf8encode})).type=Ne.type.toLowerCase(),Ne.compression=Ne.compression.toUpperCase(),Ne.type==="binarystring"&&(Ne.type="string"),!Ne.type)throw new Error("No output type specified.");T.checkSupport(Ne.type),Ne.platform!=="darwin"&&Ne.platform!=="freebsd"&&Ne.platform!=="linux"&&Ne.platform!=="sunos"||(Ne.platform="UNIX"),Ne.platform==="win32"&&(Ne.platform="DOS");var ze=Ne.comment||this.comment||"";ye=B.generateWorker(this,Ne,ze)}catch(Me){(ye=new R("error")).error(Me)}return new N(ye,Ne.type||"string",Ne.mimeType)},generateAsync:function(fe,ye){return this.generateInternalStream(fe).accumulate(ye)},generateNodeStream:function(fe,ye){return(fe=fe||{}).type||(fe.type="nodebuffer"),this.generateInternalStream(fe).toNodejsStream(ye)}};m.exports=pe},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(c,m,_){m.exports=c("stream")},{stream:void 0}],17:[function(c,m,_){var b=c("./DataReader");function E(T){b.call(this,T);for(var R=0;R<this.data.length;R++)T[R]=255&T[R]}c("../utils").inherits(E,b),E.prototype.byteAt=function(T){return this.data[this.zero+T]},E.prototype.lastIndexOfSignature=function(T){for(var R=T.charCodeAt(0),N=T.charCodeAt(1),z=T.charCodeAt(2),G=T.charCodeAt(3),V=this.length-4;0<=V;--V)if(this.data[V]===R&&this.data[V+1]===N&&this.data[V+2]===z&&this.data[V+3]===G)return V-this.zero;return-1},E.prototype.readAndCheckSignature=function(T){var R=T.charCodeAt(0),N=T.charCodeAt(1),z=T.charCodeAt(2),G=T.charCodeAt(3),V=this.readData(4);return R===V[0]&&N===V[1]&&z===V[2]&&G===V[3]},E.prototype.readData=function(T){if(this.checkOffset(T),T===0)return[];var R=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,R},m.exports=E},{"../utils":32,"./DataReader":18}],18:[function(c,m,_){var b=c("../utils");function E(T){this.data=T,this.length=T.length,this.index=0,this.zero=0}E.prototype={checkOffset:function(T){this.checkIndex(this.index+T)},checkIndex:function(T){if(this.length<this.zero+T||T<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+T+"). Corrupted zip ?")},setIndex:function(T){this.checkIndex(T),this.index=T},skip:function(T){this.setIndex(this.index+T)},byteAt:function(){},readInt:function(T){var R,N=0;for(this.checkOffset(T),R=this.index+T-1;R>=this.index;R--)N=(N<<8)+this.byteAt(R);return this.index+=T,N},readString:function(T){return b.transformTo("string",this.readData(T))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var T=this.readInt(4);return new Date(Date.UTC(1980+(T>>25&127),(T>>21&15)-1,T>>16&31,T>>11&31,T>>5&63,(31&T)<<1))}},m.exports=E},{"../utils":32}],19:[function(c,m,_){var b=c("./Uint8ArrayReader");function E(T){b.call(this,T)}c("../utils").inherits(E,b),E.prototype.readData=function(T){this.checkOffset(T);var R=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,R},m.exports=E},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(c,m,_){var b=c("./DataReader");function E(T){b.call(this,T)}c("../utils").inherits(E,b),E.prototype.byteAt=function(T){return this.data.charCodeAt(this.zero+T)},E.prototype.lastIndexOfSignature=function(T){return this.data.lastIndexOf(T)-this.zero},E.prototype.readAndCheckSignature=function(T){return T===this.readData(4)},E.prototype.readData=function(T){this.checkOffset(T);var R=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,R},m.exports=E},{"../utils":32,"./DataReader":18}],21:[function(c,m,_){var b=c("./ArrayReader");function E(T){b.call(this,T)}c("../utils").inherits(E,b),E.prototype.readData=function(T){if(this.checkOffset(T),T===0)return new Uint8Array(0);var R=this.data.subarray(this.zero+this.index,this.zero+this.index+T);return this.index+=T,R},m.exports=E},{"../utils":32,"./ArrayReader":17}],22:[function(c,m,_){var b=c("../utils"),E=c("../support"),T=c("./ArrayReader"),R=c("./StringReader"),N=c("./NodeBufferReader"),z=c("./Uint8ArrayReader");m.exports=function(G){var V=b.getTypeOf(G);return b.checkSupport(V),V!=="string"||E.uint8array?V==="nodebuffer"?new N(G):E.uint8array?new z(b.transformTo("uint8array",G)):new T(b.transformTo("array",G)):new R(G)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(c,m,_){_.LOCAL_FILE_HEADER="PK",_.CENTRAL_FILE_HEADER="PK",_.CENTRAL_DIRECTORY_END="PK",_.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",_.ZIP64_CENTRAL_DIRECTORY_END="PK",_.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(c,m,_){var b=c("./GenericWorker"),E=c("../utils");function T(R){b.call(this,"ConvertWorker to "+R),this.destType=R}E.inherits(T,b),T.prototype.processChunk=function(R){this.push({data:E.transformTo(this.destType,R.data),meta:R.meta})},m.exports=T},{"../utils":32,"./GenericWorker":28}],25:[function(c,m,_){var b=c("./GenericWorker"),E=c("../crc32");function T(){b.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}c("../utils").inherits(T,b),T.prototype.processChunk=function(R){this.streamInfo.crc32=E(R.data,this.streamInfo.crc32||0),this.push(R)},m.exports=T},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(c,m,_){var b=c("../utils"),E=c("./GenericWorker");function T(R){E.call(this,"DataLengthProbe for "+R),this.propName=R,this.withStreamInfo(R,0)}b.inherits(T,E),T.prototype.processChunk=function(R){if(R){var N=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=N+R.data.length}E.prototype.processChunk.call(this,R)},m.exports=T},{"../utils":32,"./GenericWorker":28}],27:[function(c,m,_){var b=c("../utils"),E=c("./GenericWorker");function T(R){E.call(this,"DataWorker");var N=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,R.then(function(z){N.dataIsReady=!0,N.data=z,N.max=z&&z.length||0,N.type=b.getTypeOf(z),N.isPaused||N._tickAndRepeat()},function(z){N.error(z)})}b.inherits(T,E),T.prototype.cleanUp=function(){E.prototype.cleanUp.call(this),this.data=null},T.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,b.delay(this._tickAndRepeat,[],this)),!0)},T.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(b.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},T.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var R=null,N=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":R=this.data.substring(this.index,N);break;case"uint8array":R=this.data.subarray(this.index,N);break;case"array":case"nodebuffer":R=this.data.slice(this.index,N)}return this.index=N,this.push({data:R,meta:{percent:this.max?this.index/this.max*100:0}})},m.exports=T},{"../utils":32,"./GenericWorker":28}],28:[function(c,m,_){function b(E){this.name=E||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}b.prototype={push:function(E){this.emit("data",E)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(E){this.emit("error",E)}return!0},error:function(E){return!this.isFinished&&(this.isPaused?this.generatedError=E:(this.isFinished=!0,this.emit("error",E),this.previous&&this.previous.error(E),this.cleanUp()),!0)},on:function(E,T){return this._listeners[E].push(T),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(E,T){if(this._listeners[E])for(var R=0;R<this._listeners[E].length;R++)this._listeners[E][R].call(this,T)},pipe:function(E){return E.registerPrevious(this)},registerPrevious:function(E){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=E.streamInfo,this.mergeStreamInfo(),this.previous=E;var T=this;return E.on("data",function(R){T.processChunk(R)}),E.on("end",function(){T.end()}),E.on("error",function(R){T.error(R)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var E=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),E=!0),this.previous&&this.previous.resume(),!E},flush:function(){},processChunk:function(E){this.push(E)},withStreamInfo:function(E,T){return this.extraStreamInfo[E]=T,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var E in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,E)&&(this.streamInfo[E]=this.extraStreamInfo[E])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var E="Worker "+this.name;return this.previous?this.previous+" -> "+E:E}},m.exports=b},{}],29:[function(c,m,_){var b=c("../utils"),E=c("./ConvertWorker"),T=c("./GenericWorker"),R=c("../base64"),N=c("../support"),z=c("../external"),G=null;if(N.nodestream)try{G=c("../nodejs/NodejsStreamOutputAdapter")}catch{}function V(j,H){return new z.Promise(function(X,K){var te=[],se=j._internalType,pe=j._outputType,fe=j._mimeType;j.on("data",function(ye,Ne){te.push(ye),H&&H(Ne)}).on("error",function(ye){te=[],K(ye)}).on("end",function(){try{var ye=function(Ne,ze,Me){switch(Ne){case"blob":return b.newBlob(b.transformTo("arraybuffer",ze),Me);case"base64":return R.encode(ze);default:return b.transformTo(Ne,ze)}}(pe,function(Ne,ze){var Me,je=0,yt=null,xe=0;for(Me=0;Me<ze.length;Me++)xe+=ze[Me].length;switch(Ne){case"string":return ze.join("");case"array":return Array.prototype.concat.apply([],ze);case"uint8array":for(yt=new Uint8Array(xe),Me=0;Me<ze.length;Me++)yt.set(ze[Me],je),je+=ze[Me].length;return yt;case"nodebuffer":return Buffer.concat(ze);default:throw new Error("concat : unsupported type '"+Ne+"'")}}(se,te),fe);X(ye)}catch(Ne){K(Ne)}te=[]}).resume()})}function B(j,H,X){var K=H;switch(H){case"blob":case"arraybuffer":K="uint8array";break;case"base64":K="string"}try{this._internalType=K,this._outputType=H,this._mimeType=X,b.checkSupport(K),this._worker=j.pipe(new E(K)),j.lock()}catch(te){this._worker=new T("error"),this._worker.error(te)}}B.prototype={accumulate:function(j){return V(this,j)},on:function(j,H){var X=this;return j==="data"?this._worker.on(j,function(K){H.call(X,K.data,K.meta)}):this._worker.on(j,function(){b.delay(H,arguments,X)}),this},resume:function(){return b.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(j){if(b.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new G(this,{objectMode:this._outputType!=="nodebuffer"},j)}},m.exports=B},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(c,m,_){if(_.base64=!0,_.array=!0,_.string=!0,_.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",_.nodebuffer=typeof Buffer<"u",_.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")_.blob=!1;else{var b=new ArrayBuffer(0);try{_.blob=new Blob([b],{type:"application/zip"}).size===0}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);E.append(b),_.blob=E.getBlob("application/zip").size===0}catch{_.blob=!1}}}try{_.nodestream=!!c("readable-stream").Readable}catch{_.nodestream=!1}},{"readable-stream":16}],31:[function(c,m,_){for(var b=c("./utils"),E=c("./support"),T=c("./nodejsUtils"),R=c("./stream/GenericWorker"),N=new Array(256),z=0;z<256;z++)N[z]=252<=z?6:248<=z?5:240<=z?4:224<=z?3:192<=z?2:1;N[254]=N[254]=1;function G(){R.call(this,"utf-8 decode"),this.leftOver=null}function V(){R.call(this,"utf-8 encode")}_.utf8encode=function(B){return E.nodebuffer?T.newBufferFrom(B,"utf-8"):function(j){var H,X,K,te,se,pe=j.length,fe=0;for(te=0;te<pe;te++)(64512&(X=j.charCodeAt(te)))==55296&&te+1<pe&&(64512&(K=j.charCodeAt(te+1)))==56320&&(X=65536+(X-55296<<10)+(K-56320),te++),fe+=X<128?1:X<2048?2:X<65536?3:4;for(H=E.uint8array?new Uint8Array(fe):new Array(fe),te=se=0;se<fe;te++)(64512&(X=j.charCodeAt(te)))==55296&&te+1<pe&&(64512&(K=j.charCodeAt(te+1)))==56320&&(X=65536+(X-55296<<10)+(K-56320),te++),X<128?H[se++]=X:(X<2048?H[se++]=192|X>>>6:(X<65536?H[se++]=224|X>>>12:(H[se++]=240|X>>>18,H[se++]=128|X>>>12&63),H[se++]=128|X>>>6&63),H[se++]=128|63&X);return H}(B)},_.utf8decode=function(B){return E.nodebuffer?b.transformTo("nodebuffer",B).toString("utf-8"):function(j){var H,X,K,te,se=j.length,pe=new Array(2*se);for(H=X=0;H<se;)if((K=j[H++])<128)pe[X++]=K;else if(4<(te=N[K]))pe[X++]=65533,H+=te-1;else{for(K&=te===2?31:te===3?15:7;1<te&&H<se;)K=K<<6|63&j[H++],te--;1<te?pe[X++]=65533:K<65536?pe[X++]=K:(K-=65536,pe[X++]=55296|K>>10&1023,pe[X++]=56320|1023&K)}return pe.length!==X&&(pe.subarray?pe=pe.subarray(0,X):pe.length=X),b.applyFromCharCode(pe)}(B=b.transformTo(E.uint8array?"uint8array":"array",B))},b.inherits(G,R),G.prototype.processChunk=function(B){var j=b.transformTo(E.uint8array?"uint8array":"array",B.data);if(this.leftOver&&this.leftOver.length){if(E.uint8array){var H=j;(j=new Uint8Array(H.length+this.leftOver.length)).set(this.leftOver,0),j.set(H,this.leftOver.length)}else j=this.leftOver.concat(j);this.leftOver=null}var X=function(te,se){var pe;for((se=se||te.length)>te.length&&(se=te.length),pe=se-1;0<=pe&&(192&te[pe])==128;)pe--;return pe<0||pe===0?se:pe+N[te[pe]]>se?pe:se}(j),K=j;X!==j.length&&(E.uint8array?(K=j.subarray(0,X),this.leftOver=j.subarray(X,j.length)):(K=j.slice(0,X),this.leftOver=j.slice(X,j.length))),this.push({data:_.utf8decode(K),meta:B.meta})},G.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:_.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},_.Utf8DecodeWorker=G,b.inherits(V,R),V.prototype.processChunk=function(B){this.push({data:_.utf8encode(B.data),meta:B.meta})},_.Utf8EncodeWorker=V},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(c,m,_){var b=c("./support"),E=c("./base64"),T=c("./nodejsUtils"),R=c("./external");function N(H){return H}function z(H,X){for(var K=0;K<H.length;++K)X[K]=255&H.charCodeAt(K);return X}c("setimmediate"),_.newBlob=function(H,X){_.checkSupport("blob");try{return new Blob([H],{type:X})}catch{try{var K=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return K.append(H),K.getBlob(X)}catch{throw new Error("Bug : can't construct the Blob.")}}};var G={stringifyByChunk:function(H,X,K){var te=[],se=0,pe=H.length;if(pe<=K)return String.fromCharCode.apply(null,H);for(;se<pe;)X==="array"||X==="nodebuffer"?te.push(String.fromCharCode.apply(null,H.slice(se,Math.min(se+K,pe)))):te.push(String.fromCharCode.apply(null,H.subarray(se,Math.min(se+K,pe)))),se+=K;return te.join("")},stringifyByChar:function(H){for(var X="",K=0;K<H.length;K++)X+=String.fromCharCode(H[K]);return X},applyCanBeUsed:{uint8array:function(){try{return b.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return b.nodebuffer&&String.fromCharCode.apply(null,T.allocBuffer(1)).length===1}catch{return!1}}()}};function V(H){var X=65536,K=_.getTypeOf(H),te=!0;if(K==="uint8array"?te=G.applyCanBeUsed.uint8array:K==="nodebuffer"&&(te=G.applyCanBeUsed.nodebuffer),te)for(;1<X;)try{return G.stringifyByChunk(H,K,X)}catch{X=Math.floor(X/2)}return G.stringifyByChar(H)}function B(H,X){for(var K=0;K<H.length;K++)X[K]=H[K];return X}_.applyFromCharCode=V;var j={};j.string={string:N,array:function(H){return z(H,new Array(H.length))},arraybuffer:function(H){return j.string.uint8array(H).buffer},uint8array:function(H){return z(H,new Uint8Array(H.length))},nodebuffer:function(H){return z(H,T.allocBuffer(H.length))}},j.array={string:V,array:N,arraybuffer:function(H){return new Uint8Array(H).buffer},uint8array:function(H){return new Uint8Array(H)},nodebuffer:function(H){return T.newBufferFrom(H)}},j.arraybuffer={string:function(H){return V(new Uint8Array(H))},array:function(H){return B(new Uint8Array(H),new Array(H.byteLength))},arraybuffer:N,uint8array:function(H){return new Uint8Array(H)},nodebuffer:function(H){return T.newBufferFrom(new Uint8Array(H))}},j.uint8array={string:V,array:function(H){return B(H,new Array(H.length))},arraybuffer:function(H){return H.buffer},uint8array:N,nodebuffer:function(H){return T.newBufferFrom(H)}},j.nodebuffer={string:V,array:function(H){return B(H,new Array(H.length))},arraybuffer:function(H){return j.nodebuffer.uint8array(H).buffer},uint8array:function(H){return B(H,new Uint8Array(H.length))},nodebuffer:N},_.transformTo=function(H,X){if(X=X||"",!H)return X;_.checkSupport(H);var K=_.getTypeOf(X);return j[K][H](X)},_.resolve=function(H){for(var X=H.split("/"),K=[],te=0;te<X.length;te++){var se=X[te];se==="."||se===""&&te!==0&&te!==X.length-1||(se===".."?K.pop():K.push(se))}return K.join("/")},_.getTypeOf=function(H){return typeof H=="string"?"string":Object.prototype.toString.call(H)==="[object Array]"?"array":b.nodebuffer&&T.isBuffer(H)?"nodebuffer":b.uint8array&&H instanceof Uint8Array?"uint8array":b.arraybuffer&&H instanceof ArrayBuffer?"arraybuffer":void 0},_.checkSupport=function(H){if(!b[H.toLowerCase()])throw new Error(H+" is not supported by this platform")},_.MAX_VALUE_16BITS=65535,_.MAX_VALUE_32BITS=-1,_.pretty=function(H){var X,K,te="";for(K=0;K<(H||"").length;K++)te+="\\x"+((X=H.charCodeAt(K))<16?"0":"")+X.toString(16).toUpperCase();return te},_.delay=function(H,X,K){setImmediate(function(){H.apply(K||null,X||[])})},_.inherits=function(H,X){function K(){}K.prototype=X.prototype,H.prototype=new K},_.extend=function(){var H,X,K={};for(H=0;H<arguments.length;H++)for(X in arguments[H])Object.prototype.hasOwnProperty.call(arguments[H],X)&&K[X]===void 0&&(K[X]=arguments[H][X]);return K},_.prepareContent=function(H,X,K,te,se){return R.Promise.resolve(X).then(function(pe){return b.blob&&(pe instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(pe))!==-1)&&typeof FileReader<"u"?new R.Promise(function(fe,ye){var Ne=new FileReader;Ne.onload=function(ze){fe(ze.target.result)},Ne.onerror=function(ze){ye(ze.target.error)},Ne.readAsArrayBuffer(pe)}):pe}).then(function(pe){var fe=_.getTypeOf(pe);return fe?(fe==="arraybuffer"?pe=_.transformTo("uint8array",pe):fe==="string"&&(se?pe=E.decode(pe):K&&te!==!0&&(pe=function(ye){return z(ye,b.uint8array?new Uint8Array(ye.length):new Array(ye.length))}(pe))),pe):R.Promise.reject(new Error("Can't read the data of '"+H+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(c,m,_){var b=c("./reader/readerFor"),E=c("./utils"),T=c("./signature"),R=c("./zipEntry"),N=c("./support");function z(G){this.files=[],this.loadOptions=G}z.prototype={checkSignature:function(G){if(!this.reader.readAndCheckSignature(G)){this.reader.index-=4;var V=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+E.pretty(V)+", expected "+E.pretty(G)+")")}},isSignature:function(G,V){var B=this.reader.index;this.reader.setIndex(G);var j=this.reader.readString(4)===V;return this.reader.setIndex(B),j},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var G=this.reader.readData(this.zipCommentLength),V=N.uint8array?"uint8array":"array",B=E.transformTo(V,G);this.zipComment=this.loadOptions.decodeFileName(B)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var G,V,B,j=this.zip64EndOfCentralSize-44;0<j;)G=this.reader.readInt(2),V=this.reader.readInt(4),B=this.reader.readData(V),this.zip64ExtensibleData[G]={id:G,length:V,value:B}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var G,V;for(G=0;G<this.files.length;G++)V=this.files[G],this.reader.setIndex(V.localHeaderOffset),this.checkSignature(T.LOCAL_FILE_HEADER),V.readLocalPart(this.reader),V.handleUTF8(),V.processAttributes()},readCentralDir:function(){var G;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(T.CENTRAL_FILE_HEADER);)(G=new R({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(G);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var G=this.reader.lastIndexOfSignature(T.CENTRAL_DIRECTORY_END);if(G<0)throw this.isSignature(0,T.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(G);var V=G;if(this.checkSignature(T.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===E.MAX_VALUE_16BITS||this.diskWithCentralDirStart===E.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===E.MAX_VALUE_16BITS||this.centralDirRecords===E.MAX_VALUE_16BITS||this.centralDirSize===E.MAX_VALUE_32BITS||this.centralDirOffset===E.MAX_VALUE_32BITS){if(this.zip64=!0,(G=this.reader.lastIndexOfSignature(T.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(G),this.checkSignature(T.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,T.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(T.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(T.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var B=this.centralDirOffset+this.centralDirSize;this.zip64&&(B+=20,B+=12+this.zip64EndOfCentralSize);var j=V-B;if(0<j)this.isSignature(V,T.CENTRAL_FILE_HEADER)||(this.reader.zero=j);else if(j<0)throw new Error("Corrupted zip: missing "+Math.abs(j)+" bytes.")},prepareReader:function(G){this.reader=b(G)},load:function(G){this.prepareReader(G),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},m.exports=z},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(c,m,_){var b=c("./reader/readerFor"),E=c("./utils"),T=c("./compressedObject"),R=c("./crc32"),N=c("./utf8"),z=c("./compressions"),G=c("./support");function V(B,j){this.options=B,this.loadOptions=j}V.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(B){var j,H;if(B.skip(22),this.fileNameLength=B.readInt(2),H=B.readInt(2),this.fileName=B.readData(this.fileNameLength),B.skip(H),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((j=function(X){for(var K in z)if(Object.prototype.hasOwnProperty.call(z,K)&&z[K].magic===X)return z[K];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+E.pretty(this.compressionMethod)+" unknown (inner file : "+E.transformTo("string",this.fileName)+")");this.decompressed=new T(this.compressedSize,this.uncompressedSize,this.crc32,j,B.readData(this.compressedSize))},readCentralPart:function(B){this.versionMadeBy=B.readInt(2),B.skip(2),this.bitFlag=B.readInt(2),this.compressionMethod=B.readString(2),this.date=B.readDate(),this.crc32=B.readInt(4),this.compressedSize=B.readInt(4),this.uncompressedSize=B.readInt(4);var j=B.readInt(2);if(this.extraFieldsLength=B.readInt(2),this.fileCommentLength=B.readInt(2),this.diskNumberStart=B.readInt(2),this.internalFileAttributes=B.readInt(2),this.externalFileAttributes=B.readInt(4),this.localHeaderOffset=B.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");B.skip(j),this.readExtraFields(B),this.parseZIP64ExtraField(B),this.fileComment=B.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var B=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),B==0&&(this.dosPermissions=63&this.externalFileAttributes),B==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var B=b(this.extraFields[1].value);this.uncompressedSize===E.MAX_VALUE_32BITS&&(this.uncompressedSize=B.readInt(8)),this.compressedSize===E.MAX_VALUE_32BITS&&(this.compressedSize=B.readInt(8)),this.localHeaderOffset===E.MAX_VALUE_32BITS&&(this.localHeaderOffset=B.readInt(8)),this.diskNumberStart===E.MAX_VALUE_32BITS&&(this.diskNumberStart=B.readInt(4))}},readExtraFields:function(B){var j,H,X,K=B.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});B.index+4<K;)j=B.readInt(2),H=B.readInt(2),X=B.readData(H),this.extraFields[j]={id:j,length:H,value:X};B.setIndex(K)},handleUTF8:function(){var B=G.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=N.utf8decode(this.fileName),this.fileCommentStr=N.utf8decode(this.fileComment);else{var j=this.findExtraFieldUnicodePath();if(j!==null)this.fileNameStr=j;else{var H=E.transformTo(B,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(H)}var X=this.findExtraFieldUnicodeComment();if(X!==null)this.fileCommentStr=X;else{var K=E.transformTo(B,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(K)}}},findExtraFieldUnicodePath:function(){var B=this.extraFields[28789];if(B){var j=b(B.value);return j.readInt(1)!==1||R(this.fileName)!==j.readInt(4)?null:N.utf8decode(j.readData(B.length-5))}return null},findExtraFieldUnicodeComment:function(){var B=this.extraFields[25461];if(B){var j=b(B.value);return j.readInt(1)!==1||R(this.fileComment)!==j.readInt(4)?null:N.utf8decode(j.readData(B.length-5))}return null}},m.exports=V},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(c,m,_){function b(j,H,X){this.name=j,this.dir=X.dir,this.date=X.date,this.comment=X.comment,this.unixPermissions=X.unixPermissions,this.dosPermissions=X.dosPermissions,this._data=H,this._dataBinary=X.binary,this.options={compression:X.compression,compressionOptions:X.compressionOptions}}var E=c("./stream/StreamHelper"),T=c("./stream/DataWorker"),R=c("./utf8"),N=c("./compressedObject"),z=c("./stream/GenericWorker");b.prototype={internalStream:function(j){var H=null,X="string";try{if(!j)throw new Error("No output type specified.");var K=(X=j.toLowerCase())==="string"||X==="text";X!=="binarystring"&&X!=="text"||(X="string"),H=this._decompressWorker();var te=!this._dataBinary;te&&!K&&(H=H.pipe(new R.Utf8EncodeWorker)),!te&&K&&(H=H.pipe(new R.Utf8DecodeWorker))}catch(se){(H=new z("error")).error(se)}return new E(H,X,"")},async:function(j,H){return this.internalStream(j).accumulate(H)},nodeStream:function(j,H){return this.internalStream(j||"nodebuffer").toNodejsStream(H)},_compressWorker:function(j,H){if(this._data instanceof N&&this._data.compression.magic===j.magic)return this._data.getCompressedWorker();var X=this._decompressWorker();return this._dataBinary||(X=X.pipe(new R.Utf8EncodeWorker)),N.createWorkerFrom(X,j,H)},_decompressWorker:function(){return this._data instanceof N?this._data.getContentWorker():this._data instanceof z?this._data:new T(this._data)}};for(var G=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],V=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},B=0;B<G.length;B++)b.prototype[G[B]]=V;m.exports=b},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(c,m,_){(function(b){var E,T,R=b.MutationObserver||b.WebKitMutationObserver;if(R){var N=0,z=new R(j),G=b.document.createTextNode("");z.observe(G,{characterData:!0}),E=function(){G.data=N=++N%2}}else if(b.setImmediate||b.MessageChannel===void 0)E="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var H=b.document.createElement("script");H.onreadystatechange=function(){j(),H.onreadystatechange=null,H.parentNode.removeChild(H),H=null},b.document.documentElement.appendChild(H)}:function(){setTimeout(j,0)};else{var V=new b.MessageChannel;V.port1.onmessage=j,E=function(){V.port2.postMessage(0)}}var B=[];function j(){var H,X;T=!0;for(var K=B.length;K;){for(X=B,B=[],H=-1;++H<K;)X[H]();K=B.length}T=!1}m.exports=function(H){B.push(H)!==1||T||E()}}).call(this,typeof xa<"u"?xa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(c,m,_){var b=c("immediate");function E(){}var T={},R=["REJECTED"],N=["FULFILLED"],z=["PENDING"];function G(K){if(typeof K!="function")throw new TypeError("resolver must be a function");this.state=z,this.queue=[],this.outcome=void 0,K!==E&&H(this,K)}function V(K,te,se){this.promise=K,typeof te=="function"&&(this.onFulfilled=te,this.callFulfilled=this.otherCallFulfilled),typeof se=="function"&&(this.onRejected=se,this.callRejected=this.otherCallRejected)}function B(K,te,se){b(function(){var pe;try{pe=te(se)}catch(fe){return T.reject(K,fe)}pe===K?T.reject(K,new TypeError("Cannot resolve promise with itself")):T.resolve(K,pe)})}function j(K){var te=K&&K.then;if(K&&(typeof K=="object"||typeof K=="function")&&typeof te=="function")return function(){te.apply(K,arguments)}}function H(K,te){var se=!1;function pe(Ne){se||(se=!0,T.reject(K,Ne))}function fe(Ne){se||(se=!0,T.resolve(K,Ne))}var ye=X(function(){te(fe,pe)});ye.status==="error"&&pe(ye.value)}function X(K,te){var se={};try{se.value=K(te),se.status="success"}catch(pe){se.status="error",se.value=pe}return se}(m.exports=G).prototype.finally=function(K){if(typeof K!="function")return this;var te=this.constructor;return this.then(function(se){return te.resolve(K()).then(function(){return se})},function(se){return te.resolve(K()).then(function(){throw se})})},G.prototype.catch=function(K){return this.then(null,K)},G.prototype.then=function(K,te){if(typeof K!="function"&&this.state===N||typeof te!="function"&&this.state===R)return this;var se=new this.constructor(E);return this.state!==z?B(se,this.state===N?K:te,this.outcome):this.queue.push(new V(se,K,te)),se},V.prototype.callFulfilled=function(K){T.resolve(this.promise,K)},V.prototype.otherCallFulfilled=function(K){B(this.promise,this.onFulfilled,K)},V.prototype.callRejected=function(K){T.reject(this.promise,K)},V.prototype.otherCallRejected=function(K){B(this.promise,this.onRejected,K)},T.resolve=function(K,te){var se=X(j,te);if(se.status==="error")return T.reject(K,se.value);var pe=se.value;if(pe)H(K,pe);else{K.state=N,K.outcome=te;for(var fe=-1,ye=K.queue.length;++fe<ye;)K.queue[fe].callFulfilled(te)}return K},T.reject=function(K,te){K.state=R,K.outcome=te;for(var se=-1,pe=K.queue.length;++se<pe;)K.queue[se].callRejected(te);return K},G.resolve=function(K){return K instanceof this?K:T.resolve(new this(E),K)},G.reject=function(K){var te=new this(E);return T.reject(te,K)},G.all=function(K){var te=this;if(Object.prototype.toString.call(K)!=="[object Array]")return this.reject(new TypeError("must be an array"));var se=K.length,pe=!1;if(!se)return this.resolve([]);for(var fe=new Array(se),ye=0,Ne=-1,ze=new this(E);++Ne<se;)Me(K[Ne],Ne);return ze;function Me(je,yt){te.resolve(je).then(function(xe){fe[yt]=xe,++ye!==se||pe||(pe=!0,T.resolve(ze,fe))},function(xe){pe||(pe=!0,T.reject(ze,xe))})}},G.race=function(K){var te=this;if(Object.prototype.toString.call(K)!=="[object Array]")return this.reject(new TypeError("must be an array"));var se=K.length,pe=!1;if(!se)return this.resolve([]);for(var fe=-1,ye=new this(E);++fe<se;)Ne=K[fe],te.resolve(Ne).then(function(ze){pe||(pe=!0,T.resolve(ye,ze))},function(ze){pe||(pe=!0,T.reject(ye,ze))});var Ne;return ye}},{immediate:36}],38:[function(c,m,_){var b={};(0,c("./lib/utils/common").assign)(b,c("./lib/deflate"),c("./lib/inflate"),c("./lib/zlib/constants")),m.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(c,m,_){var b=c("./zlib/deflate"),E=c("./utils/common"),T=c("./utils/strings"),R=c("./zlib/messages"),N=c("./zlib/zstream"),z=Object.prototype.toString,G=0,V=-1,B=0,j=8;function H(K){if(!(this instanceof H))return new H(K);this.options=E.assign({level:V,method:j,chunkSize:16384,windowBits:15,memLevel:8,strategy:B,to:""},K||{});var te=this.options;te.raw&&0<te.windowBits?te.windowBits=-te.windowBits:te.gzip&&0<te.windowBits&&te.windowBits<16&&(te.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var se=b.deflateInit2(this.strm,te.level,te.method,te.windowBits,te.memLevel,te.strategy);if(se!==G)throw new Error(R[se]);if(te.header&&b.deflateSetHeader(this.strm,te.header),te.dictionary){var pe;if(pe=typeof te.dictionary=="string"?T.string2buf(te.dictionary):z.call(te.dictionary)==="[object ArrayBuffer]"?new Uint8Array(te.dictionary):te.dictionary,(se=b.deflateSetDictionary(this.strm,pe))!==G)throw new Error(R[se]);this._dict_set=!0}}function X(K,te){var se=new H(te);if(se.push(K,!0),se.err)throw se.msg||R[se.err];return se.result}H.prototype.push=function(K,te){var se,pe,fe=this.strm,ye=this.options.chunkSize;if(this.ended)return!1;pe=te===~~te?te:te===!0?4:0,typeof K=="string"?fe.input=T.string2buf(K):z.call(K)==="[object ArrayBuffer]"?fe.input=new Uint8Array(K):fe.input=K,fe.next_in=0,fe.avail_in=fe.input.length;do{if(fe.avail_out===0&&(fe.output=new E.Buf8(ye),fe.next_out=0,fe.avail_out=ye),(se=b.deflate(fe,pe))!==1&&se!==G)return this.onEnd(se),!(this.ended=!0);fe.avail_out!==0&&(fe.avail_in!==0||pe!==4&&pe!==2)||(this.options.to==="string"?this.onData(T.buf2binstring(E.shrinkBuf(fe.output,fe.next_out))):this.onData(E.shrinkBuf(fe.output,fe.next_out)))}while((0<fe.avail_in||fe.avail_out===0)&&se!==1);return pe===4?(se=b.deflateEnd(this.strm),this.onEnd(se),this.ended=!0,se===G):pe!==2||(this.onEnd(G),!(fe.avail_out=0))},H.prototype.onData=function(K){this.chunks.push(K)},H.prototype.onEnd=function(K){K===G&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=K,this.msg=this.strm.msg},_.Deflate=H,_.deflate=X,_.deflateRaw=function(K,te){return(te=te||{}).raw=!0,X(K,te)},_.gzip=function(K,te){return(te=te||{}).gzip=!0,X(K,te)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(c,m,_){var b=c("./zlib/inflate"),E=c("./utils/common"),T=c("./utils/strings"),R=c("./zlib/constants"),N=c("./zlib/messages"),z=c("./zlib/zstream"),G=c("./zlib/gzheader"),V=Object.prototype.toString;function B(H){if(!(this instanceof B))return new B(H);this.options=E.assign({chunkSize:16384,windowBits:0,to:""},H||{});var X=this.options;X.raw&&0<=X.windowBits&&X.windowBits<16&&(X.windowBits=-X.windowBits,X.windowBits===0&&(X.windowBits=-15)),!(0<=X.windowBits&&X.windowBits<16)||H&&H.windowBits||(X.windowBits+=32),15<X.windowBits&&X.windowBits<48&&!(15&X.windowBits)&&(X.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new z,this.strm.avail_out=0;var K=b.inflateInit2(this.strm,X.windowBits);if(K!==R.Z_OK)throw new Error(N[K]);this.header=new G,b.inflateGetHeader(this.strm,this.header)}function j(H,X){var K=new B(X);if(K.push(H,!0),K.err)throw K.msg||N[K.err];return K.result}B.prototype.push=function(H,X){var K,te,se,pe,fe,ye,Ne=this.strm,ze=this.options.chunkSize,Me=this.options.dictionary,je=!1;if(this.ended)return!1;te=X===~~X?X:X===!0?R.Z_FINISH:R.Z_NO_FLUSH,typeof H=="string"?Ne.input=T.binstring2buf(H):V.call(H)==="[object ArrayBuffer]"?Ne.input=new Uint8Array(H):Ne.input=H,Ne.next_in=0,Ne.avail_in=Ne.input.length;do{if(Ne.avail_out===0&&(Ne.output=new E.Buf8(ze),Ne.next_out=0,Ne.avail_out=ze),(K=b.inflate(Ne,R.Z_NO_FLUSH))===R.Z_NEED_DICT&&Me&&(ye=typeof Me=="string"?T.string2buf(Me):V.call(Me)==="[object ArrayBuffer]"?new Uint8Array(Me):Me,K=b.inflateSetDictionary(this.strm,ye)),K===R.Z_BUF_ERROR&&je===!0&&(K=R.Z_OK,je=!1),K!==R.Z_STREAM_END&&K!==R.Z_OK)return this.onEnd(K),!(this.ended=!0);Ne.next_out&&(Ne.avail_out!==0&&K!==R.Z_STREAM_END&&(Ne.avail_in!==0||te!==R.Z_FINISH&&te!==R.Z_SYNC_FLUSH)||(this.options.to==="string"?(se=T.utf8border(Ne.output,Ne.next_out),pe=Ne.next_out-se,fe=T.buf2string(Ne.output,se),Ne.next_out=pe,Ne.avail_out=ze-pe,pe&&E.arraySet(Ne.output,Ne.output,se,pe,0),this.onData(fe)):this.onData(E.shrinkBuf(Ne.output,Ne.next_out)))),Ne.avail_in===0&&Ne.avail_out===0&&(je=!0)}while((0<Ne.avail_in||Ne.avail_out===0)&&K!==R.Z_STREAM_END);return K===R.Z_STREAM_END&&(te=R.Z_FINISH),te===R.Z_FINISH?(K=b.inflateEnd(this.strm),this.onEnd(K),this.ended=!0,K===R.Z_OK):te!==R.Z_SYNC_FLUSH||(this.onEnd(R.Z_OK),!(Ne.avail_out=0))},B.prototype.onData=function(H){this.chunks.push(H)},B.prototype.onEnd=function(H){H===R.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=H,this.msg=this.strm.msg},_.Inflate=B,_.inflate=j,_.inflateRaw=function(H,X){return(X=X||{}).raw=!0,j(H,X)},_.ungzip=j},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(c,m,_){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";_.assign=function(R){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var z=N.shift();if(z){if(typeof z!="object")throw new TypeError(z+"must be non-object");for(var G in z)z.hasOwnProperty(G)&&(R[G]=z[G])}}return R},_.shrinkBuf=function(R,N){return R.length===N?R:R.subarray?R.subarray(0,N):(R.length=N,R)};var E={arraySet:function(R,N,z,G,V){if(N.subarray&&R.subarray)R.set(N.subarray(z,z+G),V);else for(var B=0;B<G;B++)R[V+B]=N[z+B]},flattenChunks:function(R){var N,z,G,V,B,j;for(N=G=0,z=R.length;N<z;N++)G+=R[N].length;for(j=new Uint8Array(G),N=V=0,z=R.length;N<z;N++)B=R[N],j.set(B,V),V+=B.length;return j}},T={arraySet:function(R,N,z,G,V){for(var B=0;B<G;B++)R[V+B]=N[z+B]},flattenChunks:function(R){return[].concat.apply([],R)}};_.setTyped=function(R){R?(_.Buf8=Uint8Array,_.Buf16=Uint16Array,_.Buf32=Int32Array,_.assign(_,E)):(_.Buf8=Array,_.Buf16=Array,_.Buf32=Array,_.assign(_,T))},_.setTyped(b)},{}],42:[function(c,m,_){var b=c("./common"),E=!0,T=!0;try{String.fromCharCode.apply(null,[0])}catch{E=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{T=!1}for(var R=new b.Buf8(256),N=0;N<256;N++)R[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function z(G,V){if(V<65537&&(G.subarray&&T||!G.subarray&&E))return String.fromCharCode.apply(null,b.shrinkBuf(G,V));for(var B="",j=0;j<V;j++)B+=String.fromCharCode(G[j]);return B}R[254]=R[254]=1,_.string2buf=function(G){var V,B,j,H,X,K=G.length,te=0;for(H=0;H<K;H++)(64512&(B=G.charCodeAt(H)))==55296&&H+1<K&&(64512&(j=G.charCodeAt(H+1)))==56320&&(B=65536+(B-55296<<10)+(j-56320),H++),te+=B<128?1:B<2048?2:B<65536?3:4;for(V=new b.Buf8(te),H=X=0;X<te;H++)(64512&(B=G.charCodeAt(H)))==55296&&H+1<K&&(64512&(j=G.charCodeAt(H+1)))==56320&&(B=65536+(B-55296<<10)+(j-56320),H++),B<128?V[X++]=B:(B<2048?V[X++]=192|B>>>6:(B<65536?V[X++]=224|B>>>12:(V[X++]=240|B>>>18,V[X++]=128|B>>>12&63),V[X++]=128|B>>>6&63),V[X++]=128|63&B);return V},_.buf2binstring=function(G){return z(G,G.length)},_.binstring2buf=function(G){for(var V=new b.Buf8(G.length),B=0,j=V.length;B<j;B++)V[B]=G.charCodeAt(B);return V},_.buf2string=function(G,V){var B,j,H,X,K=V||G.length,te=new Array(2*K);for(B=j=0;B<K;)if((H=G[B++])<128)te[j++]=H;else if(4<(X=R[H]))te[j++]=65533,B+=X-1;else{for(H&=X===2?31:X===3?15:7;1<X&&B<K;)H=H<<6|63&G[B++],X--;1<X?te[j++]=65533:H<65536?te[j++]=H:(H-=65536,te[j++]=55296|H>>10&1023,te[j++]=56320|1023&H)}return z(te,j)},_.utf8border=function(G,V){var B;for((V=V||G.length)>G.length&&(V=G.length),B=V-1;0<=B&&(192&G[B])==128;)B--;return B<0||B===0?V:B+R[G[B]]>V?B:V}},{"./common":41}],43:[function(c,m,_){m.exports=function(b,E,T,R){for(var N=65535&b|0,z=b>>>16&65535|0,G=0;T!==0;){for(T-=G=2e3<T?2e3:T;z=z+(N=N+E[R++]|0)|0,--G;);N%=65521,z%=65521}return N|z<<16|0}},{}],44:[function(c,m,_){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(c,m,_){var b=function(){for(var E,T=[],R=0;R<256;R++){E=R;for(var N=0;N<8;N++)E=1&E?3988292384^E>>>1:E>>>1;T[R]=E}return T}();m.exports=function(E,T,R,N){var z=b,G=N+R;E^=-1;for(var V=N;V<G;V++)E=E>>>8^z[255&(E^T[V])];return-1^E}},{}],46:[function(c,m,_){var b,E=c("../utils/common"),T=c("./trees"),R=c("./adler32"),N=c("./crc32"),z=c("./messages"),G=0,V=4,B=0,j=-2,H=-1,X=4,K=2,te=8,se=9,pe=286,fe=30,ye=19,Ne=2*pe+1,ze=15,Me=3,je=258,yt=je+Me+1,xe=42,We=113,ae=1,nt=2,dn=3,Ve=4;function Ue(he,Lt){return he.msg=z[Lt],Lt}function at(he){return(he<<1)-(4<he?9:0)}function Wt(he){for(var Lt=he.length;0<=--Lt;)he[Lt]=0}function be(he){var Lt=he.state,kt=Lt.pending;kt>he.avail_out&&(kt=he.avail_out),kt!==0&&(E.arraySet(he.output,Lt.pending_buf,Lt.pending_out,kt,he.next_out),he.next_out+=kt,Lt.pending_out+=kt,he.total_out+=kt,he.avail_out-=kt,Lt.pending-=kt,Lt.pending===0&&(Lt.pending_out=0))}function Ce(he,Lt){T._tr_flush_block(he,0<=he.block_start?he.block_start:-1,he.strstart-he.block_start,Lt),he.block_start=he.strstart,be(he.strm)}function St(he,Lt){he.pending_buf[he.pending++]=Lt}function Mt(he,Lt){he.pending_buf[he.pending++]=Lt>>>8&255,he.pending_buf[he.pending++]=255&Lt}function It(he,Lt){var kt,Ie,Re=he.max_chain_length,ct=he.strstart,Xt=he.prev_length,rn=he.nice_match,wt=he.strstart>he.w_size-yt?he.strstart-(he.w_size-yt):0,fn=he.window,tn=he.w_mask,sn=he.prev,xr=he.strstart+je,zi=fn[ct+Xt-1],Hr=fn[ct+Xt];he.prev_length>=he.good_match&&(Re>>=2),rn>he.lookahead&&(rn=he.lookahead);do if(fn[(kt=Lt)+Xt]===Hr&&fn[kt+Xt-1]===zi&&fn[kt]===fn[ct]&&fn[++kt]===fn[ct+1]){ct+=2,kt++;do;while(fn[++ct]===fn[++kt]&&fn[++ct]===fn[++kt]&&fn[++ct]===fn[++kt]&&fn[++ct]===fn[++kt]&&fn[++ct]===fn[++kt]&&fn[++ct]===fn[++kt]&&fn[++ct]===fn[++kt]&&fn[++ct]===fn[++kt]&&ct<xr);if(Ie=je-(xr-ct),ct=xr-je,Xt<Ie){if(he.match_start=Lt,rn<=(Xt=Ie))break;zi=fn[ct+Xt-1],Hr=fn[ct+Xt]}}while((Lt=sn[Lt&tn])>wt&&--Re!=0);return Xt<=he.lookahead?Xt:he.lookahead}function ut(he){var Lt,kt,Ie,Re,ct,Xt,rn,wt,fn,tn,sn=he.w_size;do{if(Re=he.window_size-he.lookahead-he.strstart,he.strstart>=sn+(sn-yt)){for(E.arraySet(he.window,he.window,sn,sn,0),he.match_start-=sn,he.strstart-=sn,he.block_start-=sn,Lt=kt=he.hash_size;Ie=he.head[--Lt],he.head[Lt]=sn<=Ie?Ie-sn:0,--kt;);for(Lt=kt=sn;Ie=he.prev[--Lt],he.prev[Lt]=sn<=Ie?Ie-sn:0,--kt;);Re+=sn}if(he.strm.avail_in===0)break;if(Xt=he.strm,rn=he.window,wt=he.strstart+he.lookahead,fn=Re,tn=void 0,tn=Xt.avail_in,fn<tn&&(tn=fn),kt=tn===0?0:(Xt.avail_in-=tn,E.arraySet(rn,Xt.input,Xt.next_in,tn,wt),Xt.state.wrap===1?Xt.adler=R(Xt.adler,rn,tn,wt):Xt.state.wrap===2&&(Xt.adler=N(Xt.adler,rn,tn,wt)),Xt.next_in+=tn,Xt.total_in+=tn,tn),he.lookahead+=kt,he.lookahead+he.insert>=Me)for(ct=he.strstart-he.insert,he.ins_h=he.window[ct],he.ins_h=(he.ins_h<<he.hash_shift^he.window[ct+1])&he.hash_mask;he.insert&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[ct+Me-1])&he.hash_mask,he.prev[ct&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=ct,ct++,he.insert--,!(he.lookahead+he.insert<Me)););}while(he.lookahead<yt&&he.strm.avail_in!==0)}function Gn(he,Lt){for(var kt,Ie;;){if(he.lookahead<yt){if(ut(he),he.lookahead<yt&&Lt===G)return ae;if(he.lookahead===0)break}if(kt=0,he.lookahead>=Me&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,kt=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart),kt!==0&&he.strstart-kt<=he.w_size-yt&&(he.match_length=It(he,kt)),he.match_length>=Me)if(Ie=T._tr_tally(he,he.strstart-he.match_start,he.match_length-Me),he.lookahead-=he.match_length,he.match_length<=he.max_lazy_match&&he.lookahead>=Me){for(he.match_length--;he.strstart++,he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,kt=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart,--he.match_length!=0;);he.strstart++}else he.strstart+=he.match_length,he.match_length=0,he.ins_h=he.window[he.strstart],he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+1])&he.hash_mask;else Ie=T._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++;if(Ie&&(Ce(he,!1),he.strm.avail_out===0))return ae}return he.insert=he.strstart<Me-1?he.strstart:Me-1,Lt===V?(Ce(he,!0),he.strm.avail_out===0?dn:Ve):he.last_lit&&(Ce(he,!1),he.strm.avail_out===0)?ae:nt}function Vt(he,Lt){for(var kt,Ie,Re;;){if(he.lookahead<yt){if(ut(he),he.lookahead<yt&&Lt===G)return ae;if(he.lookahead===0)break}if(kt=0,he.lookahead>=Me&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,kt=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart),he.prev_length=he.match_length,he.prev_match=he.match_start,he.match_length=Me-1,kt!==0&&he.prev_length<he.max_lazy_match&&he.strstart-kt<=he.w_size-yt&&(he.match_length=It(he,kt),he.match_length<=5&&(he.strategy===1||he.match_length===Me&&4096<he.strstart-he.match_start)&&(he.match_length=Me-1)),he.prev_length>=Me&&he.match_length<=he.prev_length){for(Re=he.strstart+he.lookahead-Me,Ie=T._tr_tally(he,he.strstart-1-he.prev_match,he.prev_length-Me),he.lookahead-=he.prev_length-1,he.prev_length-=2;++he.strstart<=Re&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,kt=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart),--he.prev_length!=0;);if(he.match_available=0,he.match_length=Me-1,he.strstart++,Ie&&(Ce(he,!1),he.strm.avail_out===0))return ae}else if(he.match_available){if((Ie=T._tr_tally(he,0,he.window[he.strstart-1]))&&Ce(he,!1),he.strstart++,he.lookahead--,he.strm.avail_out===0)return ae}else he.match_available=1,he.strstart++,he.lookahead--}return he.match_available&&(Ie=T._tr_tally(he,0,he.window[he.strstart-1]),he.match_available=0),he.insert=he.strstart<Me-1?he.strstart:Me-1,Lt===V?(Ce(he,!0),he.strm.avail_out===0?dn:Ve):he.last_lit&&(Ce(he,!1),he.strm.avail_out===0)?ae:nt}function Nn(he,Lt,kt,Ie,Re){this.good_length=he,this.max_lazy=Lt,this.nice_length=kt,this.max_chain=Ie,this.func=Re}function hr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=te,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*Ne),this.dyn_dtree=new E.Buf16(2*(2*fe+1)),this.bl_tree=new E.Buf16(2*(2*ye+1)),Wt(this.dyn_ltree),Wt(this.dyn_dtree),Wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(ze+1),this.heap=new E.Buf16(2*pe+1),Wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*pe+1),Wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Rr(he){var Lt;return he&&he.state?(he.total_in=he.total_out=0,he.data_type=K,(Lt=he.state).pending=0,Lt.pending_out=0,Lt.wrap<0&&(Lt.wrap=-Lt.wrap),Lt.status=Lt.wrap?xe:We,he.adler=Lt.wrap===2?0:1,Lt.last_flush=G,T._tr_init(Lt),B):Ue(he,j)}function Tr(he){var Lt=Rr(he);return Lt===B&&function(kt){kt.window_size=2*kt.w_size,Wt(kt.head),kt.max_lazy_match=b[kt.level].max_lazy,kt.good_match=b[kt.level].good_length,kt.nice_match=b[kt.level].nice_length,kt.max_chain_length=b[kt.level].max_chain,kt.strstart=0,kt.block_start=0,kt.lookahead=0,kt.insert=0,kt.match_length=kt.prev_length=Me-1,kt.match_available=0,kt.ins_h=0}(he.state),Lt}function Wi(he,Lt,kt,Ie,Re,ct){if(!he)return j;var Xt=1;if(Lt===H&&(Lt=6),Ie<0?(Xt=0,Ie=-Ie):15<Ie&&(Xt=2,Ie-=16),Re<1||se<Re||kt!==te||Ie<8||15<Ie||Lt<0||9<Lt||ct<0||X<ct)return Ue(he,j);Ie===8&&(Ie=9);var rn=new hr;return(he.state=rn).strm=he,rn.wrap=Xt,rn.gzhead=null,rn.w_bits=Ie,rn.w_size=1<<rn.w_bits,rn.w_mask=rn.w_size-1,rn.hash_bits=Re+7,rn.hash_size=1<<rn.hash_bits,rn.hash_mask=rn.hash_size-1,rn.hash_shift=~~((rn.hash_bits+Me-1)/Me),rn.window=new E.Buf8(2*rn.w_size),rn.head=new E.Buf16(rn.hash_size),rn.prev=new E.Buf16(rn.w_size),rn.lit_bufsize=1<<Re+6,rn.pending_buf_size=4*rn.lit_bufsize,rn.pending_buf=new E.Buf8(rn.pending_buf_size),rn.d_buf=1*rn.lit_bufsize,rn.l_buf=3*rn.lit_bufsize,rn.level=Lt,rn.strategy=ct,rn.method=kt,Tr(he)}b=[new Nn(0,0,0,0,function(he,Lt){var kt=65535;for(kt>he.pending_buf_size-5&&(kt=he.pending_buf_size-5);;){if(he.lookahead<=1){if(ut(he),he.lookahead===0&&Lt===G)return ae;if(he.lookahead===0)break}he.strstart+=he.lookahead,he.lookahead=0;var Ie=he.block_start+kt;if((he.strstart===0||he.strstart>=Ie)&&(he.lookahead=he.strstart-Ie,he.strstart=Ie,Ce(he,!1),he.strm.avail_out===0)||he.strstart-he.block_start>=he.w_size-yt&&(Ce(he,!1),he.strm.avail_out===0))return ae}return he.insert=0,Lt===V?(Ce(he,!0),he.strm.avail_out===0?dn:Ve):(he.strstart>he.block_start&&(Ce(he,!1),he.strm.avail_out),ae)}),new Nn(4,4,8,4,Gn),new Nn(4,5,16,8,Gn),new Nn(4,6,32,32,Gn),new Nn(4,4,16,16,Vt),new Nn(8,16,32,32,Vt),new Nn(8,16,128,128,Vt),new Nn(8,32,128,256,Vt),new Nn(32,128,258,1024,Vt),new Nn(32,258,258,4096,Vt)],_.deflateInit=function(he,Lt){return Wi(he,Lt,te,15,8,0)},_.deflateInit2=Wi,_.deflateReset=Tr,_.deflateResetKeep=Rr,_.deflateSetHeader=function(he,Lt){return he&&he.state?he.state.wrap!==2?j:(he.state.gzhead=Lt,B):j},_.deflate=function(he,Lt){var kt,Ie,Re,ct;if(!he||!he.state||5<Lt||Lt<0)return he?Ue(he,j):j;if(Ie=he.state,!he.output||!he.input&&he.avail_in!==0||Ie.status===666&&Lt!==V)return Ue(he,he.avail_out===0?-5:j);if(Ie.strm=he,kt=Ie.last_flush,Ie.last_flush=Lt,Ie.status===xe)if(Ie.wrap===2)he.adler=0,St(Ie,31),St(Ie,139),St(Ie,8),Ie.gzhead?(St(Ie,(Ie.gzhead.text?1:0)+(Ie.gzhead.hcrc?2:0)+(Ie.gzhead.extra?4:0)+(Ie.gzhead.name?8:0)+(Ie.gzhead.comment?16:0)),St(Ie,255&Ie.gzhead.time),St(Ie,Ie.gzhead.time>>8&255),St(Ie,Ie.gzhead.time>>16&255),St(Ie,Ie.gzhead.time>>24&255),St(Ie,Ie.level===9?2:2<=Ie.strategy||Ie.level<2?4:0),St(Ie,255&Ie.gzhead.os),Ie.gzhead.extra&&Ie.gzhead.extra.length&&(St(Ie,255&Ie.gzhead.extra.length),St(Ie,Ie.gzhead.extra.length>>8&255)),Ie.gzhead.hcrc&&(he.adler=N(he.adler,Ie.pending_buf,Ie.pending,0)),Ie.gzindex=0,Ie.status=69):(St(Ie,0),St(Ie,0),St(Ie,0),St(Ie,0),St(Ie,0),St(Ie,Ie.level===9?2:2<=Ie.strategy||Ie.level<2?4:0),St(Ie,3),Ie.status=We);else{var Xt=te+(Ie.w_bits-8<<4)<<8;Xt|=(2<=Ie.strategy||Ie.level<2?0:Ie.level<6?1:Ie.level===6?2:3)<<6,Ie.strstart!==0&&(Xt|=32),Xt+=31-Xt%31,Ie.status=We,Mt(Ie,Xt),Ie.strstart!==0&&(Mt(Ie,he.adler>>>16),Mt(Ie,65535&he.adler)),he.adler=1}if(Ie.status===69)if(Ie.gzhead.extra){for(Re=Ie.pending;Ie.gzindex<(65535&Ie.gzhead.extra.length)&&(Ie.pending!==Ie.pending_buf_size||(Ie.gzhead.hcrc&&Ie.pending>Re&&(he.adler=N(he.adler,Ie.pending_buf,Ie.pending-Re,Re)),be(he),Re=Ie.pending,Ie.pending!==Ie.pending_buf_size));)St(Ie,255&Ie.gzhead.extra[Ie.gzindex]),Ie.gzindex++;Ie.gzhead.hcrc&&Ie.pending>Re&&(he.adler=N(he.adler,Ie.pending_buf,Ie.pending-Re,Re)),Ie.gzindex===Ie.gzhead.extra.length&&(Ie.gzindex=0,Ie.status=73)}else Ie.status=73;if(Ie.status===73)if(Ie.gzhead.name){Re=Ie.pending;do{if(Ie.pending===Ie.pending_buf_size&&(Ie.gzhead.hcrc&&Ie.pending>Re&&(he.adler=N(he.adler,Ie.pending_buf,Ie.pending-Re,Re)),be(he),Re=Ie.pending,Ie.pending===Ie.pending_buf_size)){ct=1;break}ct=Ie.gzindex<Ie.gzhead.name.length?255&Ie.gzhead.name.charCodeAt(Ie.gzindex++):0,St(Ie,ct)}while(ct!==0);Ie.gzhead.hcrc&&Ie.pending>Re&&(he.adler=N(he.adler,Ie.pending_buf,Ie.pending-Re,Re)),ct===0&&(Ie.gzindex=0,Ie.status=91)}else Ie.status=91;if(Ie.status===91)if(Ie.gzhead.comment){Re=Ie.pending;do{if(Ie.pending===Ie.pending_buf_size&&(Ie.gzhead.hcrc&&Ie.pending>Re&&(he.adler=N(he.adler,Ie.pending_buf,Ie.pending-Re,Re)),be(he),Re=Ie.pending,Ie.pending===Ie.pending_buf_size)){ct=1;break}ct=Ie.gzindex<Ie.gzhead.comment.length?255&Ie.gzhead.comment.charCodeAt(Ie.gzindex++):0,St(Ie,ct)}while(ct!==0);Ie.gzhead.hcrc&&Ie.pending>Re&&(he.adler=N(he.adler,Ie.pending_buf,Ie.pending-Re,Re)),ct===0&&(Ie.status=103)}else Ie.status=103;if(Ie.status===103&&(Ie.gzhead.hcrc?(Ie.pending+2>Ie.pending_buf_size&&be(he),Ie.pending+2<=Ie.pending_buf_size&&(St(Ie,255&he.adler),St(Ie,he.adler>>8&255),he.adler=0,Ie.status=We)):Ie.status=We),Ie.pending!==0){if(be(he),he.avail_out===0)return Ie.last_flush=-1,B}else if(he.avail_in===0&&at(Lt)<=at(kt)&&Lt!==V)return Ue(he,-5);if(Ie.status===666&&he.avail_in!==0)return Ue(he,-5);if(he.avail_in!==0||Ie.lookahead!==0||Lt!==G&&Ie.status!==666){var rn=Ie.strategy===2?function(wt,fn){for(var tn;;){if(wt.lookahead===0&&(ut(wt),wt.lookahead===0)){if(fn===G)return ae;break}if(wt.match_length=0,tn=T._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++,tn&&(Ce(wt,!1),wt.strm.avail_out===0))return ae}return wt.insert=0,fn===V?(Ce(wt,!0),wt.strm.avail_out===0?dn:Ve):wt.last_lit&&(Ce(wt,!1),wt.strm.avail_out===0)?ae:nt}(Ie,Lt):Ie.strategy===3?function(wt,fn){for(var tn,sn,xr,zi,Hr=wt.window;;){if(wt.lookahead<=je){if(ut(wt),wt.lookahead<=je&&fn===G)return ae;if(wt.lookahead===0)break}if(wt.match_length=0,wt.lookahead>=Me&&0<wt.strstart&&(sn=Hr[xr=wt.strstart-1])===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]){zi=wt.strstart+je;do;while(sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&xr<zi);wt.match_length=je-(zi-xr),wt.match_length>wt.lookahead&&(wt.match_length=wt.lookahead)}if(wt.match_length>=Me?(tn=T._tr_tally(wt,1,wt.match_length-Me),wt.lookahead-=wt.match_length,wt.strstart+=wt.match_length,wt.match_length=0):(tn=T._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++),tn&&(Ce(wt,!1),wt.strm.avail_out===0))return ae}return wt.insert=0,fn===V?(Ce(wt,!0),wt.strm.avail_out===0?dn:Ve):wt.last_lit&&(Ce(wt,!1),wt.strm.avail_out===0)?ae:nt}(Ie,Lt):b[Ie.level].func(Ie,Lt);if(rn!==dn&&rn!==Ve||(Ie.status=666),rn===ae||rn===dn)return he.avail_out===0&&(Ie.last_flush=-1),B;if(rn===nt&&(Lt===1?T._tr_align(Ie):Lt!==5&&(T._tr_stored_block(Ie,0,0,!1),Lt===3&&(Wt(Ie.head),Ie.lookahead===0&&(Ie.strstart=0,Ie.block_start=0,Ie.insert=0))),be(he),he.avail_out===0))return Ie.last_flush=-1,B}return Lt!==V?B:Ie.wrap<=0?1:(Ie.wrap===2?(St(Ie,255&he.adler),St(Ie,he.adler>>8&255),St(Ie,he.adler>>16&255),St(Ie,he.adler>>24&255),St(Ie,255&he.total_in),St(Ie,he.total_in>>8&255),St(Ie,he.total_in>>16&255),St(Ie,he.total_in>>24&255)):(Mt(Ie,he.adler>>>16),Mt(Ie,65535&he.adler)),be(he),0<Ie.wrap&&(Ie.wrap=-Ie.wrap),Ie.pending!==0?B:1)},_.deflateEnd=function(he){var Lt;return he&&he.state?(Lt=he.state.status)!==xe&&Lt!==69&&Lt!==73&&Lt!==91&&Lt!==103&&Lt!==We&&Lt!==666?Ue(he,j):(he.state=null,Lt===We?Ue(he,-3):B):j},_.deflateSetDictionary=function(he,Lt){var kt,Ie,Re,ct,Xt,rn,wt,fn,tn=Lt.length;if(!he||!he.state||(ct=(kt=he.state).wrap)===2||ct===1&&kt.status!==xe||kt.lookahead)return j;for(ct===1&&(he.adler=R(he.adler,Lt,tn,0)),kt.wrap=0,tn>=kt.w_size&&(ct===0&&(Wt(kt.head),kt.strstart=0,kt.block_start=0,kt.insert=0),fn=new E.Buf8(kt.w_size),E.arraySet(fn,Lt,tn-kt.w_size,kt.w_size,0),Lt=fn,tn=kt.w_size),Xt=he.avail_in,rn=he.next_in,wt=he.input,he.avail_in=tn,he.next_in=0,he.input=Lt,ut(kt);kt.lookahead>=Me;){for(Ie=kt.strstart,Re=kt.lookahead-(Me-1);kt.ins_h=(kt.ins_h<<kt.hash_shift^kt.window[Ie+Me-1])&kt.hash_mask,kt.prev[Ie&kt.w_mask]=kt.head[kt.ins_h],kt.head[kt.ins_h]=Ie,Ie++,--Re;);kt.strstart=Ie,kt.lookahead=Me-1,ut(kt)}return kt.strstart+=kt.lookahead,kt.block_start=kt.strstart,kt.insert=kt.lookahead,kt.lookahead=0,kt.match_length=kt.prev_length=Me-1,kt.match_available=0,he.next_in=rn,he.input=wt,he.avail_in=Xt,kt.wrap=ct,B},_.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(c,m,_){m.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(c,m,_){m.exports=function(b,E){var T,R,N,z,G,V,B,j,H,X,K,te,se,pe,fe,ye,Ne,ze,Me,je,yt,xe,We,ae,nt;T=b.state,R=b.next_in,ae=b.input,N=R+(b.avail_in-5),z=b.next_out,nt=b.output,G=z-(E-b.avail_out),V=z+(b.avail_out-257),B=T.dmax,j=T.wsize,H=T.whave,X=T.wnext,K=T.window,te=T.hold,se=T.bits,pe=T.lencode,fe=T.distcode,ye=(1<<T.lenbits)-1,Ne=(1<<T.distbits)-1;e:do{se<15&&(te+=ae[R++]<<se,se+=8,te+=ae[R++]<<se,se+=8),ze=pe[te&ye];t:for(;;){if(te>>>=Me=ze>>>24,se-=Me,(Me=ze>>>16&255)===0)nt[z++]=65535&ze;else{if(!(16&Me)){if(!(64&Me)){ze=pe[(65535&ze)+(te&(1<<Me)-1)];continue t}if(32&Me){T.mode=12;break e}b.msg="invalid literal/length code",T.mode=30;break e}je=65535&ze,(Me&=15)&&(se<Me&&(te+=ae[R++]<<se,se+=8),je+=te&(1<<Me)-1,te>>>=Me,se-=Me),se<15&&(te+=ae[R++]<<se,se+=8,te+=ae[R++]<<se,se+=8),ze=fe[te&Ne];n:for(;;){if(te>>>=Me=ze>>>24,se-=Me,!(16&(Me=ze>>>16&255))){if(!(64&Me)){ze=fe[(65535&ze)+(te&(1<<Me)-1)];continue n}b.msg="invalid distance code",T.mode=30;break e}if(yt=65535&ze,se<(Me&=15)&&(te+=ae[R++]<<se,(se+=8)<Me&&(te+=ae[R++]<<se,se+=8)),B<(yt+=te&(1<<Me)-1)){b.msg="invalid distance too far back",T.mode=30;break e}if(te>>>=Me,se-=Me,(Me=z-G)<yt){if(H<(Me=yt-Me)&&T.sane){b.msg="invalid distance too far back",T.mode=30;break e}if(We=K,(xe=0)===X){if(xe+=j-Me,Me<je){for(je-=Me;nt[z++]=K[xe++],--Me;);xe=z-yt,We=nt}}else if(X<Me){if(xe+=j+X-Me,(Me-=X)<je){for(je-=Me;nt[z++]=K[xe++],--Me;);if(xe=0,X<je){for(je-=Me=X;nt[z++]=K[xe++],--Me;);xe=z-yt,We=nt}}}else if(xe+=X-Me,Me<je){for(je-=Me;nt[z++]=K[xe++],--Me;);xe=z-yt,We=nt}for(;2<je;)nt[z++]=We[xe++],nt[z++]=We[xe++],nt[z++]=We[xe++],je-=3;je&&(nt[z++]=We[xe++],1<je&&(nt[z++]=We[xe++]))}else{for(xe=z-yt;nt[z++]=nt[xe++],nt[z++]=nt[xe++],nt[z++]=nt[xe++],2<(je-=3););je&&(nt[z++]=nt[xe++],1<je&&(nt[z++]=nt[xe++]))}break}}break}}while(R<N&&z<V);R-=je=se>>3,te&=(1<<(se-=je<<3))-1,b.next_in=R,b.next_out=z,b.avail_in=R<N?N-R+5:5-(R-N),b.avail_out=z<V?V-z+257:257-(z-V),T.hold=te,T.bits=se}},{}],49:[function(c,m,_){var b=c("../utils/common"),E=c("./adler32"),T=c("./crc32"),R=c("./inffast"),N=c("./inftrees"),z=1,G=2,V=0,B=-2,j=1,H=852,X=592;function K(xe){return(xe>>>24&255)+(xe>>>8&65280)+((65280&xe)<<8)+((255&xe)<<24)}function te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(xe){var We;return xe&&xe.state?(We=xe.state,xe.total_in=xe.total_out=We.total=0,xe.msg="",We.wrap&&(xe.adler=1&We.wrap),We.mode=j,We.last=0,We.havedict=0,We.dmax=32768,We.head=null,We.hold=0,We.bits=0,We.lencode=We.lendyn=new b.Buf32(H),We.distcode=We.distdyn=new b.Buf32(X),We.sane=1,We.back=-1,V):B}function pe(xe){var We;return xe&&xe.state?((We=xe.state).wsize=0,We.whave=0,We.wnext=0,se(xe)):B}function fe(xe,We){var ae,nt;return xe&&xe.state?(nt=xe.state,We<0?(ae=0,We=-We):(ae=1+(We>>4),We<48&&(We&=15)),We&&(We<8||15<We)?B:(nt.window!==null&&nt.wbits!==We&&(nt.window=null),nt.wrap=ae,nt.wbits=We,pe(xe))):B}function ye(xe,We){var ae,nt;return xe?(nt=new te,(xe.state=nt).window=null,(ae=fe(xe,We))!==V&&(xe.state=null),ae):B}var Ne,ze,Me=!0;function je(xe){if(Me){var We;for(Ne=new b.Buf32(512),ze=new b.Buf32(32),We=0;We<144;)xe.lens[We++]=8;for(;We<256;)xe.lens[We++]=9;for(;We<280;)xe.lens[We++]=7;for(;We<288;)xe.lens[We++]=8;for(N(z,xe.lens,0,288,Ne,0,xe.work,{bits:9}),We=0;We<32;)xe.lens[We++]=5;N(G,xe.lens,0,32,ze,0,xe.work,{bits:5}),Me=!1}xe.lencode=Ne,xe.lenbits=9,xe.distcode=ze,xe.distbits=5}function yt(xe,We,ae,nt){var dn,Ve=xe.state;return Ve.window===null&&(Ve.wsize=1<<Ve.wbits,Ve.wnext=0,Ve.whave=0,Ve.window=new b.Buf8(Ve.wsize)),nt>=Ve.wsize?(b.arraySet(Ve.window,We,ae-Ve.wsize,Ve.wsize,0),Ve.wnext=0,Ve.whave=Ve.wsize):(nt<(dn=Ve.wsize-Ve.wnext)&&(dn=nt),b.arraySet(Ve.window,We,ae-nt,dn,Ve.wnext),(nt-=dn)?(b.arraySet(Ve.window,We,ae-nt,nt,0),Ve.wnext=nt,Ve.whave=Ve.wsize):(Ve.wnext+=dn,Ve.wnext===Ve.wsize&&(Ve.wnext=0),Ve.whave<Ve.wsize&&(Ve.whave+=dn))),0}_.inflateReset=pe,_.inflateReset2=fe,_.inflateResetKeep=se,_.inflateInit=function(xe){return ye(xe,15)},_.inflateInit2=ye,_.inflate=function(xe,We){var ae,nt,dn,Ve,Ue,at,Wt,be,Ce,St,Mt,It,ut,Gn,Vt,Nn,hr,Rr,Tr,Wi,he,Lt,kt,Ie,Re=0,ct=new b.Buf8(4),Xt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!xe||!xe.state||!xe.output||!xe.input&&xe.avail_in!==0)return B;(ae=xe.state).mode===12&&(ae.mode=13),Ue=xe.next_out,dn=xe.output,Wt=xe.avail_out,Ve=xe.next_in,nt=xe.input,at=xe.avail_in,be=ae.hold,Ce=ae.bits,St=at,Mt=Wt,Lt=V;e:for(;;)switch(ae.mode){case j:if(ae.wrap===0){ae.mode=13;break}for(;Ce<16;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(2&ae.wrap&&be===35615){ct[ae.check=0]=255&be,ct[1]=be>>>8&255,ae.check=T(ae.check,ct,2,0),Ce=be=0,ae.mode=2;break}if(ae.flags=0,ae.head&&(ae.head.done=!1),!(1&ae.wrap)||(((255&be)<<8)+(be>>8))%31){xe.msg="incorrect header check",ae.mode=30;break}if((15&be)!=8){xe.msg="unknown compression method",ae.mode=30;break}if(Ce-=4,he=8+(15&(be>>>=4)),ae.wbits===0)ae.wbits=he;else if(he>ae.wbits){xe.msg="invalid window size",ae.mode=30;break}ae.dmax=1<<he,xe.adler=ae.check=1,ae.mode=512&be?10:12,Ce=be=0;break;case 2:for(;Ce<16;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(ae.flags=be,(255&ae.flags)!=8){xe.msg="unknown compression method",ae.mode=30;break}if(57344&ae.flags){xe.msg="unknown header flags set",ae.mode=30;break}ae.head&&(ae.head.text=be>>8&1),512&ae.flags&&(ct[0]=255&be,ct[1]=be>>>8&255,ae.check=T(ae.check,ct,2,0)),Ce=be=0,ae.mode=3;case 3:for(;Ce<32;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}ae.head&&(ae.head.time=be),512&ae.flags&&(ct[0]=255&be,ct[1]=be>>>8&255,ct[2]=be>>>16&255,ct[3]=be>>>24&255,ae.check=T(ae.check,ct,4,0)),Ce=be=0,ae.mode=4;case 4:for(;Ce<16;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}ae.head&&(ae.head.xflags=255&be,ae.head.os=be>>8),512&ae.flags&&(ct[0]=255&be,ct[1]=be>>>8&255,ae.check=T(ae.check,ct,2,0)),Ce=be=0,ae.mode=5;case 5:if(1024&ae.flags){for(;Ce<16;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}ae.length=be,ae.head&&(ae.head.extra_len=be),512&ae.flags&&(ct[0]=255&be,ct[1]=be>>>8&255,ae.check=T(ae.check,ct,2,0)),Ce=be=0}else ae.head&&(ae.head.extra=null);ae.mode=6;case 6:if(1024&ae.flags&&(at<(It=ae.length)&&(It=at),It&&(ae.head&&(he=ae.head.extra_len-ae.length,ae.head.extra||(ae.head.extra=new Array(ae.head.extra_len)),b.arraySet(ae.head.extra,nt,Ve,It,he)),512&ae.flags&&(ae.check=T(ae.check,nt,It,Ve)),at-=It,Ve+=It,ae.length-=It),ae.length))break e;ae.length=0,ae.mode=7;case 7:if(2048&ae.flags){if(at===0)break e;for(It=0;he=nt[Ve+It++],ae.head&&he&&ae.length<65536&&(ae.head.name+=String.fromCharCode(he)),he&&It<at;);if(512&ae.flags&&(ae.check=T(ae.check,nt,It,Ve)),at-=It,Ve+=It,he)break e}else ae.head&&(ae.head.name=null);ae.length=0,ae.mode=8;case 8:if(4096&ae.flags){if(at===0)break e;for(It=0;he=nt[Ve+It++],ae.head&&he&&ae.length<65536&&(ae.head.comment+=String.fromCharCode(he)),he&&It<at;);if(512&ae.flags&&(ae.check=T(ae.check,nt,It,Ve)),at-=It,Ve+=It,he)break e}else ae.head&&(ae.head.comment=null);ae.mode=9;case 9:if(512&ae.flags){for(;Ce<16;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(be!==(65535&ae.check)){xe.msg="header crc mismatch",ae.mode=30;break}Ce=be=0}ae.head&&(ae.head.hcrc=ae.flags>>9&1,ae.head.done=!0),xe.adler=ae.check=0,ae.mode=12;break;case 10:for(;Ce<32;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}xe.adler=ae.check=K(be),Ce=be=0,ae.mode=11;case 11:if(ae.havedict===0)return xe.next_out=Ue,xe.avail_out=Wt,xe.next_in=Ve,xe.avail_in=at,ae.hold=be,ae.bits=Ce,2;xe.adler=ae.check=1,ae.mode=12;case 12:if(We===5||We===6)break e;case 13:if(ae.last){be>>>=7&Ce,Ce-=7&Ce,ae.mode=27;break}for(;Ce<3;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}switch(ae.last=1&be,Ce-=1,3&(be>>>=1)){case 0:ae.mode=14;break;case 1:if(je(ae),ae.mode=20,We!==6)break;be>>>=2,Ce-=2;break e;case 2:ae.mode=17;break;case 3:xe.msg="invalid block type",ae.mode=30}be>>>=2,Ce-=2;break;case 14:for(be>>>=7&Ce,Ce-=7&Ce;Ce<32;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if((65535&be)!=(be>>>16^65535)){xe.msg="invalid stored block lengths",ae.mode=30;break}if(ae.length=65535&be,Ce=be=0,ae.mode=15,We===6)break e;case 15:ae.mode=16;case 16:if(It=ae.length){if(at<It&&(It=at),Wt<It&&(It=Wt),It===0)break e;b.arraySet(dn,nt,Ve,It,Ue),at-=It,Ve+=It,Wt-=It,Ue+=It,ae.length-=It;break}ae.mode=12;break;case 17:for(;Ce<14;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(ae.nlen=257+(31&be),be>>>=5,Ce-=5,ae.ndist=1+(31&be),be>>>=5,Ce-=5,ae.ncode=4+(15&be),be>>>=4,Ce-=4,286<ae.nlen||30<ae.ndist){xe.msg="too many length or distance symbols",ae.mode=30;break}ae.have=0,ae.mode=18;case 18:for(;ae.have<ae.ncode;){for(;Ce<3;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}ae.lens[Xt[ae.have++]]=7&be,be>>>=3,Ce-=3}for(;ae.have<19;)ae.lens[Xt[ae.have++]]=0;if(ae.lencode=ae.lendyn,ae.lenbits=7,kt={bits:ae.lenbits},Lt=N(0,ae.lens,0,19,ae.lencode,0,ae.work,kt),ae.lenbits=kt.bits,Lt){xe.msg="invalid code lengths set",ae.mode=30;break}ae.have=0,ae.mode=19;case 19:for(;ae.have<ae.nlen+ae.ndist;){for(;Nn=(Re=ae.lencode[be&(1<<ae.lenbits)-1])>>>16&255,hr=65535&Re,!((Vt=Re>>>24)<=Ce);){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(hr<16)be>>>=Vt,Ce-=Vt,ae.lens[ae.have++]=hr;else{if(hr===16){for(Ie=Vt+2;Ce<Ie;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(be>>>=Vt,Ce-=Vt,ae.have===0){xe.msg="invalid bit length repeat",ae.mode=30;break}he=ae.lens[ae.have-1],It=3+(3&be),be>>>=2,Ce-=2}else if(hr===17){for(Ie=Vt+3;Ce<Ie;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}Ce-=Vt,he=0,It=3+(7&(be>>>=Vt)),be>>>=3,Ce-=3}else{for(Ie=Vt+7;Ce<Ie;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}Ce-=Vt,he=0,It=11+(127&(be>>>=Vt)),be>>>=7,Ce-=7}if(ae.have+It>ae.nlen+ae.ndist){xe.msg="invalid bit length repeat",ae.mode=30;break}for(;It--;)ae.lens[ae.have++]=he}}if(ae.mode===30)break;if(ae.lens[256]===0){xe.msg="invalid code -- missing end-of-block",ae.mode=30;break}if(ae.lenbits=9,kt={bits:ae.lenbits},Lt=N(z,ae.lens,0,ae.nlen,ae.lencode,0,ae.work,kt),ae.lenbits=kt.bits,Lt){xe.msg="invalid literal/lengths set",ae.mode=30;break}if(ae.distbits=6,ae.distcode=ae.distdyn,kt={bits:ae.distbits},Lt=N(G,ae.lens,ae.nlen,ae.ndist,ae.distcode,0,ae.work,kt),ae.distbits=kt.bits,Lt){xe.msg="invalid distances set",ae.mode=30;break}if(ae.mode=20,We===6)break e;case 20:ae.mode=21;case 21:if(6<=at&&258<=Wt){xe.next_out=Ue,xe.avail_out=Wt,xe.next_in=Ve,xe.avail_in=at,ae.hold=be,ae.bits=Ce,R(xe,Mt),Ue=xe.next_out,dn=xe.output,Wt=xe.avail_out,Ve=xe.next_in,nt=xe.input,at=xe.avail_in,be=ae.hold,Ce=ae.bits,ae.mode===12&&(ae.back=-1);break}for(ae.back=0;Nn=(Re=ae.lencode[be&(1<<ae.lenbits)-1])>>>16&255,hr=65535&Re,!((Vt=Re>>>24)<=Ce);){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(Nn&&!(240&Nn)){for(Rr=Vt,Tr=Nn,Wi=hr;Nn=(Re=ae.lencode[Wi+((be&(1<<Rr+Tr)-1)>>Rr)])>>>16&255,hr=65535&Re,!(Rr+(Vt=Re>>>24)<=Ce);){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}be>>>=Rr,Ce-=Rr,ae.back+=Rr}if(be>>>=Vt,Ce-=Vt,ae.back+=Vt,ae.length=hr,Nn===0){ae.mode=26;break}if(32&Nn){ae.back=-1,ae.mode=12;break}if(64&Nn){xe.msg="invalid literal/length code",ae.mode=30;break}ae.extra=15&Nn,ae.mode=22;case 22:if(ae.extra){for(Ie=ae.extra;Ce<Ie;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}ae.length+=be&(1<<ae.extra)-1,be>>>=ae.extra,Ce-=ae.extra,ae.back+=ae.extra}ae.was=ae.length,ae.mode=23;case 23:for(;Nn=(Re=ae.distcode[be&(1<<ae.distbits)-1])>>>16&255,hr=65535&Re,!((Vt=Re>>>24)<=Ce);){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(!(240&Nn)){for(Rr=Vt,Tr=Nn,Wi=hr;Nn=(Re=ae.distcode[Wi+((be&(1<<Rr+Tr)-1)>>Rr)])>>>16&255,hr=65535&Re,!(Rr+(Vt=Re>>>24)<=Ce);){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}be>>>=Rr,Ce-=Rr,ae.back+=Rr}if(be>>>=Vt,Ce-=Vt,ae.back+=Vt,64&Nn){xe.msg="invalid distance code",ae.mode=30;break}ae.offset=hr,ae.extra=15&Nn,ae.mode=24;case 24:if(ae.extra){for(Ie=ae.extra;Ce<Ie;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}ae.offset+=be&(1<<ae.extra)-1,be>>>=ae.extra,Ce-=ae.extra,ae.back+=ae.extra}if(ae.offset>ae.dmax){xe.msg="invalid distance too far back",ae.mode=30;break}ae.mode=25;case 25:if(Wt===0)break e;if(It=Mt-Wt,ae.offset>It){if((It=ae.offset-It)>ae.whave&&ae.sane){xe.msg="invalid distance too far back",ae.mode=30;break}ut=It>ae.wnext?(It-=ae.wnext,ae.wsize-It):ae.wnext-It,It>ae.length&&(It=ae.length),Gn=ae.window}else Gn=dn,ut=Ue-ae.offset,It=ae.length;for(Wt<It&&(It=Wt),Wt-=It,ae.length-=It;dn[Ue++]=Gn[ut++],--It;);ae.length===0&&(ae.mode=21);break;case 26:if(Wt===0)break e;dn[Ue++]=ae.length,Wt--,ae.mode=21;break;case 27:if(ae.wrap){for(;Ce<32;){if(at===0)break e;at--,be|=nt[Ve++]<<Ce,Ce+=8}if(Mt-=Wt,xe.total_out+=Mt,ae.total+=Mt,Mt&&(xe.adler=ae.check=ae.flags?T(ae.check,dn,Mt,Ue-Mt):E(ae.check,dn,Mt,Ue-Mt)),Mt=Wt,(ae.flags?be:K(be))!==ae.check){xe.msg="incorrect data check",ae.mode=30;break}Ce=be=0}ae.mode=28;case 28:if(ae.wrap&&ae.flags){for(;Ce<32;){if(at===0)break e;at--,be+=nt[Ve++]<<Ce,Ce+=8}if(be!==(4294967295&ae.total)){xe.msg="incorrect length check",ae.mode=30;break}Ce=be=0}ae.mode=29;case 29:Lt=1;break e;case 30:Lt=-3;break e;case 31:return-4;case 32:default:return B}return xe.next_out=Ue,xe.avail_out=Wt,xe.next_in=Ve,xe.avail_in=at,ae.hold=be,ae.bits=Ce,(ae.wsize||Mt!==xe.avail_out&&ae.mode<30&&(ae.mode<27||We!==4))&&yt(xe,xe.output,xe.next_out,Mt-xe.avail_out)?(ae.mode=31,-4):(St-=xe.avail_in,Mt-=xe.avail_out,xe.total_in+=St,xe.total_out+=Mt,ae.total+=Mt,ae.wrap&&Mt&&(xe.adler=ae.check=ae.flags?T(ae.check,dn,Mt,xe.next_out-Mt):E(ae.check,dn,Mt,xe.next_out-Mt)),xe.data_type=ae.bits+(ae.last?64:0)+(ae.mode===12?128:0)+(ae.mode===20||ae.mode===15?256:0),(St==0&&Mt===0||We===4)&&Lt===V&&(Lt=-5),Lt)},_.inflateEnd=function(xe){if(!xe||!xe.state)return B;var We=xe.state;return We.window&&(We.window=null),xe.state=null,V},_.inflateGetHeader=function(xe,We){var ae;return xe&&xe.state&&2&(ae=xe.state).wrap?((ae.head=We).done=!1,V):B},_.inflateSetDictionary=function(xe,We){var ae,nt=We.length;return xe&&xe.state?(ae=xe.state).wrap!==0&&ae.mode!==11?B:ae.mode===11&&E(1,We,nt,0)!==ae.check?-3:yt(xe,We,nt,nt)?(ae.mode=31,-4):(ae.havedict=1,V):B},_.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(c,m,_){var b=c("../utils/common"),E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],T=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];m.exports=function(z,G,V,B,j,H,X,K){var te,se,pe,fe,ye,Ne,ze,Me,je,yt=K.bits,xe=0,We=0,ae=0,nt=0,dn=0,Ve=0,Ue=0,at=0,Wt=0,be=0,Ce=null,St=0,Mt=new b.Buf16(16),It=new b.Buf16(16),ut=null,Gn=0;for(xe=0;xe<=15;xe++)Mt[xe]=0;for(We=0;We<B;We++)Mt[G[V+We]]++;for(dn=yt,nt=15;1<=nt&&Mt[nt]===0;nt--);if(nt<dn&&(dn=nt),nt===0)return j[H++]=20971520,j[H++]=20971520,K.bits=1,0;for(ae=1;ae<nt&&Mt[ae]===0;ae++);for(dn<ae&&(dn=ae),xe=at=1;xe<=15;xe++)if(at<<=1,(at-=Mt[xe])<0)return-1;if(0<at&&(z===0||nt!==1))return-1;for(It[1]=0,xe=1;xe<15;xe++)It[xe+1]=It[xe]+Mt[xe];for(We=0;We<B;We++)G[V+We]!==0&&(X[It[G[V+We]]++]=We);if(Ne=z===0?(Ce=ut=X,19):z===1?(Ce=E,St-=257,ut=T,Gn-=257,256):(Ce=R,ut=N,-1),xe=ae,ye=H,Ue=We=be=0,pe=-1,fe=(Wt=1<<(Ve=dn))-1,z===1&&852<Wt||z===2&&592<Wt)return 1;for(;;){for(ze=xe-Ue,je=X[We]<Ne?(Me=0,X[We]):X[We]>Ne?(Me=ut[Gn+X[We]],Ce[St+X[We]]):(Me=96,0),te=1<<xe-Ue,ae=se=1<<Ve;j[ye+(be>>Ue)+(se-=te)]=ze<<24|Me<<16|je|0,se!==0;);for(te=1<<xe-1;be&te;)te>>=1;if(te!==0?(be&=te-1,be+=te):be=0,We++,--Mt[xe]==0){if(xe===nt)break;xe=G[V+X[We]]}if(dn<xe&&(be&fe)!==pe){for(Ue===0&&(Ue=dn),ye+=ae,at=1<<(Ve=xe-Ue);Ve+Ue<nt&&!((at-=Mt[Ve+Ue])<=0);)Ve++,at<<=1;if(Wt+=1<<Ve,z===1&&852<Wt||z===2&&592<Wt)return 1;j[pe=be&fe]=dn<<24|Ve<<16|ye-H|0}}return be!==0&&(j[ye+be]=xe-Ue<<24|64<<16|0),K.bits=dn,0}},{"../utils/common":41}],51:[function(c,m,_){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(c,m,_){var b=c("../utils/common"),E=0,T=1;function R(Re){for(var ct=Re.length;0<=--ct;)Re[ct]=0}var N=0,z=29,G=256,V=G+1+z,B=30,j=19,H=2*V+1,X=15,K=16,te=7,se=256,pe=16,fe=17,ye=18,Ne=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ze=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],je=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],yt=new Array(2*(V+2));R(yt);var xe=new Array(2*B);R(xe);var We=new Array(512);R(We);var ae=new Array(256);R(ae);var nt=new Array(z);R(nt);var dn,Ve,Ue,at=new Array(B);function Wt(Re,ct,Xt,rn,wt){this.static_tree=Re,this.extra_bits=ct,this.extra_base=Xt,this.elems=rn,this.max_length=wt,this.has_stree=Re&&Re.length}function be(Re,ct){this.dyn_tree=Re,this.max_code=0,this.stat_desc=ct}function Ce(Re){return Re<256?We[Re]:We[256+(Re>>>7)]}function St(Re,ct){Re.pending_buf[Re.pending++]=255&ct,Re.pending_buf[Re.pending++]=ct>>>8&255}function Mt(Re,ct,Xt){Re.bi_valid>K-Xt?(Re.bi_buf|=ct<<Re.bi_valid&65535,St(Re,Re.bi_buf),Re.bi_buf=ct>>K-Re.bi_valid,Re.bi_valid+=Xt-K):(Re.bi_buf|=ct<<Re.bi_valid&65535,Re.bi_valid+=Xt)}function It(Re,ct,Xt){Mt(Re,Xt[2*ct],Xt[2*ct+1])}function ut(Re,ct){for(var Xt=0;Xt|=1&Re,Re>>>=1,Xt<<=1,0<--ct;);return Xt>>>1}function Gn(Re,ct,Xt){var rn,wt,fn=new Array(X+1),tn=0;for(rn=1;rn<=X;rn++)fn[rn]=tn=tn+Xt[rn-1]<<1;for(wt=0;wt<=ct;wt++){var sn=Re[2*wt+1];sn!==0&&(Re[2*wt]=ut(fn[sn]++,sn))}}function Vt(Re){var ct;for(ct=0;ct<V;ct++)Re.dyn_ltree[2*ct]=0;for(ct=0;ct<B;ct++)Re.dyn_dtree[2*ct]=0;for(ct=0;ct<j;ct++)Re.bl_tree[2*ct]=0;Re.dyn_ltree[2*se]=1,Re.opt_len=Re.static_len=0,Re.last_lit=Re.matches=0}function Nn(Re){8<Re.bi_valid?St(Re,Re.bi_buf):0<Re.bi_valid&&(Re.pending_buf[Re.pending++]=Re.bi_buf),Re.bi_buf=0,Re.bi_valid=0}function hr(Re,ct,Xt,rn){var wt=2*ct,fn=2*Xt;return Re[wt]<Re[fn]||Re[wt]===Re[fn]&&rn[ct]<=rn[Xt]}function Rr(Re,ct,Xt){for(var rn=Re.heap[Xt],wt=Xt<<1;wt<=Re.heap_len&&(wt<Re.heap_len&&hr(ct,Re.heap[wt+1],Re.heap[wt],Re.depth)&&wt++,!hr(ct,rn,Re.heap[wt],Re.depth));)Re.heap[Xt]=Re.heap[wt],Xt=wt,wt<<=1;Re.heap[Xt]=rn}function Tr(Re,ct,Xt){var rn,wt,fn,tn,sn=0;if(Re.last_lit!==0)for(;rn=Re.pending_buf[Re.d_buf+2*sn]<<8|Re.pending_buf[Re.d_buf+2*sn+1],wt=Re.pending_buf[Re.l_buf+sn],sn++,rn===0?It(Re,wt,ct):(It(Re,(fn=ae[wt])+G+1,ct),(tn=Ne[fn])!==0&&Mt(Re,wt-=nt[fn],tn),It(Re,fn=Ce(--rn),Xt),(tn=ze[fn])!==0&&Mt(Re,rn-=at[fn],tn)),sn<Re.last_lit;);It(Re,se,ct)}function Wi(Re,ct){var Xt,rn,wt,fn=ct.dyn_tree,tn=ct.stat_desc.static_tree,sn=ct.stat_desc.has_stree,xr=ct.stat_desc.elems,zi=-1;for(Re.heap_len=0,Re.heap_max=H,Xt=0;Xt<xr;Xt++)fn[2*Xt]!==0?(Re.heap[++Re.heap_len]=zi=Xt,Re.depth[Xt]=0):fn[2*Xt+1]=0;for(;Re.heap_len<2;)fn[2*(wt=Re.heap[++Re.heap_len]=zi<2?++zi:0)]=1,Re.depth[wt]=0,Re.opt_len--,sn&&(Re.static_len-=tn[2*wt+1]);for(ct.max_code=zi,Xt=Re.heap_len>>1;1<=Xt;Xt--)Rr(Re,fn,Xt);for(wt=xr;Xt=Re.heap[1],Re.heap[1]=Re.heap[Re.heap_len--],Rr(Re,fn,1),rn=Re.heap[1],Re.heap[--Re.heap_max]=Xt,Re.heap[--Re.heap_max]=rn,fn[2*wt]=fn[2*Xt]+fn[2*rn],Re.depth[wt]=(Re.depth[Xt]>=Re.depth[rn]?Re.depth[Xt]:Re.depth[rn])+1,fn[2*Xt+1]=fn[2*rn+1]=wt,Re.heap[1]=wt++,Rr(Re,fn,1),2<=Re.heap_len;);Re.heap[--Re.heap_max]=Re.heap[1],function(Hr,d0){var i3,F0,Kd,ma,C8,J6,Zd=d0.dyn_tree,e7=d0.max_code,AS=d0.stat_desc.static_tree,PS=d0.stat_desc.has_stree,RS=d0.stat_desc.extra_bits,t7=d0.stat_desc.extra_base,wh=d0.stat_desc.max_length,Qd=0;for(ma=0;ma<=X;ma++)Hr.bl_count[ma]=0;for(Zd[2*Hr.heap[Hr.heap_max]+1]=0,i3=Hr.heap_max+1;i3<H;i3++)wh<(ma=Zd[2*Zd[2*(F0=Hr.heap[i3])+1]+1]+1)&&(ma=wh,Qd++),Zd[2*F0+1]=ma,e7<F0||(Hr.bl_count[ma]++,C8=0,t7<=F0&&(C8=RS[F0-t7]),J6=Zd[2*F0],Hr.opt_len+=J6*(ma+C8),PS&&(Hr.static_len+=J6*(AS[2*F0+1]+C8)));if(Qd!==0){do{for(ma=wh-1;Hr.bl_count[ma]===0;)ma--;Hr.bl_count[ma]--,Hr.bl_count[ma+1]+=2,Hr.bl_count[wh]--,Qd-=2}while(0<Qd);for(ma=wh;ma!==0;ma--)for(F0=Hr.bl_count[ma];F0!==0;)e7<(Kd=Hr.heap[--i3])||(Zd[2*Kd+1]!==ma&&(Hr.opt_len+=(ma-Zd[2*Kd+1])*Zd[2*Kd],Zd[2*Kd+1]=ma),F0--)}}(Re,ct),Gn(fn,zi,Re.bl_count)}function he(Re,ct,Xt){var rn,wt,fn=-1,tn=ct[1],sn=0,xr=7,zi=4;for(tn===0&&(xr=138,zi=3),ct[2*(Xt+1)+1]=65535,rn=0;rn<=Xt;rn++)wt=tn,tn=ct[2*(rn+1)+1],++sn<xr&&wt===tn||(sn<zi?Re.bl_tree[2*wt]+=sn:wt!==0?(wt!==fn&&Re.bl_tree[2*wt]++,Re.bl_tree[2*pe]++):sn<=10?Re.bl_tree[2*fe]++:Re.bl_tree[2*ye]++,fn=wt,zi=(sn=0)===tn?(xr=138,3):wt===tn?(xr=6,3):(xr=7,4))}function Lt(Re,ct,Xt){var rn,wt,fn=-1,tn=ct[1],sn=0,xr=7,zi=4;for(tn===0&&(xr=138,zi=3),rn=0;rn<=Xt;rn++)if(wt=tn,tn=ct[2*(rn+1)+1],!(++sn<xr&&wt===tn)){if(sn<zi)for(;It(Re,wt,Re.bl_tree),--sn!=0;);else wt!==0?(wt!==fn&&(It(Re,wt,Re.bl_tree),sn--),It(Re,pe,Re.bl_tree),Mt(Re,sn-3,2)):sn<=10?(It(Re,fe,Re.bl_tree),Mt(Re,sn-3,3)):(It(Re,ye,Re.bl_tree),Mt(Re,sn-11,7));fn=wt,zi=(sn=0)===tn?(xr=138,3):wt===tn?(xr=6,3):(xr=7,4)}}R(at);var kt=!1;function Ie(Re,ct,Xt,rn){Mt(Re,(N<<1)+(rn?1:0),3),function(wt,fn,tn,sn){Nn(wt),St(wt,tn),St(wt,~tn),b.arraySet(wt.pending_buf,wt.window,fn,tn,wt.pending),wt.pending+=tn}(Re,ct,Xt)}_._tr_init=function(Re){kt||(function(){var ct,Xt,rn,wt,fn,tn=new Array(X+1);for(wt=rn=0;wt<z-1;wt++)for(nt[wt]=rn,ct=0;ct<1<<Ne[wt];ct++)ae[rn++]=wt;for(ae[rn-1]=wt,wt=fn=0;wt<16;wt++)for(at[wt]=fn,ct=0;ct<1<<ze[wt];ct++)We[fn++]=wt;for(fn>>=7;wt<B;wt++)for(at[wt]=fn<<7,ct=0;ct<1<<ze[wt]-7;ct++)We[256+fn++]=wt;for(Xt=0;Xt<=X;Xt++)tn[Xt]=0;for(ct=0;ct<=143;)yt[2*ct+1]=8,ct++,tn[8]++;for(;ct<=255;)yt[2*ct+1]=9,ct++,tn[9]++;for(;ct<=279;)yt[2*ct+1]=7,ct++,tn[7]++;for(;ct<=287;)yt[2*ct+1]=8,ct++,tn[8]++;for(Gn(yt,V+1,tn),ct=0;ct<B;ct++)xe[2*ct+1]=5,xe[2*ct]=ut(ct,5);dn=new Wt(yt,Ne,G+1,V,X),Ve=new Wt(xe,ze,0,B,X),Ue=new Wt(new Array(0),Me,0,j,te)}(),kt=!0),Re.l_desc=new be(Re.dyn_ltree,dn),Re.d_desc=new be(Re.dyn_dtree,Ve),Re.bl_desc=new be(Re.bl_tree,Ue),Re.bi_buf=0,Re.bi_valid=0,Vt(Re)},_._tr_stored_block=Ie,_._tr_flush_block=function(Re,ct,Xt,rn){var wt,fn,tn=0;0<Re.level?(Re.strm.data_type===2&&(Re.strm.data_type=function(sn){var xr,zi=4093624447;for(xr=0;xr<=31;xr++,zi>>>=1)if(1&zi&&sn.dyn_ltree[2*xr]!==0)return E;if(sn.dyn_ltree[18]!==0||sn.dyn_ltree[20]!==0||sn.dyn_ltree[26]!==0)return T;for(xr=32;xr<G;xr++)if(sn.dyn_ltree[2*xr]!==0)return T;return E}(Re)),Wi(Re,Re.l_desc),Wi(Re,Re.d_desc),tn=function(sn){var xr;for(he(sn,sn.dyn_ltree,sn.l_desc.max_code),he(sn,sn.dyn_dtree,sn.d_desc.max_code),Wi(sn,sn.bl_desc),xr=j-1;3<=xr&&sn.bl_tree[2*je[xr]+1]===0;xr--);return sn.opt_len+=3*(xr+1)+5+5+4,xr}(Re),wt=Re.opt_len+3+7>>>3,(fn=Re.static_len+3+7>>>3)<=wt&&(wt=fn)):wt=fn=Xt+5,Xt+4<=wt&&ct!==-1?Ie(Re,ct,Xt,rn):Re.strategy===4||fn===wt?(Mt(Re,2+(rn?1:0),3),Tr(Re,yt,xe)):(Mt(Re,4+(rn?1:0),3),function(sn,xr,zi,Hr){var d0;for(Mt(sn,xr-257,5),Mt(sn,zi-1,5),Mt(sn,Hr-4,4),d0=0;d0<Hr;d0++)Mt(sn,sn.bl_tree[2*je[d0]+1],3);Lt(sn,sn.dyn_ltree,xr-1),Lt(sn,sn.dyn_dtree,zi-1)}(Re,Re.l_desc.max_code+1,Re.d_desc.max_code+1,tn+1),Tr(Re,Re.dyn_ltree,Re.dyn_dtree)),Vt(Re),rn&&Nn(Re)},_._tr_tally=function(Re,ct,Xt){return Re.pending_buf[Re.d_buf+2*Re.last_lit]=ct>>>8&255,Re.pending_buf[Re.d_buf+2*Re.last_lit+1]=255&ct,Re.pending_buf[Re.l_buf+Re.last_lit]=255&Xt,Re.last_lit++,ct===0?Re.dyn_ltree[2*Xt]++:(Re.matches++,ct--,Re.dyn_ltree[2*(ae[Xt]+G+1)]++,Re.dyn_dtree[2*Ce(ct)]++),Re.last_lit===Re.lit_bufsize-1},_._tr_align=function(Re){Mt(Re,2,3),It(Re,se,yt),function(ct){ct.bi_valid===16?(St(ct,ct.bi_buf),ct.bi_buf=0,ct.bi_valid=0):8<=ct.bi_valid&&(ct.pending_buf[ct.pending++]=255&ct.bi_buf,ct.bi_buf>>=8,ct.bi_valid-=8)}(Re)}},{"../utils/common":41}],53:[function(c,m,_){m.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(c,m,_){(function(b){(function(E,T){if(!E.setImmediate){var R,N,z,G,V=1,B={},j=!1,H=E.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(E);X=X&&X.setTimeout?X:E,R={}.toString.call(E.process)==="[object process]"?function(pe){process.nextTick(function(){te(pe)})}:function(){if(E.postMessage&&!E.importScripts){var pe=!0,fe=E.onmessage;return E.onmessage=function(){pe=!1},E.postMessage("","*"),E.onmessage=fe,pe}}()?(G="setImmediate$"+Math.random()+"$",E.addEventListener?E.addEventListener("message",se,!1):E.attachEvent("onmessage",se),function(pe){E.postMessage(G+pe,"*")}):E.MessageChannel?((z=new MessageChannel).port1.onmessage=function(pe){te(pe.data)},function(pe){z.port2.postMessage(pe)}):H&&"onreadystatechange"in H.createElement("script")?(N=H.documentElement,function(pe){var fe=H.createElement("script");fe.onreadystatechange=function(){te(pe),fe.onreadystatechange=null,N.removeChild(fe),fe=null},N.appendChild(fe)}):function(pe){setTimeout(te,0,pe)},X.setImmediate=function(pe){typeof pe!="function"&&(pe=new Function(""+pe));for(var fe=new Array(arguments.length-1),ye=0;ye<fe.length;ye++)fe[ye]=arguments[ye+1];var Ne={callback:pe,args:fe};return B[V]=Ne,R(V),V++},X.clearImmediate=K}function K(pe){delete B[pe]}function te(pe){if(j)setTimeout(te,0,pe);else{var fe=B[pe];if(fe){j=!0;try{(function(ye){var Ne=ye.callback,ze=ye.args;switch(ze.length){case 0:Ne();break;case 1:Ne(ze[0]);break;case 2:Ne(ze[0],ze[1]);break;case 3:Ne(ze[0],ze[1],ze[2]);break;default:Ne.apply(T,ze)}})(fe)}finally{K(pe),j=!1}}}}function se(pe){pe.source===E&&typeof pe.data=="string"&&pe.data.indexOf(G)===0&&te(+pe.data.slice(G.length))}})(typeof self>"u"?b===void 0?this:b:self)}).call(this,typeof xa<"u"?xa:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}),RO,oC,bee,IO,See,wee,Vb,Eee,kO,Tee,lC,Gb,Hb,V9,Mee,Cee,Aee,R6,gu,Pee,Ree,NO,uC,o7e=I(()=>{RO=Q(qe(),1),oC=Q(qe(),1),bee=a=>typeof a=="function",IO=(a,u)=>bee(a)?a(u):a,See=(()=>{let a=0;return()=>(++a).toString()})(),wee=20,Vb=new Map,Eee=1e3,kO=a=>{if(Vb.has(a))return;let u=setTimeout(()=>{Vb.delete(a),V9({type:4,toastId:a})},Eee);Vb.set(a,u)},Tee=a=>{let u=Vb.get(a);u&&clearTimeout(u)},lC=(a,u)=>{switch(u.type){case 0:return $(P({},a),{toasts:[u.toast,...a.toasts].slice(0,wee)});case 1:return u.toast.id&&Tee(u.toast.id),$(P({},a),{toasts:a.toasts.map(b=>b.id===u.toast.id?P(P({},b),u.toast):b)});case 2:let{toast:c}=u;return a.toasts.find(b=>b.id===c.id)?lC(a,{type:1,toast:c}):lC(a,{type:0,toast:c});case 3:let{toastId:m}=u;return m?kO(m):a.toasts.forEach(b=>{kO(b.id)}),$(P({},a),{toasts:a.toasts.map(b=>b.id===m||m===void 0?$(P({},b),{visible:!1}):b)});case 4:return u.toastId===void 0?$(P({},a),{toasts:[]}):$(P({},a),{toasts:a.toasts.filter(b=>b.id!==u.toastId)});case 5:return $(P({},a),{pausedAt:u.time});case 6:let _=u.time-(a.pausedAt||0);return $(P({},a),{pausedAt:void 0,toasts:a.toasts.map(b=>$(P({},b),{pauseDuration:b.pauseDuration+_}))})}},Gb=[],Hb={toasts:[],pausedAt:void 0},V9=a=>{Hb=lC(Hb,a),Gb.forEach(u=>{u(Hb)})},Mee={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Cee=(a={})=>{let[u,c]=(0,RO.useState)(Hb);(0,RO.useEffect)(()=>(Gb.push(c),()=>{let _=Gb.indexOf(c);_>-1&&Gb.splice(_,1)}),[u]);let m=u.toasts.map(_=>{var b,E;return $(P(P(P({},a),a[_.type]),_),{duration:_.duration||((b=a[_.type])==null?void 0:b.duration)||(a==null?void 0:a.duration)||Mee[_.type],style:P(P(P({},a.style),(E=a[_.type])==null?void 0:E.style),_.style)})});return $(P({},u),{toasts:m})},Aee=(a,u="blank",c)=>$(P({createdAt:Date.now(),visible:!0,type:u,ariaProps:{role:"status","aria-live":"polite"},message:a,pauseDuration:0},c),{id:(c==null?void 0:c.id)||See()}),R6=a=>(u,c)=>{let m=Aee(u,a,c);return V9({type:2,toast:m}),m.id},gu=(a,u)=>R6("blank")(a,u),gu.error=R6("error"),gu.success=R6("success"),gu.loading=R6("loading"),gu.custom=R6("custom"),gu.dismiss=a=>{V9({type:3,toastId:a})},gu.remove=a=>V9({type:4,toastId:a}),gu.promise=(a,u,c)=>{let m=gu.loading(u.loading,P(P({},c),c==null?void 0:c.loading));return a.then(_=>(gu.success(IO(u.success,_),P(P({id:m},c),c==null?void 0:c.success)),_)).catch(_=>{gu.error(IO(u.error,_),P(P({id:m},c),c==null?void 0:c.error))}),a},Pee=(a,u)=>{V9({type:1,toast:{id:a,height:u}})},Ree=()=>{V9({type:5,time:Date.now()})},NO=a=>{let{toasts:u,pausedAt:c}=Cee(a);(0,oC.useEffect)(()=>{if(c)return;let b=Date.now(),E=u.map(T=>{if(T.duration===1/0)return;let R=(T.duration||0)+T.pauseDuration-(b-T.createdAt);if(R<0){T.visible&&gu.dismiss(T.id);return}return setTimeout(()=>gu.dismiss(T.id),R)});return()=>{E.forEach(T=>T&&clearTimeout(T))}},[u,c]);let m=(0,oC.useCallback)(()=>{c&&V9({type:6,time:Date.now()})},[c]),_=(0,oC.useCallback)((b,E)=>{let{reverseOrder:T=!1,gutter:R=8,defaultPosition:N}=E||{},z=u.filter(B=>(B.position||N)===(b.position||N)&&B.height),G=z.findIndex(B=>B.id===b.id),V=z.filter((B,j)=>j<G&&B.visible).length;return z.filter(B=>B.visible).slice(...T?[V+1]:[0,V]).reduce((B,j)=>B+(j.height||0)+R,0)},[u]);return{toasts:u,handlers:{updateHeight:Pee,startPause:Ree,endPause:m,calculateOffset:_}}},uC=gu});function Iee(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function l7e(a){K5=a}function Oo(a,u){if(u){if(Bee.test(a))return a.replace(zee,DO)}else if(Vee.test(a))return a.replace(Gee,DO);return a}function kee(a){return a.replace(jee,(u,c)=>(c=c.toLowerCase(),c==="colon"?":":c.charAt(0)==="#"?c.charAt(1)==="x"?String.fromCharCode(parseInt(c.substring(2),16)):String.fromCharCode(+c.substring(1)):""))}function Ts(a,u){a=typeof a=="string"?a:a.source,u=u||"";let c={replace:(m,_)=>(_=_.source||_,_=_.replace(Wee,"$1"),a=a.replace(m,_),c),getRegex:()=>new RegExp(a,u)};return c}function Nee(a,u,c){if(a){let m;try{m=decodeURIComponent(kee(c)).replace($ee,"").toLowerCase()}catch{return null}if(m.indexOf("javascript:")===0||m.indexOf("vbscript:")===0||m.indexOf("data:")===0)return null}u&&!qee.test(c)&&(c=u7e(u,c));try{c=encodeURI(c).replace(/%25/g,"%")}catch{return null}return c}function u7e(a,u){jb[" "+a]||(Xee.test(a)?jb[" "+a]=a+"/":jb[" "+a]=cC(a,"/",!0)),a=jb[" "+a];let c=a.indexOf(":")===-1;return u.substring(0,2)==="//"?c?u:a.replace(Yee,"$1")+u:u.charAt(0)==="/"?c?u:a.replace(Kee,"$1")+u:a+u}function Gd(a){let u=1,c,m;for(;u<arguments.length;u++){c=arguments[u];for(m in c)Object.prototype.hasOwnProperty.call(c,m)&&(a[m]=c[m])}return a}function Dee(a,u){let c=a.replace(/\|/g,(b,E,T)=>{let R=!1,N=E;for(;--N>=0&&T[N]==="\\";)R=!R;return R?"|":" |"}),m=c.split(/ \|/),_=0;if(m[0].trim()||m.shift(),m.length>0&&!m[m.length-1].trim()&&m.pop(),m.length>u)m.splice(u);else for(;m.length<u;)m.push("");for(;_<m.length;_++)m[_]=m[_].trim().replace(/\\\|/g,"|");return m}function cC(a,u,c){let m=a.length;if(m===0)return"";let _=0;for(;_<m;){let b=a.charAt(m-_-1);if(b===u&&!c)_++;else if(b!==u&&c)_++;else break}return a.slice(0,m-_)}function c7e(a,u){if(a.indexOf(u[1])===-1)return-1;let c=a.length,m=0,_=0;for(;_<c;_++)if(a[_]==="\\")_++;else if(a[_]===u[0])m++;else if(a[_]===u[1]&&(m--,m<0))return _;return-1}function Oee(a){a&&a.sanitize&&!a.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function Fee(a,u){if(u<1)return"";let c="";for(;u>1;)u&1&&(c+=a),u>>=1,a+=a;return c+a}function Lee(a,u,c,m){let _=u.href,b=u.title?Oo(u.title):null,E=a[1].replace(/\\([\[\]])/g,"$1");if(a[0].charAt(0)!=="!"){m.state.inLink=!0;let T={type:"link",raw:c,href:_,title:b,text:E,tokens:m.inlineTokens(E)};return m.state.inLink=!1,T}return{type:"image",raw:c,href:_,title:b,text:Oo(E)}}function h7e(a,u){let c=a.match(/^(\s+)(?:```)/);if(c===null)return u;let m=c[1];return u.split(`
`).map(_=>{let b=_.match(/^\s+/);if(b===null)return _;let[E]=b;return E.length>=m.length?_.slice(m.length):_}).join(`
`)}function d7e(a){return a.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function Uee(a){let u="",c,m,_=a.length;for(c=0;c<_;c++)m=a.charCodeAt(c),Math.random()>.5&&(m="x"+m.toString(16)),u+="&#"+m+";";return u}function Br(a,u,c){if(typeof a>"u"||a===null)throw new Error("marked(): input parameter is undefined or null");if(typeof a!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(a)+", string expected");if(typeof u=="function"&&(c=u,u=null),u=Gd({},Br.defaults,u||{}),Oee(u),c){let _=u.highlight,b;try{b=Z5.lex(a,u)}catch(R){return c(R)}let E=function(R){let N;if(!R)try{u.walkTokens&&Br.walkTokens(b,u.walkTokens),N=G9.parse(b,u)}catch(z){R=z}return u.highlight=_,R?c(R):c(null,N)};if(!_||_.length<3||(delete u.highlight,!b.length))return E();let T=0;Br.walkTokens(b,function(R){R.type==="code"&&(T++,setTimeout(()=>{_(R.text,R.lang,function(N,z){if(N)return E(N);z!=null&&z!==R.text&&(R.text=z,R.escaped=!0),T--,T===0&&E()})},0))}),T===0&&E();return}function m(_){if(_.message+=`
Please report this to https://github.com/markedjs/marked.`,u.silent)return"<p>An error occurred:</p><pre>"+Oo(_.message+"",!0)+"</pre>";throw _}try{let _=Z5.lex(a,u);if(u.walkTokens){if(u.async)return Promise.all(Br.walkTokens(_,u.walkTokens)).then(()=>G9.parse(_,u)).catch(m);Br.walkTokens(_,u.walkTokens)}return G9.parse(_,u)}catch(_){m(_)}}var K5,Bee,zee,Vee,Gee,Hee,DO,jee,Wee,$ee,qee,jb,Xee,Yee,Kee,Wb,hC,Pr,nr,Z5,dC,OO,FO,G9,f7e=I(()=>{K5=Iee(),Bee=/[&<>"']/,zee=/[&<>"']/g,Vee=/[<>"']|&(?!#?\w+;)/,Gee=/[<>"']|&(?!#?\w+;)/g,Hee={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},DO=a=>Hee[a],jee=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,Wee=/(^|[^\[])\^/g,$ee=/[^\w:]/g,qee=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,jb={},Xee=/^[^:]+:\/*[^/]*$/,Yee=/^([^:]+:)[\s\S]*$/,Kee=/^([^:]+:\/*[^/]*)[\s\S]*$/,Wb={exec:function(){}},hC=class{constructor(a){this.options=a||K5}space(a){let u=this.rules.block.newline.exec(a);if(u&&u[0].length>0)return{type:"space",raw:u[0]}}code(a){let u=this.rules.block.code.exec(a);if(u){let c=u[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:u[0],codeBlockStyle:"indented",text:this.options.pedantic?c:cC(c,`
`)}}}fences(a){let u=this.rules.block.fences.exec(a);if(u){let c=u[0],m=h7e(c,u[3]||"");return{type:"code",raw:c,lang:u[2]?u[2].trim():u[2],text:m}}}heading(a){let u=this.rules.block.heading.exec(a);if(u){let c=u[2].trim();if(/#$/.test(c)){let m=cC(c,"#");(this.options.pedantic||!m||/ $/.test(m))&&(c=m.trim())}return{type:"heading",raw:u[0],depth:u[1].length,text:c,tokens:this.lexer.inline(c)}}}hr(a){let u=this.rules.block.hr.exec(a);if(u)return{type:"hr",raw:u[0]}}blockquote(a){let u=this.rules.block.blockquote.exec(a);if(u){let c=u[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:u[0],tokens:this.lexer.blockTokens(c,[]),text:c}}}list(a){let u=this.rules.block.list.exec(a);if(u){let c,m,_,b,E,T,R,N,z,G,V,B,j=u[1].trim(),H=j.length>1,X={type:"list",raw:"",ordered:H,start:H?+j.slice(0,-1):"",loose:!1,items:[]};j=H?"\\d{1,9}\\".concat(j.slice(-1)):"\\".concat(j),this.options.pedantic&&(j=H?j:"[*+-]");let K=new RegExp("^( {0,3}".concat(j,")((?:[	 ][^\\n]*)?(?:\\n|$))"));for(;a&&(B=!1,!(!(u=K.exec(a))||this.rules.block.hr.test(a)));){if(c=u[0],a=a.substring(c.length),N=u[2].split(`
`,1)[0],z=a.split(`
`,1)[0],this.options.pedantic?(b=2,V=N.trimLeft()):(b=u[2].search(/[^ ]/),b=b>4?1:b,V=N.slice(b),b+=u[1].length),T=!1,!N&&/^ *$/.test(z)&&(c+=z+`
`,a=a.substring(z.length+1),B=!0),!B){let se=new RegExp("^ {0,".concat(Math.min(3,b-1),"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))")),pe=new RegExp("^ {0,".concat(Math.min(3,b-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),fe=new RegExp("^ {0,".concat(Math.min(3,b-1),"}(?:```|~~~)")),ye=new RegExp("^ {0,".concat(Math.min(3,b-1),"}#"));for(;a&&(G=a.split(`
`,1)[0],N=G,this.options.pedantic&&(N=N.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(fe.test(N)||ye.test(N)||se.test(N)||pe.test(a)));){if(N.search(/[^ ]/)>=b||!N.trim())V+=`
`+N.slice(b);else if(!T)V+=`
`+N;else break;!T&&!N.trim()&&(T=!0),c+=G+`
`,a=a.substring(G.length+1)}}X.loose||(R?X.loose=!0:/\n *\n *$/.test(c)&&(R=!0)),this.options.gfm&&(m=/^\[[ xX]\] /.exec(V),m&&(_=m[0]!=="[ ] ",V=V.replace(/^\[[ xX]\] +/,""))),X.items.push({type:"list_item",raw:c,task:!!m,checked:_,loose:!1,text:V}),X.raw+=c}X.items[X.items.length-1].raw=c.trimRight(),X.items[X.items.length-1].text=V.trimRight(),X.raw=X.raw.trimRight();let te=X.items.length;for(E=0;E<te;E++){this.lexer.state.top=!1,X.items[E].tokens=this.lexer.blockTokens(X.items[E].text,[]);let se=X.items[E].tokens.filter(fe=>fe.type==="space"),pe=se.every(fe=>{let ye=fe.raw.split(""),Ne=0;for(let ze of ye)if(ze===`
`&&(Ne+=1),Ne>1)return!0;return!1});!X.loose&&se.length&&pe&&(X.loose=!0,X.items[E].loose=!0)}return X}}html(a){let u=this.rules.block.html.exec(a);if(u){let c={type:"html",raw:u[0],pre:!this.options.sanitizer&&(u[1]==="pre"||u[1]==="script"||u[1]==="style"),text:u[0]};if(this.options.sanitize){let m=this.options.sanitizer?this.options.sanitizer(u[0]):Oo(u[0]);c.type="paragraph",c.text=m,c.tokens=this.lexer.inline(m)}return c}}def(a){let u=this.rules.block.def.exec(a);if(u)return u[3]&&(u[3]=u[3].substring(1,u[3].length-1)),{type:"def",tag:u[1].toLowerCase().replace(/\s+/g," "),raw:u[0],href:u[2],title:u[3]}}table(a){let u=this.rules.block.table.exec(a);if(u){let c={type:"table",header:Dee(u[1]).map(m=>({text:m})),align:u[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:u[3]&&u[3].trim()?u[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(c.header.length===c.align.length){c.raw=u[0];let m=c.align.length,_,b,E,T;for(_=0;_<m;_++)/^ *-+: *$/.test(c.align[_])?c.align[_]="right":/^ *:-+: *$/.test(c.align[_])?c.align[_]="center":/^ *:-+ *$/.test(c.align[_])?c.align[_]="left":c.align[_]=null;for(m=c.rows.length,_=0;_<m;_++)c.rows[_]=Dee(c.rows[_],c.header.length).map(R=>({text:R}));for(m=c.header.length,b=0;b<m;b++)c.header[b].tokens=this.lexer.inline(c.header[b].text);for(m=c.rows.length,b=0;b<m;b++)for(T=c.rows[b],E=0;E<T.length;E++)T[E].tokens=this.lexer.inline(T[E].text);return c}}}lheading(a){let u=this.rules.block.lheading.exec(a);if(u)return{type:"heading",raw:u[0],depth:u[2].charAt(0)==="="?1:2,text:u[1],tokens:this.lexer.inline(u[1])}}paragraph(a){let u=this.rules.block.paragraph.exec(a);if(u){let c=u[1].charAt(u[1].length-1)===`
`?u[1].slice(0,-1):u[1];return{type:"paragraph",raw:u[0],text:c,tokens:this.lexer.inline(c)}}}text(a){let u=this.rules.block.text.exec(a);if(u)return{type:"text",raw:u[0],text:u[0],tokens:this.lexer.inline(u[0])}}escape(a){let u=this.rules.inline.escape.exec(a);if(u)return{type:"escape",raw:u[0],text:Oo(u[1])}}tag(a){let u=this.rules.inline.tag.exec(a);if(u)return!this.lexer.state.inLink&&/^<a /i.test(u[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(u[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(u[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(u[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:u[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(u[0]):Oo(u[0]):u[0]}}link(a){let u=this.rules.inline.link.exec(a);if(u){let c=u[2].trim();if(!this.options.pedantic&&/^</.test(c)){if(!/>$/.test(c))return;let b=cC(c.slice(0,-1),"\\");if((c.length-b.length)%2===0)return}else{let b=c7e(u[2],"()");if(b>-1){let E=(u[0].indexOf("!")===0?5:4)+u[1].length+b;u[2]=u[2].substring(0,b),u[0]=u[0].substring(0,E).trim(),u[3]=""}}let m=u[2],_="";if(this.options.pedantic){let b=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(m);b&&(m=b[1],_=b[3])}else _=u[3]?u[3].slice(1,-1):"";return m=m.trim(),/^</.test(m)&&(this.options.pedantic&&!/>$/.test(c)?m=m.slice(1):m=m.slice(1,-1)),Lee(u,{href:m&&m.replace(this.rules.inline._escapes,"$1"),title:_&&_.replace(this.rules.inline._escapes,"$1")},u[0],this.lexer)}}reflink(a,u){let c;if((c=this.rules.inline.reflink.exec(a))||(c=this.rules.inline.nolink.exec(a))){let m=(c[2]||c[1]).replace(/\s+/g," ");if(m=u[m.toLowerCase()],!m||!m.href){let _=c[0].charAt(0);return{type:"text",raw:_,text:_}}return Lee(c,m,c[0],this.lexer)}}emStrong(a,u,c=""){let m=this.rules.inline.emStrong.lDelim.exec(a);if(!m||m[3]&&c.match(/[\p{L}\p{N}]/u))return;let _=m[1]||m[2]||"";if(!_||_&&(c===""||this.rules.inline.punctuation.exec(c))){let b=m[0].length-1,E,T,R=b,N=0,z=m[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(z.lastIndex=0,u=u.slice(-1*a.length+b);(m=z.exec(u))!=null;){if(E=m[1]||m[2]||m[3]||m[4]||m[5]||m[6],!E)continue;if(T=E.length,m[3]||m[4]){R+=T;continue}else if((m[5]||m[6])&&b%3&&!((b+T)%3)){N+=T;continue}if(R-=T,R>0)continue;if(T=Math.min(T,T+R+N),Math.min(b,T)%2){let V=a.slice(1,b+m.index+T);return{type:"em",raw:a.slice(0,b+m.index+T+1),text:V,tokens:this.lexer.inlineTokens(V)}}let G=a.slice(2,b+m.index+T-1);return{type:"strong",raw:a.slice(0,b+m.index+T+1),text:G,tokens:this.lexer.inlineTokens(G)}}}}codespan(a){let u=this.rules.inline.code.exec(a);if(u){let c=u[2].replace(/\n/g," "),m=/[^ ]/.test(c),_=/^ /.test(c)&&/ $/.test(c);return m&&_&&(c=c.substring(1,c.length-1)),c=Oo(c,!0),{type:"codespan",raw:u[0],text:c}}}br(a){let u=this.rules.inline.br.exec(a);if(u)return{type:"br",raw:u[0]}}del(a){let u=this.rules.inline.del.exec(a);if(u)return{type:"del",raw:u[0],text:u[2],tokens:this.lexer.inlineTokens(u[2])}}autolink(a,u){let c=this.rules.inline.autolink.exec(a);if(c){let m,_;return c[2]==="@"?(m=Oo(this.options.mangle?u(c[1]):c[1]),_="mailto:"+m):(m=Oo(c[1]),_=m),{type:"link",raw:c[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}url(a,u){let c;if(c=this.rules.inline.url.exec(a)){let m,_;if(c[2]==="@")m=Oo(this.options.mangle?u(c[0]):c[0]),_="mailto:"+m;else{let b;do b=c[0],c[0]=this.rules.inline._backpedal.exec(c[0])[0];while(b!==c[0]);m=Oo(c[0]),c[1]==="www."?_="http://"+m:_=m}return{type:"link",raw:c[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}inlineText(a,u){let c=this.rules.inline.text.exec(a);if(c){let m;return this.lexer.state.inRawBlock?m=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(c[0]):Oo(c[0]):c[0]:m=Oo(this.options.smartypants?u(c[0]):c[0]),{type:"text",raw:c[0],text:m}}}},Pr={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Wb,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/},Pr._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Pr._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,Pr.def=Ts(Pr.def).replace("label",Pr._label).replace("title",Pr._title).getRegex(),Pr.bullet=/(?:[*+-]|\d{1,9}[.)])/,Pr.listItemStart=Ts(/^( *)(bull) */).replace("bull",Pr.bullet).getRegex(),Pr.list=Ts(Pr.list).replace(/bull/g,Pr.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Pr.def.source+")").getRegex(),Pr._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Pr._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Pr.html=Ts(Pr.html,"i").replace("comment",Pr._comment).replace("tag",Pr._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Pr.paragraph=Ts(Pr._paragraph).replace("hr",Pr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pr._tag).getRegex(),Pr.blockquote=Ts(Pr.blockquote).replace("paragraph",Pr.paragraph).getRegex(),Pr.normal=Gd({},Pr),Pr.gfm=Gd({},Pr.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Pr.gfm.table=Ts(Pr.gfm.table).replace("hr",Pr.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pr._tag).getRegex(),Pr.gfm.paragraph=Ts(Pr._paragraph).replace("hr",Pr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Pr.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pr._tag).getRegex(),Pr.pedantic=Gd({},Pr.normal,{html:Ts(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Pr._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Wb,paragraph:Ts(Pr.normal._paragraph).replace("hr",Pr.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Pr.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),nr={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Wb,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Wb,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/},nr._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",nr.punctuation=Ts(nr.punctuation).replace(/punctuation/g,nr._punctuation).getRegex(),nr.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,nr.escapedEmSt=/\\\*|\\_/g,nr._comment=Ts(Pr._comment).replace("(?:-->|$)","-->").getRegex(),nr.emStrong.lDelim=Ts(nr.emStrong.lDelim).replace(/punct/g,nr._punctuation).getRegex(),nr.emStrong.rDelimAst=Ts(nr.emStrong.rDelimAst,"g").replace(/punct/g,nr._punctuation).getRegex(),nr.emStrong.rDelimUnd=Ts(nr.emStrong.rDelimUnd,"g").replace(/punct/g,nr._punctuation).getRegex(),nr._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,nr._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,nr._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,nr.autolink=Ts(nr.autolink).replace("scheme",nr._scheme).replace("email",nr._email).getRegex(),nr._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,nr.tag=Ts(nr.tag).replace("comment",nr._comment).replace("attribute",nr._attribute).getRegex(),nr._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,nr._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,nr._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,nr.link=Ts(nr.link).replace("label",nr._label).replace("href",nr._href).replace("title",nr._title).getRegex(),nr.reflink=Ts(nr.reflink).replace("label",nr._label).replace("ref",Pr._label).getRegex(),nr.nolink=Ts(nr.nolink).replace("ref",Pr._label).getRegex(),nr.reflinkSearch=Ts(nr.reflinkSearch,"g").replace("reflink",nr.reflink).replace("nolink",nr.nolink).getRegex(),nr.normal=Gd({},nr),nr.pedantic=Gd({},nr.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ts(/^!?\[(label)\]\((.*?)\)/).replace("label",nr._label).getRegex(),reflink:Ts(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",nr._label).getRegex()}),nr.gfm=Gd({},nr.normal,{escape:Ts(nr.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),nr.gfm.url=Ts(nr.gfm.url,"i").replace("email",nr.gfm._extended_email).getRegex(),nr.breaks=Gd({},nr.gfm,{br:Ts(nr.br).replace("{2,}","*").getRegex(),text:Ts(nr.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),Z5=class BG{constructor(u){this.tokens=[],this.tokens.links=Object.create(null),this.options=u||K5,this.options.tokenizer=this.options.tokenizer||new hC,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let c={block:Pr.normal,inline:nr.normal};this.options.pedantic?(c.block=Pr.pedantic,c.inline=nr.pedantic):this.options.gfm&&(c.block=Pr.gfm,this.options.breaks?c.inline=nr.breaks:c.inline=nr.gfm),this.tokenizer.rules=c}static get rules(){return{block:Pr,inline:nr}}static lex(u,c){return new BG(c).lex(u)}static lexInline(u,c){return new BG(c).inlineTokens(u)}lex(u){u=u.replace(/\r\n|\r/g,`
`),this.blockTokens(u,this.tokens);let c;for(;c=this.inlineQueue.shift();)this.inlineTokens(c.src,c.tokens);return this.tokens}blockTokens(u,c=[]){this.options.pedantic?u=u.replace(/\t/g,"    ").replace(/^ +$/gm,""):u=u.replace(/^( *)(\t+)/gm,(T,R,N)=>R+"    ".repeat(N.length));let m,_,b,E;for(;u;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(T=>(m=T.call({lexer:this},u,c))?(u=u.substring(m.raw.length),c.push(m),!0):!1))){if(m=this.tokenizer.space(u)){u=u.substring(m.raw.length),m.raw.length===1&&c.length>0?c[c.length-1].raw+=`
`:c.push(m);continue}if(m=this.tokenizer.code(u)){u=u.substring(m.raw.length),_=c[c.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue[this.inlineQueue.length-1].src=_.text):c.push(m);continue}if(m=this.tokenizer.fences(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.heading(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.hr(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.blockquote(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.list(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.html(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.def(u)){u=u.substring(m.raw.length),_=c[c.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.raw,this.inlineQueue[this.inlineQueue.length-1].src=_.text):this.tokens.links[m.tag]||(this.tokens.links[m.tag]={href:m.href,title:m.title});continue}if(m=this.tokenizer.table(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.lheading(u)){u=u.substring(m.raw.length),c.push(m);continue}if(b=u,this.options.extensions&&this.options.extensions.startBlock){let T=1/0,R=u.slice(1),N;this.options.extensions.startBlock.forEach(function(z){N=z.call({lexer:this},R),typeof N=="number"&&N>=0&&(T=Math.min(T,N))}),T<1/0&&T>=0&&(b=u.substring(0,T+1))}if(this.state.top&&(m=this.tokenizer.paragraph(b))){_=c[c.length-1],E&&_.type==="paragraph"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):c.push(m),E=b.length!==u.length,u=u.substring(m.raw.length);continue}if(m=this.tokenizer.text(u)){u=u.substring(m.raw.length),_=c[c.length-1],_&&_.type==="text"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):c.push(m);continue}if(u){let T="Infinite loop on byte: "+u.charCodeAt(0);if(this.options.silent){console.error(T);break}else throw new Error(T)}}return this.state.top=!0,c}inline(u,c=[]){return this.inlineQueue.push({src:u,tokens:c}),c}inlineTokens(u,c=[]){let m,_,b,E=u,T,R,N;if(this.tokens.links){let z=Object.keys(this.tokens.links);if(z.length>0)for(;(T=this.tokenizer.rules.inline.reflinkSearch.exec(E))!=null;)z.includes(T[0].slice(T[0].lastIndexOf("[")+1,-1))&&(E=E.slice(0,T.index)+"["+Fee("a",T[0].length-2)+"]"+E.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(T=this.tokenizer.rules.inline.blockSkip.exec(E))!=null;)E=E.slice(0,T.index)+"["+Fee("a",T[0].length-2)+"]"+E.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(T=this.tokenizer.rules.inline.escapedEmSt.exec(E))!=null;)E=E.slice(0,T.index)+"++"+E.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;u;)if(R||(N=""),R=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(z=>(m=z.call({lexer:this},u,c))?(u=u.substring(m.raw.length),c.push(m),!0):!1))){if(m=this.tokenizer.escape(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.tag(u)){u=u.substring(m.raw.length),_=c[c.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):c.push(m);continue}if(m=this.tokenizer.link(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.reflink(u,this.tokens.links)){u=u.substring(m.raw.length),_=c[c.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):c.push(m);continue}if(m=this.tokenizer.emStrong(u,E,N)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.codespan(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.br(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.del(u)){u=u.substring(m.raw.length),c.push(m);continue}if(m=this.tokenizer.autolink(u,Uee)){u=u.substring(m.raw.length),c.push(m);continue}if(!this.state.inLink&&(m=this.tokenizer.url(u,Uee))){u=u.substring(m.raw.length),c.push(m);continue}if(b=u,this.options.extensions&&this.options.extensions.startInline){let z=1/0,G=u.slice(1),V;this.options.extensions.startInline.forEach(function(B){V=B.call({lexer:this},G),typeof V=="number"&&V>=0&&(z=Math.min(z,V))}),z<1/0&&z>=0&&(b=u.substring(0,z+1))}if(m=this.tokenizer.inlineText(b,d7e)){u=u.substring(m.raw.length),m.raw.slice(-1)!=="_"&&(N=m.raw.slice(-1)),R=!0,_=c[c.length-1],_&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):c.push(m);continue}if(u){let z="Infinite loop on byte: "+u.charCodeAt(0);if(this.options.silent){console.error(z);break}else throw new Error(z)}}return c}},dC=class{constructor(a){this.options=a||K5}code(a,u,c){let m=(u||"").match(/\S*/)[0];if(this.options.highlight){let _=this.options.highlight(a,m);_!=null&&_!==a&&(c=!0,a=_)}return a=a.replace(/\n$/,"")+`
`,m?'<pre><code class="'+this.options.langPrefix+Oo(m,!0)+'">'+(c?a:Oo(a,!0))+`</code></pre>
`:"<pre><code>"+(c?a:Oo(a,!0))+`</code></pre>
`}blockquote(a){return`<blockquote>
`.concat(a,`</blockquote>
`)}html(a){return a}heading(a,u,c,m){if(this.options.headerIds){let _=this.options.headerPrefix+m.slug(c);return"<h".concat(u,' id="').concat(_,'">').concat(a,"</h").concat(u,`>
`)}return"<h".concat(u,">").concat(a,"</h").concat(u,`>
`)}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(a,u,c){let m=u?"ol":"ul",_=u&&c!==1?' start="'+c+'"':"";return"<"+m+_+`>
`+a+"</"+m+`>
`}listitem(a){return"<li>".concat(a,`</li>
`)}checkbox(a){return"<input "+(a?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(a){return"<p>".concat(a,`</p>
`)}table(a,u){return u&&(u="<tbody>".concat(u,"</tbody>")),`<table>
<thead>
`+a+`</thead>
`+u+`</table>
`}tablerow(a){return`<tr>
`.concat(a,`</tr>
`)}tablecell(a,u){let c=u.header?"th":"td";return(u.align?"<".concat(c,' align="').concat(u.align,'">'):"<".concat(c,">"))+a+"</".concat(c,`>
`)}strong(a){return"<strong>".concat(a,"</strong>")}em(a){return"<em>".concat(a,"</em>")}codespan(a){return"<code>".concat(a,"</code>")}br(){return this.options.xhtml?"<br/>":"<br>"}del(a){return"<del>".concat(a,"</del>")}link(a,u,c){if(a=Nee(this.options.sanitize,this.options.baseUrl,a),a===null)return c;let m='<a href="'+Oo(a)+'"';return u&&(m+=' title="'+u+'"'),m+=">"+c+"</a>",m}image(a,u,c){if(a=Nee(this.options.sanitize,this.options.baseUrl,a),a===null)return c;let m='<img src="'.concat(a,'" alt="').concat(c,'"');return u&&(m+=' title="'.concat(u,'"')),m+=this.options.xhtml?"/>":">",m}text(a){return a}},OO=class{strong(a){return a}em(a){return a}codespan(a){return a}del(a){return a}html(a){return a}text(a){return a}link(a,u,c){return""+c}image(a,u,c){return""+c}br(){return""}},FO=class{constructor(){this.seen={}}serialize(a){return a.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(a,u){let c=a,m=0;if(this.seen.hasOwnProperty(c)){m=this.seen[a];do m++,c=a+"-"+m;while(this.seen.hasOwnProperty(c))}return u||(this.seen[a]=m,this.seen[c]=0),c}slug(a,u={}){let c=this.serialize(a);return this.getNextSafeSlug(c,u.dryrun)}},G9=class zG{constructor(u){this.options=u||K5,this.options.renderer=this.options.renderer||new dC,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new OO,this.slugger=new FO}static parse(u,c){return new zG(c).parse(u)}static parseInline(u,c){return new zG(c).parseInline(u)}parse(u,c=!0){let m="",_,b,E,T,R,N,z,G,V,B,j,H,X,K,te,se,pe,fe,ye,Ne=u.length;for(_=0;_<Ne;_++){if(B=u[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[B.type]&&(ye=this.options.extensions.renderers[B.type].call({parser:this},B),ye!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(B.type))){m+=ye||"";continue}switch(B.type){case"space":continue;case"hr":{m+=this.renderer.hr();continue}case"heading":{m+=this.renderer.heading(this.parseInline(B.tokens),B.depth,kee(this.parseInline(B.tokens,this.textRenderer)),this.slugger);continue}case"code":{m+=this.renderer.code(B.text,B.lang,B.escaped);continue}case"table":{for(G="",z="",T=B.header.length,b=0;b<T;b++)z+=this.renderer.tablecell(this.parseInline(B.header[b].tokens),{header:!0,align:B.align[b]});for(G+=this.renderer.tablerow(z),V="",T=B.rows.length,b=0;b<T;b++){for(N=B.rows[b],z="",R=N.length,E=0;E<R;E++)z+=this.renderer.tablecell(this.parseInline(N[E].tokens),{header:!1,align:B.align[E]});V+=this.renderer.tablerow(z)}m+=this.renderer.table(G,V);continue}case"blockquote":{V=this.parse(B.tokens),m+=this.renderer.blockquote(V);continue}case"list":{for(j=B.ordered,H=B.start,X=B.loose,T=B.items.length,V="",b=0;b<T;b++)te=B.items[b],se=te.checked,pe=te.task,K="",te.task&&(fe=this.renderer.checkbox(se),X?te.tokens.length>0&&te.tokens[0].type==="paragraph"?(te.tokens[0].text=fe+" "+te.tokens[0].text,te.tokens[0].tokens&&te.tokens[0].tokens.length>0&&te.tokens[0].tokens[0].type==="text"&&(te.tokens[0].tokens[0].text=fe+" "+te.tokens[0].tokens[0].text)):te.tokens.unshift({type:"text",text:fe}):K+=fe),K+=this.parse(te.tokens,X),V+=this.renderer.listitem(K,pe,se);m+=this.renderer.list(V,j,H);continue}case"html":{m+=this.renderer.html(B.text);continue}case"paragraph":{m+=this.renderer.paragraph(this.parseInline(B.tokens));continue}case"text":{for(V=B.tokens?this.parseInline(B.tokens):B.text;_+1<Ne&&u[_+1].type==="text";)B=u[++_],V+=`
`+(B.tokens?this.parseInline(B.tokens):B.text);m+=c?this.renderer.paragraph(V):V;continue}default:{let ze='Token with "'+B.type+'" type was not found.';if(this.options.silent){console.error(ze);return}else throw new Error(ze)}}}return m}parseInline(u,c){c=c||this.renderer;let m="",_,b,E,T=u.length;for(_=0;_<T;_++){if(b=u[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[b.type]&&(E=this.options.extensions.renderers[b.type].call({parser:this},b),E!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(b.type))){m+=E||"";continue}switch(b.type){case"escape":{m+=c.text(b.text);break}case"html":{m+=c.html(b.text);break}case"link":{m+=c.link(b.href,b.title,this.parseInline(b.tokens,c));break}case"image":{m+=c.image(b.href,b.title,b.text);break}case"strong":{m+=c.strong(this.parseInline(b.tokens,c));break}case"em":{m+=c.em(this.parseInline(b.tokens,c));break}case"codespan":{m+=c.codespan(b.text);break}case"br":{m+=c.br();break}case"del":{m+=c.del(this.parseInline(b.tokens,c));break}case"text":{m+=c.text(b.text);break}default:{let R='Token with "'+b.type+'" type was not found.';if(this.options.silent){console.error(R);return}else throw new Error(R)}}}return m}},Br.options=Br.setOptions=function(a){return Gd(Br.defaults,a),l7e(Br.defaults),Br},Br.getDefaults=Iee,Br.defaults=K5,Br.use=function(...a){let u=Gd({},...a),c=Br.defaults.extensions||{renderers:{},childTokens:{}},m;a.forEach(_=>{if(_.extensions&&(m=!0,_.extensions.forEach(b=>{if(!b.name)throw new Error("extension name required");if(b.renderer){let E=c.renderers?c.renderers[b.name]:null;E?c.renderers[b.name]=function(...T){let R=b.renderer.apply(this,T);return R===!1&&(R=E.apply(this,T)),R}:c.renderers[b.name]=b.renderer}if(b.tokenizer){if(!b.level||b.level!=="block"&&b.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");c[b.level]?c[b.level].unshift(b.tokenizer):c[b.level]=[b.tokenizer],b.start&&(b.level==="block"?c.startBlock?c.startBlock.push(b.start):c.startBlock=[b.start]:b.level==="inline"&&(c.startInline?c.startInline.push(b.start):c.startInline=[b.start]))}b.childTokens&&(c.childTokens[b.name]=b.childTokens)})),_.renderer){let b=Br.defaults.renderer||new dC;for(let E in _.renderer){let T=b[E];b[E]=(...R)=>{let N=_.renderer[E].apply(b,R);return N===!1&&(N=T.apply(b,R)),N}}u.renderer=b}if(_.tokenizer){let b=Br.defaults.tokenizer||new hC;for(let E in _.tokenizer){let T=b[E];b[E]=(...R)=>{let N=_.tokenizer[E].apply(b,R);return N===!1&&(N=T.apply(b,R)),N}}u.tokenizer=b}if(_.walkTokens){let b=Br.defaults.walkTokens;u.walkTokens=function(E){let T=[];return T.push(_.walkTokens.call(this,E)),b&&(T=T.concat(b.call(this,E))),T}}m&&(u.extensions=c),Br.setOptions(u)})},Br.walkTokens=function(a,u){let c=[];for(let m of a)switch(c=c.concat(u.call(Br,m)),m.type){case"table":{for(let _ of m.header)c=c.concat(Br.walkTokens(_.tokens,u));for(let _ of m.rows)for(let b of _)c=c.concat(Br.walkTokens(b.tokens,u));break}case"list":{c=c.concat(Br.walkTokens(m.items,u));break}default:Br.defaults.extensions&&Br.defaults.extensions.childTokens&&Br.defaults.extensions.childTokens[m.type]?Br.defaults.extensions.childTokens[m.type].forEach(function(_){c=c.concat(Br.walkTokens(m[_],u))}):m.tokens&&(c=c.concat(Br.walkTokens(m.tokens,u)))}return c},Br.parseInline=function(a,u){if(typeof a>"u"||a===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof a!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(a)+", string expected");u=Gd({},Br.defaults,u||{}),Oee(u);try{let c=Z5.lexInline(a,u);return u.walkTokens&&Br.walkTokens(c,u.walkTokens),G9.parseInline(c,u)}catch(c){if(c.message+=`
Please report this to https://github.com/markedjs/marked.`,u.silent)return"<p>An error occurred:</p><pre>"+Oo(c.message+"",!0)+"</pre>";throw c}},Br.Parser=G9,Br.parser=G9.parse,Br.Renderer=dC,Br.TextRenderer=OO,Br.Lexer=Z5,Br.lexer=Z5.lex,Br.Tokenizer=hC,Br.Slugger=FO,Br.parse=Br,Br.options,Br.setOptions,Br.use,Br.walkTokens,Br.parseInline,G9.parse,Z5.lex}),Zee,Qee,LO,Jee=I(()=>{Ft(),aC(),Qee=Te(P6)(Zee||(Zee=J([`
  padding: 6px;
`]))),LO=Qee}),za,fC,$b,pC,ete,tte,nte,UO,rte,ite,ste,BO,ate,ote,lte,ute,cte,qb,Xb,hte,dte,fte,pte,mte,gte,vte,yte,_te,xte,bte,Ste,zO,Yb=I(()=>{za=Q(qe()),o7e(),Ft(),Bi(),tr(),Ae(),f7e(),zb(),Jee(),fC=({title:a,message:u})=>"".concat(a," ").concat(u),$b=(()=>{let a=new Map;return{add:u=>{let c=fC(u);a.has(c)?a.set(c,a.get(c)+1):a.set(c,1)},delete:u=>{let c=fC(u);a.has(c)&&a.get(c)>1?a.set(c,a.get(c)-1):a.delete(c)},clear:()=>{a.clear()},check:u=>a.has(fC(u))}})(),pC=(()=>{let a=new Map;return{add:u=>{a.has(u)?a.set(u,a.get(u)+1):a.set(u,1)},delete:u=>{a.has(u)&&a.get(u)>1?a.set(u,a.get(u)-1):a.delete(u)},clear:()=>{a.clear()},check:u=>a.has(u),get types(){return Array.of(...a.keys())}}})(),tte=Te.div(ete||(ete=J([`
  width: 100%;
  border-radius: 4px;
  display: flex;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Fi),UO=Te.div(nte||(nte=J([`
  font-size: 14px;
  font-weight: bold;
  color: #fff;
`]))),ite=Te.div(rte||(rte=J([`
  flex: 1;
  flex-direction: column;
  width: 0;
  display: flex;
  padding: 16px 0;
  gap: 12px;
`]))),BO=Te.div(ste||(ste=J([`
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;

  a {
    color: rgba(255, 255, 255, 0.9);
  }

  em {
    font-style: italic;
  }

  strong {
    font-weight: bold;
    color: #d5d5d5;
  }

  p {
    margin-bottom: 8px;
  }

  code {
    font-family: monospace;
    background: rgba(0, 0, 0, 0.3);
    padding: 1px 1px 2px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    white-space: pre-wrap;
  }

  pre > code {
    white-space: pre;
    display: block;
    overflow: auto;
    padding: 4px;
  }

  pre {
    white-space: pre-wrap;
    margin-bottom: 8px;
  }
`]))),ote=Te.button(ate||(ate=J([`
  color: rgba(255, 255, 255, 0.9);
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  padding-left: 12px;
  padding-right: 12px;
  border-left: 1px solid rgba(255, 255, 255, 0.05);

  &:hover {
    background: rgba(255, 255, 255, 0.05);
  }
`]))),lte={info:"#3b82f6",success:"#10b981",warning:"#f59e0b",error:"#ef4444"},cte=Te.div(ute||(ute=J([`
  display: flex;
  justify-content: center;
  margin-left: 12px;
  padding-top: 21px;

  ::before {
    content: '';
    width: 8px;
    height: 8px;
    border-radius: 999999px;
    background-color: `,`;
  }
`])),({type:a})=>lte[a]),qb=a=>(u,c,m=[],_=!1)=>{(_||!$b.check({title:u,message:c}))&&($b.add({title:u,message:c}),pC.add(a),uC.custom(b=>za.default.createElement(tte,null,za.default.createElement(cte,{type:a}),za.default.createElement(ite,null,za.default.createElement(UO,null,u),za.default.createElement(BO,{dangerouslySetInnerHTML:{__html:Br.parse(c)}}),m.length>0&&za.default.createElement(BO,null,za.default.createElement("span",null,"Docs:"," ",m.map((E,T)=>za.default.createElement(za.Fragment,{key:T},T>0&&", ",za.default.createElement("a",{target:"_blank",href:E.url},E.title)))))),za.default.createElement(ote,{onClick:()=>{uC.remove(b.id),$b.delete({title:u,message:c}),pC.delete(a)}},"Close")),{duration:1/0}))},Xb={warning:qb("warning"),success:qb("success"),info:qb("info"),error:qb("error")},dte=Te.div(hte||(hte=J([`
  display: flex;
  justify-content: `,`;
  gap: 12px;
`])),({align:a})=>a==="center"?"center":"flex-end"),pte=Te.button(fte||(fte=J([`
  position: relative;
  border-radius: 4px;
  display: flex;
  align-items: center;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border: none;
  padding: 12px;
  color: #fff;
  overflow: hidden;

  ::before {
    content: '';
    position: absolute;
    inset: 0;
  }

  :hover::before {
    background: `,`;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Fi,({danger:a})=>a?"rgba(255, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"),gte=Te.div(mte||(mte=J([`
  z-index: 10;
  display: flex;
  flex-direction: column;
  gap: 8px;
  position: fixed;
  right: 92px;
  top: 50px;
  width: 500px;
  height: 85vh;
  min-height: 400px;
`]))),yte=Te.div(vte||(vte=J([`
  overflow: hidden;
  pointer-events: auto;
  border-radius: 4px;

  & > div {
    display: flex;
    flex-direction: column-reverse;
    gap: 8px;
    overflow: scroll;
    height: 100%;
  }
`]))),xte=Te.div(_te||(_te=J([`
  width: fit-content;
  padding: 8px;
  border-radius: 4px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;
`]))),bte=()=>{let{hasNotifications:a}=zO();return A6({enabled:!a},()=>za.default.createElement(LO,null,za.default.createElement(xte,null,za.default.createElement(UO,null,"No notifications"),"Notifications will appear here when you get them.")))},Ste=()=>{var a;let{toasts:u,handlers:c}=NO(),{startPause:m,endPause:_}=c,b=(a=qr(Se().atomP.ahistoric.pinNotifications))!=null?a:!1;return za.default.createElement(gte,null,b?u.length>0&&za.default.createElement(yte,{onMouseEnter:m,onMouseLeave:_},za.default.createElement("div",null,u.map(E=>za.default.createElement("div",{key:E.id},E.message(E))))):null,za.default.createElement(dte,{align:"side"},b&&u.length>0&&za.default.createElement(pte,{onClick:()=>{pC.clear(),$b.clear(),uC.remove()},danger:!0},"Clear")))},zO=()=>{let{toasts:a}=NO();return{hasNotifications:a.length>0}}});function VO(a,u){var c;let m=Object.values((c=(0,wte.val)(a.pointers.historic.sheetsById))!=null?c:{}),_=m.flatMap(E=>{var T;return Object.values((T=E==null?void 0:E.staticOverrides.byObject)!=null?T:{})}).flatMap(E=>Object.values(E??{})),b=[...m.flatMap(E=>{var T,R;return Object.values((R=(T=E==null?void 0:E.sequence)==null?void 0:T.tracksByObject)!=null?R:{})}).flatMap(E=>{var T;return Object.values((T=E==null?void 0:E.trackData)!=null?T:{})}).flatMap(E=>E==null?void 0:E.keyframes).map(E=>E==null?void 0:E.value)];return _.forEach(E=>{lt(E,T=>{b.push(T)},[])}),b.filter(E=>(E==null?void 0:E.type)&&typeof(E==null?void 0:E.type)=="string").map(E=>E.id).filter((E,T,R)=>E!==null&&E!==""&&R.indexOf(E)===T)}var wte,Ete=I(()=>{wte=mn(),_t()});function Tte(a,u){let c=new File([a],u),m=URL.createObjectURL(c),_=Object.assign(document.createElement("a"),{href:m,target:"_blank",rel:"noopener"});_.setAttribute("download",u),_.click(),setTimeout(()=>{URL.revokeObjectURL(m)},4e4)}var fc,Mte,Cte,Ate,Pte,Rte,Ite,kte,Nte,Dte,p7e=I(()=>{Ae(),Tp(),wp(),fc=Q(qe()),Ft(),ZJ(),s7e(),Mte=Q(a7e()),Yb(),Ete(),Ate=Te.div(Cte||(Cte=J([""]))),Rte=Te.div(Pte||(Pte=J([`
  padding: 8px 10px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
`]))),kte=Te(Ep)(Ite||(Ite=J([`
  display flex;
  flex-direction: column;
  gap: 1em;
  width: 280px;
  padding: 1em;
`]))),Nte=({projects:a})=>{let u=a[0],c=u.address.projectId,m=c.replace(/[^\w\d'_\-]+/g," ").trim(),_="".concat(m,".theatre-project-state.json"),[b,E]=(0,fc.useState)(!1),T=(0,fc.useCallback)(()=>Be(void 0,null,function*(){var N,z;let G=VO(u),V=new Map;try{yield Promise.all(G.map(j=>Be(void 0,null,function*(){let H=u.assetStorage.getAssetUrl(j),X=yield fetch(H);X.ok&&V.set(j,yield X.blob())})))}catch{Xb.error("Failed to access assets","Export aborted. Failed to access assets at ".concat((z=(N=u.config.assets)==null?void 0:N.baseUrl)!=null?z:"/",". This is likely due to a CORS issue."));return}if(V.size>0){let j=new Mte.default;for(let[X,K]of V)j.file(X,K);let H=yield j.generateAsync({type:"blob"});Tte(H,"".concat(m,".assets.zip"))}let B=JSON.stringify(Se().createContentOfSaveFile(u.address.projectId),null,2);Tte(B,_),E(!0),setTimeout(()=>{E(!1)},2e3)}),[u,_]),R=Sp({debugName:"ProjectDetails",pointerDistanceThreshold:50},()=>fc.default.createElement(kte,null,fc.default.createElement("p",null,"This will create a JSON file with the state of your project. You can commit this file to your git repo and include it in your production bundle."),fc.default.createElement("p",null,"If your project uses assets, this will also create a zip file with all the assets that you can unpack in your public folder."),fc.default.createElement("a",{href:"https://www.theatrejs.com/docs/latest/manual/projects#state",target:"_blank"},"Here is a quick guide on how to export to production.")));return fc.default.createElement(fc.default.Fragment,null,R.node,fc.default.createElement(Ate,null,fc.default.createElement(xee,{projectId:c}),fc.default.createElement(Rte,null,fc.default.createElement(iC,{onMouseEnter:N=>R.open(N,N.target),onClick:b?void 0:T,disabled:b},b?"(Exported)":"Export ".concat(c," to JSON")))))},Dte=Nte}),H9,Ote,Fte,Lte,Ute,Bte,zte,Vte,Gte,Hte,jte,m7e=I(()=>{H9=Q(qe()),Ft(),db(),Fte=Te.div(Ote||(Ote=J([`
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 24px;
`]))),Ute=Te.div(Lte||(Lte=J([`
  display: flex;
  flex-direction: column;
  gap: 11px;
  color: rgba(255, 255, 255, 0.9);
`]))),zte=Te.div(Bte||(Bte=J([`
  color: rgba(145, 145, 145, 0.8);
`]))),Gte=Te.a(Vte||(Vte=J([`
  color: #919191;
  font-size: 10px;
  text-decoration-color: #40434a;
  text-underline-offset: 3px;
`]))),Hte=()=>H9.default.createElement(Fte,null,H9.default.createElement(Ute,null,H9.default.createElement(zte,null,H9.default.createElement(aD,null)),H9.default.createElement("div",null,"Please select an object from the ",H9.default.createElement("u",null,"Outline Menu")," to see its properties.")),H9.default.createElement(Gte,{href:"https://www.theatrejs.com/docs/latest/manual/objects",target:"_blank"},"Learn more about Objects")),jte=Hte});function Wte(){let[a,u]=(0,GO.useState)(!1),c=(0,GO.useMemo)(()=>{let m=new Set;return()=>{let _=()=>{m.delete(_),u(m.size>0)};return m.add(_),u(!0),_}},[]);return[a,c]}var GO,$te=I(()=>{GO=Q(qe())}),Ns,I6,qte,Xte,mC,Yte,HO,Kte,jO,Zte,WO,Kb,Qte,Jte,gC,Q5,$O=I(()=>{N9(),tr(),Ns=Q(qe()),Ft(),oi(),Om(),Bi(),n7e(),p7e(),Ae(),OX(),I6=mn(),m7e(),$te(),X5(),qte="32px",mC=Te.div(Xte||(Xte=J([`
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  position: fixed;
  right: 8px;
  top: 50px;
  // Temporary, see comment about CSS grid in SingleRowPropEditor.
  width: 280px;
  height: fit-content;
  z-index: `,`;

  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border-radius: 2px;

  display: `,`;

  &:hover {
    display: block;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Fi,d6.propsPanel,({pin:a})=>a?"block":"none"),HO=Te.div(Yte||(Yte=J([`
  margin: 0 10px;
  color: #919191;
  font-weight: 500;
  font-size: 10px;
  user-select: none;
  `,`;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`])),Fi),jO=Te.div(Kte||(Kte=J([`
  height: `,`;
  display: flex;
  align-items: center;
`])),qte),WO=Te.div(Zte||(Zte=J([`
  `,`;
  max-height: calc(100vh - 100px);
  overflow-y: scroll;
  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
  padding: 0;
  user-select: none;

  /* Set the font-size for input values in the detail panel */
  font-size: 12px;
`])),Fi),Kb=(0,Ns.createContext)([!1,()=>()=>{}]),Qte=a=>{let u=qr(Se().atomP.ahistoric.pinDetails)!==!1,c=DX("right");(0,Ns.useLayoutEffect)(()=>{gC.set(c)},[c]),(0,Ns.useEffect)(()=>()=>{Q5.set(!1),gC.set(!1)},[]);let[m]=(0,Ns.useContext)(Kb),_=u||c||m,[b,E]=(0,Ns.useState)(null);return yQ(b),Gr(()=>{let T=k9(),R=T.find(qt);if(R)return Ns.default.createElement(mC,{"data-testid":"DetailPanel-Object",pin:_,ref:E,onMouseEnter:()=>{Q5.set(!0)},onMouseLeave:()=>{Q5.set(!1)}},Ns.default.createElement(jO,null,Ns.default.createElement(HO,{title:"".concat(R.sheet.address.sheetId,": ").concat(R.sheet.address.sheetInstanceId," > ").concat(R.address.objectKey)},Ns.default.createElement(I9,null,R.sheet.address.sheetId," "),Ns.default.createElement(hb,null,":",""),Ns.default.createElement(I9,null,R.sheet.address.sheetInstanceId," "),Ns.default.createElement(hb,null,""),Ns.default.createElement(I9,null,R.address.objectKey))),Ns.default.createElement(WO,null,Ns.default.createElement(XJ,{objects:[R]})));let N=T.find(dt);return N?Ns.default.createElement(mC,{pin:_},Ns.default.createElement(jO,null,Ns.default.createElement(HO,{title:"".concat(N.address.projectId)},Ns.default.createElement(I9,null,N.address.projectId," "))),Ns.default.createElement(WO,null,Ns.default.createElement(Dte,{projects:[N]}))):Ns.default.createElement(mC,{pin:_,onMouseEnter:()=>{Q5.set(!0)},onMouseLeave:()=>{Q5.set(!1)}},Ns.default.createElement(jte,null))},[_])},Jte=()=>{let a=Wte();return Ns.default.createElement(Kb.Provider,{value:a},Ns.default.createElement(Qte,null))},gC=new I6.Atom(!1),Q5=new I6.Atom(!1),(0,I6.prism)(()=>{let a=(0,I6.val)(Q5.prism),u=(0,I6.val)(gC.prism);return a||u})}),qO,vC,yC,XO,k6,ene,YO,N6=I(()=>{qO=mn(),tr(),Ae(),$te(),vC=Q(qe()),QD(),yC=(a,u)=>{let c=a.left/u.width,m=(a.left+a.width)/u.width,_=a.top/u.height,b=(a.height+a.top)/u.height;return{edges:{left:c<=.5?{from:"screenLeft",distance:c}:{from:"screenRight",distance:1-c},right:m<=.5?{from:"screenLeft",distance:m}:{from:"screenRight",distance:1-m},top:_<=.5?{from:"screenTop",distance:_}:{from:"screenBottom",distance:1-_},bottom:b<=.5?{from:"screenTop",distance:b}:{from:"screenBottom",distance:1-b}}}},XO=vC.default.createContext(null),k6=()=>(0,vC.useContext)(XO),ene=({panelId:a,children:u,defaultPosition:c,minDims:m})=>{let _=FM(800,200),[b,E]=Wte(),{stuff:T}=Gr(()=>{var R;let{edges:N}=(R=(0,qO.val)(Se().atomP.historic.panelPositions[a]))!=null?R:c,z=Math.floor(_.width*(N.left.from==="screenLeft"?N.left.distance:1-N.left.distance)),G=Math.floor(_.width*(N.right.from==="screenLeft"?N.right.distance:1-N.right.distance)),V=Math.floor(_.height*(N.top.from==="screenTop"?N.top.distance:1-N.top.distance)),B=Math.floor(_.height*(N.bottom.from==="screenTop"?N.bottom.distance:1-N.bottom.distance)),j=Math.max(G-z,m.width),H=Math.max(B-V,m.height);return{stuff:{dims:qO.prism.memo("dims",()=>({width:j,left:z,top:V,height:H}),[j,z,V,H]),panelId:a,minDims:m,boundsHighlighted:b,addBoundsHighlightLock:E}}},[a,_,b,E]);return vC.default.createElement(XO.Provider,{value:T},u)},YO=ene}),Zb,tne,nne,rne,KO,ine=I(()=>{Ui(),Ae(),Qa(),Zb=Q(qe()),Ft(),N6(),dc(),Ua(),Om(),nne=Te.div(tne||(tne=J([`
  cursor: move;
`]))),rne=a=>{let u=k6(),c=(0,Zb.useRef)(u);c.current=u;let[m,_]=Ii(null),b=(0,Zb.useMemo)(()=>({debugName:"PanelDragZone",lockCursorTo:"move",onDragStart(){let N=c.current,z,G=u.addBoundsHighlightLock();return{onDrag(V,B){let j=$(P({},N.dims),{top:ii(N.dims.top+B,0,window.innerHeight-yp),left:ii(N.dims.left+V,-N.dims.width+yp,window.innerWidth-yp)}),H=yC(j,{width:window.innerWidth,height:window.innerHeight});z==null||z.discard(),z=Se().tempTransaction(({stateEditors:X})=>{X.studio.historic.panelPositions.setPanelPosition({position:H,panelId:N.panelId})})},onDragEnd(V){G(),V?z==null||z.commit():z==null||z.discard()}}}}),[]),[E]=fa(_,b);mh(E,"dragging","move");let[T,R]=(0,Zb.useMemo)(()=>{let N;return[function(){if(N){let z=N;N=void 0,z()}N=u.addBoundsHighlightLock()},function(){if(N){let z=N;N=void 0,z()}}]},[]);return Zb.default.createElement(nne,$(P({},a),{ref:m,onMouseEnter:T,onMouseLeave:R}))},KO=rne}),_C,sne,ZO,ane,QO,one,JO,lne,une,cne,hne,dne,eF,fne,pne,mne,gne,vne,Qb,yne,_ne,xne,bne,Sne,wne,Ene,Tne,Mne,tF,Cne,jm,g7e=I(()=>{Ui(),Ae(),Qa(),hc(),_C=Q(qe()),Ft(),N6(),Bi(),Ua(),Om(),ZO=Te.div(sne||(sne=J([`
  position: absolute;
  `,`;
  &:after {
    position: absolute;
    inset: -5px;
    display: block;
    content: ' ';
  }

  opacity: 0;
  background-color: #478698;

  &.isHighlighted {
    opacity: 0.7;
  }

  &.isDragging {
    opacity: 1;
    /* background-color: `,`; */
  }

  &:hover {
    opacity: 1;
  }
`])),Fi,i6(.2,"#478698")),QO=Te(ZO)(ane||(ane=J([`
  /**
  The horizintal/vertical resize handles have z-index:-1 and are offset 1px outside of the panel
  to make sure they don't occlude any element that pops out of the panel (like the Playhead in SequenceEditorPanel).

  This means that panels will always need an extra 1px margin for their resize handles to be visible, but that's not a problem
  that we have to deal with right now (if it is at all a problem).
  
   */
  z-index: -1;
`]))),JO=Te(QO)(one||(one=J([`
  left: 0px;
  right: 0px;
  height: 1px;
`]))),une=Te(JO)(lne||(lne=J([`
  top: -1px;
`]))),hne=Te(JO)(cne||(cne=J([`
  bottom: -1px;
`]))),eF=Te(QO)(dne||(dne=J([`
  z-index: -1;
  top: -1px;
  bottom: -1px;
  width: 1px;
`]))),pne=Te(eF)(fne||(fne=J([`
  left: -1px;
`]))),gne=Te(eF)(mne||(mne=J([`
  right: -1px;
`]))),Qb=Te(ZO)(vne||(vne=J([`
  // The angles have z-index: 10 to make sure they _do_ occlude other elements in the panel.
  z-index: 10;
  width: 8px;
  height: 8px;
`]))),_ne=Te(Qb)(yne||(yne=J([`
  top: 0;
  left: 0;
`]))),bne=Te(Qb)(xne||(xne=J([`
  top: 0;
  right: 0;
`]))),wne=Te(Qb)(Sne||(Sne=J([`
  bottom: 0;
  left: 0;
`]))),Tne=Te(Qb)(Ene||(Ene=J([`
  bottom: 0;
  right: 0;
`]))),Mne={Top:une,TopLeft:_ne,TopRight:bne,Bottom:hne,BottomLeft:wne,BottomRight:Tne,Left:pne,Right:gne},tF={Top:"ns-resize",Bottom:"ns-resize",Left:"ew-resize",Right:"ew-resize",TopLeft:"nw-resize",TopRight:"ne-resize",BottomLeft:"sw-resize",BottomRight:"se-resize"},Cne=({which:a})=>{let u=k6(),c=(0,_C.useRef)(u);c.current=u;let[m,_]=Ii(null),b=(0,_C.useMemo)(()=>({debugName:"PanelResizeHandle",lockCursorTo:tF[a],onDragStart(){let N,z=c.current,G=u.addBoundsHighlightLock();return{onDrag(V,B){let j=P({},z.dims);if(a.startsWith("Bottom"))j.height=Math.max(j.height+B,z.minDims.height);else if(a.startsWith("Top")){let X=j.top+j.height,K=ii(j.top+B,0,Math.min(X-z.minDims.height,window.innerHeight-yp)),te=X-K;j.height=te,j.top=K}if(a.endsWith("Left")){let X=j.left+j.width,K=Math.min(j.left+V,Math.min(X-z.minDims.width,window.innerWidth-yp)),te=X-K;j.width=te,j.left=K}else a.endsWith("Right")&&(j.width=Math.max(j.width+V,Math.max(z.minDims.width,yp-z.dims.left)));let H=yC(j,{width:window.innerWidth,height:window.innerHeight});N==null||N.discard(),N=Se().tempTransaction(({stateEditors:X})=>{X.studio.historic.panelPositions.setPanelPosition({position:H,panelId:z.panelId})})},onDragEnd(V){G(),V?N==null||N.commit():N==null||N.discard()}}}}),[a]),[E]=fa(_,b),T=Mne[a],R=a.length<=6;return _C.default.createElement(T,{ref:m,className:[E?"isDragging":"",u.boundsHighlighted&&R?"isHighlighted":""].join(" "),style:{cursor:tF[a]}})},jm=Cne}),Hd,Ane,Pne,v7e=I(()=>{Hd=Q(qe()),g7e(),Ane=a=>Hd.default.createElement(Hd.default.Fragment,null,Hd.default.createElement(jm,{which:"Bottom"}),Hd.default.createElement(jm,{which:"Top"}),Hd.default.createElement(jm,{which:"Left"}),Hd.default.createElement(jm,{which:"Right"}),Hd.default.createElement(jm,{which:"TopLeft"}),Hd.default.createElement(jm,{which:"TopRight"}),Hd.default.createElement(jm,{which:"BottomLeft"}),Hd.default.createElement(jm,{which:"BottomRight"})),Pne=Ane}),xC,Rne,Ine,kne,nF,Nne=I(()=>{Bi(),xC=Q(qe()),Ft(),N6(),v7e(),Ine=Te.div(Rne||(Rne=J([`
  position: absolute;
  user-select: none;
  box-sizing: border-box;
  `,`;
  /* box-shadow: 1px 2px 10px -5px black; */

  z-index: 1000;
`])),Fi),kne=xC.default.forwardRef((a,u)=>{let c=k6(),m=a,{style:_,children:b}=m,E=Z(m,["style","children"]);return xC.default.createElement(Ine,$(P({ref:u},E),{style:P({width:c.dims.width+"px",height:c.dims.height+"px",top:c.dims.top+"px",left:c.dims.left+"px"},_??{})}),xC.default.createElement(Pne,null),b)}),nF=kne}),y7e=ie((a,u)=>{(function(c,m){typeof a=="object"&&typeof u<"u"?m(a,qe()):(c=typeof globalThis<"u"?globalThis:c||self,m(c.ReactErrorBoundary={},c.React))})(a,function(c,m){function _(B){if(B&&B.__esModule)return B;var j=Object.create(null);return B&&Object.keys(B).forEach(function(H){if(H!=="default"){var X=Object.getOwnPropertyDescriptor(B,H);Object.defineProperty(j,H,X.get?X:{enumerable:!0,get:function(){return B[H]}})}}),j.default=B,Object.freeze(j)}var b=_(m);function E(B,j){return E=Object.setPrototypeOf||function(H,X){return H.__proto__=X,H},E(B,j)}function T(B,j){B.prototype=Object.create(j.prototype),B.prototype.constructor=B,E(B,j)}var R=function(B,j){return B===void 0&&(B=[]),j===void 0&&(j=[]),B.length!==j.length||B.some(function(H,X){return!Object.is(H,j[X])})},N={error:null},z=function(B){T(j,B);function j(){for(var X,K=arguments.length,te=new Array(K),se=0;se<K;se++)te[se]=arguments[se];return X=B.call.apply(B,[this].concat(te))||this,X.state=N,X.updatedWithError=!1,X.resetErrorBoundary=function(){for(var pe,fe=arguments.length,ye=new Array(fe),Ne=0;Ne<fe;Ne++)ye[Ne]=arguments[Ne];X.props.onReset==null||(pe=X.props).onReset.apply(pe,ye),X.reset()},X}j.getDerivedStateFromError=function(X){return{error:X}};var H=j.prototype;return H.reset=function(){this.updatedWithError=!1,this.setState(N)},H.componentDidCatch=function(X,K){var te,se;(te=(se=this.props).onError)==null||te.call(se,X,K)},H.componentDidMount=function(){var X=this.state.error;X!==null&&(this.updatedWithError=!0)},H.componentDidUpdate=function(X){var K=this.state.error,te=this.props.resetKeys;if(K!==null&&!this.updatedWithError){this.updatedWithError=!0;return}if(K!==null&&R(X.resetKeys,te)){var se,pe;(se=(pe=this.props).onResetKeysChange)==null||se.call(pe,X.resetKeys,te),this.reset()}},H.render=function(){var X=this.state.error,K=this.props,te=K.fallbackRender,se=K.FallbackComponent,pe=K.fallback;if(X!==null){var fe={error:X,resetErrorBoundary:this.resetErrorBoundary};if(b.isValidElement(pe))return pe;if(typeof te=="function")return te(fe);if(se)return b.createElement(se,fe);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},j}(b.Component);function G(B,j){var H=function(K){return b.createElement(z,j,b.createElement(B,K))},X=B.displayName||B.name||"Unknown";return H.displayName="withErrorBoundary("+X+")",H}function V(B){var j=b.useState(null),H=j[0],X=j[1];if(B!=null)throw B;if(H!=null)throw H;return X}c.ErrorBoundary=z,c.useErrorHandler=V,c.withErrorBoundary=G,Object.defineProperty(c,"__esModule",{value:!0})})}),s0,Dne,One,Fne,Lne,Une,Bne,zne,Vne,Gne,Hne,jne,Wne,$ne,qne,Xne,Yne,Kne,Zne,Qne,_7e=I(()=>{s0=Q(qe()),Ft(),Om(),N6(),ine(),Nne(),Dne=Q(y7e()),x6(),Ae(),Om(),One={edges:{left:{from:"screenLeft",distance:.3},right:{from:"screenRight",distance:.3},top:{from:"screenTop",distance:.3},bottom:{from:"screenBottom",distance:.3}}},Fne={width:300,height:300},Lne=({paneInstance:a})=>s0.default.createElement(YO,{panelId:"pane-".concat(a.instanceId),defaultPosition:One,minDims:Fne},s0.default.createElement(Zne,{paneInstance:a})),Bne=Te(nF)(Une||(Une=J([`
  display: flex;
  flex-direction: column;

  box-shadow: 0px 5px 12px -4px rgb(0 0 0 / 22%);
  z-index: `,`;
`])),d6.pluginPanes),Vne=Te.div(zne||(zne=J([`
  width: 100%;
`]))),Hne=Te.div(Gne||(Gne=J([`
  display: flex;
  align-items: center;
  opacity: 1;
  position: absolute;
  right: 4px;
  top: 0;
  bottom: 0;
`]))),Wne=Te.button(jne||(jne=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 2px;
  font-size: 11px;
  height: 10px;
  width: 18px;
  color: #adadadb3;
  background: transparent;
  border: none;
  cursor: pointer;
  &:hover {
    color: white;
  }
`]))),qne=Te(Nq)($ne||($ne=J([`
  position: relative;
  overflow: hidden;

  &:after {
    z-index: 10;
    position: absolute;
    inset: 0;
    display: block;
    content: ' ';
    pointer-events: none;

    #pointer-root:not(.normal) & {
      pointer-events: auto;
    }
  }
`]))),Yne=Te.div(Xne||(Xne=J([`
  padding: 12px;

  & > pre {
    border: 1px solid #ff62624f;
    background-color: rgb(255 0 0 / 5%);
    margin: 8px 0;
    padding: 8px;
    font-family: monospace;
    overflow: scroll;
    color: #ff9896;
  }
`]))),Kne=a=>s0.default.createElement(Yne,null,"An Error occurred rendering this pane. Open the console for more info.",s0.default.createElement("pre",null,JSON.stringify({message:a.error.message,stack:a.error.stack},null,2))),Zne=({paneInstance:a})=>{let[u,c]=(0,s0.useState)(null),m=a.definition.mount;(0,s0.useLayoutEffect)(()=>{if(!u)return;let b=m({paneId:a.instanceId,node:u});if(typeof b=="function")return b},[u,m,a.instanceId]);let _=(0,s0.useCallback)(()=>{Se().paneManager.destroyPane(a.instanceId)},[a]);return s0.default.createElement(Bne,{"data-testid":"theatre-pane-wrapper-".concat(a.instanceId)},s0.default.createElement(KO,null,s0.default.createElement(iD,null,s0.default.createElement(Hne,null,s0.default.createElement(Wne,{onClick:_,title:"Close Pane"},s0.default.createElement(Sye,null))),s0.default.createElement(Vne,null,a.instanceId))),s0.default.createElement(Dne.ErrorBoundary,{FallbackComponent:Kne},s0.default.createElement(qne,{"data-testid":"theatre-pane-content-".concat(a.instanceId),ref:c})))},Qne=Lne}),rF,iF,Jne=I(()=>{rF=mn(),iF=(a,u)=>{let c=rF.prism.memo(a,()=>new rF.Atom(u),[]);return c.set(u),c}});function ere(a,u){(0,tre.useLayoutEffect)(()=>{if(!a||u.type!=="propWithChildren"&&u.type!=="primitiveProp"&&u.type!=="sheetObject")return;let c=null,m=$(P({},u.sheetObject.address),{pathToProp:u.type==="sheetObject"?[]:u.pathToProp});function _(){c=JM.replaceLock(m,()=>{})}function b(){c==null||c()}return a.addEventListener("mouseenter",_),a.addEventListener("mouseleave",b),()=>{c==null||c(),a.removeEventListener("mouseenter",_),a.removeEventListener("mouseleave",b)}},[a])}var tre,nre=I(()=>{tre=Q(qe()),SO()}),j9,rre,sF,ire,aF,sre,oF,are,ore,lre,ure,cre,hre,dre,bC,SC=I(()=>{Bi(),j9=Q(qe()),x6(),Ft(),$5(),nre(),sF=Te.li(rre||(rre=J([`
  --depth: `,`;
  margin: 0;
  padding: 0;
  list-style: none;
`])),a=>a.depth),aF=Te.div(ire||(ire=J([`
  border-bottom: 1px solid #7695b705;
`]))),oF=Te(aF)(sre||(sre=J([`
  padding-left: calc(8px + var(--depth) * 20px);

  display: flex;
  align-items: stretch;
  color: `,`;

  box-sizing: border-box;

  `,`;
`])),h6.panel.body.compoudThing.label.color,a=>a.isSelected&&"background: blue"),ore=Te.span(are||(are=J([`
  `,`;
  overflow-x: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding-right: 4px;
  line-height: 26px;
  flex-wrap: nowrap;

  `,`:hover & {
    color: #ccc;
  }
`])),U9,oF),ure=Te.span(lre||(lre=J([`
  width: 12px;
  padding: 8px;
  font-size: 9px;
  display: flex;
  align-items: center;

  transition: transform 0.05s ease-out, color 0.1s ease-out;
  transform: rotateZ(`,`deg);
  color: #66686a;

  &:hover {
    transform: rotateZ(`,`deg);
    color: #c0c4c9;
  }
`])),a=>a.isCollapsed?0:90,a=>a.isCollapsed?15:75),hre=Te.ul(cre||(cre=J([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),dre=({leaf:a,label:u,children:c,isSelectable:m,isSelected:_,toggleSelect:b,toggleCollapsed:E,isCollapsed:T})=>{let R=Array.isArray(c)&&c.length>0,N=(0,j9.useRef)(null);return ere(N.current,a),a.shouldRender?j9.default.createElement(sF,{depth:a.depth},j9.default.createElement(oF,{ref:N,style:{height:a.nodeHeight+"px"},isSelectable:m===!0,isSelected:_===!0,onClick:b,isEven:a.n%2===0},j9.default.createElement(ure,{isCollapsed:T,onClick:E},j9.default.createElement(MY,null)),j9.default.createElement(ore,null,u)),R&&j9.default.createElement(hre,null,c)):null},bC=dre});function x7e(a,u){return u.every((c,m)=>c===a[m])}function b7e(a,u){if(a.length!==u.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==u[c])return!1;return!0}function wC(a){var u;let c=[];for(;;){let m=c.length,_=(u=a[0])==null?void 0:u[m];if(_===void 0)return c;for(let b of a)if(_!==b[m])return c;c.push(_)}}var Pp,EC,Rp=I(()=>{BM(),Pp=Tb(a=>JSON.stringify(a)),EC=a=>JSON.parse(a)});function S7e(a,u){let c=(0,lF.useRef)({combo:a,listener:u});c.current={combo:a,listener:u},(0,lF.useEffect)(()=>{function m(E){E.key===c.current.combo&&c.current.listener({down:!0,event:E})}function _(E){E.key===c.current.combo&&c.current.listener({down:!1,event:E})}function b(E){c.current.listener({down:!1,event:void 0})}return document.addEventListener("keydown",m),document.addEventListener("keyup",_),window.addEventListener("blur",b),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",_),window.removeEventListener("blur",b)}},[])}var lF,w7e=I(()=>{lF=Q(qe())});function fre(a){let[u,c]=(0,pre.useState)(!1);return S7e(a,({down:m})=>{c(m)}),u}var pre,mre=I(()=>{pre=Q(qe()),w7e()});function E7e(a){let u=(0,uF.useMemo)(()=>new gre.Atom(a),[]);return(0,uF.useLayoutEffect)(()=>{u.set(a)},[a]),u}var gre,uF,T7e=I(()=>{gre=mn(),uF=Q(qe())});function vre(a,u,c){let m=(0,cF.pointer)({root:{},path:[]}),_=u(m);Sm(a,(0,cF.getPointerParts)(_).path,c)}var cF,M7e=I(()=>{cF=mn(),Vy()}),TC,yre,Ml,jd=I(()=>{TC="data-pos",yre={checkIfMouseEventSnapToPos(a,u){let c=a.composedPath().find(m=>m instanceof Element&&m!==(u==null?void 0:u.ignore)&&m.hasAttribute(TC));if(c){let m=parseFloat(c.getAttribute(TC));if(isFinite(m))return m}return null},includePositionSnapAttrs(a){return{[TC]:a}}},Ml=yre});function MC(a){let u=a.type==="sheet"?A7e(a):hF(a);return{byPosition:C7e(u),tracks:u}}function C7e(a){let u=new Map;for(let c of a)for(let m of c.data.keyframes){let _=u.get(m.position);_||(_=[],u.set(m.position,_)),_.push({kf:m,track:c,itemKey:go.forTrackKeyframe(c.sheetObject,c.id,m.id)})}return u}function A7e(a){return a.children.flatMap(hF)}function hF(a){return a.children.flatMap(u=>u.type==="propWithChildren"?hF(u):P7e(u))}function P7e(a){let u=a.sheetObject,c=u.address.projectId,m=Se().atomP.historic.coreByProject[c].sheetsById[u.address.sheetId].sequence.tracksByObject[u.address.objectKey],_=(0,CC.val)(m.trackIdByPropPath[Pp(a.pathToProp)]);if(!_)return[];let b=(0,CC.val)(m.trackData[_]);return b?[{id:_,data:b,sheetObject:u}]:[]}function R7e(a,u){return dp(a.children.flatMap(c=>dF(c,u)))}function dF(a,u){return dp(a.children.flatMap(c=>c.type==="propWithChildren"?dF(c,u):I7e(c,u)))}function I7e(a,u){var c,m;let _=a.sheetObject,b=_.address.projectId,E=Se().atomP.historic.coreByProject[b].sheetsById[_.address.sheetId].sequence.tracksByObject[_.address.objectKey],T=(0,CC.val)(E.trackIdByPropPath[Pp(a.pathToProp)]);return T?(m=(c=u[_.address.objectKey])==null?void 0:c[T])!=null?m:[]:[]}var CC,D6=I(()=>{Ae(),CC=mn(),Gm(),Rp(),Ua()});function k7e(a,u){let[c,m]=Ii(null),_=D9("useCaptureSelection");return fa(u,(0,O6.useMemo)(()=>({debugName:"DopeSheetSelectionView/useCaptureSelection",dontBlockMouseDown:!0,lockCSSCursorTo:"cell",onDragStart(b){if(!b.shiftKey||b.target instanceof HTMLInputElement)return!1;let E=u.getBoundingClientRect(),T=b.clientX-E.left-(0,vh.val)(a.scaledSpace.leftPadding),R=(0,vh.val)(a.scaledSpace.toUnitSpace)(T);return c.current={h:[R,R],v:[b.clientY-E.top,b.clientY-E.top]},(0,vh.val)(a.selectionAtom).set({current:void 0}),{onDrag(N,z,G){let V=u.getBoundingClientRect(),B=G.clientX-V.left-(0,vh.val)(a.scaledSpace.leftPadding),j=(0,vh.val)(a.scaledSpace.toUnitSpace)(B);c.current={h:[c.current.h[0],j],v:[c.current.v[0],G.clientY-V.top]};let H=fF.boundsToSelection(_,(0,vh.val)(a),c.current);(0,vh.val)(a.selectionAtom).set({current:H})},onDragEnd(N){c.current=null}}}}),[a,u,c])),m}var vh,O6,W9,_re,xre,bre,fF,Sre,wre,pF,Ere,Tre,N7e=I(()=>{Ae(),Qa(),mre(),T7e(),M7e(),Ui(),tr(),vh=mn(),O6=Q(qe()),Ft(),jd(),D6(),O9(),W9=5,xre=Te.div(_re||(_re=J([`
  cursor: `,`;
`])),a=>a.isShiftDown?"cell":"default"),bre=({layoutP:a,children:u,height:c})=>{let[m,_]=Ii(null),b=fre("Shift"),E=k7e(a,_),T=(0,O6.useRef)(E);return T.current=E,O6.default.createElement(xre,{style:{height:c+"px"},ref:m,isShiftDown:b,className:"selectionview"},E&&O6.default.createElement(Ere,{state:E,layoutP:a}),u)},(a=>{let u=(E,T,R,N,z)=>{let G=MC(R);if(R.top+R.nodeHeight/2+W9>N.v[0]&&R.top+R.nodeHeight/2-W9<N.v[1])for(let[V,B]of G.byPosition){let j=T.scaledSpace.toUnitSpace(W9);if(!(V+j<=N.h[0]||V-j>=N.h[1]))for(let H of B)vre(z,X=>X[H.track.sheetObject.address.objectKey].byTrackId[H.track.id].byKeyframeId[H.kf.id],!0)}m(E,T,R,N,z)},c={sheet(E,T,R,N,z){u(E,T,R,N,z)},propWithChildren(E,T,R,N,z){u(E,T,R,N,z)},sheetObject(E,T,R,N,z){u(E,T,R,N,z)},primitiveProp(E,T,R,N,z){let{sheetObject:G,trackId:V}=R,B=(0,vh.val)(Se().atomP.historic.coreByProject[G.address.projectId].sheetsById[G.address.sheetId].sequence.tracksByObject[G.address.objectKey].trackData[V]);if(!(N.v[0]>R.top+R.heightIncludingChildren/2+W9||R.top+R.heightIncludingChildren/2-W9>N.v[1])){for(let j of B.keyframes)if(!(j.position+T.scaledSpace.toUnitSpace(W9)<=N.h[0])){if(j.position-T.scaledSpace.toUnitSpace(W9)>=N.h[1])break;vre(z,H=>H[G.address.objectKey].byTrackId[V].byKeyframeId[j.id],!0)}}}},m=(E,T,R,N,z)=>{if("children"in R)for(let G of R.children)_(E,T,G,N,z)};function _(E,T,R,N,z){if(!R.shouldRender||N.v[0]>R.top+R.heightIncludingChildren||R.top>N.v[1])return;let G=c[R.type];G?G(E,T,R,N,z):m(E,T,R,N,z)}function b(E,T,R){let N={};R=pF(R);let z=T.tree;_(E.utilFor.internal(),T,z,R,N);let G=T.tree.sheet;return{type:"DopeSheetSelection",byObjectKey:N,getDragHandlers(V){return{debugName:"DopeSheetSelectionView/boundsToSelection",onDragStart(){let B,j=T.scaledSpace.toUnitSpace;return{onDrag(H,X,K){B&&(B.discard(),B=void 0);let te=Ml.checkIfMouseEventSnapToPos(K,{ignore:V.domNode}),se=te!=null?te-V.positionAtStartOfDrag:j(H);B=Se().tempTransaction(({stateEditors:pe})=>{let fe=pe.coreByProject.historic.sheetsById.sequence.transformKeyframes;for(let ye of Object.keys(N)){let{byTrackId:Ne}=N[ye];for(let ze of Object.keys(Ne)){let{byKeyframeId:Me}=Ne[ze];fe({trackId:ze,keyframeIds:Object.keys(Me),translate:se,scale:1,origin:0,snappingFunction:G.getSequence().closestGridPosition,objectKey:ye,projectId:V.projectId,sheetId:V.sheetId})}}})},onDragEnd(H){H?B==null||B.commit():B==null||B.discard()}}}}},delete(){Se().transaction(({stateEditors:V})=>{let B=V.coreByProject.historic.sheetsById.sequence.deleteKeyframes;for(let j of Object.keys(N)){let{byTrackId:H}=N[j];for(let X of Object.keys(H)){let{byKeyframeId:K}=H[X];B($(P({},G.address),{objectKey:j,trackId:X,keyframeIds:Object.keys(K)}))}}})}}}a.boundsToSelection=b})(fF||(fF={})),wre=Te.div(Sre||(Sre=J([`
  position: absolute;
  background: rgba(255, 255, 255, 0.1);
  border: 1px dashed rgba(255, 255, 255, 0.4);
  box-sizing: border-box;
`]))),pF=a=>({h:[...a.h].sort((u,c)=>u-c),v:[...a.v].sort((u,c)=>u-c)}),Ere=({state:a,layoutP:u})=>{let c=E7e(a);return Gr(()=>{let m=(0,vh.val)(c.pointer),_=pF(m),b=(0,vh.val)(u.scaledSpace.fromUnitSpace),E=(0,vh.val)(u.scaledSpace.leftPadding),T=_.h.map(b).map(V=>V+E),R=_.v[0],N=_.v[1]-_.v[0],z=T[0],G=T[1]-T[0];return O6.default.createElement(wre,{style:{top:R+"px",height:N+"px",left:z+"px",width:G+"px"}})},[u,c])},Tre=bre}),J5,Mre,Cre,mF,Are,Pre,Rre,Ire=I(()=>{f6(),J5=Q(qe()),Ft(),Qm(),Cre=Te.div(Mre||(Mre=J([`
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  overflow-x: hidden;
  overflow-y: scroll;
  z-index: `,`;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
`])),()=>zp.scrollableArea),mF=(0,J5.createContext)(Ld),Are=()=>(0,J5.useContext)(mF),Pre=a=>{let u=(0,J5.useRef)(null),c=(0,J5.useCallback)(m=>{u.current.scrollBy(0,m.deltaY)},[]);return J5.default.createElement(mF.Provider,{value:c},J5.default.createElement(Cre,{ref:u},a.children))},Rre=Pre}),kre,D7e=I(()=>{kre='data:image/svg+xml,<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">%0A  <path d="M1 7V1H7" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M7 33H1L1 27" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M33 27V33H27" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M27 1L33 1V7" stroke="%2374FFDE" stroke-width="0.25" />%0A</svg>'}),yh,AC=I(()=>{yh=(a,u=a)=>`
  left: `.concat(a*-.5,`px;
  top: `).concat(u*-.5,`px;
  width: `).concat(a,`px;
  height: `).concat(u,`px;
`)}),PC,Nre,Dre,O7e=I(()=>{PC=mn(),Nre=(0,PC.prism)(()=>{let[a,u]=PC.prism.state("pos",null);return PC.prism.effect("setupListeners",()=>{let c=m=>{u(m)};return document.addEventListener("mousemove",c),()=>{document.removeEventListener("mousemove",c)}},[]),a}),Dre=Nre}),Wm,Cl,Jb,Ore,Fre,Lre,Ure,$m,Ip,RC,Bre,zre,a0=I(()=>{Wm=mn(),O7e(),Ua(),Cl=Q(qe()),Jb=(0,Cl.createContext)(null),Ore=0,Fre=({children:a,layoutP:u})=>{let c=(0,Cl.useMemo)(()=>new Wm.Atom([]),[]),m=(0,Cl.useMemo)(()=>(0,Wm.prism)(()=>{let E=Wm.prism.memo("p",()=>Bre(u),[u]).getValue(),T=(0,Wm.val)(c.pointer);return T.length>0?xm(T).position:E}),[u]),_=(0,Cl.useCallback)(()=>{let E=Ore++;return c.reduce(T=>[...T,{id:E,position:[-1,0]}]),{set:T=>{c.reduce(R=>{let N=R.findIndex(G=>G.id===E);if(N===-1)return console.warn("Lock is already freed. This is a bug."),R;let z=[...R];return z.splice(N,1,{id:E,position:[T,T===-1?0:1]}),z})},unlock:()=>{c.reduce(T=>T.filter(R=>R.id!==E))}}},[]),b={currentD:m,getLock:_};return Cl.default.createElement(Jb.Provider,{value:b},a)},Lre=()=>(0,Cl.useContext)(Jb).currentD,Ure=()=>{let{getLock:a}=(0,Cl.useContext)(Jb),u=(0,Cl.useRef)();return(0,Cl.useLayoutEffect)(()=>()=>{var c;(c=u.current)==null||c.unlock()},[]),(0,Cl.useMemo)(()=>{let c;return(m,_)=>{var b,E;(c==null?void 0:c.shouldLock)!==m&&(m?u.current=a():(b=u.current)==null||b.unlock()),(c==null?void 0:c.pos)!==_&&m&&((E=u.current)==null||E.set(_)),c={shouldLock:m,pos:_}}},[a])},$m=(a,u)=>{let{getLock:c}=(0,Cl.useContext)(Jb),m=(0,Cl.useRef)();(0,Cl.useLayoutEffect)(()=>{if(a)return m.current=c(),()=>{m.current.unlock()}},[a,c]),(0,Cl.useLayoutEffect)(()=>{a&&m.current.set(u)},[u,a])},Ip=a=>({[RC]:a==="hide"?a:a.toFixed(3)}),RC="data-theatre-lock-framestamp-to",Bre=a=>(0,Wm.prism)(()=>{let u=(0,Wm.val)(a.rightDims),c=(0,Wm.val)(a.clippedSpace.toUnitSpace),m=(0,Wm.val)(Dre);if(!m)return[-1,0];for(let z of m.composedPath()){if(!(z instanceof HTMLElement||z instanceof SVGElement))break;if(z.hasAttribute(RC)){let G=z.getAttribute(RC);if(typeof G!="string")continue;if(G==="hide")return[-1,0];let V=parseFloat(G);if(isFinite(V)&&V>=0)return[V,2]}}let{clientX:_,clientY:b}=m,{screenX:E,screenY:T,width:R,height:N}=u;if(Cd(_,E,E+R)&&Cd(b,T+16,T+N)){let z=_-E;return[c(z),3]}else return[-1,0]}),zre=Fre}),Vre,eS,gF,Gre,Hre,kp,jre=I(()=>{Bi(),dc(),Ft(),D7e(),AC(),jd(),a0(),Vre=12,eS=34,gF="beingDragged",kp={BEING_DRAGGED_CLASS:gF,CSS:e0(Gre||(Gre=J([`
    position: absolute;
    `,`;
    `,`;

    &.`,` {
      pointer-events: none !important;
    }
  `])),yh(Vre),Fi,gF),CSS_WHEN_SOMETHING_DRAGGING:e0(Hre||(Hre=J([`
    pointer-events: auto;
    cursor: var(`,`);

    //  thing
    // This box extends the hitzone so the user does not
    // accidentally leave the hitzone
    &:hover:after {
      position: absolute;
      top: calc(50% - `,`px);
      left: calc(50% - `,`px);
      width: `,`px;
      height: `,`px;
      display: block;
      content: ' ';
      background: url(`,`) no-repeat 100% 100%;
      // This icon might also fit: GiConvergenceTarget
    }
  `])),Lm,eS/2,eS/2,eS,eS,kre),reactProps(a){return $(P(P({},Ip(a.position)),Ml.includePositionSnapAttrs(a.position)),{className:a.isDragging?kp.BEING_DRAGGED_CLASS:""})}}});function vF(){nS.set({mode:"snapToAll"})}function e8(){nS.set({mode:"snapToNone"})}function Wre(a){nS.set({mode:"snapToSome",positions:a})}function $re(a,u){return Object.fromEntries(Object.entries(a).map(([c,m])=>[c,Object.fromEntries(Object.entries(m.trackData).map(([_,b])=>[_,b.keyframes.filter(E=>u(E,{trackId:_,trackData:b,objectKey:c})).map(E=>E.position)]))]))}var qre,Xre,yF,Yre,Kre,Zre,Qre,Jre,tS,nS,_F,t8=I(()=>{qre=mn(),Xre=mn(),yF=Q(qe()),Ft(),jre(),Kre=Te.div(Yre||(Yre=J([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  #pointer-root.draggingPositionInSequenceEditor & {
    `,`
  }
`])),kp.CSS,kp.CSS_WHEN_SOMETHING_DRAGGING),Qre=Te.div(Zre||(Zre=J([`
  position: absolute;
`]))),Jre=a=>yF.default.createElement(Qre,{style:{top:"".concat(a.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,Xre.val)(a.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(a.position,"px))")}},yF.default.createElement(Kre,P({},kp.reactProps({isDragging:!1,position:a.position})))),tS=Jre,nS=new qre.Atom({mode:"snapToNone"}),_F=nS.prism});function F7e(a,u){let c=(0,n8.useMemo)(()=>({debugName:"HorizontallyScrollableArea",onDragStart(_){if(_.target instanceof HTMLInputElement||_.shiftKey||_.altKey||_.ctrlKey||_.metaKey||_.composedPath().some(G=>G instanceof HTMLElement&&G.draggable===!0))return!1;let b=_.clientX-u.getBoundingClientRect().left,E=ii((0,pa.val)(a.clippedSpace.toUnitSpace)(b),0,1/0),T=(0,pa.val)(a.seeker.setIsSeeking),R=(0,pa.val)(a.sheet).getSequence();R.position=E;let N=E,z=(0,pa.val)(a.scaledSpace.toUnitSpace);return T(!0),vF(),{onDrag(G,V,B){let j=z(G),H=ii(N+j,0,R.length),X=Ml.checkIfMouseEventSnapToPos(B,{});X!=null&&(H=X),R.position=H},onDragEnd(){T(!1),e8()}}}}),[a,u]),[m]=fa(u,c);mh(m,"draggingPositionInSequenceEditor","ew-resize")}function L7e(a,u){let c=Are();(0,n8.useLayoutEffect)(()=>{if(!u)return;let m=b=>{if(b.ctrlKey){b.preventDefault(),b.stopPropagation();let E=b.clientX-u.getBoundingClientRect().left,T=(0,pa.val)(a.clippedSpace.toUnitSpace)(E),R=(0,pa.val)(a.clippedSpace.range),N=1+xF(b.deltaY,[-50,50])*.03,z=cp(R,B=>(B-T)*N+T),G=(0,pa.val)(a.sheet).getSequence().length,V=G+G*.25;(0,pa.val)(a.clippedSpace.setRange)(U7e(z,[0,V]));return}else if(b.shiftKey){b.preventDefault(),b.stopPropagation();let E=(0,pa.val)(a.sheet).getSequence().length,T=(0,pa.val)(a.clippedSpace.range),R=(T.end-T.start)/E,N=xF(b.deltaY||b.deltaX,[-50,50])*.05*R,z=cp(T,G=>G+N);(0,pa.val)(a.clippedSpace.setRange)(z);return}else{c(b),b.preventDefault(),b.stopPropagation();let E=(0,pa.val)(a.scaledSpace.toUnitSpace)(b.deltaX*1),T=(0,pa.val)(a.clippedSpace.range),R=cp(T,N=>N+E);(0,pa.val)(a.clippedSpace.setRange)(R);return}},_={capture:!0,passive:!1};return u.addEventListener("wheel",m,_),()=>{u.removeEventListener("wheel",m,_)}},[u,a]),fa(u,(0,n8.useMemo)(()=>({onDragStart(m){let _=(0,pa.val)(a.clippedSpace.range),b=(0,pa.val)(a.clippedSpace.setRange),E=(0,pa.val)(a.scaledSpace.toUnitSpace);return m.preventDefault(),m.stopPropagation(),{onDrag(T,R,N,z,G){c({deltaY:-G});let V=-E(T),B=cp(_,j=>j+V);b(B)}}},debugName:"HorizontallyScrollableArea Middle Button Drag",buttons:[1],lockCSSCursorTo:"grabbing"}),[a]))}function xF(a,[u,c]){return Math.max(Math.min(a,c),u)}function U7e(a,u){return cp(a,c=>xF(c,u))}function B7e(a,u){(0,n8.useLayoutEffect)(()=>{if(!u)return;let c=(0,pa.prism)(()=>{let E=(0,pa.val)(a.clippedSpace.range);return(0,pa.val)(a.scaledSpace.fromUnitSpace)(E.start)}),m=()=>{let E=c.getValue();u.scrollLeft=E},_=c.onStale(m);m();let b=setTimeout(m,100);return()=>{clearTimeout(b),_()}},[a,u])}var pa,n8,eie,tie,nie,bF,rie=I(()=>{Qa(),Ui(),tr(),pa=mn(),Ua(),n8=Q(qe()),Ft(),Ire(),Bi(),dc(),jd(),t8(),tie=Te.div(eie||(eie=J([`
  position: absolute;

  right: 0;
  overflow-x: scroll;
  overflow-y: hidden;
  `,`;

  // hide the scrollbar on Gecko
  scrollbar-width: none;

  // hide the scrollbar on Webkit/Blink
  &::-webkit-scrollbar {
    display: none;
  }
`])),Fi),nie=n8.default.memo(({layoutP:a,children:u,height:c})=>{let{width:m,unitSpaceToScaledSpaceMultiplier:_}=Gr(()=>({width:(0,pa.val)(a.rightDims.width),unitSpaceToScaledSpaceMultiplier:(0,pa.val)(a.scaledSpace.fromUnitSpace)(1)}),[a]),[b,E]=Ii(null);return L7e(a,E),F7e(a,E),B7e(a,E),n8.default.createElement(tie,{ref:b,style:{width:m+"px",height:c+"px","--unitSpaceToScaledSpaceMultiplier":_}},u)}),bF=nie}),IC,iie,sie,aie,oie,lie,uie,cie,F6,kC=I(()=>{IC=Q(qe()),Ft(),sie=Te.li(iie||(iie=J([`
  margin: 0;
  padding: 0;
  list-style: none;
  box-sizing: border-box;
  position: relative;
`]))),oie=Te.div(aie||(aie=J([`
  box-sizing: border-box;
  width: 100%;
  position: relative;

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -40px;
    top: 0;
    bottom: 0;
    right: 0;
    box-sizing: border-box;
    border-bottom: 1px solid #252b3869;
    background: `,`;
  }
`])),a=>a.isEven?"transparent":"#6b8fb505"),uie=Te.ul(lie||(lie=J([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),cie=({leaf:a,children:u,node:c,isCollapsed:m})=>{let _=Array.isArray(u)&&u.length>0;return a.shouldRender?IC.default.createElement(sie,null,IC.default.createElement(oie,{style:{height:a.nodeHeight+"px"},isEven:a.n%2===0},c),_&&IC.default.createElement(uie,null,u)):null},F6=cie}),z7e=ie((a,u)=>{(function(){var c=this,m={};typeof a<"u"?u.exports=m:c.fuzzy=m,m.simpleFilter=function(_,b){return b.filter(function(E){return m.test(_,E)})},m.test=function(_,b){return m.match(_,b)!==null},m.match=function(_,b,E){E=E||{};var T=0,R=[],N=b.length,z=0,G=0,V=E.pre||"",B=E.post||"",j=E.caseSensitive&&b||b.toLowerCase(),H;_=E.caseSensitive&&_||_.toLowerCase();for(var X=0;X<N;X++)H=b[X],j[X]===_[T]?(H=V+H+B,T+=1,G+=1+G):G=0,z+=G,R[R.length]=H;return T===_.length?(z=j===_?1/0:z,{rendered:R.join(""),score:z}):null},m.filter=function(_,b,E){return!b||b.length===0?[]:typeof _!="string"?b:(E=E||{},b.reduce(function(T,R,N,z){var G=R;E.extract&&(G=E.extract(R));var V=m.match(_,G,E);return V!=null&&(T[T.length]={string:V.rendered,score:V.score,index:N,original:R}),T},[]).sort(function(T,R){var N=R.score-T.score;return N||T.index-R.index}))}})()});function V7e(a,u){let[c,m]=(0,NC.useState)(!1),_=(0,NC.useRef)(u);return c||(_.current=u),(0,NC.useMemo)(()=>a(m),_.current)}var NC,G7e=I(()=>{NC=Q(qe())}),SF,$9,DC=I(()=>{SF="rgba(26, 28, 30, 0.97);",$9="#272B2F"});function hie(a,u,c,m){let _=V7e(b=>({debugName:"CurveSegmentEditor/useKeyframeDrag",lockCSSCursorTo:"move",onDragStart(){return b(!0),{onDrag(E,T){a&&c.onCurveChange(m(E,T))},onDragEnd(E){b(!1),c.onCancelCurveChange()}}}}),[a,c.onCurveChange,c.onCancelCurveChange]);fa(u,_)}var Ni,OC,rS,L6,die,iS,fie,FC,pie,mie,gie,U6,vie,r8,yie,_ie,wF,xie,LC,bie,EF,Sie,wie,H7e=I(()=>{Ni=Q(qe()),Qa(),Ui(),Jf(),Ft(),Bi(),G7e(),DC(),OC=.12,rS=1+OC*2,L6=.01,die=8,iS=(1-L6)/(die-1),fie="#3EAAA4",FC="#3EAAA4",pie="#3EAAA4",mie="#3EAAA4",gie="#3EAAA4",U6="#3EAAA4",vie="#3EAAA4",r8="#B3B3B3",yie="#3eaaa4",_ie="#67dfd8",wF=["goldenrod","cornflowerblue","dodgerblue","lawngreen"],LC=Te.circle(xie||(xie=J([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.04px;
  pointer-events: none;
  transition: r 0.15s;
  fill: `,`;
`])),yie),EF=Te.circle(bie||(bie=J([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.09px;
  cursor: move;
  `,`;
  &:hover {
    opacity: 0.4;
  }
  &:hover + `,` {
    fill: `,`;
  }
`])),Fi,LC,_ie),Sie=a=>{let{curveConnection:{left:u,right:c},backgroundConnections:m}=a,_=Math.min(0,1-c.handles[1],1-u.handles[3]),b=Math.max(1,1-c.handles[1],1-u.handles[3]),E=Math.max(1,b-_),T=K=>(K-_)/E,[R,N]=Ii(null),z=rS/((N==null?void 0:N.clientWidth)||1),G=rS/((N==null?void 0:N.clientHeight)||1),[V,B]=Ii(null);hie(N,B,a,(K,te)=>{let se=ii(u.handles[2]+K*z,0,1),pe=u.handles[3]-te*G;return[se,pe,c.handles[0],c.handles[1]]});let[j,H]=Ii(null);hie(N,H,a,(K,te)=>{let se=ii(c.handles[0]+K*z,0,1),pe=c.handles[1]-te*G;return[u.handles[2],u.handles[3],se,pe]});let X=K=>"M0 ".concat(T(1)," C").concat(K.left.handles[2]," ").concat(T(1-K.left.handles[3])," ").concat(K.right.handles[0]," ").concat(T(1-K.right.handles[1])," 1 ").concat(T(0));return Ni.default.createElement("svg",{height:"100%",width:"100%",ref:R,viewBox:"".concat(-OC," ").concat(-OC," ").concat(rS," ").concat(rS),xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",fill:"none"},Ni.default.createElement("linearGradient",{id:"myGradient",gradientTransform:"rotate(90)"},Ni.default.createElement("stop",{offset:T(-1),stopColor:vie}),Ni.default.createElement("stop",{offset:T(0),stopColor:U6}),Ni.default.createElement("stop",{offset:T(.3),stopColor:gie}),Ni.default.createElement("stop",{offset:T(.5),stopColor:mie}),Ni.default.createElement("stop",{offset:T(.7),stopColor:pie}),Ni.default.createElement("stop",{offset:T(1),stopColor:FC}),Ni.default.createElement("stop",{offset:T(2),stopColor:fie})),Ni.default.createElement("pattern",{id:"dot-background-pattern-1",width:iS,height:iS/E,y:-_/E},Ni.default.createElement("rect",{width:L6,height:L6,fill:r8,opacity:.3})),Ni.default.createElement("rect",{x:0,y:0,width:"1",height:1,fill:"url(#dot-background-pattern-1)"}),Ni.default.createElement("pattern",{id:"dot-background-pattern-2",width:iS,height:iS},Ni.default.createElement("rect",{width:L6,height:L6,fill:r8})),Ni.default.createElement("rect",{x:0,y:T(0),width:"1",height:T(1)-T(0),fill:"url(#dot-background-pattern-2)"}),!u.type||u.type==="bezier"?Ni.default.createElement(Ni.default.Fragment,null,Ni.default.createElement("line",{x1:0,y1:T(1),x2:u.handles[2],y2:T(1-u.handles[3]),stroke:r8,strokeWidth:"0.01"}),Ni.default.createElement("line",{x1:1,y1:T(0),x2:c.handles[0],y2:T(1-c.handles[1]),stroke:r8,strokeWidth:"0.01"}),Ni.default.createElement("path",{d:X(a.curveConnection),stroke:"none",fill:"url('#myGradient')",opacity:"0.1"}),m.map((K,te)=>Ni.default.createElement("path",{key:K.objectKey+"/"+K.left.id,d:X(K),stroke:wF[te%wF.length],opacity:.6,strokeWidth:"0.01"})),Ni.default.createElement("path",{d:X(a.curveConnection),stroke:"url('#myGradient')",strokeWidth:"0.02"}),Ni.default.createElement("circle",{cx:0,cy:T(1),r:"0.025",stroke:FC,strokeWidth:"0.02",fill:$9}),Ni.default.createElement("circle",{cx:1,cy:T(0),r:"0.025",stroke:U6,strokeWidth:"0.02",fill:$9}),Ni.default.createElement(EF,{ref:V,cx:u.handles[2],cy:T(1-u.handles[3]),fill:FC,opacity:.2}),Ni.default.createElement(LC,{cx:u.handles[2],cy:T(1-u.handles[3])}),Ni.default.createElement(EF,{ref:j,cx:c.handles[0],cy:T(1-c.handles[1]),fill:U6,opacity:.2}),Ni.default.createElement(LC,{cx:c.handles[0],cy:T(1-c.handles[1])})):Ni.default.createElement(Ni.default.Fragment,null,Ni.default.createElement("line",{x1:0,y1:T(1),x2:1,y2:T(1),stroke:r8,strokeWidth:"0.01"}),Ni.default.createElement("line",{x1:1,y1:T(1),x2:1,y2:0,stroke:r8,strokeWidth:"0.01"}),Ni.default.createElement("circle",{cx:0,cy:1,r:"0.025",stroke:U6,strokeWidth:"0.02",fill:$9}),Ni.default.createElement("circle",{cx:1,cy:0,r:"0.025",stroke:U6,strokeWidth:"0.02",fill:$9})))},wie=Sie});function UC(a){return a.map(u=>u.toFixed(3)).join(", ")}function BC(a){if(!a||(a==null?void 0:a.length)>Eie)return null;let u=a.split(",");if(u.length!==4)return null;let c=u.map(m=>Number(m.trim()));return!c.every(m=>isFinite(m))||c[0]<0||c[0]>1||c[2]<0||c[2]>1?null:c}function j7e(a,u,c={threshold:.02}){if(!a||!u)return!1;let m=0;for(let _=0;_<4;_++)m+=Math.abs(a[_]-u[_]);return m<c.threshold}var Eie,zC,Tie=I(()=>{Eie=128,zC=[{label:"Quad Out",value:"0.250, 0.460, 0.450, 0.940"},{label:"Quad In Out",value:"0.455, 0.030, 0.515, 0.955"},{label:"Quad In",value:"0.550, 0.085, 0.680, 0.530"},{label:"Cubic Out",value:"0.215, 0.610, 0.355, 1.000"},{label:"Cubic In Out",value:"0.645, 0.045, 0.355, 1.000"},{label:"Cubic In",value:"0.550, 0.055, 0.675, 0.190"},{label:"Quart Out",value:"0.165, 0.840, 0.440, 1.000"},{label:"Quart In Out",value:"0.770, 0.000, 0.175, 1.000"},{label:"Quart In",value:"0.895, 0.030, 0.685, 0.220"},{label:"Quint Out",value:"0.230, 1.000, 0.320, 1.000"},{label:"Quint In Out",value:"0.860, 0.000, 0.070, 1.000"},{label:"Quint In",value:"0.755, 0.050, 0.855, 0.060"},{label:"Sine Out",value:"0.390, 0.575, 0.565, 1.000"},{label:"Sine In Out",value:"0.445, 0.050, 0.550, 0.950"},{label:"Sine In",value:"0.470, 0.000, 0.745, 0.715"},{label:"Expo Out",value:"0.190, 1.000, 0.220, 1.000"},{label:"Expo In Out",value:"1.000, 0.000, 0.000, 1.000"},{label:"Expo In",value:"0.780, 0.000, 0.810, 0.00"},{label:"Circ Out",value:"0.075, 0.820, 0.165, 1.000"},{label:"Circ In Out",value:"0.785, 0.135, 0.150, 0.860"},{label:"Circ In",value:"0.600, 0.040, 0.980, 0.335"},{label:"Back Out",value:"0.175, 0.885, 0.320, 1.275"},{label:"Back In Out",value:"0.680, -0.550, 0.265, 1.550"},{label:"Back In",value:"0.600, -0.280, 0.735, 0.045"},{label:"linear",value:"0.5, 0.5, 0.5, 0.5"},{label:"In Out",value:"0.42,0,0.58,1"},{label:"Hold",value:"0, 0, Infinity, Infinity"}]}),O0,VC,i8,TF,Mie,Cie,sS,MF,CF,Aie,Pie,W7e=I(()=>{O0=Q(qe()),VC=.75,i8=.1,TF=1+VC*2,Mie="#F5F5F5",Cie="#888888",sS="#4f4f4f",MF="rgba(255, 255, 255, 0.1)",CF=a=>1-a,Aie=a=>{let{easing:u,isSelected:c}=a,m=c?Mie:Cie,_="".concat(-VC," ").concat(-VC," ").concat(TF," ").concat(TF);if(u){let b=[u[0],CF(u[1])],E=[u[2],CF(u[3])];return O0.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},O0.default.createElement("line",{x1:"0",y1:"1",x2:b[0],y2:b[1],stroke:sS,strokeWidth:"0.1"}),O0.default.createElement("line",{x1:"1",y1:"0",x2:E[0],y2:E[1],stroke:sS,strokeWidth:"0.1"}),O0.default.createElement("circle",{cx:b[0],cy:b[1],r:.1,fill:MF}),O0.default.createElement("circle",{cx:E[0],cy:E[1],r:.1,fill:MF}),O0.default.createElement("circle",{cx:b[0],cy:b[1],r:i8,fill:sS}),O0.default.createElement("circle",{cx:E[0],cy:E[1],r:i8,fill:sS}),O0.default.createElement("path",{d:"M0 1 C".concat(b[0]," ").concat(b[1]," ").concat(E[0],` 
        `).concat(E[1]," 1 0"),stroke:m,strokeWidth:"0.08"}),O0.default.createElement("circle",{cx:0,cy:1,r:i8,fill:m}),O0.default.createElement("circle",{cx:1,cy:0,r:i8,fill:m}))}return O0.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},O0.default.createElement("line",{x1:"0",y1:"1",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),O0.default.createElement("line",{x1:"1",y1:"0",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),O0.default.createElement("circle",{cx:0,cy:1,r:i8,fill:m}),O0.default.createElement("circle",{cx:1,cy:0,r:i8,fill:m}))},Pie=Aie}),aS,Rie,Iie,kie,Nie,Die,Oie,Fie,$7e=I(()=>{zb(),aS=Q(qe()),Ft(),Tie(),W7e(),_M(),DC(),Tp(),kie=Te.div(Iie||(Iie=J([`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  aspect-ratio: 1;

  transition: background-color 0.15s;
  background-color: `,`;
  border-radius: 2px;
  cursor: pointer;
  outline: none;

  `,`

  &:hover {
    background-color: #31353a;
  }

  &:focus {
    background-color: #383d42;
  }
`])),$9,({isSelected:a})=>a&&e0(Rie||(Rie=J([`
      background-color: #383d42;
    `])))),Die=Te(Ep)(Nie||(Nie=J([`
  padding: 0.5em;
  color: white;
  max-width: 240px;
  pointer-events: none !important;
  --popover-bg: black;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: transparent;
  box-shadow: none;
`]))),Oie=aS.default.forwardRef((a,u)=>{let[c,m]=A6({enabled:!0,verticalPlacement:a.tooltipPlacement,verticalGap:0},()=>aS.default.createElement(Die,{showPopoverEdgeTriangle:!1},a.easing.label));return aS.default.createElement(kie,P({ref:yM([m,u])},a),c,aS.default.createElement(Pie,{easing:BC(a.easing.value),isSelected:a.isSelected}))}),Fie=Oie});function q7e(a){var u;let[c,m]=(0,Lie.useState)(null),_=E=>{if(c===null){a.items.length>0&&m(0);return}let T=c+E*a.uiColumns,R=T<0,N=T>a.items.length-1;if(R||N){if(a.canVerticleExit&&a.canVerticleExit(R?"top":"bottom")){m(null);return}return}m(T)},b=E=>{c===null?m(Z7e(E,a.items.length)):c+E<0?m(null):m(Math.min(c+E,a.items.length-1))};return{focusFirstItem(){m(0)},onParentEltKeyDown:E=>{if(E.key==="ArrowRight")b(1);else if(E.key==="ArrowLeft")b(-1);else if(E.key==="ArrowUp")_(-1);else if(E.key==="ArrowDown")_(1);else return 0;return 1},gridItems:a.items.map((E,T)=>a.renderItem({isSelected:T===c,item:E,select(R){m(T),a.onSelectItem(E)===1&&(R==null||R.preventDefault(),R==null||R.stopPropagation())}})),currentSelection:(u=a.items[c??-1])!=null?u:null}}var Lie,X7e=I(()=>{Lie=Q(qe()),HC()});function Uie(a,u,c){var m;(m=a.current)==null||m.discard(),a.current=null;let _=BC(c);_===null?a.current=K7e(u):a.current=Y7e(u,_)}function Bie(a){var u;(u=a.current)==null||u.discard(),a.current=null}function Y7e(a,u){return Se().tempTransaction(({stateEditors:c})=>{let{setHandlesForKeyframe:m,setKeyframeType:_}=c.coreByProject.historic.sheetsById.sequence;for(let{projectId:b,sheetId:E,objectKey:T,trackId:R,left:N,right:z}of a)m({projectId:b,sheetId:E,objectKey:T,trackId:R,keyframeId:N.id,start:[u[0],u[1]]}),m({projectId:b,sheetId:E,objectKey:T,trackId:R,keyframeId:z.id,end:[u[2],u[3]]}),_({projectId:b,sheetId:E,objectKey:T,trackId:R,keyframeId:N.id,keyframeType:"bezier"})})}function K7e(a){return Se().tempTransaction(({stateEditors:u})=>{let{setKeyframeType:c}=u.coreByProject.historic.sheetsById.sequence;for(let{projectId:m,sheetId:_,objectKey:b,trackId:E,left:T}of a)c({projectId:m,sheetId:_,objectKey:b,trackId:E,keyframeId:T.id,keyframeType:"hold"})})}function Z7e(a,u){return(a%u+u)%u}function Q7e(a,u){return()=>setTimeout(a,u)}function J7e({left:a,right:u}){return({left:c,right:m})=>a.handles[2]!==c.handles[2]||a.handles[3]!==c.handles[3]||u.handles[0]!==m.handles[0]||u.handles[1]!==m.handles[1]}var GC,Ks,zie,AF,PF,Vie,Gie,Hie,jie,Wie,$ie,qie,Xie,Yie,Kie,Zie,Qie,RF,e_e,IF,Jie,HC=I(()=>{GC=mn(),Ks=Q(qe()),Ft(),zie=Q(z7e()),Ae(),H7e(),$7e(),Tie(),DC(),Ui(),X7e(),AF=3,PF=53,Vie=25,Hie=Te.div(Gie||(Gie=J([`
  background: `,`;
  display: grid;
  grid-template-areas:
    'search  tween'
    'presets tween';
  grid-template-rows: 32px 1fr;
  grid-template-columns: `,`px 120px;
  gap: 1px;
  height: 120px;
`])),SF,AF*PF),Wie=Te.div(jie||(jie=J([`
  overflow: auto;
  grid-area: presets;

  display: grid;
  grid-template-columns: repeat(`,`, 1fr);
  grid-auto-rows: min-content;
  gap: 1px;

  overflow-y: scroll;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
  &::-webkit-scrollbar {
    /* WebKit */
    width: 0;
    height: 0;
  }
`])),AF),qie=Te.input.attrs({type:"text"})($ie||($ie=J([`
  background-color: `,`;
  border: none;
  border-radius: 2px;
  color: rgba(255, 255, 255, 0.8);
  padding: 6px;
  font-size: 12px;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: 100%;
  box-sizing: border-box;

  grid-area: search;

  &:hover {
    background-color: #212121;
  }

  &:focus {
    background-color: rgba(16, 16, 16, 0.26);
    outline: 1px solid rgba(0, 0, 0, 0.35);
  }
`])),$9),Yie=Te.div(Xie||(Xie=J([`
  grid-area: tween;
  background: `,`;
`])),$9),Zie=Te.div(Kie||(Kie=J([`
  grid-column: 1 / 4;
  padding: 6px;
  color: #888888;
`]))),Qie=a=>{let u=(0,Ks.useMemo)(()=>[a.curveConnection,...a.additionalConnections],[a.curveConnection,...a.additionalConnections]),c=(0,Ks.useRef)(null);(0,Ks.useEffect)(()=>{let xe=Jie(u);return()=>{var We;xe(),(We=c.current)==null||We.commit()}},[c]);let m=[a.curveConnection.left.handles[2],a.curveConnection.left.handles[3],a.curveConnection.right.handles[0],a.curveConnection.right.handles[1]],_=(0,Ks.useRef)(null);(0,Ks.useLayoutEffect)(()=>{var xe,We;(xe=_.current)==null||xe.select(),(We=_.current)==null||We.focus()},[_.current]);let[b,E]=(0,Ks.useState)(UC(m)),T=xe=>{xe!==void 0&&(z(1),E(xe.target.value),BC(xe.target.value)&&V(xe.target.value))},R=xe=>{var We,ae;z(1),(xe.key==="ArrowDown"||xe.key==="ArrowUp")&&xe.preventDefault(),xe.key==="ArrowDown"?(yt.focusFirstItem(),(ae=(We=ye.current[K[0].label])==null?void 0:We.current)==null||ae.focus()):xe.key==="Escape"?(Bie(c),a.onRequestClose("key Escape")):xe.key==="Enter"&&a.onRequestClose("key Enter")},[N,z]=(0,Ks.useState)(0);(0,Ks.useEffect)(()=>{N===2?E(UC(m)):N===3&&b!==""&&E("")},u);let[G,V]=(0,Ks.useState)(UC(m)),[B,j]=(0,Ks.useState)(null);(0,Ks.useEffect)(()=>{var xe;N!==0&&N!==3&&Uie(c,u,(xe=B??G)!=null?xe:"")},[B,G,N]),u.some(J7e(a.curveConnection))&&N===0&&z(3);let H=xe=>{var We,ae;z(2);let nt=UC(xe);E(nt),V(nt),(We=_.current)==null||We.select(),(ae=_.current)==null||ae.focus()},X=()=>{},K=(0,Ks.useMemo)(()=>/^[A-Za-z]/.test(b)?zie.default.filter(b,zC,{extract:xe=>xe.label}).map(xe=>xe.original):zC,[b]);(0,Ks.useEffect)(()=>{N===1&&K[0]&&V(K[0].value)},[K]);let te=xe=>{xe.key==="Escape"?(Bie(c),a.onRequestClose("key Escape"),xe.stopPropagation()):xe.key==="Enter"&&(a.onRequestClose("key Enter"),xe.stopPropagation())},se=xe=>{N===0&&z(2),j(xe.value)},pe=()=>j(null),fe=xe=>(Uie(c,u,xe.value),a.onRequestClose("selected easing option"),1),ye=(0,Ks.useRef)(zC.reduce((xe,We)=>(xe[We.label]={current:null},xe),{})),[Ne,ze]=Ii(null),[Me,je]=(0,Ks.useState)(0);(0,Ks.useEffect)(()=>{let xe=()=>{var We;je((We=ze==null?void 0:ze.scrollTop)!=null?We:0)};return ze==null||ze.addEventListener("scroll",xe),()=>ze==null?void 0:ze.removeEventListener("scroll",xe)},[ze]);let yt=q7e({items:K,uiColumns:3,onSelectItem:fe,canVerticleExit(xe){var We,ae;return xe==="top"?((We=_.current)==null||We.select(),(ae=_.current)==null||ae.focus(),1):0},renderItem:({item:xe,select:We})=>{var ae,nt;return Ks.default.createElement(Fie,{key:xe.label,easing:xe,tabIndex:0,onKeyDown:te,ref:ye.current[xe.label],onMouseOver:()=>se(xe),onMouseOut:pe,onClick:We,tooltipPlacement:((nt=(ae=ye.current[xe.label].current)==null?void 0:ae.offsetTop)!=null?nt:0)-(Me??0)<PF+Vie?"bottom":"top",isSelected:j7e(m,BC(xe.value))})}});return(0,Ks.useLayoutEffect)(()=>{var xe,We;if(yt.currentSelection!==null&&document.activeElement!==_.current){let ae=(We=(xe=ye.current)==null?void 0:xe[yt.currentSelection.label])==null?void 0:We.current;ae==null||ae.focus(),V(yt.currentSelection.value),/^[A-Za-z]/.test(b)||E(yt.currentSelection.value)}},[yt.currentSelection]),Ks.default.createElement(Hie,null,Ks.default.createElement(qie,{value:b,placeholder:N===3?"Multiple easings selected":"Search presets...",onPaste:Q7e(T),onChange:T,ref:_,onKeyDown:R}),Ks.default.createElement(Wie,{ref:Ne,onKeyDown:xe=>yt.onParentEltKeyDown(xe)},yt.gridItems,yt.gridItems.length===0?Ks.default.createElement(Zie,null,"No results found"):void 0),Ks.default.createElement(Yie,{onClick:()=>{var xe;return(xe=_.current)==null?void 0:xe.focus()}},Ks.default.createElement(wie,{curveConnection:a.curveConnection,backgroundConnections:a.additionalConnections,onCurveChange:H,onCancelCurveChange:X})))},RF=Qie,{isCurveEditorOpenD:e_e,isConnectionEditingInCurvePopover:IF,getLock:Jie}=(()=>{let a=new GC.Atom([]);return{getLock(u){return a.set(u),function(){a.set([])}},isCurveEditorOpenD:(0,GC.prism)(()=>a.prism.getValue().length>0),isConnectionEditingInCurvePopover(u){return GC.prism.ensurePrism(),a.prism.getValue().some(({left:c,right:m})=>u.left.id===c.id&&u.right.id===m.id)}}})()});function t_e(a,u){for(let{keyframeId:c}of i_e(u))if(a.left.id===c)return!0;return!1}function ese(a,u,c){return(0,WC.prism)(()=>{if(c===void 0)return[];let m=[];for(let{objectKey:_,trackId:b}of tse(c)){let E=(0,WC.val)(Se().atomP.historic.coreByProject[a].sheetsById[u].sequence.tracksByObject[_].trackData[b]);E&&(m=m.concat(r_e(E.keyframes).filter(T=>t_e(T,c)).map(({left:T,right:R})=>({left:T,right:R,trackId:b,objectKey:_,sheetId:u,projectId:a}))))}return m})}function jC(a,u,c){var m;if(c===void 0)return[];let _=[];for(let{objectKey:E,trackId:T,keyframeIds:R}of tse(c))_=_.concat((m=kF({projectId:a,sheetId:u,objectKey:E,trackId:T,keyframeIds:R}))!=null?m:[]);let b=wC(_.map(E=>E.pathToProp));return _.map(({keyframe:E,pathToProp:T})=>({keyframe:E,pathToProp:T.slice(b.length)}))}function kF({projectId:a,sheetId:u,objectKey:c,trackId:m,keyframeIds:_}){let b=(0,WC.val)(Se().atomP.historic.coreByProject[a].sheetsById[u].sequence.tracksByObject[c]),E=b==null?void 0:b.trackData[m];if(!E)return null;let T=n_e((b==null?void 0:b.trackIdByPropPath)||{})[m];if(!T)return null;let R=[c,...EC(T)];return _.map(N=>({keyframe:E.keyframes.find(z=>z.id===N),pathToProp:R})).filter(({keyframe:N})=>N!==void 0)}function n_e(a){let u={};for(let[c,m]of Object.entries(a))u[m]=c;return u}function r_e(a){return a.map((u,c)=>({left:u,right:a[c+1]})).slice(0,-1)}function i_e(a){var u,c,m;let _=[];for(let[b,E]of Object.entries((u=a==null?void 0:a.byObjectKey)!=null?u:{}))for(let[T,R]of Object.entries((c=E==null?void 0:E.byTrackId)!=null?c:{}))for(let N of Object.keys((m=R==null?void 0:R.byKeyframeId)!=null?m:{}))_.push({objectKey:b,trackId:T,keyframeId:N});return _}function tse(a){var u,c,m;let _=[];for(let[b,E]of Object.entries((u=a==null?void 0:a.byObjectKey)!=null?u:{}))for(let[T,R]of Object.entries((c=E==null?void 0:E.byTrackId)!=null?c:{}))_.push({objectKey:b,trackId:T,keyframeIds:Object.keys((m=R==null?void 0:R.byKeyframeId)!=null?m:{})});return _}var WC,B6=I(()=>{WC=mn(),Ae(),Rp()});function s_e(a,u){return(0,nse.useMemo)(()=>a_e(a,u),[])}function a_e(a,u){let c=null,m=E=>Se().tempTransaction(T=>a(T,E));function _(){c==null||c.discard(),c=null}let b={createAsset:u.sheet.project.assetStorage.createAsset,getAssetUrl:E=>E.id?u.sheet.project.assetStorage.getAssetUrl(E.id):void 0};return P({temporarilySetValue(E){_(),c=m(E)},discardTemporaryValue:_,permanentlySetValue(E){_(),m(E).commit()}},b)}var nse,o_e=I(()=>{Ae(),nse=Q(qe())});function NF(a){var u;if(a.type==="sheetObject")return o0.default.createElement(o0.default.Fragment,null,o0.default.createElement($C,{style:{paddingLeft:"".concat(a.indent*qC,"px")}},a.sheetObject.address.objectKey),a.children.map((c,m)=>o0.default.createElement(NF,$(P({key:m},c),{autoFocusInput:a.autoFocusInput&&m===0,indent:a.indent+1}))));if(a.type==="propWithChildren"){let c=(u=a.propConfig.label)!=null?u:xm(a.pathToProp);return o0.default.createElement(o0.default.Fragment,null,o0.default.createElement($C,{style:{paddingLeft:"".concat(a.indent*qC,"px")}},c),a.children.map((m,_)=>o0.default.createElement(NF,$(P({key:_},m),{autoFocusInput:a.autoFocusInput&&_===0,indent:a.indent+1}))))}else return o0.default.createElement(l_e,$(P({},a),{autoFocusInput:a.autoFocusInput,indent:a.indent}))}function l_e(a){var u;let c=(u=a.propConfig.label)!=null?u:xm(a.pathToProp),m=u_e(a);if(a.propConfig.type==="enum")return o0.default.createElement(o0.default.Fragment,null);{let _=uO[a.propConfig.type];return o0.default.createElement(ise,null,o0.default.createElement($C,null,o0.default.createElement("span",{style:{paddingLeft:"".concat(a.indent*qC,"px")}},c)),o0.default.createElement(ose,null,o0.default.createElement(_,{editingTools:m,propConfig:a.propConfig,value:VM(a.keyframe.value,a.propConfig),autoFocus:a.autoFocusInput})))}}function u_e(a){let u=a.sheetObject;return s_e(({stateEditors:c},m)=>{let _=$(P({},a.keyframe),{value:m});c.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(P({},u.address),{trackId:a.trackId,keyframes:[_],snappingFunction:u.sheet.getSequence().closestGridPosition}))},u)}var o0,rse,ise,sse,$C,qC,ase,ose,c_e=I(()=>{o0=Q(qe()),Ft(),WZ(),Ny(),o_e(),L9(),ise=Te.div(rse||(rse=J([`
  display: flex;
  align-items: stretch;
  min-width: 200px;

  select {
    min-width: 100px;
  }
`]))),$C=Te.div(sse||(sse=J([`
  font-style: normal;
  font-weight: 400;
  font-size: 11px;
  line-height: 13px;
  letter-spacing: 0.01em;
  padding: 6px 6px 6px 0;

  width: 40%;

  color: #919191;

  overflow: hidden;
`]))),qC=10,ose=Te.div(ase||(ase=J([`
  display: flex;
  align-items: center;
  width: 60%;
`])))});function XC(a){return Sp({debugName:"useKeyframeInlineEditorPopover"},()=>YC.default.createElement(Ep,{showPopoverEdgeTriangle:!0},YC.default.createElement("div",{style:{margin:"1px 2px 1px 10px"}},Array.isArray(a)?a.map((u,c)=>YC.default.createElement(NF,$(P({key:c},u),{autoFocusInput:c===0,indent:0}))):void 0)))}var YC,KC=I(()=>{YC=Q(qe()),wp(),Tp(),c_e()});function h_e(a,u,c){return El(a,{displayName:"Keyframe",menuItems:()=>{let m=jC(c.leaf.sheetObject.address.projectId,c.leaf.sheetObject.address.sheetId,c.selection);return[{label:m.length>0?"Copy (selection)":"Copy",callback:()=>{m.length>0?Se().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes(m)}):Se().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:c.keyframe,pathToProp:c.leaf.pathToProp}])})}},{label:c.selection!==void 0?"Delete (selection)":"Delete",callback:()=>{c.selection?c.selection.delete():Se().transaction(({stateEditors:_})=>{_.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(P({},c.leaf.sheetObject.address),{keyframeIds:[c.keyframe.id],trackId:c.leaf.trackId}))})}}]},onOpen(){u._debug("Show keyframe",c)}})}function d_e(a,u,c){let m=(0,q9.useRef)(u);m.current=u;let{onClickFromDrag:_}=c,b=(0,q9.useMemo)(()=>({debugName:"KeyframeDot/useDragKeyframe",onDragStart(T){let R=m.current,N=(0,ZC.val)(Se().atomP.historic.coreByProject[R.leaf.sheetObject.address.projectId].sheetsById[R.leaf.sheetObject.address.sheetId].sequence.tracksByObject),z=$re(N,function(j,{trackId:H,objectKey:X}){var K,te;return j.id!==R.keyframe.id&&!(R.selection&&(te=(K=R.selection.byObjectKey[X])==null?void 0:K.byTrackId[H])!=null&&te.byKeyframeId[j.id])});if(Wre(z),R.selection){let{selection:j,leaf:H}=R,{sheetObject:X}=H,K=j.getDragHandlers($(P({},X.address),{domNode:a,positionAtStartOfDrag:R.track.data.keyframes[R.index].position})).onDragStart(T);return K&&$(P({},K),{onClick:_,onDragEnd:(...te)=>{var se;(se=K.onDragEnd)==null||se.call(K,...te),e8()}})}let G=R,V=(0,ZC.val)(G.layoutP.scaledSpace.toUnitSpace),B;return{onDrag(j,H,X){var K;let te=G.track.data.keyframes[G.index],se=Math.max((K=Ml.checkIfMouseEventSnapToPos(X,{ignore:a}))!=null?K:te.position+V(j),0);B==null||B.discard(),B=void 0,B=Se().tempTransaction(({stateEditors:pe})=>{pe.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(P({},G.leaf.sheetObject.address),{trackId:G.leaf.trackId,keyframes:[$(P({},te),{position:se})],snappingFunction:(0,ZC.val)(G.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(j){j?B==null||B.commit():B==null||B.discard(),e8()},onClick(j){_(j)}}}}),[_]),[E]=fa(a,b);return $m(E,u.keyframe.position),mh(E,"draggingPositionInSequenceEditor","ew-resize"),[E]}var q9,ZC,oS,DF,lS,OF,lse,QC,use,cse,hse,dse,fse,pse,mse=I(()=>{q9=Q(qe()),Ft(),Ae(),Tl(),Qa(),Ui(),ZC=mn(),a0(),dc(),jd(),AC(),O9(),B6(),Bi(),t8(),KC(),X5(),oS=6,DF=oS+2,lS={normalColor:"#40AAA4",selectedColor:"#F2C95C",inlineEditorOpenColor:"#FCF3DC",selectedAndInlineEditorOpenColor:"#CBEBEA"},OF=({isSelected:a,isInlineEditorPopoverOpen:u})=>a&&u?lS.inlineEditorOpenColor:a?lS.selectedColor:u?lS.selectedAndInlineEditorOpenColor:lS.normalColor,QC=Te.div(lse||(lse=J([`
  position: absolute;
  `,`

  background: `,`;
  transform: rotateZ(45deg);

  `,`;

  z-index: 1;
  pointer-events: none;
`])),yh(oS),a=>OF(a),a=>a.flag===2?"outline: 2px solid white;":""),cse=Te.div(use||(use=J([`
  position: absolute;
  `,`

  background: `,`;

  `,`;

  z-index: 1;
  pointer-events: none;
`])),yh(oS*1.5),a=>OF(a),a=>a.flag===2?"outline: 2px solid white;":""),dse=Te.div(hse||(hse=J([`
  z-index: 1;
  cursor: ew-resize;

  position: absolute;
  `,`;
  `,`;

  & + `,` {
    `,`
  }

  &:hover + `,` {
    `,`
  }
`])),yh(12),Fi,QC,a=>a.isInlineEditorPopoverOpen?yh(DF):"",QC,yh(DF)),fse=a=>{let u=D9("SingleKeyframeDot",a.keyframe.id),c=q5(a.itemKey),[m,_]=Ii(null),[b]=h_e(_,u,a),{node:E,toggle:T,isOpen:R}=XC([{type:"primitiveProp",keyframe:a.keyframe,pathToProp:a.leaf.pathToProp,propConfig:a.leaf.propConf,sheetObject:a.leaf.sheetObject,trackId:a.leaf.trackId}]);d_e(_,a,{onClickFromDrag(z){T(z,m.current)}});let N=!a.keyframe.type||a.keyframe.type==="bezier";return q9.default.createElement(q9.default.Fragment,null,q9.default.createElement(dse,P({ref:m,isInlineEditorPopoverOpen:R},c.attrs)),N?q9.default.createElement(QC,{isSelected:!!a.selection,isInlineEditorPopoverOpen:R,flag:c.flag}):q9.default.createElement(cse,{isSelected:!!a.selection,isInlineEditorPopoverOpen:R,flag:c.flag}),E,b)},pse=fse}),FF,LF,UF,s8,gse,vse,BF,yse=I(()=>{hc(),FF=Q(qe()),Ft(),mse(),LF=oS/2+1,UF=1e3,s8={normalColor:"#365b59",selectedColor:"#8A7842",barColor:a=>{let u=a.isSelected?s8.selectedColor:s8.normalColor;return a.isPopoverOpen?iM(.2,i6(.2,u)):u},hoverColor:a=>{let u=a.isSelected?s8.selectedColor:s8.normalColor;return a.isPopoverOpen?iM(.2,i6(.2,u)):iM(.1,i6(.1,u))}},vse=Te.div(gse||(gse=J([`
  position: absolute;
  background: `,`;
  height: `,`px;
  width: `,`px;

  left: 0;
  top: -`,`px;
  transform-origin: top left;
  z-index: 0;
  cursor: ew-resize;

  &:after {
    display: block;
    position: absolute;
    content: ' ';
    top: -4px;
    bottom: -4px;
    left: 0;
    right: 0;
  }

  &:hover {
    background: `,`;
  }
`])),s8.barColor,LF,UF,LF/2,s8.hoverColor),BF=FF.default.forwardRef((a,u)=>{let c={isPopoverOpen:a.isPopoverOpen,isSelected:a.isSelected};return FF.default.createElement(vse,$(P({},c),{ref:u,style:{transform:"scaleX(calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(a.connectorLengthInUnitSpace/UF,"))")},onClick:m=>{var _;(_=a.openPopover)==null||_.call(a,m)}}),a.children)})});function f_e(a,u){let c=(0,zF.useRef)(u);c.current=u;let m=(0,zF.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(_){let b=c.current,E;if(b.selection){let{selection:z,leaf:G}=b,{sheetObject:V}=G;return z.getDragHandlers($(P({},V.address),{domNode:a,positionAtStartOfDrag:b.track.data.keyframes[b.index].position})).onDragStart(_)}let T=b,R=(0,JC.val)(T.layoutP.sheet).getSequence(),N=(0,JC.val)(T.layoutP.scaledSpace.toUnitSpace);return{onDrag(z,G,V){let B=N(z);E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:j})=>{j.coreByProject.historic.sheetsById.sequence.transformKeyframes($(P({},T.leaf.sheetObject.address),{trackId:T.leaf.trackId,keyframeIds:[T.keyframe.id,T.track.data.keyframes[T.index+1].id],translate:B,scale:1,origin:0,snappingFunction:R.closestGridPosition}))})},onDragEnd(z){z?E&&E.commit():E&&E.discard()}}}}),[]);fa(a,m)}function p_e(a,u,c,m){return El(u,{displayName:"Tween",menuItems:()=>{let _=jC(a.leaf.sheetObject.address.projectId,a.leaf.sheetObject.address.sheetId,a.selection);return[{label:_.length>0?"Copy (selection)":"Copy",callback:()=>{_.length>0?Se().transaction(b=>{b.stateEditors.studio.ahistoric.setClipboardKeyframes(_)}):Se().transaction(b=>{b.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:c,pathToProp:a.leaf.pathToProp},{keyframe:m,pathToProp:a.leaf.pathToProp}])})}},{label:a.selection?"Delete (selection)":"Delete",callback:()=>{a.selection?a.selection.delete():Se().transaction(({stateEditors:b})=>{b.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(P({},a.leaf.sheetObject.address),{keyframeIds:[c.id,m.id],trackId:a.leaf.trackId}))})}}]}})}var JC,X9,zF,VF,_se,xse,bse,Sse,wse,m_e=I(()=>{Ae(),Tl(),Qa(),Ui(),JC=mn(),X9=Q(qe()),zF=Q(qe()),wp(),Tp(),HC(),yse(),DC(),tr(),B6(),B6(),Ft(),VF=5,xse=Te(Ep)(_se||(_se=J([`
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: `,`;
`])),SF),bse=a=>{let{index:u,track:c}=a,m=c.data.keyframes[u],_=c.data.keyframes[u+1],[b,E]=Ii(null),{node:T,toggle:R,close:N}=Sp(()=>{let B=(0,JC.val)(a.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:B.screenX+VF,maxX:B.screenX+B.width-VF}}},()=>X9.default.createElement(wse,$(P({},a),{closePopover:N}))),[z]=p_e(a,E,m,_);f_e(E,a);let G=_.position-m.position,V={isPopoverOpen:Gr(()=>IF($(P({},a.leaf.sheetObject.address),{trackId:a.leaf.trackId,left:m,right:_})),[a.leaf.sheetObject.address,a.leaf.trackId,m,_]),isSelected:a.selection!==void 0};return X9.default.createElement(X9.default.Fragment,null,X9.default.createElement(BF,$(P({ref:b,connectorLengthInUnitSpace:G},V),{openPopover:B=>{E&&R(B,E)}}),T),z)},Sse=bse,wse=X9.default.forwardRef((a,u)=>{let{index:c,track:{data:m},selection:_}=a,b=m.keyframes[c],E=m.keyframes[c+1],T=a.leaf.trackId,R=a.leaf.sheetObject.address,N=Gr(()=>ese(R.projectId,R.sheetId,_).getValue(),[R,_]),z=P({left:b,right:E,trackId:T},R);return X9.default.createElement(xse,{showPopoverEdgeTriangle:!1,ref:u},X9.default.createElement(RF,{curveConnection:z,additionalConnections:N,onRequestClose:a.closePopover}))})}),Ese,a8,Tse,Mse,Cse,Ase,Pse,g_e=I(()=>{Ese=mn(),a8=Q(qe()),Ft(),m_e(),mse(),Mse=Te.div(Tse||(Tse=J([`
  position: absolute;
`]))),Cse=a8.default.createElement(a8.default.Fragment,null),Ase=a8.default.memo(a=>{let{index:u,track:{data:c}}=a,m=c.keyframes[u],_=c.keyframes[u+1],b=m.connectedRight&&!!_;return a8.default.createElement(Mse,{style:{top:"".concat(a.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,Ese.val)(a.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(m.position,"px))")}},a8.default.createElement(pse,$(P({},a),{itemKey:a.itemKey})),b?a8.default.createElement(Sse,P({},a)):Cse)}),Pse=Ase});function v_e(a,u){return El(a,{displayName:"Keyframe Track",menuItems:()=>{var c;let m=(c=(0,z6.val)(Se().atomP.ahistoric.clipboard.keyframesWithRelativePaths))!=null?c:[];return[y_e(u,m)]}})}function y_e(a,u){return{label:"Paste Keyframes",enabled:u.length>0,callback:()=>{var c;let m=(0,z6.val)(a.layoutP.sheet).getSequence(),_=(c=u[0])==null?void 0:c.pathToProp,b=u.filter(({keyframe:E,pathToProp:T})=>b7e(_,T)).map(({keyframe:E,pathToProp:T})=>E);Se().transaction(({stateEditors:E})=>{var T;m.position=m.closestGridPosition(m.position);let R=(T=__e(b))==null?void 0:T.position;for(let N of b)E.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(P({},a.leaf.sheetObject.address),{trackId:a.leaf.trackId,position:m.position+N.position-R,handles:N.handles,value:N.value,snappingFunction:m.closestGridPosition,type:N.type}))})}}}function __e(a){let u=null;for(let c of a)(u===null||c.position<u.position)&&(u=c);return u}var z6,qm,Rse,Ise,GF,kse,x_e=I(()=>{tr(),z6=mn(),qm=Q(qe()),Ft(),g_e(),Tl(),Ui(),Ae(),Rp(),t8(),Gm(),Ise=Te.div(Rse||(Rse=J([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),GF=qm.default.memo(a=>{var u;let{layoutP:c,trackData:m,leaf:_}=a,[b,E]=Ii(null),{selectedKeyframeIds:T,selection:R}=Gr(()=>{let se=(0,z6.val)(c.selectionAtom),pe=(0,z6.val)(se.pointer.current.byObjectKey[_.sheetObject.address.objectKey].byTrackId[_.trackId].byKeyframeId);return pe?{selectedKeyframeIds:pe,selection:(0,z6.val)(se.pointer.current)}:{selectedKeyframeIds:{},selection:void 0}},[c,_.trackId]),[N,z,G]=v_e(E,a),V=qr(_F),B=V.mode==="snapToSome"?(u=V.positions[_.sheetObject.address.objectKey])==null?void 0:u[_.trackId]:[],j=V.mode==="snapToAll",H=(0,qm.useMemo)(()=>({data:m,id:_.trackId,sheetObject:a.leaf.sheetObject}),[m,_.trackId]),X=m.keyframes.map((se,pe)=>qm.default.createElement(Pse,{key:"keyframe-"+se.id,itemKey:go.forTrackKeyframe(_.sheetObject,_.trackId,se.id),keyframe:se,index:pe,track:H,layoutP:c,leaf:_,selection:T[se.id]===!0?R:void 0})),K=B.map(se=>qm.default.createElement(tS,{key:"snap-target-"+se,layoutP:c,leaf:_,position:se})),te=j?m.keyframes.map(se=>qm.default.createElement(tS,{key:"additionalSnapTarget-".concat(se.id),layoutP:c,leaf:_,position:se.position})):null;return qm.default.createElement(Ise,{ref:b,style:{background:G?"#444850 ":"unset"}},X,K,qm.default.createElement(qm.default.Fragment,null,te),N)}),GF.displayName="BasicKeyframedTrack",kse=GF}),Nse,uS,Dse,Ose,b_e=I(()=>{Ae(),tr(),Nse=mn(),uS=Q(qe()),kC(),x_e(),O9(),Dse=({leaf:a,layoutP:u})=>{let c=D9("PrimitivePropRow",a.pathToProp.join());return Gr(()=>{let{sheetObject:m}=a,{trackId:_}=a,b=(0,Nse.val)(Se().atomP.historic.coreByProject[m.address.projectId].sheetsById[m.address.sheetId].sequence.tracksByObject[m.address.objectKey].trackData[_]);return(b==null?void 0:b.type)!=="BasicKeyframedTrack"?(c.errorDev("trackData type ".concat(b==null?void 0:b.type," is not yet supported on the sequence editor")),uS.default.createElement(F6,{leaf:a,isCollapsed:!1,node:uS.default.createElement("div",null)})):uS.default.createElement(F6,{leaf:a,isCollapsed:!1,node:uS.default.createElement(kse,{layoutP:u,trackData:b,leaf:a})})},[a,u])},Ose=Dse});function S_e(a){return a()}var w_e=I(()=>{});function Fse(a){let{index:u,aggregateKeyframes:c,selection:m}=a;return Gr(Lse(a),[u,c,m,a.viewModel])}function Lse(a){let{index:u,aggregateKeyframes:c,selection:m}=a,{projectId:_,sheetId:b}=a.viewModel.type==="sheet"?a.viewModel.sheet.address:a.viewModel.sheetObject.address;return()=>{let E=c[u],T=c[u+1],R=T&&E.keyframes.length===T.keyframes.length&&E.keyframes.every(({track:V},B)=>T.keyframes[B].track===V)?{length:T.position-E.position,selected:E.selected===0&&T.selected===0}:null,N=R?E.keyframes.map(({kf:V,track:B},j)=>$(P({},B.sheetObject.address),{trackId:B.id,left:V,right:T.keyframes[j].kf})):[],z=S_e(()=>{let V=HF.prism.memo("selectedConnections",()=>ese(_,b,m),[_,b,m]).getValue();return[...N,...V]}),G=N.every(V=>IF(V));return{itemKey:HF.prism.memo("itemKey",()=>a.viewModel.type==="sheet"?go.forSheetAggregateKeyframe(a.viewModel.sheet,E.position):a.viewModel.type==="sheetObject"?go.forSheetObjectAggregateKeyframe(a.viewModel.sheetObject,E.position):go.forCompoundPropAggregateKeyframe(a.viewModel.sheetObject,a.viewModel.pathToProp,E.position),[a.viewModel,E.position]),cur:E,connected:R,isAggregateEditingInCurvePopover:G,allConnections:z}}}var HF,jF=I(()=>{HF=mn(),Gm(),HC(),tr(),B6(),w_e()});function E_e(a,u){let c=(0,_h.useRef)(u);c.current=u;let m=(0,_h.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(_){let b=c.current,E,T=b.aggregateKeyframes[b.index].keyframes,{selection:R,viewModel:N}=b,z=N.type==="sheet"?N.sheet.address:N.sheetObject.address;if(R&&b.aggregateKeyframes[b.index].selected===0)return R.getDragHandlers($(P({},z),{domNode:a,positionAtStartOfDrag:b.aggregateKeyframes[b.index].position})).onDragStart(_);let G=b,V=(0,eA.val)(G.layoutP.sheet).getSequence(),B=(0,eA.val)(G.layoutP.scaledSpace.toUnitSpace);return{onDrag(j,H,X){let K=B(j);E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:te})=>{for(let se of T)te.coreByProject.historic.sheetsById.sequence.transformKeyframes($(P({},se.track.sheetObject.address),{trackId:se.track.id,keyframeIds:[se.kf.id,se.track.data.keyframes[se.track.data.keyframes.indexOf(se.kf)+1].id],translate:K,scale:1,origin:0,snappingFunction:V.closestGridPosition}))})},onDragEnd(j){j?E&&E.commit():E&&E.discard()}}}}),[]);return fa(a,m)}function T_e(a,u){return El(u,{displayName:"Aggregate Tween",menuItems:()=>{let c=a.utils.allConnections.reduce((T,R)=>{var N;return T.concat((N=kF($(P({},R),{keyframeIds:[R.left.id,R.right.id]})))!=null?N:[])},[]),m=wC(c.map(T=>T.pathToProp)),_=c.map(({keyframe:T,pathToProp:R})=>({keyframe:T,pathToProp:R.slice(m.length)})),b=a.editorProps.viewModel,E=b.type==="sheet"?b.sheet.address:b.sheetObject.address;return[{label:"Copy",callback:()=>{if(a.editorProps.selection){let T=jC(E.projectId,E.sheetId,a.editorProps.selection);Se().transaction(R=>{R.stateEditors.studio.ahistoric.setClipboardKeyframes(T)})}else Se().transaction(T=>{T.stateEditors.studio.ahistoric.setClipboardKeyframes(_)})}},{label:"Delete",callback:()=>{a.editorProps.selection?a.editorProps.selection.delete():Se().transaction(({stateEditors:T})=>{for(let R of a.utils.allConnections)T.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(P({},E),{objectKey:R.objectKey,keyframeIds:[R.left.id,R.right.id],trackId:R.trackId}))})}}]}})}var eA,_h,WF,Use,Bse,zse,Vse,M_e=I(()=>{eA=mn(),_h=Q(qe()),yse(),wp(),Ui(),Ae(),Qa(),HC(),jF(),Ft(),Tp(),B6(),Tl(),Rp(),WF=5,Bse=Te(Ep)(Use||(Use=J([`
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: rgba(26, 28, 30, 0.97);
`]))),zse=_h.default.forwardRef((a,u)=>{let{allConnections:c}=Fse(a);return _h.default.createElement(Bse,{showPopoverEdgeTriangle:!1,ref:u},_h.default.createElement(RF,{curveConnection:c[0],additionalConnections:c,onRequestClose:a.closePopover}))}),Vse=a=>{let[u,c]=Ii(null),{editorProps:m}=a,[_]=T_e(a,c),[b]=E_e(c,a.editorProps),{node:E,toggle:T,close:R}=Sp(()=>{let G=(0,eA.val)(m.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:G.screenX+WF,maxX:G.screenX+G.width-WF}}},()=>_h.default.createElement(zse,$(P({},m),{closePopover:R}))),{connected:N,isAggregateEditingInCurvePopover:z}=a.utils;return N||b?_h.default.createElement(_h.default.Fragment,null,_h.default.createElement(BF,{ref:u,connectorLengthInUnitSpace:N?N.length:0,isSelected:N?N.selected:!1,isPopoverOpen:z,openPopover:G=>{c&&T(G,c)}}),E,_):_h.default.createElement(_h.default.Fragment,null)}});function C_e(a){let u={isSelected:a.isSelected,flag:a.flag};return Xm.default.createElement(tA,null,a.isAllHere?Xm.default.createElement(qse,P({},u)):Xm.default.createElement(Xse,P({},u)))}var Xm,$F,Gse,Hse,tA,jse,Wse,qF,XF,YF,KF,$se,qse,Xse,A_e=I(()=>{Xm=Q(qe()),Ft(),AC(),Bi(),$F=16,Gse=$F+2,tA=Te.div(Hse||(Hse=J([`
  position: absolute;
  `,`
  z-index: 1;
`])),yh($F)),Wse=Te.div(jse||(jse=J([`
  z-index: 2;
  cursor: ew-resize;

  position: absolute;
  `,`;
  `,`;

  &:hover
    + `,`,
    #pointer-root.draggingPositionInSequenceEditor
    &:hover
    + `,` {
    `,`
  }
`])),yh(12),Fi,tA,tA,yh(Gse)),qF="#F2C95C",XF="#40AAA4",YF="#45747C",KF=a=>a.isSelected===0?qF:a.isSelected===1?XF:YF,$se=a=>a.isSelected===0?qF:a.isSelected===1?XF:YF,qse=a=>Xm.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xm.default.createElement("rect",{x:"4.46443",y:"10.0078",width:"5",height:"5",transform:"rotate(-45 4.46443 10.0078)",fill:"#212327",stroke:$se(a)}),Xm.default.createElement("rect",{x:"3.75732",y:"6.01953",width:"6",height:"6",transform:"rotate(-45 3.75732 6.01953)",fill:KF(a),stroke:a.flag===2?"white":void 0,strokeWidth:a.flag===2?"2px":void 0})),Xse=a=>Xm.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xm.default.createElement("rect",{x:"4.46443",y:"8",width:"5",height:"5",transform:"rotate(-45 4.46443 8)",fill:"#23262B",stroke:a.flag===2?"white":KF(a),strokeWidth:a.flag===2?"2px":void 0}))});function P_e(a,u){let c=a.children.map(m=>m.type==="propWithChildren"?ZF(m,u):Yse(m,u)).filter(QF);return c.length===0?null:{type:"sheetObject",sheetObject:a.sheetObject,children:c}}function ZF(a,u){let c=a.children.map(m=>m.type==="propWithChildren"?ZF(m,u):Yse(m,u)).filter(QF);return c.length===0?null:{type:"propWithChildren",pathToProp:a.pathToProp,propConfig:a.propConf,children:c}}function Yse(a,u){let c=u.find(m=>m.track.id===a.trackId);return c?{type:"primitiveProp",keyframe:c.kf,pathToProp:a.pathToProp,propConfig:a.propConf,sheetObject:a.sheetObject,trackId:a.trackId}:null}function R_e(a){var u,c,m,_;let{cur:b}=a.utils,E=XC(a.editorProps.viewModel.type==="sheet"?null:a.editorProps.viewModel.type==="sheetObject"?(c=(u=P_e(a.editorProps.viewModel,b.keyframes))==null?void 0:u.children)!=null?c:null:(_=(m=ZF(a.editorProps.viewModel,b.keyframes))==null?void 0:m.children)!=null?_:null),T=q5(a.utils.itemKey);T.useRelations(()=>b.keyframes.map(G=>({affects:G.itemKey,flag:2})),[b.keyframes.map(G=>G.track.id).join("-")]);let[R,N]=Ii(null),[z]=I_e(a,N);return cS.default.createElement(cS.default.Fragment,null,cS.default.createElement(Wse,$(P(P({ref:R},T.attrs),Ml.includePositionSnapAttrs(b.position)),{onClick:G=>a.editorProps.viewModel.type!=="sheet"?E.open(G,R.current):null})),cS.default.createElement(C_e,{flag:T.flag,isAllHere:b.allHere,isSelected:b.selected}),z,E.node)}function I_e(a,u){return El(u,{displayName:"Aggregate Keyframe",menuItems:()=>{let c=a.editorProps.viewModel,m=a.editorProps.selection;return[{label:m?"Copy (selection)":"Copy",callback:()=>{if(m){let{projectId:_,sheetId:b}=c.type==="sheet"?c.sheet.address:c.sheetObject.address,E=jC(_,b,m);Se().transaction(T=>{T.stateEditors.studio.ahistoric.setClipboardKeyframes(E)})}else{let _=a.utils.cur.keyframes.flatMap(R=>{var N;return(N=kF($(P({},R.track.sheetObject.address),{trackId:R.track.id,keyframeIds:[R.kf.id]})))!=null?N:[]}),b=c.type==="sheet"?[]:c.type==="sheetObject"?[c.sheetObject.address.objectKey]:c.type==="propWithChildren"?[c.sheetObject.address.objectKey,...c.pathToProp]:[],E=wC([b,..._.map(R=>R.pathToProp)]),T=_.map(({keyframe:R,pathToProp:N})=>({keyframe:R,pathToProp:N.slice(E.length)}));Se().transaction(R=>{R.stateEditors.studio.ahistoric.setClipboardKeyframes(T)})}}},{label:m?"Delete (selection)":"Delete",callback:()=>{m?m.delete():Se().transaction(({stateEditors:_})=>{for(let b of a.utils.cur.keyframes)_.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(P({},b.track.sheetObject.address),{keyframeIds:[b.kf.id],trackId:b.track.id}))})}}]}})}var cS,QF,k_e=I(()=>{cS=Q(qe()),Ui(),X5(),Tl(),A_e(),Ae(),B6(),Rp(),jd(),KC(),QF=a=>a!==null}),Kse,hS,Zse,Qse,Jse,eae,N_e=I(()=>{Kse=mn(),hS=Q(qe()),Ft(),M_e(),jF(),k_e(),Qse=Te.div(Zse||(Zse=J([`
  position: absolute;
`]))),Jse=hS.default.memo(a=>{let u=Fse(a);return hS.default.createElement(Qse,{style:{top:"".concat(a.viewModel.nodeHeight/2,"px"),left:"calc(".concat((0,Kse.val)(a.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(u.cur.position,"px))")}},hS.default.createElement(R_e,{editorProps:a,utils:u}),hS.default.createElement(Vse,{editorProps:a,utils:u}))}),eae=Jse});function D_e(a){let{layoutP:u,aggregatedKeyframes:c,viewModel:m}=a,_=D9("AggregatedKeyframeTrack"),[b,E]=Ii(null),{selectedPositions:T,selection:R}=O_e(u,c),[N,z,G]=U_e(E,a,()=>_._debug("see aggregatedKeyframes",a.aggregatedKeyframes)),V=(0,xh.useMemo)(()=>[...c.byPosition.entries()].sort((se,pe)=>se[0]-pe[0]).map(([se,pe])=>({position:se,keyframes:pe,selected:T.get(se),allHere:pe.length===c.tracks.length})),[c,T]),B=qr(_F),j=B.mode==="snapToAll",H=B.mode==="snapToSome"?B.positions:bO,X=(0,xh.useMemo)(()=>m.type==="sheet"?R7e(m,H):dF(m,H),[H]).map(se=>xh.default.createElement(tS,{key:"snap-target-"+se,layoutP:u,leaf:m,position:se})),K=(0,xh.useMemo)(()=>V.map(({position:se,keyframes:pe},fe)=>({position:se,editorProps:{index:fe,layoutP:u,viewModel:m,aggregateKeyframes:V,selection:T.has(se)?R:void 0}})),[V,m,T]);G_e(E,se=>{var pe;return(pe=K.find(fe=>fe.position===se))==null?void 0:pe.editorProps},{onClickFromDrag(se){}});let te=K.map((se,pe)=>xh.default.createElement(xh.Fragment,{key:"agg-"+V[pe].keyframes[0].kf.id},j&&xh.default.createElement(tS,{layoutP:u,leaf:m,position:se.position}),xh.default.createElement(eae,P({},se.editorProps))));return xh.default.createElement(iae,{ref:b,style:{background:G?"#444850 ":"unset"}},te,X,N)}function O_e(a,u){return Gr(()=>(0,Al.val)(F_e(a,u)),[a,u])}function F_e(a,u){return(0,Al.prism)(()=>{let c=(0,Al.val)(a.selectionAtom),m=(0,Al.val)(c.pointer.current);if(!m)return sae;let _=new Map;for(let[b,E]of u.byPosition){let T=L_e(E,m);T!==void 0&&T!==rA&&_.set(b,T)}return{selectedPositions:_,selection:(0,Al.val)(c.pointer.current)}})}function L_e(a,u){var c,m,_;let b;for(let{track:E,kf:T}of a){let R=((_=(m=(c=u.byObjectKey[E.sheetObject.address.objectKey])==null?void 0:c.byTrackId[E.id])==null?void 0:m.byKeyframeId)==null?void 0:_[T.id])===!0;b===void 0?R?b=tL:b=rA:R?b===rA&&(b=nL):b===tL&&(b=nL)}return b}function U_e(a,u,c){return El(a,{onOpen:c,displayName:"Aggregate Keyframe Track",menuItems:()=>{var m;let _=(m=(0,Al.pointerToPrism)(Se().atomP.ahistoric.clipboard.keyframesWithRelativePaths).getValue())!=null?m:[];return[B_e(u,_)]}})}function B_e(a,u){return{label:"Paste Keyframes",enabled:u.length>0,callback:()=>{let c=(0,Al.val)(a.layoutP.sheet).getSequence();a.viewModel.type==="sheet"?z_e(a.viewModel,u,c):V_e(a.viewModel,u,c)}}}function z_e(a,u,c){var m;let{projectId:_,sheetId:b,sheetInstanceId:E}=a.sheet.address;if(u.every(({pathToProp:T})=>T.length===0))for(let T of a.children.map(R=>R.sheetObject)){let R=(0,Al.pointerToPrism)(Se().atomP.historic.coreByProject[_].sheetsById[b].sequence.tracksByObject[T.address.objectKey]).getValue(),N=Object.keys((m=R==null?void 0:R.trackData)!=null?m:{});JF(T.address,N,u,c)}else{let T=(0,Al.pointerToPrism)(Se().atomP.historic.coreByProject[_].sheetsById[b].sequence.tracksByObject).getValue(),R=u.map(({keyframe:N,pathToProp:z})=>{var G,V;let B=z[0],j=z.slice(1),H=Pp([...j]),X=((V=(G=T==null?void 0:T[B])==null?void 0:G.trackIdByPropPath)!=null?V:{})[H];return X?{keyframe:N,trackId:X,address:{objectKey:B,projectId:_,sheetId:b,sheetInstanceId:E}}:null}).filter(N=>N!==null);tae(R,c)}}function V_e(a,u,c){var m;let{projectId:_,sheetId:b,objectKey:E}=a.sheetObject.address,T=(0,Al.pointerToPrism)(Se().atomP.historic.coreByProject[_].sheetsById[b].sequence.tracksByObject[E]).getValue();if(u.every(({pathToProp:R})=>R.length===0)){let R=Object.keys((m=T==null?void 0:T.trackData)!=null?m:{});if(a.type==="sheetObject")JF(a.sheetObject.address,R,u,c);else{let N=(T==null?void 0:T.trackIdByPropPath)||{},z=Object.entries(N).filter(([G,V])=>V!==void 0&&x7e(EC(G),a.pathToProp)).map(([G,V])=>V);JF(a.sheetObject.address,z,u,c)}}else{let R=(T==null?void 0:T.trackIdByPropPath)||{},N=a.type==="propWithChildren"?a.pathToProp:[],z=u.map(({keyframe:G,pathToProp:V})=>{let B=Pp([...N,...V]),j=R[B];return j?{keyframe:G,trackId:j,address:a.sheetObject.address}:null}).filter(G=>G!==null);tae(z,c)}}function JF(a,u,c,m){var _;m.position=m.closestGridPosition(m.position);let b=(_=nae(c.map(({keyframe:E})=>E)))==null?void 0:_.position;Se().transaction(({stateEditors:E})=>{for(let T of u)for(let{keyframe:R}of c)E.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(P({},a),{trackId:T,position:m.position+R.position-b,handles:R.handles,value:R.value,snappingFunction:m.closestGridPosition,type:R.type}))})}function tae(a,u){var c;u.position=u.closestGridPosition(u.position);let m=(c=nae(a.map(({keyframe:_})=>_)))==null?void 0:c.position;Se().transaction(({stateEditors:_})=>{for(let{keyframe:b,trackId:E,address:T}of a)_.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(P({},T),{trackId:E,position:u.position+b.position-m,handles:b.handles,value:b.value,snappingFunction:u.closestGridPosition,type:b.type}))})}function nae(a){let u=null;for(let c of a)(u===null||c.position<u.position)&&(u=c);return u}function G_e(a,u,c){let m=D9("useDragForAggregateKeyframeDot"),_=Ure(),b=(0,xh.useMemo)(()=>({debugName:"AggregateKeyframeDot/useDragKeyframe",onDragStart(T){m._debug("onDragStart",{target:T.target});let R=Number(T.target.dataset.pos),N=u(R);if(!N)return m._debug("no props found for ",{positionToFind:R}),!1;_(!0,R);let z=(0,Al.prism)(Lse(N)).getValue().cur.keyframes,G=N.viewModel.type==="sheet"?N.viewModel.sheet.address:N.viewModel.sheetObject.address,V=(0,Al.val)(Se().atomP.historic.coreByProject[G.projectId].sheetsById[G.sheetId].sequence.tracksByObject),B=$re(V,function(K,{trackId:te,objectKey:se}){var pe,fe;return z.every(ye=>K.id!==ye.kf.id)&&!(N.selection&&(fe=(pe=N.selection.byObjectKey[se])==null?void 0:pe.byTrackId[te])!=null&&fe.byKeyframeId[K.id])});if(Wre(B),N.selection&&N.aggregateKeyframes[N.index].selected===0){let{selection:K,viewModel:te}=N,se=K.getDragHandlers($(P({},G),{domNode:a,positionAtStartOfDrag:z[0].kf.position})).onDragStart(T);return se&&$(P({},se),{onClick:c.onClickFromDrag,onDragEnd:(...pe)=>{var fe;(fe=se.onDragEnd)==null||fe.call(se,...pe),e8()}})}let j=N,H=(0,Al.val)(j.layoutP.scaledSpace.toUnitSpace),X;return{onDrag(K,te,se){var pe;let fe=Math.max((pe=Ml.checkIfMouseEventSnapToPos(se,{}))!=null?pe:z[0].kf.position+H(K),0);_(!0,fe),X==null||X.discard(),X=void 0,X=Se().tempTransaction(({stateEditors:ye})=>{for(let Ne of z){let ze=Ne.kf;ye.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(P({},Ne.track.sheetObject.address),{trackId:Ne.track.id,keyframes:[$(P({},ze),{position:fe})],snappingFunction:(0,Al.val)(j.layoutP.sheet).getSequence().closestGridPosition}))}})},onDragEnd(K){_(!1,-1),K?X==null||X.commit():(X==null||X.discard(),c.onClickFromDrag(T)),e8()},onClick(K){c.onClickFromDrag(K)}}}}),[u,c.onClickFromDrag]),[E]=fa(a,b);return mh(E,"draggingPositionInSequenceEditor","ew-resize"),[E]}var Al,xh,rae,iae,sae,aae,nA,eL,tL,nL,rA,rL=I(()=>{tr(),Al=mn(),xh=Q(qe()),Ft(),Tl(),Ui(),N_e(),D6(),O9(),jF(),jd(),Qa(),a0(),dc(),Ae(),Rp(),t8(),XQ(),t8(),D6(),iae=Te.div(rae||(rae=J([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),sae=Object.freeze({selectedPositions:new Map,selection:void 0}),aae=xh.default.memo(D_e),nA=aae,eL=(a=>(a[a.AllSelected=0]="AllSelected",a[a.AtLeastOneUnselected=1]="AtLeastOneUnselected",a[a.NoneSelected=2]="NoneSelected",a))(eL||{}),{AllSelected:tL,AtLeastOneUnselected:nL,NoneSelected:rA}=eL}),V6,iL,oae,H_e=I(()=>{tr(),V6=Q(qe()),b_e(),kC(),rL(),D6(),O9(),iL=(a,u)=>a.type==="propWithChildren"?V6.default.createElement(oae,{layoutP:u,viewModel:a,key:"prop"+a.pathToProp[a.pathToProp.length-1]}):V6.default.createElement(Ose,{layoutP:u,leaf:a,key:"prop"+a.pathToProp[a.pathToProp.length-1]}),oae=({viewModel:a,layoutP:u})=>{let c=D9("RightPropWithChildrenRow",a.pathToProp.join());return Gr(()=>{let m=MC(a);return V6.default.createElement(tY,{logger:c},V6.default.createElement(F6,{leaf:a,node:V6.default.createElement(nA,{layoutP:u,aggregatedKeyframes:m,viewModel:a}),isCollapsed:a.isCollapsed},a.children.map(_=>iL(_,u))))},[a,u])}}),sL,lae,uae,j_e=I(()=>{tr(),sL=Q(qe()),H_e(),kC(),D6(),rL(),lae=({leaf:a,layoutP:u})=>Gr(()=>{let c=MC(a);return sL.default.createElement(F6,{leaf:a,node:sL.default.createElement(nA,{layoutP:u,aggregatedKeyframes:c,viewModel:a}),isCollapsed:a.isCollapsed},a.children.map(m=>iL(m,u)))},[a,u]),uae=lae}),iA,cae,hae,W_e=I(()=>{tr(),iA=Q(qe()),j_e(),kC(),D6(),rL(),cae=({leaf:a,layoutP:u})=>Gr(()=>{let c=MC(a);return iA.default.createElement(F6,{leaf:a,node:iA.default.createElement(nA,{layoutP:u,aggregatedKeyframes:c,viewModel:a}),isCollapsed:a.isCollapsed},a.children.map(m=>iA.default.createElement(uae,{layoutP:u,key:"sheetObject-"+m.sheetObject.address.objectKey,leaf:m})))},[a,u]),hae=cae}),dS,o8,sA,dae,fae,pae,mae,gae=I(()=>{tr(),dS=mn(),o8=Q(qe()),Ft(),N7e(),rie(),W_e(),sA=1e6,fae=Te.ul(dae||(dae=J([`
  margin: 0;
  padding: 0;
  list-style: none;
  position: absolute;
  left: 0;
  width: `,`px;
`])),sA),pae=({layoutP:a})=>Gr(()=>{let u=(0,dS.val)(a.tree),c=(0,dS.val)(a.tree.top)+Math.max((0,dS.val)(a.tree.heightIncludingChildren),(0,dS.val)(a.dopeSheetDims.height));return o8.default.createElement(o8.default.Fragment,null,o8.default.createElement(bF,{layoutP:a,height:c},o8.default.createElement(Tre,{layoutP:a,height:c},o8.default.createElement(fae,{style:{top:u.top+"px"}},o8.default.createElement(hae,{leaf:u,layoutP:a})))))},[a]),mae=pae});function aL(a,u,c,m){let _="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(a,"px)"),b="calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(u,") * 1px)");c===0&&(c=1e-4);let E="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(c,")");m===0&&(m=.001);let T="calc(var(--graphEditorVerticalSpace) * ".concat(m*-1,")");return"translate(".concat(_,", ").concat(b,") scale(").concat(E,", ").concat(T,")")}function $_e(a,u){let{index:c,trackData:m}=u,_=m.keyframes[c],b=m.keyframes[c+1];return El(a,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:E})=>{let{deleteKeyframes:T}=E.coreByProject.historic.sheetsById.sequence;T($(P({},u.sheetObject.address),{trackId:u.trackId,keyframeIds:[_.id,b.id]}))})}}]})}var aA,vae,yae,_ae,xae,bae,oL=I(()=>{L9(),Ae(),Tl(),Ui(),aA=Q(qe()),Ft(),yae=Te.path(vae||(vae=J([`
  stroke-width: 2;
  stroke: var(--main-color);
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),_ae="M 0 0 L 1 0 L 1 1",xae=a=>{let{index:u,trackData:c}=a,m=c.keyframes[u],_=c.keyframes[u+1],b=_.position-m.position,[E,T]=Ii(null),[R]=$_e(T,a),N=a.isScalar?VM(m.value,a.propConfig):0,z=a.isScalar?VM(_.value,a.propConfig):1,G=a.extremumSpace.fromValueSpace(N),V=a.extremumSpace.fromValueSpace(z)-G,B=aL(m.position,G,b,V),j=m.handles[2],H=m.handles[3],X=_.handles[0],K=_.handles[1],te="M 0 0 C ".concat(j," ").concat(H," ").concat(X," ").concat(K," 1 1");return aA.default.createElement(aA.default.Fragment,null,aA.default.createElement(yae,{ref:E,d:!m.type||m.type==="bezier"?te:_ae,style:{transform:B}}),R)},bae=xae});function q_e(a,u){let c=(0,l8.useRef)(u);c.current=u;let m=(0,l8.useMemo)(()=>({debugName:"CurveHandler/useOurDrags",lockCSSCursorTo:"move",onDragStart(){let _,b=c.current,E=(0,fS.val)(b.layoutP.scaledSpace.toUnitSpace),T=(0,fS.val)(b.layoutP.graphEditorVerticalSpace.toExtremumSpace),R=b.extremumSpace.lock();return{onDrag(N,z){_&&(_.discard(),_=void 0);let{index:G,trackData:V}=b,B=V.keyframes[G],j=V.keyframes[G+1],H=E(N)/(j.position-B.position),X=-z,K=T(X),te=b.extremumSpace.deltaToValueSpace(K),se=u.isScalar?B.value:0,pe=u.isScalar?j.value:1,fe=te/(pe-se);if(b.which==="left"){let ye=ii(B.handles[2]+H,0,1),Ne=B.handles[3]+fe;_=Se().tempTransaction(({stateEditors:ze})=>{ze.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(P({},b.sheetObject.address),{snappingFunction:(0,fS.val)(b.layoutP.sheet).getSequence().closestGridPosition,trackId:b.trackId,keyframes:[$(P({},B),{handles:[B.handles[0],B.handles[1],ye,Ne]})]}))})}else{let ye=ii(j.handles[0]+H,0,1),Ne=j.handles[1]+fe;_=Se().tempTransaction(({stateEditors:ze})=>{ze.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(P({},b.sheetObject.address),{trackId:b.trackId,snappingFunction:(0,fS.val)(b.layoutP.sheet).getSequence().closestGridPosition,keyframes:[$(P({},j),{handles:[ye,Ne,j.handles[2],j.handles[3]]})]}))})}},onDragEnd(N){R(),N?_&&_.commit():_&&_.discard()}}}}),[]);fa(a,m)}function X_e(a,u){return El(a,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:c})=>{c.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(P({},u.sheetObject.address),{keyframeIds:[u.keyframe.id],trackId:u.trackId}))})}}]})}var fS,l8,Sae,lL,wae,Eae,Tae,Mae,Cae,uL,Y_e=I(()=>{Ae(),Tl(),Qa(),Ui(),fS=mn(),Ua(),l8=Q(qe()),Ft(),oL(),Bi(),lL=Te.circle(Sae||(Sae=J([`
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;
  fill: var(--main-color);
  r: 2px;
  pointer-events: none;
`]))),Eae=Te.circle(wae||(wae=J([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  cursor: move;
  `,`;
  &:hover {
  }
  &:hover + `,` {
    r: 6px;
  }
`])),Fi,lL),Mae=Te.path(Tae||(Tae=J([`
  stroke-width: 1;
  stroke: var(--main-color);
  /* stroke: gray; */
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),Cae=a=>{let[u,c]=Ii(null),{index:m,trackData:_}=a,b=_.keyframes[m],E=_.keyframes[m+1],[T]=X_e(c,a);q_e(c,a);let R=a.which==="left"?b.handles[2]:E.handles[0],N=b.position+(E.position-b.position)*R,z=a.which==="left"?b.handles[3]:E.handles[1],G=a.isScalar?b.value:0,V=a.isScalar?E.value:1,B=G+(V-G)*z,j=a.extremumSpace.fromValueSpace(B),H=j-a.extremumSpace.fromValueSpace(a.which==="left"?G:V),X=aL(a.which==="left"?b.position:E.position,a.extremumSpace.fromValueSpace(a.which==="left"?G:V),N-(a.which==="left"?b.position:E.position),H);return l8.default.createElement("g",null,l8.default.createElement(Eae,{ref:u,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(N," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(j,") * 1px)")}}),l8.default.createElement(lL,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(N," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(j,") * 1px)")}}),l8.default.createElement(Mae,{d:"M 0 0 L 1 1",style:{transform:X}}),T)},uL=Cae});function K_e(a){let[u,c]=(0,Y9.useState)(!1);$m(u,a.props.keyframe.position);let m=(0,Y9.useRef)(a.props);m.current=a.props;let _=(0,Y9.useMemo)(()=>({debugName:"GraphEditorDotScalar/useDragKeyframe",lockCSSCursorTo:"move",onDragStart(b){c(!0);let E=!!b.altKey,T=m.current,R=(0,oA.val)(T.layoutP.scaledSpace.toUnitSpace),N=(0,oA.val)(T.layoutP.graphEditorVerticalSpace.toExtremumSpace),z=T.extremumSpace.lock(),G;return{onDrag(V,B){let j=T.trackData.keyframes[T.index],H=R(V),X=-B,K=N(X),te=T.extremumSpace.deltaToValueSpace(K),se=[],pe=$(P({},j),{position:j.position+H,value:j.value+te,handles:[...j.handles]});if(se.push(pe),E){let fe=T.trackData.keyframes[T.index-1];if(fe&&Math.abs(j.value-fe.value)>0){let Ne=$(P({},fe),{handles:[...fe.handles]});se.push(Ne),Ne.handles[3]=Q_e(fe.handles[3],fe.value,fe.value,j.value,pe.value)}let ye=T.trackData.keyframes[T.index+1];if(ye&&Math.abs(j.value-ye.value)>0){let Ne=$(P({},ye),{handles:[...ye.handles]});se.push(Ne),Ne.handles[1]=J_e(Ne.handles[1],Ne.value,Ne.value,j.value,pe.value)}}G==null||G.discard(),G=Se().tempTransaction(({stateEditors:fe})=>{fe.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(P({},T.sheetObject.address),{trackId:T.trackId,keyframes:se,snappingFunction:(0,oA.val)(T.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(V){c(!1),z(),V?G==null||G.commit():(G==null||G.discard(),a.onDetectedClick(b))}}}}),[]);return fa(a.node,_),mh(u,"draggingPositionInSequenceEditor","move"),u}function Z_e(a,u){return El(a,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:c})=>{c.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(P({},u.sheetObject.address),{keyframeIds:[u.keyframe.id],trackId:u.trackId}))})}}]})}function Q_e(a,u,c,m,_){return(m-u)*a/(_-c)}function J_e(a,u,c,m,_){return((u-m)*a+m-u+c-_)/(c-_)}var oA,Y9,Aae,cL,Pae,Rae,Iae,kae,exe=I(()=>{Ae(),Tl(),Qa(),Ui(),oA=mn(),Y9=Q(qe()),Ft(),a0(),a0(),Bi(),dc(),jd(),KC(),X5(),cL=Te.circle(Aae||(Aae=J([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),Rae=Te.circle(Pae||(Pae=J([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: move;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Fi,cL,Lm),Iae=a=>{let[u,c]=Ii(null),{index:m,trackData:_}=a,b=_.keyframes[m],[E]=Z_e(c,a),T=q5(a.itemKey),R=b.value,N=a.extremumSpace.fromValueSpace(R),z=XC([{type:"primitiveProp",keyframe:a.keyframe,pathToProp:a.pathToProp,propConfig:a.propConfig,sheetObject:a.sheetObject,trackId:a.trackId}]),G=K_e({node:c,props:a,onDetectedClick:V=>z.toggle(V,V.target instanceof Element?V.target:c)});return Y9.default.createElement(Y9.default.Fragment,null,Y9.default.createElement(Rae,$(P(P(P({ref:u,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(b.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(N,") * 1px)")}},Ip(b.position)),Ml.includePositionSnapAttrs(b.position)),T.attrs),{className:G?"beingDragged":""})),Y9.default.createElement(cL,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(b.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(N,") * 1px)"),fill:T.flag===2?"white":void 0}}),z.node,E)},kae=Iae});function txe(a){let[u,c]=(0,K9.useState)(!1);$m(u,a.props.keyframe.position);let m=(0,K9.useRef)(a.props);m.current=a.props;let _=(0,K9.useMemo)(()=>({debugName:"GraphEditorDotNonScalar/useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(b){c(!0);let E=m.current,T=(0,hL.val)(E.layoutP.scaledSpace.toUnitSpace),R=E.extremumSpace.lock(),N;return{onDrag(z,G){let V=E.trackData.keyframes[E.index],B=T(z),j=[],H=$(P({},V),{position:V.position+B,value:V.value,handles:[...V.handles]});j.push(H),N==null||N.discard(),N=Se().tempTransaction(({stateEditors:X})=>{X.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(P({},E.sheetObject.address),{trackId:E.trackId,keyframes:j,snappingFunction:(0,hL.val)(E.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(z){c(!1),R(),z?N==null||N.commit():(N==null||N.discard(),a.onDetectedClick(b))}}}}),[]);return fa(a.node,_),mh(u,"draggingPositionInSequenceEditor","ew-resize"),u}function nxe(a,u){return El(a,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:c})=>{c.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(P({},u.sheetObject.address),{keyframeIds:[u.keyframe.id],trackId:u.trackId}))})}}]})}var hL,K9,Nae,dL,Dae,Oae,Fae,fL,rxe=I(()=>{Ae(),Tl(),Qa(),Ui(),hL=mn(),K9=Q(qe()),Ft(),a0(),a0(),Bi(),dc(),jd(),KC(),X5(),dL=Te.circle(Nae||(Nae=J([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),Oae=Te.circle(Dae||(Dae=J([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: ew-resize;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Fi,dL,Lm),Fae=a=>{let[u,c]=Ii(null),{index:m,trackData:_,itemKey:b}=a,E=_.keyframes[m],[T]=nxe(c,a),R=q5(b),N=a.which==="left"?0:1,z=XC([{type:"primitiveProp",keyframe:a.keyframe,pathToProp:a.pathToProp,propConfig:a.propConfig,sheetObject:a.sheetObject,trackId:a.trackId}]),G=txe({node:c,props:a,onDetectedClick:B=>z.toggle(B,B.target instanceof Element?B.target:c)}),V=a.extremumSpace.fromValueSpace(N);return K9.default.createElement(K9.default.Fragment,null,K9.default.createElement(Oae,$(P(P(P({ref:u,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(E.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(V,") * 1px)")}},R.attrs),Ip(E.position)),Ml.includePositionSnapAttrs(E.position)),{className:G?"beingDragged":""})),K9.default.createElement(dL,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(E.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(V,") * 1px)"),fill:R.flag===2?"white":void 0}}),z.node,T)},fL=Fae}),lA,Lae,Uae,Bae,zae,ixe=I(()=>{lA=Q(qe()),Ft(),oL(),Uae=Te.path(Lae||(Lae=J([`
  stroke-width: 2;
  stroke: var(--main-color);
  stroke-dasharray: 3 2;
  fill: none;
  vector-effect: non-scaling-stroke;
  opacity: 0.3;
`]))),Bae=a=>{let{index:u,trackData:c}=a,m="M 0 0 L 1 1",_=aL(c.keyframes[u].position,a.extremumSpace.fromValueSpace(0),0,a.extremumSpace.fromValueSpace(1)-a.extremumSpace.fromValueSpace(0));return lA.default.createElement(lA.default.Fragment,null,lA.default.createElement(Uae,{d:m,style:{transform:_}}))},zae=Bae}),l0,Vae,Gae,Hae,jae,Wae,sxe=I(()=>{l0=Q(qe()),Ft(),oL(),Y_e(),exe(),rxe(),ixe(),Gae=Te.g(Vae||(Vae=J([`
  /* position: absolute; */
`]))),Hae=l0.default.createElement(l0.default.Fragment,null),jae=a=>{let{index:u,trackData:c,isScalar:m}=a,_=c.keyframes[u],b=c.keyframes[u+1],E=_.connectedRight&&!!b&&b.value!==_.value;return l0.default.createElement(Gae,null,E?l0.default.createElement(l0.default.Fragment,null,l0.default.createElement(bae,P({},a)),!_.type||_.type==="bezier"&&l0.default.createElement(l0.default.Fragment,null,l0.default.createElement(uL,$(P({},a),{which:"left"})),l0.default.createElement(uL,$(P({},a),{which:"right"})))):Hae,m?l0.default.createElement(kae,P({},a)):l0.default.createElement(l0.default.Fragment,null,l0.default.createElement(fL,$(P({},a),{which:"left"})),l0.default.createElement(fL,$(P({},a),{which:"right"})),l0.default.createElement(zae,P({},a))))},Wae=jae});function axe(a,u){let c=1/0,m=-1/0;function _(b){c=Math.min(b,c),m=Math.max(b,m)}return a.forEach((b,E)=>{let T=VM(b.value,u);if(_(T),!b.connectedRight)return;let R=a[E+1];if(!R)return;let N=(typeof R.value=="number"?R.value:1)-T;_(T+b.handles[3]*N),_(T+R.handles[1]*N)}),[c,m]}function oxe(a){let u=0,c=1;function m(_){u=Math.min(_,u),c=Math.max(_,c)}return a.forEach((_,b)=>{if(!_.connectedRight)return;let E=a[b+1];E&&(m(_.handles[3]),m(E.handles[1]))}),[u,c]}var Np,$ae,qae,lxe=I(()=>{Gm(),Np=Q(qe()),cA(),sxe(),L9(),tr(),$ae=Np.default.memo(({layoutP:a,trackData:u,sheetObject:c,trackId:m,color:_,pathToProp:b})=>{let E=zM(qr(c.template.configPointer),b);if(Cp(E))return console.error("Composite prop types cannot be keyframed"),Np.default.createElement(Np.default.Fragment,null);let[T,R]=(0,Np.useState)(!1),N=(0,Np.useMemo)(()=>{let B=new Set;return function(){let j=B.size===0;B.add(H),j&&R(!0);function H(){let X=B.size>0;B.delete(H),X&&B.size===0&&R(!1)}return H}},[]),z=(0,Np.useMemo)(()=>{let B=E.type==="number"?axe(u.keyframes,E):oxe(u.keyframes),j=K=>(K-B[0])/(B[1]-B[0]),H=K=>B[0]+X(K),X=K=>K*(B[1]-B[0]);return{fromValueSpace:j,toValueSpace:H,deltaToValueSpace:X,lock:N}},[u.keyframes]),G=(0,Np.useRef)(void 0);T||(G.current=z);let V=u.keyframes.map((B,j)=>Np.default.createElement(Wae,{pathToProp:b,propConfig:E,itemKey:go.forTrackKeyframe(c,m,B.id),keyframe:B,index:j,trackData:u,layoutP:a,sheetObject:c,trackId:m,isScalar:E.type==="number",key:B.id,extremumSpace:G.current,color:_}));return Np.default.createElement("g",{style:{"--main-color":pS[_].iconColor}},V)}),qae=$ae}),Xae,uA,Yae,Kae,uxe=I(()=>{Ae(),tr(),Xae=mn(),uA=Q(qe()),lxe(),Yae=a=>Gr(()=>{let{sheetObject:u,trackId:c}=a,m=(0,Xae.val)(Se().atomP.historic.coreByProject[u.address.projectId].sheetsById[u.address.sheetId].sequence.tracksByObject[u.address.objectKey].trackData[c]);return(m==null?void 0:m.type)!=="BasicKeyframedTrack"?(console.error("trackData type ".concat(m==null?void 0:m.type," is not yet supported on the graph editor")),uA.default.createElement(uA.default.Fragment,null)):uA.default.createElement(qae,$(P({},a),{trackData:m}))},[a.trackId,a.layoutP]),Kae=Yae});function Zae({clippedSpaceRange:a,clippedSpaceWidth:u,fps:c,gapWidth:m=120},_){let b=1/c,E=a.end-a.start,T=u/(c*E),R=Math.floor(m/T),N=(R<c?Qae(c).find(V=>V>=R):c*Math.floor(R/c))*b,z=Math.floor(a.start/N),G=Math.ceil(a.end/N);for(let V=z;V<=G;V++){let B=V*N,j=B%1===0;_(B,j)}}var Qae,Jae=I(()=>{Ua(),Qae=Yf(a=>{let u=[];for(let c=1;c<=a;c++)a%c===0&&u.push(c);return u})});function cxe(a){let{clippedSpaceWidth:u,height:c,ctx:m,unitSpaceToClippedSpace:_,snapToGrid:b}=a;m.clearRect(0,0,u,c),Zae(a,(E,T)=>{let R=b(E),N=Math.floor(_(R));m.strokeStyle=T?"rgba(225, 225, 225, 0.04)":"rgba(255, 255, 255, 0.01)",m.beginPath(),m.moveTo(N,0),m.lineTo(N,c),m.stroke(),m.closePath()})}var u8,c8,eoe,toe,noe,roe,ioe,soe,aoe,ooe,pL,loe=I(()=>{u8=mn(),c8=Q(qe()),Ft(),Jae(),Ae(),toe=Te.div(eoe||(eoe=J([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),roe=Te.canvas(noe||(noe=J([`
  position: relative;
  left: 0;
`]))),ioe=a=>{let u=a;return u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1},soe=()=>window.devicePixelRatio||1,aoe=a=>soe()/ioe(a),ooe=({layoutP:a,width:u,height:c})=>{let m=(0,c8.useRef)(null),[_,b]=(0,c8.useState)(null),{ctx:E,ratio:T}=(0,c8.useMemo)(()=>{if(!_)return{};let R=_.getContext("2d"),N=aoe(R);return{ctx:R,ratio:N}},[_]);return(0,c8.useLayoutEffect)(()=>{if(!E)return;_.width=u*T,_.height=c*T;let R=(0,u8.prism)(()=>{let N=(0,u8.val)(a.sheet).getSequence();return{ctx:E,clippedSpaceRange:(0,u8.val)(a.clippedSpace.range),clippedSpaceWidth:(0,u8.val)(a.clippedSpace.width),unitSpaceToClippedSpace:(0,u8.val)(a.clippedSpace.fromUnitSpace),height:c,leftPadding:(0,u8.val)(a.scaledSpace.leftPadding),fps:N.subUnitsPerUnit,snapToGrid:z=>N.closestGridPosition(z)}}).onChange(Se().ticker,N=>{E.save(),E.scale(T,T),cxe(N),E.restore()},!0);return()=>{R()}},[E,u,c,a]),c8.default.createElement(toe,{ref:m,style:{width:u+"px"}},c8.default.createElement(roe,{ref:b,style:{width:u+"px",height:c+"px"}}))},pL=ooe}),Dp,h8,pS,uoe,coe,hoe,doe,foe,poe,cA=I(()=>{Ae(),Rp(),WM(),tr(),Dp=mn(),h8=Q(qe()),Ft(),gae(),rie(),uxe(),loe(),hc(),pS={1:{iconColor:"#b98b08"},2:{iconColor:"#70a904"},3:{iconColor:"#2e928a"},4:{iconColor:"#a943bb"},5:{iconColor:"#b90808"},6:{iconColor:"#b4bf0e"}},coe=Te.div(uoe||(uoe=J([`
  position: absolute;
  right: 0;
  bottom: 0;
  background: `,`;
`])),Fd(.03,"#1a1c1e")),doe=Te.svg(hoe||(hoe=J([`
  position: absolute;
  top: 0;
  left: 0;
  margin: 0;
  pointer-events: none;
`]))),foe=({layoutP:a})=>Gr(()=>{let u=(0,Dp.val)(a.sheet),c=(0,Dp.val)(Se().atomP.historic.projects.stateByProjectId[u.address.projectId].stateBySheetId[u.address.sheetId].sequenceEditor.selectedPropsByObject),m=(0,Dp.val)(a.graphEditorDims.height),_=(0,Dp.val)(a.scaledSpace.fromUnitSpace)(1),b=[];if(c)for(let[T,R]of Object.entries(c)){let N=u.getObject(T);if(!N)continue;let z=(0,Dp.val)(N.template.getMapOfValidSequenceTracks_forStudio());for(let[G,V]of Object.entries(R)){let B=EC(G),j=B9(z,B);j&&b.push(h8.default.createElement(Kae,{key:"graph-".concat(T,"-").concat(G),sheetObject:N,pathToProp:B,layoutP:a,trackId:j,color:V}))}}let E=(0,Dp.val)(a.rightDims.width);return h8.default.createElement(coe,{style:{width:E+"px",height:m+"px","--unitSpaceToScaledSpaceMultiplier":_,"--graphEditorVerticalSpace":"".concat((0,Dp.val)(a.graphEditorVerticalSpace.space))}},h8.default.createElement(pL,{layoutP:a,width:E,height:m}),h8.default.createElement(bF,{layoutP:a,height:m},h8.default.createElement(doe,{width:sA,height:m,viewBox:"0 0 ".concat(sA," ").concat(m)},h8.default.createElement("g",{style:{transform:"translate(".concat((0,Dp.val)(a.scaledSpace.leftPadding),"px, ").concat((0,Dp.val)(a.graphEditorDims.padding.top),"px)")}},b))))},[a]),poe=foe}),moe,bh,goe,voe,yoe,_oe,mL,xoe,boe,Soe,woe,Eoe,Toe,Moe,hxe=I(()=>{Ae(),Rp(),$M(),tr(),moe=mn(),bh=Q(qe()),Ft(),TO(),ZM(),cA(),SC(),$5(),nre(),goe={label:{color:"#9a9a9a"}},yoe=Te(sF)(voe||(voe=J([""]))),mL=Te(aF)(_oe||(_oe=J([`
  display: flex;
  color: `,`;
  padding-right: 12px;
  align-items: center;
  justify-content: flex-end;
  box-sizing: border-box;
`])),goe.label.color),boe=Te.button(xoe||(xoe=J([`
  background: none;
  border: none;
  outline: none;
  display: flex;
  box-sizing: border-box;
  font-size: 14px;
  align-items: center;
  height: 100%;
  margin-left: 12px;
  color: `,`;

  &:not([disabled]):hover {
    color: white;
  }
`])),a=>a.isSelected?pS[a.graphEditorColor].iconColor:z9.offColor),Soe=()=>bh.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"12",viewBox:"0 0 640 512"},bh.default.createElement("g",{transform:"translate(0 100)"},bh.default.createElement("path",{fill:"currentColor",d:"M368 32h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM208 88h-84.75C113.75 64.56 90.84 48 64 48 28.66 48 0 76.65 0 112s28.66 64 64 64c26.84 0 49.75-16.56 59.25-40h79.73c-55.37 32.52-95.86 87.32-109.54 152h49.4c11.3-41.61 36.77-77.21 71.04-101.56-3.7-8.08-5.88-16.99-5.88-26.44V88zm-48 232H64c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zM576 48c-26.84 0-49.75 16.56-59.25 40H432v72c0 9.45-2.19 18.36-5.88 26.44 34.27 24.35 59.74 59.95 71.04 101.56h49.4c-13.68-64.68-54.17-119.48-109.54-152h79.73c9.5 23.44 32.41 40 59.25 40 35.34 0 64-28.65 64-64s-28.66-64-64-64zm0 272h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32z"}))),Eoe=Te.span(woe||(woe=J([`
  margin-right: 4px;
  `,`;

  `,`:hover & {
    color: #ccc;
  }
`])),U9,mL),Toe=({leaf:a})=>{var u;let c=Rb(a.sheetObject.propsP,a.pathToProp),m=a.sheetObject,{controlIndicators:_}=EO(c,m,a.propConf),b=Gr(()=>{let G=a.sheetObject.address,V=Pp(a.pathToProp);return(0,moe.val)(Se().atomP.historic.projects.stateByProjectId[G.projectId].stateBySheetId[G.sheetId].sequenceEditor.selectedPropsByObject[G.objectKey][V])},[a]),E=(0,bh.useRef)(!1),T=typeof b=="string";E.current=T;let R=(0,bh.useCallback)(()=>{let G=a.sheetObject.address;Se().transaction(({stateEditors:V})=>{E.current?V.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removePropFromGraphEditor($(P({},G),{pathToProp:a.pathToProp})):(V.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.addPropToGraphEditor($(P({},G),{pathToProp:a.pathToProp})),V.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!0}))})},[a]),N=(u=a.propConf.label)!=null?u:a.pathToProp[a.pathToProp.length-1],z=(0,bh.useRef)(null);return ere(z.current,a),bh.default.createElement(yoe,{depth:a.depth},bh.default.createElement(mL,{ref:z,isEven:a.n%2===0,style:{height:a.nodeHeight+"px"},isSelected:T===!0},bh.default.createElement(Eoe,null,N),_,bh.default.createElement(boe,{onClick:R,isSelected:T===!0,graphEditorColor:b??"1",style:{opacity:1},disabled:!1},bh.default.createElement(Soe,null))))},Moe=Toe});function gL(a,u){Se().transaction(({stateEditors:c})=>{c.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.sequenceEditorCollapsableItems.set($(P({},u.sheetAddress),{studioSheetItemKey:u.sheetItemKey,isCollapsed:a}))})}var vL=I(()=>{Ae()}),G6,yL,Coe,dxe=I(()=>{G6=Q(qe()),SC(),hxe(),vL(),yL=a=>{let u="prop"+a.pathToProp[a.pathToProp.length-1];return a.shouldRender?a.type==="propWithChildren"?G6.default.createElement(Coe,{leaf:a,key:u}):G6.default.createElement(Moe,{leaf:a,key:u}):G6.default.createElement(G6.default.Fragment,{key:u})},Coe=({leaf:a})=>G6.default.createElement(bC,{leaf:a,label:a.pathToProp[a.pathToProp.length-1],isCollapsed:a.isCollapsed,toggleCollapsed:()=>gL(!a.isCollapsed,{sheetAddress:a.sheetObject.address,sheetItemKey:a.sheetItemKey})},a.children.map(u=>yL(u)))}),Aoe,Poe,Roe,fxe=I(()=>{Aoe=Q(qe()),SC(),dxe(),vL(),Ae(),Poe=({leaf:a})=>Aoe.default.createElement(bC,{leaf:a,label:a.sheetObject.address.objectKey,isCollapsed:a.isCollapsed,toggleSelect:()=>{Se().transaction(({stateEditors:u})=>{u.studio.historic.panels.outline.selection.set([a.sheetObject])})},toggleCollapsed:()=>gL(!a.isCollapsed,{sheetAddress:a.sheetObject.address,sheetItemKey:a.sheetItemKey})},a.children.map(u=>yL(u))),Roe=Poe}),_L,Ioe,koe,pxe=I(()=>{tr(),_L=Q(qe()),fxe(),SC(),vL(),GJ(),Ioe=({leaf:a})=>Gr(()=>_L.default.createElement(bC,{leaf:a,label:a.sheet.address.sheetId,isCollapsed:a.isCollapsed,toggleCollapsed:()=>{gL(!a.isCollapsed,{sheetAddress:a.sheet.address,sheetItemKey:a.sheetItemKey})}},a.children.map(u=>_L.default.createElement(Roe,{key:"sheetObject-"+zJ(u.sheetObject),leaf:u}))),[a]),koe=Ioe}),xL,hA,Noe,Doe,Ooe,Foe,Loe,Uoe,mxe=I(()=>{tr(),xL=mn(),hA=Q(qe()),Ft(),pxe(),Doe=Te.div(Noe||(Noe=J([`
  position: absolute;
  left: 0;
  overflow-x: visible;
`]))),Foe=Te.ul(Ooe||(Ooe=J([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),Loe=({layoutP:a})=>Gr(()=>{let u=(0,xL.val)(a.tree),c=(0,xL.val)(a.leftDims.width);return hA.default.createElement(Doe,{style:{width:c+"px",top:u.top+"px"}},hA.default.createElement(Foe,null,hA.default.createElement(koe,{leaf:u})))},[a]),Uoe=Loe}),bL,Boe,zoe,Voe,Goe,gxe=I(()=>{Bi(),Qm(),tr(),hc(),bL=Q(qe()),Ft(),loe(),zoe=Te.div(Boe||(Boe=J([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: hidden;
  background: `,`;
  pointer-events: none;
`])),()=>zp.rightBackground,Fd(.01,ib(1*.03,h6.panel.bg))),Voe=({layoutP:a})=>{let u=qr(a.rightDims.width),c=qr(a.panelDims.height);return bL.default.createElement(zoe,{style:{width:u+"px"}},bL.default.createElement(pL,{width:u,height:c,layoutP:a}))},Goe=Voe}),H6,Hoe,joe,Woe,$oe,vxe=I(()=>{tr(),H6=Q(qe()),Ft(),mxe(),gxe(),gae(),Ire(),joe=Te.div(Hoe||(Hoe=J([`
  position: absolute;
  left: 0;
  right: 0;
`]))),Woe=({layoutP:a})=>{let u=qr(a.dopeSheetDims.height);return H6.default.createElement(joe,{style:{height:u+"px"}},H6.default.createElement(Goe,{layoutP:a}),H6.default.createElement(Rre,null,H6.default.createElement(Uoe,{layoutP:a}),H6.default.createElement(mae,{layoutP:a})))},$oe=Woe});function yxe(a,u,c){return SL.prism.memo(a,()=>(0,SL.prism)(u),c).getValue()}var SL,_xe=I(()=>{SL=mn()});function Ds(a){return function(u,c){return a(u,c())}}function pc(a){return Object.freeze({audience:d8(a,8)?"internal":d8(a,16)?"dev":"public",category:d8(a,4)?"troubleshooting":d8(a,2)?"todo":"general",level:d8(a,512)?512:d8(a,256)?256:d8(a,128)?128:64})}function d8(a,u){return(a&u)===u}function Os(a,u){return((u&32)===32?!0:(u&16)===16?a.dev:(u&8)===8?a.internal:!1)&&a.min<=u}function qoe(a=console,u={}){let c=$(P({},Op),{includes:P({},Op.includes)}),m={styled:Sxe.bind(c,a),noStyle:Exe.bind(c,a)},_=bxe.bind(c);function b(){return c.loggingConsoleStyle&&c.loggerConsoleStyle?m.styled:m.noStyle}return c.create=b(),{configureLogger(E){var T;E==="console"?(c.loggerConsoleStyle=Op.loggerConsoleStyle,c.create=b()):E.type==="console"?(c.loggerConsoleStyle=(T=E.style)!=null?T:Op.loggerConsoleStyle,c.create=b()):E.type==="keyed"?(c.creatExt=R=>E.keyed(R.names),c.create=_):E.type==="named"&&(c.creatExt=xxe.bind(null,E.named),c.create=_)},configureLogging(E){var T,R,N,z,G;c.includes.dev=(T=E.dev)!=null?T:Op.includes.dev,c.includes.internal=(R=E.internal)!=null?R:Op.includes.internal,c.includes.min=(N=E.min)!=null?N:Op.includes.min,c.include=(z=E.include)!=null?z:Op.include,c.loggingConsoleStyle=(G=E.consoleStyle)!=null?G:Op.loggingConsoleStyle,c.create=b()},getLogger(){return c.create({names:[]})}}}function xxe(a,u){let c=[];for(let{name:m,key:_}of u.names)c.push(_==null?m:"".concat(m," (").concat(_,")"));return a(c)}function bxe(a){let u=P(P({},this.includes),this.include(a)),c=this.filtered,m=this.named.bind(this,a),_=this.creatExt(a),b=Os(u,524),E=Os(u,522),T=Os(u,521),R=Os(u,529),N=Os(u,545),z=Os(u,265),G=Os(u,268),V=Os(u,273),B=Os(u,289),j=Os(u,137),H=Os(u,145),X=Os(u,73),K=Os(u,81),te=b?_.error.bind(_,vu._hmm):c.bind(a,524),se=E?_.error.bind(_,vu._todo):c.bind(a,522),pe=T?_.error.bind(_,vu._error):c.bind(a,521),fe=R?_.error.bind(_,vu.errorDev):c.bind(a,529),ye=N?_.error.bind(_,vu.errorPublic):c.bind(a,545),Ne=G?_.warn.bind(_,vu._kapow):c.bind(a,268),ze=z?_.warn.bind(_,vu._warn):c.bind(a,265),Me=V?_.warn.bind(_,vu.warnDev):c.bind(a,273),je=B?_.warn.bind(_,vu.warnPublic):c.bind(a,273),yt=j?_.debug.bind(_,vu._debug):c.bind(a,137),xe=H?_.debug.bind(_,vu.debugDev):c.bind(a,145),We=X?_.trace.bind(_,vu._trace):c.bind(a,73),ae=K?_.trace.bind(_,vu.traceDev):c.bind(a,81),nt={_hmm:te,_todo:se,_error:pe,errorDev:fe,errorPublic:ye,_kapow:Ne,_warn:ze,warnDev:Me,warnPublic:je,_debug:yt,debugDev:xe,_trace:We,traceDev:ae,lazy:{_hmm:b?Ds(te):te,_todo:E?Ds(se):se,_error:T?Ds(pe):pe,errorDev:R?Ds(fe):fe,errorPublic:N?Ds(ye):ye,_kapow:G?Ds(Ne):Ne,_warn:z?Ds(ze):ze,warnDev:V?Ds(Me):Me,warnPublic:B?Ds(je):je,_debug:j?Ds(yt):yt,debugDev:H?Ds(xe):xe,_trace:X?Ds(We):We,traceDev:K?Ds(ae):ae},named:m,utilFor:{internal(){return{debug:nt._debug,error:nt._error,warn:nt._warn,trace:nt._trace,named(dn,Ve){return nt.named(dn,Ve).utilFor.internal()}}},dev(){return{debug:nt.debugDev,error:nt.errorDev,warn:nt.warnDev,trace:nt.traceDev,named(dn,Ve){return nt.named(dn,Ve).utilFor.dev()}}},public(){return{error:nt.errorPublic,warn:nt.warnPublic,debug(dn,Ve){nt._warn('(public "debug" filtered out) '.concat(dn),Ve)},trace(dn,Ve){nt._warn('(public "trace" filtered out) '.concat(dn),Ve)},named(dn,Ve){return nt.named(dn,Ve).utilFor.public()}}}}};return nt}function Sxe(a,u){let c=P(P({},this.includes),this.include(u)),m=[],_="";for(let R=0;R<u.names.length;R++){let{name:N,key:z}=u.names[R];if(_+=" %c".concat(N),m.push(this.style.css(N)),z!=null){let G="%c#".concat(z);_+=G,m.push(this.style.css(G))}}let b=this.filtered,E=this.named.bind(this,u),T=[_,...m];return Xoe(b,u,c,a,T,wxe(T),E)}function wxe(a){let u=a.slice(0);for(let c=1;c<u.length;c++)u[c]+=";background-color:#e0005a;padding:2px;color:white";return u}function Exe(a,u){let c=P(P({},this.includes),this.include(u)),m="";for(let T=0;T<u.names.length;T++){let{name:R,key:N}=u.names[T];m+=" ".concat(R),N!=null&&(m+="#".concat(N))}let _=this.filtered,b=this.named.bind(this,u),E=[m];return Xoe(_,u,c,a,E,E,b)}function Xoe(a,u,c,m,_,b,E){let T=Os(c,524),R=Os(c,522),N=Os(c,521),z=Os(c,529),G=Os(c,545),V=Os(c,265),B=Os(c,268),j=Os(c,273),H=Os(c,289),X=Os(c,137),K=Os(c,145),te=Os(c,73),se=Os(c,81),pe=T?m.error.bind(m,..._):a.bind(u,524),fe=R?m.error.bind(m,..._):a.bind(u,522),ye=N?m.error.bind(m,..._):a.bind(u,521),Ne=z?m.error.bind(m,..._):a.bind(u,529),ze=G?m.error.bind(m,..._):a.bind(u,545),Me=B?m.warn.bind(m,...b):a.bind(u,268),je=V?m.warn.bind(m,..._):a.bind(u,265),yt=j?m.warn.bind(m,..._):a.bind(u,273),xe=H?m.warn.bind(m,..._):a.bind(u,273),We=X?m.info.bind(m,..._):a.bind(u,137),ae=K?m.info.bind(m,..._):a.bind(u,145),nt=te?m.debug.bind(m,..._):a.bind(u,73),dn=se?m.debug.bind(m,..._):a.bind(u,81),Ve={_hmm:pe,_todo:fe,_error:ye,errorDev:Ne,errorPublic:ze,_kapow:Me,_warn:je,warnDev:yt,warnPublic:xe,_debug:We,debugDev:ae,_trace:nt,traceDev:dn,lazy:{_hmm:T?Ds(pe):pe,_todo:R?Ds(fe):fe,_error:N?Ds(ye):ye,errorDev:z?Ds(Ne):Ne,errorPublic:G?Ds(ze):ze,_kapow:B?Ds(Me):Me,_warn:V?Ds(je):je,warnDev:j?Ds(yt):yt,warnPublic:H?Ds(xe):xe,_debug:X?Ds(We):We,debugDev:K?Ds(ae):ae,_trace:te?Ds(nt):nt,traceDev:se?Ds(dn):dn},named:E,utilFor:{internal(){return{debug:Ve._debug,error:Ve._error,warn:Ve._warn,trace:Ve._trace,named(Ue,at){return Ve.named(Ue,at).utilFor.internal()}}},dev(){return{debug:Ve.debugDev,error:Ve.errorDev,warn:Ve.warnDev,trace:Ve.traceDev,named(Ue,at){return Ve.named(Ue,at).utilFor.dev()}}},public(){return{error:Ve.errorPublic,warn:Ve.warnPublic,debug(Ue,at){Ve._warn('(public "debug" filtered out) '.concat(Ue),at)},trace(Ue,at){Ve._warn('(public "trace" filtered out) '.concat(Ue),at)},named(Ue,at){return Ve.named(Ue,at).utilFor.public()}}}}};return Ve}var vu,Op,Yoe=I(()=>{vu={_hmm:pc(524),_todo:pc(522),_error:pc(521),errorDev:pc(529),errorPublic:pc(545),_kapow:pc(268),_warn:pc(265),warnDev:pc(273),warnPublic:pc(289),_debug:pc(137),debugDev:pc(145),_trace:pc(73),traceDev:pc(81)},Op={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(a,u,c){return this.create({names:[...a.names,{name:u,key:c}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(a){if(a.length<5)return a;let u=a.replace(this.collapseOnRE,"");return this.cssMemo.has(u)||this.cssMemo.set(u,this.css(a)),u},css(a){var u,c,m,_;let b=this.cssMemo.get(a);if(b)return b;let E="color:".concat((c=(u=this.color)==null?void 0:u.call(this,a))!=null?c:"hsl(".concat((a.charCodeAt(0)+a.charCodeAt(a.length-1))%360,", 100%, 60%)"));return(m=this.bold)!=null&&m.test(a)&&(E+=";font-weight:600"),(_=this.italic)!=null&&_.test(a)&&(E+=";font-style:italic"),this.cssMemo.set(a,E),E}}}}),wL,dA,fA=I(()=>{Yoe(),Yoe(),wL=qoe(console,{}),wL.configureLogging({dev:!0,min:64}),dA=wL.getLogger().named("Theatre.js (default logger)").utilFor.dev()}),Z9,f8,Koe,Txe=I(()=>{Gm(),Z9=mn(),fA(),Om(),f8=28,Koe=(a,u)=>{var c;Z9.prism.ensurePrism();let m=!0,_=dM+f8,b=0,E=u.atomP.ahistoric.projects.stateByProjectId[a.address.projectId].stateBySheetId[a.address.sheetId].sequence.collapsableItems,T=E.byId[go.forSheet()].isCollapsed,R=(c=(0,Z9.pointerToPrism)(T).getValue())!=null?c:!1,N={type:"sheet",isCollapsed:R,sheet:a,children:[],sheetItemKey:go.forSheet(),shouldRender:m,top:dM,depth:0,n:b,nodeHeight:f8,heightIncludingChildren:-1};b+=1;for(let H of Object.values((0,Z9.val)(a.objectsP)))H&&z(H,N.children,N.depth+1,!R);N.heightIncludingChildren=_-N.top;function z(H,X,K,te){var se;let pe=(0,Z9.val)(H.template.getMapOfValidSequenceTracks_forStudio()),fe=(0,Z9.val)(H.template.configPointer);if(Object.keys(pe).length===0)return;let ye=E.byId[go.forSheetObject(H)].isCollapsed,Ne=(se=(0,Z9.pointerToPrism)(ye).getValue())!=null?se:!1,ze={type:"sheetObject",isCollapsed:Ne,sheetItemKey:go.forSheetObject(H),shouldRender:te,top:_,children:[],depth:K,n:b,sheetObject:H,nodeHeight:te?f8:0,heightIncludingChildren:-1};X.push(ze),te&&(b+=1,_+=ze.nodeHeight),G(H,pe,[],fe,ze.children,K+1,te&&!Ne),ze.heightIncludingChildren=_-ze.top}function G(H,X,K,te,se,pe,fe){for(let[ye,Ne]of Object.entries(X)){let ze=te.props[ye];V(H,Ne,[...K,ye],ze,se,pe,fe)}}function V(H,X,K,te,se,pe,fe){te.type==="compound"?B(H,X,te,K,te,se,pe,fe):te.type==="enum"?dA.warn("Prop type enum is not yet supported in the sequence editor"):j(H,X,K,te,se,pe,fe)}function B(H,X,K,te,se,pe,fe,ye){var Ne;let ze=E.byId[go.forSheetObjectProp(H,te)].isCollapsed,Me=(Ne=(0,Z9.pointerToPrism)(ze).getValue())!=null?Ne:!1,je={type:"propWithChildren",isCollapsed:Me,propConf:K,pathToProp:te,sheetItemKey:go.forSheetObjectProp(H,te),sheetObject:H,shouldRender:ye,top:_,children:[],nodeHeight:ye?f8:0,heightIncludingChildren:-1,depth:fe,trackMapping:X,n:b};pe.push(je),ye&&(_+=je.nodeHeight,b+=1),G(H,X,te,se,je.children,fe+1,ye&&!Me),je.heightIncludingChildren=_-je.top}function j(H,X,K,te,se,pe,fe){let ye={type:"primitiveProp",propConf:te,depth:pe,sheetItemKey:go.forSheetObjectProp(H,K),sheetObject:H,pathToProp:K,shouldRender:fe,top:_,nodeHeight:fe?f8:0,heightIncludingChildren:fe?f8:0,trackId:X,n:b};se.push(ye),b+=1,_+=ye.nodeHeight}return N}});function Mxe(a,u){let c=Se(),m=c.atomP.ahistoric.projects.stateByProjectId[a.address.projectId].stateBySheetId[a.address.sheetId],_=c.atomP.historic.projects.stateByProjectId[a.address.projectId].stateBySheetId[a.address.sheetId];return(0,yu.prism)(()=>{var b;let E=yxe("tree",()=>Koe(a,c),[]),T=(0,yu.val)(u),R=(0,yu.val)(c.atomP.historic.panels.sequenceEditor.graphEditor),N=(0,yu.val)(_.sequenceEditor.selectedPropsByObject),z=!!N&&Object.keys(N).length>0,{leftDims:G,rightDims:V,graphEditorDims:B,dopeSheetDims:j,horizontalScrollbarDims:H}=yu.prism.memo("leftDims",()=>{var je;let yt={width:Math.floor(T.width*Zoe),height:T.height,screenX:T.screenX,screenY:T.screenY},xe={width:T.width-yt.width,height:T.height,screenX:T.screenX+yt.width,screenY:T.screenY},We=z&&(R==null?void 0:R.isOpen)===!0,ae=Math.floor((We?ii((je=R==null?void 0:R.height)!=null?je:.5,.1,.7):0)*T.heightWithoutBorder),nt=0+ae,dn=T.height-nt,Ve={width:T.width,height:dn,screenX:T.screenX,screenY:T.screenY},Ue={isAvailable:z,isOpen:We,width:xe.width,height:ae,screenX:T.screenX,screenY:T.screenY+dn,padding:{top:20,bottom:20}};return{leftDims:yt,rightDims:xe,graphEditorDims:Ue,dopeSheetDims:Ve,horizontalScrollbarDims:{bottom:0}}},[T,R,z]),X=yu.prism.memo("graphEditorVerticalSpace",()=>{let je=B.height-B.padding.top-B.padding.bottom;return{space:je,fromExtremumSpace(yt){return yt*je},toExtremumSpace(yt){return yt/je}}},[B]),[K,te]=yu.prism.state("isSeeking",!1),se={isSeeking:K,setIsSeeking:te},pe={},fe=(b=(0,yu.val)(m.sequence.clippedSpaceRange))!=null?b:Qoe,ye=yu.prism.memo("scaledSpace",()=>{let je=fe.end-fe.start,yt=V.width,xe=je/yt,We=yt/je;return{fromUnitSpace(ae){return ae*We},toUnitSpace(ae){return ae*xe},leftPadding:10}},[fe,V.width]),Ne=yu.prism.memo("setClippedSpaceRange",()=>function(je){c.transaction(({stateEditors:yt})=>{let xe=P({},je);if(xe.end<=xe.start&&(xe.end=xe.start+1),xe.start<0){let We=xe.end-xe.start;xe.start=0,xe.end=We}yt.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.clippedSpaceRange.set($(P({},a.address),{range:xe}))})},[]),ze=yu.prism.memo("clippedSpace",()=>({range:fe,width:V.width,fromUnitSpace(je){return ye.fromUnitSpace(je-fe.start)+ye.leftPadding},toUnitSpace(je){return ye.toUnitSpace(je-ye.leftPadding)+fe.start},setRange:Ne}),[fe,V.width,ye,Ne]),Me=yu.prism.memo("selection.current",()=>new yu.Atom({}),[]);return iF("finalAtom",{sheet:a,tree:E,panelDims:T,leftDims:G,rightDims:V,dopeSheetDims:j,horizontalScrollbarDims:H,seeker:se,unitSpace:pe,scaledSpace:ye,clippedSpace:ze,graphEditorDims:B,graphEditorVerticalSpace:X,selectionAtom:Me}).pointer})}var yu,Zoe,Qoe,Cxe=I(()=>{Ae(),_xe(),Jne(),yu=mn(),Txe(),Ua(),Zoe=.2,Qoe={start:0,end:10}});function Axe(a){let{fullSecondStampsContainer:u,sequencePositionFormatter:c,snapToGrid:m,unitSpaceToClippedSpace:_}=a,b="";Zae(a,(E,T)=>{let R=m(E),N=_(R);T?b+=Joe(c.formatFullUnitForGrid(R),N,"full-unit"):b+=Joe(c.formatSubUnitForGrid(R),N,"sub-unit")}),u.innerHTML=b}function Joe(a,u,c){return'<span class="'.concat(c,'" style="transform: translate3d(').concat(u.toFixed(1),'px, -50%, 0);">').concat(a,"</span>")}var p8,m8,e0e,t0e,Q9,n0e,r0e,i0e,s0e,a0e,o0e,l0e=I(()=>{p8=mn(),hc(),m8=Q(qe()),Ft(),Jae(),Ae(),t0e=Te.div(e0e||(e0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),Q9={fullUnitStampColor:"#6a6a6a",stampFontSize:"10px",get subUnitStampColor(){return ib(.2,Q9.fullUnitStampColor)}},r0e=Te.div(n0e||(n0e=J([`
  position: absolute;
  top: 0;
  height: 100%;
  left: 0;
  overflow: hidden;
  z-index: 2;
  will-change: transform;
  pointer-events: none;
`]))),s0e=Te.div(i0e||(i0e=J([`
  position: absolute;
  top: 0;
  left: 0;

  & > span {
    position: absolute;
    display: block;
    top: 9px;
    left: -10px;
    color: `,`;
    text-align: center;
    font-size: `,`;
    width: 20px;

    &.full-unit {
      color: `,`;
    }

    &.sub-unit {
      color: `,`;
    }
  }

  pointer-events: none;
`])),Q9.fullUnitStampColor,Q9.stampFontSize,Q9.fullUnitStampColor,Q9.subUnitStampColor),a0e=({layoutP:a,width:u})=>{let c=(0,m8.useRef)(null),[m,_]=(0,m8.useState)(null);return(0,m8.useLayoutEffect)(()=>{if(m)return(0,p8.prism)(()=>{let b=(0,p8.val)(a.sheet).getSequence();return{fullSecondStampsContainer:m,clippedSpaceRange:(0,p8.val)(a.clippedSpace.range),clippedSpaceWidth:(0,p8.val)(a.clippedSpace.width),unitSpaceToClippedSpace:(0,p8.val)(a.clippedSpace.fromUnitSpace),leftPadding:(0,p8.val)(a.scaledSpace.leftPadding),fps:b.subUnitsPerUnit,sequencePositionFormatter:b.positionFormatter,snapToGrid:E=>b.closestGridPosition(E)}}).onChange(Se().ticker,Axe,!0)},[m,u,a]),m8.default.createElement(t0e,{ref:c,style:{width:u+"px"}},m8.default.createElement(r0e,{style:{width:u+"px"}},m8.default.createElement(s0e,{ref:_})))},o0e=a0e});function Pxe(a){let[u,c]=(0,EL.useState)(!1);return(0,EL.useEffect)(()=>{if(c(!1),!a)return;let m=b=>{b.target===a?c(!0):c(!1)},_=()=>{c(!1)};return a.addEventListener("mouseenter",m),a.addEventListener("mousemove",m),a.addEventListener("mouseleave",_),()=>{c(!1),a.removeEventListener("mouseenter",m),a.removeEventListener("mousemove",m),a.removeEventListener("mouseleave",_)}},[a]),u}var EL,Rxe=I(()=>{EL=Q(qe())});function Ixe(a,u){let c=0,[m,_]=a,[b,E]=u;return _-m>E-b?[b,E]:(m<b&&(c=0-m),_>E&&(c=E-_),[m+c,_+c])}var Fp,J9,Ja,TL,u0e,pA,c0e,h0e,d0e=I(()=>{Fp=mn(),tr(),Bi(),Ae(),v8(),Tl(),Qa(),Ui(),J9=Q(qe()),Ft(),a0(),Ja={enabled:{backgroundColor:"#2C2F34",stroke:"#646568"},disabled:{backgroundColor:"#282a2cc5",stroke:"#595a5d"},hover:{backgroundColor:"#34373D",stroke:"#C8CAC0"},dragging:{backgroundColor:"#3F444A",stroke:"#C8CAC0"},thumbWidth:9,hitZoneWidth:26,rangeStripMinWidth:30},TL=1e3,pA=Te.div(u0e||(u0e=J([`
  position: absolute;
  height: `,`px;
  background-color: `,`;
  cursor: grab;
  top: 0;
  left: 0;
  width: `,`px;
  transform-origin: left top;
  &:hover {
    background-color: `,`;
  }
  &.dragging {
    background-color: `,`;
    cursor: grabbing !important;
  }
  `,`;

  /* covers the one pixel space between the focus range strip and the top strip
  of the sequence editor panel, which would have caused that one pixel to act
  like a panel drag zone */
  &:after {
    display: block;
    content: ' ';
    position: absolute;
    bottom: -1px;
    height: 1px;
    left: 0;
    right: 0;
    background: transparent;
    pointer-events: normal;
    z-index: -1;
  }
`])),()=>Up-1,a=>a.enabled?Ja.enabled.backgroundColor:Ja.disabled.backgroundColor,TL,Ja.hover.backgroundColor,Ja.dragging.backgroundColor,Fi),c0e=({layoutP:a})=>{let u=(0,J9.useMemo)(()=>(0,Fp.prism)(()=>{let{projectId:N,sheetId:z}=(0,Fp.val)(a.sheet).address;return(0,Fp.val)(Se().atomP.ahistoric.projects.stateByProjectId[N].stateBySheetId[z].sequence.focusRange)}),[a]),[c,m]=Ii(null),[_]=El(m,{menuItems:()=>{let N=(0,Fp.val)(a.sheet),z=u.getValue();return[{label:"Delete focus range",callback:()=>{Se().tempTransaction(({stateEditors:G})=>{G.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.unset(P({},N.address))}).commit()}},{label:z!=null&&z.enabled?"Disable focus range":"Enable focus range",callback:()=>{z!==void 0&&Se().tempTransaction(({stateEditors:G})=>{G.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(P({},N.address),{range:z.range,enabled:!z.enabled}))}).commit()}}]}}),b=qr(a.scaledSpace.toUnitSpace),E=qr(a.sheet),T=(0,J9.useMemo)(()=>{let N,z;return{debugName:"FocusRangeStrip",onDragStart(G){let V,B=u.getValue();if(!B)return!1;let j=B.range.start,H=B.range.end,X=!1,K=(0,Fp.val)(a.sheet).getSequence();return{onDrag(te){if(B=u.getValue(),B){X=!0;let se=b(te),pe=j+se,fe=H+se;fe<pe&&(fe=pe),[N,z]=Ixe([pe,fe],[0,K.length]).map(ye=>K.closestGridPosition(ye)),V&&V.discard(),V=Se().tempTransaction(({stateEditors:ye})=>{var Ne;ye.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(P({},E.address),{range:{start:N,end:z},enabled:(Ne=B==null?void 0:B.enabled)!=null?Ne:!0}))})}},onDragEnd(){B&&(X&&V!==void 0?V.commit():V&&V.discard())}}},lockCSSCursorTo:"grabbing"}},[E,b]),[R]=fa(m,T);return $m(R,-1),Gr(()=>{let N=u.getValue(),z=(N==null?void 0:N.range)||{start:0,end:0},G=(0,Fp.val)(a.clippedSpace.fromUnitSpace)(z.start),V=(0,Fp.val)(a.clippedSpace.fromUnitSpace)(z.end),B,j;return G<0&&(G=0),V>(0,Fp.val)(a.clippedSpace.width)&&(V=(0,Fp.val)(a.clippedSpace.width)),G>V?(j=0,B=0):(j=G,B=(V-G)/TL),N?J9.default.createElement(J9.default.Fragment,null,_,J9.default.createElement(pA,{id:"range-strip",enabled:N.enabled,className:"".concat(R?"dragging":""," ").concat(N.enabled?"enabled":""),ref:c,style:{transform:"translateX(".concat(j,"px) scale(").concat(B,", 1)")}})):J9.default.createElement(J9.default.Fragment,null)},[a,c,u,_,R])},h0e=c0e}),e3,Ym,f0e,p0e,m0e,g0e,v0e,y0e,_0e,ML,kxe=I(()=>{e3=mn(),tr(),Ae(),v8(),dc(),Qa(),Ui(),Ym=Q(qe()),Ft(),a0(),d0e(),jd(),p0e=Te.div(f0e||(f0e=J([`
  position: absolute;
  top: 0;
  // the right handle has to be pulled back by its width since its right side indicates its position, not its left side
  left: `,`px;
  transform-origin: left top;
  width: `,`px;
  height: `,`px;
  z-index: 3;

  --bg: `,`;

  stroke: `,`;
  user-select: none;

  cursor: `,`;

  // no pointer events unless pointer-root is in normal mode _and_ the
  // focus range is enabled
  #pointer-root & {
    pointer-events: none;
  }

  #pointer-root.normal & {
    pointer-events: auto;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.dragging {
    pointer-events: none !important;
  }

  // highlight the handle if it's hovered, or the whole strip is hovverd
  `,`:hover ~ &, &:hover {
    --bg: `,`;
    stroke: `,`;
  }

  // highlight the handle when it's being dragged or the whole strip is being dragged.
  // using dragging.dragging to give this selector priority, as it seems to be overridden
  // by the hover selector above
  &.dragging,
  `,`.dragging.dragging ~ & {
    --bg: `,`;
    stroke: `,`;
  }

  #pointer-root.draggingPositionInSequenceEditor &:hover {
    --bg: `,`;
    stroke: #40aaa4;
  }

  background-color: var(--bg);

  // a larger hit zone
  &:before {
    display: block;
    content: ' ';
    position: absolute;
    inset: -8px;
  }
`])),a=>a.type==="start"?0:-Ja.thumbWidth,Ja.thumbWidth,()=>Up-1,({enabled:a})=>a?Ja.enabled.backgroundColor:Ja.disabled.backgroundColor,Ja.enabled.stroke,a=>a.type==="start"?"w-resize":"e-resize",Lm,()=>pA,Ja.hover.backgroundColor,Ja.hover.stroke,()=>pA,Ja.dragging.backgroundColor,Ja.dragging.stroke,Ja.dragging.backgroundColor),g0e=Te.div(m0e||(m0e=J([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    var(--bg) 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),a=>a.type==="start"?90:-90,a=>a.type==="start"?Ja.thumbWidth:-Ja.thumbWidth+1),y0e=Te.div(v0e||(v0e=J([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    `,` 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),a=>a.type==="start"?-90:90,()=>mS.backgroundColor,a=>a.type==="start"?-12:Ja.thumbWidth),_0e=({layoutP:a,thumbType:u})=>{var c;let[m,_]=Ii(null),b=(0,Ym.useMemo)(()=>(0,e3.prism)(()=>{let{projectId:N,sheetId:z}=(0,e3.val)(a.sheet).address;return(0,e3.val)(Se().atomP.ahistoric.projects.stateByProjectId[N].stateBySheetId[z].sequence.focusRange)}),[a]),E=(0,Ym.useMemo)(()=>({debugName:"FocusRangeThumb",onDragStart(){let N,z,G=(0,e3.val)(a.sheet),V={start:0,end:G.getSequence().length},B=b.getValue()||{range:V,enabled:!1},j=B.enabled,H=B.range[u],X=(0,e3.val)(a.scaledSpace.toUnitSpace),K=X(Ja.rangeStripMinWidth);return{onDrag(te,se,pe){var fe;let ye,Ne=Ml.checkIfMouseEventSnapToPos(pe,{ignore:_});if(Ne==null){let Me=X(te);ye=H+Me}else ye=Ne;z=((fe=b.getValue())==null?void 0:fe.range)||V,u==="start"?ye=Math.max(Math.min(ye,z.end-K),0):ye=Math.min(Math.max(ye,z.start+K),G.getSequence().length);let ze=G.getSequence().closestGridPosition(ye);N!==void 0&&N.discard(),N=Se().tempTransaction(({stateEditors:Me})=>{Me.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(P({},G.address),{range:$(P({},z),{[u]:ze}),enabled:j}))})},onDragEnd(te){te?N==null||N.commit():N==null||N.discard()}}}}),[a]),[T]=fa(_,E);mh(T,"draggingPositionInSequenceEditor",u==="start"?"w-resize":"e-resize");let R=qr(b);return $m(T,(c=R==null?void 0:R.range[u])!=null?c:0),Gr(()=>{let N=b.getValue();if(!N)return null;let{enabled:z}=N,G=N.range[u],V=(0,e3.val)(a.clippedSpace.fromUnitSpace)(G);return(V<0||(0,e3.val)(a.clippedSpace.width)<V)&&(V=-1e4),Ym.default.createElement(p0e,$(P(P({ref:m},Ml.includePositionSnapAttrs(G)),Ip(G)),{className:"".concat(T&&"dragging"," ").concat(z&&"enabled"),enabled:z,type:u,style:{transform:"translate3d(".concat(V,"px, 0, 0)")}}),Ym.default.createElement(g0e,{type:u,enabled:z}),Ym.default.createElement(y0e,{type:u}),Ym.default.createElement("svg",{viewBox:"0 0 9 18",xmlns:"http://www.w3.org/2000/svg"},Ym.default.createElement("line",{x1:"4",y1:"6",x2:"4",y2:"12"}),Ym.default.createElement("line",{x1:"6",y1:"6",x2:"6",y2:"12"})))},[a,m,b,T])},ML=_0e});function Nxe(a,u){let[c,m]=(0,Lp.useState)("none");return mh(c!=="none","dragging",c==="creating"?"ew-resize":"move"),(0,Lp.useMemo)(()=>{let _=()=>({debugName:"FocusRangeZone/focusRangeCreationGestureHandlers",onDragStart(E){let T,R=(0,g8.val)(a.clippedSpace.toUnitSpace),N=(0,g8.val)(a.scaledSpace.toUnitSpace),z=(0,g8.val)(a.sheet),G=z.getSequence(),V=E.target.getBoundingClientRect(),B=R(E.clientX-V.left),j=N(Ja.rangeStripMinWidth);return{onDrag(H){let X=N(H),K=B,te=B+X;[K,te]=[ii(K,0,G.length),ii(te,0,G.length)].map(se=>G.closestGridPosition(se)),te<K?[K,te]=[Math.max(Math.min(te,K-j),0),K]:H>0&&(te=Math.min(Math.max(te,K+j),G.length)),T&&T.discard(),T=Se().tempTransaction(({stateEditors:se})=>{se.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(P({},z.address),{range:{start:K,end:te},enabled:!0}))})},onDragEnd(H){H&&T!==void 0?T.commit():T&&T.discard()}}},lockCSSCursorTo:"ew-resize"}),b=()=>({debugName:"FocusRangeZone/panelMoveGestureHandlers",onDragStart(){let E,T=u.current,R=u.current.addBoundsHighlightLock();return{onDrag(N,z){let G=$(P({},T.dims),{top:ii(T.dims.top+z,0,window.innerHeight-yp),left:ii(T.dims.left+N,-T.dims.width+yp,window.innerWidth-yp)}),V=yC(G,{width:window.innerWidth,height:window.innerHeight});E==null||E.discard(),E=Se().tempTransaction(({stateEditors:B})=>{B.studio.historic.panelPositions.setPanelPosition({position:V,panelId:T.panelId})})},onDragEnd(N){R(),N?E==null||E.commit():E==null||E.discard()}}},lockCSSCursorTo:"move"});return{debugName:"FocusRangeZone",onDragStart(E){let[T,R]=E.shiftKey?["creating",_().onDragStart(E)]:["moving-panel",b().onDragStart(E)];return m(T),R===!1?!1:{onDrag(N,z,G,V,B){R.onDrag(N,z,G,V,B)},onDragEnd(N){var z;m("none"),(z=R.onDragEnd)==null||z.call(R,N)}}}}},[a,u])}var g8,Lp,x0e,b0e,S0e,w0e,Dxe=I(()=>{g8=mn(),tr(),Ae(),N6(),v8(),dc(),Qa(),Rxe(),mre(),Ui(),Ua(),Lp=Q(qe()),Ft(),d0e(),kxe(),Om(),b0e=Te.div(x0e||(x0e=J([`
  position: absolute;
  height: `,`px;
  left: 0;
  right: 0;
  box-sizing: border-box;
  /* Use the "grab" cursor if the shift key is up, which is the one used on the top strip of the sequence editor */
  cursor: `,`;
`])),()=>Up,a=>a.isShiftDown?"ew-resize":"move"),S0e=({layoutP:a})=>{let[u,c]=Ii(null),m=k6(),_=(0,Lp.useRef)(m);_.current=m;let b=(0,Lp.useMemo)(()=>(0,g8.prism)(()=>{let{projectId:R,sheetId:N}=(0,g8.val)(a.sheet).address;return(0,g8.val)(Se().atomP.ahistoric.projects.stateByProjectId[R].stateBySheetId[N].sequence.focusRange)}),[a]);fa(c,Nxe(a,_));let E=fre("Shift"),T=Pxe(c);return(0,Lp.useEffect)(()=>{if(!E&&T)return _.current.addBoundsHighlightLock()},[!E&&T]),Gr(()=>Lp.default.createElement(b0e,{ref:u,isShiftDown:E},Lp.default.createElement(h0e,{layoutP:a}),Lp.default.createElement(ML,{thumbType:"start",layoutP:a}),Lp.default.createElement(ML,{thumbType:"end",layoutP:a})),[a,b,E])},w0e=S0e}),j6,Up,mS,E0e,T0e,M0e,C0e,v8=I(()=>{tr(),j6=Q(qe()),Ft(),l0e(),a0(),Bi(),Dxe(),Up=18,mS={backgroundColor:"#1f2120eb",borderColor:"#1c1e21"},T0e=Te.div(E0e||(E0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: `,`px;
  box-sizing: border-box;
  background: `,`;
  border-bottom: 1px solid `,`;
  `,`;
`])),Up,mS.backgroundColor,mS.borderColor,Fi),M0e=({layoutP:a})=>{let u=qr(a.rightDims.width);return j6.default.createElement(j6.default.Fragment,null,j6.default.createElement(T0e,P({},Ip("hide")),j6.default.createElement(o0e,{layoutP:a,width:u,height:Up}),j6.default.createElement(w0e,{layoutP:a})))},C0e=M0e}),y8,A0e,P0e,R0e,I0e,k0e,N0e,D0e,O0e,Oxe=I(()=>{y8=Q(qe()),Ft(),tr(),Ae(),ID(),$5(),A0e=a=>isFinite(a)&&a>0,R0e=Te.div(P0e||(P0e=J([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),k0e=Te.div(I0e||(I0e=J([`
  `,`;
  white-space: nowrap;
`])),U9),N0e=({deltaX:a})=>a*.25,D0e=({layoutP:a})=>{let u=qr(a.sheet),c=(0,y8.useMemo)(()=>{let _;return{temporarilySetValue(b){_&&(_.discard(),_=void 0),_=Se().tempTransaction(({stateEditors:E})=>{E.coreByProject.historic.sheetsById.sequence.setLength($(P({},u.address),{length:b}))})},discardTemporaryValue(){_&&(_.discard(),_=void 0)},permanentlySetValue(b){_&&(_.discard(),_=void 0),Se().transaction(({stateEditors:E})=>{E.coreByProject.historic.sheetsById.sequence.setLength($(P({},u.address),{length:b}))})}}},[a,u]),m=(0,y8.useRef)(null);return(0,y8.useLayoutEffect)(()=>{m.current.focus()},[]),Gr(()=>{let _=u.getSequence().length;return y8.default.createElement(R0e,null,y8.default.createElement(k0e,null,"Sequence length"),y8.default.createElement(bM,$(P({value:_},c),{isValid:A0e,inputRef:m,nudge:N0e})))},[u,c,m])},O0e=D0e});function Fxe(a,u){let c=(0,_u.useRef)(u);c.current=u;let m=(0,_u.useMemo)(()=>({debugName:"LengthIndicator/useDragBulge",lockCSSCursorTo:"ew-resize",onDragStart(b){let E,T=c.current,R=(0,_8.val)(c.current.layoutP.sheet),N=R.getSequence().length,z=(0,_8.val)(T.layoutP.scaledSpace.toUnitSpace);return{onDrag(G,V,B){let j=z(G);E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:H})=>{H.coreByProject.historic.sheetsById.sequence.setLength($(P({},R.address),{length:N+j}))})},onDragEnd(G){G?E&&E.commit():E&&E.discard()}}}}),[]),[_]=fa(a,m);return $m(_,-1),[_]}var _8,_u,CL,gS,F0e,t3,L0e,U0e,B0e,z0e,V0e,G0e,H0e,j0e,W0e,$0e,q0e,Lxe=I(()=>{tr(),_8=mn(),_u=Q(qe()),Ft(),Qm(),v8(),Ui(),Qa(),Ae(),wp(),a0(),x6(),Oxe(),Bi(),Tp(),CL=1e3,gS={stripNormal:"#0000006c",stripActive:"#000000"},t3=Te.div(F0e||(F0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  z-index: `,`;
  pointer-events: none;

  &:after {
    display: block;
    content: ' ';
    position: absolute;
    /* top: `,`px; */
    top: 0;
    bottom: 0;
    left: -1px;
    width: 1px;
    background-color: `,`;
  }

  &:hover:after,
  &.dragging:after {
    background-color: `,`;
  }
`])),()=>zp.lengthIndicatorStrip,Up,gS.stripNormal,gS.stripActive),U0e=Te.div(L0e||(L0e=J([`
  position: absolute;
  top: `,`px;
  width: 100px;
  left: -50px;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 1;
`])),Up-15),z0e=Te.div(B0e||(B0e=J([`
  margin-top: 8px;
  font-size: 10px;
  white-space: nowrap;
  padding: 2px 8px;
  border-radius: 2px;
  `,`;
  cursor: ew-resize;
  color: #464646;
  background-color: #0000004d;
  display: none;

  `,":hover &, ",`.dragging & {
    display: block;
    color: white;
    background-color: `,`;
  }
`])),Fi,t3,t3,gS.stripActive),G0e=Te.div(V0e||(V0e=J([`
  font-size: 10px;
  white-space: nowrap;
  padding: 1px 2px;
  border-radius: 2px;
  `,`;
  justify-content: center;
  align-items: center;
  cursor: ew-resize;
  color: #5d5d5d;
  background-color: #191919;

  `,":hover &, ",`.dragging & {
    color: white;
    background-color: `,`;

    & > svg:first-child {
      margin-right: -1px;
    }
  }

  & > svg:first-child {
    margin-right: -4px;
  }
`])),Fi,t3,t3,gS.stripActive),j0e=Te.div(H0e||(H0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  background-color: rgb(23 23 23 / 43%);
  width: `,`px;
  z-index: `,`;
  transform-origin: left top;

  `,".dragging ~ &, ",`:hover ~ & {
    background-color: rgb(23 23 23 / 60%);
  }
`])),CL,()=>zp.lengthIndicatorCover,t3,t3),W0e=-1e4,$0e=({layoutP:a})=>{let[u,c]=Ii(null),[m]=Fxe(c,{layoutP:a}),{node:_,toggle:b,close:E}=Sp({debugName:"LengthIndicator"},()=>_u.default.createElement(Ep,null,_u.default.createElement(O0e,{layoutP:a,onRequestClose:E})));return Gr(()=>{let T=(0,_8.val)(a.sheet),R=(0,_8.val)(a.rightDims.height),N=T.getSequence(),z=N.length,G=z,V=(0,_8.val)(a.clippedSpace.fromUnitSpace)(G),B=(0,_8.val)(a.clippedSpace.width),j,H;return V>B?(H=0,j=0):(V<0&&(V=0),H=V,j=(B-V)/CL),_u.default.createElement(_u.default.Fragment,null,_,_u.default.createElement(t3,{style:{height:R+"px",transform:"translateX(".concat(H===0?W0e:H,"px)")},className:m?"dragging":""},_u.default.createElement(U0e,null,_u.default.createElement(G0e,P({ref:u,onClick:X=>{b(X,c)}},Ip("hide")),_u.default.createElement(Mye,null),_u.default.createElement(Cye,null)),_u.default.createElement(z0e,null,"Sequence length:"," ",N.positionFormatter.formatBasic(z)))),_u.default.createElement(j0e,{title:"Length",style:{height:R+"px",transform:"translateX(".concat(H,"px) scale(").concat(j,", 1)")}}))},[a,u,m,_])},q0e=$0e}),AL,Km,X0e,Y0e,K0e,Z0e,Q0e,J0e,ele,tle,Uxe=I(()=>{tr(),AL=mn(),Km=Q(qe()),Ft(),l0e(),Qm(),v8(),a0(),Y0e=Te.div(X0e||(X0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  margin-top: 0px;
`]))),Z0e=Te.div(K0e||(K0e=J([`
  position: absolute;
  top: 16px;
  font-size: `,`;
  color: `,`;
  text-align: center;
  transform: translateX(-50%);
  background: `,`;
  padding: 1px 8px;
  font-variant-numeric: tabular-nums;
  pointer-events: none;
  z-index: `,`;
`])),Q9.stampFontSize,Q9.fullUnitStampColor,mS.backgroundColor,()=>zp.currentFrameStamp),J0e=Te.div(Q0e||(Q0e=J([`
  position: absolute;
  top: 5px;
  left: -0px;
  bottom: 0;
  width: 0.5px;
  background: rgba(100, 100, 100, 0.2);
  pointer-events: none;
`]))),ele=Km.default.memo(({layoutP:a})=>{let[u,c]=qr(Lre()),m=qr(a.clippedSpace.fromUnitSpace),{sequence:_,formatter:b,clippedSpaceWidth:E}=Gr(()=>{let z=(0,AL.val)(a.sheet).getSequence(),G=(0,AL.val)(a.clippedSpace.width);return{sequence:z,formatter:z.positionFormatter,clippedSpaceWidth:G}},[a]);if(u==-1)return Km.default.createElement(Km.default.Fragment,null);let T=c===3?_.closestGridPosition(u):u,R=m(T),N=R>=0&&R<=E;return Km.default.createElement(Km.default.Fragment,null,Km.default.createElement(Y0e,null,Km.default.createElement(Z0e,{style:{opacity:N?1:0,transform:"translate3d(calc(".concat(R,"px - 50%), 0, 0)")}},b.formatForPlayhead(T)),Km.default.createElement(J0e,{posType:c,style:{opacity:N?1:0,transform:"translate3d(".concat(R,"px, 0, 0)")}}))," ")}),tle=ele}),Wd,Pl,nle,rle,ile,sle,ale,mA,ole,PL,lle,gA,ule,vA,cle,RL,hle,dle,Bxe=I(()=>{tr(),Wd=mn(),kx(),hc(),Pl=Q(qe()),Ft(),Qm(),a0(),Bi(),Qa(),rle=Te.div(nle||(nle=J([`
  --threadHeight: 6px;
  --bg-inactive: #32353b;
  --bg-active: #5b5c5d;
  position: absolute;
  height: 0;
  width: 100%;
  left: 12px;
  /* bottom: 8px; */
  z-index: `,`;
  `,`
`])),()=>zp.horizontalScrollbar,Fi),sle=Te.div(ile||(ile=J([`
  position: relative;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--threadHeight);
`]))),mA=Te.div(ale||(ale=J([`
  position: absolute;
  height: 5px;
  background: var(--bg-inactive);
  cursor: ew-resize;
  z-index: 2;

  &:hover,
  &:active {
    background: var(--bg-active);
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),ON("absolute","-4px")),PL=Te.div(ole||(ole=J([`
  position: absolute;
  height: 5px;
  width: 7px;
  left: 0;
  z-index: 2;
  top: 0;
  bottom: 0;
  display: block;

  &:hover:before {
    background: var(--bg-active);
  }

  &:before {
    `,`;
    display: block;
    content: ' ';
    background: var(--bg-inactive);
    border-radius: 0 2px 2px 0;
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),ON("absolute","0"),ON("absolute","-4px")),gA=Te(PL)(lle||(lle=J([`
  left: calc(-1 * 7px);
  cursor: w-resize;
  &:before {
    transform: scaleX(-1);
  }
`]))),vA=Te(PL)(ule||(ule=J([`
  cursor: e-resize;
  left: 0px;
`]))),RL=Te.div(cle||(cle=J([`
  display: `,`;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 4px;
  transform: translateX(-50%);
  background: #131d1f;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;

  `,`:hover &,
  `,`:hover &,
  `,":hover ~ ",` &,
  `,":hover ~ ",` & {
    display: block;
  }
`])),a=>a.active?"block":"none",gA,vA,mA,gA,mA,vA),hle=({layoutP:a})=>{let u=(0,Pl.useCallback)(X=>X.toFixed(2),[]),c=(0,Pl.useMemo)(()=>(0,Wd.prism)(()=>{let X=(0,Wd.val)(a.rightDims.width)-25,K=(0,Wd.val)(a.clippedSpace.range),te=(0,Wd.val)(a.sheet).getSequence().length,se=Math.max(K.end,te),pe=K.start/se*X,fe=K.end/se*X;return{rightWidth:X,clippedSpaceRange:K,sequenceLength:te,assumedLengthOfSequence:se,rangeStartX:pe,rangeEndX:fe,bottom:(0,Wd.val)(a.horizontalScrollbarDims.bottom)}}),[a]),{rangeStartX:m,rangeEndX:_,clippedSpaceRange:b,bottom:E}=qr(c),[T,R]=(0,Pl.useState)("nothing"),N=(0,Pl.useMemo)(()=>{let X=(0,Wd.val)(c),K=()=>{X=(0,Wd.val)(c)},te=se=>se/X.rightWidth*X.assumedLengthOfSequence;return{onRangeDragStart(){return K(),{onDrag(se){R("both");let pe=te(se),fe=cp(X.clippedSpaceRange,ye=>ye+pe);(0,Wd.val)(a.clippedSpace.setRange)(fe)},onDragEnd(){R("nothing")}}},onRangeStartDragStart(){return K(),{onDrag(se){R("start");let pe=te(se),fe={start:X.clippedSpaceRange.start+pe,end:X.clippedSpaceRange.end};fe.start>fe.end-1&&(fe.start=fe.end-1),fe.start<=0&&(fe.start=0),(0,Wd.val)(a.clippedSpace.setRange)(fe)},onDragEnd(){R("nothing")}}},onRangeEndDragStart(){return K(),{onDrag(se){R("end");let pe=te(se),fe={start:X.clippedSpaceRange.start,end:X.clippedSpaceRange.end+pe};fe.end<fe.start+1&&(fe.end=fe.start+1),fe.end>=X.assumedLengthOfSequence&&(fe.end=X.assumedLengthOfSequence),(0,Wd.val)(a.clippedSpace.setRange)(fe)},onDragEnd(){R("nothing")}}}}},[a,c]),[z,G]=(0,Pl.useState)(null);fa(z,{debugName:"HorizontalScrollbar/onRangeDrag",onDragStart:N.onRangeDragStart,lockCSSCursorTo:"ew-resize"});let[V,B]=(0,Pl.useState)(null);fa(V,{debugName:"HorizontalScrollbar/onRangeStartDrag",onDragStart:N.onRangeStartDragStart,lockCSSCursorTo:"w-resize"});let[j,H]=(0,Pl.useState)(null);return fa(j,{debugName:"HorizontalScrollbar/onRangeEndDrag",onDragStart:N.onRangeEndDragStart,lockCSSCursorTo:"e-resize"}),Pl.default.createElement(rle,P({style:{bottom:E+8+"px"}},Ip("hide")),Pl.default.createElement(sle,null,Pl.default.createElement(mA,{ref:G,style:{width:"".concat(_-m,"px"),transform:"translate3d(".concat(m,"px, 0, 0)")}}),Pl.default.createElement(gA,{ref:B,style:{transform:"translate3d(".concat(m,"px, 0, 0)")}},Pl.default.createElement(RL,{active:T==="both"||T==="start"},u(b.start))),Pl.default.createElement(vA,{ref:H,style:{transform:"translate3d(".concat(_,"px, 0, 0)")}},Pl.default.createElement(RL,{active:T==="both"||T==="end"},u(b.end)))))},dle=hle}),fle,ple,mle,gle,vle,zxe=I(()=>{fle=Q(qe()),Ft(),mle=Te.div(ple||(ple=J([`
  position: absolute;
  inset: `,`px;
`])),a=>a.room*-1),gle=a=>fle.default.createElement(mle,{room:a.room}),vle=gle}),yA,_A,IL,yle,_le,xle,ble,Sle,wle,Ele,Tle,Vxe=I(()=>{Ft(),tr(),ID(),$5(),yA=Q(qe()),_A=Q(qe()),IL=mn(),Jf(),yle=a=>isFinite(a)&&a>=0,xle=Te.div(_le||(_le=J([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),Sle=Te.div(ble||(ble=J([`
  `,`;
  white-space: nowrap;
`])),U9),wle=({deltaX:a})=>a*.25,Ele=({layoutP:a,onRequestClose:u})=>{let c=(0,IL.val)(a.sheet),m=c.getSequence(),_=(0,yA.useMemo)(()=>{let E,T=m.position;return{temporarilySetValue(R){E&&(E=void 0),E=ii(R,0,m.length),m.position=E},discardTemporaryValue(){E&&(E=void 0,m.position=T,u("discardTemporaryValue"))},permanentlySetValue(R){E&&(E=void 0),m.position=ii(R,0,m.length),u("permanentlySetValue")}}},[a,m]),b=(0,yA.useRef)(null);return(0,yA.useLayoutEffect)(()=>{b.current.focus()},[]),Gr(()=>{let E=c.getSequence(),T=Number((0,IL.val)(E.pointer.position).toFixed(3));return _A.default.createElement(xle,null,_A.default.createElement(Sle,null,"Sequence position"),_A.default.createElement(bM,$(P({value:T},_),{isValid:yle,inputRef:b,nudge:wle})))},[c,_,b])},Tle=Ele}),Mle,Gxe=I(()=>{Mle=typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0}),Cle,Hxe=I(()=>{Gxe(),Cle=a=>Mle?a.metaKey===!0:a.ctrlKey===!0});function jxe(){xA=!1}function Wxe(){xA=!0}function $xe(){let a=Se();(0,Ale.useEffect)(()=>{let u=c=>{let m=c.composedPath()[0];if(!(m&&(m.tagName==="INPUT"||m.tagName==="TEXTAREA"))){if(c.key==="z"||c.key==="Z"||c.code==="KeyZ")if(Cle(c))c.shiftKey===!0?a.redo():a.undo();else return;else if(c.code==="Space"&&!c.shiftKey&&!c.metaKey&&!c.altKey&&!c.ctrlKey){if(!xA)return;let _=Yve();if(_)if(_.playing)_.pause();else{let{projectId:b,sheetId:E}=_.address,T=(0,$d.prism)(()=>{let z=(0,$d.val)(Se().atomP.ahistoric.projects.stateByProjectId[b].stateBySheetId[E].sequence.focusRange);return $d.prism.memo("shouldFollowFocusRange",()=>{let G=_.position;if(z){let V=G>=z.range.start&&G<=z.range.end;return z.enabled?!!V:!0}else return!0},[])&&z&&z.enabled?{range:[z.range.start,z.range.end],isFollowingARange:!0}:{range:[0,(0,$d.val)(_.pointer.length)],isFollowingARange:!1}}),R=_.playDynamicRange((0,$d.prism)(()=>(0,$d.val)(T).range),Se().ticker),N=kL(_);R.finally(()=>{N.set(void 0)}),N.set(T)}else return}else if(c.altKey&&(c.key==="\\"||c.code==="Backslash"||c.code==="IntlBackslash"))a.transaction(({stateEditors:_,drafts:b})=>{_.studio.ahistoric.setVisibilityState(b.ahistoric.visibilityState==="everythingIsHidden"?"everythingIsVisible":"everythingIsHidden")});else return;c.preventDefault(),c.stopPropagation()}};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[])}var Ale,$d,xA,kL,Ple,NL=I(()=>{Ale=Q(qe()),Ae(),Hxe(),N9(),$d=mn(),BM(),xA=!0,kL=Tb(a=>new $d.Atom(void 0)),Ple=Tb(a=>(0,$d.prism)(()=>{let u=kL(a).prism.getValue();if(u)return u.getValue().isFollowingARange;{let{projectId:c,sheetId:m}=a.address,_=(0,$d.val)(Se().atomP.ahistoric.projects.stateByProjectId[c].stateBySheetId[m].sequence.focusRange);if(!_||!_.enabled)return!1;let b=(0,$d.val)(a.pointer.position);return b>=_.range.start&&b<=_.range.end}}))});function qxe(a,u){return El(a,{menuItems(){return[{label:"Place marker",callback:()=>{Se().transaction(({stateEditors:c})=>{let m=(0,Bp.val)(u.layoutP.sheet),_=m.getSequence();c.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:m.address,markers:[{id:N6e(),position:_.position}],snappingFunction:_.closestGridPosition})})}}]}})}var Bp,Sh,Rle,x8,Ile,kle,Nle,DL,Dle,Ole,Fle,Lle,Ule,Ble,Xxe=I(()=>{zxe(),Qa(),Ui(),tr(),Bp=mn(),Jf(),Sh=Q(qe()),Ft(),Qm(),a0(),Bi(),wp(),Tp(),Vxe(),NL(),dc(),Tl(),Ae(),Gm(),jd(),t8(),x8=Te.div(Rle||(Rle=J([`
  --thumbColor: #00e0ff;
  position: absolute;
  top: 0;
  left: 0;
  width: 5px;
  height: 100%;
  z-index: `,`;
  pointer-events: none;

  display: `,`;
`])),()=>zp.playhead,a=>a.isVisible?"block":"none"),kle=Te.div(Ile||(Ile=J([`
  position: absolute;
  top: 8px;
  width: 0;
  height: calc(100% - 8px);
  border-left: 1px solid #27e0fd;
  z-index: 10;
  pointer-events: none;

  #pointer-root.draggingPositionInSequenceEditor &:not(.seeking) {
    /* pointer-events: auto; */
    /* cursor: var(`,`); */

    &:after {
      position: absolute;
      inset: -8px;
      display: block;
      content: ' ';
    }
  }
`])),Lm),DL=Te.div(Nle||(Nle=J([`
  background-color: var(--thumbColor);
  position: absolute;
  width: 5px;
  height: 13px;
  top: -4px;
  left: -2px;
  z-index: 11;
  cursor: ew-resize;
  --sunblock-color: #1f2b2b;

  `,`;

  `,`.seeking > & {
    pointer-events: none !important;
  }

  #pointer-root.draggingPositionInSequenceEditor
    `,`:not(.seeking)
    > & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  `,`.playheadattachedtofocusrange > & {
    top: -8px;
    --sunblock-color: #005662;
    &:before,
    &:after {
      border-bottom-width: 8px;
    }
  }

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-left: 2px solid transparent;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    right: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-right: 2px solid transparent;
  }
`])),Fi,x8,x8,Lm,x8),Ole=Te.div(Dle||(Dle=J([`
  position: absolute;
  left: 1px;
  right: 1px;
  top: 13px;
  border-top: 3px solid var(--thumbColor);
  border-right: 1px solid transparent;
  border-left: 1px solid transparent;
  pointer-events: none;

  /* `,`.playheadattachedtofocusrange & {
    top: 10px;
    &:before,
    &:after {
      height: 15px;
    }
  } */

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    left: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 0 100% 0 0;
    border-top: 1px solid var(--thumbColor);
    border-right: 1px solid var(--thumbColor);
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    right: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 100% 0 0 0;
    border-top: 1px solid var(--thumbColor);
    border-left: 1px solid var(--thumbColor);
  }
`])),x8),Lle=Te.div(Fle||(Fle=J([`
  display: none;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 2px;
  transform: translateX(-50%);
  background: #1a1a1a;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;
  `,":hover &, ",`.seeking & {
    display: block;
  }
`])),DL,x8),Ule=({layoutP:a})=>{let[u,c]=Ii(null),{node:m,toggle:_,close:b}=Sp({debugName:"Playhead"},()=>Sh.default.createElement(Ep,null,Sh.default.createElement(Tle,{layoutP:a,onRequestClose:b}))),E=(0,Sh.useMemo)(()=>({debugName:"RightOverlay/Playhead",onDragStart(){let N=(0,Bp.val)(a.sheet).getSequence(),z=N.position,G=(0,Bp.val)(a.scaledSpace.toUnitSpace),V=(0,Bp.val)(a.seeker.setIsSeeking);return V(!0),vF(),{onDrag(B,j,H){var X;let K=G(B);N.position=(X=Ml.checkIfMouseEventSnapToPos(H,{ignore:c}))!=null?X:ii(z+K,0,N.length)},onDragEnd(B){V(!1),e8()},onClick(B){_(B,u.current)}}}}),[a,c]),[T]=fa(c,E);mh(T,"draggingPositionInSequenceEditor","ew-resize"),$m(qr(a.seeker.isSeeking)||T,-1);let[R]=qxe(c,{layoutP:a});return Gr(()=>{let N=(0,Bp.val)(a.seeker.isSeeking),z=(0,Bp.val)(a.sheet).getSequence(),G=(0,Bp.val)(Ple(z)),V=z.positionPrism.getValue(),B=(0,Bp.val)(a.clippedSpace.fromUnitSpace)(V),j=B>=0&&B<=(0,Bp.val)(a.clippedSpace.width);return Sh.default.createElement(Sh.default.Fragment,null,R,m,Sh.default.createElement(x8,P({isVisible:j,style:{transform:"translate3d(".concat(B,"px, 0, 0)")},className:"".concat(N&&"seeking"," ").concat(G&&"playheadattachedtofocusrange")},Ip("hide")),Sh.default.createElement(DL,P({ref:u},Ml.includePositionSnapAttrs(V)),Sh.default.createElement(vle,{room:8}),Sh.default.createElement(Ole,null),Sh.default.createElement(Lle,null,z.positionFormatter.formatForPlayhead(z.closestGridPosition(V)))),Sh.default.createElement(kle,$(P({},Ml.includePositionSnapAttrs(V)),{className:N?"seeking":""}))))},[a,u,m])},Ble=Ule}),b8,vS,bA,zle,Vle,Gle,Hle,Yxe=I(()=>{b8=mn(),tr(),Ae(),v8(),vS=Q(qe()),Ft(),bA=1e3,Vle=Te.div(zle||(zle=J([`
  position: absolute;
  top: `,`px;
  left: 0;
  opacity: 0.15;
  width: `,`px;
  transform-origin: top left;
  pointer-events: none;
  background-color: `,`;
`])),Up,bA,a=>a.enabled?"#000000":"transparent"),Gle=({layoutP:a})=>{let u=(0,vS.useMemo)(()=>(0,b8.prism)(()=>{let{projectId:c,sheetId:m}=(0,b8.val)(a.sheet).address;return(0,b8.val)(Se().atomP.ahistoric.projects.stateByProjectId[c].stateBySheetId[m].sequence.focusRange)}),[a]);return Gr(()=>{let c=u.getValue();if(!c||!c.enabled)return null;let{range:m}=c,_=(0,b8.val)(a.rightDims.height)-Up,b=(0,b8.val)(a.clippedSpace.fromUnitSpace),E=(0,b8.val)(a.clippedSpace.width),T=[];{let R=0,N=b(c.range.start),z,G;R>N?(G=0,z=0):(N>E&&(N=E),G=R,z=(N-R)/bA),T.push({translateX:G,scaleX:z})}{let R=b(c.range.end),N=E,z,G;R>N?(G=0,z=0):(R<0&&(R=0),G=R,z=(N-R)/bA),T.push({translateX:G,scaleX:z})}return vS.default.createElement(vS.default.Fragment,null,T.map(({translateX:R,scaleX:N},z)=>vS.default.createElement(Vle,{key:"curtain-".concat(z),enabled:!0,style:{height:"".concat(_,"px"),transform:"translateX(".concat(R,"px) scaleX(").concat(N,")")}})))},[a,u])},Hle=Gle}),W6,jle,Wle,$le,qle,Xle,Kxe=I(()=>{W6=Q(qe()),Ft(),tr(),Ae(),$5(),UD(),Wle=Te.div(jle||(jle=J([`
  display: flex;
  gap: 8px;
  /* padding: 4px 8px; */
  height: 28px;
  align-items: center;
`]))),Te.div($le||($le=J([`
  `,`;
  white-space: nowrap;
`])),U9),qle=({layoutP:a,marker:u})=>{var c;let m=qr(a.sheet),_=(0,W6.useMemo)(()=>{let E;return{temporarilySetValue(T){E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:R})=>{R.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:u.id,label:T})})},discardTemporaryValue(){E&&(E.discard(),E=void 0)},permanentlySetValue(T){E&&(E.discard(),E=void 0),Se().transaction(({stateEditors:R})=>{R.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:u.id,label:T})})}}},[a,m]),b=(0,W6.useRef)(null);return(0,W6.useLayoutEffect)(()=>{b.current.focus()},[]),W6.default.createElement(Wle,null,W6.default.createElement(wM,$(P({value:(c=u.label)!=null?c:""},_),{isValid:()=>!0,inputRef:b})))},Xle=qle});function Zxe(a,u){return El(a,{menuItems(){return[{label:"Remove marker",callback:()=>{Se().transaction(({stateEditors:c})=>{c.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeMarker({sheetAddress:u.sheetAddress,markerId:u.markerId})})}}]}})}function Qxe(a,u){let c=(0,Rl.useRef)(u);c.current=u;let m=(0,Rl.useMemo)(()=>({debugName:"MarkerDot/useDragMarker (".concat(u.marker.id,")"),onDragStart(b){let E=c.current.marker,T=(0,SA.val)(u.layoutP.scaledSpace.toUnitSpace),R;return vF(),{onDrag(N,z,G){var V;let B=E,j=Math.max((V=Ml.checkIfMouseEventSnapToPos(G,{ignore:a}))!=null?V:B.position+T(N),0);R==null||R.discard(),R=Se().tempTransaction(({stateEditors:H})=>{H.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:(0,SA.val)(u.layoutP.sheet.address),markers:[$(P({},B),{position:j})],snappingFunction:(0,SA.val)(u.layoutP.sheet).getSequence().closestGridPosition})})},onDragEnd(N){N?R==null||R.commit():R==null||R.discard(),e8()}}}}),[]),[_]=fa(a,m);return $m(_,u.marker.position),mh(_,"draggingPositionInSequenceEditor draggingMarker","ew-resize"),[_]}var SA,Rl,OL,FL,Yle,Kle,Zle,Qle,Jle,wA,eue,tue,nue,rue,iue,sue,Jxe=I(()=>{SA=mn(),tr(),Ae(),dc(),Tl(),Ui(),Rl=Q(qe()),Ft(),a0(),Qa(),Qm(),jd(),AC(),jre(),t8(),wp(),Tp(),Kxe(),OL=12,FL=12,Yle=OL*2,Kle=FL*2,Qle=Te.div(Zle||(Zle=J([`
  position: absolute;
  // below the sequence ruler "top bar"
  top: 18px;
  z-index: `,`;
`])),()=>zp.marker),wA=Te.div(Jle||(Jle=J([`
  position: absolute;
  `,`
  pointer-events: none;
`])),yh(OL,FL)),eue=Rl.default.memo(()=>Rl.default.createElement(wA,{children:Rl.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Rl.default.createElement("path",{d:"M12 5H0V7H2.71973L5.96237 10.2426L9.20501 7H12V5Z",fill:"#40AAA4"}))})),nue=Te.div(tue||(tue=J([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  // :not dragging marker to ensure that markers don't snap to other markers
  // this works because only one marker track (so this technique is not used by keyframes...)
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) & {
    `,`
  }

  // "All instances of this component <Mark/> inside #pointer-root when it has the .draggingPositionInSequenceEditor class"
  // ref: https://styled-components.com/docs/basics#pseudoelements-pseudoselectors-and-nesting
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) &,
  #pointer-root.draggingPositionInSequenceEditor
    &.`,` {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &:hover
    + `,`,
    // notice , "or" in CSS
    &.`,`
    + `,` {
    `,`
  }
`])),kp.CSS,kp.CSS_WHEN_SOMETHING_DRAGGING,kp.BEING_DRAGGED_CLASS,Lm,wA,kp.BEING_DRAGGED_CLASS,wA,yh(Yle,Kle)),rue=({layoutP:a,markerId:u})=>{let c=qr(a.sheet.address),m=qr(Se().atomP.historic.projects.stateByProjectId[c.projectId].stateBySheetId[c.sheetId].sequenceEditor.markerSet.byId[u]);if(!m)return null;let _=qr(a.clippedSpace.width),b=qr(a.clippedSpace.fromUnitSpace)(m.position),E=b<=0||b>_,T=E?-1e4:b,R=E?0:1;return Rl.default.createElement(Qle,{style:{transform:"translateX(".concat(T,"px) scale(").concat(R,")")}},Rl.default.createElement(sue,{marker:m,layoutP:a}))},iue=rue,sue=({layoutP:a,marker:u})=>{let c=qr(a.sheet.address),[m,_]=Ii(null),[b]=Zxe(_,{sheetAddress:c,markerId:u.id}),[E]=Qxe(_,{layoutP:a,marker:u}),{node:T,toggle:R,close:N}=Sp({debugName:"MarkerPopover"},()=>Rl.default.createElement(Ep,null,Rl.default.createElement(Xle,{marker:u,layoutP:a,onRequestClose:N})));return Rl.default.createElement(Rl.default.Fragment,null,b,T,Rl.default.createElement(nue,P({title:u.label?"Marker: ".concat(u.label):"Marker",ref:m,onClick:z=>{R(z,m.current)}},kp.reactProps({isDragging:E,position:u.position}))),Rl.default.createElement(eue,null))}}),EA,aue,oue,ebe=I(()=>{tr(),Ae(),EA=Q(qe()),Jxe(),aue=({layoutP:a})=>{let u=qr(a.sheet.address),c=Se().atomP.historic.projects.stateByProjectId[u.projectId].stateBySheetId[u.sheetId].sequenceEditor.markerSet,m=qr(c.allIds);return EA.default.createElement(EA.default.Fragment,null,m&&Object.keys(m).map(_=>EA.default.createElement(iue,{key:_,layoutP:a,markerId:_})))},oue=aue}),lue,Zm,uue,cue,hue,due,tbe=I(()=>{Qm(),tr(),lue=mn(),Zm=Q(qe()),Ft(),Lxe(),Uxe(),Bxe(),Xxe(),v8(),Yxe(),ebe(),cue=Te.div(uue||(uue=J([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: visible;
  pointer-events: none;
`])),()=>zp.rightOverlay),hue=({layoutP:a})=>Gr(()=>{let u=(0,lue.val)(a.rightDims.width);return Zm.default.createElement(cue,{style:{width:u+"px"}},Zm.default.createElement(Ble,{layoutP:a}),Zm.default.createElement(dle,{layoutP:a}),Zm.default.createElement(tle,{layoutP:a}),Zm.default.createElement(C0e,{layoutP:a}),Zm.default.createElement(oue,{layoutP:a}),Zm.default.createElement(q0e,{layoutP:a}),Zm.default.createElement(Hle,{layoutP:a}))},[a]),due=hue}),fue,TA,pue,mue,gue,vue,nbe=I(()=>{fue=mn(),tr(),Ae(),TA=Q(qe()),Ft(),x6(),a0(),mue=Te.button(pue||(pue=J([`
  outline: none;
  background-color: #1c1d21;
  border: 1px solid #191919;
  border-radius: 2px;
  display: flex;
  bottom: 14px;
  right: 8px;
  z-index: 1;
  position: absolute;

  padding: 4px 8px;
  display: flex;
  color: #656d77;
  line-height: 20px;
  font-size: 10px;

  &:hover {
    color: white;
  }

  & > svg {
    transition: transform 0.3s;
    transform: rotateZ(0deg);
  }

  &:hover > svg {
    transform: rotateZ(-20deg);
  }

  &.open > svg {
    transform: rotateZ(-180deg);
  }

  &.open:hover > svg {
    transform: rotateZ(-160deg);
  }
`]))),gue=({layoutP:a})=>{let u=qr(a.graphEditorDims.isOpen),c=(0,TA.useCallback)(()=>{let m=(0,fue.val)(a.graphEditorDims.isOpen);Se().transaction(({stateEditors:_})=>{_.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!m})})},[a]);return TA.default.createElement(mue,P({onClick:c,title:"Toggle graph editor",className:u?"open":""},Ip("hide")),TA.default.createElement(jye,null))},vue=gue}),qd,Zs,yue,_ue,xue,bue,zp,Sue,wue,Eue,Tue,Mue,Cue,Aue,Pue,Rue,Qm=I(()=>{N9(),tr(),Jne(),qd=mn(),Zs=Q(qe()),Ft(),vxe(),cA(),Cxe(),tbe(),N6(),ine(),Nne(),a0(),oi(),Ua(),nbe(),Om(),X5(),_ue=Te(nF)(yue||(yue=J([`
  z-index: `,`;
  box-shadow: 2px 2px 0 rgb(0 0 0 / 11%);
`])),d6.sequenceEditorPanel),bue=Te.div(xue||(xue=J([`
  background-color: rgba(40, 43, 47, 0.99);
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  z-index: -1;
  pointer-events: none;
`]))),zp=(()=>{let a={rightBackground:0,scrollableArea:0,rightOverlay:0,lengthIndicatorCover:0,lengthIndicatorStrip:0,playhead:0,currentFrameStamp:0,marker:0,horizontalScrollbar:0},u=-1;for(let c of Object.keys(a))a[c]=u,u++;return a})(),wue=Te(KO)(Sue||(Sue=J([`
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1;
`]))),Eue={edges:{left:{from:"screenLeft",distance:.1},right:{from:"screenRight",distance:.2},top:{from:"screenBottom",distance:.4},bottom:{from:"screenBottom",distance:.01}}},Tue={width:800,height:200},Mue=a=>Zs.default.createElement(YO,{panelId:"sequenceEditor",defaultPosition:Eue,minDims:Tue},Zs.default.createElement(Cue,null)),Cue=()=>{let{dims:a}=k6(),[u,c]=(0,Zs.useState)(null);return yQ(u),Gr(()=>{let m=qd.prism.memo("panelSize",()=>{let V=a.width,B=a.height;return{width:V,height:B,widthWithoutBorder:V-2,heightWithoutBorder:B-4,screenX:a.left,screenY:a.top}},[a]),_=dp(k9().filter(V=>Dt(V)||qt(V)).map(V=>qt(V)?V.sheet:V));if(dp(_.map(V=>V.template)).length!==1)return Zs.default.createElement(Zs.default.Fragment,null);let b=_[0];if(!b)return Zs.default.createElement(Zs.default.Fragment,null);let E=iF("panelSizeP",m).pointer,T=qd.prism.memo("key",()=>JSON.stringify(b.address),[b]),R=qd.prism.memo("layout",()=>Mxe(b,E),[b,E]).getValue();if((0,qd.val)(R.tree.children).length===0)return Zs.default.createElement(Zs.default.Fragment,null);let N=qd.prism.memo("containerRef",Rue,[]),z=(0,qd.val)(R.graphEditorDims.isAvailable),G=(0,qd.val)(R.graphEditorDims.isOpen);return Zs.default.createElement(_ue,{ref:V=>{N(V),V!==u&&c(V)}},Zs.default.createElement(bue,{style:{width:"".concat((0,qd.val)(R.leftDims.width),"px")}}),Zs.default.createElement(zre,{layoutP:R},Zs.default.createElement(Aue,{layoutP:R}),Zs.default.createElement($oe,{key:T+"-dopeSheet",layoutP:R}),G&&Zs.default.createElement(poe,{key:T+"-graphEditor",layoutP:R}),z&&Zs.default.createElement(vue,{layoutP:R}),Zs.default.createElement(due,{layoutP:R})))},[a,u])},Aue=({layoutP:a})=>Gr(()=>{let u=(0,qd.val)(a.sheet);return Zs.default.createElement(wue,{style:{width:(0,qd.val)(a.leftDims.width)}},Zs.default.createElement(iD,null,Zs.default.createElement(I9,null,u.address.sheetId," "),Zs.default.createElement(hb,null,":",""),Zs.default.createElement(I9,null,u.address.sheetInstanceId," "),Zs.default.createElement(hb,null,"",">",""),Zs.default.createElement(I9,null,"Sequence")))},[a]),Pue=Mue,Rue=()=>{let a=null,u={passive:!1,capture:!1},c=m=>{Math.abs(m.deltaY)<Math.abs(m.deltaX)&&(m.preventDefault(),m.stopPropagation())};return m=>{a!==m&&a&&a.removeEventListener("wheel",c,u),a=m,m&&m.addEventListener("wheel",c,u)}}}),S8,Iue,kue,rbe=I(()=>{sye(),$O(),S8=Q(qe()),Ae(),tr(),_7e(),Qm(),Iue=()=>{let a=qr(Se().paneManager.allPanesD),u=Object.entries(a).map(([c,m])=>S8.default.createElement(Qne,{key:"pane-".concat(c),paneInstance:m}));return S8.default.createElement(S8.default.Fragment,null,u,S8.default.createElement(BX,null),S8.default.createElement(Jte,null),S8.default.createElement(Pue,null))},kue=Iue}),Nue,Due,Oue,ibe=I(()=>{Ft(),aC(),Due=Te(P6)(Nue||(Nue=J([`
  --popover-outer-stroke: #e11c1c;
  --popover-inner-stroke: #2c1c1c;
  --popover-bg: #2c1c1c;
  pointer-events: none !important;
`]))),Oue=Due}),sbe=ie((a,u)=>{var c,m;c=[],m=[];function _(b,E,T){var R,N,z,G,V,B,j,H;if(b===E)return 0;if(R=b.length,N=E.length,R===0)return N;if(N===0)return R;for(T&&(b=b.toLowerCase(),E=E.toLowerCase()),j=0;j<R;)m[j]=b.charCodeAt(j),c[j]=++j;for(H=0;H<N;)for(z=E.charCodeAt(H),G=V=H++,j=-1;++j<R;)B=z===m[j]?V:V+1,V=c[j],c[j]=G=V>G?B>G?G+1:B:B>V?V+1:B;return G}u.exports=_}),abe=ie((a,u)=>{var c=sbe();function m(){var _,b,E,T,R,N=0,z=arguments[0],G=arguments[1],V=G.length,B=arguments[2];B&&(T=B.threshold,R=B.ignoreCase),T===void 0&&(T=0);for(var j=0;j<V;++j)R?b=c(z,G[j],!0):b=c(z,G[j]),b>z.length?_=1-b/G[j].length:_=1-b/z.length,_>N&&(N=_,E=G[j]);return N>=T?E:null}u.exports=m});function obe(a,u,c="Did you mean ",m="?"){let _=(0,Fue.default)(a,u,{threshold:.7});return _?c+JSON.stringify(_)+m:""}var Fue,lbe=I(()=>{Fue=Q(abe())});function Lue(a,u){return a.length<=u?a:a.substr(0,u-3)+"..."}var ube=I(()=>{}),Uue,LL,Bue=I(()=>{ube(),Uue=a=>typeof a=="string"?'string("'.concat(Lue(a,10),'")'):typeof a=="number"?"number(".concat(Lue(String(a),10),")"):a===null?"null":a===void 0?"undefined":typeof a=="boolean"?String(a):Array.isArray(a)?"array":typeof a=="object"?"object":"unknown",LL=Uue}),zue,Vue,UL,Gue=I(()=>{Ft(),H5(),Vue=Te(bq)(zue||(zue=J([`
  display: flex;
  height: fit-content;
  backdrop-filter: blur(14px);
  border-radius: 2px;
`]))),UL=Vue}),$6,Hue,jue,Wue,q6,yS=I(()=>{Ft(),Bi(),$6=Q(qe()),zb(),_M(),Jee(),Gue(),jue=Te.button(Hue||(Hue=J([`
  `,`;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  width: 32px;
  height: 32px;
  outline: none;

  color: #a8a8a9;

  background: rgba(40, 43, 47, 0.8);
  backdrop-filter: blur(14px);
  border: none;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 2px;

  svg {
    display: block;
  }

  &:hover {
    background: rgba(59, 63, 69, 0.8);
  }

  &:active {
    background: rgba(82, 88, 96, 0.8);
  }

  &.selected {
    color: rgba(255, 255, 255, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.7);
  }

  // Don't blur if in a button group, because it already blurs. We need to blur
  // on the group-level, otherwise we get seams.
  `,` > & {
    backdrop-filter: none;
    filter: none;
    border-radius: 0;

    &:first-child {
      border-top-left-radius: 2px;
      border-bottom-left-radius: 2px;
    }

    &:last-child {
      border-bottom-right-radius: 2px;
      border-top-right-radius: 2px;
    }
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Fi,UL),Wue=$6.default.forwardRef((a,u)=>{var c=a,{title:m}=c,_=Z(c,["title"]);let[b,E]=A6({enabled:typeof m=="string"},()=>$6.default.createElement(LO,null,m));return $6.default.createElement($6.default.Fragment,null,b,$6.default.createElement(jue,P({ref:yM([E,u])},_))," ")}),q6=Wue}),$ue,que,Xue,Yue,Kue,cbe=I(()=>{$ue=Q(qe()),yS(),Ft(),Bi(),Xue=Te(q6)(que||(que=J([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Fi),Yue=({config:a,testId:u})=>{var c;return $ue.default.createElement(Xue,{onClick:a.onClick,"data-testid":u,title:a.title,dangerouslySetInnerHTML:{__html:(c=a.svgSource)!=null?c:""}})},Kue=Yue});function hbe({value:a,label:u,icon:c,onClick:m,isSelected:_}){return X6.default.createElement(X6.default.Fragment,null,X6.default.createElement(q6,{forwardedAs:yq,className:_?"selected":void 0,"aria-label":u,onClick:m,title:u},c))}var X6,Zue,Que,dbe=I(()=>{X6=Q(qe()),H5(),yS(),Gue(),Zue=({value:a,onChange:u,options:c})=>X6.default.createElement(UL,null,c.map(({label:m,icon:_,value:b})=>X6.default.createElement(hbe,{key:b,value:b,isSelected:a===b,label:m,icon:_,onClick:()=>u(b)}))),Que=Zue}),BL,Jue,ece,tce,nce,fbe=I(()=>{BL=Q(qe()),Ft(),Bi(),dbe(),ece=Te.div(Jue||(Jue=J([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Fi),tce=({config:a})=>BL.default.createElement(Que,{onChange:a.onChange,options:a.options.map(({label:u,value:c,svgSource:m})=>({label:u,value:c,icon:BL.default.createElement(ece,{dangerouslySetInnerHTML:{__html:m}})})),value:a.value}),nce=tce}),_S,rce,ice,sce,ace,pbe=I(()=>{_S=Q(qe()),Ft(),Bi(),yS(),lQ(),wp(),ice=Te.div(rce||(rce=J([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Fi),sce=({config:a})=>{let u=(0,_S.useRef)(null),c=Sp(()=>{let m=u.current.getBoundingClientRect();return{debugName:"ExtensionFlyoutMenu:"+a.label,constraints:{maxX:m.right,maxY:8,minX:m.left,minY:8},verticalGap:2}},()=>_S.default.createElement(fO,{items:a.items.map((m,_)=>({label:m.label,callback:()=>{var b;try{(b=m.onClick)==null||b.call(m)}catch(E){console.error(E)}}})),onRequestClose:()=>{c.close("clicked")}}));return _S.default.createElement(ice,null,c.node,_S.default.createElement(q6,{ref:u,onClick:m=>{c.open(m,u.current)}},a.label))},ace=sce});function mbe(a){return zL[a]}var xS,oce,zL,lce,uce,gbe=I(()=>{lbe(),Bue(),xS=Q(qe()),cbe(),fbe(),pbe(),oce=a=>xS.default.createElement(xS.default.Fragment,null,a.config.map((u,c)=>xS.default.createElement(lce,{config:u,key:c}))),zL={Icon:Kue,Switch:nce,Flyout:ace},lce=({config:a})=>{let u=mbe(a.type);if(!u)throw new Error("No tool with tool.type ".concat(LL(a.type)," exists. Did you mean ").concat(obe(a.type,Object.keys(zL))));return xS.default.createElement(u,{config:a})},uce=oce}),cce,Vp,hce,dce,fce,VL,pce,mce,GL,gce=I(()=>{cce=mn(),tr(),Ae(),Vp=Q(qe()),Ft(),gbe(),dce=Te.div(hce||(hce=J([`
  height: 36px;
  /* pointer-events: none; */

  display: flex;
  gap: 0.5rem;
  justify-content: center;
`]))),VL=Te.div(fce||(fce=J([`
  position: abolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),pce=({extension:a,toolbarId:u})=>{var c;let m=(0,Vp.useMemo)(()=>new cce.Atom([]),[]),_=(c=a.toolbars)==null?void 0:c[u];(0,Vp.useLayoutEffect)(()=>{let E=_==null?void 0:_(m.set.bind(m),Se().publicApi);if(typeof E=="function")return E},[a,u,_]);let b=qr(m.prism);return Vp.default.createElement(uce,{config:b})},mce=({toolbarId:a,showLeftDivider:u})=>{var c;let m=[],_=qr(Se().atomP.ephemeral.extensions.byId),b=!1;for(let[,E]of Object.entries(_))!E||!((c=E.toolbars)!=null&&c[a])||(m.push(Vp.default.createElement(Vp.default.Fragment,{key:"extensionToolbar-"+E.id},b?Vp.default.createElement(VL,null):void 0,Vp.default.createElement(pce,{extension:E,toolbarId:a}))),b=!0);return m.length===0?null:Vp.default.createElement(dce,{"data-testid":"theatre-extensionToolbar-".concat(a)},u?Vp.default.createElement(VL,null):void 0,m)},GL=mce}),bS,vce,yce,_ce,MA,vbe=I(()=>{Ft(),bS=Q(qe()),yS(),yce=Te(q6)(vce||(vce=J([`
  color: `,`;

  border-bottom: 1px solid
    `,`;
`])),({pinned:a})=>a?"rgba(255, 255, 255, 0.8)":"#A8A8A9",({pinned:a})=>a?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.08)"),_ce=(0,bS.forwardRef)((a,u)=>{var c=a,{children:m,hint:_,pinned:b,icon:E,pinHintIcon:T,unpinHintIcon:R}=c,N=Z(c,["children","hint","pinned","icon","pinHintIcon","unpinHintIcon"]);let[z,G]=(0,bS.useState)(!1),V=z||_;return bS.default.createElement(yce,$(P({},N),{pinned:b,ref:u,onMouseOver:()=>G(!0),onMouseOut:()=>G(!1)}),bS.default.createElement("div",{style:{pointerEvents:"none",width:"fit-content",height:"fit-content",inset:0}},V&&!b?T:V&&b?R:E),m)}),MA=_ce});function ybe(a){return HL.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),HL.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.732 4.048l-.792-.792L7.2 8l4.74 4.744.792-.792L8.781 8l3.951-3.952zm-3.932 0l-.792-.792L3.268 8l4.74 4.744.792-.792L4.848 8 8.8 4.048z",fill:"currentColor"}))}var HL,jL,_be=I(()=>{HL=Q(qe()),jL=ybe});function xbe(a){return WL.createElement("svg",P({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),WL.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.694 3.765l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.951-3.951-3.951-3.952zm3.932 0l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.952-3.951-3.952-3.952z",fill:"currentColor"}))}var WL,$L,bbe=I(()=>{WL=Q(qe()),$L=xbe}),eo,xce,bce,Sce,qL,wce,n3,Ece,Tce,Mce,Cce,Ace,Pce,Rce,Ice,kce,CA,Nce,Dce,XL,YL,Oce,Fce,Sbe=I(()=>{tr(),Ae(),eo=Q(qe()),Ft(),bce=Te.div(xce||(xce=J([`
  width: 138px;
  border-radius: 2px;
  background-color: rgba(42, 45, 50, 0.9);
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.25), 0px 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  pointer-events: auto;
  // makes the edges of the item highlights match the rounded corners
  overflow: hidden;

  @supports not (backdrop-filter: blur()) {
    background-color: rgba(42, 45, 50, 0.98);
  }

  color: rgba(255, 255, 255, 0.9);

  & a {
    // Fix colors of links to not be default
    color: inherit;
  }
`]))),qL=Te.div(Sce||(Sce=J([`
  position: relative;
  padding: 0px 12px;
  font-weight: 400;
  font-size: 11px;
  height: 32px;
  text-decoration: none;
  user-select: none;
  display: flex;
  flex-direction: row;
  align-items: center;
  cursor: default;
`]))),n3=Te(qL)(wce||(wce=J([`
  &:before {
    position: absolute;
    display: block;
    content: ' ';
    inset: 3px;
    border-radius: 3px;
    background: rgba(255, 255, 255, 0.1);
    opacity: 0;
  }

  &.secondary {
    color: rgba(255, 255, 255, 0.5);
  }

  &:hover {
    /* background-color: #398995; */
    color: white !important;
    &:before {
      opacity: 1;
    }
  }
`]))),Tce=Te(qL)(Ece||(Ece=J([`
  height: auto;
  min-height: 32px;
  padding-top: 12px;
  padding-bottom: 10px;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  gap: 8px;
  color: rgba(255, 255, 255, 0.5);
`]))),Cce=Te.div(Mce||(Mce=J([`
  font-weight: 600;
`]))),Pce=Te.div(Ace||(Ace=J([`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`]))),Ice=Te.div(Rce||(Rce=J([`
  margin-left: 2px;
`]))),CA=Te.div(kce||(kce=J([`
  height: 1px;
  margin: 0 2px;
  background: rgba(255, 255, 255, 0.02);
`]))),Dce=Te.div(Nce||(Nce=J([`
  position: absolute;
  width: 8px;
  height: 8px;
  background: #40aaa4;
  right: 14px;
  top: 12px;
  border-radius: 50%;
`]))),XL="0.7.2",YL=XL.match(/^[^\-]+/)[0],Oce=eo.default.forwardRef((a,u)=>{let c=qr(Se().atomP.ahistoric.updateChecker.result.hasUpdates);return eo.default.createElement(bce,{ref:u},eo.default.createElement(n3,{as:"a",href:"https://www.theatrejs.com/docs/latest",className:"",target:"_blank"},"Docs"),eo.default.createElement(n3,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases",className:"",target:"_blank"},"Changelog"),eo.default.createElement(CA,null),eo.default.createElement(n3,{as:"a",href:"https://github.com/theatre-js/theatre",className:"",target:"_blank"},"Github"),eo.default.createElement(n3,{as:"a",href:"https://twitter.com/theatre_js",className:"",target:"_blank"},"Twitter"),eo.default.createElement(n3,{className:"",as:"a",href:"https://discord.gg/bm9f8F9Y9N",target:"_blank"},"Discord"),eo.default.createElement(CA,null),eo.default.createElement(Tce,null,eo.default.createElement(Cce,null,"Version"),eo.default.createElement(Pce,null,eo.default.createElement(Ice,null,XL," ",c===!0?"(outdated)":c===!1?"(latest)":""))),c===!0&&eo.default.createElement(eo.default.Fragment,null,eo.default.createElement(CA,null),eo.default.createElement(n3,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases".concat(encodeURIComponent(YL)),className:"",target:"_blank"},"Update",eo.default.createElement(Dce,null)),eo.default.createElement(n3,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases#".concat(encodeURIComponent(YL)),className:"",target:"_blank"},"What's new?")))}),Fce=Oce}),ds,Lce,Uce,Bce,zce,Vce,Gce,KL,Hce,ZL,jce,QL,Wce,$ce,wbe=I(()=>{tr(),Ae(),ds=Q(qe()),Ft(),zb(),ibe(),aC(),Lce=mn(),gce(),vbe(),db(),_be(),bbe(),yS(),wp(),Sbe(),Yb(),Bce=Te.div(Uce||(Uce=J([`
  height: 36px;
  pointer-events: none;

  display: flex;
  justify-content: space-between;
  padding: 12px;
`]))),Vce=Te.div(zce||(zce=J([`
  color: white;
  width: 14px;
  height: 14px;
  background: #d00;
  border-radius: 4px;
  text-align: center;
  line-height: 14px;
  font-weight: 600;
  font-size: 8px;
  position: relative;
  left: -6px;
  top: -11px;
  margin-right: -14px;
  box-shadow: 0 4px 6px -4px #00000059;
`]))),KL=Te.div(Gce||(Gce=J([`
  display: flex;
  gap: 8px;
`]))),ZL=Te.div(Hce||(Hce=J([`
  position: absolute;
  background: `,`;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  right: -2px;
  top: -2px;
`])),({type:a})=>a==="info"?"#40aaa4":"#f59e0b"),Te.div(jce||(jce=J([`
  position: absolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),QL=!1,Wce=()=>{var a,u,c;let m=Gr(()=>{let H=(0,Lce.val)(Se().atomP.ephemeral.coreByProject);return Object.entries(H).map(([X,K])=>({projectId:X,state:K})).filter(({state:X})=>X.loadingState.type==="browserStateIsNotBasedOnDiskState")},[]),[_,b]=A6({enabled:m.length>0,enterDelay:m.length>0?0:200},()=>m.length>0?ds.default.createElement(Oue,null,m.length===1?'There is a state conflict in project "'.concat(m[0].projectId,'". Select the project in the outline below in order to fix it.'):"There are ".concat(m.length," projects that have state conflicts. They are highlighted in the outline below. ")):ds.default.createElement(P6,null,ds.default.createElement(ds.default.Fragment,null,"Outline"))),E=(a=qr(Se().atomP.ahistoric.pinOutline))!=null?a:!0,T=(u=qr(Se().atomP.ahistoric.pinDetails))!=null?u:!0,R=qr(Se().atomP.ahistoric.updateChecker.result.hasUpdates)===!0,N=Sp(()=>{let H=z.current.getBoundingClientRect();return{debugName:"More Menu",constraints:{maxX:H.right,maxY:8,minX:H.left-140,minY:8},verticalGap:2}},()=>ds.default.createElement(Fce,null)),z=(0,ds.useRef)(null),G=(0,ds.useMemo)(()=>(window.__IS_VISUAL_REGRESSION_TESTING&&(QL||(QL=!0,console.warn("Visual regression testing enabled, so we're showing the updates badge unconditionally"))),R||window.__IS_VISUAL_REGRESSION_TESTING?!0:R),[R]),{hasNotifications:V}=zO(),[B,j]=bte();return ds.default.createElement(Bce,null,ds.default.createElement(KL,null,_,ds.default.createElement(MA,{ref:b,"data-testid":"OutlinePanel-TriggerButton",onClick:()=>{Se().transaction(({stateEditors:H,drafts:X})=>{var K;H.studio.ahistoric.setPinOutline(!((K=X.ahistoric.pinOutline)==null||K))})},icon:ds.default.createElement(aD,null),pinHintIcon:ds.default.createElement($L,null),unpinHintIcon:ds.default.createElement(jL,null),pinned:E}),m.length>0?ds.default.createElement(Vce,null,m.length):null,ds.default.createElement(GL,{showLeftDivider:!0,toolbarId:"global"})),ds.default.createElement(KL,null,B,ds.default.createElement(MA,{ref:j,onClick:()=>{Se().transaction(({stateEditors:H,drafts:X})=>{var K;H.studio.ahistoric.setPinNotifications(!((K=X.ahistoric.pinNotifications)!=null&&K))})},icon:ds.default.createElement(fM,null),pinHintIcon:ds.default.createElement(fM,null),unpinHintIcon:ds.default.createElement(fM,null),pinned:(c=qr(Se().atomP.ahistoric.pinNotifications))!=null?c:!1},V&&ds.default.createElement(ZL,{type:"warning"})),N.node,ds.default.createElement(q6,{ref:z,onClick:H=>{N.toggle(H,z.current)}},ds.default.createElement(Uq,null),G&&ds.default.createElement(ZL,{type:"info"})),ds.default.createElement(MA,{ref:b,onClick:()=>{Se().transaction(({stateEditors:H,drafts:X})=>{var K;H.studio.ahistoric.setPinDetails(!((K=X.ahistoric.pinDetails)==null||K))})},icon:ds.default.createElement(Lq,null),pinHintIcon:ds.default.createElement(jL,null),unpinHintIcon:ds.default.createElement($L,null),pinned:T})))},$ce=Wce}),qce,SS,Xce,wS,Yce,Kce,Zce,Qce,Jce=I(()=>{qce=mn(),tr(),SS=Q(qe()),Xce=Q(mo()),wS=new qce.Atom({set:{},byId:{}}),Yce=1,Kce=()=>{let a=Yce++;function u(m,_,b){wS.reduce(E=>({byId:$(P({},E.byId),{[a]:{comp:m,props:_,portalNode:b}}),set:$(P({},E.set),{[a]:!0})}))}function c(){wS.reduce(m=>{let _=P({},m.set),b=P({},m.byId);return delete _[a],{byId:b,set:_}})}return{mountOrRender:u,unmount:c}},Zce=()=>{let a=Object.keys(qr(wS.pointer.set));return SS.default.createElement(SS.default.Fragment,null,a.map(u=>SS.default.createElement(Qce,{key:"id-"+u,id:u})))},Qce=({id:a})=>{let{comp:u,portalNode:c,props:m}=qr(wS.pointer.byId[a]);return(0,Xce.createPortal)(SS.default.createElement(u,P({},m)),c)}});function Ebe(a){let u=Se(),[c,m]=Ii(void 0),_=qoe();_.configureLogging({min:128,dev:eU,internal:eU});let b=_.getLogger().named("Theatre.js UIRoot");$xe();let E=qr(u.atomP.ahistoric.visibilityState);return(0,u0.useEffect)(()=>(E==="everythingIsHidden"&&console.warn("Theatre.js Studio is hidden. Use the keyboard shortcut 'alt + \\' to restore the studio, or call studio.ui.restore()."),()=>{}),[E]),Gr(()=>{let T=(0,JL.val)(u.atomP.ahistoric.visibilityState);return(0,JL.val)(u.atomP.ephemeral.initialised)?u0.default.createElement(tY,{logger:b},u0.default.createElement(see,null,u0.default.createElement(cye,null,u0.default.createElement(she,null),u0.default.createElement(c6.Provider,{value:m},u0.default.createElement(rD,{target:window.__IS_VISUAL_REGRESSION_TESTING===!0?void 0:a.containerShadow},u0.default.createElement(u0.default.Fragment,null,u0.default.createElement(the,null),u0.default.createElement(rhe,{className:T==="everythingIsHidden"?"invisible":""},u0.default.createElement(nD,{ref:c}),u0.default.createElement($ce,null),u0.default.createElement(kue,null),u0.default.createElement(Ste,null)))))))):null},[u,c,m])}var JL,u0,ehe,the,nhe,rhe,ihe,eU,she,Tbe=I(()=>{Ae(),tr(),JL=mn(),u0=Q(qe()),Ft(),rbe(),wbe(),Ui(),H5(),NL(),dc(),aee(),AD(),Jce(),Bi(),fA(),O9(),Yb(),the=typeof window<"u"?$x(ehe||(ehe=J([`
  :host {
    contain: strict;
  }
`]))):{},rhe=Te(eY)(nhe||(nhe=J([`
  z-index: 50;
  position: fixed;
  inset: 0;

  &.invisible {
    pointer-events: none !important;
    opacity: 0;
    transform: translateX(1000000px);
  }
`]))),eU=/Playground.+Theatre\.js/.test((ihe=typeof document<"u"?document==null?void 0:document.title:null)!=null?ihe:""),she=()=>u0.default.createElement(Zce,null)}),Mbe=ie(a=>{var u=mo();a.createRoot=u.createRoot,a.hydrateRoot=u.hydrateRoot}),ahe={};ce(ahe,{default:()=>uhe});var ohe,lhe,uhe,Cbe=I(()=>{Tbe(),ohe=Q(qe()),lhe=Q(Mbe()),Jce(),Bi(),gce(),uhe=class{constructor(){le(this,"containerEl",document.createElement("div")),le(this,"_renderTimeout"),le(this,"_documentBodyUIIsRenderedIn"),le(this,"containerShadow"),this.containerEl.id="theatrejs-studio-root",this.containerEl.style.cssText=`
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      z-index: 100;
    `;let a=()=>{if(window.__IS_VISUAL_REGRESSION_TESTING===!0){let u=document.createElement("div");return u.id="theatrejs-faux-shadow-root",document.body.appendChild(u),u}else return this.containerEl.attachShadow({mode:"open"})};this.containerShadow=a()}render(){let a=()=>{if(!document.body){this._renderTimeout=setTimeout(a,5);return}this._renderTimeout=void 0,this._documentBodyUIIsRenderedIn=document.body,this._documentBodyUIIsRenderedIn.appendChild(this.containerEl),lhe.default.createRoot(this.containerShadow).render(ohe.default.createElement(Ebe,{containerShadow:this.containerShadow}))};this._renderTimeout=setTimeout(a,10)}renderToolset(a,u){let c=Kce();return c.mountOrRender(kve(GL),{toolbarId:a},u),c.unmount}}}),Abe=ie(a=>{a.compare=_,a.reduce=b;var u,c,m;a.REMOVE=u=-1,a.ADD=c=1,a.EQUAL=m=0;function _(z,G){var V=z.length,B=G.length,j=E(z,G),H=j<V&&j<B?T(z,G):0,X=H+j-1;V-=X,B-=X;for(var K=N(V,B),te=V-1;te>=0;--te)for(var se=B-1;se>=0;--se)K[se][te]=R(K,z,G,j,te,se);return{prefix:j,matrix:K,suffix:H}}function b(z,G,V){var B,j,H,X,K=V.matrix,te=V.prefix;for(B=0;B<te;++B)G=z(G,m,B,B);for(H=B,te=K.length,B=0,j=0;B<te;)switch(X=K[B][j].type,G=z(G,X,B+H,j+H),X){case m:++B,++j;break;case u:++j;break;case c:++B;break}for(B+=H,j+=H,te=V.suffix,H=0;H<te;++H)G=z(G,m,B+H,j+H);return G}function E(z,G){for(var V=0,B=Math.min(z.length,G.length);V<B&&z[V]===G[V];)++V;return V}function T(z,G){for(var V=z.length-1,B=G.length-1,j=Math.min(V,B),H=0;H<j&&z[V-H]===G[B-H];)++H;return H}function R(z,G,V,B,j,H){return G[j+B]===V[H+B]?{value:z[H+1][j+1].value,type:m}:z[H][j+1].value<z[H+1][j].value?{value:z[H][j+1].value+1,type:u}:{value:z[H+1][j].value+1,type:c}}function N(z,G){var V=[],B,j,H;for(H=V[G]=[],j=0;j<z;++j)H[j]={value:z-j,type:u};for(B=0;B<G;++B)V[B]=[],V[B][z]={value:G-B,type:c};return V[G][z]={value:0,type:m},V}}),che=ie(a=>{a.cons=u,a.tail=c,a.map=m;function u(_,b){var E=b.length,T=new Array(E+1);T[0]=_;for(var R=0;R<E;++R)T[R+1]=b[R];return T}function c(_){for(var b=_.length-1,E=new Array(b),T=0;T<b;++T)E[T]=_[T+1];return E}function m(_,b){for(var E=new Array(b.length),T=0;T<b.length;++T)E[T]=_(b[T]);return E}}),Pbe=ie((a,u)=>{u.exports=E;var c=/\/|~1|~0/g,m="/",_="~",b="~1";function E(T,R){var N,z,G,V;for(N=T.charAt(0)===m?1:0,z="",c.lastIndex=N;G=c.exec(T);)if(V=G[0],z+=T.slice(N,c.lastIndex-V.length),N=c.lastIndex,V===m){if(R(z)===!1)return T;z=""}else z+=V===b?m:_;return z+=T.slice(N),R(z),T}}),tU=ie(a=>{var u=Pbe();a.find=z,a.join=V,a.absolute=G,a.parse=B,a.contains=j,a.encodeSegment=X,a.decodeSegment=H,a.parseArrayIndex=se,a.isValidArrayIndex=te;var c="/",m=/\//g,_="~1",b=/~1/g,E="~",T=/~/g,R="~0",N=/~0/g;function z(fe,ye,Ne,ze){if(typeof ye=="string"){if(ye==="")return{target:fe,key:void 0};if(ye===c)return{target:fe,key:""};var Me=fe,je,yt=ze!==void 0;return u(ye,function(xe){if(fe==null)return Me=null,!1;Array.isArray(fe)?je=yt?pe(Ne,se(xe),fe,ze):xe==="-"?xe:se(xe):je=xe,Me=fe,fe=fe[je]}),Me===null?void 0:{target:Me,key:je}}}function G(fe){return fe[0]===c?fe:c+fe}function V(fe){return fe.join(c)}function B(fe){var ye=[];return u(fe,ye.push.bind(ye)),ye}function j(fe,ye){return ye.indexOf(fe)===0&&ye[fe.length]===c}function H(fe){return fe.replace(b,c).replace(N,E)}function X(fe){return fe.replace(T,R).replace(m,_)}var K=/^(0|[1-9]\d*)$/;function te(fe){return K.test(fe)}function se(fe){if(te(fe))return+fe;throw new SyntaxError("invalid array index "+fe)}function pe(fe,ye,Ne,ze){var Me=ye;if(Me<0)throw new Error("array index out of bounds "+Me);if(ze!==void 0&&typeof fe=="function"&&(Me=fe(ye,Ne,ze),Me<0))throw new Error("could not find patch context "+ze);return Me}}),hhe=ie((a,u)=>{u.exports=c;function c(b){return b==null||typeof b!="object"?b:Array.isArray(b)?m(b):_(b)}function m(b){for(var E=b.length,T=new Array(E),R=0;R<E;++R)T[R]=c(b[R]);return T}function _(b){for(var E=Object.keys(b),T={},R,N=0,z=E.length;N<z;++N)R=E[N],T[R]=c(b[R]);return T}}),Rbe=ie((a,u)=>{u.exports=c;function c(b,E){return b===E?!0:Array.isArray(b)&&Array.isArray(E)?m(b,E):typeof b=="object"&&typeof E=="object"?_(b,E):!1}function m(b,E){if(b.length!==E.length)return!1;for(var T=0;T<b.length;++T)if(!c(b[T],E[T]))return!1;return!0}function _(b,E){if(b===null&&E!==null||b!==null&&E===null)return!1;var T=Object.keys(b),R=Object.keys(E);if(T.length!==R.length)return!1;for(var N=0,z;N<T.length;++N)if(z=T[N],!(z in E&&c(b[z],E[z])))return!1;return!0}}),Ibe=ie((a,u)=>{var c=tU();u.exports=function(z,G){var V=c.parse(z.path),B=c.parse(G.path),j=R(V,B),H=b(V,B,j.length),X=N(z),K=N(G);return j.length===0&&!H?[K,X]:H?_(X,V,K,B):m(X,V,K)};function m(z,G,V,B){if(z.path===V.path)throw new TypeError("cannot commute "+z.op+","+V.op+" with identical object paths");return[V,z]}function _(z,G,V,B){return G.length===B.length?E(z,G,V,B):(G.length>B.length?(G=T(V,B,z,G,-1),z.path=c.absolute(c.join(G))):(B=T(z,G,V,B,1),V.path=c.absolute(c.join(B))),[V,z])}function b(z,G,V){return c.isValidArrayIndex(z[V])&&c.isValidArrayIndex(G[V])}function E(z,G,V,B){var j=G.length-1,H=+G[j],X=+B[j],K;return H<X?z.op==="add"||z.op==="copy"?(K=B.slice(),K[j]=Math.max(0,X-1),V.path=c.absolute(c.join(K))):z.op==="remove"&&(K=B.slice(),K[j]=X+1,V.path=c.absolute(c.join(K))):V.op==="add"||V.op==="copy"?(K=G.slice(),K[j]=H+1,z.path=c.absolute(c.join(K))):H>X&&V.op==="remove"&&(K=G.slice(),K[j]=Math.max(0,H-1),z.path=c.absolute(c.join(K))),[V,z]}function T(z,G,V,B,j){var H=G.length-1,X=+G[H],K=+B[H],te=B.slice();return X>K||(z.op==="add"||z.op==="copy"?te[H]=Math.max(0,K-j):z.op==="remove"&&(te[H]=Math.max(0,K+j))),te}function R(z,G){var V=z.length,B=G.length;if(V===0||B===0||V<2&&B<2)return[];for(var j=V===B?V-1:Math.min(V,B),H=0;H<j&&z[H]===G[H];)++H;return z.slice(0,H)}function N(z){return z.op==="remove"?{op:z.op,path:z.path}:z.op==="copy"||z.op==="move"?{op:z.op,path:z.path,from:z.from}:{op:z.op,path:z.path,value:z.value}}}),dhe=ie((a,u)=>{u.exports=c;function c(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}c.prototype=Object.create(Error.prototype),c.prototype.constructor=c}),nU=ie((a,u)=>{u.exports=c;function c(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}c.prototype=Object.create(Error.prototype),c.prototype.constructor=c}),fhe=ie((a,u)=>{u.exports=c;function c(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}c.prototype=Object.create(Error.prototype),c.prototype.constructor=c}),phe=ie(a=>{var u=tU(),c=hhe(),m=Rbe(),_=Ibe(),b=che(),E=dhe(),T=nU(),R=fhe(),N=u.find,z=u.parseArrayIndex;a.test={apply:G,inverse:V,commute:B},a.add={apply:j,inverse:X,commute:K},a.remove={apply:fe,inverse:Ne,commute:ze},a.replace={apply:te,inverse:se,commute:pe},a.move={apply:Me,inverse:je,commute:yt},a.copy={apply:xe,inverse:We,commute:K};function G(Ve,Ue,at){var Wt=N(Ve,Ue.path,at.findContext,Ue.context),be=Wt.target,Ce,St;if(Array.isArray(be)?(Ce=z(Wt.key),St=be[Ce]):St=Wt.key===void 0?Wt.target:Wt.target[Wt.key],!m(St,Ue.value))throw new E("test failed "+JSON.stringify(Ue));return Ve}function V(Ve,Ue){return Ve.push(Ue),1}function B(Ve,Ue){if(Ve.path===Ue.path&&Ue.op==="remove")throw new TypeError("Can't commute test,remove -> remove,test for same path");return Ue.op==="test"||Ue.op==="replace"?[Ue,Ve]:_(Ve,Ue)}function j(Ve,Ue,at){var Wt=N(Ve,Ue.path,at.findContext,Ue.context);if(ae(Wt))throw new T("path does not exist "+Ue.path);if(Ue.value===void 0)throw new T("missing value");var be=c(Ue.value);return Wt.key===void 0?be:(H(Wt,be),Ve)}function H(Ve,Ue){var at=Ve.target;if(Array.isArray(at))if(Ve.key==="-")at.push(Ue);else{if(Ve.key>at.length)throw new T("target of add outside of array bounds");at.splice(Ve.key,0,Ue)}else if(dn(at))at[Ve.key]=Ue;else throw new T("target of add must be an object or array "+Ve.key)}function X(Ve,Ue){var at=Ue.context;return at!==void 0&&(at={before:at.before,after:b.cons(Ue.value,at.after)}),Ve.push({op:"test",path:Ue.path,value:Ue.value,context:at}),Ve.push({op:"remove",path:Ue.path,context:at}),1}function K(Ve,Ue){if(Ve.path===Ue.path&&Ue.op==="remove")throw new TypeError("Can't commute add,remove -> remove,add for same path");return _(Ve,Ue)}function te(Ve,Ue,at){var Wt=N(Ve,Ue.path,at.findContext,Ue.context);if(ae(Wt)||nt(Wt))throw new T("path does not exist "+Ue.path);if(Ue.value===void 0)throw new T("missing value");var be=c(Ue.value);if(Wt.key===void 0)return be;var Ce=Wt.target;return Array.isArray(Ce)?Ce[z(Wt.key)]=be:Ce[Wt.key]=be,Ve}function se(Ve,Ue,at,Wt){var be=Wt[at-1];if(be===void 0||be.op!=="test"||be.path!==Ue.path)throw new R("cannot invert replace w/o test");var Ce=be.context;return Ce!==void 0&&(Ce={before:Ce.before,after:b.cons(be.value,b.tail(Ce.after))}),Ve.push({op:"test",path:be.path,value:Ue.value}),Ve.push({op:"replace",path:be.path,value:be.value}),2}function pe(Ve,Ue){if(Ve.path===Ue.path&&Ue.op==="remove")throw new TypeError("Can't commute replace,remove -> remove,replace for same path");return Ue.op==="test"||Ue.op==="replace"?[Ue,Ve]:_(Ve,Ue)}function fe(Ve,Ue,at){var Wt=N(Ve,Ue.path,at.findContext,Ue.context);if(ae(Wt)||Wt.target[Wt.key]===void 0)throw new T("path does not exist "+Ue.path);return ye(Wt),Ve}function ye(Ve){var Ue=Ve.target,at;if(Array.isArray(Ue))return at=Ue.splice(z(Ve.key),1),at[0];if(dn(Ue))return at=Ue[Ve.key],delete Ue[Ve.key],at;throw new T("target of remove must be an object or array")}function Ne(Ve,Ue,at,Wt){var be=Wt[at-1];if(be===void 0||be.op!=="test"||be.path!==Ue.path)throw new R("cannot invert remove w/o test");var Ce=be.context;return Ce!==void 0&&(Ce={before:Ce.before,after:b.tail(Ce.after)}),Ve.push({op:"add",path:be.path,value:be.value,context:Ce}),2}function ze(Ve,Ue){return Ve.path===Ue.path&&Ue.op==="remove"?[Ue,Ve]:_(Ve,Ue)}function Me(Ve,Ue,at){if(u.contains(Ue.path,Ue.from))throw new T("move.from cannot be ancestor of move.path");var Wt=N(Ve,Ue.path,at.findContext,Ue.context),be=N(Ve,Ue.from,at.findContext,Ue.fromContext);return H(Wt,ye(be)),Ve}function je(Ve,Ue){return Ve.push({op:"move",path:Ue.from,context:Ue.fromContext,from:Ue.path,fromContext:Ue.context}),1}function yt(Ve,Ue){if(Ve.path===Ue.path&&Ue.op==="remove")throw new TypeError("Can't commute move,remove -> move,replace for same path");return _(Ve,Ue)}function xe(Ve,Ue,at){var Wt=N(Ve,Ue.path,at.findContext,Ue.context),be=N(Ve,Ue.from,at.findContext,Ue.fromContext);if(ae(be)||nt(be))throw new T("copy.from must exist");var Ce=be.target,St;return Array.isArray(Ce)?St=Ce[z(be.key)]:St=Ce[be.key],H(Wt,c(St)),Ve}function We(Ve,Ue){throw new R("cannot invert "+Ue.op)}function ae(Ve){return Ve===void 0||Ve.target==null&&Ve.key!==void 0}function nt(Ve){return Ve.key!==void 0&&Ve.target[Ve.key]===void 0}function dn(Ve){return Ve!==null&&typeof Ve=="object"}}),kbe=ie(a=>{var u=phe(),c=hhe(),m=nU();a.apply=b,a.applyInPlace=E,a.clone=c,a.isValidObject=R,a.defaultHash=T;var _={};function b(z,G,V){return E(z,c(G),V)}function E(z,G,V){if(V||(V=_),!Array.isArray(z))return G;for(var B,j,H=0;H<z.length;++H){if(j=z[H],B=u[j.op],B===void 0)throw new m("invalid op "+JSON.stringify(j));G=B.apply(G,j,V)}return G}function T(z){return R(z)||N(z)?JSON.stringify(z):z}function R(z){return z!==null&&Object.prototype.toString.call(z)==="[object Object]"}function N(z){return Object.prototype.toString.call(z)==="[object Array]"}}),Nbe=ie((a,u)=>{var c=phe();u.exports=function(_){var b=[],E,T;for(E=_.length-1;E>=0;E-=T)T=m(b,_[E],E,_);return b};function m(_,b,E,T){var R=c[b.op];return R!==void 0&&typeof R.inverse=="function"?R.inverse(_,b,E,T):1}}),Dbe=ie(a=>{var u=Abe(),c=che(),m=kbe(),_=Nbe(),b=tU(),E=b.encodeSegment;a.diff=N,a.patch=m.apply,a.patchInPlace=m.applyInPlace,a.inverse=_,a.clone=m.clone,a.InvalidPatchOperationError=nU(),a.TestFailedError=dhe(),a.PatchNotInvertibleError=fhe();var T=m.isValidObject,R=m.defaultHash;function N(se,pe,fe){return G(se,pe,"",z(fe,[])).patch}function z(se,pe){return typeof se=="object"?{patch:pe,hash:X(te,se.hash,R),makeContext:X(te,se.makeContext,K),invertible:se.invertible!==!1}:{patch:pe,hash:X(te,se,R),makeContext:K,invertible:!0}}function G(se,pe,fe,ye){return Array.isArray(se)&&Array.isArray(pe)?B(se,pe,fe,ye):T(se)&&T(pe)?V(se,pe,fe,ye):H(se,pe,fe,ye)}function V(se,pe,fe,ye){var Ne=Object.keys(pe),ze=ye.patch,Me,je;for(Me=Ne.length-1;Me>=0;--Me){je=Ne[Me];var yt=fe+"/"+E(je);se[je]!==void 0?G(se[je],pe[je],yt,ye):ze.push({op:"add",path:yt,value:pe[je]})}for(Ne=Object.keys(se),Me=Ne.length-1;Me>=0;--Me)if(je=Ne[Me],pe[je]===void 0){var xe=fe+"/"+E(je);ye.invertible&&ze.push({op:"test",path:xe,value:se[je]}),ze.push({op:"remove",path:xe})}return ye}function B(se,pe,fe,ye){var Ne=c.map(ye.hash,se),ze=c.map(ye.hash,pe),Me=u.compare(Ne,ze);return j(se,pe,fe,ye,Me)}function j(se,pe,fe,ye,Ne){var ze=0;return u.reduce(function(Me,je,yt,xe){var We,ae,nt=Me.patch,dn=fe+"/"+(xe+ze);return je===u.REMOVE?(We=nt[nt.length-1],ae=Me.makeContext(xe,se),Me.invertible&&nt.push({op:"test",path:dn,value:se[xe],context:ae}),We!==void 0&&We.op==="add"&&We.path===dn?(We.op="replace",We.context=ae):nt.push({op:"remove",path:dn,context:ae}),ze-=1):je===u.ADD?(nt.push({op:"add",path:dn,value:pe[yt],context:Me.makeContext(xe,se)}),ze+=1):G(se[xe],pe[yt],dn,Me),Me},ye,Ne)}function H(se,pe,fe,ye){return se!==pe&&(ye.invertible&&ye.patch.push({op:"test",path:fe,value:se}),ye.patch.push({op:"replace",path:fe,value:pe})),ye}function X(se,pe,fe){return se(pe)?pe:fe}function K(){}function te(se){return typeof se=="function"}}),w8=ie((a,u)=>{function c(m,_){for(var b=0,E=_.length-1;b<E;b++){if(!m[_[b]])return null;m=m[_[b]]}return m}u.exports=c}),r3=ie((a,u)=>{function c(_){return _==="~0"?"~":"/"}function m(_){var b=_.split("/");if(_.indexOf("~")===-1)return b;for(var E=0,T=b.length;E<T;E++)b[E].indexOf("~")!==-1&&(b[E]=b[E].replace(/~[01]/g,c));return b}u.exports=m}),Obe=ie((a,u)=>{var c=w8(),m=r3();function _(b,E){var T=m(E),R=T[T.length-1],N=c(b,T);return N?N[R]:void 0}u.exports=_}),AA=ie((a,u)=>{function c(m,_){if(m===_)return!0;if(!(m&&_)||typeof m!="object"||typeof _!="object"||m.length!==_.length)return!1;if(Array.isArray(m)){if(!Array.isArray(_))return!1;for(var b=0,E=m.length;b<E;b++)if(!c(m[b],_[b]))return!1;return!0}var T=Object.keys(m);if(T.length!==Object.keys(_).length)return!1;for(var R=0,N=T.length;R<N;R++){var z=T[R];if(!c(m[z],_[z]))return!1}return!0}u.exports=c}),PA=ie((a,u)=>{function c(m,_){if(_==="-")return m.length;for(var b=0,E=_.length;b<E;b++){var T=_.charCodeAt(b);if(57<T||T<48)return 1/0}return+_}u.exports=c}),RA=ie((a,u)=>{var c=AA(),m=w8(),_=PA(),b=r3();function E(T,R,N,z){if(typeof N>"u")return"[op:add] require value, but got undefined";var G=b(R),V=G[G.length-1],B=m(T,G);if(B===null)return"[op:add] path not found: "+R;if(Array.isArray(B)){var j=_(B,V);if(B.length<j)return"[op:add] invalid array index: "+R;z(T,G).splice(j,0,N)}else c(B[V],N)||(z(T,G)[V]=N)}u.exports=E}),mhe=ie((a,u)=>{var c=w8(),m=PA(),_=r3();function b(E,T,R){var N=_(T),z=N[N.length-1],G=c(E,N);if(G===null)return"[op:remove] path not found: "+T;if(Array.isArray(G)){var V=m(G,z);if(G.length<=V)return"[op:remove] invalid array index: "+T;R(E,N).splice(V,1)}else delete R(E,N)[z]}u.exports=b}),ghe=ie((a,u)=>{var c=AA(),m=w8(),_=PA(),b=r3();function E(T,R,N,z){if(typeof N>"u")return"[op:replace] require value, but got undefined";var G=b(R),V=G[G.length-1],B=m(T,G);if(B===null)return"[op:replace] path not found: "+R;if(Array.isArray(B)){var j=_(B,V);if(B.length<=j)return"[op:replace] invalid array index: "+R;c(B[j],N)||z(T,G).splice(j,1,N)}else c(B[V],N)||(z(T,G)[V]=N)}u.exports=E}),vhe=ie((a,u)=>{var c=RA(),m=w8(),_=PA(),b=r3();function E(T,R,N,z){if(N!==R){var G=b(R),V=G[G.length-1],B=m(T,G);if(B===null)return"[op:move] path not found: "+R;var j=void 0;if(Array.isArray(B)){var H=_(B,V);if(B.length<=H)return"[op:move] invalid array index: "+N;j=B[H],z(T,G).splice(H,1)}else j=B[V],delete z(T,G)[V];return c(T,N,j,z)}}u.exports=E}),yhe=ie((a,u)=>{var c=w8(),m=r3(),_=RA();function b(E,T,R,N){var z=m(T),G=z[z.length-1],V=c(E,z);return V===null?"[op:copy] path not found: "+T:_(E,R,V[G],N)}u.exports=b}),_he=ie((a,u)=>{var c=AA(),m=w8(),_=r3();function b(E,T,R){var N=_(T),z=N[N.length-1],G=m(E,N);if(G===null)return"[op:test] path not found: "+T;if(!c(G[z],R)){var V=JSON.stringify(G[z]),B=JSON.stringify(R);return"[op:test] not matched: "+V+" "+B}}u.exports=b}),rU=ie((a,u)=>{function c(m){if(!m||typeof m!="object")return m;if(Array.isArray(m)){for(var _=m.length,b=new Array(_),E=0;E<_;E++)b[E]=m[E];return b}for(var T=Object.keys(m),R={},N=0,z=T.length;N<z;N++){var G=T[N];R[G]=m[G]}return R}u.exports=c}),Fbe=ie((a,u)=>{var c=Obe(),m=RA(),_=mhe(),b=ghe(),E=vhe(),T=yhe(),R=_he(),N=AA(),z=rU(),G=r3();function V(B,j){return{get:function(H){return c(B,H)},add:function(H,X){return m(B,H,X,j)},remove:function(H){return _(B,H,j)},replace:function(H,X){return b(B,H,X,j)},move:function(H,X){return E(B,H,X,j)},copy:function(H,X){return T(B,H,X,j)},test:function(H,X){return R(B,H,X)},deepEqual:N,shallowCopy:z,toKeys:G}}u.exports=V}),Lbe=ie((a,u)=>{function c(m,_,b,E){return E.error=b,E.partial?_[""]:m}u.exports=c}),Ube=ie((a,u)=>{function c(m){return!!m}u.exports=c}),Bbe=ie((a,u)=>{function c(m){if(m)throw new TypeError(m)}u.exports=c}),zbe=ie((a,u)=>{var c=rU();function m(_,b){for(var E=0,T=b.length-1;E<T;E++)_=_[b[E]]=c(_[b[E]]);return _}u.exports=m}),Vbe=ie((a,u)=>{var c=rU();function m(b,E,T){var R=b[E];return T.has(R)||(R=c(R),T.add(R)),R}function _(b,E,T){for(var R=0,N=E.length-1;R<N;R++)b=b[E[R]]=m(b,E[R],T);return b}u.exports=_}),Gbe=ie((a,u)=>{var c=Fbe(),m=Lbe(),_=Ube(),b=Bbe(),E=zbe(),T=Vbe(),R=RA(),N=mhe(),z=ghe(),G=vhe(),V=yhe(),B=_he(),j=Set||function(){var X=[];return X.has=function(K){return this.indexOf(K)!==-1},X.add=function(K){this.push(K)},X};function H(X,K,te){if(K.length===0)return X;te=te||{};for(var se=te.strict?b:_,pe=K.length===1?E:function(je){return function(yt,xe){return T(yt,xe,je)}}(new j),fe={"":X},ye,Ne=0,ze=K.length;Ne<ze;Ne++){var Me=K[Ne];switch(Me.op){case"add":if(se(R(fe,""+Me.path,Me.value,pe)))return m(X,fe,Me,te);break;case"remove":if(se(N(fe,""+Me.path,pe)))return m(X,fe,Me,te);break;case"replace":if(se(z(fe,""+Me.path,Me.value,pe)))return m(X,fe,Me,te);break;case"move":if(se(G(fe,""+Me.from,""+Me.path,pe)))return m(X,fe,Me,te);break;case"copy":if(se(V(fe,""+Me.from,""+Me.path,pe)))return m(X,fe,Me,te);break;case"test":if(se(B(fe,""+Me.path,Me.value)))return m(X,fe,Me,te);break;default:if(te.custom&&te.custom[Me.op]){if(ye=ye||c(fe,pe),se(te.custom[Me.op](ye,Me,Ne,K)))return m(X,fe,Me,te)}else return se("[op:"+Me.op+"] unknown"),m(X,fe,Me,te);break}}return fe[""]}u.exports=H}),Hbe=ie((a,u)=>{u.exports=Gbe()}),jbe=ie((a,u)=>{(function(c,m){typeof a=="object"&&typeof u=="object"?u.exports=m():typeof a=="object"?a.blobCompare=m():c.blobCompare=m()})(window,function(){return function(c){var m={};function _(b){if(m[b])return m[b].exports;var E=m[b]={i:b,l:!1,exports:{}};return c[b].call(E.exports,E,E.exports,_),E.l=!0,E.exports}return _.m=c,_.c=m,_.d=function(b,E,T){_.o(b,E)||Object.defineProperty(b,E,{enumerable:!0,get:T})},_.r=function(b){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})},_.t=function(b,E){if(1&E&&(b=_(b)),8&E||4&E&&typeof b=="object"&&b&&b.__esModule)return b;var T=Object.create(null);if(_.r(T),Object.defineProperty(T,"default",{enumerable:!0,value:b}),2&E&&typeof b!="string")for(var R in b)_.d(T,R,(function(N){return b[N]}).bind(null,R));return T},_.n=function(b){var E=b&&b.__esModule?function(){return b.default}:function(){return b};return _.d(E,"a",E),E},_.o=function(b,E){return Object.prototype.hasOwnProperty.call(b,E)},_.p="",_(_.s=4)}([function(c,m,_){var b=function(z,G){if(Array.isArray(z))return z;if(Symbol.iterator in Object(z))return function(V,B){var j=[],H=!0,X=!1,K=void 0;try{for(var te,se=V[Symbol.iterator]();!(H=(te=se.next()).done)&&(j.push(te.value),!B||j.length!==B);H=!0);}catch(pe){X=!0,K=pe}finally{try{!H&&se.return&&se.return()}finally{if(X)throw K}}return j}(z,G);throw new TypeError("Invalid attempt to destructure non-iterable instance")},E=function(){function z(G,V){for(var B=0;B<V.length;B++){var j=V[B];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(G,j.key,j)}}return function(G,V,B){return V&&z(G.prototype,V),B&&z(G,B),G}}();function T(z){if(Array.isArray(z)){for(var G=0,V=Array(z.length);G<z.length;G++)V[G]=z[G];return V}return Array.from(z)}var R=_(2),N=function(z){function G(V){(function(j,H){if(!(j instanceof H))throw new TypeError("Cannot call a class as a function")})(this,G);var B=function(j,H){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!H||typeof H!="object"&&typeof H!="function"?j:H}(this,(G.__proto__||Object.getPrototypeOf(G)).call(this));return B._messageId=1,B._messages=new Map,B._worker=V,B._worker.onmessage=B._onMessage.bind(B),B._id=Math.ceil(1e7*Math.random()),B}return function(V,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);V.prototype=Object.create(B&&B.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(V,B):V.__proto__=B)}(G,z),E(G,[{key:"terminate",value:function(){this._worker.terminate()}},{key:"isFree",value:function(){return this._messages.size===0}},{key:"jobsLength",value:function(){return this._messages.size}},{key:"exec",value:function(V){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,j=this,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],X=arguments[3];return new Promise(function(K,te){var se=j._messageId++;j._messages.set(se,[K,te,X]),j._worker.postMessage([se,B,V],H||[])})}},{key:"postMessage",value:function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,B=this,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],H=arguments[2];return new Promise(function(X,K){var te=B._messageId++;B._messages.set(te,[X,K,H]),B._worker.postMessage([te,V],j||[])})}},{key:"emit",value:function(V){for(var B=arguments.length,j=Array(B>1?B-1:0),H=1;H<B;H++)j[H-1]=arguments[H];this._worker.postMessage({eventName:V,args:j})}},{key:"_onMessage",value:function(V){var B;if(!Array.isArray(V.data)&&V.data.eventName)return(B=function te(se,pe,fe){se===null&&(se=Function.prototype);var ye=Object.getOwnPropertyDescriptor(se,pe);if(ye===void 0){var Ne=Object.getPrototypeOf(se);return Ne===null?void 0:te(Ne,pe,fe)}if("value"in ye)return ye.value;var ze=ye.get;return ze!==void 0?ze.call(fe):void 0}(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"emit",this)).call.apply(B,[this,V.data.eventName].concat(T(V.data.args)));var j,H=(j=V.data,Array.isArray(j)?j:Array.from(j)),X=H[0],K=H.slice(1);if(X===1)this._onEvent.apply(this,T(K));else{if(X!==0)throw new Error("Wrong message type '"+X+"'");this._onResult.apply(this,T(K))}}},{key:"_onResult",value:function(V,B,j){var H=this._messages.get(V),X=b(H,2),K=X[0],te=X[1];return this._messages.delete(V),B===1?K(j):te(j)}},{key:"_onEvent",value:function(V,B,j){var H=this._messages.get(V),X=b(H,3)[2];X&&X(B,j)}}]),G}(R);c.exports=N},function(c,m,_){c.exports=function(){return _(3)(`!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=r(1),c=0,l=1,s=0,y=1,p="main",b=function(e){return"object"===(void 0===e?"undefined":i(e))&&"function"==typeof e.then&&"function"==typeof e.catch};var v=function e(t,r){u(this,e),this.payload=t,this.transferable=r};e.exports=function(e){var t,r,i,h=(i=e,(r=p)in(t={})?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t),d=self.postMessage.bind(self),m=new(function(e){function t(){return u(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return d({eventName:e,args:r}),this}},{key:"emitLocally",value:function(e){for(var r,n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];(r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"emit",this)).call.apply(r,[this,e].concat(i))}},{key:"operation",value:function(e,t){return h[e]=t,this}}]),t}(f)),g=function(e,t,r){var n=function(t){t&&t instanceof v?w(e,y,t.payload,t.transferable):w(e,y,t)},o=function(t){w(e,s,{message:t.message,stack:t.stack})};try{var i=_(e,t,r);b(i)?i.then(n).catch(o):n(i)}catch(e){o(e)}},_=function(e,t,r){var n=h[r||p];if(!n)throw new Error("Not found handler for this request");return n(t,O.bind(null,e))},w=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];d([c,e,t,r],n)},O=function(e,t,r){if(!t)throw new Error("eventName is required");if("string"!=typeof t)throw new Error("eventName should be string");d([l,e,t,r])};return self.addEventListener("message",(function(e){var t=e.data;Array.isArray(t)?g.apply(void 0,a(t)):t&&t.eventName&&m.emitLocally.apply(m,[t.eventName].concat(a(t.args)))})),m},e.exports.TransferableResponse=v},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return n(e,[{key:"emit",value:function(e){if(!this.__listeners[e])return this;for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=!0,i=!1,a=void 0;try{for(var u,f=this.__listeners[e][Symbol.iterator]();!(o=(u=f.next()).done);o=!0){var c=u.value;c.apply(void 0,r)}}catch(e){i=!0,a=e}finally{try{!o&&f.return&&f.return()}finally{if(i)throw a}}return this}},{key:"once",value:function(e,t){var r=this,n=function n(){r.off(e,n),t.apply(void 0,arguments)};return this.on(e,n)}},{key:"on",value:function(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}},{key:"off",value:function(e,t){return this.__listeners[e]=t?this.__listeners[e].filter((function(e){return e!==t})):[],this}}]),e}();e.exports=o},function(e,t,r){"use strict";r.r(t);var n=r(0);r.n(n)()().operation("binary",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsBinaryString(a)})}(e,t)).operation("buffer",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsArrayBuffer(a)})}(e,t)).operation("compare",({buf1:e,buf2:t})=>(function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e),n=new DataView(t);for(var o=e.byteLength;o--;)if(r.getUint8(o)!==n.getUint8(o))return!1;return!0})(e,t))}]);`,null)}},function(c,m,_){var b=function(){function T(R,N){for(var z=0;z<N.length;z++){var G=N[z];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(R,G.key,G)}}return function(R,N,z){return N&&T(R.prototype,N),z&&T(R,z),R}}(),E=function(){function T(){(function(R,N){if(!(R instanceof N))throw new TypeError("Cannot call a class as a function")})(this,T),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return b(T,[{key:"emit",value:function(R){if(!this.__listeners[R])return this;for(var N=arguments.length,z=Array(N>1?N-1:0),G=1;G<N;G++)z[G-1]=arguments[G];var V=!0,B=!1,j=void 0;try{for(var H,X=this.__listeners[R][Symbol.iterator]();!(V=(H=X.next()).done);V=!0){var K=H.value;K.apply(void 0,z)}}catch(te){B=!0,j=te}finally{try{!V&&X.return&&X.return()}finally{if(B)throw j}}return this}},{key:"once",value:function(R,N){var z=this,G=function V(){z.off(R,V),N.apply(void 0,arguments)};return this.on(R,G)}},{key:"on",value:function(R,N){return this.__listeners[R]||(this.__listeners[R]=[]),this.__listeners[R].push(N),this}},{key:"off",value:function(R,N){return this.__listeners[R]=N?this.__listeners[R].filter(function(z){return z!==N}):[],this}}]),T}();c.exports=E},function(c,m,_){var b=window.URL||window.webkitURL;c.exports=function(E,T){try{try{var R;try{(R=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(E),R=R.getBlob()}catch{R=new Blob([E])}return new Worker(b.createObjectURL(R))}catch{return new Worker("data:application/javascript,"+encodeURIComponent(E))}}catch{if(!T)throw Error("Inline worker is not supported");return new Worker(T)}}},function(c,m,_){_.r(m);var b=_(0),E=_.n(b),T=_(1),R=_.n(T);_.d(m,"workersEnabled",function(){return N}),_.d(m,"default",function(){return z});let N=!!window.Worker;class z{static toBinaryStringWithWorker(V,B){return Be(this,null,function*(){let j=new E.a(new R.a),H=yield j.exec("binary",{blob:V,chunk:B});return j.terminate(),H})}static toBinaryStringWithoutWorker(V,B){return function(j,H){return new Promise((X,K)=>{let te=new FileReader,se=H?Math.min(H,j.size):j.size,pe=j.slice(0,se);te.onload=()=>X(te.result),te.onerror=K,te.readAsBinaryString(pe)})}(V,B)}static toBinaryString(V,B,j=!0){return j&&N?this.toBinaryStringWithWorker(V,B):this.toBinaryStringWithoutWorker(V,B)}static toArrayBufferWithWorker(V,B){return Be(this,null,function*(){let j=new E.a(new R.a),H=yield j.exec("buffer",{blob:V,chunk:B});return j.terminate(),H})}static toArrayBufferWithoutWorker(V,B){return function(j,H){return new Promise((X,K)=>{let te=new FileReader,se=H?Math.min(H,j.size):j.size,pe=j.slice(0,se);te.onload=()=>X(te.result),te.onerror=K,te.readAsArrayBuffer(pe)})}(V,B)}static toArrayBuffer(V,B,j=!0){return j&&N?this.toArrayBufferWithWorker(V,B):this.toArrayBufferWithoutWorker(V,B)}static compareBuffersWithWorker(V,B){return Be(this,null,function*(){if(V===B)return!0;let j=new E.a(new R.a),H=yield j.exec("compare",{buf1:V,buf2:B},[V,B]);return j.terminate(),H})}static compareBuffersWithoutWorker(V,B){return function(j,H){if(j===H)return!0;if(j.byteLength!==H.byteLength)return!1;let X=new DataView(j),K=new DataView(H);for(var te=j.byteLength;te--;)if(X.getUint8(te)!==K.getUint8(te))return!1;return!0}(V,B)}static compareBuffers(V,B,j=!0){return j&&N?this.compareBuffersWithWorker(V,B):this.compareBuffersWithoutWorker(V,B)}static sizeEqual(V,B){return V.size===B.size}static typeEqual(V,B){return V.type===B.type}static magicNumbersEqual(V,B,j=!0){return Be(this,null,function*(){if(V===B)return!0;let H=[24,16,14,12,8,6,4],[X,K]=yield Promise.all([this.toBinaryString(V,24,j),this.toBinaryString(B,24,j)]);for(let te of H)if(X.substring(0,te)===K.substring(0,te))return!0;return!1})}static bytesEqualWithBinaryString(V,B,j,H=!0){return Be(this,null,function*(){if(V===B)return!0;let[X,K]=yield Promise.all([this.toBinaryString(V,j,H),this.toBinaryString(B,j,H)]);return X===K})}static bytesEqualWithArrayBuffer(V,B,j,H=!0){return Be(this,null,function*(){if(V===B)return!0;let[X,K]=yield Promise.all([this.toArrayBuffer(V,j,H),this.toArrayBuffer(B,j,H)]);return this.compareBuffers(X,K,H)})}static isEqual(V,B){return Be(this,arguments,function*(j,H,{methods:X=["size","type","magic","byte"],byte:K="buffer",partial:te=!1,chunks:se=null,worker:pe=!0}={}){let fe=null;for(let ye of X){if(fe===!1||te&&fe===!0)break;switch(ye){case"byte":case"bytes":case"content":se=se instanceof Array?se:[j.size],fe=!0;for(let Ne of se){let ze=!1;ze=K==="buffer"?yield this.bytesEqualWithArrayBuffer(j,H,Ne,pe):yield this.bytesEqualWithBinaryString(j,H,Ne,pe),ze||(fe=!1)}break;case"magic":case"headers":case"numbers":case"mime":fe=yield this.magicNumbersEqual(j,H,pe);break;case"size":case"sizes":fe=this.sizeEqual(j,H);break;case"type":case"types":fe=this.typeEqual(j,H);break;default:throw new Error("Blob-compare : Unknown comparison method")}}return fe})}}}])})}),xhe={};ce(xhe,{ToolbarDropdownSelect:()=>lwe,default:()=>cwe}),s.exports=oe(xhe),Ae(),_t();var bhe=mn();oi();var Wbe=0,$be=class{constructor(a){this._studio=a,le(this,"_id"),le(this,"_state",{type:"Ready"}),this._id=String(Wbe++)}get status(){return this._state.type}reset(){let{_state:a}=this;if(a.type!=="Ready")if(a.type==="Captured")this._state={type:"Ready"},a.transaction.discard(),a.flagsTransaction.discard();else throw a.type==="Committed"?new Error("This scrub is already committed and can't be reset."):new Error("This scrub is already discarded and can't be reset.")}commit(){let{_state:a}=this;if(a.type==="Captured")a.transaction.commit(),a.flagsTransaction.discard(),this._state={type:"Committed"};else if(a.type==="Ready"){console.warn("Scrub is empty. Nothing to commit.");return}else throw a.type==="Committed"?new Error("This scrub is already committed."):new Error("This scrub is already discarded and can't be comitted.")}capture(a){if(this._state.type==="Captured"&&this.reset(),this._state.type==="Ready"){let u=!0;try{this._state=P({type:"Captured"},this._capture(a)),u=!1}finally{u&&(console.error("This scrub's callback threw an error. We're undo-ing all of the changes made by this scrub, and marking it as discarded."),this._state={type:"Discarded"})}}else throw this._state.type==="Committed"?new Error("This scrub is already committed and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.commit()"):new Error("This scrub is already discarded and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.discard()")}_capture(a){let u=[],c=this._studio.tempTransaction(_=>{let b=!0,E={set:(T,R)=>{if(!b)throw new Error("You seem to have called the scrub api after scrub.capture()");let{root:N,path:z}=(0,bhe.getPointerParts)(T);if(!qt(N))throw new Error("We can only scrub props of Sheet Objects for now");_.set(T,R),u.push(T)}};try{a(E)}finally{b=!1}}),m=this._studio.tempTransaction(({stateEditors:_})=>{u.forEach(b=>{let{root:E,path:T}=(0,bhe.getPointerParts)(b);if(!qt(E))return;let R=E.template.getDefaultsAtPointer(b);lt(R,(N,z)=>{_.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey.propsBeingScrubbed.flag($(P({},E.address),{pathToProp:z}))},T)})});return{transaction:c,flagsTransaction:m}}discard(){let{_state:a}=this;if(a.type==="Captured"||a.type==="Ready")a.type==="Captured"&&(a.transaction.discard(),a.flagsTransaction.discard()),this._state={type:"Discarded"};else throw a.type==="Committed"?new Error("This scrub is already committed and can't be discarded."):new Error("This scrub is already discarded")}},qbe=mn(),She=typeof window<"u"?Promise.resolve().then(()=>(Cbe(),ahe)).then(a=>a.default):null,Xbe=class{constructor(a){this.studio=a,le(this,"_rendered",!1),le(this,"_nonSSRBits",She?She.then(u=>new u):Promise.reject()),le(this,"ready",this._nonSSRBits.then(()=>{},()=>{}))}render(){this._rendered||(this._rendered=!0,this._nonSSRBits.then(a=>{a.render()}).catch(a=>{throw console.error(a),a}))}hide(){this.studio.transaction(({drafts:a})=>{a.ahistoric.visibilityState="everythingIsHidden"})}restore(){this.render(),this.studio.transaction(({drafts:a})=>{a.ahistoric.visibilityState="everythingIsVisible"})}get isHidden(){return(0,qbe.val)(this.studio.atomP.ahistoric.visibilityState)==="everythingIsHidden"}renderToolset(a,u){let c=!1,m=null;return this._nonSSRBits.then(_=>{c||(m=_.renderToolset(a,u))}).catch(_=>{console.error(_)}),()=>{if(m){m();return}c||(c=!0)}}},IA=mn();function Ybe(a){return a}var Kbe=(a,u=Ybe)=>{let c=m=>({type:a,payload:u(m)});return c.type=a,c.is=m=>m&&m.type&&m.type===a,c},Gp=Kbe,whe=Q(Dbe()),Ehe=Q(Hbe());Ny();var kA,Zbe=new Uint8Array(16);function Qbe(){if(!kA&&(kA=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!kA))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return kA(Zbe)}var Jbe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function eSe(a){return typeof a=="string"&&Jbe.test(a)}var tSe=eSe,c0=[];for(NA=0;NA<256;++NA)c0.push((NA+256).toString(16).substr(1));var NA;function nSe(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=(c0[a[u+0]]+c0[a[u+1]]+c0[a[u+2]]+c0[a[u+3]]+"-"+c0[a[u+4]]+c0[a[u+5]]+"-"+c0[a[u+6]]+c0[a[u+7]]+"-"+c0[a[u+8]]+c0[a[u+9]]+"-"+c0[a[u+10]]+c0[a[u+11]]+c0[a[u+12]]+c0[a[u+13]]+c0[a[u+14]]+c0[a[u+15]]).toLowerCase();if(!tSe(c))throw TypeError("Stringified UUID is invalid");return c}var rSe=nSe;function iSe(a,u,c){a=a||{};var m=a.random||(a.rng||Qbe)();if(m[6]=m[6]&15|64,m[8]=m[8]&63|128,u){c=c||0;for(var _=0;_<16;++_)u[c+_]=m[_];return u}return rSe(m)}var sSe=iSe,ES={replaceHistory:Gp("@history/replaceHistory"),startHistoryFromScratch:Gp("@history/startHistoryFromScratch"),undo:Gp("@history/undo"),redo:Gp("@history/redo")},aSe={type:"@history/unknownAction",payload:""},oSe={maxNumberOfCommits:100},lSe=(a,u=oSe)=>{let c=iU(a(void 0,aSe));return function(m,_){return ES.startHistoryFromScratch.is(_)?iU(a(void 0,_.payload)):ES.replaceHistory.is(_)?_.payload:ES.undo.is(_)?m?hSe(m):c:ES.redo.is(_)?m?dSe(m):c:m?uSe(m,a(m.innerState,_),u):iU(a(void 0,_))}};function iU(a){return{currentCommitHash:void 0,commitsByHash:{},listOfCommitHashes:[],innerState:a}}function uSe(a,u,c){if(u===a.innerState)return a;let m=cSe(a.innerState,u);if(m.forwardDiff.length===0)return a;let _=xm(a.listOfCommitHashes),b={currentCommitHash:m.hash,commitsByHash:P({},a.commitsByHash),listOfCommitHashes:[...a.listOfCommitHashes],innerState:u};if(a.currentCommitHash!==_){let E=a.listOfCommitHashes.findIndex(T=>T===a.currentCommitHash);a.listOfCommitHashes.slice(E+1).forEach(T=>{delete b.commitsByHash[T]}),b.listOfCommitHashes.splice(E+1,b.listOfCommitHashes.length)}if(b.listOfCommitHashes.push(m.hash),b.commitsByHash[m.hash]=m,b.listOfCommitHashes.length>c.maxNumberOfCommits){let E=b.listOfCommitHashes.length-c.maxNumberOfCommits;b.listOfCommitHashes.slice(0,E).forEach(T=>{delete b.commitsByHash[T]}),b.listOfCommitHashes.splice(0,E)}return b}function cSe(a,u){let c=whe.default.diff(a,u,{invertible:!1}),m=whe.default.diff(u,a,{invertible:!1}),_=Date.now(),b=sSe();return{forwardDiff:c,backwardDiff:m,timestamp:_,hash:b}}function hSe(a){if(a.currentCommitHash===void 0)return a;let u=a.listOfCommitHashes.findIndex(E=>E===a.currentCommitHash);if(u===-1)throw new Error("This should never happen");let c=a.commitsByHash[a.currentCommitHash],m=(0,Ehe.default)(a.innerState,c.backwardDiff),_=u-1,b=_===-1?void 0:a.listOfCommitHashes[_];return $(P({},a),{currentCommitHash:b,innerState:m})}function dSe(a){if(a.listOfCommitHashes.length===0)return a;let u=a.listOfCommitHashes.findIndex(E=>E===a.currentCommitHash);if(u===a.listOfCommitHashes.length-1)return a;let c=u+1,m=a.listOfCommitHashes[c],_=a.commitsByHash[m],b=(0,Ehe.default)(a.innerState,_.forwardDiff);return $(P({},a),{currentCommitHash:m,innerState:b})}fA();var DA={ahistoric:{visibilityState:"everythingIsVisible",theTrigger:{position:{closestCorner:"bottomLeft",distanceFromHorizontalEdge:.02,distanceFromVerticalEdge:.02}},coreByProject:{},projects:{stateByProjectId:{}}},historic:{projects:{stateByProjectId:{}},autoKey:!0,coreByProject:{},panelInstanceDesceriptors:{}},ephemeral:{initialised:!1,coreByProject:{},projects:{stateByProjectId:{}},extensions:{byId:{},paneClasses:{}},showOutline:!1}},The=Gp("@storeBundle/replacePersistentState",a=>a),Mhe=Gp("@storeBundle/reduceParts",a=>a),Y6={historic:ES,replacePersistentState:The,reduceParts:Mhe},Che=Gp("@storeBundle/setInnerHistoricState",a=>a),fSe=(a=DA.historic,u)=>Che.is(u)?u.payload:a,sU=lSe(fSe),Ahe=(a,u)=>{if(The.is(u)){let{historic:c,ahistoric:m}=u.payload,_=(a==null?void 0:a.ephemeral)||DA.ephemeral;return{$persistent:{historic:c,ahistoric:m},ephemeral:_}}else if(a){let{historic:c,ahistoric:m}=a.$persistent,{ephemeral:_}=a;if(Mhe.is(u)){let b={historic:a.$persistent.historic.innerState,ahistoric:a.$persistent.ahistoric,ephemeral:a.ephemeral},E=u.payload(b);if(E===b)return a;c.innerState!==E.historic&&(c=sU(c,Che(E.historic))),m=E.ahistoric,_=E.ephemeral}else{let b=sU(c,u);if(b===c)return a;c=b}return{$persistent:c===a.$persistent.historic&&m===a.$persistent.ahistoric?a.$persistent:{historic:c,ahistoric:m},ephemeral:_}}else{let c=sU(void 0,{}),m=DA.ahistoric,_=DA.ephemeral;return{$persistent:{historic:c,ahistoric:m},ephemeral:_}}},Phe=Gp("@history/pushTempAction",a=>a),Rhe=Gp("@history/discardTempAction",a=>a),Ihe=Gp("@history/commitTempAction",a=>a),pSe=0,mSe=()=>{let a=pSe++;return{push:u=>Phe({id:a,originalAction:u}),discard:()=>Rhe(a),commit:()=>Ihe(a)}},gSe=(a,u)=>{if(a){let{tempActions:c,permanent:m}=a.$temps,_;if(Phe.is(u))c=[...c,u];else if(Ihe.is(u)){let E=c.find(T=>T.payload.id===u.payload);E?(_=E.payload.originalAction,c=c.filter(T=>T.payload.id!==u.payload)):dA.error("Comitting temp action group ".concat(u.payload," isn't possible as this group doesn't exist"))}else Rhe.is(u)?c=c.filter(E=>E.payload.id!==u.payload):_=u;_&&(m=Ahe(a.$temps.permanent,_));let b={historic:m.$persistent.historic.innerState,ahistoric:m.$persistent.ahistoric,ephemeral:m.ephemeral};for(let E of c)b=E.payload.originalAction.payload(b);return P({$temps:{tempActions:c,permanent:m},$persistent:m.$persistent},b)}else{let c=Ahe(void 0,u);return{$temps:{permanent:c,tempActions:[]},$persistent:c.$persistent,historic:c.$persistent.historic.innerState,ahistoric:c.$persistent.ahistoric,ephemeral:c.ephemeral}}};Rp(),Rp(),Gm();function khe(a,u){if(typeof a!="object"||a===null)return;if(u.length===0){for(let E of Object.keys(a))delete a[E];return}let c=u.slice(0,u.length-1),m=a,_=new WeakMap;for(let E of c){let T=m,R=T[E];if(typeof R!="object"||R===null)return;_.set(R,T),m=R}let b=u.slice().reverse();for(let E of b){if(delete m[E],Object.keys(m).length>0)return;m=_.get(m)}}function vSe(a,{scale:u,origin:c,translate:m}){let _=c+(a-c)*u;return m+_}function Xd(a){for(var u=arguments.length,c=Array(u>1?u-1:0),m=1;m<u;m++)c[m-1]=arguments[m];throw Error("[Immer] minified error nr: "+a+(c.length?" "+c.map(function(_){return"'"+_+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function K6(a){return!!a&&!!a[mc]}function E8(a){return!!a&&(function(u){if(!u||typeof u!="object")return!1;var c=Object.getPrototypeOf(u);if(c===null)return!0;var m=Object.hasOwnProperty.call(c,"constructor")&&c.constructor;return m===Object||typeof m=="function"&&Function.toString.call(m)===ESe}(a)||Array.isArray(a)||!!a[Ghe]||!!a.constructor[Ghe]||oU(a)||lU(a))}function TS(a,u,c){c===void 0&&(c=!1),Z6(a)===0?(c?Object.keys:xU)(a).forEach(function(m){c&&typeof m=="symbol"||u(m,a[m],a)}):a.forEach(function(m,_){return u(_,m,a)})}function Z6(a){var u=a[mc];return u?u.i>3?u.i-4:u.i:Array.isArray(a)?1:oU(a)?2:lU(a)?3:0}function aU(a,u){return Z6(a)===2?a.has(u):Object.prototype.hasOwnProperty.call(a,u)}function ySe(a,u){return Z6(a)===2?a.get(u):a[u]}function Nhe(a,u,c){var m=Z6(a);m===2?a.set(u,c):m===3?(a.delete(u),a.add(c)):a[u]=c}function _Se(a,u){return a===u?a!==0||1/a==1/u:a!=a&&u!=u}function oU(a){return SSe&&a instanceof Map}function lU(a){return wSe&&a instanceof Set}function T8(a){return a.o||a.t}function uU(a){if(Array.isArray(a))return Array.prototype.slice.call(a);var u=TSe(a);delete u[mc];for(var c=xU(u),m=0;m<c.length;m++){var _=c[m],b=u[_];b.writable===!1&&(b.writable=!0,b.configurable=!0),(b.get||b.set)&&(u[_]={configurable:!0,writable:!0,enumerable:b.enumerable,value:a[_]})}return Object.create(Object.getPrototypeOf(a),u)}function cU(a,u){return u===void 0&&(u=!1),hU(a)||K6(a)||!E8(a)||(Z6(a)>1&&(a.set=a.add=a.clear=a.delete=xSe),Object.freeze(a),u&&TS(a,function(c,m){return cU(m,!0)},!0)),a}function xSe(){Xd(2)}function hU(a){return a==null||typeof a!="object"||Object.isFrozen(a)}function Jm(a){var u=MSe[a];return u||Xd(18,a),u}function Dhe(){return MS}function dU(a,u){u&&(Jm("Patches"),a.u=[],a.s=[],a.v=u)}function OA(a){fU(a),a.p.forEach(bSe),a.p=null}function fU(a){a===MS&&(MS=a.l)}function Ohe(a){return MS={p:[],l:MS,h:a,m:!0,_:0}}function bSe(a){var u=a[mc];u.i===0||u.i===1?u.j():u.O=!0}function pU(a,u){u._=u.p.length;var c=u.p[0],m=a!==void 0&&a!==c;return u.h.g||Jm("ES5").S(u,a,m),m?(c[mc].P&&(OA(u),Xd(4)),E8(a)&&(a=FA(u,a),u.l||LA(u,a)),u.u&&Jm("Patches").M(c[mc],a,u.u,u.s)):a=FA(u,c,[]),OA(u),u.u&&u.v(u.u,u.s),a!==Vhe?a:void 0}function FA(a,u,c){if(hU(u))return u;var m=u[mc];if(!m)return TS(u,function(b,E){return Fhe(a,m,u,b,E,c)},!0),u;if(m.A!==a)return u;if(!m.P)return LA(a,m.t,!0),m.t;if(!m.I){m.I=!0,m.A._--;var _=m.i===4||m.i===5?m.o=uU(m.k):m.o;TS(m.i===3?new Set(_):_,function(b,E){return Fhe(a,m,_,b,E,c)}),LA(a,_,!1),c&&a.u&&Jm("Patches").R(m,c,a.u,a.s)}return m.o}function Fhe(a,u,c,m,_,b){if(K6(_)){var E=FA(a,_,b&&u&&u.i!==3&&!aU(u.D,m)?b.concat(m):void 0);if(Nhe(c,m,E),!K6(E))return;a.m=!1}if(E8(_)&&!hU(_)){if(!a.h.F&&a._<1)return;FA(a,_),u&&u.A.l||LA(a,_)}}function LA(a,u,c){c===void 0&&(c=!1),a.h.F&&a.m&&cU(u,c)}function mU(a,u){var c=a[mc];return(c?T8(c):a)[u]}function Lhe(a,u){if(u in a)for(var c=Object.getPrototypeOf(a);c;){var m=Object.getOwnPropertyDescriptor(c,u);if(m)return m;c=Object.getPrototypeOf(c)}}function gU(a){a.P||(a.P=!0,a.l&&gU(a.l))}function vU(a){a.o||(a.o=uU(a.t))}function yU(a,u,c){var m=oU(u)?Jm("MapSet").N(u,c):lU(u)?Jm("MapSet").T(u,c):a.g?function(_,b){var E=Array.isArray(_),T={i:E?1:0,A:b?b.A:Dhe(),P:!1,I:!1,D:{},l:b,t:_,k:null,o:null,j:null,C:!1},R=T,N=BA;E&&(R=[T],N=zA);var z=Proxy.revocable(R,N),G=z.revoke,V=z.proxy;return T.k=V,T.j=G,V}(u,c):Jm("ES5").J(u,c);return(c?c.A:Dhe()).p.push(m),m}function UA(a){return K6(a)||Xd(22,a),function u(c){if(!E8(c))return c;var m,_=c[mc],b=Z6(c);if(_){if(!_.P&&(_.i<4||!Jm("ES5").K(_)))return _.t;_.I=!0,m=Uhe(c,b),_.I=!1}else m=Uhe(c,b);return TS(m,function(E,T){_&&ySe(_.t,E)===T||Nhe(m,E,u(T))}),b===3?new Set(m):m}(a)}function Uhe(a,u){switch(u){case 2:return new Map(a);case 3:return Array.from(a)}return uU(a)}var Bhe,MS,_U=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",SSe=typeof Map<"u",wSe=typeof Set<"u",zhe=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",Vhe=_U?Symbol.for("immer-nothing"):((Bhe={})["immer-nothing"]=!0,Bhe),Ghe=_U?Symbol.for("immer-draftable"):"__$immer_draftable",mc=_U?Symbol.for("immer-state"):"__$immer_state",ESe=""+Object.prototype.constructor,xU=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:Object.getOwnPropertyNames,TSe=Object.getOwnPropertyDescriptors||function(a){var u={};return xU(a).forEach(function(c){u[c]=Object.getOwnPropertyDescriptor(a,c)}),u},MSe={},BA={get:function(a,u){if(u===mc)return a;var c=T8(a);if(!aU(c,u))return function(_,b,E){var T,R=Lhe(b,E);return R?"value"in R?R.value:(T=R.get)===null||T===void 0?void 0:T.call(_.k):void 0}(a,c,u);var m=c[u];return a.I||!E8(m)?m:m===mU(a.t,u)?(vU(a),a.o[u]=yU(a.A.h,m,a)):m},has:function(a,u){return u in T8(a)},ownKeys:function(a){return Reflect.ownKeys(T8(a))},set:function(a,u,c){var m=Lhe(T8(a),u);if(m!=null&&m.set)return m.set.call(a.k,c),!0;if(!a.P){var _=mU(T8(a),u),b=_==null?void 0:_[mc];if(b&&b.t===c)return a.o[u]=c,a.D[u]=!1,!0;if(_Se(c,_)&&(c!==void 0||aU(a.t,u)))return!0;vU(a),gU(a)}return a.o[u]===c&&typeof c!="number"&&(c!==void 0||u in a.o)||(a.o[u]=c,a.D[u]=!0,!0)},deleteProperty:function(a,u){return mU(a.t,u)!==void 0||u in a.t?(a.D[u]=!1,vU(a),gU(a)):delete a.D[u],a.o&&delete a.o[u],!0},getOwnPropertyDescriptor:function(a,u){var c=T8(a),m=Reflect.getOwnPropertyDescriptor(c,u);return m&&{writable:!0,configurable:a.i!==1||u!=="length",enumerable:m.enumerable,value:c[u]}},defineProperty:function(){Xd(11)},getPrototypeOf:function(a){return Object.getPrototypeOf(a.t)},setPrototypeOf:function(){Xd(12)}},zA={};TS(BA,function(a,u){zA[a]=function(){return arguments[0]=arguments[0][0],u.apply(this,arguments)}}),zA.deleteProperty=function(a,u){return BA.deleteProperty.call(this,a[0],u)},zA.set=function(a,u,c){return BA.set.call(this,a[0],u,c,a[0])};var CSe=function(){function a(c){var m=this;this.g=zhe,this.F=!0,this.produce=function(_,b,E){if(typeof _=="function"&&typeof b!="function"){var T=b;b=_;var R=m;return function(B){var j=this;B===void 0&&(B=T);for(var H=arguments.length,X=Array(H>1?H-1:0),K=1;K<H;K++)X[K-1]=arguments[K];return R.produce(B,function(te){var se;return(se=b).call.apply(se,[j,te].concat(X))})}}var N;if(typeof b!="function"&&Xd(6),E!==void 0&&typeof E!="function"&&Xd(7),E8(_)){var z=Ohe(m),G=yU(m,_,void 0),V=!0;try{N=b(G),V=!1}finally{V?OA(z):fU(z)}return typeof Promise<"u"&&N instanceof Promise?N.then(function(B){return dU(z,E),pU(B,z)},function(B){throw OA(z),B}):(dU(z,E),pU(N,z))}if(!_||typeof _!="object")return(N=b(_))===Vhe?void 0:(N===void 0&&(N=_),m.F&&cU(N,!0),N);Xd(21,_)},this.produceWithPatches=function(_,b){return typeof _=="function"?function(R){for(var N=arguments.length,z=Array(N>1?N-1:0),G=1;G<N;G++)z[G-1]=arguments[G];return m.produceWithPatches(R,function(V){return _.apply(void 0,[V].concat(z))})}:[m.produce(_,b,function(R,N){E=R,T=N}),E,T];var E,T},typeof(c==null?void 0:c.useProxies)=="boolean"&&this.setUseProxies(c.useProxies),typeof(c==null?void 0:c.autoFreeze)=="boolean"&&this.setAutoFreeze(c.autoFreeze)}var u=a.prototype;return u.createDraft=function(c){E8(c)||Xd(8),K6(c)&&(c=UA(c));var m=Ohe(this),_=yU(this,c,void 0);return _[mc].C=!0,fU(m),_},u.finishDraft=function(c,m){var _=c&&c[mc],b=_.A;return dU(b,m),pU(void 0,b)},u.setAutoFreeze=function(c){this.F=c},u.setUseProxies=function(c){c&&!zhe&&Xd(20),this.g=c},u.applyPatches=function(c,m){var _;for(_=m.length-1;_>=0;_--){var b=m[_];if(b.path.length===0&&b.op==="replace"){c=b.value;break}}var E=Jm("Patches").$;return K6(c)?E(c,m):this.produce(c,function(T){return E(T,m.slice(_+1))})},a}(),gc=new CSe;gc.produce,gc.produceWithPatches.bind(gc),gc.setAutoFreeze.bind(gc),gc.setUseProxies.bind(gc),gc.applyPatches.bind(gc);var bU=gc.createDraft.bind(gc),SU=gc.finishDraft.bind(gc);lN(),cN(),yN(),Vy(),xN(),cA(),Ua(),oi();var Yd={create(a){let u={byId:{},allIds:{}};if(a)for(let[c,m]of a)u.byId[c]=m,u.allIds[c]=!0;return u},shallowCopy(a){return{byId:P({},a==null?void 0:a.byId),allIds:P({},a==null?void 0:a.allIds)}},add(a,u,c){return{byId:$(P({},a==null?void 0:a.byId),{[u]:c}),allIds:$(P({},a==null?void 0:a.allIds),{[u]:!0})}},merge(a){let u=Yd.create();for(let c=0;c<a.length;c++)u.byId=P(P({},u.byId),a[c].byId),u.allIds=P(P({},u.allIds),a[c].allIds);return u},remove(a,u){let c=Yd.shallowCopy(a);return delete c.allIds[u],delete c.byId[u],c},filter(a,u){let c=Yd.shallowCopy(a);for(let[m,_]of Object.entries(c.byId))u(_)||(delete c.allIds[m],delete c.byId[m]);return c}},Hhe=a=>(wU=a,EU),wU,h0=()=>{if(wU===void 0)throw new Error("Calling stateEditors outside of a transaction is not allowed.");return wU},EU;(a=>{(u=>{(c=>{(m=>{function _(b){let E=h0().historic;E.panelPositions!=null||(E.panelPositions={}),E.panelPositions[b.panelId]=b.position}m.setPanelPosition=_})(c.panelPositions||(c.panelPositions={})),(m=>{function _(){var b;return(b=h0().historic).panels!=null||(b.panels={}),h0().historic.panels}m._ensure=_,(b=>{function E(){let T=a.studio.historic.panels._ensure();return T.outlinePanel!=null||(T.outlinePanel={}),T.outlinePanel}b._ensure=E,(T=>{function R(z){let G=[];for(let V of dp(z))dt(V)?G.push(P({type:"Project"},V.address)):Dt(V)?(G.push(P({type:"Sheet"},V.template.address)),a.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(V.address)):gn(V)?G.push(P({type:"Sheet"},V.address)):qt(V)?(G.push(P({type:"SheetObject"},V.template.address)),a.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(V.sheet.address)):rr(V)&&G.push(P({type:"SheetObject"},V.address));b._ensure().selection=G}T.set=R;function N(){b._ensure().selection=[]}T.unset=N})(b.selection||(b.selection={}))})(m.outline||(m.outline={})),(b=>{function E(){let T=a.studio.historic.panels._ensure();return T.sequenceEditor!=null||(T.sequenceEditor={}),T.sequenceEditor}b._ensure=E,(T=>{function R(){let z=b._ensure();return z.graphEditor!=null||(z.graphEditor={height:.5,isOpen:!1}),z.graphEditor}function N(z){R().isOpen=z.isOpen}T.setIsOpen=N})(b.graphEditor||(b.graphEditor={}))})(m.sequenceEditor||(m.sequenceEditor={}))})(c.panels||(c.panels={})),(m=>{(_=>{function b(E){let T=h0().historic;return T.projects.stateByProjectId[E.projectId]||(T.projects.stateByProjectId[E.projectId]={stateBySheetId:{}}),T.projects.stateByProjectId[E.projectId]}_._ensure=b,(E=>{function T(N){let z=a.studio.historic.projects.stateByProjectId._ensure(N);return z.stateBySheetId[N.sheetId]||(z.stateBySheetId[N.sheetId]={selectedInstanceId:void 0,sequenceEditor:{selectedPropsByObject:{}}}),z.stateBySheetId[N.sheetId]}E._ensure=T;function R(N){a.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(N).selectedInstanceId=N.sheetInstanceId}E.setSelectedInstanceId=R,(N=>{function z(X){let{selectedPropsByObject:K}=E._ensure(X).sequenceEditor;K[X.objectKey]||(K[X.objectKey]={});let te=K[X.objectKey],se=Pp(X.pathToProp),pe=new Set(Object.keys(pS));for(let[ye,Ne]of Object.entries(UA(K)))for(let[ze,Me]of Object.entries(Ne))pe.delete(Me);let fe=pe.size>0?pe.values().next().value:Object.keys(pS)[0];te[se]=fe}N.addPropToGraphEditor=z;function G(X){let{selectedPropsByObject:K}=E._ensure(X).sequenceEditor;if(!K[X.objectKey])return;let te=K[X.objectKey],se=Pp(X.pathToProp);te[se]&&khe(K,[X.objectKey,se])}N.removePropFromGraphEditor=G;function V(X){let K=a.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(X).sequenceEditor;return K.markerSet||(K.markerSet=Yd.create()),K.markerSet}function B(X){let K=V(X.sheetAddress),te=X.markers.filter(ye=>!!isFinite(ye.position)).map(ye=>$(P({},ye),{position:X.snappingFunction(ye.position)})),se=P5(te,"id"),pe=Yd.filter(K,ye=>ye&&!se[ye.id]),fe=P5(Object.values(pe.byId),"position");te.forEach(({position:ye})=>{let Ne=fe[ye];Ne&&(pe=Yd.remove(pe,Ne.id))}),Object.assign(K,Yd.merge([pe,Yd.create(te.map(ye=>[ye.id,ye]))]))}N.replaceMarkers=B;function j(X){let K=V(X.sheetAddress);Object.assign(K,Yd.remove(K,X.markerId))}N.removeMarker=j;function H(X){let K=V(X.sheetAddress).byId[X.markerId];K!==void 0&&(K.label=X.label)}N.updateMarker=H})(E.sequenceEditor||(E.sequenceEditor={}))})(_.stateBySheetId||(_.stateBySheetId={}))})(m.stateByProjectId||(m.stateByProjectId={}))})(c.projects||(c.projects={}))})(u.historic||(u.historic={})),(c=>{function m(_){h0().ephemeral.showOutline=_}c.setShowOutline=m,(_=>{(b=>{function E(T){let R=h0().ephemeral;return R.projects.stateByProjectId[T.projectId]||(R.projects.stateByProjectId[T.projectId]={stateBySheetId:{}}),R.projects.stateByProjectId[T.projectId]}b._ensure=E,(T=>{function R(N){let z=a.studio.ephemeral.projects.stateByProjectId._ensure(N);return z.stateBySheetId[N.sheetId]||(z.stateBySheetId[N.sheetId]={stateByObjectKey:{}}),z.stateBySheetId[N.sheetId]}T._ensure=R,(N=>{function z(G){var V;let B=a.studio.ephemeral.projects.stateByProjectId.stateBySheetId._ensure(G).stateByObjectKey;return B[V=G.objectKey]!=null||(B[V]={}),B[G.objectKey]}N._ensure=z,(G=>{function V(j){let H=a.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey._ensure(j);return H.valuesBeingScrubbed!=null||(H.valuesBeingScrubbed={}),H.valuesBeingScrubbed}G._ensure=V;function B(j){Sm(V(j),j.pathToProp,!0)}G.flag=B})(N.propsBeingScrubbed||(N.propsBeingScrubbed={}))})(T.stateByObjectKey||(T.stateByObjectKey={}))})(b.stateBySheetId||(b.stateBySheetId={}))})(_.stateByProjectId||(_.stateByProjectId={}))})(c.projects||(c.projects={}))})(u.ephemeral||(u.ephemeral={})),(c=>{function m(R){h0().ahistoric.pinOutline=R}c.setPinOutline=m;function _(R){h0().ahistoric.pinDetails=R}c.setPinDetails=_;function b(R){h0().ahistoric.pinNotifications=R}c.setPinNotifications=b;function E(R){h0().ahistoric.visibilityState=R}c.setVisibilityState=E;function T(R){let N=wC(R.map(V=>V.pathToProp)),z=R.map(({keyframe:V,pathToProp:B})=>({keyframe:V,pathToProp:B.slice(N.length)})),G=h0();G.ahistoric.clipboard?G.ahistoric.clipboard.keyframesWithRelativePaths=z:G.ahistoric.clipboard={keyframesWithRelativePaths:z}}c.setClipboardKeyframes=T,(R=>{(N=>{function z(G){let V=h0().ahistoric;return V.projects.stateByProjectId[G.projectId]||(V.projects.stateByProjectId[G.projectId]={stateBySheetId:{}}),V.projects.stateByProjectId[G.projectId]}N._ensure=z,(G=>{function V(j){let H=a.studio.ahistoric.projects.stateByProjectId._ensure(j);return H.collapsedItemsInOutline||(H.collapsedItemsInOutline={}),H.collapsedItemsInOutline}G._ensure=V;function B(j){let H=a.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline._ensure(j);j.isCollapsed?H[j.itemKey]=!0:delete H[j.itemKey]}G.set=B})(N.collapsedItemsInOutline||(N.collapsedItemsInOutline={})),(G=>{function V(B){let j=a.studio.ahistoric.projects.stateByProjectId._ensure(B);return j.stateBySheetId[B.sheetId]||(j.stateBySheetId[B.sheetId]={}),j.stateBySheetId[B.sheetId]}G._ensure=V,(B=>{function j(H){let X=a.studio.ahistoric.projects.stateByProjectId.stateBySheetId._ensure(H);return X.sequence||(X.sequence={}),X.sequence}B._ensure=j,(H=>{function X(te){a.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(te).focusRange={range:te.range,enabled:te.enabled}}H.set=X;function K(te){a.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(te).focusRange=void 0}H.unset=K})(B.focusRange||(B.focusRange={})),(H=>{function X(K){a.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(K).clippedSpaceRange=P({},K.range)}H.set=X})(B.clippedSpaceRange||(B.clippedSpaceRange={})),(H=>{function X(te){let se=a.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(te),pe=se.collapsableItems;return pe||(pe=se.collapsableItems=Yd.create()),pe}function K(te){let se=X(te);Object.assign(se,Yd.add(se,te.studioSheetItemKey,{isCollapsed:te.isCollapsed}))}H.set=K})(B.sequenceEditorCollapsableItems||(B.sequenceEditorCollapsableItems={}))})(G.sequence||(G.sequence={}))})(N.stateBySheetId||(N.stateBySheetId={}))})(R.stateByProjectId||(R.stateByProjectId={}))})(c.projects||(c.projects={}))})(u.ahistoric||(u.ahistoric={}))})(a.studio||(a.studio={})),(u=>{(c=>{(m=>{function _(b){let E=h0().historic.coreByProject[b.projectId].revisionHistory,T=50;E.unshift(b.revision),E.length>T&&(E.length=T)}m.add=_})(c.revisionHistory||(c.revisionHistory={})),(m=>{function _(T){let R=h0().historic.coreByProject[T.projectId].sheetsById;return R[T.sheetId]||(R[T.sheetId]={staticOverrides:{byObject:{}}}),R[T.sheetId]}m._ensure=_;function b(T){let R=h0().historic.coreByProject[T.projectId].sheetsById[T.sheetId];if(!R)return;delete R.staticOverrides.byObject[T.objectKey];let N=R.sequence;N&&delete N.tracksByObject[T.objectKey]}m.forgetObject=b;function E(T){h0().historic.coreByProject[T.projectId].sheetsById[T.sheetId]&&delete h0().historic.coreByProject[T.projectId].sheetsById[T.sheetId]}m.forgetSheet=E,(T=>{function R(Me){let je=a.coreByProject.historic.sheetsById._ensure(Me);return je.sequence!=null||(je.sequence={subUnitsPerUnit:30,length:10,type:"PositionalSequence",tracksByObject:{}}),je.sequence}T._ensure=R;function N(Me){R(Me).length=ii(parseFloat(Me.length.toFixed(2)),.01,1/0)}T.setLength=N;function z(Me){R(Me).subUnitsPerUnit=ii(Me.subUnitsPerUnit,1,L(2,12))}T.setSubUnitsPerUnit=z;function G(Me){var je;let yt=a.coreByProject.historic.sheetsById.sequence._ensure(Me).tracksByObject;return yt[je=Me.objectKey]!=null||(yt[je]={trackData:{},trackIdByPropPath:{}}),yt[Me.objectKey]}function V(Me,je){let yt=G(Me),xe=Pp(Me.pathToProp);if(typeof yt.trackIdByPropPath[xe]=="string")return;let We=k6e(),ae={type:"BasicKeyframedTrack",__debugName:"".concat(Me.objectKey,":").concat(xe),keyframes:[]};yt.trackData[We]=ae,yt.trackIdByPropPath[xe]=We}T.setPrimitivePropAsSequenced=V;function B(Me){let je=G(Me),yt=Pp(Me.pathToProp),xe=je.trackIdByPropPath[yt];typeof xe=="string"&&(delete je.trackIdByPropPath[yt],delete je.trackData[xe],a.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(Me))}T.setPrimitivePropAsStatic=B;function j(Me){let je=G(Me);for(let yt of Object.keys(je.trackIdByPropPath)){let xe=JSON.parse(yt);if(Me.pathToProp.every((We,ae)=>xe[ae]===We)){let We=je.trackIdByPropPath[yt];if(typeof We!="string")continue;delete je.trackIdByPropPath[yt],delete je.trackData[We]}}a.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfCompoundProp(Me)}T.setCompoundPropAsStatic=j;function H(Me){return G(Me).trackData[Me.trackId]}function X(Me){let je=H(Me);if(je)return je.keyframes.find(yt=>yt.id===Me.keyframeId)}function K(Me){let je=Me.snappingFunction(Me.position),yt=H(Me);if(!yt)return;let{keyframes:xe}=yt,We=xe.findIndex(dn=>dn.position===je);if(We!==-1){let dn=xe[We];dn.value=Me.value;return}let ae=Rx(xe,dn=>dn.position<je);if(ae===-1){xe.unshift({id:jQ(),position:je,connectedRight:!0,handles:Me.handles||[.5,1,.5,0],type:Me.type||"bezier",value:Me.value});return}let nt=xe[ae];xe.splice(ae+1,0,{id:jQ(),position:je,connectedRight:nt.connectedRight,handles:Me.handles||[.5,1,.5,0],type:Me.type||"bezier",value:Me.value})}T.setKeyframeAtPosition=K;function te(Me){let je=H(Me);if(!je)return;let{keyframes:yt}=je,xe=yt.findIndex(We=>We.position===Me.position);xe!==-1&&yt.splice(xe,1)}T.unsetKeyframeAtPosition=te;function se(Me){let je=H(Me);if(!je)return;let yt=UA(je.keyframes).filter(xe=>Me.keyframeIds.includes(xe.id)).map(xe=>{let We=xe.position,ae=Me.snappingFunction(vSe(We,Me));return $(P({},xe),{position:ae})});ze($(P({},Me),{keyframes:yt}))}T.transformKeyframes=se;function pe(Me){let je=H(Me);je&&(je.keyframes=je.keyframes.map((yt,xe)=>{let We=je.keyframes[xe-1],ae=Me.keyframeIds.includes(yt.id),nt=Me.keyframeIds.includes(We==null?void 0:We.id);return ae&&!nt?$(P({},yt),{handles:[yt.handles[0],yt.handles[1],Me.handles[0],Me.handles[1]]}):ae&&nt?$(P({},yt),{handles:[Me.handles[2],Me.handles[3],Me.handles[0],Me.handles[1]]}):nt?$(P({},yt),{handles:[Me.handles[2],Me.handles[3],yt.handles[2],yt.handles[3]]}):yt}))}T.setTweenBetweenKeyframes=pe;function fe(Me){var je,yt,xe,We,ae,nt,dn,Ve;let Ue=X(Me);Ue&&(Ue.handles=[(yt=(je=Me.end)==null?void 0:je[0])!=null?yt:Ue.handles[0],(We=(xe=Me.end)==null?void 0:xe[1])!=null?We:Ue.handles[1],(nt=(ae=Me.start)==null?void 0:ae[0])!=null?nt:Ue.handles[2],(Ve=(dn=Me.start)==null?void 0:dn[1])!=null?Ve:Ue.handles[3]])}T.setHandlesForKeyframe=fe;function ye(Me){let je=H(Me);je&&(je.keyframes=je.keyframes.filter(yt=>Me.keyframeIds.indexOf(yt.id)===-1))}T.deleteKeyframes=ye;function Ne(Me){let je=X(Me);je&&(je.type=Me.keyframeType)}T.setKeyframeType=Ne;function ze(Me){let je=H(Me);if(!je)return;let yt=UA(je.keyframes),xe=Me.keyframes.filter(Ve=>!(typeof Ve.value=="number"&&!isFinite(Ve.value)||!Ve.handles.every(Ue=>isFinite(Ue)))).map(Ve=>$(P({},Ve),{position:Me.snappingFunction(Ve.position)})),We=P5(xe,"id"),ae=yt.filter(Ve=>!We[Ve.id]),nt=P5(ae,"position");xe.forEach(({position:Ve})=>{let Ue=nt[Ve];Ue&&TT(ae,Ue)});let dn=CT([...ae,...xe],"position");je.keyframes=dn}T.replaceKeyframes=ze})(m.sequence||(m.sequence={})),(T=>{(R=>{function N(B){var j;let H=a.coreByProject.historic.sheetsById._ensure(B).staticOverrides.byObject;return H[j=B.objectKey]!=null||(H[j]={}),H[B.objectKey]}function z(B){let j=N(B);Sm(j,B.pathToProp,B.value)}R.setValueOfCompoundProp=z;function G(B){let j=N(B);Sm(j,B.pathToProp,B.value)}R.setValueOfPrimitiveProp=G;function V(B){let j=a.coreByProject.historic.sheetsById._ensure(B).staticOverrides.byObject[B.objectKey];j&&khe(j,B.pathToProp)}R.unsetValueOfPrimitiveProp=V})(T.byObject||(T.byObject={}))})(m.staticOverrides||(m.staticOverrides={}))})(c.sheetsById||(c.sheetsById={}))})(u.historic||(u.historic={}))})(a.coreByProject||(a.coreByProject={}))})(EU||(EU={}));function TU(){let a,u,c=new Promise((_,b)=>{a=E=>{_(E),m.status="resolved"},u=E=>{b(E),m.status="rejected"}}),m={resolve:a,reject:u,promise:c,status:"pending"};return m}var ASe=mn();function PSe(a){let u=a.getState(),c=new ASe.Atom(u);return a.subscribe(()=>{let m=a.getState();c.set(m),u=m}),c}G2();function RSe(a){var u,c=a.Symbol;return typeof c=="function"?c.observable?u=c.observable:(u=c("observable"),c.observable=u):u="@@observable",u}var CS;typeof self<"u"?CS=self:typeof window<"u"?CS=window:typeof xa<"u"?CS=xa:CS=s;var ISe=RSe(CS),jhe=ISe,Whe={INIT:"@@redux/INIT"};function $he(a,u,c){var m;if(typeof u=="function"&&typeof c>"u"&&(c=u,u=void 0),typeof c<"u"){if(typeof c!="function")throw new Error("Expected the enhancer to be a function.");return c($he)(a,u)}if(typeof a!="function")throw new Error("Expected the reducer to be a function.");var _=a,b=u,E=[],T=E,R=!1;function N(){T===E&&(T=E.slice())}function z(){return b}function G(H){if(typeof H!="function")throw new Error("Expected listener to be a function.");var X=!0;return N(),T.push(H),function(){if(X){X=!1,N();var K=T.indexOf(H);T.splice(K,1)}}}function V(H){if(!ec(H))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(typeof H.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(R)throw new Error("Reducers may not dispatch actions.");try{R=!0,b=_(b,H)}finally{R=!1}for(var X=E=T,K=0;K<X.length;K++){var te=X[K];te()}return H}function B(H){if(typeof H!="function")throw new Error("Expected the nextReducer to be a function.");_=H,V({type:Whe.INIT})}function j(){var H,X=G;return H={subscribe:function(K){if(typeof K!="object")throw new TypeError("Expected the observer to be an object.");function te(){K.next&&K.next(z())}te();var se=X(te);return{unsubscribe:se}}},H[jhe]=function(){return this},H}return V({type:Whe.INIT}),m={dispatch:V,subscribe:G,getState:z,replaceReducer:B},m[jhe]=j,m}function kSe(){for(var a=arguments.length,u=Array(a),c=0;c<a;c++)u[c]=arguments[c];return u.length===0?function(m){return m}:u.length===1?u[0]:u.reduce(function(m,_){return function(){return m(_.apply(void 0,arguments))}})}function NSe(a){let u=kSe();return $he(a.rootReducer,void 0,u)}fA(),iT();var MU=new WeakMap,DSe=(a,u,c)=>{let m=R=>{a.dispatch(Y6.replacePersistentState(R))},_=qhe(c),b=()=>a.getState().$persistent;T();let E=()=>{let R=b(),N=MU.get(a);R!==N&&(MU.set(a,R),localStorage.setItem(_,JSON.stringify(R)))};a.subscribe(ky(E,1e3)),window&&window.addEventListener("beforeunload",E);function T(){let R=localStorage.getItem(_);if(R){let N,z=!0;try{N=JSON.parse(R),z=!1}catch{dA.warn("Could not parse Theatre's persisted state. This must be a bug. Please report it.")}finally{z||m(N),u()}}else u()}},OSe=(a,u)=>{let c=qhe(u),m=a.getState().$persistent;localStorage.removeItem(c),MU.set(a,m)};function qhe(a){return a+".persistent"}eee(),oi(),Qf(),fT(),_t(),WM();var VA=mn();L9(),Ua(),Bue();function CU(a){if(typeof a=="boolean"||typeof a=="string"||typeof a=="number")return a;if(ec(a)){let u={},c=!1;for(let[m,_]of Object.entries(a))CU(_)!==void 0&&(u[m]=_,c=!0);if(c)return u}else return}function Xhe(a,u,c){for(let[m,_]of Object.entries(a.props))if(_.type==="compound")Xhe(_,[...u,m],c);else{if(_.type==="enum")throw new Error("Not yet implemented");c(_,[...u,m])}}function FSe(a,u,c){return{set:(m,_)=>{a();let b=CU(_);if(typeof b>"u")return;let{root:E,path:T}=(0,VA.getPointerParts)(m);if(qt(E)){let R=E.template.getMapOfValidSequenceTracks_forStudio().getValue(),N=zM(E.template.staticConfig,T);if(!N)throw new Error("Object ".concat(E.address.objectKey," does not have a prop at ").concat(JSON.stringify(T)));let z=(G,V,B)=>{if(G==null)return;if(CU(V.deserializeAndSanitize(G))===void 0)throw new Error("Invalid value ".concat(LL(G)," for object.props").concat(B.map(X=>"[".concat(JSON.stringify(X),"]")).join("")," is invalid"));let j=$(P({},E.address),{pathToProp:B}),H=Qu(R,B);if(typeof H=="string"){let X=E.sheet.getSequence();X.position=X.closestGridPosition(X.position),u.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(P({},j),{trackId:H,position:X.position,value:G,snappingFunction:X.closestGridPosition,type:"bezier"}))}else u.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp($(P({},j),{value:G}))};if(N.type==="compound"){let G=(0,VA.getPointerParts)(m).path,V=G.length;Xhe(N,G,(B,j)=>{let H=j.slice(V),X=B9(b,H);if(typeof X<"u")z(X,B,j);else throw new Error("Property object.props".concat(j.map(K=>"[".concat(JSON.stringify(K),"]")).join("")," is required but not provided"))})}else{if(N.type==="enum")throw new Error("Enums aren't implemented yet");z(b,N,T)}}else if(wn(E)){let[R]=T;if(R==="subUnitsPerUnit"){if(typeof b!="number"||!Oy(b)||b<1)throw new Error("Value ".concat(b," is not an integer, which is required for setting sequence prop ").concat(R));u.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit($(P({},E.address),{subUnitsPerUnit:b}))}else if(R==="length"){if(typeof b!="number"||b<=.001)throw new Error("Value ".concat(b," is not a positive number, which is required for setting sequence prop ").concat(R));u.coreByProject.historic.sheetsById.sequence.setLength($(P({},E.address),{length:b}))}else throw new Error("Setting sequence prop ".concat(R," is not supported"))}else throw new Error("Only setting props of SheetObject-s and sequences is supported in a transaction so far")},unset:m=>{a();let{root:_,path:b}=(0,VA.getPointerParts)(m);if(qt(_)){let E=_.template.getMapOfValidSequenceTracks_forStudio().getValue(),T=B9(_.template.getDefaultValues().getValue(),b),R=zM(_.template.staticConfig,b),N=(z,G)=>{let V=$(P({},_.address),{pathToProp:G}),B=Qu(E,G);typeof B=="string"?u.coreByProject.historic.sheetsById.sequence.unsetKeyframeAtPosition($(P({},V),{trackId:B,position:_.sheet.getSequence().positionSnappedToGrid})):R!==void 0&&u.coreByProject.historic.sheetsById.staticOverrides.byObject.unsetValueOfPrimitiveProp(V)};R.type==="compound"?lt(T,(z,G)=>{N(z,G)},(0,VA.getPointerParts)(m).path):N(T,b)}else throw new Error("Only setting props of SheetObject-s is supported in a transaction so far")},get drafts(){return a(),c},get stateEditors(){return u}}}var LSe=class{constructor(){le(this,"_reduxStore"),le(this,"_atom"),le(this,"atomP"),this._reduxStore=NSe({rootReducer:gSe}),this._atom=PSe(this._reduxStore),this.atomP=this._atom.pointer}initialize(a){let u=TU();return a.usePersistentStorage===!0?DSe(this._reduxStore,()=>{this.tempTransaction(({drafts:c})=>{c.ephemeral.initialised=!0}).commit(),u.resolve()},a.persistenceKey):(this.tempTransaction(({drafts:c})=>{c.ephemeral.initialised=!0}).commit(),u.resolve()),u.promise}getState(){return this._reduxStore.getState()}__experimental_clearPersistentStorage(a){return OSe(this._reduxStore,a),this.getState()}__dev_startHistoryFromScratch(a){this._reduxStore.dispatch(Y6.historic.startHistoryFromScratch(Y6.reduceParts(u=>$(P({},u),{historic:a}))))}tempTransaction(a){let u=mSe(),c,m=u.push(Y6.reduceParts(_=>{let b={historic:bU(_.historic),ahistoric:bU(_.ahistoric),ephemeral:bU(_.ephemeral)},E=!0,T=()=>{if(!E)throw new Error("You seem to have called the transaction api after studio.transaction() has finished running")},R=Hhe(b),N=FSe(T,R,b);try{return a(N),E=!1,{historic:SU(b.historic),ahistoric:SU(b.ahistoric),ephemeral:SU(b.ephemeral)}}catch(z){return c=z,_}finally{Hhe(void 0)}}));if(this._reduxStore.dispatch(m),c)throw this._reduxStore.dispatch(u.discard()),c;return{commit:()=>{this._reduxStore.dispatch(u.commit())},discard:()=>{this._reduxStore.dispatch(u.discard())}}}undo(){this._reduxStore.dispatch(Y6.historic.undo())}redo(){this._reduxStore.dispatch(Y6.historic.redo())}createContentOfSaveFile(a){if(!this._reduxStore.getState().$persistent.historic.innerState.coreByProject[a])throw new Error("Project ".concat(a," has not been initialized."));let u=JJ();this.tempTransaction(({stateEditors:m})=>{m.coreByProject.historic.revisionHistory.add({projectId:a,revision:u})}).commit();let c=this._reduxStore.getState().$persistent.historic.innerState.coreByProject[a];return P({},c)}},USe=mn(),AU=class{constructor(){le(this,"_values",{})}get(a,u){if(this.has(a))return this._values[a];{let c=u();return this._values[a]=c,c}}has(a){return this._values.hasOwnProperty(a)}};oi(),N9(),Ae(),Ua(),NL();var BSe=class{constructor(a){le(this,"ui",{hide(){Se().ui.hide()},get isHidden(){return Se().ui.isHidden},restore(){Se().ui.restore()},renderToolset(u,c){return Se().ui.renderToolset(u,c)}}),le(this,"_cache",new AU),le(this,"__experimental",{__experimental_disblePlayPauseKeyboardShortcut(){jxe()},__experimental_enablePlayPauseKeyboardShortcut(){Wxe()},__experimental_clearPersistentStorage(u){return Se().clearPersistentStorage(u)},__experimental_createContentOfSaveFileTyped(u){return Se().createContentOfSaveFile(u)}})}initialize(a){return Se().initialize(a)}extend(a,u){Se().extend(a,u)}transaction(a){return Se().transaction(({set:u,unset:c,stateEditors:m})=>a({set:u,unset:c,__experimental_forgetObject:_=>{if(!ni(_))throw new Error("object in transactionApi.__experimental_forgetObject(object) must be the return type of sheet.object(...)");m.coreByProject.historic.sheetsById.forgetObject(_.address)},__experimental_forgetSheet:_=>{if(!Xn(_))throw new Error("sheet in transactionApi.__experimental_forgetSheet(sheet) must be the return type of project.sheet()");m.coreByProject.historic.sheetsById.forgetSheet(_.address)}}))}_getSelectionPrism(){return this._cache.get("_getSelectionPrism()",()=>(0,USe.prism)(()=>k9().filter(a=>a.type==="Theatre_SheetObject"||a.type==="Theatre_Sheet").map(a=>a.publicApi)))}_getSelection(){return this._getSelectionPrism().getValue()}setSelection(a){let u=[...a].filter(c=>ni(c)||Xn(c)).map(c=>Se().corePrivateAPI(c));Se().transaction(({stateEditors:c})=>{c.studio.historic.panels.outline.selection.set(u)})}onSelectionChange(a){let u=Se();return this._getSelectionPrism().onChange(u.ticker,a,!0)}get selection(){return this._getSelection()}scrub(){return Se().scrub()}getStudioProject(){let a=Se().core;if(!a)throw new Error("You're calling studio.getStudioProject() before `@theatre/core` is loaded. To fix this:\n1. Check if `@theatre/core` is import/required in your bundle.\n2. Check the stack trace of this error and make sure the funciton that calls getStudioProject() is run after `@theatre/core` is loaded.");return Se().getStudioProject(a)}debouncedScrub(a=1e3){let u,c=ky(()=>{let m=u;m&&(u=void 0,m.commit())},a);return{capture:m=>{u||(u=this.scrub());let _=!0;try{u.capture(m),_=!1}finally{if(_){let b=u;u=void 0,b.discard()}else c()}}}}createPane(a){return Se().paneManager.createPane(a)}destroyPane(a){return Se().paneManager.destroyPane(a)}createContentOfSaveFile(a){return Se().createContentOfSaveFile(a)}};HQ();var M8=mn(),zSe=class{constructor(a){this._studio=a,le(this,"_cache",new AU),this._instantiatePanesAsTheyComeIn()}_instantiatePanesAsTheyComeIn(){let a=this._getAllPanes();a.onStale(()=>{a.getValue()})}_getAllPanes(){return this._cache.get("_getAllPanels()",()=>(0,M8.prism)(()=>{if(!(0,M8.val)(this._studio.coreP))return{};let a=(0,M8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),u=(0,M8.val)(this._studio.atomP.ephemeral.extensions.paneClasses),c={};for(let m of Object.values(a)){if(!m)continue;let _=u[m.paneClass];if(!_)continue;let{instanceId:b}=m,{extensionId:E,classDefinition:T}=_,R=M8.prism.memo("instance-".concat(m.instanceId),()=>({extensionId:E,instanceId:b,definition:T}),[T]);c[b]=R}return c}))}get allPanesD(){return this._getAllPanes()}createPane(a){if(!this._studio.core)throw new Error("Can't create a pane because @theatre/core is not yet loaded");let u=(0,M8.val)(this._studio.atomP.ephemeral.extensions.paneClasses[a].extensionId),c=(0,M8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),m;for(let _=1;_<1e3&&(m="".concat(a," #").concat(_),!!c[m]);_++);if(!u)throw new Error('Pane class "'.concat(a,'" is not registered.'));return this._studio.transaction(({drafts:_})=>{_.historic.panelInstanceDesceriptors[m]={instanceId:m,paneClass:a}}),this._getAllPanes().getValue()[m]}destroyPane(a){if(!this._studio.core)throw new Error("Can't do this yet because @theatre/core is not yet loaded");this._studio.transaction(({drafts:u})=>{delete u.historic.panelInstanceDesceriptors[a]})}},GA=mn();Ae();var Yhe=30*60*1e3,VSe=1e3*60*60;function GSe(){return Be(this,null,function*(){let a=Se().atomP.ahistoric.visibilityState;if((0,GA.val)(a)==="everythingIsVisible")return;let u=TU(),c=(0,GA.pointerToPrism)(a).onStale(()=>{(0,GA.val)(a)==="everythingIsVisible"&&(c(),u.resolve(void 0))});return u.promise})}function HSe(){return Be(this,null,function*(){if(!"0.7.2".match(/COMPAT/))for(yield HA(500),yield GSe();;){let a=(0,GA.val)(Se().atomP.ahistoric.updateChecker);if(a&&a.result!=="error"){let u=a.lastChecked,c=Date.now(),m=Math.abs(c-u);m<Yhe&&(yield HA(Yhe-m))}try{let u=yield fetch(new Request("https://updates.theatrejs.com/updates/0.7.2"));if(u.ok){let c=yield u.json();if(!jSe(c))throw new Error("Bad response");Se().transaction(({drafts:m})=>{m.ahistoric.updateChecker={lastChecked:Date.now(),result:P({},c)}}),yield HA(1e3)}else throw new Error("HTTP Error ".concat(u.statusText))}catch{yield HA(VSe)}}})}var HA=a=>new Promise(u=>setTimeout(u,a));function jSe(a){if(typeof a!="object")return!1;let u=a;return typeof u.hasUpdates!="boolean"?!1:u.hasUpdates===!0&&typeof u.newVersion=="string"&&typeof u.releasePage=="string"||u.hasUpdates===!1}var WSe=Q(zT());function eg(a){return new Promise((u,c)=>{a.oncomplete=a.onsuccess=()=>u(a.result),a.onabort=a.onerror=()=>c(a.error)})}function Khe(a,u){let c=indexedDB.open(a);c.onupgradeneeded=()=>c.result.createObjectStore(u);let m=eg(c);return(_,b)=>m.then(E=>b(E.transaction(u,_).objectStore(u)))}var PU;function Q6(){return PU||(PU=Khe("keyval-store","keyval")),PU}function $Se(a,u=Q6()){return u("readonly",c=>eg(c.get(a)))}function qSe(a,u,c=Q6()){return c("readwrite",m=>(m.put(u,a),eg(m.transaction)))}function XSe(a,u=Q6()){return u("readwrite",c=>(c.delete(a),eg(c.transaction)))}function RU(a,u){return a.openCursor().onsuccess=function(){this.result&&(u(this.result),this.result.continue())},eg(a.transaction)}function YSe(a=Q6()){return a("readonly",u=>{if(u.getAllKeys)return eg(u.getAllKeys());let c=[];return RU(u,m=>c.push(m.key)).then(()=>c)})}function KSe(a=Q6()){return a("readonly",u=>{if(u.getAll)return eg(u.getAll());let c=[];return RU(u,m=>c.push(m.value)).then(()=>c)})}function ZSe(a=Q6()){return a("readonly",u=>{if(u.getAll&&u.getAllKeys)return Promise.all([eg(u.getAllKeys()),eg(u.getAll())]).then(([m,_])=>m.map((b,E)=>[b,_[E]]));let c=[];return a("readonly",m=>RU(m,_=>c.push([_.key,_.value])).then(()=>c))})}var QSe=a=>{let u=Khe("theatrejs-".concat(a),"default-store");return{set:(c,m)=>qSe(c,m,u),get:c=>$Se(c,u),del:c=>XSe(c,u),keys:()=>YSe(u),entries:()=>ZSe(u),values:()=>KSe(u)}};Ete(),Yb();var Zhe="theatre-0.4",JSe=`You seem to have imported '@theatre/studio' but haven't initialized it. You can initialize the studio by:
\`\`\`
import studio from '@theatre/studio'
studio.initialize()
\`\`\`

* If you didn't mean to import '@theatre/studio', this means that your bundler is not tree-shaking it. This is most likely a bundler misconfiguration.

* If you meant to import '@theatre/studio' without showing its UI, you can do that by running:

\`\`\`
import studio from '@theatre/studio'
studio.initialize()
studio.ui.hide()
\`\`\`
`,ewe="You seem to have imported '@theatre/studio' but called `studio.initialize()` after some delay.\nTheatre.js projects remain in pending mode (won't play their sequences) until the studio is initialized, so you should place the `studio.initialize()` line right after the import line:\n\n```\nimport studio from '@theatre/studio'\n// ... and other imports\n\nstudio.initialize()\n```\n",twe=class{constructor(){le(this,"ui"),le(this,"publicApi"),le(this,"address"),le(this,"_projectsProxy",new IA.PointerProxy(new IA.Atom({}).pointer)),le(this,"projectsP",this._projectsProxy.pointer),le(this,"_store",new LSe),le(this,"_corePrivateApi"),le(this,"_cache",new AU),le(this,"paneManager"),le(this,"_coreAtom",new IA.Atom({})),le(this,"_initializedDeferred",TU()),le(this,"_initializeFnCalled",!1),le(this,"_didWarnAboutNotInitializing",!1),le(this,"_coreBits"),le(this,"_rafDriver"),this.address={studioId:Fb(10)},this.publicApi=new BSe(this),this.ui=new Xbe(this),this._attachToIncomingProjects(),this.paneManager=new zSe(this),typeof window<"u"&&setTimeout(()=>{this._initializeFnCalled||(console.error(JSe),this._didWarnAboutNotInitializing=!0)},100)}get ticker(){if(!this._rafDriver)throw new Error("`studio.ticker` was read before studio.initialize() was called.");return this._rafDriver.ticker}get atomP(){return this._store.atomP}initialize(a){return Be(this,null,function*(){if(!this._coreBits)throw new Error("You seem to have imported `@theatre/studio` without importing `@theatre/core`. Make sure to include an import of `@theatre/core` before calling `studio.initializer()`.");if(this._initializeFnCalled)return this._initializedDeferred.promise;this._initializeFnCalled=!0,this._didWarnAboutNotInitializing&&console.warn(ewe);let u={persistenceKey:Zhe,usePersistentStorage:!0};if(typeof(a==null?void 0:a.persistenceKey)=="string"&&(u.persistenceKey=a.persistenceKey),((a==null?void 0:a.usePersistentStorage)===!1||typeof window>"u")&&(u.usePersistentStorage=!1),a!=null&&a.__experimental_rafDriver){if(a.__experimental_rafDriver.type!=="Theatre_RafDriver_PublicAPI")throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` must be either be undefined, or the return type of core.createRafDriver()");let c=this._coreBits.privateAPI(a.__experimental_rafDriver);if(!c)throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` seems to come from a different version of `@theatre/core` than the version that is attached to `@theatre/studio`");this._rafDriver=c}else this._rafDriver=this._coreBits.getCoreRafDriver();try{yield this._store.initialize(u)}catch(c){this._initializedDeferred.reject(c);return}typeof window<"u"&&(yield this.ui.ready),this._initializedDeferred.resolve(),this.ui.render(),HSe().catch(c=>{console.error(c)})})}get initialized(){return this._initializedDeferred.promise}_attachToIncomingProjects(){let a=(0,IA.pointerToPrism)(this.projectsP),u=c=>{for(let m of Object.values(c))m.isAttachedToStudio||m.attachToStudio(this)};a.onStale(()=>{u(a.getValue())}),u(a.getValue())}setCoreBits(a){this._coreBits=a,this._corePrivateApi=a.privateAPI,this._coreAtom.setByPointer(u=>u.core,a.coreExports),this._setProjectsP(a.projectsP)}_setProjectsP(a){this._projectsProxy.setPointer(a)}scrub(){return new $be(this)}tempTransaction(a){return this._store.tempTransaction(a)}transaction(a){return this.tempTransaction(a).commit()}__dev_startHistoryFromScratch(a){return this._store.__dev_startHistoryFromScratch(a)}get corePrivateAPI(){return this._corePrivateApi}get core(){return this._coreAtom.get().core}get coreP(){return this._coreAtom.pointer.core}extend(a,u){if(!a||typeof a!="object")throw new Error("Extensions must be JS objects");if(typeof a.id!="string")throw new Error("extension.id must be a string");let c=(u==null?void 0:u.__experimental_reconfigure)===!0,m=a.id,_=this._store.getState().ephemeral.extensions.byId[m];if(_&&!c){if(a===_||(0,WSe.default)(a,_))return;throw new Error('Extension id "'.concat(a.id,'" is already defined. If you mean to re-configure the extension, do it like this: studio.extend(extension, {__experimental_reconfigure: true})})'))}this.transaction(({drafts:b})=>{var E,T;b.ephemeral.extensions.byId[a.id]=a;let R=b.ephemeral.extensions.paneClasses;c&&_&&((E=_.panes)==null||E.forEach(N=>{delete R[N.class]})),(T=a.panes)==null||T.forEach(N=>{if(typeof N.class!="string")throw new Error("pane.class must be a string");if(N.class.length<3)throw new Error("pane.class should be a string with 3 or more characters");let z=R[N.class];if(z)if(c&&z.extensionId===a.id)console.warn('Pane class "'.concat(N.class,'" already exists. This is a bug in Theatre.js. Please report it at https://github.com/theatre-js/theatre/issues/new'));else throw new Error('Pane class "'.concat(N.class,'" already exists and is supplied by extension ').concat(z));R[N.class]={extensionId:a.id,classDefinition:N}})})}getStudioProject(a){return this._cache.get("getStudioProject",()=>a.getProject("Studio"))}getExtensionSheet(a,u){return this._cache.get("extensionSheet-"+a,()=>this.getStudioProject(u).sheet("Extension "+a))}undo(){this._store.undo()}redo(){this._store.redo()}createContentOfSaveFile(a){return this._store.createContentOfSaveFile(a)}createAssetStorage(a,u){return Be(this,null,function*(){if(typeof window>"u")return{getAssetUrl:()=>"",createAsset:()=>Promise.resolve(null)};if(!("indexedDB"in window))return console.log("This browser doesn't support IndexedDB."),{getAssetUrl:N=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")},createAsset:N=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")}};let c=QSe("".concat(a.address.projectId,"-assets")),m=VO(a),_=yield c.keys();yield Promise.all(_.map(N=>Be(this,null,function*(){m.includes(N)||(yield c.del(N))}))),yield Promise.all(_.map(N=>Be(this,null,function*(){var z,G;let V="".concat(u,"/").concat(N);try{(yield fetch(V,{method:"HEAD"})).ok&&(yield c.del(N))}catch{Xb.error("Failed to access assets","Failed to access assets at ".concat((G=(z=a.config.assets)==null?void 0:z.baseUrl)!=null?G:"/",". This is likely due to a CORS issue."))}})));let b=new Map(yield c.entries()),E=new Map,T=N=>{if(E.has(N))return E.get(N);{let z=URL.createObjectURL(N);return E.set(N,z),z}},R=N=>{let z=b.get(N);if(!z)throw new Error("Asset with id ".concat(N," not found"));return T(z)};return{getAssetUrl:N=>b.has(N)?R(N):"".concat(u,"/").concat(N),createAsset:N=>Be(this,null,function*(){var z,G,V;let B=VO(a),j=!1;if(B.includes(N.name)){let H;try{H=(z=b.get(N.name))!=null?z:yield fetch("".concat(u,"/").concat(N.name)).then(X=>X.ok?X.blob():void 0)}catch{return Xb.error("Failed to access assets","Failed to access assets at ".concat((V=(G=a.config.assets)==null?void 0:G.baseUrl)!=null?V:"/",". This is likely due to a CORS issue.")),Promise.resolve(null)}if(H){if(j=yield(yield Promise.resolve().then(()=>Q(jbe()))).default.isEqual(N,H),j)return N.name;{let X=K=>{let te=prompt(K,N.name);return te===null?!1:te===""?X("Asset name cannot be empty. Please choose a different file name for this asset."):B.includes(te)?(console.log(B),X("An asset with this name already exists. Please choose a different file name for this asset.")):(N=new File([N],te,{type:N.type}),!0)};if(!X("An asset with this name already exists. Please choose a different file name for this asset."))return null}}}return b.set(N.name,N),yield c.set(N.name,N),N.name})}})}clearPersistentStorage(a=Zhe){this._store.__experimental_clearPersistentStorage(a)}},IU="__TheatreJS_StudioBundle",nwe="__TheatreJS_CoreBundle",rwe="__TheatreJS_Notifications",iwe=class{constructor(a){this._studio=a,le(this,"_coreBundle")}get type(){return"Theatre_StudioBundle"}registerCoreBundle(a){if(this._coreBundle)throw new Error("StudioBundle.coreBundle is already registered. This is a bug.");this._coreBundle=a;let u;a.getBitsForStudio(this._studio,c=>{u=c}),this._studio.setCoreBits(u)}},swe=Q(qe());Ft();var Qhe,awe=Te.div(Qhe||(Qhe=J([""]))),owe=a=>swe.default.createElement(awe,null),lwe=owe;Yb();var kU=new twe;ot(kU);var uwe=kU.publicApi,cwe=uwe;hwe();function hwe(){if(typeof window>"u")return;let a=window[IU];if(typeof a<"u")throw typeof a=="object"&&a&&typeof a.version=="string"?new Error(`It seems that the module '@theatre/studio' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@theatre/studio' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(IU," seems to be already set by a module other than @theatre/core."));let u=new iwe(kU);window[IU]=u;let c=window[nwe];c&&c!==null&&c.type==="Theatre_CoreBundle"&&u.registerCoreBundle(c)}typeof window<"u"&&(window[rwe]={notify:Xb});/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)

		queue-microtask/index.js:
		  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

		react/cjs/react.production.min.js:
		  (**
		   * @license React
		   * react.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		scheduler/cjs/scheduler.production.min.js:
		  (**
		   * @license React
		   * scheduler.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-dom/cjs/react-dom.production.min.js:
		  (**
		   * @license React
		   * react-dom.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v17.0.2
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v16.13.1
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		jszip/dist/jszip.min.js:
		  (*!
		  
		  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
		  <http://stuartk.com/jszip>
		  
		  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
		  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
		  
		  JSZip uses the library pako released under the MIT license :
		  https://github.com/nodeca/pako/blob/main/LICENSE
		  *)

		jiff/lib/lcs.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/array.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointerParse.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointer.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/clone.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPatch.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/jiff.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)
		*/}(Yw,Yw.exports)),Yw.exports}var vTe=gTe();const d9e=h9e(vTe);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const GE="177",M_={ROTATE:0,DOLLY:1,PAN:2},d_={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},yTe=0,Kpe=1,_Te=2,f9e=1,xTe=2,bg=3,c1=0,qa=1,X0=2,Gl=0,Sv=1,VG=2,GG=3,HG=4,p9e=5,q3=100,m9e=101,g9e=102,v9e=103,y9e=104,wj=200,Ej=201,Tj=202,Mj=203,bE=204,SE=205,Cj=206,Aj=207,Pj=208,Rj=209,_9e=210,Ij=211,kj=212,Nj=213,Dj=214,jG=0,WG=1,$G=2,U_=3,qG=4,XG=5,YG=6,KG=7,Ck=0,bTe=1,STe=2,o1=0,x9e=1,b9e=2,S9e=3,w9e=4,E9e=5,T9e=6,M9e=7,Zpe="attached",wTe="detached",f_=300,B_=301,z_=302,$I=303,ZG=304,Ak=306,Fg=1e3,g0=1001,QG=1002,y0=1003,ETe=1004,tR=1005,Ho=1006,_z=1007,yv=1008,jo=1009,C9e=1010,A9e=1011,wE=1012,Oj=1013,e4=1014,Lh=1015,t4=1016,Fj=1017,Lj=1018,V_=1020,P9e=35902,R9e=1021,I9e=1022,K0=1023,EE=1026,G_=1027,k9e=1028,Uj=1029,N9e=1030,Bj=1031,zj=1033,MI=33776,CI=33777,AI=33778,PI=33779,JG=35840,eH=35841,tH=35842,nH=35843,rH=36196,iH=37492,sH=37496,aH=37808,oH=37809,lH=37810,uH=37811,cH=37812,hH=37813,dH=37814,fH=37815,pH=37816,mH=37817,gH=37818,vH=37819,yH=37820,_H=37821,RI=36492,xH=36494,bH=36495,D9e=36283,SH=36284,wH=36285,EH=36286,TTe=2200,MTe=2201,CTe=2202,qI=2300,TH=2301,xz=2302,p_=2400,m_=2401,XI=2402,Vj=2500,ATe=2501,HE=3200,PTe=3201,sx=0,RTe=1,bf="",ei="srgb",kc="srgb-linear",YI="linear",xs="srgb",T7=7680,Qpe=519,ITe=512,kTe=513,NTe=514,O9e=515,DTe=516,OTe=517,FTe=518,LTe=519,Jpe=35044,MH="300 es",s1=2e3,KI=2001;let Oc=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,o=r.length;i<o;i++)r[i].call(this,e);e.target=null}}};const V0=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let e1e=1234567;const uE=Math.PI/180,H_=180/Math.PI;function o4(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(V0[s&255]+V0[s>>8&255]+V0[s>>16&255]+V0[s>>24&255]+"-"+V0[e&255]+V0[e>>8&255]+"-"+V0[e>>16&15|64]+V0[e>>24&255]+"-"+V0[t&63|128]+V0[t>>8&255]+"-"+V0[t>>16&255]+V0[t>>24&255]+V0[n&255]+V0[n>>8&255]+V0[n>>16&255]+V0[n>>24&255]).toLowerCase()}function ai(s,e,t){return Math.max(e,Math.min(t,s))}function Gj(s,e){return(s%e+e)%e}function UTe(s,e,t,n,r){return n+(s-e)*(r-n)/(t-e)}function BTe(s,e,t){return s!==e?(t-s)/(e-s):0}function cE(s,e,t){return(1-t)*s+t*e}function zTe(s,e,t,n){return cE(s,e,1-Math.exp(-t*n))}function VTe(s,e=1){return e-Math.abs(Gj(s,e*2)-e)}function GTe(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function HTe(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function jTe(s,e){return s+Math.floor(Math.random()*(e-s+1))}function WTe(s,e){return s+Math.random()*(e-s)}function $Te(s){return s*(.5-Math.random())}function qTe(s){s!==void 0&&(e1e=s);let e=e1e+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function XTe(s){return s*uE}function YTe(s){return s*H_}function KTe(s){return(s&s-1)===0&&s!==0}function ZTe(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function QTe(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function JTe(s,e,t,n,r){const i=Math.cos,o=Math.sin,l=i(t/2),h=o(t/2),p=i((e+n)/2),y=o((e+n)/2),x=i((e-n)/2),S=o((e-n)/2),A=i((n-e)/2),k=o((n-e)/2);switch(r){case"XYX":s.set(l*y,h*x,h*S,l*p);break;case"YZY":s.set(h*S,l*y,h*x,l*p);break;case"ZXZ":s.set(h*x,h*S,l*y,l*p);break;case"XZX":s.set(l*y,h*k,h*A,l*p);break;case"YXY":s.set(h*A,l*y,h*k,l*p);break;case"ZYZ":s.set(h*k,h*A,l*y,l*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function l_(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function Dl(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const $0={DEG2RAD:uE,RAD2DEG:H_,generateUUID:o4,clamp:ai,euclideanModulo:Gj,mapLinear:UTe,inverseLerp:BTe,lerp:cE,damp:zTe,pingpong:VTe,smoothstep:GTe,smootherstep:HTe,randInt:jTe,randFloat:WTe,randFloatSpread:$Te,seededRandom:qTe,degToRad:XTe,radToDeg:YTe,isPowerOfTwo:KTe,ceilPowerOfTwo:ZTe,floorPowerOfTwo:QTe,setQuaternionFromProperEuler:JTe,normalize:Dl,denormalize:l_};let zn=class F9e{constructor(e=0,t=0){F9e.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=ai(this.x,e.x,t.x),this.y=ai(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=ai(this.x,e,t),this.y=ai(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(ai(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(ai(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},us=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,o,l){let h=n[r+0],p=n[r+1],y=n[r+2],x=n[r+3];const S=i[o+0],A=i[o+1],k=i[o+2],L=i[o+3];if(l===0){e[t+0]=h,e[t+1]=p,e[t+2]=y,e[t+3]=x;return}if(l===1){e[t+0]=S,e[t+1]=A,e[t+2]=k,e[t+3]=L;return}if(x!==L||h!==S||p!==A||y!==k){let U=1-l;const P=h*S+p*A+y*k+x*L,$=P>=0?1:-1,Z=1-P*P;if(Z>Number.EPSILON){const ie=Math.sqrt(Z),ce=Math.atan2(ie,P*$);U=Math.sin(U*ce)/ie,l=Math.sin(l*ce)/ie}const I=l*$;if(h=h*U+S*I,p=p*U+A*I,y=y*U+k*I,x=x*U+L*I,U===1-l){const ie=1/Math.sqrt(h*h+p*p+y*y+x*x);h*=ie,p*=ie,y*=ie,x*=ie}}e[t]=h,e[t+1]=p,e[t+2]=y,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,i,o){const l=n[r],h=n[r+1],p=n[r+2],y=n[r+3],x=i[o],S=i[o+1],A=i[o+2],k=i[o+3];return e[t]=l*k+y*x+h*A-p*S,e[t+1]=h*k+y*S+p*x-l*A,e[t+2]=p*k+y*A+l*S-h*x,e[t+3]=y*k-l*x-h*S-p*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,o=e._order,l=Math.cos,h=Math.sin,p=l(n/2),y=l(r/2),x=l(i/2),S=h(n/2),A=h(r/2),k=h(i/2);switch(o){case"XYZ":this._x=S*y*x+p*A*k,this._y=p*A*x-S*y*k,this._z=p*y*k+S*A*x,this._w=p*y*x-S*A*k;break;case"YXZ":this._x=S*y*x+p*A*k,this._y=p*A*x-S*y*k,this._z=p*y*k-S*A*x,this._w=p*y*x+S*A*k;break;case"ZXY":this._x=S*y*x-p*A*k,this._y=p*A*x+S*y*k,this._z=p*y*k+S*A*x,this._w=p*y*x-S*A*k;break;case"ZYX":this._x=S*y*x-p*A*k,this._y=p*A*x+S*y*k,this._z=p*y*k-S*A*x,this._w=p*y*x+S*A*k;break;case"YZX":this._x=S*y*x+p*A*k,this._y=p*A*x+S*y*k,this._z=p*y*k-S*A*x,this._w=p*y*x-S*A*k;break;case"XZY":this._x=S*y*x-p*A*k,this._y=p*A*x-S*y*k,this._z=p*y*k+S*A*x,this._w=p*y*x+S*A*k;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],l=t[5],h=t[9],p=t[2],y=t[6],x=t[10],S=n+l+x;if(S>0){const A=.5/Math.sqrt(S+1);this._w=.25/A,this._x=(y-h)*A,this._y=(i-p)*A,this._z=(o-r)*A}else if(n>l&&n>x){const A=2*Math.sqrt(1+n-l-x);this._w=(y-h)/A,this._x=.25*A,this._y=(r+o)/A,this._z=(i+p)/A}else if(l>x){const A=2*Math.sqrt(1+l-n-x);this._w=(i-p)/A,this._x=(r+o)/A,this._y=.25*A,this._z=(h+y)/A}else{const A=2*Math.sqrt(1+x-n-l);this._w=(o-r)/A,this._x=(i+p)/A,this._y=(h+y)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ai(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,o=e._w,l=t._x,h=t._y,p=t._z,y=t._w;return this._x=n*y+o*l+r*p-i*h,this._y=r*y+o*h+i*l-n*p,this._z=i*y+o*p+n*h-r*l,this._w=o*y-n*l-r*h-i*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let l=o*e._w+n*e._x+r*e._y+i*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const h=1-l*l;if(h<=Number.EPSILON){const A=1-t;return this._w=A*o+t*this._w,this._x=A*n+t*this._x,this._y=A*r+t*this._y,this._z=A*i+t*this._z,this.normalize(),this}const p=Math.sqrt(h),y=Math.atan2(p,l),x=Math.sin((1-t)*y)/p,S=Math.sin(t*y)/p;return this._w=o*x+this._w*S,this._x=n*x+this._x*S,this._y=r*x+this._y*S,this._z=i*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},ke=class L9e{constructor(e=0,t=0,n=0){L9e.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(t1e.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(t1e.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,l=e.z,h=e.w,p=2*(o*r-l*n),y=2*(l*t-i*r),x=2*(i*n-o*t);return this.x=t+h*p+o*x-l*y,this.y=n+h*y+l*p-i*x,this.z=r+h*x+i*y-o*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=ai(this.x,e.x,t.x),this.y=ai(this.y,e.y,t.y),this.z=ai(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=ai(this.x,e,t),this.y=ai(this.y,e,t),this.z=ai(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(ai(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,o=t.x,l=t.y,h=t.z;return this.x=r*h-i*l,this.y=i*o-n*h,this.z=n*l-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return bz.copy(this).projectOnVector(e),this.sub(bz)}reflect(e){return this.sub(bz.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(ai(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const bz=new ke,t1e=new us;let ci=class U9e{constructor(e,t,n,r,i,o,l,h,p){U9e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,o,l,h,p)}set(e,t,n,r,i,o,l,h,p){const y=this.elements;return y[0]=e,y[1]=r,y[2]=l,y[3]=t,y[4]=i,y[5]=h,y[6]=n,y[7]=o,y[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],l=n[3],h=n[6],p=n[1],y=n[4],x=n[7],S=n[2],A=n[5],k=n[8],L=r[0],U=r[3],P=r[6],$=r[1],Z=r[4],I=r[7],ie=r[2],ce=r[5],ue=r[8];return i[0]=o*L+l*$+h*ie,i[3]=o*U+l*Z+h*ce,i[6]=o*P+l*I+h*ue,i[1]=p*L+y*$+x*ie,i[4]=p*U+y*Z+x*ce,i[7]=p*P+y*I+x*ue,i[2]=S*L+A*$+k*ie,i[5]=S*U+A*Z+k*ce,i[8]=S*P+A*I+k*ue,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],l=e[5],h=e[6],p=e[7],y=e[8];return t*o*y-t*l*p-n*i*y+n*l*h+r*i*p-r*o*h}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],l=e[5],h=e[6],p=e[7],y=e[8],x=y*o-l*p,S=l*h-y*i,A=p*i-o*h,k=t*x+n*S+r*A;if(k===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/k;return e[0]=x*L,e[1]=(r*p-y*n)*L,e[2]=(l*n-r*o)*L,e[3]=S*L,e[4]=(y*t-r*h)*L,e[5]=(r*i-l*t)*L,e[6]=A*L,e[7]=(n*h-p*t)*L,e[8]=(o*t-n*i)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,o,l){const h=Math.cos(i),p=Math.sin(i);return this.set(n*h,n*p,-n*(h*o+p*l)+o+e,-r*p,r*h,-r*(-p*o+h*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(Sz.makeScale(e,t)),this}rotate(e){return this.premultiply(Sz.makeRotation(-e)),this}translate(e,t){return this.premultiply(Sz.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const Sz=new ci;function B9e(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function TE(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function eMe(){const s=TE("canvas");return s.style.display="block",s}const n1e={};function C_(s){s in n1e||(n1e[s]=!0,console.warn(s))}function tMe(s,e,t){return new Promise(function(n,r){function i(){switch(s.clientWaitSync(e,s.SYNC_FLUSH_COMMANDS_BIT,0)){case s.WAIT_FAILED:r();break;case s.TIMEOUT_EXPIRED:setTimeout(i,t);break;default:n()}}setTimeout(i,t)})}function nMe(s){const e=s.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function rMe(s){const e=s.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const r1e=new ci().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),i1e=new ci().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function iMe(){const s={enabled:!0,workingColorSpace:kc,spaces:{},convert:function(r,i,o){return this.enabled===!1||i===o||!i||!o||(this.spaces[i].transfer===xs&&(r.r=Cg(r.r),r.g=Cg(r.g),r.b=Cg(r.b)),this.spaces[i].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[i].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===xs&&(r.r=A_(r.r),r.g=A_(r.g),r.b=A_(r.b))),r},workingToColorSpace:function(r,i){return this.convert(r,this.workingColorSpace,i)},colorSpaceToWorking:function(r,i){return this.convert(r,i,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===bf?YI:this.spaces[r].transfer},getLuminanceCoefficients:function(r,i=this.workingColorSpace){return r.fromArray(this.spaces[i].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,i,o){return r.copy(this.spaces[i].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,i){return C_("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(r,i)},toWorkingColorSpace:function(r,i){return C_("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(r,i)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[kc]:{primaries:e,whitePoint:n,transfer:YI,toXYZ:r1e,fromXYZ:i1e,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:ei},outputColorSpaceConfig:{drawingBufferColorSpace:ei}},[ei]:{primaries:e,whitePoint:n,transfer:xs,toXYZ:r1e,fromXYZ:i1e,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:ei}}}),s}const Yr=iMe();function Cg(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function A_(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let M7,sMe=class{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{M7===void 0&&(M7=TE("canvas")),M7.width=e.width,M7.height=e.height;const r=M7.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=M7}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=TE("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let o=0;o<i.length;o++)i[o]=Cg(i[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Cg(t[n]/255)*255):t[n]=Cg(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},aMe=0,Hj=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:aMe++}),this.uuid=o4(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let o=0,l=r.length;o<l;o++)r[o].isDataTexture?i.push(wz(r[o].image)):i.push(wz(r[o]))}else i=wz(r);n.url=i}return t||(e.images[this.uuid]=n),n}};function wz(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?sMe.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let oMe=0;const Ez=new ke;let Wo=class II extends Oc{constructor(e=II.DEFAULT_IMAGE,t=II.DEFAULT_MAPPING,n=g0,r=g0,i=Ho,o=yv,l=K0,h=jo,p=II.DEFAULT_ANISOTROPY,y=bf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:oMe++}),this.uuid=o4(),this.name="",this.source=new Hj(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=p,this.format=l,this.internalFormat=null,this.type=h,this.offset=new zn(0,0),this.repeat=new zn(1,1),this.center=new zn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ci,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Ez).x}get height(){return this.source.getSize(Ez).y}get depth(){return this.source.getSize(Ez).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==f_)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Fg:e.x=e.x-Math.floor(e.x);break;case g0:e.x=e.x<0?0:1;break;case QG:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Fg:e.y=e.y-Math.floor(e.y);break;case g0:e.y=e.y<0?0:1;break;case QG:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};Wo.DEFAULT_IMAGE=null;Wo.DEFAULT_MAPPING=f_;Wo.DEFAULT_ANISOTROPY=1;let Ti=class z9e{constructor(e=0,t=0,n=0,r=1){z9e.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const h=e.elements,p=h[0],y=h[4],x=h[8],S=h[1],A=h[5],k=h[9],L=h[2],U=h[6],P=h[10];if(Math.abs(y-S)<.01&&Math.abs(x-L)<.01&&Math.abs(k-U)<.01){if(Math.abs(y+S)<.1&&Math.abs(x+L)<.1&&Math.abs(k+U)<.1&&Math.abs(p+A+P-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Z=(p+1)/2,I=(A+1)/2,ie=(P+1)/2,ce=(y+S)/4,ue=(x+L)/4,Q=(k+U)/4;return Z>I&&Z>ie?Z<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(Z),r=ce/n,i=ue/n):I>ie?I<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(I),n=ce/r,i=Q/r):ie<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(ie),n=ue/i,r=Q/i),this.set(n,r,i,t),this}let $=Math.sqrt((U-k)*(U-k)+(x-L)*(x-L)+(S-y)*(S-y));return Math.abs($)<.001&&($=1),this.x=(U-k)/$,this.y=(x-L)/$,this.z=(S-y)/$,this.w=Math.acos((p+A+P-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=ai(this.x,e.x,t.x),this.y=ai(this.y,e.y,t.y),this.z=ai(this.z,e.z,t.z),this.w=ai(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=ai(this.x,e,t),this.y=ai(this.y,e,t),this.z=ai(this.z,e,t),this.w=ai(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(ai(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},V9e=class extends Oc{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ho,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Ti(0,0,e,t),this.scissorTest=!1,this.viewport=new Ti(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new Wo(r);this.textures=[];const o=n.count;for(let l=0;l<o;l++)this.textures[l]=i.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Ho,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new Hj(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},J0=class extends V9e{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},G9e=class extends Wo{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=y0,this.minFilter=y0,this.wrapR=g0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};class lMe extends Wo{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=y0,this.minFilter=y0,this.wrapR=g0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let Iv=class{constructor(e=new ke(1/0,1/0,1/0),t=new ke(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(of.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(of.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=of.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const i=n.getAttribute("position");if(t===!0&&i!==void 0&&e.isInstancedMesh!==!0)for(let o=0,l=i.count;o<l;o++)e.isMesh===!0?e.getVertexPosition(o,of):of.fromBufferAttribute(i,o),of.applyMatrix4(e.matrixWorld),this.expandByPoint(of);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),nR.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),nR.copy(n.boundingBox)),nR.applyMatrix4(e.matrixWorld),this.union(nR)}const r=e.children;for(let i=0,o=r.length;i<o;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,of),of.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(pw),rR.subVectors(this.max,pw),C7.subVectors(e.a,pw),A7.subVectors(e.b,pw),P7.subVectors(e.c,pw),E3.subVectors(A7,C7),T3.subVectors(P7,A7),V8.subVectors(C7,P7);let t=[0,-E3.z,E3.y,0,-T3.z,T3.y,0,-V8.z,V8.y,E3.z,0,-E3.x,T3.z,0,-T3.x,V8.z,0,-V8.x,-E3.y,E3.x,0,-T3.y,T3.x,0,-V8.y,V8.x,0];return!Tz(t,C7,A7,P7,rR)||(t=[1,0,0,0,1,0,0,0,1],!Tz(t,C7,A7,P7,rR))?!1:(iR.crossVectors(E3,T3),t=[iR.x,iR.y,iR.z],Tz(t,C7,A7,P7,rR))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,of).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(of).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ug[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ug[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ug[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ug[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ug[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ug[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ug[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ug[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ug),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}};const ug=[new ke,new ke,new ke,new ke,new ke,new ke,new ke,new ke],of=new ke,nR=new Iv,C7=new ke,A7=new ke,P7=new ke,E3=new ke,T3=new ke,V8=new ke,pw=new ke,rR=new ke,iR=new ke,G8=new ke;function Tz(s,e,t,n,r){for(let i=0,o=s.length-3;i<=o;i+=3){G8.fromArray(s,i);const l=r.x*Math.abs(G8.x)+r.y*Math.abs(G8.y)+r.z*Math.abs(G8.z),h=e.dot(G8),p=t.dot(G8),y=n.dot(G8);if(Math.max(-Math.max(h,p,y),Math.min(h,p,y))>l)return!1}return!0}const uMe=new Iv,mw=new ke,Mz=new ke;let l4=class{constructor(e=new ke,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):uMe.setFromPoints(e).getCenter(n);let r=0;for(let i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;mw.subVectors(e,this.center);const t=mw.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(mw,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Mz.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(mw.copy(e.center).add(Mz)),this.expandByPoint(mw.copy(e.center).sub(Mz))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}};const cg=new ke,Cz=new ke,sR=new ke,M3=new ke,Az=new ke,aR=new ke,Pz=new ke;let ax=class{constructor(e=new ke,t=new ke(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,cg)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=cg.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(cg.copy(this.origin).addScaledVector(this.direction,t),cg.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Cz.copy(e).add(t).multiplyScalar(.5),sR.copy(t).sub(e).normalize(),M3.copy(this.origin).sub(Cz);const i=e.distanceTo(t)*.5,o=-this.direction.dot(sR),l=M3.dot(this.direction),h=-M3.dot(sR),p=M3.lengthSq(),y=Math.abs(1-o*o);let x,S,A,k;if(y>0)if(x=o*h-l,S=o*l-h,k=i*y,x>=0)if(S>=-k)if(S<=k){const L=1/y;x*=L,S*=L,A=x*(x+o*S+2*l)+S*(o*x+S+2*h)+p}else S=i,x=Math.max(0,-(o*S+l)),A=-x*x+S*(S+2*h)+p;else S=-i,x=Math.max(0,-(o*S+l)),A=-x*x+S*(S+2*h)+p;else S<=-k?(x=Math.max(0,-(-o*i+l)),S=x>0?-i:Math.min(Math.max(-i,-h),i),A=-x*x+S*(S+2*h)+p):S<=k?(x=0,S=Math.min(Math.max(-i,-h),i),A=S*(S+2*h)+p):(x=Math.max(0,-(o*i+l)),S=x>0?i:Math.min(Math.max(-i,-h),i),A=-x*x+S*(S+2*h)+p);else S=o>0?-i:i,x=Math.max(0,-(o*S+l)),A=-x*x+S*(S+2*h)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(Cz).addScaledVector(sR,S),A}intersectSphere(e,t){cg.subVectors(e.center,this.origin);const n=cg.dot(this.direction),r=cg.dot(cg)-n*n,i=e.radius*e.radius;if(r>i)return null;const o=Math.sqrt(i-r),l=n-o,h=n+o;return h<0?null:l<0?this.at(h,t):this.at(l,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,o,l,h;const p=1/this.direction.x,y=1/this.direction.y,x=1/this.direction.z,S=this.origin;return p>=0?(n=(e.min.x-S.x)*p,r=(e.max.x-S.x)*p):(n=(e.max.x-S.x)*p,r=(e.min.x-S.x)*p),y>=0?(i=(e.min.y-S.y)*y,o=(e.max.y-S.y)*y):(i=(e.max.y-S.y)*y,o=(e.min.y-S.y)*y),n>o||i>r||((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),x>=0?(l=(e.min.z-S.z)*x,h=(e.max.z-S.z)*x):(l=(e.max.z-S.z)*x,h=(e.min.z-S.z)*x),n>h||l>r)||((l>n||n!==n)&&(n=l),(h<r||r!==r)&&(r=h),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,cg)!==null}intersectTriangle(e,t,n,r,i){Az.subVectors(t,e),aR.subVectors(n,e),Pz.crossVectors(Az,aR);let o=this.direction.dot(Pz),l;if(o>0){if(r)return null;l=1}else if(o<0)l=-1,o=-o;else return null;M3.subVectors(this.origin,e);const h=l*this.direction.dot(aR.crossVectors(M3,aR));if(h<0)return null;const p=l*this.direction.dot(Az.cross(M3));if(p<0||h+p>o)return null;const y=-l*M3.dot(Pz);return y<0?null:this.at(y/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},yr=class CH{constructor(e,t,n,r,i,o,l,h,p,y,x,S,A,k,L,U){CH.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,o,l,h,p,y,x,S,A,k,L,U)}set(e,t,n,r,i,o,l,h,p,y,x,S,A,k,L,U){const P=this.elements;return P[0]=e,P[4]=t,P[8]=n,P[12]=r,P[1]=i,P[5]=o,P[9]=l,P[13]=h,P[2]=p,P[6]=y,P[10]=x,P[14]=S,P[3]=A,P[7]=k,P[11]=L,P[15]=U,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new CH().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/R7.setFromMatrixColumn(e,0).length(),i=1/R7.setFromMatrixColumn(e,1).length(),o=1/R7.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),l=Math.sin(n),h=Math.cos(r),p=Math.sin(r),y=Math.cos(i),x=Math.sin(i);if(e.order==="XYZ"){const S=o*y,A=o*x,k=l*y,L=l*x;t[0]=h*y,t[4]=-h*x,t[8]=p,t[1]=A+k*p,t[5]=S-L*p,t[9]=-l*h,t[2]=L-S*p,t[6]=k+A*p,t[10]=o*h}else if(e.order==="YXZ"){const S=h*y,A=h*x,k=p*y,L=p*x;t[0]=S+L*l,t[4]=k*l-A,t[8]=o*p,t[1]=o*x,t[5]=o*y,t[9]=-l,t[2]=A*l-k,t[6]=L+S*l,t[10]=o*h}else if(e.order==="ZXY"){const S=h*y,A=h*x,k=p*y,L=p*x;t[0]=S-L*l,t[4]=-o*x,t[8]=k+A*l,t[1]=A+k*l,t[5]=o*y,t[9]=L-S*l,t[2]=-o*p,t[6]=l,t[10]=o*h}else if(e.order==="ZYX"){const S=o*y,A=o*x,k=l*y,L=l*x;t[0]=h*y,t[4]=k*p-A,t[8]=S*p+L,t[1]=h*x,t[5]=L*p+S,t[9]=A*p-k,t[2]=-p,t[6]=l*h,t[10]=o*h}else if(e.order==="YZX"){const S=o*h,A=o*p,k=l*h,L=l*p;t[0]=h*y,t[4]=L-S*x,t[8]=k*x+A,t[1]=x,t[5]=o*y,t[9]=-l*y,t[2]=-p*y,t[6]=A*x+k,t[10]=S-L*x}else if(e.order==="XZY"){const S=o*h,A=o*p,k=l*h,L=l*p;t[0]=h*y,t[4]=-x,t[8]=p*y,t[1]=S*x+L,t[5]=o*y,t[9]=A*x-k,t[2]=k*x-A,t[6]=l*y,t[10]=L*x+S}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cMe,e,hMe)}lookAt(e,t,n){const r=this.elements;return bc.subVectors(e,t),bc.lengthSq()===0&&(bc.z=1),bc.normalize(),C3.crossVectors(n,bc),C3.lengthSq()===0&&(Math.abs(n.z)===1?bc.x+=1e-4:bc.z+=1e-4,bc.normalize(),C3.crossVectors(n,bc)),C3.normalize(),oR.crossVectors(bc,C3),r[0]=C3.x,r[4]=oR.x,r[8]=bc.x,r[1]=C3.y,r[5]=oR.y,r[9]=bc.y,r[2]=C3.z,r[6]=oR.z,r[10]=bc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],l=n[4],h=n[8],p=n[12],y=n[1],x=n[5],S=n[9],A=n[13],k=n[2],L=n[6],U=n[10],P=n[14],$=n[3],Z=n[7],I=n[11],ie=n[15],ce=r[0],ue=r[4],Q=r[8],oe=r[12],le=r[1],J=r[5],Be=r[9],He=r[13],rt=r[2],ot=r[6],Se=r[10],gt=r[14],Ae=r[3],lt=r[7],pt=r[11],De=r[15];return i[0]=o*ce+l*le+h*rt+p*Ae,i[4]=o*ue+l*J+h*ot+p*lt,i[8]=o*Q+l*Be+h*Se+p*pt,i[12]=o*oe+l*He+h*gt+p*De,i[1]=y*ce+x*le+S*rt+A*Ae,i[5]=y*ue+x*J+S*ot+A*lt,i[9]=y*Q+x*Be+S*Se+A*pt,i[13]=y*oe+x*He+S*gt+A*De,i[2]=k*ce+L*le+U*rt+P*Ae,i[6]=k*ue+L*J+U*ot+P*lt,i[10]=k*Q+L*Be+U*Se+P*pt,i[14]=k*oe+L*He+U*gt+P*De,i[3]=$*ce+Z*le+I*rt+ie*Ae,i[7]=$*ue+Z*J+I*ot+ie*lt,i[11]=$*Q+Z*Be+I*Se+ie*pt,i[15]=$*oe+Z*He+I*gt+ie*De,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],l=e[5],h=e[9],p=e[13],y=e[2],x=e[6],S=e[10],A=e[14],k=e[3],L=e[7],U=e[11],P=e[15];return k*(+i*h*x-r*p*x-i*l*S+n*p*S+r*l*A-n*h*A)+L*(+t*h*A-t*p*S+i*o*S-r*o*A+r*p*y-i*h*y)+U*(+t*p*x-t*l*A-i*o*x+n*o*A+i*l*y-n*p*y)+P*(-r*l*y-t*h*x+t*l*S+r*o*x-n*o*S+n*h*y)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],l=e[5],h=e[6],p=e[7],y=e[8],x=e[9],S=e[10],A=e[11],k=e[12],L=e[13],U=e[14],P=e[15],$=x*U*p-L*S*p+L*h*A-l*U*A-x*h*P+l*S*P,Z=k*S*p-y*U*p-k*h*A+o*U*A+y*h*P-o*S*P,I=y*L*p-k*x*p+k*l*A-o*L*A-y*l*P+o*x*P,ie=k*x*h-y*L*h-k*l*S+o*L*S+y*l*U-o*x*U,ce=t*$+n*Z+r*I+i*ie;if(ce===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ue=1/ce;return e[0]=$*ue,e[1]=(L*S*i-x*U*i-L*r*A+n*U*A+x*r*P-n*S*P)*ue,e[2]=(l*U*i-L*h*i+L*r*p-n*U*p-l*r*P+n*h*P)*ue,e[3]=(x*h*i-l*S*i-x*r*p+n*S*p+l*r*A-n*h*A)*ue,e[4]=Z*ue,e[5]=(y*U*i-k*S*i+k*r*A-t*U*A-y*r*P+t*S*P)*ue,e[6]=(k*h*i-o*U*i-k*r*p+t*U*p+o*r*P-t*h*P)*ue,e[7]=(o*S*i-y*h*i+y*r*p-t*S*p-o*r*A+t*h*A)*ue,e[8]=I*ue,e[9]=(k*x*i-y*L*i-k*n*A+t*L*A+y*n*P-t*x*P)*ue,e[10]=(o*L*i-k*l*i+k*n*p-t*L*p-o*n*P+t*l*P)*ue,e[11]=(y*l*i-o*x*i-y*n*p+t*x*p+o*n*A-t*l*A)*ue,e[12]=ie*ue,e[13]=(y*L*r-k*x*r+k*n*S-t*L*S-y*n*U+t*x*U)*ue,e[14]=(k*l*r-o*L*r-k*n*h+t*L*h+o*n*U-t*l*U)*ue,e[15]=(o*x*r-y*l*r+y*n*h-t*x*h-o*n*S+t*l*S)*ue,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,l=e.y,h=e.z,p=i*o,y=i*l;return this.set(p*o+n,p*l-r*h,p*h+r*l,0,p*l+r*h,y*l+n,y*h-r*o,0,p*h-r*l,y*h+r*o,i*h*h+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,o=t._y,l=t._z,h=t._w,p=i+i,y=o+o,x=l+l,S=i*p,A=i*y,k=i*x,L=o*y,U=o*x,P=l*x,$=h*p,Z=h*y,I=h*x,ie=n.x,ce=n.y,ue=n.z;return r[0]=(1-(L+P))*ie,r[1]=(A+I)*ie,r[2]=(k-Z)*ie,r[3]=0,r[4]=(A-I)*ce,r[5]=(1-(S+P))*ce,r[6]=(U+$)*ce,r[7]=0,r[8]=(k+Z)*ue,r[9]=(U-$)*ue,r[10]=(1-(S+L))*ue,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=R7.set(r[0],r[1],r[2]).length();const o=R7.set(r[4],r[5],r[6]).length(),l=R7.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],lf.copy(this);const p=1/i,y=1/o,x=1/l;return lf.elements[0]*=p,lf.elements[1]*=p,lf.elements[2]*=p,lf.elements[4]*=y,lf.elements[5]*=y,lf.elements[6]*=y,lf.elements[8]*=x,lf.elements[9]*=x,lf.elements[10]*=x,t.setFromRotationMatrix(lf),n.x=i,n.y=o,n.z=l,this}makePerspective(e,t,n,r,i,o,l=s1){const h=this.elements,p=2*i/(t-e),y=2*i/(n-r),x=(t+e)/(t-e),S=(n+r)/(n-r);let A,k;if(l===s1)A=-(o+i)/(o-i),k=-2*o*i/(o-i);else if(l===KI)A=-o/(o-i),k=-o*i/(o-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return h[0]=p,h[4]=0,h[8]=x,h[12]=0,h[1]=0,h[5]=y,h[9]=S,h[13]=0,h[2]=0,h[6]=0,h[10]=A,h[14]=k,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,r,i,o,l=s1){const h=this.elements,p=1/(t-e),y=1/(n-r),x=1/(o-i),S=(t+e)*p,A=(n+r)*y;let k,L;if(l===s1)k=(o+i)*x,L=-2*x;else if(l===KI)k=i*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-S,h[1]=0,h[5]=2*y,h[9]=0,h[13]=-A,h[2]=0,h[6]=0,h[10]=L,h[14]=-k,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}};const R7=new ke,lf=new yr,cMe=new ke(0,0,0),hMe=new ke(1,1,1),C3=new ke,oR=new ke,bc=new ke,s1e=new yr,a1e=new us;let so=class H9e{constructor(e=0,t=0,n=0,r=H9e.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],o=r[4],l=r[8],h=r[1],p=r[5],y=r[9],x=r[2],S=r[6],A=r[10];switch(t){case"XYZ":this._y=Math.asin(ai(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-y,A),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(S,p),this._z=0);break;case"YXZ":this._x=Math.asin(-ai(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(l,A),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-x,i),this._z=0);break;case"ZXY":this._x=Math.asin(ai(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,A),this._z=Math.atan2(-o,p)):(this._y=0,this._z=Math.atan2(h,i));break;case"ZYX":this._y=Math.asin(-ai(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,A),this._z=Math.atan2(h,i)):(this._x=0,this._z=Math.atan2(-o,p));break;case"YZX":this._z=Math.asin(ai(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-y,p),this._y=Math.atan2(-x,i)):(this._x=0,this._y=Math.atan2(l,A));break;case"XZY":this._z=Math.asin(-ai(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(S,p),this._y=Math.atan2(l,i)):(this._x=Math.atan2(-y,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return s1e.makeRotationFromQuaternion(e),this.setFromRotationMatrix(s1e,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return a1e.setFromEuler(this),this.setFromQuaternion(a1e,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};so.DEFAULT_ORDER="XYZ";let jj=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},dMe=0;const o1e=new ke,I7=new us,hg=new yr,lR=new ke,gw=new ke,fMe=new ke,pMe=new us,l1e=new ke(1,0,0),u1e=new ke(0,1,0),c1e=new ke(0,0,1),h1e={type:"added"},mMe={type:"removed"},k7={type:"childadded",child:null},Rz={type:"childremoved",child:null};let Ri=class kI extends Oc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dMe++}),this.uuid=o4(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kI.DEFAULT_UP.clone();const e=new ke,t=new so,n=new us,r=new ke(1,1,1);function i(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(i),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new yr},normalMatrix:{value:new ci}}),this.matrix=new yr,this.matrixWorld=new yr,this.matrixAutoUpdate=kI.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=kI.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new jj,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return I7.setFromAxisAngle(e,t),this.quaternion.multiply(I7),this}rotateOnWorldAxis(e,t){return I7.setFromAxisAngle(e,t),this.quaternion.premultiply(I7),this}rotateX(e){return this.rotateOnAxis(l1e,e)}rotateY(e){return this.rotateOnAxis(u1e,e)}rotateZ(e){return this.rotateOnAxis(c1e,e)}translateOnAxis(e,t){return o1e.copy(e).applyQuaternion(this.quaternion),this.position.add(o1e.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(l1e,e)}translateY(e){return this.translateOnAxis(u1e,e)}translateZ(e){return this.translateOnAxis(c1e,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(hg.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?lR.copy(e):lR.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),gw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hg.lookAt(gw,lR,this.up):hg.lookAt(lR,gw,this.up),this.quaternion.setFromRotationMatrix(hg),r&&(hg.extractRotation(r.matrixWorld),I7.setFromRotationMatrix(hg),this.quaternion.premultiply(I7.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(h1e),k7.child=e,this.dispatchEvent(k7),k7.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(mMe),Rz.child=e,this.dispatchEvent(Rz),Rz.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),hg.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),hg.multiply(e.parent.matrixWorld)),e.applyMatrix4(hg),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(h1e),k7.child=e,this.dispatchEvent(k7),k7.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gw,e,fMe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gw,pMe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(l=>({...l,boundingBox:l.boundingBox?l.boundingBox.toJSON():void 0,boundingSphere:l.boundingSphere?l.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(l=>({...l})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function i(l,h){return l[h.uuid]===void 0&&(l[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const h=l.shapes;if(Array.isArray(h))for(let p=0,y=h.length;p<y;p++){const x=h[p];i(e.shapes,x)}else i(e.shapes,h)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let h=0,p=this.material.length;h<p;h++)l.push(i(e.materials,this.material[h]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++){const h=this.animations[l];r.animations.push(i(e.animations,h))}}if(t){const l=o(e.geometries),h=o(e.materials),p=o(e.textures),y=o(e.images),x=o(e.shapes),S=o(e.skeletons),A=o(e.animations),k=o(e.nodes);l.length>0&&(n.geometries=l),h.length>0&&(n.materials=h),p.length>0&&(n.textures=p),y.length>0&&(n.images=y),x.length>0&&(n.shapes=x),S.length>0&&(n.skeletons=S),A.length>0&&(n.animations=A),k.length>0&&(n.nodes=k)}return n.object=r,n;function o(l){const h=[];for(const p in l){const y=l[p];delete y.metadata,h.push(y)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}};Ri.DEFAULT_UP=new ke(0,1,0);Ri.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ri.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const uf=new ke,dg=new ke,Iz=new ke,fg=new ke,N7=new ke,D7=new ke,d1e=new ke,kz=new ke,Nz=new ke,Dz=new ke,Oz=new Ti,Fz=new Ti,Lz=new Ti;let vw=class u_{constructor(e=new ke,t=new ke,n=new ke){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),uf.subVectors(e,t),r.cross(uf);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){uf.subVectors(r,t),dg.subVectors(n,t),Iz.subVectors(e,t);const o=uf.dot(uf),l=uf.dot(dg),h=uf.dot(Iz),p=dg.dot(dg),y=dg.dot(Iz),x=o*p-l*l;if(x===0)return i.set(0,0,0),null;const S=1/x,A=(p*h-l*y)*S,k=(o*y-l*h)*S;return i.set(1-A-k,k,A)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,fg)===null?!1:fg.x>=0&&fg.y>=0&&fg.x+fg.y<=1}static getInterpolation(e,t,n,r,i,o,l,h){return this.getBarycoord(e,t,n,r,fg)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(i,fg.x),h.addScaledVector(o,fg.y),h.addScaledVector(l,fg.z),h)}static getInterpolatedAttribute(e,t,n,r,i,o){return Oz.setScalar(0),Fz.setScalar(0),Lz.setScalar(0),Oz.fromBufferAttribute(e,t),Fz.fromBufferAttribute(e,n),Lz.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(Oz,i.x),o.addScaledVector(Fz,i.y),o.addScaledVector(Lz,i.z),o}static isFrontFacing(e,t,n,r){return uf.subVectors(n,t),dg.subVectors(e,t),uf.cross(dg).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return uf.subVectors(this.c,this.b),dg.subVectors(this.a,this.b),uf.cross(dg).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return u_.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return u_.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return u_.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return u_.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return u_.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let o,l;N7.subVectors(r,n),D7.subVectors(i,n),kz.subVectors(e,n);const h=N7.dot(kz),p=D7.dot(kz);if(h<=0&&p<=0)return t.copy(n);Nz.subVectors(e,r);const y=N7.dot(Nz),x=D7.dot(Nz);if(y>=0&&x<=y)return t.copy(r);const S=h*x-y*p;if(S<=0&&h>=0&&y<=0)return o=h/(h-y),t.copy(n).addScaledVector(N7,o);Dz.subVectors(e,i);const A=N7.dot(Dz),k=D7.dot(Dz);if(k>=0&&A<=k)return t.copy(i);const L=A*p-h*k;if(L<=0&&p>=0&&k<=0)return l=p/(p-k),t.copy(n).addScaledVector(D7,l);const U=y*k-A*x;if(U<=0&&x-y>=0&&A-k>=0)return d1e.subVectors(i,r),l=(x-y)/(x-y+(A-k)),t.copy(r).addScaledVector(d1e,l);const P=1/(U+L+S);return o=L*P,l=S*P,t.copy(n).addScaledVector(N7,o).addScaledVector(D7,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const j9e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},A3={h:0,s:0,l:0},uR={h:0,s:0,l:0};function Uz(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}let Vn=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ei){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Yr.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Yr.workingColorSpace){return this.r=e,this.g=t,this.b=n,Yr.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Yr.workingColorSpace){if(e=Gj(e,1),t=ai(t,0,1),n=ai(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,o=2*n-i;this.r=Uz(o,i,e+1/3),this.g=Uz(o,i,e),this.b=Uz(o,i,e-1/3)}return Yr.colorSpaceToWorking(this,r),this}setStyle(e,t=ei){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const o=r[1],l=r[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],o=i.length;if(o===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ei){const n=j9e[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Cg(e.r),this.g=Cg(e.g),this.b=Cg(e.b),this}copyLinearToSRGB(e){return this.r=A_(e.r),this.g=A_(e.g),this.b=A_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ei){return Yr.workingToColorSpace(G0.copy(this),e),Math.round(ai(G0.r*255,0,255))*65536+Math.round(ai(G0.g*255,0,255))*256+Math.round(ai(G0.b*255,0,255))}getHexString(e=ei){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Yr.workingColorSpace){Yr.workingToColorSpace(G0.copy(this),t);const n=G0.r,r=G0.g,i=G0.b,o=Math.max(n,r,i),l=Math.min(n,r,i);let h,p;const y=(l+o)/2;if(l===o)h=0,p=0;else{const x=o-l;switch(p=y<=.5?x/(o+l):x/(2-o-l),o){case n:h=(r-i)/x+(r<i?6:0);break;case r:h=(i-n)/x+2;break;case i:h=(n-r)/x+4;break}h/=6}return e.h=h,e.s=p,e.l=y,e}getRGB(e,t=Yr.workingColorSpace){return Yr.workingToColorSpace(G0.copy(this),t),e.r=G0.r,e.g=G0.g,e.b=G0.b,e}getStyle(e=ei){Yr.workingToColorSpace(G0.copy(this),e);const t=G0.r,n=G0.g,r=G0.b;return e!==ei?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(A3),this.setHSL(A3.h+e,A3.s+t,A3.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(A3),e.getHSL(uR);const n=cE(A3.h,uR.h,t),r=cE(A3.s,uR.s,t),i=cE(A3.l,uR.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const G0=new Vn;Vn.NAMES=j9e;let gMe=0,Fc=class extends Oc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gMe++}),this.uuid=o4(),this.name="",this.type="Material",this.blending=Sv,this.side=c1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=bE,this.blendDst=SE,this.blendEquation=q3,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Vn(0,0,0),this.blendAlpha=0,this.depthFunc=U_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Qpe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=T7,this.stencilZFail=T7,this.stencilZPass=T7,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Sv&&(n.blending=this.blending),this.side!==c1&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==bE&&(n.blendSrc=this.blendSrc),this.blendDst!==SE&&(n.blendDst=this.blendDst),this.blendEquation!==q3&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==U_&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Qpe&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==T7&&(n.stencilFail=this.stencilFail),this.stencilZFail!==T7&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==T7&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(i){const o=[];for(const l in i){const h=i[l];delete h.metadata,o.push(h)}return o}if(t){const i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Nc=class extends Fc{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.combine=Ck,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const wg=vMe();function vMe(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),r=new Uint32Array(512);for(let h=0;h<256;++h){const p=h-127;p<-27?(n[h]=0,n[h|256]=32768,r[h]=24,r[h|256]=24):p<-14?(n[h]=1024>>-p-14,n[h|256]=1024>>-p-14|32768,r[h]=-p-1,r[h|256]=-p-1):p<=15?(n[h]=p+15<<10,n[h|256]=p+15<<10|32768,r[h]=13,r[h|256]=13):p<128?(n[h]=31744,n[h|256]=64512,r[h]=24,r[h|256]=24):(n[h]=31744,n[h|256]=64512,r[h]=13,r[h|256]=13)}const i=new Uint32Array(2048),o=new Uint32Array(64),l=new Uint32Array(64);for(let h=1;h<1024;++h){let p=h<<13,y=0;for(;(p&8388608)===0;)p<<=1,y-=8388608;p&=-8388609,y+=947912704,i[h]=p|y}for(let h=1024;h<2048;++h)i[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)o[h]=h<<23;o[31]=1199570944,o[32]=2147483648;for(let h=33;h<63;++h)o[h]=2147483648+(h-32<<23);o[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(l[h]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:i,exponentTable:o,offsetTable:l}}function yMe(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=ai(s,-65504,65504),wg.floatView[0]=s;const e=wg.uint32View[0],t=e>>23&511;return wg.baseTable[t]+((e&8388607)>>wg.shiftTable[t])}function _Me(s){const e=s>>10;return wg.uint32View[0]=wg.mantissaTable[wg.offsetTable[e]+(s&1023)]+wg.exponentTable[e],wg.floatView[0]}class f1e{static toHalfFloat(e){return yMe(e)}static fromHalfFloat(e){return _Me(e)}}const no=new ke,cR=new zn;let xMe=0,Ic=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:xMe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Jpe,this.updateRanges=[],this.gpuType=Lh,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)cR.fromBufferAttribute(this,t),cR.applyMatrix3(e),this.setXY(t,cR.x,cR.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.applyMatrix3(e),this.setXYZ(t,no.x,no.y,no.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.applyMatrix4(e),this.setXYZ(t,no.x,no.y,no.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.applyNormalMatrix(e),this.setXYZ(t,no.x,no.y,no.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.transformDirection(e),this.setXYZ(t,no.x,no.y,no.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=l_(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Dl(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=l_(t,this.array)),t}setX(e,t){return this.normalized&&(t=Dl(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=l_(t,this.array)),t}setY(e,t){return this.normalized&&(t=Dl(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=l_(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Dl(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=l_(t,this.array)),t}setW(e,t){return this.normalized&&(t=Dl(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Dl(t,this.array),n=Dl(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Dl(t,this.array),n=Dl(n,this.array),r=Dl(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=Dl(t,this.array),n=Dl(n,this.array),r=Dl(r,this.array),i=Dl(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Jpe&&(e.usage=this.usage),e}},Wj=class extends Ic{constructor(e,t,n){super(new Uint16Array(e),t,n)}},W9e=class extends Ic{constructor(e,t,n){super(new Uint32Array(e),t,n)}},Nr=class extends Ic{constructor(e,t,n){super(new Float32Array(e),t,n)}},bMe=0;const Rh=new yr,Bz=new Ri,O7=new ke,Sc=new Iv,yw=new Iv,Bo=new ke;let ts=class $9e extends Oc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:bMe++}),this.uuid=o4(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(B9e(e)?W9e:Wj)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new ci().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Rh.makeRotationFromQuaternion(e),this.applyMatrix4(Rh),this}rotateX(e){return Rh.makeRotationX(e),this.applyMatrix4(Rh),this}rotateY(e){return Rh.makeRotationY(e),this.applyMatrix4(Rh),this}rotateZ(e){return Rh.makeRotationZ(e),this.applyMatrix4(Rh),this}translate(e,t,n){return Rh.makeTranslation(e,t,n),this.applyMatrix4(Rh),this}scale(e,t,n){return Rh.makeScale(e,t,n),this.applyMatrix4(Rh),this}lookAt(e){return Bz.lookAt(e),Bz.updateMatrix(),this.applyMatrix4(Bz.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(O7).negate(),this.translate(O7.x,O7.y,O7.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,i=e.length;r<i;r++){const o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Nr(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const i=e[r];t.setXYZ(r,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Iv);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ke(-1/0,-1/0,-1/0),new ke(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const i=t[n];Sc.setFromBufferAttribute(i),this.morphTargetsRelative?(Bo.addVectors(this.boundingBox.min,Sc.min),this.boundingBox.expandByPoint(Bo),Bo.addVectors(this.boundingBox.max,Sc.max),this.boundingBox.expandByPoint(Bo)):(this.boundingBox.expandByPoint(Sc.min),this.boundingBox.expandByPoint(Sc.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new l4);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ke,1/0);return}if(e){const n=this.boundingSphere.center;if(Sc.setFromBufferAttribute(e),t)for(let i=0,o=t.length;i<o;i++){const l=t[i];yw.setFromBufferAttribute(l),this.morphTargetsRelative?(Bo.addVectors(Sc.min,yw.min),Sc.expandByPoint(Bo),Bo.addVectors(Sc.max,yw.max),Sc.expandByPoint(Bo)):(Sc.expandByPoint(yw.min),Sc.expandByPoint(yw.max))}Sc.getCenter(n);let r=0;for(let i=0,o=e.count;i<o;i++)Bo.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Bo));if(t)for(let i=0,o=t.length;i<o;i++){const l=t[i],h=this.morphTargetsRelative;for(let p=0,y=l.count;p<y;p++)Bo.fromBufferAttribute(l,p),h&&(O7.fromBufferAttribute(e,p),Bo.add(O7)),r=Math.max(r,n.distanceToSquared(Bo))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ic(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),l=[],h=[];for(let Q=0;Q<n.count;Q++)l[Q]=new ke,h[Q]=new ke;const p=new ke,y=new ke,x=new ke,S=new zn,A=new zn,k=new zn,L=new ke,U=new ke;function P(Q,oe,le){p.fromBufferAttribute(n,Q),y.fromBufferAttribute(n,oe),x.fromBufferAttribute(n,le),S.fromBufferAttribute(i,Q),A.fromBufferAttribute(i,oe),k.fromBufferAttribute(i,le),y.sub(p),x.sub(p),A.sub(S),k.sub(S);const J=1/(A.x*k.y-k.x*A.y);isFinite(J)&&(L.copy(y).multiplyScalar(k.y).addScaledVector(x,-A.y).multiplyScalar(J),U.copy(x).multiplyScalar(A.x).addScaledVector(y,-k.x).multiplyScalar(J),l[Q].add(L),l[oe].add(L),l[le].add(L),h[Q].add(U),h[oe].add(U),h[le].add(U))}let $=this.groups;$.length===0&&($=[{start:0,count:e.count}]);for(let Q=0,oe=$.length;Q<oe;++Q){const le=$[Q],J=le.start,Be=le.count;for(let He=J,rt=J+Be;He<rt;He+=3)P(e.getX(He+0),e.getX(He+1),e.getX(He+2))}const Z=new ke,I=new ke,ie=new ke,ce=new ke;function ue(Q){ie.fromBufferAttribute(r,Q),ce.copy(ie);const oe=l[Q];Z.copy(oe),Z.sub(ie.multiplyScalar(ie.dot(oe))).normalize(),I.crossVectors(ce,oe);const J=I.dot(h[Q])<0?-1:1;o.setXYZW(Q,Z.x,Z.y,Z.z,J)}for(let Q=0,oe=$.length;Q<oe;++Q){const le=$[Q],J=le.start,Be=le.count;for(let He=J,rt=J+Be;He<rt;He+=3)ue(e.getX(He+0)),ue(e.getX(He+1)),ue(e.getX(He+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ic(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let S=0,A=n.count;S<A;S++)n.setXYZ(S,0,0,0);const r=new ke,i=new ke,o=new ke,l=new ke,h=new ke,p=new ke,y=new ke,x=new ke;if(e)for(let S=0,A=e.count;S<A;S+=3){const k=e.getX(S+0),L=e.getX(S+1),U=e.getX(S+2);r.fromBufferAttribute(t,k),i.fromBufferAttribute(t,L),o.fromBufferAttribute(t,U),y.subVectors(o,i),x.subVectors(r,i),y.cross(x),l.fromBufferAttribute(n,k),h.fromBufferAttribute(n,L),p.fromBufferAttribute(n,U),l.add(y),h.add(y),p.add(y),n.setXYZ(k,l.x,l.y,l.z),n.setXYZ(L,h.x,h.y,h.z),n.setXYZ(U,p.x,p.y,p.z)}else for(let S=0,A=t.count;S<A;S+=3)r.fromBufferAttribute(t,S+0),i.fromBufferAttribute(t,S+1),o.fromBufferAttribute(t,S+2),y.subVectors(o,i),x.subVectors(r,i),y.cross(x),n.setXYZ(S+0,y.x,y.y,y.z),n.setXYZ(S+1,y.x,y.y,y.z),n.setXYZ(S+2,y.x,y.y,y.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Bo.fromBufferAttribute(e,t),Bo.normalize(),e.setXYZ(t,Bo.x,Bo.y,Bo.z)}toNonIndexed(){function e(l,h){const p=l.array,y=l.itemSize,x=l.normalized,S=new p.constructor(h.length*y);let A=0,k=0;for(let L=0,U=h.length;L<U;L++){l.isInterleavedBufferAttribute?A=h[L]*l.data.stride+l.offset:A=h[L]*y;for(let P=0;P<y;P++)S[k++]=p[A++]}return new Ic(S,y,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new $9e,n=this.index.array,r=this.attributes;for(const l in r){const h=r[l],p=e(h,n);t.setAttribute(l,p)}const i=this.morphAttributes;for(const l in i){const h=[],p=i[l];for(let y=0,x=p.length;y<x;y++){const S=p[y],A=e(S,n);h.push(A)}t.morphAttributes[l]=h}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,h=o.length;l<h;l++){const p=o[l];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const p in h)h[p]!==void 0&&(e[p]=h[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const h in n){const p=n[h];e.data.attributes[h]=p.toJSON(e.data)}const r={};let i=!1;for(const h in this.morphAttributes){const p=this.morphAttributes[h],y=[];for(let x=0,S=p.length;x<S;x++){const A=p[x];y.push(A.toJSON(e.data))}y.length>0&&(r[h]=y,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere=l.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const y=r[p];this.setAttribute(p,y.clone(t))}const i=e.morphAttributes;for(const p in i){const y=[],x=i[p];for(let S=0,A=x.length;S<A;S++)y.push(x[S].clone(t));this.morphAttributes[p]=y}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let p=0,y=o.length;p<y;p++){const x=o[p];this.addGroup(x.start,x.count,x.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const p1e=new yr,H8=new ax,hR=new l4,m1e=new ke,dR=new ke,fR=new ke,pR=new ke,zz=new ke,mR=new ke,g1e=new ke,gR=new ke;let Mn=class extends Ri{constructor(e=new ts,t=new Nc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=r.length;i<o;i++){const l=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=i}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const l=this.morphTargetInfluences;if(i&&l){mR.set(0,0,0);for(let h=0,p=i.length;h<p;h++){const y=l[h],x=i[h];y!==0&&(zz.fromBufferAttribute(x,e),o?mR.addScaledVector(zz,y):mR.addScaledVector(zz.sub(t),y))}t.add(mR)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),hR.copy(n.boundingSphere),hR.applyMatrix4(i),H8.copy(e.ray).recast(e.near),!(hR.containsPoint(H8.origin)===!1&&(H8.intersectSphere(hR,m1e)===null||H8.origin.distanceToSquared(m1e)>(e.far-e.near)**2))&&(p1e.copy(i).invert(),H8.copy(e.ray).applyMatrix4(p1e),!(n.boundingBox!==null&&H8.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,H8)))}_computeIntersections(e,t,n){let r;const i=this.geometry,o=this.material,l=i.index,h=i.attributes.position,p=i.attributes.uv,y=i.attributes.uv1,x=i.attributes.normal,S=i.groups,A=i.drawRange;if(l!==null)if(Array.isArray(o))for(let k=0,L=S.length;k<L;k++){const U=S[k],P=o[U.materialIndex],$=Math.max(U.start,A.start),Z=Math.min(l.count,Math.min(U.start+U.count,A.start+A.count));for(let I=$,ie=Z;I<ie;I+=3){const ce=l.getX(I),ue=l.getX(I+1),Q=l.getX(I+2);r=vR(this,P,e,n,p,y,x,ce,ue,Q),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const k=Math.max(0,A.start),L=Math.min(l.count,A.start+A.count);for(let U=k,P=L;U<P;U+=3){const $=l.getX(U),Z=l.getX(U+1),I=l.getX(U+2);r=vR(this,o,e,n,p,y,x,$,Z,I),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}else if(h!==void 0)if(Array.isArray(o))for(let k=0,L=S.length;k<L;k++){const U=S[k],P=o[U.materialIndex],$=Math.max(U.start,A.start),Z=Math.min(h.count,Math.min(U.start+U.count,A.start+A.count));for(let I=$,ie=Z;I<ie;I+=3){const ce=I,ue=I+1,Q=I+2;r=vR(this,P,e,n,p,y,x,ce,ue,Q),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const k=Math.max(0,A.start),L=Math.min(h.count,A.start+A.count);for(let U=k,P=L;U<P;U+=3){const $=U,Z=U+1,I=U+2;r=vR(this,o,e,n,p,y,x,$,Z,I),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}}};function SMe(s,e,t,n,r,i,o,l){let h;if(e.side===qa?h=n.intersectTriangle(o,i,r,!0,l):h=n.intersectTriangle(r,i,o,e.side===c1,l),h===null)return null;gR.copy(l),gR.applyMatrix4(s.matrixWorld);const p=t.ray.origin.distanceTo(gR);return p<t.near||p>t.far?null:{distance:p,point:gR.clone(),object:s}}function vR(s,e,t,n,r,i,o,l,h,p){s.getVertexPosition(l,dR),s.getVertexPosition(h,fR),s.getVertexPosition(p,pR);const y=SMe(s,e,t,n,dR,fR,pR,g1e);if(y){const x=new ke;vw.getBarycoord(g1e,dR,fR,pR,x),r&&(y.uv=vw.getInterpolatedAttribute(r,l,h,p,x,new zn)),i&&(y.uv1=vw.getInterpolatedAttribute(i,l,h,p,x,new zn)),o&&(y.normal=vw.getInterpolatedAttribute(o,l,h,p,x,new ke),y.normal.dot(n.direction)>0&&y.normal.multiplyScalar(-1));const S={a:l,b:h,c:p,normal:new ke,materialIndex:0};vw.getNormal(dR,fR,pR,S.normal),y.face=S,y.barycoord=x}return y}let xo=class q9e extends ts{constructor(e=1,t=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const l=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const h=[],p=[],y=[],x=[];let S=0,A=0;k("z","y","x",-1,-1,n,t,e,o,i,0),k("z","y","x",1,-1,n,t,-e,o,i,1),k("x","z","y",1,1,e,n,t,r,o,2),k("x","z","y",1,-1,e,n,-t,r,o,3),k("x","y","z",1,-1,e,t,n,r,i,4),k("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(h),this.setAttribute("position",new Nr(p,3)),this.setAttribute("normal",new Nr(y,3)),this.setAttribute("uv",new Nr(x,2));function k(L,U,P,$,Z,I,ie,ce,ue,Q,oe){const le=I/ue,J=ie/Q,Be=I/2,He=ie/2,rt=ce/2,ot=ue+1,Se=Q+1;let gt=0,Ae=0;const lt=new ke;for(let pt=0;pt<Se;pt++){const De=pt*J-He;for(let _t=0;_t<ot;_t++){const Jt=_t*le-Be;lt[L]=Jt*$,lt[U]=De*Z,lt[P]=rt,p.push(lt.x,lt.y,lt.z),lt[L]=0,lt[U]=0,lt[P]=ce>0?1:-1,y.push(lt.x,lt.y,lt.z),x.push(_t/ue),x.push(1-pt/Q),gt+=1}}for(let pt=0;pt<Q;pt++)for(let De=0;De<ue;De++){const _t=S+De+ot*pt,Jt=S+De+ot*(pt+1),dt=S+(De+1)+ot*(pt+1),Dt=S+(De+1)+ot*pt;h.push(_t,Jt,Dt),h.push(Jt,dt,Dt),Ae+=6}l.addGroup(A,Ae,oe),A+=Ae,S+=gt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new q9e(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function j_(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const r=s[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Ol(s){const e={};for(let t=0;t<s.length;t++){const n=j_(s[t]);for(const r in n)e[r]=n[r]}return e}function wMe(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function X9e(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Yr.workingColorSpace}const EMe={clone:j_,merge:Ol};var TMe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,MMe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;let $o=class extends Fc{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=TMe,this.fragmentShader=MMe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=j_(e.uniforms),this.uniformsGroups=wMe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},Pk=class extends Ri{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new yr,this.projectionMatrix=new yr,this.projectionMatrixInverse=new yr,this.coordinateSystem=s1}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const P3=new ke,v1e=new zn,y1e=new zn;let Go=class extends Pk{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=H_*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(uE*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return H_*2*Math.atan(Math.tan(uE*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){P3.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(P3.x,P3.y).multiplyScalar(-e/P3.z),P3.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(P3.x,P3.y).multiplyScalar(-e/P3.z)}getViewSize(e,t){return this.getViewBounds(e,v1e,y1e),t.subVectors(y1e,v1e)}setViewOffset(e,t,n,r,i,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(uE*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const h=o.fullWidth,p=o.fullHeight;i+=o.offsetX*r/h,t-=o.offsetY*n/p,r*=o.width/h,n*=o.height/p}const l=this.filmOffset;l!==0&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const F7=-90,L7=1;let CMe=class extends Ri{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Go(F7,L7,e,t);r.layers=this.layers,this.add(r);const i=new Go(F7,L7,e,t);i.layers=this.layers,this.add(i);const o=new Go(F7,L7,e,t);o.layers=this.layers,this.add(o);const l=new Go(F7,L7,e,t);l.layers=this.layers,this.add(l);const h=new Go(F7,L7,e,t);h.layers=this.layers,this.add(h);const p=new Go(F7,L7,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,o,l,h]=t;for(const p of t)this.remove(p);if(e===s1)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===KI)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,o,l,h,p,y]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),k=e.xr.enabled;e.xr.enabled=!1;const L=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,l),e.setRenderTarget(n,3,r),e.render(t,h),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=L,e.setRenderTarget(n,5,r),e.render(t,y),e.setRenderTarget(x,S,A),e.xr.enabled=k,n.texture.needsPMREMUpdate=!0}},$j=class extends Wo{constructor(e=[],t=B_,n,r,i,o,l,h,p,y){super(e,t,n,r,i,o,l,h,p,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},AMe=class extends J0{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new $j(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new xo(5,5,5),i=new $o({name:"CubemapFromEquirect",uniforms:j_(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:qa,blending:Gl});i.uniforms.tEquirect.value=t;const o=new Mn(r,i),l=t.minFilter;return t.minFilter===yv&&(t.minFilter=Ho),new CMe(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(i)}},_v=class extends Ri{constructor(){super(),this.isGroup=!0,this.type="Group"}};const PMe={type:"move"};let Vz=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new _v,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new _v,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ke,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ke),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new _v,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ke,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ke),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,o=null;const l=this._targetRay,h=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){o=!0;for(const L of e.hand.values()){const U=t.getJointPose(L,n),P=this._getHandJoint(p,L);U!==null&&(P.matrix.fromArray(U.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.matrixWorldNeedsUpdate=!0,P.jointRadius=U.radius),P.visible=U!==null}const y=p.joints["index-finger-tip"],x=p.joints["thumb-tip"],S=y.position.distanceTo(x.position),A=.02,k=.005;p.inputState.pinching&&S>A+k?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&S<=A-k&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(h.matrix.fromArray(i.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,i.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(i.linearVelocity)):h.hasLinearVelocity=!1,i.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(i.angularVelocity)):h.hasAngularVelocity=!1));l!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&i!==null&&(r=i),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(PMe)))}return l!==null&&(l.visible=r!==null),h!==null&&(h.visible=i!==null),p!==null&&(p.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new _v;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},ME=class extends Ri{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new so,this.environmentIntensity=1,this.environmentRotation=new so,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};const _1e=new ke,x1e=new Ti,b1e=new Ti,RMe=new ke,S1e=new yr,yR=new ke,Gz=new l4,w1e=new yr,Hz=new ax;class qj extends Mn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Zpe,this.bindMatrix=new yr,this.bindMatrixInverse=new yr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Iv),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,yR),this.boundingBox.expandByPoint(yR)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new l4),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,yR),this.boundingSphere.expandByPoint(yR)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Gz.copy(this.boundingSphere),Gz.applyMatrix4(r),e.ray.intersectsSphere(Gz)!==!1&&(w1e.copy(r).invert(),Hz.copy(e.ray).applyMatrix4(w1e),!(this.boundingBox!==null&&Hz.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Hz)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ti,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Zpe?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===wTe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;x1e.fromBufferAttribute(r.attributes.skinIndex,e),b1e.fromBufferAttribute(r.attributes.skinWeight,e),_1e.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const o=b1e.getComponent(i);if(o!==0){const l=x1e.getComponent(i);S1e.multiplyMatrices(n.bones[l].matrixWorld,n.boneInverses[l]),t.addScaledVector(RMe.copy(_1e).applyMatrix4(S1e),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class AH extends Ri{constructor(){super(),this.isBone=!0,this.type="Bone"}}let Kw=class extends Wo{constructor(e=null,t=1,n=1,r,i,o,l,h,p=y0,y=y0,x,S){super(null,o,l,h,p,y,r,i,x,S),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const E1e=new yr,IMe=new yr;class Xj{constructor(e=[],t=[]){this.uuid=o4(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new yr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new yr;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,o=e.length;i<o;i++){const l=e[i]?e[i].matrixWorld:IMe;E1e.multiplyMatrices(l,t[i]),E1e.toArray(n,i*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Xj(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Kw(t,e,e,K0,Lh);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const i=e.bones[n];let o=t[i];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),o=new AH),this.bones.push(o),this.boneInverses.push(new yr().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const o=t[r];e.bones.push(o.uuid);const l=n[r];e.boneInverses.push(l.toArray())}return e}}const jz=new ke,kMe=new ke,NMe=new ci;let H3=class{constructor(e=new ke(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=jz.subVectors(n,t).cross(kMe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(jz),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||NMe.getNormalMatrix(e),r=this.coplanarPoint(jz).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const j8=new l4,_R=new ke;let Yj=class{constructor(e=new H3,t=new H3,n=new H3,r=new H3,i=new H3,o=new H3){this.planes=[e,t,n,r,i,o]}set(e,t,n,r,i,o){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(n),l[3].copy(r),l[4].copy(i),l[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=s1){const n=this.planes,r=e.elements,i=r[0],o=r[1],l=r[2],h=r[3],p=r[4],y=r[5],x=r[6],S=r[7],A=r[8],k=r[9],L=r[10],U=r[11],P=r[12],$=r[13],Z=r[14],I=r[15];if(n[0].setComponents(h-i,S-p,U-A,I-P).normalize(),n[1].setComponents(h+i,S+p,U+A,I+P).normalize(),n[2].setComponents(h+o,S+y,U+k,I+$).normalize(),n[3].setComponents(h-o,S-y,U-k,I-$).normalize(),n[4].setComponents(h-l,S-x,U-L,I-Z).normalize(),t===s1)n[5].setComponents(h+l,S+x,U+L,I+Z).normalize();else if(t===KI)n[5].setComponents(l,x,L,Z).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),j8.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),j8.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(j8)}intersectsSprite(e){return j8.center.set(0,0,0),j8.radius=.7071067811865476,j8.applyMatrix4(e.matrixWorld),this.intersectsSphere(j8)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(_R.x=r.normal.x>0?e.max.x:e.min.x,_R.y=r.normal.y>0?e.max.y:e.min.y,_R.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(_R)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},Mf=class extends Fc{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Vn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const ZI=new ke,QI=new ke,T1e=new yr,_w=new ax,xR=new l4,Wz=new ke,M1e=new ke;class Pu extends Ri{constructor(e=new ts,t=new Mf){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,i=t.count;r<i;r++)ZI.fromBufferAttribute(t,r-1),QI.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=ZI.distanceTo(QI);e.setAttribute("lineDistance",new Nr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),xR.copy(n.boundingSphere),xR.applyMatrix4(r),xR.radius+=i,e.ray.intersectsSphere(xR)===!1)return;T1e.copy(r).invert(),_w.copy(e.ray).applyMatrix4(T1e);const l=i/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,p=this.isLineSegments?2:1,y=n.index,S=n.attributes.position;if(y!==null){const A=Math.max(0,o.start),k=Math.min(y.count,o.start+o.count);for(let L=A,U=k-1;L<U;L+=p){const P=y.getX(L),$=y.getX(L+1),Z=bR(this,e,_w,h,P,$,L);Z&&t.push(Z)}if(this.isLineLoop){const L=y.getX(k-1),U=y.getX(A),P=bR(this,e,_w,h,L,U,k-1);P&&t.push(P)}}else{const A=Math.max(0,o.start),k=Math.min(S.count,o.start+o.count);for(let L=A,U=k-1;L<U;L+=p){const P=bR(this,e,_w,h,L,L+1,L);P&&t.push(P)}if(this.isLineLoop){const L=bR(this,e,_w,h,k-1,A,k-1);L&&t.push(L)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=r.length;i<o;i++){const l=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=i}}}}}function bR(s,e,t,n,r,i,o){const l=s.geometry.attributes.position;if(ZI.fromBufferAttribute(l,r),QI.fromBufferAttribute(l,i),t.distanceSqToSegment(ZI,QI,Wz,M1e)>n)return;Wz.applyMatrix4(s.matrixWorld);const p=e.ray.origin.distanceTo(Wz);if(!(p<e.near||p>e.far))return{distance:p,point:M1e.clone().applyMatrix4(s.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:s}}const C1e=new ke,A1e=new ke;class jE extends Pu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,i=t.count;r<i;r+=2)C1e.fromBufferAttribute(t,r),A1e.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+C1e.distanceTo(A1e);e.setAttribute("lineDistance",new Nr(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}let Y9e=class extends Fc{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Vn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};const P1e=new yr,PH=new ax,SR=new l4,wR=new ke;class DMe extends Ri{constructor(e=new ts,t=new Y9e){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),SR.copy(n.boundingSphere),SR.applyMatrix4(r),SR.radius+=i,e.ray.intersectsSphere(SR)===!1)return;P1e.copy(r).invert(),PH.copy(e.ray).applyMatrix4(P1e);const l=i/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,p=n.index,x=n.attributes.position;if(p!==null){const S=Math.max(0,o.start),A=Math.min(p.count,o.start+o.count);for(let k=S,L=A;k<L;k++){const U=p.getX(k);wR.fromBufferAttribute(x,U),R1e(wR,U,h,r,e,t,this)}}else{const S=Math.max(0,o.start),A=Math.min(x.count,o.start+o.count);for(let k=S,L=A;k<L;k++)wR.fromBufferAttribute(x,k),R1e(wR,k,h,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=r.length;i<o;i++){const l=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=i}}}}}function R1e(s,e,t,n,r,i,o){const l=PH.distanceSqToPoint(s);if(l<t){const h=new ke;PH.closestPointToPoint(s,h),h.applyMatrix4(n);const p=r.ray.origin.distanceTo(h);if(p<r.near||p>r.far)return;i.push({distance:p,distanceToRay:Math.sqrt(l),point:h,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}let Kj=class extends Wo{constructor(e,t,n=e4,r,i,o,l=y0,h=y0,p,y=EE,x=1){if(y!==EE&&y!==G_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const S={width:e,height:t,depth:x};super(S,r,i,o,l,h,y,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Hj(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};class Rk extends ts{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],o=[],l=[],h=[],p=new ke,y=new zn;o.push(0,0,0),l.push(0,0,1),h.push(.5,.5);for(let x=0,S=3;x<=t;x++,S+=3){const A=n+x/t*r;p.x=e*Math.cos(A),p.y=e*Math.sin(A),o.push(p.x,p.y,p.z),l.push(0,0,1),y.x=(o[S]/e+1)/2,y.y=(o[S+1]/e+1)/2,h.push(y.x,y.y)}for(let x=1;x<=t;x++)i.push(x,x+1,0);this.setIndex(i),this.setAttribute("position",new Nr(o,3)),this.setAttribute("normal",new Nr(l,3)),this.setAttribute("uv",new Nr(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rk(e.radius,e.segments,e.thetaStart,e.thetaLength)}}let Mu=class K9e extends ts{constructor(e=1,t=1,n=1,r=32,i=1,o=!1,l=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:l,thetaLength:h};const p=this;r=Math.floor(r),i=Math.floor(i);const y=[],x=[],S=[],A=[];let k=0;const L=[],U=n/2;let P=0;$(),o===!1&&(e>0&&Z(!0),t>0&&Z(!1)),this.setIndex(y),this.setAttribute("position",new Nr(x,3)),this.setAttribute("normal",new Nr(S,3)),this.setAttribute("uv",new Nr(A,2));function $(){const I=new ke,ie=new ke;let ce=0;const ue=(t-e)/n;for(let Q=0;Q<=i;Q++){const oe=[],le=Q/i,J=le*(t-e)+e;for(let Be=0;Be<=r;Be++){const He=Be/r,rt=He*h+l,ot=Math.sin(rt),Se=Math.cos(rt);ie.x=J*ot,ie.y=-le*n+U,ie.z=J*Se,x.push(ie.x,ie.y,ie.z),I.set(ot,ue,Se).normalize(),S.push(I.x,I.y,I.z),A.push(He,1-le),oe.push(k++)}L.push(oe)}for(let Q=0;Q<r;Q++)for(let oe=0;oe<i;oe++){const le=L[oe][Q],J=L[oe+1][Q],Be=L[oe+1][Q+1],He=L[oe][Q+1];(e>0||oe!==0)&&(y.push(le,J,He),ce+=3),(t>0||oe!==i-1)&&(y.push(J,Be,He),ce+=3)}p.addGroup(P,ce,0),P+=ce}function Z(I){const ie=k,ce=new zn,ue=new ke;let Q=0;const oe=I===!0?e:t,le=I===!0?1:-1;for(let Be=1;Be<=r;Be++)x.push(0,U*le,0),S.push(0,le,0),A.push(.5,.5),k++;const J=k;for(let Be=0;Be<=r;Be++){const rt=Be/r*h+l,ot=Math.cos(rt),Se=Math.sin(rt);ue.x=oe*Se,ue.y=U*le,ue.z=oe*ot,x.push(ue.x,ue.y,ue.z),S.push(0,le,0),ce.x=ot*.5+.5,ce.y=Se*.5*le+.5,A.push(ce.x,ce.y),k++}for(let Be=0;Be<r;Be++){const He=ie+Be,rt=J+Be;I===!0?y.push(rt,rt+1,He):y.push(rt+1,rt,He),Q+=3}p.addGroup(P,Q,I===!0?1:2),P+=Q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new K9e(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};class Zj extends ts{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],o=[];l(r),p(n),y(),this.setAttribute("position",new Nr(i,3)),this.setAttribute("normal",new Nr(i.slice(),3)),this.setAttribute("uv",new Nr(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function l($){const Z=new ke,I=new ke,ie=new ke;for(let ce=0;ce<t.length;ce+=3)A(t[ce+0],Z),A(t[ce+1],I),A(t[ce+2],ie),h(Z,I,ie,$)}function h($,Z,I,ie){const ce=ie+1,ue=[];for(let Q=0;Q<=ce;Q++){ue[Q]=[];const oe=$.clone().lerp(I,Q/ce),le=Z.clone().lerp(I,Q/ce),J=ce-Q;for(let Be=0;Be<=J;Be++)Be===0&&Q===ce?ue[Q][Be]=oe:ue[Q][Be]=oe.clone().lerp(le,Be/J)}for(let Q=0;Q<ce;Q++)for(let oe=0;oe<2*(ce-Q)-1;oe++){const le=Math.floor(oe/2);oe%2===0?(S(ue[Q][le+1]),S(ue[Q+1][le]),S(ue[Q][le])):(S(ue[Q][le+1]),S(ue[Q+1][le+1]),S(ue[Q+1][le]))}}function p($){const Z=new ke;for(let I=0;I<i.length;I+=3)Z.x=i[I+0],Z.y=i[I+1],Z.z=i[I+2],Z.normalize().multiplyScalar($),i[I+0]=Z.x,i[I+1]=Z.y,i[I+2]=Z.z}function y(){const $=new ke;for(let Z=0;Z<i.length;Z+=3){$.x=i[Z+0],$.y=i[Z+1],$.z=i[Z+2];const I=U($)/2/Math.PI+.5,ie=P($)/Math.PI+.5;o.push(I,1-ie)}k(),x()}function x(){for(let $=0;$<o.length;$+=6){const Z=o[$+0],I=o[$+2],ie=o[$+4],ce=Math.max(Z,I,ie),ue=Math.min(Z,I,ie);ce>.9&&ue<.1&&(Z<.2&&(o[$+0]+=1),I<.2&&(o[$+2]+=1),ie<.2&&(o[$+4]+=1))}}function S($){i.push($.x,$.y,$.z)}function A($,Z){const I=$*3;Z.x=e[I+0],Z.y=e[I+1],Z.z=e[I+2]}function k(){const $=new ke,Z=new ke,I=new ke,ie=new ke,ce=new zn,ue=new zn,Q=new zn;for(let oe=0,le=0;oe<i.length;oe+=9,le+=6){$.set(i[oe+0],i[oe+1],i[oe+2]),Z.set(i[oe+3],i[oe+4],i[oe+5]),I.set(i[oe+6],i[oe+7],i[oe+8]),ce.set(o[le+0],o[le+1]),ue.set(o[le+2],o[le+3]),Q.set(o[le+4],o[le+5]),ie.copy($).add(Z).add(I).divideScalar(3);const J=U(ie);L(ce,le+0,$,J),L(ue,le+2,Z,J),L(Q,le+4,I,J)}}function L($,Z,I,ie){ie<0&&$.x===1&&(o[Z]=$.x-1),I.x===0&&I.z===0&&(o[Z]=ie/2/Math.PI+.5)}function U($){return Math.atan2($.z,-$.x)}function P($){return Math.atan2(-$.y,Math.sqrt($.x*$.x+$.z*$.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zj(e.vertices,e.indices,e.radius,e.details)}}class Z9e{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const i=n.length;let o;t?o=t:o=e*n[i-1];let l=0,h=i-1,p;for(;l<=h;)if(r=Math.floor(l+(h-l)/2),p=n[r]-o,p<0)l=r+1;else if(p>0)h=r-1;else{h=r;break}if(r=h,n[r]===o)return r/(i-1);const y=n[r],S=n[r+1]-y,A=(o-y)/S;return(r+A)/(i-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);const o=this.getPoint(r),l=this.getPoint(i),h=t||(o.isVector2?new zn:new ke);return h.copy(l).sub(o).normalize(),h}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new ke,r=[],i=[],o=[],l=new ke,h=new yr;for(let A=0;A<=e;A++){const k=A/e;r[A]=this.getTangentAt(k,new ke)}i[0]=new ke,o[0]=new ke;let p=Number.MAX_VALUE;const y=Math.abs(r[0].x),x=Math.abs(r[0].y),S=Math.abs(r[0].z);y<=p&&(p=y,n.set(1,0,0)),x<=p&&(p=x,n.set(0,1,0)),S<=p&&n.set(0,0,1),l.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],l),o[0].crossVectors(r[0],i[0]);for(let A=1;A<=e;A++){if(i[A]=i[A-1].clone(),o[A]=o[A-1].clone(),l.crossVectors(r[A-1],r[A]),l.length()>Number.EPSILON){l.normalize();const k=Math.acos(ai(r[A-1].dot(r[A]),-1,1));i[A].applyMatrix4(h.makeRotationAxis(l,k))}o[A].crossVectors(r[A],i[A])}if(t===!0){let A=Math.acos(ai(i[0].dot(i[e]),-1,1));A/=e,r[0].dot(l.crossVectors(i[0],i[e]))>0&&(A=-A);for(let k=1;k<=e;k++)i[k].applyMatrix4(h.makeRotationAxis(r[k],A*k)),o[k].crossVectors(r[k],i[k])}return{tangents:r,normals:i,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function Qj(){let s=0,e=0,t=0,n=0;function r(i,o,l,h){s=i,e=l,t=-3*i+3*o-2*l-h,n=2*i-2*o+l+h}return{initCatmullRom:function(i,o,l,h,p){r(o,l,p*(l-i),p*(h-o))},initNonuniformCatmullRom:function(i,o,l,h,p,y,x){let S=(o-i)/p-(l-i)/(p+y)+(l-o)/y,A=(l-o)/y-(h-o)/(y+x)+(h-l)/x;S*=y,A*=y,r(o,l,S,A)},calc:function(i){const o=i*i,l=o*i;return s+e*i+t*o+n*l}}}const ER=new ke,$z=new Qj,qz=new Qj,Xz=new Qj;class I1e extends Z9e{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new ke){const n=t,r=this.points,i=r.length,o=(i-(this.closed?0:1))*e;let l=Math.floor(o),h=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:h===0&&l===i-1&&(l=i-2,h=1);let p,y;this.closed||l>0?p=r[(l-1)%i]:(ER.subVectors(r[0],r[1]).add(r[0]),p=ER);const x=r[l%i],S=r[(l+1)%i];if(this.closed||l+2<i?y=r[(l+2)%i]:(ER.subVectors(r[i-1],r[i-2]).add(r[i-1]),y=ER),this.curveType==="centripetal"||this.curveType==="chordal"){const A=this.curveType==="chordal"?.5:.25;let k=Math.pow(p.distanceToSquared(x),A),L=Math.pow(x.distanceToSquared(S),A),U=Math.pow(S.distanceToSquared(y),A);L<1e-4&&(L=1),k<1e-4&&(k=L),U<1e-4&&(U=L),$z.initNonuniformCatmullRom(p.x,x.x,S.x,y.x,k,L,U),qz.initNonuniformCatmullRom(p.y,x.y,S.y,y.y,k,L,U),Xz.initNonuniformCatmullRom(p.z,x.z,S.z,y.z,k,L,U)}else this.curveType==="catmullrom"&&($z.initCatmullRom(p.x,x.x,S.x,y.x,this.tension),qz.initCatmullRom(p.y,x.y,S.y,y.y,this.tension),Xz.initCatmullRom(p.z,x.z,S.z,y.z,this.tension));return n.set($z.calc(h),qz.calc(h),Xz.calc(h)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new ke().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function OMe(s,e,t=2){const n=e&&e.length,r=n?e[0]*t:s.length;let i=Q9e(s,0,r,t,!0);const o=[];if(!i||i.next===i.prev)return o;let l,h,p;if(n&&(i=zMe(s,e,i,t)),s.length>80*t){l=1/0,h=1/0;let y=-1/0,x=-1/0;for(let S=t;S<r;S+=t){const A=s[S],k=s[S+1];A<l&&(l=A),k<h&&(h=k),A>y&&(y=A),k>x&&(x=k)}p=Math.max(y-l,x-h),p=p!==0?32767/p:0}return CE(i,o,t,l,h,p,0),o}function Q9e(s,e,t,n,r){let i;if(r===ZMe(s,e,t,n)>0)for(let o=e;o<t;o+=n)i=k1e(o/n|0,s[o],s[o+1],i);else for(let o=t-n;o>=e;o-=n)i=k1e(o/n|0,s[o],s[o+1],i);return i&&W_(i,i.next)&&(PE(i),i=i.next),i}function Mv(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(W_(t,t.next)||Sa(t.prev,t,t.next)===0)){if(PE(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function CE(s,e,t,n,r,i,o){if(!s)return;!o&&i&&WMe(s,n,r,i);let l=s;for(;s.prev!==s.next;){const h=s.prev,p=s.next;if(i?LMe(s,n,r,i):FMe(s)){e.push(h.i,s.i,p.i),PE(s),s=p.next,l=p.next;continue}if(s=p,s===l){o?o===1?(s=UMe(Mv(s),e),CE(s,e,t,n,r,i,2)):o===2&&BMe(s,e,t,n,r,i):CE(Mv(s),e,t,n,r,i,1);break}}}function FMe(s){const e=s.prev,t=s,n=s.next;if(Sa(e,t,n)>=0)return!1;const r=e.x,i=t.x,o=n.x,l=e.y,h=t.y,p=n.y,y=Math.min(r,i,o),x=Math.min(l,h,p),S=Math.max(r,i,o),A=Math.max(l,h,p);let k=n.next;for(;k!==e;){if(k.x>=y&&k.x<=S&&k.y>=x&&k.y<=A&&Zw(r,l,i,h,o,p,k.x,k.y)&&Sa(k.prev,k,k.next)>=0)return!1;k=k.next}return!0}function LMe(s,e,t,n){const r=s.prev,i=s,o=s.next;if(Sa(r,i,o)>=0)return!1;const l=r.x,h=i.x,p=o.x,y=r.y,x=i.y,S=o.y,A=Math.min(l,h,p),k=Math.min(y,x,S),L=Math.max(l,h,p),U=Math.max(y,x,S),P=RH(A,k,e,t,n),$=RH(L,U,e,t,n);let Z=s.prevZ,I=s.nextZ;for(;Z&&Z.z>=P&&I&&I.z<=$;){if(Z.x>=A&&Z.x<=L&&Z.y>=k&&Z.y<=U&&Z!==r&&Z!==o&&Zw(l,y,h,x,p,S,Z.x,Z.y)&&Sa(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,I.x>=A&&I.x<=L&&I.y>=k&&I.y<=U&&I!==r&&I!==o&&Zw(l,y,h,x,p,S,I.x,I.y)&&Sa(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;Z&&Z.z>=P;){if(Z.x>=A&&Z.x<=L&&Z.y>=k&&Z.y<=U&&Z!==r&&Z!==o&&Zw(l,y,h,x,p,S,Z.x,Z.y)&&Sa(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;I&&I.z<=$;){if(I.x>=A&&I.x<=L&&I.y>=k&&I.y<=U&&I!==r&&I!==o&&Zw(l,y,h,x,p,S,I.x,I.y)&&Sa(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function UMe(s,e){let t=s;do{const n=t.prev,r=t.next.next;!W_(n,r)&&e3e(n,t,t.next,r)&&AE(n,r)&&AE(r,n)&&(e.push(n.i,t.i,r.i),PE(t),PE(t.next),t=s=r),t=t.next}while(t!==s);return Mv(t)}function BMe(s,e,t,n,r,i){let o=s;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&XMe(o,l)){let h=t3e(o,l);o=Mv(o,o.next),h=Mv(h,h.next),CE(o,e,t,n,r,i,0),CE(h,e,t,n,r,i,0);return}l=l.next}o=o.next}while(o!==s)}function zMe(s,e,t,n){const r=[];for(let i=0,o=e.length;i<o;i++){const l=e[i]*n,h=i<o-1?e[i+1]*n:s.length,p=Q9e(s,l,h,n,!1);p===p.next&&(p.steiner=!0),r.push(qMe(p))}r.sort(VMe);for(let i=0;i<r.length;i++)t=GMe(r[i],t);return t}function VMe(s,e){let t=s.x-e.x;if(t===0&&(t=s.y-e.y,t===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function GMe(s,e){const t=HMe(s,e);if(!t)return e;const n=t3e(t,s);return Mv(n,n.next),Mv(t,t.next)}function HMe(s,e){let t=e;const n=s.x,r=s.y;let i=-1/0,o;if(W_(s,t))return t;do{if(W_(s,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const x=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>i&&(i=x,o=t.x<t.next.x?t:t.next,x===n))return o}t=t.next}while(t!==e);if(!o)return null;const l=o,h=o.x,p=o.y;let y=1/0;t=o;do{if(n>=t.x&&t.x>=h&&n!==t.x&&J9e(r<p?n:i,r,h,p,r<p?i:n,r,t.x,t.y)){const x=Math.abs(r-t.y)/(n-t.x);AE(t,s)&&(x<y||x===y&&(t.x>o.x||t.x===o.x&&jMe(o,t)))&&(o=t,y=x)}t=t.next}while(t!==l);return o}function jMe(s,e){return Sa(s.prev,s,e.prev)<0&&Sa(e.next,s,s.next)<0}function WMe(s,e,t,n){let r=s;do r.z===0&&(r.z=RH(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,$Me(r)}function $Me(s){let e,t=1;do{let n=s,r;s=null;let i=null;for(e=0;n;){e++;let o=n,l=0;for(let p=0;p<t&&(l++,o=o.nextZ,!!o);p++);let h=t;for(;l>0||h>0&&o;)l!==0&&(h===0||!o||n.z<=o.z)?(r=n,n=n.nextZ,l--):(r=o,o=o.nextZ,h--),i?i.nextZ=r:s=r,r.prevZ=i,i=r;n=o}i.nextZ=null,t*=2}while(e>1);return s}function RH(s,e,t,n,r){return s=(s-t)*r|0,e=(e-n)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function qMe(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function J9e(s,e,t,n,r,i,o,l){return(r-o)*(e-l)>=(s-o)*(i-l)&&(s-o)*(n-l)>=(t-o)*(e-l)&&(t-o)*(i-l)>=(r-o)*(n-l)}function Zw(s,e,t,n,r,i,o,l){return!(s===o&&e===l)&&J9e(s,e,t,n,r,i,o,l)}function XMe(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!YMe(s,e)&&(AE(s,e)&&AE(e,s)&&KMe(s,e)&&(Sa(s.prev,s,e.prev)||Sa(s,e.prev,e))||W_(s,e)&&Sa(s.prev,s,s.next)>0&&Sa(e.prev,e,e.next)>0)}function Sa(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function W_(s,e){return s.x===e.x&&s.y===e.y}function e3e(s,e,t,n){const r=MR(Sa(s,e,t)),i=MR(Sa(s,e,n)),o=MR(Sa(t,n,s)),l=MR(Sa(t,n,e));return!!(r!==i&&o!==l||r===0&&TR(s,t,e)||i===0&&TR(s,n,e)||o===0&&TR(t,s,n)||l===0&&TR(t,e,n))}function TR(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function MR(s){return s>0?1:s<0?-1:0}function YMe(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&e3e(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function AE(s,e){return Sa(s.prev,s,s.next)<0?Sa(s,e,s.next)>=0&&Sa(s,s.prev,e)>=0:Sa(s,e,s.prev)<0||Sa(s,s.next,e)<0}function KMe(s,e){let t=s,n=!1;const r=(s.x+e.x)/2,i=(s.y+e.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&r<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function t3e(s,e){const t=IH(s.i,s.x,s.y),n=IH(e.i,e.x,e.y),r=s.next,i=e.prev;return s.next=e,e.prev=s,t.next=r,r.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function k1e(s,e,t,n){const r=IH(s,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function PE(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function IH(s,e,t){return{i:s,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ZMe(s,e,t,n){let r=0;for(let i=e,o=t-n;i<t;i+=n)r+=(s[o]-s[i])*(s[i+1]+s[o+1]),o=i;return r}class QMe{static triangulate(e,t,n=2){return OMe(e,t,n)}}class Jj{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return n*.5}static isClockWise(e){return Jj.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];N1e(e),D1e(n,e);let o=e.length;t.forEach(N1e);for(let h=0;h<t.length;h++)r.push(o),o+=t[h].length,D1e(n,t[h]);const l=QMe.triangulate(n,r);for(let h=0;h<l.length;h+=3)i.push(l.slice(h,h+3));return i}}function N1e(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function D1e(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class xv extends Zj{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new xv(e.radius,e.detail)}}let Cv=class n3e extends ts{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,o=t/2,l=Math.floor(n),h=Math.floor(r),p=l+1,y=h+1,x=e/l,S=t/h,A=[],k=[],L=[],U=[];for(let P=0;P<y;P++){const $=P*S-o;for(let Z=0;Z<p;Z++){const I=Z*x-i;k.push(I,-$,0),L.push(0,0,1),U.push(Z/l),U.push(1-P/h)}}for(let P=0;P<h;P++)for(let $=0;$<l;$++){const Z=$+p*P,I=$+p*(P+1),ie=$+1+p*(P+1),ce=$+1+p*P;A.push(Z,I,ce),A.push(I,ie,ce)}this.setIndex(A),this.setAttribute("position",new Nr(k,3)),this.setAttribute("normal",new Nr(L,3)),this.setAttribute("uv",new Nr(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n3e(e.width,e.height,e.widthSegments,e.heightSegments)}},Av=class r3e extends ts{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:l},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const h=Math.min(o+l,Math.PI);let p=0;const y=[],x=new ke,S=new ke,A=[],k=[],L=[],U=[];for(let P=0;P<=n;P++){const $=[],Z=P/n;let I=0;P===0&&o===0?I=.5/t:P===n&&h===Math.PI&&(I=-.5/t);for(let ie=0;ie<=t;ie++){const ce=ie/t;x.x=-e*Math.cos(r+ce*i)*Math.sin(o+Z*l),x.y=e*Math.cos(o+Z*l),x.z=e*Math.sin(r+ce*i)*Math.sin(o+Z*l),k.push(x.x,x.y,x.z),S.copy(x).normalize(),L.push(S.x,S.y,S.z),U.push(ce+I,1-Z),$.push(p++)}y.push($)}for(let P=0;P<n;P++)for(let $=0;$<t;$++){const Z=y[P][$+1],I=y[P][$],ie=y[P+1][$],ce=y[P+1][$+1];(P!==0||o>0)&&A.push(Z,I,ce),(P!==n-1||h<Math.PI)&&A.push(I,ie,ce)}this.setIndex(A),this.setAttribute("position",new Nr(k,3)),this.setAttribute("normal",new Nr(L,3)),this.setAttribute("uv",new Nr(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new r3e(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};class dv extends ts{constructor(e=1,t=.4,n=12,r=48,i=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const o=[],l=[],h=[],p=[],y=new ke,x=new ke,S=new ke;for(let A=0;A<=n;A++)for(let k=0;k<=r;k++){const L=k/r*i,U=A/n*Math.PI*2;x.x=(e+t*Math.cos(U))*Math.cos(L),x.y=(e+t*Math.cos(U))*Math.sin(L),x.z=t*Math.sin(U),l.push(x.x,x.y,x.z),y.x=e*Math.cos(L),y.y=e*Math.sin(L),S.subVectors(x,y).normalize(),h.push(S.x,S.y,S.z),p.push(k/r),p.push(A/n)}for(let A=1;A<=n;A++)for(let k=1;k<=r;k++){const L=(r+1)*A+k-1,U=(r+1)*(A-1)+k-1,P=(r+1)*(A-1)+k,$=(r+1)*A+k;o.push(L,U,$),o.push(U,P,$)}this.setIndex(o),this.setAttribute("position",new Nr(l,3)),this.setAttribute("normal",new Nr(h,3)),this.setAttribute("uv",new Nr(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dv(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class eW extends ts{constructor(e=1,t=.4,n=64,r=8,i=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},n=Math.floor(n),r=Math.floor(r);const l=[],h=[],p=[],y=[],x=new ke,S=new ke,A=new ke,k=new ke,L=new ke,U=new ke,P=new ke;for(let Z=0;Z<=n;++Z){const I=Z/n*i*Math.PI*2;$(I,i,o,e,A),$(I+.01,i,o,e,k),U.subVectors(k,A),P.addVectors(k,A),L.crossVectors(U,P),P.crossVectors(L,U),L.normalize(),P.normalize();for(let ie=0;ie<=r;++ie){const ce=ie/r*Math.PI*2,ue=-t*Math.cos(ce),Q=t*Math.sin(ce);x.x=A.x+(ue*P.x+Q*L.x),x.y=A.y+(ue*P.y+Q*L.y),x.z=A.z+(ue*P.z+Q*L.z),h.push(x.x,x.y,x.z),S.subVectors(x,A).normalize(),p.push(S.x,S.y,S.z),y.push(Z/n),y.push(ie/r)}}for(let Z=1;Z<=n;Z++)for(let I=1;I<=r;I++){const ie=(r+1)*(Z-1)+(I-1),ce=(r+1)*Z+(I-1),ue=(r+1)*Z+I,Q=(r+1)*(Z-1)+I;l.push(ie,ce,Q),l.push(ce,ue,Q)}this.setIndex(l),this.setAttribute("position",new Nr(h,3)),this.setAttribute("normal",new Nr(p,3)),this.setAttribute("uv",new Nr(y,2));function $(Z,I,ie,ce,ue){const Q=Math.cos(Z),oe=Math.sin(Z),le=ie/I*Z,J=Math.cos(le);ue.x=ce*(2+J)*.5*Q,ue.y=ce*(2+J)*oe*.5,ue.z=ce*Math.sin(le)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new eW(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}let JMe=class extends Fc{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Vn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sx,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},JI=class extends JMe{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new zn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ai(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Vn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Vn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Vn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},g_=class extends Fc{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Vn(16777215),this.specular=new Vn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sx,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.combine=Ck,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},i3e=class extends Fc{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sx,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},eCe=class extends Fc{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sx,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.combine=Ck,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};class s3e extends Fc{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=HE,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class tCe extends Fc{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}let a3e=class extends Fc{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Vn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sx,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}};function CR(s,e){return!s||s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function nCe(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function rCe(s){function e(r,i){return s[r]-s[i]}const t=s.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function O1e(s,e,t){const n=s.length,r=new s.constructor(n);for(let i=0,o=0;o!==n;++i){const l=t[i]*e;for(let h=0;h!==e;++h)r[o++]=s[l+h]}return r}function o3e(s,e,t,n){let r=1,i=s[0];for(;i!==void 0&&i[n]===void 0;)i=s[r++];if(i===void 0)return;let o=i[n];if(o!==void 0)if(Array.isArray(o))do o=i[n],o!==void 0&&(e.push(i.time),t.push(...o)),i=s[r++];while(i!==void 0);else if(o.toArray!==void 0)do o=i[n],o!==void 0&&(e.push(i.time),o.toArray(t,t.length)),i=s[r++];while(i!==void 0);else do o=i[n],o!==void 0&&(e.push(i.time),t.push(o)),i=s[r++];while(i!==void 0)}class Ik{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let o;n:{r:if(!(e<r)){for(let l=n+2;;){if(r===void 0){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===l)break;if(i=r,r=t[++n],e<r)break t}o=t.length;break n}if(!(e>=i)){const l=t[1];e<l&&(n=2,i=l);for(let h=n-2;;){if(i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===h)break;if(r=i,i=t[--n-1],e>=i)break t}o=n,n=0;break n}break e}for(;n<o;){const l=n+o>>>1;e<t[l]?o=l:n=l+1}if(r=t[n],i=t[n-1],i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let o=0;o!==r;++o)t[o]=n[i+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class iCe extends Ik{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:p_,endingEnd:p_}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,o=e+1,l=r[i],h=r[o];if(l===void 0)switch(this.getSettings_().endingStart){case m_:i=e,l=2*t-n;break;case XI:i=r.length-2,l=t+r[i]-r[i+1];break;default:i=e,l=n}if(h===void 0)switch(this.getSettings_().endingEnd){case m_:o=e,h=2*n-t;break;case XI:o=1,h=n+r[1]-r[0];break;default:o=e-1,h=t}const p=(n-t)*.5,y=this.valueSize;this._weightPrev=p/(t-l),this._weightNext=p/(h-n),this._offsetPrev=i*y,this._offsetNext=o*y}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,l=this.valueSize,h=e*l,p=h-l,y=this._offsetPrev,x=this._offsetNext,S=this._weightPrev,A=this._weightNext,k=(n-t)/(r-t),L=k*k,U=L*k,P=-S*U+2*S*L-S*k,$=(1+S)*U+(-1.5-2*S)*L+(-.5+S)*k+1,Z=(-1-A)*U+(1.5+A)*L+.5*k,I=A*U-A*L;for(let ie=0;ie!==l;++ie)i[ie]=P*o[y+ie]+$*o[p+ie]+Z*o[h+ie]+I*o[x+ie];return i}}class l3e extends Ik{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,l=this.valueSize,h=e*l,p=h-l,y=(n-t)/(r-t),x=1-y;for(let S=0;S!==l;++S)i[S]=o[p+S]*x+o[h+S]*y;return i}}class sCe extends Ik{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Cf{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=CR(t,this.TimeBufferType),this.values=CR(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:CR(e.times,Array),values:CR(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new sCe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new l3e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new iCe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case qI:t=this.InterpolantFactoryMethodDiscrete;break;case TH:t=this.InterpolantFactoryMethodLinear;break;case xz:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return qI;case this.InterpolantFactoryMethodLinear:return TH;case this.InterpolantFactoryMethodSmooth:return xz}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<e;)++i;for(;o!==-1&&n[o]>t;)--o;if(++o,i!==0||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const l=this.getValueSize();this.times=n.slice(i,o),this.values=this.values.slice(i*l,o*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==i;l++){const h=n[l];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,h),e=!1;break}if(o!==null&&o>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,h,o),e=!1;break}o=h}if(r!==void 0&&nCe(r))for(let l=0,h=r.length;l!==h;++l){const p=r[l];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===xz,i=e.length-1;let o=1;for(let l=1;l<i;++l){let h=!1;const p=e[l],y=e[l+1];if(p!==y&&(l!==1||p!==e[0]))if(r)h=!0;else{const x=l*n,S=x-n,A=x+n;for(let k=0;k!==n;++k){const L=t[x+k];if(L!==t[S+k]||L!==t[A+k]){h=!0;break}}}if(h){if(l!==o){e[o]=e[l];const x=l*n,S=o*n;for(let A=0;A!==n;++A)t[S+A]=t[x+A]}++o}}if(i>0){e[o]=e[i];for(let l=i*n,h=o*n,p=0;p!==n;++p)t[h+p]=t[l+p];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Cf.prototype.ValueTypeName="";Cf.prototype.TimeBufferType=Float32Array;Cf.prototype.ValueBufferType=Float32Array;Cf.prototype.DefaultInterpolation=TH;class ox extends Cf{constructor(e,t,n){super(e,t,n)}}ox.prototype.ValueTypeName="bool";ox.prototype.ValueBufferType=Array;ox.prototype.DefaultInterpolation=qI;ox.prototype.InterpolantFactoryMethodLinear=void 0;ox.prototype.InterpolantFactoryMethodSmooth=void 0;class u3e extends Cf{constructor(e,t,n,r){super(e,t,n,r)}}u3e.prototype.ValueTypeName="color";class RE extends Cf{constructor(e,t,n,r){super(e,t,n,r)}}RE.prototype.ValueTypeName="number";class aCe extends Ik{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,l=this.valueSize,h=(n-t)/(r-t);let p=e*l;for(let y=p+l;p!==y;p+=4)us.slerpFlat(i,0,o,p-l,o,p,h);return i}}class $_ extends Cf{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new aCe(this.times,this.values,this.getValueSize(),e)}}$_.prototype.ValueTypeName="quaternion";$_.prototype.InterpolantFactoryMethodSmooth=void 0;class lx extends Cf{constructor(e,t,n){super(e,t,n)}}lx.prototype.ValueTypeName="string";lx.prototype.ValueBufferType=Array;lx.prototype.DefaultInterpolation=qI;lx.prototype.InterpolantFactoryMethodLinear=void 0;lx.prototype.InterpolantFactoryMethodSmooth=void 0;class IE extends Cf{constructor(e,t,n,r){super(e,t,n,r)}}IE.prototype.ValueTypeName="vector";class kH{constructor(e="",t=-1,n=[],r=Vj){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=o4(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,l=n.length;o!==l;++o)t.push(lCe(n[o]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,o=n.length;i!==o;++i)t.push(Cf.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,o=[];for(let l=0;l<i;l++){let h=[],p=[];h.push((l+i-1)%i,l,(l+1)%i),p.push(0,1,0);const y=rCe(h);h=O1e(h,1,y),p=O1e(p,1,y),!r&&h[0]===0&&(h.push(i),p.push(p[0])),o.push(new RE(".morphTargetInfluences["+t[l].name+"]",h,p).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let l=0,h=e.length;l<h;l++){const p=e[l],y=p.name.match(i);if(y&&y.length>1){const x=y[1];let S=r[x];S||(r[x]=S=[]),S.push(p)}}const o=[];for(const l in r)o.push(this.CreateFromMorphTargetSequence(l,r[l],t,n));return o}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(x,S,A,k,L){if(A.length!==0){const U=[],P=[];o3e(A,U,P,k),U.length!==0&&L.push(new x(S,U,P))}},r=[],i=e.name||"default",o=e.fps||30,l=e.blendMode;let h=e.length||-1;const p=e.hierarchy||[];for(let x=0;x<p.length;x++){const S=p[x].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const A={};let k;for(k=0;k<S.length;k++)if(S[k].morphTargets)for(let L=0;L<S[k].morphTargets.length;L++)A[S[k].morphTargets[L]]=-1;for(const L in A){const U=[],P=[];for(let $=0;$!==S[k].morphTargets.length;++$){const Z=S[k];U.push(Z.time),P.push(Z.morphTarget===L?1:0)}r.push(new RE(".morphTargetInfluence["+L+"]",U,P))}h=A.length*o}else{const A=".bones["+t[x].name+"]";n(IE,A+".position",S,"pos",r),n($_,A+".quaternion",S,"rot",r),n(IE,A+".scale",S,"scl",r)}}return r.length===0?null:new this(i,h,r,l)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const i=this.tracks[n];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function oCe(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return RE;case"vector":case"vector2":case"vector3":case"vector4":return IE;case"color":return u3e;case"quaternion":return $_;case"bool":case"boolean":return ox;case"string":return lx}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function lCe(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=oCe(s.type);if(s.times===void 0){const t=[],n=[];o3e(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const ek={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class uCe{constructor(e,t,n){const r=this;let i=!1,o=0,l=0,h;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(y){l++,i===!1&&r.onStart!==void 0&&r.onStart(y,o,l),i=!0},this.itemEnd=function(y){o++,r.onProgress!==void 0&&r.onProgress(y,o,l),o===l&&(i=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(y){r.onError!==void 0&&r.onError(y)},this.resolveURL=function(y){return h?h(y):y},this.setURLModifier=function(y){return h=y,this},this.addHandler=function(y,x){return p.push(y,x),this},this.removeHandler=function(y){const x=p.indexOf(y);return x!==-1&&p.splice(x,2),this},this.getHandler=function(y){for(let x=0,S=p.length;x<S;x+=2){const A=p[x],k=p[x+1];if(A.global&&(A.lastIndex=0),A.test(y))return k}return null}}}const cCe=new uCe;class n4{constructor(e){this.manager=e!==void 0?e:cCe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}n4.DEFAULT_MATERIAL_NAME="__DEFAULT";const pg={};class hCe extends Error{constructor(e,t){super(e),this.response=t}}class dCe extends n4{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=ek.get(e);if(i!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(pg[e]!==void 0){pg[e].push({onLoad:t,onProgress:n,onError:r});return}pg[e]=[],pg[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,h=this.responseType;fetch(o).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const y=pg[e],x=p.body.getReader(),S=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),A=S?parseInt(S):0,k=A!==0;let L=0;const U=new ReadableStream({start(P){$();function $(){x.read().then(({done:Z,value:I})=>{if(Z)P.close();else{L+=I.byteLength;const ie=new ProgressEvent("progress",{lengthComputable:k,loaded:L,total:A});for(let ce=0,ue=y.length;ce<ue;ce++){const Q=y[ce];Q.onProgress&&Q.onProgress(ie)}P.enqueue(I),$()}},Z=>{P.error(Z)})}}});return new Response(U)}else throw new hCe(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(h){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(y=>new DOMParser().parseFromString(y,l));case"json":return p.json();default:if(l==="")return p.text();{const x=/charset="?([^;"\s]*)"?/i.exec(l),S=x&&x[1]?x[1].toLowerCase():void 0,A=new TextDecoder(S);return p.arrayBuffer().then(k=>A.decode(k))}}}).then(p=>{ek.add(e,p);const y=pg[e];delete pg[e];for(let x=0,S=y.length;x<S;x++){const A=y[x];A.onLoad&&A.onLoad(p)}}).catch(p=>{const y=pg[e];if(y===void 0)throw this.manager.itemError(e),p;delete pg[e];for(let x=0,S=y.length;x<S;x++){const A=y[x];A.onError&&A.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class c3e extends n4{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=ek.get(e);if(o!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;const l=TE("img");function h(){y(),ek.add(e,this),t&&t(this),i.manager.itemEnd(e)}function p(x){y(),r&&r(x),i.manager.itemError(e),i.manager.itemEnd(e)}function y(){l.removeEventListener("load",h,!1),l.removeEventListener("error",p,!1)}return l.addEventListener("load",h,!1),l.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),i.manager.itemStart(e),l.src=e,l}}class fCe extends n4{constructor(e){super(e)}load(e,t,n,r){const i=new $j;i.colorSpace=ei;const o=new c3e(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let l=0;function h(p){o.load(e[p],function(y){i.images[p]=y,l++,l===6&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(let p=0;p<e.length;++p)h(p);return i}}class h3e extends n4{constructor(e){super(e)}load(e,t,n,r){const i=new Wo,o=new c3e(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){i.image=l,i.needsUpdate=!0,t!==void 0&&t(i)},n,r),i}}let ux=class extends Ri{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Vn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}},pCe=class extends ux{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Vn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}};const Yz=new yr,F1e=new ke,L1e=new ke;let tW=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new zn(512,512),this.mapType=jo,this.map=null,this.mapPass=null,this.matrix=new yr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yj,this._frameExtents=new zn(1,1),this._viewportCount=1,this._viewports=[new Ti(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;F1e.setFromMatrixPosition(e.matrixWorld),t.position.copy(F1e),L1e.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(L1e),t.updateMatrixWorld(),Yz.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Yz),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Yz)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},mCe=class extends tW{constructor(){super(new Go(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=H_*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},nW=class extends ux{constructor(e,t,n=0,r=Math.PI/3,i=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.target=new Ri,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new mCe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};const U1e=new yr,xw=new ke,Kz=new ke;let gCe=class extends tW{constructor(){super(new Go(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new zn(4,2),this._viewportCount=6,this._viewports=[new Ti(2,1,1,1),new Ti(0,1,1,1),new Ti(3,1,1,1),new Ti(1,1,1,1),new Ti(3,0,1,1),new Ti(1,0,1,1)],this._cubeDirections=[new ke(1,0,0),new ke(-1,0,0),new ke(0,0,1),new ke(0,0,-1),new ke(0,1,0),new ke(0,-1,0)],this._cubeUps=[new ke(0,1,0),new ke(0,1,0),new ke(0,1,0),new ke(0,1,0),new ke(0,0,1),new ke(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),xw.setFromMatrixPosition(e.matrixWorld),n.position.copy(xw),Kz.copy(n.position),Kz.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Kz),n.updateMatrixWorld(),r.makeTranslation(-xw.x,-xw.y,-xw.z),U1e.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(U1e)}},B1e=class extends ux{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new gCe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},q_=class extends Pk{constructor(e=-1,t=1,n=1,r=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,o=n+e,l=r+t,h=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=p*this.view.offsetX,o=i+p*this.view.width,l-=y*this.view.offsetY,h=l-y*this.view.height}this.projectionMatrix.makeOrthographic(i,o,l,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},vCe=class extends tW{constructor(){super(new q_(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},rW=class extends ux{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.target=new Ri,this.shadow=new vCe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},yCe=class extends ux{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}},_Ce=class extends ux{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}};class xCe{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}let bCe=class extends Go{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}};class d3e{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=z1e(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=z1e();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function z1e(){return performance.now()}class SCe{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,i,o;switch(t){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let l=0;l!==r;++l)n[i+l]=n[l];o=t}else{o+=t;const l=t/o;this._mixBufferRegion(n,i,0,l,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const h=t*this._origIndex;this._mixBufferRegion(n,r,h,1-i,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let h=t,p=t+t;h!==p;++h)if(n[h]!==n[h+t]){l.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let o=0;o!==i;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){us.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const o=this._workIndex*i;us.multiplyQuaternionsFlat(e,o,e,t,e,n),us.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,i){const o=1-r;for(let l=0;l!==i;++l){const h=t+l;e[h]=e[h]*o+e[n+l]*r}}_lerpAdditive(e,t,n,r,i){for(let o=0;o!==i;++o){const l=t+o;e[l]=e[l]+e[n+o]*r}}}const iW="\\[\\]\\.:\\/",wCe=new RegExp("["+iW+"]","g"),sW="[^"+iW+"]",ECe="[^"+iW.replace("\\.","")+"]",TCe=/((?:WC+[\/:])*)/.source.replace("WC",sW),MCe=/(WCOD+)?/.source.replace("WCOD",ECe),CCe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sW),ACe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sW),PCe=new RegExp("^"+TCe+MCe+CCe+ACe+"$"),RCe=["material","materials","bones","map"];class ICe{constructor(e,t,n){const r=n||Gi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Gi{constructor(e,t,n){this.path=t,this.parsedPath=n||Gi.parseTrackName(t),this.node=Gi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Gi.Composite(e,t,n):new Gi(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(wCe,"")}static parseTrackName(e){const t=PCe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const i=n.nodeName.substring(r+1);RCe.indexOf(i)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(i){for(let o=0;o<i.length;o++){const l=i[o];if(l.name===t||l.uuid===t)return l;const h=n(l.children);if(h)return h}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=Gi.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let y=0;y<e.length;y++)if(e[y].name===p){p=y;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const o=e[r];if(o===void 0){const p=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?l=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(i!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[i]!==void 0&&(i=e.morphTargetDictionary[i])}h=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else o.fromArray!==void 0&&o.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(h=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Gi.Composite=ICe;Gi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Gi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Gi.prototype.GetterByBindingType=[Gi.prototype._getValue_direct,Gi.prototype._getValue_array,Gi.prototype._getValue_arrayElement,Gi.prototype._getValue_toArray];Gi.prototype.SetterByBindingTypeAndVersioning=[[Gi.prototype._setValue_direct,Gi.prototype._setValue_direct_setNeedsUpdate,Gi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Gi.prototype._setValue_array,Gi.prototype._setValue_array_setNeedsUpdate,Gi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Gi.prototype._setValue_arrayElement,Gi.prototype._setValue_arrayElement_setNeedsUpdate,Gi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Gi.prototype._setValue_fromArray,Gi.prototype._setValue_fromArray_setNeedsUpdate,Gi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class kCe{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,o=i.length,l=new Array(o),h={endingStart:p_,endingEnd:p_};for(let p=0;p!==o;++p){const y=i[p].createInterpolant(null);l[p]=y,y.settings=h}this._interpolantSettings=h,this._interpolants=l,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=MTe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,i=e._clip.duration,o=i/r,l=r/i;e.warp(1,o,t),this.warp(l,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,o=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=r._lendControlInterpolant(),this._timeScaleInterpolant=l);const h=l.parameterPositions,p=l.sampleValues;return h[0]=i,h[1]=i+n,p[0]=e/o,p[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const i=this._startTime;if(i!==null){const h=(e-i)*n;h<0||n===0?t=0:(this._startTime=null,t=n*h)}t*=this._updateTimeScale(e);const o=this._updateTime(t),l=this._updateWeight(e);if(l>0){const h=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case ATe:for(let y=0,x=h.length;y!==x;++y)h[y].evaluate(o),p[y].accumulateAdditive(l);break;case Vj:default:for(let y=0,x=h.length;y!==x;++y)h[y].evaluate(o),p[y].accumulate(r,l)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const o=n===CTe;if(e===0)return i===-1?r:o&&(i&1)===1?t-r:r;if(n===TTe){i===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(i===-1&&(e>=0?(i=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const l=Math.floor(r/t);r-=t*l,i+=Math.abs(l);const h=this.repetitions-i;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const p=e<0;this._setEndings(p,!p,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=r;if(o&&(i&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=m_,r.endingEnd=m_):(e?r.endingStart=this.zeroSlopeAtStart?m_:p_:r.endingStart=XI,t?r.endingEnd=this.zeroSlopeAtEnd?m_:p_:r.endingEnd=XI)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const l=o.parameterPositions,h=o.sampleValues;return l[0]=i,h[0]=t,l[1]=i+e,h[1]=n,this}}const NCe=new Float32Array(1);class DCe extends Oc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,l=e._interpolants,h=n.uuid,p=this._bindingsByRootAndName;let y=p[h];y===void 0&&(y={},p[h]=y);for(let x=0;x!==i;++x){const S=r[x],A=S.name;let k=y[A];if(k!==void 0)++k.referenceCount,o[x]=k;else{if(k=o[x],k!==void 0){k._cacheIndex===null&&(++k.referenceCount,this._addInactiveBinding(k,h,A));continue}const L=t&&t._propertyBindings[x].binding.parsedPath;k=new SCe(Gi.create(n,A,L),S.ValueTypeName,S.getValueSize()),++k.referenceCount,this._addInactiveBinding(k,h,A),o[x]=k}l[x].resultBuffer=k.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,i=this._actionsByClip[r];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];i.useCount++===0&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.useCount===0&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let o=i[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{const l=o.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,o=this._actionsByClip,l=o[i],h=l.knownActions,p=h[h.length-1],y=e._byClipCacheIndex;p._byClipCacheIndex=y,h[y]=p,h.pop(),e._byClipCacheIndex=null;const x=l.actionByRoot,S=(e._localRoot||this._root).uuid;delete x[S],h.length===0&&delete o[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.referenceCount===0&&this._removeInactiveBinding(i)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,l=o[r],h=t[t.length-1],p=e._cacheIndex;h._cacheIndex=p,t[p]=h,t.pop(),delete l[i],Object.keys(l).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new l3e(new Float32Array(2),new Float32Array(2),1,NCe),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let o=typeof e=="string"?kH.findByName(r,e):e;const l=o!==null?o.uuid:e,h=this._actionsByClip[l];let p=null;if(n===void 0&&(o!==null?n=o.blendMode:n=Vj),h!==void 0){const x=h.actionByRoot[i];if(x!==void 0&&x.blendMode===n)return x;p=h.knownActions[0],o===null&&(o=p._clip)}if(o===null)return null;const y=new kCe(this,o,t,n);return this._bindAction(y,p),this._addInactiveAction(y,l,i),y}existingAction(e,t){const n=t||this._root,r=n.uuid,i=typeof e=="string"?kH.findByName(n,e):e,o=i?i.uuid:e,l=this._actionsByClip[o];return l!==void 0&&l.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(r,e,i,o);const l=this._bindings,h=this._nActiveBindings;for(let p=0;p!==h;++p)l[p].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(i!==void 0){const o=i.knownActions;for(let l=0,h=o.length;l!==h;++l){const p=o[l];this._deactivateAction(p);const y=p._cacheIndex,x=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,x._cacheIndex=y,t[y]=x,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const l=n[o].actionByRoot,h=l[t];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}const r=this._bindingsByRootAndName,i=r[t];if(i!==void 0)for(const o in i){const l=i[o];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}let ms=class f3e{constructor(e){this.value=e}clone(){return new f3e(this.value.clone===void 0?this.value:this.value.clone())}};const V1e=new yr;class kE{constructor(e,t,n=0,r=1/0){this.ray=new ax(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new jj,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return V1e.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(V1e),this}intersectObject(e,t=!0,n=[]){return NH(e,this,n,t),n.sort(G1e),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)NH(e[r],this,n,t);return n.sort(G1e),n}}function G1e(s,e){return s.distance-e.distance}function NH(s,e,t,n){let r=!0;if(s.layers.test(e.layers)&&s.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const i=s.children;for(let o=0,l=i.length;o<l;o++)NH(i[o],e,t,!0)}}class DH{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=ai(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ai(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const H1e=new ke;class OCe extends Ri{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new ts,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,l=1,h=32;o<h;o++,l++){const p=o/h*Math.PI*2,y=l/h*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(y),Math.sin(y),1)}n.setAttribute("position",new Nr(r,3));const i=new Mf({fog:!1,toneMapped:!1});this.cone=new jE(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),H1e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(H1e),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const R3=new ke,AR=new yr,Zz=new yr;class FCe extends jE{constructor(e){const t=p3e(e),n=new ts,r=[],i=[],o=new Vn(0,0,1),l=new Vn(0,1,0);for(let p=0;p<t.length;p++){const y=t[p];y.parent&&y.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(l.r,l.g,l.b))}n.setAttribute("position",new Nr(r,3)),n.setAttribute("color",new Nr(i,3));const h=new Mf({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,h),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Zz.copy(this.root.matrixWorld).invert();for(let i=0,o=0;i<t.length;i++){const l=t[i];l.parent&&l.parent.isBone&&(AR.multiplyMatrices(Zz,l.matrixWorld),R3.setFromMatrixPosition(AR),r.setXYZ(o,R3.x,R3.y,R3.z),AR.multiplyMatrices(Zz,l.parent.matrixWorld),R3.setFromMatrixPosition(AR),r.setXYZ(o+1,R3.x,R3.y,R3.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function p3e(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push(...p3e(s.children[t]));return e}class LCe extends Mn{constructor(e,t,n){const r=new Av(t,4,2),i=new Nc({wireframe:!0,fog:!1,toneMapped:!1});super(r,i),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const UCe=new ke,j1e=new Vn,W1e=new Vn;class BCe extends Ri{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new xv(t);r.rotateY(Math.PI*.5),this.material=new Nc({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),o=new Float32Array(i.count*3);r.setAttribute("color",new Ic(o,3)),this.add(new Mn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");j1e.copy(this.light.color),W1e.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const i=n<r/2?j1e:W1e;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(UCe.setFromMatrixPosition(this.light.matrixWorld).negate())}}const $1e=new ke,PR=new ke,q1e=new ke;class zCe extends Ri{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new ts;r.setAttribute("position",new Nr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new Mf({fog:!1,toneMapped:!1});this.lightPlane=new Pu(r,i),this.add(this.lightPlane),r=new ts,r.setAttribute("position",new Nr([0,0,0,0,0,1],3)),this.targetLine=new Pu(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),$1e.setFromMatrixPosition(this.light.matrixWorld),PR.setFromMatrixPosition(this.light.target.matrixWorld),q1e.subVectors(PR,$1e),this.lightPlane.lookAt(PR),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(PR),this.targetLine.scale.z=q1e.length()}}const RR=new ke,Ia=new Pk;class VCe extends jE{constructor(e){const t=new ts,n=new Mf({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={};l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4");function l(k,L){h(k),h(L)}function h(k){r.push(0,0,0),i.push(0,0,0),o[k]===void 0&&(o[k]=[]),o[k].push(r.length/3-1)}t.setAttribute("position",new Nr(r,3)),t.setAttribute("color",new Nr(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const p=new Vn(16755200),y=new Vn(16711680),x=new Vn(43775),S=new Vn(16777215),A=new Vn(3355443);this.setColors(p,y,x,S,A)}setColors(e,t,n,r,i){const l=this.geometry.getAttribute("color");l.setXYZ(0,e.r,e.g,e.b),l.setXYZ(1,e.r,e.g,e.b),l.setXYZ(2,e.r,e.g,e.b),l.setXYZ(3,e.r,e.g,e.b),l.setXYZ(4,e.r,e.g,e.b),l.setXYZ(5,e.r,e.g,e.b),l.setXYZ(6,e.r,e.g,e.b),l.setXYZ(7,e.r,e.g,e.b),l.setXYZ(8,e.r,e.g,e.b),l.setXYZ(9,e.r,e.g,e.b),l.setXYZ(10,e.r,e.g,e.b),l.setXYZ(11,e.r,e.g,e.b),l.setXYZ(12,e.r,e.g,e.b),l.setXYZ(13,e.r,e.g,e.b),l.setXYZ(14,e.r,e.g,e.b),l.setXYZ(15,e.r,e.g,e.b),l.setXYZ(16,e.r,e.g,e.b),l.setXYZ(17,e.r,e.g,e.b),l.setXYZ(18,e.r,e.g,e.b),l.setXYZ(19,e.r,e.g,e.b),l.setXYZ(20,e.r,e.g,e.b),l.setXYZ(21,e.r,e.g,e.b),l.setXYZ(22,e.r,e.g,e.b),l.setXYZ(23,e.r,e.g,e.b),l.setXYZ(24,t.r,t.g,t.b),l.setXYZ(25,t.r,t.g,t.b),l.setXYZ(26,t.r,t.g,t.b),l.setXYZ(27,t.r,t.g,t.b),l.setXYZ(28,t.r,t.g,t.b),l.setXYZ(29,t.r,t.g,t.b),l.setXYZ(30,t.r,t.g,t.b),l.setXYZ(31,t.r,t.g,t.b),l.setXYZ(32,n.r,n.g,n.b),l.setXYZ(33,n.r,n.g,n.b),l.setXYZ(34,n.r,n.g,n.b),l.setXYZ(35,n.r,n.g,n.b),l.setXYZ(36,n.r,n.g,n.b),l.setXYZ(37,n.r,n.g,n.b),l.setXYZ(38,r.r,r.g,r.b),l.setXYZ(39,r.r,r.g,r.b),l.setXYZ(40,i.r,i.g,i.b),l.setXYZ(41,i.r,i.g,i.b),l.setXYZ(42,i.r,i.g,i.b),l.setXYZ(43,i.r,i.g,i.b),l.setXYZ(44,i.r,i.g,i.b),l.setXYZ(45,i.r,i.g,i.b),l.setXYZ(46,i.r,i.g,i.b),l.setXYZ(47,i.r,i.g,i.b),l.setXYZ(48,i.r,i.g,i.b),l.setXYZ(49,i.r,i.g,i.b),l.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;Ia.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const i=this.camera.coordinateSystem===s1?-1:0;Ha("c",t,e,Ia,0,0,i),Ha("t",t,e,Ia,0,0,1),Ha("n1",t,e,Ia,-1,-1,i),Ha("n2",t,e,Ia,n,-1,i),Ha("n3",t,e,Ia,-1,r,i),Ha("n4",t,e,Ia,n,r,i),Ha("f1",t,e,Ia,-1,-1,1),Ha("f2",t,e,Ia,n,-1,1),Ha("f3",t,e,Ia,-1,r,1),Ha("f4",t,e,Ia,n,r,1),Ha("u1",t,e,Ia,n*.7,r*1.1,i),Ha("u2",t,e,Ia,-1*.7,r*1.1,i),Ha("u3",t,e,Ia,0,r*2,i),Ha("cf1",t,e,Ia,-1,0,1),Ha("cf2",t,e,Ia,n,0,1),Ha("cf3",t,e,Ia,0,-1,1),Ha("cf4",t,e,Ia,0,r,1),Ha("cn1",t,e,Ia,-1,0,i),Ha("cn2",t,e,Ia,n,0,i),Ha("cn3",t,e,Ia,0,-1,i),Ha("cn4",t,e,Ia,0,r,i),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ha(s,e,t,n,r,i,o){RR.set(r,i,o).unproject(n);const l=e[s];if(l!==void 0){const h=t.getAttribute("position");for(let p=0,y=l.length;p<y;p++)h.setXYZ(l[p],RR.x,RR.y,RR.z)}}class GCe extends jE{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new ts;r.setAttribute("position",new Nr(t,3)),r.setAttribute("color",new Nr(n,3));const i=new Mf({vertexColors:!0,toneMapped:!1});super(r,i),this.type="AxesHelper"}setColors(e,t,n){const r=new Vn,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class m3e extends Oc{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function X1e(s,e,t,n){const r=HCe(n);switch(t){case R9e:return s*e;case k9e:return s*e/r.components*r.byteLength;case Uj:return s*e/r.components*r.byteLength;case N9e:return s*e*2/r.components*r.byteLength;case Bj:return s*e*2/r.components*r.byteLength;case I9e:return s*e*3/r.components*r.byteLength;case K0:return s*e*4/r.components*r.byteLength;case zj:return s*e*4/r.components*r.byteLength;case MI:case CI:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case AI:case PI:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case eH:case nH:return Math.max(s,16)*Math.max(e,8)/4;case JG:case tH:return Math.max(s,8)*Math.max(e,8)/2;case rH:case iH:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case sH:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case aH:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case oH:return Math.floor((s+4)/5)*Math.floor((e+3)/4)*16;case lH:return Math.floor((s+4)/5)*Math.floor((e+4)/5)*16;case uH:return Math.floor((s+5)/6)*Math.floor((e+4)/5)*16;case cH:return Math.floor((s+5)/6)*Math.floor((e+5)/6)*16;case hH:return Math.floor((s+7)/8)*Math.floor((e+4)/5)*16;case dH:return Math.floor((s+7)/8)*Math.floor((e+5)/6)*16;case fH:return Math.floor((s+7)/8)*Math.floor((e+7)/8)*16;case pH:return Math.floor((s+9)/10)*Math.floor((e+4)/5)*16;case mH:return Math.floor((s+9)/10)*Math.floor((e+5)/6)*16;case gH:return Math.floor((s+9)/10)*Math.floor((e+7)/8)*16;case vH:return Math.floor((s+9)/10)*Math.floor((e+9)/10)*16;case yH:return Math.floor((s+11)/12)*Math.floor((e+9)/10)*16;case _H:return Math.floor((s+11)/12)*Math.floor((e+11)/12)*16;case RI:case xH:case bH:return Math.ceil(s/4)*Math.ceil(e/4)*16;case D9e:case SH:return Math.ceil(s/4)*Math.ceil(e/4)*8;case wH:case EH:return Math.ceil(s/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function HCe(s){switch(s){case jo:case C9e:return{byteLength:1,components:1};case wE:case A9e:case t4:return{byteLength:2,components:1};case Fj:case Lj:return{byteLength:2,components:4};case e4:case Oj:case Lh:return{byteLength:4,components:1};case P9e:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${s}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:GE}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=GE);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function g3e(){let s=null,e=!1,t=null,n=null;function r(i,o){t(i,o),n=s.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(r),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(i){t=i},setContext:function(i){s=i}}}function jCe(s){const e=new WeakMap;function t(l,h){const p=l.array,y=l.usage,x=p.byteLength,S=s.createBuffer();s.bindBuffer(h,S),s.bufferData(h,p,y),l.onUploadCallback();let A;if(p instanceof Float32Array)A=s.FLOAT;else if(p instanceof Uint16Array)l.isFloat16BufferAttribute?A=s.HALF_FLOAT:A=s.UNSIGNED_SHORT;else if(p instanceof Int16Array)A=s.SHORT;else if(p instanceof Uint32Array)A=s.UNSIGNED_INT;else if(p instanceof Int32Array)A=s.INT;else if(p instanceof Int8Array)A=s.BYTE;else if(p instanceof Uint8Array)A=s.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)A=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:S,type:A,bytesPerElement:p.BYTES_PER_ELEMENT,version:l.version,size:x}}function n(l,h,p){const y=h.array,x=h.updateRanges;if(s.bindBuffer(p,l),x.length===0)s.bufferSubData(p,0,y);else{x.sort((A,k)=>A.start-k.start);let S=0;for(let A=1;A<x.length;A++){const k=x[S],L=x[A];L.start<=k.start+k.count+1?k.count=Math.max(k.count,L.start+L.count-k.start):(++S,x[S]=L)}x.length=S+1;for(let A=0,k=x.length;A<k;A++){const L=x[A];s.bufferSubData(p,L.start*y.BYTES_PER_ELEMENT,y,L.start,L.count)}h.clearUpdateRanges()}h.onUploadCallback()}function r(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function i(l){l.isInterleavedBufferAttribute&&(l=l.data);const h=e.get(l);h&&(s.deleteBuffer(h.buffer),e.delete(l))}function o(l,h){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){const y=e.get(l);(!y||y.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}const p=e.get(l);if(p===void 0)e.set(l,t(l,h));else if(p.version<l.version){if(p.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,l,h),p.version=l.version}}return{get:r,remove:i,update:o}}var WCe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,$Ce=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,qCe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,XCe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,YCe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,KCe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,ZCe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,QCe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,JCe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,eAe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,tAe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,nAe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,rAe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iAe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,sAe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,aAe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,oAe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,lAe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,uAe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,cAe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,hAe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,dAe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,fAe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,pAe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,mAe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,gAe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,vAe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,yAe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,_Ae=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,xAe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,bAe="gl_FragColor = linearToOutputTexel( gl_FragColor );",SAe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,wAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,EAe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,TAe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,MAe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,CAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,AAe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,PAe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,RAe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,IAe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,kAe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,NAe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,DAe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,OAe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,FAe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,LAe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,UAe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,BAe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,zAe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,VAe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,GAe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,HAe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,jAe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,WAe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,$Ae=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,qAe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,XAe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,YAe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,KAe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,ZAe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,QAe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,JAe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,ePe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tPe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,nPe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,rPe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,iPe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,sPe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,aPe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,oPe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,lPe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,uPe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,cPe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,hPe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,dPe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,fPe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,pPe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,mPe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,gPe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,vPe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,yPe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,_Pe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,xPe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,bPe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,SPe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,wPe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,EPe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,TPe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,MPe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,CPe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,APe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,PPe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,RPe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,IPe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,kPe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,NPe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,DPe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,OPe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,FPe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,LPe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,UPe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,BPe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,zPe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,VPe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,GPe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,HPe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const jPe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,WPe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$Pe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,qPe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,XPe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,YPe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,KPe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ZPe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,QPe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,JPe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,eRe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,tRe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nRe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,rRe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,iRe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,sRe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aRe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,oRe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lRe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,uRe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cRe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,hRe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,dRe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fRe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pRe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,mRe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gRe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vRe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yRe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,_Re=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xRe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bRe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,SRe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,wRe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,fi={alphahash_fragment:WCe,alphahash_pars_fragment:$Ce,alphamap_fragment:qCe,alphamap_pars_fragment:XCe,alphatest_fragment:YCe,alphatest_pars_fragment:KCe,aomap_fragment:ZCe,aomap_pars_fragment:QCe,batching_pars_vertex:JCe,batching_vertex:eAe,begin_vertex:tAe,beginnormal_vertex:nAe,bsdfs:rAe,iridescence_fragment:iAe,bumpmap_pars_fragment:sAe,clipping_planes_fragment:aAe,clipping_planes_pars_fragment:oAe,clipping_planes_pars_vertex:lAe,clipping_planes_vertex:uAe,color_fragment:cAe,color_pars_fragment:hAe,color_pars_vertex:dAe,color_vertex:fAe,common:pAe,cube_uv_reflection_fragment:mAe,defaultnormal_vertex:gAe,displacementmap_pars_vertex:vAe,displacementmap_vertex:yAe,emissivemap_fragment:_Ae,emissivemap_pars_fragment:xAe,colorspace_fragment:bAe,colorspace_pars_fragment:SAe,envmap_fragment:wAe,envmap_common_pars_fragment:EAe,envmap_pars_fragment:TAe,envmap_pars_vertex:MAe,envmap_physical_pars_fragment:LAe,envmap_vertex:CAe,fog_vertex:AAe,fog_pars_vertex:PAe,fog_fragment:RAe,fog_pars_fragment:IAe,gradientmap_pars_fragment:kAe,lightmap_pars_fragment:NAe,lights_lambert_fragment:DAe,lights_lambert_pars_fragment:OAe,lights_pars_begin:FAe,lights_toon_fragment:UAe,lights_toon_pars_fragment:BAe,lights_phong_fragment:zAe,lights_phong_pars_fragment:VAe,lights_physical_fragment:GAe,lights_physical_pars_fragment:HAe,lights_fragment_begin:jAe,lights_fragment_maps:WAe,lights_fragment_end:$Ae,logdepthbuf_fragment:qAe,logdepthbuf_pars_fragment:XAe,logdepthbuf_pars_vertex:YAe,logdepthbuf_vertex:KAe,map_fragment:ZAe,map_pars_fragment:QAe,map_particle_fragment:JAe,map_particle_pars_fragment:ePe,metalnessmap_fragment:tPe,metalnessmap_pars_fragment:nPe,morphinstance_vertex:rPe,morphcolor_vertex:iPe,morphnormal_vertex:sPe,morphtarget_pars_vertex:aPe,morphtarget_vertex:oPe,normal_fragment_begin:lPe,normal_fragment_maps:uPe,normal_pars_fragment:cPe,normal_pars_vertex:hPe,normal_vertex:dPe,normalmap_pars_fragment:fPe,clearcoat_normal_fragment_begin:pPe,clearcoat_normal_fragment_maps:mPe,clearcoat_pars_fragment:gPe,iridescence_pars_fragment:vPe,opaque_fragment:yPe,packing:_Pe,premultiplied_alpha_fragment:xPe,project_vertex:bPe,dithering_fragment:SPe,dithering_pars_fragment:wPe,roughnessmap_fragment:EPe,roughnessmap_pars_fragment:TPe,shadowmap_pars_fragment:MPe,shadowmap_pars_vertex:CPe,shadowmap_vertex:APe,shadowmask_pars_fragment:PPe,skinbase_vertex:RPe,skinning_pars_vertex:IPe,skinning_vertex:kPe,skinnormal_vertex:NPe,specularmap_fragment:DPe,specularmap_pars_fragment:OPe,tonemapping_fragment:FPe,tonemapping_pars_fragment:LPe,transmission_fragment:UPe,transmission_pars_fragment:BPe,uv_pars_fragment:zPe,uv_pars_vertex:VPe,uv_vertex:GPe,worldpos_vertex:HPe,background_vert:jPe,background_frag:WPe,backgroundCube_vert:$Pe,backgroundCube_frag:qPe,cube_vert:XPe,cube_frag:YPe,depth_vert:KPe,depth_frag:ZPe,distanceRGBA_vert:QPe,distanceRGBA_frag:JPe,equirect_vert:eRe,equirect_frag:tRe,linedashed_vert:nRe,linedashed_frag:rRe,meshbasic_vert:iRe,meshbasic_frag:sRe,meshlambert_vert:aRe,meshlambert_frag:oRe,meshmatcap_vert:lRe,meshmatcap_frag:uRe,meshnormal_vert:cRe,meshnormal_frag:hRe,meshphong_vert:dRe,meshphong_frag:fRe,meshphysical_vert:pRe,meshphysical_frag:mRe,meshtoon_vert:gRe,meshtoon_frag:vRe,points_vert:yRe,points_frag:_Re,shadow_vert:xRe,shadow_frag:bRe,sprite_vert:SRe,sprite_frag:wRe},Un={common:{diffuse:{value:new Vn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ci},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ci}},envmap:{envMap:{value:null},envMapRotation:{value:new ci},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ci}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ci}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ci},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ci},normalScale:{value:new zn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ci},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ci}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ci}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ci}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Vn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Vn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0},uvTransform:{value:new ci}},sprite:{diffuse:{value:new Vn(16777215)},opacity:{value:1},center:{value:new zn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ci},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0}}},r1={basic:{uniforms:Ol([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.fog]),vertexShader:fi.meshbasic_vert,fragmentShader:fi.meshbasic_frag},lambert:{uniforms:Ol([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new Vn(0)}}]),vertexShader:fi.meshlambert_vert,fragmentShader:fi.meshlambert_frag},phong:{uniforms:Ol([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new Vn(0)},specular:{value:new Vn(1118481)},shininess:{value:30}}]),vertexShader:fi.meshphong_vert,fragmentShader:fi.meshphong_frag},standard:{uniforms:Ol([Un.common,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.roughnessmap,Un.metalnessmap,Un.fog,Un.lights,{emissive:{value:new Vn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag},toon:{uniforms:Ol([Un.common,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.gradientmap,Un.fog,Un.lights,{emissive:{value:new Vn(0)}}]),vertexShader:fi.meshtoon_vert,fragmentShader:fi.meshtoon_frag},matcap:{uniforms:Ol([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,{matcap:{value:null}}]),vertexShader:fi.meshmatcap_vert,fragmentShader:fi.meshmatcap_frag},points:{uniforms:Ol([Un.points,Un.fog]),vertexShader:fi.points_vert,fragmentShader:fi.points_frag},dashed:{uniforms:Ol([Un.common,Un.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fi.linedashed_vert,fragmentShader:fi.linedashed_frag},depth:{uniforms:Ol([Un.common,Un.displacementmap]),vertexShader:fi.depth_vert,fragmentShader:fi.depth_frag},normal:{uniforms:Ol([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,{opacity:{value:1}}]),vertexShader:fi.meshnormal_vert,fragmentShader:fi.meshnormal_frag},sprite:{uniforms:Ol([Un.sprite,Un.fog]),vertexShader:fi.sprite_vert,fragmentShader:fi.sprite_frag},background:{uniforms:{uvTransform:{value:new ci},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fi.background_vert,fragmentShader:fi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ci}},vertexShader:fi.backgroundCube_vert,fragmentShader:fi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fi.cube_vert,fragmentShader:fi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fi.equirect_vert,fragmentShader:fi.equirect_frag},distanceRGBA:{uniforms:Ol([Un.common,Un.displacementmap,{referencePosition:{value:new ke},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fi.distanceRGBA_vert,fragmentShader:fi.distanceRGBA_frag},shadow:{uniforms:Ol([Un.lights,Un.fog,{color:{value:new Vn(0)},opacity:{value:1}}]),vertexShader:fi.shadow_vert,fragmentShader:fi.shadow_frag}};r1.physical={uniforms:Ol([r1.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ci},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ci},clearcoatNormalScale:{value:new zn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ci},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ci},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ci},sheen:{value:0},sheenColor:{value:new Vn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ci},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ci},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ci},transmissionSamplerSize:{value:new zn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ci},attenuationDistance:{value:0},attenuationColor:{value:new Vn(0)},specularColor:{value:new Vn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ci},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ci},anisotropyVector:{value:new zn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ci}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag};const IR={r:0,b:0,g:0},W8=new so,ERe=new yr;function TRe(s,e,t,n,r,i,o){const l=new Vn(0);let h=i===!0?0:1,p,y,x=null,S=0,A=null;function k(Z){let I=Z.isScene===!0?Z.background:null;return I&&I.isTexture&&(I=(Z.backgroundBlurriness>0?t:e).get(I)),I}function L(Z){let I=!1;const ie=k(Z);ie===null?P(l,h):ie&&ie.isColor&&(P(ie,1),I=!0);const ce=s.xr.getEnvironmentBlendMode();ce==="additive"?n.buffers.color.setClear(0,0,0,1,o):ce==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(s.autoClear||I)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil))}function U(Z,I){const ie=k(I);ie&&(ie.isCubeTexture||ie.mapping===Ak)?(y===void 0&&(y=new Mn(new xo(1,1,1),new $o({name:"BackgroundCubeMaterial",uniforms:j_(r1.backgroundCube.uniforms),vertexShader:r1.backgroundCube.vertexShader,fragmentShader:r1.backgroundCube.fragmentShader,side:qa,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),y.geometry.deleteAttribute("normal"),y.geometry.deleteAttribute("uv"),y.onBeforeRender=function(ce,ue,Q){this.matrixWorld.copyPosition(Q.matrixWorld)},Object.defineProperty(y.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(y)),W8.copy(I.backgroundRotation),W8.x*=-1,W8.y*=-1,W8.z*=-1,ie.isCubeTexture&&ie.isRenderTargetTexture===!1&&(W8.y*=-1,W8.z*=-1),y.material.uniforms.envMap.value=ie,y.material.uniforms.flipEnvMap.value=ie.isCubeTexture&&ie.isRenderTargetTexture===!1?-1:1,y.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,y.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,y.material.uniforms.backgroundRotation.value.setFromMatrix4(ERe.makeRotationFromEuler(W8)),y.material.toneMapped=Yr.getTransfer(ie.colorSpace)!==xs,(x!==ie||S!==ie.version||A!==s.toneMapping)&&(y.material.needsUpdate=!0,x=ie,S=ie.version,A=s.toneMapping),y.layers.enableAll(),Z.unshift(y,y.geometry,y.material,0,0,null)):ie&&ie.isTexture&&(p===void 0&&(p=new Mn(new Cv(2,2),new $o({name:"BackgroundMaterial",uniforms:j_(r1.background.uniforms),vertexShader:r1.background.vertexShader,fragmentShader:r1.background.fragmentShader,side:c1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=ie,p.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,p.material.toneMapped=Yr.getTransfer(ie.colorSpace)!==xs,ie.matrixAutoUpdate===!0&&ie.updateMatrix(),p.material.uniforms.uvTransform.value.copy(ie.matrix),(x!==ie||S!==ie.version||A!==s.toneMapping)&&(p.material.needsUpdate=!0,x=ie,S=ie.version,A=s.toneMapping),p.layers.enableAll(),Z.unshift(p,p.geometry,p.material,0,0,null))}function P(Z,I){Z.getRGB(IR,X9e(s)),n.buffers.color.setClear(IR.r,IR.g,IR.b,I,o)}function $(){y!==void 0&&(y.geometry.dispose(),y.material.dispose(),y=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return l},setClearColor:function(Z,I=1){l.set(Z),h=I,P(l,h)},getClearAlpha:function(){return h},setClearAlpha:function(Z){h=Z,P(l,h)},render:L,addToRenderList:U,dispose:$}}function MRe(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},r=S(null);let i=r,o=!1;function l(le,J,Be,He,rt){let ot=!1;const Se=x(He,Be,J);i!==Se&&(i=Se,p(i.object)),ot=A(le,He,Be,rt),ot&&k(le,He,Be,rt),rt!==null&&e.update(rt,s.ELEMENT_ARRAY_BUFFER),(ot||o)&&(o=!1,I(le,J,Be,He),rt!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(rt).buffer))}function h(){return s.createVertexArray()}function p(le){return s.bindVertexArray(le)}function y(le){return s.deleteVertexArray(le)}function x(le,J,Be){const He=Be.wireframe===!0;let rt=n[le.id];rt===void 0&&(rt={},n[le.id]=rt);let ot=rt[J.id];ot===void 0&&(ot={},rt[J.id]=ot);let Se=ot[He];return Se===void 0&&(Se=S(h()),ot[He]=Se),Se}function S(le){const J=[],Be=[],He=[];for(let rt=0;rt<t;rt++)J[rt]=0,Be[rt]=0,He[rt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:J,enabledAttributes:Be,attributeDivisors:He,object:le,attributes:{},index:null}}function A(le,J,Be,He){const rt=i.attributes,ot=J.attributes;let Se=0;const gt=Be.getAttributes();for(const Ae in gt)if(gt[Ae].location>=0){const pt=rt[Ae];let De=ot[Ae];if(De===void 0&&(Ae==="instanceMatrix"&&le.instanceMatrix&&(De=le.instanceMatrix),Ae==="instanceColor"&&le.instanceColor&&(De=le.instanceColor)),pt===void 0||pt.attribute!==De||De&&pt.data!==De.data)return!0;Se++}return i.attributesNum!==Se||i.index!==He}function k(le,J,Be,He){const rt={},ot=J.attributes;let Se=0;const gt=Be.getAttributes();for(const Ae in gt)if(gt[Ae].location>=0){let pt=ot[Ae];pt===void 0&&(Ae==="instanceMatrix"&&le.instanceMatrix&&(pt=le.instanceMatrix),Ae==="instanceColor"&&le.instanceColor&&(pt=le.instanceColor));const De={};De.attribute=pt,pt&&pt.data&&(De.data=pt.data),rt[Ae]=De,Se++}i.attributes=rt,i.attributesNum=Se,i.index=He}function L(){const le=i.newAttributes;for(let J=0,Be=le.length;J<Be;J++)le[J]=0}function U(le){P(le,0)}function P(le,J){const Be=i.newAttributes,He=i.enabledAttributes,rt=i.attributeDivisors;Be[le]=1,He[le]===0&&(s.enableVertexAttribArray(le),He[le]=1),rt[le]!==J&&(s.vertexAttribDivisor(le,J),rt[le]=J)}function $(){const le=i.newAttributes,J=i.enabledAttributes;for(let Be=0,He=J.length;Be<He;Be++)J[Be]!==le[Be]&&(s.disableVertexAttribArray(Be),J[Be]=0)}function Z(le,J,Be,He,rt,ot,Se){Se===!0?s.vertexAttribIPointer(le,J,Be,rt,ot):s.vertexAttribPointer(le,J,Be,He,rt,ot)}function I(le,J,Be,He){L();const rt=He.attributes,ot=Be.getAttributes(),Se=J.defaultAttributeValues;for(const gt in ot){const Ae=ot[gt];if(Ae.location>=0){let lt=rt[gt];if(lt===void 0&&(gt==="instanceMatrix"&&le.instanceMatrix&&(lt=le.instanceMatrix),gt==="instanceColor"&&le.instanceColor&&(lt=le.instanceColor)),lt!==void 0){const pt=lt.normalized,De=lt.itemSize,_t=e.get(lt);if(_t===void 0)continue;const Jt=_t.buffer,dt=_t.type,Dt=_t.bytesPerElement,gn=dt===s.INT||dt===s.UNSIGNED_INT||lt.gpuType===Oj;if(lt.isInterleavedBufferAttribute){const qt=lt.data,wn=qt.stride,rr=lt.offset;if(qt.isInstancedInterleavedBuffer){for(let Xn=0;Xn<Ae.locationSize;Xn++)P(Ae.location+Xn,qt.meshPerAttribute);le.isInstancedMesh!==!0&&He._maxInstanceCount===void 0&&(He._maxInstanceCount=qt.meshPerAttribute*qt.count)}else for(let Xn=0;Xn<Ae.locationSize;Xn++)U(Ae.location+Xn);s.bindBuffer(s.ARRAY_BUFFER,Jt);for(let Xn=0;Xn<Ae.locationSize;Xn++)Z(Ae.location+Xn,De/Ae.locationSize,dt,pt,wn*Dt,(rr+De/Ae.locationSize*Xn)*Dt,gn)}else{if(lt.isInstancedBufferAttribute){for(let qt=0;qt<Ae.locationSize;qt++)P(Ae.location+qt,lt.meshPerAttribute);le.isInstancedMesh!==!0&&He._maxInstanceCount===void 0&&(He._maxInstanceCount=lt.meshPerAttribute*lt.count)}else for(let qt=0;qt<Ae.locationSize;qt++)U(Ae.location+qt);s.bindBuffer(s.ARRAY_BUFFER,Jt);for(let qt=0;qt<Ae.locationSize;qt++)Z(Ae.location+qt,De/Ae.locationSize,dt,pt,De*Dt,De/Ae.locationSize*qt*Dt,gn)}}else if(Se!==void 0){const pt=Se[gt];if(pt!==void 0)switch(pt.length){case 2:s.vertexAttrib2fv(Ae.location,pt);break;case 3:s.vertexAttrib3fv(Ae.location,pt);break;case 4:s.vertexAttrib4fv(Ae.location,pt);break;default:s.vertexAttrib1fv(Ae.location,pt)}}}}$()}function ie(){Q();for(const le in n){const J=n[le];for(const Be in J){const He=J[Be];for(const rt in He)y(He[rt].object),delete He[rt];delete J[Be]}delete n[le]}}function ce(le){if(n[le.id]===void 0)return;const J=n[le.id];for(const Be in J){const He=J[Be];for(const rt in He)y(He[rt].object),delete He[rt];delete J[Be]}delete n[le.id]}function ue(le){for(const J in n){const Be=n[J];if(Be[le.id]===void 0)continue;const He=Be[le.id];for(const rt in He)y(He[rt].object),delete He[rt];delete Be[le.id]}}function Q(){oe(),o=!0,i!==r&&(i=r,p(i.object))}function oe(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:l,reset:Q,resetDefaultState:oe,dispose:ie,releaseStatesOfGeometry:ce,releaseStatesOfProgram:ue,initAttributes:L,enableAttribute:U,disableUnusedAttributes:$}}function CRe(s,e,t){let n;function r(p){n=p}function i(p,y){s.drawArrays(n,p,y),t.update(y,n,1)}function o(p,y,x){x!==0&&(s.drawArraysInstanced(n,p,y,x),t.update(y,n,x))}function l(p,y,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,y,0,x);let A=0;for(let k=0;k<x;k++)A+=y[k];t.update(A,n,1)}function h(p,y,x,S){if(x===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let k=0;k<p.length;k++)o(p[k],y[k],S[k]);else{A.multiDrawArraysInstancedWEBGL(n,p,0,y,0,S,0,x);let k=0;for(let L=0;L<x;L++)k+=y[L]*S[L];t.update(k,n,1)}}this.setMode=r,this.render=i,this.renderInstances=o,this.renderMultiDraw=l,this.renderMultiDrawInstances=h}function ARe(s,e,t,n){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const ue=e.get("EXT_texture_filter_anisotropic");r=s.getParameter(ue.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(ue){return!(ue!==K0&&n.convert(ue)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(ue){const Q=ue===t4&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(ue!==jo&&n.convert(ue)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&ue!==Lh&&!Q)}function h(ue){if(ue==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";ue="mediump"}return ue==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const y=h(p);y!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",y,"instead."),p=y);const x=t.logarithmicDepthBuffer===!0,S=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),A=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),k=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),L=s.getParameter(s.MAX_TEXTURE_SIZE),U=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),P=s.getParameter(s.MAX_VERTEX_ATTRIBS),$=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),Z=s.getParameter(s.MAX_VARYING_VECTORS),I=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),ie=k>0,ce=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:i,getMaxPrecision:h,textureFormatReadable:o,textureTypeReadable:l,precision:p,logarithmicDepthBuffer:x,reverseDepthBuffer:S,maxTextures:A,maxVertexTextures:k,maxTextureSize:L,maxCubemapSize:U,maxAttributes:P,maxVertexUniforms:$,maxVaryings:Z,maxFragmentUniforms:I,vertexTextures:ie,maxSamples:ce}}function PRe(s){const e=this;let t=null,n=0,r=!1,i=!1;const o=new H3,l=new ci,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(x,S){const A=x.length!==0||S||n!==0||r;return r=S,n=x.length,A},this.beginShadows=function(){i=!0,y(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(x,S){t=y(x,S,0)},this.setState=function(x,S,A){const k=x.clippingPlanes,L=x.clipIntersection,U=x.clipShadows,P=s.get(x);if(!r||k===null||k.length===0||i&&!U)i?y(null):p();else{const $=i?0:n,Z=$*4;let I=P.clippingState||null;h.value=I,I=y(k,S,Z,A);for(let ie=0;ie!==Z;++ie)I[ie]=t[ie];P.clippingState=I,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=$}};function p(){h.value!==t&&(h.value=t,h.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function y(x,S,A,k){const L=x!==null?x.length:0;let U=null;if(L!==0){if(U=h.value,k!==!0||U===null){const P=A+L*4,$=S.matrixWorldInverse;l.getNormalMatrix($),(U===null||U.length<P)&&(U=new Float32Array(P));for(let Z=0,I=A;Z!==L;++Z,I+=4)o.copy(x[Z]).applyMatrix4($,l),o.normal.toArray(U,I),U[I+3]=o.constant}h.value=U,h.needsUpdate=!0}return e.numPlanes=L,e.numIntersection=0,U}}function RRe(s){let e=new WeakMap;function t(o,l){return l===$I?o.mapping=B_:l===ZG&&(o.mapping=z_),o}function n(o){if(o&&o.isTexture){const l=o.mapping;if(l===$I||l===ZG)if(e.has(o)){const h=e.get(o).texture;return t(h,o.mapping)}else{const h=o.image;if(h&&h.height>0){const p=new AMe(h.height);return p.fromEquirectangularTexture(s,o),e.set(o,p),o.addEventListener("dispose",r),t(p.texture,o.mapping)}else return null}}return o}function r(o){const l=o.target;l.removeEventListener("dispose",r);const h=e.get(l);h!==void 0&&(e.delete(l),h.dispose())}function i(){e=new WeakMap}return{get:n,dispose:i}}const v_=4,Y1e=[.125,.215,.35,.446,.526,.582],fv=20,Qz=new q_,K1e=new Vn;let Jz=null,eV=0,tV=0,nV=!1;const sv=(1+Math.sqrt(5))/2,U7=1/sv,Z1e=[new ke(-sv,U7,0),new ke(sv,U7,0),new ke(-U7,0,sv),new ke(U7,0,sv),new ke(0,sv,-U7),new ke(0,sv,U7),new ke(-1,1,-1),new ke(1,1,-1),new ke(-1,1,1),new ke(1,1,1)],IRe=new ke;let Q1e=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100,i={}){const{size:o=256,position:l=IRe}=i;Jz=this._renderer.getRenderTarget(),eV=this._renderer.getActiveCubeFace(),tV=this._renderer.getActiveMipmapLevel(),nV=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const h=this._allocateTargets();return h.depthBuffer=!0,this._sceneToCubeUV(e,n,r,h,l),t>0&&this._blur(h,0,0,t),this._applyPMREM(h),this._cleanup(h),h}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=tme(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=eme(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Jz,eV,tV),this._renderer.xr.enabled=nV,e.scissorTest=!1,kR(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===B_||e.mapping===z_?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Jz=this._renderer.getRenderTarget(),eV=this._renderer.getActiveCubeFace(),tV=this._renderer.getActiveMipmapLevel(),nV=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ho,minFilter:Ho,generateMipmaps:!1,type:t4,format:K0,colorSpace:kc,depthBuffer:!1},r=J1e(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=J1e(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=kRe(i)),this._blurMaterial=NRe(i,e,t)}return r}_compileMaterial(e){const t=new Mn(this._lodPlanes[0],e);this._renderer.compile(t,Qz)}_sceneToCubeUV(e,t,n,r,i){const h=new Go(90,1,t,n),p=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],x=this._renderer,S=x.autoClear,A=x.toneMapping;x.getClearColor(K1e),x.toneMapping=o1,x.autoClear=!1;const k=new Nc({name:"PMREM.Background",side:qa,depthWrite:!1,depthTest:!1}),L=new Mn(new xo,k);let U=!1;const P=e.background;P?P.isColor&&(k.color.copy(P),e.background=null,U=!0):(k.color.copy(K1e),U=!0);for(let $=0;$<6;$++){const Z=$%3;Z===0?(h.up.set(0,p[$],0),h.position.set(i.x,i.y,i.z),h.lookAt(i.x+y[$],i.y,i.z)):Z===1?(h.up.set(0,0,p[$]),h.position.set(i.x,i.y,i.z),h.lookAt(i.x,i.y+y[$],i.z)):(h.up.set(0,p[$],0),h.position.set(i.x,i.y,i.z),h.lookAt(i.x,i.y,i.z+y[$]));const I=this._cubeSize;kR(r,Z*I,$>2?I:0,I,I),x.setRenderTarget(r),U&&x.render(L,h),x.render(e,h)}L.geometry.dispose(),L.material.dispose(),x.toneMapping=A,x.autoClear=S,e.background=P}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===B_||e.mapping===z_;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=tme()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=eme());const i=r?this._cubemapMaterial:this._equirectMaterial,o=new Mn(this._lodPlanes[0],i),l=i.uniforms;l.envMap.value=e;const h=this._cubeSize;kR(t,0,0,3*h,2*h),n.setRenderTarget(t),n.render(o,Qz)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const o=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),l=Z1e[(r-i-1)%Z1e.length];this._blur(e,i-1,i,o,l)}t.autoClear=n}_blur(e,t,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,o,l){const h=this._renderer,p=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const y=3,x=new Mn(this._lodPlanes[r],p),S=p.uniforms,A=this._sizeLods[n]-1,k=isFinite(i)?Math.PI/(2*A):2*Math.PI/(2*fv-1),L=i/k,U=isFinite(i)?1+Math.floor(y*L):fv;U>fv&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${U} samples when the maximum is set to ${fv}`);const P=[];let $=0;for(let ue=0;ue<fv;++ue){const Q=ue/L,oe=Math.exp(-Q*Q/2);P.push(oe),ue===0?$+=oe:ue<U&&($+=2*oe)}for(let ue=0;ue<P.length;ue++)P[ue]=P[ue]/$;S.envMap.value=e.texture,S.samples.value=U,S.weights.value=P,S.latitudinal.value=o==="latitudinal",l&&(S.poleAxis.value=l);const{_lodMax:Z}=this;S.dTheta.value=k,S.mipInt.value=Z-n;const I=this._sizeLods[r],ie=3*I*(r>Z-v_?r-Z+v_:0),ce=4*(this._cubeSize-I);kR(t,ie,ce,3*I,2*I),h.setRenderTarget(t),h.render(x,Qz)}};function kRe(s){const e=[],t=[],n=[];let r=s;const i=s-v_+1+Y1e.length;for(let o=0;o<i;o++){const l=Math.pow(2,r);t.push(l);let h=1/l;o>s-v_?h=Y1e[o-s+v_-1]:o===0&&(h=0),n.push(h);const p=1/(l-2),y=-p,x=1+p,S=[y,y,x,y,x,x,y,y,x,x,y,x],A=6,k=6,L=3,U=2,P=1,$=new Float32Array(L*k*A),Z=new Float32Array(U*k*A),I=new Float32Array(P*k*A);for(let ce=0;ce<A;ce++){const ue=ce%3*2/3-1,Q=ce>2?0:-1,oe=[ue,Q,0,ue+2/3,Q,0,ue+2/3,Q+1,0,ue,Q,0,ue+2/3,Q+1,0,ue,Q+1,0];$.set(oe,L*k*ce),Z.set(S,U*k*ce);const le=[ce,ce,ce,ce,ce,ce];I.set(le,P*k*ce)}const ie=new ts;ie.setAttribute("position",new Ic($,L)),ie.setAttribute("uv",new Ic(Z,U)),ie.setAttribute("faceIndex",new Ic(I,P)),e.push(ie),r>v_&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function J1e(s,e,t){const n=new J0(s,e,t);return n.texture.mapping=Ak,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function kR(s,e,t,n,r){s.viewport.set(e,t,n,r),s.scissor.set(e,t,n,r)}function NRe(s,e,t){const n=new Float32Array(fv),r=new ke(0,1,0);return new $o({name:"SphericalGaussianBlur",defines:{n:fv,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:aW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Gl,depthTest:!1,depthWrite:!1})}function eme(){return new $o({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:aW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Gl,depthTest:!1,depthWrite:!1})}function tme(){return new $o({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:aW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Gl,depthTest:!1,depthWrite:!1})}function aW(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function DRe(s){let e=new WeakMap,t=null;function n(l){if(l&&l.isTexture){const h=l.mapping,p=h===$I||h===ZG,y=h===B_||h===z_;if(p||y){let x=e.get(l);const S=x!==void 0?x.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==S)return t===null&&(t=new Q1e(s)),x=p?t.fromEquirectangular(l,x):t.fromCubemap(l,x),x.texture.pmremVersion=l.pmremVersion,e.set(l,x),x.texture;if(x!==void 0)return x.texture;{const A=l.image;return p&&A&&A.height>0||y&&A&&r(A)?(t===null&&(t=new Q1e(s)),x=p?t.fromEquirectangular(l):t.fromCubemap(l),x.texture.pmremVersion=l.pmremVersion,e.set(l,x),l.addEventListener("dispose",i),x.texture):null}}}return l}function r(l){let h=0;const p=6;for(let y=0;y<p;y++)l[y]!==void 0&&h++;return h===p}function i(l){const h=l.target;h.removeEventListener("dispose",i);const p=e.get(h);p!==void 0&&(e.delete(h),p.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function ORe(s){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=s.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&C_("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function FRe(s,e,t,n){const r={},i=new WeakMap;function o(x){const S=x.target;S.index!==null&&e.remove(S.index);for(const k in S.attributes)e.remove(S.attributes[k]);S.removeEventListener("dispose",o),delete r[S.id];const A=i.get(S);A&&(e.remove(A),i.delete(S)),n.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,t.memory.geometries--}function l(x,S){return r[S.id]===!0||(S.addEventListener("dispose",o),r[S.id]=!0,t.memory.geometries++),S}function h(x){const S=x.attributes;for(const A in S)e.update(S[A],s.ARRAY_BUFFER)}function p(x){const S=[],A=x.index,k=x.attributes.position;let L=0;if(A!==null){const $=A.array;L=A.version;for(let Z=0,I=$.length;Z<I;Z+=3){const ie=$[Z+0],ce=$[Z+1],ue=$[Z+2];S.push(ie,ce,ce,ue,ue,ie)}}else if(k!==void 0){const $=k.array;L=k.version;for(let Z=0,I=$.length/3-1;Z<I;Z+=3){const ie=Z+0,ce=Z+1,ue=Z+2;S.push(ie,ce,ce,ue,ue,ie)}}else return;const U=new(B9e(S)?W9e:Wj)(S,1);U.version=L;const P=i.get(x);P&&e.remove(P),i.set(x,U)}function y(x){const S=i.get(x);if(S){const A=x.index;A!==null&&S.version<A.version&&p(x)}else p(x);return i.get(x)}return{get:l,update:h,getWireframeAttribute:y}}function LRe(s,e,t){let n;function r(S){n=S}let i,o;function l(S){i=S.type,o=S.bytesPerElement}function h(S,A){s.drawElements(n,A,i,S*o),t.update(A,n,1)}function p(S,A,k){k!==0&&(s.drawElementsInstanced(n,A,i,S*o,k),t.update(A,n,k))}function y(S,A,k){if(k===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,A,0,i,S,0,k);let U=0;for(let P=0;P<k;P++)U+=A[P];t.update(U,n,1)}function x(S,A,k,L){if(k===0)return;const U=e.get("WEBGL_multi_draw");if(U===null)for(let P=0;P<S.length;P++)p(S[P]/o,A[P],L[P]);else{U.multiDrawElementsInstancedWEBGL(n,A,0,i,S,0,L,0,k);let P=0;for(let $=0;$<k;$++)P+=A[$]*L[$];t.update(P,n,1)}}this.setMode=r,this.setIndex=l,this.render=h,this.renderInstances=p,this.renderMultiDraw=y,this.renderMultiDrawInstances=x}function URe(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(i,o,l){switch(t.calls++,o){case s.TRIANGLES:t.triangles+=l*(i/3);break;case s.LINES:t.lines+=l*(i/2);break;case s.LINE_STRIP:t.lines+=l*(i-1);break;case s.LINE_LOOP:t.lines+=l*i;break;case s.POINTS:t.points+=l*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function BRe(s,e,t){const n=new WeakMap,r=new Ti;function i(o,l,h){const p=o.morphTargetInfluences,y=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,x=y!==void 0?y.length:0;let S=n.get(l);if(S===void 0||S.count!==x){let le=function(){Q.dispose(),n.delete(l),l.removeEventListener("dispose",le)};var A=le;S!==void 0&&S.texture.dispose();const k=l.morphAttributes.position!==void 0,L=l.morphAttributes.normal!==void 0,U=l.morphAttributes.color!==void 0,P=l.morphAttributes.position||[],$=l.morphAttributes.normal||[],Z=l.morphAttributes.color||[];let I=0;k===!0&&(I=1),L===!0&&(I=2),U===!0&&(I=3);let ie=l.attributes.position.count*I,ce=1;ie>e.maxTextureSize&&(ce=Math.ceil(ie/e.maxTextureSize),ie=e.maxTextureSize);const ue=new Float32Array(ie*ce*4*x),Q=new G9e(ue,ie,ce,x);Q.type=Lh,Q.needsUpdate=!0;const oe=I*4;for(let J=0;J<x;J++){const Be=P[J],He=$[J],rt=Z[J],ot=ie*ce*4*J;for(let Se=0;Se<Be.count;Se++){const gt=Se*oe;k===!0&&(r.fromBufferAttribute(Be,Se),ue[ot+gt+0]=r.x,ue[ot+gt+1]=r.y,ue[ot+gt+2]=r.z,ue[ot+gt+3]=0),L===!0&&(r.fromBufferAttribute(He,Se),ue[ot+gt+4]=r.x,ue[ot+gt+5]=r.y,ue[ot+gt+6]=r.z,ue[ot+gt+7]=0),U===!0&&(r.fromBufferAttribute(rt,Se),ue[ot+gt+8]=r.x,ue[ot+gt+9]=r.y,ue[ot+gt+10]=r.z,ue[ot+gt+11]=rt.itemSize===4?r.w:1)}}S={count:x,texture:Q,size:new zn(ie,ce)},n.set(l,S),l.addEventListener("dispose",le)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)h.getUniforms().setValue(s,"morphTexture",o.morphTexture,t);else{let k=0;for(let U=0;U<p.length;U++)k+=p[U];const L=l.morphTargetsRelative?1:1-k;h.getUniforms().setValue(s,"morphTargetBaseInfluence",L),h.getUniforms().setValue(s,"morphTargetInfluences",p)}h.getUniforms().setValue(s,"morphTargetsTexture",S.texture,t),h.getUniforms().setValue(s,"morphTargetsTextureSize",S.size)}return{update:i}}function zRe(s,e,t,n){let r=new WeakMap;function i(h){const p=n.render.frame,y=h.geometry,x=e.get(h,y);if(r.get(x)!==p&&(e.update(x),r.set(x,p)),h.isInstancedMesh&&(h.hasEventListener("dispose",l)===!1&&h.addEventListener("dispose",l),r.get(h)!==p&&(t.update(h.instanceMatrix,s.ARRAY_BUFFER),h.instanceColor!==null&&t.update(h.instanceColor,s.ARRAY_BUFFER),r.set(h,p))),h.isSkinnedMesh){const S=h.skeleton;r.get(S)!==p&&(S.update(),r.set(S,p))}return x}function o(){r=new WeakMap}function l(h){const p=h.target;p.removeEventListener("dispose",l),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:i,dispose:o}}const v3e=new Wo,nme=new Kj(1,1),y3e=new G9e,_3e=new lMe,x3e=new $j,rme=[],ime=[],sme=new Float32Array(16),ame=new Float32Array(9),ome=new Float32Array(4);function cx(s,e,t){const n=s[0];if(n<=0||n>0)return s;const r=e*t;let i=rme[r];if(i===void 0&&(i=new Float32Array(r),rme[r]=i),e!==0){n.toArray(i,0);for(let o=1,l=0;o!==e;++o)l+=t,s[o].toArray(i,l)}return i}function Eo(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function To(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function kk(s,e){let t=ime[e];t===void 0&&(t=new Int32Array(e),ime[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function VRe(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function GRe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Eo(t,e))return;s.uniform2fv(this.addr,e),To(t,e)}}function HRe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Eo(t,e))return;s.uniform3fv(this.addr,e),To(t,e)}}function jRe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Eo(t,e))return;s.uniform4fv(this.addr,e),To(t,e)}}function WRe(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Eo(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),To(t,e)}else{if(Eo(t,n))return;ome.set(n),s.uniformMatrix2fv(this.addr,!1,ome),To(t,n)}}function $Re(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Eo(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),To(t,e)}else{if(Eo(t,n))return;ame.set(n),s.uniformMatrix3fv(this.addr,!1,ame),To(t,n)}}function qRe(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Eo(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),To(t,e)}else{if(Eo(t,n))return;sme.set(n),s.uniformMatrix4fv(this.addr,!1,sme),To(t,n)}}function XRe(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function YRe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Eo(t,e))return;s.uniform2iv(this.addr,e),To(t,e)}}function KRe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Eo(t,e))return;s.uniform3iv(this.addr,e),To(t,e)}}function ZRe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Eo(t,e))return;s.uniform4iv(this.addr,e),To(t,e)}}function QRe(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function JRe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Eo(t,e))return;s.uniform2uiv(this.addr,e),To(t,e)}}function eIe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Eo(t,e))return;s.uniform3uiv(this.addr,e),To(t,e)}}function tIe(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Eo(t,e))return;s.uniform4uiv(this.addr,e),To(t,e)}}function nIe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r);let i;this.type===s.SAMPLER_2D_SHADOW?(nme.compareFunction=O9e,i=nme):i=v3e,t.setTexture2D(e||i,r)}function rIe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||_3e,r)}function iIe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||x3e,r)}function sIe(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||y3e,r)}function aIe(s){switch(s){case 5126:return VRe;case 35664:return GRe;case 35665:return HRe;case 35666:return jRe;case 35674:return WRe;case 35675:return $Re;case 35676:return qRe;case 5124:case 35670:return XRe;case 35667:case 35671:return YRe;case 35668:case 35672:return KRe;case 35669:case 35673:return ZRe;case 5125:return QRe;case 36294:return JRe;case 36295:return eIe;case 36296:return tIe;case 35678:case 36198:case 36298:case 36306:case 35682:return nIe;case 35679:case 36299:case 36307:return rIe;case 35680:case 36300:case 36308:case 36293:return iIe;case 36289:case 36303:case 36311:case 36292:return sIe}}function oIe(s,e){s.uniform1fv(this.addr,e)}function lIe(s,e){const t=cx(e,this.size,2);s.uniform2fv(this.addr,t)}function uIe(s,e){const t=cx(e,this.size,3);s.uniform3fv(this.addr,t)}function cIe(s,e){const t=cx(e,this.size,4);s.uniform4fv(this.addr,t)}function hIe(s,e){const t=cx(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function dIe(s,e){const t=cx(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function fIe(s,e){const t=cx(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function pIe(s,e){s.uniform1iv(this.addr,e)}function mIe(s,e){s.uniform2iv(this.addr,e)}function gIe(s,e){s.uniform3iv(this.addr,e)}function vIe(s,e){s.uniform4iv(this.addr,e)}function yIe(s,e){s.uniform1uiv(this.addr,e)}function _Ie(s,e){s.uniform2uiv(this.addr,e)}function xIe(s,e){s.uniform3uiv(this.addr,e)}function bIe(s,e){s.uniform4uiv(this.addr,e)}function SIe(s,e,t){const n=this.cache,r=e.length,i=kk(t,r);Eo(n,i)||(s.uniform1iv(this.addr,i),To(n,i));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||v3e,i[o])}function wIe(s,e,t){const n=this.cache,r=e.length,i=kk(t,r);Eo(n,i)||(s.uniform1iv(this.addr,i),To(n,i));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||_3e,i[o])}function EIe(s,e,t){const n=this.cache,r=e.length,i=kk(t,r);Eo(n,i)||(s.uniform1iv(this.addr,i),To(n,i));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||x3e,i[o])}function TIe(s,e,t){const n=this.cache,r=e.length,i=kk(t,r);Eo(n,i)||(s.uniform1iv(this.addr,i),To(n,i));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||y3e,i[o])}function MIe(s){switch(s){case 5126:return oIe;case 35664:return lIe;case 35665:return uIe;case 35666:return cIe;case 35674:return hIe;case 35675:return dIe;case 35676:return fIe;case 5124:case 35670:return pIe;case 35667:case 35671:return mIe;case 35668:case 35672:return gIe;case 35669:case 35673:return vIe;case 5125:return yIe;case 36294:return _Ie;case 36295:return xIe;case 36296:return bIe;case 35678:case 36198:case 36298:case 36306:case 35682:return SIe;case 35679:case 36299:case 36307:return wIe;case 35680:case 36300:case 36308:case 36293:return EIe;case 36289:case 36303:case 36311:case 36292:return TIe}}class CIe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=aIe(t.type)}}class AIe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=MIe(t.type)}}class PIe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const l=r[i];l.setValue(e,t[l.id],n)}}}const rV=/(\w+)(\])?(\[|\.)?/g;function lme(s,e){s.seq.push(e),s.map[e.id]=e}function RIe(s,e,t){const n=s.name,r=n.length;for(rV.lastIndex=0;;){const i=rV.exec(n),o=rV.lastIndex;let l=i[1];const h=i[2]==="]",p=i[3];if(h&&(l=l|0),p===void 0||p==="["&&o+2===r){lme(t,p===void 0?new CIe(l,s,e):new AIe(l,s,e));break}else{let x=t.map[l];x===void 0&&(x=new PIe(l),lme(t,x)),t=x}}}class NI{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const i=e.getActiveUniform(t,r),o=e.getUniformLocation(t,i.name);RIe(i,o,this)}}setValue(e,t,n,r){const i=this.map[t];i!==void 0&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,o=t.length;i!==o;++i){const l=t[i],h=n[l.id];h.needsUpdate!==!1&&l.setValue(e,h.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function ume(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const IIe=37297;let kIe=0;function NIe(s,e){const t=s.split(`
`),n=[],r=Math.max(e-6,0),i=Math.min(e+6,t.length);for(let o=r;o<i;o++){const l=o+1;n.push(`${l===e?">":" "} ${l}: ${t[o]}`)}return n.join(`
`)}const cme=new ci;function DIe(s){Yr._getMatrix(cme,Yr.workingColorSpace,s);const e=`mat3( ${cme.elements.map(t=>t.toFixed(4))} )`;switch(Yr.getTransfer(s)){case YI:return[e,"LinearTransferOETF"];case xs:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",s),[e,"LinearTransferOETF"]}}function hme(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),r=s.getShaderInfoLog(e).trim();if(n&&r==="")return"";const i=/ERROR: 0:(\d+)/.exec(r);if(i){const o=parseInt(i[1]);return t.toUpperCase()+`

`+r+`

`+NIe(s.getShaderSource(e),o)}else return r}function OIe(s,e){const t=DIe(e);return[`vec4 ${s}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function FIe(s,e){let t;switch(e){case x9e:t="Linear";break;case b9e:t="Reinhard";break;case S9e:t="Cineon";break;case w9e:t="ACESFilmic";break;case T9e:t="AgX";break;case M9e:t="Neutral";break;case E9e:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const NR=new ke;function LIe(){Yr.getLuminanceCoefficients(NR);const s=NR.x.toFixed(4),e=NR.y.toFixed(4),t=NR.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${s}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function UIe(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Qw).join(`
`)}function BIe(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function zIe(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const i=s.getActiveAttrib(e,r),o=i.name;let l=1;i.type===s.FLOAT_MAT2&&(l=2),i.type===s.FLOAT_MAT3&&(l=3),i.type===s.FLOAT_MAT4&&(l=4),t[o]={type:i.type,location:s.getAttribLocation(e,o),locationSize:l}}return t}function Qw(s){return s!==""}function dme(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function fme(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const VIe=/^[ \t]*#include +<([\w\d./]+)>/gm;function OH(s){return s.replace(VIe,HIe)}const GIe=new Map;function HIe(s,e){let t=fi[e];if(t===void 0){const n=GIe.get(e);if(n!==void 0)t=fi[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return OH(t)}const jIe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pme(s){return s.replace(jIe,WIe)}function WIe(s,e,t,n){let r="";for(let i=parseInt(e);i<parseInt(t);i++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return r}function mme(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function $Ie(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===f9e?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===xTe?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===bg&&(e="SHADOWMAP_TYPE_VSM"),e}function qIe(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case B_:case z_:e="ENVMAP_TYPE_CUBE";break;case Ak:e="ENVMAP_TYPE_CUBE_UV";break}return e}function XIe(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case z_:e="ENVMAP_MODE_REFRACTION";break}return e}function YIe(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case Ck:e="ENVMAP_BLENDING_MULTIPLY";break;case bTe:e="ENVMAP_BLENDING_MIX";break;case STe:e="ENVMAP_BLENDING_ADD";break}return e}function KIe(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function ZIe(s,e,t,n){const r=s.getContext(),i=t.defines;let o=t.vertexShader,l=t.fragmentShader;const h=$Ie(t),p=qIe(t),y=XIe(t),x=YIe(t),S=KIe(t),A=UIe(t),k=BIe(i),L=r.createProgram();let U,P,$=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(U=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,k].filter(Qw).join(`
`),U.length>0&&(U+=`
`),P=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,k].filter(Qw).join(`
`),P.length>0&&(P+=`
`)):(U=[mme(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,k,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Qw).join(`
`),P=[mme(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,k,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+y:"",t.envMap?"#define "+x:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==o1?"#define TONE_MAPPING":"",t.toneMapping!==o1?fi.tonemapping_pars_fragment:"",t.toneMapping!==o1?FIe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",fi.colorspace_pars_fragment,OIe("linearToOutputTexel",t.outputColorSpace),LIe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Qw).join(`
`)),o=OH(o),o=dme(o,t),o=fme(o,t),l=OH(l),l=dme(l,t),l=fme(l,t),o=pme(o),l=pme(l),t.isRawShaderMaterial!==!0&&($=`#version 300 es
`,U=[A,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+U,P=["#define varying in",t.glslVersion===MH?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===MH?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+P);const Z=$+U+o,I=$+P+l,ie=ume(r,r.VERTEX_SHADER,Z),ce=ume(r,r.FRAGMENT_SHADER,I);r.attachShader(L,ie),r.attachShader(L,ce),t.index0AttributeName!==void 0?r.bindAttribLocation(L,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(L,0,"position"),r.linkProgram(L);function ue(J){if(s.debug.checkShaderErrors){const Be=r.getProgramInfoLog(L).trim(),He=r.getShaderInfoLog(ie).trim(),rt=r.getShaderInfoLog(ce).trim();let ot=!0,Se=!0;if(r.getProgramParameter(L,r.LINK_STATUS)===!1)if(ot=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(r,L,ie,ce);else{const gt=hme(r,ie,"vertex"),Ae=hme(r,ce,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(L,r.VALIDATE_STATUS)+`

Material Name: `+J.name+`
Material Type: `+J.type+`

Program Info Log: `+Be+`
`+gt+`
`+Ae)}else Be!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Be):(He===""||rt==="")&&(Se=!1);Se&&(J.diagnostics={runnable:ot,programLog:Be,vertexShader:{log:He,prefix:U},fragmentShader:{log:rt,prefix:P}})}r.deleteShader(ie),r.deleteShader(ce),Q=new NI(r,L),oe=zIe(r,L)}let Q;this.getUniforms=function(){return Q===void 0&&ue(this),Q};let oe;this.getAttributes=function(){return oe===void 0&&ue(this),oe};let le=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return le===!1&&(le=r.getProgramParameter(L,IIe)),le},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(L),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=kIe++,this.cacheKey=e,this.usedTimes=1,this.program=L,this.vertexShader=ie,this.fragmentShader=ce,this}let QIe=0;class JIe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(i)===!1&&(o.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new eke(e),t.set(e,n)),n}}class eke{constructor(e){this.id=QIe++,this.code=e,this.usedTimes=0}}function tke(s,e,t,n,r,i,o){const l=new jj,h=new JIe,p=new Set,y=[],x=r.logarithmicDepthBuffer,S=r.vertexTextures;let A=r.precision;const k={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(oe){return p.add(oe),oe===0?"uv":`uv${oe}`}function U(oe,le,J,Be,He){const rt=Be.fog,ot=He.geometry,Se=oe.isMeshStandardMaterial?Be.environment:null,gt=(oe.isMeshStandardMaterial?t:e).get(oe.envMap||Se),Ae=gt&&gt.mapping===Ak?gt.image.height:null,lt=k[oe.type];oe.precision!==null&&(A=r.getMaxPrecision(oe.precision),A!==oe.precision&&console.warn("THREE.WebGLProgram.getParameters:",oe.precision,"not supported, using",A,"instead."));const pt=ot.morphAttributes.position||ot.morphAttributes.normal||ot.morphAttributes.color,De=pt!==void 0?pt.length:0;let _t=0;ot.morphAttributes.position!==void 0&&(_t=1),ot.morphAttributes.normal!==void 0&&(_t=2),ot.morphAttributes.color!==void 0&&(_t=3);let Jt,dt,Dt,gn;if(lt){const Kr=r1[lt];Jt=Kr.vertexShader,dt=Kr.fragmentShader}else Jt=oe.vertexShader,dt=oe.fragmentShader,h.update(oe),Dt=h.getVertexShaderID(oe),gn=h.getFragmentShaderID(oe);const qt=s.getRenderTarget(),wn=s.state.buffers.depth.getReversed(),rr=He.isInstancedMesh===!0,Xn=He.isBatchedMesh===!0,ni=!!oe.map,oi=!!oe.matcap,$r=!!gt,$e=!!oe.aoMap,zs=!!oe.lightMap,li=!!oe.bumpMap,Ci=!!oe.normalMap,Ln=!!oe.displacementMap,Ar=!!oe.emissiveMap,ar=!!oe.metalnessMap,fr=!!oe.roughnessMap,gi=oe.anisotropy>0,Oe=oe.clearcoat>0,_e=oe.dispersion>0,Ct=oe.iridescence>0,Kt=oe.sheen>0,Zt=oe.transmission>0,Ht=gi&&!!oe.anisotropyMap,or=Oe&&!!oe.clearcoatMap,An=Oe&&!!oe.clearcoatNormalMap,Hn=Oe&&!!oe.clearcoatRoughnessMap,lr=Ct&&!!oe.iridescenceMap,Qt=Ct&&!!oe.iridescenceThicknessMap,jn=Kt&&!!oe.sheenColorMap,Mr=Kt&&!!oe.sheenRoughnessMap,gr=!!oe.specularMap,Pn=!!oe.specularColorMap,Sr=!!oe.specularIntensityMap,Ze=Zt&&!!oe.transmissionMap,Tn=Zt&&!!oe.thicknessMap,nn=!!oe.gradientMap,kn=!!oe.alphaMap,ln=oe.alphaTest>0,en=!!oe.alphaHash,Yn=!!oe.extensions;let br=o1;oe.toneMapped&&(qt===null||qt.isXRRenderTarget===!0)&&(br=s.toneMapping);const xi={shaderID:lt,shaderType:oe.type,shaderName:oe.name,vertexShader:Jt,fragmentShader:dt,defines:oe.defines,customVertexShaderID:Dt,customFragmentShaderID:gn,isRawShaderMaterial:oe.isRawShaderMaterial===!0,glslVersion:oe.glslVersion,precision:A,batching:Xn,batchingColor:Xn&&He._colorsTexture!==null,instancing:rr,instancingColor:rr&&He.instanceColor!==null,instancingMorph:rr&&He.morphTexture!==null,supportsVertexTextures:S,outputColorSpace:qt===null?s.outputColorSpace:qt.isXRRenderTarget===!0?qt.texture.colorSpace:kc,alphaToCoverage:!!oe.alphaToCoverage,map:ni,matcap:oi,envMap:$r,envMapMode:$r&&gt.mapping,envMapCubeUVHeight:Ae,aoMap:$e,lightMap:zs,bumpMap:li,normalMap:Ci,displacementMap:S&&Ln,emissiveMap:Ar,normalMapObjectSpace:Ci&&oe.normalMapType===RTe,normalMapTangentSpace:Ci&&oe.normalMapType===sx,metalnessMap:ar,roughnessMap:fr,anisotropy:gi,anisotropyMap:Ht,clearcoat:Oe,clearcoatMap:or,clearcoatNormalMap:An,clearcoatRoughnessMap:Hn,dispersion:_e,iridescence:Ct,iridescenceMap:lr,iridescenceThicknessMap:Qt,sheen:Kt,sheenColorMap:jn,sheenRoughnessMap:Mr,specularMap:gr,specularColorMap:Pn,specularIntensityMap:Sr,transmission:Zt,transmissionMap:Ze,thicknessMap:Tn,gradientMap:nn,opaque:oe.transparent===!1&&oe.blending===Sv&&oe.alphaToCoverage===!1,alphaMap:kn,alphaTest:ln,alphaHash:en,combine:oe.combine,mapUv:ni&&L(oe.map.channel),aoMapUv:$e&&L(oe.aoMap.channel),lightMapUv:zs&&L(oe.lightMap.channel),bumpMapUv:li&&L(oe.bumpMap.channel),normalMapUv:Ci&&L(oe.normalMap.channel),displacementMapUv:Ln&&L(oe.displacementMap.channel),emissiveMapUv:Ar&&L(oe.emissiveMap.channel),metalnessMapUv:ar&&L(oe.metalnessMap.channel),roughnessMapUv:fr&&L(oe.roughnessMap.channel),anisotropyMapUv:Ht&&L(oe.anisotropyMap.channel),clearcoatMapUv:or&&L(oe.clearcoatMap.channel),clearcoatNormalMapUv:An&&L(oe.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Hn&&L(oe.clearcoatRoughnessMap.channel),iridescenceMapUv:lr&&L(oe.iridescenceMap.channel),iridescenceThicknessMapUv:Qt&&L(oe.iridescenceThicknessMap.channel),sheenColorMapUv:jn&&L(oe.sheenColorMap.channel),sheenRoughnessMapUv:Mr&&L(oe.sheenRoughnessMap.channel),specularMapUv:gr&&L(oe.specularMap.channel),specularColorMapUv:Pn&&L(oe.specularColorMap.channel),specularIntensityMapUv:Sr&&L(oe.specularIntensityMap.channel),transmissionMapUv:Ze&&L(oe.transmissionMap.channel),thicknessMapUv:Tn&&L(oe.thicknessMap.channel),alphaMapUv:kn&&L(oe.alphaMap.channel),vertexTangents:!!ot.attributes.tangent&&(Ci||gi),vertexColors:oe.vertexColors,vertexAlphas:oe.vertexColors===!0&&!!ot.attributes.color&&ot.attributes.color.itemSize===4,pointsUvs:He.isPoints===!0&&!!ot.attributes.uv&&(ni||kn),fog:!!rt,useFog:oe.fog===!0,fogExp2:!!rt&&rt.isFogExp2,flatShading:oe.flatShading===!0,sizeAttenuation:oe.sizeAttenuation===!0,logarithmicDepthBuffer:x,reverseDepthBuffer:wn,skinning:He.isSkinnedMesh===!0,morphTargets:ot.morphAttributes.position!==void 0,morphNormals:ot.morphAttributes.normal!==void 0,morphColors:ot.morphAttributes.color!==void 0,morphTargetsCount:De,morphTextureStride:_t,numDirLights:le.directional.length,numPointLights:le.point.length,numSpotLights:le.spot.length,numSpotLightMaps:le.spotLightMap.length,numRectAreaLights:le.rectArea.length,numHemiLights:le.hemi.length,numDirLightShadows:le.directionalShadowMap.length,numPointLightShadows:le.pointShadowMap.length,numSpotLightShadows:le.spotShadowMap.length,numSpotLightShadowsWithMaps:le.numSpotLightShadowsWithMaps,numLightProbes:le.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:oe.dithering,shadowMapEnabled:s.shadowMap.enabled&&J.length>0,shadowMapType:s.shadowMap.type,toneMapping:br,decodeVideoTexture:ni&&oe.map.isVideoTexture===!0&&Yr.getTransfer(oe.map.colorSpace)===xs,decodeVideoTextureEmissive:Ar&&oe.emissiveMap.isVideoTexture===!0&&Yr.getTransfer(oe.emissiveMap.colorSpace)===xs,premultipliedAlpha:oe.premultipliedAlpha,doubleSided:oe.side===X0,flipSided:oe.side===qa,useDepthPacking:oe.depthPacking>=0,depthPacking:oe.depthPacking||0,index0AttributeName:oe.index0AttributeName,extensionClipCullDistance:Yn&&oe.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Yn&&oe.extensions.multiDraw===!0||Xn)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:oe.customProgramCacheKey()};return xi.vertexUv1s=p.has(1),xi.vertexUv2s=p.has(2),xi.vertexUv3s=p.has(3),p.clear(),xi}function P(oe){const le=[];if(oe.shaderID?le.push(oe.shaderID):(le.push(oe.customVertexShaderID),le.push(oe.customFragmentShaderID)),oe.defines!==void 0)for(const J in oe.defines)le.push(J),le.push(oe.defines[J]);return oe.isRawShaderMaterial===!1&&($(le,oe),Z(le,oe),le.push(s.outputColorSpace)),le.push(oe.customProgramCacheKey),le.join()}function $(oe,le){oe.push(le.precision),oe.push(le.outputColorSpace),oe.push(le.envMapMode),oe.push(le.envMapCubeUVHeight),oe.push(le.mapUv),oe.push(le.alphaMapUv),oe.push(le.lightMapUv),oe.push(le.aoMapUv),oe.push(le.bumpMapUv),oe.push(le.normalMapUv),oe.push(le.displacementMapUv),oe.push(le.emissiveMapUv),oe.push(le.metalnessMapUv),oe.push(le.roughnessMapUv),oe.push(le.anisotropyMapUv),oe.push(le.clearcoatMapUv),oe.push(le.clearcoatNormalMapUv),oe.push(le.clearcoatRoughnessMapUv),oe.push(le.iridescenceMapUv),oe.push(le.iridescenceThicknessMapUv),oe.push(le.sheenColorMapUv),oe.push(le.sheenRoughnessMapUv),oe.push(le.specularMapUv),oe.push(le.specularColorMapUv),oe.push(le.specularIntensityMapUv),oe.push(le.transmissionMapUv),oe.push(le.thicknessMapUv),oe.push(le.combine),oe.push(le.fogExp2),oe.push(le.sizeAttenuation),oe.push(le.morphTargetsCount),oe.push(le.morphAttributeCount),oe.push(le.numDirLights),oe.push(le.numPointLights),oe.push(le.numSpotLights),oe.push(le.numSpotLightMaps),oe.push(le.numHemiLights),oe.push(le.numRectAreaLights),oe.push(le.numDirLightShadows),oe.push(le.numPointLightShadows),oe.push(le.numSpotLightShadows),oe.push(le.numSpotLightShadowsWithMaps),oe.push(le.numLightProbes),oe.push(le.shadowMapType),oe.push(le.toneMapping),oe.push(le.numClippingPlanes),oe.push(le.numClipIntersection),oe.push(le.depthPacking)}function Z(oe,le){l.disableAll(),le.supportsVertexTextures&&l.enable(0),le.instancing&&l.enable(1),le.instancingColor&&l.enable(2),le.instancingMorph&&l.enable(3),le.matcap&&l.enable(4),le.envMap&&l.enable(5),le.normalMapObjectSpace&&l.enable(6),le.normalMapTangentSpace&&l.enable(7),le.clearcoat&&l.enable(8),le.iridescence&&l.enable(9),le.alphaTest&&l.enable(10),le.vertexColors&&l.enable(11),le.vertexAlphas&&l.enable(12),le.vertexUv1s&&l.enable(13),le.vertexUv2s&&l.enable(14),le.vertexUv3s&&l.enable(15),le.vertexTangents&&l.enable(16),le.anisotropy&&l.enable(17),le.alphaHash&&l.enable(18),le.batching&&l.enable(19),le.dispersion&&l.enable(20),le.batchingColor&&l.enable(21),oe.push(l.mask),l.disableAll(),le.fog&&l.enable(0),le.useFog&&l.enable(1),le.flatShading&&l.enable(2),le.logarithmicDepthBuffer&&l.enable(3),le.reverseDepthBuffer&&l.enable(4),le.skinning&&l.enable(5),le.morphTargets&&l.enable(6),le.morphNormals&&l.enable(7),le.morphColors&&l.enable(8),le.premultipliedAlpha&&l.enable(9),le.shadowMapEnabled&&l.enable(10),le.doubleSided&&l.enable(11),le.flipSided&&l.enable(12),le.useDepthPacking&&l.enable(13),le.dithering&&l.enable(14),le.transmission&&l.enable(15),le.sheen&&l.enable(16),le.opaque&&l.enable(17),le.pointsUvs&&l.enable(18),le.decodeVideoTexture&&l.enable(19),le.decodeVideoTextureEmissive&&l.enable(20),le.alphaToCoverage&&l.enable(21),oe.push(l.mask)}function I(oe){const le=k[oe.type];let J;if(le){const Be=r1[le];J=EMe.clone(Be.uniforms)}else J=oe.uniforms;return J}function ie(oe,le){let J;for(let Be=0,He=y.length;Be<He;Be++){const rt=y[Be];if(rt.cacheKey===le){J=rt,++J.usedTimes;break}}return J===void 0&&(J=new ZIe(s,le,oe,i),y.push(J)),J}function ce(oe){if(--oe.usedTimes===0){const le=y.indexOf(oe);y[le]=y[y.length-1],y.pop(),oe.destroy()}}function ue(oe){h.remove(oe)}function Q(){h.dispose()}return{getParameters:U,getProgramCacheKey:P,getUniforms:I,acquireProgram:ie,releaseProgram:ce,releaseShaderCache:ue,programs:y,dispose:Q}}function nke(){let s=new WeakMap;function e(o){return s.has(o)}function t(o){let l=s.get(o);return l===void 0&&(l={},s.set(o,l)),l}function n(o){s.delete(o)}function r(o,l,h){s.get(o)[l]=h}function i(){s=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:i}}function rke(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function gme(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function vme(){const s=[];let e=0;const t=[],n=[],r=[];function i(){e=0,t.length=0,n.length=0,r.length=0}function o(x,S,A,k,L,U){let P=s[e];return P===void 0?(P={id:x.id,object:x,geometry:S,material:A,groupOrder:k,renderOrder:x.renderOrder,z:L,group:U},s[e]=P):(P.id=x.id,P.object=x,P.geometry=S,P.material=A,P.groupOrder=k,P.renderOrder=x.renderOrder,P.z=L,P.group=U),e++,P}function l(x,S,A,k,L,U){const P=o(x,S,A,k,L,U);A.transmission>0?n.push(P):A.transparent===!0?r.push(P):t.push(P)}function h(x,S,A,k,L,U){const P=o(x,S,A,k,L,U);A.transmission>0?n.unshift(P):A.transparent===!0?r.unshift(P):t.unshift(P)}function p(x,S){t.length>1&&t.sort(x||rke),n.length>1&&n.sort(S||gme),r.length>1&&r.sort(S||gme)}function y(){for(let x=e,S=s.length;x<S;x++){const A=s[x];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:t,transmissive:n,transparent:r,init:i,push:l,unshift:h,finish:y,sort:p}}function ike(){let s=new WeakMap;function e(n,r){const i=s.get(n);let o;return i===void 0?(o=new vme,s.set(n,[o])):r>=i.length?(o=new vme,i.push(o)):o=i[r],o}function t(){s=new WeakMap}return{get:e,dispose:t}}function ske(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ke,color:new Vn};break;case"SpotLight":t={position:new ke,direction:new ke,color:new Vn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ke,color:new Vn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ke,skyColor:new Vn,groundColor:new Vn};break;case"RectAreaLight":t={color:new Vn,position:new ke,halfWidth:new ke,halfHeight:new ke};break}return s[e.id]=t,t}}}function ake(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let oke=0;function lke(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function uke(s){const e=new ske,t=ake(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new ke);const r=new ke,i=new yr,o=new yr;function l(p){let y=0,x=0,S=0;for(let oe=0;oe<9;oe++)n.probe[oe].set(0,0,0);let A=0,k=0,L=0,U=0,P=0,$=0,Z=0,I=0,ie=0,ce=0,ue=0;p.sort(lke);for(let oe=0,le=p.length;oe<le;oe++){const J=p[oe],Be=J.color,He=J.intensity,rt=J.distance,ot=J.shadow&&J.shadow.map?J.shadow.map.texture:null;if(J.isAmbientLight)y+=Be.r*He,x+=Be.g*He,S+=Be.b*He;else if(J.isLightProbe){for(let Se=0;Se<9;Se++)n.probe[Se].addScaledVector(J.sh.coefficients[Se],He);ue++}else if(J.isDirectionalLight){const Se=e.get(J);if(Se.color.copy(J.color).multiplyScalar(J.intensity),J.castShadow){const gt=J.shadow,Ae=t.get(J);Ae.shadowIntensity=gt.intensity,Ae.shadowBias=gt.bias,Ae.shadowNormalBias=gt.normalBias,Ae.shadowRadius=gt.radius,Ae.shadowMapSize=gt.mapSize,n.directionalShadow[A]=Ae,n.directionalShadowMap[A]=ot,n.directionalShadowMatrix[A]=J.shadow.matrix,$++}n.directional[A]=Se,A++}else if(J.isSpotLight){const Se=e.get(J);Se.position.setFromMatrixPosition(J.matrixWorld),Se.color.copy(Be).multiplyScalar(He),Se.distance=rt,Se.coneCos=Math.cos(J.angle),Se.penumbraCos=Math.cos(J.angle*(1-J.penumbra)),Se.decay=J.decay,n.spot[L]=Se;const gt=J.shadow;if(J.map&&(n.spotLightMap[ie]=J.map,ie++,gt.updateMatrices(J),J.castShadow&&ce++),n.spotLightMatrix[L]=gt.matrix,J.castShadow){const Ae=t.get(J);Ae.shadowIntensity=gt.intensity,Ae.shadowBias=gt.bias,Ae.shadowNormalBias=gt.normalBias,Ae.shadowRadius=gt.radius,Ae.shadowMapSize=gt.mapSize,n.spotShadow[L]=Ae,n.spotShadowMap[L]=ot,I++}L++}else if(J.isRectAreaLight){const Se=e.get(J);Se.color.copy(Be).multiplyScalar(He),Se.halfWidth.set(J.width*.5,0,0),Se.halfHeight.set(0,J.height*.5,0),n.rectArea[U]=Se,U++}else if(J.isPointLight){const Se=e.get(J);if(Se.color.copy(J.color).multiplyScalar(J.intensity),Se.distance=J.distance,Se.decay=J.decay,J.castShadow){const gt=J.shadow,Ae=t.get(J);Ae.shadowIntensity=gt.intensity,Ae.shadowBias=gt.bias,Ae.shadowNormalBias=gt.normalBias,Ae.shadowRadius=gt.radius,Ae.shadowMapSize=gt.mapSize,Ae.shadowCameraNear=gt.camera.near,Ae.shadowCameraFar=gt.camera.far,n.pointShadow[k]=Ae,n.pointShadowMap[k]=ot,n.pointShadowMatrix[k]=J.shadow.matrix,Z++}n.point[k]=Se,k++}else if(J.isHemisphereLight){const Se=e.get(J);Se.skyColor.copy(J.color).multiplyScalar(He),Se.groundColor.copy(J.groundColor).multiplyScalar(He),n.hemi[P]=Se,P++}}U>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Un.LTC_FLOAT_1,n.rectAreaLTC2=Un.LTC_FLOAT_2):(n.rectAreaLTC1=Un.LTC_HALF_1,n.rectAreaLTC2=Un.LTC_HALF_2)),n.ambient[0]=y,n.ambient[1]=x,n.ambient[2]=S;const Q=n.hash;(Q.directionalLength!==A||Q.pointLength!==k||Q.spotLength!==L||Q.rectAreaLength!==U||Q.hemiLength!==P||Q.numDirectionalShadows!==$||Q.numPointShadows!==Z||Q.numSpotShadows!==I||Q.numSpotMaps!==ie||Q.numLightProbes!==ue)&&(n.directional.length=A,n.spot.length=L,n.rectArea.length=U,n.point.length=k,n.hemi.length=P,n.directionalShadow.length=$,n.directionalShadowMap.length=$,n.pointShadow.length=Z,n.pointShadowMap.length=Z,n.spotShadow.length=I,n.spotShadowMap.length=I,n.directionalShadowMatrix.length=$,n.pointShadowMatrix.length=Z,n.spotLightMatrix.length=I+ie-ce,n.spotLightMap.length=ie,n.numSpotLightShadowsWithMaps=ce,n.numLightProbes=ue,Q.directionalLength=A,Q.pointLength=k,Q.spotLength=L,Q.rectAreaLength=U,Q.hemiLength=P,Q.numDirectionalShadows=$,Q.numPointShadows=Z,Q.numSpotShadows=I,Q.numSpotMaps=ie,Q.numLightProbes=ue,n.version=oke++)}function h(p,y){let x=0,S=0,A=0,k=0,L=0;const U=y.matrixWorldInverse;for(let P=0,$=p.length;P<$;P++){const Z=p[P];if(Z.isDirectionalLight){const I=n.directional[x];I.direction.setFromMatrixPosition(Z.matrixWorld),r.setFromMatrixPosition(Z.target.matrixWorld),I.direction.sub(r),I.direction.transformDirection(U),x++}else if(Z.isSpotLight){const I=n.spot[A];I.position.setFromMatrixPosition(Z.matrixWorld),I.position.applyMatrix4(U),I.direction.setFromMatrixPosition(Z.matrixWorld),r.setFromMatrixPosition(Z.target.matrixWorld),I.direction.sub(r),I.direction.transformDirection(U),A++}else if(Z.isRectAreaLight){const I=n.rectArea[k];I.position.setFromMatrixPosition(Z.matrixWorld),I.position.applyMatrix4(U),o.identity(),i.copy(Z.matrixWorld),i.premultiply(U),o.extractRotation(i),I.halfWidth.set(Z.width*.5,0,0),I.halfHeight.set(0,Z.height*.5,0),I.halfWidth.applyMatrix4(o),I.halfHeight.applyMatrix4(o),k++}else if(Z.isPointLight){const I=n.point[S];I.position.setFromMatrixPosition(Z.matrixWorld),I.position.applyMatrix4(U),S++}else if(Z.isHemisphereLight){const I=n.hemi[L];I.direction.setFromMatrixPosition(Z.matrixWorld),I.direction.transformDirection(U),L++}}}return{setup:l,setupView:h,state:n}}function yme(s){const e=new uke(s),t=[],n=[];function r(y){p.camera=y,t.length=0,n.length=0}function i(y){t.push(y)}function o(y){n.push(y)}function l(){e.setup(t)}function h(y){e.setupView(t,y)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:l,setupLightsView:h,pushLight:i,pushShadow:o}}function cke(s){let e=new WeakMap;function t(r,i=0){const o=e.get(r);let l;return o===void 0?(l=new yme(s),e.set(r,[l])):i>=o.length?(l=new yme(s),o.push(l)):l=o[i],l}function n(){e=new WeakMap}return{get:t,dispose:n}}const hke=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,dke=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function fke(s,e,t){let n=new Yj;const r=new zn,i=new zn,o=new Ti,l=new s3e({depthPacking:PTe}),h=new tCe,p={},y=t.maxTextureSize,x={[c1]:qa,[qa]:c1,[X0]:X0},S=new $o({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new zn},radius:{value:4}},vertexShader:hke,fragmentShader:dke}),A=S.clone();A.defines.HORIZONTAL_PASS=1;const k=new ts;k.setAttribute("position",new Ic(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new Mn(k,S),U=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f9e;let P=this.type;this.render=function(ce,ue,Q){if(U.enabled===!1||U.autoUpdate===!1&&U.needsUpdate===!1||ce.length===0)return;const oe=s.getRenderTarget(),le=s.getActiveCubeFace(),J=s.getActiveMipmapLevel(),Be=s.state;Be.setBlending(Gl),Be.buffers.color.setClear(1,1,1,1),Be.buffers.depth.setTest(!0),Be.setScissorTest(!1);const He=P!==bg&&this.type===bg,rt=P===bg&&this.type!==bg;for(let ot=0,Se=ce.length;ot<Se;ot++){const gt=ce[ot],Ae=gt.shadow;if(Ae===void 0){console.warn("THREE.WebGLShadowMap:",gt,"has no shadow.");continue}if(Ae.autoUpdate===!1&&Ae.needsUpdate===!1)continue;r.copy(Ae.mapSize);const lt=Ae.getFrameExtents();if(r.multiply(lt),i.copy(Ae.mapSize),(r.x>y||r.y>y)&&(r.x>y&&(i.x=Math.floor(y/lt.x),r.x=i.x*lt.x,Ae.mapSize.x=i.x),r.y>y&&(i.y=Math.floor(y/lt.y),r.y=i.y*lt.y,Ae.mapSize.y=i.y)),Ae.map===null||He===!0||rt===!0){const De=this.type!==bg?{minFilter:y0,magFilter:y0}:{};Ae.map!==null&&Ae.map.dispose(),Ae.map=new J0(r.x,r.y,De),Ae.map.texture.name=gt.name+".shadowMap",Ae.camera.updateProjectionMatrix()}s.setRenderTarget(Ae.map),s.clear();const pt=Ae.getViewportCount();for(let De=0;De<pt;De++){const _t=Ae.getViewport(De);o.set(i.x*_t.x,i.y*_t.y,i.x*_t.z,i.y*_t.w),Be.viewport(o),Ae.updateMatrices(gt,De),n=Ae.getFrustum(),I(ue,Q,Ae.camera,gt,this.type)}Ae.isPointLightShadow!==!0&&this.type===bg&&$(Ae,Q),Ae.needsUpdate=!1}P=this.type,U.needsUpdate=!1,s.setRenderTarget(oe,le,J)};function $(ce,ue){const Q=e.update(L);S.defines.VSM_SAMPLES!==ce.blurSamples&&(S.defines.VSM_SAMPLES=ce.blurSamples,A.defines.VSM_SAMPLES=ce.blurSamples,S.needsUpdate=!0,A.needsUpdate=!0),ce.mapPass===null&&(ce.mapPass=new J0(r.x,r.y)),S.uniforms.shadow_pass.value=ce.map.texture,S.uniforms.resolution.value=ce.mapSize,S.uniforms.radius.value=ce.radius,s.setRenderTarget(ce.mapPass),s.clear(),s.renderBufferDirect(ue,null,Q,S,L,null),A.uniforms.shadow_pass.value=ce.mapPass.texture,A.uniforms.resolution.value=ce.mapSize,A.uniforms.radius.value=ce.radius,s.setRenderTarget(ce.map),s.clear(),s.renderBufferDirect(ue,null,Q,A,L,null)}function Z(ce,ue,Q,oe){let le=null;const J=Q.isPointLight===!0?ce.customDistanceMaterial:ce.customDepthMaterial;if(J!==void 0)le=J;else if(le=Q.isPointLight===!0?h:l,s.localClippingEnabled&&ue.clipShadows===!0&&Array.isArray(ue.clippingPlanes)&&ue.clippingPlanes.length!==0||ue.displacementMap&&ue.displacementScale!==0||ue.alphaMap&&ue.alphaTest>0||ue.map&&ue.alphaTest>0||ue.alphaToCoverage===!0){const Be=le.uuid,He=ue.uuid;let rt=p[Be];rt===void 0&&(rt={},p[Be]=rt);let ot=rt[He];ot===void 0&&(ot=le.clone(),rt[He]=ot,ue.addEventListener("dispose",ie)),le=ot}if(le.visible=ue.visible,le.wireframe=ue.wireframe,oe===bg?le.side=ue.shadowSide!==null?ue.shadowSide:ue.side:le.side=ue.shadowSide!==null?ue.shadowSide:x[ue.side],le.alphaMap=ue.alphaMap,le.alphaTest=ue.alphaToCoverage===!0?.5:ue.alphaTest,le.map=ue.map,le.clipShadows=ue.clipShadows,le.clippingPlanes=ue.clippingPlanes,le.clipIntersection=ue.clipIntersection,le.displacementMap=ue.displacementMap,le.displacementScale=ue.displacementScale,le.displacementBias=ue.displacementBias,le.wireframeLinewidth=ue.wireframeLinewidth,le.linewidth=ue.linewidth,Q.isPointLight===!0&&le.isMeshDistanceMaterial===!0){const Be=s.properties.get(le);Be.light=Q}return le}function I(ce,ue,Q,oe,le){if(ce.visible===!1)return;if(ce.layers.test(ue.layers)&&(ce.isMesh||ce.isLine||ce.isPoints)&&(ce.castShadow||ce.receiveShadow&&le===bg)&&(!ce.frustumCulled||n.intersectsObject(ce))){ce.modelViewMatrix.multiplyMatrices(Q.matrixWorldInverse,ce.matrixWorld);const He=e.update(ce),rt=ce.material;if(Array.isArray(rt)){const ot=He.groups;for(let Se=0,gt=ot.length;Se<gt;Se++){const Ae=ot[Se],lt=rt[Ae.materialIndex];if(lt&&lt.visible){const pt=Z(ce,lt,oe,le);ce.onBeforeShadow(s,ce,ue,Q,He,pt,Ae),s.renderBufferDirect(Q,null,He,pt,ce,Ae),ce.onAfterShadow(s,ce,ue,Q,He,pt,Ae)}}}else if(rt.visible){const ot=Z(ce,rt,oe,le);ce.onBeforeShadow(s,ce,ue,Q,He,ot,null),s.renderBufferDirect(Q,null,He,ot,ce,null),ce.onAfterShadow(s,ce,ue,Q,He,ot,null)}}const Be=ce.children;for(let He=0,rt=Be.length;He<rt;He++)I(Be[He],ue,Q,oe,le)}function ie(ce){ce.target.removeEventListener("dispose",ie);for(const Q in p){const oe=p[Q],le=ce.target.uuid;le in oe&&(oe[le].dispose(),delete oe[le])}}}const pke={[jG]:WG,[$G]:YG,[qG]:KG,[U_]:XG,[WG]:jG,[YG]:$G,[KG]:qG,[XG]:U_};function mke(s,e){function t(){let Ze=!1;const Tn=new Ti;let nn=null;const kn=new Ti(0,0,0,0);return{setMask:function(ln){nn!==ln&&!Ze&&(s.colorMask(ln,ln,ln,ln),nn=ln)},setLocked:function(ln){Ze=ln},setClear:function(ln,en,Yn,br,xi){xi===!0&&(ln*=br,en*=br,Yn*=br),Tn.set(ln,en,Yn,br),kn.equals(Tn)===!1&&(s.clearColor(ln,en,Yn,br),kn.copy(Tn))},reset:function(){Ze=!1,nn=null,kn.set(-1,0,0,0)}}}function n(){let Ze=!1,Tn=!1,nn=null,kn=null,ln=null;return{setReversed:function(en){if(Tn!==en){const Yn=e.get("EXT_clip_control");en?Yn.clipControlEXT(Yn.LOWER_LEFT_EXT,Yn.ZERO_TO_ONE_EXT):Yn.clipControlEXT(Yn.LOWER_LEFT_EXT,Yn.NEGATIVE_ONE_TO_ONE_EXT),Tn=en;const br=ln;ln=null,this.setClear(br)}},getReversed:function(){return Tn},setTest:function(en){en?qt(s.DEPTH_TEST):wn(s.DEPTH_TEST)},setMask:function(en){nn!==en&&!Ze&&(s.depthMask(en),nn=en)},setFunc:function(en){if(Tn&&(en=pke[en]),kn!==en){switch(en){case jG:s.depthFunc(s.NEVER);break;case WG:s.depthFunc(s.ALWAYS);break;case $G:s.depthFunc(s.LESS);break;case U_:s.depthFunc(s.LEQUAL);break;case qG:s.depthFunc(s.EQUAL);break;case XG:s.depthFunc(s.GEQUAL);break;case YG:s.depthFunc(s.GREATER);break;case KG:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}kn=en}},setLocked:function(en){Ze=en},setClear:function(en){ln!==en&&(Tn&&(en=1-en),s.clearDepth(en),ln=en)},reset:function(){Ze=!1,nn=null,kn=null,ln=null,Tn=!1}}}function r(){let Ze=!1,Tn=null,nn=null,kn=null,ln=null,en=null,Yn=null,br=null,xi=null;return{setTest:function(Kr){Ze||(Kr?qt(s.STENCIL_TEST):wn(s.STENCIL_TEST))},setMask:function(Kr){Tn!==Kr&&!Ze&&(s.stencilMask(Kr),Tn=Kr)},setFunc:function(Kr,Vs,la){(nn!==Kr||kn!==Vs||ln!==la)&&(s.stencilFunc(Kr,Vs,la),nn=Kr,kn=Vs,ln=la)},setOp:function(Kr,Vs,la){(en!==Kr||Yn!==Vs||br!==la)&&(s.stencilOp(Kr,Vs,la),en=Kr,Yn=Vs,br=la)},setLocked:function(Kr){Ze=Kr},setClear:function(Kr){xi!==Kr&&(s.clearStencil(Kr),xi=Kr)},reset:function(){Ze=!1,Tn=null,nn=null,kn=null,ln=null,en=null,Yn=null,br=null,xi=null}}}const i=new t,o=new n,l=new r,h=new WeakMap,p=new WeakMap;let y={},x={},S=new WeakMap,A=[],k=null,L=!1,U=null,P=null,$=null,Z=null,I=null,ie=null,ce=null,ue=new Vn(0,0,0),Q=0,oe=!1,le=null,J=null,Be=null,He=null,rt=null;const ot=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Se=!1,gt=0;const Ae=s.getParameter(s.VERSION);Ae.indexOf("WebGL")!==-1?(gt=parseFloat(/^WebGL (\d)/.exec(Ae)[1]),Se=gt>=1):Ae.indexOf("OpenGL ES")!==-1&&(gt=parseFloat(/^OpenGL ES (\d)/.exec(Ae)[1]),Se=gt>=2);let lt=null,pt={};const De=s.getParameter(s.SCISSOR_BOX),_t=s.getParameter(s.VIEWPORT),Jt=new Ti().fromArray(De),dt=new Ti().fromArray(_t);function Dt(Ze,Tn,nn,kn){const ln=new Uint8Array(4),en=s.createTexture();s.bindTexture(Ze,en),s.texParameteri(Ze,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(Ze,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let Yn=0;Yn<nn;Yn++)Ze===s.TEXTURE_3D||Ze===s.TEXTURE_2D_ARRAY?s.texImage3D(Tn,0,s.RGBA,1,1,kn,0,s.RGBA,s.UNSIGNED_BYTE,ln):s.texImage2D(Tn+Yn,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,ln);return en}const gn={};gn[s.TEXTURE_2D]=Dt(s.TEXTURE_2D,s.TEXTURE_2D,1),gn[s.TEXTURE_CUBE_MAP]=Dt(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),gn[s.TEXTURE_2D_ARRAY]=Dt(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),gn[s.TEXTURE_3D]=Dt(s.TEXTURE_3D,s.TEXTURE_3D,1,1),i.setClear(0,0,0,1),o.setClear(1),l.setClear(0),qt(s.DEPTH_TEST),o.setFunc(U_),li(!1),Ci(Kpe),qt(s.CULL_FACE),$e(Gl);function qt(Ze){y[Ze]!==!0&&(s.enable(Ze),y[Ze]=!0)}function wn(Ze){y[Ze]!==!1&&(s.disable(Ze),y[Ze]=!1)}function rr(Ze,Tn){return x[Ze]!==Tn?(s.bindFramebuffer(Ze,Tn),x[Ze]=Tn,Ze===s.DRAW_FRAMEBUFFER&&(x[s.FRAMEBUFFER]=Tn),Ze===s.FRAMEBUFFER&&(x[s.DRAW_FRAMEBUFFER]=Tn),!0):!1}function Xn(Ze,Tn){let nn=A,kn=!1;if(Ze){nn=S.get(Tn),nn===void 0&&(nn=[],S.set(Tn,nn));const ln=Ze.textures;if(nn.length!==ln.length||nn[0]!==s.COLOR_ATTACHMENT0){for(let en=0,Yn=ln.length;en<Yn;en++)nn[en]=s.COLOR_ATTACHMENT0+en;nn.length=ln.length,kn=!0}}else nn[0]!==s.BACK&&(nn[0]=s.BACK,kn=!0);kn&&s.drawBuffers(nn)}function ni(Ze){return k!==Ze?(s.useProgram(Ze),k=Ze,!0):!1}const oi={[q3]:s.FUNC_ADD,[m9e]:s.FUNC_SUBTRACT,[g9e]:s.FUNC_REVERSE_SUBTRACT};oi[v9e]=s.MIN,oi[y9e]=s.MAX;const $r={[wj]:s.ZERO,[Ej]:s.ONE,[Tj]:s.SRC_COLOR,[bE]:s.SRC_ALPHA,[_9e]:s.SRC_ALPHA_SATURATE,[Pj]:s.DST_COLOR,[Cj]:s.DST_ALPHA,[Mj]:s.ONE_MINUS_SRC_COLOR,[SE]:s.ONE_MINUS_SRC_ALPHA,[Rj]:s.ONE_MINUS_DST_COLOR,[Aj]:s.ONE_MINUS_DST_ALPHA,[Ij]:s.CONSTANT_COLOR,[kj]:s.ONE_MINUS_CONSTANT_COLOR,[Nj]:s.CONSTANT_ALPHA,[Dj]:s.ONE_MINUS_CONSTANT_ALPHA};function $e(Ze,Tn,nn,kn,ln,en,Yn,br,xi,Kr){if(Ze===Gl){L===!0&&(wn(s.BLEND),L=!1);return}if(L===!1&&(qt(s.BLEND),L=!0),Ze!==p9e){if(Ze!==U||Kr!==oe){if((P!==q3||I!==q3)&&(s.blendEquation(s.FUNC_ADD),P=q3,I=q3),Kr)switch(Ze){case Sv:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case VG:s.blendFunc(s.ONE,s.ONE);break;case GG:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case HG:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ze);break}else switch(Ze){case Sv:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case VG:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case GG:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case HG:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ze);break}$=null,Z=null,ie=null,ce=null,ue.set(0,0,0),Q=0,U=Ze,oe=Kr}return}ln=ln||Tn,en=en||nn,Yn=Yn||kn,(Tn!==P||ln!==I)&&(s.blendEquationSeparate(oi[Tn],oi[ln]),P=Tn,I=ln),(nn!==$||kn!==Z||en!==ie||Yn!==ce)&&(s.blendFuncSeparate($r[nn],$r[kn],$r[en],$r[Yn]),$=nn,Z=kn,ie=en,ce=Yn),(br.equals(ue)===!1||xi!==Q)&&(s.blendColor(br.r,br.g,br.b,xi),ue.copy(br),Q=xi),U=Ze,oe=!1}function zs(Ze,Tn){Ze.side===X0?wn(s.CULL_FACE):qt(s.CULL_FACE);let nn=Ze.side===qa;Tn&&(nn=!nn),li(nn),Ze.blending===Sv&&Ze.transparent===!1?$e(Gl):$e(Ze.blending,Ze.blendEquation,Ze.blendSrc,Ze.blendDst,Ze.blendEquationAlpha,Ze.blendSrcAlpha,Ze.blendDstAlpha,Ze.blendColor,Ze.blendAlpha,Ze.premultipliedAlpha),o.setFunc(Ze.depthFunc),o.setTest(Ze.depthTest),o.setMask(Ze.depthWrite),i.setMask(Ze.colorWrite);const kn=Ze.stencilWrite;l.setTest(kn),kn&&(l.setMask(Ze.stencilWriteMask),l.setFunc(Ze.stencilFunc,Ze.stencilRef,Ze.stencilFuncMask),l.setOp(Ze.stencilFail,Ze.stencilZFail,Ze.stencilZPass)),Ar(Ze.polygonOffset,Ze.polygonOffsetFactor,Ze.polygonOffsetUnits),Ze.alphaToCoverage===!0?qt(s.SAMPLE_ALPHA_TO_COVERAGE):wn(s.SAMPLE_ALPHA_TO_COVERAGE)}function li(Ze){le!==Ze&&(Ze?s.frontFace(s.CW):s.frontFace(s.CCW),le=Ze)}function Ci(Ze){Ze!==yTe?(qt(s.CULL_FACE),Ze!==J&&(Ze===Kpe?s.cullFace(s.BACK):Ze===_Te?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):wn(s.CULL_FACE),J=Ze}function Ln(Ze){Ze!==Be&&(Se&&s.lineWidth(Ze),Be=Ze)}function Ar(Ze,Tn,nn){Ze?(qt(s.POLYGON_OFFSET_FILL),(He!==Tn||rt!==nn)&&(s.polygonOffset(Tn,nn),He=Tn,rt=nn)):wn(s.POLYGON_OFFSET_FILL)}function ar(Ze){Ze?qt(s.SCISSOR_TEST):wn(s.SCISSOR_TEST)}function fr(Ze){Ze===void 0&&(Ze=s.TEXTURE0+ot-1),lt!==Ze&&(s.activeTexture(Ze),lt=Ze)}function gi(Ze,Tn,nn){nn===void 0&&(lt===null?nn=s.TEXTURE0+ot-1:nn=lt);let kn=pt[nn];kn===void 0&&(kn={type:void 0,texture:void 0},pt[nn]=kn),(kn.type!==Ze||kn.texture!==Tn)&&(lt!==nn&&(s.activeTexture(nn),lt=nn),s.bindTexture(Ze,Tn||gn[Ze]),kn.type=Ze,kn.texture=Tn)}function Oe(){const Ze=pt[lt];Ze!==void 0&&Ze.type!==void 0&&(s.bindTexture(Ze.type,null),Ze.type=void 0,Ze.texture=void 0)}function _e(){try{s.compressedTexImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Ct(){try{s.compressedTexImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Kt(){try{s.texSubImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Zt(){try{s.texSubImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Ht(){try{s.compressedTexSubImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function or(){try{s.compressedTexSubImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function An(){try{s.texStorage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Hn(){try{s.texStorage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function lr(){try{s.texImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Qt(){try{s.texImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function jn(Ze){Jt.equals(Ze)===!1&&(s.scissor(Ze.x,Ze.y,Ze.z,Ze.w),Jt.copy(Ze))}function Mr(Ze){dt.equals(Ze)===!1&&(s.viewport(Ze.x,Ze.y,Ze.z,Ze.w),dt.copy(Ze))}function gr(Ze,Tn){let nn=p.get(Tn);nn===void 0&&(nn=new WeakMap,p.set(Tn,nn));let kn=nn.get(Ze);kn===void 0&&(kn=s.getUniformBlockIndex(Tn,Ze.name),nn.set(Ze,kn))}function Pn(Ze,Tn){const kn=p.get(Tn).get(Ze);h.get(Tn)!==kn&&(s.uniformBlockBinding(Tn,kn,Ze.__bindingPointIndex),h.set(Tn,kn))}function Sr(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),o.setReversed(!1),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),y={},lt=null,pt={},x={},S=new WeakMap,A=[],k=null,L=!1,U=null,P=null,$=null,Z=null,I=null,ie=null,ce=null,ue=new Vn(0,0,0),Q=0,oe=!1,le=null,J=null,Be=null,He=null,rt=null,Jt.set(0,0,s.canvas.width,s.canvas.height),dt.set(0,0,s.canvas.width,s.canvas.height),i.reset(),o.reset(),l.reset()}return{buffers:{color:i,depth:o,stencil:l},enable:qt,disable:wn,bindFramebuffer:rr,drawBuffers:Xn,useProgram:ni,setBlending:$e,setMaterial:zs,setFlipSided:li,setCullFace:Ci,setLineWidth:Ln,setPolygonOffset:Ar,setScissorTest:ar,activeTexture:fr,bindTexture:gi,unbindTexture:Oe,compressedTexImage2D:_e,compressedTexImage3D:Ct,texImage2D:lr,texImage3D:Qt,updateUBOMapping:gr,uniformBlockBinding:Pn,texStorage2D:An,texStorage3D:Hn,texSubImage2D:Kt,texSubImage3D:Zt,compressedTexSubImage2D:Ht,compressedTexSubImage3D:or,scissor:jn,viewport:Mr,reset:Sr}}function gke(s,e,t,n,r,i,o){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new zn,y=new WeakMap;let x;const S=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function k(Oe,_e){return A?new OffscreenCanvas(Oe,_e):TE("canvas")}function L(Oe,_e,Ct){let Kt=1;const Zt=gi(Oe);if((Zt.width>Ct||Zt.height>Ct)&&(Kt=Ct/Math.max(Zt.width,Zt.height)),Kt<1)if(typeof HTMLImageElement<"u"&&Oe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Oe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Oe instanceof ImageBitmap||typeof VideoFrame<"u"&&Oe instanceof VideoFrame){const Ht=Math.floor(Kt*Zt.width),or=Math.floor(Kt*Zt.height);x===void 0&&(x=k(Ht,or));const An=_e?k(Ht,or):x;return An.width=Ht,An.height=or,An.getContext("2d").drawImage(Oe,0,0,Ht,or),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Zt.width+"x"+Zt.height+") to ("+Ht+"x"+or+")."),An}else return"data"in Oe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Zt.width+"x"+Zt.height+")."),Oe;return Oe}function U(Oe){return Oe.generateMipmaps}function P(Oe){s.generateMipmap(Oe)}function $(Oe){return Oe.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:Oe.isWebGL3DRenderTarget?s.TEXTURE_3D:Oe.isWebGLArrayRenderTarget||Oe.isCompressedArrayTexture?s.TEXTURE_2D_ARRAY:s.TEXTURE_2D}function Z(Oe,_e,Ct,Kt,Zt=!1){if(Oe!==null){if(s[Oe]!==void 0)return s[Oe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Oe+"'")}let Ht=_e;if(_e===s.RED&&(Ct===s.FLOAT&&(Ht=s.R32F),Ct===s.HALF_FLOAT&&(Ht=s.R16F),Ct===s.UNSIGNED_BYTE&&(Ht=s.R8)),_e===s.RED_INTEGER&&(Ct===s.UNSIGNED_BYTE&&(Ht=s.R8UI),Ct===s.UNSIGNED_SHORT&&(Ht=s.R16UI),Ct===s.UNSIGNED_INT&&(Ht=s.R32UI),Ct===s.BYTE&&(Ht=s.R8I),Ct===s.SHORT&&(Ht=s.R16I),Ct===s.INT&&(Ht=s.R32I)),_e===s.RG&&(Ct===s.FLOAT&&(Ht=s.RG32F),Ct===s.HALF_FLOAT&&(Ht=s.RG16F),Ct===s.UNSIGNED_BYTE&&(Ht=s.RG8)),_e===s.RG_INTEGER&&(Ct===s.UNSIGNED_BYTE&&(Ht=s.RG8UI),Ct===s.UNSIGNED_SHORT&&(Ht=s.RG16UI),Ct===s.UNSIGNED_INT&&(Ht=s.RG32UI),Ct===s.BYTE&&(Ht=s.RG8I),Ct===s.SHORT&&(Ht=s.RG16I),Ct===s.INT&&(Ht=s.RG32I)),_e===s.RGB_INTEGER&&(Ct===s.UNSIGNED_BYTE&&(Ht=s.RGB8UI),Ct===s.UNSIGNED_SHORT&&(Ht=s.RGB16UI),Ct===s.UNSIGNED_INT&&(Ht=s.RGB32UI),Ct===s.BYTE&&(Ht=s.RGB8I),Ct===s.SHORT&&(Ht=s.RGB16I),Ct===s.INT&&(Ht=s.RGB32I)),_e===s.RGBA_INTEGER&&(Ct===s.UNSIGNED_BYTE&&(Ht=s.RGBA8UI),Ct===s.UNSIGNED_SHORT&&(Ht=s.RGBA16UI),Ct===s.UNSIGNED_INT&&(Ht=s.RGBA32UI),Ct===s.BYTE&&(Ht=s.RGBA8I),Ct===s.SHORT&&(Ht=s.RGBA16I),Ct===s.INT&&(Ht=s.RGBA32I)),_e===s.RGB&&Ct===s.UNSIGNED_INT_5_9_9_9_REV&&(Ht=s.RGB9_E5),_e===s.RGBA){const or=Zt?YI:Yr.getTransfer(Kt);Ct===s.FLOAT&&(Ht=s.RGBA32F),Ct===s.HALF_FLOAT&&(Ht=s.RGBA16F),Ct===s.UNSIGNED_BYTE&&(Ht=or===xs?s.SRGB8_ALPHA8:s.RGBA8),Ct===s.UNSIGNED_SHORT_4_4_4_4&&(Ht=s.RGBA4),Ct===s.UNSIGNED_SHORT_5_5_5_1&&(Ht=s.RGB5_A1)}return(Ht===s.R16F||Ht===s.R32F||Ht===s.RG16F||Ht===s.RG32F||Ht===s.RGBA16F||Ht===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Ht}function I(Oe,_e){let Ct;return Oe?_e===null||_e===e4||_e===V_?Ct=s.DEPTH24_STENCIL8:_e===Lh?Ct=s.DEPTH32F_STENCIL8:_e===wE&&(Ct=s.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):_e===null||_e===e4||_e===V_?Ct=s.DEPTH_COMPONENT24:_e===Lh?Ct=s.DEPTH_COMPONENT32F:_e===wE&&(Ct=s.DEPTH_COMPONENT16),Ct}function ie(Oe,_e){return U(Oe)===!0||Oe.isFramebufferTexture&&Oe.minFilter!==y0&&Oe.minFilter!==Ho?Math.log2(Math.max(_e.width,_e.height))+1:Oe.mipmaps!==void 0&&Oe.mipmaps.length>0?Oe.mipmaps.length:Oe.isCompressedTexture&&Array.isArray(Oe.image)?_e.mipmaps.length:1}function ce(Oe){const _e=Oe.target;_e.removeEventListener("dispose",ce),Q(_e),_e.isVideoTexture&&y.delete(_e)}function ue(Oe){const _e=Oe.target;_e.removeEventListener("dispose",ue),le(_e)}function Q(Oe){const _e=n.get(Oe);if(_e.__webglInit===void 0)return;const Ct=Oe.source,Kt=S.get(Ct);if(Kt){const Zt=Kt[_e.__cacheKey];Zt.usedTimes--,Zt.usedTimes===0&&oe(Oe),Object.keys(Kt).length===0&&S.delete(Ct)}n.remove(Oe)}function oe(Oe){const _e=n.get(Oe);s.deleteTexture(_e.__webglTexture);const Ct=Oe.source,Kt=S.get(Ct);delete Kt[_e.__cacheKey],o.memory.textures--}function le(Oe){const _e=n.get(Oe);if(Oe.depthTexture&&(Oe.depthTexture.dispose(),n.remove(Oe.depthTexture)),Oe.isWebGLCubeRenderTarget)for(let Kt=0;Kt<6;Kt++){if(Array.isArray(_e.__webglFramebuffer[Kt]))for(let Zt=0;Zt<_e.__webglFramebuffer[Kt].length;Zt++)s.deleteFramebuffer(_e.__webglFramebuffer[Kt][Zt]);else s.deleteFramebuffer(_e.__webglFramebuffer[Kt]);_e.__webglDepthbuffer&&s.deleteRenderbuffer(_e.__webglDepthbuffer[Kt])}else{if(Array.isArray(_e.__webglFramebuffer))for(let Kt=0;Kt<_e.__webglFramebuffer.length;Kt++)s.deleteFramebuffer(_e.__webglFramebuffer[Kt]);else s.deleteFramebuffer(_e.__webglFramebuffer);if(_e.__webglDepthbuffer&&s.deleteRenderbuffer(_e.__webglDepthbuffer),_e.__webglMultisampledFramebuffer&&s.deleteFramebuffer(_e.__webglMultisampledFramebuffer),_e.__webglColorRenderbuffer)for(let Kt=0;Kt<_e.__webglColorRenderbuffer.length;Kt++)_e.__webglColorRenderbuffer[Kt]&&s.deleteRenderbuffer(_e.__webglColorRenderbuffer[Kt]);_e.__webglDepthRenderbuffer&&s.deleteRenderbuffer(_e.__webglDepthRenderbuffer)}const Ct=Oe.textures;for(let Kt=0,Zt=Ct.length;Kt<Zt;Kt++){const Ht=n.get(Ct[Kt]);Ht.__webglTexture&&(s.deleteTexture(Ht.__webglTexture),o.memory.textures--),n.remove(Ct[Kt])}n.remove(Oe)}let J=0;function Be(){J=0}function He(){const Oe=J;return Oe>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Oe+" texture units while this GPU supports only "+r.maxTextures),J+=1,Oe}function rt(Oe){const _e=[];return _e.push(Oe.wrapS),_e.push(Oe.wrapT),_e.push(Oe.wrapR||0),_e.push(Oe.magFilter),_e.push(Oe.minFilter),_e.push(Oe.anisotropy),_e.push(Oe.internalFormat),_e.push(Oe.format),_e.push(Oe.type),_e.push(Oe.generateMipmaps),_e.push(Oe.premultiplyAlpha),_e.push(Oe.flipY),_e.push(Oe.unpackAlignment),_e.push(Oe.colorSpace),_e.join()}function ot(Oe,_e){const Ct=n.get(Oe);if(Oe.isVideoTexture&&ar(Oe),Oe.isRenderTargetTexture===!1&&Oe.version>0&&Ct.__version!==Oe.version){const Kt=Oe.image;if(Kt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Kt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{gn(Ct,Oe,_e);return}}t.bindTexture(s.TEXTURE_2D,Ct.__webglTexture,s.TEXTURE0+_e)}function Se(Oe,_e){const Ct=n.get(Oe);if(Oe.version>0&&Ct.__version!==Oe.version){gn(Ct,Oe,_e);return}t.bindTexture(s.TEXTURE_2D_ARRAY,Ct.__webglTexture,s.TEXTURE0+_e)}function gt(Oe,_e){const Ct=n.get(Oe);if(Oe.version>0&&Ct.__version!==Oe.version){gn(Ct,Oe,_e);return}t.bindTexture(s.TEXTURE_3D,Ct.__webglTexture,s.TEXTURE0+_e)}function Ae(Oe,_e){const Ct=n.get(Oe);if(Oe.version>0&&Ct.__version!==Oe.version){qt(Ct,Oe,_e);return}t.bindTexture(s.TEXTURE_CUBE_MAP,Ct.__webglTexture,s.TEXTURE0+_e)}const lt={[Fg]:s.REPEAT,[g0]:s.CLAMP_TO_EDGE,[QG]:s.MIRRORED_REPEAT},pt={[y0]:s.NEAREST,[ETe]:s.NEAREST_MIPMAP_NEAREST,[tR]:s.NEAREST_MIPMAP_LINEAR,[Ho]:s.LINEAR,[_z]:s.LINEAR_MIPMAP_NEAREST,[yv]:s.LINEAR_MIPMAP_LINEAR},De={[ITe]:s.NEVER,[LTe]:s.ALWAYS,[kTe]:s.LESS,[O9e]:s.LEQUAL,[NTe]:s.EQUAL,[FTe]:s.GEQUAL,[DTe]:s.GREATER,[OTe]:s.NOTEQUAL};function _t(Oe,_e){if(_e.type===Lh&&e.has("OES_texture_float_linear")===!1&&(_e.magFilter===Ho||_e.magFilter===_z||_e.magFilter===tR||_e.magFilter===yv||_e.minFilter===Ho||_e.minFilter===_z||_e.minFilter===tR||_e.minFilter===yv)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(Oe,s.TEXTURE_WRAP_S,lt[_e.wrapS]),s.texParameteri(Oe,s.TEXTURE_WRAP_T,lt[_e.wrapT]),(Oe===s.TEXTURE_3D||Oe===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Oe,s.TEXTURE_WRAP_R,lt[_e.wrapR]),s.texParameteri(Oe,s.TEXTURE_MAG_FILTER,pt[_e.magFilter]),s.texParameteri(Oe,s.TEXTURE_MIN_FILTER,pt[_e.minFilter]),_e.compareFunction&&(s.texParameteri(Oe,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(Oe,s.TEXTURE_COMPARE_FUNC,De[_e.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(_e.magFilter===y0||_e.minFilter!==tR&&_e.minFilter!==yv||_e.type===Lh&&e.has("OES_texture_float_linear")===!1)return;if(_e.anisotropy>1||n.get(_e).__currentAnisotropy){const Ct=e.get("EXT_texture_filter_anisotropic");s.texParameterf(Oe,Ct.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(_e.anisotropy,r.getMaxAnisotropy())),n.get(_e).__currentAnisotropy=_e.anisotropy}}}function Jt(Oe,_e){let Ct=!1;Oe.__webglInit===void 0&&(Oe.__webglInit=!0,_e.addEventListener("dispose",ce));const Kt=_e.source;let Zt=S.get(Kt);Zt===void 0&&(Zt={},S.set(Kt,Zt));const Ht=rt(_e);if(Ht!==Oe.__cacheKey){Zt[Ht]===void 0&&(Zt[Ht]={texture:s.createTexture(),usedTimes:0},o.memory.textures++,Ct=!0),Zt[Ht].usedTimes++;const or=Zt[Oe.__cacheKey];or!==void 0&&(Zt[Oe.__cacheKey].usedTimes--,or.usedTimes===0&&oe(_e)),Oe.__cacheKey=Ht,Oe.__webglTexture=Zt[Ht].texture}return Ct}function dt(Oe,_e,Ct){return Math.floor(Math.floor(Oe/Ct)/_e)}function Dt(Oe,_e,Ct,Kt){const Ht=Oe.updateRanges;if(Ht.length===0)t.texSubImage2D(s.TEXTURE_2D,0,0,0,_e.width,_e.height,Ct,Kt,_e.data);else{Ht.sort((Qt,jn)=>Qt.start-jn.start);let or=0;for(let Qt=1;Qt<Ht.length;Qt++){const jn=Ht[or],Mr=Ht[Qt],gr=jn.start+jn.count,Pn=dt(Mr.start,_e.width,4),Sr=dt(jn.start,_e.width,4);Mr.start<=gr+1&&Pn===Sr&&dt(Mr.start+Mr.count-1,_e.width,4)===Pn?jn.count=Math.max(jn.count,Mr.start+Mr.count-jn.start):(++or,Ht[or]=Mr)}Ht.length=or+1;const An=s.getParameter(s.UNPACK_ROW_LENGTH),Hn=s.getParameter(s.UNPACK_SKIP_PIXELS),lr=s.getParameter(s.UNPACK_SKIP_ROWS);s.pixelStorei(s.UNPACK_ROW_LENGTH,_e.width);for(let Qt=0,jn=Ht.length;Qt<jn;Qt++){const Mr=Ht[Qt],gr=Math.floor(Mr.start/4),Pn=Math.ceil(Mr.count/4),Sr=gr%_e.width,Ze=Math.floor(gr/_e.width),Tn=Pn,nn=1;s.pixelStorei(s.UNPACK_SKIP_PIXELS,Sr),s.pixelStorei(s.UNPACK_SKIP_ROWS,Ze),t.texSubImage2D(s.TEXTURE_2D,0,Sr,Ze,Tn,nn,Ct,Kt,_e.data)}Oe.clearUpdateRanges(),s.pixelStorei(s.UNPACK_ROW_LENGTH,An),s.pixelStorei(s.UNPACK_SKIP_PIXELS,Hn),s.pixelStorei(s.UNPACK_SKIP_ROWS,lr)}}function gn(Oe,_e,Ct){let Kt=s.TEXTURE_2D;(_e.isDataArrayTexture||_e.isCompressedArrayTexture)&&(Kt=s.TEXTURE_2D_ARRAY),_e.isData3DTexture&&(Kt=s.TEXTURE_3D);const Zt=Jt(Oe,_e),Ht=_e.source;t.bindTexture(Kt,Oe.__webglTexture,s.TEXTURE0+Ct);const or=n.get(Ht);if(Ht.version!==or.__version||Zt===!0){t.activeTexture(s.TEXTURE0+Ct);const An=Yr.getPrimaries(Yr.workingColorSpace),Hn=_e.colorSpace===bf?null:Yr.getPrimaries(_e.colorSpace),lr=_e.colorSpace===bf||An===Hn?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,_e.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,_e.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,lr);let Qt=L(_e.image,!1,r.maxTextureSize);Qt=fr(_e,Qt);const jn=i.convert(_e.format,_e.colorSpace),Mr=i.convert(_e.type);let gr=Z(_e.internalFormat,jn,Mr,_e.colorSpace,_e.isVideoTexture);_t(Kt,_e);let Pn;const Sr=_e.mipmaps,Ze=_e.isVideoTexture!==!0,Tn=or.__version===void 0||Zt===!0,nn=Ht.dataReady,kn=ie(_e,Qt);if(_e.isDepthTexture)gr=I(_e.format===G_,_e.type),Tn&&(Ze?t.texStorage2D(s.TEXTURE_2D,1,gr,Qt.width,Qt.height):t.texImage2D(s.TEXTURE_2D,0,gr,Qt.width,Qt.height,0,jn,Mr,null));else if(_e.isDataTexture)if(Sr.length>0){Ze&&Tn&&t.texStorage2D(s.TEXTURE_2D,kn,gr,Sr[0].width,Sr[0].height);for(let ln=0,en=Sr.length;ln<en;ln++)Pn=Sr[ln],Ze?nn&&t.texSubImage2D(s.TEXTURE_2D,ln,0,0,Pn.width,Pn.height,jn,Mr,Pn.data):t.texImage2D(s.TEXTURE_2D,ln,gr,Pn.width,Pn.height,0,jn,Mr,Pn.data);_e.generateMipmaps=!1}else Ze?(Tn&&t.texStorage2D(s.TEXTURE_2D,kn,gr,Qt.width,Qt.height),nn&&Dt(_e,Qt,jn,Mr)):t.texImage2D(s.TEXTURE_2D,0,gr,Qt.width,Qt.height,0,jn,Mr,Qt.data);else if(_e.isCompressedTexture)if(_e.isCompressedArrayTexture){Ze&&Tn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,kn,gr,Sr[0].width,Sr[0].height,Qt.depth);for(let ln=0,en=Sr.length;ln<en;ln++)if(Pn=Sr[ln],_e.format!==K0)if(jn!==null)if(Ze){if(nn)if(_e.layerUpdates.size>0){const Yn=X1e(Pn.width,Pn.height,_e.format,_e.type);for(const br of _e.layerUpdates){const xi=Pn.data.subarray(br*Yn/Pn.data.BYTES_PER_ELEMENT,(br+1)*Yn/Pn.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,ln,0,0,br,Pn.width,Pn.height,1,jn,xi)}_e.clearLayerUpdates()}else t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,ln,0,0,0,Pn.width,Pn.height,Qt.depth,jn,Pn.data)}else t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,ln,gr,Pn.width,Pn.height,Qt.depth,0,Pn.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ze?nn&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,ln,0,0,0,Pn.width,Pn.height,Qt.depth,jn,Mr,Pn.data):t.texImage3D(s.TEXTURE_2D_ARRAY,ln,gr,Pn.width,Pn.height,Qt.depth,0,jn,Mr,Pn.data)}else{Ze&&Tn&&t.texStorage2D(s.TEXTURE_2D,kn,gr,Sr[0].width,Sr[0].height);for(let ln=0,en=Sr.length;ln<en;ln++)Pn=Sr[ln],_e.format!==K0?jn!==null?Ze?nn&&t.compressedTexSubImage2D(s.TEXTURE_2D,ln,0,0,Pn.width,Pn.height,jn,Pn.data):t.compressedTexImage2D(s.TEXTURE_2D,ln,gr,Pn.width,Pn.height,0,Pn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ze?nn&&t.texSubImage2D(s.TEXTURE_2D,ln,0,0,Pn.width,Pn.height,jn,Mr,Pn.data):t.texImage2D(s.TEXTURE_2D,ln,gr,Pn.width,Pn.height,0,jn,Mr,Pn.data)}else if(_e.isDataArrayTexture)if(Ze){if(Tn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,kn,gr,Qt.width,Qt.height,Qt.depth),nn)if(_e.layerUpdates.size>0){const ln=X1e(Qt.width,Qt.height,_e.format,_e.type);for(const en of _e.layerUpdates){const Yn=Qt.data.subarray(en*ln/Qt.data.BYTES_PER_ELEMENT,(en+1)*ln/Qt.data.BYTES_PER_ELEMENT);t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,en,Qt.width,Qt.height,1,jn,Mr,Yn)}_e.clearLayerUpdates()}else t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,Qt.width,Qt.height,Qt.depth,jn,Mr,Qt.data)}else t.texImage3D(s.TEXTURE_2D_ARRAY,0,gr,Qt.width,Qt.height,Qt.depth,0,jn,Mr,Qt.data);else if(_e.isData3DTexture)Ze?(Tn&&t.texStorage3D(s.TEXTURE_3D,kn,gr,Qt.width,Qt.height,Qt.depth),nn&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,Qt.width,Qt.height,Qt.depth,jn,Mr,Qt.data)):t.texImage3D(s.TEXTURE_3D,0,gr,Qt.width,Qt.height,Qt.depth,0,jn,Mr,Qt.data);else if(_e.isFramebufferTexture){if(Tn)if(Ze)t.texStorage2D(s.TEXTURE_2D,kn,gr,Qt.width,Qt.height);else{let ln=Qt.width,en=Qt.height;for(let Yn=0;Yn<kn;Yn++)t.texImage2D(s.TEXTURE_2D,Yn,gr,ln,en,0,jn,Mr,null),ln>>=1,en>>=1}}else if(Sr.length>0){if(Ze&&Tn){const ln=gi(Sr[0]);t.texStorage2D(s.TEXTURE_2D,kn,gr,ln.width,ln.height)}for(let ln=0,en=Sr.length;ln<en;ln++)Pn=Sr[ln],Ze?nn&&t.texSubImage2D(s.TEXTURE_2D,ln,0,0,jn,Mr,Pn):t.texImage2D(s.TEXTURE_2D,ln,gr,jn,Mr,Pn);_e.generateMipmaps=!1}else if(Ze){if(Tn){const ln=gi(Qt);t.texStorage2D(s.TEXTURE_2D,kn,gr,ln.width,ln.height)}nn&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,jn,Mr,Qt)}else t.texImage2D(s.TEXTURE_2D,0,gr,jn,Mr,Qt);U(_e)&&P(Kt),or.__version=Ht.version,_e.onUpdate&&_e.onUpdate(_e)}Oe.__version=_e.version}function qt(Oe,_e,Ct){if(_e.image.length!==6)return;const Kt=Jt(Oe,_e),Zt=_e.source;t.bindTexture(s.TEXTURE_CUBE_MAP,Oe.__webglTexture,s.TEXTURE0+Ct);const Ht=n.get(Zt);if(Zt.version!==Ht.__version||Kt===!0){t.activeTexture(s.TEXTURE0+Ct);const or=Yr.getPrimaries(Yr.workingColorSpace),An=_e.colorSpace===bf?null:Yr.getPrimaries(_e.colorSpace),Hn=_e.colorSpace===bf||or===An?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,_e.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,_e.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Hn);const lr=_e.isCompressedTexture||_e.image[0].isCompressedTexture,Qt=_e.image[0]&&_e.image[0].isDataTexture,jn=[];for(let en=0;en<6;en++)!lr&&!Qt?jn[en]=L(_e.image[en],!0,r.maxCubemapSize):jn[en]=Qt?_e.image[en].image:_e.image[en],jn[en]=fr(_e,jn[en]);const Mr=jn[0],gr=i.convert(_e.format,_e.colorSpace),Pn=i.convert(_e.type),Sr=Z(_e.internalFormat,gr,Pn,_e.colorSpace),Ze=_e.isVideoTexture!==!0,Tn=Ht.__version===void 0||Kt===!0,nn=Zt.dataReady;let kn=ie(_e,Mr);_t(s.TEXTURE_CUBE_MAP,_e);let ln;if(lr){Ze&&Tn&&t.texStorage2D(s.TEXTURE_CUBE_MAP,kn,Sr,Mr.width,Mr.height);for(let en=0;en<6;en++){ln=jn[en].mipmaps;for(let Yn=0;Yn<ln.length;Yn++){const br=ln[Yn];_e.format!==K0?gr!==null?Ze?nn&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn,0,0,br.width,br.height,gr,br.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn,Sr,br.width,br.height,0,br.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ze?nn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn,0,0,br.width,br.height,gr,Pn,br.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn,Sr,br.width,br.height,0,gr,Pn,br.data)}}}else{if(ln=_e.mipmaps,Ze&&Tn){ln.length>0&&kn++;const en=gi(jn[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,kn,Sr,en.width,en.height)}for(let en=0;en<6;en++)if(Qt){Ze?nn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,0,0,jn[en].width,jn[en].height,gr,Pn,jn[en].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,Sr,jn[en].width,jn[en].height,0,gr,Pn,jn[en].data);for(let Yn=0;Yn<ln.length;Yn++){const xi=ln[Yn].image[en].image;Ze?nn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn+1,0,0,xi.width,xi.height,gr,Pn,xi.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn+1,Sr,xi.width,xi.height,0,gr,Pn,xi.data)}}else{Ze?nn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,0,0,gr,Pn,jn[en]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,Sr,gr,Pn,jn[en]);for(let Yn=0;Yn<ln.length;Yn++){const br=ln[Yn];Ze?nn&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn+1,0,0,gr,Pn,br.image[en]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+en,Yn+1,Sr,gr,Pn,br.image[en])}}}U(_e)&&P(s.TEXTURE_CUBE_MAP),Ht.__version=Zt.version,_e.onUpdate&&_e.onUpdate(_e)}Oe.__version=_e.version}function wn(Oe,_e,Ct,Kt,Zt,Ht){const or=i.convert(Ct.format,Ct.colorSpace),An=i.convert(Ct.type),Hn=Z(Ct.internalFormat,or,An,Ct.colorSpace),lr=n.get(_e),Qt=n.get(Ct);if(Qt.__renderTarget=_e,!lr.__hasExternalTextures){const jn=Math.max(1,_e.width>>Ht),Mr=Math.max(1,_e.height>>Ht);Zt===s.TEXTURE_3D||Zt===s.TEXTURE_2D_ARRAY?t.texImage3D(Zt,Ht,Hn,jn,Mr,_e.depth,0,or,An,null):t.texImage2D(Zt,Ht,Hn,jn,Mr,0,or,An,null)}t.bindFramebuffer(s.FRAMEBUFFER,Oe),Ar(_e)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Kt,Zt,Qt.__webglTexture,0,Ln(_e)):(Zt===s.TEXTURE_2D||Zt>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&Zt<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,Kt,Zt,Qt.__webglTexture,Ht),t.bindFramebuffer(s.FRAMEBUFFER,null)}function rr(Oe,_e,Ct){if(s.bindRenderbuffer(s.RENDERBUFFER,Oe),_e.depthBuffer){const Kt=_e.depthTexture,Zt=Kt&&Kt.isDepthTexture?Kt.type:null,Ht=I(_e.stencilBuffer,Zt),or=_e.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,An=Ln(_e);Ar(_e)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,An,Ht,_e.width,_e.height):Ct?s.renderbufferStorageMultisample(s.RENDERBUFFER,An,Ht,_e.width,_e.height):s.renderbufferStorage(s.RENDERBUFFER,Ht,_e.width,_e.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,or,s.RENDERBUFFER,Oe)}else{const Kt=_e.textures;for(let Zt=0;Zt<Kt.length;Zt++){const Ht=Kt[Zt],or=i.convert(Ht.format,Ht.colorSpace),An=i.convert(Ht.type),Hn=Z(Ht.internalFormat,or,An,Ht.colorSpace),lr=Ln(_e);Ct&&Ar(_e)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,lr,Hn,_e.width,_e.height):Ar(_e)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,lr,Hn,_e.width,_e.height):s.renderbufferStorage(s.RENDERBUFFER,Hn,_e.width,_e.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function Xn(Oe,_e){if(_e&&_e.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,Oe),!(_e.depthTexture&&_e.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Kt=n.get(_e.depthTexture);Kt.__renderTarget=_e,(!Kt.__webglTexture||_e.depthTexture.image.width!==_e.width||_e.depthTexture.image.height!==_e.height)&&(_e.depthTexture.image.width=_e.width,_e.depthTexture.image.height=_e.height,_e.depthTexture.needsUpdate=!0),ot(_e.depthTexture,0);const Zt=Kt.__webglTexture,Ht=Ln(_e);if(_e.depthTexture.format===EE)Ar(_e)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Zt,0,Ht):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Zt,0);else if(_e.depthTexture.format===G_)Ar(_e)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Zt,0,Ht):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Zt,0);else throw new Error("Unknown depthTexture format")}function ni(Oe){const _e=n.get(Oe),Ct=Oe.isWebGLCubeRenderTarget===!0;if(_e.__boundDepthTexture!==Oe.depthTexture){const Kt=Oe.depthTexture;if(_e.__depthDisposeCallback&&_e.__depthDisposeCallback(),Kt){const Zt=()=>{delete _e.__boundDepthTexture,delete _e.__depthDisposeCallback,Kt.removeEventListener("dispose",Zt)};Kt.addEventListener("dispose",Zt),_e.__depthDisposeCallback=Zt}_e.__boundDepthTexture=Kt}if(Oe.depthTexture&&!_e.__autoAllocateDepthBuffer){if(Ct)throw new Error("target.depthTexture not supported in Cube render targets");const Kt=Oe.texture.mipmaps;Kt&&Kt.length>0?Xn(_e.__webglFramebuffer[0],Oe):Xn(_e.__webglFramebuffer,Oe)}else if(Ct){_e.__webglDepthbuffer=[];for(let Kt=0;Kt<6;Kt++)if(t.bindFramebuffer(s.FRAMEBUFFER,_e.__webglFramebuffer[Kt]),_e.__webglDepthbuffer[Kt]===void 0)_e.__webglDepthbuffer[Kt]=s.createRenderbuffer(),rr(_e.__webglDepthbuffer[Kt],Oe,!1);else{const Zt=Oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Ht=_e.__webglDepthbuffer[Kt];s.bindRenderbuffer(s.RENDERBUFFER,Ht),s.framebufferRenderbuffer(s.FRAMEBUFFER,Zt,s.RENDERBUFFER,Ht)}}else{const Kt=Oe.texture.mipmaps;if(Kt&&Kt.length>0?t.bindFramebuffer(s.FRAMEBUFFER,_e.__webglFramebuffer[0]):t.bindFramebuffer(s.FRAMEBUFFER,_e.__webglFramebuffer),_e.__webglDepthbuffer===void 0)_e.__webglDepthbuffer=s.createRenderbuffer(),rr(_e.__webglDepthbuffer,Oe,!1);else{const Zt=Oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Ht=_e.__webglDepthbuffer;s.bindRenderbuffer(s.RENDERBUFFER,Ht),s.framebufferRenderbuffer(s.FRAMEBUFFER,Zt,s.RENDERBUFFER,Ht)}}t.bindFramebuffer(s.FRAMEBUFFER,null)}function oi(Oe,_e,Ct){const Kt=n.get(Oe);_e!==void 0&&wn(Kt.__webglFramebuffer,Oe,Oe.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),Ct!==void 0&&ni(Oe)}function $r(Oe){const _e=Oe.texture,Ct=n.get(Oe),Kt=n.get(_e);Oe.addEventListener("dispose",ue);const Zt=Oe.textures,Ht=Oe.isWebGLCubeRenderTarget===!0,or=Zt.length>1;if(or||(Kt.__webglTexture===void 0&&(Kt.__webglTexture=s.createTexture()),Kt.__version=_e.version,o.memory.textures++),Ht){Ct.__webglFramebuffer=[];for(let An=0;An<6;An++)if(_e.mipmaps&&_e.mipmaps.length>0){Ct.__webglFramebuffer[An]=[];for(let Hn=0;Hn<_e.mipmaps.length;Hn++)Ct.__webglFramebuffer[An][Hn]=s.createFramebuffer()}else Ct.__webglFramebuffer[An]=s.createFramebuffer()}else{if(_e.mipmaps&&_e.mipmaps.length>0){Ct.__webglFramebuffer=[];for(let An=0;An<_e.mipmaps.length;An++)Ct.__webglFramebuffer[An]=s.createFramebuffer()}else Ct.__webglFramebuffer=s.createFramebuffer();if(or)for(let An=0,Hn=Zt.length;An<Hn;An++){const lr=n.get(Zt[An]);lr.__webglTexture===void 0&&(lr.__webglTexture=s.createTexture(),o.memory.textures++)}if(Oe.samples>0&&Ar(Oe)===!1){Ct.__webglMultisampledFramebuffer=s.createFramebuffer(),Ct.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer);for(let An=0;An<Zt.length;An++){const Hn=Zt[An];Ct.__webglColorRenderbuffer[An]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,Ct.__webglColorRenderbuffer[An]);const lr=i.convert(Hn.format,Hn.colorSpace),Qt=i.convert(Hn.type),jn=Z(Hn.internalFormat,lr,Qt,Hn.colorSpace,Oe.isXRRenderTarget===!0),Mr=Ln(Oe);s.renderbufferStorageMultisample(s.RENDERBUFFER,Mr,jn,Oe.width,Oe.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+An,s.RENDERBUFFER,Ct.__webglColorRenderbuffer[An])}s.bindRenderbuffer(s.RENDERBUFFER,null),Oe.depthBuffer&&(Ct.__webglDepthRenderbuffer=s.createRenderbuffer(),rr(Ct.__webglDepthRenderbuffer,Oe,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Ht){t.bindTexture(s.TEXTURE_CUBE_MAP,Kt.__webglTexture),_t(s.TEXTURE_CUBE_MAP,_e);for(let An=0;An<6;An++)if(_e.mipmaps&&_e.mipmaps.length>0)for(let Hn=0;Hn<_e.mipmaps.length;Hn++)wn(Ct.__webglFramebuffer[An][Hn],Oe,_e,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+An,Hn);else wn(Ct.__webglFramebuffer[An],Oe,_e,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+An,0);U(_e)&&P(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(or){for(let An=0,Hn=Zt.length;An<Hn;An++){const lr=Zt[An],Qt=n.get(lr);t.bindTexture(s.TEXTURE_2D,Qt.__webglTexture),_t(s.TEXTURE_2D,lr),wn(Ct.__webglFramebuffer,Oe,lr,s.COLOR_ATTACHMENT0+An,s.TEXTURE_2D,0),U(lr)&&P(s.TEXTURE_2D)}t.unbindTexture()}else{let An=s.TEXTURE_2D;if((Oe.isWebGL3DRenderTarget||Oe.isWebGLArrayRenderTarget)&&(An=Oe.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(An,Kt.__webglTexture),_t(An,_e),_e.mipmaps&&_e.mipmaps.length>0)for(let Hn=0;Hn<_e.mipmaps.length;Hn++)wn(Ct.__webglFramebuffer[Hn],Oe,_e,s.COLOR_ATTACHMENT0,An,Hn);else wn(Ct.__webglFramebuffer,Oe,_e,s.COLOR_ATTACHMENT0,An,0);U(_e)&&P(An),t.unbindTexture()}Oe.depthBuffer&&ni(Oe)}function $e(Oe){const _e=Oe.textures;for(let Ct=0,Kt=_e.length;Ct<Kt;Ct++){const Zt=_e[Ct];if(U(Zt)){const Ht=$(Oe),or=n.get(Zt).__webglTexture;t.bindTexture(Ht,or),P(Ht),t.unbindTexture()}}}const zs=[],li=[];function Ci(Oe){if(Oe.samples>0){if(Ar(Oe)===!1){const _e=Oe.textures,Ct=Oe.width,Kt=Oe.height;let Zt=s.COLOR_BUFFER_BIT;const Ht=Oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,or=n.get(Oe),An=_e.length>1;if(An)for(let lr=0;lr<_e.length;lr++)t.bindFramebuffer(s.FRAMEBUFFER,or.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+lr,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,or.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+lr,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,or.__webglMultisampledFramebuffer);const Hn=Oe.texture.mipmaps;Hn&&Hn.length>0?t.bindFramebuffer(s.DRAW_FRAMEBUFFER,or.__webglFramebuffer[0]):t.bindFramebuffer(s.DRAW_FRAMEBUFFER,or.__webglFramebuffer);for(let lr=0;lr<_e.length;lr++){if(Oe.resolveDepthBuffer&&(Oe.depthBuffer&&(Zt|=s.DEPTH_BUFFER_BIT),Oe.stencilBuffer&&Oe.resolveStencilBuffer&&(Zt|=s.STENCIL_BUFFER_BIT)),An){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,or.__webglColorRenderbuffer[lr]);const Qt=n.get(_e[lr]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,Qt,0)}s.blitFramebuffer(0,0,Ct,Kt,0,0,Ct,Kt,Zt,s.NEAREST),h===!0&&(zs.length=0,li.length=0,zs.push(s.COLOR_ATTACHMENT0+lr),Oe.depthBuffer&&Oe.resolveDepthBuffer===!1&&(zs.push(Ht),li.push(Ht),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,li)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,zs))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),An)for(let lr=0;lr<_e.length;lr++){t.bindFramebuffer(s.FRAMEBUFFER,or.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+lr,s.RENDERBUFFER,or.__webglColorRenderbuffer[lr]);const Qt=n.get(_e[lr]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,or.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+lr,s.TEXTURE_2D,Qt,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,or.__webglMultisampledFramebuffer)}else if(Oe.depthBuffer&&Oe.resolveDepthBuffer===!1&&h){const _e=Oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[_e])}}}function Ln(Oe){return Math.min(r.maxSamples,Oe.samples)}function Ar(Oe){const _e=n.get(Oe);return Oe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&_e.__useRenderToTexture!==!1}function ar(Oe){const _e=o.render.frame;y.get(Oe)!==_e&&(y.set(Oe,_e),Oe.update())}function fr(Oe,_e){const Ct=Oe.colorSpace,Kt=Oe.format,Zt=Oe.type;return Oe.isCompressedTexture===!0||Oe.isVideoTexture===!0||Ct!==kc&&Ct!==bf&&(Yr.getTransfer(Ct)===xs?(Kt!==K0||Zt!==jo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ct)),_e}function gi(Oe){return typeof HTMLImageElement<"u"&&Oe instanceof HTMLImageElement?(p.width=Oe.naturalWidth||Oe.width,p.height=Oe.naturalHeight||Oe.height):typeof VideoFrame<"u"&&Oe instanceof VideoFrame?(p.width=Oe.displayWidth,p.height=Oe.displayHeight):(p.width=Oe.width,p.height=Oe.height),p}this.allocateTextureUnit=He,this.resetTextureUnits=Be,this.setTexture2D=ot,this.setTexture2DArray=Se,this.setTexture3D=gt,this.setTextureCube=Ae,this.rebindTextures=oi,this.setupRenderTarget=$r,this.updateRenderTargetMipmap=$e,this.updateMultisampleRenderTarget=Ci,this.setupDepthRenderbuffer=ni,this.setupFrameBufferTexture=wn,this.useMultisampledRTT=Ar}function vke(s,e){function t(n,r=bf){let i;const o=Yr.getTransfer(r);if(n===jo)return s.UNSIGNED_BYTE;if(n===Fj)return s.UNSIGNED_SHORT_4_4_4_4;if(n===Lj)return s.UNSIGNED_SHORT_5_5_5_1;if(n===P9e)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===C9e)return s.BYTE;if(n===A9e)return s.SHORT;if(n===wE)return s.UNSIGNED_SHORT;if(n===Oj)return s.INT;if(n===e4)return s.UNSIGNED_INT;if(n===Lh)return s.FLOAT;if(n===t4)return s.HALF_FLOAT;if(n===R9e)return s.ALPHA;if(n===I9e)return s.RGB;if(n===K0)return s.RGBA;if(n===EE)return s.DEPTH_COMPONENT;if(n===G_)return s.DEPTH_STENCIL;if(n===k9e)return s.RED;if(n===Uj)return s.RED_INTEGER;if(n===N9e)return s.RG;if(n===Bj)return s.RG_INTEGER;if(n===zj)return s.RGBA_INTEGER;if(n===MI||n===CI||n===AI||n===PI)if(o===xs)if(i=e.get("WEBGL_compressed_texture_s3tc_srgb"),i!==null){if(n===MI)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===CI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===AI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===PI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(i=e.get("WEBGL_compressed_texture_s3tc"),i!==null){if(n===MI)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===CI)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===AI)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===PI)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===JG||n===eH||n===tH||n===nH)if(i=e.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(n===JG)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===eH)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===tH)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===nH)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===rH||n===iH||n===sH)if(i=e.get("WEBGL_compressed_texture_etc"),i!==null){if(n===rH||n===iH)return o===xs?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===sH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===aH||n===oH||n===lH||n===uH||n===cH||n===hH||n===dH||n===fH||n===pH||n===mH||n===gH||n===vH||n===yH||n===_H)if(i=e.get("WEBGL_compressed_texture_astc"),i!==null){if(n===aH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===oH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===lH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===uH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===cH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===hH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===dH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===fH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===pH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===mH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===gH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===vH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===yH)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===_H)return o===xs?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===RI||n===xH||n===bH)if(i=e.get("EXT_texture_compression_bptc"),i!==null){if(n===RI)return o===xs?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===xH)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===bH)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===D9e||n===SH||n===wH||n===EH)if(i=e.get("EXT_texture_compression_rgtc"),i!==null){if(n===RI)return i.COMPRESSED_RED_RGTC1_EXT;if(n===SH)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===wH)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===EH)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===V_?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}const yke=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_ke=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class xke{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const r=new Wo,i=e.properties.get(r);i.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new $o({vertexShader:yke,fragmentShader:_ke,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Mn(new Cv(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class bke extends Oc{constructor(e,t){super();const n=this;let r=null,i=1,o=null,l="local-floor",h=1,p=null,y=null,x=null,S=null,A=null,k=null;const L=new xke,U=t.getContextAttributes();let P=null,$=null;const Z=[],I=[],ie=new zn;let ce=null;const ue=new Go;ue.viewport=new Ti;const Q=new Go;Q.viewport=new Ti;const oe=[ue,Q],le=new bCe;let J=null,Be=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(dt){let Dt=Z[dt];return Dt===void 0&&(Dt=new Vz,Z[dt]=Dt),Dt.getTargetRaySpace()},this.getControllerGrip=function(dt){let Dt=Z[dt];return Dt===void 0&&(Dt=new Vz,Z[dt]=Dt),Dt.getGripSpace()},this.getHand=function(dt){let Dt=Z[dt];return Dt===void 0&&(Dt=new Vz,Z[dt]=Dt),Dt.getHandSpace()};function He(dt){const Dt=I.indexOf(dt.inputSource);if(Dt===-1)return;const gn=Z[Dt];gn!==void 0&&(gn.update(dt.inputSource,dt.frame,p||o),gn.dispatchEvent({type:dt.type,data:dt.inputSource}))}function rt(){r.removeEventListener("select",He),r.removeEventListener("selectstart",He),r.removeEventListener("selectend",He),r.removeEventListener("squeeze",He),r.removeEventListener("squeezestart",He),r.removeEventListener("squeezeend",He),r.removeEventListener("end",rt),r.removeEventListener("inputsourceschange",ot);for(let dt=0;dt<Z.length;dt++){const Dt=I[dt];Dt!==null&&(I[dt]=null,Z[dt].disconnect(Dt))}J=null,Be=null,L.reset(),e.setRenderTarget(P),A=null,S=null,x=null,r=null,$=null,Jt.stop(),n.isPresenting=!1,e.setPixelRatio(ce),e.setSize(ie.width,ie.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(dt){i=dt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(dt){l=dt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||o},this.setReferenceSpace=function(dt){p=dt},this.getBaseLayer=function(){return S!==null?S:A},this.getBinding=function(){return x},this.getFrame=function(){return k},this.getSession=function(){return r},this.setSession=async function(dt){if(r=dt,r!==null){if(P=e.getRenderTarget(),r.addEventListener("select",He),r.addEventListener("selectstart",He),r.addEventListener("selectend",He),r.addEventListener("squeeze",He),r.addEventListener("squeezestart",He),r.addEventListener("squeezeend",He),r.addEventListener("end",rt),r.addEventListener("inputsourceschange",ot),U.xrCompatible!==!0&&await t.makeXRCompatible(),ce=e.getPixelRatio(),e.getSize(ie),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let gn=null,qt=null,wn=null;U.depth&&(wn=U.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,gn=U.stencil?G_:EE,qt=U.stencil?V_:e4);const rr={colorFormat:t.RGBA8,depthFormat:wn,scaleFactor:i};x=new XRWebGLBinding(r,t),S=x.createProjectionLayer(rr),r.updateRenderState({layers:[S]}),e.setPixelRatio(1),e.setSize(S.textureWidth,S.textureHeight,!1),$=new J0(S.textureWidth,S.textureHeight,{format:K0,type:jo,depthTexture:new Kj(S.textureWidth,S.textureHeight,qt,void 0,void 0,void 0,void 0,void 0,void 0,gn),stencilBuffer:U.stencil,colorSpace:e.outputColorSpace,samples:U.antialias?4:0,resolveDepthBuffer:S.ignoreDepthValues===!1,resolveStencilBuffer:S.ignoreDepthValues===!1})}else{const gn={antialias:U.antialias,alpha:!0,depth:U.depth,stencil:U.stencil,framebufferScaleFactor:i};A=new XRWebGLLayer(r,t,gn),r.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),$=new J0(A.framebufferWidth,A.framebufferHeight,{format:K0,type:jo,colorSpace:e.outputColorSpace,stencilBuffer:U.stencil,resolveDepthBuffer:A.ignoreDepthValues===!1,resolveStencilBuffer:A.ignoreDepthValues===!1})}$.isXRRenderTarget=!0,this.setFoveation(h),p=null,o=await r.requestReferenceSpace(l),Jt.setContext(r),Jt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return L.getDepthTexture()};function ot(dt){for(let Dt=0;Dt<dt.removed.length;Dt++){const gn=dt.removed[Dt],qt=I.indexOf(gn);qt>=0&&(I[qt]=null,Z[qt].disconnect(gn))}for(let Dt=0;Dt<dt.added.length;Dt++){const gn=dt.added[Dt];let qt=I.indexOf(gn);if(qt===-1){for(let rr=0;rr<Z.length;rr++)if(rr>=I.length){I.push(gn),qt=rr;break}else if(I[rr]===null){I[rr]=gn,qt=rr;break}if(qt===-1)break}const wn=Z[qt];wn&&wn.connect(gn)}}const Se=new ke,gt=new ke;function Ae(dt,Dt,gn){Se.setFromMatrixPosition(Dt.matrixWorld),gt.setFromMatrixPosition(gn.matrixWorld);const qt=Se.distanceTo(gt),wn=Dt.projectionMatrix.elements,rr=gn.projectionMatrix.elements,Xn=wn[14]/(wn[10]-1),ni=wn[14]/(wn[10]+1),oi=(wn[9]+1)/wn[5],$r=(wn[9]-1)/wn[5],$e=(wn[8]-1)/wn[0],zs=(rr[8]+1)/rr[0],li=Xn*$e,Ci=Xn*zs,Ln=qt/(-$e+zs),Ar=Ln*-$e;if(Dt.matrixWorld.decompose(dt.position,dt.quaternion,dt.scale),dt.translateX(Ar),dt.translateZ(Ln),dt.matrixWorld.compose(dt.position,dt.quaternion,dt.scale),dt.matrixWorldInverse.copy(dt.matrixWorld).invert(),wn[10]===-1)dt.projectionMatrix.copy(Dt.projectionMatrix),dt.projectionMatrixInverse.copy(Dt.projectionMatrixInverse);else{const ar=Xn+Ln,fr=ni+Ln,gi=li-Ar,Oe=Ci+(qt-Ar),_e=oi*ni/fr*ar,Ct=$r*ni/fr*ar;dt.projectionMatrix.makePerspective(gi,Oe,_e,Ct,ar,fr),dt.projectionMatrixInverse.copy(dt.projectionMatrix).invert()}}function lt(dt,Dt){Dt===null?dt.matrixWorld.copy(dt.matrix):dt.matrixWorld.multiplyMatrices(Dt.matrixWorld,dt.matrix),dt.matrixWorldInverse.copy(dt.matrixWorld).invert()}this.updateCamera=function(dt){if(r===null)return;let Dt=dt.near,gn=dt.far;L.texture!==null&&(L.depthNear>0&&(Dt=L.depthNear),L.depthFar>0&&(gn=L.depthFar)),le.near=Q.near=ue.near=Dt,le.far=Q.far=ue.far=gn,(J!==le.near||Be!==le.far)&&(r.updateRenderState({depthNear:le.near,depthFar:le.far}),J=le.near,Be=le.far),ue.layers.mask=dt.layers.mask|2,Q.layers.mask=dt.layers.mask|4,le.layers.mask=ue.layers.mask|Q.layers.mask;const qt=dt.parent,wn=le.cameras;lt(le,qt);for(let rr=0;rr<wn.length;rr++)lt(wn[rr],qt);wn.length===2?Ae(le,ue,Q):le.projectionMatrix.copy(ue.projectionMatrix),pt(dt,le,qt)};function pt(dt,Dt,gn){gn===null?dt.matrix.copy(Dt.matrixWorld):(dt.matrix.copy(gn.matrixWorld),dt.matrix.invert(),dt.matrix.multiply(Dt.matrixWorld)),dt.matrix.decompose(dt.position,dt.quaternion,dt.scale),dt.updateMatrixWorld(!0),dt.projectionMatrix.copy(Dt.projectionMatrix),dt.projectionMatrixInverse.copy(Dt.projectionMatrixInverse),dt.isPerspectiveCamera&&(dt.fov=H_*2*Math.atan(1/dt.projectionMatrix.elements[5]),dt.zoom=1)}this.getCamera=function(){return le},this.getFoveation=function(){if(!(S===null&&A===null))return h},this.setFoveation=function(dt){h=dt,S!==null&&(S.fixedFoveation=dt),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=dt)},this.hasDepthSensing=function(){return L.texture!==null},this.getDepthSensingMesh=function(){return L.getMesh(le)};let De=null;function _t(dt,Dt){if(y=Dt.getViewerPose(p||o),k=Dt,y!==null){const gn=y.views;A!==null&&(e.setRenderTargetFramebuffer($,A.framebuffer),e.setRenderTarget($));let qt=!1;gn.length!==le.cameras.length&&(le.cameras.length=0,qt=!0);for(let Xn=0;Xn<gn.length;Xn++){const ni=gn[Xn];let oi=null;if(A!==null)oi=A.getViewport(ni);else{const $e=x.getViewSubImage(S,ni);oi=$e.viewport,Xn===0&&(e.setRenderTargetTextures($,$e.colorTexture,$e.depthStencilTexture),e.setRenderTarget($))}let $r=oe[Xn];$r===void 0&&($r=new Go,$r.layers.enable(Xn),$r.viewport=new Ti,oe[Xn]=$r),$r.matrix.fromArray(ni.transform.matrix),$r.matrix.decompose($r.position,$r.quaternion,$r.scale),$r.projectionMatrix.fromArray(ni.projectionMatrix),$r.projectionMatrixInverse.copy($r.projectionMatrix).invert(),$r.viewport.set(oi.x,oi.y,oi.width,oi.height),Xn===0&&(le.matrix.copy($r.matrix),le.matrix.decompose(le.position,le.quaternion,le.scale)),qt===!0&&le.cameras.push($r)}const wn=r.enabledFeatures;if(wn&&wn.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&x){const Xn=x.getDepthInformation(gn[0]);Xn&&Xn.isValid&&Xn.texture&&L.init(e,Xn,r.renderState)}}for(let gn=0;gn<Z.length;gn++){const qt=I[gn],wn=Z[gn];qt!==null&&wn!==void 0&&wn.update(qt,Dt,p||o)}De&&De(dt,Dt),Dt.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Dt}),k=null}const Jt=new g3e;Jt.setAnimationLoop(_t),this.setAnimationLoop=function(dt){De=dt},this.dispose=function(){}}}const $8=new so,Ske=new yr;function wke(s,e){function t(U,P){U.matrixAutoUpdate===!0&&U.updateMatrix(),P.value.copy(U.matrix)}function n(U,P){P.color.getRGB(U.fogColor.value,X9e(s)),P.isFog?(U.fogNear.value=P.near,U.fogFar.value=P.far):P.isFogExp2&&(U.fogDensity.value=P.density)}function r(U,P,$,Z,I){P.isMeshBasicMaterial||P.isMeshLambertMaterial?i(U,P):P.isMeshToonMaterial?(i(U,P),x(U,P)):P.isMeshPhongMaterial?(i(U,P),y(U,P)):P.isMeshStandardMaterial?(i(U,P),S(U,P),P.isMeshPhysicalMaterial&&A(U,P,I)):P.isMeshMatcapMaterial?(i(U,P),k(U,P)):P.isMeshDepthMaterial?i(U,P):P.isMeshDistanceMaterial?(i(U,P),L(U,P)):P.isMeshNormalMaterial?i(U,P):P.isLineBasicMaterial?(o(U,P),P.isLineDashedMaterial&&l(U,P)):P.isPointsMaterial?h(U,P,$,Z):P.isSpriteMaterial?p(U,P):P.isShadowMaterial?(U.color.value.copy(P.color),U.opacity.value=P.opacity):P.isShaderMaterial&&(P.uniformsNeedUpdate=!1)}function i(U,P){U.opacity.value=P.opacity,P.color&&U.diffuse.value.copy(P.color),P.emissive&&U.emissive.value.copy(P.emissive).multiplyScalar(P.emissiveIntensity),P.map&&(U.map.value=P.map,t(P.map,U.mapTransform)),P.alphaMap&&(U.alphaMap.value=P.alphaMap,t(P.alphaMap,U.alphaMapTransform)),P.bumpMap&&(U.bumpMap.value=P.bumpMap,t(P.bumpMap,U.bumpMapTransform),U.bumpScale.value=P.bumpScale,P.side===qa&&(U.bumpScale.value*=-1)),P.normalMap&&(U.normalMap.value=P.normalMap,t(P.normalMap,U.normalMapTransform),U.normalScale.value.copy(P.normalScale),P.side===qa&&U.normalScale.value.negate()),P.displacementMap&&(U.displacementMap.value=P.displacementMap,t(P.displacementMap,U.displacementMapTransform),U.displacementScale.value=P.displacementScale,U.displacementBias.value=P.displacementBias),P.emissiveMap&&(U.emissiveMap.value=P.emissiveMap,t(P.emissiveMap,U.emissiveMapTransform)),P.specularMap&&(U.specularMap.value=P.specularMap,t(P.specularMap,U.specularMapTransform)),P.alphaTest>0&&(U.alphaTest.value=P.alphaTest);const $=e.get(P),Z=$.envMap,I=$.envMapRotation;Z&&(U.envMap.value=Z,$8.copy(I),$8.x*=-1,$8.y*=-1,$8.z*=-1,Z.isCubeTexture&&Z.isRenderTargetTexture===!1&&($8.y*=-1,$8.z*=-1),U.envMapRotation.value.setFromMatrix4(Ske.makeRotationFromEuler($8)),U.flipEnvMap.value=Z.isCubeTexture&&Z.isRenderTargetTexture===!1?-1:1,U.reflectivity.value=P.reflectivity,U.ior.value=P.ior,U.refractionRatio.value=P.refractionRatio),P.lightMap&&(U.lightMap.value=P.lightMap,U.lightMapIntensity.value=P.lightMapIntensity,t(P.lightMap,U.lightMapTransform)),P.aoMap&&(U.aoMap.value=P.aoMap,U.aoMapIntensity.value=P.aoMapIntensity,t(P.aoMap,U.aoMapTransform))}function o(U,P){U.diffuse.value.copy(P.color),U.opacity.value=P.opacity,P.map&&(U.map.value=P.map,t(P.map,U.mapTransform))}function l(U,P){U.dashSize.value=P.dashSize,U.totalSize.value=P.dashSize+P.gapSize,U.scale.value=P.scale}function h(U,P,$,Z){U.diffuse.value.copy(P.color),U.opacity.value=P.opacity,U.size.value=P.size*$,U.scale.value=Z*.5,P.map&&(U.map.value=P.map,t(P.map,U.uvTransform)),P.alphaMap&&(U.alphaMap.value=P.alphaMap,t(P.alphaMap,U.alphaMapTransform)),P.alphaTest>0&&(U.alphaTest.value=P.alphaTest)}function p(U,P){U.diffuse.value.copy(P.color),U.opacity.value=P.opacity,U.rotation.value=P.rotation,P.map&&(U.map.value=P.map,t(P.map,U.mapTransform)),P.alphaMap&&(U.alphaMap.value=P.alphaMap,t(P.alphaMap,U.alphaMapTransform)),P.alphaTest>0&&(U.alphaTest.value=P.alphaTest)}function y(U,P){U.specular.value.copy(P.specular),U.shininess.value=Math.max(P.shininess,1e-4)}function x(U,P){P.gradientMap&&(U.gradientMap.value=P.gradientMap)}function S(U,P){U.metalness.value=P.metalness,P.metalnessMap&&(U.metalnessMap.value=P.metalnessMap,t(P.metalnessMap,U.metalnessMapTransform)),U.roughness.value=P.roughness,P.roughnessMap&&(U.roughnessMap.value=P.roughnessMap,t(P.roughnessMap,U.roughnessMapTransform)),P.envMap&&(U.envMapIntensity.value=P.envMapIntensity)}function A(U,P,$){U.ior.value=P.ior,P.sheen>0&&(U.sheenColor.value.copy(P.sheenColor).multiplyScalar(P.sheen),U.sheenRoughness.value=P.sheenRoughness,P.sheenColorMap&&(U.sheenColorMap.value=P.sheenColorMap,t(P.sheenColorMap,U.sheenColorMapTransform)),P.sheenRoughnessMap&&(U.sheenRoughnessMap.value=P.sheenRoughnessMap,t(P.sheenRoughnessMap,U.sheenRoughnessMapTransform))),P.clearcoat>0&&(U.clearcoat.value=P.clearcoat,U.clearcoatRoughness.value=P.clearcoatRoughness,P.clearcoatMap&&(U.clearcoatMap.value=P.clearcoatMap,t(P.clearcoatMap,U.clearcoatMapTransform)),P.clearcoatRoughnessMap&&(U.clearcoatRoughnessMap.value=P.clearcoatRoughnessMap,t(P.clearcoatRoughnessMap,U.clearcoatRoughnessMapTransform)),P.clearcoatNormalMap&&(U.clearcoatNormalMap.value=P.clearcoatNormalMap,t(P.clearcoatNormalMap,U.clearcoatNormalMapTransform),U.clearcoatNormalScale.value.copy(P.clearcoatNormalScale),P.side===qa&&U.clearcoatNormalScale.value.negate())),P.dispersion>0&&(U.dispersion.value=P.dispersion),P.iridescence>0&&(U.iridescence.value=P.iridescence,U.iridescenceIOR.value=P.iridescenceIOR,U.iridescenceThicknessMinimum.value=P.iridescenceThicknessRange[0],U.iridescenceThicknessMaximum.value=P.iridescenceThicknessRange[1],P.iridescenceMap&&(U.iridescenceMap.value=P.iridescenceMap,t(P.iridescenceMap,U.iridescenceMapTransform)),P.iridescenceThicknessMap&&(U.iridescenceThicknessMap.value=P.iridescenceThicknessMap,t(P.iridescenceThicknessMap,U.iridescenceThicknessMapTransform))),P.transmission>0&&(U.transmission.value=P.transmission,U.transmissionSamplerMap.value=$.texture,U.transmissionSamplerSize.value.set($.width,$.height),P.transmissionMap&&(U.transmissionMap.value=P.transmissionMap,t(P.transmissionMap,U.transmissionMapTransform)),U.thickness.value=P.thickness,P.thicknessMap&&(U.thicknessMap.value=P.thicknessMap,t(P.thicknessMap,U.thicknessMapTransform)),U.attenuationDistance.value=P.attenuationDistance,U.attenuationColor.value.copy(P.attenuationColor)),P.anisotropy>0&&(U.anisotropyVector.value.set(P.anisotropy*Math.cos(P.anisotropyRotation),P.anisotropy*Math.sin(P.anisotropyRotation)),P.anisotropyMap&&(U.anisotropyMap.value=P.anisotropyMap,t(P.anisotropyMap,U.anisotropyMapTransform))),U.specularIntensity.value=P.specularIntensity,U.specularColor.value.copy(P.specularColor),P.specularColorMap&&(U.specularColorMap.value=P.specularColorMap,t(P.specularColorMap,U.specularColorMapTransform)),P.specularIntensityMap&&(U.specularIntensityMap.value=P.specularIntensityMap,t(P.specularIntensityMap,U.specularIntensityMapTransform))}function k(U,P){P.matcap&&(U.matcap.value=P.matcap)}function L(U,P){const $=e.get(P).light;U.referencePosition.value.setFromMatrixPosition($.matrixWorld),U.nearDistance.value=$.shadow.camera.near,U.farDistance.value=$.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function Eke(s,e,t,n){let r={},i={},o=[];const l=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function h($,Z){const I=Z.program;n.uniformBlockBinding($,I)}function p($,Z){let I=r[$.id];I===void 0&&(k($),I=y($),r[$.id]=I,$.addEventListener("dispose",U));const ie=Z.program;n.updateUBOMapping($,ie);const ce=e.render.frame;i[$.id]!==ce&&(S($),i[$.id]=ce)}function y($){const Z=x();$.__bindingPointIndex=Z;const I=s.createBuffer(),ie=$.__size,ce=$.usage;return s.bindBuffer(s.UNIFORM_BUFFER,I),s.bufferData(s.UNIFORM_BUFFER,ie,ce),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,Z,I),I}function x(){for(let $=0;$<l;$++)if(o.indexOf($)===-1)return o.push($),$;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function S($){const Z=r[$.id],I=$.uniforms,ie=$.__cache;s.bindBuffer(s.UNIFORM_BUFFER,Z);for(let ce=0,ue=I.length;ce<ue;ce++){const Q=Array.isArray(I[ce])?I[ce]:[I[ce]];for(let oe=0,le=Q.length;oe<le;oe++){const J=Q[oe];if(A(J,ce,oe,ie)===!0){const Be=J.__offset,He=Array.isArray(J.value)?J.value:[J.value];let rt=0;for(let ot=0;ot<He.length;ot++){const Se=He[ot],gt=L(Se);typeof Se=="number"||typeof Se=="boolean"?(J.__data[0]=Se,s.bufferSubData(s.UNIFORM_BUFFER,Be+rt,J.__data)):Se.isMatrix3?(J.__data[0]=Se.elements[0],J.__data[1]=Se.elements[1],J.__data[2]=Se.elements[2],J.__data[3]=0,J.__data[4]=Se.elements[3],J.__data[5]=Se.elements[4],J.__data[6]=Se.elements[5],J.__data[7]=0,J.__data[8]=Se.elements[6],J.__data[9]=Se.elements[7],J.__data[10]=Se.elements[8],J.__data[11]=0):(Se.toArray(J.__data,rt),rt+=gt.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,Be,J.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function A($,Z,I,ie){const ce=$.value,ue=Z+"_"+I;if(ie[ue]===void 0)return typeof ce=="number"||typeof ce=="boolean"?ie[ue]=ce:ie[ue]=ce.clone(),!0;{const Q=ie[ue];if(typeof ce=="number"||typeof ce=="boolean"){if(Q!==ce)return ie[ue]=ce,!0}else if(Q.equals(ce)===!1)return Q.copy(ce),!0}return!1}function k($){const Z=$.uniforms;let I=0;const ie=16;for(let ue=0,Q=Z.length;ue<Q;ue++){const oe=Array.isArray(Z[ue])?Z[ue]:[Z[ue]];for(let le=0,J=oe.length;le<J;le++){const Be=oe[le],He=Array.isArray(Be.value)?Be.value:[Be.value];for(let rt=0,ot=He.length;rt<ot;rt++){const Se=He[rt],gt=L(Se),Ae=I%ie,lt=Ae%gt.boundary,pt=Ae+lt;I+=lt,pt!==0&&ie-pt<gt.storage&&(I+=ie-pt),Be.__data=new Float32Array(gt.storage/Float32Array.BYTES_PER_ELEMENT),Be.__offset=I,I+=gt.storage}}}const ce=I%ie;return ce>0&&(I+=ie-ce),$.__size=I,$.__cache={},this}function L($){const Z={boundary:0,storage:0};return typeof $=="number"||typeof $=="boolean"?(Z.boundary=4,Z.storage=4):$.isVector2?(Z.boundary=8,Z.storage=8):$.isVector3||$.isColor?(Z.boundary=16,Z.storage=12):$.isVector4?(Z.boundary=16,Z.storage=16):$.isMatrix3?(Z.boundary=48,Z.storage=48):$.isMatrix4?(Z.boundary=64,Z.storage=64):$.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",$),Z}function U($){const Z=$.target;Z.removeEventListener("dispose",U);const I=o.indexOf(Z.__bindingPointIndex);o.splice(I,1),s.deleteBuffer(r[Z.id]),delete r[Z.id],delete i[Z.id]}function P(){for(const $ in r)s.deleteBuffer(r[$]);o=[],r={},i={}}return{bind:h,update:p,dispose:P}}class y_{constructor(e={}){const{canvas:t=eMe(),context:n=null,depth:r=!0,stencil:i=!1,alpha:o=!1,antialias:l=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:p=!1,powerPreference:y="default",failIfMajorPerformanceCaveat:x=!1,reverseDepthBuffer:S=!1}=e;this.isWebGLRenderer=!0;let A;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");A=n.getContextAttributes().alpha}else A=o;const k=new Uint32Array(4),L=new Int32Array(4);let U=null,P=null;const $=[],Z=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=o1,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const I=this;let ie=!1;this._outputColorSpace=ei;let ce=0,ue=0,Q=null,oe=-1,le=null;const J=new Ti,Be=new Ti;let He=null;const rt=new Vn(0);let ot=0,Se=t.width,gt=t.height,Ae=1,lt=null,pt=null;const De=new Ti(0,0,Se,gt),_t=new Ti(0,0,Se,gt);let Jt=!1;const dt=new Yj;let Dt=!1,gn=!1;const qt=new yr,wn=new yr,rr=new ke,Xn=new Ti,ni={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let oi=!1;function $r(){return Q===null?Ae:1}let $e=n;function zs(we,st){return t.getContext(we,st)}try{const we={alpha:!0,depth:r,stencil:i,antialias:l,premultipliedAlpha:h,preserveDrawingBuffer:p,powerPreference:y,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${GE}`),t.addEventListener("webglcontextlost",kn,!1),t.addEventListener("webglcontextrestored",ln,!1),t.addEventListener("webglcontextcreationerror",en,!1),$e===null){const st="webgl2";if($e=zs(st,we),$e===null)throw zs(st)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(we){throw console.error("THREE.WebGLRenderer: "+we.message),we}let li,Ci,Ln,Ar,ar,fr,gi,Oe,_e,Ct,Kt,Zt,Ht,or,An,Hn,lr,Qt,jn,Mr,gr,Pn,Sr,Ze;function Tn(){li=new ORe($e),li.init(),Pn=new vke($e,li),Ci=new ARe($e,li,e,Pn),Ln=new mke($e,li),Ci.reverseDepthBuffer&&S&&Ln.buffers.depth.setReversed(!0),Ar=new URe($e),ar=new nke,fr=new gke($e,li,Ln,ar,Ci,Pn,Ar),gi=new RRe(I),Oe=new DRe(I),_e=new jCe($e),Sr=new MRe($e,_e),Ct=new FRe($e,_e,Ar,Sr),Kt=new zRe($e,Ct,_e,Ar),jn=new BRe($e,Ci,fr),Hn=new PRe(ar),Zt=new tke(I,gi,Oe,li,Ci,Sr,Hn),Ht=new wke(I,ar),or=new ike,An=new cke(li),Qt=new TRe(I,gi,Oe,Ln,Kt,A,h),lr=new fke(I,Kt,Ci),Ze=new Eke($e,Ar,Ci,Ln),Mr=new CRe($e,li,Ar),gr=new LRe($e,li,Ar),Ar.programs=Zt.programs,I.capabilities=Ci,I.extensions=li,I.properties=ar,I.renderLists=or,I.shadowMap=lr,I.state=Ln,I.info=Ar}Tn();const nn=new bke(I,$e);this.xr=nn,this.getContext=function(){return $e},this.getContextAttributes=function(){return $e.getContextAttributes()},this.forceContextLoss=function(){const we=li.get("WEBGL_lose_context");we&&we.loseContext()},this.forceContextRestore=function(){const we=li.get("WEBGL_lose_context");we&&we.restoreContext()},this.getPixelRatio=function(){return Ae},this.setPixelRatio=function(we){we!==void 0&&(Ae=we,this.setSize(Se,gt,!1))},this.getSize=function(we){return we.set(Se,gt)},this.setSize=function(we,st,Pt=!0){if(nn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Se=we,gt=st,t.width=Math.floor(we*Ae),t.height=Math.floor(st*Ae),Pt===!0&&(t.style.width=we+"px",t.style.height=st+"px"),this.setViewport(0,0,we,st)},this.getDrawingBufferSize=function(we){return we.set(Se*Ae,gt*Ae).floor()},this.setDrawingBufferSize=function(we,st,Pt){Se=we,gt=st,Ae=Pt,t.width=Math.floor(we*Pt),t.height=Math.floor(st*Pt),this.setViewport(0,0,we,st)},this.getCurrentViewport=function(we){return we.copy(J)},this.getViewport=function(we){return we.copy(De)},this.setViewport=function(we,st,Pt,bt){we.isVector4?De.set(we.x,we.y,we.z,we.w):De.set(we,st,Pt,bt),Ln.viewport(J.copy(De).multiplyScalar(Ae).round())},this.getScissor=function(we){return we.copy(_t)},this.setScissor=function(we,st,Pt,bt){we.isVector4?_t.set(we.x,we.y,we.z,we.w):_t.set(we,st,Pt,bt),Ln.scissor(Be.copy(_t).multiplyScalar(Ae).round())},this.getScissorTest=function(){return Jt},this.setScissorTest=function(we){Ln.setScissorTest(Jt=we)},this.setOpaqueSort=function(we){lt=we},this.setTransparentSort=function(we){pt=we},this.getClearColor=function(we){return we.copy(Qt.getClearColor())},this.setClearColor=function(){Qt.setClearColor(...arguments)},this.getClearAlpha=function(){return Qt.getClearAlpha()},this.setClearAlpha=function(){Qt.setClearAlpha(...arguments)},this.clear=function(we=!0,st=!0,Pt=!0){let bt=0;if(we){let ht=!1;if(Q!==null){const vn=Q.texture.format;ht=vn===zj||vn===Bj||vn===Uj}if(ht){const vn=Q.texture.type,Dn=vn===jo||vn===e4||vn===wE||vn===V_||vn===Fj||vn===Lj,Bn=Qt.getClearColor(),Wn=Qt.getClearAlpha(),ur=Bn.r,vr=Bn.g,Kn=Bn.b;Dn?(k[0]=ur,k[1]=vr,k[2]=Kn,k[3]=Wn,$e.clearBufferuiv($e.COLOR,0,k)):(L[0]=ur,L[1]=vr,L[2]=Kn,L[3]=Wn,$e.clearBufferiv($e.COLOR,0,L))}else bt|=$e.COLOR_BUFFER_BIT}st&&(bt|=$e.DEPTH_BUFFER_BIT),Pt&&(bt|=$e.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),$e.clear(bt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",kn,!1),t.removeEventListener("webglcontextrestored",ln,!1),t.removeEventListener("webglcontextcreationerror",en,!1),Qt.dispose(),or.dispose(),An.dispose(),ar.dispose(),gi.dispose(),Oe.dispose(),Kt.dispose(),Sr.dispose(),Ze.dispose(),Zt.dispose(),nn.dispose(),nn.removeEventListener("sessionstart",Fu),nn.removeEventListener("sessionend",Ps),Gs.stop()};function kn(we){we.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ie=!0}function ln(){console.log("THREE.WebGLRenderer: Context Restored."),ie=!1;const we=Ar.autoReset,st=lr.enabled,Pt=lr.autoUpdate,bt=lr.needsUpdate,ht=lr.type;Tn(),Ar.autoReset=we,lr.enabled=st,lr.autoUpdate=Pt,lr.needsUpdate=bt,lr.type=ht}function en(we){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",we.statusMessage)}function Yn(we){const st=we.target;st.removeEventListener("dispose",Yn),br(st)}function br(we){xi(we),ar.remove(we)}function xi(we){const st=ar.get(we).programs;st!==void 0&&(st.forEach(function(Pt){Zt.releaseProgram(Pt)}),we.isShaderMaterial&&Zt.releaseShaderCache(we))}this.renderBufferDirect=function(we,st,Pt,bt,ht,vn){st===null&&(st=ni);const Dn=ht.isMesh&&ht.matrixWorld.determinant()<0,Bn=Xh(we,st,Pt,bt,ht);Ln.setMaterial(bt,Dn);let Wn=Pt.index,ur=1;if(bt.wireframe===!0){if(Wn=Ct.getWireframeAttribute(Pt),Wn===void 0)return;ur=2}const vr=Pt.drawRange,Kn=Pt.attributes.position;let Fr=vr.start*ur,Lr=(vr.start+vr.count)*ur;vn!==null&&(Fr=Math.max(Fr,vn.start*ur),Lr=Math.min(Lr,(vn.start+vn.count)*ur)),Wn!==null?(Fr=Math.max(Fr,0),Lr=Math.min(Lr,Wn.count)):Kn!=null&&(Fr=Math.max(Fr,0),Lr=Math.min(Lr,Kn.count));const Di=Lr-Fr;if(Di<0||Di===1/0)return;Sr.setup(ht,bt,Bn,Pt,Wn);let Zi,ri=Mr;if(Wn!==null&&(Zi=_e.get(Wn),ri=gr,ri.setIndex(Zi)),ht.isMesh)bt.wireframe===!0?(Ln.setLineWidth(bt.wireframeLinewidth*$r()),ri.setMode($e.LINES)):ri.setMode($e.TRIANGLES);else if(ht.isLine){let er=bt.linewidth;er===void 0&&(er=1),Ln.setLineWidth(er*$r()),ht.isLineSegments?ri.setMode($e.LINES):ht.isLineLoop?ri.setMode($e.LINE_LOOP):ri.setMode($e.LINE_STRIP)}else ht.isPoints?ri.setMode($e.POINTS):ht.isSprite&&ri.setMode($e.TRIANGLES);if(ht.isBatchedMesh)if(ht._multiDrawInstances!==null)C_("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),ri.renderMultiDrawInstances(ht._multiDrawStarts,ht._multiDrawCounts,ht._multiDrawCount,ht._multiDrawInstances);else if(li.get("WEBGL_multi_draw"))ri.renderMultiDraw(ht._multiDrawStarts,ht._multiDrawCounts,ht._multiDrawCount);else{const er=ht._multiDrawStarts,Qi=ht._multiDrawCounts,Zr=ht._multiDrawCount,Rs=Wn?_e.get(Wn).bytesPerElement:1,qo=ar.get(bt).currentProgram.getUniforms();for(let Na=0;Na<Zr;Na++)qo.setValue($e,"_gl_DrawID",Na),ri.render(er[Na]/Rs,Qi[Na])}else if(ht.isInstancedMesh)ri.renderInstances(Fr,Di,ht.count);else if(Pt.isInstancedBufferGeometry){const er=Pt._maxInstanceCount!==void 0?Pt._maxInstanceCount:1/0,Qi=Math.min(Pt.instanceCount,er);ri.renderInstances(Fr,Di,Qi)}else ri.render(Fr,Di)};function Kr(we,st,Pt){we.transparent===!0&&we.side===X0&&we.forceSinglePass===!1?(we.side=qa,we.needsUpdate=!0,Uc(we,st,Pt),we.side=c1,we.needsUpdate=!0,Uc(we,st,Pt),we.side=X0):Uc(we,st,Pt)}this.compile=function(we,st,Pt=null){Pt===null&&(Pt=we),P=An.get(Pt),P.init(st),Z.push(P),Pt.traverseVisible(function(ht){ht.isLight&&ht.layers.test(st.layers)&&(P.pushLight(ht),ht.castShadow&&P.pushShadow(ht))}),we!==Pt&&we.traverseVisible(function(ht){ht.isLight&&ht.layers.test(st.layers)&&(P.pushLight(ht),ht.castShadow&&P.pushShadow(ht))}),P.setupLights();const bt=new Set;return we.traverse(function(ht){if(!(ht.isMesh||ht.isPoints||ht.isLine||ht.isSprite))return;const vn=ht.material;if(vn)if(Array.isArray(vn))for(let Dn=0;Dn<vn.length;Dn++){const Bn=vn[Dn];Kr(Bn,Pt,ht),bt.add(Bn)}else Kr(vn,Pt,ht),bt.add(vn)}),P=Z.pop(),bt},this.compileAsync=function(we,st,Pt=null){const bt=this.compile(we,st,Pt);return new Promise(ht=>{function vn(){if(bt.forEach(function(Dn){ar.get(Dn).currentProgram.isReady()&&bt.delete(Dn)}),bt.size===0){ht(we);return}setTimeout(vn,10)}li.get("KHR_parallel_shader_compile")!==null?vn():setTimeout(vn,10)})};let Vs=null;function la(we){Vs&&Vs(we)}function Fu(){Gs.stop()}function Ps(){Gs.start()}const Gs=new g3e;Gs.setAnimationLoop(la),typeof self<"u"&&Gs.setContext(self),this.setAnimationLoop=function(we){Vs=we,nn.setAnimationLoop(we),we===null?Gs.stop():Gs.start()},nn.addEventListener("sessionstart",Fu),nn.addEventListener("sessionend",Ps),this.render=function(we,st){if(st!==void 0&&st.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(ie===!0)return;if(we.matrixWorldAutoUpdate===!0&&we.updateMatrixWorld(),st.parent===null&&st.matrixWorldAutoUpdate===!0&&st.updateMatrixWorld(),nn.enabled===!0&&nn.isPresenting===!0&&(nn.cameraAutoUpdate===!0&&nn.updateCamera(st),st=nn.getCamera()),we.isScene===!0&&we.onBeforeRender(I,we,st,Q),P=An.get(we,Z.length),P.init(st),Z.push(P),wn.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),dt.setFromProjectionMatrix(wn),gn=this.localClippingEnabled,Dt=Hn.init(this.clippingPlanes,gn),U=or.get(we,$.length),U.init(),$.push(U),nn.enabled===!0&&nn.isPresenting===!0){const vn=I.xr.getDepthSensingMesh();vn!==null&&_0(vn,st,-1/0,I.sortObjects)}_0(we,st,0,I.sortObjects),U.finish(),I.sortObjects===!0&&U.sort(lt,pt),oi=nn.enabled===!1||nn.isPresenting===!1||nn.hasDepthSensing()===!1,oi&&Qt.addToRenderList(U,we),this.info.render.frame++,Dt===!0&&Hn.beginShadows();const Pt=P.state.shadowsArray;lr.render(Pt,we,st),Dt===!0&&Hn.endShadows(),this.info.autoReset===!0&&this.info.reset();const bt=U.opaque,ht=U.transmissive;if(P.setupLights(),st.isArrayCamera){const vn=st.cameras;if(ht.length>0)for(let Dn=0,Bn=vn.length;Dn<Bn;Dn++){const Wn=vn[Dn];tl(bt,ht,we,Wn)}oi&&Qt.render(we);for(let Dn=0,Bn=vn.length;Dn<Bn;Dn++){const Wn=vn[Dn];$l(U,we,Wn,Wn.viewport)}}else ht.length>0&&tl(bt,ht,we,st),oi&&Qt.render(we),$l(U,we,st);Q!==null&&ue===0&&(fr.updateMultisampleRenderTarget(Q),fr.updateRenderTargetMipmap(Q)),we.isScene===!0&&we.onAfterRender(I,we,st),Sr.resetDefaultState(),oe=-1,le=null,Z.pop(),Z.length>0?(P=Z[Z.length-1],Dt===!0&&Hn.setGlobalState(I.clippingPlanes,P.state.camera)):P=null,$.pop(),$.length>0?U=$[$.length-1]:U=null};function _0(we,st,Pt,bt){if(we.visible===!1)return;if(we.layers.test(st.layers)){if(we.isGroup)Pt=we.renderOrder;else if(we.isLOD)we.autoUpdate===!0&&we.update(st);else if(we.isLight)P.pushLight(we),we.castShadow&&P.pushShadow(we);else if(we.isSprite){if(!we.frustumCulled||dt.intersectsSprite(we)){bt&&Xn.setFromMatrixPosition(we.matrixWorld).applyMatrix4(wn);const Dn=Kt.update(we),Bn=we.material;Bn.visible&&U.push(we,Dn,Bn,Pt,Xn.z,null)}}else if((we.isMesh||we.isLine||we.isPoints)&&(!we.frustumCulled||dt.intersectsObject(we))){const Dn=Kt.update(we),Bn=we.material;if(bt&&(we.boundingSphere!==void 0?(we.boundingSphere===null&&we.computeBoundingSphere(),Xn.copy(we.boundingSphere.center)):(Dn.boundingSphere===null&&Dn.computeBoundingSphere(),Xn.copy(Dn.boundingSphere.center)),Xn.applyMatrix4(we.matrixWorld).applyMatrix4(wn)),Array.isArray(Bn)){const Wn=Dn.groups;for(let ur=0,vr=Wn.length;ur<vr;ur++){const Kn=Wn[ur],Fr=Bn[Kn.materialIndex];Fr&&Fr.visible&&U.push(we,Dn,Fr,Pt,Xn.z,Kn)}}else Bn.visible&&U.push(we,Dn,Bn,Pt,Xn.z,null)}}const vn=we.children;for(let Dn=0,Bn=vn.length;Dn<Bn;Dn++)_0(vn[Dn],st,Pt,bt)}function $l(we,st,Pt,bt){const ht=we.opaque,vn=we.transmissive,Dn=we.transparent;P.setupLightsView(Pt),Dt===!0&&Hn.setGlobalState(I.clippingPlanes,Pt),bt&&Ln.viewport(J.copy(bt)),ht.length>0&&ka(ht,st,Pt),vn.length>0&&ka(vn,st,Pt),Dn.length>0&&ka(Dn,st,Pt),Ln.buffers.depth.setTest(!0),Ln.buffers.depth.setMask(!0),Ln.buffers.color.setMask(!0),Ln.setPolygonOffset(!1)}function tl(we,st,Pt,bt){if((Pt.isScene===!0?Pt.overrideMaterial:null)!==null)return;P.state.transmissionRenderTarget[bt.id]===void 0&&(P.state.transmissionRenderTarget[bt.id]=new J0(1,1,{generateMipmaps:!0,type:li.has("EXT_color_buffer_half_float")||li.has("EXT_color_buffer_float")?t4:jo,minFilter:yv,samples:4,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Yr.workingColorSpace}));const vn=P.state.transmissionRenderTarget[bt.id],Dn=bt.viewport||J;vn.setSize(Dn.z*I.transmissionResolutionScale,Dn.w*I.transmissionResolutionScale);const Bn=I.getRenderTarget();I.setRenderTarget(vn),I.getClearColor(rt),ot=I.getClearAlpha(),ot<1&&I.setClearColor(16777215,.5),I.clear(),oi&&Qt.render(Pt);const Wn=I.toneMapping;I.toneMapping=o1;const ur=bt.viewport;if(bt.viewport!==void 0&&(bt.viewport=void 0),P.setupLightsView(bt),Dt===!0&&Hn.setGlobalState(I.clippingPlanes,bt),ka(we,Pt,bt),fr.updateMultisampleRenderTarget(vn),fr.updateRenderTargetMipmap(vn),li.has("WEBGL_multisampled_render_to_texture")===!1){let vr=!1;for(let Kn=0,Fr=st.length;Kn<Fr;Kn++){const Lr=st[Kn],Di=Lr.object,Zi=Lr.geometry,ri=Lr.material,er=Lr.group;if(ri.side===X0&&Di.layers.test(bt.layers)){const Qi=ri.side;ri.side=qa,ri.needsUpdate=!0,Lc(Di,Pt,bt,Zi,ri,er),ri.side=Qi,ri.needsUpdate=!0,vr=!0}}vr===!0&&(fr.updateMultisampleRenderTarget(vn),fr.updateRenderTargetMipmap(vn))}I.setRenderTarget(Bn),I.setClearColor(rt,ot),ur!==void 0&&(bt.viewport=ur),I.toneMapping=Wn}function ka(we,st,Pt){const bt=st.isScene===!0?st.overrideMaterial:null;for(let ht=0,vn=we.length;ht<vn;ht++){const Dn=we[ht],Bn=Dn.object,Wn=Dn.geometry,ur=Dn.group;let vr=Dn.material;vr.allowOverride===!0&&bt!==null&&(vr=bt),Bn.layers.test(Pt.layers)&&Lc(Bn,st,Pt,Wn,vr,ur)}}function Lc(we,st,Pt,bt,ht,vn){we.onBeforeRender(I,st,Pt,bt,ht,vn),we.modelViewMatrix.multiplyMatrices(Pt.matrixWorldInverse,we.matrixWorld),we.normalMatrix.getNormalMatrix(we.modelViewMatrix),ht.onBeforeRender(I,st,Pt,bt,we,vn),ht.transparent===!0&&ht.side===X0&&ht.forceSinglePass===!1?(ht.side=qa,ht.needsUpdate=!0,I.renderBufferDirect(Pt,st,bt,ht,we,vn),ht.side=c1,ht.needsUpdate=!0,I.renderBufferDirect(Pt,st,bt,ht,we,vn),ht.side=X0):I.renderBufferDirect(Pt,st,bt,ht,we,vn),we.onAfterRender(I,st,Pt,bt,ht,vn)}function Uc(we,st,Pt){st.isScene!==!0&&(st=ni);const bt=ar.get(we),ht=P.state.lights,vn=P.state.shadowsArray,Dn=ht.state.version,Bn=Zt.getParameters(we,ht.state,vn,st,Pt),Wn=Zt.getProgramCacheKey(Bn);let ur=bt.programs;bt.environment=we.isMeshStandardMaterial?st.environment:null,bt.fog=st.fog,bt.envMap=(we.isMeshStandardMaterial?Oe:gi).get(we.envMap||bt.environment),bt.envMapRotation=bt.environment!==null&&we.envMap===null?st.environmentRotation:we.envMapRotation,ur===void 0&&(we.addEventListener("dispose",Yn),ur=new Map,bt.programs=ur);let vr=ur.get(Wn);if(vr!==void 0){if(bt.currentProgram===vr&&bt.lightsStateVersion===Dn)return ua(we,Bn),vr}else Bn.uniforms=Zt.getUniforms(we),we.onBeforeCompile(Bn,I),vr=Zt.acquireProgram(Bn,Wn),ur.set(Wn,vr),bt.uniforms=Bn.uniforms;const Kn=bt.uniforms;return(!we.isShaderMaterial&&!we.isRawShaderMaterial||we.clipping===!0)&&(Kn.clippingPlanes=Hn.uniform),ua(we,Bn),bt.needsLights=Bc(we),bt.lightsStateVersion=Dn,bt.needsLights&&(Kn.ambientLightColor.value=ht.state.ambient,Kn.lightProbe.value=ht.state.probe,Kn.directionalLights.value=ht.state.directional,Kn.directionalLightShadows.value=ht.state.directionalShadow,Kn.spotLights.value=ht.state.spot,Kn.spotLightShadows.value=ht.state.spotShadow,Kn.rectAreaLights.value=ht.state.rectArea,Kn.ltc_1.value=ht.state.rectAreaLTC1,Kn.ltc_2.value=ht.state.rectAreaLTC2,Kn.pointLights.value=ht.state.point,Kn.pointLightShadows.value=ht.state.pointShadow,Kn.hemisphereLights.value=ht.state.hemi,Kn.directionalShadowMap.value=ht.state.directionalShadowMap,Kn.directionalShadowMatrix.value=ht.state.directionalShadowMatrix,Kn.spotShadowMap.value=ht.state.spotShadowMap,Kn.spotLightMatrix.value=ht.state.spotLightMatrix,Kn.spotLightMap.value=ht.state.spotLightMap,Kn.pointShadowMap.value=ht.state.pointShadowMap,Kn.pointShadowMatrix.value=ht.state.pointShadowMatrix),bt.currentProgram=vr,bt.uniformsList=null,vr}function Pf(we){if(we.uniformsList===null){const st=we.currentProgram.getUniforms();we.uniformsList=NI.seqWithValue(st.seq,we.uniforms)}return we.uniformsList}function ua(we,st){const Pt=ar.get(we);Pt.outputColorSpace=st.outputColorSpace,Pt.batching=st.batching,Pt.batchingColor=st.batchingColor,Pt.instancing=st.instancing,Pt.instancingColor=st.instancingColor,Pt.instancingMorph=st.instancingMorph,Pt.skinning=st.skinning,Pt.morphTargets=st.morphTargets,Pt.morphNormals=st.morphNormals,Pt.morphColors=st.morphColors,Pt.morphTargetsCount=st.morphTargetsCount,Pt.numClippingPlanes=st.numClippingPlanes,Pt.numIntersection=st.numClipIntersection,Pt.vertexAlphas=st.vertexAlphas,Pt.vertexTangents=st.vertexTangents,Pt.toneMapping=st.toneMapping}function Xh(we,st,Pt,bt,ht){st.isScene!==!0&&(st=ni),fr.resetTextureUnits();const vn=st.fog,Dn=bt.isMeshStandardMaterial?st.environment:null,Bn=Q===null?I.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:kc,Wn=(bt.isMeshStandardMaterial?Oe:gi).get(bt.envMap||Dn),ur=bt.vertexColors===!0&&!!Pt.attributes.color&&Pt.attributes.color.itemSize===4,vr=!!Pt.attributes.tangent&&(!!bt.normalMap||bt.anisotropy>0),Kn=!!Pt.morphAttributes.position,Fr=!!Pt.morphAttributes.normal,Lr=!!Pt.morphAttributes.color;let Di=o1;bt.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(Di=I.toneMapping);const Zi=Pt.morphAttributes.position||Pt.morphAttributes.normal||Pt.morphAttributes.color,ri=Zi!==void 0?Zi.length:0,er=ar.get(bt),Qi=P.state.lights;if(Dt===!0&&(gn===!0||we!==le)){const Hs=we===le&&bt.id===oe;Hn.setState(bt,we,Hs)}let Zr=!1;bt.version===er.__version?(er.needsLights&&er.lightsStateVersion!==Qi.state.version||er.outputColorSpace!==Bn||ht.isBatchedMesh&&er.batching===!1||!ht.isBatchedMesh&&er.batching===!0||ht.isBatchedMesh&&er.batchingColor===!0&&ht.colorTexture===null||ht.isBatchedMesh&&er.batchingColor===!1&&ht.colorTexture!==null||ht.isInstancedMesh&&er.instancing===!1||!ht.isInstancedMesh&&er.instancing===!0||ht.isSkinnedMesh&&er.skinning===!1||!ht.isSkinnedMesh&&er.skinning===!0||ht.isInstancedMesh&&er.instancingColor===!0&&ht.instanceColor===null||ht.isInstancedMesh&&er.instancingColor===!1&&ht.instanceColor!==null||ht.isInstancedMesh&&er.instancingMorph===!0&&ht.morphTexture===null||ht.isInstancedMesh&&er.instancingMorph===!1&&ht.morphTexture!==null||er.envMap!==Wn||bt.fog===!0&&er.fog!==vn||er.numClippingPlanes!==void 0&&(er.numClippingPlanes!==Hn.numPlanes||er.numIntersection!==Hn.numIntersection)||er.vertexAlphas!==ur||er.vertexTangents!==vr||er.morphTargets!==Kn||er.morphNormals!==Fr||er.morphColors!==Lr||er.toneMapping!==Di||er.morphTargetsCount!==ri)&&(Zr=!0):(Zr=!0,er.__version=bt.version);let Rs=er.currentProgram;Zr===!0&&(Rs=Uc(bt,st,ht));let qo=!1,Na=!1,x0=!1;const Oi=Rs.getUniforms(),gs=er.uniforms;if(Ln.useProgram(Rs.program)&&(qo=!0,Na=!0,x0=!0),bt.id!==oe&&(oe=bt.id,Na=!0),qo||le!==we){Ln.buffers.depth.getReversed()?(qt.copy(we.projectionMatrix),nMe(qt),rMe(qt),Oi.setValue($e,"projectionMatrix",qt)):Oi.setValue($e,"projectionMatrix",we.projectionMatrix),Oi.setValue($e,"viewMatrix",we.matrixWorldInverse);const ws=Oi.map.cameraPosition;ws!==void 0&&ws.setValue($e,rr.setFromMatrixPosition(we.matrixWorld)),Ci.logarithmicDepthBuffer&&Oi.setValue($e,"logDepthBufFC",2/(Math.log(we.far+1)/Math.LN2)),(bt.isMeshPhongMaterial||bt.isMeshToonMaterial||bt.isMeshLambertMaterial||bt.isMeshBasicMaterial||bt.isMeshStandardMaterial||bt.isShaderMaterial)&&Oi.setValue($e,"isOrthographic",we.isOrthographicCamera===!0),le!==we&&(le=we,Na=!0,x0=!0)}if(ht.isSkinnedMesh){Oi.setOptional($e,ht,"bindMatrix"),Oi.setOptional($e,ht,"bindMatrixInverse");const Hs=ht.skeleton;Hs&&(Hs.boneTexture===null&&Hs.computeBoneTexture(),Oi.setValue($e,"boneTexture",Hs.boneTexture,fr))}ht.isBatchedMesh&&(Oi.setOptional($e,ht,"batchingTexture"),Oi.setValue($e,"batchingTexture",ht._matricesTexture,fr),Oi.setOptional($e,ht,"batchingIdTexture"),Oi.setValue($e,"batchingIdTexture",ht._indirectTexture,fr),Oi.setOptional($e,ht,"batchingColorTexture"),ht._colorsTexture!==null&&Oi.setValue($e,"batchingColorTexture",ht._colorsTexture,fr));const Is=Pt.morphAttributes;if((Is.position!==void 0||Is.normal!==void 0||Is.color!==void 0)&&jn.update(ht,Pt,Rs),(Na||er.receiveShadow!==ht.receiveShadow)&&(er.receiveShadow=ht.receiveShadow,Oi.setValue($e,"receiveShadow",ht.receiveShadow)),bt.isMeshGouraudMaterial&&bt.envMap!==null&&(gs.envMap.value=Wn,gs.flipEnvMap.value=Wn.isCubeTexture&&Wn.isRenderTargetTexture===!1?-1:1),bt.isMeshStandardMaterial&&bt.envMap===null&&st.environment!==null&&(gs.envMapIntensity.value=st.environmentIntensity),Na&&(Oi.setValue($e,"toneMappingExposure",I.toneMappingExposure),er.needsLights&&ql(gs,x0),vn&&bt.fog===!0&&Ht.refreshFogUniforms(gs,vn),Ht.refreshMaterialUniforms(gs,bt,Ae,gt,P.state.transmissionRenderTarget[we.id]),NI.upload($e,Pf(er),gs,fr)),bt.isShaderMaterial&&bt.uniformsNeedUpdate===!0&&(NI.upload($e,Pf(er),gs,fr),bt.uniformsNeedUpdate=!1),bt.isSpriteMaterial&&Oi.setValue($e,"center",ht.center),Oi.setValue($e,"modelViewMatrix",ht.modelViewMatrix),Oi.setValue($e,"normalMatrix",ht.normalMatrix),Oi.setValue($e,"modelMatrix",ht.matrixWorld),bt.isShaderMaterial||bt.isRawShaderMaterial){const Hs=bt.uniformsGroups;for(let ws=0,hi=Hs.length;ws<hi;ws++){const ra=Hs[ws];Ze.update(ra,Rs),Ze.bind(ra,Rs)}}return Rs}function ql(we,st){we.ambientLightColor.needsUpdate=st,we.lightProbe.needsUpdate=st,we.directionalLights.needsUpdate=st,we.directionalLightShadows.needsUpdate=st,we.pointLights.needsUpdate=st,we.pointLightShadows.needsUpdate=st,we.spotLights.needsUpdate=st,we.spotLightShadows.needsUpdate=st,we.rectAreaLights.needsUpdate=st,we.hemisphereLights.needsUpdate=st}function Bc(we){return we.isMeshLambertMaterial||we.isMeshToonMaterial||we.isMeshPhongMaterial||we.isMeshStandardMaterial||we.isShadowMaterial||we.isShaderMaterial&&we.lights===!0}this.getActiveCubeFace=function(){return ce},this.getActiveMipmapLevel=function(){return ue},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function(we,st,Pt){const bt=ar.get(we);bt.__autoAllocateDepthBuffer=we.resolveDepthBuffer===!1,bt.__autoAllocateDepthBuffer===!1&&(bt.__useRenderToTexture=!1),ar.get(we.texture).__webglTexture=st,ar.get(we.depthTexture).__webglTexture=bt.__autoAllocateDepthBuffer?void 0:Pt,bt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(we,st){const Pt=ar.get(we);Pt.__webglFramebuffer=st,Pt.__useDefaultFramebuffer=st===void 0};const Yh=$e.createFramebuffer();this.setRenderTarget=function(we,st=0,Pt=0){Q=we,ce=st,ue=Pt;let bt=!0,ht=null,vn=!1,Dn=!1;if(we){const Wn=ar.get(we);if(Wn.__useDefaultFramebuffer!==void 0)Ln.bindFramebuffer($e.FRAMEBUFFER,null),bt=!1;else if(Wn.__webglFramebuffer===void 0)fr.setupRenderTarget(we);else if(Wn.__hasExternalTextures)fr.rebindTextures(we,ar.get(we.texture).__webglTexture,ar.get(we.depthTexture).__webglTexture);else if(we.depthBuffer){const Kn=we.depthTexture;if(Wn.__boundDepthTexture!==Kn){if(Kn!==null&&ar.has(Kn)&&(we.width!==Kn.image.width||we.height!==Kn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");fr.setupDepthRenderbuffer(we)}}const ur=we.texture;(ur.isData3DTexture||ur.isDataArrayTexture||ur.isCompressedArrayTexture)&&(Dn=!0);const vr=ar.get(we).__webglFramebuffer;we.isWebGLCubeRenderTarget?(Array.isArray(vr[st])?ht=vr[st][Pt]:ht=vr[st],vn=!0):we.samples>0&&fr.useMultisampledRTT(we)===!1?ht=ar.get(we).__webglMultisampledFramebuffer:Array.isArray(vr)?ht=vr[Pt]:ht=vr,J.copy(we.viewport),Be.copy(we.scissor),He=we.scissorTest}else J.copy(De).multiplyScalar(Ae).floor(),Be.copy(_t).multiplyScalar(Ae).floor(),He=Jt;if(Pt!==0&&(ht=Yh),Ln.bindFramebuffer($e.FRAMEBUFFER,ht)&&bt&&Ln.drawBuffers(we,ht),Ln.viewport(J),Ln.scissor(Be),Ln.setScissorTest(He),vn){const Wn=ar.get(we.texture);$e.framebufferTexture2D($e.FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wn.__webglTexture,Pt)}else if(Dn){const Wn=ar.get(we.texture),ur=st;$e.framebufferTextureLayer($e.FRAMEBUFFER,$e.COLOR_ATTACHMENT0,Wn.__webglTexture,Pt,ur)}else if(we!==null&&Pt!==0){const Wn=ar.get(we.texture);$e.framebufferTexture2D($e.FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_2D,Wn.__webglTexture,Pt)}oe=-1},this.readRenderTargetPixels=function(we,st,Pt,bt,ht,vn,Dn,Bn=0){if(!(we&&we.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Wn=ar.get(we).__webglFramebuffer;if(we.isWebGLCubeRenderTarget&&Dn!==void 0&&(Wn=Wn[Dn]),Wn){Ln.bindFramebuffer($e.FRAMEBUFFER,Wn);try{const ur=we.textures[Bn],vr=ur.format,Kn=ur.type;if(!Ci.textureFormatReadable(vr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ci.textureTypeReadable(Kn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}st>=0&&st<=we.width-bt&&Pt>=0&&Pt<=we.height-ht&&(we.textures.length>1&&$e.readBuffer($e.COLOR_ATTACHMENT0+Bn),$e.readPixels(st,Pt,bt,ht,Pn.convert(vr),Pn.convert(Kn),vn))}finally{const ur=Q!==null?ar.get(Q).__webglFramebuffer:null;Ln.bindFramebuffer($e.FRAMEBUFFER,ur)}}},this.readRenderTargetPixelsAsync=async function(we,st,Pt,bt,ht,vn,Dn,Bn=0){if(!(we&&we.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Wn=ar.get(we).__webglFramebuffer;if(we.isWebGLCubeRenderTarget&&Dn!==void 0&&(Wn=Wn[Dn]),Wn)if(st>=0&&st<=we.width-bt&&Pt>=0&&Pt<=we.height-ht){Ln.bindFramebuffer($e.FRAMEBUFFER,Wn);const ur=we.textures[Bn],vr=ur.format,Kn=ur.type;if(!Ci.textureFormatReadable(vr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ci.textureTypeReadable(Kn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Fr=$e.createBuffer();$e.bindBuffer($e.PIXEL_PACK_BUFFER,Fr),$e.bufferData($e.PIXEL_PACK_BUFFER,vn.byteLength,$e.STREAM_READ),we.textures.length>1&&$e.readBuffer($e.COLOR_ATTACHMENT0+Bn),$e.readPixels(st,Pt,bt,ht,Pn.convert(vr),Pn.convert(Kn),0);const Lr=Q!==null?ar.get(Q).__webglFramebuffer:null;Ln.bindFramebuffer($e.FRAMEBUFFER,Lr);const Di=$e.fenceSync($e.SYNC_GPU_COMMANDS_COMPLETE,0);return $e.flush(),await tMe($e,Di,4),$e.bindBuffer($e.PIXEL_PACK_BUFFER,Fr),$e.getBufferSubData($e.PIXEL_PACK_BUFFER,0,vn),$e.deleteBuffer(Fr),$e.deleteSync(Di),vn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(we,st=null,Pt=0){const bt=Math.pow(2,-Pt),ht=Math.floor(we.image.width*bt),vn=Math.floor(we.image.height*bt),Dn=st!==null?st.x:0,Bn=st!==null?st.y:0;fr.setTexture2D(we,0),$e.copyTexSubImage2D($e.TEXTURE_2D,Pt,0,0,Dn,Bn,ht,vn),Ln.unbindTexture()};const Kh=$e.createFramebuffer(),Rf=$e.createFramebuffer();this.copyTextureToTexture=function(we,st,Pt=null,bt=null,ht=0,vn=null){vn===null&&(ht!==0?(C_("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),vn=ht,ht=0):vn=0);let Dn,Bn,Wn,ur,vr,Kn,Fr,Lr,Di;const Zi=we.isCompressedTexture?we.mipmaps[vn]:we.image;if(Pt!==null)Dn=Pt.max.x-Pt.min.x,Bn=Pt.max.y-Pt.min.y,Wn=Pt.isBox3?Pt.max.z-Pt.min.z:1,ur=Pt.min.x,vr=Pt.min.y,Kn=Pt.isBox3?Pt.min.z:0;else{const Is=Math.pow(2,-ht);Dn=Math.floor(Zi.width*Is),Bn=Math.floor(Zi.height*Is),we.isDataArrayTexture?Wn=Zi.depth:we.isData3DTexture?Wn=Math.floor(Zi.depth*Is):Wn=1,ur=0,vr=0,Kn=0}bt!==null?(Fr=bt.x,Lr=bt.y,Di=bt.z):(Fr=0,Lr=0,Di=0);const ri=Pn.convert(st.format),er=Pn.convert(st.type);let Qi;st.isData3DTexture?(fr.setTexture3D(st,0),Qi=$e.TEXTURE_3D):st.isDataArrayTexture||st.isCompressedArrayTexture?(fr.setTexture2DArray(st,0),Qi=$e.TEXTURE_2D_ARRAY):(fr.setTexture2D(st,0),Qi=$e.TEXTURE_2D),$e.pixelStorei($e.UNPACK_FLIP_Y_WEBGL,st.flipY),$e.pixelStorei($e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,st.premultiplyAlpha),$e.pixelStorei($e.UNPACK_ALIGNMENT,st.unpackAlignment);const Zr=$e.getParameter($e.UNPACK_ROW_LENGTH),Rs=$e.getParameter($e.UNPACK_IMAGE_HEIGHT),qo=$e.getParameter($e.UNPACK_SKIP_PIXELS),Na=$e.getParameter($e.UNPACK_SKIP_ROWS),x0=$e.getParameter($e.UNPACK_SKIP_IMAGES);$e.pixelStorei($e.UNPACK_ROW_LENGTH,Zi.width),$e.pixelStorei($e.UNPACK_IMAGE_HEIGHT,Zi.height),$e.pixelStorei($e.UNPACK_SKIP_PIXELS,ur),$e.pixelStorei($e.UNPACK_SKIP_ROWS,vr),$e.pixelStorei($e.UNPACK_SKIP_IMAGES,Kn);const Oi=we.isDataArrayTexture||we.isData3DTexture,gs=st.isDataArrayTexture||st.isData3DTexture;if(we.isDepthTexture){const Is=ar.get(we),Hs=ar.get(st),ws=ar.get(Is.__renderTarget),hi=ar.get(Hs.__renderTarget);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,ws.__webglFramebuffer),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,hi.__webglFramebuffer);for(let ra=0;ra<Wn;ra++)Oi&&($e.framebufferTextureLayer($e.READ_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,ar.get(we).__webglTexture,ht,Kn+ra),$e.framebufferTextureLayer($e.DRAW_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,ar.get(st).__webglTexture,vn,Di+ra)),$e.blitFramebuffer(ur,vr,Dn,Bn,Fr,Lr,Dn,Bn,$e.DEPTH_BUFFER_BIT,$e.NEAREST);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,null),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,null)}else if(ht!==0||we.isRenderTargetTexture||ar.has(we)){const Is=ar.get(we),Hs=ar.get(st);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,Kh),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,Rf);for(let ws=0;ws<Wn;ws++)Oi?$e.framebufferTextureLayer($e.READ_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,Is.__webglTexture,ht,Kn+ws):$e.framebufferTexture2D($e.READ_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_2D,Is.__webglTexture,ht),gs?$e.framebufferTextureLayer($e.DRAW_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,Hs.__webglTexture,vn,Di+ws):$e.framebufferTexture2D($e.DRAW_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_2D,Hs.__webglTexture,vn),ht!==0?$e.blitFramebuffer(ur,vr,Dn,Bn,Fr,Lr,Dn,Bn,$e.COLOR_BUFFER_BIT,$e.NEAREST):gs?$e.copyTexSubImage3D(Qi,vn,Fr,Lr,Di+ws,ur,vr,Dn,Bn):$e.copyTexSubImage2D(Qi,vn,Fr,Lr,ur,vr,Dn,Bn);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,null),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,null)}else gs?we.isDataTexture||we.isData3DTexture?$e.texSubImage3D(Qi,vn,Fr,Lr,Di,Dn,Bn,Wn,ri,er,Zi.data):st.isCompressedArrayTexture?$e.compressedTexSubImage3D(Qi,vn,Fr,Lr,Di,Dn,Bn,Wn,ri,Zi.data):$e.texSubImage3D(Qi,vn,Fr,Lr,Di,Dn,Bn,Wn,ri,er,Zi):we.isDataTexture?$e.texSubImage2D($e.TEXTURE_2D,vn,Fr,Lr,Dn,Bn,ri,er,Zi.data):we.isCompressedTexture?$e.compressedTexSubImage2D($e.TEXTURE_2D,vn,Fr,Lr,Zi.width,Zi.height,ri,Zi.data):$e.texSubImage2D($e.TEXTURE_2D,vn,Fr,Lr,Dn,Bn,ri,er,Zi);$e.pixelStorei($e.UNPACK_ROW_LENGTH,Zr),$e.pixelStorei($e.UNPACK_IMAGE_HEIGHT,Rs),$e.pixelStorei($e.UNPACK_SKIP_PIXELS,qo),$e.pixelStorei($e.UNPACK_SKIP_ROWS,Na),$e.pixelStorei($e.UNPACK_SKIP_IMAGES,x0),vn===0&&st.generateMipmaps&&$e.generateMipmap(Qi),Ln.unbindTexture()},this.copyTextureToTexture3D=function(we,st,Pt=null,bt=null,ht=0){return C_('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(we,st,Pt,bt,ht)},this.initRenderTarget=function(we){ar.get(we).__webglFramebuffer===void 0&&fr.setupRenderTarget(we)},this.initTexture=function(we){we.isCubeTexture?fr.setTextureCube(we,0):we.isData3DTexture?fr.setTexture3D(we,0):we.isDataArrayTexture||we.isCompressedArrayTexture?fr.setTexture2DArray(we,0):fr.setTexture2D(we,0),Ln.unbindTexture()},this.resetState=function(){ce=0,ue=0,Q=null,Ln.reset(),Sr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return s1}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Yr._getDrawingBufferColorSpace(e),t.unpackColorSpace=Yr._getUnpackColorSpace()}}const iV=!0,sV=document.location.hash.search("editor")>-1;var tk=(s=>(s.LOAD_COMPLETE="Events::loadComplete",s))(tk||{});const FH=new Oc;function aV(s,e,t,n){return new(t||(t=Promise))(function(r,i){function o(p){try{h(n.next(p))}catch(y){i(y)}}function l(p){try{h(n.throw(p))}catch(y){i(y)}}function h(p){var y;p.done?r(p.value):(y=p.value,y instanceof t?y:new t(function(x){x(y)})).then(o,l)}h((n=n.apply(s,[])).next())})}const Tke=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function _me(s){return s=s.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const b3e=typeof window>"u",t1=(()=>{if(b3e)return;const{userAgent:s,platform:e,maxTouchPoints:t}=window.navigator,n=/(iphone|ipod|ipad)/i.test(s),r=e==="iPad"||e==="MacIntel"&&t>0&&!window.MSStream;return{isIpad:r,isMobile:/android/i.test(s)||n||r,isSafari12:/Version\/12.+Safari/.test(s),isFirefox:/Firefox/.test(s)}})();function Mke(s,e,t){if(!t)return[e];const n=function(p){const y=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,x=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,S=p.createShader(35633),A=p.createShader(35632),k=p.createProgram();if(!(A&&S&&k))return;p.shaderSource(S,y),p.shaderSource(A,x),p.compileShader(S),p.compileShader(A),p.attachShader(k,S),p.attachShader(k,A),p.linkProgram(k),p.detachShader(k,S),p.detachShader(k,A),p.deleteShader(S),p.deleteShader(A),p.useProgram(k);const L=p.createBuffer();p.bindBuffer(34962,L),p.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const U=p.getAttribLocation(k,"aPosition");p.vertexAttribPointer(U,3,5126,!1,0,0),p.enableVertexAttribArray(U),p.clearColor(1,1,1,1),p.clear(16384),p.viewport(0,0,1,1),p.drawArrays(4,0,3);const P=new Uint8Array(4);return p.readPixels(0,0,1,1,6408,5121,P),p.deleteProgram(k),p.deleteBuffer(L),P.join("")}(s),r="801621810",i="8016218135",o="80162181161",l=t1!=null&&t1.isIpad?[["a7",o,12],["a8",i,15],["a8x",i,15],["a9",i,15],["a9x",i,15],["a10",i,15],["a10x",i,15],["a12",r,15],["a12x",r,15],["a12z",r,15],["a14",r,15],["a15",r,15],["m1",r,15],["m2",r,15]]:[["a7",o,12],["a8",i,12],["a9",i,15],["a10",i,15],["a11",r,15],["a12",r,15],["a13",r,15],["a14",r,15],["a15",r,15],["a16",r,15],["a17",r,15]];let h;return n==="80162181255"?h=l.filter(([,,p])=>p>=14):(h=l.filter(([,p])=>p===n),h.length||(h=l)),h.map(([p])=>`apple ${p} gpu`)}let xme=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}};const oV=[],bme=[];function Cke(s,e){if(s===e)return 0;const t=s;s.length>e.length&&(s=e,e=t);let n=s.length,r=e.length;for(;n>0&&s.charCodeAt(~-n)===e.charCodeAt(~-r);)n--,r--;let i,o=0;for(;o<n&&s.charCodeAt(o)===e.charCodeAt(o);)o++;if(n-=o,r-=o,n===0)return r;let l,h,p=0,y=0,x=0;for(;y<n;)bme[y]=s.charCodeAt(o+y),oV[y]=++y;for(;x<r;)for(i=e.charCodeAt(o+x),l=x++,p=x,y=0;y<n;y++)h=i===bme[y]?l:l+1,l=oV[y],p=oV[y]=l>p?h>p?p+1:h:h>l?l+1:h;return p}function Ake(s){return s!=null}const Pke=({mobileTiers:s=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:n,failIfMajorPerformanceCaveat:r=!1,benchmarksURL:i="https://unpkg.com/detect-gpu@5.0.70/dist/benchmarks"}={})=>aV(void 0,void 0,void 0,function*(){const o={};if(b3e)return{tier:0,type:"SSR"};const{isIpad:l=!!(t1!=null&&t1.isIpad),isMobile:h=!!(t1!=null&&t1.isMobile),screenSize:p=window.screen,loadBenchmarks:y=ie=>aV(void 0,void 0,void 0,function*(){const ce=yield fetch(`${i}/${ie}`).then(ue=>ue.json());if(parseInt(ce.shift().split(".")[0],10)<4)throw new xme("Detect GPU benchmark data is out of date. Please update to version 4x");return ce})}=t;let{renderer:x}=t;const S=(ie,ce,ue,Q,oe)=>({device:oe,fps:Q,gpu:ue,isMobile:h,tier:ie,type:ce});let A,k="";if(x)x=_me(x),A=[x];else{const ie=n||function(ue,Q=!1){const oe={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:Q,powerPreference:"high-performance",stencil:!1};ue&&delete oe.powerPreference;const le=window.document.createElement("canvas"),J=le.getContext("webgl",oe)||le.getContext("experimental-webgl",oe);return J??void 0}(t1==null?void 0:t1.isSafari12,r);if(!ie)return S(0,"WEBGL_UNSUPPORTED");const ce=t1!=null&&t1.isFirefox?null:ie.getExtension("WEBGL_debug_renderer_info");if(x=ce?ie.getParameter(ce.UNMASKED_RENDERER_WEBGL):ie.getParameter(ie.RENDERER),!x)return S(1,"FALLBACK");k=x,x=_me(x),A=function(ue,Q,oe){return Q==="apple gpu"?Mke(ue,Q,oe):[Q]}(ie,x,h)}const L=(yield Promise.all(A.map(function(ie){var ce;return aV(this,void 0,void 0,function*(){const ue=(Jt=>{const dt=h?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const Dt of dt)if(Jt.includes(Dt))return Dt})(ie);if(!ue)return;const Q=`${h?"m":"d"}-${ue}${l?"-ipad":""}.json`,oe=o[Q]=(ce=o[Q])!==null&&ce!==void 0?ce:y(Q);let le;try{le=yield oe}catch(Jt){if(Jt instanceof xme)throw Jt;return}const J=function(Jt){var dt;const Dt=(Jt=Jt.replace(/\([^)]+\)/,"")).match(/\d+/)||Jt.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(dt=Dt==null?void 0:Dt.join("").replace(/\W|amd/g,""))!==null&&dt!==void 0?dt:""}(ie);let Be=le.filter(([,Jt])=>Jt===J);Be.length||(Be=le.filter(([Jt])=>Jt.includes(ie)));const He=Be.length;if(He===0)return;const rt=ie.split(/[.,()\[\]/\s]/g).sort().filter((Jt,dt,Dt)=>dt===0||Jt!==Dt[dt-1]).join(" ");let ot,[Se,,,,gt]=He>1?Be.map(Jt=>[Jt,Cke(rt,Jt[2])]).sort(([,Jt],[,dt])=>Jt-dt)[0][0]:Be[0],Ae=Number.MAX_VALUE;const{devicePixelRatio:lt}=window,pt=p.width*lt*p.height*lt;for(const Jt of gt){const[dt,Dt]=Jt,gn=dt*Dt,qt=Math.abs(pt-gn);qt<Ae&&(Ae=qt,ot=Jt)}if(!ot)return;const[,,De,_t]=ot;return[Ae,De,Se,_t]})}))).filter(Ake).sort(([ie=Number.MAX_VALUE,ce],[ue=Number.MAX_VALUE,Q])=>ie===ue?ce-Q:ie-ue);if(!L.length){const ie=Tke.find(ce=>x.includes(ce));return ie?S(0,"BLOCKLISTED",ie):S(1,"FALLBACK",`${x} (${k})`)}const[,U,P,$]=L[0];if(U===-1)return S(0,"BLOCKLISTED",P,U,$);const Z=h?s:e;let I=0;for(let ie=0;ie<Z.length;ie++)U>=Z[ie]&&(I=ie);return S(I,"BENCHMARK",P,U,$)});function Rke(s){let e=0;const t=performance.now();function n(){e++;const r=performance.now();if(r-t>=100){const i=e/((r-t)/1e3),o=Math.round(i/30)*30;s(o)}else requestAnimationFrame(n)}requestAnimationFrame(n)}function Ike(s=!1,e=!1){return new Promise(t=>{Pke().then(n=>{let r=!1;const i=document.createElement("canvas"),o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(r="transferControlToOffscreen"in i,o){const h=navigator.userAgent.match(/version\/(\d+)/i);r=(h?parseInt(h[1]):0)>=17}const l={dpr:devicePixelRatio,fps:30,width:innerWidth,height:innerHeight,mobile:n.isMobile!==void 0?n.isMobile:!1,supportOffScreenCanvas:r,supportWebGPU:!!navigator.gpu,quality:"Low",dev:s,editor:e};n.tier===3?l.quality="High":n.tier===2&&(l.quality="Medium"),Rke(h=>{l.fps=h,t(l)})})})}class kke{constructor(){Qe(this,"assets",{audio:new Map,image:new Map,json:new Map,model:new Map,video:new Map});Qe(this,"components",new Map);Qe(this,"settings",{dpr:1,fps:30,width:0,height:0,mobile:!1,supportOffScreenCanvas:!1,supportWebGPU:!1,quality:"Low",dev:!1,editor:!1});Qe(this,"onUpdateCallback");Qe(this,"playing",!1);Qe(this,"rafID",-1);Qe(this,"play",()=>{this.playing||(this.playing=!0,this.onUpdate())});Qe(this,"pause",()=>{this.playing&&(this.playing=!1,cancelAnimationFrame(this.rafID),this.rafID=-1)});Qe(this,"onUpdate",()=>{this.update(),this.isApp&&this.draw(),this.onUpdateCallback&&this.onUpdateCallback(),this.rafID=requestAnimationFrame(this.onUpdate)})}dispose(){this.pause(),this.components.forEach(e=>e.dispose()),this.components.clear()}detectSettings(e=!1,t=!1){return new Promise(n=>{Ike(e,t).then(r=>{this.settings=r,n()})})}update(){}draw(){}addComponent(e,t){this.components.set(e,t)}get debugEnabled(){return this.settings.dev}get isApp(){return!this.editor}set isApp(e){this.editor=!e}get editor(){return this.settings.editor}set editor(e){this.settings.editor=e}}var Jw={exports:{}};Jw.exports;var Sme;function Nke(){return Sme||(Sme=1,function(s,e){var t=Object.create,n=Object.defineProperty,r=Object.defineProperties,i=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,p=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,S=(w,D,W)=>D in w?n(w,D,{enumerable:!0,configurable:!0,writable:!0,value:W}):w[D]=W,A=(w,D)=>{for(var W in D||(D={}))y.call(D,W)&&S(w,W,D[W]);if(h)for(var W of h(D))x.call(D,W)&&S(w,W,D[W]);return w},k=(w,D)=>r(w,o(D)),L=(w,D)=>function(){return D||(0,w[l(w)[0]])((D={exports:{}}).exports,D),D.exports},U=(w,D)=>{for(var W in D)n(w,W,{get:D[W],enumerable:!0})},P=(w,D,W,re)=>{if(D&&typeof D=="object"||typeof D=="function")for(let me of l(D))!y.call(w,me)&&me!==W&&n(w,me,{get:()=>D[me],enumerable:!(re=i(D,me))||re.enumerable});return w},$=(w,D,W)=>(W=w!=null?t(p(w)):{},P(!w||!w.__esModule?n(W,"default",{value:w,enumerable:!0}):W,w)),Z=w=>P(n({},"__esModule",{value:!0}),w),I=(w,D,W)=>(S(w,typeof D!="symbol"?D+"":D,W),W),ie=L({"../node_modules/timing-function/lib/UnitBezier.js"(w,D){D.exports=function(){function W(re,me,Ee,Ge){this.set(re,me,Ee,Ge)}return W.prototype.set=function(re,me,Ee,Ge){this._cx=3*re,this._bx=3*(Ee-re)-this._cx,this._ax=1-this._cx-this._bx,this._cy=3*me,this._by=3*(Ge-me)-this._cy,this._ay=1-this._cy-this._by},W.epsilon=1e-6,W.prototype._sampleCurveX=function(re){return((this._ax*re+this._bx)*re+this._cx)*re},W.prototype._sampleCurveY=function(re){return((this._ay*re+this._by)*re+this._cy)*re},W.prototype._sampleCurveDerivativeX=function(re){return(3*this._ax*re+2*this._bx)*re+this._cx},W.prototype._solveCurveX=function(re,me){var Ee,Ge,ft,Tt,zt,xn;for(ft=void 0,Tt=void 0,zt=void 0,xn=void 0,Ee=void 0,Ge=void 0,zt=re,Ge=0;Ge<8;){if(xn=this._sampleCurveX(zt)-re,Math.abs(xn)<me)return zt;if(Ee=this._sampleCurveDerivativeX(zt),Math.abs(Ee)<me)break;zt=zt-xn/Ee,Ge++}if(ft=0,Tt=1,zt=re,zt<ft)return ft;if(zt>Tt)return Tt;for(;ft<Tt;){if(xn=this._sampleCurveX(zt),Math.abs(xn-re)<me)return zt;re>xn?ft=zt:Tt=zt,zt=(Tt-ft)*.5+ft}return zt},W.prototype.solve=function(re,me){return this._sampleCurveY(this._solveCurveX(re,me))},W.prototype.solveSimple=function(re){return this._sampleCurveY(this._solveCurveX(re,1e-6))},W}()}}),ce=L({"../node_modules/levenshtein-edit-distance/index.js"(w,D){var W,re;W=[],re=[];function me(Ee,Ge,ft){var Tt,zt,xn,bn,On,pr,ir,Te;if(Ee===Ge)return 0;if(Tt=Ee.length,zt=Ge.length,Tt===0)return zt;if(zt===0)return Tt;for(ft&&(Ee=Ee.toLowerCase(),Ge=Ge.toLowerCase()),ir=0;ir<Tt;)re[ir]=Ee.charCodeAt(ir),W[ir]=++ir;for(Te=0;Te<zt;)for(xn=Ge.charCodeAt(Te),bn=On=Te++,ir=-1;++ir<Tt;)pr=xn===re[ir]?On:On+1,On=W[ir],W[ir]=bn=On>bn?pr>bn?bn+1:pr:pr>On?On+1:pr;return bn}D.exports=me}}),ue=L({"../node_modules/propose/propose.js"(w,D){var W=ce();function re(){var me,Ee,Ge,ft,Tt,zt=0,xn=arguments[0],bn=arguments[1],On=bn.length,pr=arguments[2];pr&&(ft=pr.threshold,Tt=pr.ignoreCase),ft===void 0&&(ft=0);for(var ir=0;ir<On;++ir)Tt?Ee=W(xn,bn[ir],!0):Ee=W(xn,bn[ir]),Ee>xn.length?me=1-Ee/bn[ir].length:me=1-Ee/xn.length,me>zt&&(zt=me,Ge=bn[ir]);return zt>=ft?Ge:null}D.exports=re}}),Q=L({"../node_modules/fast-deep-equal/index.js"(w,D){D.exports=function W(re,me){if(re===me)return!0;if(re&&me&&typeof re=="object"&&typeof me=="object"){if(re.constructor!==me.constructor)return!1;var Ee,Ge,ft;if(Array.isArray(re)){if(Ee=re.length,Ee!=me.length)return!1;for(Ge=Ee;Ge--!==0;)if(!W(re[Ge],me[Ge]))return!1;return!0}if(re.constructor===RegExp)return re.source===me.source&&re.flags===me.flags;if(re.valueOf!==Object.prototype.valueOf)return re.valueOf()===me.valueOf();if(re.toString!==Object.prototype.toString)return re.toString()===me.toString();if(ft=Object.keys(re),Ee=ft.length,Ee!==Object.keys(me).length)return!1;for(Ge=Ee;Ge--!==0;)if(!Object.prototype.hasOwnProperty.call(me,ft[Ge]))return!1;for(Ge=Ee;Ge--!==0;){var Tt=ft[Ge];if(!W(re[Tt],me[Tt]))return!1}return!0}return re!==re&&me!==me}}}),oe={};U(oe,{createRafDriver:()=>By,getProject:()=>rb,notify:()=>bm,onChange:()=>r6,types:()=>Ux,val:()=>z5}),s.exports=Z(oe);var le={};U(le,{createRafDriver:()=>By,getProject:()=>rb,notify:()=>bm,onChange:()=>r6,types:()=>Ux,val:()=>z5});var J=mn(),Be=class{constructor(){I(this,"atom",new J.Atom({projects:{}}))}add(w,D){this.atom.setByPointer(W=>W.projects[w],D)}get(w){return this.atom.get().projects[w]}has(w){return!!this.get(w)}},He=new Be,rt=He,ot=new WeakMap;function Se(w){return ot.get(w)}function gt(w,D){ot.set(w,D)}var Ae=[],lt=Array.isArray,pt=lt,De=typeof xa=="object"&&xa&&xa.Object===Object&&xa,_t=De,Jt=typeof self=="object"&&self&&self.Object===Object&&self,dt=_t||Jt||Function("return this")(),Dt=dt,gn=Dt.Symbol,qt=gn,wn=Object.prototype,rr=wn.hasOwnProperty,Xn=wn.toString,ni=qt?qt.toStringTag:void 0;function oi(w){var D=rr.call(w,ni),W=w[ni];try{w[ni]=void 0;var re=!0}catch{}var me=Xn.call(w);return re&&(D?w[ni]=W:delete w[ni]),me}var $r=oi,$e=Object.prototype,zs=$e.toString;function li(w){return zs.call(w)}var Ci=li,Ln="[object Null]",Ar="[object Undefined]",ar=qt?qt.toStringTag:void 0;function fr(w){return w==null?w===void 0?Ar:Ln:ar&&ar in Object(w)?$r(w):Ci(w)}var gi=fr;function Oe(w){return w!=null&&typeof w=="object"}var _e=Oe,Ct="[object Symbol]";function Kt(w){return typeof w=="symbol"||_e(w)&&gi(w)==Ct}var Zt=Kt,Ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,or=/^\w*$/;function An(w,D){if(pt(w))return!1;var W=typeof w;return W=="number"||W=="symbol"||W=="boolean"||w==null||Zt(w)?!0:or.test(w)||!Ht.test(w)||D!=null&&w in Object(D)}var Hn=An;function lr(w){var D=typeof w;return w!=null&&(D=="object"||D=="function")}var Qt=lr,jn="[object AsyncFunction]",Mr="[object Function]",gr="[object GeneratorFunction]",Pn="[object Proxy]";function Sr(w){if(!Qt(w))return!1;var D=gi(w);return D==Mr||D==gr||D==jn||D==Pn}var Ze=Sr,Tn=Dt["__core-js_shared__"],nn=Tn,kn=function(){var w=/[^.]+$/.exec(nn&&nn.keys&&nn.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}();function ln(w){return!!kn&&kn in w}var en=ln,Yn=Function.prototype,br=Yn.toString;function xi(w){if(w!=null){try{return br.call(w)}catch{}try{return w+""}catch{}}return""}var Kr=xi,Vs=/[\\^$.*+?()[\]{}|]/g,la=/^\[object .+?Constructor\]$/,Fu=Function.prototype,Ps=Object.prototype,Gs=Fu.toString,_0=Ps.hasOwnProperty,$l=RegExp("^"+Gs.call(_0).replace(Vs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tl(w){if(!Qt(w)||en(w))return!1;var D=Ze(w)?$l:la;return D.test(Kr(w))}var ka=tl;function Lc(w,D){return w==null?void 0:w[D]}var Uc=Lc;function Pf(w,D){var W=Uc(w,D);return ka(W)?W:void 0}var ua=Pf,Xh=ua(Object,"create"),ql=Xh;function Bc(){this.__data__=ql?ql(null):{},this.size=0}var Yh=Bc;function Kh(w){var D=this.has(w)&&delete this.__data__[w];return this.size-=D?1:0,D}var Rf=Kh,we="__lodash_hash_undefined__",st=Object.prototype,Pt=st.hasOwnProperty;function bt(w){var D=this.__data__;if(ql){var W=D[w];return W===we?void 0:W}return Pt.call(D,w)?D[w]:void 0}var ht=bt,vn=Object.prototype,Dn=vn.hasOwnProperty;function Bn(w){var D=this.__data__;return ql?D[w]!==void 0:Dn.call(D,w)}var Wn=Bn,ur="__lodash_hash_undefined__";function vr(w,D){var W=this.__data__;return this.size+=this.has(w)?0:1,W[w]=ql&&D===void 0?ur:D,this}var Kn=vr;function Fr(w){var D=-1,W=w==null?0:w.length;for(this.clear();++D<W;){var re=w[D];this.set(re[0],re[1])}}Fr.prototype.clear=Yh,Fr.prototype.delete=Rf,Fr.prototype.get=ht,Fr.prototype.has=Wn,Fr.prototype.set=Kn;var Lr=Fr;function Di(){this.__data__=[],this.size=0}var Zi=Di;function ri(w,D){return w===D||w!==w&&D!==D}var er=ri;function Qi(w,D){for(var W=w.length;W--;)if(er(w[W][0],D))return W;return-1}var Zr=Qi,Rs=Array.prototype,qo=Rs.splice;function Na(w){var D=this.__data__,W=Zr(D,w);if(W<0)return!1;var re=D.length-1;return W==re?D.pop():qo.call(D,W,1),--this.size,!0}var x0=Na;function Oi(w){var D=this.__data__,W=Zr(D,w);return W<0?void 0:D[W][1]}var gs=Oi;function Is(w){return Zr(this.__data__,w)>-1}var Hs=Is;function ws(w,D){var W=this.__data__,re=Zr(W,w);return re<0?(++this.size,W.push([w,D])):W[re][1]=D,this}var hi=ws;function ra(w){var D=-1,W=w==null?0:w.length;for(this.clear();++D<W;){var re=w[D];this.set(re[0],re[1])}}ra.prototype.clear=Zi,ra.prototype.delete=x0,ra.prototype.get=gs,ra.prototype.has=Hs,ra.prototype.set=hi;var Zh=ra,m1=ua(Dt,"Map"),Xl=m1;function g1(){this.size=0,this.__data__={hash:new Lr,map:new(Xl||Zh),string:new Lr}}var jg=g1;function v1(w){var D=typeof w;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?w!=="__proto__":w===null}var Qh=v1;function nl(w,D){var W=w.__data__;return Qh(D)?W[typeof D=="string"?"string":"hash"]:W.map}var js=nl;function b0(w){var D=js(this,w).delete(w);return this.size-=D?1:0,D}var zc=b0;function Vc(w){return js(this,w).get(w)}var rl=Vc;function Wg(w){return js(this,w).has(w)}var y1=Wg;function Gc(w,D){var W=js(this,w),re=W.size;return W.set(w,D),this.size+=W.size==re?0:1,this}var $g=Gc;function Yl(w){var D=-1,W=w==null?0:w.length;for(this.clear();++D<W;){var re=w[D];this.set(re[0],re[1])}}Yl.prototype.clear=jg,Yl.prototype.delete=zc,Yl.prototype.get=rl,Yl.prototype.has=y1,Yl.prototype.set=$g;var Kl=Yl,qg="Expected a function";function _1(w,D){if(typeof w!="function"||D!=null&&typeof D!="function")throw new TypeError(qg);var W=function(){var re=arguments,me=D?D.apply(this,re):re[0],Ee=W.cache;if(Ee.has(me))return Ee.get(me);var Ge=w.apply(this,re);return W.cache=Ee.set(me,Ge)||Ee,Ge};return W.cache=new(_1.Cache||Kl),W}_1.Cache=Kl;var Hc=_1,Jh=500;function jc(w){var D=Hc(w,function(re){return W.size===Jh&&W.clear(),re}),W=D.cache;return D}var Xo=jc,Lu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xg=/\\(\\)?/g,Wc=Xo(function(w){var D=[];return w.charCodeAt(0)===46&&D.push(""),w.replace(Lu,function(W,re,me,Ee){D.push(me?Ee.replace(Xg,"$1"):re||W)}),D}),If=Wc;function kf(w,D){for(var W=-1,re=w==null?0:w.length,me=Array(re);++W<re;)me[W]=D(w[W],W,w);return me}var x1=kf,il=qt?qt.prototype:void 0,Nf=il?il.toString:void 0;function $c(w){if(typeof w=="string")return w;if(pt(w))return x1(w,$c)+"";if(Zt(w))return Nf?Nf.call(w):"";var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}var b1=$c;function Df(w){return w==null?"":b1(w)}var Zl=Df;function S1(w,D){return pt(w)?w:Hn(w,D)?[w]:If(Zl(w))}var ca=S1;function Uu(w){if(typeof w=="string"||Zt(w))return w;var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}var Mo=Uu;function S0(w,D){D=ca(D,w);for(var W=0,re=D.length;w!=null&&W<re;)w=w[Mo(D[W++])];return W&&W==re?w:void 0}var ed=S0;function td(w,D,W){var re=w==null?void 0:ed(w,D);return re===void 0?W:re}var sl=td;function Bu(w,D){return D.length===0?w:sl(w,D)}var al=class{constructor(){I(this,"_values",{})}get(w,D){if(this.has(w))return this._values[w];{const W=D();return this._values[w]=W,W}}has(w){return this._values.hasOwnProperty(w)}},Ws=mn(),Ql=function(){try{var w=ua(Object,"defineProperty");return w({},"",{}),w}catch{}}(),Of=Ql;function Yg(w,D,W){D=="__proto__"&&Of?Of(w,D,{configurable:!0,enumerable:!0,value:W,writable:!0}):w[D]=W}var w0=Yg,nd=Object.prototype,Kg=nd.hasOwnProperty;function Zg(w,D,W){var re=w[D];(!(Kg.call(w,D)&&er(re,W))||W===void 0&&!(D in w))&&w0(w,D,W)}var w1=Zg,d4=9007199254740991,qc=/^(?:0|[1-9]\d*)$/;function E1(w,D){var W=typeof w;return D=D??d4,!!D&&(W=="number"||W!="symbol"&&qc.test(w))&&w>-1&&w%1==0&&w<D}var T1=E1;function Qg(w,D,W,re){if(!Qt(w))return w;D=ca(D,w);for(var me=-1,Ee=D.length,Ge=Ee-1,ft=w;ft!=null&&++me<Ee;){var Tt=Mo(D[me]),zt=W;if(Tt==="__proto__"||Tt==="constructor"||Tt==="prototype")return w;if(me!=Ge){var xn=ft[Tt];zt=re?re(xn,Tt,ft):void 0,zt===void 0&&(zt=Qt(xn)?xn:T1(D[me+1])?[]:{})}w1(ft,Tt,zt),ft=ft[Tt]}return w}var Jg=Qg;function Ff(w,D,W){return w==null?w:Jg(w,D,W)}var rd=Ff,wa=new WeakMap;function f4(w){return Xc(w)}function Xc(w){if(wa.has(w))return wa.get(w);const D=w.type==="compound"?e2(w):w.type==="enum"?M1(w):w.default;return wa.set(w,D),D}function M1(w){const D={$case:w.defaultCase};for(const[W,re]of Object.entries(w.cases))D[W]=Xc(re);return D}function e2(w){const D={};for(const[W,re]of Object.entries(w.props))D[W]=Xc(re);return D}var Ya=mn(),p4=$(ie());function m4(w,D,W){return(0,Ya.prism)(()=>{const re=(0,Ya.val)(D);return Ya.prism.memo("driver",()=>re?re.type==="BasicKeyframedTrack"?t2(w,re,W):(w.logger.error("Track type not yet supported."),(0,Ya.prism)(()=>{})):(0,Ya.prism)(()=>{}),[re]).getValue()})}function t2(w,D,W){return(0,Ya.prism)(()=>{let re=Ya.prism.ref("state",{started:!1}),me=re.current;const Ee=W.getValue();return(!me.started||Ee<me.validFrom||me.validTo<=Ee)&&(re.current=me=zu(w,W,D)),me.der.getValue()})}var C1=(0,Ya.prism)(()=>{});function zu(w,D,W){const re=D.getValue();if(W.keyframes.length===0)return{started:!0,validFrom:-1/0,validTo:1/0,der:C1};let me=0;for(;;){const Ee=W.keyframes[me];if(!Ee)return ns.error;const Ge=me===W.keyframes.length-1;if(re<Ee.position)return me===0?ns.beforeFirstKeyframe(Ee):ns.error;if(Ee.position===re)return Ge?ns.lastKeyframe(Ee):ns.between(Ee,W.keyframes[me+1],D);if(me===W.keyframes.length-1)return ns.lastKeyframe(Ee);{const ft=me+1;if(W.keyframes[ft].position<=re){me=ft;continue}else return ns.between(Ee,W.keyframes[me+1],D)}}}var ns={beforeFirstKeyframe(w){return{started:!0,validFrom:-1/0,validTo:w.position,der:(0,Ya.prism)(()=>({left:w.value,progression:0}))}},lastKeyframe(w){return{started:!0,validFrom:w.position,validTo:1/0,der:(0,Ya.prism)(()=>({left:w.value,progression:0}))}},between(w,D,W){if(!w.connectedRight)return{started:!0,validFrom:w.position,validTo:D.position,der:(0,Ya.prism)(()=>({left:w.value,progression:0}))};const re=Ee=>(Ee-w.position)/(D.position-w.position);if(!w.type||w.type==="bezier"){const Ee=new p4.default(w.handles[2],w.handles[3],D.handles[0],D.handles[1]),Ge=(0,Ya.prism)(()=>{const ft=re(W.getValue()),Tt=Ee.solveSimple(ft);return{left:w.value,right:D.value,progression:Tt}});return{started:!0,validFrom:w.position,validTo:D.position,der:Ge}}const me=(0,Ya.prism)(()=>{const Ee=re(W.getValue()),Ge=Math.floor(Ee);return{left:w.value,right:D.value,progression:Ge}});return{started:!0,validFrom:w.position,validTo:D.position,der:me}},error:{started:!0,validFrom:-1/0,validTo:1/0,der:C1}};function id(w,D,W){const me=W.get(w);if(me&&me.override===D)return me.merged;const Ee=A({},w);for(const Ge of Object.keys(D)){const ft=D[Ge],Tt=w[Ge];Ee[Ge]=typeof ft=="object"&&typeof Tt=="object"?id(Tt,ft,W):ft===void 0?Tt:ft}return W.set(w,{override:D,merged:Ee}),Ee}function ol(w,D){let W=w;for(const re of D)W=W[re];return W}var Jl=mn(),A1=(w,D)=>{const W=Jl.prism.memo(w,()=>new Jl.Atom(D),[]);return W.set(D),W},bi=mn(),Vu=mn(),Yc=/\s/;function P1(w){for(var D=w.length;D--&&Yc.test(w.charAt(D)););return D}var R1=P1,I1=/^\s+/;function n2(w){return w&&w.slice(0,R1(w)+1).replace(I1,"")}var sd=n2,ll=NaN,Kc=/^[-+]0x[0-9a-f]+$/i,g4=/^0b[01]+$/i,ad=/^0o[0-7]+$/i,k1=parseInt;function N1(w){if(typeof w=="number")return w;if(Zt(w))return ll;if(Qt(w)){var D=typeof w.valueOf=="function"?w.valueOf():w;w=Qt(D)?D+"":D}if(typeof w!="string")return w===0?w:+w;w=sd(w);var W=g4.test(w);return W||ad.test(w)?k1(w.slice(2),W?2:8):Kc.test(w)?ll:+w}var de=N1,Pe=1/0,Ye=17976931348623157e292;function Bt(w){if(!w)return w===0?w:0;if(w=de(w),w===Pe||w===-Pe){var D=w<0?-1:1;return D*Ye}return w===w?w:0}var Cr=Bt;function di(w){var D=Cr(w),W=D%1;return D===D?W?D-W:D:0}var ia=di;function E0(w){return w}var Lf=E0,Zc=ua(Dt,"WeakMap"),Da=Zc,od=Object.create,v4=function(){function w(){}return function(D){if(!Qt(D))return{};if(od)return od(D);w.prototype=D;var W=new w;return w.prototype=void 0,W}}(),Fv=v4;function Lv(w,D){var W=-1,re=w.length;for(D||(D=Array(re));++W<re;)D[W]=w[W];return D}var y4=Lv;function _4(w,D){for(var W=-1,re=w==null?0:w.length;++W<re&&D(w[W],W,w)!==!1;);return w}var mx=_4;function Uv(w,D,W,re){var me=!W;W||(W={});for(var Ee=-1,Ge=D.length;++Ee<Ge;){var ft=D[Ee],Tt=re?re(W[ft],w[ft],ft,W,w):void 0;Tt===void 0&&(Tt=w[ft]),me?w0(W,ft,Tt):w1(W,ft,Tt)}return W}var ul=Uv,x4=9007199254740991;function ld(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=x4}var Uf=ld;function b4(w){return w!=null&&Uf(w.length)&&!Ze(w)}var Bf=b4,Gu=Object.prototype;function D1(w){var D=w&&w.constructor,W=typeof D=="function"&&D.prototype||Gu;return w===W}var r2=D1;function O1(w,D){for(var W=-1,re=Array(w);++W<w;)re[W]=D(W);return re}var Bv=O1,i2="[object Arguments]";function s2(w){return _e(w)&&gi(w)==i2}var a2=s2,F1=Object.prototype,S4=F1.hasOwnProperty,Hu=F1.propertyIsEnumerable,zf=a2(function(){return arguments}())?a2:function(w){return _e(w)&&S4.call(w,"callee")&&!Hu.call(w,"callee")},L1=zf;function gx(){return!1}var zv=gx,ud=e&&!e.nodeType&&e,w4=ud&&!0&&s&&!s.nodeType&&s,E4=w4&&w4.exports===ud,o2=E4?Dt.Buffer:void 0,rs=o2?o2.isBuffer:void 0,l2=rs||zv,Qc=l2,Vf="[object Arguments]",T4="[object Array]",u2="[object Boolean]",Gf="[object Date]",U1="[object Error]",cd="[object Function]",M4="[object Map]",Vv="[object Number]",Gv="[object Object]",C4="[object RegExp]",B1="[object Set]",z1="[object String]",c2="[object WeakMap]",h2="[object ArrayBuffer]",d2="[object DataView]",f2="[object Float32Array]",is="[object Float64Array]",A4="[object Int8Array]",vx="[object Int16Array]",yx="[object Int32Array]",Hf="[object Uint8Array]",eu="[object Uint8ClampedArray]",p2="[object Uint16Array]",cl="[object Uint32Array]",vi={};vi[f2]=vi[is]=vi[A4]=vi[vx]=vi[yx]=vi[Hf]=vi[eu]=vi[p2]=vi[cl]=!0,vi[Vf]=vi[T4]=vi[h2]=vi[u2]=vi[d2]=vi[Gf]=vi[U1]=vi[cd]=vi[M4]=vi[Vv]=vi[Gv]=vi[C4]=vi[B1]=vi[z1]=vi[c2]=!1;function Jc(w){return _e(w)&&Uf(w.length)&&!!vi[gi(w)]}var tu=Jc;function V1(w){return function(D){return w(D)}}var P4=V1,m2=e&&!e.nodeType&&e,T0=m2&&!0&&s&&!s.nodeType&&s,hd=T0&&T0.exports===m2,ju=hd&&_t.process,g2=function(){try{var w=T0&&T0.require&&T0.require("util").types;return w||ju&&ju.binding&&ju.binding("util")}catch{}}(),Wu=g2,eh=Wu&&Wu.isTypedArray,$u=eh?P4(eh):tu,ss=$u,as=Object.prototype,nu=as.hasOwnProperty;function Oa(w,D){var W=pt(w),re=!W&&L1(w),me=!W&&!re&&Qc(w),Ee=!W&&!re&&!me&&ss(w),Ge=W||re||me||Ee,ft=Ge?Bv(w.length,String):[],Tt=ft.length;for(var zt in w)(D||nu.call(w,zt))&&!(Ge&&(zt=="length"||me&&(zt=="offset"||zt=="parent")||Ee&&(zt=="buffer"||zt=="byteLength"||zt=="byteOffset")||T1(zt,Tt)))&&ft.push(zt);return ft}var Ka=Oa;function th(w,D){return function(W){return w(D(W))}}var dd=th,Co=dd(Object.keys,Object),G1=Co,R4=Object.prototype,I4=R4.hasOwnProperty;function v2(w){if(!r2(w))return G1(w);var D=[];for(var W in Object(w))I4.call(w,W)&&W!="constructor"&&D.push(W);return D}var Hv=v2;function M0(w){return Bf(w)?Ka(w):Hv(w)}var ru=M0;function k4(w){var D=[];if(w!=null)for(var W in Object(w))D.push(W);return D}var N4=k4,jv=Object.prototype,hl=jv.hasOwnProperty;function nh(w){if(!Qt(w))return N4(w);var D=r2(w),W=[];for(var re in w)re=="constructor"&&(D||!hl.call(w,re))||W.push(re);return W}var fd=nh;function qu(w){return Bf(w)?Ka(w,!0):fd(w)}var Xu=qu;function C0(w,D){for(var W=-1,re=D.length,me=w.length;++W<re;)w[me+W]=D[W];return w}var Ao=C0,pd=dd(Object.getPrototypeOf,Object),dl=pd,iu="[object Object]",md=Function.prototype,Wv=Object.prototype,H1=md.toString,y2=Wv.hasOwnProperty,Po=H1.call(Object);function Ro(w){if(!_e(w)||gi(w)!=iu)return!1;var D=dl(w);if(D===null)return!0;var W=y2.call(D,"constructor")&&D.constructor;return typeof W=="function"&&W instanceof W&&H1.call(W)==Po}var vs=Ro;function fl(w,D,W){var re=-1,me=w.length;D<0&&(D=-D>me?0:me+D),W=W>me?me:W,W<0&&(W+=me),me=D>W?0:W-D>>>0,D>>>=0;for(var Ee=Array(me);++re<me;)Ee[re]=w[re+D];return Ee}var _2=fl;function D4(w,D,W){var re=w.length;return W=W===void 0?re:W,!D&&W>=re?w:_2(w,D,W)}var x2=D4,O4="\\ud800-\\udfff",$v="\\u0300-\\u036f",j1="\\ufe20-\\ufe2f",F4="\\u20d0-\\u20ff",jf=$v+j1+F4,rh="\\ufe0e\\ufe0f",L4="\\u200d",W1=RegExp("["+L4+O4+jf+rh+"]");function b2(w){return W1.test(w)}var $1=b2;function qv(w){return w.split("")}var Wf=qv,gd="\\ud800-\\udfff",vd="\\u0300-\\u036f",S2="\\ufe20-\\ufe2f",yd="\\u20d0-\\u20ff",w2=vd+S2+yd,E2="\\ufe0e\\ufe0f",U4="["+gd+"]",q1="["+w2+"]",Yu="\\ud83c[\\udffb-\\udfff]",A0="(?:"+q1+"|"+Yu+")",ih="[^"+gd+"]",X1="(?:\\ud83c[\\udde6-\\uddff]){2}",B4="[\\ud800-\\udbff][\\udc00-\\udfff]",Ku="\\u200d",su=A0+"?",T2="["+E2+"]?",_d="(?:"+Ku+"(?:"+[ih,X1,B4].join("|")+")"+T2+su+")*",Yo=T2+su+_d,pl="(?:"+[ih+q1+"?",q1,X1,B4,U4].join("|")+")",Y1=RegExp(Yu+"(?="+Yu+")|"+pl+Yo,"g");function xd(w){return w.match(Y1)||[]}var $f=xd;function Xv(w){return $1(w)?$f(w):Wf(w)}var qf=Xv;function au(w,D,W){return w===w&&(W!==void 0&&(w=w<=W?w:W),D!==void 0&&(w=w>=D?w:D)),w}var K1=au;function Xf(w,D,W){return W===void 0&&(W=D,D=void 0),W!==void 0&&(W=de(W),W=W===W?W:0),D!==void 0&&(D=de(D),D=D===D?D:0),K1(de(w),D,W)}var sh=Xf;function z4(){this.__data__=new Zh,this.size=0}var ou=z4;function Z1(w){var D=this.__data__,W=D.delete(w);return this.size=D.size,W}var V4=Z1;function ys(w){return this.__data__.get(w)}var M2=ys;function G4(w){return this.__data__.has(w)}var C2=G4,A2=200;function H4(w,D){var W=this.__data__;if(W instanceof Zh){var re=W.__data__;if(!Xl||re.length<A2-1)return re.push([w,D]),this.size=++W.size,this;W=this.__data__=new Kl(re)}return W.set(w,D),this.size=W.size,this}var ah=H4;function ji(w){var D=this.__data__=new Zh(w);this.size=D.size}ji.prototype.clear=ou,ji.prototype.delete=V4,ji.prototype.get=M2,ji.prototype.has=C2,ji.prototype.set=ah;var Es=ji;function ha(w,D){return w&&ul(D,ru(D),w)}var P2=ha;function lu(w,D){return w&&ul(D,Xu(D),w)}var Zu=lu,R2=e&&!e.nodeType&&e,da=R2&&!0&&s&&!s.nodeType&&s,I2=da&&da.exports===R2,Yf=I2?Dt.Buffer:void 0,Q1=Yf?Yf.allocUnsafe:void 0;function uu(w,D){if(D)return w.slice();var W=w.length,re=Q1?Q1(W):new w.constructor(W);return w.copy(re),re}var Ko=uu;function Kf(w,D){for(var W=-1,re=w==null?0:w.length,me=0,Ee=[];++W<re;){var Ge=w[W];D(Ge,W,w)&&(Ee[me++]=Ge)}return Ee}var j4=Kf;function k2(){return[]}var N2=k2,W4=Object.prototype,$4=W4.propertyIsEnumerable,q4=Object.getOwnPropertySymbols,Yv=q4?function(w){return w==null?[]:(w=Object(w),j4(q4(w),function(D){return $4.call(w,D)}))}:N2,bd=Yv;function X4(w,D){return ul(w,bd(w),D)}var Kv=X4,oh=Object.getOwnPropertySymbols,D2=oh?function(w){for(var D=[];w;)Ao(D,bd(w)),w=dl(w);return D}:N2,J1=D2;function em(w,D){return ul(w,J1(w),D)}var Sd=em;function wd(w,D,W){var re=D(w);return pt(w)?re:Ao(re,W(w))}var Y4=wd;function tm(w){return Y4(w,ru,bd)}var Zf=tm;function Zv(w){return Y4(w,Xu,J1)}var Qu=Zv,Qf=ua(Dt,"DataView"),O2=Qf,F2=ua(Dt,"Promise"),L2=F2,Qv=ua(Dt,"Set"),nm=Qv,K4="[object Map]",Jv="[object Object]",U2="[object Promise]",B2="[object Set]",rm="[object WeakMap]",Z4="[object DataView]",ey=Kr(O2),_x=Kr(Xl),ml=Kr(L2),z2=Kr(nm),im=Kr(Da),Ju=gi;(O2&&Ju(new O2(new ArrayBuffer(1)))!=Z4||Xl&&Ju(new Xl)!=K4||L2&&Ju(L2.resolve())!=U2||nm&&Ju(new nm)!=B2||Da&&Ju(new Da)!=rm)&&(Ju=function(w){var D=gi(w),W=D==Jv?w.constructor:void 0,re=W?Kr(W):"";if(re)switch(re){case ey:return Z4;case _x:return K4;case ml:return U2;case z2:return B2;case im:return rm}return D});var lh=Ju,Q4=Object.prototype,V2=Q4.hasOwnProperty;function ec(w){var D=w.length,W=new w.constructor(D);return D&&typeof w[0]=="string"&&V2.call(w,"index")&&(W.index=w.index,W.input=w.input),W}var G2=ec,J4=Dt.Uint8Array,sm=J4;function e5(w){var D=new w.constructor(w.byteLength);return new sm(D).set(new sm(w)),D}var am=e5;function ty(w,D){var W=D?am(w.buffer):w.buffer;return new w.constructor(W,w.byteOffset,w.byteLength)}var ny=ty,t5=/\w*$/;function xx(w){var D=new w.constructor(w.source,t5.exec(w));return D.lastIndex=w.lastIndex,D}var Io=xx,ii=qt?qt.prototype:void 0,Jf=ii?ii.valueOf:void 0;function ry(w){return Jf?Object(Jf.call(w)):{}}var n5=ry;function iy(w,D){var W=D?am(w.buffer):w.buffer;return new w.constructor(W,w.byteOffset,w.length)}var sy=iy,H2="[object Boolean]",ay="[object Date]",r5="[object Map]",i5="[object Number]",oy="[object RegExp]",s5="[object Set]",j2="[object String]",ly="[object Symbol]",a5="[object ArrayBuffer]",om="[object DataView]",uy="[object Float32Array]",cy="[object Float64Array]",uh="[object Int8Array]",ep="[object Int16Array]",lm="[object Int32Array]",tc="[object Uint8Array]",hy="[object Uint8ClampedArray]",dy="[object Uint16Array]",o5="[object Uint32Array]";function l5(w,D,W){var re=w.constructor;switch(D){case a5:return am(w);case H2:case ay:return new re(+w);case om:return ny(w,W);case uy:case cy:case uh:case ep:case lm:case tc:case hy:case dy:case o5:return sy(w,W);case r5:return new re;case i5:case j2:return new re(w);case oy:return Io(w);case s5:return new re;case ly:return n5(w)}}var fy=l5;function tp(w){return typeof w.constructor=="function"&&!r2(w)?Fv(dl(w)):{}}var Fa=tp,u5="[object Map]";function py(w){return _e(w)&&lh(w)==u5}var um=py,La=Wu&&Wu.isMap,bx=La?P4(La):um,Zn=bx,np="[object Set]";function c5(w){return _e(w)&&lh(w)==np}var W2=c5,my=Wu&&Wu.isSet,rp=my?P4(my):W2,Ed=rp,h5=1,d5=2,cm=4,f5="[object Arguments]",$2="[object Array]",nc="[object Boolean]",Ea="[object Date]",Zo="[object Error]",cu="[object Function]",q2="[object GeneratorFunction]",X2="[object Map]",Qo="[object Number]",hm="[object Object]",gl="[object RegExp]",gy="[object Set]",p5="[object String]",m5="[object Symbol]",g5="[object WeakMap]",rc="[object ArrayBuffer]",v5="[object DataView]",Y2="[object Float32Array]",K2="[object Float64Array]",ko="[object Int8Array]",Ai="[object Int16Array]",Ta="[object Int32Array]",$s="[object Uint8Array]",Ma="[object Uint8ClampedArray]",Jo="[object Uint16Array]",ip="[object Uint32Array]",Ur={};Ur[f5]=Ur[$2]=Ur[rc]=Ur[v5]=Ur[nc]=Ur[Ea]=Ur[Y2]=Ur[K2]=Ur[ko]=Ur[Ai]=Ur[Ta]=Ur[X2]=Ur[Qo]=Ur[hm]=Ur[gl]=Ur[gy]=Ur[p5]=Ur[m5]=Ur[$s]=Ur[Ma]=Ur[Jo]=Ur[ip]=!0,Ur[Zo]=Ur[cu]=Ur[g5]=!1;function ch(w,D,W,re,me,Ee){var Ge,ft=D&h5,Tt=D&d5,zt=D&cm;if(W&&(Ge=me?W(w,re,me,Ee):W(w)),Ge!==void 0)return Ge;if(!Qt(w))return w;var xn=pt(w);if(xn){if(Ge=G2(w),!ft)return y4(w,Ge)}else{var bn=lh(w),On=bn==cu||bn==q2;if(Qc(w))return Ko(w,ft);if(bn==hm||bn==f5||On&&!me){if(Ge=Tt||On?{}:Fa(w),!ft)return Tt?Sd(w,Zu(Ge,w)):Kv(w,P2(Ge,w))}else{if(!Ur[bn])return me?w:{};Ge=fy(w,bn,ft)}}Ee||(Ee=new Es);var pr=Ee.get(w);if(pr)return pr;Ee.set(w,Ge),Ed(w)?w.forEach(function(Ft){Ge.add(ch(Ft,D,W,Ft,w,Ee))}):Zn(w)&&w.forEach(function(Ft,Or){Ge.set(Or,ch(Ft,D,W,Or,w,Ee))});var ir=zt?Tt?Qu:Zf:Tt?Xu:ru,Te=xn?void 0:ir(w);return mx(Te||w,function(Ft,Or){Te&&(Or=Ft,Ft=w[Or]),w1(Ge,Or,ch(Ft,D,W,Or,w,Ee))}),Ge}var hu=ch,sp=1,Z2=4;function dm(w){return hu(w,sp|Z2)}var fo=dm,y5="__lodash_hash_undefined__";function ap(w){return this.__data__.set(w,y5),this}var vl=ap;function fm(w){return this.__data__.has(w)}var _5=fm;function P0(w){var D=-1,W=w==null?0:w.length;for(this.__data__=new Kl;++D<W;)this.add(w[D])}P0.prototype.add=P0.prototype.push=vl,P0.prototype.has=_5;var pm=P0;function du(w,D){for(var W=-1,re=w==null?0:w.length;++W<re;)if(D(w[W],W,w))return!0;return!1}var mm=du;function gm(w,D){return w.has(D)}var Q2=gm,J2=1,e9=2;function Ca(w,D,W,re,me,Ee){var Ge=W&J2,ft=w.length,Tt=D.length;if(ft!=Tt&&!(Ge&&Tt>ft))return!1;var zt=Ee.get(w),xn=Ee.get(D);if(zt&&xn)return zt==D&&xn==w;var bn=-1,On=!0,pr=W&e9?new pm:void 0;for(Ee.set(w,D),Ee.set(D,w);++bn<ft;){var ir=w[bn],Te=D[bn];if(re)var Ft=Ge?re(Te,ir,bn,D,w,Ee):re(ir,Te,bn,w,D,Ee);if(Ft!==void 0){if(Ft)continue;On=!1;break}if(pr){if(!mm(D,function(Or,Li){if(!Q2(pr,Li)&&(ir===Or||me(ir,Or,W,re,Ee)))return pr.push(Li)})){On=!1;break}}else if(!(ir===Te||me(ir,Te,W,re,Ee))){On=!1;break}}return Ee.delete(w),Ee.delete(D),On}var yl=Ca;function _l(w){var D=-1,W=Array(w.size);return w.forEach(function(re,me){W[++D]=[me,re]}),W}var po=_l;function x5(w){var D=-1,W=Array(w.size);return w.forEach(function(re){W[++D]=re}),W}var t9=x5,n9=1,vy=2,ic="[object Boolean]",b5="[object Date]",r9="[object Error]",hh="[object Map]",i9="[object Number]",dh="[object RegExp]",S5="[object Set]",w5="[object String]",vm="[object Symbol]",Td="[object ArrayBuffer]",yy="[object DataView]",_y=qt?qt.prototype:void 0,s9=_y?_y.valueOf:void 0;function E5(w,D,W,re,me,Ee,Ge){switch(W){case yy:if(w.byteLength!=D.byteLength||w.byteOffset!=D.byteOffset)return!1;w=w.buffer,D=D.buffer;case Td:return!(w.byteLength!=D.byteLength||!Ee(new sm(w),new sm(D)));case ic:case b5:case i9:return er(+w,+D);case r9:return w.name==D.name&&w.message==D.message;case dh:case w5:return w==D+"";case hh:var ft=po;case S5:var Tt=re&n9;if(ft||(ft=t9),w.size!=D.size&&!Tt)return!1;var zt=Ge.get(w);if(zt)return zt==D;re|=vy,Ge.set(w,D);var xn=yl(ft(w),ft(D),re,me,Ee,Ge);return Ge.delete(w),xn;case vm:if(s9)return s9.call(w)==s9.call(D)}return!1}var fh=E5,xy=1,Md=Object.prototype,by=Md.hasOwnProperty;function ks(w,D,W,re,me,Ee){var Ge=W&xy,ft=Zf(w),Tt=ft.length,zt=Zf(D),xn=zt.length;if(Tt!=xn&&!Ge)return!1;for(var bn=Tt;bn--;){var On=ft[bn];if(!(Ge?On in D:by.call(D,On)))return!1}var pr=Ee.get(w),ir=Ee.get(D);if(pr&&ir)return pr==D&&ir==w;var Te=!0;Ee.set(w,D),Ee.set(D,w);for(var Ft=Ge;++bn<Tt;){On=ft[bn];var Or=w[On],Li=D[On];if(re)var No=Ge?re(Li,Or,On,D,w,Ee):re(Or,Li,On,w,D,Ee);if(!(No===void 0?Or===Li||me(Or,Li,W,re,Ee):No)){Te=!1;break}Ft||(Ft=On=="constructor")}if(Te&&!Ft){var I0=w.constructor,Pa=D.constructor;I0!=Pa&&"constructor"in w&&"constructor"in D&&!(typeof I0=="function"&&I0 instanceof I0&&typeof Pa=="function"&&Pa instanceof Pa)&&(Te=!1)}return Ee.delete(w),Ee.delete(D),Te}var Sy=ks,a9=1,o9="[object Arguments]",op="[object Array]",lp="[object Object]",l9=Object.prototype,T5=l9.hasOwnProperty;function R0(w,D,W,re,me,Ee){var Ge=pt(w),ft=pt(D),Tt=Ge?op:lh(w),zt=ft?op:lh(D);Tt=Tt==o9?lp:Tt,zt=zt==o9?lp:zt;var xn=Tt==lp,bn=zt==lp,On=Tt==zt;if(On&&Qc(w)){if(!Qc(D))return!1;Ge=!0,xn=!1}if(On&&!xn)return Ee||(Ee=new Es),Ge||ss(w)?yl(w,D,W,re,me,Ee):fh(w,D,Tt,W,re,me,Ee);if(!(W&a9)){var pr=xn&&T5.call(w,"__wrapped__"),ir=bn&&T5.call(D,"__wrapped__");if(pr||ir){var Te=pr?w.value():w,Ft=ir?D.value():D;return Ee||(Ee=new Es),me(Te,Ft,W,re,Ee)}}return On?(Ee||(Ee=new Es),Sy(w,D,W,re,me,Ee)):!1}var u9=R0;function c9(w,D,W,re,me){return w===D?!0:w==null||D==null||!_e(w)&&!_e(D)?w!==w&&D!==D:u9(w,D,W,re,c9,me)}var fu=c9,h9=1,ph=2;function ym(w,D,W,re){var me=W.length,Ee=me,Ge=!re;if(w==null)return!Ee;for(w=Object(w);me--;){var ft=W[me];if(Ge&&ft[2]?ft[1]!==w[ft[0]]:!(ft[0]in w))return!1}for(;++me<Ee;){ft=W[me];var Tt=ft[0],zt=w[Tt],xn=ft[1];if(Ge&&ft[2]){if(zt===void 0&&!(Tt in w))return!1}else{var bn=new Es;if(re)var On=re(zt,xn,Tt,w,D,bn);if(!(On===void 0?fu(xn,zt,h9|ph,re,bn):On))return!1}}return!0}var d9=ym;function M5(w){return w===w&&!Qt(w)}var wy=M5;function _m(w){for(var D=ru(w),W=D.length;W--;){var re=D[W],me=w[re];D[W]=[re,me,wy(me)]}return D}var Ey=_m;function Ty(w,D){return function(W){return W==null?!1:W[w]===D&&(D!==void 0||w in Object(W))}}var f9=Ty;function p9(w){var D=Ey(w);return D.length==1&&D[0][2]?f9(D[0][0],D[0][1]):function(W){return W===w||d9(W,w,D)}}var m9=p9;function g9(w,D){return w!=null&&D in Object(w)}var v9=g9;function Sx(w,D,W){D=ca(D,w);for(var re=-1,me=D.length,Ee=!1;++re<me;){var Ge=Mo(D[re]);if(!(Ee=w!=null&&W(w,Ge)))break;w=w[Ge]}return Ee||++re!=me?Ee:(me=w==null?0:w.length,!!me&&Uf(me)&&T1(Ge,me)&&(pt(w)||L1(w)))}var C5=Sx;function A5(w,D){return w!=null&&C5(w,D,v9)}var y9=A5,_9=1,x9=2;function My(w,D){return Hn(w)&&wy(D)?f9(Mo(w),D):function(W){var re=sl(W,w);return re===void 0&&re===D?y9(W,w):fu(D,re,_9|x9)}}var Cy=My;function b9(w){return function(D){return D==null?void 0:D[w]}}var Ay=b9;function up(w){return function(D){return ed(D,w)}}var wx=up;function S9(w){return Hn(w)?Ay(Mo(w)):wx(w)}var d=S9;function g(w){return typeof w=="function"?w:w==null?Lf:typeof w=="object"?pt(w)?Cy(w[0],w[1]):m9(w):d(w)}var M=g;function O(w){return function(D,W,re){for(var me=-1,Ee=Object(D),Ge=re(D),ft=Ge.length;ft--;){var Tt=Ge[w?ft:++me];if(W(Ee[Tt],Tt,Ee)===!1)break}return D}}var q=O,ee=q(),ge=ee;function Fe(w,D){return w&&ge(w,D,ru)}var Xe=Fe,Ot=function(){return Dt.Date.now()},an=Ot,yn="Expected a function",on=Math.max,$n=Math.min;function qn(w,D,W){var re,me,Ee,Ge,ft,Tt,zt=0,xn=!1,bn=!1,On=!0;if(typeof w!="function")throw new TypeError(yn);D=de(D)||0,Qt(W)&&(xn=!!W.leading,bn="maxWait"in W,Ee=bn?on(de(W.maxWait)||0,D):Ee,On="trailing"in W?!!W.trailing:On);function pr(Ji){var Do=re,Sl=me;return re=me=void 0,zt=Ji,Ge=w.apply(Sl,Do),Ge}function ir(Ji){return zt=Ji,ft=setTimeout(Or,D),xn?pr(Ji):Ge}function Te(Ji){var Do=Ji-Tt,Sl=Ji-zt,mu=D-Do;return bn?$n(mu,Ee-Sl):mu}function Ft(Ji){var Do=Ji-Tt,Sl=Ji-zt;return Tt===void 0||Do>=D||Do<0||bn&&Sl>=Ee}function Or(){var Ji=an();if(Ft(Ji))return Li(Ji);ft=setTimeout(Or,Te(Ji))}function Li(Ji){return ft=void 0,On&&re?pr(Ji):(re=me=void 0,Ge)}function No(){ft!==void 0&&clearTimeout(ft),zt=0,re=Tt=me=ft=void 0}function I0(){return ft===void 0?Ge:Li(an())}function Pa(){var Ji=an(),Do=Ft(Ji);if(re=arguments,me=this,Tt=Ji,Do){if(ft===void 0)return ir(Tt);if(bn)return clearTimeout(ft),ft=setTimeout(Or,D),pr(Tt)}return ft===void 0&&(ft=setTimeout(Or,D)),Ge}return Pa.cancel=No,Pa.flush=I0,Pa}var Qn=qn;function qs(w){var D=w==null?0:w.length;return D?w[D-1]:void 0}var xt=qs;function tt(w,D){return D.length<2?w:ed(w,_2(D,0,-1))}var At=tt;function En(w){return typeof w=="number"&&w==ia(w)}var cr=En;function wr(w,D){var W={};return D=M(D),Xe(w,function(re,me,Ee){w0(W,me,D(re,me,Ee))}),W}var Er=wr;function Dr(w,D){return D=ca(D,w),w=At(w,D),w==null||delete w[Mo(xt(D))]}var Aa=Dr,Si=9007199254740991,sc=Math.floor;function Ex(w,D){var W="";if(!w||D<1||D>Si)return W;do D%2&&(W+=w),D=sc(D/2),D&&(w+=w);while(D);return W}var Tx=Ex,eN=Ay("length"),ZE=eN,Py="\\ud800-\\udfff",QE="\\u0300-\\u036f",tN="\\ufe20-\\ufe2f",JE="\\u20d0-\\u20ff",nN=QE+tN+JE,rN="\\ufe0e\\ufe0f",eT="["+Py+"]",Mx="["+nN+"]",Ry="\\ud83c[\\udffb-\\udfff]",Iy="(?:"+Mx+"|"+Ry+")",tT="[^"+Py+"]",nT="(?:\\ud83c[\\udde6-\\uddff]){2}",Cx="[\\ud800-\\udbff][\\udc00-\\udfff]",rT="\\u200d",Ax=Iy+"?",ky="["+rN+"]?",iT="(?:"+rT+"(?:"+[tT,nT,Cx].join("|")+")"+ky+Ax+")*",iN=ky+Ax+iT,sT="(?:"+[tT+Mx+"?",Mx,nT,Cx,eT].join("|")+")",aT=RegExp(Ry+"(?="+Ry+")|"+sT+iN,"g");function sN(w){for(var D=aT.lastIndex=0;aT.test(w);)++D;return D}var xm=sN;function Ny(w){return $1(w)?xm(w):ZE(w)}var oT=Ny,lT=Math.ceil;function Px(w,D){D=D===void 0?" ":b1(D);var W=D.length;if(W<2)return W?Tx(D,w):D;var re=Tx(D,lT(w/oT(D)));return $1(D)?x2(qf(re),0,w).join(""):re.slice(0,w)}var aN=Px;function oN(w,D,W){w=Zl(w),D=ia(D);var re=D?oT(w):0;return D&&re<D?aN(D-re,W)+w:w}var w9=oN;function uT(w,D){return w==null?!0:Aa(w,D)}var Rx=uT,lN=5*1e3,uN=class{constructor(w){I(this,"_cache",new al),I(this,"_keepHotUntapDebounce"),gt(this,w)}get type(){return"Theatre_SheetObject_PublicAPI"}get props(){return Se(this).propsP}get sheet(){return Se(this).sheet.publicApi}get project(){return Se(this).sheet.project.publicApi}get address(){return A({},Se(this).address)}_valuesPrism(){return this._cache.get("_valuesPrism",()=>{const w=Se(this);return(0,Vu.prism)(()=>(0,Vu.val)(w.getValues().getValue()))})}onValuesChange(w,D){return r6(this._valuesPrism(),w,D)}get value(){const w=this._valuesPrism();{if(!w.isHot){this._keepHotUntapDebounce!=null&&this._keepHotUntapDebounce.flush();const D=w.keepHot();this._keepHotUntapDebounce=Qn(()=>{D(),this._keepHotUntapDebounce=void 0},lN)}this._keepHotUntapDebounce&&this._keepHotUntapDebounce()}return w.getValue()}set initialValue(w){Se(this).setInitialValue(w)}};function cT(w){const D=new WeakMap;return W=>(D.has(W)||D.set(W,w(W)),D.get(W))}function Dy(w){return w.type==="compound"||w.type==="enum"}function Ix(w,D){if(!w)return;const[W,...re]=D;if(W===void 0)return w;if(!Dy(w))return;const me=w.type==="enum"?w.cases[W]:w.props[W];return Ix(me,re)}function hT(w){return!Dy(w)}var dT=class{constructor(w,D,W){this.sheet=w,this.template=D,this.nativeObject=W,I(this,"$$isPointerToPrismProvider",!0),I(this,"address"),I(this,"publicApi"),I(this,"_initialValue",new bi.Atom({})),I(this,"_cache",new al),I(this,"_logger"),I(this,"_internalUtilCtx"),this._logger=w._logger.named("SheetObject",D.address.objectKey),this._logger._trace("creating object"),this._internalUtilCtx={logger:this._logger.utilFor.internal()},this.address=k(A({},D.address),{sheetInstanceId:w.address.sheetInstanceId}),this.publicApi=new uN(this)}get type(){return"Theatre_SheetObject"}getValues(){return this._cache.get("getValues()",()=>(0,bi.prism)(()=>{const w=(0,bi.val)(this.template.getDefaultValues()),D=(0,bi.val)(this._initialValue.pointer),W=bi.prism.memo("withInitialCache",()=>new WeakMap,[]),re=id(w,D,W),me=(0,bi.val)(this.template.getStaticValues()),Ee=bi.prism.memo("withStatics",()=>new WeakMap,[]);let ft=id(re,me,Ee),Tt;{const xn=bi.prism.memo("seq",()=>this.getSequencedValues(),[]),bn=bi.prism.memo("withSeqsCache",()=>new WeakMap,[]);Tt=(0,bi.val)((0,bi.val)(xn)),ft=id(ft,Tt,bn)}return A1("finalAtom",ft).pointer}))}getValueByPointer(w){const D=(0,bi.val)(this.getValues()),{path:W}=(0,bi.getPointerParts)(w);return(0,bi.val)(ol(D,W))}pointerToPrism(w){const{path:D}=(0,bi.getPointerParts)(w);return(0,bi.prism)(()=>{const W=(0,bi.val)(this.getValues());return(0,bi.val)(ol(W,D))})}getSequencedValues(){return(0,bi.prism)(()=>{const w=bi.prism.memo("tracksToProcess",()=>this.template.getArrayOfValidSequenceTracks(),[]),D=(0,bi.val)(w),W=new bi.Atom({}),re=(0,bi.val)(this.template.configPointer);return bi.prism.effect("processTracks",()=>{const me=[];for(const{trackId:Ee,pathToProp:Ge}of D){const ft=this._trackIdToPrism(Ee),Tt=Ix(re,Ge),zt=Tt.deserializeAndSanitize,xn=Tt.interpolate,bn=()=>{const pr=ft.getValue();if(!pr)return W.setByPointer(Li=>ol(Li,Ge),void 0);const ir=zt(pr.left),Te=ir===void 0?Tt.default:ir;if(pr.right===void 0)return W.setByPointer(Li=>ol(Li,Ge),Te);const Ft=zt(pr.right),Or=Ft===void 0?Tt.default:Ft;return W.setByPointer(Li=>ol(Li,Ge),xn(Te,Or,pr.progression))},On=ft.onStale(bn);bn(),me.push(On)}return()=>{for(const Ee of me)Ee()}},[re,...D]),W.pointer})}_trackIdToPrism(w){const D=this.template.project.pointers.historic.sheetsById[this.address.sheetId].sequence.tracksByObject[this.address.objectKey].trackData[w],W=this.sheet.getSequence().positionPrism;return m4(this._internalUtilCtx,D,W)}get propsP(){return this._cache.get("propsP",()=>(0,bi.pointer)({root:this,path:[]}))}validateValue(w,D){}setInitialValue(w){this.validateValue(this.propsP,w),this._initialValue.set(w)}};function hs(w){return function(W,re){return w(W,re())}}var xl={_hmm:bl(524),_todo:bl(522),_error:bl(521),errorDev:bl(529),errorPublic:bl(545),_kapow:bl(268),_warn:bl(265),warnDev:bl(273),warnPublic:bl(289),_debug:bl(137),debugDev:bl(145),_trace:bl(73),traceDev:bl(81)};function bl(w){return Object.freeze({audience:Cd(w,8)?"internal":Cd(w,16)?"dev":"public",category:Cd(w,4)?"troubleshooting":Cd(w,2)?"todo":"general",level:Cd(w,512)?512:Cd(w,256)?256:Cd(w,128)?128:64})}function Cd(w,D){return(w&D)===D}function _s(w,D){return((D&32)===32?!0:(D&16)===16?w.dev:(D&8)===8?w.internal:!1)&&w.min<=D}var Ad={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(w,D,W){return this.create({names:[...w.names,{name:D,key:W}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(w){if(w.length<5)return w;const D=w.replace(this.collapseOnRE,"");return this.cssMemo.has(D)||this.cssMemo.set(D,this.css(w)),D},css(w){var D,W,re,me;const Ee=this.cssMemo.get(w);if(Ee)return Ee;let Ge="color:".concat((W=(D=this.color)==null?void 0:D.call(this,w))!=null?W:"hsl(".concat((w.charCodeAt(0)+w.charCodeAt(w.length-1))%360,", 100%, 60%)"));return(re=this.bold)!=null&&re.test(w)&&(Ge+=";font-weight:600"),(me=this.italic)!=null&&me.test(w)&&(Ge+=";font-style:italic"),this.cssMemo.set(w,Ge),Ge}}};function Oy(w=console,D={}){const W=k(A({},Ad),{includes:A({},Ad.includes)}),re={styled:P5.bind(W,w),noStyle:hN.bind(W,w)},me=pT.bind(W);function Ee(){return W.loggingConsoleStyle&&W.loggerConsoleStyle?re.styled:re.noStyle}return W.create=Ee(),{configureLogger(Ge){var ft;Ge==="console"?(W.loggerConsoleStyle=Ad.loggerConsoleStyle,W.create=Ee()):Ge.type==="console"?(W.loggerConsoleStyle=(ft=Ge.style)!=null?ft:Ad.loggerConsoleStyle,W.create=Ee()):Ge.type==="keyed"?(W.creatExt=Tt=>Ge.keyed(Tt.names),W.create=me):Ge.type==="named"&&(W.creatExt=fT.bind(null,Ge.named),W.create=me)},configureLogging(Ge){var ft,Tt,zt,xn,bn;W.includes.dev=(ft=Ge.dev)!=null?ft:Ad.includes.dev,W.includes.internal=(Tt=Ge.internal)!=null?Tt:Ad.includes.internal,W.includes.min=(zt=Ge.min)!=null?zt:Ad.includes.min,W.include=(xn=Ge.include)!=null?xn:Ad.include,W.loggingConsoleStyle=(bn=Ge.consoleStyle)!=null?bn:Ad.loggingConsoleStyle,W.create=Ee()},getLogger(){return W.create({names:[]})}}}function fT(w,D){const W=[];for(let{name:re,key:me}of D.names)W.push(me==null?re:"".concat(re," (").concat(me,")"));return w(W)}function pT(w){const D=A(A({},this.includes),this.include(w)),W=this.filtered,re=this.named.bind(this,w),me=this.creatExt(w),Ee=_s(D,524),Ge=_s(D,522),ft=_s(D,521),Tt=_s(D,529),zt=_s(D,545),xn=_s(D,265),bn=_s(D,268),On=_s(D,273),pr=_s(D,289),ir=_s(D,137),Te=_s(D,145),Ft=_s(D,73),Or=_s(D,81),Li=Ee?me.error.bind(me,xl._hmm):W.bind(w,524),No=Ge?me.error.bind(me,xl._todo):W.bind(w,522),I0=ft?me.error.bind(me,xl._error):W.bind(w,521),Pa=Tt?me.error.bind(me,xl.errorDev):W.bind(w,529),Ji=zt?me.error.bind(me,xl.errorPublic):W.bind(w,545),Do=bn?me.warn.bind(me,xl._kapow):W.bind(w,268),Sl=xn?me.warn.bind(me,xl._warn):W.bind(w,265),mu=On?me.warn.bind(me,xl.warnDev):W.bind(w,273),Rm=pr?me.warn.bind(me,xl.warnPublic):W.bind(w,273),Im=ir?me.debug.bind(me,xl._debug):W.bind(w,137),km=Te?me.debug.bind(me,xl.debugDev):W.bind(w,145),Nm=Ft?me.trace.bind(me,xl._trace):W.bind(w,73),Dm=Or?me.trace.bind(me,xl.traceDev):W.bind(w,81),Ys={_hmm:Li,_todo:No,_error:I0,errorDev:Pa,errorPublic:Ji,_kapow:Do,_warn:Sl,warnDev:mu,warnPublic:Rm,_debug:Im,debugDev:km,_trace:Nm,traceDev:Dm,lazy:{_hmm:Ee?hs(Li):Li,_todo:Ge?hs(No):No,_error:ft?hs(I0):I0,errorDev:Tt?hs(Pa):Pa,errorPublic:zt?hs(Ji):Ji,_kapow:bn?hs(Do):Do,_warn:xn?hs(Sl):Sl,warnDev:On?hs(mu):mu,warnPublic:pr?hs(Rm):Rm,_debug:ir?hs(Im):Im,debugDev:Te?hs(km):km,_trace:Ft?hs(Nm):Nm,traceDev:Or?hs(Dm):Dm},named:re,utilFor:{internal(){return{debug:Ys._debug,error:Ys._error,warn:Ys._warn,trace:Ys._trace,named(wl,os){return Ys.named(wl,os).utilFor.internal()}}},dev(){return{debug:Ys.debugDev,error:Ys.errorDev,warn:Ys.warnDev,trace:Ys.traceDev,named(wl,os){return Ys.named(wl,os).utilFor.dev()}}},public(){return{error:Ys.errorPublic,warn:Ys.warnPublic,debug(wl,os){Ys._warn('(public "debug" filtered out) '.concat(wl),os)},trace(wl,os){Ys._warn('(public "trace" filtered out) '.concat(wl),os)},named(wl,os){return Ys.named(wl,os).utilFor.public()}}}}};return Ys}function P5(w,D){const W=A(A({},this.includes),this.include(D)),re=[];let me="";for(let Tt=0;Tt<D.names.length;Tt++){const{name:zt,key:xn}=D.names[Tt];if(me+=" %c".concat(zt),re.push(this.style.css(zt)),xn!=null){const bn="%c#".concat(xn);me+=bn,re.push(this.style.css(bn))}}const Ee=this.filtered,Ge=this.named.bind(this,D),ft=[me,...re];return cp(Ee,D,W,w,ft,cN(ft),Ge)}function cN(w){const D=w.slice(0);for(let W=1;W<D.length;W++)D[W]+=";background-color:#e0005a;padding:2px;color:white";return D}function hN(w,D){const W=A(A({},this.includes),this.include(D));let re="";for(let ft=0;ft<D.names.length;ft++){const{name:Tt,key:zt}=D.names[ft];re+=" ".concat(Tt),zt!=null&&(re+="#".concat(zt))}const me=this.filtered,Ee=this.named.bind(this,D),Ge=[re];return cp(me,D,W,w,Ge,Ge,Ee)}function cp(w,D,W,re,me,Ee,Ge){const ft=_s(W,524),Tt=_s(W,522),zt=_s(W,521),xn=_s(W,529),bn=_s(W,545),On=_s(W,265),pr=_s(W,268),ir=_s(W,273),Te=_s(W,289),Ft=_s(W,137),Or=_s(W,145),Li=_s(W,73),No=_s(W,81),I0=ft?re.error.bind(re,...me):w.bind(D,524),Pa=Tt?re.error.bind(re,...me):w.bind(D,522),Ji=zt?re.error.bind(re,...me):w.bind(D,521),Do=xn?re.error.bind(re,...me):w.bind(D,529),Sl=bn?re.error.bind(re,...me):w.bind(D,545),mu=pr?re.warn.bind(re,...Ee):w.bind(D,268),Rm=On?re.warn.bind(re,...me):w.bind(D,265),Im=ir?re.warn.bind(re,...me):w.bind(D,273),km=Te?re.warn.bind(re,...me):w.bind(D,273),Nm=Ft?re.info.bind(re,...me):w.bind(D,137),Dm=Or?re.info.bind(re,...me):w.bind(D,145),Ys=Li?re.debug.bind(re,...me):w.bind(D,73),wl=No?re.debug.bind(re,...me):w.bind(D,81),os={_hmm:I0,_todo:Pa,_error:Ji,errorDev:Do,errorPublic:Sl,_kapow:mu,_warn:Rm,warnDev:Im,warnPublic:km,_debug:Nm,debugDev:Dm,_trace:Ys,traceDev:wl,lazy:{_hmm:ft?hs(I0):I0,_todo:Tt?hs(Pa):Pa,_error:zt?hs(Ji):Ji,errorDev:xn?hs(Do):Do,errorPublic:bn?hs(Sl):Sl,_kapow:pr?hs(mu):mu,_warn:On?hs(Rm):Rm,warnDev:ir?hs(Im):Im,warnPublic:Te?hs(km):km,_debug:Ft?hs(Nm):Nm,debugDev:Or?hs(Dm):Dm,_trace:Li?hs(Ys):Ys,traceDev:No?hs(wl):wl},named:Ge,utilFor:{internal(){return{debug:os._debug,error:os._error,warn:os._warn,trace:os._trace,named(Nd,Dd){return os.named(Nd,Dd).utilFor.internal()}}},dev(){return{debug:os.debugDev,error:os.errorDev,warn:os.warnDev,trace:os.traceDev,named(Nd,Dd){return os.named(Nd,Dd).utilFor.dev()}}},public(){return{error:os.errorPublic,warn:os.warnPublic,debug(Nd,Dd){os._warn('(public "debug" filtered out) '.concat(Nd),Dd)},trace(Nd,Dd){os._warn('(public "trace" filtered out) '.concat(Nd),Dd)},named(Nd,Dd){return os.named(Nd,Dd).utilFor.public()}}}}};return os}var kx=Oy(console,{});kx.configureLogging({dev:!0,min:64});var Fy=kx.getLogger().named("Theatre.js (default logger)").utilFor.dev(),Nx=new WeakMap;function dN(w){const D=Nx.get(w);if(D)return D;const W=new Map;return Nx.set(w,W),mT([],w,W),W}function mT(w,D,W){for(const[re,me]of Object.entries(D.props))if(!Dy(me)){const Ee=[...w,re];W.set(JSON.stringify(Ee),W.size),Dx(Ee,me,W)}for(const[re,me]of Object.entries(D.props))if(Dy(me)){const Ee=[...w,re];W.set(JSON.stringify(Ee),W.size),Dx(Ee,me,W)}}function Dx(w,D,W){if(D.type==="compound")mT(w,D,W);else{if(D.type==="enum")throw new Error("Enums aren't supported yet");W.set(JSON.stringify(w),W.size)}}function gT(w){return typeof w=="object"&&w!==null&&Object.keys(w).length===0}var fN=class{constructor(w,D,W,re,me){this.sheetTemplate=w,I(this,"address"),I(this,"type","Theatre_SheetObjectTemplate"),I(this,"_config"),I(this,"_temp_actions_atom"),I(this,"_cache",new al),I(this,"project"),I(this,"pointerToSheetState"),I(this,"pointerToStaticOverrides"),this.address=k(A({},w.address),{objectKey:D}),this._config=new Ws.Atom(re),this._temp_actions_atom=new Ws.Atom(me),this.project=w.project,this.pointerToSheetState=this.sheetTemplate.project.pointers.historic.sheetsById[this.address.sheetId],this.pointerToStaticOverrides=this.pointerToSheetState.staticOverrides.byObject[this.address.objectKey]}get staticConfig(){return this._config.get()}get configPointer(){return this._config.pointer}get _temp_actions(){return this._temp_actions_atom.get()}get _temp_actionsPointer(){return this._temp_actions_atom.pointer}createInstance(w,D,W){return this._config.set(W),new dT(w,this,D)}reconfigure(w){this._config.set(w)}_temp_setActions(w){this._temp_actions_atom.set(w)}getDefaultValues(){return this._cache.get("getDefaultValues()",()=>(0,Ws.prism)(()=>{const w=(0,Ws.val)(this.configPointer);return f4(w)}))}getStaticValues(){return this._cache.get("getStaticValues",()=>(0,Ws.prism)(()=>{var w;const D=(w=(0,Ws.val)(this.pointerToStaticOverrides))!=null?w:{};return(0,Ws.val)(this.configPointer).deserializeAndSanitize(D)||{}}))}getArrayOfValidSequenceTracks(){return this._cache.get("getArrayOfValidSequenceTracks",()=>(0,Ws.prism)(()=>{const w=this.project.pointers.historic.sheetsById[this.address.sheetId],D=(0,Ws.val)(w.sequence.tracksByObject[this.address.objectKey].trackIdByPropPath);if(!D)return Ae;const W=[];if(!D)return Ae;const re=(0,Ws.val)(this.configPointer),me=Object.entries(D);for(const[Ge,ft]of me){const Tt=vT(Ge);if(!Tt)continue;const zt=Ix(re,Tt);zt&&hT(zt)&&W.push({pathToProp:Tt,trackId:ft})}const Ee=dN(re);return W.sort((Ge,ft)=>{const Tt=Ge.pathToProp,zt=ft.pathToProp,xn=Ee.get(JSON.stringify(Tt)),bn=Ee.get(JSON.stringify(zt));return xn>bn?1:-1}),W.length===0?Ae:W}))}getMapOfValidSequenceTracks_forStudio(){return this._cache.get("getMapOfValidSequenceTracks_forStudio",()=>(0,Ws.prism)(()=>{const w=(0,Ws.val)(this.getArrayOfValidSequenceTracks());let D={};for(const{pathToProp:W,trackId:re}of w)rd(D,W,re);return D}))}getStaticButNotSequencedOverrides(){return this._cache.get("getStaticButNotSequencedOverrides",()=>(0,Ws.prism)(()=>{const w=(0,Ws.val)(this.getStaticValues()),D=(0,Ws.val)(this.getArrayOfValidSequenceTracks()),W=fo(w);for(const{pathToProp:re}of D){Rx(W,re);let me=re.slice(0,-1);for(;me.length>0;){const Ee=Bu(W,me);if(!gT(Ee))break;Rx(W,me),me=me.slice(0,-1)}}if(!gT(W))return W}))}getDefaultsAtPointer(w){const{path:D}=(0,Ws.getPointerParts)(w),W=this.getDefaultValues().getValue();return Bu(W,D)}};function vT(w){try{return JSON.parse(w)}catch{Fy.warn("property ".concat(JSON.stringify(w)," cannot be parsed. Skipping."));return}}var yT=mn(),pN=cT(w=>JSON.stringify(w));$(ue());var _T=class extends Error{},R5=class extends _T{},xT=mn(),bT=mn(),mN=mn(),Za=mn();function Pd(){let w,D;const W=new Promise((me,Ee)=>{w=Ge=>{me(Ge),re.status="resolved"},D=Ge=>{Ee(Ge),re.status="rejected"}}),re={resolve:w,reject:D,promise:W,status:"pending"};return re}var gN=()=>{},Ly=gN,ST=mn(),Ox=class{constructor(){I(this,"_stopPlayCallback",Ly),I(this,"_state",new ST.Atom({position:0,playing:!1})),I(this,"statePointer"),this.statePointer=this._state.pointer}destroy(){}pause(){this._stopPlayCallback(),this.playing=!1,this._stopPlayCallback=Ly}gotoPosition(w){this._updatePositionInState(w)}_updatePositionInState(w){this._state.setByPointer(D=>D.position,w)}getCurrentPosition(){return this._state.get().position}get playing(){return this._state.get().playing}set playing(w){this._state.setByPointer(D=>D.playing,w)}play(w,D,W,re,me){this.playing&&this.pause(),this.playing=!0;const Ee=D[1]-D[0];{const On=this.getCurrentPosition();On<D[0]||On>D[1]?re==="normal"||re==="alternate"?this._updatePositionInState(D[0]):(re==="reverse"||re==="alternateReverse")&&this._updatePositionInState(D[1]):re==="normal"||re==="alternate"?On===D[1]&&this._updatePositionInState(D[0]):On===D[0]&&this._updatePositionInState(D[1])}const Ge=Pd(),ft=me.time,Tt=Ee*w;let zt=this.getCurrentPosition()-D[0];(re==="reverse"||re==="alternateReverse")&&(zt=D[1]-this.getCurrentPosition());const xn=On=>{const ir=Math.max(On-ft,0)/1e3,Te=Math.min(ir*W+zt,Tt);if(Te!==Tt){const Ft=Math.floor(Te/Ee);let Or=Te/Ee%1*Ee;if(re!=="normal")if(re==="reverse")Or=Ee-Or;else{const Li=Ft%2===0;re==="alternate"?Li||(Or=Ee-Or):Li&&(Or=Ee-Or)}this._updatePositionInState(Or+D[0]),bn()}else{if(re==="normal")this._updatePositionInState(D[1]);else if(re==="reverse")this._updatePositionInState(D[0]);else{const Ft=(w-1)%2===0;re==="alternate"?Ft?this._updatePositionInState(D[1]):this._updatePositionInState(D[0]):Ft?this._updatePositionInState(D[0]):this._updatePositionInState(D[1])}this.playing=!1,Ge.resolve(!0)}};this._stopPlayCallback=()=>{me.offThisOrNextTick(xn),me.offNextTick(xn),this.playing&&Ge.resolve(!1)};const bn=()=>me.onNextTick(xn);return me.onThisOrNextTick(xn),Ge.promise}playDynamicRange(w,D){this.playing&&this.pause(),this.playing=!0;const W=Pd(),re=w.keepHot();W.promise.then(re,re);let me=D.time;const Ee=ft=>{const Tt=Math.max(ft-me,0);me=ft;const zt=Tt/1e3,xn=this.getCurrentPosition(),bn=w.getValue();if(xn<bn[0]||xn>bn[1])this.gotoPosition(bn[0]);else{let On=xn+zt;On>bn[1]&&(On=bn[0]+(On-bn[1])),this.gotoPosition(On)}Ge()};this._stopPlayCallback=()=>{D.offThisOrNextTick(Ee),D.offNextTick(Ee),W.resolve(!1)};const Ge=()=>D.onNextTick(Ee);return D.onThisOrNextTick(Ee),W.promise}},wT=mn(),vN="__TheatreJS_StudioBundle",Fx="__TheatreJS_CoreBundle",ET="__TheatreJS_Notifications",Uy=w=>(...D)=>{var W;switch(w){case"success":{Fy.debug(D.slice(0,2).join(`
`));break}case"info":{Fy.debug(D.slice(0,2).join(`
`));break}case"warning":{Fy.warn(D.slice(0,2).join(`
`));break}}return typeof window<"u"?(W=window[ET])==null?void 0:W.notify[w](...D):void 0},bm={warning:Uy("warning"),success:Uy("success"),info:Uy("info"),error:Uy("error")};typeof window<"u"&&(window.addEventListener("error",w=>{bm.error("An error occurred","<pre>".concat(w.message,`</pre>

See **console** for details.`))}),window.addEventListener("unhandledrejection",w=>{bm.error("An error occurred","<pre>".concat(w.reason,`</pre>

See **console** for details.`))}));var TT=class{constructor(w,D,W){this._decodedBuffer=w,this._audioContext=D,this._nodeDestination=W,I(this,"_mainGain"),I(this,"_state",new wT.Atom({position:0,playing:!1})),I(this,"statePointer"),I(this,"_stopPlayCallback",Ly),this.statePointer=this._state.pointer,this._mainGain=this._audioContext.createGain(),this._mainGain.connect(this._nodeDestination)}playDynamicRange(w,D){const W=Pd();this._playing&&this.pause(),this._playing=!0;let re;const me=()=>{re==null||re(),re=this._loopInRange(w.getValue(),D).stop},Ee=w.onStale(me);return me(),this._stopPlayCallback=()=>{re==null||re(),Ee(),W.resolve(!1)},W.promise}_loopInRange(w,D){let re=this.getCurrentPosition();const me=w[1]-w[0];re<w[0]||re>w[1]?this._updatePositionInState(w[0]):re===w[1]&&this._updatePositionInState(w[0]),re=this.getCurrentPosition();const Ee=this._audioContext.createBufferSource();Ee.buffer=this._decodedBuffer,Ee.connect(this._mainGain),Ee.playbackRate.value=1,Ee.loop=!0,Ee.loopStart=w[0],Ee.loopEnd=w[1];const Ge=D.time;let ft=re-w[0];Ee.start(0,re);const Tt=bn=>{let Te=(Math.max(bn-Ge,0)/1e3*1+ft)/me%1*me;this._updatePositionInState(Te+w[0]),zt()},zt=()=>D.onNextTick(Tt);return D.onThisOrNextTick(Tt),{stop:()=>{Ee.stop(),Ee.disconnect(),D.offThisOrNextTick(Tt),D.offNextTick(Tt)}}}get _playing(){return this._state.get().playing}set _playing(w){this._state.setByPointer(D=>D.playing,w)}destroy(){}pause(){this._stopPlayCallback(),this._playing=!1,this._stopPlayCallback=Ly}gotoPosition(w){this._updatePositionInState(w)}_updatePositionInState(w){this._state.reduce(D=>k(A({},D),{position:w}))}getCurrentPosition(){return this._state.get().position}play(w,D,W,re,me){this._playing&&this.pause(),this._playing=!0;let Ee=this.getCurrentPosition();const Ge=D[1]-D[0];if(re!=="normal")throw new R5('Audio-controlled sequences can only be played in the "normal" direction. '+"'".concat(re,"' given."));Ee<D[0]||Ee>D[1]?this._updatePositionInState(D[0]):Ee===D[1]&&this._updatePositionInState(D[0]),Ee=this.getCurrentPosition();const ft=Pd(),Tt=this._audioContext.createBufferSource();Tt.buffer=this._decodedBuffer,Tt.connect(this._mainGain),Tt.playbackRate.value=W,w>1e3&&(bm.warning("Can't play sequences with audio more than 1000 times","The sequence will still play, but only 1000 times. The `iterationCount: ".concat(w,"` provided to `sequence.play()`\nis too high for a sequence with audio.\n\nTo fix this, either set `iterationCount` to a lower value, or remove the audio from the sequence."),[{url:"https://www.theatrejs.com/docs/latest/manual/audio",title:"Using Audio"},{url:"https://www.theatrejs.com/docs/latest/api/core#sequence.attachaudio",title:"Audio API"}]),w=1e3),w>1&&(Tt.loop=!0,Tt.loopStart=D[0],Tt.loopEnd=D[1]);const zt=me.time;let xn=Ee-D[0];const bn=Ge*w;Tt.start(0,Ee,bn-xn);const On=Te=>{const Or=Math.max(Te-zt,0)/1e3,Li=Math.min(Or*W+xn,bn);if(Li!==bn){let No=Li/Ge%1*Ge;this._updatePositionInState(No+D[0]),ir()}else this._updatePositionInState(D[1]),this._playing=!1,pr(),ft.resolve(!0)},pr=()=>{Tt.stop(),Tt.disconnect()};this._stopPlayCallback=()=>{pr(),me.offThisOrNextTick(On),me.offNextTick(On),this._playing&&ft.resolve(!1)};const ir=()=>me.onNextTick(On);return me.onThisOrNextTick(On),ft.promise}},yN=mn(),Lx=0;function By(w){var D;const W=Ge=>{re.tick(Ge)},re=new yN.Ticker({onActive(){var Ge;(Ge=w==null?void 0:w.start)==null||Ge.call(w)},onDormant(){var Ge;(Ge=w==null?void 0:w.stop)==null||Ge.call(w)}}),me={tick:W,id:Lx++,name:(D=w==null?void 0:w.name)!=null?D:"CustomRafDriver-".concat(Lx),type:"Theatre_RafDriver_PublicAPI"},Ee={type:"Theatre_RafDriver_PrivateAPI",publicApi:me,ticker:re,start:w==null?void 0:w.start,stop:w==null?void 0:w.stop};return gt(me,Ee),me}function _N(){let w=null;const re=By({name:"DefaultCoreRafDriver",start:()=>{if(typeof window<"u"){const me=Ee=>{re.tick(Ee),w=window.requestAnimationFrame(me)};w=window.requestAnimationFrame(me)}else re.tick(0),setTimeout(()=>re.tick(1),0)},stop:()=>{typeof window<"u"&&w!==null&&window.cancelAnimationFrame(w)}});return re}var zy;function Sm(){return zy||MT(_N()),zy}function Vy(){return Sm().ticker}function MT(w){if(zy)throw new Error("`setCoreRafDriver()` is already called.");zy=Se(w)}var CT=class{get type(){return"Theatre_Sequence_PublicAPI"}constructor(w){gt(this,w)}play(w){const D=Se(this);if(D._project.isReady()){const W=w!=null&&w.rafDriver?Se(w.rafDriver).ticker:Vy();return D.play(w??{},W)}else{const W=Pd();return W.resolve(!0),W.promise}}pause(){Se(this).pause()}get position(){return Se(this).position}set position(w){Se(this).position=w}__experimental_getKeyframes(w){return Se(this).getKeyframesOfSimpleProp(w)}async attachAudio(w){const{audioContext:D,destinationNode:W,decodedBuffer:re,gainNode:me}=await xN(w),Ee=new TT(re,D,me);return Se(this).replacePlaybackController(Ee),{audioContext:D,destinationNode:W,decodedBuffer:re,gainNode:me}}get pointer(){return Se(this).pointer}};async function xN(w){function D(){if(w.audioContext)return Promise.resolve(w.audioContext);const zt=new AudioContext;return zt.state==="running"||typeof window>"u"?Promise.resolve(zt):new Promise(xn=>{const bn=()=>{zt.resume().catch(ir=>{console.error(ir)})},On=["mousedown","keydown","touchstart"],pr={capture:!0,passive:!1};On.forEach(ir=>{window.addEventListener(ir,bn,pr)}),zt.addEventListener("statechange",()=>{zt.state==="running"&&(On.forEach(ir=>{window.removeEventListener(ir,bn,pr)}),xn(zt))})})}async function W(){if(w.source instanceof AudioBuffer)return w.source;const zt=Pd();if(typeof w.source!="string")throw new Error("Error validating arguments to sequence.attachAudio(). args.source must either be a string or an instance of AudioBuffer.");let xn;try{xn=await fetch(w.source)}catch(ir){throw console.error(ir),new Error("Could not fetch '".concat(w.source,"'. Network error logged above."))}let bn;try{bn=await xn.arrayBuffer()}catch(ir){throw console.error(ir),new Error("Could not read '".concat(w.source,"' as an arrayBuffer."))}(await re).decodeAudioData(bn,zt.resolve,zt.reject);let pr;try{pr=await zt.promise}catch(ir){throw console.error(ir),new Error("Could not decode ".concat(w.source," as an audio file."))}return pr}const re=D(),me=W(),[Ee,Ge]=await Promise.all([re,me]),ft=w.destinationNode||Ee.destination,Tt=Ee.createGain();return Tt.connect(ft),{audioContext:Ee,decodedBuffer:Ge,gainNode:Tt,destinationNode:ft}}var AT=PT("Theatre_SheetObject");function PT(w){return D=>typeof D=="object"&&!!D&&D.type===w}var RT=class{constructor(w,D,W,re,me){this._project=w,this._sheet=D,this._lengthD=W,this._subUnitsPerUnitD=re,I(this,"address"),I(this,"publicApi"),I(this,"_playbackControllerBox"),I(this,"_prismOfStatePointer"),I(this,"_positionD"),I(this,"_positionFormatterD"),I(this,"_playableRangeD"),I(this,"pointer",(0,mN.pointer)({root:this,path:[]})),I(this,"$$isPointerToPrismProvider",!0),I(this,"_logger"),I(this,"closestGridPosition",Ee=>{const ft=1/this.subUnitsPerUnit;return parseFloat((Math.round(Ee/ft)*ft).toFixed(3))}),this._logger=w._logger.named("Sheet",D.address.sheetId).named("Instance",D.address.sheetInstanceId),this.address=k(A({},this._sheet.address),{sequenceName:"default"}),this.publicApi=new CT(this),this._playbackControllerBox=new bT.Atom(me??new Ox),this._prismOfStatePointer=(0,Za.prism)(()=>this._playbackControllerBox.prism.getValue().statePointer),this._positionD=(0,Za.prism)(()=>{const Ee=this._prismOfStatePointer.getValue();return(0,Za.val)(Ee.position)}),this._positionFormatterD=(0,Za.prism)(()=>{const Ee=(0,Za.val)(this._subUnitsPerUnitD);return new bN(Ee)})}get type(){return"Theatre_Sequence"}pointerToPrism(w){const{path:D}=(0,xT.getPointerParts)(w);if(D.length===0)return(0,Za.prism)(()=>({length:(0,Za.val)(this.pointer.length),playing:(0,Za.val)(this.pointer.playing),position:(0,Za.val)(this.pointer.position),subUnitsPerUnit:(0,Za.val)(this.pointer.subUnitsPerUnit)}));if(D.length>1)return(0,Za.prism)(()=>{});const[W]=D;return W==="length"?this._lengthD:W==="subUnitsPerUnit"?this._subUnitsPerUnitD:W==="position"?this._positionD:W==="playing"?(0,Za.prism)(()=>(0,Za.val)(this._prismOfStatePointer.getValue().playing)):(0,Za.prism)(()=>{})}getKeyframesOfSimpleProp(w){const{path:D,root:W}=(0,xT.getPointerParts)(w);if(!AT(W))throw new R5("Argument prop must be a pointer to a SheetObject property");const re=(0,Za.val)(this._project.pointers.historic.sheetsById[this._sheet.address.sheetId].sequence.tracksByObject[W.address.objectKey]);if(!re)return[];const{trackData:me,trackIdByPropPath:Ee}=re,Ge=pN(D),ft=Ee[Ge];if(!ft)return[];const Tt=me[ft];return Tt?Tt.keyframes:[]}get positionFormatter(){return this._positionFormatterD.getValue()}get prismOfStatePointer(){return this._prismOfStatePointer}get length(){return this._lengthD.getValue()}get positionPrism(){return this._positionD}get position(){return this._playbackControllerBox.get().getCurrentPosition()}get subUnitsPerUnit(){return this._subUnitsPerUnitD.getValue()}get positionSnappedToGrid(){return this.closestGridPosition(this.position)}set position(w){let D=w;this.pause(),D>this.length&&(D=this.length);const W=this.length;this._playbackControllerBox.get().gotoPosition(D>W?W:D)}getDurationCold(){return this._lengthD.getValue()}get playing(){return(0,Za.val)(this._playbackControllerBox.get().statePointer.playing)}_makeRangeFromSequenceTemplate(){return(0,Za.prism)(()=>[0,(0,Za.val)(this._lengthD)])}playDynamicRange(w,D){return this._playbackControllerBox.get().playDynamicRange(w,D)}async play(w,D){const W=this.length,re=w&&w.range?w.range:[0,W],me=w&&typeof w.iterationCount=="number"?w.iterationCount:1,Ee=w&&typeof w.rate<"u"?w.rate:1,Ge=w&&w.direction?w.direction:"normal";return await this._play(me,[re[0],re[1]],Ee,Ge,D)}_play(w,D,W,re,me){return this._playbackControllerBox.get().play(w,D,W,re,me)}pause(){this._playbackControllerBox.get().pause()}replacePlaybackController(w){this.pause();const D=this._playbackControllerBox.get();this._playbackControllerBox.set(w);const W=D.getCurrentPosition();D.destroy(),w.gotoPosition(W)}},bN=class{constructor(w){this._fps=w}formatSubUnitForGrid(w){const D=w%1,W=1/this._fps;return Math.round(D/W)+"f"}formatFullUnitForGrid(w){let D=w,W="";if(D>=Em){const me=Math.floor(D/Em);W+=me+"h",D=D%Em}if(D>=hp){const me=Math.floor(D/hp);W+=me+"m",D=D%hp}if(D>=wm){const me=Math.floor(D/wm);W+=me+"s",D=D%wm}const re=1/this._fps;if(D>=re){const me=Math.floor(D/re);W+=me+"f",D=D%re}return W.length===0?"0s":W}formatForPlayhead(w){let D=w,W="";if(D>=Em){const me=Math.floor(D/Em);W+=w9(me.toString(),2,"0")+"h",D=D%Em}if(D>=hp){const me=Math.floor(D/hp);W+=w9(me.toString(),2,"0")+"m",D=D%hp}else W.length>0&&(W+="00m");if(D>=wm){const me=Math.floor(D/wm);W+=w9(me.toString(),2,"0")+"s",D=D%wm}else W+="00s";const re=1/this._fps;if(D>=re){const me=Math.round(D/re);W+=w9(me.toString(),2,"0")+"f",D=D%re}else D/re>.98?(W+=w9("1",2,"0")+"f",D=D%re):W+="00f";return W.length===0?"00s00f":W}formatBasic(w){return w.toFixed(2)+"s"}},wm=1,hp=wm*60,Em=hp*60,Ux={};U(Ux,{boolean:()=>Vx,compound:()=>I5,file:()=>Gy,image:()=>fp,number:()=>pp,rgba:()=>E9,string:()=>BT,stringLiteral:()=>zT});function IT(w,D){return w.length<=D?w:w.substr(0,D-3)+"..."}var dp=w=>typeof w=="string"?'string("'.concat(IT(w,10),'")'):typeof w=="number"?"number(".concat(IT(String(w),10),")"):w===null?"null":w===void 0?"undefined":typeof w=="boolean"?String(w):Array.isArray(w)?"array":typeof w=="object"?"object":"unknown",kT=dp;function Ua(w,{removeAlphaIfOpaque:D=!1}={}){const W=(w.a*255|256).toString(16).slice(1),re=(w.r*255|256).toString(16).slice(1)+(w.g*255|256).toString(16).slice(1)+(w.b*255|256).toString(16).slice(1)+(D&&W==="ff"?"":W);return"#".concat(re)}function Bx(w){return k(A({},w),{toString(){return Ua(this,{removeAlphaIfOpaque:!0})}})}function SN(w){return Object.fromEntries(Object.entries(w).map(([D,W])=>[D,sh(W,0,1)]))}function qe(w){function D(W){return W>=.0031308?1.055*W**(1/2.4)-.055:12.92*W}return SN({r:D(w.r),g:D(w.g),b:D(w.b),a:w.a})}function NT(w){function D(W){return W>=.04045?((W+.055)/(1+.055))**2.4:W/12.92}return{r:D(w.r),g:D(w.g),b:D(w.b),a:w.a}}function DT(w){let D=.4122214708*w.r+.5363325363*w.g+.0514459929*w.b,W=.2119034982*w.r+.6806995451*w.g+.1073969566*w.b,re=.0883024619*w.r+.2817188376*w.g+.6299787005*w.b,me=Math.cbrt(D),Ee=Math.cbrt(W),Ge=Math.cbrt(re);return{L:.2104542553*me+.793617785*Ee-.0040720468*Ge,a:1.9779984951*me-2.428592205*Ee+.4505937099*Ge,b:.0259040371*me+.7827717662*Ee-.808675766*Ge,alpha:w.a}}function wN(w){let D=w.L+.3963377774*w.a+.2158037573*w.b,W=w.L-.1055613458*w.a-.0638541728*w.b,re=w.L-.0894841775*w.a-1.291485548*w.b,me=D*D*D,Ee=W*W*W,Ge=re*re*re;return{r:4.0767416621*me-3.3077115913*Ee+.2309699292*Ge,g:-1.2684380046*me+2.6097574011*Ee-.3413193965*Ge,b:-.0041960863*me-.7034186147*Ee+1.707614701*Ge,a:w.alpha}}var mo=Symbol("TheatrePropType_Basic");function OT(w){return typeof w=="object"&&!!w&&w[mo]==="TheatrePropType"}function Gr(w){if(typeof w=="number")return pp(w);if(typeof w=="boolean")return Vx(w);if(typeof w=="string")return BT(w);if(typeof w=="object"&&w){if(OT(w))return w;if(vs(w))return I5(w);throw new R5("This value is not a valid prop type: ".concat(kT(w)))}else throw new R5("This value is not a valid prop type: ".concat(kT(w)))}function EN(w){const D={};for(const W of Object.keys(w)){const re=w[W];OT(re)?D[W]=re:D[W]=Gr(re)}return D}var I5=(w,D={})=>{const W=EN(w),re=new WeakMap;return{type:"compound",props:W,valueType:null,[mo]:"TheatrePropType",label:D.label,default:Er(W,Ee=>Ee.default),deserializeAndSanitize:Ee=>{if(typeof Ee!="object"||!Ee)return;if(re.has(Ee))return re.get(Ee);const Ge={};let ft=!1;for(const[Tt,zt]of Object.entries(W))if(Object.prototype.hasOwnProperty.call(Ee,Tt)){const xn=zt.deserializeAndSanitize(Ee[Tt]);xn!=null&&(ft=!0,Ge[Tt]=xn)}if(re.set(Ee,Ge),ft)return Ge}}},Gy=(w,D={})=>{const W=(re,me,Ee)=>{var Ge;return{type:"file",id:((Ge=D.interpolate)!=null?Ge:tr)(re.id,me.id,Ee)}};return{type:"file",default:{type:"file",id:w},valueType:null,[mo]:"TheatrePropType",label:D.label,interpolate:W,deserializeAndSanitize:FT}},FT=w=>{if(!w)return;let D=!0;if(typeof w.id!="string"&&![null,void 0].includes(w.id)&&(D=!1),w.type!=="file"&&(D=!1),!!D)return w},fp=(w,D={})=>{const W=(re,me,Ee)=>{var Ge;return{type:"image",id:((Ge=D.interpolate)!=null?Ge:tr)(re.id,me.id,Ee)}};return{type:"image",default:{type:"image",id:w},valueType:null,[mo]:"TheatrePropType",label:D.label,interpolate:W,deserializeAndSanitize:LT}},LT=w=>{if(!w)return;let D=!0;if(typeof w.id!="string"&&![null,void 0].includes(w.id)&&(D=!1),w.type!=="image"&&(D=!1),!!D)return w},pp=(w,D={})=>{var W;return k(A({type:"number",valueType:0,default:w,[mo]:"TheatrePropType"},D||{}),{label:D.label,nudgeFn:(W=D.nudgeFn)!=null?W:MN,nudgeMultiplier:typeof D.nudgeMultiplier=="number"?D.nudgeMultiplier:void 0,interpolate:ac,deserializeAndSanitize:qr(D.range)})},qr=w=>w?D=>{if(typeof D=="number"&&isFinite(D))return sh(D,w[0],w[1])}:zx,zx=w=>typeof w=="number"&&isFinite(w)?w:void 0,ac=(w,D,W)=>w+W*(D-w),E9=(w={r:0,g:0,b:0,a:1},D={})=>{const W={};for(const re of["r","g","b","a"])W[re]=Math.min(Math.max(w[re],0),1);return{type:"rgba",valueType:null,default:Bx(W),[mo]:"TheatrePropType",label:D.label,interpolate:UT,deserializeAndSanitize:Hy}},Hy=w=>{if(!w)return;let D=!0;for(const re of["r","g","b","a"])(!Object.prototype.hasOwnProperty.call(w,re)||typeof w[re]!="number")&&(D=!1);if(!D)return;const W={};for(const re of["r","g","b","a"])W[re]=Math.min(Math.max(w[re],0),1);return Bx(W)},UT=(w,D,W)=>{const re=DT(NT(w)),me=DT(NT(D)),Ee={L:(1-W)*re.L+W*me.L,a:(1-W)*re.a+W*me.a,b:(1-W)*re.b+W*me.b,alpha:(1-W)*re.alpha+W*me.alpha},Ge=qe(wN(Ee));return Bx(Ge)},Vx=(w,D={})=>{var W;return{type:"boolean",default:w,valueType:null,[mo]:"TheatrePropType",label:D.label,interpolate:(W=D.interpolate)!=null?W:tr,deserializeAndSanitize:Gx}},Gx=w=>typeof w=="boolean"?w:void 0;function tr(w){return w}var BT=(w,D={})=>{var W;return{type:"string",default:w,valueType:null,[mo]:"TheatrePropType",label:D.label,interpolate:(W=D.interpolate)!=null?W:tr,deserializeAndSanitize:TN}};function TN(w){return typeof w=="string"?w:void 0}function zT(w,D,W={}){var re,me;return{type:"stringLiteral",default:w,valuesAndLabels:A({},D),[mo]:"TheatrePropType",valueType:null,as:(re=W.as)!=null?re:"menu",label:W.label,interpolate:(me=W.interpolate)!=null?me:tr,deserializeAndSanitize(Ee){if(typeof Ee=="string"&&Object.prototype.hasOwnProperty.call(D,Ee))return Ee}}}var MN=({config:w,deltaX:D,deltaFraction:W,magnitude:re})=>{var me;const{range:Ee}=w;return!w.nudgeMultiplier&&Ee&&!Ee.includes(1/0)&&!Ee.includes(-1/0)?W*(Ee[1]-Ee[0])*re:D*re*((me=w.nudgeMultiplier)!=null?me:1)},VT=w=>w.replace(/^[\s\/]*/,"").replace(/[\s\/]*$/,"").replace(/\s*\/\s*/g," / ");function jy(w,D){return VT(w)}$(Q());var GT=class{get type(){return"Theatre_Sheet_PublicAPI"}constructor(w){gt(this,w)}object(w,D,W){const re=Se(this),me=jy(w),Ee=re.getObject(me),Ge=null,ft=W==null?void 0:W.__actions__THIS_API_IS_UNSTABLE_AND_WILL_CHANGE_IN_THE_NEXT_VERSION;if(Ee)return ft&&Ee.template._temp_setActions(ft),Ee.publicApi;{const Tt=I5(D);return re.createObject(me,Ge,Tt,ft).publicApi}}__experimental_getExistingObject(w){const D=Se(this),W=jy(w),re=D.getObject(W);return re==null?void 0:re.publicApi}get sequence(){return Se(this).getSequence().publicApi}get project(){return Se(this).project.publicApi}get address(){return A({},Se(this).address)}detachObject(w){const D=Se(this),W=jy(w);if(!D.getObject(W)){bm.warning(`Couldn't delete object "`.concat(W,'"'),'There is no object with key "'.concat(W,`".

To fix this, make sure you are calling \`sheet.deleteObject("`).concat(W,'")` with the correct key.')),console.warn('Object key "'.concat(W,'" does not exist.'));return}D.deleteObject(W)}},T9=mn(),CN=class{constructor(w,D){this.template=w,this.instanceId=D,I(this,"_objects",new T9.Atom({})),I(this,"_sequence"),I(this,"address"),I(this,"publicApi"),I(this,"project"),I(this,"objectsP",this._objects.pointer),I(this,"type","Theatre_Sheet"),I(this,"_logger"),this._logger=w.project._logger.named("Sheet",D),this._logger._trace("creating sheet"),this.project=w.project,this.address=k(A({},w.address),{sheetInstanceId:this.instanceId}),this.publicApi=new GT(this)}createObject(w,D,W,re={}){const Ee=this.template.getObjectTemplate(w,D,W,re).createInstance(this,D,W);return this._objects.setByPointer(Ge=>Ge[w],Ee),Ee}getObject(w){return this._objects.get()[w]}deleteObject(w){this._objects.reduce(D=>{const W=A({},D);return delete W[w],W})}getSequence(){if(!this._sequence){const w=(0,T9.prism)(()=>{const W=(0,T9.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.length);return AN(W)}),D=(0,T9.prism)(()=>{const W=(0,T9.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.subUnitsPerUnit);return HT(W)});this._sequence=new RT(this.template.project,this,w,D)}return this._sequence}},AN=w=>typeof w=="number"&&isFinite(w)&&w>0?w:10,HT=w=>typeof w=="number"&&cr(w)&&w>=1&&w<=1e3?w:30,PN=class{constructor(w,D){this.project=w,I(this,"type","Theatre_SheetTemplate"),I(this,"address"),I(this,"_instances",new yT.Atom({})),I(this,"instancesP",this._instances.pointer),I(this,"_objectTemplates",new yT.Atom({})),I(this,"objectTemplatesP",this._objectTemplates.pointer),this.address=k(A({},w.address),{sheetId:D})}getInstance(w){let D=this._instances.get()[w];return D||(D=new CN(this,w),this._instances.setByPointer(W=>W[w],D)),D}getObjectTemplate(w,D,W,re){let me=this._objectTemplates.get()[w];return me||(me=new fN(this,w,D,W,re),this._objectTemplates.setByPointer(Ee=>Ee[w],me)),me}},Wy=mn(),Hx=mn(),jx=w=>new Promise(D=>setTimeout(D,w)),RN=jx;function pu(w){for(var D=arguments.length,W=Array(D>1?D-1:0),re=1;re<D;re++)W[re-1]=arguments[re];throw Error("[Immer] minified error nr: "+w+(W.length?" "+W.map(function(me){return"'"+me+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Tm(w){return!!w&&!!w[t0]}function Mm(w){return!!w&&(function(D){if(!D||typeof D!="object")return!1;var W=Object.getPrototypeOf(D);if(W===null)return!0;var re=Object.hasOwnProperty.call(W,"constructor")&&W.constructor;return re===Object||typeof re=="function"&&Function.toString.call(re)===$T}(w)||Array.isArray(w)||!!w[Jx]||!!w.constructor[Jx]||qy(w)||N5(w))}function oc(w){return Tm(w)||pu(23,w),w[t0].t}function Rd(w,D,W){W===void 0&&(W=!1),Cm(w)===0?(W?Object.keys:Zy)(w).forEach(function(re){W&&typeof re=="symbol"||D(re,w[re],w)}):w.forEach(function(re,me){return D(me,re,w)})}function Cm(w){var D=w[t0];return D?D.i>3?D.i-4:D.i:Array.isArray(w)?1:qy(w)?2:N5(w)?3:0}function k5(w,D){return Cm(w)===2?w.has(D):Object.prototype.hasOwnProperty.call(w,D)}function Id(w,D){return Cm(w)===2?w.get(D):w[D]}function $y(w,D,W){var re=Cm(w);re===2?w.set(D,W):re===3?(w.delete(D),w.add(W)):w[D]=W}function jT(w,D){return w===D?w!==0||1/w==1/D:w!=w&&D!=D}function qy(w){return R9&&w instanceof Map}function N5(w){return L5&&w instanceof Set}function mp(w){return w.o||w.t}function Xy(w){if(Array.isArray(w))return Array.prototype.slice.call(w);var D=Qy(w);delete D[t0];for(var W=Zy(D),re=0;re<W.length;re++){var me=W[re],Ee=D[me];Ee.writable===!1&&(Ee.writable=!0,Ee.configurable=!0),(Ee.get||Ee.set)&&(D[me]={configurable:!0,writable:!0,enumerable:Ee.enumerable,value:w[me]})}return Object.create(Object.getPrototypeOf(w),D)}function Yy(w,D){return D===void 0&&(D=!1),e0(w)||Tm(w)||!Mm(w)||(Cm(w)>1&&(w.set=w.add=w.clear=w.delete=Am),Object.freeze(w),D&&Rd(w,function(W,re){return Yy(re,!0)},!0)),w}function Am(){pu(2)}function e0(w){return w==null||typeof w!="object"||Object.isFrozen(w)}function lc(w){var D=eb[w];return D||pu(18,w),D}function D5(){return kd}function Wx(w,D){D&&(lc("Patches"),w.u=[],w.s=[],w.v=D)}function O5(w){Ky(w),w.p.forEach(qx),w.p=null}function Ky(w){w===kd&&(kd=w.l)}function $x(w){return kd={p:[],l:kd,h:w,m:!0,_:0}}function qx(w){var D=w[t0];D.i===0||D.i===1?D.j():D.O=!0}function Xs(w,D){D._=D.p.length;var W=D.p[0],re=w!==void 0&&w!==W;return D.h.g||lc("ES5").S(D,w,re),re?(W[t0].P&&(O5(D),pu(4)),Mm(w)&&(w=F5(D,w),D.l||M9(D,w)),D.u&&lc("Patches").M(W[t0],w,D.u,D.s)):w=F5(D,W,[]),O5(D),D.u&&D.v(D.u,D.s),w!==Qx?w:void 0}function F5(w,D,W){if(e0(D))return D;var re=D[t0];if(!re)return Rd(D,function(Ee,Ge){return Xx(w,re,D,Ee,Ge,W)},!0),D;if(re.A!==w)return D;if(!re.P)return M9(w,re.t,!0),re.t;if(!re.I){re.I=!0,re.A._--;var me=re.i===4||re.i===5?re.o=Xy(re.k):re.o;Rd(re.i===3?new Set(me):me,function(Ee,Ge){return Xx(w,re,me,Ee,Ge,W)}),M9(w,me,!1),W&&w.u&&lc("Patches").R(re,W,w.u,w.s)}return re.o}function Xx(w,D,W,re,me,Ee){if(Tm(me)){var Ge=F5(w,me,Ee&&D&&D.i!==3&&!k5(D.D,re)?Ee.concat(re):void 0);if($y(W,re,Ge),!Tm(Ge))return;w.m=!1}if(Mm(me)&&!e0(me)){if(!w.h.F&&w._<1)return;F5(w,me),D&&D.A.l||M9(w,me)}}function M9(w,D,W){W===void 0&&(W=!1),w.h.F&&w.m&&Yy(D,W)}function C9(w,D){var W=w[t0];return(W?mp(W):w)[D]}function A9(w,D){if(D in w)for(var W=Object.getPrototypeOf(w);W;){var re=Object.getOwnPropertyDescriptor(W,D);if(re)return re;W=Object.getPrototypeOf(W)}}function uc(w){w.P||(w.P=!0,w.l&&uc(w.l))}function cc(w){w.o||(w.o=Xy(w.t))}function P9(w,D,W){var re=qy(D)?lc("MapSet").N(D,W):N5(D)?lc("MapSet").T(D,W):w.g?function(me,Ee){var Ge=Array.isArray(me),ft={i:Ge?1:0,A:Ee?Ee.A:D5(),P:!1,I:!1,D:{},l:Ee,t:me,k:null,o:null,j:null,C:!1},Tt=ft,zt=U5;Ge&&(Tt=[ft],zt=B5);var xn=Proxy.revocable(Tt,zt),bn=xn.revoke,On=xn.proxy;return ft.k=On,ft.j=bn,On}(D,W):lc("ES5").J(D,W);return(W?W.A:D5()).p.push(re),re}function WT(w){return Tm(w)||pu(22,w),function D(W){if(!Mm(W))return W;var re,me=W[t0],Ee=Cm(W);if(me){if(!me.P&&(me.i<4||!lc("ES5").K(me)))return me.t;me.I=!0,re=Yx(W,Ee),me.I=!1}else re=Yx(W,Ee);return Rd(re,function(Ge,ft){me&&Id(me.t,Ge)===ft||$y(re,Ge,D(ft))}),Ee===3?new Set(re):re}(w)}function Yx(w,D){switch(D){case 2:return new Map(w);case 3:return Array.from(w)}return Xy(w)}var Kx,kd,Pm=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",R9=typeof Map<"u",L5=typeof Set<"u",Zx=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",Qx=Pm?Symbol.for("immer-nothing"):((Kx={})["immer-nothing"]=!0,Kx),Jx=Pm?Symbol.for("immer-draftable"):"__$immer_draftable",t0=Pm?Symbol.for("immer-state"):"__$immer_state",$T=""+Object.prototype.constructor,Zy=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:Object.getOwnPropertyNames,Qy=Object.getOwnPropertyDescriptors||function(w){var D={};return Zy(w).forEach(function(W){D[W]=Object.getOwnPropertyDescriptor(w,W)}),D},eb={},U5={get:function(w,D){if(D===t0)return w;var W=mp(w);if(!k5(W,D))return function(me,Ee,Ge){var ft,Tt=A9(Ee,Ge);return Tt?"value"in Tt?Tt.value:(ft=Tt.get)===null||ft===void 0?void 0:ft.call(me.k):void 0}(w,W,D);var re=W[D];return w.I||!Mm(re)?re:re===C9(w.t,D)?(cc(w),w.o[D]=P9(w.A.h,re,w)):re},has:function(w,D){return D in mp(w)},ownKeys:function(w){return Reflect.ownKeys(mp(w))},set:function(w,D,W){var re=A9(mp(w),D);if(re!=null&&re.set)return re.set.call(w.k,W),!0;if(!w.P){var me=C9(mp(w),D),Ee=me==null?void 0:me[t0];if(Ee&&Ee.t===W)return w.o[D]=W,w.D[D]=!1,!0;if(jT(W,me)&&(W!==void 0||k5(w.t,D)))return!0;cc(w),uc(w)}return w.o[D]===W&&typeof W!="number"&&(W!==void 0||D in w.o)||(w.o[D]=W,w.D[D]=!0,!0)},deleteProperty:function(w,D){return C9(w.t,D)!==void 0||D in w.t?(w.D[D]=!1,cc(w),uc(w)):delete w.D[D],w.o&&delete w.o[D],!0},getOwnPropertyDescriptor:function(w,D){var W=mp(w),re=Reflect.getOwnPropertyDescriptor(W,D);return re&&{writable:!0,configurable:w.i!==1||D!=="length",enumerable:re.enumerable,value:W[D]}},defineProperty:function(){pu(11)},getPrototypeOf:function(w){return Object.getPrototypeOf(w.t)},setPrototypeOf:function(){pu(12)}},B5={};Rd(U5,function(w,D){B5[w]=function(){return arguments[0]=arguments[0][0],D.apply(this,arguments)}}),B5.deleteProperty=function(w,D){return U5.deleteProperty.call(this,w[0],D)},B5.set=function(w,D,W){return U5.set.call(this,w[0],D,W,w[0])};var qT=function(){function w(W){var re=this;this.g=Zx,this.F=!0,this.produce=function(me,Ee,Ge){if(typeof me=="function"&&typeof Ee!="function"){var ft=Ee;Ee=me;var Tt=re;return function(pr){var ir=this;pr===void 0&&(pr=ft);for(var Te=arguments.length,Ft=Array(Te>1?Te-1:0),Or=1;Or<Te;Or++)Ft[Or-1]=arguments[Or];return Tt.produce(pr,function(Li){var No;return(No=Ee).call.apply(No,[ir,Li].concat(Ft))})}}var zt;if(typeof Ee!="function"&&pu(6),Ge!==void 0&&typeof Ge!="function"&&pu(7),Mm(me)){var xn=$x(re),bn=P9(re,me,void 0),On=!0;try{zt=Ee(bn),On=!1}finally{On?O5(xn):Ky(xn)}return typeof Promise<"u"&&zt instanceof Promise?zt.then(function(pr){return Wx(xn,Ge),Xs(pr,xn)},function(pr){throw O5(xn),pr}):(Wx(xn,Ge),Xs(zt,xn))}if(!me||typeof me!="object")return(zt=Ee(me))===Qx?void 0:(zt===void 0&&(zt=me),re.F&&Yy(zt,!0),zt);pu(21,me)},this.produceWithPatches=function(me,Ee){return typeof me=="function"?function(Tt){for(var zt=arguments.length,xn=Array(zt>1?zt-1:0),bn=1;bn<zt;bn++)xn[bn-1]=arguments[bn];return re.produceWithPatches(Tt,function(On){return me.apply(void 0,[On].concat(xn))})}:[re.produce(me,Ee,function(Tt,zt){Ge=Tt,ft=zt}),Ge,ft];var Ge,ft},typeof(W==null?void 0:W.useProxies)=="boolean"&&this.setUseProxies(W.useProxies),typeof(W==null?void 0:W.autoFreeze)=="boolean"&&this.setAutoFreeze(W.autoFreeze)}var D=w.prototype;return D.createDraft=function(W){Mm(W)||pu(8),Tm(W)&&(W=WT(W));var re=$x(this),me=P9(this,W,void 0);return me[t0].C=!0,Ky(re),me},D.finishDraft=function(W,re){var me=W&&W[t0],Ee=me.A;return Wx(Ee,re),Xs(void 0,Ee)},D.setAutoFreeze=function(W){this.F=W},D.setUseProxies=function(W){W&&!Zx&&pu(20),this.g=W},D.applyPatches=function(W,re){var me;for(me=re.length-1;me>=0;me--){var Ee=re[me];if(Ee.path.length===0&&Ee.op==="replace"){W=Ee.value;break}}var Ge=lc("Patches").$;return Tm(W)?Ge(W,re):this.produce(W,function(ft){return Ge(ft,re.slice(me+1))})},w}(),n0=new qT;n0.produce,n0.produceWithPatches.bind(n0),n0.setAutoFreeze.bind(n0),n0.setUseProxies.bind(n0),n0.applyPatches.bind(n0),n0.createDraft.bind(n0),n0.finishDraft.bind(n0);var XT={currentProjectStateDefinitionVersion:"0.4.0"},gp=XT;async function YT(w,D,W){await RN(0),w.transaction(({drafts:re})=>{var me;const Ee=D.address.projectId;re.ephemeral.coreByProject[Ee]={lastExportedObject:null,loadingState:{type:"loading"}},re.ahistoric.coreByProject[Ee]={ahistoricStuff:""};function Ge(){re.ephemeral.coreByProject[Ee].loadingState={type:"loaded"},re.historic.coreByProject[Ee]={sheetsById:{},definitionVersion:gp.currentProjectStateDefinitionVersion,revisionHistory:[]}}function ft(bn){re.ephemeral.coreByProject[Ee].loadingState={type:"loaded"},re.historic.coreByProject[Ee]=bn}function Tt(){re.ephemeral.coreByProject[Ee].loadingState={type:"loaded"}}function zt(bn){re.ephemeral.coreByProject[Ee].loadingState={type:"browserStateIsNotBasedOnDiskState",onDiskState:bn}}const xn=(me=oc(re.historic))==null?void 0:me.coreByProject[D.address.projectId];xn?W&&xn.revisionHistory.indexOf(W.revisionHistory[0])==-1?zt(W):Tt():W?ft(W):Ge()})}function Jy(){}function vp(w){var D,W;const re=(D=w==null?void 0:w.logging)!=null&&D.internal?(W=w.logging.min)!=null?W:256:1/0,me=re<=128,Ee=re<=512,Ge=Oy(void 0,{_debug:me?console.debug.bind(console,"_coreLogger(TheatreInternalLogger) debug"):Jy,_error:Ee?console.error.bind(console,"_coreLogger(TheatreInternalLogger) error"):Jy});if(w){const{logger:ft,logging:Tt}=w;ft&&Ge.configureLogger(ft),Tt?Ge.configureLogging(Tt):Ge.configureLogging({dev:!1})}return Ge.getLogger().named("Theatre")}var tb=class{constructor(w,D={},W){this.config=D,this.publicApi=W,I(this,"pointers"),I(this,"_pointerProxies"),I(this,"address"),I(this,"_studioReadyDeferred"),I(this,"_assetStorageReadyDeferred"),I(this,"_readyPromise"),I(this,"_sheetTemplates",new Hx.Atom({})),I(this,"sheetTemplatesP",this._sheetTemplates.pointer),I(this,"_studio"),I(this,"assetStorage"),I(this,"type","Theatre_Project"),I(this,"_logger");var re;this._logger=vp({logging:{dev:!0}}).named("Project",w),this._logger.traceDev("creating project"),this.address={projectId:w};const me=new Hx.Atom({ahistoric:{ahistoricStuff:""},historic:(re=D.state)!=null?re:{sheetsById:{},definitionVersion:gp.currentProjectStateDefinitionVersion,revisionHistory:[]},ephemeral:{loadingState:{type:"loaded"},lastExportedObject:null}});this._assetStorageReadyDeferred=Pd(),this.assetStorage={getAssetUrl:Ee=>{var Ge;return"".concat((Ge=D.assets)==null?void 0:Ge.baseUrl,"/").concat(Ee)},createAsset:()=>{throw new Error("Please wait for Project.ready to use assets.")}},this._pointerProxies={historic:new Wy.PointerProxy(me.pointer.historic),ahistoric:new Wy.PointerProxy(me.pointer.ahistoric),ephemeral:new Wy.PointerProxy(me.pointer.ephemeral)},this.pointers={historic:this._pointerProxies.historic.pointer,ahistoric:this._pointerProxies.ahistoric.pointer,ephemeral:this._pointerProxies.ephemeral.pointer},rt.add(w,this),this._studioReadyDeferred=Pd(),this._readyPromise=Promise.all([this._studioReadyDeferred.promise,this._assetStorageReadyDeferred.promise]).then(()=>{}),D.state?setTimeout(()=>{this._studio||(this._studioReadyDeferred.resolve(void 0),this._assetStorageReadyDeferred.resolve(void 0),this._logger._trace("ready deferred resolved with no state"))},0):typeof window>"u"?console.error('Argument config.state in Theatre.getProject("'.concat(w,'", config) is empty. ')+"You can safely ignore this message if you're developing a Next.js/Remix project in development mode. But if you are shipping to your end-users, then you need to set config.state, otherwise your project's state will be empty and nothing will animate. Learn more at https://www.theatrejs.com/docs/latest/manual/projects#state"):setTimeout(()=>{if(!this._studio)throw new Error('Argument config.state in Theatre.getProject("'.concat(w,'", config) is empty. This is fine ')+"while you are using @theatre/core along with @theatre/studio. But since @theatre/studio "+'is not loaded, the state of project "'.concat(w,`" will be empty.

`)+`To fix this, you need to add @theatre/studio into the bundle and export the project's state. Learn how to do that at https://www.theatrejs.com/docs/latest/manual/projects#state
`)},1e3)}attachToStudio(w){if(this._studio){if(this._studio!==w)throw new Error("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));console.warn("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));return}this._studio=w,w.initialized.then(async()=>{var D;await YT(w,this,this.config.state),this._pointerProxies.historic.setPointer(w.atomP.historic.coreByProject[this.address.projectId]),this._pointerProxies.ahistoric.setPointer(w.atomP.ahistoric.coreByProject[this.address.projectId]),this._pointerProxies.ephemeral.setPointer(w.atomP.ephemeral.coreByProject[this.address.projectId]),await w.createAssetStorage(this,(D=this.config.assets)==null?void 0:D.baseUrl).then(W=>{this.assetStorage=W,this._assetStorageReadyDeferred.resolve(void 0)}),this._studioReadyDeferred.resolve(void 0)}).catch(D=>{throw console.error(D),D})}get isAttachedToStudio(){return!!this._studio}get ready(){return this._readyPromise}isReady(){return this._studioReadyDeferred.status==="resolved"&&this._assetStorageReadyDeferred.status==="resolved"}getOrCreateSheet(w,D="default"){let W=this._sheetTemplates.get()[w];return W||(W=new PN(this,w),this._sheetTemplates.reduce(re=>k(A({},re),{[w]:W}))),W.getInstance(D)}},KT=class{get type(){return"Theatre_Project_PublicAPI"}constructor(w,D={}){gt(this,new tb(w,D,this))}get ready(){return Se(this).ready}get isReady(){return Se(this).isReady()}get address(){return A({},Se(this).address)}getAssetUrl(w){if(!this.isReady){console.error("Calling `project.getAssetUrl()` before `project.ready` is resolved, will always return `undefined`. Either use `project.ready.then(() => project.getAssetUrl())` or `await project.ready` before calling `project.getAssetUrl()`.");return}return w.id?Se(this).assetStorage.getAssetUrl(w.id):void 0}sheet(w,D="default"){const W=jy(w);return Se(this).getOrCreateSheet(W,D).publicApi}};$(Q());var nb=mn(),e6=mn();function rb(w,D={}){const W=rt.get(w);if(W)return W.publicApi;const me=vp().named("Project",w);return D.state?(n6(w,D.state),me._debug("deep validated config.state on disk")):me._debug("no config.state"),new KT(w,D)}var t6=(w,D)=>{if(Array.isArray(D)||D==null||D.definitionVersion!==gp.currentProjectStateDefinitionVersion)throw new R5("Error validating conf.state in Theatre.getProject(".concat(JSON.stringify(w),", conf). The state seems to be formatted in a way that is unreadable to Theatre.js. Read more at https://www.theatrejs.com/docs/latest/manual/projects#state"))},n6=(w,D)=>{t6(w,D)};function r6(w,D,W){const re=W?Se(W).ticker:Vy();if((0,nb.isPointer)(w))return(0,e6.pointerToPrism)(w).onChange(re,D,!0);if((0,e6.isPrism)(w))return w.onChange(re,D,!0);throw new Error("Called onChange(p) where p is neither a pointer nor a prism.")}function z5(w){if((0,nb.isPointer)(w))return(0,e6.pointerToPrism)(w).getValue();throw new Error("Called val(p) where p is not a pointer.")}var ZT=class{constructor(){I(this,"_studio")}get type(){return"Theatre_CoreBundle"}get version(){return"0.7.2"}getBitsForStudio(w,D){if(this._studio)throw new Error("@theatre/core is already attached to @theatre/studio");this._studio=w;const W={projectsP:rt.atom.pointer.projects,privateAPI:Se,coreExports:le,getCoreRafDriver:Sm};D(W)}};QT();function QT(){if(typeof window>"u")return;const w=window[Fx];if(typeof w<"u")throw typeof w=="object"&&w&&typeof w.version=="string"?new Error(`It seems that the module '@theatre/core' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@theatre/core' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(Fx," seems to be already set by a module other than @theatre/core."));const D=new ZT;window[Fx]=D;const W=window[vN];W&&W!==null&&W.type==="Theatre_StudioBundle"&&W.registerCoreBundle(D)}/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)
		*/}(Jw,Jw.exports)),Jw.exports}var wme=Nke();class S3e{constructor(e,t=!1,n=!1){Qe(this,"name");Qe(this,"_debug",!1);Qe(this,"_editor",!1);Qe(this,"broadcastChannel");this.name=e,this._debug=t,this._editor=n,t&&(this.broadcastChannel=new BroadcastChannel(e),this.broadcastChannel.addEventListener("message",this.messageHandler.bind(this)))}dispose(){var e,t;(e=this.broadcastChannel)==null||e.removeEventListener("message",this.messageHandler.bind(this)),(t=this.broadcastChannel)==null||t.close()}get debug(){return this._debug}get editor(){return this._editor}send(e){var n;if(this.editor&&e.target==="app"||!this.editor&&e.target==="editor")try{(n=this.broadcastChannel)==null||n.postMessage(e)}catch(r){console.log("Hermes - Error sending message:"),console.log(r),console.log(e)}}messageHandler(e){const t=e.data;t.target==="app"?this.handleApp(t):this.handleEditor(t)}handleApp(e){}handleEditor(e){}}const w3e=()=>{};function nk(s){return s.substring(0,1).toUpperCase()+s.substring(1)}function Dke(s){const e=JSON.stringify(s);return navigator.clipboard.writeText(e),e}function v0(){return Math.round(Math.random()*1e6).toString()}function Oke(s){return s.r!==void 0&&s.g!==void 0&&s.b!==void 0}function Eme(s){const e=Math.round(s.r*255),t=Math.round(s.g*255),n=Math.round(s.b*255),r=h=>{const p=h.toString(16);return p.length===1?"0"+p:p},i=r(e),o=r(t),l=r(n);return"#"+i+o+l}function Fke(s,e,t,n,r){const i=1-s;return i*i*i*e+3*i*i*s*t+3*i*s*s*n+s*s*s*r}function Lke(s,e,t){if(s.type!=="bezier"||s.handles.length!==4)throw new Error("Invalid keyframe data for Bzier interpolation.");const[n,r]=s.handles,i=(t-s.position)/(e.position-s.position);return Fke(i,s.value,s.value+n,e.value+r,e.value)}class Uke extends S3e{constructor(t=!1,n=!1){super("RemoteTheatre",t,n);Qe(this,"project");Qe(this,"sheets",new Map);Qe(this,"sheetObjects",new Map);Qe(this,"sheetObjectCBs",new Map);Qe(this,"sheetObjectUnsubscribe",new Map);Qe(this,"activeSheet");Qe(this,"studio");Qe(this,"rafDriver")}dispose(){this.project=void 0,this.sheets=new Map,this.sheetObjects=new Map,this.sheetObjectCBs=new Map,this.sheetObjectUnsubscribe=new Map}loadProject(t,n,r){return this.project=wme.getProject(t,{state:r}),new Promise((i,o)=>{var l;(l=this.project)==null||l.ready.then(()=>{if(r){const h=r.sheetsById;for(const p in h)this.sheet(p)}n&&(this.rafDriver=wme.createRafDriver({name:t})),i()}).catch(()=>o())})}getSheetInstance(t,n){return n!==void 0?`${t}-${n}`:t}sheet(t,n){var o;if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const r=this.getSheetInstance(t,n);let i=this.sheets.get(r);return i!==void 0||(i=(o=this.project)==null?void 0:o.sheet(t,n),this.sheets.set(r,i)),i}playSheet(t,n,r){return new Promise(i=>{var l;const o=n!==void 0?{...n}:{};o.rafDriver=this.rafDriver,(l=this.sheet(t,r))==null||l.sequence.play(o).then(h=>i(h)),this.send({event:"playSheet",target:"editor",data:{sheet:t,instance:r,value:n}})})}pauseSheet(t,n){var r;(r=this.sheet(t,n))==null||r.sequence.pause(),this.send({event:"pauseSheet",target:"editor",data:{sheet:t,instance:n}})}clearSheetObjects(t){this.sheetObjects.forEach((n,r)=>{r.search(`${t}_`)>-1&&this.unsubscribe(n)})}sheetObject(t,n,r,i,o){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const l=this.sheet(t,o);if(l===void 0)return;const p=`${this.getSheetInstance(t,o)}_${n}`;let y=this.sheetObjects.get(p),x=r;y!==void 0&&(x={...r,...y.value}),y=l.object(n,x,{reconfigure:!0}),this.sheetObjects.set(p,y),this.sheetObjectCBs.set(p,i!==void 0?i:w3e);function S(k,L,U){if(typeof U=="object")if(Oke(U))k[L]={r:U.r,g:U.g,b:U.b,a:U.a};else for(const P in U){const $=U[P];typeof $=="object"&&S(U,P,$)}}const A=y.onValuesChange(k=>{const L=this.sheetObjectCBs.get(p);if(this.editor){for(const U in k){const P=k[U];typeof P=="object"&&S(k,U,P)}this.send({event:"updateSheetObject",target:"app",data:{sheet:t,sheetObject:p,values:k}}),L&&L(k)}else L&&L(k)});return this.sheetObjectUnsubscribe.set(p,A),y}getSheetObjectKeyframes(t,n,r){const i=this.sheet(t);if(i===void 0)return[];const o=`${t}_${n}`,l=this.sheetObjects.get(o);return l===void 0?[]:i.sequence.__experimental_getKeyframes(l.props[r])}getSheetObjectVectors(t,n){const r=this.sheet(t);if(r===void 0)return[];const i=`${t}_${n}`,o=this.sheetObjects.get(i);if(o===void 0)return[];const l=[],h=r.sequence.__experimental_getKeyframes(o.props.x),p=r.sequence.__experimental_getKeyframes(o.props.y),y=r.sequence.__experimental_getKeyframes(o.props.z),x=new Set;return h.forEach(A=>x.add(A.position)),p.forEach(A=>x.add(A.position)),y.forEach(A=>x.add(A.position)),Array.from(x).sort((A,k)=>A-k).forEach(A=>{const k=(L,U)=>{const P=L.find((I,ie)=>{var ce;return I.position<=U&&(((ce=L[ie+1])==null?void 0:ce.position)||1/0)>U}),$=L.find(I=>I.position>U);if(!P)return($==null?void 0:$.value)||0;if(!$||P.position===U)return P.value;if(P.type==="bezier")return Lke(P,$,U);const Z=(U-P.position)/($.position-P.position);return P.value+Z*($.value-P.value)};l.push({position:A,x:k(h,A),y:k(p,A),z:k(y,A)})}),l}update(t){var n;(n=this.rafDriver)==null||n.tick(t)}unsubscribe(t){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const n=t.address.sheetId,r=t.address.objectKey,i=this.sheets.get(n);i==null||i.detachObject(r);const o=`${n}_${r}`,l=this.sheetObjectUnsubscribe.get(o);l!==void 0&&(this.sheetObjects.delete(o),this.sheetObjectCBs.delete(o),this.sheetObjectUnsubscribe.delete(o),l())}handleApp(t){var r,i;let n;switch(t.event){case"setSheet":n=this.sheets.get(t.data.sheet),n!==void 0?(r=this.studio)==null||r.setSelection([n]):console.log(`Hermes - Can't set Sheet: ${t.data.sheet}`,n);break;case"setSheetObject":n=this.sheetObjects.get(`${t.data.sheet}_${t.data.key}`),n!==void 0?(i=this.studio)==null||i.setSelection([n]):console.log(`Hermes - Can't set Sheet Object: ${t.data.sheet}, ${t.data.key}: ${t.data.sheet}_${t.data.key}`,n);break;case"updateSheetObject":n=this.sheets.get(t.data.sheet),n!==void 0&&n.sequence.pause(),n=this.sheetObjectCBs.get(t.data.sheetObject),n!==void 0?n(t.data.values):console.log(`Hermes - Can't update Sheet Object: ${t.data.sheetObject}, ${t.data.sheet}`,n);break;case"updateTimeline":n=this.sheets.get(t.data.sheet),n!==void 0?n.sequence.position=t.data.position:console.log(`Hermes - Can't update sheet position: ${t.data.sheet}, ${t.data.position}`);break}}handleEditor(t){var n,r;switch(t.event){case"playSheet":(n=this.sheet(t.data.sheet,t.data.instance))==null||n.sequence.play(t.data.value);break;case"pauseSheet":(r=this.sheet(t.data.sheet,t.data.instance))==null||r.sequence.pause();break}}getSheetNames(){const t=[];return this.sheets.forEach((n,r)=>{t.push(r)}),t}handleEditorApp(){var t,n,r;if(this.editor){(t=this.studio)==null||t.ui.restore(),(n=this.studio)==null||n.onSelectionChange(h=>{h.length<1||h.forEach(p=>{let y=p.address.sheetId,x="setSheet",S={};switch(p.type){case"Theatre_Sheet_PublicAPI":x="setSheet",S={sheet:p.address.sheetId},this.activeSheet=this.sheets.get(p.address.sheetId);break;case"Theatre_SheetObject_PublicAPI":x="setSheetObject",y+=`_${p.address.objectKey}`,S={id:y,sheet:p.address.sheetId,key:p.address.objectKey},this.activeSheet=this.sheets.get(p.address.sheetId);break}this.send({event:x,target:"app",data:S})})});let i=-1;const o=()=>{if(this.activeSheet!==void 0&&i!==this.activeSheet.sequence.position){i=this.activeSheet.sequence.position;const h=this.activeSheet;this.send({event:"updateTimeline",target:"app",data:{position:i,sheet:h.address.sheetId}})}},l=()=>{o(),requestAnimationFrame(l)};o(),l()}else(r=this.studio)==null||r.ui.hide()}}const oW=new ts;oW.setAttribute("position",new Nr([-.5,-.5,0,1.5,-.5,0,-.5,1.5,0],3));oW.setAttribute("normal",new Nr([0,0,1,0,0,1],3));oW.setAttribute("uv",new Nr([0,0,2,0,0,2],2));new q_(-.5,.5,.5,-.5,0,100);const Tme=s=>{s==null||s.dispose()},E3e=s=>{if(s)if(Array.isArray(s))s.forEach(e=>E3e(e));else{for(const e in s){const t=s[e];t!==null&&t instanceof Wo&&Tme(t)}if(s.isShaderMaterial===!0){const e=s;for(const t in e.uniforms){const n=e.uniforms[t];n.value!==null&&n.value instanceof Wo&&Tme(n.value)}}s.dispose()}},Hh=s=>{var e;if(s){for(;s.children.length>0;){const t=s.children[0];t.type==="Audio"?(t.pause(),t.parent&&t.parent.remove(t)):Hh(t)}if(s.parent&&s.parent.remove(s),s.isMesh){const t=s;(e=t.geometry)==null||e.dispose(),E3e(t.material)}s.dispose!==void 0&&s.dispose()}};let LH=0;const Mme=()=>{LH=0},X_=s=>{if(!s)return;let e=s.name.replaceAll(" ","").replaceAll("/",".");if(e.length===0&&(e=`obj_${LH}`,LH++),s.parent!==null&&s.parent.uuid.length>0&&(e=`${s.parent.uuid}.${e}`),s.uuid=e,s.isMesh!==void 0){const t=s;if(Array.isArray(t.material))t.material.forEach((n,r)=>{n.uuid=`${e}.material.${r}`});else{const n=t.material;n.uuid=`${e}.material`}}s.children.forEach(t=>X_(t))};class q0{static init(){this.inited||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.inited=!0)}static renderToBlob(e){this.init();const t=e.repeat.clone(),n=e.offset.clone();if(e.repeat.set(1,1),e.offset.set(0,0),this.context!==null){this.context.clearRect(0,0,this.width,this.height);const r=e.image;if(r!=null&&r.width>0){this.canvas.title=e.sourceFile;const i=this.canvas.width/r.width,o=this.renderToCanvas(e);this.context.drawImage(o,0,0,r.width*i,r.height*i)}}return e.repeat.copy(t),e.offset.copy(n),this.canvas.toDataURL("image/png")}static renderToCanvas(e){if(this.material===null){this.camera=new q_(-.5,.5,.5,-.5,0,100),this.scene=new ME,this.material=new Nc;const t=new ts;t.setAttribute("position",new Nr([-.5,-.5,0,1.5,-.5,0,-.5,1.5,0],3)),t.setAttribute("normal",new Nr([0,0,1,0,0,1],3)),t.setAttribute("uv",new Nr([0,0,2,0,0,2],2));const n=new Mn(t,this.material);this.scene.add(n)}if(e.isRenderTargetTexture)this.material.map=e,this.renderer.render(this.scene,this.camera);else{const t=this.renderer.outputColorSpace,n=e.colorSpace;this.renderer.outputColorSpace=kc,e.colorSpace=kc,this.material.map=e,this.renderer.render(this.scene,this.camera),this.renderer.outputColorSpace=t,e.colorSpace=n}return this.renderer.domElement}}Qe(q0,"renderer"),Qe(q0,"canvas"),Qe(q0,"context",null),Qe(q0,"scene",null),Qe(q0,"camera",null),Qe(q0,"material",null),Qe(q0,"inited",!1),Qe(q0,"width",100),Qe(q0,"height",100);function Bke(s){if(s.name==="cameras")return"camera";if(s.name==="interactive")return"interactive";if(s.name==="lights")return"light";if(s.name==="ui")return"ui";if(s.name==="utils")return"utils";const e=s.type;return e.search("Helper")>-1?"icon_utils":e.search("Camera")>-1?"camera":e.search("Light")>-1?"light":"obj3D"}function c_(s){const e={name:s.name,type:s.type,uuid:s.uuid,children:[]};return s.children.forEach(t=>{e.children.push(c_(t))}),e}function zke(s){const e={};for(const t in s){const n=s[t].value;e[t]={value:n},n===null?e[t].value={src:"",offset:[0,0],repeat:[1,1]}:n!==void 0&&n.isTexture&&(e[t].value={src:n.image.src,offset:[n.offset.x,n.offset.y],repeat:[n.repeat.x,n.repeat.y]})}return e}function Vke(s){switch(s){case"blendSrcAlpha":case"blendDstAlpha":case"blendEquationAlpha":case"clippingPlanes":case"shadowSide":case"precision":return!0}return!1}function B7(s){const e={};for(const t in s){if(t.substring(0,1)==="_"||t.substring(0,2)==="is"||Vke(t))continue;const n=typeof s[t],r=s[t];switch(n){case"boolean":case"number":case"string":e[t]=r;break;case"object":r!==null?(e[t]=r,r.isTexture?e[t]={src:q0.renderToBlob(r),offset:[r.offset.x,r.offset.y],repeat:[r.repeat.x,r.repeat.y]}:t==="uniforms"&&(e[t]=zke(e[t]))):t==="glslVersion"?e[t]="":e[t]={src:"",offset:[0,0],repeat:[1,1]};break}}return s.anisotropy!==void 0&&(e.anisotropy=s.anisotropy),s.clearcoat!==void 0&&(e.clearcoat=s.clearcoat),s.iridescence!==void 0&&(e.iridescence=s.iridescence),s.dispersion!==void 0&&(e.dispersion=s.dispersion),s.sheen!==void 0&&(e.sheen=s.sheen),s.transmission!==void 0&&(e.transmission=s.transmission),s.transmission!==void 0&&(e.transmission=s.transmission),e}function lV(s){s.updateMatrix();const e={name:s.name,type:s.type,uuid:s.uuid,visible:s.visible,matrix:s.matrix.elements,animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};s.animations.forEach(n=>{e.animations.push({name:n.name,duration:n.duration,blendMode:n.blendMode})});const t=s.type.toLowerCase();if(t.search("mesh")>-1){const n=s;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(B7(i))}),e.material=r}else e.material=B7(n.material)}else if(t.search("points")>-1){const n=s;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(B7(i))}),e.material=r}else e.material=B7(n.material)}else if(t.search("line")>-1){const n=s;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(B7(i))}),e.material=r}else e.material=B7(n.material)}else t.search("camera")>-1?s.type==="PerspectiveCamera"?e.perspectiveCameraInfo={fov:s.fov,zoom:s.zoom,near:s.near,far:s.far,focus:s.focus,aspect:s.aspect,filmGauge:s.filmGauge,filmOffset:s.filmOffset}:s.type==="OrthographicCamera"&&(e.orthographicCameraInfo={zoom:s.zoom,near:s.near,far:s.far,left:s.left,right:s.right,top:s.top,bottom:s.bottom}):t.search("light")>-1&&(e.lightInfo={color:s.color,intensity:s.intensity,decay:s.decay,distance:s.distance,angle:s.angle,penumbra:s.penumbra,groundColor:s.groundColor,width:s.width,height:s.height});return e}function Gke(s,e){const t=e.split(".");switch(t.length){case 1:return s[t[0]];case 2:return s[t[0]][t[1]];case 3:return s[t[0]][t[1]][t[2]];case 4:return s[t[0]][t[1]][t[2]][t[3]];case 5:return s[t[0]][t[1]][t[2]][t[3]][t[4]];case 6:return s[t[0]][t[1]][t[2]][t[3]][t[4]][t[5]]}}function Hke(s,e){for(const t in e)s[t]=e[t]}function Wa(s,e,t){if(s===void 0){console.log(`Hermes - Can't set props: ${e}`,t);return}const n=e.split("."),r=n.length;if(typeof t!="object")switch(r){case 1:s[n[0]]=t;break;case 2:s[n[0]][n[1]]=t;break;case 3:s[n[0]][n[1]][n[2]]=t;break;case 4:s[n[0]][n[1]][n[2]][n[3]]=t;break;case 5:s[n[0]][n[1]][n[2]][n[3]][n[4]]=t;break}else{let o;switch(r){case 1:o=s[n[0]];break;case 2:o=s[n[0]][n[1]];break;case 3:o=s[n[0]][n[1]][n[2]];break;case 4:o=s[n[0]][n[1]][n[2]][n[3]];break;case 5:o=s[n[0]][n[1]][n[2]][n[3]][n[4]];break}o!=null?Hke(o,t):console.log(`Hermes - Can't set props because target isn't found: ${e}`,t)}}function lW(s){return new Promise((e,t)=>{const n=new Image;n.onload=()=>{const r=new Wo(n);r.wrapS=Fg,r.wrapT=Fg,r.needsUpdate=!0,e(r)},n.onerror=t,n.src=s})}function av(s,e,t){return Math.min(e,Math.max(s,t))}function Cme(s,e,t){return(t-s)/(e-s)}function UH(s,e,t){return s*(1-t)+e*t}function _f(s,e=1){return Number(s.toFixed(e))}var pi=(s=>(s.CUSTOM="ToolEvents::custom",s.SELECT_DROPDOWN="ToolEvents::selectDropdown",s.DRAG_UPDATE="ToolEvents::dragUpdate",s.ADD_SCENE="ToolEvents::addScene",s.REFRESH_SCENE="ToolEvents::refreshScene",s.REMOVE_SCENE="ToolEvents::removeScene",s.SET_SCENE="ToolEvents::setScene",s.SET_OBJECT="ToolEvents::setObject",s.CLEAR_OBJECT="ToolEvents::clearObject",s.ADD_CAMERA="ToolEvents::addCamera",s.REMOVE_CAMERA="ToolEvents::removeCamera",s.ADD_GROUP="ToolEvents::addGroup",s.REMOVE_GROUP="ToolEvents::removeGroup",s.ADD_SPLINE="ToolEvents::addSpline",s.ADD_RENDERER="ToolEvents::addRenderer",s.UPDATE_RENDERER="ToolEvents::updateRenderer",s))(pi||{});class jke extends S3e{constructor(t,n=!1,r=!1){super("RemoteThree",n,r);Qe(this,"name");Qe(this,"canvas",null);Qe(this,"inputElement",null);Qe(this,"scene");Qe(this,"scenes",new Map);Qe(this,"renderer");Qe(this,"renderTargets",new Map);Qe(this,"renderTargetsResize",new Map);Qe(this,"groups",new Map);Qe(this,"_listeners",{});this.name=t}dispose(){var t;this.scenes.forEach(n=>{Hh(n)}),this.scenes.clear(),this.scene&&Hh(this.scene),this.renderTargets.forEach(n=>{n.dispose()}),this.renderTargets.clear(),(t=this.renderer)==null||t.dispose()}addEventListener(t,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(n)===-1&&r[t].push(n)}hasEventListener(t,n){const r=this._listeners;return r===void 0?!1:r[t]!==void 0&&r[t].indexOf(n)!==-1}removeEventListener(t,n){const r=this._listeners;if(r===void 0)return;const i=r[t];if(i!==void 0){const o=i.indexOf(n);o!==-1&&i.splice(o,1)}}dispatchEvent(t){const n=this._listeners;if(n===void 0)return;const r=n[t.type];if(r!==void 0){const i={...t,target:this},o=r.slice(0);for(let l=0,h=o.length;l<h;l++)o[l].call(this,i)}}getObjectByUUID(t){const n=t.split(".")[0],r=this.scenes.get(n);if(r!==void 0)return r.getObjectByProperty("uuid",t)}getObject(t){if(!this.debug)return;this.renderer!==void 0&&(q0.renderer=this.renderer);const n=this.getObjectByUUID(t);n&&this.setObject(n)}setObject(t){this.renderer!==void 0&&(q0.renderer=this.renderer);const n=lV(t);this.dispatchEvent({type:"ToolEvents::setObject",value:n})}requestMethod(t,n,r,i){const o=this.getObjectByUUID(t);if(o)try{i!==void 0?Gke(o,i)[n](r):o[n](r)}catch(l){console.log("Hermes - Error requesting method:",t,n,r),console.log(l)}}updateObject(t,n,r){this.send({event:"updateObject",target:"app",data:{uuid:t,key:n,value:r}})}createTexture(t,n,r){this.send({event:"createTexture",target:"app",data:{uuid:t,key:n,value:r}})}onUpdateObject(t,n,r){const i=this.getObjectByUUID(t);i&&Wa(i,n,r)}onCreateTexture(t,n,r){const i=this.getObjectByUUID(t);if(i){const o=l=>{const h=n.split(".");switch(h.length){case 1:i[h[0]]=l;break;case 2:i[h[0]][h[1]]=l;break;case 3:i[h[0]][h[1]][h[2]]=l;break;case 4:i[h[0]][h[1]][h[2]][h[3]]=l;break;case 5:i[h[0]][h[1]][h[2]][h[3]][h[4]]=l;break}i.material.needsUpdate=!0};r.src.length>0?lW(r.src).then(l=>{l.offset.set(r.offset[0],r.offset[1]),l.repeat.set(r.repeat[0],r.repeat[1]),o(l)}):o(null)}}addGroup(t){this.groups.get(t.title)===void 0&&(this.groups.set(t.title,{title:t.title,onUpdate:t.onUpdate}),this.send({event:"addGroup",target:"editor",data:JSON.stringify(t)}))}removeGroup(t){this.groups.get(t)!==void 0&&(this.groups.delete(t),this.send({event:"removeGroup",target:"editor",data:t}))}updateGroup(t,n,r){this.send({event:"updateGroup",target:"app",data:JSON.stringify({group:t,prop:n,value:r})})}addSpline(t){setTimeout(()=>{this.send({event:"addSpline",target:"editor",data:JSON.stringify(t.toJSON())})},1)}setRenderer(t,n=null){if(this.renderer=t,this.canvas=t.domElement,this.inputElement=n!==null?n:this.canvas,!this.debug)return;const r=`#${t.getClearColor(new Vn).getHexString()}`;this.send({event:"addRenderer",target:"editor",data:{autoClear:t.autoClear,autoClearColor:t.autoClearColor,autoClearDepth:t.autoClearDepth,autoClearStencil:t.autoClearStencil,outputColorSpace:t.outputColorSpace,localClippingEnabled:t.localClippingEnabled,clearColor:r,clearAlpha:t.getClearAlpha(),colorManagement:Yr.enabled,toneMapping:t.toneMapping,toneMappingExposure:t.toneMappingExposure,type:t.isWebGLRenderer?"WebGLRenderer":"WebGPURenderer"}})}updateRenderer(t){this.send({event:"updateRenderer",target:"app",data:t})}addScene(t){if(t===void 0||(this.scenes.set(t.name,t),!this.debug))return;Mme(),X_(t);const n=c_(t);this.send({event:"addScene",target:"editor",data:n})}refreshScene(t){if(!this.debug)return;const n=this.scenes.get(t);if(n!==void 0){const r=c_(n);this.send({event:"refreshScene",target:"app",data:r})}}removeScene(t){if(t===void 0||(this.scenes.delete(t.name),!this.debug))return;const n=c_(t);this.send({event:"removeScene",target:"editor",data:n})}removeAllScenes(){this.scenes.forEach(t=>this.removeScene(t))}getScene(t){let n=null;return this.scene!==void 0&&this.scene.uuid.search(t)>-1?this.scene:(this.scenes.forEach((r,i)=>{t.search(i)>-1&&(n=r)}),n)}setScene(t){if(t===void 0||(this.scene=t,!this.debug))return;this.renderer!==void 0&&(q0.renderer=this.renderer),Mme(),X_(t);const n=c_(t);this.send({event:"setScene",target:"editor",data:n})}requestSize(){this.send({event:"requestSize",target:"app"})}addCamera(t){if(!this.debug)return;const n=lV(t);this.send({event:"addCamera",target:"editor",data:n})}removeCamera(t){if(!this.debug)return;const n=lV(t);this.send({event:"removeCamera",target:"editor",data:n})}handleApp(t){switch(t.event){case"refreshScene":this.send({event:"refreshScene",target:"editor",data:c_(this.scenes.get(t.data.name))});break;case"updateRenderer":this.renderer&&(this.renderer.autoClearColor=t.data.autoClearColor,this.renderer.outputColorSpace=t.data.outputColorSpace,this.renderer.localClippingEnabled=t.data.localClippingEnabled,this.renderer.setClearColor(t.data.clearColor,t.data.clearAlpha),this.renderer.toneMapping=t.data.toneMapping,this.renderer.toneMappingExposure=t.data.toneMappingExposure,Yr.enabled=t.data.colorManagement);break}if(t.event==="updateGroup"){const n=JSON.parse(t.data),r=this.groups.get(n.group);r==null||r.onUpdate(n.prop,n.value)}}handleEditor(t){switch(t.event){case"addScene":this.dispatchEvent({type:"ToolEvents::addScene",value:t.data});break;case"refreshScene":this.dispatchEvent({type:"ToolEvents::refreshScene",value:t.data});break;case"removeScene":this.dispatchEvent({type:"ToolEvents::removeScene",value:t.data});break;case"setScene":this.dispatchEvent({type:"ToolEvents::setScene",value:t.data});break;case"addCamera":this.dispatchEvent({type:"ToolEvents::addCamera",value:t.data});break;case"removeCamera":this.dispatchEvent({type:"ToolEvents::removeCamera",value:t.data});break;case"addGroup":this.dispatchEvent({type:"ToolEvents::addGroup",value:t.data});break;case"removeGroup":this.dispatchEvent({type:"ToolEvents::removeGroup",value:t.data});break;case"addSpline":this.dispatchEvent({type:"ToolEvents::addSpline",value:t.data});break;case"addRenderer":this.dispatchEvent({type:"ToolEvents::addRenderer",value:t.data})}}messageHandler(t){const n=t.data;if(n.event==="updateObject"){this.onUpdateObject(n.data.uuid,n.data.key,n.data.value);return}else if(n.event==="createTexture"){this.onCreateTexture(n.data.uuid,n.data.key,n.data.value);return}else if(n.event==="requestSize"){n.target==="app"?this.send({event:"requestSize",target:"editor",data:{width:this.width,height:this.height}}):this.scenes.forEach(r=>{r.resize!==void 0&&r.resize(n.data.width,n.data.height)});return}n.target==="app"?this.handleApp(n):this.handleEditor(n)}addRT(t,n=!0,r){const i=new J0(32,32,r);i.texture.name=t,this.renderTargets.set(t,i),this.renderTargetsResize.set(t,n)}removeRT(t){this.renderTargets.delete(t),this.renderTargetsResize.delete(t)}resize(t,n){var o,l;const r=this.dpr;this.renderTargets.forEach((h,p)=>{this.renderTargetsResize.get(p)&&h.setSize(t*r,n*r)});const i=!(((o=this.renderer)==null?void 0:o.domElement)instanceof OffscreenCanvas);(l=this.renderer)==null||l.setSize(t,n,i)}set dpr(t){var n;(n=this.renderer)==null||n.setPixelRatio(av(1,2,t))}get dpr(){var t;return this.renderer!==void 0?(t=this.renderer)==null?void 0:t.getPixelRatio():1}get width(){return this.renderer!==void 0?this.renderer.domElement.width/this.dpr:0}get height(){return this.renderer!==void 0?this.renderer.domElement.height/this.dpr:0}}function Wke(s){const t=s.app.components.get("theatre");return t.studio=d9e,t.handleEditorApp(),null}function $ke(s){return et.jsxs("div",{className:"editor",ref:s.ref,style:s.style,children:[et.jsx("div",{className:"header",children:s.header}),s.children,et.jsx("div",{className:"footer",children:s.footer})]})}class qke{constructor(e,t){this.nodes=e,this.info=t,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,n)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(t,n)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Tf{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let n=this.weakMap;for(let r=0;r<e.length-1;r++){const i=e[r];n.has(i)===!1&&n.set(i,new WeakMap),n=n.get(i)}return n.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return!1;return t.delete(e[e.length-1])}}const H0=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ame=1234567;const hE=Math.PI/180,Y_=180/Math.PI;function Ag(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(H0[s&255]+H0[s>>8&255]+H0[s>>16&255]+H0[s>>24&255]+"-"+H0[e&255]+H0[e>>8&255]+"-"+H0[e>>16&15|64]+H0[e>>24&255]+"-"+H0[t&63|128]+H0[t>>8&255]+"-"+H0[t>>16&255]+H0[t>>24&255]+H0[n&255]+H0[n>>8&255]+H0[n>>16&255]+H0[n>>24&255]).toLowerCase()}function Ei(s,e,t){return Math.max(e,Math.min(t,s))}function uW(s,e){return(s%e+e)%e}function ov(s,e,t,n,r){return n+(s-e)*(r-n)/(t-e)}function Xke(s,e,t){return s!==e?(t-s)/(e-s):0}function Q3(s,e,t){return(1-t)*s+t*e}function Yke(s,e,t,n){return Q3(s,e,1-Math.exp(-t*n))}function Kke(s,e=1){return e-Math.abs(uW(s,e*2)-e)}function Zke(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function Qke(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function Jke(s,e){return s+Math.floor(Math.random()*(e-s+1))}function eNe(s,e){return s+Math.random()*(e-s)}function tNe(s){return s*(.5-Math.random())}function nNe(s){s!==void 0&&(Ame=s);let e=Ame+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function rk(s){return s*hE}function T3e(s){return s*Y_}function rNe(s){return(s&s-1)===0&&s!==0}function iNe(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function sNe(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function aNe(s,e,t,n,r){const i=Math.cos,o=Math.sin,l=i(t/2),h=o(t/2),p=i((e+n)/2),y=o((e+n)/2),x=i((e-n)/2),S=o((e-n)/2),A=i((n-e)/2),k=o((n-e)/2);switch(r){case"XYX":s.set(l*y,h*x,h*S,l*p);break;case"YZY":s.set(h*S,l*y,h*x,l*p);break;case"ZXZ":s.set(h*x,h*S,l*y,l*p);break;case"XZX":s.set(l*y,h*k,h*A,l*p);break;case"YXY":s.set(h*A,l*y,h*k,l*p);break;case"ZYZ":s.set(h*k,h*A,l*y,l*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function zl(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function si(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const oNe={DEG2RAD:hE,RAD2DEG:Y_,generateUUID:Ag,clamp:Ei,euclideanModulo:uW,mapLinear:ov,inverseLerp:Xke,lerp:Q3,damp:Yke,pingpong:Kke,smoothstep:Zke,smootherstep:Qke,randInt:Jke,randFloat:eNe,randFloatSpread:tNe,seededRandom:nNe,degToRad:rk,radToDeg:T3e,isPowerOfTwo:rNe,ceilPowerOfTwo:iNe,floorPowerOfTwo:sNe,setQuaternionFromProperEuler:aNe,normalize:si,denormalize:zl},M3e="177",lNe=0,uNe=1,cNe=2,hNe=0,dNe=1,DI=3,Pg=0,Nu=1,P_=2,K_=0,Rg=1,ik=2,sk=3,ak=4,dE=5,Sf=100,C3e=101,A3e=102,fNe=103,pNe=104,j3=200,P3e=201,R3e=202,I3e=203,ok=204,lk=205,k3e=206,N3e=207,D3e=208,O3e=209,F3e=210,L3e=0,U3e=1,B3e=2,uk=3,z3e=4,V3e=5,G3e=6,H3e=7,Nk=0,mNe=1,gNe=2,R_=0,vNe=1,yNe=2,_Ne=3,xNe=4,bNe=6,SNe=7,cW=300,NE=301,ck=302,hW=303,dW=304,BH=306,Z_=1e3,Z3=1001,Q_=1002,So=1003,j3e=1004,DE=1005,Dc=1006,zH=1007,Ig=1008,Vl=1009,fE=1010,pE=1011,__=1012,Ul=1013,$a=1014,Rc=1015,Uh=1016,wNe=1017,ENe=1018,J3=1020,W3e=35902,TNe=1021,fW=1022,Bh=1023,l1=1026,kg=1027,pW=1028,mW=1029,bv=1030,gW=1031,MNe=1032,vW=1033,uV=33776,OI=33777,FI=33778,LI=33779,Pme=35840,Rme=35841,Ime=35842,kme=35843,Nme=36196,VH=37492,GH=37496,HH=37808,jH=37809,WH=37810,$H=37811,qH=37812,XH=37813,YH=37814,KH=37815,ZH=37816,QH=37817,JH=37818,ej=37819,tj=37820,nj=37821,cV=36492,CNe=36283,Dme=36284,Ome=36285,Fme=36286,r4=0,ANe=1,Lg="",Ac="srgb",I_="srgb-linear",hk="linear",Xr="srgb",PNe=0,lv=7680,RNe=7681,INe=7682,kNe=7683,NNe=34055,DNe=34056,ONe=5386,FNe=512,LNe=513,UNe=514,BNe=515,zNe=516,VNe=517,GNe=518,rj=519,$3e=512,yW=513,q3e=514,X3e=515,Y3e=516,K3e=517,Z3e=518,Q3e=519,dk=35044,x_=35048,Ru=2e3,i4=2001;class Ou{constructor(e,t,n,r,i,o,l,h,p){Ou.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,o,l,h,p)}set(e,t,n,r,i,o,l,h,p){const y=this.elements;return y[0]=e,y[1]=r,y[2]=l,y[3]=t,y[4]=i,y[5]=h,y[6]=n,y[7]=o,y[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],l=n[3],h=n[6],p=n[1],y=n[4],x=n[7],S=n[2],A=n[5],k=n[8],L=r[0],U=r[3],P=r[6],$=r[1],Z=r[4],I=r[7],ie=r[2],ce=r[5],ue=r[8];return i[0]=o*L+l*$+h*ie,i[3]=o*U+l*Z+h*ce,i[6]=o*P+l*I+h*ue,i[1]=p*L+y*$+x*ie,i[4]=p*U+y*Z+x*ce,i[7]=p*P+y*I+x*ue,i[2]=S*L+A*$+k*ie,i[5]=S*U+A*Z+k*ce,i[8]=S*P+A*I+k*ue,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],l=e[5],h=e[6],p=e[7],y=e[8];return t*o*y-t*l*p-n*i*y+n*l*h+r*i*p-r*o*h}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],l=e[5],h=e[6],p=e[7],y=e[8],x=y*o-l*p,S=l*h-y*i,A=p*i-o*h,k=t*x+n*S+r*A;if(k===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/k;return e[0]=x*L,e[1]=(r*p-y*n)*L,e[2]=(l*n-r*o)*L,e[3]=S*L,e[4]=(y*t-r*h)*L,e[5]=(r*i-l*t)*L,e[6]=A*L,e[7]=(n*h-p*t)*L,e[8]=(o*t-n*i)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,o,l){const h=Math.cos(i),p=Math.sin(i);return this.set(n*h,n*p,-n*(h*o+p*l)+o+e,-r*p,r*h,-r*(-p*o+h*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(hV.makeScale(e,t)),this}rotate(e){return this.premultiply(hV.makeRotation(-e)),this}translate(e,t){return this.premultiply(hV.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const hV=new Ou;function J3e(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function ij(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function HNe(){const s=ij("canvas");return s.style.display="block",s}const Lme={};function Ug(s){s in Lme||(Lme[s]=!0,console.warn(s))}const Ume=new Ou().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Bme=new Ou().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function jNe(){const s={enabled:!0,workingColorSpace:I_,spaces:{},convert:function(r,i,o){return this.enabled===!1||i===o||!i||!o||(this.spaces[i].transfer===Xr&&(r.r=Ng(r.r),r.g=Ng(r.g),r.b=Ng(r.b)),this.spaces[i].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[i].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Xr&&(r.r=k_(r.r),r.g=k_(r.g),r.b=k_(r.b))),r},workingToColorSpace:function(r,i){return this.convert(r,this.workingColorSpace,i)},colorSpaceToWorking:function(r,i){return this.convert(r,i,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Lg?hk:this.spaces[r].transfer},getLuminanceCoefficients:function(r,i=this.workingColorSpace){return r.fromArray(this.spaces[i].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,i,o){return r.copy(this.spaces[i].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,i){return Ug("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(r,i)},toWorkingColorSpace:function(r,i){return Ug("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(r,i)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[I_]:{primaries:e,whitePoint:n,transfer:hk,toXYZ:Ume,fromXYZ:Bme,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Ac},outputColorSpaceConfig:{drawingBufferColorSpace:Ac}},[Ac]:{primaries:e,whitePoint:n,transfer:Xr,toXYZ:Ume,fromXYZ:Bme,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Ac}}}),s}const Us=jNe();function Ng(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function k_(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}const e4e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},I3={h:0,s:0,l:0},DR={h:0,s:0,l:0};function dV(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class Ki{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ac){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Us.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Us.workingColorSpace){return this.r=e,this.g=t,this.b=n,Us.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Us.workingColorSpace){if(e=uW(e,1),t=Ei(t,0,1),n=Ei(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,o=2*n-i;this.r=dV(o,i,e+1/3),this.g=dV(o,i,e),this.b=dV(o,i,e-1/3)}return Us.colorSpaceToWorking(this,r),this}setStyle(e,t=Ac){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const o=r[1],l=r[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],o=i.length;if(o===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ac){const n=e4e[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ng(e.r),this.g=Ng(e.g),this.b=Ng(e.b),this}copyLinearToSRGB(e){return this.r=k_(e.r),this.g=k_(e.g),this.b=k_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ac){return Us.workingToColorSpace(j0.copy(this),e),Math.round(Ei(j0.r*255,0,255))*65536+Math.round(Ei(j0.g*255,0,255))*256+Math.round(Ei(j0.b*255,0,255))}getHexString(e=Ac){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Us.workingColorSpace){Us.workingToColorSpace(j0.copy(this),t);const n=j0.r,r=j0.g,i=j0.b,o=Math.max(n,r,i),l=Math.min(n,r,i);let h,p;const y=(l+o)/2;if(l===o)h=0,p=0;else{const x=o-l;switch(p=y<=.5?x/(o+l):x/(2-o-l),o){case n:h=(r-i)/x+(r<i?6:0);break;case r:h=(i-n)/x+2;break;case i:h=(n-r)/x+4;break}h/=6}return e.h=h,e.s=p,e.l=y,e}getRGB(e,t=Us.workingColorSpace){return Us.workingToColorSpace(j0.copy(this),t),e.r=j0.r,e.g=j0.g,e.b=j0.b,e}getStyle(e=Ac){Us.workingToColorSpace(j0.copy(this),e);const t=j0.r,n=j0.g,r=j0.b;return e!==Ac?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(I3),this.setHSL(I3.h+e,I3.s+t,I3.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(I3),e.getHSL(DR);const n=Q3(I3.h,DR.h,t),r=Q3(I3.s,DR.s,t),i=Q3(I3.l,DR.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const j0=new Ki;Ki.NAMES=e4e;class Dk{constructor(e,t,n,r){Dk.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=r,this}}class hx{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,o,l){let h=n[r+0],p=n[r+1],y=n[r+2],x=n[r+3];const S=i[o+0],A=i[o+1],k=i[o+2],L=i[o+3];if(l===0){e[t+0]=h,e[t+1]=p,e[t+2]=y,e[t+3]=x;return}if(l===1){e[t+0]=S,e[t+1]=A,e[t+2]=k,e[t+3]=L;return}if(x!==L||h!==S||p!==A||y!==k){let U=1-l;const P=h*S+p*A+y*k+x*L,$=P>=0?1:-1,Z=1-P*P;if(Z>Number.EPSILON){const ie=Math.sqrt(Z),ce=Math.atan2(ie,P*$);U=Math.sin(U*ce)/ie,l=Math.sin(l*ce)/ie}const I=l*$;if(h=h*U+S*I,p=p*U+A*I,y=y*U+k*I,x=x*U+L*I,U===1-l){const ie=1/Math.sqrt(h*h+p*p+y*y+x*x);h*=ie,p*=ie,y*=ie,x*=ie}}e[t]=h,e[t+1]=p,e[t+2]=y,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,i,o){const l=n[r],h=n[r+1],p=n[r+2],y=n[r+3],x=i[o],S=i[o+1],A=i[o+2],k=i[o+3];return e[t]=l*k+y*x+h*A-p*S,e[t+1]=h*k+y*S+p*x-l*A,e[t+2]=p*k+y*A+l*S-h*x,e[t+3]=y*k-l*x-h*S-p*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,o=e._order,l=Math.cos,h=Math.sin,p=l(n/2),y=l(r/2),x=l(i/2),S=h(n/2),A=h(r/2),k=h(i/2);switch(o){case"XYZ":this._x=S*y*x+p*A*k,this._y=p*A*x-S*y*k,this._z=p*y*k+S*A*x,this._w=p*y*x-S*A*k;break;case"YXZ":this._x=S*y*x+p*A*k,this._y=p*A*x-S*y*k,this._z=p*y*k-S*A*x,this._w=p*y*x+S*A*k;break;case"ZXY":this._x=S*y*x-p*A*k,this._y=p*A*x+S*y*k,this._z=p*y*k+S*A*x,this._w=p*y*x-S*A*k;break;case"ZYX":this._x=S*y*x-p*A*k,this._y=p*A*x+S*y*k,this._z=p*y*k-S*A*x,this._w=p*y*x+S*A*k;break;case"YZX":this._x=S*y*x+p*A*k,this._y=p*A*x+S*y*k,this._z=p*y*k-S*A*x,this._w=p*y*x-S*A*k;break;case"XZY":this._x=S*y*x-p*A*k,this._y=p*A*x-S*y*k,this._z=p*y*k+S*A*x,this._w=p*y*x+S*A*k;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],l=t[5],h=t[9],p=t[2],y=t[6],x=t[10],S=n+l+x;if(S>0){const A=.5/Math.sqrt(S+1);this._w=.25/A,this._x=(y-h)*A,this._y=(i-p)*A,this._z=(o-r)*A}else if(n>l&&n>x){const A=2*Math.sqrt(1+n-l-x);this._w=(y-h)/A,this._x=.25*A,this._y=(r+o)/A,this._z=(i+p)/A}else if(l>x){const A=2*Math.sqrt(1+l-n-x);this._w=(i-p)/A,this._x=(r+o)/A,this._y=.25*A,this._z=(h+y)/A}else{const A=2*Math.sqrt(1+x-n-l);this._w=(o-r)/A,this._x=(i+p)/A,this._y=(h+y)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ei(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,o=e._w,l=t._x,h=t._y,p=t._z,y=t._w;return this._x=n*y+o*l+r*p-i*h,this._y=r*y+o*h+i*l-n*p,this._z=i*y+o*p+n*h-r*l,this._w=o*y-n*l-r*h-i*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let l=o*e._w+n*e._x+r*e._y+i*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const h=1-l*l;if(h<=Number.EPSILON){const A=1-t;return this._w=A*o+t*this._w,this._x=A*n+t*this._x,this._y=A*r+t*this._y,this._z=A*i+t*this._z,this.normalize(),this}const p=Math.sqrt(h),y=Math.atan2(p,l),x=Math.sin((1-t)*y)/p,S=Math.sin(t*y)/p;return this._w=o*x+this._w*S,this._x=n*x+this._x*S,this._y=r*x+this._y*S,this._z=i*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class vt{constructor(e=0,t=0,n=0){vt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(zme.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(zme.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,l=e.z,h=e.w,p=2*(o*r-l*n),y=2*(l*t-i*r),x=2*(i*n-o*t);return this.x=t+h*p+o*x-l*y,this.y=n+h*y+l*p-i*x,this.z=r+h*x+i*y-o*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Ei(this.x,e.x,t.x),this.y=Ei(this.y,e.y,t.y),this.z=Ei(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Ei(this.x,e,t),this.y=Ei(this.y,e,t),this.z=Ei(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ei(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,o=t.x,l=t.y,h=t.z;return this.x=r*h-i*l,this.y=i*o-n*h,this.z=n*l-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return fV.copy(this).projectOnVector(e),this.sub(fV)}reflect(e){return this.sub(fV.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ei(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const fV=new vt,zme=new hx;class As{constructor(e,t,n,r,i,o,l,h,p,y,x,S,A,k,L,U){As.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,o,l,h,p,y,x,S,A,k,L,U)}set(e,t,n,r,i,o,l,h,p,y,x,S,A,k,L,U){const P=this.elements;return P[0]=e,P[4]=t,P[8]=n,P[12]=r,P[1]=i,P[5]=o,P[9]=l,P[13]=h,P[2]=p,P[6]=y,P[10]=x,P[14]=S,P[3]=A,P[7]=k,P[11]=L,P[15]=U,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new As().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/z7.setFromMatrixColumn(e,0).length(),i=1/z7.setFromMatrixColumn(e,1).length(),o=1/z7.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),l=Math.sin(n),h=Math.cos(r),p=Math.sin(r),y=Math.cos(i),x=Math.sin(i);if(e.order==="XYZ"){const S=o*y,A=o*x,k=l*y,L=l*x;t[0]=h*y,t[4]=-h*x,t[8]=p,t[1]=A+k*p,t[5]=S-L*p,t[9]=-l*h,t[2]=L-S*p,t[6]=k+A*p,t[10]=o*h}else if(e.order==="YXZ"){const S=h*y,A=h*x,k=p*y,L=p*x;t[0]=S+L*l,t[4]=k*l-A,t[8]=o*p,t[1]=o*x,t[5]=o*y,t[9]=-l,t[2]=A*l-k,t[6]=L+S*l,t[10]=o*h}else if(e.order==="ZXY"){const S=h*y,A=h*x,k=p*y,L=p*x;t[0]=S-L*l,t[4]=-o*x,t[8]=k+A*l,t[1]=A+k*l,t[5]=o*y,t[9]=L-S*l,t[2]=-o*p,t[6]=l,t[10]=o*h}else if(e.order==="ZYX"){const S=o*y,A=o*x,k=l*y,L=l*x;t[0]=h*y,t[4]=k*p-A,t[8]=S*p+L,t[1]=h*x,t[5]=L*p+S,t[9]=A*p-k,t[2]=-p,t[6]=l*h,t[10]=o*h}else if(e.order==="YZX"){const S=o*h,A=o*p,k=l*h,L=l*p;t[0]=h*y,t[4]=L-S*x,t[8]=k*x+A,t[1]=x,t[5]=o*y,t[9]=-l*y,t[2]=-p*y,t[6]=A*x+k,t[10]=S-L*x}else if(e.order==="XZY"){const S=o*h,A=o*p,k=l*h,L=l*p;t[0]=h*y,t[4]=-x,t[8]=p*y,t[1]=S*x+L,t[5]=o*y,t[9]=A*x-k,t[2]=k*x-A,t[6]=l*y,t[10]=L*x+S}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(WNe,e,$Ne)}lookAt(e,t,n){const r=this.elements;return wc.subVectors(e,t),wc.lengthSq()===0&&(wc.z=1),wc.normalize(),k3.crossVectors(n,wc),k3.lengthSq()===0&&(Math.abs(n.z)===1?wc.x+=1e-4:wc.z+=1e-4,wc.normalize(),k3.crossVectors(n,wc)),k3.normalize(),OR.crossVectors(wc,k3),r[0]=k3.x,r[4]=OR.x,r[8]=wc.x,r[1]=k3.y,r[5]=OR.y,r[9]=wc.y,r[2]=k3.z,r[6]=OR.z,r[10]=wc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],l=n[4],h=n[8],p=n[12],y=n[1],x=n[5],S=n[9],A=n[13],k=n[2],L=n[6],U=n[10],P=n[14],$=n[3],Z=n[7],I=n[11],ie=n[15],ce=r[0],ue=r[4],Q=r[8],oe=r[12],le=r[1],J=r[5],Be=r[9],He=r[13],rt=r[2],ot=r[6],Se=r[10],gt=r[14],Ae=r[3],lt=r[7],pt=r[11],De=r[15];return i[0]=o*ce+l*le+h*rt+p*Ae,i[4]=o*ue+l*J+h*ot+p*lt,i[8]=o*Q+l*Be+h*Se+p*pt,i[12]=o*oe+l*He+h*gt+p*De,i[1]=y*ce+x*le+S*rt+A*Ae,i[5]=y*ue+x*J+S*ot+A*lt,i[9]=y*Q+x*Be+S*Se+A*pt,i[13]=y*oe+x*He+S*gt+A*De,i[2]=k*ce+L*le+U*rt+P*Ae,i[6]=k*ue+L*J+U*ot+P*lt,i[10]=k*Q+L*Be+U*Se+P*pt,i[14]=k*oe+L*He+U*gt+P*De,i[3]=$*ce+Z*le+I*rt+ie*Ae,i[7]=$*ue+Z*J+I*ot+ie*lt,i[11]=$*Q+Z*Be+I*Se+ie*pt,i[15]=$*oe+Z*He+I*gt+ie*De,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],l=e[5],h=e[9],p=e[13],y=e[2],x=e[6],S=e[10],A=e[14],k=e[3],L=e[7],U=e[11],P=e[15];return k*(+i*h*x-r*p*x-i*l*S+n*p*S+r*l*A-n*h*A)+L*(+t*h*A-t*p*S+i*o*S-r*o*A+r*p*y-i*h*y)+U*(+t*p*x-t*l*A-i*o*x+n*o*A+i*l*y-n*p*y)+P*(-r*l*y-t*h*x+t*l*S+r*o*x-n*o*S+n*h*y)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],l=e[5],h=e[6],p=e[7],y=e[8],x=e[9],S=e[10],A=e[11],k=e[12],L=e[13],U=e[14],P=e[15],$=x*U*p-L*S*p+L*h*A-l*U*A-x*h*P+l*S*P,Z=k*S*p-y*U*p-k*h*A+o*U*A+y*h*P-o*S*P,I=y*L*p-k*x*p+k*l*A-o*L*A-y*l*P+o*x*P,ie=k*x*h-y*L*h-k*l*S+o*L*S+y*l*U-o*x*U,ce=t*$+n*Z+r*I+i*ie;if(ce===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ue=1/ce;return e[0]=$*ue,e[1]=(L*S*i-x*U*i-L*r*A+n*U*A+x*r*P-n*S*P)*ue,e[2]=(l*U*i-L*h*i+L*r*p-n*U*p-l*r*P+n*h*P)*ue,e[3]=(x*h*i-l*S*i-x*r*p+n*S*p+l*r*A-n*h*A)*ue,e[4]=Z*ue,e[5]=(y*U*i-k*S*i+k*r*A-t*U*A-y*r*P+t*S*P)*ue,e[6]=(k*h*i-o*U*i-k*r*p+t*U*p+o*r*P-t*h*P)*ue,e[7]=(o*S*i-y*h*i+y*r*p-t*S*p-o*r*A+t*h*A)*ue,e[8]=I*ue,e[9]=(k*x*i-y*L*i-k*n*A+t*L*A+y*n*P-t*x*P)*ue,e[10]=(o*L*i-k*l*i+k*n*p-t*L*p-o*n*P+t*l*P)*ue,e[11]=(y*l*i-o*x*i-y*n*p+t*x*p+o*n*A-t*l*A)*ue,e[12]=ie*ue,e[13]=(y*L*r-k*x*r+k*n*S-t*L*S-y*n*U+t*x*U)*ue,e[14]=(k*l*r-o*L*r-k*n*h+t*L*h+o*n*U-t*l*U)*ue,e[15]=(o*x*r-y*l*r+y*n*h-t*x*h-o*n*S+t*l*S)*ue,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,l=e.y,h=e.z,p=i*o,y=i*l;return this.set(p*o+n,p*l-r*h,p*h+r*l,0,p*l+r*h,y*l+n,y*h-r*o,0,p*h-r*l,y*h+r*o,i*h*h+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,o=t._y,l=t._z,h=t._w,p=i+i,y=o+o,x=l+l,S=i*p,A=i*y,k=i*x,L=o*y,U=o*x,P=l*x,$=h*p,Z=h*y,I=h*x,ie=n.x,ce=n.y,ue=n.z;return r[0]=(1-(L+P))*ie,r[1]=(A+I)*ie,r[2]=(k-Z)*ie,r[3]=0,r[4]=(A-I)*ce,r[5]=(1-(S+P))*ce,r[6]=(U+$)*ce,r[7]=0,r[8]=(k+Z)*ue,r[9]=(U-$)*ue,r[10]=(1-(S+L))*ue,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=z7.set(r[0],r[1],r[2]).length();const o=z7.set(r[4],r[5],r[6]).length(),l=z7.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],cf.copy(this);const p=1/i,y=1/o,x=1/l;return cf.elements[0]*=p,cf.elements[1]*=p,cf.elements[2]*=p,cf.elements[4]*=y,cf.elements[5]*=y,cf.elements[6]*=y,cf.elements[8]*=x,cf.elements[9]*=x,cf.elements[10]*=x,t.setFromRotationMatrix(cf),n.x=i,n.y=o,n.z=l,this}makePerspective(e,t,n,r,i,o,l=Ru){const h=this.elements,p=2*i/(t-e),y=2*i/(n-r),x=(t+e)/(t-e),S=(n+r)/(n-r);let A,k;if(l===Ru)A=-(o+i)/(o-i),k=-2*o*i/(o-i);else if(l===i4)A=-o/(o-i),k=-o*i/(o-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return h[0]=p,h[4]=0,h[8]=x,h[12]=0,h[1]=0,h[5]=y,h[9]=S,h[13]=0,h[2]=0,h[6]=0,h[10]=A,h[14]=k,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,r,i,o,l=Ru){const h=this.elements,p=1/(t-e),y=1/(n-r),x=1/(o-i),S=(t+e)*p,A=(n+r)*y;let k,L;if(l===Ru)k=(o+i)*x,L=-2*x;else if(l===i4)k=i*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-S,h[1]=0,h[5]=2*y,h[9]=0,h[13]=-A,h[2]=0,h[6]=0,h[10]=L,h[14]=-k,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const z7=new vt,cf=new As,WNe=new vt(0,0,0),$Ne=new vt(1,1,1),k3=new vt,OR=new vt,wc=new vt;class mi{constructor(e=0,t=0){mi.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Ei(this.x,e.x,t.x),this.y=Ei(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Ei(this.x,e,t),this.y=Ei(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ei(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ei(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ki{constructor(e=0,t=0,n=0,r=1){ki.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const h=e.elements,p=h[0],y=h[4],x=h[8],S=h[1],A=h[5],k=h[9],L=h[2],U=h[6],P=h[10];if(Math.abs(y-S)<.01&&Math.abs(x-L)<.01&&Math.abs(k-U)<.01){if(Math.abs(y+S)<.1&&Math.abs(x+L)<.1&&Math.abs(k+U)<.1&&Math.abs(p+A+P-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Z=(p+1)/2,I=(A+1)/2,ie=(P+1)/2,ce=(y+S)/4,ue=(x+L)/4,Q=(k+U)/4;return Z>I&&Z>ie?Z<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(Z),r=ce/n,i=ue/n):I>ie?I<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(I),n=ce/r,i=Q/r):ie<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(ie),n=ue/i,r=Q/i),this.set(n,r,i,t),this}let $=Math.sqrt((U-k)*(U-k)+(x-L)*(x-L)+(S-y)*(S-y));return Math.abs($)<.001&&($=1),this.x=(U-k)/$,this.y=(x-L)/$,this.z=(S-y)/$,this.w=Math.acos((p+A+P-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Ei(this.x,e.x,t.x),this.y=Ei(this.y,e.y,t.y),this.z=Ei(this.z,e.z,t.z),this.w=Ei(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Ei(this.x,e,t),this.y=Ei(this.y,e,t),this.z=Ei(this.z,e,t),this.w=Ei(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ei(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}function OE(s,e=0){let t=3735928559^e,n=1103547991^e;if(s instanceof Array)for(let r=0,i;r<s.length;r++)i=s[r],t=Math.imul(t^i,2654435761),n=Math.imul(n^i,1597334677);else for(let r=0,i;r<s.length;r++)i=s.charCodeAt(r),t=Math.imul(t^i,2654435761),n=Math.imul(n^i,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}const qNe=s=>OE(s),_W=s=>OE(s),fk=(...s)=>OE(s);function t4e(s,e=!1){const t=[];s.isNode===!0&&(t.push(s.id),s=s.getSelf());for(const{property:n,childNode:r}of pk(s))t.push(OE(n.slice(0,-4)),r.getCacheKey(e));return OE(t)}function*pk(s,e=!1){for(const t in s){if(t.startsWith("_")===!0)continue;const n=s[t];if(Array.isArray(n)===!0)for(let r=0;r<n.length;r++){const i=n[r];i&&(i.isNode===!0||e&&typeof i.toJSON=="function")&&(yield{property:t,index:r,childNode:i})}else if(n&&n.isNode===!0)yield{property:t,childNode:n};else if(typeof n=="object")for(const r in n){const i=n[r];i&&(i.isNode===!0||e&&typeof i.toJSON=="function")&&(yield{property:t,index:r,childNode:i})}}}const XNe=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),Vme=new WeakMap;function YNe(s){return XNe.get(s)}function mk(s){if(s==null)return null;const e=typeof s;return s.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":s.isVector2===!0?"vec2":s.isVector3===!0?"vec3":s.isVector4===!0?"vec4":s.isMatrix2===!0?"mat2":s.isMatrix3===!0?"mat3":s.isMatrix4===!0?"mat4":s.isColor===!0?"color":s instanceof ArrayBuffer?"ArrayBuffer":null}function n4e(s,...e){const t=s?s.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),s==="color"?new Ki(...e):t==="vec2"?new mi(...e):t==="vec3"?new vt(...e):t==="vec4"?new ki(...e):t==="mat2"?new Dk(...e):t==="mat3"?new Ou(...e):t==="mat4"?new As(...e):s==="bool"?e[0]||!1:s==="float"||s==="int"||s==="uint"?e[0]||0:s==="string"?e[0]||"":s==="ArrayBuffer"?ZNe(e[0]):null}function r4e(s){let e=Vme.get(s);return e===void 0&&(e={},Vme.set(s,e)),e}function KNe(s){let e="";const t=new Uint8Array(s);for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function ZNe(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0)).buffer}let QNe=0;function JNe(s){const e=Object.keys(s);let t=Object.getPrototypeOf(s);for(;t;){const n=Object.getOwnPropertyDescriptors(t);for(const r in n)if(n[r]!==void 0){const i=n[r];i&&typeof i.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class eDe{constructor(e,t,n,r,i,o,l,h,p,y){this.id=QNe++,this._nodes=e,this._geometries=t,this.renderer=n,this.object=r,this.material=i,this.scene=o,this.camera=l,this.lightsNode=h,this.context=p,this.geometry=r.geometry,this.version=i.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=y,this.clippingContextCacheKey=y!==null?y.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],r=new Set;for(const i of e){const o=i.node&&i.node.attribute?i.node.attribute:t.getAttribute(i.name);if(o===void 0)continue;n.push(o);const l=o.isInterleavedBufferAttribute?o.data:o;r.add(l)}return this.attributes=n,this.vertexBuffers=Array.from(r.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:r,drawRange:i}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),l=this.getIndex(),h=l!==null;let p=1;if(n.isInstancedBufferGeometry===!0?p=n.instanceCount:e.count!==void 0&&(p=Math.max(0,e.count)),p===0)return null;if(o.instanceCount=p,e.isBatchedMesh===!0)return o;let y=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(y=2);let x=i.start*y,S=(i.start+i.count)*y;r!==null&&(x=Math.max(x,r.start*y),S=Math.min(S,(r.start+r.count)*y));const A=n.attributes.position;let k=1/0;h?k=l.count:A!=null&&(k=A.count),x=Math.max(x,0),S=Math.min(S,k);const L=S-x;return L<0||L===1/0?null:(o.vertexCount=L,o.firstVertex=x,o)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const r=e.attributes[n];t+=n+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const n of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[n];t+="morph-"+n+",";for(let i=0,o=r.length;i<o;i++){const l=r[i];t+=l.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let n=t.customProgramCacheKey();for(const r of JNe(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const i=t[r];let o;if(i!==null){const l=typeof i;l==="number"?o=i!==0?"1":"0":l==="object"?(o="{",i.isTexture&&(o+=i.mapping),o+="}"):o=String(i)}else o=String(i);n+=o+","}return n+=this.clippingContextCacheKey+",",e.geometry&&(n+=this.getGeometryCacheKey()),e.skeleton&&(n+=e.skeleton.bones.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(n+=e._colorsTexture.uuid+",")),e.count>1&&(n+=e.uuid+","),n+=e.receiveShadow+",",qNe(n)}get needsGeometryUpdate(){return this.geometry.id!==this.object.geometry.id}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=fk(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=fk(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const q8=[];class tDe{constructor(e,t,n,r,i,o){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=r,this.bindings=i,this.info=o,this.chainMaps={}}get(e,t,n,r,i,o,l,h){const p=this.getChainMap(h);q8[0]=e,q8[1]=t,q8[2]=o,q8[3]=i;let y=p.get(q8);return y===void 0?(y=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,i,o,l,h),p.set(q8,y)):(y.updateClipping(l),y.needsGeometryUpdate&&y.setGeometry(e.geometry),(y.version!==t.version||y.needsUpdate)&&(y.initialCacheKey!==y.getCacheKey()?(y.dispose(),y=this.get(e,t,n,r,i,o,l,h)):y.version=t.version)),q8.length=0,y}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Tf)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,r,i,o,l,h,p,y,x){const S=this.getChainMap(x),A=new eDe(e,t,n,r,i,o,l,h,p,y);return A.onDispose=()=>{this.pipelines.delete(A),this.bindings.delete(A),this.nodes.delete(A),S.delete(A.getChainArray())},A}}class u4{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const zh={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},X3=16,nDe=211,rDe=212;class iDe extends u4{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(n.version===void 0)t===zh.VERTEX?this.backend.createAttribute(e):t===zh.INDEX?this.backend.createIndexAttribute(e):t===zh.STORAGE?this.backend.createStorageAttribute(e):t===zh.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(n.version<r.version||r.usage===x_)&&(this.backend.updateAttribute(e),n.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}const Eg=sDe();function sDe(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),r=new Uint32Array(512);for(let h=0;h<256;++h){const p=h-127;p<-27?(n[h]=0,n[h|256]=32768,r[h]=24,r[h|256]=24):p<-14?(n[h]=1024>>-p-14,n[h|256]=1024>>-p-14|32768,r[h]=-p-1,r[h|256]=-p-1):p<=15?(n[h]=p+15<<10,n[h|256]=p+15<<10|32768,r[h]=13,r[h|256]=13):p<128?(n[h]=31744,n[h|256]=64512,r[h]=24,r[h|256]=24):(n[h]=31744,n[h|256]=64512,r[h]=13,r[h|256]=13)}const i=new Uint32Array(2048),o=new Uint32Array(64),l=new Uint32Array(64);for(let h=1;h<1024;++h){let p=h<<13,y=0;for(;(p&8388608)===0;)p<<=1,y-=8388608;p&=-8388609,y+=947912704,i[h]=p|y}for(let h=1024;h<2048;++h)i[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)o[h]=h<<23;o[31]=1199570944,o[32]=2147483648;for(let h=33;h<63;++h)o[h]=2147483648+(h-32<<23);o[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(l[h]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:i,exponentTable:o,offsetTable:l}}function Ec(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=Ei(s,-65504,65504),Eg.floatView[0]=s;const e=Eg.uint32View[0],t=e>>23&511;return Eg.baseTable[t]+((e&8388607)>>Eg.shiftTable[t])}function FR(s){const e=s>>10;return Eg.uint32View[0]=Eg.mantissaTable[Eg.offsetTable[e]+(s&1023)]+Eg.exponentTable[e],Eg.floatView[0]}const ro=new vt,LR=new mi;let aDe=0;class Vh{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:aDe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=dk,this.updateRanges=[],this.gpuType=Rc,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)LR.fromBufferAttribute(this,t),LR.applyMatrix3(e),this.setXY(t,LR.x,LR.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)ro.fromBufferAttribute(this,t),ro.applyMatrix3(e),this.setXYZ(t,ro.x,ro.y,ro.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ro.fromBufferAttribute(this,t),ro.applyMatrix4(e),this.setXYZ(t,ro.x,ro.y,ro.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ro.fromBufferAttribute(this,t),ro.applyNormalMatrix(e),this.setXYZ(t,ro.x,ro.y,ro.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ro.fromBufferAttribute(this,t),ro.transformDirection(e),this.setXYZ(t,ro.x,ro.y,ro.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=zl(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=zl(t,this.array)),t}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=zl(t,this.array)),t}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=zl(t,this.array)),t}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=zl(t,this.array)),t}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array),i=si(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==dk&&(e.usage=this.usage),e}}class i4e extends Vh{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class s4e extends Vh{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class a4e extends Vh{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=FR(this.array[e*this.itemSize]);return this.normalized&&(t=zl(t,this.array)),t}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize]=Ec(t),this}getY(e){let t=FR(this.array[e*this.itemSize+1]);return this.normalized&&(t=zl(t,this.array)),t}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+1]=Ec(t),this}getZ(e){let t=FR(this.array[e*this.itemSize+2]);return this.normalized&&(t=zl(t,this.array)),t}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+2]=Ec(t),this}getW(e){let t=FR(this.array[e*this.itemSize+3]);return this.normalized&&(t=zl(t,this.array)),t}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+3]=Ec(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array)),this.array[e+0]=Ec(t),this.array[e+1]=Ec(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array)),this.array[e+0]=Ec(t),this.array[e+1]=Ec(n),this.array[e+2]=Ec(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array),i=si(i,this.array)),this.array[e+0]=Ec(t),this.array[e+1]=Ec(n),this.array[e+2]=Ec(r),this.array[e+3]=Ec(i),this}}class Hl extends Vh{constructor(e,t,n){super(new Float32Array(e),t,n)}}function o4e(s){return s.index!==null?s.index.version:s.attributes.position.version}function Gme(s){const e=[],t=s.index,n=s.attributes.position;if(t!==null){const i=t.array;for(let o=0,l=i.length;o<l;o+=3){const h=i[o+0],p=i[o+1],y=i[o+2];e.push(h,p,p,y,y,h)}}else{const i=n.array;for(let o=0,l=i.length/3-1;o<l;o+=3){const h=o+0,p=o+1,y=o+2;e.push(h,p,p,y,y,h)}}const r=new(J3e(e)?s4e:i4e)(e,1);return r.version=o4e(s),r}class oDe extends u4{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,n=this.get(t);n.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const i=t.index,o=e.getAttributes();i!==null&&this.attributes.delete(i);for(const h of o)this.attributes.delete(h);const l=this.wireframes.get(t);l!==void 0&&this.attributes.delete(l),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const i of t)i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute?this.updateAttribute(i,zh.STORAGE):this.updateAttribute(i,zh.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,zh.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,zh.INDIRECT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:n}=e;let r=t.index;if(n.wireframe===!0){const i=this.wireframes;let o=i.get(t);o===void 0?(o=Gme(t),i.set(t,o)):o.version!==o4e(t)&&(this.attributes.delete(o),o=Gme(t),i.set(t,o)),r=o}return r}}class lDe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class l4e{constructor(e){this.cacheKey=e,this.usedTimes=0}}class uDe extends l4e{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class cDe extends l4e{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let hDe=0;class pV{constructor(e,t,n,r=null,i=null){this.id=hDe++,this.code=e,this.stage=t,this.name=n,this.transforms=r,this.attributes=i,this.usedTimes=0}}class dDe extends u4{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let l=this.programs.compute.get(o.computeShader);l===void 0&&(i&&i.computeProgram.usedTimes===0&&this._releaseProgram(i.computeProgram),l=new pV(o.computeShader,"compute",e.name,o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,l),n.createProgram(l));const h=this._getComputeCacheKey(e,l);let p=this.caches.get(h);p===void 0&&(i&&i.usedTimes===0&&this._releasePipeline(i),p=this._getComputePipeline(e,l,h,t)),p.usedTimes++,l.usedTimes++,r.version=e.version,r.pipeline=p}return r.pipeline}getForRender(e,t=null){const{backend:n}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState(),l=e.material?e.material.name:"";let h=this.programs.vertex.get(o.vertexShader);h===void 0&&(i&&i.vertexProgram.usedTimes===0&&this._releaseProgram(i.vertexProgram),h=new pV(o.vertexShader,"vertex",l),this.programs.vertex.set(o.vertexShader,h),n.createProgram(h));let p=this.programs.fragment.get(o.fragmentShader);p===void 0&&(i&&i.fragmentProgram.usedTimes===0&&this._releaseProgram(i.fragmentProgram),p=new pV(o.fragmentShader,"fragment",l),this.programs.fragment.set(o.fragmentShader,p),n.createProgram(p));const y=this._getRenderCacheKey(e,h,p);let x=this.caches.get(y);x===void 0?(i&&i.usedTimes===0&&this._releasePipeline(i),x=this._getRenderPipeline(e,h,p,y,t)):e.pipeline=x,x.usedTimes++,h.usedTimes++,p.usedTimes++,r.pipeline=x}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,r){n=n||this._getComputeCacheKey(e,t);let i=this.caches.get(n);return i===void 0&&(i=new cDe(n,t),this.caches.set(n,i),this.backend.createComputePipeline(i,r)),i}_getRenderPipeline(e,t,n,r,i){r=r||this._getRenderCacheKey(e,t,n);let o=this.caches.get(r);return o===void 0&&(o=new uDe(r,t,n),this.caches.set(r,o),e.pipeline=o,this.backend.createRenderPipeline(e,i)),o}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class fDe extends u4{constructor(e,t,n,r,i,o){super(),this.backend=e,this.textures=n,this.pipelines=i,this.attributes=r,this.nodes=t,this.info=o,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const n=t.attribute,r=n.isIndirectStorageBufferAttribute?zh.INDIRECT:zh.STORAGE;this.attributes.update(n,r)}}_update(e,t){const{backend:n}=this;let r=!1,i=!0,o=0,l=0;for(const h of e.bindings)if(!(h.isNodeUniformsGroup&&this.nodes.updateGroup(h)===!1)){if(h.isStorageBuffer){const p=h.attribute,y=p.isIndirectStorageBufferAttribute?zh.INDIRECT:zh.STORAGE;this.attributes.update(p,y)}if(h.isUniformBuffer)h.update()&&n.updateBinding(h);else if(h.isSampler)h.update();else if(h.isSampledTexture){const p=this.textures.get(h.texture);h.needsBindingsUpdate(p.generation)&&(r=!0);const y=h.update(),x=h.texture;y&&this.textures.updateTexture(x);const S=n.get(x);if(S.externalTexture!==void 0||p.isDefaultTexture?i=!1:(o=o*10+x.id,l+=x.version),n.isWebGPUBackend===!0&&S.texture===void 0&&S.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",h,y,x,h.textureNode.value,r),this.textures.updateTexture(x),r=!0),x.isStorageTexture===!0){const A=this.get(x);h.store===!0?A.needsMipmap=!0:this.textures.needsMipmaps(x)&&A.needsMipmap===!0&&(this.backend.generateMipmaps(x),A.needsMipmap=!1)}}}r===!0&&this.backend.updateBindings(e,t,i?o:0,l)}}function pDe(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?s.z-e.z:s.id-e.id}function Hme(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function jme(s){return(s.transmission>0||s.transmissionNode)&&s.side===P_&&s.forceSinglePass===!1}class mDe{constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,r,i,o,l){let h=this.renderItems[this.renderItemsIndex];return h===void 0?(h={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:i,group:o,clippingContext:l},this.renderItems[this.renderItemsIndex]=h):(h.id=e.id,h.object=e,h.geometry=t,h.material=n,h.groupOrder=r,h.renderOrder=e.renderOrder,h.z=i,h.group=o,h.clippingContext=l),this.renderItemsIndex++,h}push(e,t,n,r,i,o,l){const h=this.getNextRenderItem(e,t,n,r,i,o,l);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0?(jme(n)&&this.transparentDoublePass.push(h),this.transparent.push(h)):this.opaque.push(h)}unshift(e,t,n,r,i,o,l){const h=this.getNextRenderItem(e,t,n,r,i,o,l);n.transparent===!0||n.transmission>0?(jme(n)&&this.transparentDoublePass.unshift(h),this.transparent.unshift(h)):this.opaque.unshift(h)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||pDe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||Hme),this.transparent.length>1&&this.transparent.sort(t||Hme)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}const bw=[];class gDe{constructor(e){this.lighting=e,this.lists=new Tf}get(e,t){const n=this.lists;bw[0]=e,bw[1]=t;let r=n.get(bw);return r===void 0&&(r=new mDe(this.lighting,e,t),n.set(bw,r)),bw.length=0,r}dispose(){this.lists=new Tf}}let vDe=0;class yDe{constructor(){this.id=vDe++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new ki,this.scissor=!1,this.scissorValue=new ki,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return u4e(this)}}function u4e(s){const{textures:e,activeCubeFace:t}=s,n=[t];for(const r of e)n.push(r.id);return _W(n)}let kv=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,o=r.length;i<o;i++)r[i].call(this,e);e.target=null}}};const Wme=new As,$me=new hx;class jh{constructor(e=0,t=0,n=0,r=jh.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],o=r[4],l=r[8],h=r[1],p=r[5],y=r[9],x=r[2],S=r[6],A=r[10];switch(t){case"XYZ":this._y=Math.asin(Ei(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-y,A),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(S,p),this._z=0);break;case"YXZ":this._x=Math.asin(-Ei(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(l,A),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-x,i),this._z=0);break;case"ZXY":this._x=Math.asin(Ei(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,A),this._z=Math.atan2(-o,p)):(this._y=0,this._z=Math.atan2(h,i));break;case"ZYX":this._y=Math.asin(-Ei(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,A),this._z=Math.atan2(h,i)):(this._x=0,this._z=Math.atan2(-o,p));break;case"YZX":this._z=Math.asin(Ei(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-y,p),this._y=Math.atan2(-x,i)):(this._x=0,this._y=Math.atan2(l,A));break;case"XZY":this._z=Math.asin(-Ei(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(S,p),this._y=Math.atan2(l,i)):(this._x=Math.atan2(-y,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Wme.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Wme,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return $me.setFromEuler(this),this.setFromQuaternion($me,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}jh.DEFAULT_ORDER="XYZ";class _De{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let xDe=0;const qme=new vt,V7=new hx,mg=new As,UR=new vt,Sw=new vt,bDe=new vt,SDe=new hx,Xme=new vt(1,0,0),Yme=new vt(0,1,0),Kme=new vt(0,0,1),Zme={type:"added"},wDe={type:"removed"},G7={type:"childadded",child:null},mV={type:"childremoved",child:null};class wo extends kv{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:xDe++}),this.uuid=Ag(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=wo.DEFAULT_UP.clone();const e=new vt,t=new jh,n=new hx,r=new vt(1,1,1);function i(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(i),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new As},normalMatrix:{value:new Ou}}),this.matrix=new As,this.matrixWorld=new As,this.matrixAutoUpdate=wo.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=wo.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new _De,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return V7.setFromAxisAngle(e,t),this.quaternion.multiply(V7),this}rotateOnWorldAxis(e,t){return V7.setFromAxisAngle(e,t),this.quaternion.premultiply(V7),this}rotateX(e){return this.rotateOnAxis(Xme,e)}rotateY(e){return this.rotateOnAxis(Yme,e)}rotateZ(e){return this.rotateOnAxis(Kme,e)}translateOnAxis(e,t){return qme.copy(e).applyQuaternion(this.quaternion),this.position.add(qme.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Xme,e)}translateY(e){return this.translateOnAxis(Yme,e)}translateZ(e){return this.translateOnAxis(Kme,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(mg.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?UR.copy(e):UR.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Sw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mg.lookAt(Sw,UR,this.up):mg.lookAt(UR,Sw,this.up),this.quaternion.setFromRotationMatrix(mg),r&&(mg.extractRotation(r.matrixWorld),V7.setFromRotationMatrix(mg),this.quaternion.premultiply(V7.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Zme),G7.child=e,this.dispatchEvent(G7),G7.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(wDe),mV.child=e,this.dispatchEvent(mV),mV.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),mg.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),mg.multiply(e.parent.matrixWorld)),e.applyMatrix4(mg),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Zme),G7.child=e,this.dispatchEvent(G7),G7.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sw,e,bDe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sw,SDe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(l=>({...l,boundingBox:l.boundingBox?l.boundingBox.toJSON():void 0,boundingSphere:l.boundingSphere?l.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(l=>({...l})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function i(l,h){return l[h.uuid]===void 0&&(l[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const h=l.shapes;if(Array.isArray(h))for(let p=0,y=h.length;p<y;p++){const x=h[p];i(e.shapes,x)}else i(e.shapes,h)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let h=0,p=this.material.length;h<p;h++)l.push(i(e.materials,this.material[h]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++){const h=this.animations[l];r.animations.push(i(e.animations,h))}}if(t){const l=o(e.geometries),h=o(e.materials),p=o(e.textures),y=o(e.images),x=o(e.shapes),S=o(e.skeletons),A=o(e.animations),k=o(e.nodes);l.length>0&&(n.geometries=l),h.length>0&&(n.materials=h),p.length>0&&(n.textures=p),y.length>0&&(n.images=y),x.length>0&&(n.shapes=x),S.length>0&&(n.skeletons=S),A.length>0&&(n.animations=A),k.length>0&&(n.nodes=k)}return n.object=r,n;function o(l){const h=[];for(const p in l){const y=l[p];delete y.metadata,h.push(y)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}wo.DEFAULT_UP=new vt(0,1,0);wo.DEFAULT_MATRIX_AUTO_UPDATE=!0;wo.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;class xW extends wo{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new jh,this.environmentIntensity=1,this.environmentRotation=new jh,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class bW extends wo{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new As,this.projectionMatrix=new As,this.projectionMatrixInverse=new As,this.coordinateSystem=Ru}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const ww=[],EDe=new xW,TDe=new bW;class MDe{constructor(){this.chainMaps={}}get(e,t,n=null){ww[0]=e,ww[1]=t;let r;if(n===null)r="default";else{const l=n.texture.format;r=`${n.textures.length}:${l}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const i=this._getChainMap(r);let o=i.get(ww);return o===void 0&&(o=new yDe,i.set(ww,o)),ww.length=0,n!==null&&(o.sampleCount=n.samples===0?1:n.samples),o}getForClear(e=null){return this.get(EDe,TDe,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Tf)}dispose(){this.chainMaps={}}}let H7;class CDe{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{H7===void 0&&(H7=ij("canvas")),H7.width=e.width,H7.height=e.height;const r=H7.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=H7}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=ij("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let o=0;o<i.length;o++)i[o]=Ng(i[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Ng(t[n]/255)*255):t[n]=Ng(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ADe=0;class SW{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ADe++}),this.uuid=Ag(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let o=0,l=r.length;o<l;o++)r[o].isDataTexture?i.push(gV(r[o].image)):i.push(gV(r[o]))}else i=gV(r);n.url=i}return t||(e.images[this.uuid]=n),n}}function gV(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?CDe.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let PDe=0;const vV=new vt;class Q0 extends kv{constructor(e=Q0.DEFAULT_IMAGE,t=Q0.DEFAULT_MAPPING,n=Z3,r=Z3,i=Dc,o=Ig,l=Bh,h=Vl,p=Q0.DEFAULT_ANISOTROPY,y=Lg){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:PDe++}),this.uuid=Ag(),this.name="",this.source=new SW(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=p,this.format=l,this.internalFormat=null,this.type=h,this.offset=new mi(0,0),this.repeat=new mi(1,1),this.center=new mi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ou,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(vV).x}get height(){return this.source.getSize(vV).y}get depth(){return this.source.getSize(vV).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==cW)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Z_:e.x=e.x-Math.floor(e.x);break;case Z3:e.x=e.x<0?0:1;break;case Q_:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Z_:e.y=e.y-Math.floor(e.y);break;case Z3:e.y=e.y<0?0:1;break;case Q_:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Q0.DEFAULT_IMAGE=null;Q0.DEFAULT_MAPPING=cW;Q0.DEFAULT_ANISOTROPY=1;class u1 extends Q0{constructor(e,t,n=$a,r,i,o,l=So,h=So,p,y=l1,x=1){if(y!==l1&&y!==kg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const S={width:e,height:t,depth:x};super(S,r,i,o,l,h,y,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new SW(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const RDe=new vt;class IDe extends u4{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),r=e.samples===0?1:e.samples,i=n.depthTextureMips||(n.depthTextureMips={}),o=e.textures,l=this.getSize(o[0]),h=l.width>>t,p=l.height>>t;let y=e.depthTexture||i[t];const x=e.depthBuffer===!0||e.stencilBuffer===!0;let S=!1;y===void 0&&x&&(y=new u1,y.format=e.stencilBuffer?kg:l1,y.type=e.stencilBuffer?J3:$a,y.image.width=h,y.image.height=p,y.image.depth=l.depth,y.isArrayTexture=e.multiview===!0&&l.depth>1,i[t]=y),(n.width!==l.width||l.height!==n.height)&&(S=!0,y&&(y.needsUpdate=!0,y.image.width=h,y.image.height=p,y.image.depth=y.isArrayTexture?y.image.depth:1)),n.width=l.width,n.height=l.height,n.textures=o,n.depthTexture=y||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==r&&(S=!0,y&&(y.needsUpdate=!0),n.sampleCount=r);const A={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let k=0;k<o.length;k++){const L=o[k];S&&(L.needsUpdate=!0),this.updateTexture(L,A)}y&&this.updateTexture(y,A)}if(n.initialized!==!0){n.initialized=!0;const k=()=>{e.removeEventListener("dispose",k);for(let L=0;L<o.length;L++)this._destroyTexture(o[L]);y&&this._destroyTexture(y),this.delete(e)};e.addEventListener("dispose",k)}}updateTexture(e,t={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,i=this.backend;if(r&&n.initialized===!0&&(i.destroySampler(e),i.destroyTexture(e)),e.isFramebufferTexture){const p=this.renderer.getRenderTarget();p?e.type=p.texture.type:e.type=Vl}const{width:o,height:l,depth:h}=this.getSize(e);if(t.width=o,t.height=l,t.depth=h,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,o,l):1,r||e.isStorageTexture===!0)i.createSampler(e),i.createTexture(e,t),n.generation=e.version;else if(n.initialized!==!0&&i.createSampler(e),e.version>0){const y=e.image;if(y===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(y.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const x=[];for(const S of e.images)x.push(S);t.images=x}else t.image=y;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(i.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&i.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&i.generateMipmaps(e)}}else i.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;if(n.initialized!==!0){n.initialized=!0,n.generation=e.version,this.info.memory.textures++;const p=()=>{e.removeEventListener("dispose",p),this._destroyTexture(e)};e.addEventListener("dispose",p)}n.version=e.version}getSize(e,t=RDe){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let r;return e.isCompressedTexture?e.mipmaps?r=e.mipmaps.length:r=1:r=Math.floor(Math.log2(Math.max(t,n)))+1,r}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class wW extends Ki{constructor(e,t,n,r=1){super(e,t,n),this.a=r}set(e,t,n,r=1){return this.a=r,super.set(e,t,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}const BR={VERTEX:"vertex"},_i={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Mg={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},kDe=["fragment","vertex"],Qme=["setup","analyze","generate"],Jme=[...kDe,"compute"],dx=["x","y","z","w"],NDe={analyze:"setup",generate:"analyze"};let DDe=0,ti=class extends kv{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=_i.NONE,this.updateBeforeType=_i.NONE,this.updateAfterType=_i.NONE,this.uuid=oNe.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:DDe++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,_i.FRAME)}onRenderUpdate(e){return this.onUpdate(e,_i.RENDER)}onObjectUpdate(e){return this.onUpdate(e,_i.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of pk(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=fk(t4e(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())t["node"+n++]=r;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(this.parents===!0){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(n===1){const r=e.getNodeProperties(this);for(const i of Object.values(r))i&&i.isNode===!0&&i.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&n.isNode===!0)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);const r=e.getDataFromNode(this);r.buildStages=r.buildStages||{},r.buildStages[e.buildStage]=!0;const i=NDe[e.buildStage];if(i&&r.buildStages[i]!==!0){const h=e.getBuildStage();e.setBuildStage(i),this.build(e),e.setBuildStage(h)}e.addNode(this),e.addChain(this);let o=null;const l=e.getBuildStage();if(l==="setup"){this.updateReference(e);const h=e.getNodeProperties(this);if(h.initialized!==!0){h.initialized=!0,h.outputNode=this.setup(e)||h.outputNode||null;for(const p of Object.values(h))if(p&&p.isNode===!0){if(p.parents===!0){const y=e.getNodeProperties(p);y.parents=y.parents||[],y.parents.push(this)}p.build(e)}}o=h.outputNode}else if(l==="analyze")this.analyze(e,t);else if(l==="generate")if(this.generate.length===1){const p=this.getNodeType(e),y=e.getDataFromNode(this);o=y.snippet,o===void 0?y.generated===void 0?(y.generated=!0,o=this.generate(e)||"",y.snippet=o):(console.warn("THREE.Node: Recursion detected.",this),o=""):y.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),o=e.format(o,p,t)}else o=this.generate(e,t)||"";return e.removeChain(this),e.addSequentialNode(this),o}getSerializeChildren(){return pk(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:i,childNode:o}of t)i!==void 0?(n[r]===void 0&&(n[r]=Number.isInteger(i)?[]:{}),n[r][i]=o.toJSON(e.meta).uuid):n[r]=o.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const i of e.inputNodes[n])r.push(t[i]);this[n]=r}else if(typeof e.inputNodes[n]=="object"){const r={};for(const i in e.inputNodes[n]){const o=e.inputNodes[n][i];r[i]=t[o]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let i=e.nodes[t];i===void 0&&(i={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta);function o(l){const h=[];for(const p in l){const y=l[p];delete y.metadata,h.push(y)}return h}if(r){const l=o(e.textures),h=o(e.images),p=o(e.nodes);l.length>0&&(i.textures=l),h.length>0&&(i.images=h),p.length>0&&(i.nodes=p)}return i}};class co extends ti{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),i=e.getDataFromNode(this);if(i.propertyName!==void 0)return e.format(i.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const o=super.build(e,r),l=e.getVarFromNode(this,null,r),h=e.getPropertyName(l);return e.addLineFlowCode(`${h} = ${o}`,this),i.snippet=o,i.propertyName=h,e.format(i.propertyName,r,t)}}return super.build(e,t)}}class WE extends ti{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e),n=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${n}[ ${r} ]`}}class c4e extends ti{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))(n===null||e.getTypeLength(t)===e.getTypeLength(r))&&(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),i=n.build(e,r);return e.format(i,r,t)}}class ODe extends co{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),r=e.getTypeLength(n),i=this.nodes,o=e.getComponentType(n),l=[];let h=0;for(const y of i){if(h>=r){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${n}()' type.`);break}let x=y.getNodeType(e),S=e.getTypeLength(x),A;h+S>r&&(console.error(`THREE.TSL: Length of '${n}()' data exceeds maximum length of output type.`),S=r-h,x=e.getTypeFromLength(S)),h+=S,A=y.build(e,x);const k=e.getComponentType(x);k!==o&&(A=e.format(A,k,o)),l.push(A)}const p=`${e.getType(n)}( ${l.join(", ")} )`;return e.format(p,n,t)}}const FDe=dx.join("");class ege extends ti{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(dx.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let i=null;if(r>1){let o=null;this.getVectorLength()>=r&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const h=n.build(e,o);this.components.length===r&&this.components===FDe.slice(0,this.components.length)?i=e.format(h,o,t):i=e.format(`${h}.${this.components}`,this.getNodeType(e),t)}else i=n.build(e,t);return i}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class LDe extends co{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,i=this.getNodeType(e),o=e.getComponentType(r.getNodeType(e)),l=e.getTypeFromLength(n.length,o),h=r.build(e,l),p=t.build(e,i),y=e.getTypeLength(i),x=[];for(let S=0;S<y;S++){const A=dx[S];A===n[0]?(x.push(h),S+=n.length-1):x.push(p+"."+A)}return`${e.getType(i)}( ${x.join(", ")} )`}}class UDe extends co{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),i=n.build(e),o=e.getVarFromNode(this),l=e.getPropertyName(o);e.addLineFlowCode(l+" = "+i,this);const h=e.getTypeLength(r),p=[];let y=0;for(let x=0;x<h;x++){const S=dx[x];S===t[y]?(p.push("1.0 - "+(l+"."+S)),y++):p.push(l+"."+S)}return`${e.getType(r)}( ${p.join(", ")} )`}}class EW extends ti{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?mk(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=mk(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=KNe(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?n4e(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const tge=/float|u?int/;class Vg extends EW{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return tge.test(n)&&tge.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class BDe extends ti{static get type(){return"MemberNode"}constructor(e,t){super(),this.node=e,this.property=t,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let J_=null;const b_=new Map;function jt(s,e){if(b_.has(s)){console.warn(`THREE.TSL: Redefinition of method chaining '${s}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${s} is not a function`);b_.set(s,e)}const h4e=s=>s.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),nge=s=>h4e(s).split("").sort().join(""),d4e={setup(s,e){const t=e.shift();return s(Lk(t),...e)},get(s,e,t){if(typeof e=="string"&&s[e]===void 0){if(s.isStackNode!==!0&&e==="assign")return(...n)=>(J_.assign(t,...n),t);if(b_.has(e)){const n=b_.get(e);return s.isStackNode?(...r)=>t.add(n(...r)):(...r)=>n(t,...r)}else{if(e==="self")return s;if(e.endsWith("Assign")&&b_.has(e.slice(0,e.length-6))){const n=b_.get(e.slice(0,e.length-6));return s.isStackNode?(...r)=>t.assign(r[0],n(...r)):(...r)=>t.assign(n(t,...r))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=h4e(e),hn(new ege(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=nge(e.slice(3).toLowerCase()),n=>hn(new LDe(s,e,hn(n)));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=nge(e.slice(4).toLowerCase()),()=>hn(new UDe(hn(s),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),hn(new ege(s,e));if(/^\d+$/.test(e)===!0)return hn(new WE(t,new Vg(Number(e),"uint")));if(/^get$/.test(e)===!0)return n=>hn(new BDe(t,n))}}}return Reflect.get(s,e,t)},set(s,e,t,n){return typeof e=="string"&&s[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(n[e].assign(t),!0):Reflect.set(s,e,t,n)}},yV=new WeakMap,rge=new WeakMap,zDe=function(s,e=null){const t=mk(s);if(t==="node"){let n=yV.get(s);return n===void 0&&(n=new Proxy(s,d4e),yV.set(s,n),yV.set(n,n)),n}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return hn(sj(s,e));if(t==="shader")return un(s)}return s},VDe=function(s,e=null){for(const t in s)s[t]=hn(s[t],e);return s},GDe=function(s,e=null){const t=s.length;for(let n=0;n<t;n++)s[n]=hn(s[n],e);return s},HDe=function(s,e=null,t=null,n=null){const r=y=>hn(n!==null?Object.assign(y,n):y);let i,o=e,l,h;function p(y){let x;return o?x=/[a-z]/i.test(o)?o+"()":o:x=s.type,l!==void 0&&y.length<l?(console.error(`THREE.TSL: "${x}" parameter length is less than minimum required.`),y.concat(new Array(l-y.length).fill(0))):h!==void 0&&y.length>h?(console.error(`THREE.TSL: "${x}" parameter length exceeds limit.`),y.slice(0,h)):y}return e===null?i=(...y)=>r(new s(...N_(p(y)))):t!==null?(t=hn(t),i=(...y)=>r(new s(e,...N_(p(y)),t))):i=(...y)=>r(new s(e,...N_(p(y)))),i.setParameterLength=(...y)=>(y.length===1?l=h=y[0]:y.length===2&&([l,h]=y),i),i.setName=y=>(o=y,i),i},jDe=function(s,...e){return hn(new s(...N_(e)))};class WDe extends ti{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,inputNodes:n}=this,r=e.getNodeProperties(t),i=t.namespace&&t.namespace===e.namespace?e.getNamespace("once"):"once";if(r[i])return r[i];let o=null;if(t.layout){let l=rge.get(e.constructor);l===void 0&&(l=new WeakMap,rge.set(e.constructor,l));let h=l.get(t);h===void 0&&(h=hn(e.buildFunctionNode(t)),l.set(t,h)),e.addInclude(h),o=hn(h.call(n))}else{const l=t.jsFunc,h=n!==null||l.length>1?l(n||[],e):l(e);o=hn(h)}return t.once&&(r[i]=o),o}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getOutputNamespace();return t[n]=t[n]||this.setupOutput(e),t[n]}build(e,t=null){let n=null;const r=e.getBuildStage(),i=e.getNodeProperties(this),o=e.getOutputNamespace(),l=this.getOutputNode(e);if(r==="setup"){const h=e.getNamespace("initialized");i[h]!==!0&&(i[h]=!0,i[o]=this.getOutputNode(e),i[o].build(e)),n=i[o]}else r==="analyze"?l.build(e,t):r==="generate"&&(n=l.build(e,t)||"");return n}}class $De extends ti{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1,this.namespace=null}setLayout(e){return this.layout=e,this}call(e=null){return Lk(e),hn(new WDe(this,e))}setup(){return this.call()}}const qDe=[!1,!0],XDe=[0,1,2,3],YDe=[-1,-2],f4e=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],TW=new Map;for(const s of qDe)TW.set(s,new Vg(s));const MW=new Map;for(const s of XDe)MW.set(s,new Vg(s,"uint"));const CW=new Map([...MW].map(s=>new Vg(s.value,"int")));for(const s of YDe)CW.set(s,new Vg(s,"int"));const Ok=new Map([...CW].map(s=>new Vg(s.value)));for(const s of f4e)Ok.set(s,new Vg(s));for(const s of f4e)Ok.set(-s,new Vg(-s));const Fk={bool:TW,uint:MW,ints:CW,float:Ok},ige=new Map([...TW,...Ok]),sj=(s,e)=>ige.has(s)?ige.get(s):s.isNode===!0?s:new Vg(s,e),KDe=s=>{try{return s.getNodeType()}catch{return}},ho=function(s,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(s)&&t.every(r=>typeof r!="object"))&&(t=[n4e(s,...t)]),t.length===1&&e!==null&&e.has(t[0]))return hn(e.get(t[0]));if(t.length===1){const r=sj(t[0],s);return KDe(r)===s?hn(r):hn(new c4e(r,s))}const n=t.map(r=>sj(r));return hn(new ODe(n,s))}},sge=s=>typeof s=="object"&&s!==null?s.value:s,ZDe=s=>s!=null?s.nodeType||s.convertTo||(typeof s=="string"?s:null):null;function eE(s,e){return new Proxy(new $De(s,e),d4e)}const hn=(s,e=null)=>zDe(s,e),Lk=(s,e=null)=>new VDe(s,e),N_=(s,e=null)=>new GDe(s,e),cn=(...s)=>new HDe(...s),Rn=(...s)=>new jDe(...s);let QDe=0;const un=(s,e=null)=>{let t=null;e!==null&&(typeof e=="object"?t=e.return:(typeof e=="string"?t=e:console.error("THREE.TSL: Invalid layout type."),e=null));const n=new eE(s,t),r=(...i)=>{let o;Lk(i),i[0]&&(i[0].isNode||Object.getPrototypeOf(i[0])!==Object.prototype)?o=[...i]:o=i[0];const h=n.call(o);return t==="void"&&h.toStack(),h};if(r.shaderNode=n,r.id=n.id,r.getNodeType=(...i)=>n.getNodeType(...i),r.getCacheKey=(...i)=>n.getCacheKey(...i),r.setLayout=i=>(n.setLayout(i),r),r.once=(i=null)=>(n.once=!0,n.namespace=i,r),e!==null){if(typeof e.inputs!="object"){const i={name:"fn"+QDe++,type:t,inputs:[]};for(const o in e)o!=="return"&&i.inputs.push({name:o,type:e[o]});e=i}r.setLayout(e)}return r},gk=s=>{J_=s},p4e=()=>J_,Xa=(...s)=>J_.If(...s);function m4e(s){return J_&&J_.add(s),s}jt("toStack",m4e);const JDe=new ho("color"),$t=new ho("float",Fk.float),Bs=new ho("int",Fk.ints),eOe=new ho("uint",Fk.uint),AW=new ho("bool",Fk.bool),In=new ho("vec2"),Sg=new ho("ivec2"),tOe=new ho("uvec2"),nOe=new ho("bvec2"),Yt=new ho("vec3"),rOe=new ho("ivec3"),iOe=new ho("uvec3"),sOe=new ho("bvec3"),Jr=new ho("vec4"),aOe=new ho("ivec4"),oOe=new ho("uvec4"),lOe=new ho("bvec4"),PW=new ho("mat2"),jl=new ho("mat3"),D_=new ho("mat4");jt("toColor",JDe);jt("toFloat",$t);jt("toInt",Bs);jt("toUint",eOe);jt("toBool",AW);jt("toVec2",In);jt("toIVec2",Sg);jt("toUVec2",tOe);jt("toBVec2",nOe);jt("toVec3",Yt);jt("toIVec3",rOe);jt("toUVec3",iOe);jt("toBVec3",sOe);jt("toVec4",Jr);jt("toIVec4",aOe);jt("toUVec4",oOe);jt("toBVec4",lOe);jt("toMat2",PW);jt("toMat3",jl);jt("toMat4",D_);const uOe=cn(WE).setParameterLength(2),cOe=(s,e)=>hn(new c4e(hn(s),e));jt("element",uOe);jt("convert",cOe);jt("append",s=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),m4e(s)));class hOe extends co{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return dx.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,r=e.getNodeProperties(this);r.sourceNode=n,r.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:r}=e.getNodeProperties(this),i=this.needsSplitAssign(e),o=n.getNodeType(e),l=n.build(e),h=r.build(e,o),p=r.getNodeType(e),y=e.getDataFromNode(this);let x;if(y.initialized===!0)t!=="void"&&(x=l);else if(i){const S=e.getVarFromNode(this,null,o),A=e.getPropertyName(S);e.addLineFlowCode(`${A} = ${h}`,this);const k=n.node,U=k.node.context({assign:!0}).build(e);for(let P=0;P<k.components.length;P++){const $=k.components[P];e.addLineFlowCode(`${U}.${$} = ${A}[ ${P} ]`,this)}t!=="void"&&(x=l)}else x=`${l} = ${h}`,(t==="void"||p==="void")&&(e.addLineFlowCode(x,this),t!=="void"&&(x=l));return y.initialized=!0,e.format(x,o,t)}}const dOe=cn(hOe).setParameterLength(2);jt("assign",dOe);class age extends co{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const fOe=(...s)=>{let e;if(s.length===1){const t=s[0];e=new age(null,t.length,t)}else{const t=s[0],n=s[1];e=new age(t,n)}return hn(e)};jt("toArray",(s,e)=>fOe(Array(e).fill(s)));class g4e extends ti{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const pOe=s=>new g4e(s),RW=(s,e=0)=>new g4e(s,!0,e),mOe=RW("frame"),zr=RW("render"),v4e=pOe("object");class $E extends EW{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=v4e}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const n=this.getSelf();return e=e.bind(n),super.onUpdate(r=>{const i=e(r,n);i!==void 0&&(this.value=i)},t)}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let i=e.getNodeFromHash(r);i===void 0&&(e.setHashNode(this,r),i=this);const o=i.getInputType(e),l=e.getUniformFromNode(i,o,e.shaderStage,this.name||e.context.label),h=e.getPropertyName(l);return e.context.label!==void 0&&delete e.context.label,e.format(h,n,t)}}const Vr=(s,e)=>{const t=ZDe(e||s),n=s&&s.isNode===!0?s.node&&s.node.value||s.value:s;return hn(new $E(n,t))};class cs extends ti{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const y4e=(s,e)=>hn(new cs(s,e)),vk=(s,e)=>hn(new cs(s,e,!0)),Yi=Rn(cs,"vec4","DiffuseColor"),oge=Rn(cs,"vec3","EmissiveColor"),Tg=Rn(cs,"float","Roughness"),yk=Rn(cs,"float","Metalness"),aj=Rn(cs,"float","Clearcoat"),_k=Rn(cs,"float","ClearcoatRoughness"),S_=Rn(cs,"vec3","Sheen"),IW=Rn(cs,"float","SheenRoughness"),kW=Rn(cs,"float","Iridescence"),_4e=Rn(cs,"float","IridescenceIOR"),x4e=Rn(cs,"float","IridescenceThickness"),oj=Rn(cs,"float","AlphaT"),uv=Rn(cs,"float","Anisotropy"),UI=Rn(cs,"vec3","AnisotropyT"),O_=Rn(cs,"vec3","AnisotropyB"),Cc=Rn(cs,"color","SpecularColor"),xk=Rn(cs,"float","SpecularF90"),lj=Rn(cs,"float","Shininess"),mE=Rn(cs,"vec4","Output"),_V=Rn(cs,"float","dashSize"),lge=Rn(cs,"float","gapSize"),BI=Rn(cs,"float","IOR"),uj=Rn(cs,"float","Transmission"),b4e=Rn(cs,"float","Thickness"),S4e=Rn(cs,"float","AttenuationDistance"),w4e=Rn(cs,"color","AttenuationColor"),E4e=Rn(cs,"float","Dispersion");class gOe extends co{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),i=this.parameters,o=(h,p)=>{const y=p.type,x=y==="pointer";let S;return x?S="&"+h.build(e):S=h.build(e,y),S};if(Array.isArray(i)){if(i.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),i.length=r.length;else if(i.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");i.length<r.length;)i.push($t(0));for(let h=0;h<i.length;h++)t.push(o(i[h],r[h]))}else for(const h of r){const p=i[h.name];p!==void 0?t.push(o(p,h)):(console.error(`THREE.TSL: Input '${h.name}' not found in 'Fn()'.`),t.push(o($t(0),h)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}const vOe=(s,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?N_(e):Lk(e[0]),hn(new gOe(hn(s),e)));jt("call",vOe);const yOe={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class oa extends co{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let i=new oa(e,t,n);for(let o=0;o<r.length-1;o++)i=new oa(e,i,r[o]);t=i,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(yOe[this.op],t)}getNodeType(e){const t=this.op,n=this.aNode,r=this.bNode,i=n.getNodeType(e),o=r?r.getNodeType(e):null;if(i==="void"||o==="void")return"void";if(t==="%")return i;if(t==="~"||t==="&"||t==="|"||t==="^"||t===">>"||t==="<<")return e.getIntegerType(i);if(t==="!"||t==="&&"||t==="||"||t==="^^")return"bool";if(t==="=="||t==="!="||t==="<"||t===">"||t==="<="||t===">="){const l=Math.max(e.getTypeLength(i),e.getTypeLength(o));return l>1?`bvec${l}`:"bool"}else{if(e.isMatrix(i)){if(o==="float")return i;if(e.isVector(o))return e.getVectorFromMatrix(i);if(e.isMatrix(o))return i}else if(e.isMatrix(o)){if(i==="float")return o;if(e.isVector(i))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(i)?o:i}}generate(e,t){const n=this.op,{aNode:r,bNode:i}=this,o=this.getNodeType(e);let l=null,h=null;o!=="void"?(l=r.getNodeType(e),h=i?i.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="||n==="!="?e.isVector(l)?h=l:e.isVector(h)?l=h:l!==h&&(l=h="float"):n===">>"||n==="<<"?(l=o,h=e.changeComponentType(h,"uint")):n==="%"?(l=o,h=e.isInteger(l)&&e.isInteger(h)?h:l):e.isMatrix(l)?h==="float"?h="float":e.isVector(h)?h=e.getVectorFromMatrix(l):e.isMatrix(h)||(l=h=o):e.isMatrix(h)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(h):l=h=o:l=h=o):l=h=o;const p=r.build(e,l),y=i?i.build(e,h):null,x=e.getFunctionOperator(n);if(t!=="void"){const S=e.renderer.coordinateSystem===Ru;if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">=")return S?e.isVector(l)?e.format(`${this.getOperatorMethod(e,t)}( ${p}, ${y} )`,o,t):e.format(`( ${p} ${n} ${y} )`,o,t):e.format(`( ${p} ${n} ${y} )`,o,t);if(n==="%")return e.isInteger(h)?e.format(`( ${p} % ${y} )`,o,t):e.format(`${this.getOperatorMethod(e,o)}( ${p}, ${y} )`,o,t);if(n==="!"||n==="~")return e.format(`(${n}${p})`,l,t);if(x)return e.format(`${x}( ${p}, ${y} )`,o,t);if(e.isMatrix(l)&&h==="float")return e.format(`( ${y} ${n} ${p} )`,o,t);if(l==="float"&&e.isMatrix(h))return e.format(`${p} ${n} ${y}`,o,t);{let A=`( ${p} ${n} ${y} )`;return!S&&o==="bool"&&e.isVector(l)&&e.isVector(h)&&(A=`all${A}`),e.format(A,o,t)}}else if(l!=="void")return x?e.format(`${x}( ${p}, ${y} )`,o,t):e.isMatrix(l)&&h==="float"?e.format(`${y} ${n} ${p}`,o,t):e.format(`${p} ${n} ${y}`,o,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Wl=cn(oa,"+").setParameterLength(2,1/0).setName("add"),Bl=cn(oa,"-").setParameterLength(2,1/0).setName("sub"),Mi=cn(oa,"*").setParameterLength(2,1/0).setName("mul"),h1=cn(oa,"/").setParameterLength(2,1/0).setName("div"),Uk=cn(oa,"%").setParameterLength(2).setName("mod"),T4e=cn(oa,"==").setParameterLength(2).setName("equal"),_Oe=cn(oa,"!=").setParameterLength(2).setName("notEqual"),xOe=cn(oa,"<").setParameterLength(2).setName("lessThan"),bOe=cn(oa,">").setParameterLength(2).setName("greaterThan"),SOe=cn(oa,"<=").setParameterLength(2).setName("lessThanEqual"),wOe=cn(oa,">=").setParameterLength(2).setName("greaterThanEqual"),EOe=cn(oa,"&&").setParameterLength(2,1/0).setName("and"),TOe=cn(oa,"||").setParameterLength(2,1/0).setName("or"),MOe=cn(oa,"!").setParameterLength(1).setName("not"),COe=cn(oa,"^^").setParameterLength(2).setName("xor"),AOe=cn(oa,"&").setParameterLength(2).setName("bitAnd"),POe=cn(oa,"~").setParameterLength(2).setName("bitNot"),ROe=cn(oa,"|").setParameterLength(2).setName("bitOr"),IOe=cn(oa,"^").setParameterLength(2).setName("bitXor"),kOe=cn(oa,"<<").setParameterLength(2).setName("shiftLeft"),NOe=cn(oa,">>").setParameterLength(2).setName("shiftRight"),DOe=un(([s])=>(s.addAssign(1),s)),OOe=un(([s])=>(s.subAssign(1),s)),FOe=un(([s])=>{const e=Bs(s).toConst();return s.addAssign(1),e}),LOe=un(([s])=>{const e=Bs(s).toConst();return s.subAssign(1),e});jt("add",Wl);jt("sub",Bl);jt("mul",Mi);jt("div",h1);jt("mod",Uk);jt("equal",T4e);jt("notEqual",_Oe);jt("lessThan",xOe);jt("greaterThan",bOe);jt("lessThanEqual",SOe);jt("greaterThanEqual",wOe);jt("and",EOe);jt("or",TOe);jt("not",MOe);jt("xor",COe);jt("bitAnd",AOe);jt("bitNot",POe);jt("bitOr",ROe);jt("bitXor",IOe);jt("shiftLeft",kOe);jt("shiftRight",NOe);jt("incrementBefore",DOe);jt("decrementBefore",OOe);jt("increment",FOe);jt("decrement",LOe);const UOe=(s,e)=>(console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),Uk(s,e)),BOe=(s,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),Uk(Bs(s),Bs(e)));jt("remainder",UOe);jt("modInt",BOe);class mt extends co{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){if(super(),(e===mt.MAX||e===mt.MIN)&&arguments.length>3){let i=new mt(e,t,n);for(let o=2;o<arguments.length-1;o++)i=new mt(e,i,arguments[o]);t=i,n=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(n)?0:e.getTypeLength(n),l=e.isMatrix(r)?0:e.getTypeLength(r);return i>o&&i>l?t:o>l?n:l>i?r:t}getNodeType(e){const t=this.method;return t===mt.LENGTH||t===mt.DISTANCE||t===mt.DOT?"float":t===mt.CROSS?"vec3":t===mt.ALL||t===mt.ANY?"bool":t===mt.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:r}=this;let i=null;if(r===mt.ONE_MINUS)i=Bl(1,t);else if(r===mt.RECIPROCAL)i=h1(1,t);else if(r===mt.DIFFERENCE)i=Oh(Bl(t,n));else if(r===mt.TRANSFORM_DIRECTION){let o=t,l=n;e.isMatrix(o.getNodeType(e))?l=Jr(Yt(l),0):o=Jr(Yt(o),0);const h=Mi(o,l).xyz;i=LE(h)}return i!==null?i:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const i=this.getNodeType(e),o=this.getInputType(e),l=this.aNode,h=this.bNode,p=this.cNode,y=e.renderer.coordinateSystem;if(r===mt.NEGATE)return e.format("( - "+l.build(e,o)+" )",i,t);{const x=[];return r===mt.CROSS?x.push(l.build(e,i),h.build(e,i)):y===Ru&&r===mt.STEP?x.push(l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":o),h.build(e,o)):y===Ru&&(r===mt.MIN||r===mt.MAX)?x.push(l.build(e,o),h.build(e,e.getTypeLength(h.getNodeType(e))===1?"float":o)):r===mt.REFRACT?x.push(l.build(e,o),h.build(e,o),p.build(e,"float")):r===mt.MIX?x.push(l.build(e,o),h.build(e,o),p.build(e,e.getTypeLength(p.getNodeType(e))===1?"float":o)):(y===i4&&r===mt.ATAN&&h!==null&&(r="atan2"),e.shaderStage!=="fragment"&&(r===mt.DFDX||r===mt.DFDY)&&(console.warn(`THREE.TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),x.push(l.build(e,o)),h!==null&&x.push(h.build(e,o)),p!==null&&x.push(p.build(e,o))),e.format(`${e.getMethod(r,i)}( ${x.join(", ")} )`,i,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}mt.ALL="all";mt.ANY="any";mt.RADIANS="radians";mt.DEGREES="degrees";mt.EXP="exp";mt.EXP2="exp2";mt.LOG="log";mt.LOG2="log2";mt.SQRT="sqrt";mt.INVERSE_SQRT="inversesqrt";mt.FLOOR="floor";mt.CEIL="ceil";mt.NORMALIZE="normalize";mt.FRACT="fract";mt.SIN="sin";mt.COS="cos";mt.TAN="tan";mt.ASIN="asin";mt.ACOS="acos";mt.ATAN="atan";mt.ABS="abs";mt.SIGN="sign";mt.LENGTH="length";mt.NEGATE="negate";mt.ONE_MINUS="oneMinus";mt.DFDX="dFdx";mt.DFDY="dFdy";mt.ROUND="round";mt.RECIPROCAL="reciprocal";mt.TRUNC="trunc";mt.FWIDTH="fwidth";mt.TRANSPOSE="transpose";mt.BITCAST="bitcast";mt.EQUALS="equals";mt.MIN="min";mt.MAX="max";mt.STEP="step";mt.REFLECT="reflect";mt.DISTANCE="distance";mt.DIFFERENCE="difference";mt.DOT="dot";mt.CROSS="cross";mt.POW="pow";mt.TRANSFORM_DIRECTION="transformDirection";mt.MIX="mix";mt.CLAMP="clamp";mt.REFRACT="refract";mt.SMOOTHSTEP="smoothstep";mt.FACEFORWARD="faceforward";const zOe=$t(1e-6),VOe=$t(Math.PI),GOe=cn(mt,mt.ALL).setParameterLength(1),HOe=cn(mt,mt.ANY).setParameterLength(1),jOe=cn(mt,mt.RADIANS).setParameterLength(1),WOe=cn(mt,mt.DEGREES).setParameterLength(1),M4e=cn(mt,mt.EXP).setParameterLength(1),FE=cn(mt,mt.EXP2).setParameterLength(1),C4e=cn(mt,mt.LOG).setParameterLength(1),Dg=cn(mt,mt.LOG2).setParameterLength(1),NW=cn(mt,mt.SQRT).setParameterLength(1),$Oe=cn(mt,mt.INVERSE_SQRT).setParameterLength(1),wv=cn(mt,mt.FLOOR).setParameterLength(1),DW=cn(mt,mt.CEIL).setParameterLength(1),LE=cn(mt,mt.NORMALIZE).setParameterLength(1),c4=cn(mt,mt.FRACT).setParameterLength(1),xf=cn(mt,mt.SIN).setParameterLength(1),W3=cn(mt,mt.COS).setParameterLength(1),qOe=cn(mt,mt.TAN).setParameterLength(1),XOe=cn(mt,mt.ASIN).setParameterLength(1),A4e=cn(mt,mt.ACOS).setParameterLength(1),P4e=cn(mt,mt.ATAN).setParameterLength(1,2),Oh=cn(mt,mt.ABS).setParameterLength(1),bk=cn(mt,mt.SIGN).setParameterLength(1),Og=cn(mt,mt.LENGTH).setParameterLength(1),YOe=cn(mt,mt.NEGATE).setParameterLength(1),KOe=cn(mt,mt.ONE_MINUS).setParameterLength(1),R4e=cn(mt,mt.DFDX).setParameterLength(1),I4e=cn(mt,mt.DFDY).setParameterLength(1),ZOe=cn(mt,mt.ROUND).setParameterLength(1),QOe=cn(mt,mt.RECIPROCAL).setParameterLength(1),JOe=cn(mt,mt.TRUNC).setParameterLength(1),eFe=cn(mt,mt.FWIDTH).setParameterLength(1),tFe=cn(mt,mt.TRANSPOSE).setParameterLength(1),nFe=(s,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),T4e(s,e)),ex=cn(mt,mt.MIN).setParameterLength(2,1/0),el=cn(mt,mt.MAX).setParameterLength(2,1/0),k4e=cn(mt,mt.STEP).setParameterLength(2),rFe=cn(mt,mt.REFLECT).setParameterLength(2),iFe=cn(mt,mt.DISTANCE).setParameterLength(2),sFe=cn(mt,mt.DIFFERENCE).setParameterLength(2),OW=cn(mt,mt.DOT).setParameterLength(2),N4e=cn(mt,mt.CROSS).setParameterLength(2),Bk=cn(mt,mt.POW).setParameterLength(2),D4e=cn(mt,mt.POW,2).setParameterLength(1),aFe=cn(mt,mt.POW,3).setParameterLength(1),oFe=cn(mt,mt.POW,4).setParameterLength(1),lFe=cn(mt,mt.TRANSFORM_DIRECTION).setParameterLength(2),uFe=s=>Mi(bk(s),Bk(Oh(s),1/3)),O4e=s=>OW(s,s),ea=cn(mt,mt.MIX).setParameterLength(3),Bg=(s,e=0,t=1)=>hn(new mt(mt.CLAMP,hn(s),hn(e),hn(t))),F4e=s=>Bg(s),L4e=cn(mt,mt.REFRACT).setParameterLength(3),s4=cn(mt,mt.SMOOTHSTEP).setParameterLength(3),cFe=cn(mt,mt.FACEFORWARD).setParameterLength(3),hFe=un(([s])=>{const n=43758.5453,r=OW(s.xy,In(12.9898,78.233)),i=Uk(r,VOe);return c4(xf(i).mul(n))}),dFe=(s,e,t)=>ea(e,t,s),fFe=(s,e,t)=>s4(e,t,s),pFe=(s,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),P4e(s,e));jt("all",GOe);jt("any",HOe);jt("equals",nFe);jt("radians",jOe);jt("degrees",WOe);jt("exp",M4e);jt("exp2",FE);jt("log",C4e);jt("log2",Dg);jt("sqrt",NW);jt("inverseSqrt",$Oe);jt("floor",wv);jt("ceil",DW);jt("normalize",LE);jt("fract",c4);jt("sin",xf);jt("cos",W3);jt("tan",qOe);jt("asin",XOe);jt("acos",A4e);jt("atan",P4e);jt("abs",Oh);jt("sign",bk);jt("length",Og);jt("lengthSq",O4e);jt("negate",YOe);jt("oneMinus",KOe);jt("dFdx",R4e);jt("dFdy",I4e);jt("round",ZOe);jt("reciprocal",QOe);jt("trunc",JOe);jt("fwidth",eFe);jt("atan2",pFe);jt("min",ex);jt("max",el);jt("step",k4e);jt("reflect",rFe);jt("distance",iFe);jt("dot",OW);jt("cross",N4e);jt("pow",Bk);jt("pow2",D4e);jt("pow3",aFe);jt("pow4",oFe);jt("transformDirection",lFe);jt("mix",dFe);jt("clamp",Bg);jt("refract",L4e);jt("smoothstep",fFe);jt("faceForward",cFe);jt("difference",sFe);jt("saturate",F4e);jt("cbrt",uFe);jt("transpose",tFe);jt("rand",hFe);class mFe extends ti{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(t===void 0)return this.setup(e),this.getNodeType(e);const r=t.getNodeType(e);if(n!==null){const i=n.getNodeType(e);if(e.getTypeLength(i)>e.getTypeLength(r))return i}return r}setup(e){const t=this.condNode.cache(),n=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=i,r!==null&&(e.getDataFromNode(r).parentNodeBlock=i);const o=e.getNodeProperties(this);o.condNode=t,o.ifNode=n.context({nodeBlock:n}),o.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:i,ifNode:o,elseNode:l}=e.getNodeProperties(this),h=e.currentFunctionNode,p=t!=="void",y=p?y4e(n).build(e):"";r.nodeProperty=y;const x=i.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${x} ) {

`).addFlowTab();let S=o.build(e,n);if(S&&(p?S=y+" = "+S+";":(S="return "+S+";",h===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),S="// "+S))),e.removeFlowTab().addFlowCode(e.tab+"	"+S+`

`+e.tab+"}"),l!==null){e.addFlowCode(` else {

`).addFlowTab();let A=l.build(e,n);A&&(p?A=y+" = "+A+";":(A="return "+A+";",h===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),A="// "+A))),e.removeFlowTab().addFlowCode(e.tab+"	"+A+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(y,n,t)}}const Z0=cn(mFe).setParameterLength(2,3);jt("select",Z0);const gFe=(...s)=>(console.warn("THREE.TSL: cond() has been renamed to select()."),Z0(...s));jt("cond",gFe);class U4e extends ti{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const n=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(n),r}}const FW=cn(U4e).setParameterLength(1,2),vFe=(s,e)=>FW(s,{label:e});jt("context",FW);jt("label",vFe);class zI extends ti{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:n,readOnly:r}=this,{renderer:i}=e,o=i.backend.isWebGPUBackend===!0;let l=!1,h=!1;r&&(l=e.isDeterministic(t),h=o?r:l);const p=e.getVectorType(this.getNodeType(e)),y=t.build(e,p),x=e.getVarFromNode(this,n,p,void 0,h),S=e.getPropertyName(x);let A=S;if(h)if(o)A=l?`const ${S}`:`let ${S}`;else{const k=e.getArrayCount(t);A=`const ${e.getVar(x.type,S,k)}`}return e.addLineFlowCode(`${A} = ${y}`,this),S}}const LW=cn(zI),yFe=(s,e=null)=>LW(s,e).toStack(),_Fe=(s,e=null)=>LW(s,e,!0).toStack();jt("toVar",yFe);jt("toConst",_Fe);const xFe=s=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),LW(s));jt("temp",xFe);class bFe extends ti{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(n===void 0){const r=this.name,i=this.getNodeType(e),o=this.interpolationType,l=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,r,i,o,l),t.node=this.node}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(BR.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(BR.VERTEX,this.node)}generate(e){const t=e.getNodeProperties(this),n=this.setupVarying(e);if(t.propertyName===void 0){const r=this.getNodeType(e),i=e.getPropertyName(n,BR.VERTEX);e.flowNodeFromShaderStage(BR.VERTEX,this.node,r,i),t.propertyName=i}return e.getPropertyName(n)}}const Af=cn(bFe).setParameterLength(1,2),SFe=s=>Af(s);jt("toVarying",Af);jt("toVertexStage",SFe);jt("varying",(...s)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),Af(...s)));jt("vertexStage",(...s)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),Af(...s)));const wFe=un(([s])=>{const e=s.mul(.9478672986).add(.0521327014).pow(2.4),t=s.mul(.0773993808),n=s.lessThanEqual(.04045);return ea(e,t,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),EFe=un(([s])=>{const e=s.pow(.41666).mul(1.055).sub(.055),t=s.mul(12.92),n=s.lessThanEqual(.0031308);return ea(e,t,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),UW="WorkingColorSpace",TFe="OutputColorSpace";class B4e extends co{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===UW?Us.workingColorSpace:t===TFe?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let i=t;return Us.enabled===!1||n===r||!n||!r||(Us.getTransfer(n)===Xr&&(i=Jr(wFe(i.rgb),i.a)),Us.getPrimaries(n)!==Us.getPrimaries(r)&&(i=Jr(jl(Us._getMatrix(new Ou,n,r)).mul(i.rgb),i.a)),Us.getTransfer(r)===Xr&&(i=Jr(EFe(i.rgb),i.a))),i}}const MFe=(s,e)=>hn(new B4e(hn(s),UW,e)),BW=(s,e)=>hn(new B4e(hn(s),e,UW));jt("workingToColorSpace",MFe);jt("colorSpaceToWorking",BW);let CFe=class extends WE{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class z4e extends ti{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=_i.OBJECT}setGroup(e){return this.group=e,this}element(e){return hn(new CFe(this,hn(e)))}setNodeType(e){const t=Vr(null,e).getSelf();this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const AFe=(s,e,t)=>hn(new z4e(s,e,t));class PFe extends z4e{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(zr)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const RFe=(s,e,t=null)=>hn(new PFe(s,e,t));class IFe extends co{static get type(){return"ToneMappingNode"}constructor(e,t=NFe,n=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return fk(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(n===R_)return t;let r=null;const i=e.renderer.library.getToneMappingFunction(n);return i!==null?r=Jr(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const kFe=(s,e,t)=>hn(new IFe(s,hn(e),hn(t))),NFe=RFe("toneMappingExposure","float");jt("toneMapping",(s,e,t)=>kFe(e,t,s));const Nl=new vt;class zW{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Nl.fromBufferAttribute(this,t),Nl.applyMatrix4(e),this.setXYZ(t,Nl.x,Nl.y,Nl.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Nl.fromBufferAttribute(this,t),Nl.applyNormalMatrix(e),this.setXYZ(t,Nl.x,Nl.y,Nl.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Nl.fromBufferAttribute(this,t),Nl.transformDirection(e),this.setXYZ(t,Nl.x,Nl.y,Nl.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=zl(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=si(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=zl(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=zl(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=zl(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=zl(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),n=si(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array),i=si(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return new Vh(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new zW(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class V4e{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=dk,this.updateRanges=[],this.version=0,this.uuid=Ag()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ag()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ag()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}class DFe extends EW{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=dk,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),n=this.value,r=e.getTypeLength(t),i=this.bufferStride||r,o=this.bufferOffset,l=n.isInterleavedBuffer===!0?n:new V4e(n,i),h=new zW(l,r,o);l.setUsage(this.usage),this.attribute=h,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let i=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,i=r):i=Af(this).build(e,t),i}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const VW=(s,e=null,t=0,n=0)=>hn(new DFe(s,e,t,n)),OFe=(s,e=null,t=0,n=0)=>VW(s,e,t,n).setUsage(x_),uge=(s,e=null,t=0,n=0)=>VW(s,e,t,n).setInstanced(!0),cge=(s,e=null,t=0,n=0)=>OFe(s,e,t,n).setInstanced(!0);jt("toAttribute",s=>VW(s.value));class FFe extends ti{static get type(){return"ComputeNode"}constructor(e,t,n=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=_i.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let n=t[0];for(let r=1;r<t.length;r++)n*=t[r];this.dispatchCount=Math.ceil(e/n)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const n=e.getNodeProperties(this);n.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if(n==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const i=e.getNodeProperties(this).outputComputeNode;if(i)return i.build(e,t)}}}const LFe=(s,e,t)=>hn(new FFe(hn(s),e,t));jt("compute",LFe);class UFe extends ti{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const i=this.node.build(e,...t);return e.setCache(n),i}}const VI=(s,e)=>hn(new UFe(hn(s),e)),BFe=(s,e)=>s.context({namespace:e});jt("cache",VI);class zFe extends ti{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const VFe=cn(zFe).setParameterLength(2);jt("bypass",VFe);class G4e extends ti{static get type(){return"RemapNode"}constructor(e,t,n,r=$t(0),i=$t(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=i,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:i,doClamp:o}=this;let l=e.sub(t).div(n.sub(t));return o===!0&&(l=l.clamp()),l.mul(i.sub(r)).add(r)}}const GFe=cn(G4e,null,null,{doClamp:!1}).setParameterLength(3,5),HFe=cn(G4e).setParameterLength(3,5);jt("remap",GFe);jt("remapClamp",HFe);class GI extends ti{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if(n==="void")e.addLineFlowCode(r,this);else return e.format(r,n,t)}}const tx=cn(GI).setParameterLength(1,2),jFe=s=>(s?Z0(s,tx("discard")):tx("discard")).toStack();jt("discard",jFe);class WFe extends co{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const n=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||R_,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Lg;return n!==R_&&(t=t.toneMapping(n)),r!==Lg&&r!==Us.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const $Fe=(s,e=null,t=null)=>hn(new WFe(hn(s),e,t));jt("renderOutput",$Fe);class qFe extends co{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",i="-".repeat(r.length);let o="";return o+="// #"+r+`#
`,o+=e.flow.code.replace(/^\t/mg,"")+`
`,o+="/* ... */ "+n+` /* ... */
`,o+="// #"+i+`#
`,t!==null?t(e,o):console.log(o),n}}const XFe=(s,e=null)=>hn(new qFe(hn(s),e));jt("debug",XFe);class H4e extends ti{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const i=e.geometry.getAttribute(t),o=e.getTypeFromAttribute(i),l=e.getAttribute(t,o);return e.shaderStage==="vertex"?e.format(l.name,o,n):Af(this).build(e,n)}else return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const a4=(s,e=null)=>hn(new H4e(s,e));class ta extends ti{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let r;if(n===ta.VERTEX)r=e.getVertexIndex();else if(n===ta.INSTANCE)r=e.getInstanceIndex();else if(n===ta.DRAW)r=e.getDrawIndex();else if(n===ta.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(n===ta.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(n===ta.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let i;return e.shaderStage==="vertex"||e.shaderStage==="compute"?i=r:i=Af(this).build(e,t),i}}ta.VERTEX="vertex";ta.INSTANCE="instance";ta.SUBGROUP="subgroup";ta.INVOCATION_LOCAL="invocationLocal";ta.INVOCATION_SUBGROUP="invocationSubgroup";ta.DRAW="draw";const YFe=Rn(ta,ta.VERTEX),GW=Rn(ta,ta.INSTANCE);ta.SUBGROUP;ta.INVOCATION_SUBGROUP;ta.INVOCATION_LOCAL;const KFe=Rn(ta,ta.DRAW);class ZFe extends cs{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class QFe extends ti{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.outputNode?this.outputNode.getMemberType(e,t):"void"}add(e){return this.nodes.push(e),this}If(e,t){const n=new eE(t);return this._currentCond=Z0(e,n),this.add(this._currentCond)}ElseIf(e,t){const n=new eE(t),r=Z0(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new eE(e),this}Switch(e){return this._expressionNode=hn(e),this}Case(...e){const t=[];if(e.length>=2)for(let l=0;l<e.length-1;l++)t.push(this._expressionNode.equal(hn(e[l])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const n=e[e.length-1],r=new eE(n);let i=t[0];for(let l=1;l<t.length;l++)i=i.or(t[l]);const o=Z0(i,r);return this._currentCond===null?(this._currentCond=o,this.add(this._currentCond)):(this._currentCond.elseNode=o,this._currentCond=o,this)}Default(e){return this.Else(e),this}build(e,...t){const n=p4e();gk(this);const r=e.buildStage;for(const i of this.nodes)if(r==="setup")i.build(e);else if(r==="analyze")i.build(e,this);else if(r==="generate"){const o=e.getDataFromNode(i,"any").stages,l=o&&o[e.shaderStage];if(i.isVarNode&&l&&l.length===1&&l[0]&&l[0].isStackNode)continue;i.build(e,"void")}return gk(n),this.outputNode?this.outputNode.build(e,...t):super.build(e,...t)}else(...e){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const xV=cn(QFe).setParameterLength(0,1);class JFe extends ti{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const n={};for(let o=0,l=this.params.length-1;o<l;o++){const h=this.params[o],p=h.isNode!==!0&&h.name||this.getVarName(o),y=h.isNode!==!0&&h.type||"int";n[p]=tx(p,y)}const r=e.addStack();t.returnsNode=this.params[this.params.length-1](n,e),t.stackNode=r;const i=this.params[0];return i.isNode!==!0&&typeof i.update=="function"&&(t.updateNode=un(this.params[0].update)(n)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let l=0,h=n.length-1;l<h;l++){const p=n[l];let y=!1,x=null,S=null,A=null,k=null,L=null,U=null;p.isNode?p.getNodeType(e)==="bool"?(y=!0,k="bool",S=p.build(e,k)):(k="int",A=this.getVarName(l),x="0",S=p.build(e,k),L="<"):(k=p.type||"int",A=p.name||this.getVarName(l),x=p.start,S=p.end,L=p.condition,U=p.update,typeof x=="number"?x=e.generateConst(k,x):x&&x.isNode&&(x=x.build(e,k)),typeof S=="number"?S=e.generateConst(k,S):S&&S.isNode&&(S=S.build(e,k)),x!==void 0&&S===void 0?(x=x+" - 1",S="0",L=">="):S!==void 0&&x===void 0&&(x="0",L="<"),L===void 0&&(Number(x)>Number(S)?L=">=":L="<"));let P;if(y)P=`while ( ${S} )`;else{const $={start:x,end:S},Z=$.start,I=$.end;let ie;const ce=()=>L.includes("<")?"+=":"-=";if(U!=null)switch(typeof U){case"function":ie=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":ie=A+" "+ce()+" "+e.generateConst(k,U);break;case"string":ie=A+" "+U;break;default:U.isNode?ie=A+" "+ce()+" "+U.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),ie="break /* invalid update */")}else k==="int"||k==="uint"?U=L.includes("<")?"++":"--":U=ce()+" 1.",ie=A+" "+U;const ue=e.getVar(k,A)+" = "+Z,Q=A+" "+L+" "+I;P=`for ( ${ue}; ${Q}; ${ie} )`}e.addFlowCode((l===0?`
`:"")+e.tab+P+` {

`).addFlowTab()}const i=r.build(e,"void"),o=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+i);for(let l=0,h=this.params.length-1;l<h;l++)e.addFlowCode((l===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),o}}const wf=(...s)=>hn(new JFe(N_(s,"int"))).toStack(),eLe=()=>tx("break").toStack();class qE{constructor(e=new vt(1/0,1/0,1/0),t=new vt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(hf.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(hf.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=hf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const i=n.getAttribute("position");if(t===!0&&i!==void 0&&e.isInstancedMesh!==!0)for(let o=0,l=i.count;o<l;o++)e.isMesh===!0?e.getVertexPosition(o,hf):hf.fromBufferAttribute(i,o),hf.applyMatrix4(e.matrixWorld),this.expandByPoint(hf);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),zR.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),zR.copy(n.boundingBox)),zR.applyMatrix4(e.matrixWorld),this.union(zR)}const r=e.children;for(let i=0,o=r.length;i<o;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,hf),hf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ew),VR.subVectors(this.max,Ew),j7.subVectors(e.a,Ew),W7.subVectors(e.b,Ew),$7.subVectors(e.c,Ew),N3.subVectors(W7,j7),D3.subVectors($7,W7),X8.subVectors(j7,$7);let t=[0,-N3.z,N3.y,0,-D3.z,D3.y,0,-X8.z,X8.y,N3.z,0,-N3.x,D3.z,0,-D3.x,X8.z,0,-X8.x,-N3.y,N3.x,0,-D3.y,D3.x,0,-X8.y,X8.x,0];return!bV(t,j7,W7,$7,VR)||(t=[1,0,0,0,1,0,0,0,1],!bV(t,j7,W7,$7,VR))?!1:(GR.crossVectors(N3,D3),t=[GR.x,GR.y,GR.z],bV(t,j7,W7,$7,VR))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,hf).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(hf).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(gg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gg),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const gg=[new vt,new vt,new vt,new vt,new vt,new vt,new vt,new vt],hf=new vt,zR=new qE,j7=new vt,W7=new vt,$7=new vt,N3=new vt,D3=new vt,X8=new vt,Ew=new vt,VR=new vt,GR=new vt,Y8=new vt;function bV(s,e,t,n,r){for(let i=0,o=s.length-3;i<=o;i+=3){Y8.fromArray(s,i);const l=r.x*Math.abs(Y8.x)+r.y*Math.abs(Y8.y)+r.z*Math.abs(Y8.z),h=e.dot(Y8),p=t.dot(Y8),y=n.dot(Y8);if(Math.max(-Math.max(h,p,y),Math.min(h,p,y))>l)return!1}return!0}const tLe=new qE,Tw=new vt,SV=new vt;class zk{constructor(e=new vt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):tLe.setFromPoints(e).getCenter(n);let r=0;for(let i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Tw.subVectors(e,this.center);const t=Tw.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Tw,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(SV.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Tw.copy(e.center).add(SV)),this.expandByPoint(Tw.copy(e.center).sub(SV))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const hge=new zk;class bs extends ti{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=_i.OBJECT,this.uniformNode=new $E(null)}getNodeType(){const e=this.scope;if(e===bs.WORLD_MATRIX)return"mat4";if(e===bs.POSITION||e===bs.VIEW_POSITION||e===bs.DIRECTION||e===bs.SCALE)return"vec3";if(e===bs.RADIUS)return"float"}update(e){const t=this.object3d,n=this.uniformNode,r=this.scope;if(r===bs.WORLD_MATRIX)n.value=t.matrixWorld;else if(r===bs.POSITION)n.value=n.value||new vt,n.value.setFromMatrixPosition(t.matrixWorld);else if(r===bs.SCALE)n.value=n.value||new vt,n.value.setFromMatrixScale(t.matrixWorld);else if(r===bs.DIRECTION)n.value=n.value||new vt,t.getWorldDirection(n.value);else if(r===bs.VIEW_POSITION){const i=e.camera;n.value=n.value||new vt,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(i.matrixWorldInverse)}else if(r===bs.RADIUS){const i=e.object.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),hge.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),n.value=hge.radius}}generate(e){const t=this.scope;return t===bs.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===bs.POSITION||t===bs.VIEW_POSITION||t===bs.DIRECTION||t===bs.SCALE?this.uniformNode.nodeType="vec3":t===bs.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}bs.WORLD_MATRIX="worldMatrix";bs.POSITION="position";bs.SCALE="scale";bs.VIEW_POSITION="viewPosition";bs.DIRECTION="direction";bs.RADIUS="radius";const nLe=cn(bs,bs.POSITION).setParameterLength(1);class j4e extends $E{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const W4e=(s,e,t)=>hn(new j4e(s,e,t));class rLe extends WE{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,n)}}class iLe extends j4e{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?mk(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=_i.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if(n==="float"||n==="int"||n==="uint")for(let r=0;r<e.length;r++){const i=r*4;t[i]=e[r]}else if(n==="color")for(let r=0;r<e.length;r++){const i=r*4,o=e[r];t[i]=o.r,t[i+1]=o.g,t[i+2]=o.b||0}else if(n==="mat2")for(let r=0;r<e.length;r++){const i=r*4,o=e[r];t[i]=o.elements[0],t[i+1]=o.elements[1],t[i+2]=o.elements[2],t[i+3]=o.elements[3]}else if(n==="mat3")for(let r=0;r<e.length;r++){const i=r*16,o=e[r];t[i]=o.elements[0],t[i+1]=o.elements[1],t[i+2]=o.elements[2],t[i+4]=o.elements[3],t[i+5]=o.elements[4],t[i+6]=o.elements[5],t[i+8]=o.elements[6],t[i+9]=o.elements[7],t[i+10]=o.elements[8],t[i+15]=1}else if(n==="mat4")for(let r=0;r<e.length;r++){const i=r*16,o=e[r];for(let l=0;l<o.elements.length;l++)t[i+l]=o.elements[l]}else for(let r=0;r<e.length;r++){const i=r*4,o=e[r];t[i]=o.x,t[i+1]=o.y,t[i+2]=o.z||0,t[i+3]=o.w||0}}setup(e){const t=this.array.length,n=this.elementType;let r=Float32Array;const i=this.paddedType,o=e.getTypeLength(i);return n.charAt(0)==="i"&&(r=Int32Array),n.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*o),this.bufferCount=t,this.bufferType=i,super.setup(e)}element(e){return hn(new rLe(this,hn(e)))}}const i1=(s,e)=>hn(new iLe(s,e));class sLe extends ti{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const Vk=cn(sLe).setParameterLength(1),$4e=Vr(0,"uint").label("u_cameraIndex").setGroup(RW("cameraIndex")).toVarying("v_cameraIndex"),pv=Vr("float").label("cameraNear").setGroup(zr).onRenderUpdate(({camera:s})=>s.near),mv=Vr("float").label("cameraFar").setGroup(zr).onRenderUpdate(({camera:s})=>s.far),HW=un(({camera:s})=>{let e;if(s.isArrayCamera&&s.cameras.length>0){const t=[];for(const r of s.cameras)t.push(r.projectionMatrix);e=i1(t).setGroup(zr).label("cameraProjectionMatrices").element(s.isMultiViewCamera?Vk("gl_ViewID_OVR"):$4e).toVar("cameraProjectionMatrix")}else e=Vr("mat4").label("cameraProjectionMatrix").setGroup(zr).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),Gg=un(({camera:s})=>{let e;if(s.isArrayCamera&&s.cameras.length>0){const t=[];for(const r of s.cameras)t.push(r.matrixWorldInverse);e=i1(t).setGroup(zr).label("cameraViewMatrices").element(s.isMultiViewCamera?Vk("gl_ViewID_OVR"):$4e).toVar("cameraViewMatrix")}else e=Vr("mat4").label("cameraViewMatrix").setGroup(zr).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),aLe=Vr(new vt).label("cameraPosition").setGroup(zr).onRenderUpdate(({camera:s},e)=>e.value.setFromMatrixPosition(s.matrixWorld));class Wh extends bs{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}Wh.DIRECTION;const Pv=Rn(Wh,Wh.WORLD_MATRIX);Wh.POSITION;Wh.SCALE;Wh.VIEW_POSITION;Wh.RADIUS;const oLe=Vr(new Ou).onObjectUpdate(({object:s},e)=>e.value.getNormalMatrix(s.matrixWorld)),Gk=un(s=>s.renderer.overrideNodes.modelViewMatrix||lLe).once()().toVar("modelViewMatrix"),lLe=Gg.mul(Pv),dge=un(s=>(s.context.isHighPrecisionModelViewMatrix=!0,Vr("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),fge=un(s=>{const e=s.context.isHighPrecisionModelViewMatrix;return Vr("mat3").onObjectUpdate(({object:t,camera:n})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),Hk=a4("position","vec3"),Y0=Hk.toVarying("positionLocal"),pge=Hk.toVarying("positionPrevious"),UE=un(s=>Pv.mul(Y0).xyz.toVarying(s.getNamespace("v_positionWorld")),"vec3").once("POSITION")(),q4e=un(s=>Y0.transformDirection(Pv).toVarying(s.getNamespace("v_positionWorldDirection")).normalize().toVar("positionWorldDirection"),"vec3").once("POSITION")(),lo=un(s=>s.context.setupPositionView().toVarying(s.getNamespace("v_positionView")),"vec3").once("POSITION")(),ba=lo.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class uLe extends co{static get type(){return"EquirectUVNode"}constructor(e=q4e){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan(e.x).mul(1/(Math.PI*2)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return In(t,n)}}const X4e=cn(uLe).setParameterLength(0,1);class cLe extends ti{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:n}=e;return t.coordinateSystem===Ru&&n.side===Nu?"false":e.getFrontFacing()}}const hLe=Rn(cLe),jk=$t(hLe).mul(2).sub(1),Y4e=a4("normal","vec3"),d1=un(s=>s.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),Yt(0,1,0)):Y4e,"vec3").once()().toVar("normalLocal"),dLe=lo.dFdx().cross(lo.dFdy()).normalize().toVar("normalFlat"),f1=un(s=>{let e;return s.material.flatShading===!0?e=dLe:e=Af(K4e(d1),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),jW=un(s=>{let e=f1.transformDirection(Gg);return s.material.flatShading!==!0&&(e=Af(e,"v_normalWorld")),e},"vec3").once()().normalize().toVar("normalWorld"),ao=un(s=>{let e=s.context.setupNormal().context({getUV:null});return s.material.flatShading!==!0&&(e=e.mul(jk)),e},"vec3").once()().toVar("transformedNormalView"),WW=ao.transformDirection(Gg).toVar("transformedNormalWorld"),tE=un(s=>{let e=s.context.setupClearcoatNormal().context({getUV:null});return s.material.flatShading!==!0&&(e=e.mul(jk)),e},"vec3").once()().toVar("transformedClearcoatNormalView"),fLe=un(([s,e=Pv])=>{const t=jl(e),n=s.div(Yt(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(n).xyz}),K4e=un(([s],e)=>{const t=e.renderer.overrideNodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(s);const n=oLe.mul(s);return Gg.transformDirection(n)});class pLe extends co{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Yt(ba.z,0,ba.x.negate()).normalize(),t=ba.cross(e);return In(e.dot(ao),t.dot(ao)).mul(.495).add(.5)}}const mLe=Rn(pLe);class gLe extends $E{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=_i.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&n.width!==void 0){const{width:r,height:i}=n;this.value=Math.log2(Math.max(r,i))}}}const vLe=cn(gLe).setParameterLength(1),yLe=s=>hn(s).mul(.5).add(.5);class _Le extends co{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const i=t.cos(),o=t.sin();return PW(i,o,o.negate(),i).mul(n)}else{const i=t,o=D_(Jr(1,0,0,0),Jr(0,W3(i.x),xf(i.x).negate(),0),Jr(0,xf(i.x),W3(i.x),0),Jr(0,0,0,1)),l=D_(Jr(W3(i.y),0,xf(i.y),0),Jr(0,1,0,0),Jr(xf(i.y).negate(),0,W3(i.y),0),Jr(0,0,0,1)),h=D_(Jr(W3(i.z),xf(i.z).negate(),0,0),Jr(xf(i.z),W3(i.z),0,0),Jr(0,0,1,0),Jr(0,0,0,1));return o.mul(l).mul(h).mul(Jr(n,1)).xyz}}}const Z4e=cn(_Le).setParameterLength(2);let Mw,Cw;class io extends ti{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===io.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=_i.NONE;return(this.scope===io.SIZE||this.scope===io.VIEWPORT)&&(e=_i.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===io.VIEWPORT?t!==null?Cw.copy(t.viewport):(e.getViewport(Cw),Cw.multiplyScalar(e.getPixelRatio())):t!==null?(Mw.width=t.width,Mw.height=t.height):e.getDrawingBufferSize(Mw)}setup(){const e=this.scope;let t=null;return e===io.SIZE?t=Vr(Mw||(Mw=new mi)):e===io.VIEWPORT?t=Vr(Cw||(Cw=new ki)):t=In(Wk.div(cj)),t}generate(e){if(this.scope===io.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(cj).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}io.COORDINATE="coordinate";io.VIEWPORT="viewport";io.SIZE="size";io.UV="uv";const F_=Rn(io,io.UV),cj=Rn(io,io.SIZE),Wk=Rn(io,io.COORDINATE),gE=Rn(io,io.VIEWPORT);gE.zw;gE.xy;const XE=(s=0)=>a4("uv"+(s>0?s:""),"vec2");class xLe extends ti{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const L_=cn(xLe).setParameterLength(1,2),Q4e=new Q0;class fx extends $E{static get type(){return"TextureNode"}constructor(e=Q4e,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=_i.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===$a?"uvec4":this.value.type===Ul?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return XE(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=Vr(this.value.matrix)),this._matrixUniform.mul(Yt(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?_i.OBJECT:_i.NONE,this}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.image instanceof ImageBitmap&&n.flipY===!0||n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0||n.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(Bs(L_(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||n.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let r=this.uvNode;(r===null||e.context.forceUVContext===!0)&&e.context.getUV&&(r=e.context.getUV(this,e)),r||(r=this.getDefaultUV()),this.updateMatrix===!0&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);let i=this.levelNode;i===null&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,t,n,r,i,o,l,h){const p=this.value;let y;return r?y=e.generateTextureLevel(p,t,n,r,o):i?y=e.generateTextureBias(p,t,n,i,o):h?y=e.generateTextureGrad(p,t,n,h,o):l?y=e.generateTextureCompare(p,t,n,l,o):this.sampler===!1?y=e.generateTextureLoad(p,t,n,o):y=e.generateTexture(p,t,n,o),y}generate(e,t){const n=this.value,r=e.getNodeProperties(this),i=super.generate(e,"property");if(/^sampler/.test(t))return i+"_sampler";if(e.isReference(t))return i;{const o=e.getDataFromNode(this);let l=o.propertyName;if(l===void 0){const{uvNode:y,levelNode:x,biasNode:S,compareNode:A,depthNode:k,gradNode:L}=r,U=this.generateUV(e,y),P=x?x.build(e,"float"):null,$=S?S.build(e,"float"):null,Z=k?k.build(e,"int"):null,I=A?A.build(e,"float"):null,ie=L?[L[0].build(e,"vec2"),L[1].build(e,"vec2")]:null,ce=e.getVarFromNode(this);l=e.getPropertyName(ce);const ue=this.generateSnippet(e,i,U,P,$,Z,I,ie);e.addLineFlowCode(`${l} = ${ue}`,this),o.snippet=ue,o.propertyName=l}let h=l;const p=this.getNodeType(e);return e.needsToWorkingColorSpace(n)&&(h=BW(tx(h,p),n.colorSpace).setup(e).build(e,p)),e.format(h,p,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}blur(e){const t=this.clone();t.biasNode=hn(e).mul(vLe(t)),t.referenceNode=this.getSelf();const n=t.value;return t.generateMipmaps===!1&&(n&&n.generateMipmaps===!1||n.minFilter===So||n.magFilter===So)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),hn(t)}level(e){const t=this.clone();return t.levelNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}size(e){return L_(this,e)}bias(e){const t=this.clone();return t.biasNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}compare(e){const t=this.clone();return t.compareNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}grad(e,t){const n=this.clone();return n.gradNode=[hn(e),hn(t)],n.referenceNode=this.getSelf(),hn(n)}depth(e){const t=this.clone();return t.depthNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const bLe=cn(fx).setParameterLength(1,4).setName("texture"),Hi=(s=Q4e,e=null,t=null,n=null)=>{let r;return s&&s.isTextureNode===!0?(r=hn(s.clone()),r.referenceNode=s.getSelf(),e!==null&&(r.uvNode=hn(e)),t!==null&&(r.levelNode=hn(t)),n!==null&&(r.biasNode=hn(n))):r=bLe(s,e,t,n),r},gf=(...s)=>Hi(...s).setSampler(!1);class SLe extends Q0{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=So,this.minFilter=So,this.generateMipmaps=!1,this.needsUpdate=!0}}const Aw=new mi;class J4e extends fx{static get type(){return"ViewportTextureNode"}constructor(e=F_,t=null,n=null){n===null&&(n=new SLe,n.minFilter=Ig),super(n,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=_i.FRAME}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(Aw);const n=this.value;(n.image.width!==Aw.width||n.image.height!==Aw.height)&&(n.image.width=Aw.width,n.image.height=Aw.height,n.needsUpdate=!0);const r=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const e5e=cn(J4e,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let wV=null;class wLe extends J4e{static get type(){return"ViewportDepthTextureNode"}constructor(e=F_,t=null){wV===null&&(wV=new u1),super(e,t,wV)}}const ELe=cn(wLe).setParameterLength(0,2);class Iu extends ti{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Iu.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===Iu.DEPTH_BASE)n!==null&&(r=r5e().assign(n));else if(t===Iu.DEPTH)e.isPerspectiveCamera?r=TLe(lo.z,pv,mv):r=vE(lo.z,pv,mv);else if(t===Iu.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const i=t5e(n,pv,mv);r=vE(i,pv,mv)}else r=n;else r=vE(lo.z,pv,mv);return r}}Iu.DEPTH_BASE="depthBase";Iu.DEPTH="depth";Iu.LINEAR_DEPTH="linearDepth";const vE=(s,e,t)=>s.add(e).div(e.sub(t)),TLe=(s,e,t)=>e.add(s).mul(t).div(t.sub(e).mul(s)),t5e=(s,e,t)=>e.mul(t).div(t.sub(e).mul(s).sub(t)),n5e=(s,e,t)=>{e=e.max(1e-6).toVar();const n=Dg(s.negate().div(e)),r=Dg(t.div(e));return n.div(r)},r5e=cn(Iu,Iu.DEPTH_BASE),i5e=Rn(Iu,Iu.DEPTH),MLe=cn(Iu,Iu.LINEAR_DEPTH).setParameterLength(0,1);ELe();i5e.assign=s=>r5e(s);const EV=new vt,CLe=new vt,ALe=new Ou;class $3{constructor(e=new vt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=EV.subVectors(n,t).cross(CLe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(EV),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ALe.getNormalMatrix(e),r=this.coplanarPoint(EV).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}class Nv extends kv{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Dc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new ki(0,0,e,t),this.scissorTest=!1,this.viewport=new ki(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new Q0(r);this.textures=[];const o=n.count;for(let l=0;l<o;l++)this.textures[l]=i.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Dc,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new SW(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}new $3;new vt;new vt;new vt;new As;new vt(0,0,-1);new ki;new vt;new vt;new ki;new mi;const PLe=new Nv;F_.flipX();PLe.depthTexture=new u1(1,1);let RLe=0;class Du extends kv{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:RLe++}),this.uuid=Ag(),this.name="",this.type="Material",this.blending=Rg,this.side=Pg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=ok,this.blendDst=lk,this.blendEquation=Sf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ki(0,0,0),this.blendAlpha=0,this.depthFunc=uk,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=rj,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lv,this.stencilZFail=lv,this.stencilZPass=lv,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Rg&&(n.blending=this.blending),this.side!==Pg&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==ok&&(n.blendSrc=this.blendSrc),this.blendDst!==lk&&(n.blendDst=this.blendDst),this.blendEquation!==Sf&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==uk&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==rj&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==lv&&(n.stencilFail=this.stencilFail),this.stencilZFail!==lv&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==lv&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(i){const o=[];for(const l in i){const h=i[l];delete h.metadata,o.push(h)}return o}if(t){const i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const mge=new jh,TV=new As,ILe=Vr(0).onReference(({material:s})=>s).onObjectUpdate(({material:s})=>s.refractionRatio),MV=Vr(1).onReference(({material:s})=>s).onObjectUpdate(function({material:s,scene:e}){return s.envMap?s.envMapIntensity:e.environmentIntensity}),s5e=Vr(new As).onReference(function(s){return s.material}).onObjectUpdate(function({material:s,scene:e}){const t=e.environment!==null&&s.envMap===null?e.environmentRotation:s.envMapRotation;return t?(mge.copy(t),TV.makeRotationFromEuler(mge)):TV.identity(),TV}),kLe=ba.negate().reflect(ao),NLe=ba.negate().refract(ao,ILe),DLe=kLe.transformDirection(Gg).toVar("reflectVector"),OLe=NLe.transformDirection(Gg).toVar("reflectVector");class $k extends Q0{constructor(e=[],t=NE,n,r,i,o,l,h,p,y){super(e,t,n,r,i,o,l,h,p,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}const FLe=new $k;class LLe extends fx{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===NE?DLe:e.mapping===ck?OLe:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Yt(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return(e.renderer.coordinateSystem===i4||!n.isRenderTargetTexture)&&(t=Yt(t.x.negate(),t.yz)),s5e.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const ULe=cn(LLe).setParameterLength(1,4).setName("cubeTexture"),BE=(s=FLe,e=null,t=null,n=null)=>{let r;return s&&s.isCubeTextureNode===!0?(r=hn(s.clone()),r.referenceNode=s.getSelf(),e!==null&&(r.uvNode=hn(e)),t!==null&&(r.levelNode=hn(t)),n!==null&&(r.biasNode=hn(n))):r=ULe(s,e,t,n),r};class BLe extends WE{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class $W extends ti{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=_i.OBJECT}element(e){return hn(new BLe(this,hn(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;this.count!==null?t=W4e(null,e,this.count):Array.isArray(this.getValueFromReference())?t=i1(null,e):e==="texture"?t=Hi(null):e==="cubeTexture"?t=BE(null):t=Vr(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Cs=(s,e,t)=>hn(new $W(s,e,t)),gge=(s,e,t,n)=>hn(new $W(s,e,n,t));class zLe extends $W{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const Y3=(s,e,t=null)=>hn(new zLe(s,e,t)),a5e=un(s=>(s.geometry.hasAttribute("tangent")===!1&&s.geometry.computeTangents(),a4("tangent","vec4")))(),qW=a5e.xyz.toVar("tangentLocal"),o5e=Gk.mul(Jr(qW,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),VLe=un(([s,e],t)=>{let n=s.mul(a5e.w).xyz;return t.material.flatShading!==!0&&(n=Af(n,e)),n}).once(),GLe=VLe(f1.cross(o5e),"v_bitangentView").normalize().toVar("bitangentView"),nE=jl(o5e,GLe,f1),HLe=(()=>{let s=O_.cross(ba);return s=s.cross(O_).normalize(),s=ea(s,ao,uv.mul(Tg.oneMinus()).oneMinus().pow2().pow2()).normalize(),s})(),jLe=un(s=>{const{eye_pos:e,surf_norm:t,mapN:n,uv:r}=s,i=e.dFdx(),o=e.dFdy(),l=r.dFdx(),h=r.dFdy(),p=t,y=o.cross(p),x=p.cross(i),S=y.mul(l.x).add(x.mul(h.x)),A=y.mul(l.y).add(x.mul(h.y)),k=S.dot(S).max(A.dot(A)),L=jk.mul(k.inverseSqrt());return Wl(S.mul(n.x,L),A.mul(n.y,L),p.mul(n.z)).normalize()});class WLe extends co{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=r4}setup(e){const{normalMapType:t,scaleNode:n}=this;let r=this.node.mul(2).sub(1);n!==null&&(r=Yt(r.xy.mul(n),r.z));let i=null;return t===ANe?i=K4e(r):t===r4&&(e.hasGeometryAttribute("tangent")===!0?i=nE.mul(r).normalize():i=jLe({eye_pos:lo,surf_norm:f1,mapN:r,uv:XE()})),i}}const vge=cn(WLe).setParameterLength(1,2),$Le=un(({textureNode:s,bumpScale:e})=>{const t=r=>s.cache().context({getUV:i=>r(i.uvNode||XE()),forceUVContext:!0}),n=$t(t(r=>r));return In($t(t(r=>r.add(r.dFdx()))).sub(n),$t(t(r=>r.add(r.dFdy()))).sub(n)).mul(e)}),qLe=un(s=>{const{surf_pos:e,surf_norm:t,dHdxy:n}=s,r=e.dFdx().normalize(),i=e.dFdy().normalize(),o=t,l=i.cross(o),h=o.cross(r),p=r.dot(l).mul(jk),y=p.sign().mul(n.x.mul(l).add(n.y.mul(h)));return p.abs().mul(t).sub(y).normalize()});class XLe extends co{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=$Le({textureNode:this.textureNode,bumpScale:e});return qLe({surf_pos:lo,surf_norm:f1,dHdxy:t})}}const YLe=cn(XLe).setParameterLength(1,2),yge=new Map;class Gt extends ti{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=yge.get(e);return n===void 0&&(n=Y3(e,t),yge.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===Gt.COLOR){const i=t.color!==void 0?this.getColor(n):Yt();t.map&&t.map.isTexture===!0?r=i.mul(this.getTexture("map")):r=i}else if(n===Gt.OPACITY){const i=this.getFloat(n);t.alphaMap&&t.alphaMap.isTexture===!0?r=i.mul(this.getTexture("alpha")):r=i}else if(n===Gt.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=$t(1);else if(n===Gt.SPECULAR_INTENSITY){const i=this.getFloat(n);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=i.mul(this.getTexture(n).a):r=i}else if(n===Gt.SPECULAR_COLOR){const i=this.getColor(n);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=i.mul(this.getTexture(n).rgb):r=i}else if(n===Gt.ROUGHNESS){const i=this.getFloat(n);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).g):r=i}else if(n===Gt.METALNESS){const i=this.getFloat(n);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=i.mul(this.getTexture(n).b):r=i}else if(n===Gt.EMISSIVE){const i=this.getFloat("emissiveIntensity"),o=this.getColor(n).mul(i);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=o.mul(this.getTexture(n)):r=o}else if(n===Gt.NORMAL)t.normalMap?(r=vge(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):t.bumpMap?r=YLe(this.getTexture("bump").r,this.getFloat("bumpScale")):r=f1;else if(n===Gt.CLEARCOAT){const i=this.getFloat(n);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=i.mul(this.getTexture(n).r):r=i}else if(n===Gt.CLEARCOAT_ROUGHNESS){const i=this.getFloat(n);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).r):r=i}else if(n===Gt.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=vge(this.getTexture(n),this.getCache(n+"Scale","vec2")):r=f1;else if(n===Gt.SHEEN){const i=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=i.mul(this.getTexture("sheenColor").rgb):r=i}else if(n===Gt.SHEEN_ROUGHNESS){const i=this.getFloat(n);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).a):r=i,r=r.clamp(.07,1)}else if(n===Gt.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const i=this.getTexture(n);r=PW(Pw.x,Pw.y,Pw.y.negate(),Pw.x).mul(i.rg.mul(2).sub(In(1)).normalize().mul(i.b))}else r=Pw;else if(n===Gt.IRIDESCENCE_THICKNESS){const i=Cs("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const o=Cs("0","float",t.iridescenceThicknessRange);r=i.sub(o).mul(this.getTexture(n).g).add(o)}else r=i}else if(n===Gt.TRANSMISSION){const i=this.getFloat(n);t.transmissionMap?r=i.mul(this.getTexture(n).r):r=i}else if(n===Gt.THICKNESS){const i=this.getFloat(n);t.thicknessMap?r=i.mul(this.getTexture(n).g):r=i}else if(n===Gt.IOR)r=this.getFloat(n);else if(n===Gt.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===Gt.AO)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===Gt.LINE_DASH_OFFSET)r=t.dashOffset?this.getFloat(n):$t(0);else{const i=this.getNodeType(e);r=this.getCache(n,i)}return r}}Gt.ALPHA_TEST="alphaTest";Gt.COLOR="color";Gt.OPACITY="opacity";Gt.SHININESS="shininess";Gt.SPECULAR="specular";Gt.SPECULAR_STRENGTH="specularStrength";Gt.SPECULAR_INTENSITY="specularIntensity";Gt.SPECULAR_COLOR="specularColor";Gt.REFLECTIVITY="reflectivity";Gt.ROUGHNESS="roughness";Gt.METALNESS="metalness";Gt.NORMAL="normal";Gt.CLEARCOAT="clearcoat";Gt.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Gt.CLEARCOAT_NORMAL="clearcoatNormal";Gt.EMISSIVE="emissive";Gt.ROTATION="rotation";Gt.SHEEN="sheen";Gt.SHEEN_ROUGHNESS="sheenRoughness";Gt.ANISOTROPY="anisotropy";Gt.IRIDESCENCE="iridescence";Gt.IRIDESCENCE_IOR="iridescenceIOR";Gt.IRIDESCENCE_THICKNESS="iridescenceThickness";Gt.IOR="ior";Gt.TRANSMISSION="transmission";Gt.THICKNESS="thickness";Gt.ATTENUATION_DISTANCE="attenuationDistance";Gt.ATTENUATION_COLOR="attenuationColor";Gt.LINE_SCALE="scale";Gt.LINE_DASH_SIZE="dashSize";Gt.LINE_GAP_SIZE="gapSize";Gt.LINE_WIDTH="linewidth";Gt.LINE_DASH_OFFSET="dashOffset";Gt.POINT_SIZE="size";Gt.DISPERSION="dispersion";Gt.LIGHT_MAP="light";Gt.AO="ao";const KLe=Rn(Gt,Gt.ALPHA_TEST),ZLe=Rn(Gt,Gt.COLOR),QLe=Rn(Gt,Gt.SHININESS),JLe=Rn(Gt,Gt.EMISSIVE),l5e=Rn(Gt,Gt.OPACITY),eUe=Rn(Gt,Gt.SPECULAR),_ge=Rn(Gt,Gt.SPECULAR_INTENSITY),tUe=Rn(Gt,Gt.SPECULAR_COLOR),HI=Rn(Gt,Gt.SPECULAR_STRENGTH),CV=Rn(Gt,Gt.REFLECTIVITY),nUe=Rn(Gt,Gt.ROUGHNESS),rUe=Rn(Gt,Gt.METALNESS),iUe=Rn(Gt,Gt.NORMAL),sUe=Rn(Gt,Gt.CLEARCOAT),aUe=Rn(Gt,Gt.CLEARCOAT_ROUGHNESS),oUe=Rn(Gt,Gt.CLEARCOAT_NORMAL),lUe=Rn(Gt,Gt.ROTATION),uUe=Rn(Gt,Gt.SHEEN),cUe=Rn(Gt,Gt.SHEEN_ROUGHNESS),hUe=Rn(Gt,Gt.ANISOTROPY),dUe=Rn(Gt,Gt.IRIDESCENCE),fUe=Rn(Gt,Gt.IRIDESCENCE_IOR),pUe=Rn(Gt,Gt.IRIDESCENCE_THICKNESS),mUe=Rn(Gt,Gt.TRANSMISSION),gUe=Rn(Gt,Gt.THICKNESS),vUe=Rn(Gt,Gt.IOR),yUe=Rn(Gt,Gt.ATTENUATION_DISTANCE),_Ue=Rn(Gt,Gt.ATTENUATION_COLOR),xUe=Rn(Gt,Gt.LINE_SCALE),bUe=Rn(Gt,Gt.LINE_DASH_SIZE),SUe=Rn(Gt,Gt.LINE_GAP_SIZE);Gt.LINE_WIDTH;const wUe=Rn(Gt,Gt.LINE_DASH_OFFSET),EUe=Rn(Gt,Gt.POINT_SIZE),TUe=Rn(Gt,Gt.DISPERSION),u5e=Rn(Gt,Gt.LIGHT_MAP),MUe=Rn(Gt,Gt.AO),Pw=Vr(new mi).onReference(function(s){return s.material}).onRenderUpdate(function({material:s}){this.value.set(s.anisotropy*Math.cos(s.anisotropyRotation),s.anisotropy*Math.sin(s.anisotropyRotation))}),c5e=un(s=>s.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class CUe extends V4e{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class AUe extends Vh{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}class PUe extends ti{static get type(){return"InstanceNode"}constructor(e,t,n=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=n,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=_i.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:t,instanceMatrix:n,instanceColor:r}=this;let{instanceMatrixNode:i,instanceColorNode:o}=this;if(i===null){if(t<=1e3)i=W4e(n.array,"mat4",Math.max(t,1)).element(GW);else{const h=new CUe(n.array,16,1);this.buffer=h;const p=n.usage===x_?cge:uge,y=[p(h,"vec4",16,0),p(h,"vec4",16,4),p(h,"vec4",16,8),p(h,"vec4",16,12)];i=D_(...y)}this.instanceMatrixNode=i}if(r&&o===null){const h=new AUe(r.array,3),p=r.usage===x_?cge:uge;this.bufferColor=h,o=Yt(p(h,"vec3",3,0)),this.instanceColorNode=o}const l=i.mul(Y0).xyz;if(Y0.assign(l),e.hasGeometryAttribute("normal")){const h=fLe(d1,i);d1.assign(h)}this.instanceColorNode!==null&&vk("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==x_&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==x_&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}class RUe extends PUe{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:n,instanceColor:r}=e;super(t,n,r),this.instancedMesh=e}}const IUe=cn(RUe).setParameterLength(1);class kUe extends ti{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=GW:this.batchingIdNode=KFe);const n=un(([k])=>{const L=Bs(L_(gf(this.batchMesh._indirectTexture),0).x),U=Bs(k).mod(L),P=Bs(k).div(L);return gf(this.batchMesh._indirectTexture,Sg(U,P)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(Bs(this.batchingIdNode)),r=this.batchMesh._matricesTexture,i=Bs(L_(gf(r),0).x),o=$t(n).mul(4).toInt().toVar(),l=o.mod(i),h=o.div(i),p=D_(gf(r,Sg(l,h)),gf(r,Sg(l.add(1),h)),gf(r,Sg(l.add(2),h)),gf(r,Sg(l.add(3),h))),y=this.batchMesh._colorsTexture;if(y!==null){const L=un(([U])=>{const P=Bs(L_(gf(y),0).x),$=U,Z=$.mod(P),I=$.div(P);return gf(y,Sg(Z,I)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(n);vk("vec3","vBatchColor").assign(L)}const x=jl(p);Y0.assign(p.mul(Y0));const S=d1.div(Yt(x[0].dot(x[0]),x[1].dot(x[1]),x[2].dot(x[2]))),A=x.mul(S).xyz;d1.assign(A),e.hasGeometryAttribute("tangent")&&qW.mulAssign(x)}}const NUe=cn(kUe).setParameterLength(1),xge=new WeakMap;class DUe extends ti{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=_i.OBJECT,this.skinIndexNode=a4("skinIndex","uvec4"),this.skinWeightNode=a4("skinWeight","vec4"),this.bindMatrixNode=Cs("bindMatrix","mat4"),this.bindMatrixInverseNode=Cs("bindMatrixInverse","mat4"),this.boneMatricesNode=gge("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=Y0,this.toPositionNode=Y0,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:o}=this,l=e.element(n.x),h=e.element(n.y),p=e.element(n.z),y=e.element(n.w),x=i.mul(t),S=Wl(l.mul(r.x).mul(x),h.mul(r.y).mul(x),p.mul(r.z).mul(x),y.mul(r.w).mul(x));return o.mul(S).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=d1){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:o}=this,l=e.element(n.x),h=e.element(n.y),p=e.element(n.z),y=e.element(n.w);let x=Wl(r.x.mul(l),r.y.mul(h),r.z.mul(p),r.w.mul(y));return x=o.mul(x).mul(i),x.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=gge("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,pge)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||r4e(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&pge.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const n=this.getSkinnedNormal();d1.assign(n),e.hasGeometryAttribute("tangent")&&qW.assign(n)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;xge.get(t)!==e.frameId&&(xge.set(t,e.frameId),this.previousBoneMatricesNode!==null&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const OUe=s=>hn(new DUe(s));class FUe extends Q0{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=So,this.minFilter=So,this.wrapR=Z3,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}const AV=new WeakMap,Tc=new ki,bge=un(({bufferMap:s,influence:e,stride:t,width:n,depth:r,offset:i})=>{const o=Bs(YFe).mul(t).add(i),l=o.div(n),h=o.sub(l.mul(n));return gf(s,Sg(h,l)).depth(r).xyz.mul(e)});function LUe(s){const e=s.morphAttributes.position!==void 0,t=s.morphAttributes.normal!==void 0,n=s.morphAttributes.color!==void 0,r=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,i=r!==void 0?r.length:0;let o=AV.get(s);if(o===void 0||o.count!==i){let $=function(){U.dispose(),AV.delete(s),s.removeEventListener("dispose",$)};var l=$;o!==void 0&&o.texture.dispose();const h=s.morphAttributes.position||[],p=s.morphAttributes.normal||[],y=s.morphAttributes.color||[];let x=0;e===!0&&(x=1),t===!0&&(x=2),n===!0&&(x=3);let S=s.attributes.position.count*x,A=1;const k=4096;S>k&&(A=Math.ceil(S/k),S=k);const L=new Float32Array(S*A*4*i),U=new FUe(L,S,A,i);U.type=Rc,U.needsUpdate=!0;const P=x*4;for(let Z=0;Z<i;Z++){const I=h[Z],ie=p[Z],ce=y[Z],ue=S*A*4*Z;for(let Q=0;Q<I.count;Q++){const oe=Q*P;e===!0&&(Tc.fromBufferAttribute(I,Q),L[ue+oe+0]=Tc.x,L[ue+oe+1]=Tc.y,L[ue+oe+2]=Tc.z,L[ue+oe+3]=0),t===!0&&(Tc.fromBufferAttribute(ie,Q),L[ue+oe+4]=Tc.x,L[ue+oe+5]=Tc.y,L[ue+oe+6]=Tc.z,L[ue+oe+7]=0),n===!0&&(Tc.fromBufferAttribute(ce,Q),L[ue+oe+8]=Tc.x,L[ue+oe+9]=Tc.y,L[ue+oe+10]=Tc.z,L[ue+oe+11]=ce.itemSize===4?Tc.w:1)}}o={count:i,texture:U,stride:x,size:new mi(S,A)},AV.set(s,o),s.addEventListener("dispose",$)}return o}class UUe extends ti{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=Vr(1),this.updateType=_i.OBJECT}setup(e){const{geometry:t}=e,n=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,i=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,o=i!==void 0?i.length:0,{texture:l,stride:h,size:p}=LUe(t);n===!0&&Y0.mulAssign(this.morphBaseInfluence),r===!0&&d1.mulAssign(this.morphBaseInfluence);const y=Bs(p.width);wf(o,({i:x})=>{const S=$t(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?S.assign(gf(this.mesh.morphTexture,Sg(Bs(x).add(1),Bs(GW))).r):S.assign(Cs("morphTargetInfluences","float").element(x).toVar()),Xa(S.notEqual(0),()=>{n===!0&&Y0.addAssign(bge({bufferMap:l,influence:S,stride:h,width:y,depth:x,offset:Bs(0)})),r===!0&&d1.addAssign(bge({bufferMap:l,influence:S,stride:h,width:y,depth:x,offset:Bs(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,n)=>t+n,0)}}const BUe=cn(UUe).setParameterLength(1);class px extends ti{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class zUe extends px{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class VUe extends U4e{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,r=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n=Yt().toVar("directDiffuse"),r=Yt().toVar("directSpecular"),i=Yt().toVar("indirectDiffuse"),o=Yt().toVar("indirectSpecular"),l={directDiffuse:n,directSpecular:r,indirectDiffuse:i,indirectSpecular:o};return{radiance:Yt().toVar("radiance"),irradiance:Yt().toVar("irradiance"),iblIrradiance:Yt().toVar("iblIrradiance"),ambientOcclusion:$t(1).toVar("ambientOcclusion"),reflectedLight:l,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const GUe=cn(VUe);class HUe extends px{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}class Gh extends ti{static get type(){return"ClippingNode"}constructor(e=Gh.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===Gh.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,r):this.scope===Gh.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(n,r)}setupAlphaToCoverage(e,t){return un(()=>{const n=$t().toVar("distanceToPlane"),r=$t().toVar("distanceToGradient"),i=$t(1).toVar("clipOpacity"),o=t.length;if(this.hardwareClipping===!1&&o>0){const h=i1(t);wf(o,({i:p})=>{const y=h.element(p);n.assign(lo.dot(y.xyz).negate().add(y.w)),r.assign(n.fwidth().div(2)),i.mulAssign(s4(r.negate(),r,n))})}const l=e.length;if(l>0){const h=i1(e),p=$t(1).toVar("intersectionClipOpacity");wf(l,({i:y})=>{const x=h.element(y);n.assign(lo.dot(x.xyz).negate().add(x.w)),r.assign(n.fwidth().div(2)),p.mulAssign(s4(r.negate(),r,n).oneMinus())}),i.mulAssign(p.oneMinus())}Yi.a.mulAssign(i),Yi.a.equal(0).discard()})()}setupDefault(e,t){return un(()=>{const n=t.length;if(this.hardwareClipping===!1&&n>0){const i=i1(t);wf(n,({i:o})=>{const l=i.element(o);lo.dot(l.xyz).greaterThan(l.w).discard()})}const r=e.length;if(r>0){const i=i1(e),o=AW(!0).toVar("clipped");wf(r,({i:l})=>{const h=i.element(l);o.assign(lo.dot(h.xyz).greaterThan(h.w).and(o))}),o.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),un(()=>{const r=i1(e),i=Vk(t.getClipDistance());wf(n,({i:o})=>{const l=r.element(o),h=lo.dot(l.xyz).sub(l.w).negate();i.element(o).assign(h)})})()}}Gh.ALPHA_TO_COVERAGE="alphaToCoverage";Gh.DEFAULT="default";Gh.HARDWARE="hardware";const jUe=()=>hn(new Gh),WUe=()=>hn(new Gh(Gh.ALPHA_TO_COVERAGE)),$Ue=()=>hn(new Gh(Gh.HARDWARE)),qUe=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class XUe{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=qUe,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:n,material:r,object:i}=e;if(t={material:this.getMaterialData(r),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:i.matrixWorld.clone()},i.center&&(t.center=i.center.clone()),i.morphTargetInfluences&&(t.morphTargetInfluences=i.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:o,height:l}=e.context;t.bufferWidth=o,t.bufferHeight=l}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const r=e[n];t[n]={version:r.version}}return t}containsNode(e){const t=e.material;for(const n in t)if(t[n]&&t[n].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const r=e[n];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[n]={id:r.id,version:r.version}:t[n]=r.clone():t[n]=r)}return t}equals(e){const{object:t,material:n,geometry:r}=e,i=this.getRenderObjectData(e);if(i.worldMatrix.equals(t.matrixWorld)!==!0)return i.worldMatrix.copy(t.matrixWorld),!1;const o=i.material;for(const L in o){const U=o[L],P=n[L];if(U.equals!==void 0){if(U.equals(P)===!1)return U.copy(P),!1}else if(P.isTexture===!0){if(U.id!==P.id||U.version!==P.version)return U.id=P.id,U.version=P.version,!1}else if(U!==P)return o[L]=P,!1}if(o.transmission>0){const{width:L,height:U}=e.context;if(i.bufferWidth!==L||i.bufferHeight!==U)return i.bufferWidth=L,i.bufferHeight=U,!1}const l=i.geometry,h=r.attributes,p=l.attributes,y=Object.keys(p),x=Object.keys(h);if(l.id!==r.id)return l.id=r.id,!1;if(y.length!==x.length)return i.geometry.attributes=this.getAttributesData(h),!1;for(const L of y){const U=p[L],P=h[L];if(P===void 0)return delete p[L],!1;if(U.version!==P.version)return U.version=P.version,!1}const S=r.index,A=l.indexVersion,k=S?S.version:null;if(A!==k)return l.indexVersion=k,!1;if(l.drawRange.start!==r.drawRange.start||l.drawRange.count!==r.drawRange.count)return l.drawRange.start=r.drawRange.start,l.drawRange.count=r.drawRange.count,!1;if(i.morphTargetInfluences){let L=!1;for(let U=0;U<i.morphTargetInfluences.length;U++)i.morphTargetInfluences[U]!==t.morphTargetInfluences[U]&&(L=!0);if(L)return!0}return i.center&&i.center.equals(t.center)===!1?(i.center.copy(t.center),!0):(e.bundle!==null&&(i.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const r=e.object.static===!0,i=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return r||i?!1:this.equals(e)!==!0}}const YUe=.05,Sge=un(([s])=>c4(Mi(1e4,xf(Mi(17,s.x).add(Mi(.1,s.y)))).mul(Wl(.1,Oh(xf(Mi(13,s.y).add(s.x))))))),wge=un(([s])=>Sge(In(Sge(s.xy),s.z))),KUe=un(([s])=>{const e=el(Og(R4e(s.xyz)),Og(I4e(s.xyz))),t=$t(1).div($t(YUe).mul(e)).toVar("pixScale"),n=In(FE(wv(Dg(t))),FE(DW(Dg(t)))),r=In(wge(wv(n.x.mul(s.xyz))),wge(wv(n.y.mul(s.xyz)))),i=c4(Dg(t)),o=Wl(Mi(i.oneMinus(),r.x),Mi(i,r.y)),l=ex(i,i.oneMinus()),h=Yt(o.mul(o).div(Mi(2,l).mul(Bl(1,l))),o.sub(Mi(.5,l)).div(Bl(1,l)),Bl(1,Bl(1,o).mul(Bl(1,o)).div(Mi(2,l).mul(Bl(1,l))))),p=o.lessThan(l.oneMinus()).select(o.lessThan(l).select(h.x,h.y),h.z);return Bg(p,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class ZUe extends H4e{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),n=e.hasGeometryAttribute(t);let r;return n===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new ki(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const QUe=(s=0)=>hn(new ZUe(s));class uo extends Du{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+t4e(this)}build(e){this.setup(e)}setupObserver(e){return new XUe(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,n=t.getRenderTarget();e.addStack();const r=this.setupVertex(e),i=this.vertexNode||r;e.stack.outputNode=i,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let o;const l=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(n!==null?n.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const h=this.setupLighting(e);l!==null&&e.stack.add(l);const p=Jr(h,Yi.a).max(0);o=this.setupOutput(e,p),mE.assign(o);const y=this.outputNode!==null;if(y&&(o=this.outputNode),n!==null){const x=t.getMRT(),S=this.mrtNode;x!==null?(y&&mE.assign(o),o=x,S!==null&&(o=x.merge(S))):S!==null&&(o=S)}}else{let h=this.fragmentNode;h.isOutputStructNode!==!0&&(h=Jr(h)),o=this.setupOutput(e,h)}e.stack.outputNode=o,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:n}=e.clippingContext;let r=null;if(t.length>0||n.length>0){const i=e.renderer.samples;this.alphaToCoverage&&i>1?r=WUe():e.stack.add(jUe())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add($Ue()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:n}=e;let r=this.depthNode;if(r===null){const i=t.getMRT();i&&i.has("depth")?r=i.get("depth"):t.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?r=n5e(lo.z,pv,mv):r=vE(lo.z,pv,mv))}r!==null&&i5e.assign(r).toStack()}setupPositionView(){return Gk.mul(Y0).xyz}setupModelViewProjection(){return HW.mul(lo)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),c5e}setupPosition(e){const{object:t,geometry:n}=e;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&BUe(t).toStack(),t.isSkinnedMesh===!0&&OUe(t).toStack(),this.displacementMap){const r=Y3("displacementMap","texture"),i=Y3("displacementScale","float"),o=Y3("displacementBias","float");Y0.addAssign(d1.normalize().mul(r.x.mul(i).add(o)))}return t.isBatchedMesh&&NUe(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&IUe(t).toStack(),this.positionNode!==null&&Y0.assign(BFe(this.positionNode,"POSITION")),Y0}setupDiffuseColor({object:e,geometry:t}){this.maskNode!==null&&AW(this.maskNode).not().discard();let n=this.colorNode?Jr(this.colorNode):ZLe;this.vertexColors===!0&&t.hasAttribute("color")&&(n=n.mul(QUe())),e.instanceColor&&(n=vk("vec3","vInstanceColor").mul(n)),e.isBatchedMesh&&e._colorsTexture&&(n=vk("vec3","vBatchColor").mul(n)),Yi.assign(n);const r=this.opacityNode?$t(this.opacityNode):l5e;Yi.a.assign(Yi.a.mul(r));let i=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(i=this.alphaTestNode!==null?$t(this.alphaTestNode):KLe,Yi.a.lessThanEqual(i).discard()),this.alphaHash===!0&&Yi.a.lessThan(KUe(Y0)).discard(),this.transparent===!1&&this.blending===Rg&&this.alphaToCoverage===!1?Yi.a.assign(1):i===null&&Yi.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Yt(0):Yi.rgb}setupNormal(){return this.normalNode?Yt(this.normalNode):iUe}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Y3("envMap","cubeTexture"):Y3("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new HUe(u5e)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),this.aoNode!==null||e.material.aoMap){const o=this.aoNode!==null?this.aoNode:MUe;t.push(new zUe(o))}let i=this.lightsNode||e.lightsNode;return t.length>0&&(i=e.renderer.lighting.createNode([...i.getLights(),...t])),i}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:r,emissiveNode:i}=this,l=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let h=this.setupOutgoingLight(e);if(l&&l.getScope().hasLights){const p=this.setupLightingModel(e)||null;h=GUe(l,p,n,r)}else n!==null&&(h=Yt(r!==null?ea(h,n,r):n));return(i&&i.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(oge.assign(Yt(i||JLe)),h=h.add(oge)),h}setupFog(e,t){const n=e.fogNode;return n&&(mE.assign(t),t=Jr(n)),t}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),t}setDefaultValues(e){for(const n in e){const r=e[n];this[n]===void 0&&(this[n]=r,r&&r.clone&&(this[n]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&t[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const n=Du.prototype.toJSON.call(this,e),r=pk(this);n.inputNodes={};for(const{property:o,childNode:l}of r)n.inputNodes[o]=l.toJSON(e).uuid;function i(o){const l=[];for(const h in o){const p=o[h];delete p.metadata,l.push(p)}return l}if(t){const o=i(e.textures),l=i(e.images),h=i(e.nodes);o.length>0&&(n.textures=o),l.length>0&&(n.images=l),h.length>0&&(n.nodes=h)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}let JUe=0;const Ih=new As,PV=new wo,q7=new vt,Mc=new qE,Rw=new qE,zo=new vt;class Hg extends kv{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:JUe++}),this.uuid=Ag(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(J3e(e)?s4e:i4e)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new Ou().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ih.makeRotationFromQuaternion(e),this.applyMatrix4(Ih),this}rotateX(e){return Ih.makeRotationX(e),this.applyMatrix4(Ih),this}rotateY(e){return Ih.makeRotationY(e),this.applyMatrix4(Ih),this}rotateZ(e){return Ih.makeRotationZ(e),this.applyMatrix4(Ih),this}translate(e,t,n){return Ih.makeTranslation(e,t,n),this.applyMatrix4(Ih),this}scale(e,t,n){return Ih.makeScale(e,t,n),this.applyMatrix4(Ih),this}lookAt(e){return PV.lookAt(e),PV.updateMatrix(),this.applyMatrix4(PV.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(q7).negate(),this.translate(q7.x,q7.y,q7.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,i=e.length;r<i;r++){const o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Hl(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const i=e[r];t.setXYZ(r,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new qE);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new vt(-1/0,-1/0,-1/0),new vt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const i=t[n];Mc.setFromBufferAttribute(i),this.morphTargetsRelative?(zo.addVectors(this.boundingBox.min,Mc.min),this.boundingBox.expandByPoint(zo),zo.addVectors(this.boundingBox.max,Mc.max),this.boundingBox.expandByPoint(zo)):(this.boundingBox.expandByPoint(Mc.min),this.boundingBox.expandByPoint(Mc.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new zk);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new vt,1/0);return}if(e){const n=this.boundingSphere.center;if(Mc.setFromBufferAttribute(e),t)for(let i=0,o=t.length;i<o;i++){const l=t[i];Rw.setFromBufferAttribute(l),this.morphTargetsRelative?(zo.addVectors(Mc.min,Rw.min),Mc.expandByPoint(zo),zo.addVectors(Mc.max,Rw.max),Mc.expandByPoint(zo)):(Mc.expandByPoint(Rw.min),Mc.expandByPoint(Rw.max))}Mc.getCenter(n);let r=0;for(let i=0,o=e.count;i<o;i++)zo.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(zo));if(t)for(let i=0,o=t.length;i<o;i++){const l=t[i],h=this.morphTargetsRelative;for(let p=0,y=l.count;p<y;p++)zo.fromBufferAttribute(l,p),h&&(q7.fromBufferAttribute(e,p),zo.add(q7)),r=Math.max(r,n.distanceToSquared(zo))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Vh(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),l=[],h=[];for(let Q=0;Q<n.count;Q++)l[Q]=new vt,h[Q]=new vt;const p=new vt,y=new vt,x=new vt,S=new mi,A=new mi,k=new mi,L=new vt,U=new vt;function P(Q,oe,le){p.fromBufferAttribute(n,Q),y.fromBufferAttribute(n,oe),x.fromBufferAttribute(n,le),S.fromBufferAttribute(i,Q),A.fromBufferAttribute(i,oe),k.fromBufferAttribute(i,le),y.sub(p),x.sub(p),A.sub(S),k.sub(S);const J=1/(A.x*k.y-k.x*A.y);isFinite(J)&&(L.copy(y).multiplyScalar(k.y).addScaledVector(x,-A.y).multiplyScalar(J),U.copy(x).multiplyScalar(A.x).addScaledVector(y,-k.x).multiplyScalar(J),l[Q].add(L),l[oe].add(L),l[le].add(L),h[Q].add(U),h[oe].add(U),h[le].add(U))}let $=this.groups;$.length===0&&($=[{start:0,count:e.count}]);for(let Q=0,oe=$.length;Q<oe;++Q){const le=$[Q],J=le.start,Be=le.count;for(let He=J,rt=J+Be;He<rt;He+=3)P(e.getX(He+0),e.getX(He+1),e.getX(He+2))}const Z=new vt,I=new vt,ie=new vt,ce=new vt;function ue(Q){ie.fromBufferAttribute(r,Q),ce.copy(ie);const oe=l[Q];Z.copy(oe),Z.sub(ie.multiplyScalar(ie.dot(oe))).normalize(),I.crossVectors(ce,oe);const J=I.dot(h[Q])<0?-1:1;o.setXYZW(Q,Z.x,Z.y,Z.z,J)}for(let Q=0,oe=$.length;Q<oe;++Q){const le=$[Q],J=le.start,Be=le.count;for(let He=J,rt=J+Be;He<rt;He+=3)ue(e.getX(He+0)),ue(e.getX(He+1)),ue(e.getX(He+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Vh(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let S=0,A=n.count;S<A;S++)n.setXYZ(S,0,0,0);const r=new vt,i=new vt,o=new vt,l=new vt,h=new vt,p=new vt,y=new vt,x=new vt;if(e)for(let S=0,A=e.count;S<A;S+=3){const k=e.getX(S+0),L=e.getX(S+1),U=e.getX(S+2);r.fromBufferAttribute(t,k),i.fromBufferAttribute(t,L),o.fromBufferAttribute(t,U),y.subVectors(o,i),x.subVectors(r,i),y.cross(x),l.fromBufferAttribute(n,k),h.fromBufferAttribute(n,L),p.fromBufferAttribute(n,U),l.add(y),h.add(y),p.add(y),n.setXYZ(k,l.x,l.y,l.z),n.setXYZ(L,h.x,h.y,h.z),n.setXYZ(U,p.x,p.y,p.z)}else for(let S=0,A=t.count;S<A;S+=3)r.fromBufferAttribute(t,S+0),i.fromBufferAttribute(t,S+1),o.fromBufferAttribute(t,S+2),y.subVectors(o,i),x.subVectors(r,i),y.cross(x),n.setXYZ(S+0,y.x,y.y,y.z),n.setXYZ(S+1,y.x,y.y,y.z),n.setXYZ(S+2,y.x,y.y,y.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)zo.fromBufferAttribute(e,t),zo.normalize(),e.setXYZ(t,zo.x,zo.y,zo.z)}toNonIndexed(){function e(l,h){const p=l.array,y=l.itemSize,x=l.normalized,S=new p.constructor(h.length*y);let A=0,k=0;for(let L=0,U=h.length;L<U;L++){l.isInterleavedBufferAttribute?A=h[L]*l.data.stride+l.offset:A=h[L]*y;for(let P=0;P<y;P++)S[k++]=p[A++]}return new Vh(S,y,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Hg,n=this.index.array,r=this.attributes;for(const l in r){const h=r[l],p=e(h,n);t.setAttribute(l,p)}const i=this.morphAttributes;for(const l in i){const h=[],p=i[l];for(let y=0,x=p.length;y<x;y++){const S=p[y],A=e(S,n);h.push(A)}t.morphAttributes[l]=h}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,h=o.length;l<h;l++){const p=o[l];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const p in h)h[p]!==void 0&&(e[p]=h[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const h in n){const p=n[h];e.data.attributes[h]=p.toJSON(e.data)}const r={};let i=!1;for(const h in this.morphAttributes){const p=this.morphAttributes[h],y=[];for(let x=0,S=p.length;x<S;x++){const A=p[x];y.push(A.toJSON(e.data))}y.length>0&&(r[h]=y,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere=l.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const y=r[p];this.setAttribute(p,y.clone(t))}const i=e.morphAttributes;for(const p in i){const y=[],x=i[p];for(let S=0,A=x.length;S<A;S++)y.push(x[S].clone(t));this.morphAttributes[p]=y}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let p=0,y=o.length;p<y;p++){const x=o[p];this.addGroup(x.start,x.count,x.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const vg=new vt,RV=new vt,HR=new vt,O3=new vt,IV=new vt,jR=new vt,kV=new vt;class eBe{constructor(e=new vt,t=new vt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,vg)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=vg.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(vg.copy(this.origin).addScaledVector(this.direction,t),vg.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){RV.copy(e).add(t).multiplyScalar(.5),HR.copy(t).sub(e).normalize(),O3.copy(this.origin).sub(RV);const i=e.distanceTo(t)*.5,o=-this.direction.dot(HR),l=O3.dot(this.direction),h=-O3.dot(HR),p=O3.lengthSq(),y=Math.abs(1-o*o);let x,S,A,k;if(y>0)if(x=o*h-l,S=o*l-h,k=i*y,x>=0)if(S>=-k)if(S<=k){const L=1/y;x*=L,S*=L,A=x*(x+o*S+2*l)+S*(o*x+S+2*h)+p}else S=i,x=Math.max(0,-(o*S+l)),A=-x*x+S*(S+2*h)+p;else S=-i,x=Math.max(0,-(o*S+l)),A=-x*x+S*(S+2*h)+p;else S<=-k?(x=Math.max(0,-(-o*i+l)),S=x>0?-i:Math.min(Math.max(-i,-h),i),A=-x*x+S*(S+2*h)+p):S<=k?(x=0,S=Math.min(Math.max(-i,-h),i),A=S*(S+2*h)+p):(x=Math.max(0,-(o*i+l)),S=x>0?i:Math.min(Math.max(-i,-h),i),A=-x*x+S*(S+2*h)+p);else S=o>0?-i:i,x=Math.max(0,-(o*S+l)),A=-x*x+S*(S+2*h)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(RV).addScaledVector(HR,S),A}intersectSphere(e,t){vg.subVectors(e.center,this.origin);const n=vg.dot(this.direction),r=vg.dot(vg)-n*n,i=e.radius*e.radius;if(r>i)return null;const o=Math.sqrt(i-r),l=n-o,h=n+o;return h<0?null:l<0?this.at(h,t):this.at(l,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,o,l,h;const p=1/this.direction.x,y=1/this.direction.y,x=1/this.direction.z,S=this.origin;return p>=0?(n=(e.min.x-S.x)*p,r=(e.max.x-S.x)*p):(n=(e.max.x-S.x)*p,r=(e.min.x-S.x)*p),y>=0?(i=(e.min.y-S.y)*y,o=(e.max.y-S.y)*y):(i=(e.max.y-S.y)*y,o=(e.min.y-S.y)*y),n>o||i>r||((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),x>=0?(l=(e.min.z-S.z)*x,h=(e.max.z-S.z)*x):(l=(e.max.z-S.z)*x,h=(e.min.z-S.z)*x),n>h||l>r)||((l>n||n!==n)&&(n=l),(h<r||r!==r)&&(r=h),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,vg)!==null}intersectTriangle(e,t,n,r,i){IV.subVectors(t,e),jR.subVectors(n,e),kV.crossVectors(IV,jR);let o=this.direction.dot(kV),l;if(o>0){if(r)return null;l=1}else if(o<0)l=-1,o=-o;else return null;O3.subVectors(this.origin,e);const h=l*this.direction.dot(jR.crossVectors(O3,jR));if(h<0)return null;const p=l*this.direction.dot(IV.cross(O3));if(p<0||h+p>o)return null;const y=-l*O3.dot(kV);return y<0?null:this.at(y/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}const df=new vt,yg=new vt,NV=new vt,_g=new vt,X7=new vt,Y7=new vt,Ege=new vt,DV=new vt,OV=new vt,FV=new vt,LV=new ki,UV=new ki,BV=new ki;class Ef{constructor(e=new vt,t=new vt,n=new vt){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),df.subVectors(e,t),r.cross(df);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){df.subVectors(r,t),yg.subVectors(n,t),NV.subVectors(e,t);const o=df.dot(df),l=df.dot(yg),h=df.dot(NV),p=yg.dot(yg),y=yg.dot(NV),x=o*p-l*l;if(x===0)return i.set(0,0,0),null;const S=1/x,A=(p*h-l*y)*S,k=(o*y-l*h)*S;return i.set(1-A-k,k,A)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,_g)===null?!1:_g.x>=0&&_g.y>=0&&_g.x+_g.y<=1}static getInterpolation(e,t,n,r,i,o,l,h){return this.getBarycoord(e,t,n,r,_g)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(i,_g.x),h.addScaledVector(o,_g.y),h.addScaledVector(l,_g.z),h)}static getInterpolatedAttribute(e,t,n,r,i,o){return LV.setScalar(0),UV.setScalar(0),BV.setScalar(0),LV.fromBufferAttribute(e,t),UV.fromBufferAttribute(e,n),BV.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(LV,i.x),o.addScaledVector(UV,i.y),o.addScaledVector(BV,i.z),o}static isFrontFacing(e,t,n,r){return df.subVectors(n,t),yg.subVectors(e,t),df.cross(yg).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return df.subVectors(this.c,this.b),yg.subVectors(this.a,this.b),df.cross(yg).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ef.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ef.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return Ef.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Ef.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ef.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let o,l;X7.subVectors(r,n),Y7.subVectors(i,n),DV.subVectors(e,n);const h=X7.dot(DV),p=Y7.dot(DV);if(h<=0&&p<=0)return t.copy(n);OV.subVectors(e,r);const y=X7.dot(OV),x=Y7.dot(OV);if(y>=0&&x<=y)return t.copy(r);const S=h*x-y*p;if(S<=0&&h>=0&&y<=0)return o=h/(h-y),t.copy(n).addScaledVector(X7,o);FV.subVectors(e,i);const A=X7.dot(FV),k=Y7.dot(FV);if(k>=0&&A<=k)return t.copy(i);const L=A*p-h*k;if(L<=0&&p>=0&&k<=0)return l=p/(p-k),t.copy(n).addScaledVector(Y7,l);const U=y*k-A*x;if(U<=0&&x-y>=0&&A-k>=0)return Ege.subVectors(i,r),l=(x-y)/(x-y+(A-k)),t.copy(r).addScaledVector(Ege,l);const P=1/(U+L+S);return o=L*P,l=S*P,t.copy(n).addScaledVector(X7,o).addScaledVector(Y7,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}class K3 extends Du{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ki(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jh,this.combine=Nk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Tge=new As,K8=new eBe,WR=new zk,Mge=new vt,$R=new vt,qR=new vt,XR=new vt,zV=new vt,YR=new vt,Cge=new vt,KR=new vt;class zg extends wo{constructor(e=new Hg,t=new K3){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=r.length;i<o;i++){const l=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=i}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const l=this.morphTargetInfluences;if(i&&l){YR.set(0,0,0);for(let h=0,p=i.length;h<p;h++){const y=l[h],x=i[h];y!==0&&(zV.fromBufferAttribute(x,e),o?YR.addScaledVector(zV,y):YR.addScaledVector(zV.sub(t),y))}t.add(YR)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),WR.copy(n.boundingSphere),WR.applyMatrix4(i),K8.copy(e.ray).recast(e.near),!(WR.containsPoint(K8.origin)===!1&&(K8.intersectSphere(WR,Mge)===null||K8.origin.distanceToSquared(Mge)>(e.far-e.near)**2))&&(Tge.copy(i).invert(),K8.copy(e.ray).applyMatrix4(Tge),!(n.boundingBox!==null&&K8.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,K8)))}_computeIntersections(e,t,n){let r;const i=this.geometry,o=this.material,l=i.index,h=i.attributes.position,p=i.attributes.uv,y=i.attributes.uv1,x=i.attributes.normal,S=i.groups,A=i.drawRange;if(l!==null)if(Array.isArray(o))for(let k=0,L=S.length;k<L;k++){const U=S[k],P=o[U.materialIndex],$=Math.max(U.start,A.start),Z=Math.min(l.count,Math.min(U.start+U.count,A.start+A.count));for(let I=$,ie=Z;I<ie;I+=3){const ce=l.getX(I),ue=l.getX(I+1),Q=l.getX(I+2);r=ZR(this,P,e,n,p,y,x,ce,ue,Q),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const k=Math.max(0,A.start),L=Math.min(l.count,A.start+A.count);for(let U=k,P=L;U<P;U+=3){const $=l.getX(U),Z=l.getX(U+1),I=l.getX(U+2);r=ZR(this,o,e,n,p,y,x,$,Z,I),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}else if(h!==void 0)if(Array.isArray(o))for(let k=0,L=S.length;k<L;k++){const U=S[k],P=o[U.materialIndex],$=Math.max(U.start,A.start),Z=Math.min(h.count,Math.min(U.start+U.count,A.start+A.count));for(let I=$,ie=Z;I<ie;I+=3){const ce=I,ue=I+1,Q=I+2;r=ZR(this,P,e,n,p,y,x,ce,ue,Q),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const k=Math.max(0,A.start),L=Math.min(h.count,A.start+A.count);for(let U=k,P=L;U<P;U+=3){const $=U,Z=U+1,I=U+2;r=ZR(this,o,e,n,p,y,x,$,Z,I),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}}}function tBe(s,e,t,n,r,i,o,l){let h;if(e.side===Nu?h=n.intersectTriangle(o,i,r,!0,l):h=n.intersectTriangle(r,i,o,e.side===Pg,l),h===null)return null;KR.copy(l),KR.applyMatrix4(s.matrixWorld);const p=t.ray.origin.distanceTo(KR);return p<t.near||p>t.far?null:{distance:p,point:KR.clone(),object:s}}function ZR(s,e,t,n,r,i,o,l,h,p){s.getVertexPosition(l,$R),s.getVertexPosition(h,qR),s.getVertexPosition(p,XR);const y=tBe(s,e,t,n,$R,qR,XR,Cge);if(y){const x=new vt;Ef.getBarycoord(Cge,$R,qR,XR,x),r&&(y.uv=Ef.getInterpolatedAttribute(r,l,h,p,x,new mi)),i&&(y.uv1=Ef.getInterpolatedAttribute(i,l,h,p,x,new mi)),o&&(y.normal=Ef.getInterpolatedAttribute(o,l,h,p,x,new vt),y.normal.dot(n.direction)>0&&y.normal.multiplyScalar(-1));const S={a:l,b:h,c:p,normal:new vt,materialIndex:0};Ef.getNormal($R,qR,XR,S.normal),y.face=S,y.barycoord=x}return y}class XW extends bW{constructor(e=-1,t=1,n=1,r=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,o=n+e,l=r+t,h=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=p*this.view.offsetX,o=i+p*this.view.width,l-=y*this.view.offsetY,h=l-y*this.view.height}this.projectionMatrix.makeOrthographic(i,o,l,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const VV=new XW(-1,1,1,-1,0,1);class nBe extends Hg{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Hl([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Hl(t,2))}}const rBe=new nBe;class YW extends zg{constructor(e=null){super(rBe,e),this.camera=VV,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,VV)}render(e){e.render(this,VV)}}const qk=1/6,h5e=s=>Mi(qk,Mi(s,Mi(s,s.negate().add(3)).sub(3)).add(1)),hj=s=>Mi(qk,Mi(s,Mi(s,Mi(3,s).sub(6))).add(4)),d5e=s=>Mi(qk,Mi(s,Mi(s,Mi(-3,s).add(3)).add(3)).add(1)),dj=s=>Mi(qk,Bk(s,3)),Age=s=>h5e(s).add(hj(s)),Pge=s=>d5e(s).add(dj(s)),Rge=s=>Wl(-1,hj(s).div(h5e(s).add(hj(s)))),Ige=s=>Wl(1,dj(s).div(d5e(s).add(dj(s)))),kge=(s,e,t)=>{const n=s.uvNode,r=Mi(n,e.zw).add(.5),i=wv(r),o=c4(r),l=Age(o.x),h=Pge(o.x),p=Rge(o.x),y=Ige(o.x),x=Rge(o.y),S=Ige(o.y),A=In(i.x.add(p),i.y.add(x)).sub(.5).mul(e.xy),k=In(i.x.add(y),i.y.add(x)).sub(.5).mul(e.xy),L=In(i.x.add(p),i.y.add(S)).sub(.5).mul(e.xy),U=In(i.x.add(y),i.y.add(S)).sub(.5).mul(e.xy),P=Age(o.y).mul(Wl(l.mul(s.sample(A).level(t)),h.mul(s.sample(k).level(t)))),$=Pge(o.y).mul(Wl(l.mul(s.sample(L).level(t)),h.mul(s.sample(U).level(t))));return P.add($)},iBe=un(([s,e=$t(3)])=>{const t=In(s.size(Bs(e))),n=In(s.size(Bs(e.add(1)))),r=h1(1,t),i=h1(1,n),o=kge(s,Jr(r,t),wv(e)),l=kge(s,Jr(i,n),DW(e));return c4(e).mix(o,l)}),Iw=new jh,GV=new As;class ku extends ti{static get type(){return"SceneNode"}constructor(e=ku.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=this.scene!==null?this.scene:e.scene;let r;return t===ku.BACKGROUND_BLURRINESS?r=Cs("backgroundBlurriness","float",n):t===ku.BACKGROUND_INTENSITY?r=Cs("backgroundIntensity","float",n):t===ku.BACKGROUND_ROTATION?r=Vr("mat4").label("backgroundRotation").setGroup(zr).onRenderUpdate(()=>{const i=n.background;return i!==null&&i.isTexture&&i.mapping!==cW?(Iw.copy(n.backgroundRotation),Iw.x*=-1,Iw.y*=-1,Iw.z*=-1,GV.makeRotationFromEuler(Iw)):GV.identity(),GV}):console.error("THREE.SceneNode: Unknown scope:",t),r}}ku.BACKGROUND_BLURRINESS="backgroundBlurriness";ku.BACKGROUND_INTENSITY="backgroundIntensity";ku.BACKGROUND_ROTATION="backgroundRotation";const sBe=Rn(ku,ku.BACKGROUND_BLURRINESS),Nge=Rn(ku,ku.BACKGROUND_INTENSITY),aBe=Rn(ku,ku.BACKGROUND_ROTATION),oBe=un(({texture:s,uv:e})=>{const n=Yt().toVar();return Xa(e.x.lessThan(1e-4),()=>{n.assign(Yt(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{n.assign(Yt(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{n.assign(Yt(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{n.assign(Yt(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{n.assign(Yt(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{n.assign(Yt(0,0,-1))}).Else(()=>{const i=s.sample(e.add(Yt(-.01,0,0))).r.sub(s.sample(e.add(Yt(.01,0,0))).r),o=s.sample(e.add(Yt(0,-.01,0))).r.sub(s.sample(e.add(Yt(0,.01,0))).r),l=s.sample(e.add(Yt(0,0,-.01))).r.sub(s.sample(e.add(Yt(0,0,.01))).r);n.assign(Yt(i,o,l))}),n.normalize()});class lBe extends fx{static get type(){return"Texture3DNode"}constructor(e,t=null,n=null){super(e,t,n),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Yt(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(Bs(L_(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}normal(e){return oBe({texture:this,uv:e})}}const uBe=cn(lBe).setParameterLength(1,3),QR=new mi;class cBe extends fx{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class Dge extends cBe{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class Xk extends co{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const i=new u1;i.isRenderTargetTexture=!0,i.name="depth";const o=new Nv(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Uh,...r});o.texture.name="output",o.depthTexture=i,this.renderTarget=o,this._textures={output:o.texture,depth:i},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=Vr(0),this._cameraFar=Vr(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=_i.FRAME,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=hn(new Dge(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=hn(new Dge(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=t5e(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=vE(i,n,r)}return t}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.texture.type=e.getColorBufferType(),this.scope===Xk.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let r,i;const o=t.getOutputRenderTarget();o&&o.isXRRenderTarget===!0?(i=1,r=t.xr.getCamera(),t.xr.updateCamera(r),QR.set(o.width,o.height)):(r=this.camera,i=t.getPixelRatio(),t.getSize(QR)),this._pixelRatio=i,this.setSize(QR.width,QR.height);const l=t.getRenderTarget(),h=t.getMRT(),p=r.layers.mask;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const y in this._previousTextures)this.toggleTexture(y);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(n,r),t.setRenderTarget(l),t.setMRT(h),r.layers.mask=p}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}Xk.COLOR="color";Xk.DEPTH="depth";const hBe=un(([s,e])=>s.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),dBe=un(([s,e])=>(s=s.mul(e),s.div(s.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),fBe=un(([s,e])=>{s=s.mul(e),s=s.sub(.004).max(0);const t=s.mul(s.mul(6.2).add(.5)),n=s.mul(s.mul(6.2).add(1.7)).add(.06);return t.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),pBe=un(([s])=>{const e=s.mul(s.add(.0245786)).sub(90537e-9),t=s.mul(s.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),mBe=un(([s,e])=>{const t=jl(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=jl(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return s=s.mul(e).div(.6),s=t.mul(s),s=pBe(s),s=n.mul(s),s.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),gBe=jl(Yt(1.6605,-.1246,-.0182),Yt(-.5876,1.1329,-.1006),Yt(-.0728,-.0083,1.1187)),vBe=jl(Yt(.6274,.0691,.0164),Yt(.3293,.9195,.088),Yt(.0433,.0113,.8956)),yBe=un(([s])=>{const e=Yt(s).toVar(),t=Yt(e.mul(e)).toVar(),n=Yt(t.mul(t)).toVar();return $t(15.5).mul(n.mul(t)).sub(Mi(40.14,n.mul(e))).add(Mi(31.96,n).sub(Mi(6.868,t.mul(e))).add(Mi(.4298,t).add(Mi(.1191,e).sub(.00232))))}),_Be=un(([s,e])=>{const t=Yt(s).toVar(),n=jl(Yt(.856627153315983,.137318972929847,.11189821299995),Yt(.0951212405381588,.761241990602591,.0767994186031903),Yt(.0482516061458583,.101439036467562,.811302368396859)),r=jl(Yt(1.1271005818144368,-.1413297634984383,-.14132976349843826),Yt(-.11060664309660323,1.157823702216272,-.11060664309660294),Yt(-.016493938717834573,-.016493938717834257,1.2519364065950405)),i=$t(-12.47393),o=$t(4.026069);return t.mulAssign(e),t.assign(vBe.mul(t)),t.assign(n.mul(t)),t.assign(el(t,1e-10)),t.assign(Dg(t)),t.assign(t.sub(i).div(o.sub(i))),t.assign(Bg(t,0,1)),t.assign(yBe(t)),t.assign(r.mul(t)),t.assign(Bk(el(Yt(0),t),Yt(2.2))),t.assign(gBe.mul(t)),t.assign(Bg(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),xBe=un(([s,e])=>{const t=$t(.76),n=$t(.15);s=s.mul(e);const r=ex(s.r,ex(s.g,s.b)),i=Z0(r.lessThan(.08),r.sub(Mi(6.25,r.mul(r))),.04);s.subAssign(i);const o=el(s.r,el(s.g,s.b));Xa(o.lessThan(t),()=>s);const l=Bl(1,t),h=Bl(1,l.mul(l).div(o.add(l.sub(t))));s.mulAssign(h.div(o));const p=Bl(1,h1(1,n.mul(o.sub(h)).add(1)));return ea(s,Yt(h),p)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class bo extends ti{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class bBe extends bo{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),r=n.name,i=n.type,o=e.getCodeFromNode(this,i);r!==""&&(o.name=r);const l=e.getPropertyName(o),h=this.getNodeFunction(e).getCode(l);return o.code=h+`
`,t==="property"?l:e.format(`${l}()`,i,t)}}function f5e(s){let e;const t=s.context.getViewZ;return t!==void 0&&(e=t(this)),(e||lo.z).negate()}const SBe=un(([s,e],t)=>{const n=f5e(t);return s4(s,e,n)}),wBe=un(([s],e)=>{const t=f5e(e);return s.mul(s,t,t).negate().exp().oneMinus()}),Oge=un(([s,e])=>Jr(e.toFloat().mix(mE.rgb,s.toVec3()),mE.a));class EBe extends ti{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}cn(EBe);class p1 extends ti{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,r=this.method,i=this.getNodeType(e),o=this.getInputType(e),l=this.pointerNode,h=this.valueNode,p=[];p.push(`&${l.build(e,o)}`),h!==null&&p.push(h.build(e,o));const y=`${e.getMethod(r,i)}( ${p.join(", ")} )`;if(n.length===1&&n[0].isStackNode===!0)e.addLineFlowCode(y,this);else return t.constNode===void 0&&(t.constNode=tx(y,i).toConst()),t.constNode.build(e)}}p1.ATOMIC_LOAD="atomicLoad";p1.ATOMIC_STORE="atomicStore";p1.ATOMIC_ADD="atomicAdd";p1.ATOMIC_SUB="atomicSub";p1.ATOMIC_MAX="atomicMax";p1.ATOMIC_MIN="atomicMin";p1.ATOMIC_AND="atomicAnd";p1.ATOMIC_OR="atomicOr";p1.ATOMIC_XOR="atomicXor";cn(p1);let JR;function Yk(s){JR=JR||new WeakMap;let e=JR.get(s);return e===void 0&&JR.set(s,e={}),e}function p5e(s){const e=Yk(s);return e.shadowMatrix||(e.shadowMatrix=Vr("mat4").setGroup(zr).onRenderUpdate(t=>((s.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&s.shadow.updateMatrices(s),s.shadow.matrix)))}function TBe(s,e=UE){const t=p5e(s).mul(e);return t.xyz.div(t.w)}function m5e(s){const e=Yk(s);return e.position||(e.position=Vr(new vt).setGroup(zr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(s.matrixWorld)))}function MBe(s){const e=Yk(s);return e.targetPosition||(e.targetPosition=Vr(new vt).setGroup(zr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(s.target.matrixWorld)))}function g5e(s){const e=Yk(s);return e.viewPosition||(e.viewPosition=Vr(new vt).setGroup(zr).onRenderUpdate(({camera:t},n)=>{n.value=n.value||new vt,n.value.setFromMatrixPosition(s.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)}))}const v5e=s=>Gg.transformDirection(m5e(s).sub(MBe(s))),CBe=s=>s.sort((e,t)=>e.id-t.id),ABe=(s,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===s)return t;return null},HV=new WeakMap,kw=[];class y5e extends ti{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Yt().toVar(),this.totalSpecularNode=Yt().toVar(),this.outgoingLightNode=Yt().toVar(),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let n=0;n<e.length;n++){const r=e[n];if(kw.push(r.id),kw.push(r.castShadow?1:0),r.isSpotLight===!0){const i=r.map!==null?r.map.id:-1,o=r.colorNode?r.colorNode.getCacheKey():-1;kw.push(i,o)}}const t=_W(kw);return kw.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const n of this._lightNodes)t.push(n.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const n of t.nodes)n.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,r=CBe(this._lights),i=e.renderer.library;for(const o of r)if(o.isNode)t.push(hn(o));else{let l=null;if(n!==null&&(l=ABe(o.id,n)),l===null){const h=i.getLightNodeClass(o.constructor);if(h===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${o.constructor.name}`);continue}let p=null;HV.has(o)?p=HV.get(o):(p=hn(new h(o)),HV.set(o,p)),t.push(p)}}this._lightNodes=t}setupDirectLight(e,t,n){const{lightingModel:r,reflectedLight:i}=e.context;r.direct({...n,lightNode:t,reflectedLight:i},e)}setupDirectRectAreaLight(e,t,n){const{lightingModel:r,reflectedLight:i}=e.context;r.directRectArea({...n,lightNode:t,reflectedLight:i},e)}setupLights(e,t){for(const n of t)n.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let n=this.outgoingLightNode;const r=e.context,i=r.lightingModel,o=e.getNodeProperties(this);if(i){const{totalDiffuseNode:l,totalSpecularNode:h}=this;r.outgoingLight=n;const p=e.addStack();o.nodes=p.nodes,i.start(e);const{backdrop:y,backdropAlpha:x}=r,{directDiffuse:S,directSpecular:A,indirectDiffuse:k,indirectSpecular:L}=r.reflectedLight;let U=S.add(k);y!==null&&(x!==null?U=Yt(x.mix(U,y)):U=Yt(y),r.material.transparent=!0),l.assign(U),h.assign(A.add(L)),n.assign(l.add(h)),i.finish(e),n=n.bypass(e.removeStack())}else o.nodes=[];return e.lightsNode=t,n}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class PBe extends ti{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=_i.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){_5e.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||UE)}}const _5e=y4e("vec3","shadowPositionWorld");function RBe(s,e={}){return e.toneMapping=s.toneMapping,e.toneMappingExposure=s.toneMappingExposure,e.outputColorSpace=s.outputColorSpace,e.renderTarget=s.getRenderTarget(),e.activeCubeFace=s.getActiveCubeFace(),e.activeMipmapLevel=s.getActiveMipmapLevel(),e.renderObjectFunction=s.getRenderObjectFunction(),e.pixelRatio=s.getPixelRatio(),e.mrt=s.getMRT(),e.clearColor=s.getClearColor(e.clearColor||new Ki),e.clearAlpha=s.getClearAlpha(),e.autoClear=s.autoClear,e.scissorTest=s.getScissorTest(),e}function IBe(s,e){return e=RBe(s,e),s.setMRT(null),s.setRenderObjectFunction(null),s.setClearColor(0,1),s.autoClear=!0,e}function kBe(s,e){s.toneMapping=e.toneMapping,s.toneMappingExposure=e.toneMappingExposure,s.outputColorSpace=e.outputColorSpace,s.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),s.setRenderObjectFunction(e.renderObjectFunction),s.setPixelRatio(e.pixelRatio),s.setMRT(e.mrt),s.setClearColor(e.clearColor,e.clearAlpha),s.autoClear=e.autoClear,s.setScissorTest(e.scissorTest)}function NBe(s,e={}){return e.background=s.background,e.backgroundNode=s.backgroundNode,e.overrideMaterial=s.overrideMaterial,e}function DBe(s,e){return e=NBe(s,e),s.background=null,s.backgroundNode=null,s.overrideMaterial=null,e}function OBe(s,e){s.background=e.background,s.backgroundNode=e.backgroundNode,s.overrideMaterial=e.overrideMaterial}function FBe(s,e,t){return t=IBe(s,t),t=DBe(e,t),t}function LBe(s,e,t){kBe(s,t),OBe(e,t)}const Fge=new WeakMap,UBe=un(({depthTexture:s,shadowCoord:e,depthLayer:t})=>{let n=Hi(s,e.xy).label("t_basic");return s.isArrayTexture&&(n=n.depth(t)),n.compare(e.z)}),BBe=un(({depthTexture:s,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(U,P)=>{let $=Hi(s,U);return s.isArrayTexture&&($=$.depth(n)),$.compare(P)},i=Cs("mapSize","vec2",t).setGroup(zr),o=Cs("radius","float",t).setGroup(zr),l=In(1).div(i),h=l.x.negate().mul(o),p=l.y.negate().mul(o),y=l.x.mul(o),x=l.y.mul(o),S=h.div(2),A=p.div(2),k=y.div(2),L=x.div(2);return Wl(r(e.xy.add(In(h,p)),e.z),r(e.xy.add(In(0,p)),e.z),r(e.xy.add(In(y,p)),e.z),r(e.xy.add(In(S,A)),e.z),r(e.xy.add(In(0,A)),e.z),r(e.xy.add(In(k,A)),e.z),r(e.xy.add(In(h,0)),e.z),r(e.xy.add(In(S,0)),e.z),r(e.xy,e.z),r(e.xy.add(In(k,0)),e.z),r(e.xy.add(In(y,0)),e.z),r(e.xy.add(In(S,L)),e.z),r(e.xy.add(In(0,L)),e.z),r(e.xy.add(In(k,L)),e.z),r(e.xy.add(In(h,x)),e.z),r(e.xy.add(In(0,x)),e.z),r(e.xy.add(In(y,x)),e.z)).mul(1/17)}),zBe=un(({depthTexture:s,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(x,S)=>{let A=Hi(s,x);return s.isArrayTexture&&(A=A.depth(n)),A.compare(S)},i=Cs("mapSize","vec2",t).setGroup(zr),o=In(1).div(i),l=o.x,h=o.y,p=e.xy,y=c4(p.mul(i).add(.5));return p.subAssign(y.mul(o)),Wl(r(p,e.z),r(p.add(In(l,0)),e.z),r(p.add(In(0,h)),e.z),r(p.add(o),e.z),ea(r(p.add(In(l.negate(),0)),e.z),r(p.add(In(l.mul(2),0)),e.z),y.x),ea(r(p.add(In(l.negate(),h)),e.z),r(p.add(In(l.mul(2),h)),e.z),y.x),ea(r(p.add(In(0,h.negate())),e.z),r(p.add(In(0,h.mul(2))),e.z),y.y),ea(r(p.add(In(l,h.negate())),e.z),r(p.add(In(l,h.mul(2))),e.z),y.y),ea(ea(r(p.add(In(l.negate(),h.negate())),e.z),r(p.add(In(l.mul(2),h.negate())),e.z),y.x),ea(r(p.add(In(l.negate(),h.mul(2))),e.z),r(p.add(In(l.mul(2),h.mul(2))),e.z),y.x),y.y)).mul(1/9)}),VBe=un(({depthTexture:s,shadowCoord:e,depthLayer:t})=>{const n=$t(1).toVar();let r=Hi(s).sample(e.xy);s.isArrayTexture&&(r=r.depth(t)),r=r.rg;const i=k4e(e.z,r.x);return Xa(i.notEqual($t(1)),()=>{const o=e.z.sub(r.x),l=el(0,r.y.mul(r.y));let h=l.div(l.add(o.mul(o)));h=Bg(Bl(h,.3).div(.95-.3)),n.assign(Bg(el(i,h)))}),n}),GBe=un(([s,e,t])=>{let n=UE.sub(s).length();return n=n.sub(e).div(t.sub(e)),n=n.saturate(),n}),HBe=s=>{const e=s.shadow.camera,t=Cs("near","float",e).setGroup(zr),n=Cs("far","float",e).setGroup(zr),r=nLe(s);return GBe(r,t,n)},jBe=s=>{let e=Fge.get(s);if(e===void 0){const t=s.isPointLight?HBe(s):null;e=new uo,e.colorNode=Jr(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,Fge.set(s,e)}return e},Lge=new Tf,K7=[],WBe=(s,e,t,n)=>{K7[0]=s,K7[1]=e;let r=Lge.get(K7);return(r===void 0||r.shadowType!==t||r.useVelocity!==n)&&(r=(i,o,l,h,p,y,...x)=>{(i.castShadow===!0||i.receiveShadow&&t===DI)&&(n&&(r4e(i).useVelocity=!0),i.onBeforeShadow(s,i,l,e.camera,h,o.overrideMaterial,y),s.renderObject(i,o,l,h,p,y,...x),i.onAfterShadow(s,i,l,e.camera,h,o.overrideMaterial,y))},r.shadowType=t,r.useVelocity=n,Lge.set(K7,r)),K7[0]=null,K7[1]=null,r},$Be=un(({samples:s,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const i=$t(0).toVar("meanVertical"),o=$t(0).toVar("squareMeanVertical"),l=s.lessThanEqual($t(1)).select($t(0),$t(2).div(s.sub(1))),h=s.lessThanEqual($t(1)).select($t(0),$t(-1));wf({start:Bs(0),end:Bs(s),type:"int",condition:"<"},({i:y})=>{const x=h.add($t(y).mul(l));let S=n.sample(Wl(Wk.xy,In(0,x).mul(e)).div(t));n.value.isArrayTexture&&(S=S.depth(r)),S=S.x,i.addAssign(S),o.addAssign(S.mul(S))}),i.divAssign(s),o.divAssign(s);const p=NW(o.sub(i.mul(i)));return In(i,p)}),qBe=un(({samples:s,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const i=$t(0).toVar("meanHorizontal"),o=$t(0).toVar("squareMeanHorizontal"),l=s.lessThanEqual($t(1)).select($t(0),$t(2).div(s.sub(1))),h=s.lessThanEqual($t(1)).select($t(0),$t(-1));wf({start:Bs(0),end:Bs(s),type:"int",condition:"<"},({i:y})=>{const x=h.add($t(y).mul(l));let S=n.sample(Wl(Wk.xy,In(x,0).mul(e)).div(t));n.value.isArrayTexture&&(S=S.depth(r)),i.addAssign(S.x),o.addAssign(Wl(S.y.mul(S.y),S.x.mul(S.x)))}),i.divAssign(s),o.divAssign(s);const p=NW(o.sub(i.mul(i)));return In(i,p)}),XBe=[UBe,BBe,zBe,VBe];let jV;const eI=new YW;class x5e extends PBe{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:i,depthLayer:o}){const l=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),h=t({depthTexture:n,shadowCoord:r,shadow:i,depthLayer:o});return l.select(h,$t(1))}setupShadowCoord(e,t){const{shadow:n}=this,{renderer:r}=e,i=Cs("bias","float",n).setGroup(zr);let o=t,l;if(n.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)o=o.xyz.div(o.w),l=o.z,r.coordinateSystem===i4&&(l=l.mul(2).sub(1));else{const h=o.w;o=o.xy.div(h);const p=Cs("near","float",n.camera).setGroup(zr),y=Cs("far","float",n.camera).setGroup(zr);l=n5e(h.negate(),p,y)}return o=Yt(o.x,o.y.oneMinus(),l.add(i)),o}getShadowFilterFn(e){return XBe[e]}setupRenderTarget(e,t){const n=new u1(e.mapSize.width,e.mapSize.height);n.name="ShadowDepthTexture",n.compareFunction=yW;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=n,{shadowMap:r,depthTexture:n}}setupShadow(e){const{renderer:t}=e,{light:n,shadow:r}=this,i=t.shadowMap.type,{depthTexture:o,shadowMap:l}=this.setupRenderTarget(r,e);if(r.camera.updateProjectionMatrix(),i===DI&&r.isPointLightShadow!==!0){o.compareFunction=null,l.depth>1?(l._vsmShadowMapVertical||(l._vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:bv,type:Uh,depth:l.depth,depthBuffer:!1}),l._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=l._vsmShadowMapVertical,l._vsmShadowMapHorizontal||(l._vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:bv,type:Uh,depth:l.depth,depthBuffer:!1}),l._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=l._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:bv,type:Uh,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:bv,type:Uh,depthBuffer:!1}));let P=Hi(o);o.isArrayTexture&&(P=P.depth(this.depthLayer));let $=Hi(this.vsmShadowMapVertical.texture);o.isArrayTexture&&($=$.depth(this.depthLayer));const Z=Cs("blurSamples","float",r).setGroup(zr),I=Cs("radius","float",r).setGroup(zr),ie=Cs("mapSize","vec2",r).setGroup(zr);let ce=this.vsmMaterialVertical||(this.vsmMaterialVertical=new uo);ce.fragmentNode=$Be({samples:Z,radius:I,size:ie,shadowPass:P,depthLayer:this.depthLayer}).context(e.getSharedContext()),ce.name="VSMVertical",ce=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new uo),ce.fragmentNode=qBe({samples:Z,radius:I,size:ie,shadowPass:$,depthLayer:this.depthLayer}).context(e.getSharedContext()),ce.name="VSMHorizontal"}const h=Cs("intensity","float",r).setGroup(zr),p=Cs("normalBias","float",r).setGroup(zr),y=p5e(n).mul(_5e.add(WW.mul(p))),x=this.setupShadowCoord(e,y),S=r.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(S===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const A=i===DI&&r.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:o,k=this.setupShadowFilter(e,{filterFn:S,shadowTexture:l.texture,depthTexture:A,shadowCoord:x,shadow:r,depthLayer:this.depthLayer});let L=Hi(l.texture,x);o.isArrayTexture&&(L=L.depth(this.depthLayer));const U=ea(1,k.rgb.mix(L,1),h.mul(L.a)).toVar();return this.shadowMap=l,this.shadow.map=l,U}setup(e){if(e.renderer.shadowMap.enabled!==!1)return un(()=>{let t=this._node;return this.setupShadowPosition(e),t===null&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:i,scene:o}=e;t.updateMatrices(r),n.setSize(t.mapSize.width,t.mapSize.height,n.depth),i.render(o,t.camera)}updateShadow(e){const{shadowMap:t,light:n,shadow:r}=this,{renderer:i,scene:o,camera:l}=e,h=i.shadowMap.type,p=t.depthTexture.version;this._depthVersionCached=p;const y=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=l.layers.mask);const x=i.getRenderObjectFunction(),S=i.getMRT(),A=S?S.has("velocity"):!1;jV=FBe(i,o,jV),o.overrideMaterial=jBe(n),i.setRenderObjectFunction(WBe(i,r,h,A)),i.setClearColor(0,0),i.setRenderTarget(t),this.renderShadow(e),i.setRenderObjectFunction(x),h===DI&&r.isPointLightShadow!==!0&&this.vsmPass(i),r.camera.layers.mask=y,LBe(i,o,jV)}vsmPass(e){const{shadow:t}=this,n=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,n),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,n),e.setRenderTarget(this.vsmShadowMapVertical),eI.material=this.vsmMaterialVertical,eI.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),eI.material=this.vsmMaterialHorizontal,eI.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const YBe=(s,e)=>hn(new x5e(s,e)),KBe=new Ki,e1=un(([s,e])=>{const t=s.toVar(),n=Oh(t),r=h1(1,el(n.x,el(n.y,n.z)));n.mulAssign(r),t.mulAssign(r.mul(e.mul(2).oneMinus()));const i=In(t.xy).toVar(),l=e.mul(1.5).oneMinus();return Xa(n.z.greaterThanEqual(l),()=>{Xa(t.z.greaterThan(0),()=>{i.x.assign(Bl(4,t.x))})}).ElseIf(n.x.greaterThanEqual(l),()=>{const h=bk(t.x);i.x.assign(t.z.mul(h).add(h.mul(2)))}).ElseIf(n.y.greaterThanEqual(l),()=>{const h=bk(t.y);i.x.assign(t.x.add(h.mul(2)).add(2)),i.y.assign(t.z.mul(h).sub(2))}),In(.125,.25).mul(i).add(In(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),ZBe=un(({depthTexture:s,bd3D:e,dp:t,texelSize:n})=>Hi(s,e1(e,n.y)).compare(t)),QBe=un(({depthTexture:s,bd3D:e,dp:t,texelSize:n,shadow:r})=>{const i=Cs("radius","float",r).setGroup(zr),o=In(-1,1).mul(i).mul(n.y);return Hi(s,e1(e.add(o.xyy),n.y)).compare(t).add(Hi(s,e1(e.add(o.yyy),n.y)).compare(t)).add(Hi(s,e1(e.add(o.xyx),n.y)).compare(t)).add(Hi(s,e1(e.add(o.yyx),n.y)).compare(t)).add(Hi(s,e1(e,n.y)).compare(t)).add(Hi(s,e1(e.add(o.xxy),n.y)).compare(t)).add(Hi(s,e1(e.add(o.yxy),n.y)).compare(t)).add(Hi(s,e1(e.add(o.xxx),n.y)).compare(t)).add(Hi(s,e1(e.add(o.yxx),n.y)).compare(t)).mul(1/9)}),JBe=un(({filterFn:s,depthTexture:e,shadowCoord:t,shadow:n})=>{const r=t.xyz.toVar(),i=r.length(),o=Vr("float").setGroup(zr).onRenderUpdate(()=>n.camera.near),l=Vr("float").setGroup(zr).onRenderUpdate(()=>n.camera.far),h=Cs("bias","float",n).setGroup(zr),p=Vr(n.mapSize).setGroup(zr),y=$t(1).toVar();return Xa(i.sub(l).lessThanEqual(0).and(i.sub(o).greaterThanEqual(0)),()=>{const x=i.sub(o).div(l.sub(o)).toVar();x.addAssign(h);const S=r.normalize(),A=In(1).div(p.mul(In(4,2)));y.assign(s({depthTexture:e,bd3D:S,dp:x,texelSize:A,shadow:n}))}),y}),Uge=new ki,Z7=new mi,Nw=new mi;class eze extends x5e{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===hNe?ZBe:QBe}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:i,shadow:o}){return JBe({filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:i,shadow:o})}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:i,scene:o}=e,l=t.getFrameExtents();Nw.copy(t.mapSize),Nw.multiply(l),n.setSize(Nw.width,Nw.height),Z7.copy(t.mapSize);const h=i.autoClear,p=i.getClearColor(KBe),y=i.getClearAlpha();i.autoClear=!1,i.setClearColor(t.clearColor,t.clearAlpha),i.clear();const x=t.getViewportCount();for(let S=0;S<x;S++){const A=t.getViewport(S),k=Z7.x*A.x,L=Nw.y-Z7.y-Z7.y*A.y;Uge.set(k,L,Z7.x*A.z,Z7.y*A.w),n.viewport.copy(Uge),t.updateMatrices(r,S),i.render(o,t.camera)}i.autoClear=h,i.setClearColor(p,y)}}const tze=(s,e)=>hn(new eze(s,e));class Dv extends px{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new Ki,this.colorNode=e&&e.colorNode||Vr(this.color).setGroup(zr),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=_i.FRAME}getHash(){return this.light.uuid}getLightVector(e){return g5e(this.light).sub(e.context.positionView||lo)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return YBe(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const r=this.light.shadow.shadowNode;let i;r!==void 0?i=hn(r):i=this.setupShadowNode(),this.shadowNode=i,this.shadowColorNode=n=this.colorNode.mul(i),this.baseColorNode=this.colorNode}this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const b5e=un(({lightDistance:s,cutoffDistance:e,decayExponent:t})=>{const n=s.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(n.mul(s.div(e).pow4().oneMinus().clamp().pow2()),n)}),nze=({color:s,lightVector:e,cutoffDistance:t,decayExponent:n})=>{const r=e.normalize(),i=e.length(),o=b5e({lightDistance:i,cutoffDistance:t,decayExponent:n}),l=s.mul(o);return{lightDirection:r,lightColor:l}};class rze extends Dv{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=Vr(0).setGroup(zr),this.decayExponentNode=Vr(2).setGroup(zr)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return tze(this.light)}setupDirect(e){return nze({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const Bge=$t(1),fj=$t(-2),tI=$t(.8),WV=$t(-1),nI=$t(.4),$V=$t(2),rI=$t(.305),qV=$t(3),zge=$t(.21),ize=$t(4),Vge=$t(4),sze=$t(16),aze=un(([s])=>{const e=Yt(Oh(s)).toVar(),t=$t(-1).toVar();return Xa(e.x.greaterThan(e.z),()=>{Xa(e.x.greaterThan(e.y),()=>{t.assign(Z0(s.x.greaterThan(0),0,3))}).Else(()=>{t.assign(Z0(s.y.greaterThan(0),1,4))})}).Else(()=>{Xa(e.z.greaterThan(e.y),()=>{t.assign(Z0(s.z.greaterThan(0),2,5))}).Else(()=>{t.assign(Z0(s.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),oze=un(([s,e])=>{const t=In().toVar();return Xa(e.equal(0),()=>{t.assign(In(s.z,s.y).div(Oh(s.x)))}).ElseIf(e.equal(1),()=>{t.assign(In(s.x.negate(),s.z.negate()).div(Oh(s.y)))}).ElseIf(e.equal(2),()=>{t.assign(In(s.x.negate(),s.y).div(Oh(s.z)))}).ElseIf(e.equal(3),()=>{t.assign(In(s.z.negate(),s.y).div(Oh(s.x)))}).ElseIf(e.equal(4),()=>{t.assign(In(s.x.negate(),s.z).div(Oh(s.y)))}).Else(()=>{t.assign(In(s.x,s.y).div(Oh(s.z)))}),Mi(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),lze=un(([s])=>{const e=$t(0).toVar();return Xa(s.greaterThanEqual(tI),()=>{e.assign(Bge.sub(s).mul(WV.sub(fj)).div(Bge.sub(tI)).add(fj))}).ElseIf(s.greaterThanEqual(nI),()=>{e.assign(tI.sub(s).mul($V.sub(WV)).div(tI.sub(nI)).add(WV))}).ElseIf(s.greaterThanEqual(rI),()=>{e.assign(nI.sub(s).mul(qV.sub($V)).div(nI.sub(rI)).add($V))}).ElseIf(s.greaterThanEqual(zge),()=>{e.assign(rI.sub(s).mul(ize.sub(qV)).div(rI.sub(zge)).add(qV))}).Else(()=>{e.assign($t(-2).mul(Dg(Mi(1.16,s))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),uze=un(([s,e])=>{const t=s.toVar();t.assign(Mi(2,t).sub(1));const n=Yt(t,1).toVar();return Xa(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),cze=un(([s,e,t,n,r,i])=>{const o=$t(t),l=Yt(e),h=Bg(lze(o),fj,i),p=c4(h),y=wv(h),x=Yt(pj(s,l,y,n,r,i)).toVar();return Xa(p.notEqual(0),()=>{const S=Yt(pj(s,l,y.add(1),n,r,i)).toVar();x.assign(ea(x,S,p))}),x}),pj=un(([s,e,t,n,r,i])=>{const o=$t(t).toVar(),l=Yt(e),h=$t(aze(l)).toVar(),p=$t(el(Vge.sub(o),0)).toVar();o.assign(el(o,Vge));const y=$t(FE(o)).toVar(),x=In(oze(l,h).mul(y.sub(2)).add(1)).toVar();return Xa(h.greaterThan(2),()=>{x.y.addAssign(y),h.subAssign(3)}),x.x.addAssign(h.mul(y)),x.x.addAssign(p.mul(Mi(3,sze))),x.y.addAssign(Mi(4,FE(i).sub(y))),x.x.mulAssign(n),x.y.mulAssign(r),s.sample(x).grad(In(),In())}),XV=un(({envMap:s,mipInt:e,outputDirection:t,theta:n,axis:r,CUBEUV_TEXEL_WIDTH:i,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:l})=>{const h=W3(n),p=t.mul(h).add(r.cross(t).mul(xf(n))).add(r.mul(r.dot(t).mul(h.oneMinus())));return pj(s,p,e,i,o,l)}),hze=un(({n:s,latitudinal:e,poleAxis:t,outputDirection:n,weights:r,samples:i,dTheta:o,mipInt:l,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x})=>{const S=Yt(Z0(e,t,N4e(t,n))).toVar();Xa(S.equal(Yt(0)),()=>{S.assign(Yt(n.z,0,n.x.negate()))}),S.assign(LE(S));const A=Yt().toVar();return A.addAssign(r.element(0).mul(XV({theta:0,axis:S,outputDirection:n,mipInt:l,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x}))),wf({start:Bs(1),end:s},({i:k})=>{Xa(k.greaterThanEqual(i),()=>{eLe()});const L=$t(o.mul($t(k))).toVar();A.addAssign(r.element(k).mul(XV({theta:L.mul(-1),axis:S,outputDirection:n,mipInt:l,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x}))),A.addAssign(r.element(k).mul(XV({theta:L,axis:S,outputDirection:n,mipInt:l,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:x})))}),Jr(A,1)}),F3=new vt,Gge=new mi,Hge=new mi;class Pc extends bW{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Y_*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(hE*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Y_*2*Math.atan(Math.tan(hE*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){F3.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(F3.x,F3.y).multiplyScalar(-e/F3.z),F3.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(F3.x,F3.y).multiplyScalar(-e/F3.z)}getViewSize(e,t){return this.getViewBounds(e,Gge,Hge),t.subVectors(Hge,Gge)}setViewOffset(e,t,n,r,i,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(hE*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const h=o.fullWidth,p=o.fullHeight;i+=o.offsetX*r/h,t-=o.offsetY*n/p,r*=o.width/h,n*=o.height/p}const l=this.filmOffset;l!==0&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class YE extends Hg{constructor(e=1,t=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const l=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const h=[],p=[],y=[],x=[];let S=0,A=0;k("z","y","x",-1,-1,n,t,e,o,i,0),k("z","y","x",1,-1,n,t,-e,o,i,1),k("x","z","y",1,1,e,n,t,r,o,2),k("x","z","y",1,-1,e,n,-t,r,o,3),k("x","y","z",1,-1,e,t,n,r,i,4),k("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(h),this.setAttribute("position",new Hl(p,3)),this.setAttribute("normal",new Hl(y,3)),this.setAttribute("uv",new Hl(x,2));function k(L,U,P,$,Z,I,ie,ce,ue,Q,oe){const le=I/ue,J=ie/Q,Be=I/2,He=ie/2,rt=ce/2,ot=ue+1,Se=Q+1;let gt=0,Ae=0;const lt=new vt;for(let pt=0;pt<Se;pt++){const De=pt*J-He;for(let _t=0;_t<ot;_t++){const Jt=_t*le-Be;lt[L]=Jt*$,lt[U]=De*Z,lt[P]=rt,p.push(lt.x,lt.y,lt.z),lt[L]=0,lt[U]=0,lt[P]=ce>0?1:-1,y.push(lt.x,lt.y,lt.z),x.push(_t/ue),x.push(1-pt/Q),gt+=1}}for(let pt=0;pt<Q;pt++)for(let De=0;De<ue;De++){const _t=S+De+ot*pt,Jt=S+De+ot*(pt+1),dt=S+(De+1)+ot*(pt+1),Dt=S+(De+1)+ot*pt;h.push(_t,Jt,Dt),h.push(Jt,dt,Dt),Ae+=6}l.addGroup(A,Ae,oe),A+=Ae,S+=gt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new YE(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}const w_=4,jge=[.125,.215,.35,.446,.526,.582],gv=20,YV=new XW(-1,1,1,-1,0,1),dze=new Pc(90,1),Wge=new Ki;let KV=null,ZV=0,QV=0;const cv=(1+Math.sqrt(5))/2,Q7=1/cv,$ge=[new vt(-cv,Q7,0),new vt(cv,Q7,0),new vt(-Q7,0,cv),new vt(Q7,0,cv),new vt(0,cv,-Q7),new vt(0,cv,Q7),new vt(-1,1,-1),new vt(1,1,-1),new vt(-1,1,1),new vt(1,1,1)],fze=new vt,S5e=new WeakMap,pze=[3,1,5,0,4,2],JV=uze(XE(),a4("faceIndex")).normalize(),KW=Yt(JV.x,JV.y,JV.z);class mze{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,n=.1,r=100,i={}){const{size:o=256,position:l=fze,renderTarget:h=null}=i;if(this._setSize(o),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const y=h||this._allocateTarget();return i.renderTarget=y,this.fromSceneAsync(e,t,n,r,i),y}KV=this._renderer.getRenderTarget(),ZV=this._renderer.getActiveCubeFace(),QV=this._renderer.getActiveMipmapLevel();const p=h||this._allocateTarget();return p.depthBuffer=!0,this._init(p),this._sceneToCubeUV(e,n,r,p,l),t>0&&this._blur(p,0,0,t),this._applyPMREM(p),this._cleanup(p),p}async fromSceneAsync(e,t=0,n=.1,r=100,i={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,t,n,r,i)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Xge(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Yge(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===NE||e.mapping===ck?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(KV,ZV,QV),e.scissorTest=!1,iI(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),KV=this._renderer.getRenderTarget(),ZV=this._renderer.getActiveCubeFace(),QV=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTarget();return this._init(n),this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return qge(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=qge(e.width,e.height);const{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=gze(t)),this._blurMaterial=vze(t,e.width,e.height)}}async _compileMaterial(e){const t=new zg(this._lodPlanes[0],e);await this._renderer.compile(t,YV)}_sceneToCubeUV(e,t,n,r,i){const o=dze;o.near=t,o.far=n;const l=[1,1,1,1,-1,1],h=[1,-1,1,-1,1,-1],p=this._renderer,y=p.autoClear;p.getClearColor(Wge),p.autoClear=!1;let x=this._backgroundBox;if(x===null){const k=new K3({name:"PMREM.Background",side:Nu,depthWrite:!1,depthTest:!1});x=new zg(new YE,k)}let S=!1;const A=e.background;A?A.isColor&&(x.material.color.copy(A),e.background=null,S=!0):(x.material.color.copy(Wge),S=!0),p.setRenderTarget(r),p.clear(),S&&p.render(x,o);for(let k=0;k<6;k++){const L=k%3;L===0?(o.up.set(0,l[k],0),o.position.set(i.x,i.y,i.z),o.lookAt(i.x+h[k],i.y,i.z)):L===1?(o.up.set(0,0,l[k]),o.position.set(i.x,i.y,i.z),o.lookAt(i.x,i.y+h[k],i.z)):(o.up.set(0,l[k],0),o.position.set(i.x,i.y,i.z),o.lookAt(i.x,i.y,i.z+h[k]));const U=this._cubeSize;iI(r,L*U,k>2?U:0,U,U),p.render(e,o)}p.autoClear=y,e.background=A}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===NE||e.mapping===ck;r?this._cubemapMaterial===null&&(this._cubemapMaterial=Xge(e)):this._equirectMaterial===null&&(this._equirectMaterial=Yge(e));const i=r?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=i;const l=this._cubeSize;iI(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,YV)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const o=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),l=$ge[(r-i-1)%$ge.length];this._blur(e,i-1,i,o,l)}t.autoClear=n}_blur(e,t,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,o,l){const h=this._renderer,p=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const y=3,x=this._lodMeshes[r];x.material=p;const S=S5e.get(p),A=this._sizeLods[n]-1,k=isFinite(i)?Math.PI/(2*A):2*Math.PI/(2*gv-1),L=i/k,U=isFinite(i)?1+Math.floor(y*L):gv;U>gv&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${U} samples when the maximum is set to ${gv}`);const P=[];let $=0;for(let ue=0;ue<gv;++ue){const Q=ue/L,oe=Math.exp(-Q*Q/2);P.push(oe),ue===0?$+=oe:ue<U&&($+=2*oe)}for(let ue=0;ue<P.length;ue++)P[ue]=P[ue]/$;e.texture.frame=(e.texture.frame||0)+1,S.envMap.value=e.texture,S.samples.value=U,S.weights.array=P,S.latitudinal.value=o==="latitudinal"?1:0,l&&(S.poleAxis.value=l);const{_lodMax:Z}=this;S.dTheta.value=k,S.mipInt.value=Z-n;const I=this._sizeLods[r],ie=3*I*(r>Z-w_?r-Z+w_:0),ce=4*(this._cubeSize-I);iI(t,ie,ce,3*I,2*I),h.setRenderTarget(t),h.render(x,YV)}}function gze(s){const e=[],t=[],n=[],r=[];let i=s;const o=s-w_+1+jge.length;for(let l=0;l<o;l++){const h=Math.pow(2,i);t.push(h);let p=1/h;l>s-w_?p=jge[l-s+w_-1]:l===0&&(p=0),n.push(p);const y=1/(h-2),x=-y,S=1+y,A=[x,x,S,x,S,S,x,x,S,S,x,S],k=6,L=6,U=3,P=2,$=1,Z=new Float32Array(U*L*k),I=new Float32Array(P*L*k),ie=new Float32Array($*L*k);for(let ue=0;ue<k;ue++){const Q=ue%3*2/3-1,oe=ue>2?0:-1,le=[Q,oe,0,Q+2/3,oe,0,Q+2/3,oe+1,0,Q,oe,0,Q+2/3,oe+1,0,Q,oe+1,0],J=pze[ue];Z.set(le,U*L*J),I.set(A,P*L*J);const Be=[J,J,J,J,J,J];ie.set(Be,$*L*J)}const ce=new Hg;ce.setAttribute("position",new Vh(Z,U)),ce.setAttribute("uv",new Vh(I,P)),ce.setAttribute("faceIndex",new Vh(ie,$)),e.push(ce),r.push(new zg(ce,null)),i>w_&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n,lodMeshes:r}}function qge(s,e){const t={magFilter:Dc,minFilter:Dc,generateMipmaps:!1,type:Uh,format:Bh,colorSpace:I_},n=new Nv(s,e,t);return n.texture.mapping=BH,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function iI(s,e,t,n,r){s.viewport.set(e,t,n,r),s.scissor.set(e,t,n,r)}function ZW(s){const e=new uo;return e.depthTest=!1,e.depthWrite=!1,e.blending=K_,e.name=`PMREM_${s}`,e}function vze(s,e,t){const n=i1(new Array(gv).fill(0)),r=Vr(new vt(0,1,0)),i=Vr(0),o=$t(gv),l=Vr(0),h=Vr(1),p=Hi(null),y=Vr(0),x=$t(1/e),S=$t(1/t),A=$t(s),k={n:o,latitudinal:l,weights:n,poleAxis:r,outputDirection:KW,dTheta:i,samples:h,envMap:p,mipInt:y,CUBEUV_TEXEL_WIDTH:x,CUBEUV_TEXEL_HEIGHT:S,CUBEUV_MAX_MIP:A},L=ZW("blur");return L.fragmentNode=hze({...k,latitudinal:l.equal(1)}),S5e.set(L,k),L}function Xge(s){const e=ZW("cubemap");return e.fragmentNode=BE(s,KW),e}function Yge(s){const e=ZW("equirect");return e.fragmentNode=Hi(s,X4e(KW),0),e}const Kge=new WeakMap;function yze(s){const e=Math.log2(s)-2,t=1/s;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function _ze(s,e,t){const n=xze(e);let r=n.get(s);if((r!==void 0?r.pmremVersion:-1)!==s.pmremVersion){const o=s.image;if(s.isCubeTexture)if(Sze(o))r=t.fromCubemap(s,r);else return null;else if(wze(o))r=t.fromEquirectangular(s,r);else return null;r.pmremVersion=s.pmremVersion,n.set(s,r)}return r.texture}function xze(s){let e=Kge.get(s);return e===void 0&&(e=new WeakMap,Kge.set(s,e)),e}class bze extends co{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const r=new Q0;r.isRenderTargetTexture=!0,this._texture=Hi(r),this._width=Vr(0),this._height=Vr(0),this._maxMip=Vr(0),this.updateBeforeType=_i.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=yze(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const n=t?t.pmremVersion:-1,r=this._value;n!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=_ze(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new mze(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this)),t=s5e.mul(Yt(t.x,t.y.negate(),t.z));let n=this.levelNode;return n===null&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),cze(this._texture,t,n,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function Sze(s){if(s==null)return!1;let e=0;const t=6;for(let n=0;n<t;n++)s[n]!==void 0&&e++;return e===t}function wze(s){return s==null?!1:s.height>0}const w5e=cn(bze).setParameterLength(1,3);un(([s=XE()],{renderer:e,material:t})=>{const n=O4e(s.mul(2).sub(1));let r;if(t.alphaToCoverage&&e.samples>1){const i=$t(n.fwidth()).toVar();r=s4(i.oneMinus(),i.add(1),n).oneMinus()}else r=Z0(n.greaterThan(1),0,1);return r});const zE=un(({f0:s,f90:e,dotVH:t})=>{const n=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return s.mul(n.oneMinus()).add(e.mul(n))}),Eze=un(({alpha:s,dotNL:e,dotNV:t})=>{const n=s.pow2(),r=e.mul(n.add(n.oneMinus().mul(t.pow2())).sqrt()),i=t.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return h1(.5,r.add(i).max(zOe))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),Tze=un(({alphaT:s,alphaB:e,dotTV:t,dotBV:n,dotTL:r,dotBL:i,dotNV:o,dotNL:l})=>{const h=l.mul(Yt(s.mul(t),e.mul(n),o).length()),p=o.mul(Yt(s.mul(r),e.mul(i),l).length());return h1(.5,h.add(p)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),Mze=un(({alpha:s,dotNH:e})=>{const t=s.pow2(),n=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),Cze=$t(1/Math.PI),Aze=un(({alphaT:s,alphaB:e,dotNH:t,dotTH:n,dotBH:r})=>{const i=s.mul(e),o=Yt(e.mul(n),s.mul(r),i.mul(t)),l=o.dot(o),h=i.div(l);return Cze.mul(i.mul(h.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),Zge=un(s=>{const{lightDirection:e,f0:t,f90:n,roughness:r,f:i,USE_IRIDESCENCE:o,USE_ANISOTROPY:l}=s,h=s.normalView||ao,p=r.pow2(),y=e.add(ba).normalize(),x=h.dot(e).clamp(),S=h.dot(ba).clamp(),A=h.dot(y).clamp(),k=ba.dot(y).clamp();let L=zE({f0:t,f90:n,dotVH:k}),U,P;if(sge(o)&&(L=kW.mix(L,i)),sge(l)){const $=UI.dot(e),Z=UI.dot(ba),I=UI.dot(y),ie=O_.dot(e),ce=O_.dot(ba),ue=O_.dot(y);U=Tze({alphaT:oj,alphaB:p,dotTV:Z,dotBV:ce,dotTL:$,dotBL:ie,dotNV:S,dotNL:x}),P=Aze({alphaT:oj,alphaB:p,dotNH:A,dotTH:I,dotBH:ue})}else U=Eze({alpha:p,dotNL:x,dotNV:S}),P=Mze({alpha:p,dotNH:A});return L.mul(U).mul(P)}),nx=un(s=>s.diffuseColor.mul(1/Math.PI)),E5e=un(({roughness:s,dotNV:e})=>{const t=Jr(-1,-.0275,-.572,.022),n=Jr(1,.0425,1.04,-.04),r=s.mul(t).add(n),i=r.x.mul(r.x).min(e.mul(-9.28).exp2()).mul(r.x).add(r.y);return In(-1.04,1.04).mul(i).add(r.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),Pze=un(({f:s,f90:e,dotVH:t})=>{const n=t.oneMinus().saturate(),r=n.mul(n),i=n.mul(r,r).clamp(0,.9999);return s.sub(Yt(e).mul(i)).div(i.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),Rze=un(s=>{if(s.geometry.hasAttribute("normal")===!1)return $t(0);const e=f1.dFdx().abs().max(f1.dFdy().abs());return e.x.max(e.y).max(e.z)}),T5e=un(s=>{const{roughness:e}=s,t=Rze();let n=e.max(.0525);return n=n.add(t),n=n.min(1),n}),Ize=un(([s,e])=>{const t=s.x,n=s.y,r=s.z;let i=e.element(0).mul(.886227);return i=i.add(e.element(1).mul(2*.511664).mul(n)),i=i.add(e.element(2).mul(2*.511664).mul(r)),i=i.add(e.element(3).mul(2*.511664).mul(t)),i=i.add(e.element(4).mul(2*.429043).mul(t).mul(n)),i=i.add(e.element(5).mul(2*.429043).mul(n).mul(r)),i=i.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),i=i.add(e.element(7).mul(2*.429043).mul(t).mul(r)),i=i.add(e.element(8).mul(.429043).mul(Mi(t,t).sub(Mi(n,n)))),i});class QW extends Hg{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:l},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const h=Math.min(o+l,Math.PI);let p=0;const y=[],x=new vt,S=new vt,A=[],k=[],L=[],U=[];for(let P=0;P<=n;P++){const $=[],Z=P/n;let I=0;P===0&&o===0?I=.5/t:P===n&&h===Math.PI&&(I=-.5/t);for(let ie=0;ie<=t;ie++){const ce=ie/t;x.x=-e*Math.cos(r+ce*i)*Math.sin(o+Z*l),x.y=e*Math.cos(o+Z*l),x.z=e*Math.sin(r+ce*i)*Math.sin(o+Z*l),k.push(x.x,x.y,x.z),S.copy(x).normalize(),L.push(S.x,S.y,S.z),U.push(ce+I,1-Z),$.push(p++)}y.push($)}for(let P=0;P<n;P++)for(let $=0;$<t;$++){const Z=y[P][$+1],I=y[P][$],ie=y[P+1][$],ce=y[P+1][$+1];(P!==0||o>0)&&A.push(Z,I,ce),(P!==n-1||h<Math.PI)&&A.push(I,ie,ce)}this.setIndex(A),this.setAttribute("position",new Hl(k,3)),this.setAttribute("normal",new Hl(L,3)),this.setAttribute("uv",new Hl(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QW(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}const ff=new wW;class kze extends u4{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const r=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(i===null)r._clearColor.getRGB(ff),ff.a=r._clearColor.a;else if(i.isColor===!0)i.getRGB(ff),ff.a=1,o=!0;else if(i.isNode===!0){const p=this.get(e),y=i;ff.copy(r._clearColor);let x=p.backgroundMesh;if(x===void 0){let U=function(){i.removeEventListener("dispose",U),x.material.dispose(),x.geometry.dispose()};var h=U;const A=FW(Jr(y).mul(Nge),{getUV:()=>aBe.mul(jW),getTextureLevel:()=>sBe});let k=c5e;k=k.setZ(k.w);const L=new uo;L.name="Background.material",L.side=Nu,L.depthTest=!1,L.depthWrite=!1,L.allowOverride=!1,L.fog=!1,L.lights=!1,L.vertexNode=k,L.colorNode=A,p.backgroundMeshNode=A,p.backgroundMesh=x=new zg(new QW(1,32,32),L),x.frustumCulled=!1,x.name="Background.mesh",x.onBeforeRender=function(P,$,Z){this.matrixWorld.copyPosition(Z.matrixWorld)},i.addEventListener("dispose",U)}const S=y.getCacheKey();p.backgroundCacheKey!==S&&(p.backgroundMeshNode.node=Jr(y).mul(Nge),p.backgroundMeshNode.needsUpdate=!0,x.material.needsUpdate=!0,p.backgroundCacheKey=S),t.unshift(x,x.geometry,x.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);const l=r.xr.getEnvironmentBlendMode();if(l==="additive"?ff.set(0,0,0,1):l==="alpha-blend"&&ff.set(0,0,0,0),r.autoClear===!0||o===!0){const p=n.clearColorValue;p.r=ff.r,p.g=ff.g,p.b=ff.b,p.a=ff.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(p.r*=p.a,p.g*=p.a,p.b*=p.a),n.depthClearValue=r._clearDepth,n.stencilClearValue=r._clearStencil,n.clearColor=r.autoClearColor===!0,n.clearDepth=r.autoClearDepth===!0,n.clearStencil=r.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let Nze=0;class mj{constructor(e="",t=[],n=0,r=[]){this.name=e,this.bindings=t,this.index=n,this.bindingsReference=r,this.id=Nze++}}class Dze{constructor(e,t,n,r,i,o,l,h,p,y=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=y,this.nodeAttributes=r,this.bindings=i,this.updateNodes=o,this.updateBeforeNodes=l,this.updateAfterNodes=h,this.observer=p,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new mj(t.name,[],t.index,t);e.push(r);for(const i of t.bindings)r.bindings.push(i.clone())}else e.push(t);return e}}function M5e(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const r=s[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Oze(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}const Fze=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,Lze=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class Uze extends Du{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Fze,this.fragmentShader=Lze,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=M5e(e.uniforms),this.uniformsGroups=Oze(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Bze extends Nv{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}const J7=-90,e_=1;class C5e extends wo{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Pc(J7,e_,e,t);r.layers=this.layers,this.add(r);const i=new Pc(J7,e_,e,t);i.layers=this.layers,this.add(i);const o=new Pc(J7,e_,e,t);o.layers=this.layers,this.add(o);const l=new Pc(J7,e_,e,t);l.layers=this.layers,this.add(l);const h=new Pc(J7,e_,e,t);h.layers=this.layers,this.add(h);const p=new Pc(J7,e_,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,o,l,h]=t;for(const p of t)this.remove(p);if(e===Ru)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===i4)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,o,l,h,p,y]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),k=e.xr.enabled;e.xr.enabled=!1;const L=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,l),e.setRenderTarget(n,3,r),e.render(t,h),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=L,e.setRenderTarget(n,5,r),e.render(t,y),e.setRenderTarget(x,S,A),e.xr.enabled=k,n.texture.needsPMREMUpdate=!0}}class zze extends Bze{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new $k(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new YE(5,5,5),i=new Uze({name:"CubemapFromEquirect",uniforms:M5e(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Nu,blending:K_});i.uniforms.tEquirect.value=t;const o=new zg(r,i),l=t.minFilter;return t.minFilter===Ig&&(t.minFilter=Dc),new C5e(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(i)}}class A5e extends zze{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i=new YE(5,5,5),o=X4e(q4e),l=new uo;l.colorNode=Hi(t,o,0),l.side=Nu,l.blending=K_;const h=new zg(i,l),p=new xW;p.add(h),t.minFilter===Ig&&(t.minFilter=Dc);const y=new C5e(1,10,this),x=e.getMRT();return e.setMRT(null),y.update(e,p),e.setMRT(x),t.minFilter=n,t.currentGenerateMipmaps=r,h.geometry.dispose(),h.material.dispose(),this}}const yE=new WeakMap;class Vze extends co{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=BE(null);const t=new $k;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=_i.RENDER}updateBefore(e){const{renderer:t,material:n}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const i=r.isTextureNode?r.value:n[r.property];if(i&&i.isTexture){const o=i.mapping;if(o===hW||o===dW){if(yE.has(i)){const l=yE.get(i);Qge(l,i.mapping),this._cubeTexture=l}else{const l=i.image;if(Gze(l)){const h=new A5e(l.height);h.fromEquirectangularTexture(t,i),Qge(h.texture,i.mapping),this._cubeTexture=h.texture,yE.set(i,h.texture),i.addEventListener("dispose",P5e)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function Gze(s){return s==null?!1:s.height>0}function P5e(s){const e=s.target;e.removeEventListener("dispose",P5e);const t=yE.get(e);t!==void 0&&(yE.delete(e),t.dispose())}function Qge(s,e){e===hW?s.mapping=NE:e===dW&&(s.mapping=ck)}const R5e=cn(Vze).setParameterLength(1);class Kk{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class Jge{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class Hze{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class I5e{constructor(e,t,n=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=n,this.count=r}}class jze extends I5e{constructor(e,t,n=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=n,this.interpolationSampling=r}}class Wze{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let $ze=0;class eG{constructor(e=null){this.id=$ze++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class qze{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class h4{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class Xze extends h4{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class Yze extends h4{constructor(e,t=new mi){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class Kze extends h4{constructor(e,t=new vt){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class Zze extends h4{constructor(e,t=new ki){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class Qze extends h4{constructor(e,t=new Ki){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class Jze extends h4{constructor(e,t=new Dk){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class eVe extends h4{constructor(e,t=new Ou){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class tVe extends h4{constructor(e,t=new As){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class nVe extends Xze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class rVe extends Yze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class iVe extends Kze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class sVe extends Zze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class aVe extends Qze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class oVe extends Jze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class lVe extends eVe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class uVe extends tVe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const e2e=new WeakMap,cVe=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),sI=s=>/e/g.test(s)?String(s).replace(/\+/g,""):(s=Number(s),s+(s%1?"":".0"));class k5e{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=xV(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new eG,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}getBindGroupsCache(){let e=e2e.get(this.renderer);return e===void 0&&(e=new Tf,e2e.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new Nv(e,t,n)}createCubeRenderTarget(e,t){return new A5e(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const n=this.getBindGroupsCache(),r=[];let i=!0;for(const l of t)r.push(l),i=i&&l.groupNode.shared!==!0;let o;return i?(o=n.get(r),o===void 0&&(o=new mj(e,r,this.bindingsIndexes[e].group,r),n.set(r,o))):o=new mj(e,r,this.bindingsIndexes[e].group,r),o}getBindGroupArray(e,t){const n=this.bindings[t];let r=n[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},n=this.bindings;for(const r of Jme)for(const i in n[r]){const o=n[r][i];(t[i]||(t[i]=[])).push(...o)}e=[];for(const r in t){const i=t[r],o=this._getBindGroup(r,i);e.push(o)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,n)=>t.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==_i.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==_i.NONE&&this.updateBeforeNodes.push(e.getSelf()),n!==_i.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Dc||e.magFilter===zH||e.magFilter===DE||e.magFilter===Ig||e.minFilter===Dc||e.minFilter===zH||e.minFilter===DE||e.minFilter===Ig}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new eG(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,n=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let i=0;i<t;i++){const o=n?n[i]:null;o!==null?r+=o.build(this,e):r+=this.generateConst(e),i<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,n=null){const r=[];for(const i of t){const{name:o,type:l}=i;n&&n[o]&&n[o].isNode?r.push(n[o].build(this,l)):r.push(this.generateConst(l))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new Ki:e==="vec2"?t=new mi:e==="vec3"?t=new vt:e==="vec4"&&(t=new ki)),e==="float")return sI(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${sI(t.r)}, ${sI(t.g)}, ${sI(t.b)} )`;const n=this.getTypeLength(e),r=this.getComponentType(e),i=o=>this.generateConst(r,o);if(n===2)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)} )`;if(n===3)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)} )`;if(n===4&&e!=="mat2")return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)}, ${i(t.w)} )`;if(n>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(i).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const n=this.attributes;for(const i of n)if(i.name===e)return i;const r=new Jge(e,t);return this.registerDeclaration(r),n.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Ul)return"int";if(t===$a)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let n=YNe(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(n=n.replace("vec","mat")),r+n}getTypeFromArray(e){return cVe.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,r=e.itemSize,i=e.normalized;let o;return!(e instanceof a4e)&&i!==!0&&(o=this.getTypeFromArray(n)),this.getTypeFromLength(r,o)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return n!==null?Number(n[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=xV(this.stack),this.stacks.push(p4e()||this.stack),gk(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,gk(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let r=n.getData(e);return r===void 0&&(r={},n.setData(e,r)),r[t]===void 0&&(r[t]={}),r[t]}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e);let r=n.bufferAttribute;if(r===void 0){const i=this.uniforms.index++;r=new Jge("nodeAttribute"+i,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}getStructTypeFromNode(e,t,n=null,r=this.shaderStage){const i=this.getDataFromNode(e,r,this.globalCache);let o=i.structType;if(o===void 0){const l=this.structs.index++;n===null&&(n="StructType"+l),o=new qze(n,t),this.structs[r].push(o),i.structType=o}return o}getOutputStructTypeFromNode(e,t){const n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}getUniformFromNode(e,t,n=this.shaderStage,r=null){const i=this.getDataFromNode(e,n,this.globalCache);let o=i.uniform;if(o===void 0){const l=this.uniforms.index++;o=new Hze(r||"nodeUniform"+l,t,e),this.uniforms[n].push(o),this.registerDeclaration(o),i.uniform=o}return o}getArrayCount(e){let t=null;return e.isArrayNode?t=e.count:e.isVarNode&&e.node.isArrayNode&&(t=e.node.count),t}getVarFromNode(e,t=null,n=e.getNodeType(this),r=this.shaderStage,i=!1){const o=this.getDataFromNode(e,r);let l=o.variable;if(l===void 0){const h=i?"_const":"_var",p=this.vars[r]||(this.vars[r]=[]),y=this.vars[h]||(this.vars[h]=0);t===null&&(t=(i?"nodeConst":"nodeVar")+y,this.vars[h]++);const x=this.getArrayCount(e);l=new I5e(t,n,i,x),i||p.push(l),this.registerDeclaration(l),o.variable=l}return l}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,n=e.getNodeType(this),r=null,i=null){const o=this.getDataFromNode(e,"any");let l=o.varying;if(l===void 0){const h=this.varyings,p=h.length;t===null&&(t="nodeVarying"+p),l=new jze(t,n,r,i),h.push(l),this.registerDeclaration(l),o.varying=l}return l}get namespace(){return this.context.namespace}getOutputNamespace(){return this.getNamespace("outputNode")}getNamespace(e=""){const t=this.namespace;let n;return t?n=e?t+"_"+e:t:n=e,n}registerDeclaration(e){const t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let i=1,o=r;for(;n[o]!==void 0;)o=r+"_"+i++;i>1&&(e.name=o,console.warn(`THREE.TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${o}'.`)),n[o]=e}getCodeFromNode(e,t,n=this.shaderStage){const r=this.getDataFromNode(e);let i=r.code;if(i===void 0){const o=this.codes[n]||(this.codes[n]=[]),l=o.length;i=new Wze("nodeCode"+l,t),o.push(i),r.code=i}return i}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:r}=this.getDataFromNode(e);let i=!0,o=t;for(;o;){if(r.get(o)===!0){i=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(i)for(const l of n)this.addLineFlowCode(l)}addLineFlowCodeBlock(e,t,n){const r=this.getDataFromNode(e),i=r.flowCodes||(r.flowCodes=[]),o=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);i.push(t),o.set(n,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new bBe,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let o=0;const l=Object.values(this);return{next:()=>({value:l[o],done:o++>=l.length})}}};for(const o of t.inputs)n[o.name]=new ZFe(o.type,o.name);e.layout=null;const r=e.call(n),i=this.flowStagesNode(r,t.type);return e.layout=t,i}flowStagesNode(e,t=null){const n=this.flow,r=this.vars,i=this.declarations,o=this.cache,l=this.buildStage,h=this.stack,p={code:""};this.flow=p,this.vars={},this.declarations={},this.cache=new eG,this.stack=xV();for(const y of Qme)this.setBuildStage(y),p.result=e.build(this,t);return p.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.declarations=i,this.cache=o,this.stack=h,this.setBuildStage(l),p}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}flowNodeFromShaderStage(e,t,n=null,r=null){const i=this.tab,o=this.cache,l=this.shaderStage,h=this.context;this.setShaderStage(e);const p={...this.context};delete p.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=p;let y=null;if(this.buildStage==="generate"){const x=this.flowChildNode(t,n);r!==null&&(x.code+=`${this.tab+r} = ${x.result};
`),this.flowCode[e]=this.flowCode[e]+x.code,y=x}else y=t.build(this);return this.setShaderStage(l),this.cache=o,this.tab=i,this.context=h,y}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,n=null){return`${n!==null?this.generateArrayDeclaration(e,n):this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(n!==void 0)for(const r of n)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(t!==void 0)for(const r of t)n+=r.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:n}=this;if(t!==null){let r=n.library.fromMaterial(t);r===null&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new uo),r.build(this)}else this.addFlow("compute",e);for(const r of Qme){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const i of Jme){this.setShaderStage(i);const o=this.flowNodes[i];for(const l of o)r==="generate"?this.flowNode(l):l.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new nVe(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new rVe(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new iVe(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new sVe(e);if(t==="color")return new aVe(e);if(t==="mat2")return new oVe(e);if(t==="mat3")return new lVe(e);if(t==="mat4")return new uVe(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,n){if(t=this.getVectorType(t),n=this.getVectorType(n),t===n||n===null||this.isReference(n))return e;const r=this.getTypeLength(t),i=this.getTypeLength(n);return r===16&&i===9?`${this.getType(n)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&i===4?`${this.getType(n)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||i>4||i===0?e:r===i?`${this.getType(n)}( ${e} )`:r>i?(e=n==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,i)}`,this.format(e,this.getTypeFromLength(i,this.getComponentType(t)),n)):i===4&&r>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&i>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${M3e} - Node System
`}*[Symbol.iterator](){}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}}class t2e{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return n===void 0&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===_i.FRAME){const{frameMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.frameId&&e.updateBefore(this)!==!1&&r.set(n,this.frameId)}else if(t===_i.RENDER){const{renderMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.renderId&&e.updateBefore(this)!==!1&&r.set(n,this.renderId)}else t===_i.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===_i.FRAME){const{frameMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.frameId&&e.updateAfter(this)!==!1&&r.set(n,this.frameId)}else if(t===_i.RENDER){const{renderMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.renderId&&e.updateAfter(this)!==!1&&r.set(n,this.renderId)}else t===_i.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===_i.FRAME){const{frameMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.frameId&&e.update(this)!==!1&&r.set(n,this.frameId)}else if(t===_i.RENDER){const{renderMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.renderId&&e.update(this)!==!1&&r.set(n,this.renderId)}else t===_i.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class JW{constructor(e,t,n=null,r="",i=!1){this.type=e,this.name=t,this.count=n,this.qualifier=r,this.isConst=i}}JW.isNodeFunctionInput=!0;class hVe extends Dv{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:v5e(this.light),lightColor:e}}}const tG=new As,aI=new As;let Dw=null;class dVe extends Dv{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=Vr(new vt).setGroup(zr),this.halfWidth=Vr(new vt).setGroup(zr),this.updateType=_i.RENDER}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;aI.identity(),tG.copy(t.matrixWorld),tG.premultiply(n),aI.extractRotation(tG),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(aI),this.halfHeight.value.applyMatrix4(aI)}setupDirectRectArea(e){let t,n;e.isAvailable("float32Filterable")?(t=Hi(Dw.LTC_FLOAT_1),n=Hi(Dw.LTC_FLOAT_2)):(t=Hi(Dw.LTC_HALF_1),n=Hi(Dw.LTC_HALF_2));const{colorNode:r,light:i}=this,o=g5e(i);return{lightColor:r,lightPosition:o,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}static setLTC(e){Dw=e}}class e$ extends Dv{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=Vr(0).setGroup(zr),this.penumbraCosNode=Vr(0).setGroup(zr),this.cutoffDistanceNode=Vr(0).setGroup(zr),this.decayExponentNode=Vr(0).setGroup(zr),this.colorNode=Vr(this.color).setGroup(zr)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:n,penumbraCosNode:r}=this;return s4(n,r,t)}getLightCoord(e){const t=e.getNodeProperties(this);let n=t.projectionUV;return n===void 0&&(n=TBe(this.light,e.context.positionWorld),t.projectionUV=n),n}setupDirect(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:r,light:i}=this,o=this.getLightVector(e),l=o.normalize(),h=l.dot(v5e(i)),p=this.getSpotAttenuation(e,h),y=o.length(),x=b5e({lightDistance:y,cutoffDistance:n,decayExponent:r});let S=t.mul(p).mul(x),A,k;return i.colorNode?(k=this.getLightCoord(e),A=i.colorNode(k)):i.map&&(k=this.getLightCoord(e),A=Hi(i.map,k.xy).onRenderUpdate(()=>i.map)),A&&(S=k.mul(2).sub(1).abs().lessThan(1).all().select(S.mul(A),S)),{lightColor:S,lightDirection:l}}}class fVe extends e${static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const n=this.light.iesMap;let r=null;if(n&&n.isTexture===!0){const i=t.acos().mul(1/Math.PI);r=Hi(n,In(i,0),0).r}else r=super.getSpotAttenuation(t);return r}}const pVe=un(([s,e])=>{const t=s.abs().sub(e);return Og(el(t,0)).add(ex(el(t.x,t.y),0))});class mVe extends e${static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let n=1;t.map!==null&&(n=t.map.width/t.map.height),t.shadow.aspect=n}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=this.penumbraCosNode,n=this.getLightCoord(e),r=n.xyz.div(n.w),i=pVe(r.xy.sub(In(.5)),In(.5)),o=h1(-1,Bl(1,A4e(t)).sub(1));return F4e(i.mul(-2).mul(o))}}class gVe extends Dv{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class vVe extends Dv{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=m5e(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=Vr(new Ki).setGroup(zr)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:r}=this,o=jW.dot(r).mul(.5).add(.5),l=ea(n,t,o);e.context.irradiance.addAssign(l)}}class yVe extends Dv{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let n=0;n<9;n++)t.push(new vt);this.lightProbe=i1(t)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=Ize(jW,this.lightProbe);e.context.irradiance.addAssign(t)}}const n2e=new WeakMap;class _Ve extends px{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const x=n.isTextureNode?n.value:t[n.property];let S=n2e.get(x);S===void 0&&(S=w5e(x),n2e.set(x,S)),n=S}const i=t.useAnisotropy===!0||t.anisotropy>0?HLe:ao,o=n.context(r2e(Tg,i)).mul(MV),l=n.context(xVe(WW)).mul(Math.PI).mul(MV),h=VI(o),p=VI(l);e.context.radiance.addAssign(h),e.context.iblIrradiance.addAssign(p);const y=e.context.lightingModel.clearcoatRadiance;if(y){const x=n.context(r2e(_k,tE)).mul(MV),S=VI(x);y.addAssign(S)}}}const r2e=(s,e)=>{let t=null;return{getUV:()=>(t===null&&(t=ba.negate().reflect(e),t=s.mul(s).mix(t,e).normalize(),t=t.transformDirection(Gg)),t),getTextureLevel:()=>s}},xVe=s=>({getUV:()=>s,getTextureLevel:()=>$t(1)});class t$ extends px{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=R5e(this.envNode)}}class N5e{parseFunction(){console.warn("Abstract function.")}}class n${constructor(e,t,n="",r=""){this.type=e,this.inputs=t,this.name=n,this.precision=r}getCode(){console.warn("Abstract function.")}}n$.isNodeFunction=!0;const bVe=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,SVe=/[a-z_0-9]+/ig,i2e="#pragma main",wVe=s=>{s=s.trim();const e=s.indexOf(i2e),t=e!==-1?s.slice(e+i2e.length):s,n=t.match(bVe);if(n!==null&&n.length===5){const r=n[4],i=[];let o=null;for(;(o=SVe.exec(r))!==null;)i.push(o);const l=[];let h=0;for(;h<i.length;){const k=i[h][0]==="const";k===!0&&h++;let L=i[h][0];L==="in"||L==="out"||L==="inout"?h++:L="";const U=i[h++][0];let P=Number.parseInt(i[h][0]);Number.isNaN(P)===!1?h++:P=null;const $=i[h++][0];l.push(new JW(U,$,P,L,k))}const p=t.substring(n[0].length),y=n[3]!==void 0?n[3]:"",x=n[2],S=n[1]!==void 0?n[1]:"",A=e!==-1?s.slice(0,e):"";return{type:x,inputs:l,name:y,precision:S,inputsCode:r,blockCode:p,headerCode:A}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class EVe extends n${constructor(e){const{type:t,inputs:n,name:r,precision:i,inputsCode:o,blockCode:l,headerCode:h}=wVe(e);super(t,n,r,i),this.inputsCode=o,this.blockCode=l,this.headerCode=h}getCode(e=this.name){let t;const n=this.blockCode;if(n!==""){const{type:r,inputsCode:i,headerCode:o,precision:l}=this;let h=`${r} ${e} ( ${i.trim()} )`;l!==""&&(h=`${l} ${h}`),t=o+h+n}else t="";return t}}class TVe extends N5e{parseFunction(e){return new EVe(e)}}class D5e extends Kk{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,n=e.reflectedLight,r=e.irradianceLightMap;n.indirectDiffuse.assign(Jr(0)),r?n.indirectDiffuse.addAssign(r):n.indirectDiffuse.addAssign(Jr(1,1,1,0)),n.indirectDiffuse.mulAssign(t),n.indirectDiffuse.mulAssign(Yi.rgb)}finish(e){const{material:t,context:n}=e,r=n.outgoingLight,i=e.context.environment;if(i)switch(t.combine){case Nk:r.rgb.assign(ea(r.rgb,r.rgb.mul(i.rgb),HI.mul(CV)));break;case mNe:r.rgb.assign(ea(r.rgb,i.rgb,HI.mul(CV)));break;case gNe:r.rgb.addAssign(i.rgb.mul(HI.mul(CV)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const MVe=()=>$t(.25),CVe=un(({dotNH:s})=>lj.mul($t(.5)).add(1).mul($t(1/Math.PI)).mul(s.pow(lj))),AVe=un(({lightDirection:s})=>{const e=s.add(ba).normalize(),t=ao.dot(e).clamp(),n=ba.dot(e).clamp(),r=zE({f0:Cc,f90:1,dotVH:n}),i=MVe(),o=CVe({dotNH:t});return r.mul(i).mul(o)});class O5e extends D5e{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const i=ao.dot(e).clamp().mul(t);n.directDiffuse.addAssign(i.mul(nx({diffuseColor:Yi.rgb}))),this.specular===!0&&n.directSpecular.addAssign(i.mul(AVe({lightDirection:e})).mul(HI))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(nx({diffuseColor:Yi}))),r.indirectDiffuse.mulAssign(t)}}const F5e=un(s=>{const{dotNV:e,specularColor:t,specularF90:n,roughness:r}=s,i=E5e({dotNV:e,roughness:r});return t.mul(i.x).add(n.mul(i.y))}),PVe=un(({roughness:s,dotNH:e})=>{const t=s.pow2(),n=$t(1).div(t),i=e.pow2().oneMinus().max(.0078125);return $t(2).add(n).mul(i.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),RVe=un(({dotNV:s,dotNL:e})=>$t(1).div($t(4).mul(e.add(s).sub(e.mul(s))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),IVe=un(({lightDirection:s})=>{const e=s.add(ba).normalize(),t=ao.dot(s).clamp(),n=ao.dot(ba).clamp(),r=ao.dot(e).clamp(),i=PVe({roughness:IW,dotNH:r}),o=RVe({dotNV:n,dotNL:t});return S_.mul(i).mul(o)}),kVe=un(({N:s,V:e,roughness:t})=>{const i=.0078125,o=s.dot(e).saturate(),l=In(t,o.oneMinus().sqrt());return l.assign(l.mul(.984375).add(i)),l}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),NVe=un(({f:s})=>{const e=s.length();return el(e.mul(e).add(s.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),oI=un(({v1:s,v2:e})=>{const t=s.dot(e),n=t.abs().toVar(),r=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),i=n.add(4.1616724).mul(n).add(3.417594).toVar(),o=r.div(i),l=t.greaterThan(0).select(o,el(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return s.cross(e).mul(l)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),s2e=un(({N:s,V:e,P:t,mInv:n,p0:r,p1:i,p2:o,p3:l})=>{const h=i.sub(r).toVar(),p=l.sub(r).toVar(),y=h.cross(p),x=Yt().toVar();return Xa(y.dot(t.sub(r)).greaterThanEqual(0),()=>{const S=e.sub(s.mul(e.dot(s))).normalize(),A=s.cross(S).negate(),k=n.mul(jl(S,A,s).transpose()).toVar(),L=k.mul(r.sub(t)).normalize().toVar(),U=k.mul(i.sub(t)).normalize().toVar(),P=k.mul(o.sub(t)).normalize().toVar(),$=k.mul(l.sub(t)).normalize().toVar(),Z=Yt(0).toVar();Z.addAssign(oI({v1:L,v2:U})),Z.addAssign(oI({v1:U,v2:P})),Z.addAssign(oI({v1:P,v2:$})),Z.addAssign(oI({v1:$,v2:L})),x.assign(Yt(NVe({f:Z})))}),x}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),a2e=un(([s,e,t,n,r])=>{const i=Yt(L4e(e.negate(),LE(s),h1(1,n))),o=Yt(Og(r[0].xyz),Og(r[1].xyz),Og(r[2].xyz));return LE(i).mul(t.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),DVe=un(([s,e])=>s.mul(Bg(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),OVe=e5e(),FVe=e5e(),o2e=un(([s,e,t],{material:n})=>{const i=(n.side===Nu?OVe:FVe).sample(s),o=Dg(cj.x).mul(DVe(e,t));return iBe(i,o)}),l2e=un(([s,e,t])=>(Xa(t.notEqual(0),()=>{const n=C4e(e).negate().div(t);return M4e(n.negate().mul(s))}),Yt(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),LVe=un(([s,e,t,n,r,i,o,l,h,p,y,x,S,A,k])=>{let L,U;if(k){L=Jr().toVar(),U=Yt().toVar();const ie=y.sub(1).mul(k.mul(.025)),ce=Yt(y.sub(ie),y,y.add(ie));wf({start:0,end:3},({i:ue})=>{const Q=ce.element(ue),oe=a2e(s,e,x,Q,l),le=o.add(oe),J=p.mul(h.mul(Jr(le,1))),Be=In(J.xy.div(J.w)).toVar();Be.addAssign(1),Be.divAssign(2),Be.assign(In(Be.x,Be.y.oneMinus()));const He=o2e(Be,t,Q);L.element(ue).assign(He.element(ue)),L.a.addAssign(He.a),U.element(ue).assign(n.element(ue).mul(l2e(Og(oe),S,A).element(ue)))}),L.a.divAssign(3)}else{const ie=a2e(s,e,x,y,l),ce=o.add(ie),ue=p.mul(h.mul(Jr(ce,1))),Q=In(ue.xy.div(ue.w)).toVar();Q.addAssign(1),Q.divAssign(2),Q.assign(In(Q.x,Q.y.oneMinus())),L=o2e(Q,t,y),U=n.mul(l2e(Og(ie),S,A))}const P=U.rgb.mul(L.rgb),$=s.dot(e).clamp(),Z=Yt(F5e({dotNV:$,specularColor:r,specularF90:i,roughness:t})),I=U.r.add(U.g,U.b).div(3);return Jr(Z.oneMinus().mul(P),L.a.oneMinus().mul(I).oneMinus())}),UVe=jl(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),BVe=s=>{const e=s.sqrt();return Yt(1).add(e).div(Yt(1).sub(e))},u2e=(s,e)=>s.sub(e).div(s.add(e)).pow2(),zVe=(s,e)=>{const t=s.mul(2*Math.PI*1e-9),n=Yt(54856e-17,44201e-17,52481e-17),r=Yt(1681e3,1795300,2208400),i=Yt(43278e5,93046e5,66121e5),o=$t(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let l=n.mul(i.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(i).exp());return l=Yt(l.x.add(o),l.y,l.z).div(10685e-11),UVe.mul(l)},VVe=un(({outsideIOR:s,eta2:e,cosTheta1:t,thinFilmThickness:n,baseF0:r})=>{const i=ea(s,e,s4(0,.03,n)),l=s.div(i).pow2().mul(t.pow2().oneMinus()).oneMinus();Xa(l.lessThan(0),()=>Yt(1));const h=l.sqrt(),p=u2e(i,s),y=zE({f0:p,f90:1,dotVH:t}),x=y.oneMinus(),S=i.lessThan(s).select(Math.PI,0),A=$t(Math.PI).sub(S),k=BVe(r.clamp(0,.9999)),L=u2e(k,i.toVec3()),U=zE({f0:L,f90:1,dotVH:h}),P=Yt(k.x.lessThan(i).select(Math.PI,0),k.y.lessThan(i).select(Math.PI,0),k.z.lessThan(i).select(Math.PI,0)),$=i.mul(n,h,2),Z=Yt(A).add(P),I=y.mul(U).clamp(1e-5,.9999),ie=I.sqrt(),ce=x.pow2().mul(U).div(Yt(1).sub(I)),Q=y.add(ce).toVar(),oe=ce.sub(x).toVar();return wf({start:1,end:2,condition:"<=",name:"m"},({m:le})=>{oe.mulAssign(ie);const J=zVe($t(le).mul($),$t(le).mul(Z)).mul(2);Q.addAssign(oe.mul(J))}),Q.max(Yt(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),GVe=un(({normal:s,viewDir:e,roughness:t})=>{const n=s.dot(e).saturate(),r=t.pow2(),i=Z0(t.lessThan(.25),$t(-339.2).mul(r).add($t(161.4).mul(t)).sub(25.9),$t(-8.48).mul(r).add($t(14.3).mul(t)).sub(9.95)),o=Z0(t.lessThan(.25),$t(44).mul(r).sub($t(23.7).mul(t)).add(3.26),$t(1.97).mul(r).sub($t(3.27).mul(t)).add(.72));return Z0(t.lessThan(.25),0,$t(.1).mul(t).sub(.025)).add(i.mul(n).add(o).exp()).mul(1/Math.PI).saturate()}),nG=Yt(.04),rG=$t(1);class L5e extends Kk{constructor(e=!1,t=!1,n=!1,r=!1,i=!1,o=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=r,this.transmission=i,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Yt().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Yt().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Yt().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Yt().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Yt().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=ao.dot(ba).clamp();this.iridescenceFresnel=VVe({outsideIOR:$t(1),eta2:_4e,cosTheta1:t,thinFilmThickness:x4e,baseF0:Cc}),this.iridescenceF0=Pze({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=UE,n=aLe.sub(UE).normalize(),r=WW,i=e.context;i.backdrop=LVe(r,n,Tg,Yi,Cc,xk,t,Pv,Gg,HW,BI,b4e,w4e,S4e,this.dispersion?E4e:null),i.backdropAlpha=uj,Yi.a.mulAssign(ea(1,i.backdrop.a,uj))}super.start(e)}computeMultiscattering(e,t,n){const r=ao.dot(ba).clamp(),i=E5e({roughness:Tg,dotNV:r}),l=(this.iridescenceF0?kW.mix(Cc,this.iridescenceF0):Cc).mul(i.x).add(n.mul(i.y)),p=i.x.add(i.y).oneMinus(),y=Cc.add(Cc.oneMinus().mul(.047619)),x=l.mul(y).div(p.mul(y).oneMinus());e.addAssign(l),t.addAssign(x.mul(p))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const i=ao.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(i.mul(IVe({lightDirection:e}))),this.clearcoat===!0){const l=tE.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(l.mul(Zge({lightDirection:e,f0:nG,f90:rG,roughness:_k,normalView:tE})))}n.directDiffuse.addAssign(i.mul(nx({diffuseColor:Yi.rgb}))),n.directSpecular.addAssign(i.mul(Zge({lightDirection:e,f0:Cc,f90:1,roughness:Tg,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:r,reflectedLight:i,ltc_1:o,ltc_2:l}){const h=t.add(n).sub(r),p=t.sub(n).sub(r),y=t.sub(n).add(r),x=t.add(n).add(r),S=ao,A=ba,k=lo.toVar(),L=kVe({N:S,V:A,roughness:Tg}),U=o.sample(L).toVar(),P=l.sample(L).toVar(),$=jl(Yt(U.x,0,U.y),Yt(0,1,0),Yt(U.z,0,U.w)).toVar(),Z=Cc.mul(P.x).add(Cc.oneMinus().mul(P.y)).toVar();i.directSpecular.addAssign(e.mul(Z).mul(s2e({N:S,V:A,P:k,mInv:$,p0:h,p1:p,p2:y,p3:x}))),i.directDiffuse.addAssign(e.mul(Yi).mul(s2e({N:S,V:A,P:k,mInv:jl(1,0,0,0,1,0,0,0,1),p0:h,p1:p,p2:y,p3:x})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:n}=e.context;n.indirectDiffuse.addAssign(t.mul(nx({diffuseColor:Yi})))}indirectSpecular(e){const{radiance:t,iblIrradiance:n,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(n.mul(S_,GVe({normal:ao,viewDir:ba,roughness:IW}))),this.clearcoat===!0){const y=tE.dot(ba).clamp(),x=F5e({dotNV:y,specularColor:nG,specularF90:rG,roughness:_k});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(x))}const i=Yt().toVar("singleScattering"),o=Yt().toVar("multiScattering"),l=n.mul(1/Math.PI);this.computeMultiscattering(i,o,xk);const h=i.add(o),p=Yi.mul(h.r.max(h.g).max(h.b).oneMinus());r.indirectSpecular.addAssign(t.mul(i)),r.indirectSpecular.addAssign(o.mul(l)),r.indirectDiffuse.addAssign(p.mul(l))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:n}=e.context,i=ao.dot(ba).clamp().add(t),o=Tg.mul(-16).oneMinus().negate().exp2(),l=t.sub(i.pow(o).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(l)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const n=tE.dot(ba).clamp(),r=zE({dotVH:n,f0:nG,f90:rG}),i=t.mul(aj.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(aj));t.assign(i)}if(this.sheen===!0){const n=S_.r.max(S_.g).max(S_.b).mul(.157).oneMinus(),r=t.mul(n).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const c2e=new WeakMap,Xp=[],Z8=[];class HVe extends u4{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new t2e,this.nodeBuilderCache=new Map,this.callHashCache=new Tf,this.groupsData=new Tf,this.cacheLib={}}updateGroup(e){const t=e.groupNode,n=t.name;if(n===v4e.name)return!0;if(n===zr.name){const i=this.get(e),o=this.nodeFrame.renderId;return i.renderId!==o?(i.renderId=o,!0):!1}if(n===mOe.name){const i=this.get(e),o=this.nodeFrame.frameId;return i.frameId!==o?(i.frameId=o,!0):!1}Xp[0]=t,Xp[1]=e;let r=this.groupsData.get(Xp);return r===void 0&&this.groupsData.set(Xp,r={}),Xp.length=0,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:r}=this,i=this.getForRenderCacheKey(e);if(n=r.get(i),n===void 0){const o=this.backend.createNodeBuilder(e.object,this.renderer);o.scene=e.scene,o.material=e.material,o.camera=e.camera,o.context.material=e.material,o.lightsNode=e.lightsNode,o.environmentNode=this.getEnvironmentNode(e.scene),o.fogNode=this.getFogNode(e.scene),o.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&o.enableMultiview(),o.build(),n=this._createNodeBuilderState(o),r.set(i,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new Dze(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){Xp[0]=e,Xp[1]=t;const n=this.renderer.info.calls,r=this.callHashCache.get(Xp)||{};if(r.callId!==n){const i=this.getEnvironmentNode(e),o=this.getFogNode(e);t&&Z8.push(t.getCacheKey(!0)),i&&Z8.push(i.getCacheKey()),o&&Z8.push(o.getCacheKey()),Z8.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),Z8.push(this.renderer.shadowMap.enabled?1:0),r.callId=n,r.cacheKey=_W(Z8),this.callHashCache.set(Xp,r),Z8.length=0}return Xp.length=0,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==n||r){const i=this.getCacheNode("background",n,()=>{if(n.isCubeTexture===!0||n.mapping===hW||n.mapping===dW||n.mapping===BH){if(e.backgroundBlurriness>0||n.mapping===BH)return w5e(n);{let o;return n.isCubeTexture===!0?o=BE(n):o=Hi(n),R5e(o)}}else{if(n.isTexture===!0)return Hi(n,F_.flipY()).setUpdateMatrix(!0);n.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",n)}},r);t.backgroundNode=i,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,n,r=!1){const i=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let o=i.get(t);return(o===void 0||r)&&(o=n(),i.set(t,o)),o}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){const r=this.getCacheNode("fog",n,()=>{if(n.isFogExp2){const i=Cs("color","color",n).setGroup(zr),o=Cs("density","float",n).setGroup(zr);return Oge(i,wBe(o))}else if(n.isFog){const i=Cs("color","color",n).setGroup(zr),o=Cs("near","float",n).setGroup(zr),l=Cs("far","float",n).setGroup(zr);return Oge(i,SBe(o,l))}else console.error("THREE.Renderer: Unsupported fog configuration.",n)});t.fogNode=r,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){const r=this.getCacheNode("environment",n,()=>{if(n.isCubeTexture===!0)return BE(n);if(n.isTexture===!0)return Hi(n);console.error("Nodes: Unsupported environment configuration.",n)});t.environmentNode=r,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,r=null,i=null){const o=this.nodeFrame;return o.renderer=e,o.scene=t,o.object=n,o.camera=r,o.material=i,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return c2e.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),r=e.isArrayTexture?uBe(e,Yt(F_,Vk("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):Hi(e,F_).renderOutput(t.toneMapping,t.currentColorSpace);return c2e.set(e,n),r}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const r of n.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const r of n.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new t2e,this.nodeBuilderCache=new Map,this.cacheLib={}}}const iG=new $3;class Sk{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Ou,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,n){const r=e.length;for(let i=0;i<r;i++){iG.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const o=t[n+i],l=iG.normal;o.x=-l.x,o.y=-l.y,o.z=-l.z,o.w=iG.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,i=r.length;let o,l;if(this.clipIntersection?(o=this.intersectionPlanes,l=e.intersectionPlanes.length):(o=this.unionPlanes,l=e.unionPlanes.length),o.length!==l+i){o.length=l+i;for(let h=0;h<i;h++)o[l+h]=new ki;n=!0}this.projectPlanes(r,o,l),n&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new Sk(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class jVe{constructor(e,t){this.bundleGroup=e,this.camera=t}}const Ow=[];class WVe{constructor(){this.bundles=new Tf}get(e,t){const n=this.bundles;Ow[0]=e,Ow[1]=t;let r=n.get(Ow);return r===void 0&&(r=new jVe(e,t),n.set(Ow,r)),Ow.length=0,r}dispose(){this.bundles=new Tf}}class U5e{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){t=new n;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}addClass(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}const $Ve=new y5e,Fw=[];class qVe extends Tf{constructor(){super()}createNode(e=[]){return new y5e().setLights(e)}getNode(e,t){if(e.isQuadMesh)return $Ve;Fw[0]=e,Fw[1]=t;let n=this.get(Fw);return n===void 0&&(n=this.createNode(),this.set(Fw,n)),Fw.length=0,n}}class XVe extends Pc{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class lI extends wo{constructor(){super(),this.isGroup=!0,this.type="Group"}}const YVe={type:"move"};class KVe{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new lI,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new lI,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new vt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new vt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new lI,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new vt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new vt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,o=null;const l=this._targetRay,h=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){o=!0;for(const L of e.hand.values()){const U=t.getJointPose(L,n),P=this._getHandJoint(p,L);U!==null&&(P.matrix.fromArray(U.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.matrixWorldNeedsUpdate=!0,P.jointRadius=U.radius),P.visible=U!==null}const y=p.joints["index-finger-tip"],x=p.joints["thumb-tip"],S=y.position.distanceTo(x.position),A=.02,k=.005;p.inputState.pinching&&S>A+k?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&S<=A-k&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(h.matrix.fromArray(i.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,i.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(i.linearVelocity)):h.hasLinearVelocity=!1,i.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(i.angularVelocity)):h.hasAngularVelocity=!1));l!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&i!==null&&(r=i),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(YVe)))}return l!==null&&(l.visible=r!==null),h!==null&&(h.visible=i!==null),p!==null&&(p.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new lI;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class rE extends Nv{constructor(e=1,t=1,n={}){super(e,t,n),this.isXRRenderTarget=!0,this.hasExternalTextures=!1,this.autoAllocateDepthBuffer=!0}copy(e){return super.copy(e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}class r$ extends Hg{constructor(e=1,t=1,n=1,r=32,i=1,o=!1,l=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:l,thetaLength:h};const p=this;r=Math.floor(r),i=Math.floor(i);const y=[],x=[],S=[],A=[];let k=0;const L=[],U=n/2;let P=0;$(),o===!1&&(e>0&&Z(!0),t>0&&Z(!1)),this.setIndex(y),this.setAttribute("position",new Hl(x,3)),this.setAttribute("normal",new Hl(S,3)),this.setAttribute("uv",new Hl(A,2));function $(){const I=new vt,ie=new vt;let ce=0;const ue=(t-e)/n;for(let Q=0;Q<=i;Q++){const oe=[],le=Q/i,J=le*(t-e)+e;for(let Be=0;Be<=r;Be++){const He=Be/r,rt=He*h+l,ot=Math.sin(rt),Se=Math.cos(rt);ie.x=J*ot,ie.y=-le*n+U,ie.z=J*Se,x.push(ie.x,ie.y,ie.z),I.set(ot,ue,Se).normalize(),S.push(I.x,I.y,I.z),A.push(He,1-le),oe.push(k++)}L.push(oe)}for(let Q=0;Q<r;Q++)for(let oe=0;oe<i;oe++){const le=L[oe][Q],J=L[oe+1][Q],Be=L[oe+1][Q+1],He=L[oe][Q+1];(e>0||oe!==0)&&(y.push(le,J,He),ce+=3),(t>0||oe!==i-1)&&(y.push(J,Be,He),ce+=3)}p.addGroup(P,ce,0),P+=ce}function Z(I){const ie=k,ce=new mi,ue=new vt;let Q=0;const oe=I===!0?e:t,le=I===!0?1:-1;for(let Be=1;Be<=r;Be++)x.push(0,U*le,0),S.push(0,le,0),A.push(.5,.5),k++;const J=k;for(let Be=0;Be<=r;Be++){const rt=Be/r*h+l,ot=Math.cos(rt),Se=Math.sin(rt);ue.x=oe*Se,ue.y=U*le,ue.z=oe*ot,x.push(ue.x,ue.y,ue.z),S.push(0,le,0),ce.x=ot*.5+.5,ce.y=Se*.5*le+.5,A.push(ce.x,ce.y),k++}for(let Be=0;Be<r;Be++){const He=ie+Be,rt=J+Be;I===!0?y.push(rt,rt+1,He):y.push(rt+1,rt,He),Q+=3}p.addGroup(P,Q,I===!0?1:2),P+=Q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new r$(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class i$ extends Hg{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,o=t/2,l=Math.floor(n),h=Math.floor(r),p=l+1,y=h+1,x=e/l,S=t/h,A=[],k=[],L=[],U=[];for(let P=0;P<y;P++){const $=P*S-o;for(let Z=0;Z<p;Z++){const I=Z*x-i;k.push(I,-$,0),L.push(0,0,1),U.push(Z/l),U.push(1-P/h)}}for(let P=0;P<h;P++)for(let $=0;$<l;$++){const Z=$+p*P,I=$+p*(P+1),ie=$+1+p*(P+1),ce=$+1+p*P;A.push(Z,I,ce),A.push(I,ie,ce)}this.setIndex(A),this.setAttribute("position",new Hl(k,3)),this.setAttribute("normal",new Hl(L,3)),this.setAttribute("uv",new Hl(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i$(e.width,e.height,e.widthSegments,e.heightSegments)}}const h2e=new vt,d2e=new vt;class ZVe extends kv{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Pc,this._cameraL.viewport=new ki,this._cameraR=new Pc,this._cameraR.viewport=new ki,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new XVe,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._frameBufferTargets=null,this._createXRLayer=rGe.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new mi,this._onSessionEvent=eGe.bind(this),this._onSessionEnd=tGe.bind(this),this._onInputSourcesChange=nGe.bind(this),this._onAnimationFrame=iGe.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,n,r,i,o,l,h={}){const p=new i$(e,t),y=new rE(i,o,{format:Bh,type:Vl,depthTexture:new u1(i,o,h.stencil?J3:$a,void 0,void 0,void 0,void 0,void 0,void 0,h.stencil?kg:l1),stencilBuffer:h.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});y.autoAllocateDepthBuffer=!0;const x=new K3({color:16777215,side:Pg});x.map=y.texture,x.map.offset.y=1,x.map.repeat.y=-1;const S=new zg(p,x);S.position.copy(n),S.quaternion.copy(r);const A={type:"quad",width:e,height:t,translation:n,quaternion:r,pixelwidth:i,pixelheight:o,plane:S,material:x,rendercall:l,renderTarget:y};if(this._layers.push(A),this._session!==null){A.plane.material=new K3({color:16777215,side:Pg}),A.plane.material.blending=dE,A.plane.material.blendEquation=Sf,A.plane.material.blendSrc=j3,A.plane.material.blendDst=j3,A.xrlayer=this._createXRLayer(A);const k=this._session.renderState.layers;k.unshift(A.xrlayer),this._session.updateRenderState({layers:k})}else y.isXRRenderTarget=!1;return S}createCylinderLayer(e,t,n,r,i,o,l,h,p={}){const y=new r$(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),x=new rE(o,l,{format:Bh,type:Vl,depthTexture:new u1(o,l,p.stencil?J3:$a,void 0,void 0,void 0,void 0,void 0,void 0,p.stencil?kg:l1),stencilBuffer:p.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});x.autoAllocateDepthBuffer=!0;const S=new K3({color:16777215,side:Nu});S.map=x.texture,S.map.offset.y=1,S.map.repeat.y=-1;const A=new zg(y,S);A.position.copy(r),A.quaternion.copy(i);const k={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:r,quaternion:i,pixelwidth:o,pixelheight:l,plane:A,material:S,rendercall:h,renderTarget:x};if(this._layers.push(k),this._session!==null){k.plane.material=new K3({color:16777215,side:Nu}),k.plane.material.blending=dE,k.plane.material.blendEquation=Sf,k.plane.material.blendSrc=j3,k.plane.material.blendDst=j3,k.xrlayer=this._createXRLayer(k);const L=this._session.renderState.layers;L.unshift(k.xrlayer),this._session.updateRenderState({layers:L})}else x.isXRRenderTarget=!1;return A}renderLayers(){const e=new vt,t=new hx,n=this._renderer,r=this.isPresenting,i=n.getOutputRenderTarget(),o=n._frameBufferTarget;this.isPresenting=!1;const l=new mi;n.getSize(l);const h=n._quad;for(const p of this._layers)if(p.renderTarget.isXRRenderTarget=this._session!==null,p.renderTarget.hasExternalTextures=p.renderTarget.isXRRenderTarget,p.renderTarget.isXRRenderTarget&&this._supportsLayers){p.xrlayer.transform=new XRRigidTransform(p.plane.getWorldPosition(e),p.plane.getWorldQuaternion(t));const y=this._glBinding.getSubImage(p.xrlayer,this._xrFrame);n.backend.setXRRenderTargetTextures(p.renderTarget,y.colorTexture,void 0),n._setXRLayerSize(p.renderTarget.width,p.renderTarget.height),n.setOutputRenderTarget(p.renderTarget),n.setRenderTarget(null),n._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:x,quad:S}=this._frameBufferTargets.get(p.renderTarget)||{frameBufferTarget:null,quad:null};x?(n._frameBufferTarget=x,n._quad=S):(n._quad=new YW(new uo),this._frameBufferTargets.set(p.renderTarget,{frameBufferTarget:n._getFrameBufferTarget(),quad:n._quad})),p.rendercall(),n._frameBufferTarget=null}else n.setRenderTarget(p.renderTarget),p.rendercall();n.setRenderTarget(null),n.setOutputRenderTarget(i),n._frameBufferTarget=o,n._setXRLayerSize(l.x,l.y),n._quad=h,this.isPresenting=r}getSession(){return this._session}async setSession(e){const t=this._renderer,n=t.backend;this._gl=t.getContext();const r=this._gl,i=r.getContextAttributes();if(this._session=e,e!==null){if(n.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await n.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._useLayers===!0){let o=null,l=null,h=null;t.depth&&(h=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,o=t.stencil?kg:l1,l=t.stencil?J3:$a);const p={colorFormat:r.RGBA8,depthFormat:h,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(p.textureType="texture-array",this._useMultiview=!0);const y=new XRWebGLBinding(e,r),x=y.createProjectionLayer(p),S=[x];this._glBinding=y,this._glProjLayer=x,t.setPixelRatio(1),t._setXRLayerSize(x.textureWidth,x.textureHeight);const A=this._useMultiview?2:1,k=new u1(x.textureWidth,x.textureHeight,l,void 0,void 0,void 0,void 0,void 0,void 0,o,A);if(this._xrRenderTarget=new rE(x.textureWidth,x.textureHeight,{format:Bh,type:Vl,colorSpace:t.outputColorSpace,depthTexture:k,stencilBuffer:t.stencil,samples:i.antialias?4:0,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget.hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const L of this._layers)L.plane.material=new K3({color:16777215,side:L.type==="cylinder"?Nu:Pg}),L.plane.material.blending=dE,L.plane.material.blendEquation=Sf,L.plane.material.blendSrc=j3,L.plane.material.blendDst=j3,L.xrlayer=this._createXRLayer(L),S.unshift(L.xrlayer);e.updateRenderState({layers:S})}else{const o={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},l=new XRWebGLLayer(e,r,o);this._glBaseLayer=l,e.updateRenderState({baseLayer:l}),t.setPixelRatio(1),t._setXRLayerSize(l.framebufferWidth,l.framebufferHeight),this._xrRenderTarget=new rE(l.framebufferWidth,l.framebufferHeight,{format:Bh,type:Vl,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:l.ignoreDepthValues===!1,resolveStencilBuffer:l.ignoreDepthValues===!1}),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const n=e.near,r=e.far,i=this._cameraXR,o=this._cameraL,l=this._cameraR;i.near=l.near=o.near=n,i.far=l.far=o.far=r,i.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==i.near||this._currentDepthFar!==i.far)&&(t.updateRenderState({depthNear:i.near,depthFar:i.far}),this._currentDepthNear=i.near,this._currentDepthFar=i.far),o.layers.mask=e.layers.mask|2,l.layers.mask=e.layers.mask|4,i.layers.mask=o.layers.mask|l.layers.mask;const h=e.parent,p=i.cameras;f2e(i,h);for(let y=0;y<p.length;y++)f2e(p[y],h);p.length===2?QVe(i,o,l):i.projectionMatrix.copy(o.projectionMatrix),JVe(e,i,h)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new KVe,this._controllers[e]=t),t}}function QVe(s,e,t){h2e.setFromMatrixPosition(e.matrixWorld),d2e.setFromMatrixPosition(t.matrixWorld);const n=h2e.distanceTo(d2e),r=e.projectionMatrix.elements,i=t.projectionMatrix.elements,o=r[14]/(r[10]-1),l=r[14]/(r[10]+1),h=(r[9]+1)/r[5],p=(r[9]-1)/r[5],y=(r[8]-1)/r[0],x=(i[8]+1)/i[0],S=o*y,A=o*x,k=n/(-y+x),L=k*-y;if(e.matrixWorld.decompose(s.position,s.quaternion,s.scale),s.translateX(L),s.translateZ(k),s.matrixWorld.compose(s.position,s.quaternion,s.scale),s.matrixWorldInverse.copy(s.matrixWorld).invert(),r[10]===-1)s.projectionMatrix.copy(e.projectionMatrix),s.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const U=o+k,P=l+k,$=S-L,Z=A+(n-L),I=h*l/P*U,ie=p*l/P*U;s.projectionMatrix.makePerspective($,Z,I,ie,U,P),s.projectionMatrixInverse.copy(s.projectionMatrix).invert()}}function f2e(s,e){e===null?s.matrixWorld.copy(s.matrix):s.matrixWorld.multiplyMatrices(e.matrixWorld,s.matrix),s.matrixWorldInverse.copy(s.matrixWorld).invert()}function JVe(s,e,t){t===null?s.matrix.copy(e.matrixWorld):(s.matrix.copy(t.matrixWorld),s.matrix.invert(),s.matrix.multiply(e.matrixWorld)),s.matrix.decompose(s.position,s.quaternion,s.scale),s.updateMatrixWorld(!0),s.projectionMatrix.copy(e.projectionMatrix),s.projectionMatrixInverse.copy(e.projectionMatrixInverse),s.isPerspectiveCamera&&(s.fov=Y_*2*Math.atan(1/s.projectionMatrix.elements[5]),s.zoom=1)}function eGe(s){const e=this._controllerInputSources.indexOf(s.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const n=this.getReferenceSpace();t.update(s.inputSource,s.frame,n),t.dispatchEvent({type:s.type,data:s.inputSource})}}function tGe(){const s=this._session,e=this._renderer;s.removeEventListener("select",this._onSessionEvent),s.removeEventListener("selectstart",this._onSessionEvent),s.removeEventListener("selectend",this._onSessionEvent),s.removeEventListener("squeeze",this._onSessionEvent),s.removeEventListener("squeezestart",this._onSessionEvent),s.removeEventListener("squeezeend",this._onSessionEvent),s.removeEventListener("end",this._onSessionEnd),s.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const n=this._controllerInputSources[t];n!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(n))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const t of this._layers)t.renderTarget=new rE(t.pixelwidth,t.pixelheight,{format:Bh,type:Vl,depthTexture:new u1(t.pixelwidth,t.pixelheight,t.stencilBuffer?J3:$a,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?kg:l1),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function nGe(s){const e=this._controllers,t=this._controllerInputSources;for(let n=0;n<s.removed.length;n++){const r=s.removed[n],i=t.indexOf(r);i>=0&&(t[i]=null,e[i].disconnect(r))}for(let n=0;n<s.added.length;n++){const r=s.added[n];let i=t.indexOf(r);if(i===-1){for(let l=0;l<e.length;l++)if(l>=t.length){t.push(r),i=l;break}else if(t[l]===null){t[l]=r,i=l;break}if(i===-1)break}const o=e[i];o&&o.connect(r)}}function rGe(s){return s.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(s.translation,s.quaternion),width:s.width/2,height:s.height/2,space:this._referenceSpace,viewPixelWidth:s.pixelwidth,viewPixelHeight:s.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(s.translation,s.quaternion),radius:s.radius,centralAngle:s.centralAngle,aspectRatio:s.aspectRatio,space:this._referenceSpace,viewPixelWidth:s.pixelwidth,viewPixelHeight:s.pixelheight,clearOnAccess:!1})}function iGe(s,e){if(e===void 0)return;const t=this._cameraXR,n=this._renderer,r=n.backend,i=this._glBaseLayer,o=this.getReferenceSpace(),l=e.getViewerPose(o);if(this._xrFrame=e,l!==null){const h=l.views;this._glBaseLayer!==null&&r.setXRTarget(i.framebuffer);let p=!1;h.length!==t.cameras.length&&(t.cameras.length=0,p=!0);for(let y=0;y<h.length;y++){const x=h[y];let S;if(this._useLayers===!0){const k=this._glBinding.getViewSubImage(this._glProjLayer,x);S=k.viewport,y===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,k.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:k.depthStencilTexture)}else S=i.getViewport(x);let A=this._cameras[y];A===void 0&&(A=new Pc,A.layers.enable(y),A.viewport=new ki,this._cameras[y]=A),A.matrix.fromArray(x.transform.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale),A.projectionMatrix.fromArray(x.projectionMatrix),A.projectionMatrixInverse.copy(A.projectionMatrix).invert(),A.viewport.set(S.x,S.y,S.width,S.height),y===0&&(t.matrix.copy(A.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),p===!0&&t.cameras.push(A)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let h=0;h<this._controllers.length;h++){const p=this._controllerInputSources[h],y=this._controllers[h];p!==null&&y!==void 0&&y.update(p,e,o)}this._currentAnimationLoop&&this._currentAnimationLoop(s,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const Q8=new zk,uI=new vt;class s${constructor(e=new $3,t=new $3,n=new $3,r=new $3,i=new $3,o=new $3){this.planes=[e,t,n,r,i,o]}set(e,t,n,r,i,o){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(n),l[3].copy(r),l[4].copy(i),l[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ru){const n=this.planes,r=e.elements,i=r[0],o=r[1],l=r[2],h=r[3],p=r[4],y=r[5],x=r[6],S=r[7],A=r[8],k=r[9],L=r[10],U=r[11],P=r[12],$=r[13],Z=r[14],I=r[15];if(n[0].setComponents(h-i,S-p,U-A,I-P).normalize(),n[1].setComponents(h+i,S+p,U+A,I+P).normalize(),n[2].setComponents(h+o,S+y,U+k,I+$).normalize(),n[3].setComponents(h-o,S-y,U-k,I-$).normalize(),n[4].setComponents(h-l,S-x,U-L,I-Z).normalize(),t===Ru)n[5].setComponents(h+l,S+x,U+L,I+Z).normalize();else if(t===i4)n[5].setComponents(l,x,L,Z).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Q8.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Q8.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Q8)}intersectsSprite(e){return Q8.center.set(0,0,0),Q8.radius=.7071067811865476,Q8.applyMatrix4(e.matrixWorld),this.intersectsSphere(Q8)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(uI.x=r.normal.x>0?e.max.x:e.min.x,uI.y=r.normal.y>0?e.max.y:e.min.y,uI.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(uI)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Yp=new As,Kp=new s$;class a${constructor(){this.coordinateSystem=Ru}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Yp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Kp.setFromProjectionMatrix(Yp,this.coordinateSystem),Kp.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Yp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Kp.setFromProjectionMatrix(Yp,this.coordinateSystem),Kp.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Yp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Kp.setFromProjectionMatrix(Yp,this.coordinateSystem),Kp.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Yp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Kp.setFromProjectionMatrix(Yp,this.coordinateSystem),Kp.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Yp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Kp.setFromProjectionMatrix(Yp,this.coordinateSystem),Kp.containsPoint(e))return!0}return!1}clone(){return new a$}}const p2e=new xW,cI=new mi,sG=new ki,aG=new s$,oG=new a$,hI=new As,L3=new ki;class sGe{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:r=!0,depth:i=!0,stencil:o=!1,antialias:l=!1,samples:h=0,getFallback:p=null,colorBufferType:y=Uh,multiview:x=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=h||l===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=n,this.outputColorSpace=Ac,this.toneMapping=R_,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=i,this.stencil=o,this.info=new lDe,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new U5e,this.lighting=new qVe,this._getFallback=p,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new ki(0,0,this._width,this._height),this._scissor=new ki(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new YW(new uo),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const S=this.alpha===!0?0:1;this._clearColor=new wW(0,0,0,S),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=y,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:dNe},this.xr=new ZVe(this,x),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(A,k,L)=>{await this.compileAsync(A,k);const U=this._renderLists.get(A,k),P=this._renderContexts.get(A,k,this._renderTarget),$=A.overrideMaterial||L.material,Z=this._objects.get(L,$,A,k,U.lightsNode,P,P.clippingContext),{fragmentShader:I,vertexShader:ie}=Z.getNodeBuilderState();return{fragmentShader:I,vertexShader:ie}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=n=this._getFallback(r),await n.init(this)}catch(i){t(i);return}else{t(r);return}}this._nodes=new HVe(this,n),this._animation=new qke(this._nodes,this.info),this._attributes=new iDe(n),this._background=new kze(this,this._nodes),this._geometries=new oDe(this._attributes,this.info),this._textures=new IDe(this,n,this.info),this._pipelines=new dDe(n,this._nodes),this._bindings=new fDe(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new tDe(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new gDe(this.lighting),this._bundles=new WVe,this._renderContexts=new MDe,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,i=r.renderId,o=this._currentRenderContext,l=this._currentRenderObjectFunction,h=this._compilationPromises,p=e.isScene===!0?e:p2e;n===null&&(n=e);const y=this._renderTarget,x=this._renderContexts.get(n,t,y),S=this._activeMipmapLevel,A=[];this._currentRenderContext=x,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=A,r.renderId++,r.update(),x.depth=this.depth,x.stencil=this.stencil,x.clippingContext||(x.clippingContext=new Sk),x.clippingContext.updateGlobal(p,t),p.onBeforeRender(this,e,t,y);const k=this._renderLists.get(e,t);if(k.begin(),this._projectObject(e,t,0,k,x.clippingContext),n!==e&&n.traverseVisible(function(Z){Z.isLight&&Z.layers.test(t.layers)&&k.pushLight(Z)}),k.finish(),y!==null){this._textures.updateRenderTarget(y,S);const Z=this._textures.get(y);x.textures=Z.textures,x.depthTexture=Z.depthTexture}else x.textures=null,x.depthTexture=null;this._background.update(p,k,x);const L=k.opaque,U=k.transparent,P=k.transparentDoublePass,$=k.lightsNode;this.opaque===!0&&L.length>0&&this._renderObjects(L,t,p,$),this.transparent===!0&&U.length>0&&this._renderTransparents(U,P,t,p,$),r.renderId=i,this._currentRenderContext=o,this._currentRenderObjectFunction=l,this._compilationPromises=h,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(A)}async renderAsync(e,t){this._initialized===!1&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=dge,this.overrideNodes.modelNormalViewMatrix=fge):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===dge&&this.overrideNodes.modelNormalViewMatrix===fge}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:r,camera:i,renderList:o}=e,l=this._currentRenderContext,h=this._bundles.get(r,i),p=this.backend.get(h);p.renderContexts===void 0&&(p.renderContexts=new Set);const y=r.version!==p.version,x=p.renderContexts.has(l)===!1||y;if(p.renderContexts.add(l),x){this.backend.beginBundle(l),(p.renderObjects===void 0||y)&&(p.renderObjects=[]),this._currentRenderBundle=h;const{transparentDoublePass:S,transparent:A,opaque:k}=o;this.opaque===!0&&k.length>0&&this._renderObjects(k,i,t,n),this.transparent===!0&&A.length>0&&this._renderTransparents(A,S,i,t,n),this._currentRenderBundle=null,this.backend.finishBundle(l,h),p.version=r.version}else{const{renderObjects:S}=p;for(let A=0,k=S.length;A<k;A++){const L=S[A];this._nodes.needsRefresh(L)&&(this._nodes.updateBefore(L),this._nodes.updateForRender(L),this._bindings.updateForRender(L),this._nodes.updateAfter(L))}}this.backend.addBundle(l,h)}render(e,t){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(e!==R_===!1&&t!==I_===!1)return null;const{width:i,height:o}=this.getDrawingBufferSize(cI),{depth:l,stencil:h}=this;let p=this._frameBufferTarget;p===null&&(p=new Nv(i,o,{depthBuffer:l,stencilBuffer:h,type:this._colorBufferType,format:Bh,colorSpace:I_,generateMipmaps:!1,minFilter:Dc,magFilter:Dc,samples:this.samples}),p.isPostProcessingRenderTarget=!0,this._frameBufferTarget=p);const y=this.getOutputRenderTarget();return p.depthBuffer=l,p.stencilBuffer=h,y!==null?p.setSize(y.width,y.height,y.depth):p.setSize(i,o,1),p.viewport.copy(this._viewport),p.scissor.copy(this._scissor),p.viewport.multiplyScalar(this._pixelRatio),p.scissor.multiplyScalar(this._pixelRatio),p.scissorTest=this._scissorTest,p.multiview=y!==null?y.multiview:!1,p.resolveDepthBuffer=y!==null?y.resolveDepthBuffer:!0,p.autoAllocateDepthBuffer=y!==null?y.autoAllocateDepthBuffer:!1,p}_renderScene(e,t,n=!0){if(this._isDeviceLost===!0)return;const r=n?this._getFrameBufferTarget():null,i=this._nodes.nodeFrame,o=i.renderId,l=this._currentRenderContext,h=this._currentRenderObjectFunction,p=e.isScene===!0?e:p2e,y=this._renderTarget||this._outputRenderTarget,x=this._activeCubeFace,S=this._activeMipmapLevel;let A;r!==null?(A=r,this.setRenderTarget(A)):A=y;const k=this._renderContexts.get(e,t,A);this._currentRenderContext=k,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,i.renderId=this.info.calls;const L=this.coordinateSystem,U=this.xr;if(t.coordinateSystem!==L&&U.isPresenting===!1&&(t.coordinateSystem=L,t.updateProjectionMatrix(),t.isArrayCamera))for(const He of t.cameras)He.coordinateSystem=L,He.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),U.enabled===!0&&U.isPresenting===!0&&(U.cameraAutoUpdate===!0&&U.updateCamera(t),t=U.getCamera());let P=this._viewport,$=this._scissor,Z=this._pixelRatio;A!==null&&(P=A.viewport,$=A.scissor,Z=1),this.getDrawingBufferSize(cI),sG.set(0,0,cI.width,cI.height);const I=P.minDepth===void 0?0:P.minDepth,ie=P.maxDepth===void 0?1:P.maxDepth;k.viewportValue.copy(P).multiplyScalar(Z).floor(),k.viewportValue.width>>=S,k.viewportValue.height>>=S,k.viewportValue.minDepth=I,k.viewportValue.maxDepth=ie,k.viewport=k.viewportValue.equals(sG)===!1,k.scissorValue.copy($).multiplyScalar(Z).floor(),k.scissor=this._scissorTest&&k.scissorValue.equals(sG)===!1,k.scissorValue.width>>=S,k.scissorValue.height>>=S,k.clippingContext||(k.clippingContext=new Sk),k.clippingContext.updateGlobal(p,t),p.onBeforeRender(this,e,t,A);const ce=t.isArrayCamera?oG:aG;t.isArrayCamera||(hI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ce.setFromProjectionMatrix(hI,L));const ue=this._renderLists.get(e,t);if(ue.begin(),this._projectObject(e,t,0,ue,k.clippingContext),ue.finish(),this.sortObjects===!0&&ue.sort(this._opaqueSort,this._transparentSort),A!==null){this._textures.updateRenderTarget(A,S);const He=this._textures.get(A);k.textures=He.textures,k.depthTexture=He.depthTexture,k.width=He.width,k.height=He.height,k.renderTarget=A,k.depth=A.depthBuffer,k.stencil=A.stencilBuffer}else k.textures=null,k.depthTexture=null,k.width=this.domElement.width,k.height=this.domElement.height,k.depth=this.depth,k.stencil=this.stencil;k.width>>=S,k.height>>=S,k.activeCubeFace=x,k.activeMipmapLevel=S,k.occlusionQueryCount=ue.occlusionQueryCount,this._background.update(p,ue,k),k.camera=t,this.backend.beginRender(k);const{bundles:Q,lightsNode:oe,transparentDoublePass:le,transparent:J,opaque:Be}=ue;return Q.length>0&&this._renderBundles(Q,p,oe),this.opaque===!0&&Be.length>0&&this._renderObjects(Be,t,p,oe),this.transparent===!0&&J.length>0&&this._renderTransparents(J,le,t,p,oe),this.backend.finishRender(k),i.renderId=o,this._currentRenderContext=l,this._currentRenderObjectFunction=h,r!==null&&(this.setRenderTarget(y,x,S),this._renderOutput(A)),p.onAfterRender(this,e,t,A),k}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const n=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,r){const i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,n,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,r,i=0,o=1){const l=this._viewport;e.isVector4?l.copy(e):l.set(e,t,n,r),l.minDepth=i,l.maxDepth=o}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,n);const r=this._renderTarget||this._getFrameBufferTarget();let i=null;if(r!==null){this._textures.updateRenderTarget(r);const o=this._textures.get(r);i=this._renderContexts.getForClear(r),i.textures=o.textures,i.depthTexture=o.depthTexture,i.width=o.width,i.height=o.height,i.renderTarget=r,i.depth=r.depthBuffer,i.stencil=r.stencilBuffer,i.clearColorValue=this.backend.getClearColor(),i.activeCubeFace=this.getActiveCubeFace(),i.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,i),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){this._initialized===!1&&await this.init(),this.clear(e,t,n)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:R_}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:I_}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,n=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,i=this._pipelines,o=this._bindings,l=this._nodes,h=Array.isArray(e)?e:[e];if(h[0]===void 0||h[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const p of h){if(i.has(p)===!1){const S=()=>{p.removeEventListener("dispose",S),i.delete(p),o.delete(p),l.delete(p)};p.addEventListener("dispose",S);const A=p.onInitFunction;A!==null&&A.call(p,{renderer:this})}l.updateForCompute(p),o.updateForCompute(p);const y=o.getForCompute(p),x=i.getForCompute(p,y);r.compute(e,p,y,x)}r.finishCompute(e),t.renderId=n}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=L3.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=L3.copy(t).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=L3.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,r;n!==null?r=n.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),n=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,n,t)}copyTextureToTexture(e,t,n=null,r=null,i=0,o=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,i,o)}async readRenderTargetPixelsAsync(e,t,n,r,i,o=0,l=0){return this.backend.copyTextureToBuffer(e.textures[o],t,n,r,i,l)}_projectObject(e,t,n,r,i){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(i=i.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const h=t.isArrayCamera?oG:aG;if(!e.frustumCulled||h.intersectsSprite(e,t)){this.sortObjects===!0&&L3.setFromMatrixPosition(e.matrixWorld).applyMatrix4(hI);const{geometry:p,material:y}=e;y.visible&&r.push(e,p,y,n,L3.z,null,i)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const h=t.isArrayCamera?oG:aG;if(!e.frustumCulled||h.intersectsObject(e,t)){const{geometry:p,material:y}=e;if(this.sortObjects===!0&&(p.boundingSphere===null&&p.computeBoundingSphere(),L3.copy(p.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(hI)),Array.isArray(y)){const x=p.groups;for(let S=0,A=x.length;S<A;S++){const k=x[S],L=y[k.materialIndex];L&&L.visible&&r.push(e,p,L,n,L3.z,k,i)}}else y.visible&&r.push(e,p,y,n,L3.z,null,i)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const h=r;r=this._renderLists.get(e,t),r.begin(),h.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const l=e.children;for(let h=0,p=l.length;h<p;h++)this._projectObject(l[h],t,n,r,i)}_renderBundles(e,t,n){for(const r of e)this._renderBundle(r,t,n)}_renderTransparents(e,t,n,r,i){if(t.length>0){for(const{material:o}of t)o.side=Nu;this._renderObjects(t,n,r,i,"backSide");for(const{material:o}of t)o.side=Pg;this._renderObjects(e,n,r,i);for(const{material:o}of t)o.side=P_}else this._renderObjects(e,n,r,i)}_renderObjects(e,t,n,r,i=null){for(let o=0,l=e.length;o<l;o++){const{object:h,geometry:p,material:y,group:x,clippingContext:S}=e[o];this._currentRenderObjectFunction(h,n,t,p,y,x,r,S,i)}}renderObject(e,t,n,r,i,o,l,h=null,p=null){let y,x,S;if(e.onBeforeRender(this,t,n,r,i,o),i.allowOverride===!0&&t.overrideMaterial!==null){const A=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(y=A.positionNode,A.positionNode=i.positionNode),A.alphaTest=i.alphaTest,A.alphaMap=i.alphaMap,A.transparent=i.transparent||i.transmission>0,A.isShadowPassMaterial&&(A.side=i.shadowSide===null?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(S=A.depthNode,A.depthNode=i.depthNode),i.castShadowNode&&i.castShadowNode.isNode&&(x=A.colorNode,A.colorNode=i.castShadowNode),i.castShadowPositionNode&&i.castShadowPositionNode.isNode&&(y=A.positionNode,A.positionNode=i.castShadowPositionNode)),i=A}i.transparent===!0&&i.side===P_&&i.forceSinglePass===!1?(i.side=Nu,this._handleObjectFunction(e,i,t,n,l,o,h,"backSide"),i.side=Pg,this._handleObjectFunction(e,i,t,n,l,o,h,p),i.side=P_):this._handleObjectFunction(e,i,t,n,l,o,h,p),y!==void 0&&(t.overrideMaterial.positionNode=y),S!==void 0&&(t.overrideMaterial.depthNode=S),x!==void 0&&(t.overrideMaterial.colorNode=x),e.onAfterRender(this,t,n,r,i,o)}_renderObjectDirect(e,t,n,r,i,o,l,h){const p=this._objects.get(e,t,n,r,i,this._currentRenderContext,l,h);p.drawRange=e.geometry.drawRange,p.group=o;const y=this._nodes.needsRefresh(p);y&&(this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p)),this._pipelines.updateForRender(p),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(p),p.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(p,this.info),y&&this._nodes.updateAfter(p)}_createObjectPipeline(e,t,n,r,i,o,l,h){const p=this._objects.get(e,t,n,r,i,this._currentRenderContext,l,h);p.drawRange=e.geometry.drawRange,p.group=o,this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p),this._pipelines.getForRender(p,this._compilationPromises),this._nodes.updateAfter(p)}get compile(){return this.compileAsync}}class o${constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function aGe(s){return s+(X3-s%X3)%X3}let B5e=class extends o${constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return aGe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}};class z5e extends B5e{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let oGe=0;class V5e extends z5e{constructor(e,t){super("UniformBuffer_"+oGe++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class lGe extends z5e{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let n=0,r=this.uniforms.length;n<r;n++){const i=this.uniforms[n],o=i.boundary,l=i.itemSize*e,h=t%X3,p=h%o,y=h+p;t+=p,y!==0&&X3-y<l&&(t+=X3-y),i.offset=t/e,t+=l}return Math.ceil(t/X3)*X3}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,o=e.getType();if(n[i]!==r){const l=this._getBufferForType(o);l[i]=n[i]=r,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,o=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y){const l=this._getBufferForType(o);l[i+0]=n[i+0]=r.x,l[i+1]=n[i+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,o=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z){const l=this._getBufferForType(o);l[i+0]=n[i+0]=r.x,l[i+1]=n[i+1]=r.y,l[i+2]=n[i+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,o=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z||n[i+4]!==r.w){const l=this._getBufferForType(o);l[i+0]=n[i+0]=r.x,l[i+1]=n[i+1]=r.y,l[i+2]=n[i+2]=r.z,l[i+3]=n[i+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.r||n[i+1]!==r.g||n[i+2]!==r.b){const o=this.buffer;o[i+0]=n[i+0]=r.r,o[i+1]=n[i+1]=r.g,o[i+2]=n[i+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;if(n[i+0]!==r[0]||n[i+1]!==r[1]||n[i+2]!==r[2]||n[i+4]!==r[3]||n[i+5]!==r[4]||n[i+6]!==r[5]||n[i+8]!==r[6]||n[i+9]!==r[7]||n[i+10]!==r[8]){const o=this.buffer;o[i+0]=n[i+0]=r[0],o[i+1]=n[i+1]=r[1],o[i+2]=n[i+2]=r[2],o[i+4]=n[i+4]=r[3],o[i+5]=n[i+5]=r[4],o[i+6]=n[i+6]=r[5],o[i+8]=n[i+8]=r[6],o[i+9]=n[i+9]=r[7],o[i+10]=n[i+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;return cGe(n,r,i)===!1&&(this.buffer.set(r,i),uGe(n,r,i),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function uGe(s,e,t){for(let n=0,r=e.length;n<r;n++)s[t+n]=e[n]}function cGe(s,e,t){for(let n=0,r=e.length;n<r;n++)if(s[t+n]!==e[n])return!1;return!0}let hGe=0;class G5e extends lGe{constructor(e,t){super(e),this.id=hGe++,this.groupNode=t,this.isNodeUniformsGroup=!0}}let dGe=0;class fGe extends o${constructor(e,t){super(e),this.id=dGe++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}}class Zk extends fGe{constructor(e,t,n,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class H5e extends Zk{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledCubeTexture=!0}}class j5e extends Zk{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledTexture3D=!0}}class pGe extends Q0{constructor(e=null,t=1,n=1,r,i,o,l,h,p=So,y=So,x,S){super(null,o,l,h,p,y,r,i,x,S),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const mGe={textureDimensions:"textureSize",equals:"equal"},gGe={low:"lowp",medium:"mediump",high:"highp"},m2e={swizzleAssign:!0,storageBuffer:!1},g2e={perspective:"smooth",linear:"noperspective"},v2e={centroid:"centroid","flat first":"flat","flat either":"flat"},y2e=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class vGe extends k5e{constructor(e,t){super(e,t,new TVe),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Lg}getMethod(e){return mGe[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(this.getType(o.type)+" "+o.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const n=t.array,r=t.count*t.itemSize,{itemSize:i}=t,o=t.array.constructor.name.toLowerCase().includes("int");let l=o?mW:pW;i===2?l=o?gW:bv:i===3?l=o?MNe:fW:i===4&&(l=o?vW:Bh);const h={Float32Array:Rc,Uint8Array:Vl,Uint16Array:__,Uint32Array:$a,Int8Array:fE,Int16Array:pE,Int32Array:Ul,Uint8ClampedArray:Vl},p=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/i))));let y=Math.ceil(r/i/p);p*y*i<r&&y++;const x=p*y*i,S=new n.constructor(x);S.set(n,0),t.array=S;const A=new pGe(t.array,p,y,l,h[t.array.constructor.name]||Rc);A.needsUpdate=!0,A.isPBOTexture=!0;const k=new fx(A,null,null);k.setPrecision("high"),t.pboNode=k,t.pbo=k.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,r=t.value;if(this.renderer.backend.has(r)){const y=this.renderer.backend.get(r);y.pbo=r.pbo}const i=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),o=this.getPropertyName(i);this.increaseUsage(n);const l=n.build(this,"uint"),h=this.getDataFromNode(e);let p=h.propertyName;if(p===void 0){const y=this.getVarFromNode(e);p=this.getPropertyName(y);const x=this.getDataFromNode(t);let S=x.propertySizeName;S===void 0&&(S=p+"Size",this.getVarFromNode(t,S,"uint"),this.addLineFlowCode(`${S} = uint( textureSize( ${o}, 0 ).x )`,e),x.propertySizeName=S);const{itemSize:A}=r,k="."+dx.join("").slice(0,A),L=`ivec2(${l} % ${S}, ${l} / ${S})`,U=this.generateTextureLoad(null,o,L,null,"0");let P="vec4";r.pbo.type===$a?P="uvec4":r.pbo.type===Ul&&(P="ivec4"),this.addLineFlowCode(`${p} = ${P}(${U})${k}`,e),h.propertyName=p}return p}generateTextureLoad(e,t,n,r,i="0"){return r?`texelFetch( ${t}, ivec3( ${n}, ${r} ), ${i} )`:`texelFetch( ${t}, ${n}, ${i} )`}generateTexture(e,t,n,r){return e.isDepthTexture?(r&&(n=`vec4( ${n}, ${r} )`),`texture( ${t}, ${n} ).x`):(r&&(n=`vec3( ${n}, ${r} )`),`texture( ${t}, ${n} )`)}generateTextureLevel(e,t,n,r){return`textureLod( ${t}, ${n}, ${r} )`}generateTextureBias(e,t,n,r){return`texture( ${t}, ${n}, ${r} )`}generateTextureGrad(e,t,n,r){return`textureGrad( ${t}, ${n}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,n,r,i,o=this.shaderStage){if(o==="fragment")return i?`texture( ${t}, vec4( ${n}, ${i}, ${r} ) )`:`texture( ${t}, vec3( ${n}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],n=[],r={};for(const o of t){let l=null,h=!1;if(o.type==="texture"||o.type==="texture3D"){const y=o.node.value;let x="";(y.isDataTexture===!0||y.isData3DTexture===!0)&&(y.type===$a?x="u":y.type===Ul&&(x="i")),o.type==="texture3D"&&y.isArrayTexture===!1?l=`${x}sampler3D ${o.name};`:y.compareFunction?y.isArrayTexture===!0?l=`sampler2DArrayShadow ${o.name};`:l=`sampler2DShadow ${o.name};`:y.isArrayTexture===!0||y.isDataArrayTexture===!0||y.isCompressedArrayTexture===!0?l=`${x}sampler2DArray ${o.name};`:l=`${x}sampler2D ${o.name};`}else if(o.type==="cubeTexture")l=`samplerCube ${o.name};`;else if(o.type==="buffer"){const y=o.node,x=this.getType(y.bufferType),S=y.bufferCount,A=S>0?S:"";l=`${y.name} {
	${x} ${o.name}[${A}];
};
`}else l=`${this.getVectorType(o.type)} ${this.getPropertyName(o,e)};`,h=!0;const p=o.node.precision;if(p!==null&&(l=gGe[p]+" "+l),h){l="	"+l;const y=o.groupNode.name;(r[y]||(r[y]=[])).push(l)}else l="uniform "+l,n.push(l)}let i="";for(const o in r){const l=r[o];i+=this._getGLSLUniformStruct(e+"_"+o,l.join(`
`))+`
`}return i+=n.join(`
`),i}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Ul){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let r=0;for(const i of n)t+=`layout( location = ${r++} ) in ${i.type} ${i.name};
`}return t}getStructMembers(e){const t=[];for(const n of e.members)t.push(`	${n.type} ${n.name};`);return t.join(`
`)}getStructs(e){const t=[],n=this.structs[e],r=[];for(const i of n)if(i.output)for(const o of i.members)r.push(`layout( location = ${o.index} ) out ${o.type} ${o.name};`);else{let o="struct "+i.name+` {
`;o+=this.getStructMembers(i),o+=`
};
`,t.push(o)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const r of n){e==="compute"&&(r.needsInterpolation=!0);const i=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const o=g2e[r.interpolationType]||r.interpolationType,l=v2e[r.interpolationSampling]||"";t+=`${o} ${l} out ${i} ${r.name};
`}else{const o=i.includes("int")||i.includes("uv")||i.includes("iv")?"flat ":"";t+=`${o}out ${i} ${r.name};
`}else t+=`${i} ${r.name};
`}else if(e==="fragment"){for(const r of n)if(r.needsInterpolation){const i=this.getType(r.type);if(r.interpolationType){const o=g2e[r.interpolationType]||r.interpolationType,l=v2e[r.interpolationSampling]||"";t+=`${o} ${l} in ${i} ${r.name};
`}else{const o=i.includes("int")||i.includes("uv")||i.includes("iv")?"flat ":"";t+=`${o}in ${i} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((n,r)=>n*r,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const r=this.extensions[n]||(this.extensions[n]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:r,behavior:i}of n.values())t.push(`#extension ${r} : ${i}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=m2e[e];if(t===void 0){let n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance";break}if(n!==void 0){const r=this.renderer.backend.extensions;r.has(n)&&(r.get(n),t=!0)}m2e[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const r=e[n],i=this.getPropertyName(r.attributeNode);i&&(t+=`${r.varyingName} = ${i};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${y2e}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${y2e}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n=`// code

`;n+=this.flowCode[t];const r=this.flowNodes[t],i=r[r.length-1];for(const l of r){const h=this.getFlowData(l),p=l.name;p&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${p}
	`),n+=`${h.code}
	`,l===i&&t!=="compute"&&(n+=`// result
	`,t==="vertex"?(n+="gl_Position = ",n+=`${h.result};`):t==="fragment"&&(l.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${h.result};`)))}const o=e[t];o.extensions=this.getExtensions(t),o.uniforms=this.getUniforms(t),o.attributes=this.getAttributes(t),o.varyings=this.getVaryings(t),o.vars=this.getVars(t),o.structs=this.getStructs(t),o.codes=this.getCodes(t),o.transforms=this.getTransforms(t),o.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),o=this.getDataFromNode(e,n,this.globalCache);let l=o.uniformGPU;if(l===void 0){const h=e.groupNode,p=h.name,y=this.getBindGroupArray(p,n);if(t==="texture")l=new Zk(i.name,i.node,h),y.push(l);else if(t==="cubeTexture")l=new H5e(i.name,i.node,h),y.push(l);else if(t==="texture3D")l=new j5e(i.name,i.node,h),y.push(l);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,i.name=`buffer${e.id}`;const x=new V5e(e,h);x.name=e.name,y.push(x),l=x}else{const x=this.uniformGroups[n]||(this.uniformGroups[n]={});let S=x[p];S===void 0&&(S=new G5e(n+"_"+p,h),x[p]=S,y.push(S)),l=this.getNodeUniform(i,t),S.addUniform(l)}o.uniformGPU=l}return i}}let lG=null,t_=null;class W5e{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){Ug("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t){Ug(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const n=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=n,n}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return lG=lG||new mi,this.renderer.getDrawingBufferSize(lG)}setScissorTest(){}getClearColor(){const e=this.renderer;return t_=t_||new wW,e.getClearColor(t_),t_.getRGB(t_),t_}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:HNe(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${M3e} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let yGe=0;class _Ge{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class xGe{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:r}=n,i=e.array,o=e.usage||r.STATIC_DRAW,l=e.isInterleavedBufferAttribute?e.data:e,h=n.get(l);let p=h.bufferGPU;p===void 0&&(p=this._createBuffer(r,t,i,o),h.bufferGPU=p,h.bufferType=t,h.version=l.version);let y;if(i instanceof Float32Array)y=r.FLOAT;else if(i instanceof Uint16Array)e.isFloat16BufferAttribute?y=r.HALF_FLOAT:y=r.UNSIGNED_SHORT;else if(i instanceof Int16Array)y=r.SHORT;else if(i instanceof Uint32Array)y=r.UNSIGNED_INT;else if(i instanceof Int32Array)y=r.INT;else if(i instanceof Int8Array)y=r.BYTE;else if(i instanceof Uint8Array)y=r.UNSIGNED_BYTE;else if(i instanceof Uint8ClampedArray)y=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+i);let x={bufferGPU:p,bufferType:t,type:y,byteLength:i.byteLength,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:y===r.INT||y===r.UNSIGNED_INT||e.gpuType===Ul,id:yGe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const S=this._createBuffer(r,t,i,o);x=new _Ge(x,S)}n.set(e,x)}updateAttribute(e){const t=this.backend,{gl:n}=t,r=e.array,i=e.isInterleavedBufferAttribute?e.data:e,o=t.get(i),l=o.bufferType,h=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(l,o.bufferGPU),h.length===0)n.bufferSubData(l,0,r);else{for(let p=0,y=h.length;p<y;p++){const x=h[p];n.bufferSubData(l,x.start*r.BYTES_PER_ELEMENT,r,x.start,x.count)}i.clearUpdateRanges()}n.bindBuffer(l,null),o.version=i.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:i}=t.get(r),o=e.array,l=o.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,i);const h=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,h),n.bufferData(n.COPY_WRITE_BUFFER,l,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,l),await t.utils._clientWaitAsync();const p=new e.array.constructor(o.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,h),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,p),n.deleteBuffer(h),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),p.buffer}_createBuffer(e,t,n,r){const i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,r),e.bindBuffer(t,null),i}}let uG,Lw;class bGe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;uG={[Sf]:e.FUNC_ADD,[C3e]:e.FUNC_SUBTRACT,[A3e]:e.FUNC_REVERSE_SUBTRACT},Lw={[j3]:e.ZERO,[P3e]:e.ONE,[R3e]:e.SRC_COLOR,[ok]:e.SRC_ALPHA,[F3e]:e.SRC_ALPHA_SATURATE,[D3e]:e.DST_COLOR,[k3e]:e.DST_ALPHA,[I3e]:e.ONE_MINUS_SRC_COLOR,[lk]:e.ONE_MINUS_SRC_ALPHA,[O3e]:e.ONE_MINUS_DST_COLOR,[N3e]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),n=e.getParameter(e.VIEWPORT);this.currentScissor=new ki().fromArray(t),this.currentViewport=new ki().fromArray(n),this._tempVec4=new ki}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==lNe?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===uNe?t.cullFace(t.BACK):e===cNe?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,n,r,i,o,l,h){const{gl:p}=this;if(e===K_){this.currentBlendingEnabled===!0&&(this.disable(p.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(p.BLEND),this.currentBlendingEnabled=!0),e!==dE){if(e!==this.currentBlending||h!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==Sf||this.currentBlendEquationAlpha!==Sf)&&(p.blendEquation(p.FUNC_ADD),this.currentBlendEquation=Sf,this.currentBlendEquationAlpha=Sf),h)switch(e){case Rg:p.blendFuncSeparate(p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case ik:p.blendFunc(p.ONE,p.ONE);break;case sk:p.blendFuncSeparate(p.ZERO,p.ONE_MINUS_SRC_COLOR,p.ZERO,p.ONE);break;case ak:p.blendFuncSeparate(p.ZERO,p.SRC_COLOR,p.ZERO,p.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Rg:p.blendFuncSeparate(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case ik:p.blendFunc(p.SRC_ALPHA,p.ONE);break;case sk:p.blendFuncSeparate(p.ZERO,p.ONE_MINUS_SRC_COLOR,p.ZERO,p.ONE);break;case ak:p.blendFunc(p.ZERO,p.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=h}return}i=i||t,o=o||n,l=l||r,(t!==this.currentBlendEquation||i!==this.currentBlendEquationAlpha)&&(p.blendEquationSeparate(uG[t],uG[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),(n!==this.currentBlendSrc||r!==this.currentBlendDst||o!==this.currentBlendSrcAlpha||l!==this.currentBlendDstAlpha)&&(p.blendFuncSeparate(Lw[n],Lw[r],Lw[o],Lw[l]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=l),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case L3e:t.depthFunc(t.NEVER);break;case U3e:t.depthFunc(t.ALWAYS);break;case B3e:t.depthFunc(t.LESS);break;case uk:t.depthFunc(t.LEQUAL);break;case z3e:t.depthFunc(t.EQUAL);break;case V3e:t.depthFunc(t.GEQUAL);break;case G3e:t.depthFunc(t.GREATER);break;case H3e:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,n,r){const i=this._tempVec4.set(e,t,n,r);if(this.currentScissor.equals(i)===!1){const{gl:o}=this;o.scissor(i.x,i.y,i.z,i.w),this.currentScissor.copy(i)}}viewport(e,t,n,r){const i=this._tempVec4.set(e,t,n,r);if(this.currentViewport.equals(i)===!1){const{gl:o}=this;o.viewport(i.x,i.y,i.z,i.w),this.currentViewport.copy(i)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t,n){const{gl:r}=this;e.side===P_?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let i=e.side===Nu;t&&(i=!i),this.setFlipSided(i),e.blending===Rg&&e.transparent===!1?this.setBlending(K_):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const o=e.stencilWrite;if(this.setStencilTest(o),o&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(let h=0;h<8;h++)h<n?this.enable(12288+h):this.disable(12288+h)}setPolygonOffset(e,t,n){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==n)&&(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const n=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(n.bindVertexArray(e),t!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:r}=this;return r[e]!==t?(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:n}=this;let r=[],i=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const o=e.textures;if(r.length!==o.length||r[0]!==n.COLOR_ATTACHMENT0){for(let l=0,h=o.length;l<h;l++)r[l]=n.COLOR_ATTACHMENT0+l;r.length=o.length,i=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,i=!0);i&&n.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:r,currentTextureSlot:i,currentBoundTextures:o,maxTextures:l}=this;n===void 0&&(i===null?n=r.TEXTURE0+l-1:n=i);let h=o[n];h===void 0&&(h={type:void 0,texture:void 0},o[n]=h),(h.type!==e||h.texture!==t)&&(i!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),h.type=e,h.texture=t)}bindBufferBase(e,t,n){const{gl:r}=this,i=`${e}-${t}`;return this.currentBoundBufferBases[i]!==n?(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[i]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,r=n[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class SGe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Lg){const{gl:n,extensions:r}=this;let i;const o=Us.getTransfer(t);if(e===Vl)return n.UNSIGNED_BYTE;if(e===wNe)return n.UNSIGNED_SHORT_4_4_4_4;if(e===ENe)return n.UNSIGNED_SHORT_5_5_5_1;if(e===W3e)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===fE)return n.BYTE;if(e===pE)return n.SHORT;if(e===__)return n.UNSIGNED_SHORT;if(e===Ul)return n.INT;if(e===$a)return n.UNSIGNED_INT;if(e===Rc)return n.FLOAT;if(e===Uh)return n.HALF_FLOAT;if(e===TNe)return n.ALPHA;if(e===fW)return n.RGB;if(e===Bh)return n.RGBA;if(e===l1)return n.DEPTH_COMPONENT;if(e===kg)return n.DEPTH_STENCIL;if(e===pW)return n.RED;if(e===mW)return n.RED_INTEGER;if(e===bv)return n.RG;if(e===gW)return n.RG_INTEGER;if(e===vW)return n.RGBA_INTEGER;if(e===uV||e===OI||e===FI||e===LI)if(o===Xr)if(i=r.get("WEBGL_compressed_texture_s3tc_srgb"),i!==null){if(e===uV)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===OI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===FI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===LI)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(i=r.get("WEBGL_compressed_texture_s3tc"),i!==null){if(e===uV)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===OI)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===FI)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===LI)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===Pme||e===Rme||e===Ime||e===kme)if(i=r.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(e===Pme)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Rme)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ime)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===kme)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===Nme||e===VH||e===GH)if(i=r.get("WEBGL_compressed_texture_etc"),i!==null){if(e===Nme||e===VH)return o===Xr?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===GH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===HH||e===jH||e===WH||e===$H||e===qH||e===XH||e===YH||e===KH||e===ZH||e===QH||e===JH||e===ej||e===tj||e===nj)if(i=r.get("WEBGL_compressed_texture_astc"),i!==null){if(e===HH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===jH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===WH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===$H)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===qH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===XH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===YH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===KH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===ZH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===QH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===JH)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===ej)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===tj)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===nj)return o===Xr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===cV)if(i=r.get("EXT_texture_compression_bptc"),i!==null){if(e===cV)return o===Xr?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===CNe||e===Dme||e===Ome||e===Fme)if(i=r.get("EXT_texture_compression_rgtc"),i!==null){if(e===cV)return i.COMPRESSED_RED_RGTC1_EXT;if(e===Dme)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===Ome)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===Fme)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===J3?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,r)=>{function i(){const o=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED){e.deleteSync(t),r();return}if(o===e.TIMEOUT_EXPIRED){requestAnimationFrame(i);return}e.deleteSync(t),n()}i()})}}let _2e=!1,dI,cG,x2e;class wGe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},_2e===!1&&(this._init(),_2e=!0)}_init(){const e=this.gl;dI={[Z_]:e.REPEAT,[Z3]:e.CLAMP_TO_EDGE,[Q_]:e.MIRRORED_REPEAT},cG={[So]:e.NEAREST,[j3e]:e.NEAREST_MIPMAP_NEAREST,[DE]:e.NEAREST_MIPMAP_LINEAR,[Dc]:e.LINEAR,[zH]:e.LINEAR_MIPMAP_NEAREST,[Ig]:e.LINEAR_MIPMAP_LINEAR},x2e={[$3e]:e.NEVER,[Q3e]:e.ALWAYS,[yW]:e.LESS,[X3e]:e.LEQUAL,[q3e]:e.EQUAL,[Z3e]:e.GEQUAL,[Y3e]:e.GREATER,[K3e]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let n;return e.isCubeTexture===!0?n=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=t.TEXTURE_3D:n=t.TEXTURE_2D,n}getInternalFormat(e,t,n,r,i=!1){const{gl:o,extensions:l}=this;if(e!==null){if(o[e]!==void 0)return o[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let h=t;if(t===o.RED&&(n===o.FLOAT&&(h=o.R32F),n===o.HALF_FLOAT&&(h=o.R16F),n===o.UNSIGNED_BYTE&&(h=o.R8),n===o.UNSIGNED_SHORT&&(h=o.R16),n===o.UNSIGNED_INT&&(h=o.R32UI),n===o.BYTE&&(h=o.R8I),n===o.SHORT&&(h=o.R16I),n===o.INT&&(h=o.R32I)),t===o.RED_INTEGER&&(n===o.UNSIGNED_BYTE&&(h=o.R8UI),n===o.UNSIGNED_SHORT&&(h=o.R16UI),n===o.UNSIGNED_INT&&(h=o.R32UI),n===o.BYTE&&(h=o.R8I),n===o.SHORT&&(h=o.R16I),n===o.INT&&(h=o.R32I)),t===o.RG&&(n===o.FLOAT&&(h=o.RG32F),n===o.HALF_FLOAT&&(h=o.RG16F),n===o.UNSIGNED_BYTE&&(h=o.RG8),n===o.UNSIGNED_SHORT&&(h=o.RG16),n===o.UNSIGNED_INT&&(h=o.RG32UI),n===o.BYTE&&(h=o.RG8I),n===o.SHORT&&(h=o.RG16I),n===o.INT&&(h=o.RG32I)),t===o.RG_INTEGER&&(n===o.UNSIGNED_BYTE&&(h=o.RG8UI),n===o.UNSIGNED_SHORT&&(h=o.RG16UI),n===o.UNSIGNED_INT&&(h=o.RG32UI),n===o.BYTE&&(h=o.RG8I),n===o.SHORT&&(h=o.RG16I),n===o.INT&&(h=o.RG32I)),t===o.RGB){const p=i?hk:Us.getTransfer(r);n===o.FLOAT&&(h=o.RGB32F),n===o.HALF_FLOAT&&(h=o.RGB16F),n===o.UNSIGNED_BYTE&&(h=o.RGB8),n===o.UNSIGNED_SHORT&&(h=o.RGB16),n===o.UNSIGNED_INT&&(h=o.RGB32UI),n===o.BYTE&&(h=o.RGB8I),n===o.SHORT&&(h=o.RGB16I),n===o.INT&&(h=o.RGB32I),n===o.UNSIGNED_BYTE&&(h=p===Xr?o.SRGB8:o.RGB8),n===o.UNSIGNED_SHORT_5_6_5&&(h=o.RGB565),n===o.UNSIGNED_SHORT_5_5_5_1&&(h=o.RGB5_A1),n===o.UNSIGNED_SHORT_4_4_4_4&&(h=o.RGB4),n===o.UNSIGNED_INT_5_9_9_9_REV&&(h=o.RGB9_E5)}if(t===o.RGB_INTEGER&&(n===o.UNSIGNED_BYTE&&(h=o.RGB8UI),n===o.UNSIGNED_SHORT&&(h=o.RGB16UI),n===o.UNSIGNED_INT&&(h=o.RGB32UI),n===o.BYTE&&(h=o.RGB8I),n===o.SHORT&&(h=o.RGB16I),n===o.INT&&(h=o.RGB32I)),t===o.RGBA){const p=i?hk:Us.getTransfer(r);n===o.FLOAT&&(h=o.RGBA32F),n===o.HALF_FLOAT&&(h=o.RGBA16F),n===o.UNSIGNED_BYTE&&(h=o.RGBA8),n===o.UNSIGNED_SHORT&&(h=o.RGBA16),n===o.UNSIGNED_INT&&(h=o.RGBA32UI),n===o.BYTE&&(h=o.RGBA8I),n===o.SHORT&&(h=o.RGBA16I),n===o.INT&&(h=o.RGBA32I),n===o.UNSIGNED_BYTE&&(h=p===Xr?o.SRGB8_ALPHA8:o.RGBA8),n===o.UNSIGNED_SHORT_4_4_4_4&&(h=o.RGBA4),n===o.UNSIGNED_SHORT_5_5_5_1&&(h=o.RGB5_A1)}return t===o.RGBA_INTEGER&&(n===o.UNSIGNED_BYTE&&(h=o.RGBA8UI),n===o.UNSIGNED_SHORT&&(h=o.RGBA16UI),n===o.UNSIGNED_INT&&(h=o.RGBA32UI),n===o.BYTE&&(h=o.RGBA8I),n===o.SHORT&&(h=o.RGBA16I),n===o.INT&&(h=o.RGBA32I)),t===o.DEPTH_COMPONENT&&(n===o.UNSIGNED_SHORT&&(h=o.DEPTH_COMPONENT16),n===o.UNSIGNED_INT&&(h=o.DEPTH_COMPONENT24),n===o.FLOAT&&(h=o.DEPTH_COMPONENT32F)),t===o.DEPTH_STENCIL&&n===o.UNSIGNED_INT_24_8&&(h=o.DEPTH24_STENCIL8),(h===o.R16F||h===o.R32F||h===o.RG16F||h===o.RG32F||h===o.RGBA16F||h===o.RGBA32F)&&l.get("EXT_color_buffer_float"),h}setTextureParameters(e,t){const{gl:n,extensions:r,backend:i}=this,o=Us.getPrimaries(Us.workingColorSpace),l=t.colorSpace===Lg?null:Us.getPrimaries(t.colorSpace),h=t.colorSpace===Lg||o===l?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,h),n.texParameteri(e,n.TEXTURE_WRAP_S,dI[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,dI[t.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||n.texParameteri(e,n.TEXTURE_WRAP_R,dI[t.wrapR])),n.texParameteri(e,n.TEXTURE_MAG_FILTER,cG[t.magFilter]);const p=t.mipmaps!==void 0&&t.mipmaps.length>0,y=t.minFilter===Dc&&p?Ig:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,cG[y]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,x2e[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===So||t.minFilter!==DE&&t.minFilter!==Ig||t.type===Rc&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const x=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,x.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:r}=this,i=this.getGLTextureType(e);let o=r[i];o===void 0&&(o=t.createTexture(),n.state.bindTexture(i,o),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),r[i]=o),n.set(e,{textureGPU:o,glTextureType:i,isDefault:!0})}createTexture(e,t){const{gl:n,backend:r}=this,{levels:i,width:o,height:l,depth:h}=t,p=r.utils.convert(e.format,e.colorSpace),y=r.utils.convert(e.type),x=this.getInternalFormat(e.internalFormat,p,y,e.colorSpace,e.isVideoTexture),S=n.createTexture(),A=this.getGLTextureType(e);r.state.bindTexture(A,S),this.setTextureParameters(A,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,i,x,o,l,h):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,i,x,o,l,h):e.isVideoTexture||n.texStorage2D(A,i,x,o,l),r.set(e,{textureGPU:S,glTextureType:A,glFormat:p,glType:y,glInternalFormat:x})}copyBufferToTexture(e,t){const{gl:n,backend:r}=this,{textureGPU:i,glTextureType:o,glFormat:l,glType:h}=r.get(t),{width:p,height:y}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(o,i),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(o,0,0,0,p,y,l,h,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:r,height:i}=t,{textureGPU:o,glTextureType:l,glFormat:h,glType:p,glInternalFormat:y}=this.backend.get(e);if(!(e.isRenderTargetTexture||o===void 0))if(this.backend.state.bindTexture(l,o),this.setTextureParameters(l,e),e.isCompressedTexture){const x=e.mipmaps,S=t.image;for(let A=0;A<x.length;A++){const k=x[A];e.isCompressedArrayTexture?e.format!==n.RGBA?h!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,A,0,0,0,k.width,k.height,S.depth,h,k.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,A,0,0,0,k.width,k.height,S.depth,h,p,k.data):h!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,A,0,0,k.width,k.height,h,k.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const x=t.images;for(let S=0;S<6;S++){const A=b2e(x[S]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+S,0,0,0,r,i,h,p,A)}}else if(e.isDataArrayTexture||e.isArrayTexture){const x=t.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,x.width,x.height,x.depth,h,p,x.data)}else if(e.isData3DTexture){const x=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,x.width,x.height,x.depth,h,p,x.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(l,0,y,h,p,t.image);else{const x=b2e(t.image);n.texSubImage2D(l,0,0,0,r,i,h,p,x)}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:r,glTextureType:i}=n.get(e);n.state.bindTexture(i,r),t.generateMipmap(i)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const i in r.framebuffers)t.deleteFramebuffer(r.framebuffers[i]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let i=0;i<r.msaaRenderbuffers.length;i++)t.deleteRenderbuffer(r.msaaRenderbuffers[i]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:n}=this,{textureGPU:r,renderTarget:i}=n.get(e);this.deallocateRenderBuffers(i),t.deleteTexture(r),n.delete(e)}copyTextureToTexture(e,t,n=null,r=null,i=0,o=0){const{gl:l,backend:h}=this,{state:p}=this.backend,{textureGPU:y,glTextureType:x,glType:S,glFormat:A}=h.get(t);p.bindTexture(x,y);let k,L,U,P,$,Z,I,ie,ce;const ue=e.isCompressedTexture?e.mipmaps[o]:e.image;if(n!==null)k=n.max.x-n.min.x,L=n.max.y-n.min.y,U=n.isBox3?n.max.z-n.min.z:1,P=n.min.x,$=n.min.y,Z=n.isBox3?n.min.z:0;else{const rt=Math.pow(2,-i);k=Math.floor(ue.width*rt),L=Math.floor(ue.height*rt),e.isDataArrayTexture||e.isArrayTexture?U=ue.depth:e.isData3DTexture?U=Math.floor(ue.depth*rt):U=1,P=0,$=0,Z=0}r!==null?(I=r.x,ie=r.y,ce=r.z):(I=0,ie=0,ce=0),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,t.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,t.unpackAlignment);const Q=l.getParameter(l.UNPACK_ROW_LENGTH),oe=l.getParameter(l.UNPACK_IMAGE_HEIGHT),le=l.getParameter(l.UNPACK_SKIP_PIXELS),J=l.getParameter(l.UNPACK_SKIP_ROWS),Be=l.getParameter(l.UNPACK_SKIP_IMAGES);l.pixelStorei(l.UNPACK_ROW_LENGTH,ue.width),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,ue.height),l.pixelStorei(l.UNPACK_SKIP_PIXELS,P),l.pixelStorei(l.UNPACK_SKIP_ROWS,$),l.pixelStorei(l.UNPACK_SKIP_IMAGES,Z);const He=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const rt=h.get(e),ot=h.get(t),Se=h.get(rt.renderTarget),gt=h.get(ot.renderTarget),Ae=Se.framebuffers[rt.cacheKey],lt=gt.framebuffers[ot.cacheKey];p.bindFramebuffer(l.READ_FRAMEBUFFER,Ae),p.bindFramebuffer(l.DRAW_FRAMEBUFFER,lt);let pt=l.COLOR_BUFFER_BIT;e.isDepthTexture&&(pt=l.DEPTH_BUFFER_BIT),l.blitFramebuffer(P,$,k,L,I,ie,k,L,pt,l.NEAREST),p.bindFramebuffer(l.READ_FRAMEBUFFER,null),p.bindFramebuffer(l.DRAW_FRAMEBUFFER,null)}else He?e.isDataTexture||e.isData3DTexture?l.texSubImage3D(x,o,I,ie,ce,k,L,U,A,S,ue.data):t.isCompressedArrayTexture?l.compressedTexSubImage3D(x,o,I,ie,ce,k,L,U,A,ue.data):l.texSubImage3D(x,o,I,ie,ce,k,L,U,A,S,ue):e.isDataTexture?l.texSubImage2D(x,o,I,ie,k,L,A,S,ue.data):e.isCompressedTexture?l.compressedTexSubImage2D(x,o,I,ie,ue.width,ue.height,A,ue.data):l.texSubImage2D(x,o,I,ie,k,L,A,S,ue);l.pixelStorei(l.UNPACK_ROW_LENGTH,Q),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,oe),l.pixelStorei(l.UNPACK_SKIP_PIXELS,le),l.pixelStorei(l.UNPACK_SKIP_ROWS,J),l.pixelStorei(l.UNPACK_SKIP_IMAGES,Be),o===0&&t.generateMipmaps&&l.generateMipmap(x),p.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:r}=this,{state:i}=this.backend,{textureGPU:o}=this.backend.get(e),{x:l,y:h,z:p,w:y}=n,x=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,S=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(x){const A=l!==0||h!==0;let k,L;if(e.isDepthTexture===!0?(k=r.DEPTH_BUFFER_BIT,L=r.DEPTH_ATTACHMENT,t.stencil&&(k|=r.STENCIL_BUFFER_BIT)):(k=r.COLOR_BUFFER_BIT,L=r.COLOR_ATTACHMENT0),A){const U=this.backend.get(t.renderTarget),P=U.framebuffers[t.getCacheKey()],$=U.msaaFrameBuffer;i.bindFramebuffer(r.DRAW_FRAMEBUFFER,P),i.bindFramebuffer(r.READ_FRAMEBUFFER,$);const Z=S-h-y;r.blitFramebuffer(l,Z,l+p,Z+y,l,Z,l+p,Z+y,k,r.NEAREST),i.bindFramebuffer(r.READ_FRAMEBUFFER,P),i.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,l,Z,p,y),i.unbindTexture()}else{const U=r.createFramebuffer();i.bindFramebuffer(r.DRAW_FRAMEBUFFER,U),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,L,r.TEXTURE_2D,o,0),r.blitFramebuffer(0,0,p,y,0,0,p,y,k,r.NEAREST),r.deleteFramebuffer(U)}}else i.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,l,S-y-h,p,y),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,n,r=!1){const{gl:i}=this,o=t.renderTarget,{depthTexture:l,depthBuffer:h,stencilBuffer:p,width:y,height:x}=o;if(i.bindRenderbuffer(i.RENDERBUFFER,e),h&&!p){let S=i.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(i.RENDERBUFFER,o.samples,S,y,x):n>0?(l&&l.isDepthTexture&&l.type===i.FLOAT&&(S=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,n,S,y,x)):i.renderbufferStorage(i.RENDERBUFFER,S,y,x),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else h&&p&&(n>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,n,i.DEPTH24_STENCIL8,y,x):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,y,x),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,n,r,i,o){const{backend:l,gl:h}=this,{textureGPU:p,glFormat:y,glType:x}=this.backend.get(e),S=h.createFramebuffer();h.bindFramebuffer(h.READ_FRAMEBUFFER,S);const A=e.isCubeTexture?h.TEXTURE_CUBE_MAP_POSITIVE_X+o:h.TEXTURE_2D;h.framebufferTexture2D(h.READ_FRAMEBUFFER,h.COLOR_ATTACHMENT0,A,p,0);const k=this._getTypedArrayType(x),L=this._getBytesPerTexel(x,y),P=r*i*L,$=h.createBuffer();h.bindBuffer(h.PIXEL_PACK_BUFFER,$),h.bufferData(h.PIXEL_PACK_BUFFER,P,h.STREAM_READ),h.readPixels(t,n,r,i,y,x,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null),await l.utils._clientWaitAsync();const Z=new k(P/k.BYTES_PER_ELEMENT);return h.bindBuffer(h.PIXEL_PACK_BUFFER,$),h.getBufferSubData(h.PIXEL_PACK_BUFFER,0,Z),h.bindBuffer(h.PIXEL_PACK_BUFFER,null),h.deleteFramebuffer(S),Z}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let r=0;if(e===n.UNSIGNED_BYTE&&(r=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(r=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(r=4),t===n.RGBA)return r*4;if(t===n.RGB)return r*3;if(t===n.ALPHA)return r}}function b2e(s){return s.isDataTexture?s.image.data:typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?s:s.data}class EGe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class TGe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const S2e={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class MGe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:r,object:i,type:o,info:l,index:h}=this;h!==0?n.drawElements(r,t,o,e):n.drawArrays(r,e,t),l.update(i,t,1)}renderInstances(e,t,n){const{gl:r,mode:i,type:o,index:l,object:h,info:p}=this;n!==0&&(l!==0?r.drawElementsInstanced(i,t,o,e,n):r.drawArraysInstanced(i,e,t,n),p.update(h,t,n))}renderMultiDraw(e,t,n){const{extensions:r,mode:i,object:o,info:l}=this;if(n===0)return;const h=r.get("WEBGL_multi_draw");if(h===null)for(let p=0;p<n;p++)this.render(e[p],t[p]);else{this.index!==0?h.multiDrawElementsWEBGL(i,t,0,this.type,e,0,n):h.multiDrawArraysWEBGL(i,e,0,t,0,n);let p=0;for(let y=0;y<n;y++)p+=t[y];l.update(o,p,1)}}renderMultiDrawInstances(e,t,n,r){const{extensions:i,mode:o,object:l,info:h}=this;if(n===0)return;const p=i.get("WEBGL_multi_draw");if(p===null)for(let y=0;y<n;y++)this.renderInstances(e[y],t[y],r[y]);else{this.index!==0?p.multiDrawElementsInstancedWEBGL(o,t,0,this.type,e,0,r,0,n):p.multiDrawArraysInstancedWEBGL(o,e,0,t,0,r,0,n);let y=0;for(let x=0;x<n;x++)y+=t[x]*r[x];h.update(l,y,1)}}}class $5e{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class CGe extends $5e{constructor(e,t,n=2048){if(super(n),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ug(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e.id,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t==null||this.activeQuery!==null)return;const n=this.queries[t];if(n)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){console.error("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){console.error("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[r,i]of this.queryStates)if(i==="ended"){const o=this.queries[r];e.push(this.resolveQuery(o))}if(e.length===0)return this.lastValue;const n=(await Promise.all(e)).reduce((r,i)=>r+i,0);return this.lastValue=n,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,n}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let n,r=!1;const i=()=>{n&&(clearTimeout(n),n=null)},o=h=>{r||(r=!0,i(),t(h))},l=()=>{if(this.isDisposed){o(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){o(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){n=setTimeout(l,1);return}const y=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(y)/1e6)}catch(h){console.error("Error checking query:",h),t(this.lastValue)}};l()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}const w2e=new mi;class E2e extends W5e{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,n={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",n);function i(o){o.preventDefault();const l={api:"WebGL",message:o.statusMessage||"Unknown reason",reason:null,originalEvent:o};e.onDeviceLost(l)}this._onContextLost=i,e.domElement.addEventListener("webglcontextlost",i,!1),this.gl=r,this.extensions=new EGe(this),this.capabilities=new TGe(this),this.attributeUtils=new xGe(this),this.textureUtils=new wGe(this),this.bufferRenderer=new MGe(this),this.state=new bGe(this),this.utils=new SGe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return Ru}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,n=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),n!==null){const i=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:i}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t]||(this.timestampQueryPool[t]=new CGe(this.gl,t,2048));const n=this.timestampQueryPool[t];n.allocateQueriesForContext(e)!==null&&n.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:t}=this,n=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:i,height:o}=this.getDrawingBufferSize(w2e);t.viewport(0,0,i,o)}if(e.scissor){const{x:i,y:o,width:l,height:h}=e.scissorValue;t.scissor(i,e.height-h-o,l,h)}this.initTimestampQuery(e),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const r=e.occlusionQueryCount;r>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(r),n.occlusionQueryObjects=new Array(r),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,r=this.get(e),i=r.previousContext;n.resetVertexState();const o=e.occlusionQueryCount;o>0&&(o>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const l=e.textures;if(l!==null)for(let h=0;h<l.length;h++){const p=l[h];p.generateMipmaps&&this.generateMipmaps(p)}if(this._currentContext=i,e.textures!==null&&e.renderTarget){const h=this.get(e.renderTarget),{resolveDepthBuffer:p,samples:y}=e.renderTarget;if(y>0&&this._useMultisampledExtension(e.renderTarget)===!1){const x=h.framebuffers[e.getCacheKey()],S=t.COLOR_BUFFER_BIT,A=h.msaaFrameBuffer,k=e.textures;n.bindFramebuffer(t.READ_FRAMEBUFFER,A),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,x);for(let L=0;L<k.length;L++)if(e.scissor){const{x:U,y:P,width:$,height:Z}=e.scissorValue,I=e.height-Z-P;t.blitFramebuffer(U,I,U+$,I+Z,U,I,U+$,I+Z,S,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,h.invalidationArray,U,I,$,Z)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,S,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,h.invalidationArray)}else if(p===!1&&h.framebuffers){const x=h.framebuffers[e.getCacheKey()];n.bindFramebuffer(t.DRAW_FRAMEBUFFER,x),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,h.depthInvalidationArray)}}if(i!==null)if(this._setFramebuffer(i),i.viewport)this.updateViewport(i);else{const{width:h,height:p}=this.getDrawingBufferSize(w2e);n.viewport(0,0,h,p)}this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const i=new WeakSet,{gl:o}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const l=()=>{let h=0;for(let p=0;p<n.length;p++){const y=n[p];y!==null&&o.getQueryParameter(y,o.QUERY_RESULT_AVAILABLE)&&(o.getQueryParameter(y,o.QUERY_RESULT)===0&&i.add(r[p]),n[p]=null,o.deleteQuery(y),h++)}h<n.length?requestAnimationFrame(l):t.occluded=i};l()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:n,y:r,width:i,height:o}=e.viewportValue;t.viewport(n,e.height-o-r,i,o)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,n,r=null,i=!0){const{gl:o,renderer:l}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let h=0;if(e&&(h|=o.COLOR_BUFFER_BIT),t&&(h|=o.DEPTH_BUFFER_BIT),n&&(h|=o.STENCIL_BUFFER_BIT),h!==0){let p;r.clearColorValue?p=r.clearColorValue:p=this.getClearColor();const y=l.getClearDepth(),x=l.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)o.clearColor(p.r,p.g,p.b,p.a),o.clear(h);else{if(i&&this._setFramebuffer(r),e)for(let S=0;S<r.textures.length;S++)S===0?o.clearBufferfv(o.COLOR,S,[p.r,p.g,p.b,p.a]):o.clearBufferfv(o.COLOR,S,[0,0,0,1]);t&&n?o.clearBufferfi(o.DEPTH_STENCIL,0,y,x):t?o.clearBufferfv(o.DEPTH,0,[y]):n&&o.clearBufferiv(o.STENCIL,0,[x])}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,n,r){const{state:i,gl:o}=this;this.discard===!1&&(o.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:l,transformBuffers:h,attributes:p}=this.get(r),y=this._getVaoKey(p),x=this.vaoCache[y];x===void 0?this._createVao(p):i.setVertexState(x),i.useProgram(l),this._bindUniforms(n);const S=this._getTransformFeedback(h);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,S),o.beginTransformFeedback(o.POINTS),p[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,t.count):o.drawArrays(o.POINTS,0,t.count),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let A=0;A<h.length;A++){const k=h[A];k.pbo&&this.textureUtils.copyBufferToTexture(k.transformBuffer,k.pbo),k.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:n,material:r,context:i,hardwareClippingPlanes:o}=e,{programGPU:l}=this.get(n),{gl:h,state:p}=this,y=this.get(i),x=e.getDrawParameters();if(x===null)return;this._bindUniforms(e.getBindings());const S=t.isMesh&&t.matrixWorld.determinant()<0;p.setMaterial(r,S,o),p.useProgram(l);const A=this.get(e);let k=A.staticVao;if(k===void 0||A.geometryId!==e.geometry.id){const ue=this._getVaoKey(e.getAttributes());if(k=this.vaoCache[ue],k===void 0){let Q;({vaoGPU:k,staticVao:Q}=this._createVao(e.getAttributes())),Q&&(A.staticVao=k,A.geometryId=e.geometry.id)}}const L=e.getIndex(),U=L!==null?this.get(L).bufferGPU:null;p.setVertexState(k,U);const P=y.lastOcclusionObject;if(P!==t&&P!==void 0){if(P!==null&&P.occlusionTest===!0&&(h.endQuery(h.ANY_SAMPLES_PASSED),y.occlusionQueryIndex++),t.occlusionTest===!0){const ue=h.createQuery();h.beginQuery(h.ANY_SAMPLES_PASSED,ue),y.occlusionQueries[y.occlusionQueryIndex]=ue,y.occlusionQueryObjects[y.occlusionQueryIndex]=t}y.lastOcclusionObject=t}const $=this.bufferRenderer;t.isPoints?$.mode=h.POINTS:t.isLineSegments?$.mode=h.LINES:t.isLine?$.mode=h.LINE_STRIP:t.isLineLoop?$.mode=h.LINE_LOOP:r.wireframe===!0?(p.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),$.mode=h.LINES):$.mode=h.TRIANGLES;const{vertexCount:Z,instanceCount:I}=x;let{firstVertex:ie}=x;if($.object=t,L!==null){ie*=L.array.BYTES_PER_ELEMENT;const ue=this.get(L);$.index=L.count,$.type=ue.type}else $.index=0;const ce=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(Ug("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),$.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?$.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):Ug("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):I>1?$.renderInstances(ie,Z,I):$.render(ie,Z)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const ue=this.get(e.camera),Q=e.camera.cameras,oe=e.getBindingGroup("cameraIndex").bindings[0];if(ue.indexesGPU===void 0||ue.indexesGPU.length!==Q.length){const ot=new Uint32Array([0,0,0,0]),Se=[];for(let gt=0,Ae=Q.length;gt<Ae;gt++){const lt=h.createBuffer();ot[0]=gt,h.bindBuffer(h.UNIFORM_BUFFER,lt),h.bufferData(h.UNIFORM_BUFFER,ot,h.STATIC_DRAW),Se.push(lt)}ue.indexesGPU=Se}const le=this.get(oe),J=this.renderer.getPixelRatio(),Be=this._currentContext.renderTarget,He=this._isRenderCameraDepthArray(this._currentContext),rt=this._currentContext.activeCubeFace;if(He){const ot=this.get(Be.depthTexture);if(ot.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){ot.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:Se}=Be;for(let gt=0,Ae=Q.length;gt<Ae;gt++)this.renderer._activeCubeFace=gt,this._currentContext.activeCubeFace=gt,this._setFramebuffer(this._currentContext),this.clear(!1,!0,Se,this._currentContext,!1);this.renderer._activeCubeFace=rt,this._currentContext.activeCubeFace=rt}}for(let ot=0,Se=Q.length;ot<Se;ot++){const gt=Q[ot];if(t.layers.test(gt.layers)){He&&(this.renderer._activeCubeFace=ot,this._currentContext.activeCubeFace=ot,this._setFramebuffer(this._currentContext));const Ae=gt.viewport;if(Ae!==void 0){const lt=Ae.x*J,pt=Ae.y*J,De=Ae.width*J,_t=Ae.height*J;p.viewport(Math.floor(lt),Math.floor(e.context.height-_t-pt),Math.floor(De),Math.floor(_t))}p.bindBufferBase(h.UNIFORM_BUFFER,le.index,ue.indexesGPU[ot]),ce()}this._currentContext.activeCubeFace=rt,this.renderer._activeCubeFace=rt}}else ce()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,i,o){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,o)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new vGe(e,t)}createProgram(e){const t=this.gl,{stage:n,code:r}=e,i=n==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,r),t.compileShader(i),this.set(e,{shaderGPU:i})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const n=this.gl,r=e.pipeline,{fragmentProgram:i,vertexProgram:o}=r,l=n.createProgram(),h=this.get(i).shaderGPU,p=this.get(o).shaderGPU;if(n.attachShader(l,h),n.attachShader(l,p),n.linkProgram(l),this.set(r,{programGPU:l,fragmentShader:h,vertexShader:p}),t!==null&&this.parallel){const y=new Promise(x=>{const S=this.parallel,A=()=>{n.getProgramParameter(l,S.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),x()):requestAnimationFrame(A)};A()});t.push(y);return}this._completeCompile(e,r)}_handleSource(e,t){const n=e.split(`
`),r=[],i=Math.max(t-6,0),o=Math.min(t+6,n.length);for(let l=i;l<o;l++){const h=l+1;r.push(`${h===t?">":" "} ${h}: ${n[l]}`)}return r.join(`
`)}_getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&i==="")return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const l=parseInt(o[1]);return n.toUpperCase()+`

`+i+`

`+this._handleSource(e.getShaderSource(t),l)}else return i}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const r=this.gl,i=r.getProgramInfoLog(e).trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,n,t);else{const o=this._getShaderErrors(r,n,"vertex"),l=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+i+`
`+o+`
`+l)}else i!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}_completeCompile(e,t){const{state:n,gl:r}=this,i=this.get(t),{programGPU:o,fragmentShader:l,vertexShader:h}=i;r.getProgramParameter(o,r.LINK_STATUS)===!1&&this._logProgramError(o,l,h),n.useProgram(o);const p=e.getBindings();this._setupBindings(p,o),this.set(t,{programGPU:o})}createComputePipeline(e,t){const{state:n,gl:r}=this,i={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(i);const{computeProgram:o}=e,l=r.createProgram(),h=this.get(i).shaderGPU,p=this.get(o).shaderGPU,y=o.transforms,x=[],S=[];for(let U=0;U<y.length;U++){const P=y[U];x.push(P.varyingName),S.push(P.attributeNode)}r.attachShader(l,h),r.attachShader(l,p),r.transformFeedbackVaryings(l,x,r.SEPARATE_ATTRIBS),r.linkProgram(l),r.getProgramParameter(l,r.LINK_STATUS)===!1&&this._logProgramError(l,h,p),n.useProgram(l),this._setupBindings(t,l);const A=o.attributes,k=[],L=[];for(let U=0;U<A.length;U++){const P=A[U].node.attribute;k.push(P),this.has(P)||this.attributeUtils.createAttribute(P,r.ARRAY_BUFFER)}for(let U=0;U<S.length;U++){const P=S[U].attribute;this.has(P)||this.attributeUtils.createAttribute(P,r.ARRAY_BUFFER);const $=this.get(P);L.push($)}this.set(e,{programGPU:l,transformBuffers:L,attributes:k})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let n=0,r=0;for(const i of t){this.set(i,{textures:r,uniformBuffers:n});for(const o of i.bindings)o.isUniformBuffer&&n++,o.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let r=n.uniformBuffers,i=n.textures;for(const o of e.bindings)if(o.isUniformsGroup||o.isUniformBuffer){const l=o.buffer,h=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,h),t.bufferData(t.UNIFORM_BUFFER,l,t.DYNAMIC_DRAW),this.set(o,{index:r++,bufferGPU:h})}else if(o.isSampledTexture){const{textureGPU:l,glTextureType:h}=this.get(o.texture);this.set(o,{index:i++,textureGPU:l,glTextureType:h})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,i=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(S2e).filter(r=>S2e[r]===e),n=this.extensions;for(let r=0;r<t.length;r++)if(n.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n=null,r=null,i=0,o=0){this.textureUtils.copyTextureToTexture(e,t,n,r,i,o)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}_setFramebuffer(e){const{gl:t,state:n}=this;let r=null;if(e.textures!==null){const i=e.renderTarget,o=this.get(i),{samples:l,depthBuffer:h,stencilBuffer:p}=i,y=i.isWebGLCubeRenderTarget===!0,x=i.isRenderTarget3D===!0,S=i.depth>1,A=i.isXRRenderTarget===!0,k=A===!0&&i.hasExternalTextures===!0;let L=o.msaaFrameBuffer,U=o.depthRenderbuffer;const P=this.extensions.get("WEBGL_multisampled_render_to_texture"),$=this.extensions.get("OVR_multiview2"),Z=this._useMultisampledExtension(i),I=u4e(e);let ie;if(y?(o.cubeFramebuffers||(o.cubeFramebuffers={}),ie=o.cubeFramebuffers[I]):A&&k===!1?ie=this._xrFramebuffer:(o.framebuffers||(o.framebuffers={}),ie=o.framebuffers[I]),ie===void 0){ie=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,ie);const ce=e.textures,ue=[];if(y){o.cubeFramebuffers[I]=ie;const{textureGPU:oe}=this.get(ce[0]),le=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+le,oe,0)}else{o.framebuffers[I]=ie;for(let oe=0;oe<ce.length;oe++){const le=ce[oe],J=this.get(le);J.renderTarget=e.renderTarget,J.cacheKey=I;const Be=t.COLOR_ATTACHMENT0+oe;if(i.multiview)$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Be,J.textureGPU,0,l,0,2);else if(x||S){const He=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,Be,J.textureGPU,0,He)}else Z?P.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Be,t.TEXTURE_2D,J.textureGPU,0,l):t.framebufferTexture2D(t.FRAMEBUFFER,Be,t.TEXTURE_2D,J.textureGPU,0)}n.drawBuffers(e,ie)}const Q=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(i.autoAllocateDepthBuffer===!0){const oe=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(oe,e,0,Z),o.xrDepthRenderbuffer=oe,ue.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,oe),t.framebufferRenderbuffer(t.FRAMEBUFFER,Q,t.RENDERBUFFER,oe)}else if(e.depthTexture!==null){ue.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const oe=this.get(e.depthTexture);if(oe.renderTarget=e.renderTarget,oe.cacheKey=I,i.multiview)$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Q,oe.textureGPU,0,l,0,2);else if(k&&Z)P.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Q,t.TEXTURE_2D,oe.textureGPU,0,l);else if(e.depthTexture.isArrayTexture){const le=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,Q,oe.textureGPU,0,le)}else t.framebufferTexture2D(t.FRAMEBUFFER,Q,t.TEXTURE_2D,oe.textureGPU,0)}o.depthInvalidationArray=ue}else{if(this._isRenderCameraDepthArray(e)){n.bindFramebuffer(t.FRAMEBUFFER,ie);const ue=this.renderer._activeCubeFace,Q=this.get(e.depthTexture),oe=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,oe,Q.textureGPU,0,ue)}if(A||Z||i.multiview){n.bindFramebuffer(t.FRAMEBUFFER,ie);const ue=this.get(e.textures[0]);i.multiview?$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,ue.textureGPU,0,l,0,2):Z?P.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ue.textureGPU,0,l):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ue.textureGPU,0);const Q=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(i.autoAllocateDepthBuffer===!0){const oe=o.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,oe),t.framebufferRenderbuffer(t.FRAMEBUFFER,Q,t.RENDERBUFFER,oe)}else{const oe=this.get(e.depthTexture);i.multiview?$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Q,oe.textureGPU,0,l,0,2):Z?P.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Q,t.TEXTURE_2D,oe.textureGPU,0,l):t.framebufferTexture2D(t.FRAMEBUFFER,Q,t.TEXTURE_2D,oe.textureGPU,0)}}}if(l>0&&Z===!1&&!i.multiview){if(L===void 0){const ce=[];L=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,L);const ue=[],Q=e.textures;for(let oe=0;oe<Q.length;oe++){if(ue[oe]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,ue[oe]),ce.push(t.COLOR_ATTACHMENT0+oe),h){const Be=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;ce.push(Be)}const le=e.textures[oe],J=this.get(le);t.renderbufferStorageMultisample(t.RENDERBUFFER,l,J.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+oe,t.RENDERBUFFER,ue[oe])}if(o.msaaFrameBuffer=L,o.msaaRenderbuffers=ue,U===void 0){U=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(U,e,l),o.depthRenderbuffer=U;const oe=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;ce.push(oe)}o.invalidationArray=ce}r=o.msaaFrameBuffer}else r=ie}n.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let n=0;n<e.length;n++){const r=this.get(e[n]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,n=t.createVertexArray();let r="",i=!0;t.bindVertexArray(n);for(let o=0;o<e.length;o++){const l=e[o],h=this.get(l);r+=":"+h.id,t.bindBuffer(t.ARRAY_BUFFER,h.bufferGPU),t.enableVertexAttribArray(o),(l.isStorageBufferAttribute||l.isStorageInstancedBufferAttribute)&&(i=!1);let p,y;l.isInterleavedBufferAttribute===!0?(p=l.data.stride*h.bytesPerElement,y=l.offset*h.bytesPerElement):(p=0,y=0),h.isInteger?t.vertexAttribIPointer(o,l.itemSize,h.type,p,y):t.vertexAttribPointer(o,l.itemSize,h.type,l.normalized,p,y),l.isInstancedBufferAttribute&&!l.isInterleavedBufferAttribute?t.vertexAttribDivisor(o,l.meshPerAttribute):l.isInterleavedBufferAttribute&&l.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(o,l.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),this.vaoCache[r]=n,{vaoGPU:n,staticVao:i}}_getTransformFeedback(e){let t="";for(let i=0;i<e.length;i++)t+=":"+e[i].id;let n=this.transformFeedbackCache[t];if(n!==void 0)return n;const{gl:r}=this;n=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let i=0;i<e.length;i++){const o=e[i];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,i,o.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const r of e)for(const i of r.bindings){const l=this.get(i).index;if(i.isUniformsGroup||i.isUniformBuffer){const h=n.getUniformBlockIndex(t,i.name);n.uniformBlockBinding(t,h,l)}else if(i.isSampledTexture){const h=n.getUniformLocation(t,i.name);n.uniform1i(h,l)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const r of e)for(const i of r.bindings){const o=this.get(i),l=o.index;i.isUniformsGroup||i.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,l,o.bufferGPU):i.isSampledTexture&&n.bindTexture(o.glTextureType,o.textureGPU,t.TEXTURE0+l)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const E_={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},m0={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Fl={Store:"store"},es={Load:"load",Clear:"clear"},hG={CCW:"ccw"},dG={None:"none",Front:"front",Back:"back"},rx={Uint16:"uint16",Uint32:"uint32"},Ke={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},fG={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},vv={Linear:"linear",Nearest:"nearest"},Qr={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},J8={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},T2e={None:0,All:15},U3={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},pG={Storage:"storage",ReadOnlyStorage:"read-only-storage"},mG={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},M2e={NonFiltering:"non-filtering",Comparison:"comparison"},ev={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},C2e={TwoD:"2d",ThreeD:"3d"},Vo={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},AGe={All:"all"},fI={Vertex:"vertex",Instance:"instance"},gj={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class PGe extends o${constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class RGe extends PGe{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){this.texture=this.textureNode.value}}class IGe extends B5e{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let kGe=0;class NGe extends IGe{constructor(e,t){super("StorageBuffer_"+kGe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:Mg.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class DGe extends u4{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,n=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:vv.Linear}),this.flipYSampler=e.createSampler({minFilter:vv.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:n}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:E_.TriangleStrip,stripIndexFormat:rx.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:E_.TriangleStrip,stripIndexFormat:rx.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,n=0){const r=t.format,{width:i,height:o}=t.size,l=this.getTransferPipeline(r),h=this.getFlipYPipeline(r),p=this.device.createTexture({size:{width:i,height:o,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),y=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Vo.TwoD,baseArrayLayer:n}),x=p.createView({baseMipLevel:0,mipLevelCount:1,dimension:Vo.TwoD,baseArrayLayer:0}),S=this.device.createCommandEncoder({}),A=(k,L,U)=>{const P=k.getBindGroupLayout(0),$=this.device.createBindGroup({layout:P,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:L}]}),Z=S.beginRenderPass({colorAttachments:[{view:U,loadOp:es.Clear,storeOp:Fl.Store,clearValue:[0,0,0,0]}]});Z.setPipeline(k),Z.setBindGroup(0,$),Z.draw(4,1,0,0),Z.end()};A(l,y,x),A(h,x,y),this.device.queue.submit([S.finish()]),p.destroy()}generateMipmaps(e,t,n=0){const r=this.get(e);r.useCount===void 0&&(r.useCount=0,r.layers=[]);const i=r.layers[n]||this._mipmapCreateBundles(e,t,n),o=this.device.createCommandEncoder({});this._mipmapRunBundles(o,i),this.device.queue.submit([o.finish()]),r.useCount!==0&&(r.layers[n]=i),r.useCount++}_mipmapCreateBundles(e,t,n){const r=this.getTransferPipeline(t.format),i=r.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Vo.TwoD,baseArrayLayer:n});const l=[];for(let h=1;h<t.mipLevelCount;h++){const p=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),y=e.createView({baseMipLevel:h,mipLevelCount:1,dimension:Vo.TwoD,baseArrayLayer:n}),x={colorAttachments:[{view:y,loadOp:es.Clear,storeOp:Fl.Store,clearValue:[0,0,0,0]}]},S=this.device.createRenderBundleEncoder({colorFormats:[t.format]});S.setPipeline(r),S.setBindGroup(0,p),S.draw(4,1,0,0),l.push({renderBundles:[S.finish()],passDescriptor:x}),o=y}return l}_mipmapRunBundles(e,t){const n=t.length;for(let r=0;r<n;r++){const i=t[r],o=e.beginRenderPass(i.passDescriptor);o.executeBundles(i.renderBundles),o.end()}}}const OGe={[$3e]:"never",[yW]:"less",[q3e]:"equal",[X3e]:"less-equal",[Y3e]:"greater",[Z3e]:"greater-equal",[Q3e]:"always",[K3e]:"not-equal"},FGe=[0,1,3,2,4,5];class LGe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new u1,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,n=t.device,r=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===vv.Linear&&i.minFilter===vv.Linear&&i.mipmapFilter===vv.Linear&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(i.compare=OGe[e.compareFunction]),r.sampler=n.createSampler(i)}createDefaultTexture(e){let t;const n=vj(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:i,height:o,depth:l,levels:h}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const p=this._getDimension(e),y=e.internalFormat||t.format||vj(e,n.device);r.format=y;const{samples:x,primarySamples:S,isMSAA:A}=n.utils.getTextureSampleData(e);let k=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(k|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(k|=GPUTextureUsage.RENDER_ATTACHMENT);const L={label:e.name,size:{width:i,height:o,depthOrArrayLayers:l},mipLevelCount:h,sampleCount:S,dimension:p,format:y,usage:k};if(e.isVideoTexture){const U=e.source.data,P=new VideoFrame(U);L.size.width=P.displayWidth,L.size.height=P.displayHeight,P.close(),r.externalTexture=U}else{if(y===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(L.textureBindingViewDimension=Vo.Cube),r.texture=n.device.createTexture(L)}if(A){const U=Object.assign({},L);U.label=U.label+"-msaa",U.sampleCount=x,r.msaaTexture=n.device.createTexture(U)}r.initialized=!0,r.textureDescriptorGPU=L}destroyTexture(e){const t=this.backend,n=t.get(e);n.texture!==void 0&&n.texture.destroy(),n.msaaTexture!==void 0&&n.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const n=this.backend.get(e);delete n.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let n=0;n<6;n++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,n);else{const n=e.image.depth||1;for(let r=0;r<n;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:n}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:n,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const n=this.backend,{width:r,height:i}=n.getDrawingBufferSize(),o=this.depthTexture,l=n.get(o).texture;let h,p;if(t?(h=kg,p=J3):e&&(h=l1,p=$a),l!==void 0){if(o.image.width===r&&o.image.height===i&&o.format===h&&o.type===p)return l;this.destroyTexture(o)}return o.name="depthBuffer",o.format=h,o.type=p,o.image.width=r,o.image.height=i,this.createTexture(o,{width:r,height:i}),n.get(o).texture}updateTexture(e,t){const n=this.backend.get(e),{textureDescriptorGPU:r}=n;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)this._copyBufferToTexture(t.image,n.texture,r,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let i=0;i<t.image.depth;i++)this._copyBufferToTexture(t.image,n.texture,r,i,e.flipY,i);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,n.texture,r,e.flipY,e.premultiplyAlpha);else if(e.isVideoTexture){const i=e.source.data;n.externalTexture=i}else this._copyImageToTexture(t.image,n.texture,r,0,e.flipY,e.premultiplyAlpha);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,n,r,i,o){const l=this.backend.device,h=this.backend.get(e),p=h.texture,y=h.textureDescriptorGPU.format,x=this._getBytesPerTexel(y);let S=r*x;S=Math.ceil(S/256)*256;const A=l.createBuffer({size:r*i*x,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),k=l.createCommandEncoder();k.copyTextureToBuffer({texture:p,origin:{x:t,y:n,z:o}},{buffer:A,bytesPerRow:S},{width:r,height:i});const L=this._getTypedArrayType(y);l.queue.submit([k.finish()]),await A.mapAsync(GPUMapMode.READ);const U=A.getMappedRange();return new L(U)}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new Q0;n.minFilter=So,n.magFilter=So,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new $k;n.minFilter=So,n.magFilter=So,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,n,r,i){for(let o=0;o<6;o++){const l=e[o],h=r===!0?FGe[o]:o;l.isDataTexture?this._copyBufferToTexture(l.image,t,n,h,r):this._copyImageToTexture(l,t,n,h,r,i)}}_copyImageToTexture(e,t,n,r,i,o){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:i},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r},premultipliedAlpha:o},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new DGe(this.backend.device)),e}_generateMipmaps(e,t,n=0){this._getPassUtils().generateMipmaps(e,t,n)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,r,i,o=0){const l=this.backend.device,h=e.data,p=this._getBytesPerTexel(n.format),y=e.width*p;l.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},h,{offset:e.width*e.height*p*o,bytesPerRow:y},{width:e.width,height:e.height,depthOrArrayLayers:1}),i===!0&&this._flipY(t,n,r)}_copyCompressedBufferToTexture(e,t,n){const r=this.backend.device,i=this._getBlockData(n.format),o=n.size.depthOrArrayLayers>1;for(let l=0;l<e.length;l++){const h=e[l],p=h.width,y=h.height,x=o?n.size.depthOrArrayLayers:1,S=Math.ceil(p/i.width)*i.byteLength,A=S*Math.ceil(y/i.height);for(let k=0;k<x;k++)r.queue.writeTexture({texture:t,mipLevel:l,origin:{x:0,y:0,z:k}},h.data,{offset:k*A,bytesPerRow:S,rowsPerImage:Math.ceil(y/i.height)},{width:Math.ceil(p/i.width)*i.width,height:Math.ceil(y/i.height)*i.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===Ke.BC1RGBAUnorm||e===Ke.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ke.BC2RGBAUnorm||e===Ke.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.BC3RGBAUnorm||e===Ke.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.BC4RUnorm||e===Ke.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===Ke.BC5RGUnorm||e===Ke.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===Ke.BC6HRGBUFloat||e===Ke.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===Ke.BC7RGBAUnorm||e===Ke.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.ETC2RGB8Unorm||e===Ke.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ke.ETC2RGB8A1Unorm||e===Ke.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ke.ETC2RGBA8Unorm||e===Ke.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===Ke.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===Ke.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===Ke.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===Ke.ASTC4x4Unorm||e===Ke.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.ASTC5x4Unorm||e===Ke.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===Ke.ASTC5x5Unorm||e===Ke.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===Ke.ASTC6x5Unorm||e===Ke.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===Ke.ASTC6x6Unorm||e===Ke.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===Ke.ASTC8x5Unorm||e===Ke.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===Ke.ASTC8x6Unorm||e===Ke.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===Ke.ASTC8x8Unorm||e===Ke.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===Ke.ASTC10x5Unorm||e===Ke.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===Ke.ASTC10x6Unorm||e===Ke.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===Ke.ASTC10x8Unorm||e===Ke.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===Ke.ASTC10x10Unorm||e===Ke.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===Ke.ASTC12x10Unorm||e===Ke.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===Ke.ASTC12x12Unorm||e===Ke.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=fG.ClampToEdge;return e===Z_?t=fG.Repeat:e===Q_&&(t=fG.MirrorRepeat),t}_convertFilterMode(e){let t=vv.Linear;return(e===So||e===j3e||e===DE)&&(t=vv.Nearest),t}_getBytesPerTexel(e){if(e===Ke.R8Unorm||e===Ke.R8Snorm||e===Ke.R8Uint||e===Ke.R8Sint)return 1;if(e===Ke.R16Uint||e===Ke.R16Sint||e===Ke.R16Float||e===Ke.RG8Unorm||e===Ke.RG8Snorm||e===Ke.RG8Uint||e===Ke.RG8Sint)return 2;if(e===Ke.R32Uint||e===Ke.R32Sint||e===Ke.R32Float||e===Ke.RG16Uint||e===Ke.RG16Sint||e===Ke.RG16Float||e===Ke.RGBA8Unorm||e===Ke.RGBA8UnormSRGB||e===Ke.RGBA8Snorm||e===Ke.RGBA8Uint||e===Ke.RGBA8Sint||e===Ke.BGRA8Unorm||e===Ke.BGRA8UnormSRGB||e===Ke.RGB9E5UFloat||e===Ke.RGB10A2Unorm||e===Ke.RG11B10UFloat||e===Ke.Depth32Float||e===Ke.Depth24Plus||e===Ke.Depth24PlusStencil8||e===Ke.Depth32FloatStencil8)return 4;if(e===Ke.RG32Uint||e===Ke.RG32Sint||e===Ke.RG32Float||e===Ke.RGBA16Uint||e===Ke.RGBA16Sint||e===Ke.RGBA16Float)return 8;if(e===Ke.RGBA32Uint||e===Ke.RGBA32Sint||e===Ke.RGBA32Float)return 16}_getTypedArrayType(e){if(e===Ke.R8Uint)return Uint8Array;if(e===Ke.R8Sint)return Int8Array;if(e===Ke.R8Unorm)return Uint8Array;if(e===Ke.R8Snorm)return Int8Array;if(e===Ke.RG8Uint)return Uint8Array;if(e===Ke.RG8Sint)return Int8Array;if(e===Ke.RG8Unorm)return Uint8Array;if(e===Ke.RG8Snorm)return Int8Array;if(e===Ke.RGBA8Uint)return Uint8Array;if(e===Ke.RGBA8Sint)return Int8Array;if(e===Ke.RGBA8Unorm)return Uint8Array;if(e===Ke.RGBA8Snorm)return Int8Array;if(e===Ke.R16Uint)return Uint16Array;if(e===Ke.R16Sint)return Int16Array;if(e===Ke.RG16Uint)return Uint16Array;if(e===Ke.RG16Sint)return Int16Array;if(e===Ke.RGBA16Uint)return Uint16Array;if(e===Ke.RGBA16Sint)return Int16Array;if(e===Ke.R16Float||e===Ke.RG16Float||e===Ke.RGBA16Float)return Uint16Array;if(e===Ke.R32Uint)return Uint32Array;if(e===Ke.R32Sint)return Int32Array;if(e===Ke.R32Float)return Float32Array;if(e===Ke.RG32Uint)return Uint32Array;if(e===Ke.RG32Sint)return Int32Array;if(e===Ke.RG32Float)return Float32Array;if(e===Ke.RGBA32Uint)return Uint32Array;if(e===Ke.RGBA32Sint)return Int32Array;if(e===Ke.RGBA32Float)return Float32Array;if(e===Ke.BGRA8Unorm||e===Ke.BGRA8UnormSRGB)return Uint8Array;if(e===Ke.RGB10A2Unorm||e===Ke.RGB9E5UFloat||e===Ke.RG11B10UFloat)return Uint32Array;if(e===Ke.Depth32Float)return Float32Array;if(e===Ke.Depth24Plus||e===Ke.Depth24PlusStencil8)return Uint32Array;if(e===Ke.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.isData3DTexture?t=C2e.ThreeD:t=C2e.TwoD,t}}function vj(s,e=null){const t=s.format,n=s.type,r=s.colorSpace,i=Us.getTransfer(r);let o;if(s.isCompressedTexture===!0||s.isCompressedArrayTexture===!0)switch(t){case OI:o=i===Xr?Ke.BC1RGBAUnormSRGB:Ke.BC1RGBAUnorm;break;case FI:o=i===Xr?Ke.BC2RGBAUnormSRGB:Ke.BC2RGBAUnorm;break;case LI:o=i===Xr?Ke.BC3RGBAUnormSRGB:Ke.BC3RGBAUnorm;break;case VH:o=i===Xr?Ke.ETC2RGB8UnormSRGB:Ke.ETC2RGB8Unorm;break;case GH:o=i===Xr?Ke.ETC2RGBA8UnormSRGB:Ke.ETC2RGBA8Unorm;break;case HH:o=i===Xr?Ke.ASTC4x4UnormSRGB:Ke.ASTC4x4Unorm;break;case jH:o=i===Xr?Ke.ASTC5x4UnormSRGB:Ke.ASTC5x4Unorm;break;case WH:o=i===Xr?Ke.ASTC5x5UnormSRGB:Ke.ASTC5x5Unorm;break;case $H:o=i===Xr?Ke.ASTC6x5UnormSRGB:Ke.ASTC6x5Unorm;break;case qH:o=i===Xr?Ke.ASTC6x6UnormSRGB:Ke.ASTC6x6Unorm;break;case XH:o=i===Xr?Ke.ASTC8x5UnormSRGB:Ke.ASTC8x5Unorm;break;case YH:o=i===Xr?Ke.ASTC8x6UnormSRGB:Ke.ASTC8x6Unorm;break;case KH:o=i===Xr?Ke.ASTC8x8UnormSRGB:Ke.ASTC8x8Unorm;break;case ZH:o=i===Xr?Ke.ASTC10x5UnormSRGB:Ke.ASTC10x5Unorm;break;case QH:o=i===Xr?Ke.ASTC10x6UnormSRGB:Ke.ASTC10x6Unorm;break;case JH:o=i===Xr?Ke.ASTC10x8UnormSRGB:Ke.ASTC10x8Unorm;break;case ej:o=i===Xr?Ke.ASTC10x10UnormSRGB:Ke.ASTC10x10Unorm;break;case tj:o=i===Xr?Ke.ASTC12x10UnormSRGB:Ke.ASTC12x10Unorm;break;case nj:o=i===Xr?Ke.ASTC12x12UnormSRGB:Ke.ASTC12x12Unorm;break;case Bh:o=i===Xr?Ke.RGBA8UnormSRGB:Ke.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case Bh:switch(n){case fE:o=Ke.RGBA8Snorm;break;case pE:o=Ke.RGBA16Sint;break;case __:o=Ke.RGBA16Uint;break;case $a:o=Ke.RGBA32Uint;break;case Ul:o=Ke.RGBA32Sint;break;case Vl:o=i===Xr?Ke.RGBA8UnormSRGB:Ke.RGBA8Unorm;break;case Uh:o=Ke.RGBA16Float;break;case Rc:o=Ke.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case fW:switch(n){case W3e:o=Ke.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case pW:switch(n){case fE:o=Ke.R8Snorm;break;case pE:o=Ke.R16Sint;break;case __:o=Ke.R16Uint;break;case $a:o=Ke.R32Uint;break;case Ul:o=Ke.R32Sint;break;case Vl:o=Ke.R8Unorm;break;case Uh:o=Ke.R16Float;break;case Rc:o=Ke.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case bv:switch(n){case fE:o=Ke.RG8Snorm;break;case pE:o=Ke.RG16Sint;break;case __:o=Ke.RG16Uint;break;case $a:o=Ke.RG32Uint;break;case Ul:o=Ke.RG32Sint;break;case Vl:o=Ke.RG8Unorm;break;case Uh:o=Ke.RG16Float;break;case Rc:o=Ke.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case l1:switch(n){case __:o=Ke.Depth16Unorm;break;case $a:o=Ke.Depth24Plus;break;case Rc:o=Ke.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case kg:switch(n){case J3:o=Ke.Depth24PlusStencil8;break;case Rc:e&&e.features.has(gj.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),o=Ke.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case mW:switch(n){case Ul:o=Ke.R32Sint;break;case $a:o=Ke.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case gW:switch(n){case Ul:o=Ke.RG32Sint;break;case $a:o=Ke.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case vW:switch(n){case Ul:o=Ke.RGBA32Sint;break;case $a:o=Ke.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}return o}const UGe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,BGe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,A2e={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},zGe=s=>{s=s.trim();const e=s.match(UGe);if(e!==null&&e.length===4){const t=e[2],n=[];let r=null;for(;(r=BGe.exec(t))!==null;)n.push({name:r[1],type:r[2]});const i=[];for(let y=0;y<n.length;y++){const{name:x,type:S}=n[y];let A=S;A.startsWith("ptr")?A="pointer":(A.startsWith("texture")&&(A=S.split("<")[0]),A=A2e[A]),i.push(new JW(A,x))}const o=s.substring(e[0].length),l=e[3]||"void",h=e[1]!==void 0?e[1]:"";return{type:A2e[l]||l,inputs:i,name:h,inputsCode:t,blockCode:o,outputType:l}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class VGe extends n${constructor(e){const{type:t,inputs:n,name:r,inputsCode:i,blockCode:o,outputType:l}=zGe(e);super(t,n,r),this.inputsCode=i,this.blockCode=o,this.outputType=l}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class GGe extends N5e{parseFunction(e){return new VGe(e)}}const n_=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},HGe={[Mg.READ_ONLY]:"read",[Mg.WRITE_ONLY]:"write",[Mg.READ_WRITE]:"read_write"},P2e={[Z_]:"repeat",[Z3]:"clamp",[Q_]:"mirror"},pI={vertex:n_?n_.VERTEX:1,fragment:n_?n_.FRAGMENT:2,compute:n_?n_.COMPUTE:4},R2e={instance:!0,swizzleAssign:!1,storageBuffer:!0},jGe={"^^":"tsl_xor"},WGe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},I2e={},Nh={tsl_xor:new bo("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new bo("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new bo("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new bo("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new bo("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new bo("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new bo("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new bo("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new bo("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new bo("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new bo("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new bo("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new bo(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},iE={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(Nh.pow_float=new bo("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),Nh.pow_vec2=new bo("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[Nh.pow_float]),Nh.pow_vec3=new bo("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[Nh.pow_float]),Nh.pow_vec4=new bo("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[Nh.pow_float]),iE.pow_float="tsl_pow_float",iE.pow_vec2="tsl_pow_vec2",iE.pow_vec3="tsl_pow_vec3",iE.pow_vec4="tsl_pow_vec4");let q5e="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(q5e+=`diagnostic( off, derivative_uniformity );
`);class $Ge extends k5e{constructor(e,t){super(e,t,new GGe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Lg}_generateTextureSample(e,t,n,r,i=this.shaderStage){return i==="fragment"?r?`textureSample( ${t}, ${t}_sampler, ${n}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this._generateTextureSampleLevel(e,t,n,"0",r)}_generateVideoSample(e,t,n=this.shaderStage){if(n==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${n} shader.`)}_generateTextureSampleLevel(e,t,n,r,i){return this.isUnfilterable(e)===!1?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,r):this.generateTextureLod(e,t,n,i,r)}generateWrapFunction(e){const t=`tsl_coord_${P2e[e.wrapS]}S_${P2e[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let n=I2e[t];if(n===void 0){const r=[],i=e.isData3DTexture?"vec3f":"vec2f";let o=`fn ${t}( coord : ${i} ) -> ${i} {

	return ${i}(
`;const l=(h,p)=>{h===Z_?(r.push(Nh.repeatWrapping_float),o+=`		tsl_repeatWrapping_float( coord.${p} )`):h===Z3?(r.push(Nh.clampWrapping_float),o+=`		tsl_clampWrapping_float( coord.${p} )`):h===Q_?(r.push(Nh.mirrorWrapping_float),o+=`		tsl_mirrorWrapping_float( coord.${p} )`):(o+=`		coord.${p}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${h}" for vertex shader.`))};l(e.wrapS,"x"),o+=`,
`,l(e.wrapT,"y"),e.isData3DTexture&&(o+=`,
`,l(e.wrapR,"z")),o+=`
	);

}
`,I2e[t]=n=new bo(o,r)}return n.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,n){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let i=r.dimensionsSnippet[n];if(r.dimensionsSnippet[n]===void 0){let o,l;const{primarySamples:h}=this.renderer.backend.utils.getTextureSampleData(e),p=h>1;e.isData3DTexture?l="vec3<u32>":l="vec2<u32>",p||e.isVideoTexture||e.isStorageTexture?o=t:o=`${t}${n?`, u32( ${n} )`:""}`,i=new zI(new GI(`textureDimensions( ${o} )`,l)),r.dimensionsSnippet[n]=i,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(r.arrayLayerCount=new zI(new GI(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new zI(new GI("6u","u32")))}return i.build(this)}generateFilteredTexture(e,t,n,r="0u"){this._include("biquadraticTexture");const i=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,r);return`tsl_biquadraticTexture( ${t}, ${i}( ${n} ), ${o}, u32( ${r} ) )`}generateTextureLod(e,t,n,r,i="0u"){const o=this.generateWrapFunction(e),l=this.generateTextureDimension(e,t,i),h=e.isData3DTexture?"vec3":"vec2",p=`${h}<u32>( ${o}( ${n} ) * ${h}<f32>( ${l} ) )`;return this.generateTextureLoad(e,t,p,r,i)}generateTextureLoad(e,t,n,r,i="0u"){let o;return e.isVideoTexture===!0?o=`textureLoad( ${t}, ${n} )`:r?o=`textureLoad( ${t}, ${n}, ${r}, u32( ${i} ) )`:(o=`textureLoad( ${t}, ${n}, u32( ${i} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(o+=".x")),o}generateTextureStore(e,t,n,r,i){let o;return r?o=`textureStore( ${t}, ${n}, ${r}, ${i} )`:o=`textureStore( ${t}, ${n}, ${i} )`,o}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===Rc||this.isSampleCompare(e)===!1&&e.minFilter===So&&e.magFilter===So||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,n,r,i=this.shaderStage){let o=null;return e.isVideoTexture===!0?o=this._generateVideoSample(t,n,i):this.isUnfilterable(e)?o=this.generateTextureLod(e,t,n,r,"0",i):o=this._generateTextureSample(e,t,n,r,i),o}generateTextureGrad(e,t,n,r,i,o=this.shaderStage){if(o==="fragment")return`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,n,r,i,o=this.shaderStage){if(o==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${i}, ${r} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,n,r,i,o=this.shaderStage){let l=null;return e.isVideoTexture===!0?l=this._generateVideoSample(t,n,o):l=this._generateTextureSampleLevel(e,t,n,r,i),l}generateTextureBias(e,t,n,r,i,o=this.shaderStage){if(o==="fragment")return`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="storageTexture"||r==="texture3D"?n:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?n:n+".value":e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=jGe[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?Mg.READ_ONLY:e.access}getStorageAccess(e,t){return HGe[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),o=this.getDataFromNode(e,n,this.globalCache);if(o.uniformGPU===void 0){let l;const h=e.groupNode,p=h.name,y=this.getBindGroupArray(p,n);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let x=null;const S=this.getNodeAccess(e,n);if(t==="texture"||t==="storageTexture"?x=new Zk(i.name,i.node,h,S):t==="cubeTexture"?x=new H5e(i.name,i.node,h,S):t==="texture3D"&&(x=new j5e(i.name,i.node,h,S)),x.store=e.isStorageTextureNode===!0,x.setVisibility(pI[n]),this.isUnfilterable(e.value)===!1&&x.store===!1){const A=new RGe(`${i.name}_sampler`,i.node,h);A.setVisibility(pI[n]),y.push(A,x),l=[A,x]}else y.push(x),l=[x]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const x=t==="buffer"?V5e:NGe,S=new x(e,h);S.setVisibility(pI[n]),y.push(S),l=S,i.name=r||"NodeBuffer_"+i.id}else{const x=this.uniformGroups[n]||(this.uniformGroups[n]={});let S=x[p];S===void 0&&(S=new G5e(p,h),S.setVisibility(pI[n]),x[p]=S,y.push(S)),l=this.getNodeUniform(i,t),S.addUniform(l)}o.uniformGPU=l}return i}getBuiltin(e,t,n,r=this.shaderStage){const i=this.builtins[r]||(this.builtins[r]=new Map);return i.has(e)===!1&&i.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(o.name+" : "+this.getType(o.type));let i=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${n.vars}
${n.code}
`;return n.result&&(i+=`	return ${n.result};
`),i+=`
}
`,i}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(n!==void 0)for(const r of n)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],n=this.builtins[e];if(n!==void 0)for(const{name:r,property:i,type:o}of n.values())t.push(`@builtin( ${r} ) ${i} : ${o}`);return t.join(`,
	`)}getScopedArray(e,t,n,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:n,scope:r,bufferType:i,bufferCount:o}of this.scopedArrays.values()){const l=this.getType(i);t.push(`var<${r}> ${n}: array< ${l}, ${o} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&t.push(n);const r=this.getAttributesArray();for(let i=0,o=r.length;i<o;i++){const l=r[i],h=l.name,p=this.getType(l.type);t.push(`@location( ${i} ) ${h} : ${p}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const n of e.members){const r=e.output?"@location( "+n.index+" ) ":"";let i=this.getType(n.type);n.atomic&&(i="atomic< "+i+" >"),t.push(`	${r+n.name} : ${i}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const n=this.structs[e];if(n.length>0){const r=[];for(const i of n){let o=`struct ${i.name} {
`;o+=this.getStructMembers(i),o+=`
};`,r.push(o)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,n=null){let r=`var ${t} : `;return n!==null?r+=this.generateArrayDeclaration(e,n):r+=this.getType(e),r}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const i=this.varyings,o=this.vars[e];for(let l=0;l<i.length;l++){const h=i[l];if(h.needsInterpolation){let p=`@location( ${l} )`;if(h.interpolationType){const y=h.interpolationSampling!==null?`, ${h.interpolationSampling} )`:" )";p+=` @interpolate( ${h.interpolationType}${y}`}else/^(int|uint|ivec|uvec)/.test(h.type)&&(p+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${p} ${h.name} : ${this.getType(h.type)}`)}else e==="vertex"&&o.includes(h)===!1&&o.push(h)}}const n=this.getBuiltins(e);n&&t.push(n);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,n=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&n.structTypeNode!==null,i=n.value&&n.value.array&&typeof n.value.itemSize=="number"&&n.value.array.length>n.value.itemSize;return r&&!i}getUniforms(e){const t=this.uniforms[e],n=[],r=[],i=[],o={};for(const h of t){const p=h.groupNode.name,y=this.bindingsIndexes[p];if(h.type==="texture"||h.type==="cubeTexture"||h.type==="storageTexture"||h.type==="texture3D"){const x=h.node.value;this.isUnfilterable(x)===!1&&h.node.isStorageTextureNode!==!0&&(this.isSampleCompare(x)?n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${h.name}_sampler : sampler_comparison;`):n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${h.name}_sampler : sampler;`));let S,A="";const{primarySamples:k}=this.renderer.backend.utils.getTextureSampleData(x);if(k>1&&(A="_multisampled"),x.isCubeTexture===!0)S="texture_cube<f32>";else if(x.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&x.compareFunction===null?S=`texture${A}_2d<f32>`:S=`texture_depth${A}_2d${x.isArrayTexture===!0?"_array":""}`;else if(x.isArrayTexture===!0||x.isDataArrayTexture===!0||x.isCompressedArrayTexture===!0)S="texture_2d_array<f32>";else if(x.isVideoTexture===!0)S="texture_external";else if(x.isData3DTexture===!0)S="texture_3d<f32>";else if(h.node.isStorageTextureNode===!0){const L=vj(x),U=this.getStorageAccess(h.node,e);S=`texture_storage_2d<${L}, ${U}>`}else{const L=this.getComponentTypeFromTexture(x).charAt(0);S=`texture${A}_2d<${L}32>`}n.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var ${h.name} : ${S};`)}else if(h.type==="buffer"||h.type==="storageBuffer"||h.type==="indirectStorageBuffer"){const x=h.node,S=this.getType(x.getNodeType(this)),A=x.bufferCount,k=A>0&&h.type==="buffer"?", "+A:"",L=x.isStorageBufferNode?`storage, ${this.getStorageAccess(x,e)}`:"uniform";if(this.isCustomStruct(h))r.push(`@binding( ${y.binding++} ) @group( ${y.group} ) var<${L}> ${h.name} : ${S};`);else{const P=`	value : array< ${x.isAtomic?`atomic<${S}>`:`${S}`}${k} >`;r.push(this._getWGSLStructBinding(h.name,P,L,y.binding++,y.group))}}else{const x=this.getType(this.getVectorType(h.type)),S=h.groupNode.name;(o[S]||(o[S]={index:y.binding++,id:y.group,snippets:[]})).snippets.push(`	${h.name} : ${x}`)}}for(const h in o){const p=o[h];i.push(this._getWGSLStructBinding(h,p.snippets.join(`,
`),"uniform",p.index,p.id))}let l=n.join(`
`);return l+=r.join(`
`),l+=i.join(`
`),l}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const i=this.flowNodes[t],o=i[i.length-1],l=o.outputNode,h=l!==void 0&&l.isOutputStructNode===!0;for(const p of i){const y=this.getFlowData(p),x=p.name;if(x&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${x}
`),r+=`${y.code}
	`,p===o&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${y.result};`;else if(t==="fragment")if(h)n.returnType=l.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",r+=`return ${y.result};`;else{let S="	@location(0) color: vec4<f32>";const A=this.getBuiltins("output");A&&(S+=`,
	`+A),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",S),n.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${y.result};

	return output;`}}}n.flow=r}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let n;return t!==null&&(n=this._getWGSLMethod(e+"_"+t)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getType(e){return WGe[e]||e}isAvailable(e){let t=R2e[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),R2e[e]=t),t}_getWGSLMethod(e){return Nh[e]!==void 0&&this._include(e),iE[e]}_include(e){const t=Nh[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${q5e}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${t} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${t}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${t});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,n,r=0,i=0){const o=e+"Struct";return`${this._getWGSLStruct(o,t)}
@binding( ${r} ) @group( ${i} )
var<${n}> ${e} : ${o};`}}class qGe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=Ke.Depth24PlusStencil8:e.depth&&(t=Ke.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const i=this.backend.renderer,o=i.getRenderTarget();t=o?o.samples:i.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const n=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:n?1:t,isMSAA:n}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return E_.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return E_.LineList;if(e.isLine)return E_.LineStrip;if(e.isMesh)return E_.TriangleList}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),t===2&&(t=4)),t}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===Vl)return Ke.BGRA8Unorm;if(e===Uh)return Ke.RGBA16Float;throw new Error("Unsupported outputType")}}const XGe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),YGe=new Map([[a4e,["float16"]]]),KGe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class ZGe{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),r=this.backend,i=r.get(n);let o=i.buffer;if(o===void 0){const l=r.device;let h=n.array;if(e.normalized===!1){if(h.constructor===Int16Array||h.constructor===Int8Array)h=new Int32Array(h);else if((h.constructor===Uint16Array||h.constructor===Uint8Array)&&(h=new Uint32Array(h),t&GPUBufferUsage.INDEX))for(let x=0;x<h.length;x++)h[x]===65535&&(h[x]=4294967295)}if(n.array=h,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){h=new h.constructor(n.count*4);for(let x=0;x<n.count;x++)h.set(n.array.subarray(x*3,x*3+3),x*4);n.itemSize=4,n.array=h,i._force3to4BytesAlignment=!0}const p=h.byteLength,y=p+(4-p%4)%4;o=l.createBuffer({label:n.name,size:y,usage:t,mappedAtCreation:!0}),new h.constructor(o.getMappedRange()).set(h),o.unmap(),i.buffer=o}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,r=n.device,i=n.get(t),o=n.get(t).buffer;let l=t.array;if(i._force3to4BytesAlignment===!0){l=new l.constructor(t.count*4);for(let y=0;y<t.count;y++)l.set(t.array.subarray(y*3,y*3+3),y*4);t.array=l}const h=this._isTypedArray(l),p=t.updateRanges;if(p.length===0)r.queue.writeBuffer(o,0,l,0);else{const y=h?1:l.BYTES_PER_ELEMENT;for(let x=0,S=p.length;x<S;x++){const A=p[x];let k,L;if(i._force3to4BytesAlignment===!0){const P=Math.floor(A.start/3),$=Math.ceil(A.count/3);k=P*4*y,L=$*4*y}else k=A.start*y,L=A.count*y;const U=k*(h?l.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(o,U,l,k,L)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let r=0;r<t.length;r++){const i=t[r],o=i.array.BYTES_PER_ELEMENT,l=this._getBufferAttribute(i);let h=n.get(l);if(h===void 0){let x,S;i.isInterleavedBufferAttribute===!0?(x=i.data.stride*o,S=i.data.isInstancedInterleavedBuffer?fI.Instance:fI.Vertex):(x=i.itemSize*o,S=i.isInstancedBufferAttribute?fI.Instance:fI.Vertex),i.normalized===!1&&(i.array.constructor===Int16Array||i.array.constructor===Uint16Array)&&(x=4),h={arrayStride:x,attributes:[],stepMode:S},n.set(l,h)}const p=this._getVertexFormat(i),y=i.isInterleavedBufferAttribute===!0?i.offset*o:0;h.attributes.push({shaderLocation:r,offset:y,format:p})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,i=t.get(this._getBufferAttribute(e)).buffer,o=i.size,l=n.createBuffer({label:`${e.name}_readback`,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),h=n.createCommandEncoder({label:`readback_encoder_${e.name}`});h.copyBufferToBuffer(i,0,l,0,o);const p=h.finish();n.queue.submit([p]),await l.mapAsync(GPUMapMode.READ);const y=l.getMappedRange(),x=new e.array.constructor(y.slice(0));return l.unmap(),x.buffer}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,r=e.array.constructor,i=e.constructor;let o;if(t===1)o=KGe.get(r);else{const h=(YGe.get(i)||XGe.get(r))[n?1:0];if(h){const p=r.BYTES_PER_ELEMENT*t,x=Math.floor((p+3)/4)*4/r.BYTES_PER_ELEMENT;if(x%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${h}x${x}`}}return o||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),o}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class QGe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,n=t.device,r=[];let i=0;for(const o of e.bindings){const l={binding:i++,visibility:o.visibility};if(o.isUniformBuffer||o.isStorageBuffer){const h={};o.isStorageBuffer&&(o.visibility&4&&(o.access===Mg.READ_WRITE||o.access===Mg.WRITE_ONLY)?h.type=pG.Storage:h.type=pG.ReadOnlyStorage),l.buffer=h}else if(o.isSampler){const h={};o.texture.isDepthTexture&&(o.texture.compareFunction!==null?h.type=M2e.Comparison:t.compatibilityMode&&(h.type=M2e.NonFiltering)),l.sampler=h}else if(o.isSampledTexture&&o.texture.isVideoTexture)l.externalTexture={};else if(o.isSampledTexture&&o.store){const h={};h.format=this.backend.get(o.texture).texture.format;const p=o.access;p===Mg.READ_WRITE?h.access=mG.ReadWrite:p===Mg.WRITE_ONLY?h.access=mG.WriteOnly:h.access=mG.ReadOnly,l.storageTexture=h}else if(o.isSampledTexture){const h={},{primarySamples:p}=t.utils.getTextureSampleData(o.texture);if(p>1&&(h.multisampled=!0,o.texture.isDepthTexture||(h.sampleType=ev.UnfilterableFloat)),o.texture.isDepthTexture)t.compatibilityMode&&o.texture.compareFunction===null?h.sampleType=ev.UnfilterableFloat:h.sampleType=ev.Depth;else if(o.texture.isDataTexture||o.texture.isDataArrayTexture||o.texture.isData3DTexture){const y=o.texture.type;y===Ul?h.sampleType=ev.SInt:y===$a?h.sampleType=ev.UInt:y===Rc&&(this.backend.hasFeature("float32-filterable")?h.sampleType=ev.Float:h.sampleType=ev.UnfilterableFloat)}o.isSampledCubeTexture?h.viewDimension=Vo.Cube:o.texture.isArrayTexture||o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?h.viewDimension=Vo.TwoDArray:o.isSampledTexture3D&&(h.viewDimension=Vo.ThreeD),l.texture=h}else console.error(`WebGPUBindingUtils: Unsupported binding "${o}".`);r.push(l)}return n.createBindGroupLayout({entries:r})}createBindings(e,t,n,r=0){const{backend:i,bindGroupLayoutCache:o}=this,l=i.get(e);let h=o.get(e.bindingsReference);h===void 0&&(h=this.createBindingsLayout(e),o.set(e.bindingsReference,h));let p;n>0&&(l.groups===void 0&&(l.groups=[],l.versions=[]),l.versions[n]===r&&(p=l.groups[n])),p===void 0&&(p=this.createBindGroup(e,h),n>0&&(l.groups[n]=p,l.versions[n]=r)),l.group=p,l.layout=h}updateBinding(e){const t=this.backend,n=t.device,r=e.buffer,i=t.get(e).buffer;n.queue.writeBuffer(i,0,r,0)}createBindGroupIndex(e,t){const r=this.backend.device,i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,o=e[0],l=r.createBuffer({label:"bindingCameraIndex_"+o,size:16,usage:i});r.queue.writeBuffer(l,0,e,0);const h=[{binding:0,resource:{buffer:l}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+o,layout:t,entries:h})}createBindGroup(e,t){const n=this.backend,r=n.device;let i=0;const o=[];for(const l of e.bindings){if(l.isUniformBuffer){const h=n.get(l);if(h.buffer===void 0){const p=l.byteLength,y=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,x=r.createBuffer({label:"bindingBuffer_"+l.name,size:p,usage:y});h.buffer=x}o.push({binding:i,resource:{buffer:h.buffer}})}else if(l.isStorageBuffer){const h=n.get(l);if(h.buffer===void 0){const p=l.attribute;h.buffer=n.get(p).buffer}o.push({binding:i,resource:{buffer:h.buffer}})}else if(l.isSampler){const h=n.get(l.texture);o.push({binding:i,resource:h.sampler})}else if(l.isSampledTexture){const h=n.get(l.texture);let p;if(h.externalTexture!==void 0)p=r.importExternalTexture({source:h.externalTexture});else{const y=l.store?1:h.texture.mipLevelCount,x=`view-${h.texture.width}-${h.texture.height}-${y}`;if(p=h[x],p===void 0){const S=AGe.All;let A;l.isSampledCubeTexture?A=Vo.Cube:l.isSampledTexture3D?A=Vo.ThreeD:l.texture.isArrayTexture||l.texture.isDataArrayTexture||l.texture.isCompressedArrayTexture?A=Vo.TwoDArray:A=Vo.TwoD,p=h[x]=h.texture.createView({aspect:S,dimension:A,mipLevelCount:y})}}o.push({binding:i,resource:p})}i++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}class JGe{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:r,geometry:i,pipeline:o}=e,{vertexProgram:l,fragmentProgram:h}=o,p=this.backend,y=p.device,x=p.utils,S=p.get(o),A=[];for(const He of e.getBindings()){const rt=p.get(He);A.push(rt.layout)}const k=p.attributeUtils.createShaderVertexBuffers(e);let L;r.blending!==K_&&(r.blending!==Rg||r.transparent!==!1)&&(L=this._getBlending(r));let U={};r.stencilWrite===!0&&(U={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const P=this._getColorWriteMask(r),$=[];if(e.context.textures!==null){const He=e.context.textures;for(let rt=0;rt<He.length;rt++){const ot=x.getTextureFormatGPU(He[rt]);$.push({format:ot,blend:L,writeMask:P})}}else{const He=x.getCurrentColorFormat(e.context);$.push({format:He,blend:L,writeMask:P})}const Z=p.get(l).module,I=p.get(h).module,ie=this._getPrimitiveState(n,i,r),ce=this._getDepthCompare(r),ue=x.getCurrentDepthStencilFormat(e.context),Q=this._getSampleCount(e.context),oe={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},Z,{buffers:k}),fragment:Object.assign({},I,{targets:$}),primitive:ie,multisample:{count:Q,alphaToCoverageEnabled:r.alphaToCoverage&&Q>1},layout:y.createPipelineLayout({bindGroupLayouts:A})},le={},J=e.context.depth,Be=e.context.stencil;if((J===!0||Be===!0)&&(J===!0&&(le.format=ue,le.depthWriteEnabled=r.depthWrite,le.depthCompare=ce),Be===!0&&(le.stencilFront=U,le.stencilBack={},le.stencilReadMask=r.stencilFuncMask,le.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(le.depthBias=r.polygonOffsetUnits,le.depthBiasSlopeScale=r.polygonOffsetFactor,le.depthBiasClamp=0),oe.depthStencil=le),t===null)S.pipeline=y.createRenderPipeline(oe);else{const He=new Promise(rt=>{y.createRenderPipelineAsync(oe).then(ot=>{S.pipeline=ot,rt()})});t.push(He)}}createBundleEncoder(e,t="renderBundleEncoder"){const n=this.backend,{utils:r,device:i}=n,o=r.getCurrentDepthStencilFormat(e),l=r.getCurrentColorFormat(e),h=this._getSampleCount(e),p={label:t,colorFormats:[l],depthStencilFormat:o,sampleCount:h};return i.createRenderBundleEncoder(p)}createComputePipeline(e,t){const n=this.backend,r=n.device,i=n.get(e.computeProgram).module,o=n.get(e),l=[];for(const h of t){const p=n.get(h);l.push(p.layout)}o.pipeline=r.createComputePipeline({compute:i,layout:r.createPipelineLayout({bindGroupLayouts:l})})}_getBlending(e){let t,n;const r=e.blending,i=e.blendSrc,o=e.blendDst,l=e.blendEquation;if(r===dE){const h=e.blendSrcAlpha!==null?e.blendSrcAlpha:i,p=e.blendDstAlpha!==null?e.blendDstAlpha:o,y=e.blendEquationAlpha!==null?e.blendEquationAlpha:l;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(l)},n={srcFactor:this._getBlendFactor(h),dstFactor:this._getBlendFactor(p),operation:this._getBlendOperation(y)}}else{const h=e.premultipliedAlpha,p=(y,x,S,A)=>{t={srcFactor:y,dstFactor:x,operation:J8.Add},n={srcFactor:S,dstFactor:A,operation:J8.Add}};if(h)switch(r){case Rg:p(Qr.One,Qr.OneMinusSrcAlpha,Qr.One,Qr.OneMinusSrcAlpha);break;case ik:p(Qr.One,Qr.One,Qr.One,Qr.One);break;case sk:p(Qr.Zero,Qr.OneMinusSrc,Qr.Zero,Qr.One);break;case ak:p(Qr.Zero,Qr.Src,Qr.Zero,Qr.SrcAlpha);break}else switch(r){case Rg:p(Qr.SrcAlpha,Qr.OneMinusSrcAlpha,Qr.One,Qr.OneMinusSrcAlpha);break;case ik:p(Qr.SrcAlpha,Qr.One,Qr.SrcAlpha,Qr.One);break;case sk:p(Qr.Zero,Qr.OneMinusSrc,Qr.Zero,Qr.One);break;case ak:p(Qr.Zero,Qr.Src,Qr.Zero,Qr.Src);break}}if(t!==void 0&&n!==void 0)return{color:t,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case j3:t=Qr.Zero;break;case P3e:t=Qr.One;break;case R3e:t=Qr.Src;break;case I3e:t=Qr.OneMinusSrc;break;case ok:t=Qr.SrcAlpha;break;case lk:t=Qr.OneMinusSrcAlpha;break;case D3e:t=Qr.Dst;break;case O3e:t=Qr.OneMinusDst;break;case k3e:t=Qr.DstAlpha;break;case N3e:t=Qr.OneMinusDstAlpha;break;case F3e:t=Qr.SrcAlphaSaturated;break;case nDe:t=Qr.Constant;break;case rDe:t=Qr.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case FNe:t=m0.Never;break;case rj:t=m0.Always;break;case LNe:t=m0.Less;break;case BNe:t=m0.LessEqual;break;case UNe:t=m0.Equal;break;case GNe:t=m0.GreaterEqual;break;case zNe:t=m0.Greater;break;case VNe:t=m0.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case lv:t=U3.Keep;break;case PNe:t=U3.Zero;break;case RNe:t=U3.Replace;break;case ONe:t=U3.Invert;break;case INe:t=U3.IncrementClamp;break;case kNe:t=U3.DecrementClamp;break;case NNe:t=U3.IncrementWrap;break;case DNe:t=U3.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case Sf:t=J8.Add;break;case C3e:t=J8.Subtract;break;case A3e:t=J8.ReverseSubtract;break;case fNe:t=J8.Min;break;case pNe:t=J8.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const r={},i=this.backend.utils;switch(r.topology=i.getPrimitiveTopology(e,n),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?rx.Uint16:rx.Uint32),n.side){case Pg:r.frontFace=hG.CCW,r.cullMode=dG.Back;break;case Nu:r.frontFace=hG.CCW,r.cullMode=dG.Front;break;case P_:r.frontFace=hG.CCW,r.cullMode=dG.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side);break}return r}_getColorWriteMask(e){return e.colorWrite===!0?T2e.All:T2e.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=m0.Always;else{const n=e.depthFunc;switch(n){case L3e:t=m0.Never;break;case U3e:t=m0.Always;break;case B3e:t=m0.Less;break;case uk:t=m0.LessEqual;break;case z3e:t=m0.Equal;break;case V3e:t=m0.GreaterEqual;break;case G3e:t=m0.Greater;break;case H3e:t=m0.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class eHe extends $5e{constructor(e,t,n=2048){super(n),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ug(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,n=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,n);const i=r.finish();if(this.device.queue.submit([i]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,n),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const o=new BigUint64Array(this.resultBuffer.getMappedRange(0,n));let l=0;for(const[,h]of e){const p=o[h],y=o[h+1],x=Number(y-p)/1e6;l+=x}return this.resultBuffer.unmap(),this.lastValue=l,l}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class tHe extends W5e{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new qGe(this),this.attributeUtils=new ZGe(this),this.bindingUtils=new QGe(this),this.pipelineUtils=new JGe(this),this.textureUtils=new LGe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(t.device===void 0){const o={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},l=typeof navigator<"u"?await navigator.gpu.requestAdapter(o):null;if(l===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const h=Object.values(gj),p=[];for(const x of h)l.features.has(x)&&p.push(x);const y={requiredFeatures:p,requiredLimits:t.requiredLimits};n=await l.requestDevice(y)}else n=t.device;n.lost.then(o=>{const l={api:"WebGPU",message:o.message||"Unknown reason",reason:o.reason||null,originalEvent:o};e.onDeviceLost(l)});const r=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=n,this.context=r;const i=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(gj.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:i}),this.updateSize()}get coordinateSystem(){return i4}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const n=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(n.depth,n.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const n=e.renderTarget,r=this.get(n);let i=r.descriptors;if(i===void 0||r.width!==n.width||r.height!==n.height||r.dimensions!==n.dimensions||r.activeMipmapLevel!==e.activeMipmapLevel||r.activeCubeFace!==e.activeCubeFace||r.samples!==n.samples){i={},r.descriptors=i;const p=()=>{n.removeEventListener("dispose",p),this.delete(n)};n.hasEventListener("dispose",p)===!1&&n.addEventListener("dispose",p)}const o=e.getCacheKey();let l=i[o];if(l===void 0){const p=e.textures,y=[];let x;const S=this._isRenderCameraDepthArray(e);for(let A=0;A<p.length;A++){const k=this.get(p[A]),L={label:`colorAttachment_${A}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:Vo.TwoD};if(n.isRenderTarget3D)x=e.activeCubeFace,L.baseArrayLayer=0,L.dimension=Vo.ThreeD,L.depthOrArrayLayers=p[A].image.depth;else if(n.isRenderTarget&&p[A].image.depth>1)if(S===!0){const U=e.camera.cameras;for(let P=0;P<U.length;P++){const $={...L,baseArrayLayer:P,arrayLayerCount:1,dimension:Vo.TwoD},Z=k.texture.createView($);y.push({view:Z,resolveTarget:void 0,depthSlice:void 0})}}else L.dimension=Vo.TwoDArray,L.depthOrArrayLayers=p[A].image.depth;if(S!==!0){const U=k.texture.createView(L);let P,$;k.msaaTexture!==void 0?(P=k.msaaTexture.createView(),$=U):(P=U,$=void 0),y.push({view:P,resolveTarget:$,depthSlice:x})}}if(l={textureViews:y},e.depth){const A=this.get(e.depthTexture),k={};e.depthTexture.isArrayTexture&&(k.dimension=Vo.TwoD,k.arrayLayerCount=1,k.baseArrayLayer=e.activeCubeFace),l.depthStencilView=A.texture.createView(k)}i[o]=l,r.width=n.width,r.height=n.height,r.samples=n.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace,r.dimensions=n.dimensions}const h={colorAttachments:[]};for(let p=0;p<l.textureViews.length;p++){const y=l.textureViews[p];let x={r:0,g:0,b:0,a:1};p===0&&t.clearValue&&(x=t.clearValue),h.colorAttachments.push({view:y.view,depthSlice:y.depthSlice,resolveTarget:y.resolveTarget,loadOp:t.loadOp||es.Load,storeOp:t.storeOp||Fl.Store,clearValue:x})}return l.depthStencilView&&(h.depthStencilAttachment={view:l.depthStencilView}),h}beginRender(e){const t=this.get(e),n=this.device,r=e.occlusionQueryCount;let i;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,i=n.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=i,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let o;e.textures===null?o=this._getDefaultRenderPassDescriptor():o=this._getRenderPassDescriptor(e,{loadOp:es.Load}),this.initTimestampQuery(e,o),o.occlusionQuerySet=i;const l=o.depthStencilAttachment;if(e.textures!==null){const p=o.colorAttachments;for(let y=0;y<p.length;y++){const x=p[y];e.clearColor?(x.clearValue=y===0?e.clearColorValue:{r:0,g:0,b:0,a:1},x.loadOp=es.Clear):x.loadOp=es.Load,x.storeOp=Fl.Store}}else{const p=o.colorAttachments[0];e.clearColor?(p.clearValue=e.clearColorValue,p.loadOp=es.Clear):p.loadOp=es.Load,p.storeOp=Fl.Store}e.depth&&(e.clearDepth?(l.depthClearValue=e.clearDepthValue,l.depthLoadOp=es.Clear):l.depthLoadOp=es.Load,l.depthStoreOp=Fl.Store),e.stencil&&(e.clearStencil?(l.stencilClearValue=e.clearStencilValue,l.stencilLoadOp=es.Clear):l.stencilLoadOp=es.Load,l.stencilStoreOp=Fl.Store);const h=n.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const p=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==p.length?this._createDepthLayerDescriptors(e,t,o,p):this._updateDepthLayerDescriptors(e,t,p),t.bundleEncoders=[],t.bundleSets=[];for(let y=0;y<p.length;y++){const x=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+y),S={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(x),t.bundleSets.push(S)}t.currentPass=null}else{const p=h.beginRenderPass(o);if(t.currentPass=p,e.viewport&&this.updateViewport(e),e.scissor){const{x:y,y:x,width:S,height:A}=e.scissorValue;p.setScissorRect(y,x,S,A)}}t.descriptor=o,t.encoder=h,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,n,r){const i=n.depthStencilAttachment;t.layerDescriptors=[];const o=this.get(e.depthTexture);o.viewCache||(o.viewCache=[]);for(let l=0;l<r.length;l++){const h={...n,colorAttachments:[{...n.colorAttachments[0],view:n.colorAttachments[l].view}]};if(n.depthStencilAttachment){const p=l;o.viewCache[p]||(o.viewCache[p]=o.texture.createView({dimension:Vo.TwoD,baseArrayLayer:l,arrayLayerCount:1})),h.depthStencilAttachment={view:o.viewCache[p],depthLoadOp:i.depthLoadOp||es.Clear,depthStoreOp:i.depthStoreOp||Fl.Store,depthClearValue:i.depthClearValue||1},e.stencil&&(h.depthStencilAttachment.stencilLoadOp=i.stencilLoadOp,h.depthStencilAttachment.stencilStoreOp=i.stencilStoreOp,h.depthStencilAttachment.stencilClearValue=i.stencilClearValue)}else h.depthStencilAttachment={...i};t.layerDescriptors.push(h)}}_updateDepthLayerDescriptors(e,t,n){for(let r=0;r<n.length;r++){const i=t.layerDescriptors[r];if(i.depthStencilAttachment){const o=i.depthStencilAttachment;e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=es.Clear):o.depthLoadOp=es.Load),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=es.Clear):o.stencilLoadOp=es.Load)}}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const i=[];for(let o=0;o<t.bundleEncoders.length;o++){const l=t.bundleEncoders[o];i.push(l.finish())}for(let o=0;o<t.layerDescriptors.length;o++)if(o<i.length){const l=t.layerDescriptors[o],h=r.beginRenderPass(l);if(e.viewport){const{x:p,y,width:x,height:S,minDepth:A,maxDepth:k}=e.viewportValue;h.setViewport(p,y,x,S,A,k)}if(e.scissor){const{x:p,y,width:x,height:S}=e.scissorValue;h.setScissorRect(p,y,x,S)}h.executeBundles([i[o]]),h.end()}}else t.currentPass&&t.currentPass.end();if(n>0){const i=n*8;let o=this.occludedResolveCache.get(i);o===void 0&&(o=this.device.createBuffer({size:i,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(i,o));const l=this.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,o,0),t.encoder.copyBufferToBuffer(o,0,l,0,i),t.occlusionQueryBuffer=l,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const i=e.textures;for(let o=0;o<i.length;o++){const l=i[o];l.generateMipmaps===!0&&this.textureUtils.generateMipmaps(l)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const i=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const o=n.getMappedRange(),l=new BigUint64Array(o);for(let h=0;h<r.length;h++)l[h]===BigInt(0)&&i.add(r[h]);n.destroy(),t.occluded=i}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:i,height:o,minDepth:l,maxDepth:h}=e.viewportValue;t.setViewport(n,r,i,o,l,h)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,n,r=null){const i=this.device,o=this.renderer;let l=[],h,p,y,x;if(e){const k=this.getClearColor();p={r:k.r,g:k.g,b:k.b,a:k.a}}if(r===null){y=o.depth,x=o.stencil;const k=this._getDefaultRenderPassDescriptor();if(e){l=k.colorAttachments;const L=l[0];L.clearValue=p,L.loadOp=es.Clear,L.storeOp=Fl.Store}(y||x)&&(h=k.depthStencilAttachment)}else{y=r.depth,x=r.stencil;const k={loadOp:e?es.Clear:es.Load,clearValue:e?p:void 0};y&&(k.depthLoadOp=t?es.Clear:es.Load,k.depthClearValue=t?o.getClearDepth():void 0,k.depthStoreOp=Fl.Store),x&&(k.stencilLoadOp=n?es.Clear:es.Load,k.stencilClearValue=n?o.getClearStencil():void 0,k.stencilStoreOp=Fl.Store);const L=this._getRenderPassDescriptor(r,k);l=L.colorAttachments,h=L.depthStencilAttachment}y&&h&&h.depthLoadOp===void 0&&(t?(h.depthLoadOp=es.Clear,h.depthClearValue=o.getClearDepth(),h.depthStoreOp=Fl.Store):(h.depthLoadOp=es.Load,h.depthStoreOp=Fl.Store)),x&&h&&h.stencilLoadOp===void 0&&(n?(h.stencilLoadOp=es.Clear,h.stencilClearValue=o.getClearStencil(),h.stencilStoreOp=Fl.Store):(h.stencilLoadOp=es.Load,h.stencilStoreOp=Fl.Store));const S=i.createCommandEncoder({label:"clear"});S.beginRenderPass({colorAttachments:l,depthStencilAttachment:h}).end(),i.queue.submit([S.finish()])}beginCompute(e){const t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(e,n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,r){const{passEncoderGPU:i}=this.get(e),o=this.get(r).pipeline;this.pipelineUtils.setPipeline(i,o);for(let y=0,x=n.length;y<x;y++){const S=n[y],A=this.get(S);i.setBindGroup(y,A.group)}const l=this.device.limits.maxComputeWorkgroupsPerDimension,h=this.get(t);h.dispatchSize===void 0&&(h.dispatchSize={x:0,y:1,z:1});const{dispatchSize:p}=h;t.dispatchCount>l?(p.x=Math.min(t.dispatchCount,l),p.y=Math.ceil(t.dispatchCount/l)):p.x=t.dispatchCount,i.dispatchWorkgroups(p.x,p.y,p.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:n,material:r,context:i,pipeline:o}=e,l=e.getBindings(),h=this.get(i),p=this.get(o).pipeline,y=e.getIndex(),x=y!==null,S=e.getDrawParameters();if(S===null)return;const A=(L,U)=>{this.pipelineUtils.setPipeline(L,p),U.pipeline=p;const P=U.bindingGroups;for(let Z=0,I=l.length;Z<I;Z++){const ie=l[Z],ce=this.get(ie);P[ie.index]!==ie.id&&(L.setBindGroup(ie.index,ce.group),P[ie.index]=ie.id)}if(x===!0&&U.index!==y){const Z=this.get(y).buffer,I=y.array instanceof Uint16Array?rx.Uint16:rx.Uint32;L.setIndexBuffer(Z,I),U.index=y}const $=e.getVertexBuffers();for(let Z=0,I=$.length;Z<I;Z++){const ie=$[Z];if(U.attributes[Z]!==ie){const ce=this.get(ie).buffer;L.setVertexBuffer(Z,ce),U.attributes[Z]=ie}}i.stencil===!0&&r.stencilWrite===!0&&h.currentStencilRef!==r.stencilRef&&(L.setStencilReference(r.stencilRef),h.currentStencilRef=r.stencilRef)},k=(L,U)=>{if(A(L,U),n.isBatchedMesh===!0){const P=n._multiDrawStarts,$=n._multiDrawCounts,Z=n._multiDrawCount,I=n._multiDrawInstances;I!==null&&Ug("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let ie=0;ie<Z;ie++){const ce=I?I[ie]:1,ue=ce>1?0:ie;x===!0?L.drawIndexed($[ie],ce,P[ie]/y.array.BYTES_PER_ELEMENT,0,ue):L.draw($[ie],ce,P[ie],ue),t.update(n,$[ie],ce)}}else if(x===!0){const{vertexCount:P,instanceCount:$,firstVertex:Z}=S,I=e.getIndirect();if(I!==null){const ie=this.get(I).buffer;L.drawIndexedIndirect(ie,0)}else L.drawIndexed(P,$,Z,0,0);t.update(n,P,$)}else{const{vertexCount:P,instanceCount:$,firstVertex:Z}=S,I=e.getIndirect();if(I!==null){const ie=this.get(I).buffer;L.drawIndirect(ie,0)}else L.draw(P,$,Z,0);t.update(n,P,$)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const L=this.get(e.camera),U=e.camera.cameras,P=e.getBindingGroup("cameraIndex");if(L.indexesGPU===void 0||L.indexesGPU.length!==U.length){const Z=this.get(P),I=[],ie=new Uint32Array([0,0,0,0]);for(let ce=0,ue=U.length;ce<ue;ce++){ie[0]=ce;const Q=this.bindingUtils.createBindGroupIndex(ie,Z.layout);I.push(Q)}L.indexesGPU=I}const $=this.renderer.getPixelRatio();for(let Z=0,I=U.length;Z<I;Z++){const ie=U[Z];if(n.layers.test(ie.layers)){const ce=ie.viewport;let ue=h.currentPass,Q=h.currentSets;if(h.bundleEncoders){const oe=h.bundleEncoders[Z],le=h.bundleSets[Z];ue=oe,Q=le}ce&&ue.setViewport(Math.floor(ce.x*$),Math.floor(ce.y*$),Math.floor(ce.width*$),Math.floor(ce.height*$),i.viewportValue.minDepth,i.viewportValue.maxDepth),P&&L.indexesGPU&&(ue.setBindGroup(P.index,L.indexesGPU[Z]),Q.bindingGroups[P.index]=P.id),k(ue,Q)}}}else if(h.currentPass){if(h.occlusionQuerySet!==void 0){const L=h.lastOcclusionObject;L!==n&&(L!==null&&L.occlusionTest===!0&&(h.currentPass.endOcclusionQuery(),h.occlusionQueryIndex++),n.occlusionTest===!0&&(h.currentPass.beginOcclusionQuery(h.occlusionQueryIndex),h.occlusionQueryObjects[h.occlusionQueryIndex]=n),h.lastOcclusionObject=n)}k(h.currentPass,h.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:r}=e,i=this.utils,o=i.getSampleCountRenderContext(e.context),l=i.getCurrentColorSpace(e.context),h=i.getCurrentColorFormat(e.context),p=i.getCurrentDepthStencilFormat(e.context),y=i.getPrimitiveTopology(n,r);let x=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==o||t.colorSpace!==l||t.colorFormat!==h||t.depthStencilFormat!==p||t.primitiveTopology!==y||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=o,t.colorSpace=l,t.colorFormat=h,t.depthStencilFormat=p,t.primitiveTopology=y,t.clippingContextCacheKey=e.clippingContextCacheKey,x=!0),x}getRenderCacheKey(e){const{object:t,material:n}=e,r=this.utils,i=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,r.getSampleCountRenderContext(i),r.getCurrentColorSpace(i),r.getCurrentColorFormat(i),r.getCurrentDepthStencilFormat(i),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,i,o){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,o)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n]||(this.timestampQueryPool[n]=new eHe(this.device,n,2048));const r=this.timestampQueryPool[n],i=r.allocateQueriesForContext(e);t.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:i,endOfPassWriteIndex:i+1}}createNodeBuilder(e,t){return new $Ge(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),i=n.currentPass.finish();this.get(t).bundleGPU=i,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,n=null,r=null,i=0,o=0){let l=0,h=0,p=0,y=0,x=0,S=0,A=e.image.width,k=e.image.height,L=1;n!==null&&(n.isBox3===!0?(y=n.min.x,x=n.min.y,S=n.min.z,A=n.max.x-n.min.x,k=n.max.y-n.min.y,L=n.max.z-n.min.z):(y=n.min.x,x=n.min.y,A=n.max.x-n.min.x,k=n.max.y-n.min.y,L=1)),r!==null&&(l=r.x,h=r.y,p=r.z||0);const U=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),P=this.get(e).texture,$=this.get(t).texture;U.copyTextureToTexture({texture:P,mipLevel:i,origin:{x:y,y:x,z:S}},{texture:$,mipLevel:o,origin:{x:l,y:h,z:p}},[A,k,L]),this.device.queue.submit([U.finish()]),o===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,n){const r=this.get(t);let i=null;t.renderTarget?e.isDepthTexture?i=this.get(t.depthTexture).texture:i=this.get(t.textures[0]).texture:e.isDepthTexture?i=this.textureUtils.getDepthBuffer(t.depth,t.stencil):i=this.context.getCurrentTexture();const o=this.get(e).texture;if(i.format!==o.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",i.format,o.format);return}let l;if(r.currentPass?(r.currentPass.end(),l=r.encoder):l=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),l.copyTextureToTexture({texture:i,origin:[n.x,n.y,0]},{texture:o},[n.z,n.w]),r.currentPass){const{descriptor:h}=r;for(let p=0;p<h.colorAttachments.length;p++)h.colorAttachments[p].loadOp=es.Load;if(t.depth&&(h.depthStencilAttachment.depthLoadOp=es.Load),t.stencil&&(h.depthStencilAttachment.stencilLoadOp=es.Load),r.currentPass=l.beginRenderPass(h),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:p,y,width:x,height:S}=t.scissorValue;r.currentPass.setScissorRect(p,y,x,S)}}else this.device.queue.submit([l.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}}class nHe extends Du{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ki(16777215),this.specular=new Ki(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ki(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=r4,this.normalScale=new mi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jh,this.combine=Nk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const rHe=new nHe;class iHe extends uo{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(rHe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new t$(t):null}setupLightingModel(){return new O5e}setupVariants(){const e=(this.shininessNode?$t(this.shininessNode):QLe).max(1e-4);lj.assign(e);const t=this.specularNode||eUe;Cc.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}class X5e extends Du{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ki(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ki(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=r4,this.normalScale=new mi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jh,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const sHe=new X5e;class Y5e extends uo{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(sHe),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new _Ve(t):null}setupLightingModel(){return new L5e}setupSpecular(){const e=ea(Yt(.04),Yi.rgb,yk);Cc.assign(e),xk.assign(1)}setupVariants(){const e=this.metalnessNode?$t(this.metalnessNode):rUe;yk.assign(e);let t=this.roughnessNode?$t(this.roughnessNode):nUe;t=T5e({roughness:t}),Tg.assign(t),this.setupSpecular(),Yi.assign(Jr(Yi.rgb.mul(e.oneMinus()),Yi.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}class aHe extends X5e{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new mi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ei(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ki(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ki(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ki(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const oHe=new aHe;class lHe extends Y5e{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(oHe),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?$t(this.iorNode):vUe;BI.assign(e),Cc.assign(ea(ex(D4e(BI.sub(1).div(BI.add(1))).mul(tUe),Yt(1)).mul(_ge),Yi.rgb,yk)),xk.assign(ea(_ge,1,yk))}setupLightingModel(){return new L5e(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?$t(this.clearcoatNode):sUe,n=this.clearcoatRoughnessNode?$t(this.clearcoatRoughnessNode):aUe;aj.assign(t),_k.assign(T5e({roughness:n}))}if(this.useSheen){const t=this.sheenNode?Yt(this.sheenNode):uUe,n=this.sheenRoughnessNode?$t(this.sheenRoughnessNode):cUe;S_.assign(t),IW.assign(n)}if(this.useIridescence){const t=this.iridescenceNode?$t(this.iridescenceNode):dUe,n=this.iridescenceIORNode?$t(this.iridescenceIORNode):fUe,r=this.iridescenceThicknessNode?$t(this.iridescenceThicknessNode):pUe;kW.assign(t),_4e.assign(n),x4e.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?In(this.anisotropyNode):hUe).toVar();uv.assign(t.length()),Xa(uv.equal(0),()=>{t.assign(In(1,0))}).Else(()=>{t.divAssign(In(uv)),uv.assign(uv.saturate())}),oj.assign(uv.pow2().mix(Tg.pow2(),1)),UI.assign(nE[0].mul(t.x).add(nE[1].mul(t.y))),O_.assign(nE[1].mul(t.x).sub(nE[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?$t(this.transmissionNode):mUe,n=this.thicknessNode?$t(this.thicknessNode):gUe,r=this.attenuationDistanceNode?$t(this.attenuationDistanceNode):yUe,i=this.attenuationColorNode?Yt(this.attenuationColorNode):_Ue;if(uj.assign(t),b4e.assign(n),S4e.assign(r),w4e.assign(i),this.useDispersion){const o=this.dispersionNode?$t(this.dispersionNode):TUe;E4e.assign(o)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Yt(this.clearcoatNormalNode):oUe}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const uHe=un(({normal:s,lightDirection:e,builder:t})=>{const n=s.dot(e),r=In(n.mul(.5).add(.5),0);if(t.material.gradientMap){const i=Y3("gradientMap","texture").context({getUV:()=>r});return Yt(i.r)}else{const i=r.fwidth().mul(.5);return ea(Yt(.7),Yt(1),s4($t(.7).sub(i.x),$t(.7).add(i.x),r.x))}});class cHe extends Kk{direct({lightDirection:e,lightColor:t,reflectedLight:n},r){const i=uHe({normal:Y4e,lightDirection:e,builder:r}).mul(t);n.directDiffuse.addAssign(i.mul(nx({diffuseColor:Yi.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(nx({diffuseColor:Yi}))),r.indirectDiffuse.mulAssign(t)}}class hHe extends Du{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ki(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ki(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=r4,this.normalScale=new mi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const dHe=new hHe;class fHe extends uo{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(dHe),this.setValues(e)}setupLightingModel(){return new cHe}}class pHe extends px{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=$t(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}const mHe=new K3;class gHe extends uo{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(mHe),this.setValues(e)}setupNormal(){return f1}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new t$(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new pHe(u5e)),t}setupOutgoingLight(){return Yi.rgb}setupLightingModel(){return new D5e}}class vHe extends Du{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ki(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ki(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=r4,this.normalScale=new mi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jh,this.combine=Nk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const yHe=new vHe;class _He extends uo{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(yHe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new t$(t):null}setupLightingModel(){return new O5e(!1)}}class xHe extends Du{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=r4,this.normalScale=new mi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}const bHe=new xHe;class SHe extends uo{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(bHe),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?$t(this.opacityNode):l5e;Yi.assign(BW(Jr(yLe(ao),e),Ac))}}class wHe extends Du{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ki(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=r4,this.normalScale=new mi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}const EHe=new wHe;class THe extends uo{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(EHe),this.setValues(e)}setupVariants(e){const t=mLe;let n;e.material.matcap?n=Y3("matcap","texture").context({getUV:()=>t}):n=Yt(ea(.2,.8,t.y)),Yi.rgb.mulAssign(n.rgb)}}class K5e extends Du{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ki(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const MHe=new K5e;class CHe extends uo{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(MHe),this.setValues(e)}}class AHe extends K5e{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const PHe=new AHe;class RHe extends uo{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(PHe),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?$t(this.offsetNode):wUe,t=this.dashScaleNode?$t(this.dashScaleNode):xUe,n=this.dashSizeNode?$t(this.dashSizeNode):bUe,r=this.gapSizeNode?$t(this.gapSizeNode):SUe;_V.assign(n),lge.assign(r);const i=Af(a4("lineDistance").mul(t));(e?i.add(e):i).mod(_V.add(lge)).greaterThan(_V).discard()}}class IHe extends Du{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ki(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const kHe=new IHe;class Z5e extends uo{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(kHe),this.setValues(e)}setupPositionView(e){const{object:t,camera:n}=e,r=this.sizeAttenuation,{positionNode:i,rotationNode:o,scaleNode:l}=this,h=Gk.mul(Yt(i||0));let p=In(Pv[0].xyz.length(),Pv[1].xyz.length());if(l!==null&&(p=p.mul(In(l))),r===!1)if(n.isPerspectiveCamera)p=p.mul(h.z.negate());else{const A=$t(2).div(HW.element(1).element(1));p=p.mul(A.mul(2))}let y=Hk.xy;if(t.center&&t.center.isVector2===!0){const A=AFe("center","vec2",t);y=y.sub(A.sub(.5))}y=y.mul(p);const x=$t(o||lUe),S=Z4e(y,x);return Jr(h.xy.add(S),h.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}class NHe extends Du{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ki(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const DHe=new NHe;class OHe extends Z5e{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(DHe),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return Gk.mul(Yt(e||Y0)).xyz}setupVertex(e){const t=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return t;const{rotationNode:n,scaleNode:r,sizeNode:i}=this,o=Hk.xy.toVar(),l=gE.z.div(gE.w);if(n&&n.isNode){const p=$t(n);o.assign(Z4e(o,p))}let h=i!==null?In(i):EUe;return this.sizeAttenuation===!0&&(h=h.mul(h.div(lo.z.negate()))),r&&r.isNode&&(h=h.mul(In(r))),o.mulAssign(h.mul(2)),o.assign(o.div(gE.z)),o.y.assign(o.y.mul(l)),o.assign(o.mul(t.w)),t.addAssign(Jr(o,0,0)),t}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class FHe extends Kk{constructor(){super(),this.shadowNode=$t(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Yi.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Yi.rgb)}}class LHe extends Du{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ki(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}const UHe=new LHe;class BHe extends uo{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(UHe),this.setValues(e)}setupLightingModel(){return new FHe}}class Ov extends wo{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ki(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}const gG=new As,k2e=new vt,N2e=new vt;class l${constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new mi(512,512),this.mapType=Vl,this.map=null,this.mapPass=null,this.matrix=new As,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new s$,this._frameExtents=new mi(1,1),this._viewportCount=1,this._viewports=[new ki(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;k2e.setFromMatrixPosition(e.matrixWorld),t.position.copy(k2e),N2e.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(N2e),t.updateMatrixWorld(),gG.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(gG),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(gG)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const D2e=new As,Uw=new vt,vG=new vt;class zHe extends l${constructor(){super(new Pc(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new mi(4,2),this._viewportCount=6,this._viewports=[new ki(2,1,1,1),new ki(0,1,1,1),new ki(3,1,1,1),new ki(1,1,1,1),new ki(3,0,1,1),new ki(1,0,1,1)],this._cubeDirections=[new vt(1,0,0),new vt(-1,0,0),new vt(0,0,1),new vt(0,0,-1),new vt(0,1,0),new vt(0,-1,0)],this._cubeUps=[new vt(0,1,0),new vt(0,1,0),new vt(0,1,0),new vt(0,1,0),new vt(0,0,1),new vt(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Uw.setFromMatrixPosition(e.matrixWorld),n.position.copy(Uw),vG.copy(n.position),vG.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(vG),n.updateMatrixWorld(),r.makeTranslation(-Uw.x,-Uw.y,-Uw.z),D2e.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(D2e)}}class VHe extends Ov{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new zHe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class GHe extends l${constructor(){super(new XW(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class HHe extends Ov{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(wo.DEFAULT_UP),this.updateMatrix(),this.target=new wo,this.shadow=new GHe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class jHe extends Ov{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class WHe extends l${constructor(){super(new Pc(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Y_*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class u$ extends Ov{constructor(e,t,n=0,r=Math.PI/3,i=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(wo.DEFAULT_UP),this.updateMatrix(),this.target=new wo,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new WHe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class $He extends Ov{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class qHe extends Ov{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(wo.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ki(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}class XHe{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new vt)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*r)),t.addScaledVector(o[5],1.092548*(r*i)),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],1.092548*(n*i)),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*i),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*r),t.addScaledVector(o[5],2*.429043*r*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],2*.429043*n*i),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class YHe extends Ov{constructor(e=new XHe,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class KHe extends u${constructor(e,t,n,r,i,o){super(e,t,n,r,i,o),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class ZHe extends u${constructor(e,t,n,r,i,o){super(e,t,n,r,i,o),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class QHe extends U5e{constructor(){super(),this.addMaterial(iHe,"MeshPhongMaterial"),this.addMaterial(Y5e,"MeshStandardMaterial"),this.addMaterial(lHe,"MeshPhysicalMaterial"),this.addMaterial(fHe,"MeshToonMaterial"),this.addMaterial(gHe,"MeshBasicMaterial"),this.addMaterial(_He,"MeshLambertMaterial"),this.addMaterial(SHe,"MeshNormalMaterial"),this.addMaterial(THe,"MeshMatcapMaterial"),this.addMaterial(CHe,"LineBasicMaterial"),this.addMaterial(RHe,"LineDashedMaterial"),this.addMaterial(OHe,"PointsMaterial"),this.addMaterial(Z5e,"SpriteMaterial"),this.addMaterial(BHe,"ShadowMaterial"),this.addLight(rze,VHe),this.addLight(hVe,HHe),this.addLight(dVe,jHe),this.addLight(e$,u$),this.addLight(gVe,$He),this.addLight(vVe,qHe),this.addLight(yVe,YHe),this.addLight(fVe,KHe),this.addLight(mVe,ZHe),this.addToneMapping(hBe,vNe),this.addToneMapping(dBe,yNe),this.addToneMapping(fBe,_Ne),this.addToneMapping(mBe,xNe),this.addToneMapping(_Be,bNe),this.addToneMapping(xBe,SNe)}}class mI extends sGe{constructor(e={}){let t;e.forceWebGL?t=E2e:(t=tHe,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new E2e(e)));const n=new t(e);super(n,e),this.library=new QHe,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class JHe extends Pu{constructor(e,t){const n=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],r=new ts;r.setAttribute("position",new Nr(n,3)),r.computeBoundingSphere();const i=new Mf({fog:!1});super(r,i),this.light=e,this.color=t,this.type="RectAreaLightHelper";const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new ts;l.setAttribute("position",new Nr(o,3)),l.computeBoundingSphere(),this.add(new Mn(l,new Nc({side:qa,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const O2e={type:"change"},c$={type:"start"},Q5e={type:"end"},gI=new ax,F2e=new H3,eje=Math.cos(70*$0.DEG2RAD),_o=new ke,Cu=2*Math.PI,Ss={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},yG=1e-6;class tje extends m3e{constructor(e,t=null){super(e,t),this.state=Ss.NONE,this.target=new ke,this.cursor=new ke,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:M_.ROTATE,MIDDLE:M_.DOLLY,RIGHT:M_.PAN},this.touches={ONE:d_.ROTATE,TWO:d_.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new ke,this._lastQuaternion=new us,this._lastTargetPosition=new ke,this._quat=new us().setFromUnitVectors(e.up,new ke(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new DH,this._sphericalDelta=new DH,this._scale=1,this._panOffset=new ke,this._rotateStart=new zn,this._rotateEnd=new zn,this._rotateDelta=new zn,this._panStart=new zn,this._panEnd=new zn,this._panDelta=new zn,this._dollyStart=new zn,this._dollyEnd=new zn,this._dollyDelta=new zn,this._dollyDirection=new ke,this._mouse=new zn,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=rje.bind(this),this._onPointerDown=nje.bind(this),this._onPointerUp=ije.bind(this),this._onContextMenu=hje.bind(this),this._onMouseWheel=oje.bind(this),this._onKeyDown=lje.bind(this),this._onTouchStart=uje.bind(this),this._onTouchMove=cje.bind(this),this._onMouseDown=sje.bind(this),this._onMouseMove=aje.bind(this),this._interceptControlDown=dje.bind(this),this._interceptControlUp=fje.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(O2e),this.update(),this.state=Ss.NONE}update(e=null){const t=this.object.position;_o.copy(t).sub(this.target),_o.applyQuaternion(this._quat),this._spherical.setFromVector3(_o),this.autoRotate&&this.state===Ss.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=Cu:n>Math.PI&&(n-=Cu),r<-Math.PI?r+=Cu:r>Math.PI&&(r-=Cu),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=o!=this._spherical.radius}if(_o.setFromSpherical(this._spherical),_o.applyQuaternion(this._quatInverse),t.copy(this.target).add(_o),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const l=_o.length();o=this._clampDistance(l*this._scale);const h=l-o;this.object.position.addScaledVector(this._dollyDirection,h),this.object.updateMatrixWorld(),i=!!h}else if(this.object.isOrthographicCamera){const l=new ke(this._mouse.x,this._mouse.y,0);l.unproject(this.object);const h=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=h!==this.object.zoom;const p=new ke(this._mouse.x,this._mouse.y,0);p.unproject(this.object),this.object.position.sub(p).add(l),this.object.updateMatrixWorld(),o=_o.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(gI.origin.copy(this.object.position),gI.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(gI.direction))<eje?this.object.lookAt(this.target):(F2e.setFromNormalAndCoplanarPoint(this.object.up,this.target),gI.intersectPlane(F2e,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,i||this._lastPosition.distanceToSquared(this.object.position)>yG||8*(1-this._lastQuaternion.dot(this.object.quaternion))>yG||this._lastTargetPosition.distanceToSquared(this.target)>yG?(this.dispatchEvent(O2e),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Cu/60*this.autoRotateSpeed*e:Cu/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){_o.setFromMatrixColumn(t,0),_o.multiplyScalar(-e),this._panOffset.add(_o)}_panUp(e,t){this.screenSpacePanning===!0?_o.setFromMatrixColumn(t,1):(_o.setFromMatrixColumn(t,0),_o.crossVectors(this.object.up,_o)),_o.multiplyScalar(e),this._panOffset.add(_o)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;_o.copy(r).sub(this.target);let i=_o.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/n.clientHeight,this.object.matrix),this._panUp(2*t*i/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,i=t-n.top,o=n.width,l=n.height;this._mouse.x=r/o*2-1,this._mouse.y=-(i/l)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Cu*this._rotateDelta.x/t.clientHeight),this._rotateUp(Cu*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Cu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Cu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Cu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Cu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),i=.5*(e.pageY+n.y);this._rotateEnd.set(r,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Cu*this._rotateDelta.x/t.clientHeight),this._rotateUp(Cu*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+t.x)*.5,l=(e.pageY+t.y)*.5;this._updateZoomParameters(o,l)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new zn,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function nje(s){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(s.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(s)&&(this._addPointer(s),s.pointerType==="touch"?this._onTouchStart(s):this._onMouseDown(s)))}function rje(s){this.enabled!==!1&&(s.pointerType==="touch"?this._onTouchMove(s):this._onMouseMove(s))}function ije(s){switch(this._removePointer(s),this._pointers.length){case 0:this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Q5e),this.state=Ss.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function sje(s){let e;switch(s.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case M_.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(s),this.state=Ss.DOLLY;break;case M_.ROTATE:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(s),this.state=Ss.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(s),this.state=Ss.ROTATE}break;case M_.PAN:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(s),this.state=Ss.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(s),this.state=Ss.PAN}break;default:this.state=Ss.NONE}this.state!==Ss.NONE&&this.dispatchEvent(c$)}function aje(s){switch(this.state){case Ss.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(s);break;case Ss.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(s);break;case Ss.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(s);break}}function oje(s){this.enabled===!1||this.enableZoom===!1||this.state!==Ss.NONE||(s.preventDefault(),this.dispatchEvent(c$),this._handleMouseWheel(this._customWheelEvent(s)),this.dispatchEvent(Q5e))}function lje(s){this.enabled!==!1&&this._handleKeyDown(s)}function uje(s){switch(this._trackPointer(s),this._pointers.length){case 1:switch(this.touches.ONE){case d_.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(s),this.state=Ss.TOUCH_ROTATE;break;case d_.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(s),this.state=Ss.TOUCH_PAN;break;default:this.state=Ss.NONE}break;case 2:switch(this.touches.TWO){case d_.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(s),this.state=Ss.TOUCH_DOLLY_PAN;break;case d_.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(s),this.state=Ss.TOUCH_DOLLY_ROTATE;break;default:this.state=Ss.NONE}break;default:this.state=Ss.NONE}this.state!==Ss.NONE&&this.dispatchEvent(c$)}function cje(s){switch(this._trackPointer(s),this.state){case Ss.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(s),this.update();break;case Ss.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(s),this.update();break;case Ss.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(s),this.update();break;case Ss.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(s),this.update();break;default:this.state=Ss.NONE}}function hje(s){this.enabled!==!1&&s.preventDefault()}function dje(s){s.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function fje(s){s.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const ya={LEFT:1,RIGHT:2,MIDDLE:4},Nt=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),r_={NONE:0,IN:1,OUT:-1};function tv(s){return s.isPerspectiveCamera}function G3(s){return s.isOrthographicCamera}const i_=Math.PI*2,L2e=Math.PI/2,J5e=1e-5,Bw=Math.PI/180;function mf(s,e,t){return Math.max(e,Math.min(t,s))}function Ls(s,e=J5e){return Math.abs(s)<e}function ls(s,e,t=J5e){return Ls(s-e,t)}function U2e(s,e){return Math.round(s/e)*e}function zw(s){return isFinite(s)?s:s<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Vw(s){return Math.abs(s)<Number.MAX_VALUE?s:s*(1/0)}function vI(s,e,t,n,r=1/0,i){n=Math.max(1e-4,n);const o=2/n,l=o*i,h=1/(1+l+.48*l*l+.235*l*l*l);let p=s-e;const y=e,x=r*n;p=mf(p,-x,x),e=s-p;const S=(t.value+o*p)*i;t.value=(t.value-o*S)*h;let A=e+(p+S)*h;return y-s>0==A>y&&(A=y,t.value=(A-y)/i),A}function B2e(s,e,t,n,r=1/0,i,o){n=Math.max(1e-4,n);const l=2/n,h=l*i,p=1/(1+h+.48*h*h+.235*h*h*h);let y=e.x,x=e.y,S=e.z,A=s.x-y,k=s.y-x,L=s.z-S;const U=y,P=x,$=S,Z=r*n,I=Z*Z,ie=A*A+k*k+L*L;if(ie>I){const ot=Math.sqrt(ie);A=A/ot*Z,k=k/ot*Z,L=L/ot*Z}y=s.x-A,x=s.y-k,S=s.z-L;const ce=(t.x+l*A)*i,ue=(t.y+l*k)*i,Q=(t.z+l*L)*i;t.x=(t.x-l*ce)*p,t.y=(t.y-l*ue)*p,t.z=(t.z-l*Q)*p,o.x=y+(A+ce)*p,o.y=x+(k+ue)*p,o.z=S+(L+Q)*p;const oe=U-s.x,le=P-s.y,J=$-s.z,Be=o.x-U,He=o.y-P,rt=o.z-$;return oe*Be+le*He+J*rt>0&&(o.x=U,o.y=P,o.z=$,t.x=(o.x-U)/i,t.y=(o.y-P)/i,t.z=(o.z-$)/i),o}function _G(s,e){e.set(0,0),s.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=s.length,e.y/=s.length}function xG(s,e){return G3(s)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class pje{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,o=r.length;i<o;i++)r[i].call(this,e)}}}var bG;const mje="2.10.1",yI=1/8,gje=/Mac/.test((bG=globalThis==null?void 0:globalThis.navigator)===null||bG===void 0?void 0:bG.platform);let Wr,z2e,_I,SG,Au,ui,qi,s_,Gw,Zp,Qp,nv,V2e,G2e,kh,Hw,a_,H2e,wG,j2e,EG,TG,xI;class n1 extends pje{static install(e){Wr=e.THREE,z2e=Object.freeze(new Wr.Vector3(0,0,0)),_I=Object.freeze(new Wr.Vector3(0,1,0)),SG=Object.freeze(new Wr.Vector3(0,0,1)),Au=new Wr.Vector2,ui=new Wr.Vector3,qi=new Wr.Vector3,s_=new Wr.Vector3,Gw=new Wr.Vector3,Zp=new Wr.Vector3,Qp=new Wr.Vector3,nv=new Wr.Vector3,V2e=new Wr.Vector3,G2e=new Wr.Vector3,kh=new Wr.Spherical,Hw=new Wr.Spherical,a_=new Wr.Box3,H2e=new Wr.Box3,wG=new Wr.Sphere,j2e=new Wr.Quaternion,EG=new Wr.Quaternion,TG=new Wr.Matrix4,xI=new Wr.Raycaster}static get ACTION(){return Nt}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Nt.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=r_.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Wr.Vector3,this._focalOffsetVelocity=new Wr.Vector3,this._zoomVelocity={value:0},this._truckInternal=(P,$,Z,I)=>{let ie,ce;if(tv(this._camera)){const ue=ui.copy(this._camera.position).sub(this._target),Q=this._camera.getEffectiveFOV()*Bw,oe=ue.length()*Math.tan(Q*.5);ie=this.truckSpeed*P*oe/this._elementRect.height,ce=this.truckSpeed*$*oe/this._elementRect.height}else if(G3(this._camera)){const ue=this._camera;ie=this.truckSpeed*P*(ue.right-ue.left)/ue.zoom/this._elementRect.width,ce=this.truckSpeed*$*(ue.top-ue.bottom)/ue.zoom/this._elementRect.height}else return;I?(Z?this.setFocalOffset(this._focalOffsetEnd.x+ie,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(ie,0,!0),this.forward(-ce,!0)):Z?this.setFocalOffset(this._focalOffsetEnd.x+ie,this._focalOffsetEnd.y+ce,this._focalOffsetEnd.z,!0):this.truck(ie,ce,!0)},this._rotateInternal=(P,$)=>{const Z=i_*this.azimuthRotateSpeed*P/this._elementRect.height,I=i_*this.polarRotateSpeed*$/this._elementRect.height;this.rotate(Z,I,!0)},this._dollyInternal=(P,$,Z)=>{const I=Math.pow(.95,-P*this.dollySpeed),ie=this._sphericalEnd.radius,ce=this._sphericalEnd.radius*I,ue=mf(ce,this.minDistance,this.maxDistance),Q=ue-ce;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(ce,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(Q,!0),this._dollyToNoClamp(ue,!0)):this._dollyToNoClamp(ue,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?ce:ue)-ie,this._dollyControlCoord.set($,Z)),this._lastDollyDirection=Math.sign(-P)},this._zoomInternal=(P,$,Z)=>{const I=Math.pow(.95,P*this.dollySpeed),ie=this._zoom,ce=this._zoom*I;this.zoomTo(ce,!0),this.dollyToCursor&&(this._changedZoom+=ce-ie,this._dollyControlCoord.set($,Z))},typeof Wr>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Wr.Quaternion().setFromUnitVectors(this._camera.up,_I),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Nt.NONE,this._target=new Wr.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Wr.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Wr.Spherical().setFromVector3(ui.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Wr.Vector3,new Wr.Vector3,new Wr.Vector3,new Wr.Vector3],this._updateNearPlaneCorners(),this._boundary=new Wr.Box3(new Wr.Vector3(-1/0,-1/0,-1/0),new Wr.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Wr.Vector2,this.mouseButtons={left:Nt.ROTATE,middle:Nt.DOLLY,right:Nt.TRUCK,wheel:tv(this._camera)?Nt.DOLLY:G3(this._camera)?Nt.ZOOM:Nt.NONE},this.touches={one:Nt.TOUCH_ROTATE,two:tv(this._camera)?Nt.TOUCH_DOLLY_TRUCK:G3(this._camera)?Nt.TOUCH_ZOOM_TRUCK:Nt.NONE,three:Nt.TOUCH_TRUCK};const n=new Wr.Vector2,r=new Wr.Vector2,i=new Wr.Vector2,o=P=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const I=this._domElement.getBoundingClientRect(),ie=P.clientX/I.width,ce=P.clientY/I.height;if(ie<this._interactiveArea.left||ie>this._interactiveArea.right||ce<this._interactiveArea.top||ce>this._interactiveArea.bottom)return}const $=P.pointerType!=="mouse"?null:(P.buttons&ya.LEFT)===ya.LEFT?ya.LEFT:(P.buttons&ya.MIDDLE)===ya.MIDDLE?ya.MIDDLE:(P.buttons&ya.RIGHT)===ya.RIGHT?ya.RIGHT:null;if($!==null){const I=this._findPointerByMouseButton($);I&&this._disposePointer(I)}if((P.buttons&ya.LEFT)===ya.LEFT&&this._lockedPointer)return;const Z={pointerId:P.pointerId,clientX:P.clientX,clientY:P.clientY,deltaX:0,deltaY:0,mouseButton:$};this._activePointers.push(Z),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),this._isDragging=!0,S(P)},l=P=>{P.cancelable&&P.preventDefault();const $=P.pointerId,Z=this._lockedPointer||this._findPointerById($);if(Z){if(Z.clientX=P.clientX,Z.clientY=P.clientY,Z.deltaX=P.movementX,Z.deltaY=P.movementY,this._state=0,P.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(P.buttons&ya.LEFT)===ya.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(P.buttons&ya.MIDDLE)===ya.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(P.buttons&ya.RIGHT)===ya.RIGHT&&(this._state=this._state|this.mouseButtons.right);A()}},h=P=>{const $=this._findPointerById(P.pointerId);if(!($&&$===this._lockedPointer)){if($&&this._disposePointer($),P.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=Nt.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=Nt.NONE;k()}};let p=-1;const y=P=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Nt.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const ce=this._domElement.getBoundingClientRect(),ue=P.clientX/ce.width,Q=P.clientY/ce.height;if(ue<this._interactiveArea.left||ue>this._interactiveArea.right||Q<this._interactiveArea.top||Q>this._interactiveArea.bottom)return}if(P.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Nt.ROTATE||this.mouseButtons.wheel===Nt.TRUCK){const ce=performance.now();p-ce<1e3&&this._getClientRect(this._elementRect),p=ce}const $=gje?-1:-3,Z=P.deltaMode===1||P.ctrlKey?P.deltaY/$:P.deltaY/($*10),I=this.dollyToCursor?(P.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,ie=this.dollyToCursor?(P.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Nt.ROTATE:{this._rotateInternal(P.deltaX,P.deltaY),this._isUserControllingRotate=!0;break}case Nt.TRUCK:{this._truckInternal(P.deltaX,P.deltaY,!1,!1),this._isUserControllingTruck=!0;break}case Nt.SCREEN_PAN:{this._truckInternal(P.deltaX,P.deltaY,!1,!0),this._isUserControllingTruck=!0;break}case Nt.OFFSET:{this._truckInternal(P.deltaX,P.deltaY,!0,!1),this._isUserControllingOffset=!0;break}case Nt.DOLLY:{this._dollyInternal(-Z,I,ie),this._isUserControllingDolly=!0;break}case Nt.ZOOM:{this._zoomInternal(-Z,I,ie),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},x=P=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===n1.ACTION.NONE){const $=P instanceof PointerEvent?P.pointerId:0,Z=this._findPointerById($);Z&&this._disposePointer(Z),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h);return}P.preventDefault()}},S=P=>{if(!this._enabled)return;if(_G(this._activePointers,Au),this._getClientRect(this._elementRect),n.copy(Au),r.copy(Au),this._activePointers.length>=2){const Z=Au.x-this._activePointers[1].clientX,I=Au.y-this._activePointers[1].clientY,ie=Math.sqrt(Z*Z+I*I);i.set(0,ie);const ce=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,ue=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(ce,ue)}if(this._state=0,!P)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in P&&P.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(P.buttons&ya.LEFT)===ya.LEFT&&(this._state=this._state|this.mouseButtons.left),(P.buttons&ya.MIDDLE)===ya.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(P.buttons&ya.RIGHT)===ya.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&Nt.ROTATE)===Nt.ROTATE||(this._state&Nt.TOUCH_ROTATE)===Nt.TOUCH_ROTATE||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Nt.TRUCK)===Nt.TRUCK||(this._state&Nt.SCREEN_PAN)===Nt.SCREEN_PAN||(this._state&Nt.TOUCH_TRUCK)===Nt.TOUCH_TRUCK||(this._state&Nt.TOUCH_SCREEN_PAN)===Nt.TOUCH_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Nt.DOLLY)===Nt.DOLLY||(this._state&Nt.TOUCH_DOLLY)===Nt.TOUCH_DOLLY||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Nt.ZOOM)===Nt.ZOOM||(this._state&Nt.TOUCH_ZOOM)===Nt.TOUCH_ZOOM||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Nt.OFFSET)===Nt.OFFSET||(this._state&Nt.TOUCH_OFFSET)===Nt.TOUCH_OFFSET||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},A=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,_G(this._activePointers,Au);const $=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,Z=$?-$.deltaX:r.x-Au.x,I=$?-$.deltaY:r.y-Au.y;if(r.copy(Au),((this._state&Nt.ROTATE)===Nt.ROTATE||(this._state&Nt.TOUCH_ROTATE)===Nt.TOUCH_ROTATE||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(Z,I),this._isUserControllingRotate=!0),(this._state&Nt.DOLLY)===Nt.DOLLY||(this._state&Nt.ZOOM)===Nt.ZOOM){const ie=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,ce=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,ue=this.dollyDragInverted?-1:1;(this._state&Nt.DOLLY)===Nt.DOLLY?(this._dollyInternal(ue*I*yI,ie,ce),this._isUserControllingDolly=!0):(this._zoomInternal(ue*I*yI,ie,ce),this._isUserControllingZoom=!0)}if((this._state&Nt.TOUCH_DOLLY)===Nt.TOUCH_DOLLY||(this._state&Nt.TOUCH_ZOOM)===Nt.TOUCH_ZOOM||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE){const ie=Au.x-this._activePointers[1].clientX,ce=Au.y-this._activePointers[1].clientY,ue=Math.sqrt(ie*ie+ce*ce),Q=i.y-ue;i.set(0,ue);const oe=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,le=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Nt.TOUCH_DOLLY)===Nt.TOUCH_DOLLY||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET?(this._dollyInternal(Q*yI,oe,le),this._isUserControllingDolly=!0):(this._zoomInternal(Q*yI,oe,le),this._isUserControllingZoom=!0)}((this._state&Nt.TRUCK)===Nt.TRUCK||(this._state&Nt.TOUCH_TRUCK)===Nt.TOUCH_TRUCK||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(Z,I,!1,!1),this._isUserControllingTruck=!0),((this._state&Nt.SCREEN_PAN)===Nt.SCREEN_PAN||(this._state&Nt.TOUCH_SCREEN_PAN)===Nt.TOUCH_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(Z,I,!1,!0),this._isUserControllingTruck=!0),((this._state&Nt.OFFSET)===Nt.OFFSET||(this._state&Nt.TOUCH_OFFSET)===Nt.TOUCH_OFFSET||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(Z,I,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},k=()=>{_G(this._activePointers,Au),r.copy(Au),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",L),this._domElement.ownerDocument.addEventListener("pointerlockerror",U),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),S())},this.unlockPointer=()=>{var P,$,Z;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(P=this._domElement)===null||P===void 0||P.ownerDocument.exitPointerLock(),($=this._domElement)===null||$===void 0||$.ownerDocument.removeEventListener("pointerlockchange",L),(Z=this._domElement)===null||Z===void 0||Z.ownerDocument.removeEventListener("pointerlockerror",U),this.cancel()};const L=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},U=()=>{this.unlockPointer()};this._addAllEventListeners=P=>{this._domElement=P,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),this._domElement.addEventListener("pointercancel",h),this._domElement.addEventListener("wheel",y,{passive:!1}),this._domElement.addEventListener("contextmenu",x)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("pointercancel",h),this._domElement.removeEventListener("wheel",y,{passive:!1}),this._domElement.removeEventListener("contextmenu",x),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("pointerlockchange",L),this._domElement.ownerDocument.removeEventListener("pointerlockerror",U))},this.cancel=()=>{this._state!==Nt.NONE&&(this._state=Nt.NONE,this._activePointers.length=0,k())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=mf(e.width,0,1),this._interactiveArea.height=mf(e.height,0,1),this._interactiveArea.x=mf(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=mf(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const r=mf(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=mf(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!n||ls(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&ls(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=r_.NONE,this._changedDolly=0,this._dollyToNoClamp(mf(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const o=this._collisionTest(),l=ls(o,this._spherical.radius);if(!(n>e)&&l)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,o)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const i=!t||ls(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Gw).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||ls(this._target.x,this._targetEnd.x,this.restThreshold)&&ls(this._target.y,this._targetEnd.y,this.restThreshold)&&ls(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=mf(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||ls(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),Zp.setFromMatrixColumn(this._camera.matrix,0),Qp.setFromMatrixColumn(this._camera.matrix,1),Zp.multiplyScalar(e),Qp.multiplyScalar(-t);const r=ui.copy(Zp).add(Qp),i=qi.copy(this._targetEnd).add(r);return this.moveTo(i.x,i.y,i.z,n)}forward(e,t=!1){ui.setFromMatrixColumn(this._camera.matrix,0),ui.crossVectors(this._camera.up,ui),ui.multiplyScalar(e);const n=qi.copy(this._targetEnd).add(ui);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return ui.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+ui.x,this._targetEnd.y+ui.y,this._targetEnd.z+ui.z,t)}moveTo(e,t,n,r=!1){this._isUserControllingTruck=!1;const i=ui.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const o=!r||ls(this._target.x,this._targetEnd.x,this.restThreshold)&&ls(this._target.y,this._targetEnd.y,this.restThreshold)&&ls(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,n,r=!1){const l=ui.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(l.x,l.y,l.z,r)}fitToBox(e,t,{cover:n=!1,paddingLeft:r=0,paddingRight:i=0,paddingBottom:o=0,paddingTop:l=0}={}){const h=[],p=e.isBox3?a_.copy(e):a_.setFromObject(e);p.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const y=U2e(this._sphericalEnd.theta,L2e),x=U2e(this._sphericalEnd.phi,L2e);h.push(this.rotateTo(y,x,t));const S=ui.setFromSpherical(this._sphericalEnd).normalize(),A=j2e.setFromUnitVectors(S,SG),k=ls(Math.abs(S.y),1);k&&A.multiply(EG.setFromAxisAngle(_I,y)),A.multiply(this._yAxisUpSpaceInverse);const L=H2e.makeEmpty();qi.copy(p.min).applyQuaternion(A),L.expandByPoint(qi),qi.copy(p.min).setX(p.max.x).applyQuaternion(A),L.expandByPoint(qi),qi.copy(p.min).setY(p.max.y).applyQuaternion(A),L.expandByPoint(qi),qi.copy(p.max).setZ(p.min.z).applyQuaternion(A),L.expandByPoint(qi),qi.copy(p.min).setZ(p.max.z).applyQuaternion(A),L.expandByPoint(qi),qi.copy(p.max).setY(p.min.y).applyQuaternion(A),L.expandByPoint(qi),qi.copy(p.max).setX(p.min.x).applyQuaternion(A),L.expandByPoint(qi),qi.copy(p.max).applyQuaternion(A),L.expandByPoint(qi),L.min.x-=r,L.min.y-=o,L.max.x+=i,L.max.y+=l,A.setFromUnitVectors(SG,S),k&&A.premultiply(EG.invert()),A.premultiply(this._yAxisUpSpace);const U=L.getSize(ui),P=L.getCenter(qi).applyQuaternion(A);if(tv(this._camera)){const $=this.getDistanceToFitBox(U.x,U.y,U.z,n);h.push(this.moveTo(P.x,P.y,P.z,t)),h.push(this.dollyTo($,t)),h.push(this.setFocalOffset(0,0,0,t))}else if(G3(this._camera)){const $=this._camera,Z=$.right-$.left,I=$.top-$.bottom,ie=n?Math.max(Z/U.x,I/U.y):Math.min(Z/U.x,I/U.y);h.push(this.moveTo(P.x,P.y,P.z,t)),h.push(this.zoomTo(ie,t)),h.push(this.setFocalOffset(0,0,0,t))}return Promise.all(h)}fitToSphere(e,t){const n=[],i="isObject3D"in e?n1.createBoundingSphere(e,wG):wG.copy(e);if(n.push(this.moveTo(i.center.x,i.center.y,i.center.z,t)),tv(this._camera)){const o=this.getDistanceToFitSphere(i.radius);n.push(this.dollyTo(o,t))}else if(G3(this._camera)){const o=this._camera.right-this._camera.left,l=this._camera.top-this._camera.bottom,h=2*i.radius,p=Math.min(o/h,l/h);n.push(this.zoomTo(p,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,r,i,o,l=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=r_.NONE,this._changedDolly=0;const h=qi.set(r,i,o),p=ui.set(e,t,n);this._targetEnd.copy(h),this._sphericalEnd.setFromVector3(p.sub(h).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,l||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const y=!l||ls(this._target.x,this._targetEnd.x,this.restThreshold)&&ls(this._target.y,this._targetEnd.y,this.restThreshold)&&ls(this._target.z,this._targetEnd.z,this.restThreshold)&&ls(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&ls(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&ls(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(y)}lerpLookAt(e,t,n,r,i,o,l,h,p,y,x,S,A,k=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=r_.NONE,this._changedDolly=0;const L=ui.set(r,i,o),U=qi.set(e,t,n);kh.setFromVector3(U.sub(L).applyQuaternion(this._yAxisUpSpace));const P=s_.set(y,x,S),$=qi.set(l,h,p);Hw.setFromVector3($.sub(P).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(L.lerp(P,A));const Z=Hw.theta-kh.theta,I=Hw.phi-kh.phi,ie=Hw.radius-kh.radius;this._sphericalEnd.set(kh.radius+ie*A,kh.phi+I*A,kh.theta+Z*A),this.normalizeRotations(),this._needsUpdate=!0,k||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const ce=!k||ls(this._target.x,this._targetEnd.x,this.restThreshold)&&ls(this._target.y,this._targetEnd.y,this.restThreshold)&&ls(this._target.z,this._targetEnd.z,this.restThreshold)&&ls(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&ls(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&ls(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(ce)}setPosition(e,t,n,r=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n,r=!1){const i=this.getPosition(ui),o=this.setLookAt(i.x,i.y,i.z,e,t,n,r);return this._sphericalEnd.phi=mf(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,n,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const i=!r||ls(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&ls(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&ls(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),Zp.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Qp.setFromMatrixColumn(this._camera.matrixWorldInverse,1),nv.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=ui.set(e,t,n),i=r.distanceTo(this._camera.position),o=r.sub(this._camera.position);Zp.multiplyScalar(o.x),Qp.multiplyScalar(o.y),nv.multiplyScalar(o.z),ui.copy(Zp).add(Qp).add(nv),ui.z=ui.z+i,this.dollyTo(i,!1),this.setFocalOffset(-ui.x,ui.y,-ui.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Wr.Vector4,typeof e=="number"?this._viewport.set(e,t,n,r):this._viewport.copy(e)}getDistanceToFitBox(e,t,n,r=!1){if(xG(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const i=e/t,o=this._camera.getEffectiveFOV()*Bw,l=this._camera.aspect;return((r?i>l:i<l)?t:e/l)*.5/Math.tan(o*.5)+n*.5}getDistanceToFitSphere(e){if(xG(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Bw,n=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,r=1<this._camera.aspect?t:n;return e/Math.sin(r*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Wr.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Wr.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new Wr.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Wr.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%i_,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=i_),this._spherical.theta+=i_*Math.round((this._sphericalEnd.theta-this._spherical.theta)/i_)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!ls(this._camera.up.x,this._cameraUp0.x)||!ls(this._camera.up.y,this._cameraUp0.y)||!ls(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const n=this.getPosition(ui);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,_I),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=ui.subVectors(this._target,this._camera.position).normalize(),t=qi.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(ui);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,i=V2e.subVectors(this._targetEnd,this._target),o=G2e.subVectors(this._focalOffsetEnd,this._focalOffset),l=this._zoomEnd-this._zoom;if(Ls(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=vI(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,x,1/0,e),this._needsUpdate=!0}if(Ls(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=vI(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,x,1/0,e),this._needsUpdate=!0}if(Ls(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const x=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=vI(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,x,this.maxSpeed,e),this._needsUpdate=!0}if(Ls(i.x)&&Ls(i.y)&&Ls(i.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const x=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;B2e(this._target,this._targetEnd,this._targetVelocity,x,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Ls(o.x)&&Ls(o.y)&&Ls(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const x=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;B2e(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,x,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Ls(l))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const x=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=vI(this._zoom,this._zoomEnd,this._zoomVelocity,x,1/0,e)}if(this.dollyToCursor){if(tv(this._camera)&&this._changedDolly!==0){const x=this._spherical.radius-this._lastDistance,S=this._camera,A=this._getCameraDirection(Gw),k=ui.copy(A).cross(S.up).normalize();k.lengthSq()===0&&(k.x=1);const L=qi.crossVectors(k,A),U=this._sphericalEnd.radius*Math.tan(S.getEffectiveFOV()*Bw*.5),$=(this._sphericalEnd.radius-x-this._sphericalEnd.radius)/this._sphericalEnd.radius,Z=s_.copy(this._targetEnd).add(k.multiplyScalar(this._dollyControlCoord.x*U*S.aspect)).add(L.multiplyScalar(this._dollyControlCoord.y*U)),I=ui.copy(this._targetEnd).lerp(Z,$),ie=this._lastDollyDirection===r_.IN&&this._spherical.radius<=this.minDistance,ce=this._lastDollyDirection===r_.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(ie||ce)){this._sphericalEnd.radius-=x,this._spherical.radius-=x;const Q=qi.copy(A).multiplyScalar(-x);I.add(Q)}this._boundary.clampPoint(I,I);const ue=qi.subVectors(I,this._targetEnd);this._targetEnd.copy(I),this._target.add(ue),this._changedDolly-=x,Ls(this._changedDolly)&&(this._changedDolly=0)}else if(G3(this._camera)&&this._changedZoom!==0){const x=this._zoom-this._lastZoom,S=this._camera,A=ui.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(S.near+S.far)/(S.near-S.far)).unproject(S),k=qi.set(0,0,-1).applyQuaternion(S.quaternion),L=s_.copy(A).add(k.multiplyScalar(-A.dot(S.up))),P=-(this._zoom-x-this._zoom)/this._zoom,$=this._getCameraDirection(Gw),Z=this._targetEnd.dot($),I=ui.copy(this._targetEnd).lerp(L,P),ie=I.dot($),ce=$.multiplyScalar(ie-Z);I.sub(ce),this._boundary.clampPoint(I,I);const ue=qi.subVectors(I,this._targetEnd);this._targetEnd.copy(I),this._target.add(ue),this._changedZoom-=x,Ls(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const h=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,h),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Ls(this._focalOffset.x)||!Ls(this._focalOffset.y)||!Ls(this._focalOffset.z))&&(Zp.setFromMatrixColumn(this._camera.matrix,0),Qp.setFromMatrixColumn(this._camera.matrix,1),nv.setFromMatrixColumn(this._camera.matrix,2),Zp.multiplyScalar(this._focalOffset.x),Qp.multiplyScalar(-this._focalOffset.y),nv.multiplyScalar(this._focalOffset.z),ui.copy(Zp).add(Qp).add(nv),this._camera.position.add(ui),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),ui.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const y=this._needsUpdate;return y&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):y?(this.dispatchEvent({type:"update"}),Ls(t,this.restThreshold)&&Ls(n,this.restThreshold)&&Ls(r,this.restThreshold)&&Ls(i.x,this.restThreshold)&&Ls(i.y,this.restThreshold)&&Ls(i.z,this.restThreshold)&&Ls(o.x,this.restThreshold)&&Ls(o.y,this.restThreshold)&&Ls(o.z,this.restThreshold)&&Ls(l,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!y&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=y,this._needsUpdate=!1,y}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:zw(this.maxDistance),minZoom:this.minZoom,maxZoom:zw(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:zw(this.maxPolarAngle),minAzimuthAngle:zw(this.minAzimuthAngle),maxAzimuthAngle:zw(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:ui.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=Vw(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=Vw(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=Vw(n.maxPolarAngle),this.minAzimuthAngle=Vw(n.minAzimuthAngle),this.maxAzimuthAngle=Vw(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),kh.setFromVector3(ui.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(kh.theta,kh.phi,t),this.dollyTo(kh.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",mje),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(r===0)return e;const i=qi.copy(t).add(e),l=this._boundary.clampPoint(i,s_).sub(i),h=l.lengthSq();if(h===0)return e.add(t);if(h===r)return e;if(n===0)return e.add(t).add(l);{const p=1+n*h/t.dot(l);return e.add(qi.copy(t).multiplyScalar(p)).add(l.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(tv(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*Bw,r=Math.tan(n*.5)*t,i=r*e.aspect;this._nearPlaneCorners[0].set(-i,-r,0),this._nearPlaneCorners[1].set(i,-r,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(-i,r,0)}else if(G3(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,i=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(n,i,0),this._nearPlaneCorners[1].set(r,i,0),this._nearPlaneCorners[2].set(r,o,0),this._nearPlaneCorners[3].set(n,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||xG(this._camera,"_collisionTest"))return e;const n=this._getTargetDirection(Gw);TG.lookAt(z2e,n,this._camera.up);for(let r=0;r<4;r++){const i=qi.copy(this._nearPlaneCorners[r]);i.applyMatrix4(TG);const o=s_.addVectors(this._target,i);xI.set(o,n),xI.far=this._spherical.radius+1;const l=xI.intersectObjects(this.colliderMeshes);l.length!==0&&l[0].distance<e&&(e=l[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const n=()=>{this.removeEventListener("rest",n),t()};this.addEventListener("rest",n)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Wr.Sphere){const n=t,r=n.center;a_.makeEmpty(),e.traverseVisible(o=>{o.isMesh&&a_.expandByObject(o)}),a_.getCenter(r);let i=0;return e.traverseVisible(o=>{if(!o.isMesh)return;const l=o;if(!l.geometry)return;const h=l.geometry.clone();h.applyMatrix4(l.matrixWorld);const y=h.attributes.position;for(let x=0,S=y.count;x<S;x++)ui.fromBufferAttribute(y,x),i=Math.max(i,r.distanceToSquared(ui))}),n.radius=Math.sqrt(i),n}}const wk=s=>{const[e,t]=Fn.useState(s.options[s.index]),n=()=>{s.onToggle(!s.open)},r=o=>{o!==e&&(s.onSelect(o),t(o)),s.onToggle(!1)},i=s.open?`${s.options.length*31-1}px`:"0px";return et.jsxs("div",{className:`dropdown ${s.up===!0?"up":""}`,children:[et.jsx("div",{className:"dropdown-toggle",onClick:n,children:`${s.title}: ${e}`}),et.jsx("ul",{className:"dropdown-menu",style:{height:i},children:s.options.map(o=>et.jsx("li",{onClick:()=>r(o),children:o},o))})]})},rv=Fn.forwardRef(function(e,t){const n=["Renderer","Depth","Normals","UVs","Wireframe"],[r,i]=Fn.useState("Renderer"),[o,l]=Fn.useState(!1),[h,p]=Fn.useState(!1),[y,x]=Fn.useState(!1);return et.jsxs("div",{className:`CameraWindow ${e.name}`,children:[et.jsx("div",{ref:t,className:"clickable",onClick:()=>{y&&x(!1)}}),et.jsxs("div",{className:"options",children:[e.camera!==null&&et.jsx(wk,{title:"Camera",index:e.options.indexOf(e.camera.name),open:y,options:e.options,onSelect:e.onSelectCamera,onToggle:S=>{S&&h&&p(!1),x(S)},up:!0}),et.jsx(wk,{title:"Mode",index:n.indexOf(r),open:h,options:n,onSelect:S=>{if(S===r)return;const A=S;e.onSelectRenderMode(A),i(A)},onToggle:S=>{S&&y&&x(!1),o&&l(!1),p(S)},up:!0})]})]})}),vje=`out vec3 worldPosition;
uniform float uDistance;

void main() {
  // Scale the plane by the drawing distance
  worldPosition = position.xzy * uDistance;
  worldPosition.xz += cameraPosition.xz;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(worldPosition, 1.0);
}`,yje=`out vec4 fragColor;
in vec3 worldPosition;
uniform float uDivisions;
uniform float uScale;
uniform vec3 uColor;
uniform float uDistance;
uniform float uGridOpacity;
uniform float uSubgridOpacity;

#define minAlpha 0.00784313725490196

float getGrid(float gapSize) {
  vec2 worldPositionByDivision = worldPosition.xz / gapSize;

  // Inverted, 0 where line, >1 where there's no line
  // We use the worldPosition (which in this case we use similarly to UVs) differential to control the anti-aliasing
  // We need to do the -0.5)-0.5 trick because the result fades out from 0 to 1, and we want both
  // worldPositionByDivision == 0.3 and worldPositionByDivision == 0.7 to result in the same fade, i.e. 0.3,
  // otherwise only one side of the line will be anti-aliased
  vec2 grid = abs(fract(worldPositionByDivision-0.5)-0.5) / fwidth(worldPositionByDivision) / 2.0;
  float gridLine = min(grid.x, grid.y);

  // Uninvert and clamp
  return 1.0 - min(gridLine, 1.0);
}

void main() {
  float cameraDistanceToGridPlane = max(200.0, distance(cameraPosition.y, worldPosition.y));
  float cameraDistanceToFragmentOnGridPlane = distance(cameraPosition.xyz, worldPosition.xyz);

  // The size of the grid and subgrid are powers of each other and they are determined based on camera distance.
  // The current grid will become the next subgrid when it becomes too small, and its next power becomes the new grid.
  float subGridPower = pow(uDivisions, floor(log(cameraDistanceToGridPlane) / log(uDivisions)));
  float gridPower = subGridPower * uDivisions;

  // If we want to fade both the grid and its subgrid, we need to displays 3 different opacities, with the next grid being the third
  float nextGridPower = gridPower * uDivisions;

  // 1 where grid, 0 where no grid
  float subgrid = getGrid(subGridPower * uScale);
  float grid = getGrid(gridPower * uScale);
  float nextGrid = getGrid(nextGridPower * uScale);

  // Where we are between the introduction of the current grid power and when we switch to the next grid power
  float stepPercentage = (cameraDistanceToGridPlane - subGridPower)/(gridPower - subGridPower);

  // The last x percentage of the current step over which we want to fade
  float fadeRange = 0.3;

  // We calculate the fade percentage from the step percentage and the fade range
  float fadePercentage = max(stepPercentage - 1.0 + fadeRange, 0.0) / fadeRange;

  // Set base opacity based on how close we are to the drawing distance, with a cubic falloff
  float baseOpacity = subgrid * pow(1.0 - min(cameraDistanceToFragmentOnGridPlane / uDistance, 1.0), 3.0);

  // Shade the subgrid
  fragColor = vec4(uColor.rgb, (baseOpacity - fadePercentage) * uSubgridOpacity);

  // Somewhat arbitrary additional fade coefficient to counter anti-aliasing popping when switching between grid powers
  float fadeCoefficient = 0.5;

  // Shade the grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity - fadePercentage * (uGridOpacity - uSubgridOpacity) * fadeCoefficient, grid);

  // Shade the next grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity, nextGrid);

  if (fragColor.a <= minAlpha) discard;
}`;class _je extends $o{constructor(e){super({extensions:{derivatives:!0},uniforms:{uScale:{value:(e==null?void 0:e.scale)!==void 0?e==null?void 0:e.scale:.1},uDivisions:{value:(e==null?void 0:e.divisions)!==void 0?e==null?void 0:e.divisions:10},uColor:{value:(e==null?void 0:e.color)!==void 0?e==null?void 0:e.color:new Vn(16777215)},uDistance:{value:(e==null?void 0:e.distance)!==void 0?e==null?void 0:e.distance:1e4},uSubgridOpacity:{value:(e==null?void 0:e.subgridOpacity)!==void 0?e==null?void 0:e.subgridOpacity:.15},uGridOpacity:{value:(e==null?void 0:e.gridOpacity)!==void 0?e==null?void 0:e.gridOpacity:.25}},glslVersion:MH,side:X0,transparent:!0,name:"InfiniteGrid",vertexShader:vje,fragmentShader:yje})}}class xje extends Mn{constructor(t){const n=new _je(t);super(new Cv,n);Qe(this,"gridMaterial");this.gridMaterial=n,this.frustumCulled=!1,this.name="InfiniteGridHelper"}update(){this.gridMaterial.needsUpdate=!0}}function _E(s){const[e,t]=Fn.useState(s.open!==void 0?s.open:!1),[n,r]=Fn.useState(s.visible!==void 0?s.visible:!1),i=!e||s.children===void 0,o=()=>{s.three.dispatchEvent({type:pi.REMOVE_SCENE,value:s.scene})};return et.jsxs("div",{className:`accordion ${i?"hide":""}`,children:[et.jsxs("button",{className:"toggle",onClick:()=>{const l=!e;s.onToggle!==void 0&&s.onToggle(l),t(l)},children:[et.jsx("p",{className:`status ${e?"open":""}`,children:"Toggle"}),et.jsx("p",{className:"label",children:nk(s.label)})]}),s.onRefresh?et.jsxs(et.Fragment,{children:[et.jsx("button",{className:"visibility",style:{opacity:n?1:.25},onClick:()=>{const h=s.three.getScene(s.scene.uuid);if(h){const p=!h.visible;h.visible=p,r(p)}}}),et.jsx("button",{className:"refresh",onClick:s.onRefresh}),et.jsx("button",{className:"remove",onClick:o})]}):null,s.button,et.jsx("div",{className:e?"open":"",children:et.jsx("div",{children:s.children})},Math.random())]})}function sE(s){const[e,t]=Fn.useState(s.defaultValue);return Fn.useEffect(()=>{var A,k;let n=!1,r=-1,i=0,o=s.defaultValue,l=!1;const h=L=>{l=L.ctrlKey},p=L=>{var U;n=!0,i=Number((U=s.input.current)==null?void 0:U.value),r=L.clientX,document.addEventListener("mouseup",x,!1),document.addEventListener("mousemove",y,!1),document.addEventListener("contextmenu",x,!1)},y=L=>{if(!n)return;const U=s.step!==void 0?s.step:1,P=(L.clientX-r)*U*(l?10:1);o=Number((i+P).toFixed(4)),s.min!==void 0&&(o=Math.max(o,s.min)),s.max!==void 0&&(o=Math.min(o,s.max)),s.onChange!==void 0&&s.onChange(o),t(o)},x=()=>{n=!1,document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",y),document.removeEventListener("contextmenu",x)},S=L=>{const U=Number(L.target.value);s.onChange!==void 0&&s.onChange(U),t(U)};return(A=s.label.current)==null||A.addEventListener("mousedown",p,!1),s.sliderRef!==void 0&&((k=s.sliderRef.current)==null||k.addEventListener("input",S)),document.addEventListener("keydown",h,!1),document.addEventListener("keyup",h,!1),()=>{var L,U;(L=s.label.current)==null||L.removeEventListener("mousedown",p),s.sliderRef!==void 0&&((U=s.sliderRef.current)==null||U.removeEventListener("input",S)),document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",y),document.removeEventListener("contextmenu",x),document.removeEventListener("keydown",h),document.addEventListener("keyup",h,!1)}},[]),e}function Ev(s){const e=Fn.useRef(null),t=Fn.useRef(null),[n,r]=Fn.useState(s.value);return sE({label:s.labelRef,input:e,sliderRef:t,defaultValue:n,min:s.min,max:s.max,step:s.step,onChange:i=>{r(i),s.onChange!==void 0&&s.onChange(s.prop,i)}}),et.jsxs(et.Fragment,{children:[s.type==="number"&&et.jsx("input",{alt:s.alt,className:s.className,ref:e,type:"number",value:n,min:s.min,max:s.max,step:s.step,disabled:s.disabled,name:v0(),onChange:i=>{if(r(i.target.value),i.target.value.length===0)return;const o=Number(i.target.value);isNaN(o)||s.onChange!==void 0&&s.onChange(s.prop,o)}}),s.type==="range"&&et.jsxs(et.Fragment,{children:[et.jsx("input",{type:"text",value:n.toString(),disabled:s.disabled,ref:e,className:"min",name:v0(),onChange:i=>{if(i.target.value.length===0)return;const o=Number(i.target.value);isNaN(o)||(r(o),s.onChange!==void 0&&s.onChange(s.prop,o))}}),et.jsx("input",{disabled:s.disabled,type:"range",value:n,min:s.min,max:s.max,step:s.step,ref:t,name:v0(),onChange:w3e})]})]})}function bje(s){const e=Fn.useRef(null),t=Fn.useRef(null),n=Fn.useRef(null),r=Fn.useRef(null),i=Fn.useRef(null),o=Fn.useRef(null),l=Fn.useRef(null),h=Fn.useRef(null),p=Fn.useRef(null),y=Fn.useRef(null),[x,S]=Fn.useState(s.value.x),[A,k]=Fn.useState(s.value.y),[L,U]=Fn.useState({min:Math.min(s.min,Math.min(s.value.x,s.value.y)),max:Math.max(s.max,Math.max(s.value.x,s.value.y))}),[P,$]=Fn.useState(!1);sE({label:l,input:e,defaultValue:x,min:L.min,max:L.max,step:.01,onChange:oe=>{S(oe),s.onChange({target:{value:{x:oe,y:A}}})}}),sE({label:h,input:t,defaultValue:A,min:L.min,max:L.max,step:.01,onChange:oe=>{k(oe),s.onChange({target:{value:{x,y:oe}}})}}),sE({label:p,input:n,defaultValue:L.min,min:L.min-1,max:L.max+1,step:.01,onChange:oe=>{U({min:oe,max:L.max})}}),sE({label:y,input:r,defaultValue:L.max,min:L.min-1,max:L.max+1,step:.01,onChange:oe=>{U({min:L.min,max:oe})}});function Z(){P||(window.addEventListener("mousemove",ie),window.addEventListener("mouseup",I),$(!0))}function I(){window.removeEventListener("mousemove",ie),window.removeEventListener("mouseup",I),$(!1)}function ie(oe){const le=i.current.getBoundingClientRect(),J=av(0,99,oe.clientX-le.left)/99,Be=1-av(0,99,oe.clientY-le.top)/99,He=_f(UH(L.min,L.max,J),3),rt=_f(UH(L.min,L.max,Be),3);s.onChange({target:{value:{x:He,y:rt}}}),S(He),k(rt)}function ce(){const oe=Number(n.current.value);U({min:oe,max:L.max}),x<oe&&S(av(oe,L.max,x)),A<oe&&k(av(oe,L.max,A))}function ue(){const oe=Number(r.current.value);U({min:L.min,max:oe}),x>oe&&S(av(L.min,oe,x)),A>oe&&k(av(L.min,oe,A))}Fn.useEffect(()=>{o.current.style.left=`${Cme(L.min,L.max,x)*100}%`,o.current.style.top=`${(1-Cme(L.min,L.max,A))*100}%`},[L,x,A]);const Q=s.step!==void 0?s.step:.01;return et.jsxs("div",{className:"vector2",children:[et.jsxs("div",{className:"fields",children:[et.jsxs("div",{children:[et.jsx("span",{ref:l,children:"X"}),et.jsx("input",{ref:e,type:"number",value:x,min:L.min,max:L.max,step:Q,name:v0(),onChange:oe=>{if(S(oe.target.value),oe.target.value.length===0)return;const le=Number(oe.target.value);isNaN(le)||(s.onChange({target:{value:{x:le,y:A}}}),le<L.min&&U({min:le,max:L.max}))}})]}),et.jsxs("div",{children:[et.jsx("span",{ref:h,children:"Y"}),et.jsx("input",{ref:t,type:"number",value:A,min:L.min,max:L.max,step:Q,name:v0(),onChange:oe=>{if(k(oe.target.value),oe.target.value.length===0)return;const le=Number(oe.target.value);isNaN(le)||(s.onChange({target:{value:{x,y:le}}}),le>L.max&&U({min:L.min,max:le}))}})]}),et.jsxs("div",{children:[et.jsx("span",{ref:p,children:"Min"}),et.jsx("input",{ref:n,type:"number",value:L.min,step:Q,name:v0(),onChange:ce})]}),et.jsxs("div",{children:[et.jsx("span",{ref:y,children:"Max"}),et.jsx("input",{ref:r,type:"number",value:L.max,step:Q,name:v0(),onChange:ue})]})]}),et.jsxs("div",{className:"input",ref:i,onMouseDown:Z,onMouseUp:I,children:[et.jsx("div",{className:"x"}),et.jsx("div",{className:"y"}),et.jsx("div",{className:"pt",ref:o})]})]})}function W2e(s){const e=s.value.x!==void 0&&s.value.y!==void 0&&s.value.z!==void 0,t=s.value.isEuler!==void 0,n=s.value.elements!==void 0,r=s.step!==void 0?s.step:.01,i=[];if(t){const o=Fn.useMemo(()=>s.value,[]);["_x","_y","_z"].forEach(h=>{const p=Fn.useRef(null);i.push(et.jsxs("div",{children:[et.jsx("span",{ref:p,children:h.substring(1).toUpperCase()}),et.jsx(Ev,{value:T3e(o[h]),type:"number",prop:h,step:.1,labelRef:p,onChange:(y,x)=>{o[y]=rk(x),s.onChange({target:{value:o}})}})]},h))})}else if(e){const o=Fn.useMemo(()=>s.value,[]),l=(p,y)=>{o[p]=y,s.onChange({target:{value:o}})};["x","y","z"].forEach(p=>{const y=Fn.useRef(null);i.push(et.jsxs("div",{children:[et.jsx("label",{ref:y,children:p.toUpperCase()}),et.jsx(Ev,{value:o[p],type:"number",prop:p,step:r,labelRef:y,onChange:l})]},p))})}else if(n){const o=Fn.useMemo(()=>s.value,[]),l=(h,p)=>{const y=Number(h);o.elements[y]=p,s.onChange({target:{value:o}})};for(let h=0;h<9;h++){const p=Fn.useRef(null);i.push(et.jsxs("div",{children:[et.jsx("label",{ref:p,children:h+1}),et.jsx(Ev,{value:o.elements[h],type:"number",prop:h.toString(),step:r,labelRef:p,onChange:l})]},h.toString()))}}return et.jsx("div",{className:"grid3",children:i},Math.random().toString())}function Sje(s){const e=s.value.x!==void 0,t=s.step!==void 0?s.step:.01,n=[];if(e){const r=Fn.useMemo(()=>s.value,[]),i=(l,h)=>{r[l]=h,s.onChange({target:{value:r}})};["x","y","z","w"].forEach(l=>{const h=Fn.useRef(null);n.push(et.jsxs("div",{children:[et.jsx("label",{ref:h,children:l.toUpperCase()}),et.jsx(Ev,{value:r[l],type:"number",prop:l,step:t,labelRef:h,onChange:i})]},l))})}else{const r=Fn.useMemo(()=>s.value,[]),i=(o,l)=>{const h=Number(o);r.elements[h]=l,s.onChange({target:{value:r}})};for(let o=0;o<16;o++){const l=Fn.useRef(null);n.push(et.jsxs("div",{children:[et.jsx("span",{ref:l,children:o+1}),et.jsx(Ev,{value:r.elements[o],type:"number",prop:o.toString(),step:t,labelRef:l,onChange:i})]},o.toString()))}}return et.jsx("div",{className:"grid4",children:n})}function wje(s){return!(s==="defaultAttributeValues"||s==="forceSinglePass"||s==="linecap"||s==="linejoin"||s==="linewidth"||s==="normalMapType"||s==="precision"||s==="shadowSide"||s==="uniformsGroups"||s==="uniformsNeedUpdate"||s==="userData"||s==="version"||s==="wireframeLinecap"||s==="wireframeLinejoin"||s==="wireframeLinewidth"||s.slice(0,4)==="clip"||s.slice(0,7)==="polygon"||s.slice(0,7)==="stencil"||s.slice(0,2)==="is")}function Eje(s){switch(s){case"Alpha Map":return"alphaMap";case"Anisotropy Map":return"anisotropyMap";case"AO Map":return"aoMap";case"Bump Map":return"bumpMap";case"Clearcoat Map":return"clearcoatMap";case"Clearcoat Normal Map":return"clearcoatNormalMap";case"Clearcoat Roughness Map":return"clearcoatRoughnessMap";case"Displacement Map":return"displacementMap";case"Emissive Map":return"emissiveMap";case"Gradient Map":return"gradientMap";case"Iridescence Map":return"iridescenceMap";case"Iridescence Thickness Map":return"iridescenceThicknessMap";case"Map":return"map";case"Matcap":return"matcap";case"Normal Map":return"normalMap";case"Roughness Map":return"roughnessMap";case"Sheen Color Map":return"sheenColorMap";case"Sheen Roughness Map":return"sheenRoughnessMap";case"Specular Color Map":return"specularColorMap";case"Specular Map Intensity":return"specularIntensityMap";case"Thickness Map":return"thicknessMap";case"Transmission Map":return"transmissionMap"}return s}function Qk(s){switch(s){case"alphaHash":return"Alpha Hash";case"alphaMap":return"Alpha Map";case"alphaToCoverage":return"Alpha To Coverage";case"anisotropy":return"Anisotropy";case"anisotropyMap":return"Anisotropy Map";case"anisotropyRotation":return"Anisotropy Rotation";case"aoMap":return"AO Map";case"aoMapIntensity":return"AO Map Intensity";case"attenuationColor":return"Attenuation Color";case"attenuationDistance":return"Attenuation Distance";case"blendAlpha":return"Blend Alpha";case"blendColor":return"Blend Color";case"blendDst":return"Blend Dst";case"blendDstAlpha":return"Blend Dst Alha";case"blendEquation":return"Blend Equation";case"blendEquationAlpha":return"Blend Equation Alpha";case"blending":return"Blending";case"blendSrc":return"Blend Src";case"blendSrcAlpha":return"Blend Src Alpha";case"bumpMap":return"Bump Map";case"bumpScale":return"Bump Scale";case"clearcoat":return"Clearcoat";case"clearcoatMap":return"Clearcoat Map";case"clearcoatNormalMap":return"Clearcoat Normal Map";case"clearcoatNormalScale":return"Clearcoat Normal Scale";case"clearcoatRoughness":return"Clearcoat Roughness";case"clearcoatRoughnessMap":return"Clearcoat Roughness Map";case"color":return"Color";case"colorWrite":return"Color Write";case"defines":return"Defines";case"depthFunc":return"Depth Func";case"depthTest":return"Depth Test";case"depthWrite":return"Depth Write";case"dispersion":return"Dispersion";case"displacementBias":return"Displacement Bias";case"displacementMap":return"Displacement Map";case"displacementScale":return"Displacement Scale";case"dithering":return"Dithering";case"emissive":return"Emissive";case"emissiveMap":return"Emissive Map";case"emissiveIntensity":return"Emissive Intensity";case"envMap":return"Environment Map";case"envMapIntensity":return"Environment Map Intensity";case"envMapRotation":return"Environment Map Rotation";case"extensions":return"Extensions";case"flatShading":return"Flat Shading";case"fragmentShader":return"Fragment Shader";case"fog":return"Fog";case"glslVersion":return"GLSL Version";case"gradientMap":return"Gradient Map";case"ior":return"IOR";case"iridescence":return"Iridescence";case"iridescenceIOR":return"Iridescence IOR";case"iridescenceMap":return"Iridescence Map";case"iridescenceThicknessMap":return"Iridescence Thickness Map";case"iridescenceThicknessRange":return"Iridescence Thickness Range";case"lights":return"Lights";case"lightMap":return"Light Map";case"lightMapIntensity":return"Light Map Intensity";case"map":return"Map";case"matcap":return"Matcap";case"metalness":return"Metalness";case"metalnessMap":return"Metalness Map";case"name":return"Name";case"normalMap":return"Normal Map";case"normalScale":return"Normal Scale";case"premultipliedAlpha":return"Premultiplied Alpha";case"opacity":return"Opacity";case"reflectivity":return"Reflectivity";case"refractionRatio":return"Refraction Ratio";case"roughness":return"Roughness";case"roughnessMap":return"Roughness Map";case"sheen":return"Sheen";case"sheenColor":return"Sheen Color";case"sheenColorMap":return"Sheen Color Map";case"sheenRoughness":return"Sheen Roughness";case"sheenRoughnessMap":return"Sheen Roughness Map";case"shininess":return"Shininess";case"side":return"Side";case"size":return"Size";case"sizeAttenuation":return"Size Attenuation";case"specular":return"Specular";case"specularColor":return"Specular Color";case"specularColorMap":return"Specular Color Map";case"specularIntensity":return"Specular Intensity";case"specularIntensityMap":return"Specular Map Intensity";case"thickness":return"Thickness";case"thicknessMap":return"Thickness Map";case"toneMapped":return"Tone Mapped";case"transmission":return"Transmission";case"transmissionMap":return"Transmission Map";case"transparent":return"Transparent";case"type":return"Type";case"uuid":return"UUID";case"uniforms":return"Uniforms";case"vertexColors":return"Vertex Colors";case"vertexShader":return"Vertex Shader";case"visible":return"Visible";case"wireframe":return"Wireframe"}return s}function e8e(s){const e=s.toLowerCase();return e.search("intensity")>-1||e==="anisotropyrotation"||e==="blendalpha"||e==="bumpscale"||e==="clearcoatroughness"||e==="displacementbias"||e==="displacementscale"||e==="metalness"||e==="opacity"||e==="reflectivity"||e==="refractionratio"||e==="roughness"||e==="sheenroughness"}function Tje(){const s=document.createElement("input");return s.type="file",new Promise((e,t)=>{s.addEventListener("change",function(){if(s.files===null)t();else{const n=s.files[0],r=new FileReader;r.onload=function(i){e(i.target.result)},r.readAsDataURL(n)}}),s.click()})}const Mje=[{title:"Front",value:c1},{title:"Back",value:qa},{title:"Double",value:X0}],Cje=[{title:"No Blending",value:Gl},{title:"Normal",value:Sv},{title:"Additive",value:VG},{title:"Subtractive",value:GG},{title:"Multiply",value:HG},{title:"Custom",value:p9e}],Aje=[{title:"Add",value:q3},{title:"Subtract",value:m9e},{title:"Reverse Subtract",value:g9e},{title:"Min",value:v9e},{title:"Max",value:y9e}],Pje=[{title:"Zero",value:wj},{title:"One",value:Ej},{title:"Src Color",value:Tj},{title:"One Minus Src Color",value:Mj},{title:"Src Alpha",value:bE},{title:"One Minus Src Alpha",value:SE},{title:"Dst Alpha",value:Cj},{title:"One Minus Dst Alpha",value:Aj},{title:"Dst Color",value:Pj},{title:"One Minus Dst Color",value:Rj},{title:"Src Alpha Saturate",value:_9e},{title:"Constant Color",value:Ij},{title:"One Minus Constant Color",value:kj},{title:"Constant Alpha",value:Nj},{title:"One Minus Constant Alpha",value:Dj}],Rje=[{title:"Zero",value:wj},{title:"One",value:Ej},{title:"Src Color",value:Tj},{title:"One Minus Src Color",value:Mj},{title:"Src Alpha",value:bE},{title:"One Minus Src Alpha",value:SE},{title:"Dst Alpha",value:Cj},{title:"One Minus Dst Alpha",value:Aj},{title:"Dst Color",value:Pj},{title:"One Minus Dst Color",value:Rj},{title:"Constant Color",value:Ij},{title:"One Minus Constant Color",value:kj},{title:"Constant Alpha",value:Nj},{title:"One Minus Constant Alpha",value:Dj}];function jw(s,e){s.needsUpdate=!0,s.type="option",s.options=e}function Ije(s,e,t,n){return{type:"boolean",title:Qk(s),prop:s,value:e,needsUpdate:!0,onChange:(r,i)=>{n.updateObject(t.uuid,`material.${s}`,i),n.updateObject(t.uuid,"material.needsUpdate",!0);const o=n.getScene(t.uuid);if(o!==null){const l=o.getObjectByProperty("uuid",t.uuid);Wa(l,`material.${s}`,i)}}}}function kje(s,e,t,n){const r={type:"number",title:Qk(s),prop:s,value:e,min:void 0,max:void 0,step:.01,needsUpdate:!0,onChange:(i,o)=>{n.updateObject(t.uuid,`material.${s}`,o),n.updateObject(t.uuid,"material.needsUpdate",!0);const l=n.getScene(t.uuid);if(l!==null){const h=l.getObjectByProperty("uuid",t.uuid);Wa(h,`material.${s}`,o)}}};switch(s){case"blending":jw(r,Cje);break;case"blendDst":jw(r,Rje);break;case"blendEquation":jw(r,Aje);break;case"blendSrc":jw(r,Pje);break;case"side":jw(r,Mje);break}return e8e(s)&&(r.value=Number(e),r.type="range",r.min=Math.min(0,r.value),r.max=Math.max(1,r.value),r.step=.01),r}function Nje(s,e,t,n){const r={type:"string",title:Qk(s),prop:s,value:e,needsUpdate:!0,onChange:(o,l)=>{n.updateObject(t.uuid,`material.${s}`,l),n.updateObject(t.uuid,"material.needsUpdate",!0);const h=n.getScene(t.uuid);if(h!==null){const p=h.getObjectByProperty("uuid",t.uuid);Wa(p,`material.${s}`,l)}},onKeyDown:o=>{}};return(s==="vertexShader"||s==="fragmentShader")&&(r.type="field",r.disabled=!1,r.latest=r.value,r.onChange=(o,l)=>{r.latest=l,n.updateObject(t.uuid,`material.${s}`,l);const h=n.getScene(t.uuid);if(h!==null){const p=h.getObjectByProperty("uuid",t.uuid);Wa(p,`material.${s}`,l)}},r.onKeyDown=o=>{if(o.key==="Enter"&&(o.altKey||o.metaKey)){n.updateObject(t.uuid,"material.needsUpdate",!0);const l=n.getScene(t.uuid);if(l!==null){const h=l.getObjectByProperty("uuid",t.uuid);Wa(h,"material.needsUpdate",!0)}}}),r}function Dje(s){return s.x!==void 0&&s.y!==void 0&&s.z===void 0}function Oje(s){return s.x!==void 0&&s.y!==void 0&&s.z!==void 0&&s.w===void 0}function Fje(s){return s.x!==void 0&&s.y!==void 0&&s.z!==void 0&&s.w!==void 0}function yj(s){s.sort((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)}function aE(s,e,t,n,r="",i=!1){const o=Qk(s).split(".")[0].replaceAll("[","").replaceAll("]",""),l=r.length>0?`${r}.${s}`:s,h=typeof e;if(h==="boolean"||h==="string")return{title:o,prop:l,type:h,value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${l}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Wa(S,`material.${l}`,y)}}};if(h==="number"){const p={title:o,prop:l,type:"number",value:e,step:.01,disabled:i,onChange:(y,x)=>{n.updateObject(t.uuid,`material.${l}`,x);const S=n.getScene(t.uuid);if(S!==null){const A=S.getObjectByProperty("uuid",t.uuid);Wa(A,`material.${l}`,x)}}};return e8e(o)&&(p.type="range",p.min=0,p.max=1),p}else{if(e.isColor)return{title:o,prop:l,type:"color",value:e,disabled:i,onChange:(p,y)=>{const x=new Vn(y);n.updateObject(t.uuid,`material.${l}`,x);const S=n.getScene(t.uuid);if(S!==null){const A=S.getObjectByProperty("uuid",t.uuid);Wa(A,`material.${l}`,x)}}};if(Array.isArray(e)){const p=[];for(const y in e){const x=e[y],S=`[${y.toString()}]`;if(x.value!==void 0){const A=aE(`${S}.value`,x.value,t,n,l,i);A!==void 0&&p.push(A)}else{const A=aE(S,x,t,n,l,i);A!==void 0&&p.push(A)}}if(p.length>0)return yj(p),{title:o,items:p}}else{if(Dje(e))return{title:o,prop:l,type:"vector2",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${l}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Wa(S,`material.${l}`,y)}}};if(Oje(e))return{title:o,prop:l,type:"grid3",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${l}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Wa(S,`material.${l}`,y)}}};if(Fje(e))return{title:o,prop:l,type:"grid4",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${l}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Wa(S,`material.${l}`,y)}}};if(e.isEuler)return{title:o,prop:l,type:"euler",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${l}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Wa(S,`material.${l}`,y)}}};if(e.src!==void 0)return{title:o,type:"image",value:e,disabled:i,onChange:(p,y)=>{const x=Eje(s),S=r.length>0?`${r}.${x}`:x;n.createTexture(t.uuid,`material.${S}`,y);const A=n.getScene(t.uuid);if(A!==null){const k=A.getObjectByProperty("uuid",t.uuid);if(k!==void 0){const L=U=>{const P=k.material,$=S.split(".");switch($.length){case 1:P[$[0]]=U;break;case 2:P[$[0]][$[1]]=U;break;case 3:P[$[0]][$[1]][$[2]]=U;break;case 4:P[$[0]][$[1]][$[2]][$[3]]=U;break;case 5:P[$[0]][$[1]][$[2]][$[3]][$[4]]=U;break}P.needsUpdate=!0};y.src.length>0?lW(y.src).then(U=>{U.offset.set(y.offset[0],y.offset[1]),U.repeat.set(y.repeat[0],y.repeat[1]),L(U)}):L(null)}}}};if(e.elements!==void 0)return{title:o,prop:l,type:e.elements.length>9?"grid4":"grid3",value:e,disabled:i,onChange:(p,y)=>{n.updateObject(t.uuid,`material.${l}`,y);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);Wa(S,`material.${l}`,y)}}};{const p=[],y=s==="defines"||s==="extensions";try{for(const x in e){const S=e[x];if(S!==void 0)if(S.value!==void 0){const A=aE(`${x}.value`,S.value,t,n,l,y);A!==void 0&&p.push(A)}else{const A=aE(x,S,t,n,l,y);A!==void 0&&p.push(A)}}}catch{console.log("Hermes - Issue cycling through material object:",s,e)}if(p.length>0)return yj(p),{title:o,items:p}}}}}function $2e(s,e,t){const n=[];for(const r in s){if(!wje(r))continue;const i=typeof s[r],o=s[r];if(i==="boolean")n.push(Ije(r,o,e,t));else if(i==="number")n.push(kje(r,o,e,t));else if(i==="string")n.push(Nje(r,o,e,t));else if(i==="object"){const l=aE(r,o,e,t);l!==void 0&&n.push(l)}else o!==void 0&&console.log("Hermes - Other Material Prop Type:",r,i,o)}return yj(n),n.push({title:"Update Material",type:"button",onChange:()=>{t.updateObject(e.uuid,"material.needsUpdate",!0);const r=t.getScene(e.uuid);if(r!==null){const i=r.getObjectByProperty("uuid",e.uuid);Wa(i,"material.needsUpdate",!0)}}}),n}function Lje(s,e){function t(){return`${e.name}_material`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function i(l){localStorage.setItem(t(),l?"open":"closed")}const o=s.material;if(Array.isArray(o)){const l=[],h=o.length;for(let p=0;p<h;p++)l.push(et.jsx($h,{three:e,title:`Material ${p}`,items:$2e(o[p],s,e)},`Material ${p}`));return et.jsx(et.Fragment,{children:l})}else return et.jsx($h,{three:e,title:"Material",items:$2e(o,s,e),expanded:r,onToggle:l=>{i(l)}})}const q2e="data:image/gif;base64,R0lGODlhDgFkAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuZGJhM2RhM2I1LCAyMDIzLzEyLzE1LTEwOjQyOjM3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjUuNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyMDk3M0NEODAxQjQxMUVGODVGNENDMkUyMUExNDk1NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyMDk3M0NEOTAxQjQxMUVGODVGNENDMkUyMUExNDk1NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE4ODc3Qzg5MDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE4ODc3QzhBMDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAAAAAAAsAAAAAA4BZAAAAv+Mj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqTkJAGDQ+dnpuekmGgAKejpKuiZqmprKqoZKGyrbOlqrejub6xvLGyw8TFzcprurGuvqybxq7ETbrItsCz0l7Zpc+6p9/cS967w9/S2FTF0u/mzehK4Oqz3eTl9vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0XHDt6/AgypMiRJEuaPIkypcqVLFt+KwAAOw==";function Uje(s){const e=s.step!==void 0?s.step:.01,t=Fn.useRef(null),n=Fn.useRef(null),r=Fn.useRef(null),i=Fn.useRef(null),o=Fn.useRef(null),[l]=Fn.useState(s.value),[h,p]=Fn.useState(s.value.offset[0]),[y,x]=Fn.useState(s.value.offset[1]),[S,A]=Fn.useState(s.value.repeat[0]),[k,L]=Fn.useState(s.value.repeat[1]);function U($,Z,I,ie,ce){if(s.onChange!==void 0){const ue=s.prop!==void 0?s.prop:s.title;s.onChange(ue,{src:$,offset:[Z,I],repeat:[ie,ce]})}}function P($){const Z=t.current.src,I=$.target.value;switch($.target){case n.current:p(I),U(Z,I,y,S,k);break;case r.current:x(I),U(Z,h,I,S,k);break;case i.current:A(I),U(Z,h,y,I,k);break;case o.current:L(I),U(Z,h,y,S,I);break}}return et.jsxs("div",{className:"imageField",children:[et.jsx("img",{alt:s.title,ref:t,onClick:()=>{Tje().then($=>{t.current.src=$,U($,h,y,S,k)})},src:l.src.length>0?l.src:q2e}),et.jsxs("div",{className:"fields",children:[et.jsxs("div",{children:[et.jsx("span",{children:"Offset:"}),et.jsx("input",{ref:n,type:"number",value:h,step:e,name:v0(),onChange:P}),et.jsx("input",{ref:r,type:"number",value:y,step:e,name:v0(),onChange:P})]}),et.jsxs("div",{children:[et.jsx("span",{children:"Repeat:"}),et.jsx("input",{ref:i,type:"number",value:S,step:e,name:v0(),onChange:P}),et.jsx("input",{ref:o,type:"number",value:k,step:e,name:v0(),onChange:P})]}),et.jsx("button",{onClick:()=>{U("",h,y,S,k),t.current.src=q2e},children:"Clear"})]})]})}function jI(s){var p;let e=s.value;e!==void 0&&(e.isColor!==void 0?e=Eme(s.value):s.type==="color"&&(e=Eme(new Vn().setStyle(s.value,kc))));const[t,n]=Fn.useState(e),r=Fn.useRef(null),i=y=>{let x=y.target.value;if(s.type==="boolean")x=y.target.checked;else if(s.type==="option"&&(typeof s.value=="number"?x=Number(x):typeof s.value=="boolean"?x=!!x:typeof s.value=="object"&&(x=JSON.parse(x)),s.options!==void 0)){const S=s.options.length;for(let A=0;A<S&&s.options[A].value!==x;A++);}n(x),s.onChange!==void 0&&s.onChange(s.prop!==void 0?s.prop:s.title,x)},o={};s.disabled&&(o.opacity=.8);const l=s.type==="field"||s.type==="string"&&(t.length>100||t.search(`
`)>-1),h=l||s.type==="image"||s.type==="vector2";return et.jsxs("div",{className:`field ${h?"block":""}`,style:o,children:[s.type!=="button"&&et.jsx("span",{ref:r,children:nk(s.title)},"fieldLabel"),s.type==="string"&&!l&&et.jsx("input",{type:"text",disabled:s.disabled,onChange:i,value:t,name:v0()}),(s.type==="field"||s.type==="string"&&l)&&et.jsx("textarea",{cols:50,rows:10,disabled:s.disabled!==void 0?s.disabled:!0,onChange:i,onKeyDown:y=>{s.onKeyDown!==void 0&&s.onKeyDown(y)},value:t,name:v0()}),s.type==="boolean"&&et.jsx("input",{type:"checkbox",disabled:s.disabled,onChange:i,checked:t,name:v0()}),s.type==="number"&&et.jsx(Ev,{value:t,type:s.type,prop:s.prop!==void 0?s.prop:s.title,min:s.min,max:s.max,step:s.step,disabled:s.disabled,labelRef:r,onChange:s.onChange}),s.type==="range"&&et.jsx(Ev,{value:t,type:s.type,prop:s.prop!==void 0?s.prop:s.title,min:s.min,max:s.max,step:s.step,disabled:s.disabled,labelRef:r,onChange:s.onChange}),s.type==="color"&&et.jsxs(et.Fragment,{children:[et.jsx("input",{type:"text",value:t.toString(),onChange:i,disabled:s.disabled,className:"color",name:v0()}),et.jsx("input",{type:"color",value:t,onChange:i,disabled:s.disabled,name:v0()})]}),s.type==="button"&&et.jsx("button",{disabled:s.disabled,onClick:()=>{s.onChange!==void 0&&s.onChange(s.prop!==void 0?s.prop:s.title,!0)},children:s.title}),s.type==="image"&&et.jsx(Uje,{title:s.title,prop:s.prop,value:s.value,onChange:s.onChange}),s.type==="option"&&et.jsx(et.Fragment,{children:et.jsx("select",{onChange:i,disabled:s.disabled,defaultValue:s.value,name:v0(),children:(p=s.options)==null?void 0:p.map((y,x)=>et.jsx("option",{value:y.value,children:nk(y.title)},x))})}),s.type==="vector2"&&et.jsx(bje,{step:s.step,value:t,min:0,max:1,onChange:i}),s.type==="grid3"&&et.jsx(W2e,{step:s.step,value:t,onChange:i}),s.type==="grid4"&&et.jsx(Sje,{step:s.step,value:t,onChange:i}),s.type==="euler"&&et.jsx(W2e,{step:s.step,value:t,onChange:i})]})}function Bje(s){return"items"in s}class $h extends Fn.Component{constructor(t){super(t);Qe(this,"subgroupNames",[]);Qe(this,"subgroupElements",[]);Qe(this,"valueOverrides",new Map);Qe(this,"three");this.three=t.three,this.state={lastUpdated:Date.now()}}addGroup(t){const n=[];t.items.forEach(o=>{n.push({type:o.type,prop:o.prop,title:o.title!==void 0?o.title:o.prop,value:o.value,min:o.min,max:o.max,step:o.step,options:o.options,disabled:o.disabled,onChange:(l,h)=>{t.onUpdate(l,h)}})});const r=Fn.createRef(),i=et.jsx($h,{three:this.props.three,ref:r,title:t.title,expanded:t.expanded,items:n},Math.random());return this.subgroupNames.push(t.title),this.subgroupElements.push(i),this.setState({lastUpdated:Date.now()}),r}removeGroup(t){const n=this.subgroupNames.length;for(let r=0;r<n;r++){const i=this.subgroupNames[r];if(t===i){this.subgroupNames.splice(r,1),this.subgroupElements.splice(r,1),this.setState({lastUpdated:Date.now()});return}}}setField(t,n){this.valueOverrides.set(t,n),this.setState({lastUpdated:Date.now()})}render(){const t=[];return this.props.items.forEach(n=>{if(Bje(n))t.push(et.jsx($h,{three:this.props.three,title:nk(n.title),items:n.items},Math.random()));else{const r=this.valueOverrides.get(n.title),i=r!==void 0?r:n.value;t.push(et.jsx(jI,{title:n.title,prop:n.prop,value:i,type:n.type,min:n.min,max:n.max,step:n.step,disabled:n.disabled,options:n.options,onChange:(o,l)=>{n.onChange!==void 0&&(this.valueOverrides.delete(n.title),n.onChange(o,l))},onKeyDown:o=>{n.onKeyDown!==void 0&&n.onKeyDown(o)}},Math.random()))}}),this.subgroupElements.forEach(n=>t.push(n)),et.jsx(_E,{three:this.props.three,label:this.props.title,open:this.props.expanded===!0,onToggle:n=>{var r;this.props.onToggle&&((r=this.props)==null||r.onToggle(n))},children:t})}}const ps=class ps extends Fn.Component{constructor(t){super(t);Qe(this,"addGroup",t=>{const n=JSON.parse(t.value),r=[];n.items.forEach(i=>{r.push({type:i.type,prop:i.prop,title:i.title!==void 0?i.title:i.prop,value:i.value,min:i.min,max:i.max,step:i.step,options:i.options,disabled:i.disabled,onChange:(o,l)=>{this.props.three.updateGroup(n.title,o,l)}})}),ps.groups.push(et.jsx($h,{three:this.props.three,title:n.title,items:r},Math.random())),ps.groupTitles.push(n.title),this.setState({lastUpdate:Date.now()})});Qe(this,"removeGroup",t=>{const n=t.value,r=ps.groupTitles.length;for(let i=0;i<r;i++)if(n===ps.groupTitles[i]){ps.groups.splice(i,1),ps.groupTitles.splice(i,1),this.setState({lastUpdate:Date.now()});return}});this.state={lastUpdate:Date.now()},ps.instance=this,ps.three=t.three,t.three.addEventListener(pi.ADD_GROUP,this.addGroup),t.three.addEventListener(pi.REMOVE_GROUP,this.removeGroup)}componentWillUnmount(){this.props.three.removeEventListener(pi.ADD_GROUP,this.addGroup),this.props.three.removeEventListener(pi.REMOVE_GROUP,this.removeGroup)}render(){return et.jsx("div",{className:"customGroups",children:ps.groups},this.state.lastUpdate)}static addEditorGroup(t){const n=[];t.items.forEach(o=>{n.push({type:o.type,prop:o.prop,title:o.title!==void 0?o.title:o.prop,value:o.value,min:o.min,max:o.max,step:o.step,options:o.options,disabled:o.disabled,onChange:(l,h)=>{t.onUpdate(l,h)}})});const r=Fn.createRef(),i=et.jsx($h,{three:ps.three,ref:r,title:t.title,items:n},Math.random());return ps.groups.push(i),ps.groupsRefs.push(r),ps.groupTitles.push(t.title),r}static removeEditorGroup(t){const n=ps.groupTitles.length;for(let r=0;r<n;r++)if(t===ps.groupTitles[r]){ps.groups.splice(r,1),ps.groupTitles.splice(r,1),ps.instance.setState({lastUpdate:Date.now()});return}}static removeAllGroups(){for(let t=ps.groupTitles.length;t>0;t--)ps.groups.splice(t,1),ps.groupTitles.splice(t,1);ps.instance.setState({lastUpdate:Date.now()})}};Qe(ps,"instance"),Qe(ps,"groups",[]),Qe(ps,"groupsRefs",[]),Qe(ps,"groupTitles",[]),Qe(ps,"three");let Rv=ps;const Tk=class Tk extends Fn.Component{constructor(t){super(t);Qe(this,"matrix",new yr);Qe(this,"position",new ke);Qe(this,"rotation",new so);Qe(this,"scale",new ke);Qe(this,"open",!1);Qe(this,"updateTransform",(t,n)=>{const r=t==="rotation"?{x:n._x,y:n._y,z:n._z}:n;this.props.three.updateObject(this.props.object.uuid,t,r);const i=this.props.three.getScene(this.props.object.uuid);if(i){const o=i.getObjectByProperty("uuid",this.props.object.uuid);Wa(o,t,r)}});const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;this.open=r,this.saveExpanded(),this.state={lastUpdated:0,expanded:r},this.matrix.elements=t.object.matrix,t.object.uuid.length>0&&(this.position.setFromMatrixPosition(this.matrix),this.rotation.setFromRotationMatrix(this.matrix),this.scale.setFromMatrixScale(this.matrix)),Tk.instance=this}update(){if(oo.instance){const t=oo.instance.selectedItem;if(t===void 0)return;this.position.x=_f(t.position.x,3),this.position.y=_f(t.position.y,3),this.position.z=_f(t.position.z,3),this.rotation.copy(t.rotation),this.scale.x=_f(t.scale.x,3),this.scale.y=_f(t.scale.y,3),this.scale.z=_f(t.scale.z,3),this.setState({lastUpdated:Date.now()})}}render(){return et.jsx($h,{three:this.props.three,title:"Transform",expanded:this.open,items:[{title:"Position",prop:"position",type:"grid3",step:.1,value:this.position,onChange:this.updateTransform},{title:"Rotation",prop:"rotation",type:"euler",value:this.rotation,onChange:this.updateTransform},{title:"Scale",prop:"scale",type:"grid3",value:this.scale,onChange:this.updateTransform},{title:"Visible",prop:"visible",type:"boolean",value:this.props.object.visible,onChange:this.updateTransform}],onToggle:t=>{this.open=t,this.saveExpanded()}},this.state.lastUpdated)}saveExpanded(){localStorage.setItem(this.expandedName,this.open?"open":"closed")}get expandedName(){return`${this.props.three.name}_transform`}};Qe(Tk,"instance");let Ek=Tk;function MG(s){const[e,t]=Fn.useState(s.selected),n="toggle"+(e?" selected":"");return et.jsx("button",{className:n,onClick:()=>{const r=!e;t(r),s.onClick(r)},style:{backgroundImage:`url(${s.icon})`,backgroundPositionX:"center",backgroundPositionY:s.top!==void 0?`${s.top}px`:"center",backgroundSize:`${s.width!==void 0?`${s.width}px`:"26px"} ${s.height}px`}},s.name)}const zje=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#if defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
}`,Vje=`
#include <common>
#include <uv_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
	#include <clipping_planes_fragment>
	gl_FragColor = vec4(vec3(vUv, 0.0), 1.0);
}`;class Gje extends $o{constructor(){super({defines:{USE_UV:""},vertexShader:zje,fragmentShader:Vje})}}const iv=new kE,W0=new ke,B3=new ke,aa=new us,X2e={X:new ke(1,0,0),Y:new ke(0,1,0),Z:new ke(0,0,1)},CG={type:"change"},Y2e={type:"mouseDown",mode:null},K2e={type:"mouseUp",mode:null},Z2e={type:"objectChange"};class Hje extends m3e{constructor(e,t=null){super(void 0,t);const n=new Yje(this);this._root=n;const r=new Kje;this._gizmo=r,n.add(r);const i=new Zje;this._plane=i,n.add(i);const o=this;function l(Z,I){let ie=I;Object.defineProperty(o,Z,{get:function(){return ie!==void 0?ie:I},set:function(ce){ie!==ce&&(ie=ce,i[Z]=ce,r[Z]=ce,o.dispatchEvent({type:Z+"-changed",value:ce}),o.dispatchEvent(CG))}}),o[Z]=I,i[Z]=I,r[Z]=I}l("camera",e),l("object",void 0),l("enabled",!0),l("axis",null),l("mode","translate"),l("translationSnap",null),l("rotationSnap",null),l("scaleSnap",null),l("space","world"),l("size",1),l("dragging",!1),l("showX",!0),l("showY",!0),l("showZ",!0),l("minX",-1/0),l("maxX",1/0),l("minY",-1/0),l("maxY",1/0),l("minZ",-1/0),l("maxZ",1/0);const h=new ke,p=new ke,y=new us,x=new us,S=new ke,A=new us,k=new ke,L=new ke,U=new ke,P=0,$=new ke;l("worldPosition",h),l("worldPositionStart",p),l("worldQuaternion",y),l("worldQuaternionStart",x),l("cameraPosition",S),l("cameraQuaternion",A),l("pointStart",k),l("pointEnd",L),l("rotationAxis",U),l("rotationAngle",P),l("eye",$),this._offset=new ke,this._startNorm=new ke,this._endNorm=new ke,this._cameraScale=new ke,this._parentPosition=new ke,this._parentQuaternion=new us,this._parentQuaternionInv=new us,this._parentScale=new ke,this._worldScaleStart=new ke,this._worldQuaternionInv=new us,this._worldScale=new ke,this._positionStart=new ke,this._quaternionStart=new us,this._scaleStart=new ke,this._getPointer=jje.bind(this),this._onPointerDown=$je.bind(this),this._onPointerHover=Wje.bind(this),this._onPointerMove=qje.bind(this),this._onPointerUp=Xje.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;e!==null&&iv.setFromCamera(e,this.camera);const t=AG(this._gizmo.picker[this.mode],iv);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e!=null&&e.button!==0)&&this.axis!==null){e!==null&&iv.setFromCamera(e,this.camera);const t=AG(this._plane,iv,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,Y2e.mode=this.mode,this.dispatchEvent(Y2e)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let i=this.space;if(n==="scale"?i="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(i="world"),r===void 0||t===null||this.dragging===!1||e!==null&&e.button!==-1)return;e!==null&&iv.setFromCamera(e,this.camera);const o=AG(this._plane,iv,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),i==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),i==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(i==="local"&&(r.position.applyQuaternion(aa.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),i==="world"&&(r.parent&&r.position.add(W0.setFromMatrixPosition(r.parent.matrixWorld)),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(W0.setFromMatrixPosition(r.parent.matrixWorld)))),r.position.x=Math.max(this.minX,Math.min(this.maxX,r.position.x)),r.position.y=Math.max(this.minY,Math.min(this.maxY,r.position.y)),r.position.z=Math.max(this.minZ,Math.min(this.maxZ,r.position.z));else if(n==="scale"){if(t.search("XYZ")!==-1){let l=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(l*=-1),B3.set(l,l,l)}else W0.copy(this.pointStart),B3.copy(this.pointEnd),W0.applyQuaternion(this._worldQuaternionInv),B3.applyQuaternion(this._worldQuaternionInv),B3.divide(W0),t.search("X")===-1&&(B3.x=1),t.search("Y")===-1&&(B3.y=1),t.search("Z")===-1&&(B3.z=1);r.scale.copy(this._scaleStart).multiply(B3),this.scaleSnap&&(t.search("X")!==-1&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const l=20/this.worldPosition.distanceTo(W0.setFromMatrixPosition(this.camera.matrixWorld));let h=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(W0.copy(this.rotationAxis).cross(this.eye))*l):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(X2e[t]),W0.copy(X2e[t]),i==="local"&&W0.applyQuaternion(this.worldQuaternion),W0.cross(this.eye),W0.length()===0?h=!0:this.rotationAngle=this._offset.dot(W0.normalize())*l),(t==="E"||h)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),i==="local"&&t!=="E"&&t!=="XYZE"?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(aa.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(aa.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(CG),this.dispatchEvent(Z2e)}}pointerUp(e){e!==null&&e.button!==0||(this.dragging&&this.axis!==null&&(K2e.mode=this.mode,this.dispatchEvent(K2e)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this._root.dispose()}attach(e){return this.object=e,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(CG),this.dispatchEvent(Z2e),this.pointStart.copy(this.pointEnd))}getRaycaster(){return iv}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function jje(s){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:s.button};{const e=this.domElement.getBoundingClientRect();return{x:(s.clientX-e.left)/e.width*2-1,y:-(s.clientY-e.top)/e.height*2+1,button:s.button}}}function Wje(s){if(this.enabled)switch(s.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(s));break}}function $je(s){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(s.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(s)),this.pointerDown(this._getPointer(s)))}function qje(s){this.enabled&&this.pointerMove(this._getPointer(s))}function Xje(s){this.enabled&&(this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(s)))}function AG(s,e,t){const n=e.intersectObject(s,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const bI=new so,Ms=new ke(0,1,0),Q2e=new ke(0,0,0),J2e=new yr,SI=new us,WI=new us,Jp=new ke,e9e=new yr,oE=new ke(1,0,0),hv=new ke(0,1,0),lE=new ke(0,0,1),wI=new ke,Ww=new ke,$w=new ke;class Yje extends Ri{constructor(e){super(),this.isTransformControlsRoot=!0,this.controls=e,this.visible=!1}updateMatrixWorld(e){const t=this.controls;t.object!==void 0&&(t.object.updateMatrixWorld(),t.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):t.object.parent.matrixWorld.decompose(t._parentPosition,t._parentQuaternion,t._parentScale),t.object.matrixWorld.decompose(t.worldPosition,t.worldQuaternion,t._worldScale),t._parentQuaternionInv.copy(t._parentQuaternion).invert(),t._worldQuaternionInv.copy(t.worldQuaternion).invert()),t.camera.updateMatrixWorld(),t.camera.matrixWorld.decompose(t.cameraPosition,t.cameraQuaternion,t._cameraScale),t.camera.isOrthographicCamera?t.camera.getWorldDirection(t.eye).negate():t.eye.copy(t.cameraPosition).sub(t.worldPosition).normalize(),super.updateMatrixWorld(e)}dispose(){this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}}class Kje extends Ri{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Nc({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Mf({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const i=e.clone();i.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const l=e.clone();l.color.setHex(255);const h=e.clone();h.color.setHex(16711680),h.opacity=.5;const p=e.clone();p.color.setHex(65280),p.opacity=.5;const y=e.clone();y.color.setHex(255),y.opacity=.5;const x=e.clone();x.opacity=.25;const S=e.clone();S.color.setHex(16776960),S.opacity=.25,e.clone().color.setHex(16776960);const k=e.clone();k.color.setHex(7895160);const L=new Mu(0,.04,.1,12);L.translate(0,.05,0);const U=new xo(.08,.08,.08);U.translate(0,.04,0);const P=new ts;P.setAttribute("position",new Nr([0,0,0,1,0,0],3));const $=new Mu(.0075,.0075,.5,3);$.translate(0,.25,0);function Z(ot,Se){const gt=new dv(ot,.0075,3,64,Se*Math.PI*2);return gt.rotateY(Math.PI/2),gt.rotateX(Math.PI/2),gt}function I(){const ot=new ts;return ot.setAttribute("position",new Nr([0,0,0,1,1,1],3)),ot}const ie={X:[[new Mn(L,i),[.5,0,0],[0,0,-Math.PI/2]],[new Mn(L,i),[-.5,0,0],[0,0,Math.PI/2]],[new Mn($,i),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Mn(L,o),[0,.5,0]],[new Mn(L,o),[0,-.5,0],[Math.PI,0,0]],[new Mn($,o)]],Z:[[new Mn(L,l),[0,0,.5],[Math.PI/2,0,0]],[new Mn(L,l),[0,0,-.5],[-Math.PI/2,0,0]],[new Mn($,l),null,[Math.PI/2,0,0]]],XYZ:[[new Mn(new xv(.1,0),x.clone()),[0,0,0]]],XY:[[new Mn(new xo(.15,.15,.01),y.clone()),[.15,.15,0]]],YZ:[[new Mn(new xo(.15,.15,.01),h.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new xo(.15,.15,.01),p.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},ce={X:[[new Mn(new Mu(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Mn(new Mu(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Mn(new Mu(.2,0,.6,4),n),[0,.3,0]],[new Mn(new Mu(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Mn(new Mu(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Mn(new Mu(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Mn(new xv(.2,0),n)]],XY:[[new Mn(new xo(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Mn(new xo(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new xo(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},ue={START:[[new Mn(new xv(.01,2),r),null,null,null,"helper"]],END:[[new Mn(new xv(.01,2),r),null,null,null,"helper"]],DELTA:[[new Pu(I(),r),null,null,null,"helper"]],X:[[new Pu(P,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Pu(P,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Pu(P,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Q={XYZE:[[new Mn(Z(.5,1),k),null,[0,Math.PI/2,0]]],X:[[new Mn(Z(.5,.5),i)]],Y:[[new Mn(Z(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new Mn(Z(.5,.5),l),null,[0,Math.PI/2,0]]],E:[[new Mn(Z(.75,1),S),null,[0,Math.PI/2,0]]]},oe={AXIS:[[new Pu(P,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},le={XYZE:[[new Mn(new Av(.25,10,8),n)]],X:[[new Mn(new dv(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Mn(new dv(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Mn(new dv(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Mn(new dv(.75,.1,2,24),n)]]},J={X:[[new Mn(U,i),[.5,0,0],[0,0,-Math.PI/2]],[new Mn($,i),[0,0,0],[0,0,-Math.PI/2]],[new Mn(U,i),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Mn(U,o),[0,.5,0]],[new Mn($,o)],[new Mn(U,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Mn(U,l),[0,0,.5],[Math.PI/2,0,0]],[new Mn($,l),[0,0,0],[Math.PI/2,0,0]],[new Mn(U,l),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Mn(new xo(.15,.15,.01),y),[.15,.15,0]]],YZ:[[new Mn(new xo(.15,.15,.01),h),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new xo(.15,.15,.01),p),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Mn(new xo(.1,.1,.1),x.clone())]]},Be={X:[[new Mn(new Mu(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Mn(new Mu(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Mn(new Mu(.2,0,.6,4),n),[0,.3,0]],[new Mn(new Mu(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Mn(new Mu(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Mn(new Mu(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Mn(new xo(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Mn(new xo(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new xo(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Mn(new xo(.2,.2,.2),n),[0,0,0]]]},He={X:[[new Pu(P,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Pu(P,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Pu(P,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function rt(ot){const Se=new Ri;for(const gt in ot)for(let Ae=ot[gt].length;Ae--;){const lt=ot[gt][Ae][0].clone(),pt=ot[gt][Ae][1],De=ot[gt][Ae][2],_t=ot[gt][Ae][3],Jt=ot[gt][Ae][4];lt.name=gt,lt.tag=Jt,pt&&lt.position.set(pt[0],pt[1],pt[2]),De&&lt.rotation.set(De[0],De[1],De[2]),_t&&lt.scale.set(_t[0],_t[1],_t[2]),lt.updateMatrix();const dt=lt.geometry.clone();dt.applyMatrix4(lt.matrix),lt.geometry=dt,lt.renderOrder=1/0,lt.position.set(0,0,0),lt.rotation.set(0,0,0),lt.scale.set(1,1,1),Se.add(lt)}return Se}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=rt(ie)),this.add(this.gizmo.rotate=rt(Q)),this.add(this.gizmo.scale=rt(J)),this.add(this.picker.translate=rt(ce)),this.add(this.picker.rotate=rt(le)),this.add(this.picker.scale=rt(Be)),this.add(this.helper.translate=rt(ue)),this.add(this.helper.rotate=rt(oe)),this.add(this.helper.scale=rt(He)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:WI;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let i=0;i<r.length;i++){const o=r[i];o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition);let l;if(this.camera.isOrthographicCamera?l=(this.camera.top-this.camera.bottom)/this.camera.zoom:l=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(l*this.size/4),o.tag==="helper"){o.visible=!1,o.name==="AXIS"?(o.visible=!!this.axis,this.axis==="X"&&(aa.setFromEuler(bI.set(0,0,0)),o.quaternion.copy(n).multiply(aa),Math.abs(Ms.copy(oE).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="Y"&&(aa.setFromEuler(bI.set(0,0,Math.PI/2)),o.quaternion.copy(n).multiply(aa),Math.abs(Ms.copy(hv).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="Z"&&(aa.setFromEuler(bI.set(0,Math.PI/2,0)),o.quaternion.copy(n).multiply(aa),Math.abs(Ms.copy(lE).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="XYZE"&&(aa.setFromEuler(bI.set(0,Math.PI/2,0)),Ms.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(J2e.lookAt(Q2e,Ms,hv)),o.quaternion.multiply(aa),o.visible=this.dragging),this.axis==="E"&&(o.visible=!1)):o.name==="START"?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):o.name==="END"?(o.position.copy(this.worldPosition),o.visible=this.dragging):o.name==="DELTA"?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),W0.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),W0.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(W0),o.visible=this.dragging):(o.quaternion.copy(n),this.dragging?o.position.copy(this.worldPositionStart):o.position.copy(this.worldPosition),this.axis&&(o.visible=this.axis.search(o.name)!==-1));continue}o.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(o.name==="X"&&Math.abs(Ms.copy(oE).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="Y"&&Math.abs(Ms.copy(hv).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="Z"&&Math.abs(Ms.copy(lE).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="XY"&&Math.abs(Ms.copy(lE).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="YZ"&&Math.abs(Ms.copy(oE).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="XZ"&&Math.abs(Ms.copy(hv).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):this.mode==="rotate"&&(SI.copy(n),Ms.copy(this.eye).applyQuaternion(aa.copy(n).invert()),o.name.search("E")!==-1&&o.quaternion.setFromRotationMatrix(J2e.lookAt(this.eye,Q2e,hv)),o.name==="X"&&(aa.setFromAxisAngle(oE,Math.atan2(-Ms.y,Ms.z)),aa.multiplyQuaternions(SI,aa),o.quaternion.copy(aa)),o.name==="Y"&&(aa.setFromAxisAngle(hv,Math.atan2(Ms.x,Ms.z)),aa.multiplyQuaternions(SI,aa),o.quaternion.copy(aa)),o.name==="Z"&&(aa.setFromAxisAngle(lE,Math.atan2(Ms.y,Ms.x)),aa.multiplyQuaternions(SI,aa),o.quaternion.copy(aa))),o.visible=o.visible&&(o.name.indexOf("X")===-1||this.showX),o.visible=o.visible&&(o.name.indexOf("Y")===-1||this.showY),o.visible=o.visible&&(o.name.indexOf("Z")===-1||this.showZ),o.visible=o.visible&&(o.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(h){return o.name===h}))&&(o.material.color.setHex(16776960),o.material.opacity=1)}super.updateMatrixWorld(e)}}class Zje extends Mn{constructor(){super(new Cv(1e5,1e5,2,2),new Nc({visible:!1,wireframe:!0,side:X0,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),wI.copy(oE).applyQuaternion(t==="local"?this.worldQuaternion:WI),Ww.copy(hv).applyQuaternion(t==="local"?this.worldQuaternion:WI),$w.copy(lE).applyQuaternion(t==="local"?this.worldQuaternion:WI),Ms.copy(Ww),this.mode){case"translate":case"scale":switch(this.axis){case"X":Ms.copy(this.eye).cross(wI),Jp.copy(wI).cross(Ms);break;case"Y":Ms.copy(this.eye).cross(Ww),Jp.copy(Ww).cross(Ms);break;case"Z":Ms.copy(this.eye).cross($w),Jp.copy($w).cross(Ms);break;case"XY":Jp.copy($w);break;case"YZ":Jp.copy(wI);break;case"XZ":Ms.copy($w),Jp.copy(Ww);break;case"XYZ":case"E":Jp.set(0,0,0);break}break;case"rotate":default:Jp.set(0,0,0)}Jp.length()===0?this.quaternion.copy(this.cameraQuaternion):(e9e.lookAt(W0.set(0,0,0),Jp,Ms),this.quaternion.setFromRotationMatrix(e9e)),super.updateMatrixWorld(e)}}const vf=class vf extends Oc{constructor(){super(...arguments);Qe(this,"three");Qe(this,"activeCamera");Qe(this,"controls",new Map);Qe(this,"visibility",new Map);Qe(this,"setScene",()=>{this.clear()})}setApp(t){this.three=t,this.three.addEventListener(pi.SET_SCENE,this.setScene)}clear(){for(const t of this.controls.values()){t.detach(),t.disconnect();const n=t.getHelper();Hh(n)}this.controls=new Map,this.visibility=new Map}add(t){let n=this.controls.get(t);if(n===void 0){const r=document.querySelector(".clickable");n=new Hje(this.activeCamera,r),n.getHelper().name=t,n.setSize(.5),n.setSpace("local"),this.controls.set(t,n),this.visibility.set(t,!0),n.addEventListener("mouseDown",()=>{this.dispatchEvent({type:vf.DRAG_START})}),n.addEventListener("mouseUp",()=>{this.dispatchEvent({type:vf.DRAG_END})}),n.addEventListener("dragging-changed",i=>{var o;(o=oo.instance)==null||o.toggleOrbitControls(i.value)})}return n}get(t){return this.controls.get(t)}remove(t){const n=this.get(t);return n===void 0?!1:(n.detach(),n.disconnect(),Hh(n.getHelper()),this.controls.delete(t),!0)}enabled(t){this.controls.forEach(n=>{n.enabled=t})}updateCamera(t,n){this.activeCamera=t,this.controls.forEach(r=>{r.camera!==t&&(r.camera=t,t.getWorldPosition(r.cameraPosition),t.getWorldQuaternion(r.cameraQuaternion)),r.domElement!==n&&(r.disconnect(),r.domElement=n,r.connect(n))})}show(){this.controls.forEach(t=>{const n=t.getHelper(),r=this.visibility.get(n.name);r!==void 0&&(n.visible=r)})}hide(){this.controls.forEach(t=>{const n=t.getHelper();this.visibility.set(n.name,n.visible),n.visible=!1})}static get instance(){return vf._instance||(vf._instance=new vf),vf._instance}};Qe(vf,"DRAG_START","Transform::dragStart"),Qe(vf,"DRAG_END","Transform::dragEnd"),Qe(vf,"_instance");let Dh=vf;const Qje=new xo,PG=new zn;class RG extends Ri{constructor(t,n){const r=new Vn(Q3(.5,1,Math.random()),Q3(.5,1,Math.random()),Q3(.5,1,Math.random()));super();Qe(this,"curve",new I1e);Qe(this,"line");Qe(this,"draggable");Qe(this,"curvePos");Qe(this,"tension",.5);Qe(this,"closed",!1);Qe(this,"subdivide",50);Qe(this,"curveType");Qe(this,"offset",1);Qe(this,"lineMaterial");Qe(this,"_camera");Qe(this,"_curvePercentage",0);Qe(this,"_draggableScale",10);Qe(this,"_transform");Qe(this,"raycaster");Qe(this,"draggedMat",new Nc);Qe(this,"parentGroup");Qe(this,"group");Qe(this,"dispose",()=>{this._transform&&(this._transform.removeEventListener("objectChange",this.updateSpline),Dh.instance.remove(this.name)),this.disable(),this.parentGroup.removeGroup(this.name)});Qe(this,"hideTransform",()=>{var t;(t=this._transform)==null||t.detach()});Qe(this,"exportSpline",()=>{const t=[];this.draggable.children.forEach(n=>{t.push([_f(n.position.x,3),_f(n.position.y,3),_f(n.position.z,3)])}),Dke({name:this.name,points:t,tension:this.tension,closed:this.closed,subdivide:this.subdivide,type:this.curveType}),console.log("Spline copied!")});Qe(this,"showPoints",(t=!0)=>{this.draggable.visible=t});Qe(this,"addPoints",(t=[])=>{if(t.length>0){const n=t.length-1;for(let r=0;r<n;r++)this.addPoint(t[r],!1);this.addPoint(t[n])}});Qe(this,"addPoint",(t,n=!0)=>{var l;const r=this.draggable.children.length,i=new Mn(Qje,this.draggedMat);i.name=`point_${r}`,i.position.copy(t),i.scale.setScalar(this._draggableScale),this.draggable.add(i),(l=this._transform)==null||l.attach(i);const o=this.points.length>1;return o&&n&&this.updateSpline(),this.line.visible=o,this.updateCurrentPoint(),i});Qe(this,"addNextPt",()=>{var i;const t=this.draggable.children.length,n=t>1?this.draggable.children[t-1].position.clone():new ke,r=this.addPoint(n);(i=this.group.current)==null||i.setField("Current Point",r.position)});Qe(this,"removePoint",t=>{var n,r,i,o;if(((n=this._transform)==null?void 0:n.object)===t){(r=this._transform)==null||r.detach();const l=this.draggable.children[this.draggable.children.length-1];(i=this._transform)==null||i.attach(l),(o=this.group.current)==null||o.setField("Current Point",l.position)}Hh(t),this.updateSpline()});Qe(this,"removePointAt",t=>{const n=this.draggable.children[t];this.removePoint(n)});Qe(this,"removeSelectedPt",()=>{var t,n;((t=this._transform)==null?void 0:t.object)!==void 0&&this.removePoint((n=this._transform)==null?void 0:n.object)});Qe(this,"updateSpline",()=>{this.points.length<2||(this.curve=new I1e(this.points,this.closed,this.curveType,this.tension),this.line.geometry.dispose(),this.line.geometry=new ts().setFromPoints(this.curve.getPoints(this.subdivide)),this.curvePos.position.copy(this.getPointAt(this._curvePercentage)))});Qe(this,"onMouseClick",t=>{var o,l,h;if(!oo.instance||!oo.instance.currentWindow||this._transform&&!this._transform.getHelper().visible)return;const r=oo.instance.currentWindow.current.getBoundingClientRect();PG.x=(t.clientX-r.x)/r.width*2-1,PG.y=-((t.clientY-r.y)/r.height)*2+1,this.raycaster.setFromCamera(PG,this.camera);const i=this.raycaster.intersectObjects(this.draggable.children,!1);if(i.length>0){const p=i[0].object;p!==((o=this._transform)==null?void 0:o.object)&&((l=this._transform)==null||l.attach(p),(h=this.group.current)==null||h.setField("Current Point",p.position))}});Qe(this,"onUpdateTransform",()=>{this.updateCurrentPoint(),this.updateSpline()});Qe(this,"debugPoint",t=>{t.name,t.visible=this.draggable.visible});this.name=t,this.lineMaterial=new Mf({color:r}),this.line=new Pu(new ts,this.lineMaterial),this.line.name="line",this.line.visible=!1,this.add(this.line),this._camera=n,this.curveType="catmullrom",this.draggedMat.color=r,this.draggable=new Ri,this.draggable.name="draggablePoints",this.add(this.draggable),this.curvePos=new Mn(new Av(1.5),new Nc({color:r})),this.curvePos.name="curvePos",this.curvePos.scale.setScalar(this._draggableScale),this.curvePos.visible=!1,this.add(this.curvePos),this.raycaster=new kE,this.raycaster.params.Line.threshold=3,this.enable()}enable(){document.addEventListener("pointerdown",this.onMouseClick)}disable(){document.removeEventListener("pointerdown",this.onMouseClick)}updateLastPoint(t){const n=this.draggable.children.length;n>0&&(this.draggable.children[n-1].position.copy(t),this.updateSpline())}getPointAt(t){return this.curve.points.length>1?this.curve.getPointAt(t):this.curve.points.length===1?this.curve.points[0]:new ke}getTangentAt(t){return this.curve.getTangentAt(t)}get points(){const t=[];return this.draggable.children.forEach(n=>{t.push(n.position)}),t}get total(){return this.draggable.children.length}get draggableScale(){return this._draggableScale}set draggableScale(t){this._draggableScale=t,this.draggable.children.forEach(n=>n.scale.setScalar(t)),this.curvePos.scale.setScalar(t)}get camera(){return this._camera}set camera(t){this._camera=t,this._transform!==void 0&&(this._transform.camera=t)}get curvePercentage(){return this._curvePercentage}set curvePercentage(t){this._curvePercentage=t,this.curvePos.position.copy(this.getPointAt(t))}updateCurrentPoint(){var t,n,r;if((t=this._transform)!=null&&t.object&&this.group){const i=(n=this._transform)==null?void 0:n.object;i.name.search("point")>-1&&((r=this.group.current)==null||r.setField("Current Point",i.position))}}initDebug(t){var i;const n=this.draggable.children;this.parentGroup=t,this._transform=Dh.instance.add(this.name),this._transform.camera=this._camera,this._transform.addEventListener("objectChange",this.onUpdateTransform),n.length>0&&this._transform.attach(n[n.length-1]),(i=oo.instance)==null||i.helpersContainer.add(this._transform.getHelper());const r=n.length>0?n[n.length-1].position:{x:0,y:0,z:0};this.group=t.addGroup({title:this.name,expanded:!0,items:[{prop:"Closed",type:"boolean",value:this.closed},{prop:"Visible",type:"boolean",value:this.visible},{prop:"Show Position",type:"boolean",value:this.curvePos.visible},{prop:"Show Points",type:"boolean",value:this.draggable.visible},{prop:"Color",type:"color",value:`#${this.draggedMat.color.getHexString()}`},{prop:"Curve",type:"option",options:[{title:"Catmullrom",value:"catmullrom"},{title:"Centripetal",value:"centripetal"},{title:"Chordal",value:"chordal"}]},{prop:"Draggable Scale",type:"range",min:.01,max:100,step:.01,value:this._draggableScale},{prop:"Subdivide",type:"range",min:1,max:1e3,step:1,value:this.subdivide},{prop:"Tension",type:"range",min:0,max:1,step:.01,value:this.tension},{prop:"New Pt Offset",type:"range",min:0,max:10,value:this.offset},{prop:"Curve At",type:"range",min:0,max:1,step:.01,value:0},{prop:"Toggle Transform",type:"button"},{prop:"Add Point",type:"button"},{prop:"Remove Point",type:"button"},{prop:"Export",type:"button"},{prop:"Delete",type:"button"},{prop:"Current Point",type:"grid3",value:r}],onUpdate:(o,l)=>{var h,p;switch(o){case"Closed":this.closed=l,this.updateSpline();break;case"Visible":this.visible=l;break;case"Color":this.lineMaterial.color.setStyle(l),this.draggedMat.color.setStyle(l);break;case"Curve":this.curveType=l,this.updateSpline();break;case"Draggable Scale":this.draggableScale=l;break;case"Subdivide":this.subdivide=l,this.updateSpline();break;case"Tension":this.tension=l,this.updateSpline();break;case"New Pt Offset":this.offset=l;break;case"Curve At":this.curvePos.position.copy(this.getPointAt(l));break;case"Show Position":this.curvePos.visible=l;break;case"Show Points":this.draggable.visible=l;break;case"Toggle Transform":this._transform&&(this._transform.getHelper().visible=!this._transform.getHelper().visible);break;case"Add Point":this.addNextPt();break;case"Remove Point":this.removeSelectedPt();break;case"Export":this.exportSpline();break;case"Delete":this.parent.currentSpline=null,Hh(this);break;case"Current Point":if(this.group.current&&((h=this._transform)!=null&&h.object)){const y=(p=this._transform)==null?void 0:p.object;y.name.search("point")>-1&&(y.position.copy(l),this.updateSpline())}break}}}),this.draggable.children.forEach(o=>{this.debugPoint(o)})}}let EI=0;class Jje extends Ri{constructor(t,n){super();Qe(this,"defaultScale",10);Qe(this,"currentSpline",null);Qe(this,"_camera");Qe(this,"group",null);Qe(this,"three");Qe(this,"splineDataText","");Qe(this,"createSpline",(t=[])=>{const n=`Spline ${EI+1}`,r=new RG(n,this._camera);return r.addPoints(t),this.addSpline(r),EI++,r});Qe(this,"createSplineFromArray",t=>{const n=[];return t.forEach(r=>{n.push(new ke(r[0],r[1],r[2]))}),this.createSpline(n)});Qe(this,"createSplineFromCatmullRom",t=>this.createSpline(t.points));Qe(this,"createSplineFromJSON",t=>{const n=[];t.points.forEach(i=>{n.push(new ke(i[0],i[1],i[2]))});const r=new RG(t.name,this._camera);return r.closed=t.closed,r.subdivide=t.subdivide,r.tension=t.tension,r.type=t.type,r.addPoints(n),r.updateSpline(),this.addSpline(r),r});Qe(this,"showPoints",(t=!0)=>{this.children.forEach(n=>{n.showPoints(t)})});Qe(this,"onAddSpline",t=>{const n=JSON.parse(t.value),r=`Spline ${EI+1}`,i=[];n.points.forEach(l=>{i.push(new ke(l[0],l[1],l[2]))});const o=new RG(r,this.camera);o.addPoints(i),this.addSpline(o),EI++});Qe(this,"isMouseDown",!1);Qe(this,"onClickCanvas",t=>{var h;if(t.button!==0)return;if(this._camera.type!=="OrthographicCamera"){console.warn("Spline Editor - 3D Camera not supported in Draw Mode");return}const r=t.target.getBoundingClientRect(),i=(t.clientX-r.left)/r.width*2-1,o=-((t.clientY-r.top)/r.height)*2+1;if(oo.instance){const p=new kE;p.setFromCamera(new zn(i,o),this._camera);const y=p.intersectObjects(oo.instance.helpersContainer.children,!0);for(let x=0;x<y.length;x++){const S=y[x];if(!(S.object.isLine||S.object.isTransformControlsPlane)&&S.object.isObject3D)return}}this.currentSpline===null&&(this.currentSpline=this.createSpline());const l=this.mouseToSplinePos(i,o,r.width,r.height);(h=this.currentSpline)==null||h.addPoint(l),this.isMouseDown=!0});Qe(this,"onMouseMove",t=>{var h;if(!this.isMouseDown)return;const r=t.target.getBoundingClientRect(),i=(t.clientX-r.left)/r.width*2-1,o=-((t.clientY-r.top)/r.height)*2+1,l=this.mouseToSplinePos(i,o,r.width,r.height);(h=this.currentSpline)==null||h.updateLastPoint(l)});Qe(this,"onMouseUp",()=>{this.isMouseDown=!1});this.name="Spline Editor",this._camera=t,this.three=n,this.three.addEventListener(pi.ADD_SPLINE,this.onAddSpline)}initDebug(){this.group=Rv.addEditorGroup({title:this.name,items:[{type:"field",prop:"Spline Data",value:"",disabled:!1},{type:"button",prop:"Import Spline"},{type:"button",prop:"New Spline"},{type:"boolean",prop:"Show Points",value:!0},{type:"boolean",prop:"Draw Mode",value:!1},{type:"boolean",prop:"Visible",value:this.visible},{type:"range",prop:"Default Scale",min:0,max:50,step:.01,value:this.defaultScale}],onUpdate:(t,n)=>{switch(t){case"New Spline":this.createSpline();break;case"Spline Data":this.splineDataText=n;break;case"Import Spline":this.createSplineFromJSON(JSON.parse(this.splineDataText));break;case"Show Points":this.showPoints(n);break;case"Visible":this.visible=n;break;case"Default Scale":this.defaultScale=n;break;case"Draw Mode":n?this.enableClickToDraw():this.disableClickToDraw();break}}})}dispose(){this.three.removeEventListener(pi.ADD_SPLINE,this.onAddSpline),Rv.removeEditorGroup(this.name)}addSpline(t){var n;t.draggableScale=this.defaultScale,t.hideTransform(),((n=this.group)==null?void 0:n.current)!==null&&t.initDebug(this.group.current),this.add(t),this.currentSpline=t}enableClickToDraw(){document.querySelectorAll(".clickable").forEach(t=>{t.addEventListener("mousedown",this.onClickCanvas),t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mouseup",this.onMouseUp)})}disableClickToDraw(){document.querySelectorAll(".clickable").forEach(t=>{t.removeEventListener("mousedown",this.onClickCanvas),t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mouseup",this.onMouseUp)})}mouseToSplinePos(t,n,r,i){const o=new ke,l=Math.PI/2,h=this._camera,p=h.zoom,y=h.rotation.x===-6123233995736766e-32&&h.rotation.y===0&&h.rotation.z===0,x=h.rotation.x===-Math.PI&&h.rotation.y===12246467991473532e-32&&h.rotation.z===Math.PI,S=h.rotation.x===-6162975822039155e-48&&h.rotation.y===-l&&h.rotation.z===0,A=h.rotation.x===-6162975822039155e-48&&h.rotation.y===l&&h.rotation.z===0,k=h.rotation.x===-1.5707953264174506&&h.rotation.y===0&&h.rotation.z===0,L=h.rotation.x===1.5707953264174506&&h.rotation.y===0&&h.rotation.z===0;let U=t,P=n;x||A?U*=-1:k&&(P*=-1);const $=r/2/p,Z=i/2/p;if(this.currentSpline===null&&(this.currentSpline=this.createSpline()),y||x){const I=U*$+h.position.x,ie=P*Z+h.position.y;o.set(I,ie,0)}else if(S||A){const I=U*$+h.position.z,ie=P*Z+h.position.y;o.set(0,ie,I)}else if(k||L){const I=U*$+h.position.x,ie=P*Z+h.position.z;o.set(I,0,ie)}return o}get camera(){return this._camera}set camera(t){this._camera=t,this.children.forEach(n=>{const r=n;r.camera=t})}}const t9e=["Single","Side by Side","Stacked","Quad"],eWe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC60lEQVRYhe2YT4hNcRTHP48xpmYaNAvRyEQxEhnKQljYsRm9/EmSyJiMFAsMZWNhJYoNIUVJ2VGiyb9ZzIpMpkQSahbGv9GMYWrM+1rc2zjvzvvdd+99rzdvMd+6de75nd+5387vnN/v/G5KEuWMKRNNIB8mCRaKiiL5qQb2ApuBuUAV0Ad0AJeB3sSeJRX6LJbULTf6JTUn9Z+KWMUpPyp/Avoa4CNQZ3Sj/lNpdL/xottR7AjOkHRUUpekN5I6JbVLavDH75lIfZN0UFKTpCWS0pJem/HeJBEMG6yV1ONYtgFJbZJ+GF1jDh+zJb03NuliEuwMkMo4yErS2RA/LcbuYVyCrm1mA7Dal/8Cu4FG4JD/HsTTkCy6a+SVMTPQuc1sBKb78nHghi+/A+YBxwL2lbhRY+ThuARdEVxu5JdGFvACr0otdoZ8Y4+Rn0Sn5sFFsMvI6YB9MzA1YJ8mN8k1wAHzfj4uQVdyrpI0aJL7oqTtkq4FiqPLyCOSbktqlbRL0jlJQ2b8QdwCUZ4qvhRStZL0XFK1pMd57CRvq5mfhKBriRfiFUMY6oD7eOdwPlQAN4G10dfWg+uouwXsiOssAj4AC+JMcEWwvnAuOTEr7gTXPmg34zagOwkbIIOXAo9CbDYBrcBXYN+4UUdy2sRflyS5zVNlfPX7ugpJW5V9nI7mmh+lYU0lCZ2B3TOnAVuAk0BTwC5nuhWro46KauBOQJch5OpRaoIW34GreGf+YZdRqS9NAj4Bp4ClQDvwOWxCqSM4ADQEdKE5XvbXzlITrAVe4TW+M6NMKDXBFLAMuAD0ACfIc7pMZBXXA2cY3/xmodQRHAL2A2+NLtj8ZiEKwUL/z2WMPAJcAVYALWSf8dZuDFGWeBHwKxm3sWYhiGG8Tfo6sA2vSfiSy4GrH3wGrDcfKSSKKf6v1E9yF0XK9Q1XBPuMXMw8HXTonQFwETwNzMFr64v1jzgFHIk9ybHEZYPJo65QlD3Bf2/Q/eaHPiSWAAAAAElFTkSuQmCC",tWe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAETklEQVRYhe2YXYhVVRTHf3d0/JhyUrMpFbImM+whSa3Mynww+4AeIgiKoozooQ+KyMyXIAujF6OXqHyI6iEKKYgIP/owsjSFqCkprdDUTEcjbWZ0HHV+Pex1ucfb9Z57Z9REXHA4Z++99l7/s/ZZ/7X2KaiczNLwfwPIk9MA+yunNMAG4DHgV+BvoB3YFff2TPstYEyfrajVroI6Sr1GvahsbJC63HzZq04pmztSvU5tVRuqYRiYg78JeBR4HPg5ntdmxovz9wJfA3uAxuibDLQCA+IqynnAQuBuYCnwMLC1rx48U12U8cZqdWqMDcx4cI16qTpYbVKHqa+ovWUeHKsujn7VL9ULq2HI+wY7gVeBJdGeFu3J4ZUiy/cAXeHRRuAQsC/GC0B3eG4BcH/0tUV7czUAeVsMsBF4Kha9HZgCvAncAuwPnXHA0wFuGLANuDrGuoGDwFxgTqzzQ7RX5FrP2eLsdb76vnogtme6+nE8H1YPlQXHwbi3q9eqn0e7Tb25VrsF68vFY0lb1AGcDTwItGQ8tQM4AIwGmqP/EPAu8A0wElgJfFGzxTo8mKWXu9Rd4ZF96jvqjSbauEC9Sn1O3R463epLaku99voCsFXdkAH3kNpcQW+IiT/bQne3eufxBtioPqP2mKhioXpWzpxb1T8C5Ifh4ZptVoriRmAIKdrI3Lujf3bobAPeJpF0NVkKrAFuI9HTOBIxnxFrF4OgQKKr/dnJlQA+AcwABgOHA4zAamA5cE7orQL+zAEHiWI+A2bFC7aSguheYCgpqAphZz3wSB7AecCICv2TgH8oFRib4gVqka0k0h8CXAxMBW6ooDejFoCvA9OBQUAvKWM0kDz4XUZvNKXtyZMWUl7vBbaQXq457PeEziDgx/KJlQAuIPFdMcEXv5OdYWBP9M8k8VpnDQCvB4aTSrCNJB5cSdrW3tBpIJVnR0qdUTxAfdGUOVTnmwqEanNmqltC/9OgqePKg5eom8PgdvW+oJ9Kupera0O3U50TL3lcAaI+oHaF4R3qa6Z822wq0Saq89T1lmSxOrxeW/Xm4uGkiqQDmECKuKHxHW0HdpMiewSpvGqKeR8Ay0iBsYIjg6261PE2o9Q3Yqv+MqWxO9R1Hl12qs+q49Vlppy82pSr+5xJKsko4AXgHlJ0t5NIeg3wLXAlqZhtIUV8J6nmWwX8QiLjdhL5TwMWkY4R6/rrwYKlMr1Y321QZ/vfwBijPqm+rF4Wc7PjE9QllurGVeoV5gRNHsAm9fnMom3qrKPoTjKdMXaYyrFygEWQ72XWW24qhPu8xcUc2UU6O8wFPjmK7jhgPHAuMJGUGQ6U6WwE5sfzTXGvei7KA9hFOiR9D/wOfFVFt4dS2tpfRe83Ur7/CPiJakfOGgBCypubatArl2r8VfOax/LfzABKtePAzHO/5FgC7KBEzB2kOrDfUm8mOeFySv9+OyFyGmB/5aQH+C9BVKmVCNuMZgAAAABJRU5ErkJggg==",nWe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQ0lEQVQ4jWP8////fwYqAxYozUhFM/8zkaKYWIWkGEq0b0ZdSjQY5i79TyWagRGaTUdzFEEw6lLqGzqwLoVVJ1StpwA9sBwbUqAh5gAAAABJRU5ErkJggg==",Mk=class Mk extends Fn.Component{constructor(t){super(t);Qe(this,"scene");Qe(this,"renderer");Qe(this,"currentScene");Qe(this,"scenes",new Map);Qe(this,"cameras",new Map);Qe(this,"controls",new Map);Qe(this,"currentCamera");Qe(this,"currentWindow");Qe(this,"helpersContainer",new _v);Qe(this,"cameraHelpers",new Map);Qe(this,"lightHelpers",new Map);Qe(this,"grid",new xje);Qe(this,"interactionHelper",new GCe(25));Qe(this,"currentTransform");Qe(this,"splineEditor");Qe(this,"depthMaterial",new s3e);Qe(this,"normalsMaterial",new i3e);Qe(this,"uvMaterial",new Gje);Qe(this,"wireframeMaterial",new Nc({opacity:.33,transparent:!0,wireframe:!0}));Qe(this,"playing",!1);Qe(this,"rafID",-1);Qe(this,"cameraControlsRafID",-1);Qe(this,"width",0);Qe(this,"height",0);Qe(this,"tlCam",null);Qe(this,"trCam",null);Qe(this,"blCam",null);Qe(this,"brCam",null);Qe(this,"tlRender","Renderer");Qe(this,"trRender","Renderer");Qe(this,"blRender","Renderer");Qe(this,"brRender","Renderer");Qe(this,"cameraVisibility",!0);Qe(this,"lightVisibility",!0);Qe(this,"gridVisibility",!0);Qe(this,"selectedItem");Qe(this,"debugCamera");Qe(this,"raycaster",new kE);Qe(this,"pointer",new zn);Qe(this,"cameraControls");Qe(this,"canvasRef");Qe(this,"containerRef");Qe(this,"tlWindow");Qe(this,"trWindow");Qe(this,"blWindow");Qe(this,"brWindow");Qe(this,"editorCameras",["Top","Bottom","Left","Right","Front","Back","Orthographic","UI","Debug"]);Qe(this,"setupRenderer",t=>{this.renderer&&this.renderer.dispose();const n=this.canvasRef.current;this.props.three.canvas=n;const r=t.value;r.type==="WebGLRenderer"?(this.renderer=new y_({canvas:n,stencil:!1}),this.grid.visible=!0):r.type==="WebGPURenderer"&&(this.renderer=new mI({canvas:n,stencil:!1}),this.grid.visible=!1),this.renderer&&(this.renderer.autoClear=!1,this.renderer.shadowMap.enabled=!0,this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setClearColor(0),this.resize(),this.props.three.renderer=this.renderer)});Qe(this,"onUpdate",()=>{this.playing&&(this.update(),this.draw(),this.rafID=requestAnimationFrame(this.onUpdate))});Qe(this,"resize",()=>{var l;this.width=window.innerWidth-300,this.height=window.innerHeight,(l=this.renderer)==null||l.setSize(this.width,this.height);const t=Math.floor(this.width/2),n=Math.floor(this.height/2);this.props.three.resize(this.width,this.height),this.props.onSceneResize!==void 0&&this.currentScene!==void 0&&this.props.onSceneResize(this.currentScene,this.width,this.height);let r=this.width,i=this.height;switch(this.state.mode){case"Side by Side":r=t,i=this.height;break;case"Stacked":r=this.width,i=n;break;case"Quad":r=t,i=n;break}const o=r/i;this.cameras.forEach(h=>{var p;h instanceof q_?(h.left=r/-2,h.right=r/2,h.top=i/2,h.bottom=i/-2,h.name==="UI"&&(h.position.x=this.width/2,h.position.y=this.height/-2,h.position.z=100),h.updateProjectionMatrix()):h instanceof Go&&(h.aspect=o,h.updateProjectionMatrix()),(p=this.cameraHelpers.get(h.name))==null||p.update()})});Qe(this,"addScene",t=>{const n=this.props.scenes.get(t.value.name);if(n!==void 0){const r=new n;r.visible=!1,this.props.onSceneAdd!==void 0&&this.props.onSceneAdd(r),this.props.three.scene=r,this.scenes.set(t.value.name,r),this.scene.add(r)}else console.log("Hermes - Scene not found:",t.value.name,this.props.scenes)});Qe(this,"sceneUpdate",t=>{this.currentScene!==void 0&&(this.currentScene.visible=!1,this.clearLightHelpers());const n=this.scene.getObjectByName(t.value.name);n!==void 0&&(this.currentScene=n,this.currentScene.visible=!0,this.addLightHelpers(this.currentScene))});Qe(this,"removeScene",t=>{const n=t.value.name;this.scenes.delete(n);const r=this.scene.getObjectByName(n);r&&setTimeout(()=>{Hh(r)},100),this.clearLightHelpers()});Qe(this,"addCamera",t=>{var o;const n=t.value,r=n.uuid,i=(o=this.props.three.scene)==null?void 0:o.getObjectByProperty("uuid",n.uuid);if(i!==void 0){const l=i;this.cameras.set(r,l);const h=new VCe(l);h.visible=this.cameraVisibility,this.cameraHelpers.set(r,h),this.helpersContainer.add(h),this.setState({lastUpdate:Date.now()})}});Qe(this,"removeCamera",t=>{const r=t.value.uuid,i=this.cameraHelpers.get(r);i!==void 0&&(this.helpersContainer.remove(i),i.dispose()),this.cameras.delete(r),this.setState({lastUpdate:Date.now()})});Qe(this,"onMouseMove",t=>{var x;const n=new zn;(x=this.renderer)==null||x.getSize(n);const r=Math.min(t.clientX,n.x),i=Math.min(t.clientY,n.y);this.pointer.x=ov(r,0,n.x,-1,1),this.pointer.y=ov(i,0,n.y,1,-1);const o=n.x/2,l=n.y/2,h=()=>{r<o?this.pointer.x=ov(r,0,o,-1,1):this.pointer.x=ov(r,o,n.x,-1,1)},p=()=>{i<l?this.pointer.y=ov(i,0,l,1,-1):this.pointer.y=ov(i,l,n.y,1,-1)};switch(this.state.mode){case"Quad":h(),p();break;case"Side by Side":h();break;case"Stacked":p(),p();break}if(this.updateCamera(r,i,o,l),this.state.interactionMode==="Orbit"||this.currentScene===void 0)return;const y=this.raycaster.intersectObjects(this.currentScene.children);y.length>0&&this.interactionHelper.position.copy(y[0].point)});Qe(this,"onClick",t=>{if(this.state.interactionMode==="Orbit"||this.currentScene===void 0)return;const n=new zn;if(this.renderer.getSize(n),t.clientX>=n.x)return;this.onMouseMove(t);const r=this.raycaster.intersectObjects(this.currentScene.children);r.length>0&&(this.props.three.getObject(r[0].object.uuid),this.interactionHelper.visible=!1,this.setState({interactionMode:"Orbit",lastUpdate:Date.now()}))});Qe(this,"onKey",t=>{if(this.selectedItem!==void 0){if(t.ctrlKey){if(this.currentCamera.name==="UI")return;const n=this.controls.get(this.currentCamera.name);t.key==="0"?(t.preventDefault(),this.clearControls(),this.cameraControls=new n1(this.currentCamera,this.currentWindow.current),this.selectedItem instanceof Mn||this.selectedItem instanceof qj?(this.selectedItem.geometry.computeBoundingBox(),this.cameraControls.fitToBox(this.selectedItem.geometry.boundingBox,!0)):this.cameraControls.fitToSphere(this.selectedItem,!0),this.updateCameraControls(n,!0)):t.key==="1"?(t.preventDefault(),this.clearControls(),this.cameraControls=new n1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,Math.PI*.5,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="2"?(t.preventDefault(),this.clearControls(),this.cameraControls=new n1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,0,!0),this.cameraControls.moveTo(this.selectedItem.position.x,0,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="3"?(t.preventDefault(),this.clearControls(),this.cameraControls=new n1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI/2,Math.PI/2,!0),this.cameraControls.moveTo(0,this.selectedItem.position.y,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="4"?(t.preventDefault(),this.clearControls(),this.cameraControls=new n1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI,Math.PI/2,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="5"&&(t.preventDefault(),this.clearControls(),this.cameraControls=new n1(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(rk(45),rk(45),!0),this.updateCameraControls(n))}else if(this.currentTransform!==void 0)switch(t.key){case"r":this.currentTransform.setMode("rotate");break;case"s":this.currentTransform.setMode("scale");break;case"t":this.currentTransform.setMode("translate");break;case"q":this.currentTransform.setSpace(this.currentTransform.space==="local"?"world":"local");break}}});Qe(this,"onSetSelectedItem",t=>{this.selectedItem!==void 0&&this.updateSelectedItemHelper(!1),this.selectedItem=void 0;const n=t.value.uuid;if(this.scenes.forEach(r=>{n.search(r.uuid)>-1&&(this.selectedItem=r.getObjectByProperty("uuid",n))}),this.selectedItem===void 0){console.log(`Hermes - Can't find selected item: ${t.value.uuid}, ${t.value.name}`);return}this.currentTransform!==void 0&&(this.currentTransform.removeEventListener("objectChange",this.onUpdateTransform),Dh.instance.remove(this.currentTransform.getHelper().name)),this.currentTransform=Dh.instance.add(t.value.name),this.currentTransform.attach(this.selectedItem),this.helpersContainer.add(this.currentTransform.getHelper()),this.currentTransform.addEventListener("objectChange",this.onUpdateTransform),this.updateSelectedItemHelper(!0)});Qe(this,"onUpdateTransform",()=>{this.selectedItem!==void 0&&(this.props.three.updateObject(this.selectedItem.uuid,"position",this.selectedItem.position),this.props.three.updateObject(this.selectedItem.uuid,"rotation",{x:this.selectedItem.rotation.x,y:this.selectedItem.rotation.y,z:this.selectedItem.rotation.z}),this.props.three.updateObject(this.selectedItem.uuid,"scale",this.selectedItem.scale),Ek.instance.update())});Qe(this,"clearLightHelpers",()=>{this.lightHelpers.forEach(t=>{this.helpersContainer.remove(t),t.dispose()}),this.lightHelpers.clear()});Qe(this,"addLightHelpers",t=>{t.traverse(n=>{if(n.type.search("Light")>-1){let r;switch(n.type){case"DirectionalLight":r=new zCe(n,100),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"HemisphereLight":r=new BCe(n,250),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"RectAreaLight":r=new JHe(n),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"PointLight":r=new LCe(n,100),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break;case"SpotLight":r=new OCe(n),r.name=`${n.name}Helper`,r.visible=this.lightVisibility,this.lightHelpers.set(n.name,r),this.helpersContainer.add(r);break}}})});Qe(this,"updateCamera",(t,n,r,i)=>{switch(this.state.mode){case"Quad":n<i?t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam:t<r?this.currentCamera=this.blCam:this.currentCamera=this.brCam;break;case"Side by Side":t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break;case"Single":this.currentCamera=this.tlCam;break;case"Stacked":n<i?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break}this.splineEditor.camera=this.currentCamera,this.raycaster.setFromCamera(this.pointer,this.currentCamera),this.currentCamera===this.tlCam?this.currentWindow=this.tlWindow:this.currentCamera===this.trCam?this.currentWindow=this.trWindow:this.currentCamera===this.blCam?this.currentWindow=this.blWindow:this.currentCamera===this.brCam&&(this.currentWindow=this.brWindow),Dh.instance.updateCamera(this.currentCamera,this.currentWindow.current)});Qe(this,"updateCameraControls",(t,n=!1)=>{if(this.selectedItem===void 0)return;cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.cameraControls&&(this.cameraControls.smoothTime=.1);const r=.15,i=new d3e;i.start(),this.selectedItem.getWorldPosition(t.target0);const o=()=>{const l=i.getDelta();this.cameraControls&&this.cameraControls.update(l),n&&(t.target.lerp(t.target0,r),t.object.position.lerp(t.position0,r),t.object.zoom=UH(t.object.zoom,t.zoom0,r),t.object.updateProjectionMatrix(),t.dispatchEvent({type:"change"})),i.getElapsedTime()>=.5?(cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.clearControls()):this.cameraControlsRafID=requestAnimationFrame(o)};o()});Qe(this,"clearControls",()=>{this.cameraControls!==void 0&&(this.cameraControls.disconnect(),this.cameraControls.dispose(),this.cameraControls=void 0)});Qe(this,"drawDouble",()=>{const t=this.getSceneOverride(this.tlRender),n=this.getSceneOverride(this.trRender),r=Math.floor(this.width/2),i=Math.floor(this.height/2);if(this.state.mode==="Side by Side")this.drawTo(0,0,r,this.height,this.tlCam,t),this.drawTo(r,0,r,this.height,this.trCam,n);else{const o=this.height-i;this.drawTo(0,o,this.width,i,this.tlCam,t),this.drawTo(0,0,this.width,i,this.trCam,n)}});Qe(this,"drawQuad",()=>{const t=this.getSceneOverride(this.tlRender),n=this.getSceneOverride(this.trRender),r=this.getSceneOverride(this.blRender),i=this.getSceneOverride(this.brRender),o=Math.floor(this.width/2),l=Math.floor(this.height/2);let h=0,p=0;p=this.height-l,h=0,this.drawTo(h,p,o,l,this.tlCam,t),h=o,this.drawTo(h,p,o,l,this.trCam,n),p=0,h=0,this.scene.overrideMaterial=r,this.drawTo(h,p,o,l,this.blCam,r),h=o,this.drawTo(h,p,o,l,this.brCam,i)});this.props.three.addEventListener(pi.ADD_RENDERER,this.setupRenderer),this.scene=new ME,this.scene.name=this.scene.uuid="",this.canvasRef=Fn.createRef(),this.containerRef=Fn.createRef(),this.tlWindow=Fn.createRef(),this.trWindow=Fn.createRef(),this.blWindow=Fn.createRef(),this.brWindow=Fn.createRef();const n=t.three.name,r=localStorage,i=r.getItem(`${n}_mode`);this.state={mode:i!==null?i:"Single",modeOpen:!1,renderModeOpen:!1,interactionMode:"Orbit",interactionModeOpen:!1,lastUpdate:Date.now()},r.setItem(`${n}_mode`,this.state.mode),r.setItem(`${n}_tlCam`,r.getItem(`${n}_tlCam`)!==null?r.getItem(`${n}_tlCam`):"Debug"),r.setItem(`${n}_trCam`,r.getItem(`${n}_trCam`)!==null?r.getItem(`${n}_trCam`):"Orthographic"),r.setItem(`${n}_blCam`,r.getItem(`${n}_blCam`)!==null?r.getItem(`${n}_blCam`):"Front"),r.setItem(`${n}_brCam`,r.getItem(`${n}_brCam`)!==null?r.getItem(`${n}_brCam`):"Top"),r.setItem(`${n}_tlRender`,r.getItem(`${n}_tlRender`)!==null?r.getItem(`${n}_tlRender`):"Renderer"),r.setItem(`${n}_trRender`,r.getItem(`${n}_trRender`)!==null?r.getItem(`${n}_trRender`):"Renderer"),r.setItem(`${n}_blRender`,r.getItem(`${n}_blRender`)!==null?r.getItem(`${n}_blRender`):"Renderer"),r.setItem(`${n}_brRender`,r.getItem(`${n}_brRender`)!==null?r.getItem(`${n}_brRender`):"Renderer");const o={Vector2:zn,Vector3:ke,Vector4:Ti,Quaternion:us,Matrix4:yr,Spherical:DH,Box3:Iv,Sphere:l4,Raycaster:kE};n1.install({THREE:o}),this.setupScene(),this.setupTools();const l=localStorage.getItem(this.expandedCameraVisibility);l!==null&&(this.cameraVisibility=l==="open"),this.saveExpandedCameraVisibility();const h=localStorage.getItem(this.expandedLightVisibility);h!==null&&(this.lightVisibility=h==="open"),this.saveExpandedLightVisibility();const p=localStorage.getItem(this.expandedGridVisibility);p!==null&&(this.gridVisibility=p==="open"),this.grid.visible=this.gridVisibility,this.saveExpandedGridVisibility(),Mk.instance=this}componentDidMount(){this.enable(),this.assignControls(),this.resize(),this.play(),Dh.instance.setApp(this.props.three),Dh.instance.activeCamera=this.debugCamera}componentDidUpdate(t,n,r){n.mode!==this.state.mode&&(this.assignControls(),this.resize())}componentWillUnmount(){this.disable(),this.clear(),Rv.removeEditorGroup("View Settings")}render(){const t=[];return this.cameras.forEach((n,r)=>{t.push(r)}),et.jsxs("div",{className:"multiview",children:[et.jsx("canvas",{ref:this.canvasRef}),et.jsxs("div",{className:`cameras ${this.state.mode==="Single"||this.state.mode==="Stacked"?"single":""}`,ref:this.containerRef,children:[this.state.mode==="Single"&&et.jsx(et.Fragment,{children:et.jsx(rv,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}})}),(this.state.mode==="Side by Side"||this.state.mode==="Stacked")&&et.jsxs(et.Fragment,{children:[et.jsx(rv,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),et.jsx(rv,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.trCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}})]}),this.state.mode==="Quad"&&et.jsxs(et.Fragment,{children:[et.jsx(rv,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),et.jsx(rv,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.trCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}}),et.jsx(rv,{name:"bl",camera:this.blCam,options:t,ref:this.blWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.blCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.blCam),this.blCam=r,localStorage.setItem(`${this.appID}_blCam`,r.name),this.createControls(r,this.blWindow.current))},onSelectRenderMode:n=>{this.blRender=n,localStorage.setItem(`${this.appID}_blRender`,n)}}),et.jsx(rv,{name:"br",camera:this.brCam,options:t,ref:this.brWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.brCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.brCam),this.brCam=r,localStorage.setItem(`${this.appID}_brCam`,r.name),this.createControls(r,this.brWindow.current))},onSelectRenderMode:n=>{this.brRender=n,localStorage.setItem(`${this.appID}_brRender`,n)}})]})]}),et.jsxs("div",{className:"settings",children:[et.jsx(wk,{title:"View",index:t9e.indexOf(this.state.mode),options:t9e,onSelect:n=>{n!==this.state.mode&&(this.killControls(),this.setState({mode:n}),localStorage.setItem(`${this.appID}_mode`,n))},open:this.state.modeOpen,onToggle:n=>{this.setState({modeOpen:n,renderModeOpen:!1,interactionModeOpen:!1})}}),et.jsx(wk,{title:"Interact",index:this.state.interactionMode==="Orbit"?0:1,options:["Orbit Mode","Selection Mode"],onSelect:n=>{this.interactionHelper.visible=n==="Selection Mode",this.setState({interactionMode:this.interactionHelper.visible?"Selection":"Orbit"})},open:this.state.interactionModeOpen,onToggle:n=>{this.setState({modeOpen:!1,renderModeOpen:!1,interactionModeOpen:n})}}),et.jsx(MG,{name:"cameraHelper",icon:eWe,selected:this.cameraVisibility,height:24,top:2,onClick:n=>{if(this.cameraVisibility=n,this.saveExpandedCameraVisibility(),this.cameraHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n){const r=this.cameraHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),et.jsx(MG,{name:"lightHelper",icon:tWe,selected:this.lightVisibility,height:24,top:4,onClick:n=>{if(this.lightVisibility=n,this.saveExpandedLightVisibility(),this.lightHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n&&this.selectedItem.isLight===!0){const r=this.lightHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),et.jsx(MG,{name:"gridHelper",icon:nWe,selected:this.gridVisibility,height:21,width:21,onClick:n=>{this.gridVisibility=n,this.saveExpandedGridVisibility(),this.grid.visible=n}})]},this.state.lastUpdate)]})}setupScene(){this.helpersContainer.name="helpers",this.scene.add(this.helpersContainer),this.grid.position.y=-1,this.scene.add(this.grid),this.interactionHelper.name="interactionHelper",this.interactionHelper.visible=!1,this.helpersContainer.add(this.interactionHelper);const t=(o,l)=>{const h=new q_(-100,100,100,-100,0,3e3);return h.name=o,h.position.copy(l),h.lookAt(0,0,0),this.cameras.set(o,h),h},n=1e3;t("Top",new ke(0,n,0)),t("Bottom",new ke(0,-n,0)),t("Left",new ke(-n,0,0)),t("Right",new ke(n,0,0)),t("Front",new ke(0,0,n)),t("Back",new ke(0,0,-n)),t("Orthographic",new ke(n,n,n)),t("UI",new ke),this.debugCamera=new Go(60,1,.01,3e3),this.debugCamera.name="Debug",this.debugCamera.position.set(300,300,300),this.debugCamera.lookAt(0,0,0),this.cameras.set("Debug",this.debugCamera),this.currentCamera=this.debugCamera;const r=localStorage,i=this.props.three.name;this.tlCam=this.cameras.get(r.getItem(`${i}_tlCam`)),this.trCam=this.cameras.get(r.getItem(`${i}_trCam`)),this.blCam=this.cameras.get(r.getItem(`${i}_blCam`)),this.brCam=this.cameras.get(r.getItem(`${i}_brCam`)),this.tlCam===void 0&&(this.tlCam=this.cameras.get("Debug")),this.trCam===void 0&&(this.trCam=this.cameras.get("Orthographic")),this.blCam===void 0&&(this.blCam=this.cameras.get("Front")),this.brCam===void 0&&(this.brCam=this.cameras.get("Top"))}setupTools(){this.splineEditor=new Jje(this.currentCamera,this.three),this.splineEditor.initDebug(),this.helpersContainer.add(this.splineEditor)}play(){this.playing=!0,this.onUpdate()}pause(){this.playing=!1,cancelAnimationFrame(this.rafID),this.rafID=-1}toggleOrbitControls(t){this.controls.forEach(n=>{n.enabled=!t})}clear(){this.three.dispatchEvent({type:pi.CLEAR_OBJECT}),Rv.removeAllGroups(),this.clearLightHelpers(),this.clearControls(),this.currentTransform!==void 0&&(this.currentTransform.removeEventListener("objectChange",this.onUpdateTransform),Dh.instance.remove(this.currentTransform.getHelper().name)),this.currentTransform=void 0,Dh.instance.clear(),this.cameras.forEach(t=>{this.editorCameras.indexOf(t.name)<0&&this.three.dispatchEvent({type:pi.REMOVE_CAMERA,value:t})}),this.currentCamera=this.debugCamera,this.currentScene=void 0,this.scenes.forEach(t=>{this.three.dispatchEvent({type:pi.REMOVE_SCENE,value:t})}),this.scenes.clear()}update(){var t,n;this.renderer&&(this.renderer instanceof y_?(t=this.renderer)==null||t.clear():this.renderer instanceof mI&&((n=this.renderer)==null||n.clearAsync())),this.controls.forEach(r=>r.update()),this.cameraHelpers.forEach(r=>r.update()),this.lightHelpers.forEach(r=>{r.update!==void 0&&r.update()}),this.props.onSceneUpdate!==void 0&&this.currentScene!==void 0&&this.props.onSceneUpdate(this.currentScene)}draw(){var t,n;switch(this.renderer&&(this.renderer instanceof y_?(t=this.renderer)==null||t.clear():this.renderer instanceof mI&&((n=this.renderer)==null||n.clearAsync())),this.state.mode){case"Single":this.drawSingle();break;case"Side by Side":case"Stacked":this.drawDouble();break;case"Quad":this.drawQuad();break}}enable(){const t=this.containerRef.current;t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("click",this.onClick),window.addEventListener("keydown",this.onKey),window.addEventListener("resize",this.resize),this.three.addEventListener(pi.ADD_SCENE,this.addScene),this.three.addEventListener(pi.SET_SCENE,this.sceneUpdate),this.three.addEventListener(pi.REMOVE_SCENE,this.removeScene),this.three.addEventListener(pi.ADD_CAMERA,this.addCamera),this.three.addEventListener(pi.REMOVE_CAMERA,this.removeCamera),this.three.addEventListener(pi.SET_OBJECT,this.onSetSelectedItem)}disable(){const t=this.containerRef.current;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("click",this.onClick),window.removeEventListener("keydown",this.onKey),window.removeEventListener("resize",this.resize),this.three.removeEventListener(pi.ADD_SCENE,this.addScene),this.three.removeEventListener(pi.SET_SCENE,this.sceneUpdate),this.three.removeEventListener(pi.ADD_CAMERA,this.addCamera),this.three.removeEventListener(pi.REMOVE_CAMERA,this.removeCamera),this.three.removeEventListener(pi.SET_OBJECT,this.onSetSelectedItem)}updateSelectedItemHelper(t){if(this.selectedItem!==void 0)if(this.cameraVisibility){if(this.selectedItem.isLight===!0&&!this.lightVisibility){const n=this.lightHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}else{const n=this.cameraHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}createControls(t,n){const r=this.controls.get(t.name);if(r!==void 0&&r.dispose(),this.controls.delete(t.name),t.name==="UI")return;const i=new tje(t,n);switch(i.enableDamping=!0,i.dampingFactor=.1,t.name){case"Top":case"Bottom":case"Left":case"Right":case"Front":case"Back":i.enableRotate=!1;break}this.controls.set(t.name,i)}clearCamera(t){const n=this.cameraHelpers.get(t.name);n!==void 0&&(this.helpersContainer.remove(n),n.dispose(),this.cameraHelpers.delete(t.name));const r=this.controls.get(t.name);r!==void 0&&(r.dispose(),this.controls.delete(t.name))}killControls(){this.controls.forEach((t,n)=>{t.dispose();const r=this.cameraHelpers.get(n);r!==void 0&&(this.helpersContainer.remove(r),r.dispose()),this.cameraHelpers.delete(n),this.controls.delete(n)}),this.controls.clear(),this.cameraHelpers.clear()}assignControls(){switch(this.state.mode){case"Single":this.createControls(this.tlCam,this.tlWindow.current);break;case"Side by Side":case"Stacked":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current);break;case"Quad":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current),this.createControls(this.blCam,this.blWindow.current),this.createControls(this.brCam,this.brWindow.current);break}}saveExpandedCameraVisibility(){localStorage.setItem(this.expandedCameraVisibility,this.cameraVisibility?"open":"closed")}saveExpandedLightVisibility(){localStorage.setItem(this.expandedLightVisibility,this.lightVisibility?"open":"closed")}saveExpandedGridVisibility(){localStorage.setItem(this.expandedGridVisibility,this.gridVisibility?"open":"closed")}getSceneOverride(t){switch(t){case"Depth":return this.depthMaterial;case"Normals":return this.normalsMaterial;case"Renderer":return null;case"UVs":return this.uvMaterial;case"Wireframe":return this.wireframeMaterial}return null}drawTo(t,n,r,i,o,l){var h,p,y,x;switch(o.name){case"Left":case"Right":this.grid.rotation.z=Math.PI/2;break;case"Front":case"Back":this.grid.rotation.x=Math.PI/2;break}this.scene.overrideMaterial=l,this.renderer&&((h=this.renderer)==null||h.setViewport(t,n,r,i),(p=this.renderer)==null||p.setScissor(t,n,r,i),this.renderer instanceof y_?(y=this.renderer)==null||y.render(this.scene,o):this.renderer instanceof mI&&((x=this.renderer)==null||x.renderAsync(this.scene,o))),this.grid.rotation.set(0,0,0)}drawSingle(){const t=this.getSceneOverride(this.tlRender);this.drawTo(0,0,this.width,this.height,this.tlCam,t)}get appID(){return this.props.three.name}get mode(){return this.state.mode}get three(){return this.props.three}get expandedCameraVisibility(){return`${this.appID}_multiviewCameraVisibility`}get expandedLightVisibility(){return`${this.appID}_multiviewLightVisibility`}get expandedGridVisibility(){return`${this.appID}_multiviewGridVisibility`}};Qe(Mk,"instance",null);let oo=Mk;function t8e(s){if(s.child===void 0)return console.log("Hermes - No child attached"),null;const e=Fn.useRef(null),[t,n]=Fn.useState(!1),r=s.child.children.length>0,i=[];return s.child.children.length>0&&s.child.children.map((o,l)=>{i.push(et.jsx(t8e,{child:o,three:s.three},l))}),Fn.useEffect(()=>{if(s.child){const o=s.child.uuid.split(".")[0],l=s.three.getScene(o);if(l!==null)try{const h=l.getObjectByProperty("uuid",s.child.uuid);h!==void 0?e.current.style.opacity=h.visible?"1":"0.25":console.log(`Hermes - Can't find child: ${s.child.uuid}`)}catch(h){console.log("Error looking for child:",h),console.log(s.child),console.log(s.three.scenes),console.log(l)}else console.log(`Hermes (ChildObject) - Can't find Scene: ${o} with child UUID: ${s.child.uuid}`,s.three.scenes,s.three.scene,l)}},[t]),et.jsxs("div",{className:"childObject",children:[et.jsxs("div",{className:"child",children:[r?et.jsx("button",{className:"status",style:{backgroundPositionX:t?"-14px":"2px"},onClick:()=>{n(!t)}}):null,et.jsx("button",{className:"name",style:{left:r?"20px":"5px"},onClick:()=>{s.child!==void 0?(s.three.getObject(s.child.uuid),!t&&r&&n(!0)):console.log("Hermes - No child attached...")},children:s.child.name.length>0?`${s.child.name} (${s.child.type})`:`${s.child.type}::${s.child.uuid}`}),et.jsx("button",{className:"visibility",ref:e,onClick:()=>{if(s.child){const o=s.three.getScene(s.child.uuid);if(o!==null){const l=o.getObjectByProperty("uuid",s.child.uuid);if(l!==void 0){const h="visible",p=!l.visible;e.current.style.opacity=p?"1":"0.25",s.three.updateObject(s.child.uuid,h,p),Wa(l,h,p)}else console.log(`Hermes - Couldn't find object: ${s.child.uuid}`,o)}else console.log(`Hermes - Couldn't find object in scene: ${s.child.uuid}, ${s.child.name}`)}}}),et.jsx("div",{className:`icon ${Bke(s.child)}`})]}),et.jsx("div",{className:t?"open":"",children:et.jsx("div",{className:"container",children:i})})]},Math.random())}function IG(s){var t;const e=[];return(t=s.child)==null||t.children.map((n,r)=>{e.push(et.jsx(t8e,{child:n,scene:s.scene,three:s.three},r))}),et.jsx("div",{className:`scene ${s.class!==void 0?s.class:""}`,children:e})}function n9e(s){switch(s){case"fov":return"FOV";case"zoom":return"Zoom";case"near":return"Near";case"far":return"Far";case"focus":return"Focus";case"aspect":return"Aspect";case"filmGauge":return"Film Gauge";case"filmOffset":return"Film Offset";case"left":return"Left";case"right":return"Right";case"top":return"Top";case"bottom":return"Bottom"}return s}function rWe(s,e){function t(){return`${e.name}_camera`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function i(l){localStorage.setItem(t(),l?"open":"closed")}const o=[];if(s.perspectiveCameraInfo!==void 0)for(const l in s.perspectiveCameraInfo)o.push({title:n9e(l),prop:l,type:"number",step:.01,value:s.perspectiveCameraInfo[l],onChange:(h,p)=>{e.updateObject(s.uuid,h,p),e.requestMethod(s.uuid,"updateProjectionMatrix");const y=e.getScene(s.uuid);if(y!==null){const x=y.getObjectByProperty("uuid",s.uuid);x!==void 0&&(Wa(x,h,p),x.updateProjectionMatrix())}}});else if(s.orthographicCameraInfo!==void 0)for(const l in s.orthographicCameraInfo)o.push({title:n9e(l),prop:l,type:"number",step:.01,value:s.orthographicCameraInfo[l],onChange:(h,p)=>{e.updateObject(s.uuid,h,p),e.requestMethod(s.uuid,"updateProjectionMatrix");const y=e.getScene(s.uuid);if(y!==null){const x=y.getObjectByProperty("uuid",s.uuid);x!==void 0&&(Wa(x,h,p),x.updateProjectionMatrix())}}});return et.jsx($h,{three:e,title:"Camera",items:o,expanded:r,onToggle:l=>{i(l)}})}function r9e(s){switch(s){case"color":return"Color";case"intensity":return"Intensity";case"decay":return"Decay";case"distance":return"Distance";case"angle":return"Angle";case"penumbra":return"Penumbra";case"groundColor":return"Ground Color";case"width":return"Width";case"height":return"Height"}return s}function iWe(s,e){function t(){return`${e.name}_light`}const n=localStorage.getItem(t()),r=n!==null?n==="open":!1;function i(l){localStorage.setItem(t(),l?"open":"closed")}const o=[];if(s.lightInfo!==void 0)for(const l in s.lightInfo){const h=s.lightInfo[l];h!==void 0&&(h.isColor!==void 0?o.push({title:r9e(l),prop:l,type:"color",value:h,onChange:(p,y)=>{const x=new Vn(y);e.updateObject(s.uuid,p,x);const S=e.getScene(s.uuid);if(S!==null){const A=S.getObjectByProperty("uuid",s.uuid);Wa(A,p,x)}}}):o.push({title:r9e(l),prop:l,type:typeof h,value:h,step:typeof h=="number"?.01:void 0,onChange:(p,y)=>{e.updateObject(s.uuid,p,y);const x=e.getScene(s.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",s.uuid);Wa(S,p,y)}}}))}return et.jsx($h,{three:e,title:"Light",items:o,expanded:r,onToggle:l=>{i(l)}})}function sWe(s){var S;const e=s.object,t=s.three;function n(){return`${t.name}_animation`}const r=localStorage.getItem(n()),i=r!==null?r==="open":!1;function o(A){localStorage.setItem(n(),A?"open":"closed")}const l=[],h=[];let p=0;e.animations.forEach(A=>{p=Math.max(p,A.duration),A.duration>0&&h.push({title:A.name,items:[{title:"Duration",type:"number",value:A.duration,disabled:!0},{title:"Blend Mode",type:"option",disabled:!0,options:[{title:"Normal",value:2500},{title:"Additive",value:2501}]}]})}),l.push({title:"Animations",items:h});let y;const x=t.getScene(e.uuid);if(x!==null){const A=x.getObjectByProperty("uuid",e.uuid);if(A!==void 0){const k=A.mixer;if(k!==void 0){const U=[{title:"Time Scale",type:"range",value:k.timeScale,step:.01,min:-1,max:2,onChange:(P,$)=>{k.timeScale=$,t.updateObject(e.uuid,"mixer.timeScale",$)}}];U.push({title:"Stop All",type:"button",onChange:()=>{k.stopAllAction(),t.requestMethod(e.uuid,"stopAllAction",void 0,"mixer")}}),l.push({title:"Mixer",items:U}),y=new FCe(A),(S=oo.instance)==null||S.scene.add(y)}}}return Fn.useEffect(()=>()=>{y!==void 0&&Hh(y)},[]),et.jsx($h,{three:s.three,title:"Animation",items:l,expanded:i,onToggle:A=>{o(A)}})}const kG={name:"",uuid:"",type:"",visible:!1,matrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};function aWe(s){const[e,t]=Fn.useState(kG);Fn.useEffect(()=>{function o(h){t(h.value)}function l(){t(kG)}return s.three.addEventListener(pi.CLEAR_OBJECT,l),s.three.addEventListener(pi.SET_SCENE,l),s.three.addEventListener(pi.SET_OBJECT,o),()=>{s.three.removeEventListener(pi.CLEAR_OBJECT,l),s.three.removeEventListener(pi.SET_SCENE,l),s.three.removeEventListener(pi.SET_OBJECT,o)}},[]);const n=e.type.toLowerCase(),r=e.animations.length>0||e.mixer!==void 0,i=n.search("mesh")>-1||n.search("line")>-1||n.search("points")>-1;return et.jsx(_E,{three:s.three,label:"Inspector",button:e.uuid.length>0?et.jsx("button",{className:"remove",onClick:()=>{Dh.instance.remove(e.name),t(kG)}}):void 0,children:et.jsx("div",{id:"Inspector",className:s.class,children:e.uuid.length>0&&et.jsxs(et.Fragment,{children:[et.jsxs(et.Fragment,{children:[et.jsx(jI,{type:"string",title:"Name",prop:"name",value:e.name,disabled:!0}),et.jsx(jI,{type:"string",title:"Type",prop:"type",value:e.type,disabled:!0}),et.jsx(jI,{type:"string",title:"UUID",prop:"uuid",value:e.uuid,disabled:!0})]}),et.jsxs(et.Fragment,{children:[et.jsx(Ek,{object:e,three:s.three}),r?et.jsx(sWe,{object:e,three:s.three}):null,n.search("camera")>-1?rWe(e,s.three):null,n.search("light")>-1?iWe(e,s.three):null,i?Lje(e,s.three):null]})]})})},"Inspector")}class oWe extends Fn.Component{constructor(t){super(t);Qe(this,"autoClear",!0);Qe(this,"autoClearColor",!0);Qe(this,"autoClearDepth",!0);Qe(this,"autoClearStencil",!0);Qe(this,"outputColorSpace",ei);Qe(this,"localClippingEnabled",!1);Qe(this,"clearColor",new Vn(0));Qe(this,"clearAlpha",1);Qe(this,"toneMapping",o1);Qe(this,"toneMappingExposure",1);Qe(this,"type","");Qe(this,"onAddRenderer",t=>{const n=t.value;if(this.autoClear=n.autoClear,this.autoClearColor=n.autoClearColor,this.autoClearDepth=n.autoClearDepth,this.autoClearStencil=n.autoClearStencil,this.outputColorSpace=n.outputColorSpace,this.localClippingEnabled=n.localClippingEnabled,this.clearAlpha=n.clearAlpha,this.type=n.type,this.toneMapping=n.toneMapping,this.toneMappingExposure=n.toneMappingExposure,this.clearColor.setStyle(n.clearColor,kc),Yr.enabled=n.colorManagement,oo.instance){const r=oo.instance.renderer;r&&(r.autoClearColor=this.autoClearColor,r.outputColorSpace=this.outputColorSpace,r.localClippingEnabled=this.localClippingEnabled,r.toneMapping=this.toneMapping,r.toneMappingExposure=this.toneMappingExposure,r.setClearColor(n.clearColor,this.clearAlpha))}this.setState({lastUpdated:Date.now()})});const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;if(this.state={expanded:r,lastUpdated:Date.now()},this.saveExpanded(r),oo.instance){const i=oo.instance.renderer;i&&(this.autoClear=i.autoClear,this.autoClearColor=i.autoClearColor,this.autoClearDepth=i.autoClearDepth,this.autoClearStencil=i.autoClearStencil,this.clearAlpha=i.getClearAlpha(),this.toneMapping=i.toneMapping,this.toneMappingExposure=i.toneMappingExposure,i instanceof y_&&(this.localClippingEnabled=i.localClippingEnabled,i.getClearColor(this.clearColor)))}this.props.three.addEventListener(pi.ADD_RENDERER,this.onAddRenderer)}componentwillunmount(){this.props.three.removeEventListener(pi.ADD_RENDERER,this.onAddRenderer)}render(){const t=()=>{if(oo.instance){const n=oo.instance.renderer;n&&(n.autoClearColor=this.autoClearColor,n.outputColorSpace=this.outputColorSpace,n.localClippingEnabled=this.localClippingEnabled,n.toneMapping=this.toneMapping,n.toneMappingExposure=this.toneMappingExposure,n.setClearColor(this.clearColor.getStyle(),this.clearAlpha),this.props.three.updateRenderer({autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,outputColorSpace:this.outputColorSpace,localClippingEnabled:this.localClippingEnabled,clearAlpha:this.clearAlpha,clearColor:this.clearColor.getStyle(),colorManagement:Yr.enabled,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure}))}};return et.jsx($h,{three:this.props.three,title:"Renderer",expanded:this.state.expanded,items:[{type:"boolean",title:"Auto Clear",value:this.autoClear,onChange:(n,r)=>{this.autoClear=r}},{type:"boolean",title:"Auto Clear Color",value:this.autoClearColor,onChange:(n,r)=>{this.autoClearColor=r,t()}},{type:"boolean",title:"Auto Clear Depth",value:this.autoClearDepth,onChange:(n,r)=>{this.autoClearDepth=r,t()}},{type:"boolean",title:"Auto Clear Stencil",value:this.autoClearStencil,onChange:(n,r)=>{this.autoClearStencil=r,t()}},{type:"boolean",title:"Local Clipping",value:this.localClippingEnabled,onChange:(n,r)=>{this.localClippingEnabled=r,t()}},{type:"color",title:"Clear Color",value:`#${this.clearColor.getHexString()}`,onChange:(n,r)=>{this.clearColor.setStyle(r),t()}},{type:"range",title:"Clear Alpha",min:0,max:1,step:.01,value:this.clearAlpha,onChange:(n,r)=>{this.clearAlpha=r,t()}},{type:"boolean",title:"Clear Management",value:Yr.enabled,onChange:(n,r)=>{Yr.enabled=r,t()}},{type:"option",title:"Color Space",value:this.outputColorSpace,options:[{title:"No Color Space",value:bf},{title:"SRB Color Space",value:ei},{title:"Linear SRB Color Space",value:kc}],onChange:(n,r)=>{this.outputColorSpace=r,t()}},{type:"option",title:"Tone Mapping",value:this.toneMapping,options:[{title:"None ",value:o1},{title:"Linear ",value:x9e},{title:"Reinhard",value:b9e},{title:"Cineon ",value:S9e},{title:"ACES Filmic",value:w9e},{title:"AgX",value:T9e},{title:"Neutral",value:M9e},{title:"Custom",value:E9e}],onChange:(n,r)=>{this.toneMapping=r,t()}},{type:"range",title:"Tone Mapping Exposure",value:this.toneMappingExposure,min:0,max:2,step:.01,onChange:(n,r)=>{this.toneMappingExposure=r,t()}},{type:"string",title:"Type",value:this.type,disabled:!0},{type:"button",title:"Resize Scenes from Source",onChange:()=>{this.props.three.requestSize()}}],onToggle:n=>{this.setState({expanded:n}),this.saveExpanded(n)}},Math.random())}saveExpanded(t){localStorage.setItem(this.expandedName,t?"open":"closed")}get expandedName(){return`${this.props.three.name}_renderer`}}function lWe(s){const[e]=Fn.useState([]),[t]=Fn.useState([]),[n,r]=Fn.useState(0),i=p=>{const y=p.value;e.push(y),t.push(et.jsx(_E,{three:s.three,label:`Scene: ${y.name}`,scene:y,open:!1,visible:!1,onRefresh:()=>{s.three.refreshScene(y.name)},children:et.jsx(IG,{child:y,scene:y,three:s.three})},y.name)),r(Date.now())},o=p=>{const y=p.value;for(let x=0;x<e.length;x++)if(y.uuid===e[x].uuid){e[x]=y,t[x]=et.jsx(_E,{three:s.three,label:`Scene: ${y.name}`,scene:y,open:t[x].props.open,visible:t[x].props.visible,onRefresh:()=>{s.three.refreshScene(y.name)},children:et.jsx(IG,{child:y,scene:y,three:s.three})},y.name),r(Date.now());return}},l=p=>{const y=p.value;for(let x=0;x<e.length;x++)if(y.uuid===e[x].uuid){e.splice(x,1),t.splice(x,1),r(Date.now());return}},h=p=>{const y=p.value.name;for(let x=0;x<e.length;x++){const S=e[x];if(S.name===y){t[x]=et.jsx(_E,{three:s.three,label:`Scene: ${S.name}`,scene:S,open:!0,visible:!0,onRefresh:()=>{s.three.refreshScene(S.name)},children:et.jsx(IG,{child:S,scene:S,three:s.three})},S.name);break}}r(Date.now())};return Fn.useEffect(()=>(s.three.addEventListener(pi.ADD_SCENE,i),s.three.addEventListener(pi.SET_SCENE,h),s.three.addEventListener(pi.REFRESH_SCENE,o),s.three.addEventListener(pi.REMOVE_SCENE,l),()=>{s.three.removeEventListener(pi.ADD_SCENE,i),s.three.removeEventListener(pi.SET_SCENE,h),s.three.removeEventListener(pi.REFRESH_SCENE,o),s.three.removeEventListener(pi.REMOVE_SCENE,l)}),[]),et.jsxs("div",{id:"SidePanel",children:[et.jsx("div",{className:"scenes",children:t},n),et.jsx(aWe,{three:s.three}),et.jsx(oWe,{three:s.three}),et.jsx(Rv,{three:s.three})]})}function uWe(s){return et.jsx($ke,{children:et.jsxs(et.Fragment,{children:[et.jsx(oo,{three:s.three,scenes:s.scenes,onSceneAdd:s.onSceneAdd,onSceneResize:s.onSceneResize,onSceneUpdate:s.onSceneUpdate}),et.jsx(lWe,{three:s.three})]})})}async function cWe(){var n;for(;!document.getElementById("theatrejs-studio-root");)await new Promise(r=>setTimeout(r,100));const s=document.getElementById("theatrejs-studio-root");if(s===null||s.shadowRoot===null)return;const e=s.shadowRoot.getElementById("pointer-root");if(e===null)return;const t=e.children[0];if(t!==null){try{const i=t.children[1].children[1];(n=i.parentElement)==null||n.removeChild(i)}catch{}try{const r=t.children[3];r.style.top="0",r.style.right="300px"}catch{}}}/**
 * postprocessing v6.37.6 build Fri Jul 04 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var NG=1/1e3,hWe=1e3,dWe=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(s){typeof document<"u"&&document.hidden!==void 0&&(s?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=s)}get delta(){return this._delta*NG}get fixedDelta(){return this._fixedDelta*NG}set fixedDelta(s){this._fixedDelta=s*hWe}get elapsed(){return this._elapsed*NG}update(s){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(s!==void 0?s:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(s){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},fWe=(()=>{const s=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new ts;return t.setAttribute("position",new Ic(s,3)),t.setAttribute("uv",new Ic(e,2)),t})(),qh=class _j{static get fullscreenGeometry(){return fWe}constructor(e="Pass",t=new ME,n=new Pk){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Mn(_j.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new ME),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=HE){}render(e,t,n,r,i){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof J0||t instanceof Fc||t instanceof Wo||t instanceof _j)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},pWe=class extends qh{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(s,e,t,n,r){const i=s.state.buffers.stencil;i.setLocked(!1),i.setTest(!1)}},mWe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,n8e="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",h$=class extends $o{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new ms(null),opacity:new ms(1)},blending:Gl,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:mWe,vertexShader:n8e})}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.uniforms.inputBuffer.value=s}getOpacity(s){return this.uniforms.opacity.value}setOpacity(s){this.uniforms.opacity.value=s}},gWe=class extends qh{constructor(s,e=!0){super("CopyPass"),this.fullscreenMaterial=new h$,this.needsSwap=!1,this.renderTarget=s,s===void 0&&(this.renderTarget=new J0(1,1,{minFilter:Ho,magFilter:Ho,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(s){this.autoResize=s}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(s){this.autoResize=s}render(s,e,t,n,r){this.fullscreenMaterial.inputBuffer=e.texture,s.setRenderTarget(this.renderToScreen?null:this.renderTarget),s.render(this.scene,this.camera)}setSize(s,e){this.autoResize&&this.renderTarget.setSize(s,e)}initialize(s,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==jo?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":s!==null&&s.outputColorSpace===ei&&(this.renderTarget.texture.colorSpace=ei))}},i9e=new Vn,r8e=class extends qh{constructor(s=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=s,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(s,e,t){this.color=s,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(s){this.overrideClearColor=s}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(s){this.overrideClearAlpha=s}render(s,e,t,n,r){const i=this.overrideClearColor,o=this.overrideClearAlpha,l=s.getClearAlpha(),h=i!==null,p=o>=0;h?(s.getClearColor(i9e),s.setClearColor(i,p?o:l)):p&&s.setClearAlpha(o),s.setRenderTarget(this.renderToScreen?null:e),s.clear(this.color,this.depth,this.stencil),h?s.setClearColor(i9e,l):p&&s.setClearAlpha(l)}},vWe=class extends qh{constructor(s,e){super("MaskPass",s,e),this.needsSwap=!1,this.clearPass=new r8e(!1,!1,!0),this.inverse=!1}set mainScene(s){this.scene=s}set mainCamera(s){this.camera=s}get inverted(){return this.inverse}set inverted(s){this.inverse=s}get clear(){return this.clearPass.enabled}set clear(s){this.clearPass.enabled=s}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(s){this.inverted=s}render(s,e,t,n,r){const i=s.getContext(),o=s.state.buffers,l=this.scene,h=this.camera,p=this.clearPass,y=this.inverted?0:1,x=1-y;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),o.stencil.setFunc(i.ALWAYS,y,4294967295),o.stencil.setClear(x),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(s,null):(p.render(s,e),p.render(s,t))),this.renderToScreen?(s.setRenderTarget(null),s.render(l,h)):(s.setRenderTarget(e),s.render(l,h),s.setRenderTarget(t),s.render(l,h)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(i.EQUAL,1,4294967295),o.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),o.stencil.setLocked(!0)}},yWe=class{constructor(s=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:n=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,r,n),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new gWe,this.depthTexture=null,this.passes=[],this.timer=new dWe,this.autoRenderToScreen=!0,this.setRenderer(s)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(s){const e=this.inputBuffer,t=this.multisampling;t>0&&s>0?(this.inputBuffer.samples=s,this.outputBuffer.samples=s,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==s&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,s),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(s){if(this.renderer=s,s!==null){const e=s.getSize(new zn),t=s.getContext().getContextAttributes().alpha,n=this.inputBuffer.texture.type;n===jo&&s.outputColorSpace===ei&&(this.inputBuffer.texture.colorSpace=ei,this.outputBuffer.texture.colorSpace=ei,this.inputBuffer.dispose(),this.outputBuffer.dispose()),s.autoClear=!1,this.setSize(e.width,e.height);for(const r of this.passes)r.initialize(s,t,n)}}replaceRenderer(s,e=!0){const t=this.renderer,n=t.domElement.parentNode;return this.setRenderer(s),e&&n!==null&&(n.removeChild(t.domElement),n.appendChild(s.domElement)),t}createDepthTexture(){const s=this.depthTexture=new Kj;return this.inputBuffer.depthTexture=s,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(s.format=G_,s.type=V_):s.type=e4,s}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const s of this.passes)s.setDepthTexture(null)}}createBuffer(s,e,t,n){const r=this.renderer,i=r===null?new zn:r.getDrawingBufferSize(new zn),o={minFilter:Ho,magFilter:Ho,stencilBuffer:e,depthBuffer:s,type:t},l=new J0(i.width,i.height,o);return n>0&&(l.ignoreDepthForMultisampleCopy=!1,l.samples=n),t===jo&&r!==null&&r.outputColorSpace===ei&&(l.texture.colorSpace=ei),l.texture.name="EffectComposer.Buffer",l.texture.generateMipmaps=!1,l}setMainScene(s){for(const e of this.passes)e.mainScene=s}setMainCamera(s){for(const e of this.passes)e.mainCamera=s}addPass(s,e){const t=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new zn),i=n.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(s.setRenderer(n),s.setSize(r.width,r.height),s.initialize(n,i,o),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),s.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,s):t.push(s),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),s.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const l=this.createDepthTexture();for(s of t)s.setDepthTexture(l)}else s.setDepthTexture(this.depthTexture)}removePass(s){const e=this.passes,t=e.indexOf(s);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const i=(l,h)=>l||h.needsDepthTexture;e.reduce(i,!1)||(s.getDepthTexture()===this.depthTexture&&s.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(s.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const s=this.passes;this.deleteDepthTexture(),s.length>0&&(this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!1),this.passes=[])}render(s){const e=this.renderer,t=this.copyPass;let n=this.inputBuffer,r=this.outputBuffer,i=!1,o,l,h;s===void 0&&(this.timer.update(),s=this.timer.getDelta());for(const p of this.passes)p.enabled&&(p.render(e,n,r,s,i),p.needsSwap&&(i&&(t.renderToScreen=p.renderToScreen,o=e.getContext(),l=e.state.buffers.stencil,l.setFunc(o.NOTEQUAL,1,4294967295),t.render(e,n,r,s,i),l.setFunc(o.EQUAL,1,4294967295)),h=n,n=r,r=h),p instanceof vWe?i=!0:p instanceof pWe&&(i=!1))}setSize(s,e,t){const n=this.renderer,r=n.getSize(new zn);(s===void 0||e===void 0)&&(s=r.width,e=r.height),(r.width!==s||r.height!==e)&&n.setSize(s,e,t);const i=n.getDrawingBufferSize(new zn);this.inputBuffer.setSize(i.width,i.height),this.outputBuffer.setSize(i.width,i.height);for(const o of this.passes)o.setSize(i.width,i.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const s of this.passes)s.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),qh.fullscreenGeometry.dispose()}},Tv={NONE:0,DEPTH:1,CONVOLUTION:2},Xi={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},_We=class{constructor(){this.shaderParts=new Map([[Xi.FRAGMENT_HEAD,null],[Xi.FRAGMENT_MAIN_UV,null],[Xi.FRAGMENT_MAIN_IMAGE,null],[Xi.VERTEX_HEAD,null],[Xi.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Tv.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=kc}},DG=!1,s9e=class{constructor(s=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(s),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case X0:t=this.materialsFlatShadedDoubleSide;break;case qa:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case X0:t=this.materialsDoubleSide;break;case qa:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(s){if(!(s instanceof $o))return s.clone();const e=s.uniforms,t=new Map;for(const r in e){const i=e[r].value;i.isRenderTargetTexture&&(e[r].value=null,t.set(r,i))}const n=s.clone();for(const r of t)e[r[0]].value=r[1],n.uniforms[r[0]].value=r[1];return n}setMaterial(s){if(this.disposeMaterials(),this.material=s,s!==null){const e=this.materials=[this.cloneMaterial(s),this.cloneMaterial(s),this.cloneMaterial(s)];for(const t of e)t.uniforms=Object.assign({},s.uniforms),t.side=c1;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.side=qa,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.side=X0,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.flatShading=!0,n.side=qa,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},s.uniforms),n.flatShading=!0,n.side=X0,n})}}render(s,e,t){const n=s.shadowMap.enabled;if(s.shadowMap.enabled=!1,DG){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),s.render(e,t);for(const i of r)i[0].material=i[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,s.render(e,t),e.overrideMaterial=r}s.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const s=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of s)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return DG}static set workaroundEnabled(s){DG=s}},z3=-1,a1=class extends Oc{constructor(s,e=z3,t=z3,n=1){super(),this.resizable=s,this.baseSize=new zn(1,1),this.preferredSize=new zn(e,t),this.target=this.preferredSize,this.s=n,this.effectiveSize=new zn,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const s=this.baseSize,e=this.preferredSize,t=this.effectiveSize,n=this.scale;e.width!==z3?t.width=e.width:e.height!==z3?t.width=Math.round(e.height*(s.width/Math.max(s.height,1))):t.width=Math.round(s.width*n),e.height!==z3?t.height=e.height:e.width!==z3?t.height=Math.round(e.width/Math.max(s.width/Math.max(s.height,1),1)):t.height=Math.round(s.height*n)}get width(){return this.effectiveSize.width}set width(s){this.preferredWidth=s}get height(){return this.effectiveSize.height}set height(s){this.preferredHeight=s}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(s){this.s!==s&&(this.s=s,this.preferredSize.setScalar(z3),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(s){this.scale=s}get baseWidth(){return this.baseSize.width}set baseWidth(s){this.baseSize.width!==s&&(this.baseSize.width=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(s){this.baseWidth=s}get baseHeight(){return this.baseSize.height}set baseHeight(s){this.baseSize.height!==s&&(this.baseSize.height=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(s){this.baseHeight=s}setBaseSize(s,e){(this.baseSize.width!==s||this.baseSize.height!==e)&&(this.baseSize.set(s,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(s){this.preferredSize.width!==s&&(this.preferredSize.width=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(s){this.preferredWidth=s}get preferredHeight(){return this.preferredSize.height}set preferredHeight(s){this.preferredSize.height!==s&&(this.preferredSize.height=s,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(s){this.preferredHeight=s}setPreferredSize(s,e){(this.preferredSize.width!==s||this.preferredSize.height!==e)&&(this.preferredSize.set(s,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(s){this.s=s.scale,this.baseSize.set(s.baseWidth,s.baseHeight),this.preferredSize.set(s.preferredWidth,s.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return z3}},Pi={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},xWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),opacity);}",bWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",SWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),opacity);}",wWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",EWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),opacity);}",TWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),opacity);}",MWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),opacity);}",CWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),opacity);}",AWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),opacity);}",PWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),opacity);}",RWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),opacity);}",IWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),opacity);}",kWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),opacity);}",NWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),opacity);}",DWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),opacity);}",OWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),opacity);}",FWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",LWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),opacity);}",UWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",BWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),opacity);}",zWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),opacity);}",VWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),opacity);}",GWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",HWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),opacity);}",jWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),opacity);}",WWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),opacity);}",$We="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",qWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),opacity);}",XWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),opacity);}",YWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",KWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),opacity);}",ZWe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),opacity);}",QWe=new Map([[Pi.ADD,xWe],[Pi.ALPHA,bWe],[Pi.AVERAGE,SWe],[Pi.COLOR,wWe],[Pi.COLOR_BURN,EWe],[Pi.COLOR_DODGE,TWe],[Pi.DARKEN,MWe],[Pi.DIFFERENCE,CWe],[Pi.DIVIDE,AWe],[Pi.DST,null],[Pi.EXCLUSION,PWe],[Pi.HARD_LIGHT,RWe],[Pi.HARD_MIX,IWe],[Pi.HUE,kWe],[Pi.INVERT,NWe],[Pi.INVERT_RGB,DWe],[Pi.LIGHTEN,OWe],[Pi.LINEAR_BURN,FWe],[Pi.LINEAR_DODGE,LWe],[Pi.LINEAR_LIGHT,UWe],[Pi.LUMINOSITY,BWe],[Pi.MULTIPLY,zWe],[Pi.NEGATION,VWe],[Pi.NORMAL,GWe],[Pi.OVERLAY,HWe],[Pi.PIN_LIGHT,jWe],[Pi.REFLECT,WWe],[Pi.SATURATION,$We],[Pi.SCREEN,qWe],[Pi.SOFT_LIGHT,XWe],[Pi.SRC,YWe],[Pi.SUBTRACT,KWe],[Pi.VIVID_LIGHT,ZWe]]),JWe=class extends Oc{constructor(s,e=1){super(),this._blendFunction=s,this.opacity=new ms(e)}getOpacity(){return this.opacity.value}setOpacity(s){this.opacity.value=s}get blendFunction(){return this._blendFunction}set blendFunction(s){this._blendFunction=s,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(s){this.blendFunction=s}getShaderCode(){return QWe.get(this.blendFunction)}},d$=class extends Oc{constructor(s,e,{attributes:t=Tv.NONE,blendFunction:n=Pi.NORMAL,defines:r=new Map,uniforms:i=new Map,extensions:o=null,vertexShader:l=null}={}){super(),this.name=s,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=l,this.defines=r,this.uniforms=i,this.extensions=o,this.blendMode=new JWe(n),this.blendMode.addEventListener("change",h=>this.setChanged()),this._inputColorSpace=kc,this._outputColorSpace=bf}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(s){this._inputColorSpace=s,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(s){this._outputColorSpace=s,this.setChanged()}set mainScene(s){}set mainCamera(s){}getName(){return this.name}setRenderer(s){this.renderer=s}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(s){this.attributes=s,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(s){this.fragmentShader=s,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(s){this.vertexShader=s,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(s,e=HE){}update(s,e,t){}setSize(s,e){}initialize(s,e,t){}dispose(){for(const s of Object.keys(this)){const e=this[s];(e instanceof J0||e instanceof Fc||e instanceof Wo||e instanceof qh)&&this[s].dispose()}}},f$={MEDIUM:2,LARGE:3},e$e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,t$e="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",n$e=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],r$e=class extends $o{constructor(s=new Ti){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new ms(null),texelSize:new ms(new Ti),scale:new ms(1),kernel:new ms(0)},blending:Gl,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:e$e,vertexShader:t$e}),this.setTexelSize(s.x,s.y),this.kernelSize=f$.MEDIUM}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.inputBuffer=s}get kernelSequence(){return n$e[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(s){this.uniforms.scale.value=s}getScale(){return this.uniforms.scale.value}setScale(s){this.uniforms.scale.value=s}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(s){this.uniforms.kernel.value=s}setKernel(s){this.kernel=s}setTexelSize(s,e){this.uniforms.texelSize.value.set(s,e,s*.5,e*.5)}setSize(s,e){const t=1/s,n=1/e;this.uniforms.texelSize.value.set(t,n,t*.5,n*.5)}},i$e=class extends qh{constructor({kernelSize:s=f$.MEDIUM,resolutionScale:e=.5,width:t=a1.AUTO_SIZE,height:n=a1.AUTO_SIZE,resolutionX:r=t,resolutionY:i=n}={}){super("KawaseBlurPass"),this.renderTargetA=new J0(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new a1(this,r,i,e);o.addEventListener("change",l=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new r$e,this._blurMaterial.kernelSize=s,this.copyMaterial=new h$}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(s){this._blurMaterial=s}get dithering(){return this.copyMaterial.dithering}set dithering(s){this.copyMaterial.dithering=s}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(s){this.blurMaterial.kernelSize=s}get width(){return this.resolution.width}set width(s){this.resolution.preferredWidth=s}get height(){return this.resolution.height}set height(s){this.resolution.preferredHeight=s}get scale(){return this.blurMaterial.scale}set scale(s){this.blurMaterial.scale=s}getScale(){return this.blurMaterial.scale}setScale(s){this.blurMaterial.scale=s}getKernelSize(){return this.kernelSize}setKernelSize(s){this.kernelSize=s}getResolutionScale(){return this.resolution.scale}setResolutionScale(s){this.resolution.scale=s}render(s,e,t,n,r){const i=this.scene,o=this.camera,l=this.renderTargetA,h=this.renderTargetB,p=this.blurMaterial,y=p.kernelSequence;let x=e;this.fullscreenMaterial=p;for(let S=0,A=y.length;S<A;++S){const k=(S&1)===0?l:h;p.kernel=y[S],p.inputBuffer=x.texture,s.setRenderTarget(k),s.render(i,o),x=k}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=x.texture,s.setRenderTarget(this.renderToScreen?null:t),s.render(i,o)}setSize(s,e){const t=this.resolution;t.setBaseSize(s,e);const n=t.width,r=t.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(s,e)}initialize(s,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==jo?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):s!==null&&s.outputColorSpace===ei&&(this.renderTargetA.texture.colorSpace=ei,this.renderTargetB.texture.colorSpace=ei))}static get AUTO_SIZE(){return a1.AUTO_SIZE}},s$e=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,a$e=class extends $o{constructor(s=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:GE.replace(/\D+/g,"")},uniforms:{inputBuffer:new ms(null),threshold:new ms(0),smoothing:new ms(1),range:new ms(null)},blending:Gl,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:s$e,vertexShader:n8e}),this.colorOutput=s,this.luminanceRange=e}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.uniforms.inputBuffer.value=s}get threshold(){return this.uniforms.threshold.value}set threshold(s){this.smoothing>0||s>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=s}getThreshold(){return this.threshold}setThreshold(s){this.threshold=s}get smoothing(){return this.uniforms.smoothing.value}set smoothing(s){this.threshold>0||s>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=s}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(s){this.smoothing=s}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(s){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(s){s?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(s){return this.colorOutput}setColorOutputEnabled(s){this.colorOutput=s}get useRange(){return this.luminanceRange!==null}set useRange(s){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(s){s!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=s,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(s){this.luminanceRange=s}},o$e=class extends qh{constructor({renderTarget:s,luminanceRange:e,colorOutput:t,resolutionScale:n=1,width:r=a1.AUTO_SIZE,height:i=a1.AUTO_SIZE,resolutionX:o=r,resolutionY:l=i}={}){super("LuminancePass"),this.fullscreenMaterial=new a$e(t,e),this.needsSwap=!1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new J0(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const h=this.resolution=new a1(this,o,l,n);h.addEventListener("change",p=>this.setSize(h.baseWidth,h.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(s,e,t,n,r){const i=this.fullscreenMaterial;i.inputBuffer=e.texture,s.setRenderTarget(this.renderToScreen?null:this.renderTarget),s.render(this.scene,this.camera)}setSize(s,e){const t=this.resolution;t.setBaseSize(s,e),this.renderTarget.setSize(t.width,t.height)}initialize(s,e,t){t!==void 0&&t!==jo&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},l$e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,u$e="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",c$e=class extends $o{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new ms(null),texelSize:new ms(new zn)},blending:Gl,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:l$e,vertexShader:u$e})}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setSize(s,e){this.uniforms.texelSize.value.set(1/s,1/e)}},h$e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,d$e="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",f$e=class extends $o{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new ms(null),supportBuffer:new ms(null),texelSize:new ms(new zn),radius:new ms(.85)},blending:Gl,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:h$e,vertexShader:d$e})}set inputBuffer(s){this.uniforms.inputBuffer.value=s}set supportBuffer(s){this.uniforms.supportBuffer.value=s}get radius(){return this.uniforms.radius.value}set radius(s){this.uniforms.radius.value=s}setSize(s,e){this.uniforms.texelSize.value.set(1/s,1/e)}},p$e=class extends qh{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new J0(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new c$e,this.upsamplingMaterial=new f$e,this.resolution=new zn}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(s){if(this.levels!==s){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<s;++t){const n=e.clone();n.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(n)}this.upsamplingMipmaps.push(e);for(let t=1,n=s-1;t<n;++t){const r=e.clone();r.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(r)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(s){this.upsamplingMaterial.radius=s}render(s,e,t,n,r){const{scene:i,camera:o}=this,{downsamplingMaterial:l,upsamplingMaterial:h}=this,{downsamplingMipmaps:p,upsamplingMipmaps:y}=this;let x=e;this.fullscreenMaterial=l;for(let S=0,A=p.length;S<A;++S){const k=p[S];l.setSize(x.width,x.height),l.inputBuffer=x.texture,s.setRenderTarget(k),s.render(i,o),x=k}this.fullscreenMaterial=h;for(let S=y.length-1;S>=0;--S){const A=y[S];h.setSize(x.width,x.height),h.inputBuffer=x.texture,h.supportBuffer=p[S].texture,s.setRenderTarget(A),s.render(i,o),x=A}}setSize(s,e){const t=this.resolution;t.set(s,e);let n=t.width,r=t.height;for(let i=0,o=this.downsamplingMipmaps.length;i<o;++i)n=Math.round(n*.5),r=Math.round(r*.5),this.downsamplingMipmaps[i].setSize(n,r),i<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[i].setSize(n,r)}initialize(s,e,t){if(t!==void 0){const n=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const r of n)r.texture.type=t;if(t!==jo)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(s!==null&&s.outputColorSpace===ei)for(const r of n)r.texture.colorSpace=ei}}dispose(){super.dispose();for(const s of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))s.dispose()}},m$e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,g$e=class extends d${constructor({blendFunction:s=Pi.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:n=!0,intensity:r=1,radius:i=.85,levels:o=8,kernelSize:l=f$.LARGE,resolutionScale:h=.5,width:p=a1.AUTO_SIZE,height:y=a1.AUTO_SIZE,resolutionX:x=p,resolutionY:S=y}={}){super("BloomEffect",m$e,{blendFunction:s,uniforms:new Map([["map",new ms(null)],["intensity",new ms(r)]])}),this.renderTarget=new J0(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new i$e({kernelSize:l}),this.luminancePass=new o$e({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new p$e,this.mipmapBlurPass.enabled=n,this.mipmapBlurPass.radius=i,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=n?this.mipmapBlurPass.texture:this.renderTarget.texture;const A=this.resolution=new a1(this,x,S,h);A.addEventListener("change",k=>this.setSize(A.baseWidth,A.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(s){this.resolution.preferredWidth=s}get height(){return this.resolution.height}set height(s){this.resolution.preferredHeight=s}get dithering(){return this.blurPass.dithering}set dithering(s){this.blurPass.dithering=s}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(s){this.blurPass.kernelSize=s}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(s){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(s){this.uniforms.get("intensity").value=s}getIntensity(){return this.intensity}setIntensity(s){this.intensity=s}getResolutionScale(){return this.resolution.scale}setResolutionScale(s){this.resolution.scale=s}update(s,e,t){const n=this.renderTarget,r=this.luminancePass;r.enabled?(r.render(s,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(s,r.renderTarget):this.blurPass.render(s,r.renderTarget,n)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(s,e):this.blurPass.render(s,e,n)}setSize(s,e){const t=this.resolution;t.setBaseSize(s,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(s,e),this.mipmapBlurPass.setSize(s,e)}initialize(s,e,t){this.blurPass.initialize(s,e,t),this.luminancePass.initialize(s,e,t),this.mipmapBlurPass.initialize(s,e,t),t!==void 0&&(this.renderTarget.texture.type=t,s!==null&&s.outputColorSpace===ei&&(this.renderTarget.texture.colorSpace=ei))}},v$e=class extends qh{constructor(s,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=s,this.input=e}setInput(s){this.input=s}render(s,e,t,n,r){const i=this.fullscreenMaterial.uniforms;e!==null&&i!==void 0&&i[this.input]!==void 0&&(i[this.input].value=e.texture),s.setRenderTarget(this.renderToScreen?null:t),s.render(this.scene,this.camera)}initialize(s,e,t){t!==void 0&&t!==jo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},y$e=`#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))
#define ONE_OVER_TWELVE 0.08333333333333333
varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;vec4 fxaa(const in vec4 inputColor,const in vec2 uv){float lumaCenter=luminance(inputColor.rgb);float lumaDown=luminance(texture2D(inputBuffer,vUvDown).rgb);float lumaUp=luminance(texture2D(inputBuffer,vUvUp).rgb);float lumaLeft=luminance(texture2D(inputBuffer,vUvLeft).rgb);float lumaRight=luminance(texture2D(inputBuffer,vUvRight).rgb);float lumaMin=min(lumaCenter,min(min(lumaDown,lumaUp),min(lumaLeft,lumaRight)));float lumaMax=max(lumaCenter,max(max(lumaDown,lumaUp),max(lumaLeft,lumaRight)));float lumaRange=lumaMax-lumaMin;if(lumaRange<max(EDGE_THRESHOLD_MIN,lumaMax*EDGE_THRESHOLD_MAX)){return inputColor;}float lumaDownLeft=luminance(texture2D(inputBuffer,vUvDownLeft).rgb);float lumaUpRight=luminance(texture2D(inputBuffer,vUvUpRight).rgb);float lumaUpLeft=luminance(texture2D(inputBuffer,vUvUpLeft).rgb);float lumaDownRight=luminance(texture2D(inputBuffer,vUvDownRight).rgb);float lumaDownUp=lumaDown+lumaUp;float lumaLeftRight=lumaLeft+lumaRight;float lumaLeftCorners=lumaDownLeft+lumaUpLeft;float lumaDownCorners=lumaDownLeft+lumaDownRight;float lumaRightCorners=lumaDownRight+lumaUpRight;float lumaUpCorners=lumaUpRight+lumaUpLeft;float edgeHorizontal=(abs(-2.0*lumaLeft+lumaLeftCorners)+abs(-2.0*lumaCenter+lumaDownUp)*2.0+abs(-2.0*lumaRight+lumaRightCorners));float edgeVertical=(abs(-2.0*lumaUp+lumaUpCorners)+abs(-2.0*lumaCenter+lumaLeftRight)*2.0+abs(-2.0*lumaDown+lumaDownCorners));bool isHorizontal=(edgeHorizontal>=edgeVertical);float stepLength=isHorizontal?texelSize.y:texelSize.x;float luma1=isHorizontal?lumaDown:lumaLeft;float luma2=isHorizontal?lumaUp:lumaRight;float gradient1=abs(luma1-lumaCenter);float gradient2=abs(luma2-lumaCenter);bool is1Steepest=gradient1>=gradient2;float gradientScaled=0.25*max(gradient1,gradient2);float lumaLocalAverage=0.0;if(is1Steepest){stepLength=-stepLength;lumaLocalAverage=0.5*(luma1+lumaCenter);}else{lumaLocalAverage=0.5*(luma2+lumaCenter);}vec2 currentUv=uv;if(isHorizontal){currentUv.y+=stepLength*0.5;}else{currentUv.x+=stepLength*0.5;}vec2 offset=isHorizontal?vec2(texelSize.x,0.0):vec2(0.0,texelSize.y);vec2 uv1=currentUv-offset*QUALITY(0);vec2 uv2=currentUv+offset*QUALITY(0);float lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);float lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd1-=lumaLocalAverage;lumaEnd2-=lumaLocalAverage;bool reached1=abs(lumaEnd1)>=gradientScaled;bool reached2=abs(lumaEnd2)>=gradientScaled;bool reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(1);}if(!reached2){uv2+=offset*QUALITY(1);}if(!reachedBoth){for(int i=2;i<SAMPLES;++i){if(!reached1){lumaEnd1=luminance(texture2D(inputBuffer,uv1).rgb);lumaEnd1=lumaEnd1-lumaLocalAverage;}if(!reached2){lumaEnd2=luminance(texture2D(inputBuffer,uv2).rgb);lumaEnd2=lumaEnd2-lumaLocalAverage;}reached1=abs(lumaEnd1)>=gradientScaled;reached2=abs(lumaEnd2)>=gradientScaled;reachedBoth=reached1&&reached2;if(!reached1){uv1-=offset*QUALITY(i);}if(!reached2){uv2+=offset*QUALITY(i);}if(reachedBoth){break;}}}float distance1=isHorizontal?(uv.x-uv1.x):(uv.y-uv1.y);float distance2=isHorizontal?(uv2.x-uv.x):(uv2.y-uv.y);bool isDirection1=distance1<distance2;float distanceFinal=min(distance1,distance2);float edgeThickness=(distance1+distance2);bool isLumaCenterSmaller=lumaCenter<lumaLocalAverage;bool correctVariation1=(lumaEnd1<0.0)!=isLumaCenterSmaller;bool correctVariation2=(lumaEnd2<0.0)!=isLumaCenterSmaller;bool correctVariation=isDirection1?correctVariation1:correctVariation2;float pixelOffset=-distanceFinal/edgeThickness+0.5;float finalOffset=correctVariation?pixelOffset:0.0;float lumaAverage=ONE_OVER_TWELVE*(2.0*(lumaDownUp+lumaLeftRight)+lumaLeftCorners+lumaRightCorners);float subPixelOffset1=clamp(abs(lumaAverage-lumaCenter)/lumaRange,0.0,1.0);float subPixelOffset2=(-2.0*subPixelOffset1+3.0)*subPixelOffset1*subPixelOffset1;float subPixelOffsetFinal=subPixelOffset2*subPixelOffset2*SUBPIXEL_QUALITY;finalOffset=max(finalOffset,subPixelOffsetFinal);vec2 finalUv=uv;if(isHorizontal){finalUv.y+=finalOffset*stepLength;}else{finalUv.x+=finalOffset*stepLength;}return texture2D(inputBuffer,finalUv);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=fxaa(inputColor,uv);}`,_$e="varying vec2 vUvDown;varying vec2 vUvUp;varying vec2 vUvLeft;varying vec2 vUvRight;varying vec2 vUvDownLeft;varying vec2 vUvUpRight;varying vec2 vUvUpLeft;varying vec2 vUvDownRight;void mainSupport(const in vec2 uv){vUvDown=uv+vec2(0.0,-1.0)*texelSize;vUvUp=uv+vec2(0.0,1.0)*texelSize;vUvRight=uv+vec2(1.0,0.0)*texelSize;vUvLeft=uv+vec2(-1.0,0.0)*texelSize;vUvDownLeft=uv+vec2(-1.0,-1.0)*texelSize;vUvUpRight=uv+vec2(1.0,1.0)*texelSize;vUvUpLeft=uv+vec2(-1.0,1.0)*texelSize;vUvDownRight=uv+vec2(1.0,-1.0)*texelSize;}",x$e=class extends d${constructor({blendFunction:s=Pi.SRC}={}){super("FXAAEffect",y$e,{vertexShader:_$e,blendFunction:s,defines:new Map([["EDGE_THRESHOLD_MIN","0.0312"],["EDGE_THRESHOLD_MAX","0.125"],["SUBPIXEL_QUALITY","0.75"],["SAMPLES","12"]])})}get minEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MIN"))}set minEdgeThreshold(s){this.defines.set("EDGE_THRESHOLD_MIN",s.toFixed(12)),this.setChanged()}get maxEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MAX"))}set maxEdgeThreshold(s){this.defines.set("EDGE_THRESHOLD_MAX",s.toFixed(12)),this.setChanged()}get subpixelQuality(){return Number(this.defines.get("SUBPIXEL_QUALITY"))}set subpixelQuality(s){this.defines.set("SUBPIXEL_QUALITY",s.toFixed(12)),this.setChanged()}get samples(){return Number(this.defines.get("SAMPLES"))}set samples(s){this.defines.set("SAMPLES",s.toFixed(0)),this.setChanged()}},b$e=class extends qh{constructor(s,e,t=null){super("RenderPass",s,e),this.needsSwap=!1,this.clearPass=new r8e,this.overrideMaterialManager=t===null?null:new s9e(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(s){this.scene=s}set mainCamera(s){this.camera=s}get renderToScreen(){return super.renderToScreen}set renderToScreen(s){super.renderToScreen=s,this.clearPass.renderToScreen=s}get overrideMaterial(){const s=this.overrideMaterialManager;return s!==null?s.material:null}set overrideMaterial(s){const e=this.overrideMaterialManager;s!==null?e!==null?e.setMaterial(s):this.overrideMaterialManager=new s9e(s):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(s){this.overrideMaterial=s}get clear(){return this.clearPass.enabled}set clear(s){this.clearPass.enabled=s}getSelection(){return this.selection}setSelection(s){this.selection=s}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(s){this.ignoreBackground=s}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(s){this.skipShadowMapUpdate=s}getClearPass(){return this.clearPass}render(s,e,t,n,r){const i=this.scene,o=this.camera,l=this.selection,h=o.layers.mask,p=i.background,y=s.shadowMap.autoUpdate,x=this.renderToScreen?null:e;l!==null&&o.layers.set(l.getLayer()),this.skipShadowMapUpdate&&(s.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(i.background=null),this.clearPass.enabled&&this.clearPass.render(s,e),s.setRenderTarget(x),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(s,i,o):s.render(i,o),o.layers.mask=h,i.background=p,s.shadowMap.autoUpdate=y}},qw={DEFAULT:0,ESKIL:1},S$e=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,w$e=class extends d${constructor({blendFunction:s,eskil:e=!1,technique:t=e?qw.ESKIL:qw.DEFAULT,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",S$e,{blendFunction:s,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new ms(n)],["darkness",new ms(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(s){this.technique!==s&&(this.defines.set("VIGNETTE_TECHNIQUE",s.toFixed(0)),this.setChanged())}get eskil(){return this.technique===qw.ESKIL}set eskil(s){this.technique=s?qw.ESKIL:qw.DEFAULT}getTechnique(){return this.technique}setTechnique(s){this.technique=s}get offset(){return this.uniforms.get("offset").value}set offset(s){this.uniforms.get("offset").value=s}getOffset(){return this.offset}setOffset(s){this.offset=s}get darkness(){return this.uniforms.get("darkness").value}set darkness(s){this.uniforms.get("darkness").value=s}getDarkness(){return this.darkness}setDarkness(s){this.darkness=s}},E$e=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,T$e="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",M$e=class extends $o{constructor(s,e,t,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:GE.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new ms(null),depthBuffer:new ms(null),resolution:new ms(new zn),texelSize:new ms(new zn),cameraNear:new ms(.3),cameraFar:new ms(1e3),aspect:new ms(1),time:new ms(0)},blending:Gl,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),s&&this.setShaderParts(s),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(s){this.uniforms.inputBuffer.value=s}setInputBuffer(s){this.uniforms.inputBuffer.value=s}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(s){this.uniforms.depthBuffer.value=s}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(s){this.defines.DEPTH_PACKING=s.toFixed(0),this.needsUpdate=!0}setDepthBuffer(s,e=HE){this.depthBuffer=s,this.depthPacking=e}setShaderData(s){this.setShaderParts(s.shaderParts),this.setDefines(s.defines),this.setUniforms(s.uniforms),this.setExtensions(s.extensions)}setShaderParts(s){return this.fragmentShader=E$e.replace(Xi.FRAGMENT_HEAD,s.get(Xi.FRAGMENT_HEAD)||"").replace(Xi.FRAGMENT_MAIN_UV,s.get(Xi.FRAGMENT_MAIN_UV)||"").replace(Xi.FRAGMENT_MAIN_IMAGE,s.get(Xi.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=T$e.replace(Xi.VERTEX_HEAD,s.get(Xi.VERTEX_HEAD)||"").replace(Xi.VERTEX_MAIN_SUPPORT,s.get(Xi.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(s){for(const e of s.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(s){for(const e of s.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(s){this.extensions={};for(const e of s)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(s){this.encodeOutput!==s&&(s?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(s){return this.encodeOutput}setOutputEncodingEnabled(s){this.encodeOutput=s}get time(){return this.uniforms.time.value}set time(s){this.uniforms.time.value=s}setDeltaTime(s){this.uniforms.time.value+=s}adoptCameraSettings(s){this.copyCameraSettings(s)}copyCameraSettings(s){s&&(this.uniforms.cameraNear.value=s.near,this.uniforms.cameraFar.value=s.far,s instanceof Go?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(s,e){const t=this.uniforms;t.resolution.value.set(s,e),t.texelSize.value.set(1/s,1/e),t.aspect.value=s/e}static get Section(){return Xi}};function a9e(s,e,t){for(const n of e){const r="$1"+s+n.charAt(0).toUpperCase()+n.slice(1),i=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const o of t.entries())o[1]!==null&&t.set(o[0],o[1].replace(i,r))}}function C$e(s,e,t){let n=e.getFragmentShader(),r=e.getVertexShader();const i=n!==void 0&&/mainImage/.test(n),o=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&(t.attributes&Tv.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!i&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const l=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,h=t.shaderParts;let p=h.get(Xi.FRAGMENT_HEAD)||"",y=h.get(Xi.FRAGMENT_MAIN_UV)||"",x=h.get(Xi.FRAGMENT_MAIN_IMAGE)||"",S=h.get(Xi.VERTEX_HEAD)||"",A=h.get(Xi.VERTEX_MAIN_SUPPORT)||"";const k=new Set,L=new Set;if(o&&(y+=`	${s}MainUv(UV);
`,t.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const $=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);A+=`	${s}MainSupport(`,A+=$?`vUv);
`:`);
`;for(const Z of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const I of Z[1].split(/\s*,\s*/))t.varyings.add(I),k.add(I),L.add(I);for(const Z of r.matchAll(l))L.add(Z[1])}for(const $ of n.matchAll(l))L.add($[1]);for(const $ of e.defines.keys())L.add($.replace(/\([\w\s,]*\)/g,""));for(const $ of e.uniforms.keys())L.add($);L.delete("while"),L.delete("for"),L.delete("if"),e.uniforms.forEach(($,Z)=>t.uniforms.set(s+Z.charAt(0).toUpperCase()+Z.slice(1),$)),e.defines.forEach(($,Z)=>t.defines.set(s+Z.charAt(0).toUpperCase()+Z.slice(1),$));const U=new Map([["fragment",n],["vertex",r]]);a9e(s,L,t.defines),a9e(s,L,U),n=U.get("fragment"),r=U.get("vertex");const P=e.blendMode;if(t.blendModes.set(P.blendFunction,P),i){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(x+=e.inputColorSpace===ei?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==bf?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const $=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;x+=`${s}MainImage(color0, UV, `,(t.attributes&Tv.DEPTH)!==0&&$.test(n)&&(x+="depth, ",t.readDepth=!0),x+=`color1);
	`;const Z=s+"BlendOpacity";t.uniforms.set(Z,P.opacity),x+=`color0 = blend${P.blendFunction}(color0, color1, ${Z});

	`,p+=`uniform float ${Z};

`}if(p+=n+`
`,r!==null&&(S+=r+`
`),h.set(Xi.FRAGMENT_HEAD,p),h.set(Xi.FRAGMENT_MAIN_UV,y),h.set(Xi.FRAGMENT_MAIN_IMAGE,x),h.set(Xi.VERTEX_HEAD,S),h.set(Xi.VERTEX_MAIN_SUPPORT,A),e.extensions!==null)for(const $ of e.extensions)t.extensions.add($)}}var A$e=class extends qh{constructor(s,...e){super("EffectPass"),this.fullscreenMaterial=new M$e(null,null,null,s),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(s){for(const e of this.effects)e.mainScene=s}set mainCamera(s){this.fullscreenMaterial.copyCameraSettings(s);for(const e of this.effects)e.mainCamera=s}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(s){this.fullscreenMaterial.encodeOutput=s}get dithering(){return this.fullscreenMaterial.dithering}set dithering(s){const e=this.fullscreenMaterial;e.dithering=s,e.needsUpdate=!0}setEffects(s){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=s.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const s=new _We;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===Pi.DST)s.attributes|=o.getAttributes()&Tv.DEPTH;else{if((s.attributes&o.getAttributes()&Tv.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${o.name})`);C$e("e"+e++,o,s)}let t=s.shaderParts.get(Xi.FRAGMENT_HEAD),n=s.shaderParts.get(Xi.FRAGMENT_MAIN_IMAGE),r=s.shaderParts.get(Xi.FRAGMENT_MAIN_UV);const i=/\bblend\b/g;for(const o of s.blendModes.values())t+=o.getShaderCode().replace(i,`blend${o.blendFunction}`)+`
`;(s.attributes&Tv.DEPTH)!==0?(s.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,s.colorSpace===ei&&(n+=`color0 = sRGBToLinear(color0);
	`),s.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,s.defines.set("UV","transformedUv")):s.defines.set("UV","vUv"),s.shaderParts.set(Xi.FRAGMENT_HEAD,t),s.shaderParts.set(Xi.FRAGMENT_MAIN_IMAGE,n),s.shaderParts.set(Xi.FRAGMENT_MAIN_UV,r);for(const[o,l]of s.shaderParts)l!==null&&s.shaderParts.set(o,l.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(s)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(s,e=HE){this.fullscreenMaterial.depthBuffer=s,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(s,e)}render(s,e,t,n,r){for(const i of this.effects)i.update(s,e,n);if(!this.skipRendering||this.renderToScreen){const i=this.fullscreenMaterial;i.inputBuffer=e.texture,i.time+=n*this.timeScale,s.setRenderTarget(this.renderToScreen?null:t),s.render(this.scene,this.camera)}}setSize(s,e){this.fullscreenMaterial.setSize(s,e);for(const t of this.effects)t.setSize(s,e)}initialize(s,e,t){this.renderer=s;for(const n of this.effects)n.initialize(s,e,t);this.updateMaterial(),t!==void 0&&t!==jo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const s of this.effects)s.removeEventListener("change",this.listener),s.dispose()}handleEvent(s){switch(s.type){case"change":this.recompile();break}}};const P$e=`varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,R$e=`struct Light {
  float intensity;
  vec3 position;
  vec3 color;
};

uniform float time;
uniform float opacity;
uniform vec2 resolution;
uniform vec3 diffuse;
uniform vec3 mouse;
uniform sampler2D map;
uniform Light light;
uniform Light lights[3];
varying vec2 vUv;

#define MIN_ALPHA 2.0 / 255.0

void main() {
  if (opacity < MIN_ALPHA) discard;
  vec2 imageUV = vUv * 10.0;
  vec3 image = texture2D(map, imageUV).rgb;
  vec3 col = image * diffuse;
  col += (sin(time * 0.1) * 0.5 + 0.5) * 0.2;
  col += vec3(resolution, 0.0);
  col += mouse;
  gl_FragColor = vec4(col, opacity);
}`,I$e="data:image/png;base64,R0lGODlhCAAIAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OTc3NywgMjAyMy8wNi8yNS0yMzo1NzoxNCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjVENjQyODM4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjVENjQyODQ4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2NUQ2NDI4MThBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2NUQ2NDI4MjhBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAAAAAAALAAAAAAIAAgAAAIOjH8AprzRkHyspqSoNAUAOw==";class i8e extends $o{constructor(){super({vertexShader:P$e,fragmentShader:R$e,name:"ExampleScene/SimpleShader",transparent:!0,uniforms:{diffuse:{value:new Vn(16777215)},opacity:{value:1},time:{value:0},map:{value:null},resolution:{value:new zn},mouse:{value:new ke},v4:{value:new Ti},euler:{value:new so},testM3:{value:new ci},testM4:{value:new yr},light:{value:{position:new zn(5,10),intensity:1,color:new Vn(16711935)}},lights:{value:[{position:new zn(1,1),intensity:1,color:new Vn(16711680)},{position:new zn(2,2),intensity:2,color:new Vn(65280)},{position:new zn(3,3),intensity:3,color:new Vn(255)}]}}}),lW(I$e).then(e=>{this.uniforms.map.value=e})}update(e){this.uniforms.opacity.value=this.opacity,this.uniforms.time.value+=e}}function k$e(s){const e=new Map,t=new Map,n=s.clone();return s8e(s,n,function(r,i){e.set(i,r),t.set(r,i)}),n.traverse(function(r){if(!r.isSkinnedMesh)return;const i=r,o=e.get(r),l=o.skeleton.bones;i.skeleton=o.skeleton.clone(),i.bindMatrix.copy(o.bindMatrix),i.skeleton.bones=l.map(function(h){return t.get(h)}),i.bind(i.skeleton,i.bindMatrix)}),n}function s8e(s,e,t){t(s,e);for(let n=0;n<s.children.length;n++)s8e(s.children[n],e.children[n],t)}/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var Fh=Uint8Array,T_=Uint16Array,N$e=Int32Array,a8e=new Fh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o8e=new Fh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),D$e=new Fh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l8e=function(s,e){for(var t=new T_(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];for(var r=new N$e(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)r[i]=i-t[n]<<5|n;return{b:t,r}},u8e=l8e(a8e,2),c8e=u8e.b,O$e=u8e.r;c8e[28]=258,O$e[258]=28;var F$e=l8e(o8e,0),L$e=F$e.b,xj=new T_(32768);for(var na=0;na<32768;++na){var V3=(na&43690)>>1|(na&21845)<<1;V3=(V3&52428)>>2|(V3&13107)<<2,V3=(V3&61680)>>4|(V3&3855)<<4,xj[na]=((V3&65280)>>8|(V3&255)<<8)>>1}var xE=function(s,e,t){for(var n=s.length,r=0,i=new T_(e);r<n;++r)s[r]&&++i[s[r]-1];var o=new T_(e);for(r=1;r<e;++r)o[r]=o[r-1]+i[r-1]<<1;var l;if(t){l=new T_(1<<e);var h=15-e;for(r=0;r<n;++r)if(s[r])for(var p=r<<4|s[r],y=e-s[r],x=o[s[r]-1]++<<y,S=x|(1<<y)-1;x<=S;++x)l[xj[x]>>h]=p}else for(l=new T_(n),r=0;r<n;++r)s[r]&&(l[r]=xj[o[s[r]-1]++]>>15-s[r]);return l},KE=new Fh(288);for(var na=0;na<144;++na)KE[na]=8;for(var na=144;na<256;++na)KE[na]=9;for(var na=256;na<280;++na)KE[na]=7;for(var na=280;na<288;++na)KE[na]=8;var h8e=new Fh(32);for(var na=0;na<32;++na)h8e[na]=5;var U$e=xE(KE,9,1),B$e=xE(h8e,5,1),OG=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},pf=function(s,e,t){var n=e/8|0;return(s[n]|s[n+1]<<8)>>(e&7)&t},FG=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},z$e=function(s){return(s+7)/8|0},V$e=function(s,e,t){return(t==null||t>s.length)&&(t=s.length),new Fh(s.subarray(e,t))},G$e=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],yf=function(s,e,t){var n=new Error(e||G$e[s]);if(n.code=s,Error.captureStackTrace&&Error.captureStackTrace(n,yf),!t)throw n;return n},H$e=function(s,e,t,n){var r=s.length,i=0;if(!r||e.f&&!e.l)return t||new Fh(0);var o=!t,l=o||e.i!=2,h=e.i;o&&(t=new Fh(r*3));var p=function(ni){var oi=t.length;if(ni>oi){var $r=new Fh(Math.max(oi*2,ni));$r.set(t),t=$r}},y=e.f||0,x=e.p||0,S=e.b||0,A=e.l,k=e.d,L=e.m,U=e.n,P=r*8;do{if(!A){y=pf(s,x,1);var $=pf(s,x+1,3);if(x+=3,$)if($==1)A=U$e,k=B$e,L=9,U=5;else if($==2){var ce=pf(s,x,31)+257,ue=pf(s,x+10,15)+4,Q=ce+pf(s,x+5,31)+1;x+=14;for(var oe=new Fh(Q),le=new Fh(19),J=0;J<ue;++J)le[D$e[J]]=pf(s,x+J*3,7);x+=ue*3;for(var Be=OG(le),He=(1<<Be)-1,rt=xE(le,Be,1),J=0;J<Q;){var ot=rt[pf(s,x,He)];x+=ot&15;var Z=ot>>4;if(Z<16)oe[J++]=Z;else{var Se=0,gt=0;for(Z==16?(gt=3+pf(s,x,3),x+=2,Se=oe[J-1]):Z==17?(gt=3+pf(s,x,7),x+=3):Z==18&&(gt=11+pf(s,x,127),x+=7);gt--;)oe[J++]=Se}}var Ae=oe.subarray(0,ce),lt=oe.subarray(ce);L=OG(Ae),U=OG(lt),A=xE(Ae,L,1),k=xE(lt,U,1)}else yf(1);else{var Z=z$e(x)+4,I=s[Z-4]|s[Z-3]<<8,ie=Z+I;if(ie>r){h&&yf(0);break}l&&p(S+I),t.set(s.subarray(Z,ie),S),e.b=S+=I,e.p=x=ie*8,e.f=y;continue}if(x>P){h&&yf(0);break}}l&&p(S+131072);for(var pt=(1<<L)-1,De=(1<<U)-1,_t=x;;_t=x){var Se=A[FG(s,x)&pt],Jt=Se>>4;if(x+=Se&15,x>P){h&&yf(0);break}if(Se||yf(2),Jt<256)t[S++]=Jt;else if(Jt==256){_t=x,A=null;break}else{var dt=Jt-254;if(Jt>264){var J=Jt-257,Dt=a8e[J];dt=pf(s,x,(1<<Dt)-1)+c8e[J],x+=Dt}var gn=k[FG(s,x)&De],qt=gn>>4;gn||yf(3),x+=gn&15;var lt=L$e[qt];if(qt>3){var Dt=o8e[qt];lt+=FG(s,x)&(1<<Dt)-1,x+=Dt}if(x>P){h&&yf(0);break}l&&p(S+131072);var wn=S+dt;if(S<lt){var rr=i-lt,Xn=Math.min(lt,wn);for(rr+S<0&&yf(3);S<Xn;++S)t[S]=n[rr+S]}for(;S<wn;++S)t[S]=t[S-lt]}}e.l=A,e.p=_t,e.b=S,e.f=y,A&&(y=1,e.m=L,e.d=k,e.n=U)}while(!y);return S!=t.length&&o?V$e(t,0,S):t.subarray(0,S)},j$e=new Fh(0),W$e=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&yf(6,"invalid zlib data"),(s[1]>>5&1)==1&&yf(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function $$e(s,e){return H$e(s.subarray(W$e(s),-4),{i:2},e,e)}var q$e=typeof TextDecoder<"u"&&new TextDecoder,X$e=0;try{q$e.decode(j$e,{stream:!0}),X$e=1}catch{}function d8e(s,e,t){const n=t.length-s-1;if(e>=t[n])return n-1;if(e<=t[s])return s;let r=s,i=n,o=Math.floor((r+i)/2);for(;e<t[o]||e>=t[o+1];)e<t[o]?i=o:r=o,o=Math.floor((r+i)/2);return o}function Y$e(s,e,t,n){const r=[],i=[],o=[];r[0]=1;for(let l=1;l<=t;++l){i[l]=e-n[s+1-l],o[l]=n[s+l]-e;let h=0;for(let p=0;p<l;++p){const y=o[p+1],x=i[l-p],S=r[p]/(y+x);r[p]=h+y*S,h=x*S}r[l]=h}return r}function K$e(s,e,t,n){const r=d8e(s,n,e),i=Y$e(r,n,s,e),o=new Ti(0,0,0,0);for(let l=0;l<=s;++l){const h=t[r-s+l],p=i[l],y=h.w*p;o.x+=h.x*y,o.y+=h.y*y,o.z+=h.z*y,o.w+=h.w*p}return o}function Z$e(s,e,t,n,r){const i=[];for(let x=0;x<=t;++x)i[x]=0;const o=[];for(let x=0;x<=n;++x)o[x]=i.slice(0);const l=[];for(let x=0;x<=t;++x)l[x]=i.slice(0);l[0][0]=1;const h=i.slice(0),p=i.slice(0);for(let x=1;x<=t;++x){h[x]=e-r[s+1-x],p[x]=r[s+x]-e;let S=0;for(let A=0;A<x;++A){const k=p[A+1],L=h[x-A];l[x][A]=k+L;const U=l[A][x-1]/l[x][A];l[A][x]=S+k*U,S=L*U}l[x][x]=S}for(let x=0;x<=t;++x)o[0][x]=l[x][t];for(let x=0;x<=t;++x){let S=0,A=1;const k=[];for(let L=0;L<=t;++L)k[L]=i.slice(0);k[0][0]=1;for(let L=1;L<=n;++L){let U=0;const P=x-L,$=t-L;x>=L&&(k[A][0]=k[S][0]/l[$+1][P],U=k[A][0]*l[P][$]);const Z=P>=-1?1:-P,I=x-1<=$?L-1:t-x;for(let ce=Z;ce<=I;++ce)k[A][ce]=(k[S][ce]-k[S][ce-1])/l[$+1][P+ce],U+=k[A][ce]*l[P+ce][$];x<=$&&(k[A][L]=-k[S][L-1]/l[$+1][x],U+=k[A][L]*l[x][$]),o[L][x]=U;const ie=S;S=A,A=ie}}let y=t;for(let x=1;x<=n;++x){for(let S=0;S<=t;++S)o[x][S]*=y;y*=t-x}return o}function Q$e(s,e,t,n,r){const i=r<s?r:s,o=[],l=d8e(s,n,e),h=Z$e(l,n,s,i,e),p=[];for(let y=0;y<t.length;++y){const x=t[y].clone(),S=x.w;x.x*=S,x.y*=S,x.z*=S,p[y]=x}for(let y=0;y<=i;++y){const x=p[l-s].clone().multiplyScalar(h[y][0]);for(let S=1;S<=s;++S)x.add(p[l-s+S].clone().multiplyScalar(h[y][S]));o[y]=x}for(let y=i+1;y<=r+1;++y)o[y]=new Ti(0,0,0);return o}function J$e(s,e){let t=1;for(let r=2;r<=s;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=s-e;++r)n*=r;return t/n}function eqe(s){const e=s.length,t=[],n=[];for(let i=0;i<e;++i){const o=s[i];t[i]=new ke(o.x,o.y,o.z),n[i]=o.w}const r=[];for(let i=0;i<e;++i){const o=t[i].clone();for(let l=1;l<=i;++l)o.sub(r[i-l].clone().multiplyScalar(J$e(i,l)*n[l]));r[i]=o.divideScalar(n[0])}return r}function tqe(s,e,t,n,r){const i=Q$e(s,e,t,n,r);return eqe(i)}class nqe extends Z9e{constructor(e,t,n,r,i){super();const o=t?t.length-1:0,l=n?n.length:0;this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||o;for(let h=0;h<l;++h){const p=n[h];this.controlPoints[h]=new Ti(p.x,p.y,p.z,p.w)}}getPoint(e,t=new ke){const n=t,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=K$e(this.degree,this.knots,this.controlPoints,r);return i.w!==1&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}getTangent(e,t=new ke){const n=t,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=tqe(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}toJSON(){const e=super.toJSON();return e.degree=this.degree,e.knots=[...this.knots],e.controlPoints=this.controlPoints.map(t=>t.toArray()),e.startKnot=this.startKnot,e.endKnot=this.endKnot,e}fromJSON(e){return super.fromJSON(e),this.degree=e.degree,this.knots=[...e.knots],this.controlPoints=e.controlPoints.map(t=>new Ti(t[0],t[1],t[2],t[3])),this.startKnot=e.startKnot,this.endKnot=e.endKnot,this}}let yi,ja,Ll;class rqe extends n4{constructor(e){super(e)}load(e,t,n,r){const i=this,o=i.path===""?xCe.extractUrlBase(e):i.path,l=new dCe(this.manager);l.setPath(i.path),l.setResponseType("arraybuffer"),l.setRequestHeader(i.requestHeader),l.setWithCredentials(i.withCredentials),l.load(e,function(h){try{t(i.parse(h,o))}catch(p){r?r(p):console.error(p),i.manager.itemError(e)}},n,r)}parse(e,t){if(uqe(e))yi=new lqe().parse(e);else{const r=m8e(e);if(!cqe(r))throw new Error("THREE.FBXLoader: Unknown format.");if(l9e(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+l9e(r));yi=new oqe().parse(r)}const n=new h3e(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new iqe(n,this.manager).parse(yi)}}class iqe{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){ja=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),i=new sqe().parse(r);return this.parseScene(r,i,n),Ll}parseConnections(){const e=new Map;return"Connections"in yi&&yi.Connections.connections.forEach(function(n){const r=n[0],i=n[1],o=n[2];e.has(r)||e.set(r,{parents:[],children:[]});const l={ID:i,relationship:o};e.get(r).parents.push(l),e.has(i)||e.set(i,{parents:[],children:[]});const h={ID:r,relationship:o};e.get(i).children.push(h)}),e}parseImages(){const e={},t={};if("Video"in yi.Objects){const n=yi.Objects.Video;for(const r in n){const i=n[r],o=parseInt(r);if(e[o]=i.RelativeFilename||i.Filename,"Content"in i){const l=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,h=typeof i.Content=="string"&&i.Content!=="";if(l||h){const p=this.parseImage(n[r]);t[i.RelativeFilename||i.Filename]=p}}}}for(const n in e){const r=e[n];t[r]!==void 0?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let i;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),i="image/tga";break;case"webp":i="image/webp";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof t=="string")return"data:"+i+";base64,"+t;{const o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:i}))}}parseTextures(e){const t=new Map;if("Texture"in yi.Objects){const n=yi.Objects.Texture;for(const r in n){const i=this.parseTexture(n[r],e);t.set(parseInt(r),i)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,i=e.WrapModeV,o=r!==void 0?r.value:0,l=i!==void 0?i.value:0;if(n.wrapS=o===0?Fg:g0,n.wrapT=l===0?Fg:g0,"Scaling"in e){const h=e.Scaling.value;n.repeat.x=h[0],n.repeat.y=h[1]}if("Translation"in e){const h=e.Translation.value;n.offset.x=h[0],n.offset.y=h[1]}return n}loadTexture(e,t){const n=e.FileName.split(".").pop().toLowerCase();let r=this.manager.getHandler(`.${n}`);r===null&&(r=this.textureLoader);const i=r.path;i||r.setPath(this.textureLoader.path);const o=ja.get(e.id).children;let l;if(o!==void 0&&o.length>0&&t[o[0].ID]!==void 0&&(l=t[o[0].ID],(l.indexOf("blob:")===0||l.indexOf("data:")===0)&&r.setPath(void 0)),l===void 0)return console.warn("FBXLoader: Undefined filename, creating placeholder texture."),new Wo;const h=r.load(l);return r.setPath(i),h}parseMaterials(e){const t=new Map;if("Material"in yi.Objects){const n=yi.Objects.Material;for(const r in n){const i=this.parseMaterial(n[r],e);i!==null&&t.set(parseInt(r),i)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let i=e.ShadingModel;if(typeof i=="object"&&(i=i.value),!ja.has(n))return null;const o=this.parseParameters(e,t,n);let l;switch(i.toLowerCase()){case"phong":l=new g_;break;case"lambert":l=new eCe;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),l=new g_;break}return l.setValues(o),l.name=r,l}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=Yr.colorSpaceToWorking(new Vn().fromArray(e.Diffuse.value),ei):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=Yr.colorSpaceToWorking(new Vn().fromArray(e.DiffuseColor.value),ei)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=Yr.colorSpaceToWorking(new Vn().fromArray(e.Emissive.value),ei):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=Yr.colorSpaceToWorking(new Vn().fromArray(e.EmissiveColor.value),ei)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),r.opacity=1-(e.TransparencyFactor?parseFloat(e.TransparencyFactor.value):0),(r.opacity===1||r.opacity===0)&&(r.opacity=e.Opacity?parseFloat(e.Opacity.value):null,r.opacity===null&&(r.opacity=1-(e.TransparentColor?parseFloat(e.TransparentColor.value[0]):0))),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=Yr.colorSpaceToWorking(new Vn().fromArray(e.Specular.value),ei):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=Yr.colorSpaceToWorking(new Vn().fromArray(e.SpecularColor.value),ei));const i=this;return ja.get(n).children.forEach(function(o){const l=o.relationship;switch(l){case"Bump":r.bumpMap=i.getTexture(t,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(t,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(t,o.ID),r.map!==void 0&&(r.map.colorSpace=ei);break;case"DisplacementColor":r.displacementMap=i.getTexture(t,o.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(t,o.ID),r.emissiveMap!==void 0&&(r.emissiveMap.colorSpace=ei);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(t,o.ID);break;case"ReflectionColor":r.envMap=i.getTexture(t,o.ID),r.envMap!==void 0&&(r.envMap.mapping=$I,r.envMap.colorSpace=ei);break;case"SpecularColor":r.specularMap=i.getTexture(t,o.ID),r.specularMap!==void 0&&(r.specularMap.colorSpace=ei);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(t,o.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",l);break}}),r}getTexture(e,t){return"LayeredTexture"in yi.Objects&&t in yi.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=ja.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in yi.Objects){const n=yi.Objects.Deformer;for(const r in n){const i=n[r],o=ja.get(parseInt(r));if(i.attrType==="Skin"){const l=this.parseSkeleton(o,n);l.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=o.parents[0].ID,e[r]=l}else if(i.attrType==="BlendShape"){const l={id:r};l.rawTargets=this.parseMorphTargets(o,n),l.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=l}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(r){const i=t[r.ID];if(i.attrType!=="Cluster")return;const o={ID:r.ID,indices:[],weights:[],transformLink:new yr().fromArray(i.TransformLink.a)};"Indexes"in i&&(o.indices=i.Indexes.a,o.weights=i.Weights.a),n.push(o)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const i=e.children[r],o=t[i.ID],l={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if(o.attrType!=="BlendShapeChannel")return;l.geoID=ja.get(parseInt(i.ID)).children.filter(function(h){return h.relationship===void 0})[0].ID,n.push(l)}return n}parseScene(e,t,n){Ll=new _v;const r=this.parseModels(e.skeletons,t,n),i=yi.Objects.Model,o=this;r.forEach(function(h){const p=i[h.ID];o.setLookAtProperties(h,p),ja.get(h.ID).parents.forEach(function(x){const S=r.get(x.ID);S!==void 0&&S.add(h)}),h.parent===null&&Ll.add(h)}),this.bindSkeleton(e.skeletons,t,r),this.addGlobalSceneSettings(),Ll.traverse(function(h){if(h.userData.transformData){h.parent&&(h.userData.transformData.parentMatrix=h.parent.matrix,h.userData.transformData.parentMatrixWorld=h.parent.matrixWorld);const p=p8e(h.userData.transformData);h.applyMatrix4(p),h.updateWorldMatrix()}});const l=new aqe().parse();Ll.children.length===1&&Ll.children[0].isGroup&&(Ll.children[0].animations=l,Ll=Ll.children[0]),Ll.animations=l}parseModels(e,t,n){const r=new Map,i=yi.Objects.Model;for(const o in i){const l=parseInt(o),h=i[o],p=ja.get(l);let y=this.buildSkeleton(p,e,l,h.attrName);if(!y){switch(h.attrType){case"Camera":y=this.createCamera(p);break;case"Light":y=this.createLight(p);break;case"Mesh":y=this.createMesh(p,t,n);break;case"NurbsCurve":y=this.createCurve(p,t);break;case"LimbNode":case"Root":y=new AH;break;case"Null":default:y=new _v;break}y.name=h.attrName?Gi.sanitizeNodeName(h.attrName):"",y.userData.originalName=h.attrName,y.ID=l}this.getTransformData(y,h),r.set(l,y)}return r}buildSkeleton(e,t,n,r){let i=null;return e.parents.forEach(function(o){for(const l in t){const h=t[l];h.rawBones.forEach(function(p,y){if(p.ID===o.ID){const x=i;i=new AH,i.matrixWorld.copy(p.transformLink),i.name=r?Gi.sanitizeNodeName(r):"",i.userData.originalName=r,i.ID=n,h.bones[y]=i,x!==null&&i.add(x)}})}}),i}createCamera(e){let t,n;if(e.children.forEach(function(r){const i=yi.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)}),n===void 0)t=new Ri;else{let r=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(r=1);let i=1;n.NearPlane!==void 0&&(i=n.NearPlane.value/1e3);let o=1e3;n.FarPlane!==void 0&&(o=n.FarPlane.value/1e3);let l=window.innerWidth,h=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(l=n.AspectWidth.value,h=n.AspectHeight.value);const p=l/h;let y=45;n.FieldOfView!==void 0&&(y=n.FieldOfView.value);const x=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new Go(y,p,i,o),x!==null&&t.setFocalLength(x);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),t=new Ri;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new Ri;break}}return t}createLight(e){let t,n;if(e.children.forEach(function(r){const i=yi.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)}),n===void 0)t=new Ri;else{let r;n.LightType===void 0?r=0:r=n.LightType.value;let i=16777215;n.Color!==void 0&&(i=Yr.colorSpaceToWorking(new Vn().fromArray(n.Color.value),ei));let o=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(o=0);let l=0;n.FarAttenuationEnd!==void 0&&(n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?l=0:l=n.FarAttenuationEnd.value);const h=1;switch(r){case 0:t=new B1e(i,o,l,h);break;case 1:t=new rW(i,o);break;case 2:let p=Math.PI/3;n.InnerAngle!==void 0&&(p=$0.degToRad(n.InnerAngle.value));let y=0;n.OuterAngle!==void 0&&(y=$0.degToRad(n.OuterAngle.value),y=Math.max(y,1)),t=new nW(i,o,l,p,y,h);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new B1e(i,o);break}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,i=null,o=null;const l=[];if(e.children.forEach(function(h){t.has(h.ID)&&(i=t.get(h.ID)),n.has(h.ID)&&l.push(n.get(h.ID))}),l.length>1?o=l:l.length>0?o=l[0]:(o=new g_({name:n4.DEFAULT_MATERIAL_NAME,color:13421772}),l.push(o)),"color"in i.attributes&&l.forEach(function(h){h.vertexColors=!0}),i.groups.length>0){let h=!1;for(let p=0,y=i.groups.length;p<y;p++){const x=i.groups[p];(x.materialIndex<0||x.materialIndex>=l.length)&&(x.materialIndex=l.length,h=!0)}if(h){const p=new g_;l.push(p)}}return i.FBX_Deformer?(r=new qj(i,o),r.normalizeSkinWeights()):r=new Mn(i,o),r}createCurve(e,t){const n=e.children.reduce(function(i,o){return t.has(o.ID)&&(i=t.get(o.ID)),i},null),r=new Mf({name:n4.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Pu(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?n.eulerOrder=VE(t.RotationOrder.value):n.eulerOrder=VE(0),"Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&ja.get(e.ID).children.forEach(function(r){if(r.relationship==="LookAtProperty"){const i=yi.Objects.Model[r.ID];if("Lcl_Translation"in i){const o=i.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(o),Ll.add(e.target)):e.lookAt(new ke().fromArray(o))}}})}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const i in e){const o=e[i];ja.get(parseInt(o.ID)).parents.forEach(function(h){if(t.has(h.ID)){const p=h.ID;ja.get(p).parents.forEach(function(x){n.has(x.ID)&&n.get(x.ID).bind(new Xj(o.bones),r[x.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in yi.Objects){const t=yi.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach(function(i){e[i.Node]=new yr().fromArray(i.Matrix.a)}):e[r.Node]=new yr().fromArray(r.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in yi){if("AmbientColor"in yi.GlobalSettings){const e=yi.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(t!==0||n!==0||r!==0){const i=new Vn().setRGB(t,n,r,ei);Ll.add(new yCe(i,1))}}"UnitScaleFactor"in yi.GlobalSettings&&(Ll.userData.unitScaleFactor=yi.GlobalSettings.UnitScaleFactor.value)}}}class sqe{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in yi.Objects){const n=yi.Objects.Geometry;for(const r in n){const i=ja.get(parseInt(r)),o=this.parseGeometry(i,n[r],e);t.set(parseInt(r),o)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,i=[],o=e.parents.map(function(x){return yi.Objects.Model[x.ID]});if(o.length===0)return;const l=e.children.reduce(function(x,S){return r[S.ID]!==void 0&&(x=r[S.ID]),x},null);e.children.forEach(function(x){n.morphTargets[x.ID]!==void 0&&i.push(n.morphTargets[x.ID])});const h=o[0],p={};"RotationOrder"in h&&(p.eulerOrder=VE(h.RotationOrder.value)),"InheritType"in h&&(p.inheritType=parseInt(h.InheritType.value)),"GeometricTranslation"in h&&(p.translation=h.GeometricTranslation.value),"GeometricRotation"in h&&(p.rotation=h.GeometricRotation.value),"GeometricScaling"in h&&(p.scale=h.GeometricScaling.value);const y=p8e(p);return this.genGeometry(t,l,i,y)}genGeometry(e,t,n,r){const i=new ts;e.attrName&&(i.name=e.attrName);const o=this.parseGeoNode(e,t),l=this.genBuffers(o),h=new Nr(l.vertex,3);if(h.applyMatrix4(r),i.setAttribute("position",h),l.colors.length>0&&i.setAttribute("color",new Nr(l.colors,3)),t&&(i.setAttribute("skinIndex",new Wj(l.weightsIndices,4)),i.setAttribute("skinWeight",new Nr(l.vertexWeights,4)),i.FBX_Deformer=t),l.normal.length>0){const p=new ci().getNormalMatrix(r),y=new Nr(l.normal,3);y.applyNormalMatrix(p),i.setAttribute("normal",y)}if(l.uvs.forEach(function(p,y){const x=y===0?"uv":`uv${y}`;i.setAttribute(x,new Nr(l.uvs[y],2))}),o.material&&o.material.mappingType!=="AllSame"){let p=l.materialIndex[0],y=0;if(l.materialIndex.forEach(function(x,S){x!==p&&(i.addGroup(y,S-y,p),p=x,y=S)}),i.groups.length>0){const x=i.groups[i.groups.length-1],S=x.start+x.count;S!==l.materialIndex.length&&i.addGroup(S,l.materialIndex.length-S,p)}i.groups.length===0&&i.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return this.addMorphTargets(i,e,n,r),i}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach(function(r,i){r.indices.forEach(function(o,l){n.weightTable[o]===void 0&&(n.weightTable[o]=[]),n.weightTable[o].push({id:i,weight:r.weights[l]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,i=!1,o=[],l=[],h=[],p=[],y=[],x=[];const S=this;return e.vertexIndices.forEach(function(A,k){let L,U=!1;A<0&&(A=A^-1,U=!0);let P=[],$=[];if(o.push(A*3,A*3+1,A*3+2),e.color){const Z=TI(k,n,A,e.color);h.push(Z[0],Z[1],Z[2])}if(e.skeleton){if(e.weightTable[A]!==void 0&&e.weightTable[A].forEach(function(Z){$.push(Z.weight),P.push(Z.id)}),$.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);const Z=[0,0,0,0],I=[0,0,0,0];$.forEach(function(ie,ce){let ue=ie,Q=P[ce];I.forEach(function(oe,le,J){if(ue>oe){J[le]=ue,ue=oe;const Be=Z[le];Z[le]=Q,Q=Be}})}),P=Z,$=I}for(;$.length<4;)$.push(0),P.push(0);for(let Z=0;Z<4;++Z)y.push($[Z]),x.push(P[Z])}if(e.normal){const Z=TI(k,n,A,e.normal);l.push(Z[0],Z[1],Z[2])}e.material&&e.material.mappingType!=="AllSame"&&(L=TI(k,n,A,e.material)[0],L<0&&(S.negativeMaterialIndices=!0,L=0)),e.uv&&e.uv.forEach(function(Z,I){const ie=TI(k,n,A,Z);p[I]===void 0&&(p[I]=[]),p[I].push(ie[0]),p[I].push(ie[1])}),r++,U&&(S.genFace(t,e,o,L,l,h,p,y,x,r),n++,r=0,o=[],l=[],h=[],p=[],y=[],x=[])}),t}getNormalNewell(e){const t=new ke(0,0,0);for(let n=0;n<e.length;n++){const r=e[n],i=e[(n+1)%e.length];t.x+=(r.y-i.y)*(r.z+i.z),t.y+=(r.z-i.z)*(r.x+i.x),t.z+=(r.x-i.x)*(r.y+i.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){const t=this.getNormalNewell(e),r=(Math.abs(t.z)>.5?new ke(0,1,0):new ke(0,0,1)).cross(t).normalize(),i=t.clone().cross(r).normalize();return{normal:t,tangent:r,bitangent:i}}flattenVertex(e,t,n){return new zn(e.dot(t),e.dot(n))}genFace(e,t,n,r,i,o,l,h,p,y){let x;if(y>3){const S=[],A=t.baseVertexPositions||t.vertexPositions;for(let P=0;P<n.length;P+=3)S.push(new ke(A[n[P]],A[n[P+1]],A[n[P+2]]));const{tangent:k,bitangent:L}=this.getNormalTangentAndBitangent(S),U=[];for(const P of S)U.push(this.flattenVertex(P,k,L));x=Jj.triangulateShape(U,[])}else x=[[0,1,2]];for(const[S,A,k]of x)e.vertex.push(t.vertexPositions[n[S*3]]),e.vertex.push(t.vertexPositions[n[S*3+1]]),e.vertex.push(t.vertexPositions[n[S*3+2]]),e.vertex.push(t.vertexPositions[n[A*3]]),e.vertex.push(t.vertexPositions[n[A*3+1]]),e.vertex.push(t.vertexPositions[n[A*3+2]]),e.vertex.push(t.vertexPositions[n[k*3]]),e.vertex.push(t.vertexPositions[n[k*3+1]]),e.vertex.push(t.vertexPositions[n[k*3+2]]),t.skeleton&&(e.vertexWeights.push(h[S*4]),e.vertexWeights.push(h[S*4+1]),e.vertexWeights.push(h[S*4+2]),e.vertexWeights.push(h[S*4+3]),e.vertexWeights.push(h[A*4]),e.vertexWeights.push(h[A*4+1]),e.vertexWeights.push(h[A*4+2]),e.vertexWeights.push(h[A*4+3]),e.vertexWeights.push(h[k*4]),e.vertexWeights.push(h[k*4+1]),e.vertexWeights.push(h[k*4+2]),e.vertexWeights.push(h[k*4+3]),e.weightsIndices.push(p[S*4]),e.weightsIndices.push(p[S*4+1]),e.weightsIndices.push(p[S*4+2]),e.weightsIndices.push(p[S*4+3]),e.weightsIndices.push(p[A*4]),e.weightsIndices.push(p[A*4+1]),e.weightsIndices.push(p[A*4+2]),e.weightsIndices.push(p[A*4+3]),e.weightsIndices.push(p[k*4]),e.weightsIndices.push(p[k*4+1]),e.weightsIndices.push(p[k*4+2]),e.weightsIndices.push(p[k*4+3])),t.color&&(e.colors.push(o[S*3]),e.colors.push(o[S*3+1]),e.colors.push(o[S*3+2]),e.colors.push(o[A*3]),e.colors.push(o[A*3+1]),e.colors.push(o[A*3+2]),e.colors.push(o[k*3]),e.colors.push(o[k*3+1]),e.colors.push(o[k*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(i[S*3]),e.normal.push(i[S*3+1]),e.normal.push(i[S*3+2]),e.normal.push(i[A*3]),e.normal.push(i[A*3+1]),e.normal.push(i[A*3+2]),e.normal.push(i[k*3]),e.normal.push(i[k*3+1]),e.normal.push(i[k*3+2])),t.uv&&t.uv.forEach(function(L,U){e.uvs[U]===void 0&&(e.uvs[U]=[]),e.uvs[U].push(l[U][S*2]),e.uvs[U].push(l[U][S*2+1]),e.uvs[U].push(l[U][A*2]),e.uvs[U].push(l[U][A*2+1]),e.uvs[U].push(l[U][k*2]),e.uvs[U].push(l[U][k*2+1])})}addMorphTargets(e,t,n,r){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const i=this;n.forEach(function(o){o.rawTargets.forEach(function(l){const h=yi.Objects.Geometry[l.geoID];h!==void 0&&i.genMorphGeometry(e,t,h,r,l.name)})})}genMorphGeometry(e,t,n,r,i){const o=t.Vertices!==void 0?t.Vertices.a:[],l=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],h=n.Vertices!==void 0?n.Vertices.a:[],p=n.Indexes!==void 0?n.Indexes.a:[],y=e.attributes.position.count*3,x=new Float32Array(y);for(let L=0;L<p.length;L++){const U=p[L]*3;x[U]=h[L*3],x[U+1]=h[L*3+1],x[U+2]=h[L*3+2]}const S={vertexIndices:l,vertexPositions:x,baseVertexPositions:o},A=this.genBuffers(S),k=new Nr(A.vertex,3);k.name=i||n.attrName,k.applyMatrix4(r),e.morphAttributes.position.push(k)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let i=[];return n==="IndexToDirect"&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let i=[];return n==="IndexToDirect"&&(i=e.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let i=[];n==="IndexToDirect"&&(i=e.ColorIndex.a);for(let o=0,l=new Vn;o<r.length;o+=4)l.fromArray(r,o),Yr.colorSpaceToWorking(l,ei),l.toArray(r,o);return{dataSize:4,buffer:r,indices:i,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,i=[];for(let o=0;o<r.length;++o)i.push(o);return{dataSize:1,buffer:r,indices:i,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new ts;const n=t-1,r=e.KnotVector.a,i=[],o=e.Points.a;for(let x=0,S=o.length;x<S;x+=4)i.push(new Ti().fromArray(o,x));let l,h;if(e.Form==="Closed")i.push(i[0]);else if(e.Form==="Periodic"){l=n,h=r.length-1-l;for(let x=0;x<n;++x)i.push(i[x])}const y=new nqe(n,r,i,l,h).getPoints(i.length*12);return new ts().setFromPoints(y)}}class aqe{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const r=t[n],i=this.addClip(r);e.push(i)}return e}parseClips(){if(yi.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=yi.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const i={id:r.id,attr:r.attrName,curves:{}};t.set(i.id,i)}}return t}parseAnimationCurves(e){const t=yi.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(hqe),values:t[n].KeyValueFloat.a},i=ja.get(r.id);if(i!==void 0){const o=i.parents[0].ID,l=i.parents[0].relationship;l.match(/X/)?e.get(o).curves.x=r:l.match(/Y/)?e.get(o).curves.y=r:l.match(/Z/)?e.get(o).curves.z=r:l.match(/DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const t=yi.Objects.AnimationLayer,n=new Map;for(const r in t){const i=[],o=ja.get(parseInt(r));o!==void 0&&(o.children.forEach(function(h,p){if(e.has(h.ID)){const y=e.get(h.ID);if(y.curves.x!==void 0||y.curves.y!==void 0||y.curves.z!==void 0){if(i[p]===void 0){const x=ja.get(h.ID).parents.filter(function(S){return S.relationship!==void 0})[0].ID;if(x!==void 0){const S=yi.Objects.Model[x.toString()];if(S===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",h);return}const A={modelName:S.attrName?Gi.sanitizeNodeName(S.attrName):"",ID:S.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Ll.traverse(function(k){k.ID===S.id&&(A.transform=k.matrix,k.userData.transformData&&(A.eulerOrder=k.userData.transformData.eulerOrder))}),A.transform||(A.transform=new yr),"PreRotation"in S&&(A.preRotation=S.PreRotation.value),"PostRotation"in S&&(A.postRotation=S.PostRotation.value),i[p]=A}}i[p]&&(i[p][y.attr]=y)}else if(y.curves.morph!==void 0){if(i[p]===void 0){const x=ja.get(h.ID).parents.filter(function(P){return P.relationship!==void 0})[0].ID,S=ja.get(x).parents[0].ID,A=ja.get(S).parents[0].ID,k=ja.get(A).parents[0].ID,L=yi.Objects.Model[k],U={modelName:L.attrName?Gi.sanitizeNodeName(L.attrName):"",morphName:yi.Objects.Deformer[x].attrName};i[p]=U}i[p][y.attr]=y}}}),n.set(parseInt(r),i))}return n}parseAnimStacks(e){const t=yi.Objects.AnimationStack,n={};for(const r in t){const i=ja.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(i[0].ID);n[r]={name:t[r].attrName,layer:o}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(r){t=t.concat(n.generateTracks(r))}),new kH(e.name,-1,t)}generateTracks(e){const t=[];let n=new ke,r=new ke;if(e.transform&&e.transform.decompose(n,new us,r),n=n.toArray(),r=r.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");i!==void 0&&t.push(i)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const i=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);i!==void 0&&t.push(i)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");i!==void 0&&t.push(i)}if(e.DeformPercent!==void 0){const i=this.generateMorphTrack(e);i!==void 0&&t.push(i)}return t}generateVectorTrack(e,t,n,r){const i=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(i,t,n);return new IE(e+"."+r,i,o)}generateRotationTrack(e,t,n,r,i){let o,l;if(t.x!==void 0&&t.y!==void 0&&t.z!==void 0){const S=this.interpolateRotations(t.x,t.y,t.z,i);o=S[0],l=S[1]}const h=VE(0);n!==void 0&&(n=n.map($0.degToRad),n.push(h),n=new so().fromArray(n),n=new us().setFromEuler(n)),r!==void 0&&(r=r.map($0.degToRad),r.push(h),r=new so().fromArray(r),r=new us().setFromEuler(r).invert());const p=new us,y=new so,x=[];if(!l||!o)return new $_(e+".quaternion",[0],[0]);for(let S=0;S<l.length;S+=3)y.set(l[S],l[S+1],l[S+2],i),p.setFromEuler(y),n!==void 0&&p.premultiply(n),r!==void 0&&p.multiply(r),S>2&&new us().fromArray(x,(S-3)/3*4).dot(p)<0&&p.set(-p.x,-p.y,-p.z,-p.w),p.toArray(x,S/3*4);return new $_(e+".quaternion",o,x)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(i){return i/100}),r=Ll.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new RE(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(n,r){return n-r}),t.length>1){let n=1,r=t[0];for(let i=1;i<t.length;i++){const o=t[i];o!==r&&(t[n]=o,r=o,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,i=[];let o=-1,l=-1,h=-1;return e.forEach(function(p){if(t.x&&(o=t.x.times.indexOf(p)),t.y&&(l=t.y.times.indexOf(p)),t.z&&(h=t.z.times.indexOf(p)),o!==-1){const y=t.x.values[o];i.push(y),r[0]=y}else i.push(r[0]);if(l!==-1){const y=t.y.values[l];i.push(y),r[1]=y}else i.push(r[1]);if(h!==-1){const y=t.z.values[h];i.push(y),r[2]=y}else i.push(r[2])}),i}interpolateRotations(e,t,n,r){const i=[],o=[];i.push(e.times[0]),o.push($0.degToRad(e.values[0])),o.push($0.degToRad(t.values[0])),o.push($0.degToRad(n.values[0]));for(let l=1;l<e.values.length;l++){const h=[e.values[l-1],t.values[l-1],n.values[l-1]];if(isNaN(h[0])||isNaN(h[1])||isNaN(h[2]))continue;const p=h.map($0.degToRad),y=[e.values[l],t.values[l],n.values[l]];if(isNaN(y[0])||isNaN(y[1])||isNaN(y[2]))continue;const x=y.map($0.degToRad),S=[y[0]-h[0],y[1]-h[1],y[2]-h[2]],A=[Math.abs(S[0]),Math.abs(S[1]),Math.abs(S[2])];if(A[0]>=180||A[1]>=180||A[2]>=180){const L=Math.max(...A)/180,U=new so(...p,r),P=new so(...x,r),$=new us().setFromEuler(U),Z=new us().setFromEuler(P);$.dot(Z)&&Z.set(-Z.x,-Z.y,-Z.z,-Z.w);const I=e.times[l-1],ie=e.times[l]-I,ce=new us,ue=new so;for(let Q=0;Q<1;Q+=1/L)ce.copy($.clone().slerp(Z.clone(),Q)),i.push(I+Q*ie),ue.setFromQuaternion(ce,r),o.push(ue.x),o.push(ue.y),o.push(ue.z)}else i.push(e.times[l]),o.push($0.degToRad(e.values[l])),o.push($0.degToRad(t.values[l])),o.push($0.degToRad(n.values[l]))}return[i,o]}}class oqe{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new f8e,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(r,i){const o=r.match(/^[\s\t]*;/),l=r.match(/^[\s\t]*$/);if(o||l)return;const h=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),p=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),y=r.match("^\\t{"+(t.currentIndent-1)+"}}");h?t.parseNodeBegin(r,h):p?t.parseNodeProperty(r,p,n[++i]):y?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(h){return h.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:n},o=this.parseNodeAttr(r),l=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,i):n in l?(n==="PoseNode"?l.PoseNode.push(i):l[n].id!==void 0&&(l[n]={},l[n][l[n].id]=l[n]),o.id!==""&&(l[n][o.id]=i)):typeof o.id=="number"?(l[n]={},l[n][o.id]=i):n!=="Properties70"&&(n==="PoseNode"?l[n]=[i]:l[n]=i),typeof o.id=="number"&&(i.id=o.id),o.name!==""&&(i.attrName=o.name),o.type!==""&&(i.attrType=o.type),this.pushStack(i)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&i===","&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if(o.name==="Properties70"){this.parseNodeSpecialProperty(e,r,i);return}if(r==="C"){const h=i.split(",").slice(1),p=parseInt(h[0]),y=parseInt(h[1]);let x=i.split(",").slice(3);x=x.map(function(S){return S.trim().replace(/^"/,"")}),r="connections",i=[p,y],fqe(i,x),o[r]===void 0&&(o[r]=[])}r==="Node"&&(o.id=i),r in o&&Array.isArray(o[r])?o[r].push(i):r!=="a"?o[r]=i:o.a=i,this.setCurrentProp(o,r),r==="a"&&i.slice(-1)!==","&&(o.a=UG(i))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=UG(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map(function(y){return y.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=r[0],o=r[1],l=r[2],h=r[3];let p=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":p=parseFloat(p);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":p=UG(p);break}this.getPrevNode()[i]={type:o,type2:l,flag:h,value:p},this.setCurrentProp(this.getPrevNode(),i)}}class lqe{parse(e){const t=new o9e(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new f8e;for(;!this.endOfContent(t);){const i=this.parseNode(t,n);i!==null&&r.add(i.name,i)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),l=e.getString(o);if(r===0)return null;const h=[];for(let S=0;S<i;S++)h.push(this.parseProperty(e));const p=h.length>0?h[0]:"",y=h.length>1?h[1]:"",x=h.length>2?h[2]:"";for(n.singleProperty=i===1&&e.getOffset()===r;r>e.getOffset();){const S=this.parseNode(e,t);S!==null&&this.parseSubNode(l,n,S)}return n.propertyList=h,typeof p=="number"&&(n.id=p),y!==""&&(n.attrName=y),x!==""&&(n.attrType=x),l!==""&&(n.name=l),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if(e==="Connections"&&n.name==="C"){const r=[];n.propertyList.forEach(function(i,o){o!==0&&r.push(i)}),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(n.name==="Properties70")Object.keys(n).forEach(function(i){t[i]=n[i]});else if(e==="Properties70"&&n.name==="P"){let r=n.propertyList[0],i=n.propertyList[1];const o=n.propertyList[2],l=n.propertyList[3];let h;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),i==="Color"||i==="ColorRGB"||i==="Vector"||i==="Vector3D"||i.indexOf("Lcl_")===0?h=[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:h=n.propertyList[4],t[r]={type:i,type2:o,flag:l,value:h}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),i=e.getUint32(),o=e.getUint32();if(i===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const l=$$e(new Uint8Array(e.getArrayBuffer(o))),h=new o9e(l.buffer);switch(t){case"b":case"c":return h.getBooleanArray(r);case"d":return h.getFloat64Array(r);case"f":return h.getFloat32Array(r);case"i":return h.getInt32Array(r);case"l":return h.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class o9e{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const r=n.indexOf(0);return r>=0&&(n=new Uint8Array(this.dv.buffer,t,r)),this._textDecoder.decode(n)}}class f8e{add(e,t){this[e]=t}}function uqe(s){const e="Kaydara FBX Binary  \0";return s.byteLength>=e.length&&e===m8e(s,0,e.length)}function cqe(s){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(r){const i=s[r-1];return s=s.slice(t+r),t++,i}for(let r=0;r<e.length;++r)if(n(1)===e[r])return!1;return!0}function l9e(s){const e=/FBXVersion: (\d+)/,t=s.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function hqe(s){return s/46186158e3}const dqe=[];function TI(s,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=s;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(r=n.indices[r]);const i=r*n.dataSize,o=i+n.dataSize;return pqe(dqe,n.buffer,i,o)}const LG=new so,o_=new ke;function p8e(s){const e=new yr,t=new yr,n=new yr,r=new yr,i=new yr,o=new yr,l=new yr,h=new yr,p=new yr,y=new yr,x=new yr,S=new yr,A=s.inheritType?s.inheritType:0;s.translation&&e.setPosition(o_.fromArray(s.translation));const k=VE(0);if(s.preRotation){const J=s.preRotation.map($0.degToRad);J.push(k),t.makeRotationFromEuler(LG.fromArray(J))}if(s.rotation){const J=s.rotation.map($0.degToRad);J.push(s.eulerOrder||k),n.makeRotationFromEuler(LG.fromArray(J))}if(s.postRotation){const J=s.postRotation.map($0.degToRad);J.push(k),r.makeRotationFromEuler(LG.fromArray(J)),r.invert()}s.scale&&i.scale(o_.fromArray(s.scale)),s.scalingOffset&&l.setPosition(o_.fromArray(s.scalingOffset)),s.scalingPivot&&o.setPosition(o_.fromArray(s.scalingPivot)),s.rotationOffset&&h.setPosition(o_.fromArray(s.rotationOffset)),s.rotationPivot&&p.setPosition(o_.fromArray(s.rotationPivot)),s.parentMatrixWorld&&(x.copy(s.parentMatrix),y.copy(s.parentMatrixWorld));const L=t.clone().multiply(n).multiply(r),U=new yr;U.extractRotation(y);const P=new yr;P.copyPosition(y);const $=P.clone().invert().multiply(y),Z=U.clone().invert().multiply($),I=i,ie=new yr;if(A===0)ie.copy(U).multiply(L).multiply(Z).multiply(I);else if(A===1)ie.copy(U).multiply(Z).multiply(L).multiply(I);else{const Be=new yr().scale(new ke().setFromMatrixScale(x)).clone().invert(),He=Z.clone().multiply(Be);ie.copy(U).multiply(L).multiply(He).multiply(I)}const ce=p.clone().invert(),ue=o.clone().invert();let Q=e.clone().multiply(h).multiply(p).multiply(t).multiply(n).multiply(r).multiply(ce).multiply(l).multiply(o).multiply(i).multiply(ue);const oe=new yr().copyPosition(Q),le=y.clone().multiply(oe);return S.copyPosition(le),Q=S.clone().multiply(ie),Q.premultiply(y.invert()),Q}function VE(s){s=s||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return s===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[s]}function UG(s){return s.split(",").map(function(t){return parseFloat(t)})}function m8e(s,e,t){return e===void 0&&(e=0),t===void 0&&(t=s.byteLength),new TextDecoder().decode(new Uint8Array(s,e,t))}function fqe(s,e){for(let t=0,n=s.length,r=e.length;t<r;t++,n++)s[n]=e[t]}function pqe(s,e,t,n){for(let r=t,i=0;r<n;r++,i++)s[i]=e[r];return s}const Jk=new Map,g8e=new Map,v8e=new Map,p$=new Map;function mqe(s,e){return new Promise((t,n)=>{new fCe().setPath("images/milkyWay/").load(e,r=>{Jk.set(s,r),t(r)},void 0,()=>{n()})})}function gqe(s,e){return new Promise((t,n)=>{new rqe().setPath("./models/").loadAsync(e).then(r=>{r.traverse(i=>{i.isMesh&&(i.castShadow=!0,i.receiveShadow=!0)}),v8e.set(s,r),t(r)}).catch(r=>{console.log("Couldn't load:",e),console.log(r),n()})})}function vqe(s,e){return new Promise((t,n)=>{new h3e().load(e,r=>{r.wrapS=Fg,r.wrapT=Fg,r.needsUpdate=!0,p$.set(s,r),t(r)},void 0,()=>{n()})})}function yqe(s,e){return new Promise((t,n)=>{fetch(e).then(r=>{if(!r.ok)throw new Error(`Network response was not ok: ${r.status}`);return r.json()}).then(r=>{g8e.set(s,r),t(r)}).catch(()=>{console.log(`Couldn't load: ${e}`),n()})})}function _qe(s){return new Promise((e,t)=>{const n=[()=>mqe("environment",["dark-s_px.jpg","dark-s_nx.jpg","dark-s_py.jpg","dark-s_ny.jpg","dark-s_pz.jpg","dark-s_nz.jpg"]),()=>vqe("uv_grid","images/uv_grid_opengl.jpg"),()=>gqe("Flair","Flair.fbx"),()=>yqe("animation","json/animation.json")];Promise.all(n.map(r=>r())).then(()=>{const r=s.components.get("theatre"),i=g8e.get("animation");r.loadProject("RemoteApp",i).then(()=>{FH.dispatchEvent({type:tk.LOAD_COMPLETE}),e()})}).catch(r=>{console.log(r),t()})})}class y8e extends Ri{constructor(t){super();Qe(this,"mixer");this.name=t,this.scale.setScalar(.5);const n=v8e.get(t),r=k$e(n);this.add(r),this.mixer=new DCe(r),r.mixer=this.mixer,this.mixer.clipAction(r.animations[0]).play()}update(t){this.mixer.update(t)}get timeScale(){return this.mixer.timeScale}set timeScale(t){this.mixer.timeScale=t}}class m$ extends ME{constructor(){super();Qe(this,"app");Qe(this,"camera");Qe(this,"renderer");Qe(this,"clock");this.clock=new d3e,this.clock.start();const t=new Ri;t.name="cameras",this.add(t),this.camera=new Go(90,1,10,1e3),this.camera.name="SceneCamera",this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),t.add(this.camera)}setup(t,n){this.app=t,this.renderer=n}init(){}dispose(){this.app.components.get("theatre").clearSheetObjects(this.name)}resize(t,n){this.camera.aspect=t/n,this.camera.updateProjectionMatrix()}update(){}draw(){this.renderer.isWebGLRenderer?this.renderer.render(this,this.camera):this.renderer.renderAsync(this,this.camera)}}let bj=[];function xqe(s,e,t=!0){q0.renderer=e.renderer;const n=[];n.push({type:"boolean",prop:"Enabled",value:s.enabled});let r=(o,l)=>{console.log("Default Handle Pass:",o,l)};if(s.name==="EffectPass")s.effects.forEach(o=>{o.uniforms.size>0&&o.uniforms.forEach((l,h)=>{if(h==="map")return;const p=`${o.name.replace("Effect","")} ${h}`;if(l.value===null&&t)n.push({prop:h,title:p,type:"image",value:{offset:[0,0],repeat:[1,1],src:""}});else if(l.value.isTexture&&t){const y=l.value,x=q0.renderToBlob(y);n.push({prop:h,title:p,type:"image",value:{offset:[y.offset.x,y.offset.y],repeat:[y.repeat.x,y.repeat.y],src:x}})}else typeof l.value=="number"?n.push({prop:h,title:p,type:"number",value:l.value,step:.01}):typeof l.value=="string"?n.push({prop:h,title:p,type:"string",value:l.value}):typeof l.value=="boolean"&&n.push({prop:h,title:p,type:"boolean",value:l.value})})}),r=(o,l)=>{s.effects.forEach(h=>{h.uniforms.size>0&&h.uniforms.forEach((p,y)=>{y===o&&(p.value=l)})})};else if(s.name==="ShaderPass"){const o=s.fullscreenMaterial;for(const l in o.uniforms){if(l==="inputBuffer"||l==="map")continue;const h=o.uniforms[l],p=`${o.name.replace("Material","")} ${l}`;if(h.value===null&&t)n.push({title:p,prop:l,type:"image",value:{offset:[0,0],repeat:[1,1],src:""}});else if(h.value.isTexture&&t){const y=h.value,x=q0.renderToBlob(y);n.push({title:p,prop:l,type:"image",value:{offset:[y.offset.x,y.offset.y],repeat:[y.repeat.x,y.repeat.y],src:x}})}else typeof h.value=="number"?n.push({title:p,prop:l,type:"number",value:h.value,step:.01}):typeof h.value=="string"?n.push({title:p,prop:l,type:"string",value:h.value}):typeof h.value=="boolean"&&n.push({title:p,prop:l,type:"boolean",value:h.value})}r=(l,h)=>{const p=o.uniforms[l];p.value=h}}else return;const i=`${s.name}: ${s.scene.name}`;e.addGroup({title:i,items:n,onUpdate:(o,l)=>{o==="Enabled"?s.enabled=l:r(o,l)}}),bj.push(i)}function bqe(s,e){s.passes.forEach(t=>{xqe(t,e)})}function Sqe(s){bj.forEach(e=>{s.removeGroup(e)}),bj=[]}class _8e extends m${constructor(){super();Qe(this,"dance");Qe(this,"composer");Qe(this,"customMat");this.name="Scene1"}init(){const t=Jk.get("environment");this.background=t,this.camera.position.set(0,50,50),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createPost(),this.createAnimation(),X_(this);const n=this.app.components.get("three");n.addScene(this),n.setScene(this),n.addCamera(this.camera)}dispose(){var n;const t=this.app.components.get("three");(n=this.composer)==null||n.dispose(),t.removeCamera(this.camera),super.dispose()}createLights(){const t=new Ri;t.name="lights",this.add(t);const n=new rW(16777215,.25);n.name="sun",n.castShadow=!0,n.position.set(0,50,50);const r=1024;n.shadow.camera.top=r,n.shadow.camera.bottom=-r,n.shadow.camera.left=-r,n.shadow.camera.right=r,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=10,n.shadow.camera.far=1e3,n.shadow.bias=-.001,t.add(n);const i=new pCe(7320802,12872999,.5);i.name="hemi",t.add(i);const o=new nW(16777215,3);o.angle=5.8,o.decay=0,o.distance=1e3,o.penumbra=Math.PI,o.name="spotlight",o.castShadow=!0,o.shadow.mapSize.width=1024,o.shadow.mapSize.height=1024,o.shadow.camera.near=10,o.shadow.camera.far=1e3,o.shadow.bias=-.001,o.position.set(-50,200,200),o.lookAt(0,50,0),t.add(o)}createWorld(){const t=new Ri;t.name="world",this.add(t);const n=p$.get("uv_grid");n.repeat.setScalar(10),n.needsUpdate=!0;const r=new g_({map:n}),i=new Mn(new Rk(500,36),r);i.name="floor",i.receiveShadow=!0,i.rotateX(-Math.PI/2),t.add(i),this.dance=new y8e("Flair"),this.dance.position.set(0,0,0),t.add(this.dance),this.createTestMaterials(t)}createTestMaterials(t){const n=new Av(20),r=[],i=new Mn(n,new Nc({name:"BasicMaterial",transparent:!0}));i.name="Basic",t.add(i),r.push(i);const o=new Mn(n,new a3e({transparent:!0}));o.name="Matcap",t.add(o),r.push(o);const l=new Mn(n,new g_({name:"PhongMaterial",transparent:!0}));l.name="Phong",t.add(l),r.push(l);const h=new Mn(n,new JI({name:"PhysicalMaterial",transparent:!0}));if(h.name="Physical",t.add(h),r.push(h),this.app.components.get("three").renderer.isWebGLRenderer){this.customMat=new i8e;const A=new Mn(n,this.customMat);A.name="Shader",t.add(A),r.push(A)}const y=50,x=r.length,S=(x-1)/2*y;for(let A=0;A<x;A++){const k=A*y-S;r[A].position.set(k,100,-150),r[A].castShadow=!0}}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Break Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.playSheet(this.name,{iterationCount:1/0})}createPost(){var i,o,l;const t=this.app.components.get("three");this.composer=new yWe(t.renderer,{frameBufferType:t4}),(i=this.composer)==null||i.addPass(new b$e(this,this.camera));const n=new A$e(this.camera,new x$e,new g$e,new w$e);n.scene.name="FXAA/Bloom/Vignette",(o=this.composer)==null||o.addPass(n);const r=new v$e(new h$);r.scene.name="Display",(l=this.composer)==null||l.addPass(r),bqe(this.composer,t)}update(){var n;const t=this.clock.getDelta();(n=this.customMat)==null||n.update(t),this.dance.update(t)}draw(){var t;(t=this.composer)==null||t.render()}resize(t,n){var r;super.resize(t,n),this.app.isApp&&((r=this.composer)==null||r.setSize(t,n))}}class ix{static init(){const e=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-448815e-12,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,907581e-12,1.12813,.997866,-896716e-12,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,879224e-12,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,655682e-12,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,462391e-12,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,304092e-12,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,173682e-12,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,778271e-13,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-627338e-12,.0306409,197672e-13,99168e-8,-158573e-10,.0314638,499803e-12,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,237499e-13,-999999e-13,282592e-10,114596e-15,100292e-11,-166369e-11,250354e-9,677492e-14,350752e-11,-637769e-11,357289e-9,631655e-13,826445e-11,-174689e-10,516179e-9,31851e-11,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],t=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,545037e-15,0,0,.999994,285095e-14,0,0,.999989,126931e-13,0,0,.999973,489938e-13,0,0,.999947,166347e-12,0,0,.999894,502694e-12,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,115855e-15,0,0,.999996,66947e-14,0,0,.999991,330863e-14,0,0,.999983,141737e-13,0,0,.999968,532626e-13,0,0,.99994,177431e-12,0,0,.999891,528835e-12,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,222338e-15,0,0,.999995,10967e-13,0,0,.999991,482132e-14,0,0,.999981,189434e-13,0,0,.999967,667716e-13,0,0,.999938,212066e-12,0,0,.999886,60977e-11,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,101739e-15,0,0,.999997,470132e-15,0,0,.999993,200436e-14,0,0,.999988,783682e-14,0,0,.999979,280338e-13,0,0,.999962,917033e-13,0,0,.999933,274514e-12,0,0,.999881,753201e-12,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,251859e-15,0,0,.999996,996192e-15,0,0,.999992,374531e-14,0,0,.999986,132022e-13,0,0,.999975,433315e-13,0,0,.999959,131956e-12,0,0,.999927,372249e-12,0,0,.999871,972461e-12,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,179597e-15,0,0,.999997,602367e-15,0,0,.999994,206835e-14,0,0,.99999,694952e-14,0,0,.999984,223363e-13,0,0,.999972,678578e-13,0,0,.999952,193571e-12,0,0,.999919,516594e-12,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,114608e-15,0,0,.999998,210507e-15,0,0,.999997,499595e-15,0,0,.999995,139897e-14,0,0,.999994,419818e-14,0,0,.999988,127042e-13,0,0,.999979,375153e-13,0,0,.999965,106206e-12,0,0,.999945,285381e-12,0,0,.999908,723611e-12,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,286798e-15,0,0,1,286877e-15,0,0,1,288094e-15,0,0,1,293506e-15,0,0,1,309262e-15,0,0,.999999,348593e-15,0,0,.999999,444582e-15,0,0,.999998,688591e-15,0,0,.999996,134391e-14,0,0,.999993,317438e-14,0,0,.999989,835609e-14,0,0,.999983,228677e-13,0,0,.999974,623361e-13,0,0,.999959,165225e-12,0,0,.999936,419983e-12,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,168222e-12,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,109018e-14,0,0,1,10904e-13,0,0,1,109393e-14,0,0,1,11095e-13,0,0,1,1154e-12,0,0,1,126089e-14,0,0,.999999,15059e-13,0,0,.999997,207899e-14,0,0,.999994,348164e-14,0,0,.999993,705728e-14,0,0,.999987,163692e-13,0,0,.999981,406033e-13,0,0,.999969,10245e-11,0,0,.999953,255023e-12,0,0,.999925,61511e-11,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,354014e-14,0,0,1,354073e-14,0,0,1,354972e-14,0,0,1,358929e-14,0,0,1,370093e-14,0,0,.999999,396194e-14,0,0,.999998,453352e-14,0,0,.999997,578828e-14,0,0,.999994,863812e-14,0,0,.999991,153622e-13,0,0,.999985,316356e-13,0,0,.999977,712781e-13,0,0,.999964,166725e-12,0,0,.999945,390501e-12,0,0,.999912,895622e-12,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,10153e-12,0,0,1,101544e-13,0,0,1,101751e-13,0,0,1,102662e-13,0,0,1,10521e-12,0,0,.999999,111049e-13,0,0,.999999,123408e-13,0,0,.999996,14924e-12,0,0,.999992,204471e-13,0,0,.999989,326539e-13,0,0,.99998,603559e-13,0,0,.999971,123936e-12,0,0,.999955,269058e-12,0,0,.999933,593604e-12,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,22038e-11,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,263344e-13,0,0,1,263373e-13,0,0,1,263815e-13,0,0,1,265753e-13,0,0,1,271132e-13,0,0,.999999,283279e-13,0,0,.999997,30833e-12,0,0,.999995,358711e-13,0,0,.999992,461266e-13,0,0,.999985,67574e-12,0,0,.999977,11358e-11,0,0,.999966,213657e-12,0,0,.999948,431151e-12,0,0,.999923,896656e-12,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,628647e-13,0,0,1,628705e-13,0,0,1,629587e-13,0,0,1,633441e-13,0,0,.999999,644087e-13,0,0,.999998,667856e-13,0,0,.999997,715889e-13,0,0,.999995,809577e-13,0,0,.999989,992764e-13,0,0,.999983,135834e-12,0,0,.999974,210482e-12,0,0,.999959,365215e-12,0,0,.999939,686693e-12,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,139968e-12,0,0,1,139979e-12,0,0,1,140145e-12,0,0,1,14087e-11,0,0,.999999,142865e-12,0,0,.999998,147279e-12,0,0,.999997,156057e-12,0,0,.999992,17276e-11,0,0,.999989,204352e-12,0,0,.99998,26494e-11,0,0,.999969,383435e-12,0,0,.999953,618641e-12,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,29368e-11,0,0,1,2937e-10,0,0,1,293998e-12,0,0,1,295298e-12,0,0,.999999,298865e-12,0,0,.999998,3067e-10,0,0,.999995,322082e-12,0,0,.999992,350767e-12,0,0,.999986,403538e-12,0,0,.999976,501372e-12,0,0,.999964,68562e-11,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,585473e-12,0,0,1,585507e-12,0,0,1,58602e-11,0,0,.999999,588259e-12,0,0,.999999,594381e-12,0,0,.999998,607754e-12,0,0,.999995,633729e-12,0,0,.99999,68137e-11,0,0,.999984,767003e-12,0,0,.999973,921212e-12,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,88288e-11,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],n=new Float32Array(e),r=new Float32Array(t),i=new Kw(n,64,64,K0,Lh,f_,g0,g0,Ho,y0,1),o=new Kw(r,64,64,K0,Lh,f_,g0,g0,Ho,y0,1);i.needsUpdate=!0,o.needsUpdate=!0;const l=new Uint16Array(e.length);e.forEach(function(x,S){l[S]=f1e.toHalfFloat(x)});const h=new Uint16Array(t.length);t.forEach(function(x,S){h[S]=f1e.toHalfFloat(x)});const p=new Kw(l,64,64,K0,t4,f_,g0,g0,Ho,y0,1),y=new Kw(h,64,64,K0,t4,f_,g0,g0,Ho,y0,1);return p.needsUpdate=!0,y.needsUpdate=!0,this.LTC_HALF_1=p,this.LTC_HALF_2=y,this.LTC_FLOAT_1=i,this.LTC_FLOAT_2=o,this}}ix.LTC_HALF_1=null;ix.LTC_HALF_2=null;ix.LTC_FLOAT_1=null;ix.LTC_FLOAT_2=null;class wqe{static init(){ix.init();const{LTC_FLOAT_1:e,LTC_FLOAT_2:t,LTC_HALF_1:n,LTC_HALF_2:r}=ix;Un.LTC_FLOAT_1=e,Un.LTC_FLOAT_2=t,Un.LTC_HALF_1=n,Un.LTC_HALF_2=r}}const u9e=new ke;class x8e extends m${constructor(){super();Qe(this,"renderTarget");Qe(this,"mesh");this.name="RTTScene",this.camera.position.set(0,0,100),this.camera.lookAt(u9e)}init(){const t=Jk.get("environment").clone();this.background=t;const n=new rW(new Vn(16777215),1);n.name="sun",this.add(n),this.mesh=new Mn(new eW(10,3,100,6),new JI({envMap:t,envMapIntensity:10})),this.mesh.name="normalMesh",this.add(this.mesh);const r=new Mn(new Av(10),new i3e);r.name="ball",r.position.set(25,25,0),this.add(r);const i=new Mn(new Cv(200,200),new JI({envMap:t}));i.name="floor",i.rotation.x=-Math.PI/2,i.position.set(0,-20,0),this.add(i),this.renderTarget=new V9e(512,512),X_(this);const o=this.app.components.get("three");o.addScene(this),o.addCamera(this.camera)}dispose(){const t=this.app.components.get("three");t.removeCamera(this.camera),t.removeScene(this),super.dispose()}draw(){const t=this.clock.getElapsedTime(),n=100,r=t*.05*Math.PI*2,i=Math.cos(r)*n,o=Math.sin(r)*n;this.camera.position.set(i,0,o),this.camera.lookAt(u9e),this.renderer&&(this.renderer.isWebGLRenderer?(this.renderer.setRenderTarget(this.renderTarget),this.renderer.clear(),this.renderer.render(this,this.camera),this.renderer.setRenderTarget(null)):(this.renderer.setRenderTarget(this.renderTarget),this.renderer.clearAsync(),this.renderer.renderAsync(this,this.camera),this.renderer.setRenderTarget(null)))}}const c9e="Custom Group";class b8e extends m${constructor(){super();Qe(this,"dance");Qe(this,"rttScene");Qe(this,"speed",1);this.name="Scene2",this.rttScene=new x8e}setup(t,n){super.setup(t,n),this.rttScene.setup(t,n)}init(){this.rttScene.init();const t=this.app.components.get("three");this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createAnimation(),X_(this),t.addScene(this),t.addCamera(this.camera),t.setScene(this),t.renderer&&(this.renderer=t.renderer)}dispose(){const t=this.app.components.get("three");t.removeCamera(this.camera),t.removeGroup(c9e),Hh(this.rttScene),super.dispose()}createLights(){const t=this.app.components.get("three"),n=new Ri;n.name="lights",this.add(n);const r=new nW(16777215,3);if(r.angle=5.8,r.decay=0,r.distance=1e3,r.penumbra=Math.PI,r.name="spotlight",r.position.set(-250,200,200),r.lookAt(0,50,0),n.add(r),t.renderer!==void 0&&t.renderer.isWebGLRenderer){wqe.init();const i=new _Ce(16711680,1,300,100);i.name="rectLight",i.position.set(250,100,100),i.lookAt(0,50,0),n.add(i)}}createWorld(){const t=this.app.components.get("three"),n=Jk.get("environment").clone();this.background=n;const r=new Ri;r.name="world",this.add(r);const i=p$.get("uv_grid");i.repeat.setScalar(10),i.needsUpdate=!0;const o=new JI({map:i,envMap:n}),l=new Mn(new Rk(250,36),o);l.name="floor",l.receiveShadow=!0,l.position.y=-2,l.rotateX(-Math.PI/2),r.add(l);const h=new DMe(new Av(50),new Y9e({size:.5}));h.name="points",h.position.set(-100,50,0),r.add(h);const p=new jE(new Av(50),new Mf);p.name="lines",p.position.set(100,50,0),r.add(p);const y=new Nc;y.map=this.rttScene.renderTarget.texture;const x=new Mn(new Cv(100,100),y);if(x.name="rttExample",x.position.set(-75,50,-125),r.add(x),t.renderer.isWebGLRenderer){const S=new Mn(new Cv(100,100),new i8e);S.name="customShaderMaterial",S.position.set(75,50,-125),r.add(S)}else x.scale.y=-1,y.side=qa,y.needsUpdate=!0;this.dance=new y8e("Flair"),this.dance.name="flair",this.dance.traverse(S=>{if(S instanceof qj){const A=S;A.material=new a3e}}),r.add(this.dance),t.addGroup({title:c9e,items:[{title:"Speed",prop:"speed",value:1,min:0,max:2,step:.01,type:"range"},{title:"Name",prop:"name",value:"Hello World!",type:"string"},{title:"Color",prop:"color",value:new Vn(16711680),type:"color"}],onUpdate:(S,A)=>{switch(console.log(S,A),S){case"speed":this.speed=A;break}}})}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)})}update(){const t=this.clock.getDelta();this.dance.update(t*this.speed),this.rttScene.update(),this.rttScene.draw()}resize(t,n){super.resize(t,n),this.rttScene.resize(t,n)}}function Eqe(s){Fn.useEffect(()=>{cWe()},[]);const e=s.app.components.get("three"),t=new Map;return t.set("Scene1",_8e),t.set("Scene2",b8e),t.set("RTTScene",x8e),et.jsx(uWe,{three:e,scenes:t,onSceneAdd:n=>{var r;n.setup(s.app,(r=oo.instance)==null?void 0:r.renderer),n.init()},onSceneUpdate:n=>{n.update()}})}class S8e{constructor(e,t,n){this.id=0,this.name=e,this.fg=t,this.bg=n,this.gradient=null,this.PR=Math.round(window.devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=document.createElement("canvas"),this.canvas.width=this.WIDTH,this.canvas.height=this.HEIGHT,this.canvas.style.width="90px",this.canvas.style.height="48px",this.canvas.style.position="absolute",this.canvas.style.cssText="width:90px;height:48px;background-color: transparent !important;",this.context=this.canvas.getContext("2d"),this.initializeCanvas()}createGradient(){if(!this.context)throw new Error("No context");const e=this.context.createLinearGradient(0,this.GRAPH_Y,0,this.GRAPH_Y+this.GRAPH_HEIGHT);let t;const n=this.fg;switch(this.fg.toLowerCase()){case"#0ff":t="#006666";break;case"#0f0":t="#006600";break;case"#ff0":t="#666600";break;case"#e1e1e1":t="#666666";break;default:t=this.bg;break}return e.addColorStop(0,t),e.addColorStop(1,n),e}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.gradient=this.createGradient(),this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}update(e,t,n=0){if(!this.context||!this.gradient)return;const r=Math.min(1/0,e),i=Math.max(t,e);this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(`${e.toFixed(n)} ${this.name} (${r.toFixed(n)}-${parseFloat(i.toFixed(n))})`,this.TEXT_X,this.TEXT_Y)}updateGraph(e,t){if(!this.context||!this.gradient)return;e===0&&t===0&&(t=1),t=Math.max(t,e,.1),e=Math.max(e,0);const n=Math.round(this.GRAPH_X),r=Math.round(this.GRAPH_Y),i=Math.round(this.GRAPH_WIDTH),o=Math.round(this.GRAPH_HEIGHT),l=Math.round(this.PR);this.context.drawImage(this.canvas,n+l,r,i-l,o,n,r,i-l,o),this.context.fillStyle=this.bg,this.context.fillRect(n+i-l,r,l,o);const h=Math.min(o,Math.round(e/t*o));h>0&&(this.context.globalAlpha=.9,this.context.fillStyle=this.gradient,this.context.fillRect(n+i-l,r+(o-h),l,h)),this.context.globalAlpha=1}}class Tqe extends S8e{constructor(e,t,n){super(e,t,n),this.vsyncValue=0,this.SMALL_HEIGHT=9*this.PR,this.HEIGHT=this.SMALL_HEIGHT,this.WIDTH=35*this.PR,this.TEXT_Y=0*this.PR,this.canvas.height=this.HEIGHT,this.canvas.width=this.WIDTH,this.canvas.style.height="9px",this.canvas.style.width="35px",this.canvas.style.cssText=`
            width: 35px;
            height: 9px;
            position: absolute;
            top: 0;
            left: 0;
            background-color: transparent !important;
            pointer-events: none;
        `,this.initializeCanvas()}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.context.globalAlpha=1)}update(e,t,n=0){this.context&&(this.vsyncValue=e,this.context.clearRect(0,0,this.WIDTH,this.HEIGHT),this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillText(`${e.toFixed(0)}Hz`,this.TEXT_X,this.TEXT_Y))}updateGraph(e,t){}setOffset(e,t){this.canvas.style.transform=`translate(${e}px, ${t}px)`}}const w8e=class h_{constructor({trackGPU:e=!1,trackCPT:t=!1,trackHz:n=!1,logsPerSecond:r=4,graphsPerSecond:i=30,samplesLog:o=40,samplesGraph:l=10,precision:h=2,minimal:p=!1,horizontal:y=!0,mode:x=0}={}){this.gl=null,this.ext=null,this.activeQuery=null,this.gpuQueries=[],this.threeRendererPatched=!1,this.frameTimes=[],this.renderCount=0,this.totalCpuDuration=0,this.totalGpuDuration=0,this.totalGpuDurationCompute=0,this.gpuPanel=null,this.gpuPanelCompute=null,this.vsyncPanel=null,this.averageFps={logs:[],graph:[]},this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.averageGpuCompute={logs:[],graph:[]},this.updateCounter=0,this.lastMin={},this.lastMax={},this.lastValue={},this.VSYNC_RATES=[{refreshRate:60,frameTime:16.67},{refreshRate:75,frameTime:13.33},{refreshRate:90,frameTime:11.11},{refreshRate:120,frameTime:8.33},{refreshRate:144,frameTime:6.94},{refreshRate:165,frameTime:6.06},{refreshRate:240,frameTime:4.17}],this.detectedVSync=null,this.frameTimeHistory=[],this.HISTORY_SIZE=120,this.VSYNC_THRESHOLD=.05,this.lastFrameTime=0,this.handleClick=A=>{A.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},this.handleResize=()=>{this.resizePanel(this.fpsPanel),this.resizePanel(this.msPanel),this.gpuPanel&&this.resizePanel(this.gpuPanel),this.gpuPanelCompute&&this.resizePanel(this.gpuPanelCompute)},this.mode=x,this.horizontal=y,this.minimal=p,this.trackGPU=e,this.trackCPT=t,this.trackHz=n,this.samplesLog=o,this.samplesGraph=l,this.precision=h,this.logsPerSecond=r,this.graphsPerSecond=i;const S=performance.now();this.prevGraphTime=S,this.dom=document.createElement("div"),this.initializeDOM(),this.beginTime=performance.now(),this.prevTextTime=this.beginTime,this.prevCpuTime=this.beginTime,this._panelId=0,this.fpsPanel=this.addPanel(new h_.Panel("FPS","#0ff","#002")),this.msPanel=this.addPanel(new h_.Panel("CPU","#0f0","#020")),this.trackHz===!0&&(this.vsyncPanel=new Tqe("","#f0f","#202"),this.dom.appendChild(this.vsyncPanel.canvas),this.vsyncPanel.setOffset(56,35)),this.setupEventListeners()}initializeDOM(){this.dom.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      opacity: 0.9;
      z-index: 10000;
      ${this.minimal?"cursor: pointer;":""}
    `}setupEventListeners(){this.minimal?(this.dom.addEventListener("click",this.handleClick),this.showPanel(this.mode)):window.addEventListener("resize",this.handleResize)}async init(e){if(!e){console.error('Stats: The "canvas" parameter is undefined.');return}if(!this.handleThreeRenderer(e)&&!await this.handleWebGPURenderer(e))if(this.initializeWebGL(e)){this.trackGPU&&this.initializeGPUTracking();return}else console.error("Stats-gl: Failed to initialize WebGL context")}handleThreeRenderer(e){return e.isWebGLRenderer&&!this.threeRendererPatched?(this.patchThreeRenderer(e),this.gl=e.getContext(),this.trackGPU&&this.initializeGPUTracking(),!0):!1}async handleWebGPURenderer(e){return e.isWebGPURenderer?((this.trackGPU||this.trackCPT)&&(e.backend.trackTimestamp=!0,await e.hasFeatureAsync("timestamp-query")&&this.initializeWebGPUPanels()),this.info=e.info,this.patchThreeWebGPU(e),!0):!1}initializeWebGPUPanels(){this.trackGPU&&(this.gpuPanel=this.addPanel(new h_.Panel("GPU","#ff0","#220"))),this.trackCPT&&(this.gpuPanelCompute=this.addPanel(new h_.Panel("CPT","#e1e1e1","#212121")))}initializeWebGL(e){if(e instanceof WebGL2RenderingContext)this.gl=e;else if(e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas){if(this.gl=e.getContext("webgl2"),!this.gl)return console.error("Stats: Unable to obtain WebGL2 context."),!1}else return console.error("Stats: Invalid input type. Expected WebGL2RenderingContext, HTMLCanvasElement, or OffscreenCanvas."),!1;return!0}initializeGPUTracking(){this.gl&&(this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new h_.Panel("GPU","#ff0","#220"))))}begin(){this.beginProfiling("cpu-started"),!(!this.gl||!this.ext)&&(this.activeQuery&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.activeQuery=this.gl.createQuery(),this.activeQuery&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery))}end(){this.renderCount++,this.gl&&this.ext&&this.activeQuery&&(this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.gpuQueries.push({query:this.activeQuery}),this.activeQuery=null),this.endProfiling("cpu-started","cpu-finished","cpu-duration")}update(){this.endProfiling("cpu-started","cpu-finished","cpu-duration"),this.info?this.processWebGPUTimestamps():this.processGpuQueries(),this.updateAverages(),this.resetCounters()}processWebGPUTimestamps(){this.totalGpuDuration=this.info.render.timestamp,this.totalGpuDurationCompute=this.info.compute.timestamp}resetCounters(){this.renderCount=0,this.totalCpuDuration=0,this.beginTime=this.endInternal()}resizePanel(e){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=e.id*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=e.id*e.HEIGHT/e.PR+"px"))}addPanel(e){return e.canvas&&(this.dom.appendChild(e.canvas),e.id=this._panelId,this.resizePanel(e),this._panelId++),e}showPanel(e){for(let t=0;t<this.dom.children.length;t++){const n=this.dom.children[t];n.style.display=t===e?"block":"none"}this.mode=e}processGpuQueries(){!this.gl||!this.ext||(this.totalGpuDuration=0,this.gpuQueries.forEach((e,t)=>{if(this.gl){const n=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),r=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT);if(n&&!r){const o=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT)*1e-6;this.totalGpuDuration+=o,this.gl.deleteQuery(e.query),this.gpuQueries.splice(t,1)}}}))}detectVSync(e){if(this.lastFrameTime===0){this.lastFrameTime=e;return}const t=e-this.lastFrameTime;if(this.lastFrameTime=e,this.frameTimeHistory.push(t),this.frameTimeHistory.length>this.HISTORY_SIZE&&this.frameTimeHistory.shift(),this.frameTimeHistory.length<60)return;const n=this.frameTimeHistory.reduce((h,p)=>h+p)/this.frameTimeHistory.length,r=this.frameTimeHistory.reduce((h,p)=>h+Math.pow(p-n,2),0)/this.frameTimeHistory.length;if(Math.sqrt(r)>2){this.detectedVSync=null;return}let o=null,l=1/0;for(const h of this.VSYNC_RATES){const p=Math.abs(n-h.frameTime);p<l&&(l=p,o=h)}o&&l/o.frameTime<=this.VSYNC_THRESHOLD?this.detectedVSync=o:this.detectedVSync=null}endInternal(){var e;const t=performance.now();for(this.frameTimes.push(t);this.frameTimes.length>0&&this.frameTimes[0]<=t-1e3;)this.frameTimes.shift();const n=Math.round(this.frameTimes.length);this.addToAverage(n,this.averageFps);const r=t>=this.prevTextTime+1e3/this.logsPerSecond,i=t>=this.prevGraphTime+1e3/this.graphsPerSecond;if(this.updatePanelComponents(this.fpsPanel,this.averageFps,0,r,i),this.updatePanelComponents(this.msPanel,this.averageCpu,this.precision,r,i),this.gpuPanel&&this.updatePanelComponents(this.gpuPanel,this.averageGpu,this.precision,r,i),this.trackCPT&&this.gpuPanelCompute&&this.updatePanelComponents(this.gpuPanelCompute,this.averageGpuCompute,this.precision,r,i),r&&(this.prevTextTime=t),i&&(this.prevGraphTime=t),this.vsyncPanel!==null){this.detectVSync(t);const o=((e=this.detectedVSync)==null?void 0:e.refreshRate)||0;r&&o>0&&this.vsyncPanel.update(o,o)}return t}updatePanelComponents(e,t,n,r,i){if(!e||t.logs.length===0)return;e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const o=t.logs[t.logs.length-1];this.lastMax[e.name]=Math.max(...t.logs),this.lastMin[e.name]=Math.min(this.lastMin[e.name],o),this.lastValue[e.name]=this.lastValue[e.name]*.7+o*.3;const l=Math.max(Math.max(...t.logs),...t.graph.slice(-this.samplesGraph));this.updateCounter++,r&&e.update(this.lastValue[e.name],this.lastMax[e.name],n),i&&e.updateGraph(o,l)}beginProfiling(e){if(window.performance)try{window.performance.clearMarks(e),window.performance.mark(e)}catch(t){console.debug("Stats: Performance marking failed:",t)}}endProfiling(e,t,n){if(!(!window.performance||!t||!e))try{window.performance.getEntriesByName(e,"mark").length===0&&this.beginProfiling(e),window.performance.clearMarks(t),window.performance.mark(t),window.performance.clearMeasures(n);const i=performance.measure(n,e,t);this.totalCpuDuration+=i.duration,window.performance.clearMarks(e),window.performance.clearMarks(t),window.performance.clearMeasures(n)}catch(r){console.debug("Stats: Performance measurement failed:",r)}}updatePanel(e,t,n=2){if(!e||t.logs.length===0)return;const r=performance.now();e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const i=t.logs[t.logs.length-1],o=Math.max(...t.logs.slice(-30));this.lastMin[e.name]=Math.min(this.lastMin[e.name],i),this.lastMax[e.name]=Math.max(this.lastMax[e.name],i),this.lastValue[e.name]=this.lastValue[e.name]*.7+i*.3;const l=Math.max(o,...t.graph.slice(-this.samplesGraph));this.updateCounter++,this.updateCounter%(this.logsPerSecond*2)===0&&(this.lastMax[e.name]=o,this.lastMin[e.name]=i),e.update&&(r>=this.prevCpuTime+1e3/this.logsPerSecond&&e.update(this.lastValue[e.name],i,this.lastMax[e.name],l,n),r>=this.prevGraphTime+1e3/this.graphsPerSecond&&(e.updateGraph(i,l),this.prevGraphTime=r))}updateAverages(){this.addToAverage(this.totalCpuDuration,this.averageCpu),this.addToAverage(this.totalGpuDuration,this.averageGpu),this.info&&this.totalGpuDurationCompute!==void 0&&this.addToAverage(this.totalGpuDurationCompute,this.averageGpuCompute)}addToAverage(e,t){t.logs.push(e),t.logs.length>this.samplesLog&&(t.logs=t.logs.slice(-this.samplesLog)),t.graph.push(e),t.graph.length>this.samplesGraph&&(t.graph=t.graph.slice(-this.samplesGraph))}get domElement(){return this.dom}patchThreeWebGPU(e){const t=e.info.reset,n=this;e.info.reset=function(){n.beginProfiling("cpu-started"),t.call(this)}}patchThreeRenderer(e){const t=e.render,n=this;e.render=function(r,i){n.begin(),t.call(this,r,i),n.end()},this.threeRendererPatched=!0}};w8e.Panel=S8e;let Mqe=w8e,xg,_a,Xw="";function Cqe(s){const e=s.app,t=Fn.useRef(null),n=s.app.components.get("three");console.log("Settings",e.settings),e.isApp&&Fn.useEffect(()=>{const l=t.current;xg=new y_({canvas:l,stencil:!1}),xg.shadowMap.enabled=!0,xg.setPixelRatio(devicePixelRatio),xg.setClearColor(0),n.setRenderer(xg,l);const h=new Mqe;h.init(xg),document.body.appendChild(h.dom);let p=-1;const y=()=>{const S=window.innerWidth,A=window.innerHeight;_a==null||_a.resize(S,A),xg.setSize(S,A)},x=()=>{_a==null||_a.update(),_a==null||_a.draw(),h.update(),p=requestAnimationFrame(x)};return window.addEventListener("resize",y),y(),x(),()=>{_a!==void 0&&(n.removeCamera(_a.camera),n.removeScene(_a),Hh(_a)),window.removeEventListener("resize",y),cancelAnimationFrame(p),p=-1,xg.dispose()}},[]);const r=()=>{_a!==void 0&&(_a.camera!==void 0&&n.removeCamera(_a.camera),n.removeScene(_a),Hh(_a),Sqe(n)),Xw==="scene1"?_a=new _8e:_a=new b8e,_a.setup(e,xg),_a.init(),_a.resize(window.innerWidth,window.innerHeight)},i=()=>{Xw!=="scene1"&&(Xw="scene1",r())},o=()=>{Xw!=="scene2"&&(Xw="scene2",r())};return et.jsx(et.Fragment,{children:e.isApp&&et.jsxs(et.Fragment,{children:[et.jsx("canvas",{ref:t}),et.jsxs("div",{style:{position:"absolute",bottom:"20px",left:"20px"},children:[et.jsx("button",{onClick:i,children:"Scene 1"}),et.jsx("button",{onClick:o,children:"Scene 2"})]})]})})}function Aqe(s){const[e,t]=Fn.useState(!1);return Fn.useEffect(()=>{const n=()=>{FH.removeEventListener(tk.LOAD_COMPLETE,n),t(!0)};FH.addEventListener(tk.LOAD_COMPLETE,n),_qe(s.app)},[t]),et.jsxs(et.Fragment,{children:[!e&&et.jsx("p",{children:"Loading..."}),e&&s.app.isApp&&et.jsx(Cqe,{app:s.app})]})}function Pqe(){const[s,e]=Fn.useState(null);return Fn.useEffect(()=>{const t=new kke;t.detectSettings(iV,sV).then(()=>{t.addComponent("theatre",new Uke(iV,sV));const n=new jke("Hermes Example",iV,sV);t.addComponent("three",n),e(t)})},[]),et.jsx(et.Fragment,{children:s!==null&&et.jsxs(et.Fragment,{children:[s.debugEnabled&&et.jsx(Wke,{app:s}),s.editor&&et.jsx(Eqe,{app:s}),et.jsx(Aqe,{app:s})]})})}d9e.initialize();mTe.createRoot(document.getElementById("root")).render(et.jsx(et.Fragment,{children:et.jsx(et.Fragment,{children:et.jsx(Pqe,{})})}));
